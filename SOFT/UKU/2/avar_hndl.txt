; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\avar_hndl.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DUKU_ZVU --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;77     //-----------------------------------------------
;;;78     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;79     {
;;;80     //static unsigned avar_stat_old;
;;;81     char i;
;;;82     //unsigned avar_stat_new,avar_stat_offed;
;;;83     
;;;84     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48ff              LDR      r0,|L1.1024|
000004  4bff              LDR      r3,|L1.1028|
000006  7801              LDRB     r1,[r0,#0]  ; net_av
000008  6818              LDR      r0,[r3,#0]
00000a  b119              CBZ      r1,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6018              STR      r0,[r3,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;85     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6018              STR      r0,[r3,#0]  ; avar_stat
                  |L1.26|
;;;86     
;;;87     for(i=0;i<2;i++)
00001a  f04f0000          MOV      r0,#0
;;;88     	{
;;;89     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
00001e  4dfa              LDR      r5,|L1.1032|
000020  f04f0401          MOV      r4,#1
                  |L1.36|
000024  eb000140          ADD      r1,r0,r0,LSL #1
000028  eb011100          ADD      r1,r1,r0,LSL #4
00002c  eb050181          ADD      r1,r5,r1,LSL #2
000030  f891103d          LDRB     r1,[r1,#0x3d]
000034  0789              LSLS     r1,r1,#30
000036  d00a              BEQ      |L1.78|
000038  f1000101          ADD      r1,r0,#1
00003c  fa04f201          LSL      r2,r4,r1
000040  6819              LDR      r1,[r3,#0]  ; avar_stat
000042  ea210102          BIC      r1,r1,r2
000046  ea410102          ORR      r1,r1,r2
00004a  6019              STR      r1,[r3,#0]  ; avar_stat
00004c  e007              B        |L1.94|
                  |L1.78|
;;;90     	else	   			SET_REG(avar_stat,0,1+i,1);
00004e  f1000201          ADD      r2,r0,#1
000052  fa04f102          LSL      r1,r4,r2
000056  681a              LDR      r2,[r3,#0]  ; avar_stat
000058  ea220201          BIC      r2,r2,r1
00005c  601a              STR      r2,[r3,#0]  ; avar_stat
                  |L1.94|
00005e  f1000001          ADD      r0,r0,#1              ;87
000062  b2c0              UXTB     r0,r0                 ;87
000064  2802              CMP      r0,#2                 ;87
000066  d3dd              BCC      |L1.36|
;;;91     	}
;;;92     
;;;93     for(i=0;i<12;i++)
000068  f04f0000          MOV      r0,#0
;;;94     	{
;;;95     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00006c  4de7              LDR      r5,|L1.1036|
                  |L1.110|
00006e  eb0001c0          ADD      r1,r0,r0,LSL #3
000072  eb011100          ADD      r1,r1,r0,LSL #4
000076  eb050181          ADD      r1,r5,r1,LSL #2
00007a  7849              LDRB     r1,[r1,#1]
00007c  f0110fef          TST      r1,#0xef
000080  d00a              BEQ      |L1.152|
000082  f1000203          ADD      r2,r0,#3
000086  fa04f102          LSL      r1,r4,r2
00008a  681a              LDR      r2,[r3,#0]  ; avar_stat
00008c  ea220201          BIC      r2,r2,r1
000090  ea420201          ORR      r2,r2,r1
000094  601a              STR      r2,[r3,#0]  ; avar_stat
000096  e007              B        |L1.168|
                  |L1.152|
;;;96     	else	   		SET_REG(avar_stat,0,3+i,1);
000098  f1000103          ADD      r1,r0,#3
00009c  fa04f201          LSL      r2,r4,r1
0000a0  6819              LDR      r1,[r3,#0]  ; avar_stat
0000a2  ea210102          BIC      r1,r1,r2
0000a6  6019              STR      r1,[r3,#0]  ; avar_stat
                  |L1.168|
0000a8  f1000001          ADD      r0,r0,#1              ;93
0000ac  b2c0              UXTB     r0,r0                 ;93
0000ae  280c              CMP      r0,#0xc               ;93
0000b0  d3dd              BCC      |L1.110|
;;;97     	}
;;;98     
;;;99     for(i=0;i<6;i++)
0000b2  f04f0000          MOV      r0,#0
;;;100    	{
;;;101    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
0000b6  4ad3              LDR      r2,|L1.1028|
0000b8  f1020228          ADD      r2,r2,#0x28
                  |L1.188|
0000bc  5c11              LDRB     r1,[r2,r0]
0000be  b151              CBZ      r1,|L1.214|
0000c0  f100050f          ADD      r5,r0,#0xf
0000c4  fa04f105          LSL      r1,r4,r5
0000c8  681d              LDR      r5,[r3,#0]  ; avar_stat
0000ca  ea250501          BIC      r5,r5,r1
0000ce  ea450501          ORR      r5,r5,r1
0000d2  601d              STR      r5,[r3,#0]  ; avar_stat
0000d4  e007              B        |L1.230|
                  |L1.214|
;;;102    	else	   		SET_REG(avar_stat,0,15+i,1);
0000d6  f100010f          ADD      r1,r0,#0xf
0000da  fa04f501          LSL      r5,r4,r1
0000de  6819              LDR      r1,[r3,#0]  ; avar_stat
0000e0  ea210105          BIC      r1,r1,r5
0000e4  6019              STR      r1,[r3,#0]  ; avar_stat
                  |L1.230|
0000e6  f1000001          ADD      r0,r0,#1              ;99
0000ea  b2c0              UXTB     r0,r0                 ;99
0000ec  2806              CMP      r0,#6                 ;99
0000ee  d3e5              BCC      |L1.188|
;;;103    	}
;;;104    
;;;105    /*for(i=0;i<4;i++)
;;;106    	{
;;;107    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;108    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;109    	}  */
;;;110    for(i=0;i<4;i++)
0000f0  f04f0000          MOV      r0,#0
;;;111    	{
;;;112    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000f4  4dc6              LDR      r5,|L1.1040|
                  |L1.246|
0000f6  5c29              LDRB     r1,[r5,r0]
0000f8  2901              CMP      r1,#1
0000fa  d036              BEQ      |L1.362|
;;;113    	else	   		SET_REG(avar_stat,0,24+i,1);
0000fc  f1000118          ADD      r1,r0,#0x18
000100  681a              LDR      r2,[r3,#0]  ; avar_stat
000102  fa04f101          LSL      r1,r4,r1
000106  ea220201          BIC      r2,r2,r1
00010a  601a              STR      r2,[r3,#0]  ; avar_stat
                  |L1.268|
00010c  f1000001          ADD      r0,r0,#1              ;110
000110  b2c0              UXTB     r0,r0                 ;110
000112  2804              CMP      r0,#4                 ;110
000114  d3ef              BCC      |L1.246|
;;;114    	}
;;;115    
;;;116    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;117    //else	   			SET_REG(avar_stat,0,28,1);
;;;118    
;;;119    
;;;120    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000116  689a              LDR      r2,[r3,#8]  ; avar_stat_old
000118  6818              LDR      r0,[r3,#0]  ; avar_stat
00011a  ea200102          BIC      r1,r0,r2
00011e  60d9              STR      r1,[r3,#0xc]  ; avar_stat_new
;;;121    
;;;122    avar_ind_stat|=avar_stat_new;
000120  685c              LDR      r4,[r3,#4]  ; avar_ind_stat
000122  ea440401          ORR      r4,r4,r1
000126  605c              STR      r4,[r3,#4]  ; avar_ind_stat
;;;123    
;;;124    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000128  49ba              LDR      r1,|L1.1044|
00012a  880d              LDRH     r5,[r1,#0]  ; SK_ZVUK_EN
00012c  b115              CBZ      r5,|L1.308|
00012e  f0247480          BIC      r4,r4,#0x1000000
000132  605c              STR      r4,[r3,#4]  ; avar_ind_stat
                  |L1.308|
;;;125    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
000134  884c              LDRH     r4,[r1,#2]  ; SK_ZVUK_EN
000136  b11c              CBZ      r4,|L1.320|
000138  685c              LDR      r4,[r3,#4]  ; avar_ind_stat
00013a  f0247400          BIC      r4,r4,#0x2000000
00013e  605c              STR      r4,[r3,#4]  ; avar_ind_stat
                  |L1.320|
;;;126    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
000140  888c              LDRH     r4,[r1,#4]  ; SK_ZVUK_EN
000142  b11c              CBZ      r4,|L1.332|
000144  685c              LDR      r4,[r3,#4]  ; avar_ind_stat
000146  f0246480          BIC      r4,r4,#0x4000000
00014a  605c              STR      r4,[r3,#4]  ; avar_ind_stat
                  |L1.332|
;;;127    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
00014c  88c9              LDRH     r1,[r1,#6]  ; SK_ZVUK_EN
00014e  b119              CBZ      r1,|L1.344|
000150  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
000152  f0216100          BIC      r1,r1,#0x8000000
000156  6059              STR      r1,[r3,#4]  ; avar_ind_stat
                  |L1.344|
;;;128    
;;;129    
;;;130    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
000158  ea220200          BIC      r2,r2,r0
00015c  ea6f0102          MVN      r1,r2
000160  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
;;;131    
;;;132    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
000162  4aad              LDR      r2,|L1.1048|
000164  8812              LDRH     r2,[r2,#0]  ; AV_OFF_AVT
000166  b15a              CBZ      r2,|L1.384|
000168  e00e              B        |L1.392|
                  |L1.362|
00016a  f1000218          ADD      r2,r0,#0x18           ;112
00016e  fa04f102          LSL      r1,r4,r2              ;112
000172  681a              LDR      r2,[r3,#0]            ;112  ; avar_stat
000174  ea220201          BIC      r2,r2,r1              ;112
000178  ea420201          ORR      r2,r2,r1              ;112
00017c  601a              STR      r2,[r3,#0]            ;112  ; avar_stat
00017e  e7c5              B        |L1.268|
                  |L1.384|
000180  4aa6              LDR      r2,|L1.1052|
000182  ea410102          ORR      r1,r1,r2
000186  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
                  |L1.392|
;;;133    
;;;134    avar_ind_stat&=avar_stat_offed; 
000188  691a              LDR      r2,[r3,#0x10]  ; avar_stat_offed
00018a  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
00018c  ea010102          AND      r1,r1,r2
000190  6059              STR      r1,[r3,#4]  ; avar_ind_stat
;;;135    
;;;136    avar_stat_old=avar_stat;
000192  6098              STR      r0,[r3,#8]  ; avar_stat_old
;;;137    
;;;138    //oleg_start
;;;139    
;;;140    
;;;141    
;;;142    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
000194  48a2              LDR      r0,|L1.1056|
000196  49a3              LDR      r1,|L1.1060|
000198  8800              LDRH     r0,[r0,#0]  ; status_izm_r
00019a  6809              LDR      r1,[r1,#0]  ; sk_alarm
00019c  f000003f          AND      r0,r0,#0x3f
0001a0  ea402001          ORR      r0,r0,r1,LSL #8
0001a4  6158              STR      r0,[r3,#0x14]  ; rki_avar1_stat
;;;143    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
0001a6  69da              LDR      r2,[r3,#0x1c]  ; rki_avar1_stat_old
0001a8  ea200102          BIC      r1,r0,r2
0001ac  6219              STR      r1,[r3,#0x20]  ; rki_avar1_stat_new
;;;144    rki_avar1_ind_stat|=rki_avar1_stat_new;
0001ae  699c              LDR      r4,[r3,#0x18]  ; rki_avar1_ind_stat
0001b0  ea440401          ORR      r4,r4,r1
;;;145    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
0001b4  ea220200          BIC      r2,r2,r0
0001b8  ea6f0102          MVN      r1,r2
0001bc  6259              STR      r1,[r3,#0x24]  ; rki_avar1_stat_offed
;;;146    rki_avar1_ind_stat&=rki_avar1_stat_offed;
0001be  ea040401          AND      r4,r4,r1
0001c2  619c              STR      r4,[r3,#0x18]  ; rki_avar1_ind_stat
;;;147    rki_avar1_stat_old=rki_avar1_stat;
0001c4  61d8              STR      r0,[r3,#0x1c]  ; rki_avar1_stat_old
;;;148    /*
;;;149    rki_avarI1_stat=status_di1;
;;;150    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;151    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;152    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;153    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;154    rki_avarI1_stat_old=rki_avarI1_stat;
;;;155    
;;;156    rki_avarI2_stat=status_di2;
;;;157    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;158    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;159    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;160    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;161    rki_avarI2_stat_old=rki_avarI2_stat;
;;;162    */
;;;163    //oleg_end
;;;164    }
0001c6  bd30              POP      {r4,r5,pc}
;;;165    
                          ENDP

                  reload_hndl PROC
;;;166    //-----------------------------------------------
;;;167    void reload_hndl(void)
0001c8  b5f8              PUSH     {r3-r7,lr}
;;;168    {
;;;169    
;;;170    char data[4];
;;;171    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;172    
;;;173    event_ptr=lc640_read_int(PTR_EVENT_LOG);
0001ca  f44f6560          MOV      r5,#0xe00
0001ce  4628              MOV      r0,r5
0001d0  f7fffffe          BL       lc640_read_int
;;;174    event_ptr++;	
0001d4  f1000001          ADD      r0,r0,#1
0001d8  4604              MOV      r4,r0
;;;175    if(event_ptr>63)event_ptr=0;	
0001da  2c3f              CMP      r4,#0x3f
0001dc  d901              BLS      |L1.482|
0001de  f04f0400          MOV      r4,#0
                  |L1.482|
;;;176    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
0001e2  b221              SXTH     r1,r4
0001e4  4628              MOV      r0,r5
0001e6  f7fffffe          BL       lc640_write_int
;;;177    	
;;;178    event_cnt=lc640_read_int(CNT_EVENT_LOG);
0001ea  f6406602          MOV      r6,#0xe02
0001ee  4630              MOV      r0,r6
0001f0  f7fffffe          BL       lc640_read_int
;;;179    if(event_cnt!=63)event_cnt=event_ptr;
0001f4  283f              CMP      r0,#0x3f
0001f6  d000              BEQ      |L1.506|
0001f8  4620              MOV      r0,r4
                  |L1.506|
;;;180    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
0001fa  b201              SXTH     r1,r0
0001fc  4630              MOV      r0,r6
0001fe  f7fffffe          BL       lc640_write_int
;;;181    	
;;;182    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000202  4628              MOV      r0,r5
000204  f7fffffe          BL       lc640_read_int
000208  f44f6180          MOV      r1,#0x400
00020c  eb011440          ADD      r4,r1,r0,LSL #5
;;;183    	
;;;184    data[0]='U';
000210  f04f0055          MOV      r0,#0x55
000214  f88d0000          STRB     r0,[sp,#0]
;;;185    data[1]=0;
000218  f04f0600          MOV      r6,#0
00021c  f88d6001          STRB     r6,[sp,#1]
;;;186    data[2]='R';
000220  f04f0052          MOV      r0,#0x52
000224  f88d0002          STRB     r0,[sp,#2]
;;;187    data[3]=0;
000228  f88d6003          STRB     r6,[sp,#3]
;;;188    lc640_write_long_ptr(lc640_adr,data);
00022c  4669              MOV      r1,sp
00022e  4620              MOV      r0,r4
000230  f7fffffe          BL       lc640_write_long_ptr
;;;189    
;;;190    data[0]=0;
;;;191    data[1]=0;
;;;192    data[2]=0;
;;;193    data[3]=0;
000234  9600              STR      r6,[sp,#0]
;;;194    lc640_write_long_ptr(lc640_adr+4,data);
000236  4669              MOV      r1,sp
000238  1d20              ADDS     r0,r4,#4
00023a  f7fffffe          BL       lc640_write_long_ptr
;;;195    
;;;196    data[0]=LPC_RTC->YEAR;
00023e  4d7a              LDR      r5,|L1.1064|
000240  8ba8              LDRH     r0,[r5,#0x1c]
000242  f88d0000          STRB     r0,[sp,#0]
;;;197    data[1]=LPC_RTC->MONTH;
000246  7e28              LDRB     r0,[r5,#0x18]
000248  f88d0001          STRB     r0,[sp,#1]
;;;198    data[2]=LPC_RTC->DOM;
00024c  7b28              LDRB     r0,[r5,#0xc]
00024e  f88d0002          STRB     r0,[sp,#2]
;;;199    data[3]=0;
000252  f88d6003          STRB     r6,[sp,#3]
;;;200    lc640_write_long_ptr(lc640_adr+8,data);
000256  4669              MOV      r1,sp
000258  f1040008          ADD      r0,r4,#8
00025c  f7fffffe          BL       lc640_write_long_ptr
;;;201    
;;;202    data[0]=LPC_RTC->HOUR;
000260  7a28              LDRB     r0,[r5,#8]
000262  f88d0000          STRB     r0,[sp,#0]
;;;203    data[1]=LPC_RTC->MIN;
000266  7928              LDRB     r0,[r5,#4]
000268  f88d0001          STRB     r0,[sp,#1]
;;;204    data[2]=LPC_RTC->SEC;
00026c  7828              LDRB     r0,[r5,#0]
00026e  f88d0002          STRB     r0,[sp,#2]
;;;205    data[3]=LPC_SC->RSID;
000272  486e              LDR      r0,|L1.1068|
000274  f8d00180          LDR      r0,[r0,#0x180]
000278  f88d0003          STRB     r0,[sp,#3]
;;;206    
;;;207    lc640_write_long_ptr(lc640_adr+12,data);
00027c  4669              MOV      r1,sp
00027e  f104000c          ADD      r0,r4,#0xc
000282  f7fffffe          BL       lc640_write_long_ptr
;;;208    	
;;;209    data[0]='A';
000286  f04f0541          MOV      r5,#0x41
00028a  f88d5000          STRB     r5,[sp,#0]
;;;210    data[1]='A';
00028e  f88d5001          STRB     r5,[sp,#1]
;;;211    data[2]='A';
000292  f88d5002          STRB     r5,[sp,#2]
;;;212    data[3]='A';
000296  f88d5003          STRB     r5,[sp,#3]
;;;213    lc640_write_long_ptr(lc640_adr+16,data);
00029a  4669              MOV      r1,sp
00029c  f1040010          ADD      r0,r4,#0x10
0002a0  f7fffffe          BL       lc640_write_long_ptr
;;;214    	
;;;215    data[0]='A';
0002a4  f88d5000          STRB     r5,[sp,#0]
;;;216    data[1]='A';
0002a8  f88d5001          STRB     r5,[sp,#1]
;;;217    data[2]='A';
0002ac  f88d5002          STRB     r5,[sp,#2]
;;;218    data[3]='A';
0002b0  f88d5003          STRB     r5,[sp,#3]
;;;219    lc640_write_long_ptr(lc640_adr+20,data);
0002b4  4669              MOV      r1,sp
0002b6  f1040014          ADD      r0,r4,#0x14
0002ba  f7fffffe          BL       lc640_write_long_ptr
;;;220    	
;;;221    data[0]='A';
0002be  f88d5000          STRB     r5,[sp,#0]
;;;222    data[1]='A';
0002c2  f88d5001          STRB     r5,[sp,#1]
;;;223    data[2]='A';
0002c6  f88d5002          STRB     r5,[sp,#2]
;;;224    data[3]='A';
0002ca  f88d5003          STRB     r5,[sp,#3]
;;;225    lc640_write_long_ptr(lc640_adr+24,data);
0002ce  4669              MOV      r1,sp
0002d0  f1040018          ADD      r0,r4,#0x18
0002d4  f7fffffe          BL       lc640_write_long_ptr
;;;226    	
;;;227    data[0]='A';
0002d8  f88d5000          STRB     r5,[sp,#0]
;;;228    data[1]='A';
0002dc  f88d5001          STRB     r5,[sp,#1]
;;;229    data[2]='A';
0002e0  f88d5002          STRB     r5,[sp,#2]
;;;230    data[3]='A';
0002e4  f88d5003          STRB     r5,[sp,#3]
;;;231    lc640_write_long_ptr(lc640_adr+28,data);				
0002e8  4669              MOV      r1,sp
0002ea  f104001c          ADD      r0,r4,#0x1c
0002ee  f7fffffe          BL       lc640_write_long_ptr
;;;232    	
;;;233    	
;;;234    }
0002f2  bdf8              POP      {r3-r7,pc}
;;;235    
                          ENDP

                  avar_unet_hndl PROC
;;;236    //-----------------------------------------------
;;;237    void avar_unet_hndl(char in)
0002f4  e92d4ff8          PUSH     {r3-r11,lr}
;;;238    {
;;;239    
;;;240    char data[4];
;;;241    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;242    
;;;243    
;;;244    if(in==1)
;;;245    	{
;;;246    	net_av=1;
;;;247    	net_av_2min_timer=1200;
;;;248    
;;;249    	//beep_init(0x01L,'O');
;;;250    	//a.av.bAN=1;
;;;251    
;;;252    
;;;253    	//beep_init(0x33333333,'A');
;;;254    	 
;;;255    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;256    	event_ptr++;	
;;;257    	if(event_ptr>63)event_ptr=0;	
;;;258    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;259    	
;;;260         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;261    	if(event_cnt!=63)event_cnt=event_ptr;
;;;262    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;263    	
;;;264    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;265    	
;;;266    	data[0]='P';
;;;267    	data[1]=0;
;;;268    	data[2]='A';
;;;269    	data[3]=0;
;;;270    	lc640_write_long_ptr(lc640_adr,data);
;;;271    
;;;272    	data[0]=0;//*((char*)&Unet_store);
;;;273    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;274    	data[2]=0;
;;;275    	data[3]=0;
;;;276    	lc640_write_long_ptr(lc640_adr+4,data);
;;;277    
;;;278    	data[0]=LPC_RTC->YEAR;
0002f8  4e4b              LDR      r6,|L1.1064|
0002fa  4941              LDR      r1,|L1.1024|
0002fc  2441              MOVS     r4,#0x41              ;268
0002fe  3e20              SUBS     r6,r6,#0x20
000300  2700              MOVS     r7,#0                 ;257
000302  f04f0a50          MOV      r10,#0x50             ;266
000306  f44f6560          MOV      r5,#0xe00             ;255
00030a  f6406b02          MOV      r11,#0xe02            ;260
00030e  f44f6880          MOV      r8,#0x400             ;264
000312  2801              CMP      r0,#1                 ;244
000314  d006              BEQ      |L1.804|
;;;279    	data[1]=LPC_RTC->MONTH;
;;;280    	data[2]=LPC_RTC->DOM;
;;;281    	data[3]=0;
;;;282    	lc640_write_long_ptr(lc640_adr+8,data);
;;;283    
;;;284    	data[0]=LPC_RTC->HOUR;
;;;285    	data[1]=LPC_RTC->MIN;
;;;286    	data[2]=LPC_RTC->SEC;
;;;287    	data[3]=0;
;;;288    	lc640_write_long_ptr(lc640_adr+12,data);
;;;289    	
;;;290    	data[0]='A';
;;;291    	data[1]='A';
;;;292    	data[2]='A';
;;;293    	data[3]='A';
;;;294    	lc640_write_long_ptr(lc640_adr+16,data);
;;;295    	
;;;296    	data[0]='A';
;;;297    	data[1]='A';
;;;298    	data[2]='A';
;;;299    	data[3]='A';
;;;300    	lc640_write_long_ptr(lc640_adr+20,data);
;;;301    	
;;;302    	data[0]='A';
;;;303    	data[1]='A';
;;;304    	data[2]='A';
;;;305    	data[3]='A';
;;;306    	lc640_write_long_ptr(lc640_adr+24,data);
;;;307    	
;;;308    	data[0]='A';
;;;309    	data[1]='A';
;;;310    	data[2]='A';
;;;311    	data[3]='A';
;;;312    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;313    	
;;;314    /*	memo_out0[0]=0x55;
;;;315         memo_out0[1]=0x00+2;
;;;316         memo_out0[2]=1;
;;;317         memo_out0[3]=0x0b;
;;;318         memo_out0[4]=0x55;
;;;319         memo_out0[5]=0x55; 
;;;320         	
;;;321         memo_out0[6]=crc_87(memo_out0,6);
;;;322    	memo_out0[7]=crc_95(memo_out0,6);
;;;323         usart_out_adr0(memo_out0,8); 
;;;324    	*/
;;;325    	snmp_trap_send("Main power alarm, voltage reduced",2,1,0);
;;;326    	}
;;;327    
;;;328    else if(in==2)
;;;329    	{
;;;330    	net_av=2;
;;;331    
;;;332    	//beep_init(0x01L,'O');
;;;333    	//a.av.bAN=1;
;;;334    
;;;335    
;;;336    	//beep_init(0x33333333,'A');
;;;337    	 
;;;338    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;339    	event_ptr++;	
;;;340    	if(event_ptr>63)event_ptr=0;	
;;;341    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;342    	
;;;343         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;344    	if(event_cnt!=63)event_cnt=event_ptr;
;;;345    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;346    	
;;;347    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;348    	
;;;349    	data[0]='P';
;;;350    	data[1]=0;
;;;351    	data[2]='B';
000316  f04f0942          MOV      r9,#0x42
00031a  2802              CMP      r0,#2                 ;328
00031c  d06d              BEQ      |L1.1018|
;;;352    	data[3]=0;
;;;353    	lc640_write_long_ptr(lc640_adr,data);
;;;354    
;;;355    	data[0]=0;//*((char*)&Unet_store);
;;;356    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;357    	data[2]=0;
;;;358    	data[3]=0;
;;;359    	lc640_write_long_ptr(lc640_adr+4,data);
;;;360    
;;;361    	data[0]=LPC_RTC->YEAR;
;;;362    	data[1]=LPC_RTC->MONTH;
;;;363    	data[2]=LPC_RTC->DOM;
;;;364    	data[3]=0;
;;;365    	lc640_write_long_ptr(lc640_adr+8,data);
;;;366    
;;;367    	data[0]=LPC_RTC->HOUR;
;;;368    	data[1]=LPC_RTC->MIN;
;;;369    	data[2]=LPC_RTC->SEC;
;;;370    	data[3]=0;
;;;371    	lc640_write_long_ptr(lc640_adr+12,data);
;;;372    	
;;;373    	data[0]='A';
;;;374    	data[1]='A';
;;;375    	data[2]='A';
;;;376    	data[3]='A';
;;;377    	lc640_write_long_ptr(lc640_adr+16,data);
;;;378    	
;;;379    	data[0]='A';
;;;380    	data[1]='A';
;;;381    	data[2]='A';
;;;382    	data[3]='A';
;;;383    	lc640_write_long_ptr(lc640_adr+20,data);
;;;384    	
;;;385    	data[0]='A';
;;;386    	data[1]='A';
;;;387    	data[2]='A';
;;;388    	data[3]='A';
;;;389    	lc640_write_long_ptr(lc640_adr+24,data);
;;;390    	
;;;391    	data[0]='A';
;;;392    	data[1]='A';
;;;393    	data[2]='A';
;;;394    	data[3]='A';
;;;395    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;396    	
;;;397    	snmp_trap_send("Main power alarm, voltage increased",2,2,0);
;;;398    	}
;;;399    
;;;400    else if(in==0)
00031e  2800              CMP      r0,#0
000320  d06c              BEQ      |L1.1020|
000322  e1d3              B        |L1.1740|
                  |L1.804|
000324  f04f0001          MOV      r0,#1                 ;246
000328  7008              STRB     r0,[r1,#0]            ;246
00032a  4941              LDR      r1,|L1.1072|
00032c  f44f6096          MOV      r0,#0x4b0             ;247
000330  8008              STRH     r0,[r1,#0]            ;247
000332  4628              MOV      r0,r5                 ;255
000334  f7fffffe          BL       lc640_read_int
000338  f1000001          ADD      r0,r0,#1              ;256
00033c  4681              MOV      r9,r0                 ;256
00033e  f1b90f3f          CMP      r9,#0x3f              ;257
000342  d901              BLS      |L1.840|
000344  f04f0900          MOV      r9,#0                 ;257
                  |L1.840|
000348  fa0ff189          SXTH     r1,r9                 ;258
00034c  4628              MOV      r0,r5                 ;258
00034e  f7fffffe          BL       lc640_write_int
000352  4658              MOV      r0,r11                ;260
000354  f7fffffe          BL       lc640_read_int
000358  283f              CMP      r0,#0x3f              ;261
00035a  d000              BEQ      |L1.862|
00035c  4648              MOV      r0,r9                 ;261
                  |L1.862|
00035e  b201              SXTH     r1,r0                 ;262
000360  4658              MOV      r0,r11                ;262
000362  f7fffffe          BL       lc640_write_int
000366  4628              MOV      r0,r5                 ;264
000368  f7fffffe          BL       lc640_read_int
00036c  eb081540          ADD      r5,r8,r0,LSL #5       ;264
000370  f88da000          STRB     r10,[sp,#0]           ;266
000374  f88d7001          STRB     r7,[sp,#1]            ;267
000378  f88d4002          STRB     r4,[sp,#2]            ;268
00037c  f88d7003          STRB     r7,[sp,#3]            ;269
000380  4669              MOV      r1,sp                 ;270
000382  4628              MOV      r0,r5                 ;270
000384  f7fffffe          BL       lc640_write_long_ptr
000388  9700              STR      r7,[sp,#0]            ;275
00038a  4669              MOV      r1,sp                 ;276
00038c  1d28              ADDS     r0,r5,#4              ;276
00038e  f7fffffe          BL       lc640_write_long_ptr
000392  f1060620          ADD      r6,r6,#0x20           ;278
000396  8bb0              LDRH     r0,[r6,#0x1c]         ;278
000398  f88d0000          STRB     r0,[sp,#0]            ;278
00039c  7e30              LDRB     r0,[r6,#0x18]         ;279
00039e  f88d0001          STRB     r0,[sp,#1]            ;279
0003a2  7b30              LDRB     r0,[r6,#0xc]          ;280
0003a4  f88d0002          STRB     r0,[sp,#2]            ;280
0003a8  f88d7003          STRB     r7,[sp,#3]            ;281
0003ac  4669              MOV      r1,sp                 ;282
0003ae  f1050008          ADD      r0,r5,#8              ;282
0003b2  f7fffffe          BL       lc640_write_long_ptr
0003b6  7a30              LDRB     r0,[r6,#8]            ;284
0003b8  f88d0000          STRB     r0,[sp,#0]            ;284
0003bc  7930              LDRB     r0,[r6,#4]            ;285
0003be  f88d0001          STRB     r0,[sp,#1]            ;285
0003c2  7830              LDRB     r0,[r6,#0]            ;286
0003c4  f88d0002          STRB     r0,[sp,#2]            ;286
0003c8  f88d7003          STRB     r7,[sp,#3]            ;287
0003cc  4669              MOV      r1,sp                 ;288
0003ce  f105000c          ADD      r0,r5,#0xc            ;288
0003d2  f7fffffe          BL       lc640_write_long_ptr
0003d6  f88d4000          STRB     r4,[sp,#0]            ;290
0003da  f88d4001          STRB     r4,[sp,#1]            ;291
0003de  f88d4002          STRB     r4,[sp,#2]            ;292
0003e2  f88d4003          STRB     r4,[sp,#3]            ;293
0003e6  4669              MOV      r1,sp                 ;294
0003e8  f1050010          ADD      r0,r5,#0x10           ;294
0003ec  f7fffffe          BL       lc640_write_long_ptr
0003f0  f88d4000          STRB     r4,[sp,#0]            ;296
0003f4  f88d4001          STRB     r4,[sp,#1]            ;297
0003f8  e01c              B        |L1.1076|
                  |L1.1018|
0003fa  e045              B        |L1.1160|
                  |L1.1020|
0003fc  e0d5              B        |L1.1450|
0003fe  0000              DCW      0x0000
                  |L1.1024|
                          DCD      net_av
                  |L1.1028|
                          DCD      ||.data||
                  |L1.1032|
                          DCD      bat
                  |L1.1036|
                          DCD      bps
                  |L1.1040|
                          DCD      sk_av_stat
                  |L1.1044|
                          DCD      SK_ZVUK_EN
                  |L1.1048|
                          DCD      AV_OFF_AVT
                  |L1.1052|
                          DCD      0xeffffffe
                  |L1.1056|
                          DCD      status_izm_r
                  |L1.1060|
                          DCD      sk_alarm
                  |L1.1064|
                          DCD      0x40024020
                  |L1.1068|
                          DCD      0x400fc000
                  |L1.1072|
                          DCD      net_av_2min_timer
                  |L1.1076|
000434  f88d4002          STRB     r4,[sp,#2]            ;298
000438  f88d4003          STRB     r4,[sp,#3]            ;299
00043c  4669              MOV      r1,sp                 ;300
00043e  f1050014          ADD      r0,r5,#0x14           ;300
000442  f7fffffe          BL       lc640_write_long_ptr
000446  f88d4000          STRB     r4,[sp,#0]            ;302
00044a  f88d4001          STRB     r4,[sp,#1]            ;303
00044e  f88d4002          STRB     r4,[sp,#2]            ;304
000452  f88d4003          STRB     r4,[sp,#3]            ;305
000456  4669              MOV      r1,sp                 ;306
000458  f1050018          ADD      r0,r5,#0x18           ;306
00045c  f7fffffe          BL       lc640_write_long_ptr
000460  f88d4000          STRB     r4,[sp,#0]            ;308
000464  f88d4001          STRB     r4,[sp,#1]            ;309
000468  f88d4002          STRB     r4,[sp,#2]            ;310
00046c  f88d4003          STRB     r4,[sp,#3]            ;311
000470  4669              MOV      r1,sp                 ;312
000472  f105001c          ADD      r0,r5,#0x1c           ;312
000476  f7fffffe          BL       lc640_write_long_ptr
00047a  2300              MOVS     r3,#0                 ;325
00047c  2201              MOVS     r2,#1                 ;325
00047e  2102              MOVS     r1,#2                 ;325
000480  a0ff              ADR      r0,|L1.2176|
000482  f7fffffe          BL       snmp_trap_send
000486  e121              B        |L1.1740|
                  |L1.1160|
000488  f04f0002          MOV      r0,#2                 ;330
00048c  7008              STRB     r0,[r1,#0]            ;330
00048e  f44f6060          MOV      r0,#0xe00             ;338
000492  f7fffffe          BL       lc640_read_int
000496  f1000001          ADD      r0,r0,#1              ;339
00049a  4605              MOV      r5,r0                 ;339
00049c  2d3f              CMP      r5,#0x3f              ;340
00049e  d901              BLS      |L1.1188|
0004a0  f04f0500          MOV      r5,#0                 ;340
                  |L1.1188|
0004a4  b229              SXTH     r1,r5                 ;341
0004a6  f44f6060          MOV      r0,#0xe00             ;341
0004aa  f7fffffe          BL       lc640_write_int
0004ae  4658              MOV      r0,r11                ;343
0004b0  f7fffffe          BL       lc640_read_int
0004b4  283f              CMP      r0,#0x3f              ;344
0004b6  d000              BEQ      |L1.1210|
0004b8  4628              MOV      r0,r5                 ;344
                  |L1.1210|
0004ba  b201              SXTH     r1,r0                 ;345
0004bc  4658              MOV      r0,r11                ;345
0004be  f7fffffe          BL       lc640_write_int
0004c2  f44f6060          MOV      r0,#0xe00             ;347
0004c6  f7fffffe          BL       lc640_read_int
0004ca  eb081540          ADD      r5,r8,r0,LSL #5       ;347
0004ce  f88da000          STRB     r10,[sp,#0]           ;349
0004d2  f88d7001          STRB     r7,[sp,#1]            ;350
0004d6  f88d9002          STRB     r9,[sp,#2]            ;351
0004da  f88d7003          STRB     r7,[sp,#3]            ;352
0004de  4669              MOV      r1,sp                 ;353
0004e0  4628              MOV      r0,r5                 ;353
0004e2  f7fffffe          BL       lc640_write_long_ptr
0004e6  9700              STR      r7,[sp,#0]            ;358
0004e8  4669              MOV      r1,sp                 ;359
0004ea  1d28              ADDS     r0,r5,#4              ;359
0004ec  f7fffffe          BL       lc640_write_long_ptr
0004f0  f1060620          ADD      r6,r6,#0x20           ;361
0004f4  8bb0              LDRH     r0,[r6,#0x1c]         ;361
0004f6  f88d0000          STRB     r0,[sp,#0]            ;361
0004fa  7e30              LDRB     r0,[r6,#0x18]         ;362
0004fc  f88d0001          STRB     r0,[sp,#1]            ;362
000500  7b30              LDRB     r0,[r6,#0xc]          ;363
000502  f88d0002          STRB     r0,[sp,#2]            ;363
000506  f88d7003          STRB     r7,[sp,#3]            ;364
00050a  4669              MOV      r1,sp                 ;365
00050c  f1050008          ADD      r0,r5,#8              ;365
000510  f7fffffe          BL       lc640_write_long_ptr
000514  7a30              LDRB     r0,[r6,#8]            ;367
000516  f88d0000          STRB     r0,[sp,#0]            ;367
00051a  7930              LDRB     r0,[r6,#4]            ;368
00051c  f88d0001          STRB     r0,[sp,#1]            ;368
000520  7830              LDRB     r0,[r6,#0]            ;369
000522  f88d0002          STRB     r0,[sp,#2]            ;369
000526  f88d7003          STRB     r7,[sp,#3]            ;370
00052a  4669              MOV      r1,sp                 ;371
00052c  f105000c          ADD      r0,r5,#0xc            ;371
000530  f7fffffe          BL       lc640_write_long_ptr
000534  f88d4000          STRB     r4,[sp,#0]            ;373
000538  f88d4001          STRB     r4,[sp,#1]            ;374
00053c  f88d4002          STRB     r4,[sp,#2]            ;375
000540  f88d4003          STRB     r4,[sp,#3]            ;376
000544  4669              MOV      r1,sp                 ;377
000546  f1050010          ADD      r0,r5,#0x10           ;377
00054a  f7fffffe          BL       lc640_write_long_ptr
00054e  f88d4000          STRB     r4,[sp,#0]            ;379
000552  f88d4001          STRB     r4,[sp,#1]            ;380
000556  f88d4002          STRB     r4,[sp,#2]            ;381
00055a  f88d4003          STRB     r4,[sp,#3]            ;382
00055e  4669              MOV      r1,sp                 ;383
000560  f1050014          ADD      r0,r5,#0x14           ;383
000564  f7fffffe          BL       lc640_write_long_ptr
000568  f88d4000          STRB     r4,[sp,#0]            ;385
00056c  f88d4001          STRB     r4,[sp,#1]            ;386
000570  f88d4002          STRB     r4,[sp,#2]            ;387
000574  f88d4003          STRB     r4,[sp,#3]            ;388
000578  4669              MOV      r1,sp                 ;389
00057a  f1050018          ADD      r0,r5,#0x18           ;389
00057e  f7fffffe          BL       lc640_write_long_ptr
000582  f88d4000          STRB     r4,[sp,#0]            ;391
000586  f88d4001          STRB     r4,[sp,#1]            ;392
00058a  f88d4002          STRB     r4,[sp,#2]            ;393
00058e  f88d4003          STRB     r4,[sp,#3]            ;394
000592  4669              MOV      r1,sp                 ;395
000594  f105001c          ADD      r0,r5,#0x1c           ;395
000598  f7fffffe          BL       lc640_write_long_ptr
00059c  2202              MOVS     r2,#2                 ;397
00059e  2300              MOVS     r3,#0                 ;397
0005a0  4611              MOV      r1,r2                 ;397
0005a2  a0c0              ADR      r0,|L1.2212|
0005a4  f7fffffe          BL       snmp_trap_send
0005a8  e090              B        |L1.1740|
                  |L1.1450|
;;;401    	{
;;;402    	net_av=0;
0005aa  700f              STRB     r7,[r1,#0]
;;;403    
;;;404      /*
;;;405    	SET_REG(C2GSR,3,24,8);
;;;406    	C2MOD=0;
;;;407    	bOUT_FREE2=1;*/
;;;408    
;;;409    
;;;410    	//C2MOD=0;
;;;411    
;;;412    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;413    
;;;414         //beep_init(0x02L,'O');
;;;415    	//a_.av.bAN=0;
;;;416    	SET_REG(avar_stat,0,0,1);
0005ac  48c6              LDR      r0,|L1.2248|
0005ae  6801              LDR      r1,[r0,#0]  ; avar_stat
0005b0  f0210101          BIC      r1,r1,#1
0005b4  6001              STR      r1,[r0,#0]  ; avar_stat
;;;417    
;;;418    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;419    	
;;;420    	if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
0005b6  49c5              LDR      r1,|L1.2252|
0005b8  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
0005ba  b119              CBZ      r1,|L1.1476|
0005bc  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
0005be  f0210101          BIC      r1,r1,#1
0005c2  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.1476|
;;;421    
;;;422         event_ptr=lc640_read_int(PTR_EVENT_LOG);
0005c4  4628              MOV      r0,r5
0005c6  f7fffffe          BL       lc640_read_int
0005ca  4682              MOV      r10,r0
;;;423    	event_ptr_find=event_ptr;
0005cc  4654              MOV      r4,r10
                  |L1.1486|
;;;424    avar_unet_hndl_lbl1:
;;;425    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0005ce  eb081544          ADD      r5,r8,r4,LSL #5
;;;426    
;;;427         lc640_read_long_ptr(lc640_adr,data);
0005d2  4669              MOV      r1,sp
0005d4  4628              MOV      r0,r5
0005d6  f7fffffe          BL       lc640_read_long_ptr
;;;428         
;;;429         if(!((data[0]=='P')&&(data[1]==0)&&((data[2]=='A')||(data[2]=='B'))))
0005da  f89d0000          LDRB     r0,[sp,#0]
0005de  2850              CMP      r0,#0x50
0005e0  d108              BNE      |L1.1524|
0005e2  f89d0001          LDRB     r0,[sp,#1]
0005e6  b928              CBNZ     r0,|L1.1524|
0005e8  f89d0002          LDRB     r0,[sp,#2]
0005ec  2841              CMP      r0,#0x41
0005ee  d00a              BEQ      |L1.1542|
0005f0  2842              CMP      r0,#0x42
0005f2  d008              BEQ      |L1.1542|
                  |L1.1524|
;;;430         	{        
;;;431         	if(event_ptr_find)event_ptr_find--;
0005f4  b114              CBZ      r4,|L1.1532|
0005f6  f1a40401          SUB      r4,r4,#1
0005fa  e001              B        |L1.1536|
                  |L1.1532|
;;;432         	else event_ptr_find=63;
0005fc  f04f043f          MOV      r4,#0x3f
                  |L1.1536|
;;;433         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000600  4554              CMP      r4,r10
000602  d1e4              BNE      |L1.1486|
000604  e062              B        |L1.1740|
                  |L1.1542|
;;;434         	else goto avar_unet_hndl_lbl1;
;;;435         	}
;;;436         else 
;;;437         	{
;;;438         	lc640_read_long_ptr(lc640_adr+16,data);
000606  4669              MOV      r1,sp
000608  f1050010          ADD      r0,r5,#0x10
00060c  f7fffffe          BL       lc640_read_long_ptr
;;;439         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000610  f89d0000          LDRB     r0,[sp,#0]
000614  2841              CMP      r0,#0x41
000616  d10b              BNE      |L1.1584|
000618  f89d0001          LDRB     r0,[sp,#1]
00061c  2841              CMP      r0,#0x41
00061e  d107              BNE      |L1.1584|
000620  f89d0002          LDRB     r0,[sp,#2]
000624  2841              CMP      r0,#0x41
000626  d103              BNE      |L1.1584|
000628  f89d0003          LDRB     r0,[sp,#3]
00062c  2841              CMP      r0,#0x41
00062e  d008              BEQ      |L1.1602|
                  |L1.1584|
;;;440         		{        
;;;441         		if(event_ptr_find)event_ptr_find--;
000630  b114              CBZ      r4,|L1.1592|
000632  f1a40401          SUB      r4,r4,#1
000636  e001              B        |L1.1596|
                  |L1.1592|
;;;442             		else event_ptr_find=63;
000638  f04f043f          MOV      r4,#0x3f
                  |L1.1596|
;;;443             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
00063c  4554              CMP      r4,r10
00063e  d1c6              BNE      |L1.1486|
000640  e044              B        |L1.1740|
                  |L1.1602|
;;;444         		else goto avar_unet_hndl_lbl1;
;;;445         		}
;;;446    
;;;447         	}	
;;;448    	
;;;449    	data[0]=LPC_RTC->YEAR;
000642  f1060620          ADD      r6,r6,#0x20
000646  8bb0              LDRH     r0,[r6,#0x1c]
000648  f88d0000          STRB     r0,[sp,#0]
;;;450    	data[1]=LPC_RTC->MONTH;
00064c  7e30              LDRB     r0,[r6,#0x18]
00064e  f88d0001          STRB     r0,[sp,#1]
;;;451    	data[2]=LPC_RTC->DOM;
000652  7b30              LDRB     r0,[r6,#0xc]
000654  f88d0002          STRB     r0,[sp,#2]
;;;452    	data[3]=0;
000658  f88d7003          STRB     r7,[sp,#3]
;;;453    	lc640_write_long_ptr(lc640_adr+16,data);
00065c  4669              MOV      r1,sp
00065e  f1050010          ADD      r0,r5,#0x10
000662  f7fffffe          BL       lc640_write_long_ptr
;;;454    
;;;455    	data[0]=LPC_RTC->HOUR;
000666  7a30              LDRB     r0,[r6,#8]
000668  f88d0000          STRB     r0,[sp,#0]
;;;456    	data[1]=LPC_RTC->MIN;
00066c  7930              LDRB     r0,[r6,#4]
00066e  f88d0001          STRB     r0,[sp,#1]
;;;457    	data[2]=LPC_RTC->SEC;
000672  7830              LDRB     r0,[r6,#0]
000674  f88d0002          STRB     r0,[sp,#2]
;;;458    	data[3]=0;
000678  f88d7003          STRB     r7,[sp,#3]
;;;459    	lc640_write_long_ptr(lc640_adr+20,data); 
00067c  4669              MOV      r1,sp
00067e  f1050014          ADD      r0,r5,#0x14
000682  f7fffffe          BL       lc640_write_long_ptr
;;;460    	
;;;461    	data[0]=*((char*)(&net_Ustore));
000686  4892              LDR      r0,|L1.2256|
000688  7801              LDRB     r1,[r0,#0]  ; net_Ustore
00068a  f88d1000          STRB     r1,[sp,#0]
;;;462    	data[1]=*(((char*)(&net_Ustore))+1);
00068e  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000690  f88d0001          STRB     r0,[sp,#1]
;;;463    	data[2]='B';
000694  f88d9002          STRB     r9,[sp,#2]
;;;464    	data[3]='B';
000698  f88d9003          STRB     r9,[sp,#3]
;;;465    	lc640_write_long_ptr(lc640_adr+24,data);
00069c  4669              MOV      r1,sp
00069e  f1050018          ADD      r0,r5,#0x18
0006a2  f7fffffe          BL       lc640_write_long_ptr
;;;466    	
;;;467    	data[0]='B';
0006a6  f88d9000          STRB     r9,[sp,#0]
;;;468    	data[1]='B';
0006aa  f88d9001          STRB     r9,[sp,#1]
;;;469    	data[2]='B';
0006ae  f88d9002          STRB     r9,[sp,#2]
;;;470    	data[3]='B';
0006b2  f88d9003          STRB     r9,[sp,#3]
;;;471    	lc640_write_long_ptr(lc640_adr+28,data);	
0006b6  4669              MOV      r1,sp
0006b8  f105001c          ADD      r0,r5,#0x1c
0006bc  f7fffffe          BL       lc640_write_long_ptr
;;;472    	
;;;473    /*	memo_out0[0]=0x55;
;;;474         memo_out0[1]=0x00+2;
;;;475         memo_out0[2]=1;
;;;476         memo_out0[3]=0x0b;
;;;477         memo_out0[4]=0xaa;
;;;478         memo_out0[5]=0xaa; 
;;;479         	
;;;480         memo_out0[6]=crc_87(memo_out0,6);
;;;481    	memo_out0[7]=crc_95(memo_out0,6);
;;;482         usart_out_adr0(memo_out0,8); */
;;;483         snmp_trap_send("Main power alarm  clear",2,1,1);	
0006c0  2301              MOVS     r3,#1
0006c2  461a              MOV      r2,r3
0006c4  2102              MOVS     r1,#2
0006c6  a083              ADR      r0,|L1.2260|
0006c8  f7fffffe          BL       snmp_trap_send
                  |L1.1740|
;;;484    	}
;;;485    avar_unet_hndl_end:
;;;486    	__nop();		
0006cc  bf00              NOP      
                  |L1.1742|
;;;487    }
0006ce  e8bd8ff8          POP      {r3-r11,pc}
;;;488    
                          ENDP

                  avar_uout_hndl PROC
;;;490    //-----------------------------------------------
;;;491    void avar_uout_hndl(char in)
0006d2  e92d4ff8          PUSH     {r3-r11,lr}
;;;492    {
;;;493    
;;;494    char data[4];
;;;495    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;496    char avar_data=0;
;;;497    
;;;498    if(in==1)
;;;499    	{
;;;500    	//net_av=1;
;;;501    
;;;502    	//beep_init(0x01L,'O');
;;;503    	//a.av.bAN=1;
;;;504    
;;;505    
;;;506    	//beep_init(0x33333333,'A');
;;;507    
;;;508    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;509    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;510    	
;;;511    	avar_data=uout_av;
;;;512    		 
;;;513    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;514    	event_ptr++;	
;;;515    	if(event_ptr>63)event_ptr=0;	
;;;516    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;517    	
;;;518        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;519    	if(event_cnt!=63)event_cnt=event_ptr;
;;;520    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;521    	
;;;522    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;523    	
;;;524    	data[0]='Q';
;;;525    	data[1]=0;
;;;526    	data[2]='A';
;;;527    	data[3]=avar_data;
;;;528    	lc640_write_long_ptr(lc640_adr,data);
;;;529    
;;;530    	 //load_U=4321;
;;;531    
;;;532    	data[0]=*((char*)&load_U);
;;;533    	data[1]=*(((char*)&load_U)+1);
;;;534    	data[2]=0;
;;;535    	data[3]=0;
;;;536    	lc640_write_long_ptr(lc640_adr+4,data);
;;;537    
;;;538    	data[0]=LPC_RTC->YEAR;
0006d6  4f85              LDR      r7,|L1.2284|
0006d8  4985              LDR      r1,|L1.2288|
0006da  f44f6560          MOV      r5,#0xe00             ;513
0006de  f04f0800          MOV      r8,#0                 ;496
0006e2  f44f6980          MOV      r9,#0x400             ;522
0006e6  2801              CMP      r0,#1                 ;498
0006e8  d002              BEQ      |L1.1776|
;;;539    	data[1]=LPC_RTC->MONTH;
;;;540    	data[2]=LPC_RTC->DOM;
;;;541    	data[3]=0;
;;;542    	lc640_write_long_ptr(lc640_adr+8,data);
;;;543    
;;;544    	data[0]=LPC_RTC->HOUR;
;;;545    	data[1]=LPC_RTC->MIN;
;;;546    	data[2]=LPC_RTC->SEC;
;;;547    	data[3]=0;
;;;548    	lc640_write_long_ptr(lc640_adr+12,data);
;;;549    	
;;;550    	data[0]='A';
;;;551    	data[1]='A';
;;;552    	data[2]='A';
;;;553    	data[3]='A';
;;;554    	lc640_write_long_ptr(lc640_adr+16,data);
;;;555    	
;;;556    	data[0]='A';
;;;557    	data[1]='A';
;;;558    	data[2]='A';
;;;559    	data[3]='A';
;;;560    	lc640_write_long_ptr(lc640_adr+20,data);
;;;561    	
;;;562    	data[0]='A';
;;;563    	data[1]='A';
;;;564    	data[2]='A';
;;;565    	data[3]='A';
;;;566    	lc640_write_long_ptr(lc640_adr+24,data);
;;;567    	
;;;568    	data[0]='A';
;;;569    	data[1]='A';
;;;570    	data[2]='A';
;;;571    	data[3]='A';
;;;572    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;573    	
;;;574    /*	memo_out0[0]=0x55;
;;;575         memo_out0[1]=0x00+2;
;;;576         memo_out0[2]=1;
;;;577         memo_out0[3]=0x0b;
;;;578         memo_out0[4]=0x55;
;;;579         memo_out0[5]=0x55; 
;;;580         	
;;;581         memo_out0[6]=crc_87(memo_out0,6);
;;;582    	memo_out0[7]=crc_95(memo_out0,6);
;;;583         usart_out_adr0(memo_out0,8); 
;;;584    	*/
;;;585    	//snmp_trap_send("Main power is off",2,1,0);
;;;586    	}
;;;587    
;;;588    else if(in==0)
0006ea  2800              CMP      r0,#0
0006ec  d07d              BEQ      |L1.2026|
0006ee  e174              B        |L1.2522|
                  |L1.1776|
0006f0  f8dfa200          LDR      r10,|L1.2292|
0006f4  4a80              LDR      r2,|L1.2296|
0006f6  f9ba0000          LDRSH    r0,[r10,#0]           ;508  ; load_U
0006fa  f9b22000          LDRSH    r2,[r2,#0]            ;508  ; U_OUT_KONTR_MAX
0006fe  4290              CMP      r0,r2                 ;508
000700  dd02              BLE      |L1.1800|
000702  f04f0201          MOV      r2,#1                 ;508
000706  700a              STRB     r2,[r1,#0]            ;508
                  |L1.1800|
000708  4a7c              LDR      r2,|L1.2300|
00070a  f9b22000          LDRSH    r2,[r2,#0]            ;509  ; U_OUT_KONTR_MIN
00070e  4290              CMP      r0,r2                 ;509
000710  da02              BGE      |L1.1816|
000712  f04f0002          MOV      r0,#2                 ;509
000716  7008              STRB     r0,[r1,#0]            ;509
                  |L1.1816|
000718  780e              LDRB     r6,[r1,#0]            ;511  ; uout_av
00071a  4628              MOV      r0,r5                 ;513
00071c  f7fffffe          BL       lc640_read_int
000720  f1000001          ADD      r0,r0,#1              ;514
000724  4604              MOV      r4,r0                 ;514
000726  2c3f              CMP      r4,#0x3f              ;515
000728  d901              BLS      |L1.1838|
00072a  f04f0400          MOV      r4,#0                 ;515
                  |L1.1838|
00072e  b221              SXTH     r1,r4                 ;516
000730  4628              MOV      r0,r5                 ;516
000732  f7fffffe          BL       lc640_write_int
000736  f6406b02          MOV      r11,#0xe02            ;518
00073a  4658              MOV      r0,r11                ;518
00073c  f7fffffe          BL       lc640_read_int
000740  283f              CMP      r0,#0x3f              ;519
000742  d000              BEQ      |L1.1862|
000744  4620              MOV      r0,r4                 ;519
                  |L1.1862|
000746  b201              SXTH     r1,r0                 ;520
000748  4658              MOV      r0,r11                ;520
00074a  f7fffffe          BL       lc640_write_int
00074e  4628              MOV      r0,r5                 ;522
000750  f7fffffe          BL       lc640_read_int
000754  eb091540          ADD      r5,r9,r0,LSL #5       ;522
000758  f04f0051          MOV      r0,#0x51              ;524
00075c  f88d0000          STRB     r0,[sp,#0]            ;524
000760  f88d8001          STRB     r8,[sp,#1]            ;525
000764  f04f0441          MOV      r4,#0x41              ;526
000768  f88d4002          STRB     r4,[sp,#2]            ;526
00076c  f88d6003          STRB     r6,[sp,#3]            ;527
000770  4669              MOV      r1,sp                 ;528
000772  4628              MOV      r0,r5                 ;528
000774  f7fffffe          BL       lc640_write_long_ptr
000778  f89a0000          LDRB     r0,[r10,#0]           ;532  ; load_U
00077c  f88d0000          STRB     r0,[sp,#0]            ;532
000780  f89a0001          LDRB     r0,[r10,#1]           ;533  ; load_U
000784  f88d0001          STRB     r0,[sp,#1]            ;533
000788  f88d8002          STRB     r8,[sp,#2]            ;534
00078c  f88d8003          STRB     r8,[sp,#3]            ;535
000790  4669              MOV      r1,sp                 ;536
000792  1d28              ADDS     r0,r5,#4              ;536
000794  f7fffffe          BL       lc640_write_long_ptr
000798  f1070720          ADD      r7,r7,#0x20           ;538
00079c  8bb8              LDRH     r0,[r7,#0x1c]         ;538
00079e  f88d0000          STRB     r0,[sp,#0]            ;538
0007a2  7e38              LDRB     r0,[r7,#0x18]         ;539
0007a4  f88d0001          STRB     r0,[sp,#1]            ;539
0007a8  7b38              LDRB     r0,[r7,#0xc]          ;540
0007aa  f88d0002          STRB     r0,[sp,#2]            ;540
0007ae  f88d8003          STRB     r8,[sp,#3]            ;541
0007b2  4669              MOV      r1,sp                 ;542
0007b4  f1050008          ADD      r0,r5,#8              ;542
0007b8  f7fffffe          BL       lc640_write_long_ptr
0007bc  7a38              LDRB     r0,[r7,#8]            ;544
0007be  f88d0000          STRB     r0,[sp,#0]            ;544
0007c2  7938              LDRB     r0,[r7,#4]            ;545
0007c4  f88d0001          STRB     r0,[sp,#1]            ;545
0007c8  7838              LDRB     r0,[r7,#0]            ;546
0007ca  f88d0002          STRB     r0,[sp,#2]            ;546
0007ce  f88d8003          STRB     r8,[sp,#3]            ;547
0007d2  4669              MOV      r1,sp                 ;548
0007d4  f105000c          ADD      r0,r5,#0xc            ;548
0007d8  f7fffffe          BL       lc640_write_long_ptr
0007dc  f88d4000          STRB     r4,[sp,#0]            ;550
0007e0  f88d4001          STRB     r4,[sp,#1]            ;551
0007e4  f88d4002          STRB     r4,[sp,#2]            ;552
0007e8  e000              B        |L1.2028|
                  |L1.2026|
0007ea  e02e              B        |L1.2122|
                  |L1.2028|
0007ec  f88d4003          STRB     r4,[sp,#3]            ;553
0007f0  4669              MOV      r1,sp                 ;554
0007f2  f1050010          ADD      r0,r5,#0x10           ;554
0007f6  f7fffffe          BL       lc640_write_long_ptr
0007fa  f88d4000          STRB     r4,[sp,#0]            ;556
0007fe  f88d4001          STRB     r4,[sp,#1]            ;557
000802  f88d4002          STRB     r4,[sp,#2]            ;558
000806  f88d4003          STRB     r4,[sp,#3]            ;559
00080a  4669              MOV      r1,sp                 ;560
00080c  f1050014          ADD      r0,r5,#0x14           ;560
000810  f7fffffe          BL       lc640_write_long_ptr
000814  f88d4000          STRB     r4,[sp,#0]            ;562
000818  f88d4001          STRB     r4,[sp,#1]            ;563
00081c  f88d4002          STRB     r4,[sp,#2]            ;564
000820  f88d4003          STRB     r4,[sp,#3]            ;565
000824  4669              MOV      r1,sp                 ;566
000826  f1050018          ADD      r0,r5,#0x18           ;566
00082a  f7fffffe          BL       lc640_write_long_ptr
00082e  f88d4000          STRB     r4,[sp,#0]            ;568
000832  f88d4001          STRB     r4,[sp,#1]            ;569
000836  f88d4002          STRB     r4,[sp,#2]            ;570
00083a  f88d4003          STRB     r4,[sp,#3]            ;571
00083e  4669              MOV      r1,sp                 ;572
000840  f105001c          ADD      r0,r5,#0x1c           ;572
000844  f7fffffe          BL       lc640_write_long_ptr
000848  e0c7              B        |L1.2522|
                  |L1.2122|
;;;589    	{
;;;590    	uout_av=0;
00084a  f8818000          STRB     r8,[r1,#0]
;;;591    
;;;592      /*
;;;593    	SET_REG(C2GSR,3,24,8);
;;;594    	C2MOD=0;
;;;595    	bOUT_FREE2=1;*/
;;;596    
;;;597    
;;;598    	//C2MOD=0;
;;;599    
;;;600    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;601    
;;;602         //beep_init(0x02L,'O');
;;;603    	//a_.av.bAN=0;
;;;604    //	SET_REG(avar_stat,0,0,1);
;;;605    
;;;606    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;607    	
;;;608    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;609    
;;;610        event_ptr=lc640_read_int(PTR_EVENT_LOG);
00084e  4628              MOV      r0,r5
000850  f7fffffe          BL       lc640_read_int
000854  4606              MOV      r6,r0
;;;611    	event_ptr_find=event_ptr;
000856  4634              MOV      r4,r6
                  |L1.2136|
;;;612    avar_uout_hndl_lbl1:
;;;613    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000858  eb091544          ADD      r5,r9,r4,LSL #5
;;;614    
;;;615         lc640_read_long_ptr(lc640_adr,data);
00085c  4669              MOV      r1,sp
00085e  4628              MOV      r0,r5
000860  f7fffffe          BL       lc640_read_long_ptr
;;;616         
;;;617         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
000864  f89d0000          LDRB     r0,[sp,#0]
000868  2851              CMP      r0,#0x51
00086a  d106              BNE      |L1.2170|
00086c  f89d0001          LDRB     r0,[sp,#1]
000870  b918              CBNZ     r0,|L1.2170|
000872  f89d0002          LDRB     r0,[sp,#2]
000876  2841              CMP      r0,#0x41
000878  d04a              BEQ      |L1.2320|
                  |L1.2170|
;;;618         	{        
;;;619         	if(event_ptr_find)event_ptr_find--;
00087a  b104              CBZ      r4,|L1.2174|
00087c  e040              B        |L1.2304|
                  |L1.2174|
00087e  e042              B        |L1.2310|
                  |L1.2176|
000880  4d61696e          DCB      "Main power alarm, voltage reduced",0
000884  20706f77
000888  65722061
00088c  6c61726d
000890  2c20766f
000894  6c746167
000898  65207265
00089c  64756365
0008a0  6400    
0008a2  00                DCB      0
0008a3  00                DCB      0
                  |L1.2212|
0008a4  4d61696e          DCB      "Main power alarm, voltage increased",0
0008a8  20706f77
0008ac  65722061
0008b0  6c61726d
0008b4  2c20766f
0008b8  6c746167
0008bc  6520696e
0008c0  63726561
0008c4  73656400
                  |L1.2248|
                          DCD      ||.data||
                  |L1.2252|
                          DCD      AV_OFF_AVT
                  |L1.2256|
                          DCD      net_Ustore
                  |L1.2260|
0008d4  4d61696e          DCB      "Main power alarm  clear",0
0008d8  20706f77
0008dc  65722061
0008e0  6c61726d
0008e4  2020636c
0008e8  65617200
                  |L1.2284|
                          DCD      0x40024000
                  |L1.2288|
                          DCD      uout_av
                  |L1.2292|
                          DCD      load_U
                  |L1.2296|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2300|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2304|
000900  f1a40401          SUB      r4,r4,#1
000904  e001              B        |L1.2314|
                  |L1.2310|
;;;620         	else event_ptr_find=63;
000906  f04f043f          MOV      r4,#0x3f
                  |L1.2314|
;;;621         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
00090a  42b4              CMP      r4,r6
00090c  d1a4              BNE      |L1.2136|
00090e  e064              B        |L1.2522|
                  |L1.2320|
;;;622         	else goto avar_uout_hndl_lbl1;
;;;623         	}
;;;624         else 
;;;625         	{
;;;626         	lc640_read_long_ptr(lc640_adr+16,data);
000910  4669              MOV      r1,sp
000912  f1050010          ADD      r0,r5,#0x10
000916  f7fffffe          BL       lc640_read_long_ptr
;;;627         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00091a  f89d0000          LDRB     r0,[sp,#0]
00091e  2841              CMP      r0,#0x41
000920  d10b              BNE      |L1.2362|
000922  f89d0001          LDRB     r0,[sp,#1]
000926  2841              CMP      r0,#0x41
000928  d107              BNE      |L1.2362|
00092a  f89d0002          LDRB     r0,[sp,#2]
00092e  2841              CMP      r0,#0x41
000930  d103              BNE      |L1.2362|
000932  f89d0003          LDRB     r0,[sp,#3]
000936  2841              CMP      r0,#0x41
000938  d008              BEQ      |L1.2380|
                  |L1.2362|
;;;628         		{        
;;;629         		if(event_ptr_find)event_ptr_find--;
00093a  b114              CBZ      r4,|L1.2370|
00093c  f1a40401          SUB      r4,r4,#1
000940  e001              B        |L1.2374|
                  |L1.2370|
;;;630             		else event_ptr_find=63;
000942  f04f043f          MOV      r4,#0x3f
                  |L1.2374|
;;;631             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000946  42b4              CMP      r4,r6
000948  d186              BNE      |L1.2136|
00094a  e046              B        |L1.2522|
                  |L1.2380|
;;;632         		else goto avar_uout_hndl_lbl1;
;;;633         		}
;;;634    
;;;635         	}	
;;;636    	
;;;637    	data[0]=LPC_RTC->YEAR;
00094c  f1070720          ADD      r7,r7,#0x20
000950  8bb8              LDRH     r0,[r7,#0x1c]
000952  f88d0000          STRB     r0,[sp,#0]
;;;638    	data[1]=LPC_RTC->MONTH;
000956  7e38              LDRB     r0,[r7,#0x18]
000958  f88d0001          STRB     r0,[sp,#1]
;;;639    	data[2]=LPC_RTC->DOM;
00095c  7b38              LDRB     r0,[r7,#0xc]
00095e  f88d0002          STRB     r0,[sp,#2]
;;;640    	data[3]=0;
000962  f88d8003          STRB     r8,[sp,#3]
;;;641    	lc640_write_long_ptr(lc640_adr+16,data);
000966  4669              MOV      r1,sp
000968  f1050010          ADD      r0,r5,#0x10
00096c  f7fffffe          BL       lc640_write_long_ptr
;;;642    
;;;643    	data[0]=LPC_RTC->HOUR;
000970  7a38              LDRB     r0,[r7,#8]
000972  f88d0000          STRB     r0,[sp,#0]
;;;644    	data[1]=LPC_RTC->MIN;
000976  7938              LDRB     r0,[r7,#4]
000978  f88d0001          STRB     r0,[sp,#1]
;;;645    	data[2]=LPC_RTC->SEC;
00097c  7838              LDRB     r0,[r7,#0]
00097e  f88d0002          STRB     r0,[sp,#2]
;;;646    	data[3]=0;
000982  f88d8003          STRB     r8,[sp,#3]
;;;647    	lc640_write_long_ptr(lc640_adr+20,data); 
000986  4669              MOV      r1,sp
000988  f1050014          ADD      r0,r5,#0x14
00098c  f7fffffe          BL       lc640_write_long_ptr
;;;648    	
;;;649    	data[0]=*((char*)(&net_Ustore));
000990  48ff              LDR      r0,|L1.3472|
000992  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000994  f88d1000          STRB     r1,[sp,#0]
;;;650    	data[1]=*(((char*)(&net_Ustore))+1);
000998  7840              LDRB     r0,[r0,#1]  ; net_Ustore
00099a  f88d0001          STRB     r0,[sp,#1]
;;;651    	data[2]='B';
00099e  f04f0442          MOV      r4,#0x42
0009a2  f88d4002          STRB     r4,[sp,#2]
;;;652    	data[3]='B';
0009a6  f88d4003          STRB     r4,[sp,#3]
;;;653    	lc640_write_long_ptr(lc640_adr+24,data);
0009aa  4669              MOV      r1,sp
0009ac  f1050018          ADD      r0,r5,#0x18
0009b0  f7fffffe          BL       lc640_write_long_ptr
;;;654    	
;;;655    	data[0]='B';
0009b4  f88d4000          STRB     r4,[sp,#0]
;;;656    	data[1]='B';
0009b8  f88d4001          STRB     r4,[sp,#1]
;;;657    	data[2]='B';
0009bc  f88d4002          STRB     r4,[sp,#2]
;;;658    	data[3]='B';
0009c0  f88d4003          STRB     r4,[sp,#3]
;;;659    	lc640_write_long_ptr(lc640_adr+28,data);	
0009c4  4669              MOV      r1,sp
0009c6  f105001c          ADD      r0,r5,#0x1c
0009ca  f7fffffe          BL       lc640_write_long_ptr
;;;660    	
;;;661    /*	memo_out0[0]=0x55;
;;;662         memo_out0[1]=0x00+2;
;;;663         memo_out0[2]=1;
;;;664         memo_out0[3]=0x0b;
;;;665         memo_out0[4]=0xaa;
;;;666         memo_out0[5]=0xaa; 
;;;667         	
;;;668         memo_out0[6]=crc_87(memo_out0,6);
;;;669    	memo_out0[7]=crc_95(memo_out0,6);
;;;670         usart_out_adr0(memo_out0,8); */
;;;671         snmp_trap_send("Main power is on",2,1,1);	
0009ce  2301              MOVS     r3,#1
0009d0  461a              MOV      r2,r3
0009d2  2102              MOVS     r1,#2
0009d4  a0ef              ADR      r0,|L1.3476|
0009d6  f7fffffe          BL       snmp_trap_send
                  |L1.2522|
;;;672    	}
;;;673    avar_unet_hndl_end:
;;;674    	__nop();		
0009da  bf00              NOP      
                  |L1.2524|
;;;675    }
0009dc  e677              B        |L1.1742|
;;;676    
                          ENDP

                  avar_bps_hndl PROC
;;;677    //-----------------------------------------------
;;;678    void avar_bps_hndl(char dev, char v, char in)
0009de  e92d4ff8          PUSH     {r3-r11,lr}
;;;679    {
0009e2  4606              MOV      r6,r0
0009e4  460c              MOV      r4,r1
;;;680    char data[4];
;;;681    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;682    char avar_simbol;
;;;683    
;;;684    avar_simbol='T';
0009e6  f04f0754          MOV      r7,#0x54
;;;685    if(v==0)avar_simbol='T';
0009ea  b174              CBZ      r4,|L1.2570|
;;;686    else if(v==1)avar_simbol='U';
0009ec  2c01              CMP      r4,#1
0009ee  d004              BEQ      |L1.2554|
;;;687    else if(v==2)avar_simbol='u';
0009f0  2c02              CMP      r4,#2
0009f2  d005              BEQ      |L1.2560|
;;;688    else if(v==3)avar_simbol='L';
0009f4  2c03              CMP      r4,#3
0009f6  d006              BEQ      |L1.2566|
0009f8  e007              B        |L1.2570|
                  |L1.2554|
0009fa  f04f0755          MOV      r7,#0x55              ;686
0009fe  e004              B        |L1.2570|
                  |L1.2560|
000a00  f04f0775          MOV      r7,#0x75              ;687
000a04  e001              B        |L1.2570|
                  |L1.2566|
000a06  f04f074c          MOV      r7,#0x4c
                  |L1.2570|
;;;689    
;;;690    if(in==1)
;;;691    	{
;;;692    	//av_src[bps]=1;
;;;693    
;;;694    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;695    //	SET_REG(avar_stat,1,3+dev,1);
;;;696    	
;;;697    	if(v==0)bps[dev]._av|=(1<<0);
000a0a  48e8              LDR      r0,|L1.3500|
000a0c  eb0601c6          ADD      r1,r6,r6,LSL #3
;;;698    	else if(v==1) bps[dev]._av|=(1<<1);
;;;699    	else if(v==2) bps[dev]._av|=(1<<2);
;;;700    	else if(v==3) bps[dev]._av|=(1<<3);
;;;701    
;;;702    	bps[dev]._last_avar=v;
;;;703    
;;;704    	//beep_init(0x33333333,'A');
;;;705    
;;;706    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;707    	event_ptr++;	
;;;708    	if(event_ptr>63)event_ptr=0;	
;;;709    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;710    	
;;;711        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;712    	if(event_cnt!=63)event_cnt=event_ptr;
;;;713    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;714    	
;;;715    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;716    	
;;;717    	data[0]='S';
;;;718    	data[1]=dev; 
;;;719    	data[2]=avar_simbol;
;;;720    	data[3]=0;
;;;721    	lc640_write_long_ptr(lc640_adr,data);
;;;722    
;;;723    	data[0]=0;
;;;724    	data[1]=0;
;;;725    	data[2]=0;
;;;726    	data[3]=0;
;;;727    	lc640_write_long_ptr(lc640_adr+4,data);
;;;728    
;;;729    	data[0]=LPC_RTC->YEAR;
000a10  f8df8394          LDR      r8,|L1.3496|
000a14  eb011106          ADD      r1,r1,r6,LSL #4       ;697
000a18  f04f0900          MOV      r9,#0                 ;679
000a1c  f44f6a60          MOV      r10,#0xe00            ;706
000a20  f44f6580          MOV      r5,#0x400             ;715
000a24  eb000081          ADD      r0,r0,r1,LSL #2       ;697
000a28  2a01              CMP      r2,#1                 ;690
000a2a  d002              BEQ      |L1.2610|
;;;730    	data[1]=LPC_RTC->MONTH;
;;;731    	data[2]=LPC_RTC->DOM;
;;;732    	data[3]=0;
;;;733    	lc640_write_long_ptr(lc640_adr+8,data);
;;;734    
;;;735    	data[0]=LPC_RTC->HOUR;
;;;736    	data[1]=LPC_RTC->MIN;
;;;737    	data[2]=LPC_RTC->SEC;
;;;738    	data[3]=0;
;;;739    	lc640_write_long_ptr(lc640_adr+12,data);
;;;740    	
;;;741    	data[0]='A';
;;;742    	data[1]='A';
;;;743    	data[2]='A';
;;;744    	data[3]='A';
;;;745    	lc640_write_long_ptr(lc640_adr+16,data);
;;;746    	
;;;747    	data[0]='A';
;;;748    	data[1]='A';
;;;749    	data[2]='A';
;;;750    	data[3]='A';
;;;751    	lc640_write_long_ptr(lc640_adr+20,data);
;;;752    	
;;;753    	data[0]='A';
;;;754    	data[1]='A';
;;;755    	data[2]='A';
;;;756    	data[3]='A';
;;;757    	lc640_write_long_ptr(lc640_adr+24,data);
;;;758    	
;;;759    	data[0]='A';
;;;760    	data[1]='A';
;;;761    	data[2]='A';
;;;762    	data[3]='A';
;;;763    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;764    
;;;765    
;;;766    	if(dev==0)
;;;767    		{
;;;768    		if(v==0)
;;;769    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;770    		else if(v==1)
;;;771    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;772    		else if(v==2)
;;;773    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;774    		else if(v==3)
;;;775    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;776    		}
;;;777    	else if(dev==1)
;;;778    		{
;;;779    		if(v==0)
;;;780    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;781    		else if(v==1)
;;;782    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;783    		else if(v==2)
;;;784    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;785    		else if(v==3)
;;;786    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;787    		} 
;;;788    	else if(dev==2)
;;;789    		{
;;;790    		if(v==0)
;;;791    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;792    		else if(v==1)
;;;793    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;794    		else if(v==2)
;;;795    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;796    		else if(v==3)
;;;797    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;798    		} 	
;;;799    			
;;;800    	}
;;;801    
;;;802    else if(in==0)
000a2c  2a00              CMP      r2,#0
000a2e  d07e              BEQ      |L1.2862|
000a30  e284              B        |L1.3900|
                  |L1.2610|
000a32  b134              CBZ      r4,|L1.2626|
000a34  2c01              CMP      r4,#1                 ;698
000a36  d009              BEQ      |L1.2636|
000a38  2c02              CMP      r4,#2                 ;699
000a3a  d00c              BEQ      |L1.2646|
000a3c  2c03              CMP      r4,#3                 ;700
000a3e  d00f              BEQ      |L1.2656|
000a40  e012              B        |L1.2664|
                  |L1.2626|
000a42  7841              LDRB     r1,[r0,#1]            ;697
000a44  f0410101          ORR      r1,r1,#1              ;697
000a48  7041              STRB     r1,[r0,#1]            ;697
000a4a  e00d              B        |L1.2664|
                  |L1.2636|
000a4c  7841              LDRB     r1,[r0,#1]            ;698
000a4e  f0410102          ORR      r1,r1,#2              ;698
000a52  7041              STRB     r1,[r0,#1]            ;698
000a54  e008              B        |L1.2664|
                  |L1.2646|
000a56  7841              LDRB     r1,[r0,#1]            ;699
000a58  f0410104          ORR      r1,r1,#4              ;699
000a5c  7041              STRB     r1,[r0,#1]            ;699
000a5e  e003              B        |L1.2664|
                  |L1.2656|
000a60  7841              LDRB     r1,[r0,#1]            ;700
000a62  f0410108          ORR      r1,r1,#8              ;700
000a66  7041              STRB     r1,[r0,#1]            ;700
                  |L1.2664|
000a68  f8804057          STRB     r4,[r0,#0x57]         ;702
000a6c  4650              MOV      r0,r10                ;706
000a6e  f7fffffe          BL       lc640_read_int
000a72  f1000001          ADD      r0,r0,#1              ;707
000a76  fa1ffb80          UXTH     r11,r0                ;707
000a7a  f1bb0f3f          CMP      r11,#0x3f             ;708
000a7e  d901              BLS      |L1.2692|
000a80  f04f0b00          MOV      r11,#0                ;708
                  |L1.2692|
000a84  fa0ff18b          SXTH     r1,r11                ;709
000a88  4650              MOV      r0,r10                ;709
000a8a  f7fffffe          BL       lc640_write_int
000a8e  f6406002          MOV      r0,#0xe02             ;711
000a92  f7fffffe          BL       lc640_read_int
000a96  b280              UXTH     r0,r0                 ;711
000a98  283f              CMP      r0,#0x3f              ;712
000a9a  d000              BEQ      |L1.2718|
000a9c  4658              MOV      r0,r11                ;712
                  |L1.2718|
000a9e  b201              SXTH     r1,r0                 ;713
000aa0  f6406002          MOV      r0,#0xe02             ;713
000aa4  f7fffffe          BL       lc640_write_int
000aa8  4650              MOV      r0,r10                ;715
000aaa  f7fffffe          BL       lc640_read_int
000aae  eb051040          ADD      r0,r5,r0,LSL #5       ;715
000ab2  b285              UXTH     r5,r0                 ;715
000ab4  f04f0053          MOV      r0,#0x53              ;717
000ab8  f88d0000          STRB     r0,[sp,#0]            ;717
000abc  f88d6001          STRB     r6,[sp,#1]            ;718
000ac0  f88d7002          STRB     r7,[sp,#2]            ;719
000ac4  f88d9003          STRB     r9,[sp,#3]            ;720
000ac8  4669              MOV      r1,sp                 ;721
000aca  4628              MOV      r0,r5                 ;721
000acc  f7fffffe          BL       lc640_write_long_ptr
000ad0  f8cd9000          STR      r9,[sp,#0]            ;726
000ad4  4669              MOV      r1,sp                 ;727
000ad6  1d28              ADDS     r0,r5,#4              ;727
000ad8  f7fffffe          BL       lc640_write_long_ptr
000adc  f8b8003c          LDRH     r0,[r8,#0x3c]         ;729
000ae0  f88d0000          STRB     r0,[sp,#0]            ;729
000ae4  f8980038          LDRB     r0,[r8,#0x38]         ;730
000ae8  f88d0001          STRB     r0,[sp,#1]            ;730
000aec  f898002c          LDRB     r0,[r8,#0x2c]         ;731
000af0  f88d0002          STRB     r0,[sp,#2]            ;731
000af4  f88d9003          STRB     r9,[sp,#3]            ;732
000af8  4669              MOV      r1,sp                 ;733
000afa  f1050008          ADD      r0,r5,#8              ;733
000afe  f7fffffe          BL       lc640_write_long_ptr
000b02  f8980028          LDRB     r0,[r8,#0x28]         ;735
000b06  f88d0000          STRB     r0,[sp,#0]            ;735
000b0a  f8980024          LDRB     r0,[r8,#0x24]         ;736
000b0e  f88d0001          STRB     r0,[sp,#1]            ;736
000b12  f8980020          LDRB     r0,[r8,#0x20]         ;737
000b16  f88d0002          STRB     r0,[sp,#2]            ;737
000b1a  f88d9003          STRB     r9,[sp,#3]            ;738
000b1e  4669              MOV      r1,sp                 ;739
000b20  f105000c          ADD      r0,r5,#0xc            ;739
000b24  f7fffffe          BL       lc640_write_long_ptr
000b28  f04f0741          MOV      r7,#0x41              ;741
000b2c  e000              B        |L1.2864|
                  |L1.2862|
000b2e  e0a5              B        |L1.3196|
                  |L1.2864|
000b30  f88d7000          STRB     r7,[sp,#0]            ;741
000b34  f88d7001          STRB     r7,[sp,#1]            ;742
000b38  f88d7002          STRB     r7,[sp,#2]            ;743
000b3c  f88d7003          STRB     r7,[sp,#3]            ;744
000b40  4669              MOV      r1,sp                 ;745
000b42  f1050010          ADD      r0,r5,#0x10           ;745
000b46  f7fffffe          BL       lc640_write_long_ptr
000b4a  f88d7000          STRB     r7,[sp,#0]            ;747
000b4e  f88d7001          STRB     r7,[sp,#1]            ;748
000b52  f88d7002          STRB     r7,[sp,#2]            ;749
000b56  f88d7003          STRB     r7,[sp,#3]            ;750
000b5a  4669              MOV      r1,sp                 ;751
000b5c  f1050014          ADD      r0,r5,#0x14           ;751
000b60  f7fffffe          BL       lc640_write_long_ptr
000b64  f88d7000          STRB     r7,[sp,#0]            ;753
000b68  f88d7001          STRB     r7,[sp,#1]            ;754
000b6c  f88d7002          STRB     r7,[sp,#2]            ;755
000b70  f88d7003          STRB     r7,[sp,#3]            ;756
000b74  4669              MOV      r1,sp                 ;757
000b76  f1050018          ADD      r0,r5,#0x18           ;757
000b7a  f7fffffe          BL       lc640_write_long_ptr
000b7e  f88d7000          STRB     r7,[sp,#0]            ;759
000b82  f88d7001          STRB     r7,[sp,#1]            ;760
000b86  f88d7002          STRB     r7,[sp,#2]            ;761
000b8a  f88d7003          STRB     r7,[sp,#3]            ;762
000b8e  4669              MOV      r1,sp                 ;763
000b90  f105001c          ADD      r0,r5,#0x1c           ;763
000b94  f7fffffe          BL       lc640_write_long_ptr
000b98  b126              CBZ      r6,|L1.2980|
000b9a  2e01              CMP      r6,#1                 ;777
000b9c  d026              BEQ      |L1.3052|
000b9e  2e02              CMP      r6,#2                 ;788
000ba0  d048              BEQ      |L1.3124|
000ba2  e1cb              B        |L1.3900|
                  |L1.2980|
000ba4  b134              CBZ      r4,|L1.2996|
000ba6  2c01              CMP      r4,#1                 ;770
000ba8  d00b              BEQ      |L1.3010|
000baa  2c02              CMP      r4,#2                 ;772
000bac  d010              BEQ      |L1.3024|
000bae  2c03              CMP      r4,#3                 ;774
000bb0  d015              BEQ      |L1.3038|
000bb2  e1c3              B        |L1.3900|
                  |L1.2996|
000bb4  2300              MOVS     r3,#0                 ;769
000bb6  2201              MOVS     r2,#1                 ;769
000bb8  2104              MOVS     r1,#4                 ;769
000bba  a07d              ADR      r0,|L1.3504|
000bbc  f7fffffe          BL       snmp_trap_send
000bc0  e1bc              B        |L1.3900|
                  |L1.3010|
000bc2  2301              MOVS     r3,#1                 ;771
000bc4  461a              MOV      r2,r3                 ;771
000bc6  2104              MOVS     r1,#4                 ;771
000bc8  a07f              ADR      r0,|L1.3528|
000bca  f7fffffe          BL       snmp_trap_send
000bce  e1b5              B        |L1.3900|
                  |L1.3024|
000bd0  2302              MOVS     r3,#2                 ;773
000bd2  2201              MOVS     r2,#1                 ;773
000bd4  2104              MOVS     r1,#4                 ;773
000bd6  a083              ADR      r0,|L1.3556|
000bd8  f7fffffe          BL       snmp_trap_send
000bdc  e1ae              B        |L1.3900|
                  |L1.3038|
000bde  2303              MOVS     r3,#3                 ;775
000be0  2201              MOVS     r2,#1                 ;775
000be2  2104              MOVS     r1,#4                 ;775
000be4  a087              ADR      r0,|L1.3588|
000be6  f7fffffe          BL       snmp_trap_send
000bea  e1a7              B        |L1.3900|
                  |L1.3052|
000bec  b134              CBZ      r4,|L1.3068|
000bee  2c01              CMP      r4,#1                 ;781
000bf0  d00b              BEQ      |L1.3082|
000bf2  2c02              CMP      r4,#2                 ;783
000bf4  d010              BEQ      |L1.3096|
000bf6  2c03              CMP      r4,#3                 ;785
000bf8  d015              BEQ      |L1.3110|
000bfa  e19f              B        |L1.3900|
                  |L1.3068|
000bfc  2300              MOVS     r3,#0                 ;780
000bfe  2202              MOVS     r2,#2                 ;780
000c00  2104              MOVS     r1,#4                 ;780
000c02  a088              ADR      r0,|L1.3620|
000c04  f7fffffe          BL       snmp_trap_send
000c08  e198              B        |L1.3900|
                  |L1.3082|
000c0a  2301              MOVS     r3,#1                 ;782
000c0c  2202              MOVS     r2,#2                 ;782
000c0e  2104              MOVS     r1,#4                 ;782
000c10  a08a              ADR      r0,|L1.3644|
000c12  f7fffffe          BL       snmp_trap_send
000c16  e191              B        |L1.3900|
                  |L1.3096|
000c18  2302              MOVS     r3,#2                 ;784
000c1a  461a              MOV      r2,r3                 ;784
000c1c  2104              MOVS     r1,#4                 ;784
000c1e  a08e              ADR      r0,|L1.3672|
000c20  f7fffffe          BL       snmp_trap_send
000c24  e18a              B        |L1.3900|
                  |L1.3110|
000c26  2303              MOVS     r3,#3                 ;786
000c28  2202              MOVS     r2,#2                 ;786
000c2a  2104              MOVS     r1,#4                 ;786
000c2c  a092              ADR      r0,|L1.3704|
000c2e  f7fffffe          BL       snmp_trap_send
000c32  e183              B        |L1.3900|
                  |L1.3124|
000c34  b134              CBZ      r4,|L1.3140|
000c36  2c01              CMP      r4,#1                 ;792
000c38  d00b              BEQ      |L1.3154|
000c3a  2c02              CMP      r4,#2                 ;794
000c3c  d010              BEQ      |L1.3168|
000c3e  2c03              CMP      r4,#3                 ;796
000c40  d015              BEQ      |L1.3182|
000c42  e17b              B        |L1.3900|
                  |L1.3140|
000c44  2300              MOVS     r3,#0                 ;791
000c46  2203              MOVS     r2,#3                 ;791
000c48  2104              MOVS     r1,#4                 ;791
000c4a  a093              ADR      r0,|L1.3736|
000c4c  f7fffffe          BL       snmp_trap_send
000c50  e174              B        |L1.3900|
                  |L1.3154|
000c52  2301              MOVS     r3,#1                 ;793
000c54  2203              MOVS     r2,#3                 ;793
000c56  2104              MOVS     r1,#4                 ;793
000c58  a095              ADR      r0,|L1.3760|
000c5a  f7fffffe          BL       snmp_trap_send
000c5e  e16d              B        |L1.3900|
                  |L1.3168|
000c60  2302              MOVS     r3,#2                 ;795
000c62  2203              MOVS     r2,#3                 ;795
000c64  2104              MOVS     r1,#4                 ;795
000c66  a099              ADR      r0,|L1.3788|
000c68  f7fffffe          BL       snmp_trap_send
000c6c  e166              B        |L1.3900|
                  |L1.3182|
000c6e  2303              MOVS     r3,#3                 ;797
000c70  461a              MOV      r2,r3                 ;797
000c72  2104              MOVS     r1,#4                 ;797
000c74  a09d              ADR      r0,|L1.3820|
000c76  f7fffffe          BL       snmp_trap_send
000c7a  e15f              B        |L1.3900|
                  |L1.3196|
;;;803    	{      
;;;804    //	av_bps[bps]=0;
;;;805    
;;;806    	//SET_REG(avar_stat,0,3+bps,1);
;;;807    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;808    
;;;809         if(v==0) bps[dev]._av&=(~(1<<0));
000c7c  b134              CBZ      r4,|L1.3212|
;;;810         else if(v==1) bps[dev]._av&=(~(1<<1));
000c7e  2c01              CMP      r4,#1
000c80  d009              BEQ      |L1.3222|
;;;811    	else if(v==2) bps[dev]._av&=(~(1<<2));
000c82  2c02              CMP      r4,#2
000c84  d00c              BEQ      |L1.3232|
;;;812    	else if(v==3) bps[dev]._av&=(~(1<<3));
000c86  2c03              CMP      r4,#3
000c88  d00f              BEQ      |L1.3242|
000c8a  e012              B        |L1.3250|
                  |L1.3212|
000c8c  7841              LDRB     r1,[r0,#1]            ;809
000c8e  f0210101          BIC      r1,r1,#1              ;809
000c92  7041              STRB     r1,[r0,#1]            ;809
000c94  e00d              B        |L1.3250|
                  |L1.3222|
000c96  7841              LDRB     r1,[r0,#1]            ;810
000c98  f0210102          BIC      r1,r1,#2              ;810
000c9c  7041              STRB     r1,[r0,#1]            ;810
000c9e  e008              B        |L1.3250|
                  |L1.3232|
000ca0  7841              LDRB     r1,[r0,#1]            ;811
000ca2  f0210104          BIC      r1,r1,#4              ;811
000ca6  7041              STRB     r1,[r0,#1]            ;811
000ca8  e003              B        |L1.3250|
                  |L1.3242|
000caa  7841              LDRB     r1,[r0,#1]
000cac  f0210108          BIC      r1,r1,#8
000cb0  7041              STRB     r1,[r0,#1]
                  |L1.3250|
;;;813         
;;;814    //	if((bps[dev]._av&0x0f==0))
;;;815    //	     {
;;;816    		//SET_REG(avar_stat,0,3+bps,1);
;;;817    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;818    //	     }
;;;819     
;;;820    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000cb2  4650              MOV      r0,r10
000cb4  f7fffffe          BL       lc640_read_int
000cb8  fa1ffb80          UXTH     r11,r0
;;;821    	event_ptr_find=event_ptr;
000cbc  465c              MOV      r4,r11
                  |L1.3262|
;;;822    	
;;;823    avar_src_hndl_lbl1: 
;;;824    
;;;825    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000cbe  eb051044          ADD      r0,r5,r4,LSL #5
000cc2  fa1ffa80          UXTH     r10,r0
;;;826    
;;;827         lc640_read_long_ptr(lc640_adr,data);
000cc6  4669              MOV      r1,sp
000cc8  4650              MOV      r0,r10
000cca  f7fffffe          BL       lc640_read_long_ptr
;;;828         
;;;829         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000cce  f89d0000          LDRB     r0,[sp,#0]
000cd2  2853              CMP      r0,#0x53
000cd4  d107              BNE      |L1.3302|
000cd6  f89d0001          LDRB     r0,[sp,#1]
000cda  42b0              CMP      r0,r6
000cdc  d103              BNE      |L1.3302|
000cde  f89d0002          LDRB     r0,[sp,#2]
000ce2  42b8              CMP      r0,r7
000ce4  d009              BEQ      |L1.3322|
                  |L1.3302|
;;;830         	{        
;;;831         	if(event_ptr_find)event_ptr_find--;
000ce6  b11c              CBZ      r4,|L1.3312|
000ce8  f1a40401          SUB      r4,r4,#1
000cec  b2a4              UXTH     r4,r4
000cee  e001              B        |L1.3316|
                  |L1.3312|
;;;832         	else event_ptr_find=63;
000cf0  f04f043f          MOV      r4,#0x3f
                  |L1.3316|
;;;833         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000cf4  455c              CMP      r4,r11
000cf6  d1e2              BNE      |L1.3262|
000cf8  e120              B        |L1.3900|
                  |L1.3322|
;;;834         	else goto avar_src_hndl_lbl1;
;;;835         	}
;;;836         else 
;;;837         	{
;;;838         	lc640_read_long_ptr(lc640_adr+16,data);
000cfa  4669              MOV      r1,sp
000cfc  f10a0010          ADD      r0,r10,#0x10
000d00  f7fffffe          BL       lc640_read_long_ptr
;;;839         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000d04  f89d0000          LDRB     r0,[sp,#0]
000d08  2841              CMP      r0,#0x41
000d0a  d10b              BNE      |L1.3364|
000d0c  f89d0001          LDRB     r0,[sp,#1]
000d10  2841              CMP      r0,#0x41
000d12  d107              BNE      |L1.3364|
000d14  f89d0002          LDRB     r0,[sp,#2]
000d18  2841              CMP      r0,#0x41
000d1a  d103              BNE      |L1.3364|
000d1c  f89d0003          LDRB     r0,[sp,#3]
000d20  2841              CMP      r0,#0x41
000d22  d009              BEQ      |L1.3384|
                  |L1.3364|
;;;840         		{        
;;;841         		if(event_ptr_find)event_ptr_find--;
000d24  b11c              CBZ      r4,|L1.3374|
000d26  f1a40401          SUB      r4,r4,#1
000d2a  b2a4              UXTH     r4,r4
000d2c  e001              B        |L1.3378|
                  |L1.3374|
;;;842             		else event_ptr_find=63;
000d2e  f04f043f          MOV      r4,#0x3f
                  |L1.3378|
;;;843             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000d32  455c              CMP      r4,r11
000d34  d1c3              BNE      |L1.3262|
000d36  e101              B        |L1.3900|
                  |L1.3384|
;;;844         		else goto avar_src_hndl_lbl1;
;;;845         		}
;;;846    
;;;847         	}	
;;;848    
;;;849    
;;;850    	
;;;851    	data[0]=LPC_RTC->YEAR;
000d38  f8b8003c          LDRH     r0,[r8,#0x3c]
000d3c  f88d0000          STRB     r0,[sp,#0]
;;;852    	data[1]=LPC_RTC->MONTH;
000d40  f8980038          LDRB     r0,[r8,#0x38]
000d44  f88d0001          STRB     r0,[sp,#1]
;;;853    	data[2]=LPC_RTC->DOM;
000d48  f898002c          LDRB     r0,[r8,#0x2c]
000d4c  f88d0002          STRB     r0,[sp,#2]
;;;854    	data[3]=0;
000d50  f88d9003          STRB     r9,[sp,#3]
;;;855    	lc640_write_long_ptr(lc640_adr+16,data);
000d54  4669              MOV      r1,sp
000d56  f10a0010          ADD      r0,r10,#0x10
000d5a  f7fffffe          BL       lc640_write_long_ptr
;;;856    
;;;857    	data[0]=LPC_RTC->HOUR;
000d5e  f8980028          LDRB     r0,[r8,#0x28]
000d62  f88d0000          STRB     r0,[sp,#0]
;;;858    	data[1]=LPC_RTC->MIN;
000d66  f8980024          LDRB     r0,[r8,#0x24]
000d6a  f88d0001          STRB     r0,[sp,#1]
;;;859    	data[2]=LPC_RTC->SEC;
000d6e  f8980020          LDRB     r0,[r8,#0x20]
000d72  f88d0002          STRB     r0,[sp,#2]
;;;860    	data[3]=0;
000d76  f88d9003          STRB     r9,[sp,#3]
;;;861    	lc640_write_long_ptr(lc640_adr+20,data);
000d7a  4669              MOV      r1,sp
000d7c  f10a0014          ADD      r0,r10,#0x14
000d80  f7fffffe          BL       lc640_write_long_ptr
;;;862    	
;;;863    	data[0]='B';
000d84  f04f0442          MOV      r4,#0x42
000d88  f88d4000          STRB     r4,[sp,#0]
;;;864    	data[1]='B';
000d8c  e0be              B        |L1.3852|
000d8e  0000              DCW      0x0000
                  |L1.3472|
                          DCD      net_Ustore
                  |L1.3476|
000d94  4d61696e          DCB      "Main power is on",0
000d98  20706f77
000d9c  65722069
000da0  73206f6e
000da4  00      
000da5  00                DCB      0
000da6  00                DCB      0
000da7  00                DCB      0
                  |L1.3496|
                          DCD      0x40024000
                  |L1.3500|
                          DCD      bps
                  |L1.3504|
000db0  42505320          DCB      "BPS #1 Alarm, overheat",0
000db4  23312041
000db8  6c61726d
000dbc  2c206f76
000dc0  65726865
000dc4  617400  
000dc7  00                DCB      0
                  |L1.3528|
000dc8  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000dcc  23312041
000dd0  6c61726d
000dd4  2c20766f
000dd8  6c746167
000ddc  65206973
000de0  20757000
                  |L1.3556|
000de4  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000de8  23312041
000dec  6c61726d
000df0  2c20766f
000df4  6c746167
000df8  65206973
000dfc  20646f77
000e00  6e00    
000e02  00                DCB      0
000e03  00                DCB      0
                  |L1.3588|
000e04  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000e08  23312041
000e0c  6c61726d
000e10  2c20636f
000e14  6e6e6563
000e18  74206973
000e1c  206c6f73
000e20  7400    
000e22  00                DCB      0
000e23  00                DCB      0
                  |L1.3620|
000e24  42505320          DCB      "BPS #2 Alarm, overheat",0
000e28  23322041
000e2c  6c61726d
000e30  2c206f76
000e34  65726865
000e38  617400  
000e3b  00                DCB      0
                  |L1.3644|
000e3c  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000e40  23322041
000e44  6c61726d
000e48  2c20766f
000e4c  6c746167
000e50  65206973
000e54  20757000
                  |L1.3672|
000e58  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000e5c  23322041
000e60  6c61726d
000e64  2c20766f
000e68  6c746167
000e6c  65206973
000e70  20646f77
000e74  6e00    
000e76  00                DCB      0
000e77  00                DCB      0
                  |L1.3704|
000e78  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000e7c  23322041
000e80  6c61726d
000e84  2c20636f
000e88  6e6e6563
000e8c  74206973
000e90  206c6f73
000e94  7400    
000e96  00                DCB      0
000e97  00                DCB      0
                  |L1.3736|
000e98  42505320          DCB      "BPS #3 Alarm, overheat",0
000e9c  23332041
000ea0  6c61726d
000ea4  2c206f76
000ea8  65726865
000eac  617400  
000eaf  00                DCB      0
                  |L1.3760|
000eb0  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000eb4  23332041
000eb8  6c61726d
000ebc  2c20766f
000ec0  6c746167
000ec4  65206973
000ec8  20757000
                  |L1.3788|
000ecc  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000ed0  23332041
000ed4  6c61726d
000ed8  2c20766f
000edc  6c746167
000ee0  65206973
000ee4  20646f77
000ee8  6e00    
000eea  00                DCB      0
000eeb  00                DCB      0
                  |L1.3820|
000eec  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000ef0  23332041
000ef4  6c61726d
000ef8  2c20636f
000efc  6e6e6563
000f00  74206973
000f04  206c6f73
000f08  7400    
000f0a  00                DCB      0
000f0b  00                DCB      0
                  |L1.3852|
000f0c  f88d4001          STRB     r4,[sp,#1]
;;;865    	data[2]='B';
000f10  f88d4002          STRB     r4,[sp,#2]
;;;866    	data[3]='B';
000f14  f88d4003          STRB     r4,[sp,#3]
;;;867    	lc640_write_long_ptr(lc640_adr+24,data);
000f18  4669              MOV      r1,sp
000f1a  f10a0018          ADD      r0,r10,#0x18
000f1e  f7fffffe          BL       lc640_write_long_ptr
;;;868    	
;;;869    	data[0]='B';
000f22  f88d4000          STRB     r4,[sp,#0]
;;;870    	data[1]='B';
000f26  f88d4001          STRB     r4,[sp,#1]
;;;871    	data[2]='B';
000f2a  f88d4002          STRB     r4,[sp,#2]
;;;872    	data[3]='B';
000f2e  f88d4003          STRB     r4,[sp,#3]
;;;873    	lc640_write_long_ptr(lc640_adr+28,data);
000f32  4669              MOV      r1,sp
000f34  f10a001c          ADD      r0,r10,#0x1c
000f38  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3900|
;;;874    	
;;;875    	}
;;;876    	
;;;877    avar_src_hndl_end:
;;;878    __nop();		
000f3c  bf00              NOP      
                  |L1.3902|
;;;879    }
000f3e  e54d              B        |L1.2524|
;;;880    
                          ENDP

                  wrk_mem_hndl PROC
;;;881    //-----------------------------------------------
;;;882    void wrk_mem_hndl(char b)
000f40  e92d41fc          PUSH     {r2-r8,lr}
;;;883    {
000f44  4606              MOV      r6,r0
;;;884    char data[4];
;;;885    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;886    
;;;887    signed short temp_temp;
;;;888    
;;;889    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000f46  eb060046          ADD      r0,r6,r6,LSL #1
000f4a  eb001106          ADD      r1,r0,r6,LSL #4
000f4e  48ff              LDR      r0,|L1.4940|
000f50  eb000481          ADD      r4,r0,r1,LSL #2
000f54  8be0              LDRH     r0,[r4,#0x1e]
000f56  2805              CMP      r0,#5
000f58  d37e              BCC      |L1.4184|
;;;890    
;;;891    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000f5a  48fd              LDR      r0,|L1.4944|
000f5c  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000f5e  f1000006          ADD      r0,r0,#6
000f62  f0000007          AND      r0,r0,#7
000f66  eb040040          ADD      r0,r4,r0,LSL #1
000f6a  8c00              LDRH     r0,[r0,#0x20]
000f6c  9000              STR      r0,[sp,#0]
;;;892    
;;;893    
;;;894    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000f6e  f44f6760          MOV      r7,#0xe00
000f72  4638              MOV      r0,r7
000f74  f7fffffe          BL       lc640_read_int
;;;895    event_ptr++;	
000f78  f1000001          ADD      r0,r0,#1
000f7c  b285              UXTH     r5,r0
;;;896    if(event_ptr>63)event_ptr=0;	
000f7e  2d3f              CMP      r5,#0x3f
000f80  d901              BLS      |L1.3974|
000f82  f04f0500          MOV      r5,#0
                  |L1.3974|
;;;897    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000f86  b229              SXTH     r1,r5
000f88  4638              MOV      r0,r7
000f8a  f7fffffe          BL       lc640_write_int
;;;898    	
;;;899    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000f8e  f6406802          MOV      r8,#0xe02
000f92  4640              MOV      r0,r8
000f94  f7fffffe          BL       lc640_read_int
000f98  b280              UXTH     r0,r0
;;;900    if(event_cnt!=63)event_cnt=event_ptr;
000f9a  283f              CMP      r0,#0x3f
000f9c  d000              BEQ      |L1.4000|
000f9e  4628              MOV      r0,r5
                  |L1.4000|
;;;901    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000fa0  b201              SXTH     r1,r0
000fa2  4640              MOV      r0,r8
000fa4  f7fffffe          BL       lc640_write_int
;;;902    	
;;;903    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000fa8  4638              MOV      r0,r7
000faa  f7fffffe          BL       lc640_read_int
000fae  f44f6180          MOV      r1,#0x400
000fb2  eb011040          ADD      r0,r1,r0,LSL #5
000fb6  b285              UXTH     r5,r0
;;;904    	
;;;905    data[0]='B';
000fb8  f04f0042          MOV      r0,#0x42
000fbc  f88d0004          STRB     r0,[sp,#4]
;;;906    data[1]=b; 
000fc0  f88d6005          STRB     r6,[sp,#5]
;;;907    data[2]='W';
000fc4  f04f0057          MOV      r0,#0x57
000fc8  f88d0006          STRB     r0,[sp,#6]
;;;908    data[3]=0;
000fcc  f04f0600          MOV      r6,#0
000fd0  f88d6007          STRB     r6,[sp,#7]
;;;909    
;;;910    lc640_write_long_ptr(lc640_adr,data);
000fd4  a901              ADD      r1,sp,#4
000fd6  4628              MOV      r0,r5
000fd8  f7fffffe          BL       lc640_write_long_ptr
;;;911    
;;;912    data[0]=*((char*)&bat[b]._Iintegr_);
000fdc  7fa0              LDRB     r0,[r4,#0x1e]
000fde  f88d0004          STRB     r0,[sp,#4]
;;;913    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000fe2  7fe0              LDRB     r0,[r4,#0x1f]
000fe4  f88d0005          STRB     r0,[sp,#5]
;;;914    data[2]=*((char*)&temp_temp);
000fe8  f89d0000          LDRB     r0,[sp,#0]
000fec  f88d0006          STRB     r0,[sp,#6]
;;;915    data[3]=*(((char*)(&temp_temp))+1);
000ff0  f89d0001          LDRB     r0,[sp,#1]
000ff4  f88d0007          STRB     r0,[sp,#7]
;;;916    lc640_write_long_ptr(lc640_adr+4,data);
000ff8  a901              ADD      r1,sp,#4
000ffa  1d28              ADDS     r0,r5,#4
000ffc  f7fffffe          BL       lc640_write_long_ptr
;;;917    
;;;918    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
001000  f1040134          ADD      r1,r4,#0x34
001004  f1050008          ADD      r0,r5,#8
001008  f7fffffe          BL       lc640_write_long_ptr
;;;919    	
;;;920    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
00100c  f1040138          ADD      r1,r4,#0x38
001010  f105000c          ADD      r0,r5,#0xc
001014  f7fffffe          BL       lc640_write_long_ptr
;;;921    
;;;922    data[0]=LPC_RTC->YEAR;
001018  4cce              LDR      r4,|L1.4948|
00101a  8ba0              LDRH     r0,[r4,#0x1c]
00101c  f88d0004          STRB     r0,[sp,#4]
;;;923    data[1]=LPC_RTC->MONTH;
001020  7e20              LDRB     r0,[r4,#0x18]
001022  f88d0005          STRB     r0,[sp,#5]
;;;924    data[2]=LPC_RTC->DOM;
001026  7b20              LDRB     r0,[r4,#0xc]
001028  f88d0006          STRB     r0,[sp,#6]
;;;925    data[3]=0;
00102c  f88d6007          STRB     r6,[sp,#7]
;;;926    lc640_write_long_ptr(lc640_adr+16,data);
001030  a901              ADD      r1,sp,#4
001032  f1050010          ADD      r0,r5,#0x10
001036  f7fffffe          BL       lc640_write_long_ptr
;;;927    
;;;928    data[0]=LPC_RTC->HOUR;
00103a  7a20              LDRB     r0,[r4,#8]
00103c  f88d0004          STRB     r0,[sp,#4]
;;;929    data[1]=LPC_RTC->MIN;
001040  7920              LDRB     r0,[r4,#4]
001042  f88d0005          STRB     r0,[sp,#5]
;;;930    data[2]=LPC_RTC->SEC;
001046  7820              LDRB     r0,[r4,#0]
001048  f88d0006          STRB     r0,[sp,#6]
;;;931    data[3]=0;
00104c  f88d6007          STRB     r6,[sp,#7]
;;;932    lc640_write_long_ptr(lc640_adr+20,data);
001050  a901              ADD      r1,sp,#4
001052  f1050014          ADD      r0,r5,#0x14
001056  e000              B        |L1.4186|
                  |L1.4184|
001058  e001              B        |L1.4190|
                  |L1.4186|
00105a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4190|
;;;933    	
;;;934    
;;;935    
;;;936    	
;;;937    wrk_mem_hndl_end:	
;;;938    __nop();
00105e  bf00              NOP      
;;;939    }  
001060  e8bd81fc          POP      {r2-r8,pc}
;;;940    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;942    //-----------------------------------------------
;;;943    void avar_bat_ips_hndl(char in)
001064  e92d4ff8          PUSH     {r3-r11,lr}
;;;944    {
001068  4602              MOV      r2,r0
;;;945    char data[4];
;;;946    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;947    
;;;948    if(in==1)
;;;949    	{
;;;950    	bat_ips._av|=1;
00106a  48bb              LDR      r0,|L1.4952|
;;;951        ips_bat_av_stat=1;
00106c  4cbb              LDR      r4,|L1.4956|
;;;952    	ips_bat_av_vzvod=1;
00106e  4bbc              LDR      r3,|L1.4960|
;;;953    
;;;954    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;955    	event_ptr++;	
;;;956    	if(event_ptr>63)event_ptr=0;	
;;;957    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;958    	
;;;959    	event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;960    	if(event_cnt!=63)event_cnt=event_ptr;
;;;961    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;962    	
;;;963    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;964    	
;;;965    	data[0]='B';
;;;966    	data[1]=0;
;;;967    	data[2]='C';
;;;968    	data[3]=0;
;;;969    	lc640_write_long_ptr(lc640_adr,data);
;;;970    
;;;971    	data[0]=0;
;;;972    	data[1]=0;
;;;973    	data[2]=0;
;;;974    	data[3]=0;
;;;975    	lc640_write_long_ptr(lc640_adr+4,data);
;;;976    
;;;977    	data[0]=LPC_RTC->YEAR;
001070  f8df82f0          LDR      r8,|L1.4964|
001074  f890103d          LDRB     r1,[r0,#0x3d]         ;950
001078  f04f0742          MOV      r7,#0x42              ;965
00107c  f44f6560          MOV      r5,#0xe00             ;954
001080  f04f0900          MOV      r9,#0                 ;956
001084  f44f6a80          MOV      r10,#0x400            ;963
001088  2a01              CMP      r2,#1                 ;948
00108a  d002              BEQ      |L1.4242|
;;;978    	data[1]=LPC_RTC->MONTH;
;;;979    	data[2]=LPC_RTC->DOM;
;;;980    	data[3]=0;
;;;981    	lc640_write_long_ptr(lc640_adr+8,data);
;;;982    
;;;983    	data[0]=LPC_RTC->HOUR;
;;;984    	data[1]=LPC_RTC->MIN;
;;;985    	data[2]=LPC_RTC->SEC;
;;;986    	data[3]=0;
;;;987    	lc640_write_long_ptr(lc640_adr+12,data);
;;;988    	
;;;989    	data[0]='A';
;;;990    	data[1]='A';
;;;991    	data[2]='A';
;;;992    	data[3]='A';
;;;993    	lc640_write_long_ptr(lc640_adr+16,data);
;;;994    	
;;;995    	data[0]='A';
;;;996    	data[1]='A';
;;;997    	data[2]='A';
;;;998    	data[3]='A';
;;;999    	lc640_write_long_ptr(lc640_adr+20,data);
;;;1000   	
;;;1001   	data[0]='A';
;;;1002   	data[1]='A';
;;;1003   	data[2]='A';
;;;1004   	data[3]='A';
;;;1005   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1006   	
;;;1007   	data[0]='A';
;;;1008   	data[1]='A';
;;;1009   	data[2]='A';
;;;1010   	data[3]='A';
;;;1011   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1012   					
;;;1013   	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;1014   		
;;;1015   	}
;;;1016   
;;;1017   else if(in==0)
00108c  2a00              CMP      r2,#0
00108e  d07e              BEQ      |L1.4494|
001090  e129              B        |L1.4838|
                  |L1.4242|
001092  f0410101          ORR      r1,r1,#1              ;950
001096  f880103d          STRB     r1,[r0,#0x3d]         ;950
00109a  f04f0001          MOV      r0,#1                 ;951
00109e  7020              STRB     r0,[r4,#0]            ;951
0010a0  7018              STRB     r0,[r3,#0]            ;952
0010a2  4628              MOV      r0,r5                 ;954
0010a4  f7fffffe          BL       lc640_read_int
0010a8  f1000001          ADD      r0,r0,#1              ;955
0010ac  b284              UXTH     r4,r0                 ;955
0010ae  2c3f              CMP      r4,#0x3f              ;956
0010b0  d901              BLS      |L1.4278|
0010b2  f04f0400          MOV      r4,#0                 ;956
                  |L1.4278|
0010b6  b221              SXTH     r1,r4                 ;957
0010b8  4628              MOV      r0,r5                 ;957
0010ba  f7fffffe          BL       lc640_write_int
0010be  f6406602          MOV      r6,#0xe02             ;959
0010c2  4630              MOV      r0,r6                 ;959
0010c4  f7fffffe          BL       lc640_read_int
0010c8  b281              UXTH     r1,r0                 ;959
0010ca  293f              CMP      r1,#0x3f              ;960
0010cc  d000              BEQ      |L1.4304|
0010ce  4621              MOV      r1,r4                 ;960
                  |L1.4304|
0010d0  b209              SXTH     r1,r1                 ;961
0010d2  4630              MOV      r0,r6                 ;961
0010d4  f7fffffe          BL       lc640_write_int
0010d8  4628              MOV      r0,r5                 ;963
0010da  f7fffffe          BL       lc640_read_int
0010de  eb0a1040          ADD      r0,r10,r0,LSL #5      ;963
0010e2  b284              UXTH     r4,r0                 ;963
0010e4  f88d7000          STRB     r7,[sp,#0]            ;965
0010e8  f88d9001          STRB     r9,[sp,#1]            ;966
0010ec  f04f0043          MOV      r0,#0x43              ;967
0010f0  f88d0002          STRB     r0,[sp,#2]            ;967
0010f4  f88d9003          STRB     r9,[sp,#3]            ;968
0010f8  4669              MOV      r1,sp                 ;969
0010fa  4620              MOV      r0,r4                 ;969
0010fc  f7fffffe          BL       lc640_write_long_ptr
001100  f8cd9000          STR      r9,[sp,#0]            ;974
001104  4669              MOV      r1,sp                 ;975
001106  1d20              ADDS     r0,r4,#4              ;975
001108  f7fffffe          BL       lc640_write_long_ptr
00110c  f8b8003c          LDRH     r0,[r8,#0x3c]         ;977
001110  f88d0000          STRB     r0,[sp,#0]            ;977
001114  f8980038          LDRB     r0,[r8,#0x38]         ;978
001118  f88d0001          STRB     r0,[sp,#1]            ;978
00111c  f898002c          LDRB     r0,[r8,#0x2c]         ;979
001120  f88d0002          STRB     r0,[sp,#2]            ;979
001124  f88d9003          STRB     r9,[sp,#3]            ;980
001128  4669              MOV      r1,sp                 ;981
00112a  f1040008          ADD      r0,r4,#8              ;981
00112e  f7fffffe          BL       lc640_write_long_ptr
001132  f8980028          LDRB     r0,[r8,#0x28]         ;983
001136  f88d0000          STRB     r0,[sp,#0]            ;983
00113a  f8980024          LDRB     r0,[r8,#0x24]         ;984
00113e  f88d0001          STRB     r0,[sp,#1]            ;984
001142  f8980020          LDRB     r0,[r8,#0x20]         ;985
001146  f88d0002          STRB     r0,[sp,#2]            ;985
00114a  f88d9003          STRB     r9,[sp,#3]            ;986
00114e  4669              MOV      r1,sp                 ;987
001150  f104000c          ADD      r0,r4,#0xc            ;987
001154  f7fffffe          BL       lc640_write_long_ptr
001158  f04f0541          MOV      r5,#0x41              ;989
00115c  f88d5000          STRB     r5,[sp,#0]            ;989
001160  f88d5001          STRB     r5,[sp,#1]            ;990
001164  f88d5002          STRB     r5,[sp,#2]            ;991
001168  f88d5003          STRB     r5,[sp,#3]            ;992
00116c  4669              MOV      r1,sp                 ;993
00116e  f1040010          ADD      r0,r4,#0x10           ;993
001172  f7fffffe          BL       lc640_write_long_ptr
001176  f88d5000          STRB     r5,[sp,#0]            ;995
00117a  f88d5001          STRB     r5,[sp,#1]            ;996
00117e  f88d5002          STRB     r5,[sp,#2]            ;997
001182  f88d5003          STRB     r5,[sp,#3]            ;998
001186  4669              MOV      r1,sp                 ;999
001188  f1040014          ADD      r0,r4,#0x14           ;999
00118c  e000              B        |L1.4496|
                  |L1.4494|
00118e  e022              B        |L1.4566|
                  |L1.4496|
001190  f7fffffe          BL       lc640_write_long_ptr
001194  f88d5000          STRB     r5,[sp,#0]            ;1001
001198  f88d5001          STRB     r5,[sp,#1]            ;1002
00119c  f88d5002          STRB     r5,[sp,#2]            ;1003
0011a0  f88d5003          STRB     r5,[sp,#3]            ;1004
0011a4  4669              MOV      r1,sp                 ;1005
0011a6  f1040018          ADD      r0,r4,#0x18           ;1005
0011aa  f7fffffe          BL       lc640_write_long_ptr
0011ae  f88d5000          STRB     r5,[sp,#0]            ;1007
0011b2  f88d5001          STRB     r5,[sp,#1]            ;1008
0011b6  f88d5002          STRB     r5,[sp,#2]            ;1009
0011ba  f88d5003          STRB     r5,[sp,#3]            ;1010
0011be  4669              MOV      r1,sp                 ;1011
0011c0  f104001c          ADD      r0,r4,#0x1c           ;1011
0011c4  f7fffffe          BL       lc640_write_long_ptr
0011c8  2301              MOVS     r3,#1                 ;1013
0011ca  461a              MOV      r2,r3                 ;1013
0011cc  2105              MOVS     r1,#5                 ;1013
0011ce  a066              ADR      r0,|L1.4968|
0011d0  f7fffffe          BL       snmp_trap_send
0011d4  e087              B        |L1.4838|
                  |L1.4566|
;;;1018   	{
;;;1019   	bat_ips._av&=~1;
0011d6  f0210101          BIC      r1,r1,#1
0011da  f880103d          STRB     r1,[r0,#0x3d]
;;;1020   	ips_bat_av_stat=0;
0011de  f8849000          STRB     r9,[r4,#0]
;;;1021   	ips_bat_av_vzvod=0;
0011e2  f8839000          STRB     r9,[r3,#0]
;;;1022        
;;;1023   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0011e6  4628              MOV      r0,r5
0011e8  f7fffffe          BL       lc640_read_int
0011ec  b286              UXTH     r6,r0
;;;1024   	event_ptr_find=event_ptr;
0011ee  4634              MOV      r4,r6
                  |L1.4592|
;;;1025   	
;;;1026   avar_bat_ips_hndl_lbl1: 
;;;1027   
;;;1028   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0011f0  eb0a1044          ADD      r0,r10,r4,LSL #5
0011f4  b285              UXTH     r5,r0
;;;1029   
;;;1030        lc640_read_long_ptr(lc640_adr,data);
0011f6  4669              MOV      r1,sp
0011f8  4628              MOV      r0,r5
0011fa  f7fffffe          BL       lc640_read_long_ptr
;;;1031        
;;;1032        if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
0011fe  f89d0000          LDRB     r0,[sp,#0]
001202  2842              CMP      r0,#0x42
001204  d106              BNE      |L1.4628|
001206  f89d0001          LDRB     r0,[sp,#1]
00120a  b918              CBNZ     r0,|L1.4628|
00120c  f89d0002          LDRB     r0,[sp,#2]
001210  2843              CMP      r0,#0x43
001212  d009              BEQ      |L1.4648|
                  |L1.4628|
;;;1033        	{        
;;;1034        	if(event_ptr_find)event_ptr_find--;
001214  b11c              CBZ      r4,|L1.4638|
001216  f1a40401          SUB      r4,r4,#1
00121a  b2a4              UXTH     r4,r4
00121c  e001              B        |L1.4642|
                  |L1.4638|
;;;1035        	else event_ptr_find=63;
00121e  f04f043f          MOV      r4,#0x3f
                  |L1.4642|
;;;1036        	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001222  42b4              CMP      r4,r6
001224  d1e4              BNE      |L1.4592|
001226  e05e              B        |L1.4838|
                  |L1.4648|
;;;1037        	else goto avar_bat_ips_hndl_lbl1;
;;;1038        	}
;;;1039        else 
;;;1040        	{
;;;1041        	lc640_read_long_ptr(lc640_adr+16,data);
001228  4669              MOV      r1,sp
00122a  f1050010          ADD      r0,r5,#0x10
00122e  f7fffffe          BL       lc640_read_long_ptr
;;;1042        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001232  f89d0000          LDRB     r0,[sp,#0]
001236  2841              CMP      r0,#0x41
001238  d10b              BNE      |L1.4690|
00123a  f89d0001          LDRB     r0,[sp,#1]
00123e  2841              CMP      r0,#0x41
001240  d107              BNE      |L1.4690|
001242  f89d0002          LDRB     r0,[sp,#2]
001246  2841              CMP      r0,#0x41
001248  d103              BNE      |L1.4690|
00124a  f89d0003          LDRB     r0,[sp,#3]
00124e  2841              CMP      r0,#0x41
001250  d009              BEQ      |L1.4710|
                  |L1.4690|
;;;1043        		{        
;;;1044        		if(event_ptr_find)event_ptr_find--;
001252  b11c              CBZ      r4,|L1.4700|
001254  f1a40401          SUB      r4,r4,#1
001258  b2a4              UXTH     r4,r4
00125a  e001              B        |L1.4704|
                  |L1.4700|
;;;1045            		else event_ptr_find=63;
00125c  f04f043f          MOV      r4,#0x3f
                  |L1.4704|
;;;1046            	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001260  42b4              CMP      r4,r6
001262  d1c5              BNE      |L1.4592|
001264  e03f              B        |L1.4838|
                  |L1.4710|
;;;1047        		else goto avar_bat_ips_hndl_lbl1;
;;;1048        		}
;;;1049   
;;;1050        	}
;;;1051        		
;;;1052   	data[0]=LPC_RTC->YEAR;
001266  f8b8003c          LDRH     r0,[r8,#0x3c]
00126a  f88d0000          STRB     r0,[sp,#0]
;;;1053   	data[1]=LPC_RTC->MONTH;
00126e  f8980038          LDRB     r0,[r8,#0x38]
001272  f88d0001          STRB     r0,[sp,#1]
;;;1054   	data[2]=LPC_RTC->DOM;
001276  f898002c          LDRB     r0,[r8,#0x2c]
00127a  f88d0002          STRB     r0,[sp,#2]
;;;1055   	data[3]=0;
00127e  f88d9003          STRB     r9,[sp,#3]
;;;1056   	lc640_write_long_ptr(lc640_adr+16,data);
001282  4669              MOV      r1,sp
001284  f1050010          ADD      r0,r5,#0x10
001288  f7fffffe          BL       lc640_write_long_ptr
;;;1057   
;;;1058   	data[0]=LPC_RTC->HOUR;
00128c  f8980028          LDRB     r0,[r8,#0x28]
001290  f88d0000          STRB     r0,[sp,#0]
;;;1059   	data[1]=LPC_RTC->MIN;
001294  f8980024          LDRB     r0,[r8,#0x24]
001298  f88d0001          STRB     r0,[sp,#1]
;;;1060   	data[2]=LPC_RTC->SEC;
00129c  f8980020          LDRB     r0,[r8,#0x20]
0012a0  f88d0002          STRB     r0,[sp,#2]
;;;1061   	data[3]=0;
0012a4  f88d9003          STRB     r9,[sp,#3]
;;;1062   	lc640_write_long_ptr(lc640_adr+20,data);
0012a8  4669              MOV      r1,sp
0012aa  f1050014          ADD      r0,r5,#0x14
0012ae  f7fffffe          BL       lc640_write_long_ptr
;;;1063   	
;;;1064   	data[0]='B';
0012b2  f88d7000          STRB     r7,[sp,#0]
;;;1065   	data[1]='B';
0012b6  f88d7001          STRB     r7,[sp,#1]
;;;1066   	data[2]='B';
0012ba  f88d7002          STRB     r7,[sp,#2]
;;;1067   	data[3]='B';
0012be  f88d7003          STRB     r7,[sp,#3]
;;;1068   	lc640_write_long_ptr(lc640_adr+24,data);
0012c2  4669              MOV      r1,sp
0012c4  f1050018          ADD      r0,r5,#0x18
0012c8  f7fffffe          BL       lc640_write_long_ptr
;;;1069   	
;;;1070   	data[0]='B';
0012cc  f88d7000          STRB     r7,[sp,#0]
;;;1071   	data[1]='B';
0012d0  f88d7001          STRB     r7,[sp,#1]
;;;1072   	data[2]='B';
0012d4  f88d7002          STRB     r7,[sp,#2]
;;;1073   	data[3]='B';
0012d8  f88d7003          STRB     r7,[sp,#3]
;;;1074   	lc640_write_long_ptr(lc640_adr+28,data);
0012dc  4669              MOV      r1,sp
0012de  f105001c          ADD      r0,r5,#0x1c
0012e2  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4838|
;;;1075   	
;;;1076   
;;;1077   	
;;;1078   	}
;;;1079   	
;;;1080   avar_bat_ips_hndl_end:
;;;1081   __nop();		
0012e6  bf00              NOP      
                  |L1.4840|
;;;1082   }
0012e8  e629              B        |L1.3902|
;;;1083   
                          ENDP

                  avar_bat_hndl PROC
;;;1086   //-----------------------------------------------
;;;1087   void avar_bat_hndl(char b, char in)
0012ea  e92d4ff8          PUSH     {r3-r11,lr}
;;;1088   {
0012ee  4606              MOV      r6,r0
;;;1089   char data[4];
;;;1090   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1091   
;;;1092   if(in==1)
;;;1093   	{
;;;1094   	bat[b]._av|=1;
0012f0  4816              LDR      r0,|L1.4940|
0012f2  eb060246          ADD      r2,r6,r6,LSL #1
;;;1095       
;;;1096   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1097   	event_ptr++;	
;;;1098   	if(event_ptr>63)event_ptr=0;	
;;;1099   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1100   	
;;;1101        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1102   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1103   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1104   	
;;;1105   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1106   	
;;;1107   	data[0]='B';
;;;1108   	data[1]=b;
;;;1109   	data[2]='C';
;;;1110   	data[3]=0;
;;;1111   	lc640_write_long_ptr(lc640_adr,data);
;;;1112   
;;;1113   	data[0]=0;
;;;1114   	data[1]=0;
;;;1115   	data[2]=0;
;;;1116   	data[3]=0;
;;;1117   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1118   
;;;1119   	data[0]=LPC_RTC->YEAR;
0012f6  f8df806c          LDR      r8,|L1.4964|
0012fa  eb021206          ADD      r2,r2,r6,LSL #4       ;1094
0012fe  f04f0a00          MOV      r10,#0                ;1098
001302  f04f0942          MOV      r9,#0x42              ;1107
001306  f44f6560          MOV      r5,#0xe00             ;1096
00130a  f44f6b80          MOV      r11,#0x400            ;1105
00130e  eb000082          ADD      r0,r0,r2,LSL #2       ;1094
001312  2901              CMP      r1,#1                 ;1092
001314  d002              BEQ      |L1.4892|
;;;1120   	data[1]=LPC_RTC->MONTH;
;;;1121   	data[2]=LPC_RTC->DOM;
;;;1122   	data[3]=0;
;;;1123   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1124   
;;;1125   	data[0]=LPC_RTC->HOUR;
;;;1126   	data[1]=LPC_RTC->MIN;
;;;1127   	data[2]=LPC_RTC->SEC;
;;;1128   	data[3]=0;
;;;1129   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1130   	
;;;1131   	data[0]='A';
;;;1132   	data[1]='A';
;;;1133   	data[2]='A';
;;;1134   	data[3]='A';
;;;1135   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1136   	
;;;1137   	data[0]='A';
;;;1138   	data[1]='A';
;;;1139   	data[2]='A';
;;;1140   	data[3]='A';
;;;1141   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1142   	
;;;1143   	data[0]='A';
;;;1144   	data[1]='A';
;;;1145   	data[2]='A';
;;;1146   	data[3]='A';
;;;1147   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1148   	
;;;1149   	data[0]='A';
;;;1150   	data[1]='A';
;;;1151   	data[2]='A';
;;;1152   	data[3]='A';
;;;1153   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1154   					
;;;1155   	if(b==0)
;;;1156   		{
;;;1157   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1158   		}
;;;1159   	else if(b==1)
;;;1160   		{
;;;1161   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1162   		} 
;;;1163   			
;;;1164   	}
;;;1165   
;;;1166   else if(in==0)
001316  2900              CMP      r1,#0
001318  d07d              BEQ      |L1.5142|
00131a  e149              B        |L1.5552|
                  |L1.4892|
00131c  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1094
001320  f0410101          ORR      r1,r1,#1              ;1094
001324  7001              STRB     r1,[r0,#0]            ;1094
001326  4628              MOV      r0,r5                 ;1096
001328  f7fffffe          BL       lc640_read_int
00132c  f1000001          ADD      r0,r0,#1              ;1097
001330  b284              UXTH     r4,r0                 ;1097
001332  2c3f              CMP      r4,#0x3f              ;1098
001334  d901              BLS      |L1.4922|
001336  f04f0400          MOV      r4,#0                 ;1098
                  |L1.4922|
00133a  b221              SXTH     r1,r4                 ;1099
00133c  4628              MOV      r0,r5                 ;1099
00133e  f7fffffe          BL       lc640_write_int
001342  f6406702          MOV      r7,#0xe02             ;1101
001346  4638              MOV      r0,r7                 ;1101
001348  e018              B        |L1.4988|
00134a  0000              DCW      0x0000
                  |L1.4940|
                          DCD      bat
                  |L1.4944|
                          DCD      bat_u_old_cnt
                  |L1.4948|
                          DCD      0x40024020
                  |L1.4952|
                          DCD      bat_ips
                  |L1.4956|
                          DCD      ips_bat_av_stat
                  |L1.4960|
                          DCD      ips_bat_av_vzvod
                  |L1.4964|
                          DCD      0x40024000
                  |L1.4968|
001368  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
00136c  b9312041
001370  6c61726d
001374  2c206c6f
001378  737400  
00137b  00                DCB      0
                  |L1.4988|
00137c  f7fffffe          BL       lc640_read_int
001380  b280              UXTH     r0,r0                 ;1101
001382  283f              CMP      r0,#0x3f              ;1102
001384  d000              BEQ      |L1.5000|
001386  4620              MOV      r0,r4                 ;1102
                  |L1.5000|
001388  b201              SXTH     r1,r0                 ;1103
00138a  4638              MOV      r0,r7                 ;1103
00138c  f7fffffe          BL       lc640_write_int
001390  4628              MOV      r0,r5                 ;1105
001392  f7fffffe          BL       lc640_read_int
001396  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1105
00139a  b284              UXTH     r4,r0                 ;1105
00139c  f88d9000          STRB     r9,[sp,#0]            ;1107
0013a0  f88d6001          STRB     r6,[sp,#1]            ;1108
0013a4  f04f0043          MOV      r0,#0x43              ;1109
0013a8  f88d0002          STRB     r0,[sp,#2]            ;1109
0013ac  f88da003          STRB     r10,[sp,#3]           ;1110
0013b0  4669              MOV      r1,sp                 ;1111
0013b2  4620              MOV      r0,r4                 ;1111
0013b4  f7fffffe          BL       lc640_write_long_ptr
0013b8  f8cda000          STR      r10,[sp,#0]           ;1116
0013bc  4669              MOV      r1,sp                 ;1117
0013be  1d20              ADDS     r0,r4,#4              ;1117
0013c0  f7fffffe          BL       lc640_write_long_ptr
0013c4  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1119
0013c8  f88d0000          STRB     r0,[sp,#0]            ;1119
0013cc  f8980038          LDRB     r0,[r8,#0x38]         ;1120
0013d0  f88d0001          STRB     r0,[sp,#1]            ;1120
0013d4  f898002c          LDRB     r0,[r8,#0x2c]         ;1121
0013d8  f88d0002          STRB     r0,[sp,#2]            ;1121
0013dc  f88da003          STRB     r10,[sp,#3]           ;1122
0013e0  4669              MOV      r1,sp                 ;1123
0013e2  f1040008          ADD      r0,r4,#8              ;1123
0013e6  f7fffffe          BL       lc640_write_long_ptr
0013ea  f8980028          LDRB     r0,[r8,#0x28]         ;1125
0013ee  f88d0000          STRB     r0,[sp,#0]            ;1125
0013f2  f8980024          LDRB     r0,[r8,#0x24]         ;1126
0013f6  f88d0001          STRB     r0,[sp,#1]            ;1126
0013fa  f8980020          LDRB     r0,[r8,#0x20]         ;1127
0013fe  f88d0002          STRB     r0,[sp,#2]            ;1127
001402  f88da003          STRB     r10,[sp,#3]           ;1128
001406  4669              MOV      r1,sp                 ;1129
001408  f104000c          ADD      r0,r4,#0xc            ;1129
00140c  f7fffffe          BL       lc640_write_long_ptr
001410  f04f0541          MOV      r5,#0x41              ;1131
001414  e000              B        |L1.5144|
                  |L1.5142|
001416  e045              B        |L1.5284|
                  |L1.5144|
001418  f88d5000          STRB     r5,[sp,#0]            ;1131
00141c  f88d5001          STRB     r5,[sp,#1]            ;1132
001420  f88d5002          STRB     r5,[sp,#2]            ;1133
001424  f88d5003          STRB     r5,[sp,#3]            ;1134
001428  4669              MOV      r1,sp                 ;1135
00142a  f1040010          ADD      r0,r4,#0x10           ;1135
00142e  f7fffffe          BL       lc640_write_long_ptr
001432  f88d5000          STRB     r5,[sp,#0]            ;1137
001436  f88d5001          STRB     r5,[sp,#1]            ;1138
00143a  f88d5002          STRB     r5,[sp,#2]            ;1139
00143e  f88d5003          STRB     r5,[sp,#3]            ;1140
001442  4669              MOV      r1,sp                 ;1141
001444  f1040014          ADD      r0,r4,#0x14           ;1141
001448  f7fffffe          BL       lc640_write_long_ptr
00144c  f88d5000          STRB     r5,[sp,#0]            ;1143
001450  f88d5001          STRB     r5,[sp,#1]            ;1144
001454  f88d5002          STRB     r5,[sp,#2]            ;1145
001458  f88d5003          STRB     r5,[sp,#3]            ;1146
00145c  4669              MOV      r1,sp                 ;1147
00145e  f1040018          ADD      r0,r4,#0x18           ;1147
001462  f7fffffe          BL       lc640_write_long_ptr
001466  f88d5000          STRB     r5,[sp,#0]            ;1149
00146a  f88d5001          STRB     r5,[sp,#1]            ;1150
00146e  f88d5002          STRB     r5,[sp,#2]            ;1151
001472  f88d5003          STRB     r5,[sp,#3]            ;1152
001476  4669              MOV      r1,sp                 ;1153
001478  f104001c          ADD      r0,r4,#0x1c           ;1153
00147c  f7fffffe          BL       lc640_write_long_ptr
001480  b116              CBZ      r6,|L1.5256|
001482  2e01              CMP      r6,#1                 ;1159
001484  d007              BEQ      |L1.5270|
001486  e093              B        |L1.5552|
                  |L1.5256|
001488  2301              MOVS     r3,#1                 ;1157
00148a  461a              MOV      r2,r3                 ;1157
00148c  2105              MOVS     r1,#5                 ;1157
00148e  a0fe              ADR      r0,|L1.6280|
001490  f7fffffe          BL       snmp_trap_send
001494  e08c              B        |L1.5552|
                  |L1.5270|
001496  2301              MOVS     r3,#1                 ;1161
001498  2202              MOVS     r2,#2                 ;1161
00149a  2105              MOVS     r1,#5                 ;1161
00149c  a0ff              ADR      r0,|L1.6300|
00149e  f7fffffe          BL       snmp_trap_send
0014a2  e085              B        |L1.5552|
                  |L1.5284|
;;;1167   	{
;;;1168   	bat[b]._av&=~1;
0014a4  f8101f3d          LDRB     r1,[r0,#0x3d]!
0014a8  f0210101          BIC      r1,r1,#1
0014ac  7001              STRB     r1,[r0,#0]
;;;1169   
;;;1170        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0014ae  4628              MOV      r0,r5
0014b0  f7fffffe          BL       lc640_read_int
0014b4  b287              UXTH     r7,r0
;;;1171   	event_ptr_find=event_ptr;
0014b6  463c              MOV      r4,r7
                  |L1.5304|
;;;1172   	
;;;1173   avar_bat_hndl_lbl1: 
;;;1174   
;;;1175   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0014b8  eb0b1044          ADD      r0,r11,r4,LSL #5
0014bc  b285              UXTH     r5,r0
;;;1176   
;;;1177        lc640_read_long_ptr(lc640_adr,data);
0014be  4669              MOV      r1,sp
0014c0  4628              MOV      r0,r5
0014c2  f7fffffe          BL       lc640_read_long_ptr
;;;1178        
;;;1179        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
0014c6  f89d0000          LDRB     r0,[sp,#0]
0014ca  2842              CMP      r0,#0x42
0014cc  d107              BNE      |L1.5342|
0014ce  f89d0001          LDRB     r0,[sp,#1]
0014d2  42b0              CMP      r0,r6
0014d4  d103              BNE      |L1.5342|
0014d6  f89d0002          LDRB     r0,[sp,#2]
0014da  2843              CMP      r0,#0x43
0014dc  d009              BEQ      |L1.5362|
                  |L1.5342|
;;;1180        	{        
;;;1181        	if(event_ptr_find)event_ptr_find--;
0014de  b11c              CBZ      r4,|L1.5352|
0014e0  f1a40401          SUB      r4,r4,#1
0014e4  b2a4              UXTH     r4,r4
0014e6  e001              B        |L1.5356|
                  |L1.5352|
;;;1182        	else event_ptr_find=63;
0014e8  f04f043f          MOV      r4,#0x3f
                  |L1.5356|
;;;1183        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
0014ec  42bc              CMP      r4,r7
0014ee  d1e3              BNE      |L1.5304|
0014f0  e05e              B        |L1.5552|
                  |L1.5362|
;;;1184        	else goto avar_bat_hndl_lbl1;
;;;1185        	}
;;;1186        else 
;;;1187        	{
;;;1188        	lc640_read_long_ptr(lc640_adr+16,data);
0014f2  4669              MOV      r1,sp
0014f4  f1050010          ADD      r0,r5,#0x10
0014f8  f7fffffe          BL       lc640_read_long_ptr
;;;1189        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0014fc  f89d0000          LDRB     r0,[sp,#0]
001500  2841              CMP      r0,#0x41
001502  d10b              BNE      |L1.5404|
001504  f89d0001          LDRB     r0,[sp,#1]
001508  2841              CMP      r0,#0x41
00150a  d107              BNE      |L1.5404|
00150c  f89d0002          LDRB     r0,[sp,#2]
001510  2841              CMP      r0,#0x41
001512  d103              BNE      |L1.5404|
001514  f89d0003          LDRB     r0,[sp,#3]
001518  2841              CMP      r0,#0x41
00151a  d009              BEQ      |L1.5424|
                  |L1.5404|
;;;1190        		{        
;;;1191        		if(event_ptr_find)event_ptr_find--;
00151c  b11c              CBZ      r4,|L1.5414|
00151e  f1a40401          SUB      r4,r4,#1
001522  b2a4              UXTH     r4,r4
001524  e001              B        |L1.5418|
                  |L1.5414|
;;;1192            		else event_ptr_find=63;
001526  f04f043f          MOV      r4,#0x3f
                  |L1.5418|
;;;1193            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
00152a  42bc              CMP      r4,r7
00152c  d1c4              BNE      |L1.5304|
00152e  e03f              B        |L1.5552|
                  |L1.5424|
;;;1194        		else goto avar_bat_hndl_lbl1;
;;;1195        		}
;;;1196   
;;;1197        	}
;;;1198        		
;;;1199   	data[0]=LPC_RTC->YEAR;
001530  f8b8003c          LDRH     r0,[r8,#0x3c]
001534  f88d0000          STRB     r0,[sp,#0]
;;;1200   	data[1]=LPC_RTC->MONTH;
001538  f8980038          LDRB     r0,[r8,#0x38]
00153c  f88d0001          STRB     r0,[sp,#1]
;;;1201   	data[2]=LPC_RTC->DOM;
001540  f898002c          LDRB     r0,[r8,#0x2c]
001544  f88d0002          STRB     r0,[sp,#2]
;;;1202   	data[3]=0;
001548  f88da003          STRB     r10,[sp,#3]
;;;1203   	lc640_write_long_ptr(lc640_adr+16,data);
00154c  4669              MOV      r1,sp
00154e  f1050010          ADD      r0,r5,#0x10
001552  f7fffffe          BL       lc640_write_long_ptr
;;;1204   
;;;1205   	data[0]=LPC_RTC->HOUR;
001556  f8980028          LDRB     r0,[r8,#0x28]
00155a  f88d0000          STRB     r0,[sp,#0]
;;;1206   	data[1]=LPC_RTC->MIN;
00155e  f8980024          LDRB     r0,[r8,#0x24]
001562  f88d0001          STRB     r0,[sp,#1]
;;;1207   	data[2]=LPC_RTC->SEC;
001566  f8980020          LDRB     r0,[r8,#0x20]
00156a  f88d0002          STRB     r0,[sp,#2]
;;;1208   	data[3]=0;
00156e  f88da003          STRB     r10,[sp,#3]
;;;1209   	lc640_write_long_ptr(lc640_adr+20,data);
001572  4669              MOV      r1,sp
001574  f1050014          ADD      r0,r5,#0x14
001578  f7fffffe          BL       lc640_write_long_ptr
;;;1210   	
;;;1211   	data[0]='B';
00157c  f88d9000          STRB     r9,[sp,#0]
;;;1212   	data[1]='B';
001580  f88d9001          STRB     r9,[sp,#1]
;;;1213   	data[2]='B';
001584  f88d9002          STRB     r9,[sp,#2]
;;;1214   	data[3]='B';
001588  f88d9003          STRB     r9,[sp,#3]
;;;1215   	lc640_write_long_ptr(lc640_adr+24,data);
00158c  4669              MOV      r1,sp
00158e  f1050018          ADD      r0,r5,#0x18
001592  f7fffffe          BL       lc640_write_long_ptr
;;;1216   	
;;;1217   	data[0]='B';
001596  f88d9000          STRB     r9,[sp,#0]
;;;1218   	data[1]='B';
00159a  f88d9001          STRB     r9,[sp,#1]
;;;1219   	data[2]='B';
00159e  f88d9002          STRB     r9,[sp,#2]
;;;1220   	data[3]='B';
0015a2  f88d9003          STRB     r9,[sp,#3]
;;;1221   	lc640_write_long_ptr(lc640_adr+28,data);
0015a6  4669              MOV      r1,sp
0015a8  f105001c          ADD      r0,r5,#0x1c
0015ac  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5552|
;;;1222   	
;;;1223   
;;;1224   	
;;;1225   	}
;;;1226   	
;;;1227   avar_bat_hndl_end:
;;;1228   __nop();		
0015b0  bf00              NOP      
                  |L1.5554|
;;;1229   }
0015b2  e4c4              B        |L1.3902|
;;;1230   
                          ENDP

                  avar_bat_temper_hndl PROC
;;;1231   //-----------------------------------------------
;;;1232   void avar_bat_temper_hndl(char b, char in)
0015b4  e92d4ff8          PUSH     {r3-r11,lr}
;;;1233   {
0015b8  4605              MOV      r5,r0
0015ba  460e              MOV      r6,r1
;;;1234   char data[4];
;;;1235   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1236   
;;;1237   if((in==1)||(in==3))
;;;1238   	{
;;;1239   	//bat[b]._av|=1;
;;;1240       
;;;1241   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1242   	event_ptr++;	
;;;1243   	if(event_ptr>63)event_ptr=0;	
;;;1244   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1245   	
;;;1246        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1247   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1248   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1249   	
;;;1250   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1251   	
;;;1252   	data[0]='B';
;;;1253   	data[1]=b;
;;;1254   	data[2]='T';
;;;1255   	data[3]='1';
;;;1256   	if(in==3)data[3]='3';
;;;1257   	lc640_write_long_ptr(lc640_adr,data);
;;;1258   
;;;1259   	data[0]=0;
;;;1260   	data[1]=0;
;;;1261   	data[2]=0;
;;;1262   	data[3]=0;
;;;1263   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1264   
;;;1265   	data[0]=LPC_RTC->YEAR;
0015bc  f8dfa2f0          LDR      r10,|L1.6320|
0015c0  f44f6060          MOV      r0,#0xe00             ;1241
0015c4  f44f6780          MOV      r7,#0x400             ;1250
0015c8  2e01              CMP      r6,#1                 ;1237
0015ca  d010              BEQ      |L1.5614|
0015cc  2e03              CMP      r6,#3                 ;1237
0015ce  d00e              BEQ      |L1.5614|
;;;1266   	data[1]=LPC_RTC->MONTH;
;;;1267   	data[2]=LPC_RTC->DOM;
;;;1268   	data[3]=0;
;;;1269   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1270   
;;;1271   	data[0]=LPC_RTC->HOUR;
;;;1272   	data[1]=LPC_RTC->MIN;
;;;1273   	data[2]=LPC_RTC->SEC;
;;;1274   	data[3]=0;
;;;1275   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1276   	
;;;1277   	data[0]='A';
;;;1278   	data[1]='A';
;;;1279   	data[2]='A';
;;;1280   	data[3]='A';
;;;1281   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1282   	
;;;1283   	data[0]='A';
;;;1284   	data[1]='A';
;;;1285   	data[2]='A';
;;;1286   	data[3]='A';
;;;1287   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1288   	
;;;1289   	data[0]='A';
;;;1290   	data[1]='A';
;;;1291   	data[2]='A';
;;;1292   	data[3]='A';
;;;1293   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1294   	
;;;1295   	data[0]='A';
;;;1296   	data[1]='A';
;;;1297   	data[2]='A';
;;;1298   	data[3]='A';
;;;1299   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1300   	if(in==1)
;;;1301   		{				
;;;1302   		if(b==0)
;;;1303   			{
;;;1304   			snmp_trap_send("BAT #1 Alarm, is heated",10,1,1);
;;;1305   			}
;;;1306   		else if(b==1)
;;;1307   			{
;;;1308   			snmp_trap_send("BAT #2 Alarm, is heated",10,2,1);
;;;1309   			} 
;;;1310   		}
;;;1311   	if(in==3)
;;;1312   		{				
;;;1313   		if(b==0)
;;;1314   			{
;;;1315   			snmp_trap_send("BAT #1 Alarm, is overheated",11,1,1);
;;;1316   			}
;;;1317   		else if(b==1)
;;;1318   			{
;;;1319   			snmp_trap_send("BAT #2 Alarm, is overheated",11,2,1);
;;;1320   			} 
;;;1321   		}			
;;;1322   	}
;;;1323   
;;;1324   else if((in==0)||(in==2))
0015d0  b10e              CBZ      r6,|L1.5590|
0015d2  2e02              CMP      r6,#2
0015d4  d17e              BNE      |L1.5844|
                  |L1.5590|
;;;1325   	{
;;;1326   	char i;
;;;1327   
;;;1328   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0015d6  f7fffffe          BL       lc640_read_int
0015da  fa1ff980          UXTH     r9,r0
;;;1329   	event_ptr_find=event_ptr;
0015de  464c              MOV      r4,r9
;;;1330   
;;;1331   /*	for (i=0;i<63;i++)
;;;1332   		{
;;;1333   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1334   
;;;1335        	lc640_read_long_ptr(lc640_adr,data);
;;;1336        
;;;1337        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;1338        		{        
;;;1339        		if(event_ptr_find)event_ptr_find--;
;;;1340        		else event_ptr_find=63;
;;;1341        		if(event_ptr_find==event_ptr)
;;;1342   				{
;;;1343   				lc640_adr=0;
;;;1344   				break;
;;;1345   				}
;;;1346        		else continue;
;;;1347        		}
;;;1348        	else 
;;;1349        		{
;;;1350        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1351        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1352        			{        
;;;1353        			if(event_ptr_find)event_ptr_find--;
;;;1354            		else event_ptr_find=63;
;;;1355            		if(event_ptr_find==event_ptr)
;;;1356   					{
;;;1357   					lc640_adr=0;
;;;1358   					break;
;;;1359   					}
;;;1360        			else continue;
;;;1361        			}
;;;1362        		}	
;;;1363   		}*/
;;;1364   	
;;;1365   	for (i=0;i<63;i++)
0015e0  f04f0800          MOV      r8,#0
                  |L1.5604|
;;;1366   		{
;;;1367   		char temp='1';
0015e4  f04f0b31          MOV      r11,#0x31
;;;1368   		if(in==2)temp='3';
0015e8  2e02              CMP      r6,#2
0015ea  d074              BEQ      |L1.5846|
0015ec  e0c7              B        |L1.6014|
                  |L1.5614|
0015ee  4680              MOV      r8,r0                 ;1241
0015f0  f7fffffe          BL       lc640_read_int
0015f4  f1000001          ADD      r0,r0,#1              ;1242
0015f8  b284              UXTH     r4,r0                 ;1242
0015fa  2c3f              CMP      r4,#0x3f              ;1243
0015fc  d901              BLS      |L1.5634|
0015fe  f04f0400          MOV      r4,#0                 ;1243
                  |L1.5634|
001602  b221              SXTH     r1,r4                 ;1244
001604  4640              MOV      r0,r8                 ;1244
001606  f7fffffe          BL       lc640_write_int
00160a  f6406902          MOV      r9,#0xe02             ;1246
00160e  4648              MOV      r0,r9                 ;1246
001610  f7fffffe          BL       lc640_read_int
001614  b280              UXTH     r0,r0                 ;1246
001616  283f              CMP      r0,#0x3f              ;1247
001618  d000              BEQ      |L1.5660|
00161a  4620              MOV      r0,r4                 ;1247
                  |L1.5660|
00161c  b201              SXTH     r1,r0                 ;1248
00161e  4648              MOV      r0,r9                 ;1248
001620  f7fffffe          BL       lc640_write_int
001624  4640              MOV      r0,r8                 ;1250
001626  f7fffffe          BL       lc640_read_int
00162a  eb071040          ADD      r0,r7,r0,LSL #5       ;1250
00162e  b284              UXTH     r4,r0                 ;1250
001630  f04f0042          MOV      r0,#0x42              ;1252
001634  f88d0000          STRB     r0,[sp,#0]            ;1252
001638  f88d5001          STRB     r5,[sp,#1]            ;1253
00163c  f04f0054          MOV      r0,#0x54              ;1254
001640  f88d0002          STRB     r0,[sp,#2]            ;1254
001644  f04f0031          MOV      r0,#0x31              ;1255
001648  f88d0003          STRB     r0,[sp,#3]            ;1255
00164c  2e03              CMP      r6,#3                 ;1256
00164e  d103              BNE      |L1.5720|
001650  f04f0033          MOV      r0,#0x33              ;1256
001654  f88d0003          STRB     r0,[sp,#3]            ;1256
                  |L1.5720|
001658  4669              MOV      r1,sp                 ;1257
00165a  4620              MOV      r0,r4                 ;1257
00165c  f7fffffe          BL       lc640_write_long_ptr
001660  f04f0700          MOV      r7,#0                 ;1259
001664  9700              STR      r7,[sp,#0]            ;1262
001666  4669              MOV      r1,sp                 ;1263
001668  f1040004          ADD      r0,r4,#4              ;1263
00166c  f7fffffe          BL       lc640_write_long_ptr
001670  f8ba003c          LDRH     r0,[r10,#0x3c]        ;1265
001674  f88d0000          STRB     r0,[sp,#0]            ;1265
001678  f89a0038          LDRB     r0,[r10,#0x38]        ;1266
00167c  f88d0001          STRB     r0,[sp,#1]            ;1266
001680  f89a002c          LDRB     r0,[r10,#0x2c]        ;1267
001684  f88d0002          STRB     r0,[sp,#2]            ;1267
001688  f88d7003          STRB     r7,[sp,#3]            ;1268
00168c  4669              MOV      r1,sp                 ;1269
00168e  f1040008          ADD      r0,r4,#8              ;1269
001692  f7fffffe          BL       lc640_write_long_ptr
001696  f89a0028          LDRB     r0,[r10,#0x28]        ;1271
00169a  f88d0000          STRB     r0,[sp,#0]            ;1271
00169e  f89a0024          LDRB     r0,[r10,#0x24]        ;1272
0016a2  f88d0001          STRB     r0,[sp,#1]            ;1272
0016a6  f89a0020          LDRB     r0,[r10,#0x20]        ;1273
0016aa  f88d0002          STRB     r0,[sp,#2]            ;1273
0016ae  f88d7003          STRB     r7,[sp,#3]            ;1274
0016b2  4669              MOV      r1,sp                 ;1275
0016b4  f104000c          ADD      r0,r4,#0xc            ;1275
0016b8  f7fffffe          BL       lc640_write_long_ptr
0016bc  f04f0741          MOV      r7,#0x41              ;1277
0016c0  f88d7000          STRB     r7,[sp,#0]            ;1277
0016c4  f88d7001          STRB     r7,[sp,#1]            ;1278
0016c8  f88d7002          STRB     r7,[sp,#2]            ;1279
0016cc  f88d7003          STRB     r7,[sp,#3]            ;1280
0016d0  4669              MOV      r1,sp                 ;1281
0016d2  e001              B        |L1.5848|
                  |L1.5844|
0016d4  e049              B        |L1.5994|
                  |L1.5846|
0016d6  e050              B        |L1.6010|
                  |L1.5848|
0016d8  f1040010          ADD      r0,r4,#0x10           ;1281
0016dc  f7fffffe          BL       lc640_write_long_ptr
0016e0  f88d7000          STRB     r7,[sp,#0]            ;1283
0016e4  f88d7001          STRB     r7,[sp,#1]            ;1284
0016e8  f88d7002          STRB     r7,[sp,#2]            ;1285
0016ec  f88d7003          STRB     r7,[sp,#3]            ;1286
0016f0  4669              MOV      r1,sp                 ;1287
0016f2  f1040014          ADD      r0,r4,#0x14           ;1287
0016f6  f7fffffe          BL       lc640_write_long_ptr
0016fa  f88d7000          STRB     r7,[sp,#0]            ;1289
0016fe  f88d7001          STRB     r7,[sp,#1]            ;1290
001702  f88d7002          STRB     r7,[sp,#2]            ;1291
001706  f88d7003          STRB     r7,[sp,#3]            ;1292
00170a  4669              MOV      r1,sp                 ;1293
00170c  f1040018          ADD      r0,r4,#0x18           ;1293
001710  f7fffffe          BL       lc640_write_long_ptr
001714  f88d7000          STRB     r7,[sp,#0]            ;1295
001718  f88d7001          STRB     r7,[sp,#1]            ;1296
00171c  f88d7002          STRB     r7,[sp,#2]            ;1297
001720  f88d7003          STRB     r7,[sp,#3]            ;1298
001724  4669              MOV      r1,sp                 ;1299
001726  f104001c          ADD      r0,r4,#0x1c           ;1299
00172a  f7fffffe          BL       lc640_write_long_ptr
00172e  2e01              CMP      r6,#1                 ;1300
001730  d110              BNE      |L1.5972|
001732  b115              CBZ      r5,|L1.5946|
001734  2d01              CMP      r5,#1                 ;1306
001736  d007              BEQ      |L1.5960|
001738  e00c              B        |L1.5972|
                  |L1.5946|
00173a  2301              MOVS     r3,#1                 ;1304
00173c  461a              MOV      r2,r3                 ;1304
00173e  210a              MOVS     r1,#0xa               ;1304
001740  a05c              ADR      r0,|L1.6324|
001742  f7fffffe          BL       snmp_trap_send
001746  e005              B        |L1.5972|
                  |L1.5960|
001748  2301              MOVS     r3,#1                 ;1308
00174a  2202              MOVS     r2,#2                 ;1308
00174c  210a              MOVS     r1,#0xa               ;1308
00174e  a05f              ADR      r0,|L1.6348|
001750  f7fffffe          BL       snmp_trap_send
                  |L1.5972|
001754  2e03              CMP      r6,#3                 ;1311
001756  d108              BNE      |L1.5994|
001758  b145              CBZ      r5,|L1.5996|
00175a  2d01              CMP      r5,#1                 ;1317
00175c  d105              BNE      |L1.5994|
00175e  2301              MOVS     r3,#1                 ;1319
001760  2202              MOVS     r2,#2                 ;1319
001762  210b              MOVS     r1,#0xb               ;1319
001764  a05f              ADR      r0,|L1.6372|
001766  f7fffffe          BL       snmp_trap_send
                  |L1.5994|
;;;1369   
;;;1370   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1371   
;;;1372        	lc640_read_long_ptr(lc640_adr,data);
;;;1373        
;;;1374        	if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='T')&&(data[3]==temp)))
;;;1375        		{        
;;;1376        		if(event_ptr_find)event_ptr_find--;
;;;1377        		else event_ptr_find=63;
;;;1378        		if(event_ptr_find==event_ptr)				{
;;;1379   				lc640_adr=0;
;;;1380   				break;
;;;1381   				}
;;;1382        		else continue;
;;;1383        		}
;;;1384   	     else 
;;;1385   	     	{
;;;1386   	     	lc640_read_long_ptr(lc640_adr+16,data);
;;;1387   	     	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1388   	     		{        
;;;1389   	     		if(event_ptr_find)event_ptr_find--;
;;;1390   	         	else event_ptr_find=63;
;;;1391   	         	if(event_ptr_find==event_ptr)				{
;;;1392   					lc640_adr=0;
;;;1393   					break;
;;;1394   					}
;;;1395   	     		else continue;
;;;1396   	     		}
;;;1397   	
;;;1398   	     	}
;;;1399   		}
;;;1400        		
;;;1401   	data[0]=LPC_RTC->YEAR;
;;;1402   	data[1]=LPC_RTC->MONTH;
;;;1403   	data[2]=LPC_RTC->DOM;
;;;1404   	data[3]=0;
;;;1405   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1406   
;;;1407   	data[0]=LPC_RTC->HOUR;
;;;1408   	data[1]=LPC_RTC->MIN;
;;;1409   	data[2]=LPC_RTC->SEC;
;;;1410   	data[3]=0;
;;;1411   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1412   	
;;;1413   	data[0]='B';
;;;1414   	data[1]='B';
;;;1415   	data[2]='B';
;;;1416   	data[3]='B';
;;;1417   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1418   	
;;;1419   	data[0]='B';
;;;1420   	data[1]='B';
;;;1421   	data[2]='B';
;;;1422   	data[3]='B';
;;;1423   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1424   	
;;;1425   	if(in==1)
;;;1426   		{				
;;;1427   		if(b==0)
;;;1428   			{
;;;1429   			snmp_trap_send("BAT #1 Alarm, heating eliminated",10,1,0);
;;;1430   			}
;;;1431   		else if(b==1)
;;;1432   			{
;;;1433   			snmp_trap_send("BAT #2 Alarm, heating eliminated",10,2,0);
;;;1434   			} 
;;;1435   		}
;;;1436   	if(in==3)
;;;1437   		{				
;;;1438   		if(b==0)
;;;1439   			{
;;;1440   			snmp_trap_send("BAT #1 Alarm, overheating eliminated",11,1,0);
;;;1441   			}
;;;1442   		else if(b==1)
;;;1443   			{
;;;1444   			snmp_trap_send("BAT #2 Alarm, overheating eliminated",11,2,0);
;;;1445   			} 
;;;1446   		}		
;;;1447   	
;;;1448   	}
;;;1449   	
;;;1450   }
00176a  e5bd              B        |L1.4840|
                  |L1.5996|
00176c  2301              MOVS     r3,#1                 ;1315
00176e  461a              MOV      r2,r3                 ;1315
001770  210b              MOVS     r1,#0xb               ;1315
001772  a063              ADR      r0,|L1.6400|
001774  f7fffffe          BL       snmp_trap_send
001778  e5b6              B        |L1.4840|
                  |L1.6010|
00177a  f04f0b33          MOV      r11,#0x33             ;1368
                  |L1.6014|
00177e  f44f6080          MOV      r0,#0x400             ;1370
001782  eb001044          ADD      r0,r0,r4,LSL #5       ;1370
001786  b287              UXTH     r7,r0                 ;1370
001788  4669              MOV      r1,sp                 ;1372
00178a  4638              MOV      r0,r7                 ;1372
00178c  f7fffffe          BL       lc640_read_long_ptr
001790  f89d0000          LDRB     r0,[sp,#0]            ;1374
001794  2842              CMP      r0,#0x42              ;1374
001796  d10b              BNE      |L1.6064|
001798  f89d0001          LDRB     r0,[sp,#1]            ;1374
00179c  42a8              CMP      r0,r5                 ;1374
00179e  d107              BNE      |L1.6064|
0017a0  f89d0002          LDRB     r0,[sp,#2]            ;1374
0017a4  2854              CMP      r0,#0x54              ;1374
0017a6  d103              BNE      |L1.6064|
0017a8  f89d0003          LDRB     r0,[sp,#3]            ;1374
0017ac  4558              CMP      r0,r11                ;1374
0017ae  d00b              BEQ      |L1.6088|
                  |L1.6064|
0017b0  b11c              CBZ      r4,|L1.6074|
0017b2  f1a40401          SUB      r4,r4,#1              ;1376
0017b6  b2a4              UXTH     r4,r4                 ;1376
0017b8  e001              B        |L1.6078|
                  |L1.6074|
0017ba  f04f043f          MOV      r4,#0x3f              ;1377
                  |L1.6078|
0017be  454c              CMP      r4,r9                 ;1378
0017c0  d123              BNE      |L1.6154|
0017c2  f04f0700          MOV      r7,#0                 ;1379
0017c6  e028              B        |L1.6170|
                  |L1.6088|
0017c8  4669              MOV      r1,sp                 ;1386
0017ca  f1070010          ADD      r0,r7,#0x10           ;1386
0017ce  f7fffffe          BL       lc640_read_long_ptr
0017d2  f89d0000          LDRB     r0,[sp,#0]            ;1387
0017d6  2841              CMP      r0,#0x41              ;1387
0017d8  d10b              BNE      |L1.6130|
0017da  f89d0001          LDRB     r0,[sp,#1]            ;1387
0017de  2841              CMP      r0,#0x41              ;1387
0017e0  d107              BNE      |L1.6130|
0017e2  f89d0002          LDRB     r0,[sp,#2]            ;1387
0017e6  2841              CMP      r0,#0x41              ;1387
0017e8  d103              BNE      |L1.6130|
0017ea  f89d0003          LDRB     r0,[sp,#3]            ;1387
0017ee  2841              CMP      r0,#0x41              ;1387
0017f0  d00b              BEQ      |L1.6154|
                  |L1.6130|
0017f2  b11c              CBZ      r4,|L1.6140|
0017f4  f1a40401          SUB      r4,r4,#1              ;1389
0017f8  b2a4              UXTH     r4,r4                 ;1389
0017fa  e001              B        |L1.6144|
                  |L1.6140|
0017fc  f04f043f          MOV      r4,#0x3f              ;1390
                  |L1.6144|
001800  454c              CMP      r4,r9                 ;1391
001802  d102              BNE      |L1.6154|
001804  f04f0700          MOV      r7,#0                 ;1392
001808  e007              B        |L1.6170|
                  |L1.6154|
00180a  f1080801          ADD      r8,r8,#1              ;1365
00180e  f00808ff          AND      r8,r8,#0xff           ;1365
001812  f1b80f3f          CMP      r8,#0x3f              ;1365
001816  f4ffaee5          BCC      |L1.5604|
                  |L1.6170|
00181a  f8ba003c          LDRH     r0,[r10,#0x3c]        ;1401
00181e  f88d0000          STRB     r0,[sp,#0]            ;1401
001822  f89a0038          LDRB     r0,[r10,#0x38]        ;1402
001826  f88d0001          STRB     r0,[sp,#1]            ;1402
00182a  f89a002c          LDRB     r0,[r10,#0x2c]        ;1403
00182e  f88d0002          STRB     r0,[sp,#2]            ;1403
001832  f04f0400          MOV      r4,#0                 ;1404
001836  f88d4003          STRB     r4,[sp,#3]            ;1404
00183a  4669              MOV      r1,sp                 ;1405
00183c  f1070010          ADD      r0,r7,#0x10           ;1405
001840  f7fffffe          BL       lc640_write_long_ptr
001844  f89a0028          LDRB     r0,[r10,#0x28]        ;1407
001848  f88d0000          STRB     r0,[sp,#0]            ;1407
00184c  f89a0024          LDRB     r0,[r10,#0x24]        ;1408
001850  f88d0001          STRB     r0,[sp,#1]            ;1408
001854  f89a0020          LDRB     r0,[r10,#0x20]        ;1409
001858  f88d0002          STRB     r0,[sp,#2]            ;1409
00185c  f88d4003          STRB     r4,[sp,#3]            ;1410
001860  4669              MOV      r1,sp                 ;1411
001862  f1070014          ADD      r0,r7,#0x14           ;1411
001866  f7fffffe          BL       lc640_write_long_ptr
00186a  f04f0442          MOV      r4,#0x42              ;1413
00186e  f88d4000          STRB     r4,[sp,#0]            ;1413
001872  f88d4001          STRB     r4,[sp,#1]            ;1414
001876  f88d4002          STRB     r4,[sp,#2]            ;1415
00187a  f88d4003          STRB     r4,[sp,#3]            ;1416
00187e  4669              MOV      r1,sp                 ;1417
001880  f1070018          ADD      r0,r7,#0x18           ;1417
001884  e04a              B        |L1.6428|
001886  0000              DCW      0x0000
                  |L1.6280|
001888  42415420          DCB      "BAT #1 Alarm, lost",0
00188c  23312041
001890  6c61726d
001894  2c206c6f
001898  737400  
00189b  00                DCB      0
                  |L1.6300|
00189c  42415420          DCB      "BAT #2 Alarm, lost",0
0018a0  23322041
0018a4  6c61726d
0018a8  2c206c6f
0018ac  737400  
0018af  00                DCB      0
                  |L1.6320|
                          DCD      0x40024000
                  |L1.6324|
0018b4  42415420          DCB      "BAT #1 Alarm, is heated",0
0018b8  23312041
0018bc  6c61726d
0018c0  2c206973
0018c4  20686561
0018c8  74656400
                  |L1.6348|
0018cc  42415420          DCB      "BAT #2 Alarm, is heated",0
0018d0  23322041
0018d4  6c61726d
0018d8  2c206973
0018dc  20686561
0018e0  74656400
                  |L1.6372|
0018e4  42415420          DCB      "BAT #2 Alarm, is overheated",0
0018e8  23322041
0018ec  6c61726d
0018f0  2c206973
0018f4  206f7665
0018f8  72686561
0018fc  74656400
                  |L1.6400|
001900  42415420          DCB      "BAT #1 Alarm, is overheated",0
001904  23312041
001908  6c61726d
00190c  2c206973
001910  206f7665
001914  72686561
001918  74656400
                  |L1.6428|
00191c  f7fffffe          BL       lc640_write_long_ptr
001920  f88d4000          STRB     r4,[sp,#0]            ;1419
001924  f88d4001          STRB     r4,[sp,#1]            ;1420
001928  f88d4002          STRB     r4,[sp,#2]            ;1421
00192c  f88d4003          STRB     r4,[sp,#3]            ;1422
001930  4669              MOV      r1,sp                 ;1423
001932  f107001c          ADD      r0,r7,#0x1c           ;1423
001936  f7fffffe          BL       lc640_write_long_ptr
00193a  2e01              CMP      r6,#1                 ;1425
00193c  d110              BNE      |L1.6496|
00193e  b115              CBZ      r5,|L1.6470|
001940  2d01              CMP      r5,#1                 ;1431
001942  d007              BEQ      |L1.6484|
001944  e00c              B        |L1.6496|
                  |L1.6470|
001946  2300              MOVS     r3,#0                 ;1429
001948  2201              MOVS     r2,#1                 ;1429
00194a  210a              MOVS     r1,#0xa               ;1429
00194c  a0e9              ADR      r0,|L1.7412|
00194e  f7fffffe          BL       snmp_trap_send
001952  e005              B        |L1.6496|
                  |L1.6484|
001954  2300              MOVS     r3,#0                 ;1433
001956  2202              MOVS     r2,#2                 ;1433
001958  210a              MOVS     r1,#0xa               ;1433
00195a  a0ef              ADR      r0,|L1.7448|
00195c  f7fffffe          BL       snmp_trap_send
                  |L1.6496|
001960  2e03              CMP      r6,#3                 ;1436
                  |L1.6498|
001962  f47faf02          BNE      |L1.5994|
001966  b145              CBZ      r5,|L1.6522|
001968  2d01              CMP      r5,#1                 ;1442
00196a  d1fa              BNE      |L1.6498|
00196c  2300              MOVS     r3,#0                 ;1444
00196e  2202              MOVS     r2,#2                 ;1444
001970  210b              MOVS     r1,#0xb               ;1444
001972  a0f2              ADR      r0,|L1.7484|
001974  f7fffffe          BL       snmp_trap_send
                  |L1.6520|
001978  e4b6              B        |L1.4840|
                  |L1.6522|
00197a  2300              MOVS     r3,#0                 ;1440
00197c  2201              MOVS     r2,#1                 ;1440
00197e  210b              MOVS     r1,#0xb               ;1440
001980  a0f8              ADR      r0,|L1.7524|
001982  f7fffffe          BL       snmp_trap_send
001986  e4af              B        |L1.4840|
;;;1451   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1452   //-----------------------------------------------
;;;1453   void avar_bat_as_hndl(char b, char in)
001988  e92d4ff8          PUSH     {r3-r11,lr}
;;;1454   {
00198c  4606              MOV      r6,r0
;;;1455   char data[4];
;;;1456   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1457   
;;;1458   if(in==1)
;;;1459   	{
;;;1460   	bat[b]._av|=2;
00198e  48ff              LDR      r0,|L1.7564|
001990  eb060246          ADD      r2,r6,r6,LSL #1
;;;1461       
;;;1462   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1463   	event_ptr++;	
;;;1464   	if(event_ptr>63)event_ptr=0;	
;;;1465   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1466   	
;;;1467        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1468   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1469   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1470   	
;;;1471   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1472   	
;;;1473   	data[0]='B';
;;;1474   	data[1]=b;
;;;1475   	data[2]='S';
;;;1476   	data[3]=0;
;;;1477   	lc640_write_long_ptr(lc640_adr,data);
;;;1478   
;;;1479   	data[0]=0;
;;;1480   	data[1]=0;
;;;1481   	data[2]=0;
;;;1482   	data[3]=0;
;;;1483   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1484   
;;;1485   	data[0]=LPC_RTC->YEAR;
001994  f8df83f8          LDR      r8,|L1.7568|
001998  eb021206          ADD      r2,r2,r6,LSL #4       ;1460
00199c  f04f0a00          MOV      r10,#0                ;1464
0019a0  f04f0942          MOV      r9,#0x42              ;1473
0019a4  f44f6560          MOV      r5,#0xe00             ;1462
0019a8  f44f6b80          MOV      r11,#0x400            ;1471
0019ac  eb000082          ADD      r0,r0,r2,LSL #2       ;1460
0019b0  2901              CMP      r1,#1                 ;1458
0019b2  d002              BEQ      |L1.6586|
;;;1486   	data[1]=LPC_RTC->MONTH;
;;;1487   	data[2]=LPC_RTC->DOM;
;;;1488   	data[3]=0;
;;;1489   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1490   
;;;1491   	data[0]=LPC_RTC->HOUR;
;;;1492   	data[1]=LPC_RTC->MIN;
;;;1493   	data[2]=LPC_RTC->SEC;
;;;1494   	data[3]=0;
;;;1495   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1496   	
;;;1497   	data[0]='A';
;;;1498   	data[1]='A';
;;;1499   	data[2]='A';
;;;1500   	data[3]='A';
;;;1501   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1502   	
;;;1503   	data[0]='A';
;;;1504   	data[1]='A';
;;;1505   	data[2]='A';
;;;1506   	data[3]='A';
;;;1507   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1508   	
;;;1509   	data[0]='A';
;;;1510   	data[1]='A';
;;;1511   	data[2]='A';
;;;1512   	data[3]='A';
;;;1513   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1514   	
;;;1515   	data[0]='A';
;;;1516   	data[1]='A';
;;;1517   	data[2]='A';
;;;1518   	data[3]='A';
;;;1519   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1520   
;;;1521   	if(b==0)
;;;1522   		{
;;;1523   		snmp_trap_send("BAT #1 Alarm, assimetry",5,1,2);
;;;1524   		}
;;;1525   	else if(b==1)
;;;1526   		{
;;;1527   		snmp_trap_send("BAT #2 Alarm, assimetry",5,2,2);
;;;1528   		} 
;;;1529   	
;;;1530   	}
;;;1531   
;;;1532   else if(in==0)
0019b4  2900              CMP      r1,#0
0019b6  d07d              BEQ      |L1.6836|
0019b8  e12f              B        |L1.7194|
                  |L1.6586|
0019ba  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1460
0019be  f0410102          ORR      r1,r1,#2              ;1460
0019c2  7001              STRB     r1,[r0,#0]            ;1460
0019c4  4628              MOV      r0,r5                 ;1462
0019c6  f7fffffe          BL       lc640_read_int
0019ca  f1000001          ADD      r0,r0,#1              ;1463
0019ce  b284              UXTH     r4,r0                 ;1463
0019d0  2c3f              CMP      r4,#0x3f              ;1464
0019d2  d901              BLS      |L1.6616|
0019d4  f04f0400          MOV      r4,#0                 ;1464
                  |L1.6616|
0019d8  b221              SXTH     r1,r4                 ;1465
0019da  4628              MOV      r0,r5                 ;1465
0019dc  f7fffffe          BL       lc640_write_int
0019e0  f6406702          MOV      r7,#0xe02             ;1467
0019e4  4638              MOV      r0,r7                 ;1467
0019e6  f7fffffe          BL       lc640_read_int
0019ea  b280              UXTH     r0,r0                 ;1467
0019ec  283f              CMP      r0,#0x3f              ;1468
0019ee  d000              BEQ      |L1.6642|
0019f0  4620              MOV      r0,r4                 ;1468
                  |L1.6642|
0019f2  b201              SXTH     r1,r0                 ;1469
0019f4  4638              MOV      r0,r7                 ;1469
0019f6  f7fffffe          BL       lc640_write_int
0019fa  4628              MOV      r0,r5                 ;1471
0019fc  f7fffffe          BL       lc640_read_int
001a00  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1471
001a04  b284              UXTH     r4,r0                 ;1471
001a06  f88d9000          STRB     r9,[sp,#0]            ;1473
001a0a  f88d6001          STRB     r6,[sp,#1]            ;1474
001a0e  f04f0053          MOV      r0,#0x53              ;1475
001a12  f88d0002          STRB     r0,[sp,#2]            ;1475
001a16  f88da003          STRB     r10,[sp,#3]           ;1476
001a1a  4669              MOV      r1,sp                 ;1477
001a1c  4620              MOV      r0,r4                 ;1477
001a1e  f7fffffe          BL       lc640_write_long_ptr
001a22  f8cda000          STR      r10,[sp,#0]           ;1482
001a26  4669              MOV      r1,sp                 ;1483
001a28  1d20              ADDS     r0,r4,#4              ;1483
001a2a  f7fffffe          BL       lc640_write_long_ptr
001a2e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1485
001a32  f88d0000          STRB     r0,[sp,#0]            ;1485
001a36  f8980038          LDRB     r0,[r8,#0x38]         ;1486
001a3a  f88d0001          STRB     r0,[sp,#1]            ;1486
001a3e  f898002c          LDRB     r0,[r8,#0x2c]         ;1487
001a42  f88d0002          STRB     r0,[sp,#2]            ;1487
001a46  f88da003          STRB     r10,[sp,#3]           ;1488
001a4a  4669              MOV      r1,sp                 ;1489
001a4c  f1040008          ADD      r0,r4,#8              ;1489
001a50  f7fffffe          BL       lc640_write_long_ptr
001a54  f8980028          LDRB     r0,[r8,#0x28]         ;1491
001a58  f88d0000          STRB     r0,[sp,#0]            ;1491
001a5c  f8980024          LDRB     r0,[r8,#0x24]         ;1492
001a60  f88d0001          STRB     r0,[sp,#1]            ;1492
001a64  f8980020          LDRB     r0,[r8,#0x20]         ;1493
001a68  f88d0002          STRB     r0,[sp,#2]            ;1493
001a6c  f88da003          STRB     r10,[sp,#3]           ;1494
001a70  4669              MOV      r1,sp                 ;1495
001a72  f104000c          ADD      r0,r4,#0xc            ;1495
001a76  f7fffffe          BL       lc640_write_long_ptr
001a7a  f04f0541          MOV      r5,#0x41              ;1497
001a7e  f88d5000          STRB     r5,[sp,#0]            ;1497
001a82  f88d5001          STRB     r5,[sp,#1]            ;1498
001a86  f88d5002          STRB     r5,[sp,#2]            ;1499
001a8a  f88d5003          STRB     r5,[sp,#3]            ;1500
001a8e  4669              MOV      r1,sp                 ;1501
001a90  f1040010          ADD      r0,r4,#0x10           ;1501
001a94  f7fffffe          BL       lc640_write_long_ptr
001a98  f88d5000          STRB     r5,[sp,#0]            ;1503
001a9c  f88d5001          STRB     r5,[sp,#1]            ;1504
001aa0  f88d5002          STRB     r5,[sp,#2]            ;1505
001aa4  f88d5003          STRB     r5,[sp,#3]            ;1506
001aa8  4669              MOV      r1,sp                 ;1507
001aaa  f1040014          ADD      r0,r4,#0x14           ;1507
001aae  f7fffffe          BL       lc640_write_long_ptr
001ab2  e000              B        |L1.6838|
                  |L1.6836|
001ab4  e02b              B        |L1.6926|
                  |L1.6838|
001ab6  f88d5000          STRB     r5,[sp,#0]            ;1509
001aba  f88d5001          STRB     r5,[sp,#1]            ;1510
001abe  f88d5002          STRB     r5,[sp,#2]            ;1511
001ac2  f88d5003          STRB     r5,[sp,#3]            ;1512
001ac6  4669              MOV      r1,sp                 ;1513
001ac8  f1040018          ADD      r0,r4,#0x18           ;1513
001acc  f7fffffe          BL       lc640_write_long_ptr
001ad0  f88d5000          STRB     r5,[sp,#0]            ;1515
001ad4  f88d5001          STRB     r5,[sp,#1]            ;1516
001ad8  f88d5002          STRB     r5,[sp,#2]            ;1517
001adc  f88d5003          STRB     r5,[sp,#3]            ;1518
001ae0  4669              MOV      r1,sp                 ;1519
001ae2  f104001c          ADD      r0,r4,#0x1c           ;1519
001ae6  f7fffffe          BL       lc640_write_long_ptr
001aea  b116              CBZ      r6,|L1.6898|
001aec  2e01              CMP      r6,#1                 ;1525
001aee  d007              BEQ      |L1.6912|
001af0  e093              B        |L1.7194|
                  |L1.6898|
001af2  2302              MOVS     r3,#2                 ;1523
001af4  2201              MOVS     r2,#1                 ;1523
001af6  2105              MOVS     r1,#5                 ;1523
001af8  a0a6              ADR      r0,|L1.7572|
001afa  f7fffffe          BL       snmp_trap_send
001afe  e08c              B        |L1.7194|
                  |L1.6912|
001b00  2302              MOVS     r3,#2                 ;1527
001b02  461a              MOV      r2,r3                 ;1527
001b04  2105              MOVS     r1,#5                 ;1527
001b06  a0a9              ADR      r0,|L1.7596|
001b08  f7fffffe          BL       snmp_trap_send
001b0c  e085              B        |L1.7194|
                  |L1.6926|
;;;1533   	{
;;;1534   	bat[b]._av&=~(1<<1);
001b0e  f8101f3d          LDRB     r1,[r0,#0x3d]!
001b12  f0210102          BIC      r1,r1,#2
001b16  7001              STRB     r1,[r0,#0]
;;;1535   
;;;1536        event_ptr=lc640_read_int(PTR_EVENT_LOG);
001b18  4628              MOV      r0,r5
001b1a  f7fffffe          BL       lc640_read_int
001b1e  b287              UXTH     r7,r0
;;;1537   	event_ptr_find=event_ptr;
001b20  463c              MOV      r4,r7
                  |L1.6946|
;;;1538   	
;;;1539   avar_bat_as_hndl_lbl1: 
;;;1540   
;;;1541   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001b22  eb0b1044          ADD      r0,r11,r4,LSL #5
001b26  b285              UXTH     r5,r0
;;;1542   
;;;1543        lc640_read_long_ptr(lc640_adr,data);
001b28  4669              MOV      r1,sp
001b2a  4628              MOV      r0,r5
001b2c  f7fffffe          BL       lc640_read_long_ptr
;;;1544        
;;;1545        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
001b30  f89d0000          LDRB     r0,[sp,#0]
001b34  2842              CMP      r0,#0x42
001b36  d107              BNE      |L1.6984|
001b38  f89d0001          LDRB     r0,[sp,#1]
001b3c  42b0              CMP      r0,r6
001b3e  d103              BNE      |L1.6984|
001b40  f89d0002          LDRB     r0,[sp,#2]
001b44  2843              CMP      r0,#0x43
001b46  d009              BEQ      |L1.7004|
                  |L1.6984|
;;;1546        	{        
;;;1547        	if(event_ptr_find)event_ptr_find--;
001b48  b11c              CBZ      r4,|L1.6994|
001b4a  f1a40401          SUB      r4,r4,#1
001b4e  b2a4              UXTH     r4,r4
001b50  e001              B        |L1.6998|
                  |L1.6994|
;;;1548        	else event_ptr_find=63;
001b52  f04f043f          MOV      r4,#0x3f
                  |L1.6998|
;;;1549        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001b56  42bc              CMP      r4,r7
001b58  d1e3              BNE      |L1.6946|
001b5a  e05e              B        |L1.7194|
                  |L1.7004|
;;;1550        	else goto avar_bat_as_hndl_lbl1;
;;;1551        	}
;;;1552        else 
;;;1553        	{
;;;1554        	lc640_read_long_ptr(lc640_adr+16,data);
001b5c  4669              MOV      r1,sp
001b5e  f1050010          ADD      r0,r5,#0x10
001b62  f7fffffe          BL       lc640_read_long_ptr
;;;1555        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001b66  f89d0000          LDRB     r0,[sp,#0]
001b6a  2841              CMP      r0,#0x41
001b6c  d10b              BNE      |L1.7046|
001b6e  f89d0001          LDRB     r0,[sp,#1]
001b72  2841              CMP      r0,#0x41
001b74  d107              BNE      |L1.7046|
001b76  f89d0002          LDRB     r0,[sp,#2]
001b7a  2841              CMP      r0,#0x41
001b7c  d103              BNE      |L1.7046|
001b7e  f89d0003          LDRB     r0,[sp,#3]
001b82  2841              CMP      r0,#0x41
001b84  d009              BEQ      |L1.7066|
                  |L1.7046|
;;;1556        		{        
;;;1557        		if(event_ptr_find)event_ptr_find--;
001b86  b11c              CBZ      r4,|L1.7056|
001b88  f1a40401          SUB      r4,r4,#1
001b8c  b2a4              UXTH     r4,r4
001b8e  e001              B        |L1.7060|
                  |L1.7056|
;;;1558            		else event_ptr_find=63;
001b90  f04f043f          MOV      r4,#0x3f
                  |L1.7060|
;;;1559            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001b94  42bc              CMP      r4,r7
001b96  d1c4              BNE      |L1.6946|
001b98  e03f              B        |L1.7194|
                  |L1.7066|
;;;1560        		else goto avar_bat_as_hndl_lbl1;
;;;1561        		}
;;;1562   
;;;1563        	}
;;;1564        		
;;;1565   	data[0]=LPC_RTC->YEAR;
001b9a  f8b8003c          LDRH     r0,[r8,#0x3c]
001b9e  f88d0000          STRB     r0,[sp,#0]
;;;1566   	data[1]=LPC_RTC->MONTH;
001ba2  f8980038          LDRB     r0,[r8,#0x38]
001ba6  f88d0001          STRB     r0,[sp,#1]
;;;1567   	data[2]=LPC_RTC->DOM;
001baa  f898002c          LDRB     r0,[r8,#0x2c]
001bae  f88d0002          STRB     r0,[sp,#2]
;;;1568   	data[3]=0;
001bb2  f88da003          STRB     r10,[sp,#3]
;;;1569   	lc640_write_long_ptr(lc640_adr+16,data);
001bb6  4669              MOV      r1,sp
001bb8  f1050010          ADD      r0,r5,#0x10
001bbc  f7fffffe          BL       lc640_write_long_ptr
;;;1570   
;;;1571   	data[0]=LPC_RTC->HOUR;
001bc0  f8980028          LDRB     r0,[r8,#0x28]
001bc4  f88d0000          STRB     r0,[sp,#0]
;;;1572   	data[1]=LPC_RTC->MIN;
001bc8  f8980024          LDRB     r0,[r8,#0x24]
001bcc  f88d0001          STRB     r0,[sp,#1]
;;;1573   	data[2]=LPC_RTC->SEC;
001bd0  f8980020          LDRB     r0,[r8,#0x20]
001bd4  f88d0002          STRB     r0,[sp,#2]
;;;1574   	data[3]=0;
001bd8  f88da003          STRB     r10,[sp,#3]
;;;1575   	lc640_write_long_ptr(lc640_adr+20,data);
001bdc  4669              MOV      r1,sp
001bde  f1050014          ADD      r0,r5,#0x14
001be2  f7fffffe          BL       lc640_write_long_ptr
;;;1576   	
;;;1577   	data[0]='B';
001be6  f88d9000          STRB     r9,[sp,#0]
;;;1578   	data[1]='B';
001bea  f88d9001          STRB     r9,[sp,#1]
;;;1579   	data[2]='B';
001bee  f88d9002          STRB     r9,[sp,#2]
;;;1580   	data[3]='B';
001bf2  f88d9003          STRB     r9,[sp,#3]
;;;1581   	lc640_write_long_ptr(lc640_adr+24,data);
001bf6  4669              MOV      r1,sp
001bf8  f1050018          ADD      r0,r5,#0x18
001bfc  f7fffffe          BL       lc640_write_long_ptr
;;;1582   	
;;;1583   	data[0]='B';
001c00  f88d9000          STRB     r9,[sp,#0]
;;;1584   	data[1]='B';
001c04  f88d9001          STRB     r9,[sp,#1]
;;;1585   	data[2]='B';
001c08  f88d9002          STRB     r9,[sp,#2]
;;;1586   	data[3]='B';
001c0c  f88d9003          STRB     r9,[sp,#3]
;;;1587   	lc640_write_long_ptr(lc640_adr+28,data);
001c10  4669              MOV      r1,sp
001c12  f105001c          ADD      r0,r5,#0x1c
001c16  f7fffffe          BL       lc640_write_long_ptr
                  |L1.7194|
;;;1588   	
;;;1589   
;;;1590   	
;;;1591   	}
;;;1592   	
;;;1593   avar_bat_as_hndl_end:
;;;1594   __nop();		
001c1a  bf00              NOP      
                  |L1.7196|
;;;1595   }
001c1c  e4c9              B        |L1.5554|
;;;1596   
                          ENDP

                  ke_zvu_mem_hndl PROC
;;;1597   //-----------------------------------------------
;;;1598   void ke_zvu_mem_hndl(char b,unsigned short in,unsigned short in1)
001c1e  b5f7              PUSH     {r0-r2,r4-r7,lr}
;;;1599   {
001c20  b082              SUB      sp,sp,#8
001c22  4605              MOV      r5,r0
;;;1600   char data[4];
;;;1601   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1602   //unsigned char temp,temp_;
;;;1603   //unsigned int tempUI;
;;;1604   //unsigned long tempUL; 
;;;1605   signed temp_temp;
;;;1606   
;;;1607   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
001c24  eb050045          ADD      r0,r5,r5,LSL #1
001c28  4958              LDR      r1,|L1.7564|
001c2a  eb001005          ADD      r0,r0,r5,LSL #4
001c2e  eb010180          ADD      r1,r1,r0,LSL #2
001c32  4864              LDR      r0,|L1.7620|
001c34  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
001c38  f1000001          ADD      r0,r0,#1
001c3c  eb010040          ADD      r0,r1,r0,LSL #1
001c40  f9b00020          LDRSH    r0,[r0,#0x20]
001c44  9000              STR      r0,[sp,#0]
;;;1608   
;;;1609   event_ptr=lc640_read_int(PTR_EVENT_LOG);
001c46  f44f6660          MOV      r6,#0xe00
001c4a  4630              MOV      r0,r6
001c4c  f7fffffe          BL       lc640_read_int
;;;1610   event_ptr++;	
001c50  f1000001          ADD      r0,r0,#1
001c54  4604              MOV      r4,r0
;;;1611   if(event_ptr>63)event_ptr=0;	
001c56  2c3f              CMP      r4,#0x3f
001c58  d901              BLS      |L1.7262|
001c5a  f04f0400          MOV      r4,#0
                  |L1.7262|
;;;1612   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
001c5e  b221              SXTH     r1,r4
001c60  4630              MOV      r0,r6
001c62  f7fffffe          BL       lc640_write_int
;;;1613   	
;;;1614   event_cnt=lc640_read_int(CNT_EVENT_LOG);
001c66  f6406702          MOV      r7,#0xe02
001c6a  4638              MOV      r0,r7
001c6c  f7fffffe          BL       lc640_read_int
;;;1615   if(event_cnt!=63)event_cnt=event_ptr;
001c70  283f              CMP      r0,#0x3f
001c72  d000              BEQ      |L1.7286|
001c74  4620              MOV      r0,r4
                  |L1.7286|
;;;1616   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
001c76  b201              SXTH     r1,r0
001c78  4638              MOV      r0,r7
001c7a  f7fffffe          BL       lc640_write_int
;;;1617   	
;;;1618   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
001c7e  4630              MOV      r0,r6
001c80  f7fffffe          BL       lc640_read_int
001c84  f44f6180          MOV      r1,#0x400
001c88  eb011440          ADD      r4,r1,r0,LSL #5
;;;1619   	
;;;1620   data[0]='B';
001c8c  f04f0042          MOV      r0,#0x42
001c90  f88d0004          STRB     r0,[sp,#4]
;;;1621   data[1]=b; 
001c94  f88d5005          STRB     r5,[sp,#5]
;;;1622   data[2]='K';
001c98  f04f004b          MOV      r0,#0x4b
001c9c  f88d0006          STRB     r0,[sp,#6]
;;;1623   data[3]='Z';
001ca0  f04f005a          MOV      r0,#0x5a
001ca4  f88d0007          STRB     r0,[sp,#7]
;;;1624   
;;;1625   lc640_write_long_ptr(lc640_adr,data);
001ca8  a901              ADD      r1,sp,#4
001caa  4620              MOV      r0,r4
001cac  f7fffffe          BL       lc640_write_long_ptr
;;;1626   
;;;1627   data[0]=*((char*)&in);
001cb0  f89d000c          LDRB     r0,[sp,#0xc]
001cb4  f88d0004          STRB     r0,[sp,#4]
;;;1628   data[1]=*(((char*)(&in))+1);
001cb8  f89d000d          LDRB     r0,[sp,#0xd]
001cbc  f88d0005          STRB     r0,[sp,#5]
;;;1629   data[2]=*((char*)&temp_temp);
001cc0  f89d0000          LDRB     r0,[sp,#0]
001cc4  f88d0006          STRB     r0,[sp,#6]
;;;1630   data[3]=*(((char*)(&temp_temp))+1);
001cc8  f89d0001          LDRB     r0,[sp,#1]
001ccc  f88d0007          STRB     r0,[sp,#7]
;;;1631   lc640_write_long_ptr(lc640_adr+4,data);
001cd0  a901              ADD      r1,sp,#4
001cd2  1d20              ADDS     r0,r4,#4
001cd4  f7fffffe          BL       lc640_write_long_ptr
;;;1632   
;;;1633   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
001cd8  f24020a2          MOV      r0,#0x2a2
001cdc  f7fffffe          BL       lc640_read_long
001ce0  4d39              LDR      r5,|L1.7624|
001ce2  6028              STR      r0,[r5,#0]  ; ke_date
;;;1634   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
001ce4  4629              MOV      r1,r5
001ce6  f1040008          ADD      r0,r4,#8
001cea  f7fffffe          BL       lc640_write_long_ptr
;;;1635   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
001cee  f24020a6          MOV      r0,#0x2a6
001cf2  e06b              B        |L1.7628|
                  |L1.7412|
001cf4  42415420          DCB      "BAT #1 Alarm, heating eliminated",0
001cf8  23312041
001cfc  6c61726d
001d00  2c206865
001d04  6174696e
001d08  6720656c
001d0c  696d696e
001d10  61746564
001d14  00      
001d15  00                DCB      0
001d16  00                DCB      0
001d17  00                DCB      0
                  |L1.7448|
001d18  42415420          DCB      "BAT #2 Alarm, heating eliminated",0
001d1c  23322041
001d20  6c61726d
001d24  2c206865
001d28  6174696e
001d2c  6720656c
001d30  696d696e
001d34  61746564
001d38  00      
001d39  00                DCB      0
001d3a  00                DCB      0
001d3b  00                DCB      0
                  |L1.7484|
001d3c  42415420          DCB      "BAT #2 Alarm, overheating eliminated",0
001d40  23322041
001d44  6c61726d
001d48  2c206f76
001d4c  65726865
001d50  6174696e
001d54  6720656c
001d58  696d696e
001d5c  61746564
001d60  00      
001d61  00                DCB      0
001d62  00                DCB      0
001d63  00                DCB      0
                  |L1.7524|
001d64  42415420          DCB      "BAT #1 Alarm, overheating eliminated",0
001d68  23312041
001d6c  6c61726d
001d70  2c206f76
001d74  65726865
001d78  6174696e
001d7c  6720656c
001d80  696d696e
001d84  61746564
001d88  00      
001d89  00                DCB      0
001d8a  00                DCB      0
001d8b  00                DCB      0
                  |L1.7564|
                          DCD      bat
                  |L1.7568|
                          DCD      0x40024000
                  |L1.7572|
001d94  42415420          DCB      "BAT #1 Alarm, assimetry",0
001d98  23312041
001d9c  6c61726d
001da0  2c206173
001da4  73696d65
001da8  74727900
                  |L1.7596|
001dac  42415420          DCB      "BAT #2 Alarm, assimetry",0
001db0  23322041
001db4  6c61726d
001db8  2c206173
001dbc  73696d65
001dc0  74727900
                  |L1.7620|
                          DCD      bat_u_old_cnt
                  |L1.7624|
                          DCD      ke_date
                  |L1.7628|
001dcc  f7fffffe          BL       lc640_read_long
001dd0  6068              STR      r0,[r5,#4]  ; ke_date
;;;1636   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
001dd2  1d29              ADDS     r1,r5,#4
001dd4  f104000c          ADD      r0,r4,#0xc
001dd8  f7fffffe          BL       lc640_write_long_ptr
;;;1637   
;;;1638   data[0]=LPC_RTC->YEAR;
001ddc  4dff              LDR      r5,|L1.8668|
001dde  8ba8              LDRH     r0,[r5,#0x1c]
001de0  f88d0004          STRB     r0,[sp,#4]
;;;1639   data[1]=LPC_RTC->MONTH;
001de4  7e28              LDRB     r0,[r5,#0x18]
001de6  f88d0005          STRB     r0,[sp,#5]
;;;1640   data[2]=LPC_RTC->DOM;
001dea  7b28              LDRB     r0,[r5,#0xc]
001dec  f88d0006          STRB     r0,[sp,#6]
;;;1641   data[3]=*((char*)&in1);
001df0  f89d0010          LDRB     r0,[sp,#0x10]
001df4  f88d0007          STRB     r0,[sp,#7]
;;;1642   lc640_write_long_ptr(lc640_adr+16,data);
001df8  a901              ADD      r1,sp,#4
001dfa  f1040010          ADD      r0,r4,#0x10
001dfe  f7fffffe          BL       lc640_write_long_ptr
;;;1643   
;;;1644   data[0]=LPC_RTC->HOUR;
001e02  7a28              LDRB     r0,[r5,#8]
001e04  f88d0004          STRB     r0,[sp,#4]
;;;1645   data[1]=LPC_RTC->MIN;
001e08  7928              LDRB     r0,[r5,#4]
001e0a  f88d0005          STRB     r0,[sp,#5]
;;;1646   data[2]=LPC_RTC->SEC;
001e0e  7828              LDRB     r0,[r5,#0]
001e10  f88d0006          STRB     r0,[sp,#6]
;;;1647   data[3]=*(((char*)(&in1))+1);
001e14  f89d0011          LDRB     r0,[sp,#0x11]
001e18  f88d0007          STRB     r0,[sp,#7]
;;;1648   lc640_write_long_ptr(lc640_adr+20,data);
001e1c  a901              ADD      r1,sp,#4
001e1e  f1040014          ADD      r0,r4,#0x14
001e22  f7fffffe          BL       lc640_write_long_ptr
;;;1649    
;;;1650   }
001e26  b005              ADD      sp,sp,#0x14
001e28  bdf0              POP      {r4-r7,pc}
;;;1651   
                          ENDP

                  vz_mem_hndl PROC
;;;1708   //-----------------------------------------------
;;;1709   void vz_mem_hndl(unsigned short in)
001e2a  e92d4ff8          PUSH     {r3-r11,lr}
;;;1710   {
;;;1711   char data[4];
;;;1712   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001e2e  f04f0600          MOV      r6,#0
001e32  4634              MOV      r4,r6
;;;1713   //char avar_simbol;
;;;1714   
;;;1715   if(in==1)
;;;1716   	{
;;;1717   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1718   	event_ptr++;	
;;;1719   	if(event_ptr>63)event_ptr=0;	
;;;1720   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1721   	
;;;1722        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1723   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1724   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1725   	
;;;1726   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1727   	
;;;1728   	data[0]='B';
;;;1729   	data[1]=0; 
;;;1730   	data[2]='Z';
;;;1731   	data[3]=0;
;;;1732   	lc640_write_long_ptr(lc640_adr,data);
;;;1733   
;;;1734   	data[0]=0;
;;;1735   	data[1]=0;
;;;1736   	data[2]=0;
;;;1737   	data[3]=0;
;;;1738   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1739   
;;;1740   	data[0]=LPC_RTC->YEAR;
001e34  f8df83a8          LDR      r8,|L1.8672|
001e38  46a1              MOV      r9,r4                 ;1712
001e3a  f04f0742          MOV      r7,#0x42              ;1728
001e3e  f44f6a80          MOV      r10,#0x400            ;1726
001e42  2801              CMP      r0,#1                 ;1715
001e44  d002              BEQ      |L1.7756|
;;;1741   	data[1]=LPC_RTC->MONTH;
;;;1742   	data[2]=LPC_RTC->DOM;
;;;1743   	data[3]=0;
;;;1744   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1745   
;;;1746   	data[0]=LPC_RTC->HOUR;
;;;1747   	data[1]=LPC_RTC->MIN;
;;;1748   	data[2]=LPC_RTC->SEC;
;;;1749   	data[3]=0;
;;;1750   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1751   	
;;;1752   	data[0]='A';
;;;1753   	data[1]='A';
;;;1754   	data[2]='A';
;;;1755   	data[3]='A';
;;;1756   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1757   	
;;;1758   	data[0]='A';
;;;1759   	data[1]='A';
;;;1760   	data[2]='A';
;;;1761   	data[3]='A';
;;;1762   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1763   	
;;;1764   	data[0]='A';
;;;1765   	data[1]='A';
;;;1766   	data[2]='A';
;;;1767   	data[3]='A';
;;;1768   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1769   	
;;;1770   	data[0]='A';
;;;1771   	data[1]='A';
;;;1772   	data[2]='A';
;;;1773   	data[3]='A';
;;;1774   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1775    	
;;;1776   	}
;;;1777   
;;;1778   else if(in==0)
001e46  2800              CMP      r0,#0
001e48  d07e              BEQ      |L1.8008|
001e4a  e108              B        |L1.8286|
                  |L1.7756|
001e4c  f44f6560          MOV      r5,#0xe00             ;1717
001e50  4628              MOV      r0,r5                 ;1717
001e52  f7fffffe          BL       lc640_read_int
001e56  f1000001          ADD      r0,r0,#1              ;1718
001e5a  4604              MOV      r4,r0                 ;1718
001e5c  2c3f              CMP      r4,#0x3f              ;1719
001e5e  d901              BLS      |L1.7780|
001e60  f04f0400          MOV      r4,#0                 ;1719
                  |L1.7780|
001e64  b221              SXTH     r1,r4                 ;1720
001e66  4628              MOV      r0,r5                 ;1720
001e68  f7fffffe          BL       lc640_write_int
001e6c  f6406602          MOV      r6,#0xe02             ;1722
001e70  4630              MOV      r0,r6                 ;1722
001e72  f7fffffe          BL       lc640_read_int
001e76  283f              CMP      r0,#0x3f              ;1723
001e78  d000              BEQ      |L1.7804|
001e7a  4620              MOV      r0,r4                 ;1723
                  |L1.7804|
001e7c  b201              SXTH     r1,r0                 ;1724
001e7e  4630              MOV      r0,r6                 ;1724
001e80  f7fffffe          BL       lc640_write_int
001e84  4628              MOV      r0,r5                 ;1726
001e86  f7fffffe          BL       lc640_read_int
001e8a  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1726
001e8e  f88d7000          STRB     r7,[sp,#0]            ;1728
001e92  f88d9001          STRB     r9,[sp,#1]            ;1729
001e96  f04f005a          MOV      r0,#0x5a              ;1730
001e9a  f88d0002          STRB     r0,[sp,#2]            ;1730
001e9e  f88d9003          STRB     r9,[sp,#3]            ;1731
001ea2  4669              MOV      r1,sp                 ;1732
001ea4  4620              MOV      r0,r4                 ;1732
001ea6  f7fffffe          BL       lc640_write_long_ptr
001eaa  f8cd9000          STR      r9,[sp,#0]            ;1737
001eae  4669              MOV      r1,sp                 ;1738
001eb0  1d20              ADDS     r0,r4,#4              ;1738
001eb2  f7fffffe          BL       lc640_write_long_ptr
001eb6  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1740
001eba  f88d0000          STRB     r0,[sp,#0]            ;1740
001ebe  f8980038          LDRB     r0,[r8,#0x38]         ;1741
001ec2  f88d0001          STRB     r0,[sp,#1]            ;1741
001ec6  f898002c          LDRB     r0,[r8,#0x2c]         ;1742
001eca  f88d0002          STRB     r0,[sp,#2]            ;1742
001ece  f88d9003          STRB     r9,[sp,#3]            ;1743
001ed2  4669              MOV      r1,sp                 ;1744
001ed4  f1040008          ADD      r0,r4,#8              ;1744
001ed8  f7fffffe          BL       lc640_write_long_ptr
001edc  f8980028          LDRB     r0,[r8,#0x28]         ;1746
001ee0  f88d0000          STRB     r0,[sp,#0]            ;1746
001ee4  f8980024          LDRB     r0,[r8,#0x24]         ;1747
001ee8  f88d0001          STRB     r0,[sp,#1]            ;1747
001eec  f8980020          LDRB     r0,[r8,#0x20]         ;1748
001ef0  f88d0002          STRB     r0,[sp,#2]            ;1748
001ef4  f88d9003          STRB     r9,[sp,#3]            ;1749
001ef8  4669              MOV      r1,sp                 ;1750
001efa  f104000c          ADD      r0,r4,#0xc            ;1750
001efe  f7fffffe          BL       lc640_write_long_ptr
001f02  f04f0541          MOV      r5,#0x41              ;1752
001f06  f88d5000          STRB     r5,[sp,#0]            ;1752
001f0a  f88d5001          STRB     r5,[sp,#1]            ;1753
001f0e  f88d5002          STRB     r5,[sp,#2]            ;1754
001f12  f88d5003          STRB     r5,[sp,#3]            ;1755
001f16  4669              MOV      r1,sp                 ;1756
001f18  f1040010          ADD      r0,r4,#0x10           ;1756
001f1c  f7fffffe          BL       lc640_write_long_ptr
001f20  f88d5000          STRB     r5,[sp,#0]            ;1758
001f24  f88d5001          STRB     r5,[sp,#1]            ;1759
001f28  f88d5002          STRB     r5,[sp,#2]            ;1760
001f2c  f88d5003          STRB     r5,[sp,#3]            ;1761
001f30  4669              MOV      r1,sp                 ;1762
001f32  f1040014          ADD      r0,r4,#0x14           ;1762
001f36  f7fffffe          BL       lc640_write_long_ptr
001f3a  f88d5000          STRB     r5,[sp,#0]            ;1764
001f3e  f88d5001          STRB     r5,[sp,#1]            ;1765
001f42  f88d5002          STRB     r5,[sp,#2]            ;1766
001f46  e000              B        |L1.8010|
                  |L1.8008|
001f48  e014              B        |L1.8052|
                  |L1.8010|
001f4a  f88d5003          STRB     r5,[sp,#3]            ;1767
001f4e  4669              MOV      r1,sp                 ;1768
001f50  f1040018          ADD      r0,r4,#0x18           ;1768
001f54  f7fffffe          BL       lc640_write_long_ptr
001f58  f88d5000          STRB     r5,[sp,#0]            ;1770
001f5c  f88d5001          STRB     r5,[sp,#1]            ;1771
001f60  f88d5002          STRB     r5,[sp,#2]            ;1772
001f64  f88d5003          STRB     r5,[sp,#3]            ;1773
001f68  4669              MOV      r1,sp                 ;1774
001f6a  f104001c          ADD      r0,r4,#0x1c           ;1774
001f6e  f7fffffe          BL       lc640_write_long_ptr
001f72  e074              B        |L1.8286|
                  |L1.8052|
;;;1779   	{      
;;;1780        
;;;1781   vz_mem_hndl_lbl1: 
;;;1782   
;;;1783   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001f74  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1784   
;;;1785        lc640_read_long_ptr(lc640_adr,data);
001f78  4669              MOV      r1,sp
001f7a  4628              MOV      r0,r5
001f7c  f7fffffe          BL       lc640_read_long_ptr
;;;1786        
;;;1787        if(!((data[0]=='B')&&(data[2]=='Z')))
001f80  f89d0000          LDRB     r0,[sp,#0]
001f84  2842              CMP      r0,#0x42
001f86  d103              BNE      |L1.8080|
001f88  f89d0002          LDRB     r0,[sp,#2]
001f8c  285a              CMP      r0,#0x5a
001f8e  d008              BEQ      |L1.8098|
                  |L1.8080|
;;;1788        	{        
;;;1789        	if(event_ptr_find)event_ptr_find--;
001f90  b114              CBZ      r4,|L1.8088|
001f92  f1a40401          SUB      r4,r4,#1
001f96  e001              B        |L1.8092|
                  |L1.8088|
;;;1790        	else event_ptr_find=63;
001f98  f04f043f          MOV      r4,#0x3f
                  |L1.8092|
;;;1791        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001f9c  42b4              CMP      r4,r6
001f9e  d1e9              BNE      |L1.8052|
001fa0  e05d              B        |L1.8286|
                  |L1.8098|
;;;1792        	else goto vz_mem_hndl_lbl1;
;;;1793        	}
;;;1794        else 
;;;1795        	{
;;;1796        	lc640_read_long_ptr(lc640_adr+16,data);
001fa2  4669              MOV      r1,sp
001fa4  f1050010          ADD      r0,r5,#0x10
001fa8  f7fffffe          BL       lc640_read_long_ptr
;;;1797        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001fac  f89d0000          LDRB     r0,[sp,#0]
001fb0  2841              CMP      r0,#0x41
001fb2  d10b              BNE      |L1.8140|
001fb4  f89d0001          LDRB     r0,[sp,#1]
001fb8  2841              CMP      r0,#0x41
001fba  d107              BNE      |L1.8140|
001fbc  f89d0002          LDRB     r0,[sp,#2]
001fc0  2841              CMP      r0,#0x41
001fc2  d103              BNE      |L1.8140|
001fc4  f89d0003          LDRB     r0,[sp,#3]
001fc8  2841              CMP      r0,#0x41
001fca  d008              BEQ      |L1.8158|
                  |L1.8140|
;;;1798        		{        
;;;1799        		if(event_ptr_find)event_ptr_find--;
001fcc  b114              CBZ      r4,|L1.8148|
001fce  f1a40401          SUB      r4,r4,#1
001fd2  e001              B        |L1.8152|
                  |L1.8148|
;;;1800            		else event_ptr_find=63;
001fd4  f04f043f          MOV      r4,#0x3f
                  |L1.8152|
;;;1801            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001fd8  42b4              CMP      r4,r6
001fda  d1cb              BNE      |L1.8052|
001fdc  e03f              B        |L1.8286|
                  |L1.8158|
;;;1802        		else goto vz_mem_hndl_lbl1;
;;;1803        		}
;;;1804   
;;;1805        	}	
;;;1806   
;;;1807   
;;;1808   	
;;;1809   	data[0]=LPC_RTC->YEAR;
001fde  f8b8003c          LDRH     r0,[r8,#0x3c]
001fe2  f88d0000          STRB     r0,[sp,#0]
;;;1810   	data[1]=LPC_RTC->MONTH;
001fe6  f8980038          LDRB     r0,[r8,#0x38]
001fea  f88d0001          STRB     r0,[sp,#1]
;;;1811   	data[2]=LPC_RTC->DOM;
001fee  f898002c          LDRB     r0,[r8,#0x2c]
001ff2  f88d0002          STRB     r0,[sp,#2]
;;;1812   	data[3]=0;
001ff6  f88d9003          STRB     r9,[sp,#3]
;;;1813   	lc640_write_long_ptr(lc640_adr+16,data);
001ffa  4669              MOV      r1,sp
001ffc  f1050010          ADD      r0,r5,#0x10
002000  f7fffffe          BL       lc640_write_long_ptr
;;;1814   
;;;1815   	data[0]=LPC_RTC->HOUR;
002004  f8980028          LDRB     r0,[r8,#0x28]
002008  f88d0000          STRB     r0,[sp,#0]
;;;1816   	data[1]=LPC_RTC->MIN;
00200c  f8980024          LDRB     r0,[r8,#0x24]
002010  f88d0001          STRB     r0,[sp,#1]
;;;1817   	data[2]=LPC_RTC->SEC;
002014  f8980020          LDRB     r0,[r8,#0x20]
002018  f88d0002          STRB     r0,[sp,#2]
;;;1818   	data[3]=0;
00201c  f88d9003          STRB     r9,[sp,#3]
;;;1819   	lc640_write_long_ptr(lc640_adr+20,data);
002020  4669              MOV      r1,sp
002022  f1050014          ADD      r0,r5,#0x14
002026  f7fffffe          BL       lc640_write_long_ptr
;;;1820   	
;;;1821   	data[0]='B';
00202a  f88d7000          STRB     r7,[sp,#0]
;;;1822   	data[1]='B';
00202e  f88d7001          STRB     r7,[sp,#1]
;;;1823   	data[2]='B';
002032  f88d7002          STRB     r7,[sp,#2]
;;;1824   	data[3]='B';
002036  f88d7003          STRB     r7,[sp,#3]
;;;1825   	lc640_write_long_ptr(lc640_adr+24,data);
00203a  4669              MOV      r1,sp
00203c  f1050018          ADD      r0,r5,#0x18
002040  f7fffffe          BL       lc640_write_long_ptr
;;;1826   	
;;;1827   	data[0]='B';
002044  f88d7000          STRB     r7,[sp,#0]
;;;1828   	data[1]='B';
002048  f88d7001          STRB     r7,[sp,#1]
;;;1829   	data[2]='B';
00204c  f88d7002          STRB     r7,[sp,#2]
;;;1830   	data[3]='B';
002050  f88d7003          STRB     r7,[sp,#3]
;;;1831   	lc640_write_long_ptr(lc640_adr+28,data);
002054  4669              MOV      r1,sp
002056  f105001c          ADD      r0,r5,#0x1c
00205a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8286|
;;;1832   	
;;;1833   	}
;;;1834   
;;;1835   vz_mem_hndl_end:
;;;1836   __nop(); 
00205e  bf00              NOP      
                  |L1.8288|
;;;1837   
;;;1838   }
002060  e48a              B        |L1.6520|
;;;1839   
                          ENDP

                  speedz_mem_hndl PROC
;;;1840   //-----------------------------------------------
;;;1841   void speedz_mem_hndl(unsigned short in)	 //    (1-, 5- , 0- , 10- )
002062  e92d4ff8          PUSH     {r3-r11,lr}
;;;1842   {
002066  4605              MOV      r5,r0
;;;1843   char data[4];
;;;1844   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
002068  f04f0600          MOV      r6,#0
00206c  4634              MOV      r4,r6
;;;1845   //char avar_simbol;
;;;1846   
;;;1847   if((in==1)||(in==5)) //  
;;;1848   	{
;;;1849   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1850   	event_ptr++;	
;;;1851   	if(event_ptr>63)event_ptr=0;	
;;;1852   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1853   	
;;;1854       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1855   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1856   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1857   	
;;;1858   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1859   	
;;;1860   	data[0]='s';
;;;1861   	data[1]=0;
;;;1862   	if(in==5)data[1]='a'; 
;;;1863   	data[2]='Z';
;;;1864   	data[3]=0;
;;;1865   	lc640_write_long_ptr(lc640_adr,data);
;;;1866   
;;;1867   	data[0]=0;
;;;1868   	data[1]=0;
;;;1869   	data[2]=0;
;;;1870   	data[3]=0;
;;;1871   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1872   
;;;1873   	data[0]=LPC_RTC->YEAR;
00206e  f8df8170          LDR      r8,|L1.8672|
002072  46a1              MOV      r9,r4                 ;1844
002074  f44f6a80          MOV      r10,#0x400            ;1858
002078  2d01              CMP      r5,#1                 ;1847
00207a  d012              BEQ      |L1.8354|
00207c  2d05              CMP      r5,#5                 ;1847
00207e  d010              BEQ      |L1.8354|
;;;1874   	data[1]=LPC_RTC->MONTH;
;;;1875   	data[2]=LPC_RTC->DOM;
;;;1876   	data[3]=0;
;;;1877   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1878   
;;;1879   	data[0]=LPC_RTC->HOUR;
;;;1880   	data[1]=LPC_RTC->MIN;
;;;1881   	data[2]=LPC_RTC->SEC;
;;;1882   	data[3]=0;
;;;1883   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1884   	
;;;1885   	data[0]='A';
;;;1886   	data[1]='A';
;;;1887   	data[2]='A';
;;;1888   	data[3]='A';
;;;1889   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1890   	
;;;1891   	data[0]='A';
;;;1892   	data[1]='A';
;;;1893   	data[2]='A';
;;;1894   	data[3]='A';
;;;1895   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1896   	
;;;1897   	data[0]='A';
;;;1898   	data[1]='A';
;;;1899   	data[2]='A';
;;;1900   	data[3]='A';
;;;1901   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1902   	
;;;1903   	data[0]='A';
;;;1904   	data[1]='A';
;;;1905   	data[2]='A';
;;;1906   	data[3]='A';
;;;1907   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1908    	
;;;1909   	}
;;;1910   
;;;1911   else if(in==0)	// 
002080  2d00              CMP      r5,#0
002082  d07d              BEQ      |L1.8576|
;;;1912   	{      
;;;1913   	char i;     
;;;1914   	event_ptr_find=0;
;;;1915   	for (i=0;i<63;i++)
;;;1916   		{
;;;1917   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1918   
;;;1919        	lc640_read_long_ptr(lc640_adr,data);
;;;1920        
;;;1921        	if(!((data[0]=='s')&&(data[2]=='Z')))
;;;1922        		{        
;;;1923        		if(event_ptr_find)event_ptr_find--;
;;;1924        		else event_ptr_find=63;
;;;1925        		if(event_ptr_find==event_ptr)
;;;1926   				{
;;;1927   				lc640_adr=0;
;;;1928   				break;
;;;1929   				}
;;;1930        		else continue;
;;;1931        		}
;;;1932        	else 
;;;1933        		{
;;;1934        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1935        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1936        			{        
;;;1937        			if(event_ptr_find)event_ptr_find--;
;;;1938            		else event_ptr_find=63;
;;;1939            		if(event_ptr_find==event_ptr)
;;;1940   					{
;;;1941   					lc640_adr=0;
;;;1942   					break;
;;;1943   					}
;;;1944        			else continue;
;;;1945        			}
;;;1946        		}	
;;;1947   		}
;;;1948   	if(lc640_adr!=0)
;;;1949   		{
;;;1950   		data[0]=LPC_RTC->YEAR;
;;;1951   		data[1]=LPC_RTC->MONTH;
;;;1952   		data[2]=LPC_RTC->DOM;
;;;1953   		data[3]=0;
;;;1954   		lc640_write_long_ptr(lc640_adr+16,data);
;;;1955   	
;;;1956   		data[0]=LPC_RTC->HOUR;
;;;1957   		data[1]=LPC_RTC->MIN;
;;;1958   		data[2]=LPC_RTC->SEC;
;;;1959   		data[3]=0;
;;;1960   		lc640_write_long_ptr(lc640_adr+20,data);
;;;1961   		
;;;1962   		data[0]='C';
;;;1963   		data[1]='C';
;;;1964   		data[2]='C';
;;;1965   		data[3]='C';
;;;1966   		lc640_write_long_ptr(lc640_adr+24,data);
;;;1967   		
;;;1968   		data[0]='C';
;;;1969   		data[1]='C';
;;;1970   		data[2]='C';
;;;1971   		data[3]='C';
;;;1972   		lc640_write_long_ptr(lc640_adr+28,data);
;;;1973   		}
;;;1974   	}
;;;1975   else if(in==10) 	//  
002084  2d0a              CMP      r5,#0xa
002086  d17c              BNE      |L1.8578|
;;;1976   	{      
;;;1977   	char i;     
;;;1978   
;;;1979   	event_ptr_find=0;
;;;1980   	for (i=0;i<63;i++)
002088  f04f0700          MOV      r7,#0
                  |L1.8332|
;;;1981   		{
;;;1982   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
00208c  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1983   
;;;1984        	lc640_read_long_ptr(lc640_adr,data);
002090  4669              MOV      r1,sp
002092  4628              MOV      r0,r5
002094  f7fffffe          BL       lc640_read_long_ptr
;;;1985        
;;;1986        	if(!((data[0]=='s')&&(data[2]=='Z')))
002098  f89d0000          LDRB     r0,[sp,#0]
00209c  2873              CMP      r0,#0x73
00209e  d171              BNE      |L1.8580|
0020a0  e128              B        |L1.8948|
                  |L1.8354|
0020a2  f44f6660          MOV      r6,#0xe00             ;1849
0020a6  4630              MOV      r0,r6                 ;1849
0020a8  f7fffffe          BL       lc640_read_int
0020ac  f1000001          ADD      r0,r0,#1              ;1850
0020b0  4604              MOV      r4,r0                 ;1850
0020b2  2c3f              CMP      r4,#0x3f              ;1851
0020b4  d901              BLS      |L1.8378|
0020b6  f04f0400          MOV      r4,#0                 ;1851
                  |L1.8378|
0020ba  b221              SXTH     r1,r4                 ;1852
0020bc  4630              MOV      r0,r6                 ;1852
0020be  f7fffffe          BL       lc640_write_int
0020c2  f6406702          MOV      r7,#0xe02             ;1854
0020c6  4638              MOV      r0,r7                 ;1854
0020c8  f7fffffe          BL       lc640_read_int
0020cc  283f              CMP      r0,#0x3f              ;1855
0020ce  d000              BEQ      |L1.8402|
0020d0  4620              MOV      r0,r4                 ;1855
                  |L1.8402|
0020d2  b201              SXTH     r1,r0                 ;1856
0020d4  4638              MOV      r0,r7                 ;1856
0020d6  f7fffffe          BL       lc640_write_int
0020da  4630              MOV      r0,r6                 ;1858
0020dc  f7fffffe          BL       lc640_read_int
0020e0  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1858
0020e4  f04f0073          MOV      r0,#0x73              ;1860
0020e8  f88d0000          STRB     r0,[sp,#0]            ;1860
0020ec  f88d9001          STRB     r9,[sp,#1]            ;1861
0020f0  2d05              CMP      r5,#5                 ;1862
0020f2  d103              BNE      |L1.8444|
0020f4  f04f0061          MOV      r0,#0x61              ;1862
0020f8  f88d0001          STRB     r0,[sp,#1]            ;1862
                  |L1.8444|
0020fc  f04f005a          MOV      r0,#0x5a              ;1863
002100  f88d0002          STRB     r0,[sp,#2]            ;1863
002104  f88d9003          STRB     r9,[sp,#3]            ;1864
002108  4669              MOV      r1,sp                 ;1865
00210a  4620              MOV      r0,r4                 ;1865
00210c  f7fffffe          BL       lc640_write_long_ptr
002110  f8cd9000          STR      r9,[sp,#0]            ;1870
002114  4669              MOV      r1,sp                 ;1871
002116  1d20              ADDS     r0,r4,#4              ;1871
002118  f7fffffe          BL       lc640_write_long_ptr
00211c  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1873
002120  f88d0000          STRB     r0,[sp,#0]            ;1873
002124  f8980038          LDRB     r0,[r8,#0x38]         ;1874
002128  f88d0001          STRB     r0,[sp,#1]            ;1874
00212c  f898002c          LDRB     r0,[r8,#0x2c]         ;1875
002130  f88d0002          STRB     r0,[sp,#2]            ;1875
002134  f88d9003          STRB     r9,[sp,#3]            ;1876
002138  4669              MOV      r1,sp                 ;1877
00213a  f1040008          ADD      r0,r4,#8              ;1877
00213e  f7fffffe          BL       lc640_write_long_ptr
002142  f8980028          LDRB     r0,[r8,#0x28]         ;1879
002146  f88d0000          STRB     r0,[sp,#0]            ;1879
00214a  f8980024          LDRB     r0,[r8,#0x24]         ;1880
00214e  f88d0001          STRB     r0,[sp,#1]            ;1880
002152  f8980020          LDRB     r0,[r8,#0x20]         ;1881
002156  f88d0002          STRB     r0,[sp,#2]            ;1881
00215a  f88d9003          STRB     r9,[sp,#3]            ;1882
00215e  4669              MOV      r1,sp                 ;1883
002160  f104000c          ADD      r0,r4,#0xc            ;1883
002164  f7fffffe          BL       lc640_write_long_ptr
002168  f04f0541          MOV      r5,#0x41              ;1885
00216c  f88d5000          STRB     r5,[sp,#0]            ;1885
002170  f88d5001          STRB     r5,[sp,#1]            ;1886
002174  f88d5002          STRB     r5,[sp,#2]            ;1887
002178  f88d5003          STRB     r5,[sp,#3]            ;1888
00217c  4669              MOV      r1,sp                 ;1889
00217e  e002              B        |L1.8582|
                  |L1.8576|
002180  e033              B        |L1.8682|
                  |L1.8578|
002182  e031              B        |L1.8680|
                  |L1.8580|
002184  e0ba              B        |L1.8956|
                  |L1.8582|
002186  f1040010          ADD      r0,r4,#0x10           ;1889
00218a  f7fffffe          BL       lc640_write_long_ptr
00218e  f88d5000          STRB     r5,[sp,#0]            ;1891
002192  f88d5001          STRB     r5,[sp,#1]            ;1892
002196  f88d5002          STRB     r5,[sp,#2]            ;1893
00219a  f88d5003          STRB     r5,[sp,#3]            ;1894
00219e  4669              MOV      r1,sp                 ;1895
0021a0  f1040014          ADD      r0,r4,#0x14           ;1895
0021a4  f7fffffe          BL       lc640_write_long_ptr
0021a8  f88d5000          STRB     r5,[sp,#0]            ;1897
0021ac  f88d5001          STRB     r5,[sp,#1]            ;1898
0021b0  f88d5002          STRB     r5,[sp,#2]            ;1899
0021b4  f88d5003          STRB     r5,[sp,#3]            ;1900
0021b8  4669              MOV      r1,sp                 ;1901
0021ba  f1040018          ADD      r0,r4,#0x18           ;1901
0021be  f7fffffe          BL       lc640_write_long_ptr
0021c2  f88d5000          STRB     r5,[sp,#0]            ;1903
0021c6  f88d5001          STRB     r5,[sp,#1]            ;1904
0021ca  f88d5002          STRB     r5,[sp,#2]            ;1905
0021ce  f88d5003          STRB     r5,[sp,#3]            ;1906
0021d2  4669              MOV      r1,sp                 ;1907
0021d4  f104001c          ADD      r0,r4,#0x1c           ;1907
0021d8  e004              B        |L1.8676|
0021da  0000              DCW      0x0000
                  |L1.8668|
                          DCD      0x40024020
                  |L1.8672|
                          DCD      0x40024000
                  |L1.8676|
0021e4  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8680|
;;;1987        		{        
;;;1988        		if(event_ptr_find)event_ptr_find--;
;;;1989        		else event_ptr_find=63;
;;;1990        		if(event_ptr_find==event_ptr)
;;;1991   				{
;;;1992   				lc640_adr=0;
;;;1993   				break;
;;;1994   				}
;;;1995        		else continue;
;;;1996        		}
;;;1997        	else 
;;;1998        		{
;;;1999        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2000        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2001        			{        
;;;2002        			if(event_ptr_find)event_ptr_find--;
;;;2003            		else event_ptr_find=63;
;;;2004            		if(event_ptr_find==event_ptr)
;;;2005   					{
;;;2006   					lc640_adr=0;
;;;2007   					break;
;;;2008   					}
;;;2009        			else continue;
;;;2010        			}
;;;2011        		}	
;;;2012   		}
;;;2013   	if(lc640_adr!=0)
;;;2014   		{
;;;2015   		data[0]=LPC_RTC->YEAR;
;;;2016   		data[1]=LPC_RTC->MONTH;
;;;2017   		data[2]=LPC_RTC->DOM;
;;;2018   		data[3]=0;
;;;2019   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2020   	
;;;2021   		data[0]=LPC_RTC->HOUR;
;;;2022   		data[1]=LPC_RTC->MIN;
;;;2023   		data[2]=LPC_RTC->SEC;
;;;2024   		data[3]=0;
;;;2025   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2026   		
;;;2027   		data[0]='B';
;;;2028   		data[1]='B';
;;;2029   		data[2]='B';
;;;2030   		data[3]='B';
;;;2031   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2032   		
;;;2033   		data[0]='B';
;;;2034   		data[1]='B';
;;;2035   		data[2]='B';
;;;2036   		data[3]='B';
;;;2037   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2038   		}
;;;2039   	}
;;;2040   }
0021e8  e518              B        |L1.7196|
                  |L1.8682|
0021ea  f04f0700          MOV      r7,#0                 ;1915
                  |L1.8686|
0021ee  eb0a1544          ADD      r5,r10,r4,LSL #5      ;1917
0021f2  4669              MOV      r1,sp                 ;1919
0021f4  4628              MOV      r0,r5                 ;1919
0021f6  f7fffffe          BL       lc640_read_long_ptr
0021fa  f89d0000          LDRB     r0,[sp,#0]            ;1921
0021fe  2873              CMP      r0,#0x73              ;1921
002200  d103              BNE      |L1.8714|
002202  f89d0002          LDRB     r0,[sp,#2]            ;1921
002206  285a              CMP      r0,#0x5a              ;1921
002208  d00a              BEQ      |L1.8736|
                  |L1.8714|
00220a  b114              CBZ      r4,|L1.8722|
00220c  f1a40401          SUB      r4,r4,#1              ;1923
002210  e001              B        |L1.8726|
                  |L1.8722|
002212  f04f043f          MOV      r4,#0x3f              ;1924
                  |L1.8726|
002216  42b4              CMP      r4,r6                 ;1925
002218  d122              BNE      |L1.8800|
00221a  f04f0500          MOV      r5,#0                 ;1927
00221e  e024              B        |L1.8810|
                  |L1.8736|
002220  4669              MOV      r1,sp                 ;1934
002222  f1050010          ADD      r0,r5,#0x10           ;1934
002226  f7fffffe          BL       lc640_read_long_ptr
00222a  f89d0000          LDRB     r0,[sp,#0]            ;1935
00222e  2841              CMP      r0,#0x41              ;1935
002230  d10b              BNE      |L1.8778|
002232  f89d0001          LDRB     r0,[sp,#1]            ;1935
002236  2841              CMP      r0,#0x41              ;1935
002238  d107              BNE      |L1.8778|
00223a  f89d0002          LDRB     r0,[sp,#2]            ;1935
00223e  2841              CMP      r0,#0x41              ;1935
002240  d103              BNE      |L1.8778|
002242  f89d0003          LDRB     r0,[sp,#3]            ;1935
002246  2841              CMP      r0,#0x41              ;1935
002248  d00a              BEQ      |L1.8800|
                  |L1.8778|
00224a  b114              CBZ      r4,|L1.8786|
00224c  f1a40401          SUB      r4,r4,#1              ;1937
002250  e001              B        |L1.8790|
                  |L1.8786|
002252  f04f043f          MOV      r4,#0x3f              ;1938
                  |L1.8790|
002256  42b4              CMP      r4,r6                 ;1939
002258  d102              BNE      |L1.8800|
00225a  f04f0500          MOV      r5,#0                 ;1941
00225e  e004              B        |L1.8810|
                  |L1.8800|
002260  f1070701          ADD      r7,r7,#1              ;1915
002264  b2ff              UXTB     r7,r7                 ;1915
002266  2f3f              CMP      r7,#0x3f              ;1915
002268  d3c1              BCC      |L1.8686|
                  |L1.8810|
00226a  2d00              CMP      r5,#0                 ;1948
00226c  d0bc              BEQ      |L1.8680|
00226e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1950
002272  f88d0000          STRB     r0,[sp,#0]            ;1950
002276  f8980038          LDRB     r0,[r8,#0x38]         ;1951
00227a  f88d0001          STRB     r0,[sp,#1]            ;1951
00227e  f898002c          LDRB     r0,[r8,#0x2c]         ;1952
002282  f88d0002          STRB     r0,[sp,#2]            ;1952
002286  f88d9003          STRB     r9,[sp,#3]            ;1953
00228a  4669              MOV      r1,sp                 ;1954
00228c  f1050010          ADD      r0,r5,#0x10           ;1954
002290  f7fffffe          BL       lc640_write_long_ptr
002294  f8980028          LDRB     r0,[r8,#0x28]         ;1956
002298  f88d0000          STRB     r0,[sp,#0]            ;1956
00229c  f8980024          LDRB     r0,[r8,#0x24]         ;1957
0022a0  f88d0001          STRB     r0,[sp,#1]            ;1957
0022a4  f8980020          LDRB     r0,[r8,#0x20]         ;1958
0022a8  f88d0002          STRB     r0,[sp,#2]            ;1958
0022ac  f88d9003          STRB     r9,[sp,#3]            ;1959
0022b0  4669              MOV      r1,sp                 ;1960
0022b2  f1050014          ADD      r0,r5,#0x14           ;1960
0022b6  f7fffffe          BL       lc640_write_long_ptr
0022ba  f04f0443          MOV      r4,#0x43              ;1962
0022be  f88d4000          STRB     r4,[sp,#0]            ;1962
0022c2  f88d4001          STRB     r4,[sp,#1]            ;1963
0022c6  f88d4002          STRB     r4,[sp,#2]            ;1964
0022ca  f88d4003          STRB     r4,[sp,#3]            ;1965
0022ce  4669              MOV      r1,sp                 ;1966
0022d0  f1050018          ADD      r0,r5,#0x18           ;1966
0022d4  f7fffffe          BL       lc640_write_long_ptr
0022d8  f88d4000          STRB     r4,[sp,#0]            ;1968
0022dc  f88d4001          STRB     r4,[sp,#1]            ;1969
0022e0  f88d4002          STRB     r4,[sp,#2]            ;1970
0022e4  f88d4003          STRB     r4,[sp,#3]            ;1971
0022e8  4669              MOV      r1,sp                 ;1972
0022ea  f105001c          ADD      r0,r5,#0x1c           ;1972
0022ee  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8946|
0022f2  e493              B        |L1.7196|
                  |L1.8948|
0022f4  f89d0002          LDRB     r0,[sp,#2]            ;1986
0022f8  285a              CMP      r0,#0x5a              ;1986
0022fa  d00a              BEQ      |L1.8978|
                  |L1.8956|
0022fc  b114              CBZ      r4,|L1.8964|
0022fe  f1a40401          SUB      r4,r4,#1              ;1988
002302  e001              B        |L1.8968|
                  |L1.8964|
002304  f04f043f          MOV      r4,#0x3f              ;1989
                  |L1.8968|
002308  42b4              CMP      r4,r6                 ;1990
00230a  d122              BNE      |L1.9042|
00230c  f04f0500          MOV      r5,#0                 ;1992
002310  e025              B        |L1.9054|
                  |L1.8978|
002312  4669              MOV      r1,sp                 ;1999
002314  f1050010          ADD      r0,r5,#0x10           ;1999
002318  f7fffffe          BL       lc640_read_long_ptr
00231c  f89d0000          LDRB     r0,[sp,#0]            ;2000
002320  2841              CMP      r0,#0x41              ;2000
002322  d10b              BNE      |L1.9020|
002324  f89d0001          LDRB     r0,[sp,#1]            ;2000
002328  2841              CMP      r0,#0x41              ;2000
00232a  d107              BNE      |L1.9020|
00232c  f89d0002          LDRB     r0,[sp,#2]            ;2000
002330  2841              CMP      r0,#0x41              ;2000
002332  d103              BNE      |L1.9020|
002334  f89d0003          LDRB     r0,[sp,#3]            ;2000
002338  2841              CMP      r0,#0x41              ;2000
00233a  d00a              BEQ      |L1.9042|
                  |L1.9020|
00233c  b114              CBZ      r4,|L1.9028|
00233e  f1a40401          SUB      r4,r4,#1              ;2002
002342  e001              B        |L1.9032|
                  |L1.9028|
002344  f04f043f          MOV      r4,#0x3f              ;2003
                  |L1.9032|
002348  42b4              CMP      r4,r6                 ;2004
00234a  d102              BNE      |L1.9042|
00234c  f04f0500          MOV      r5,#0                 ;2006
002350  e005              B        |L1.9054|
                  |L1.9042|
002352  f1070701          ADD      r7,r7,#1              ;1980
002356  b2ff              UXTB     r7,r7                 ;1980
002358  2f3f              CMP      r7,#0x3f              ;1980
00235a  f4ffae97          BCC      |L1.8332|
                  |L1.9054|
00235e  2d00              CMP      r5,#0                 ;2013
002360  d0c7              BEQ      |L1.8946|
002362  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2015
002366  f88d0000          STRB     r0,[sp,#0]            ;2015
00236a  f8980038          LDRB     r0,[r8,#0x38]         ;2016
00236e  f88d0001          STRB     r0,[sp,#1]            ;2016
002372  f898002c          LDRB     r0,[r8,#0x2c]         ;2017
002376  f88d0002          STRB     r0,[sp,#2]            ;2017
00237a  f88d9003          STRB     r9,[sp,#3]            ;2018
00237e  4669              MOV      r1,sp                 ;2019
002380  f1050010          ADD      r0,r5,#0x10           ;2019
002384  f7fffffe          BL       lc640_write_long_ptr
002388  f8980028          LDRB     r0,[r8,#0x28]         ;2021
00238c  f88d0000          STRB     r0,[sp,#0]            ;2021
002390  f8980024          LDRB     r0,[r8,#0x24]         ;2022
002394  f88d0001          STRB     r0,[sp,#1]            ;2022
002398  f8980020          LDRB     r0,[r8,#0x20]         ;2023
00239c  f88d0002          STRB     r0,[sp,#2]            ;2023
0023a0  f88d9003          STRB     r9,[sp,#3]            ;2024
0023a4  4669              MOV      r1,sp                 ;2025
0023a6  f1050014          ADD      r0,r5,#0x14           ;2025
0023aa  f7fffffe          BL       lc640_write_long_ptr
0023ae  f04f0442          MOV      r4,#0x42              ;2027
0023b2  f88d4000          STRB     r4,[sp,#0]            ;2027
0023b6  f88d4001          STRB     r4,[sp,#1]            ;2028
0023ba  f88d4002          STRB     r4,[sp,#2]            ;2029
0023be  f88d4003          STRB     r4,[sp,#3]            ;2030
0023c2  4669              MOV      r1,sp                 ;2031
0023c4  f1050018          ADD      r0,r5,#0x18           ;2031
0023c8  f7fffffe          BL       lc640_write_long_ptr
0023cc  f88d4000          STRB     r4,[sp,#0]            ;2033
0023d0  f88d4001          STRB     r4,[sp,#1]            ;2034
0023d4  f88d4002          STRB     r4,[sp,#2]            ;2035
0023d8  f88d4003          STRB     r4,[sp,#3]            ;2036
0023dc  4669              MOV      r1,sp                 ;2037
0023de  f105001c          ADD      r0,r5,#0x1c           ;2037
0023e2  f7fffffe          BL       lc640_write_long_ptr
0023e6  e419              B        |L1.7196|
;;;2041     
                          ENDP

                  uz_mem_hndl PROC
;;;2043   //-----------------------------------------------
;;;2044   void uz_mem_hndl(unsigned short in)	 //   
0023e8  e92d4ff8          PUSH     {r3-r11,lr}
;;;2045   {
;;;2046   char data[4];
;;;2047   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
0023ec  f04f0600          MOV      r6,#0
0023f0  4634              MOV      r4,r6
;;;2048   //char avar_simbol;
;;;2049   
;;;2050   if(in==1) //  
;;;2051   	{
;;;2052   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2053   	event_ptr++;	
;;;2054   	if(event_ptr>63)event_ptr=0;	
;;;2055   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2056   	
;;;2057       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2058   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2059   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2060   	
;;;2061   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2062   	
;;;2063   	data[0]='u';
;;;2064   	data[1]=0; 
;;;2065   	data[2]='Z';
;;;2066   	data[3]=0;
;;;2067   	lc640_write_long_ptr(lc640_adr,data);
;;;2068   
;;;2069   	data[0]=0;
;;;2070   	data[1]=0;
;;;2071   	data[2]=0;
;;;2072   	data[3]=0;
;;;2073   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2074   
;;;2075   	data[0]=LPC_RTC->YEAR;
0023f2  f8df86c4          LDR      r8,|L1.10936|
0023f6  46a1              MOV      r9,r4                 ;2047
0023f8  f44f6a80          MOV      r10,#0x400            ;2061
0023fc  2801              CMP      r0,#1                 ;2050
0023fe  d010              BEQ      |L1.9250|
;;;2076   	data[1]=LPC_RTC->MONTH;
;;;2077   	data[2]=LPC_RTC->DOM;
;;;2078   	data[3]=0;
;;;2079   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2080   
;;;2081   	data[0]=LPC_RTC->HOUR;
;;;2082   	data[1]=LPC_RTC->MIN;
;;;2083   	data[2]=LPC_RTC->SEC;
;;;2084   	data[3]=0;
;;;2085   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2086   	
;;;2087   	data[0]='A';
;;;2088   	data[1]='A';
;;;2089   	data[2]='A';
;;;2090   	data[3]='A';
;;;2091   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2092   	
;;;2093   	data[0]='A';
;;;2094   	data[1]='A';
;;;2095   	data[2]='A';
;;;2096   	data[3]='A';
;;;2097   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2098   	
;;;2099   	data[0]='A';
;;;2100   	data[1]='A';
;;;2101   	data[2]='A';
;;;2102   	data[3]='A';
;;;2103   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2104   	
;;;2105   	data[0]='A';
;;;2106   	data[1]='A';
;;;2107   	data[2]='A';
;;;2108   	data[3]='A';
;;;2109   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2110    	
;;;2111   	}
;;;2112   
;;;2113   else if(in==0)	// 
002400  2800              CMP      r0,#0
002402  d07d              BEQ      |L1.9472|
;;;2114   	{      
;;;2115   	char i;     
;;;2116   	event_ptr_find=0;
;;;2117   	for (i=0;i<63;i++)
;;;2118   		{
;;;2119   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2120   
;;;2121        	lc640_read_long_ptr(lc640_adr,data);
;;;2122        
;;;2123        	if(!((data[0]=='u')&&(data[2]=='Z')))
;;;2124        		{        
;;;2125        		if(event_ptr_find)event_ptr_find--;
;;;2126        		else event_ptr_find=63;
;;;2127        		if(event_ptr_find==event_ptr)
;;;2128   				{
;;;2129   				lc640_adr=0;
;;;2130   				break;
;;;2131   				}
;;;2132        		else continue;
;;;2133        		}
;;;2134        	else 
;;;2135        		{
;;;2136        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2137        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2138        			{        
;;;2139        			if(event_ptr_find)event_ptr_find--;
;;;2140            		else event_ptr_find=63;
;;;2141            		if(event_ptr_find==event_ptr)
;;;2142   					{
;;;2143   					lc640_adr=0;
;;;2144   					break;
;;;2145   					}
;;;2146        			else continue;
;;;2147        			}
;;;2148        		}	
;;;2149   		}
;;;2150   	if(lc640_adr!=0)
;;;2151   		{
;;;2152   		data[0]=LPC_RTC->YEAR;
;;;2153   		data[1]=LPC_RTC->MONTH;
;;;2154   		data[2]=LPC_RTC->DOM;
;;;2155   		data[3]=0;
;;;2156   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2157   	
;;;2158   		data[0]=LPC_RTC->HOUR;
;;;2159   		data[1]=LPC_RTC->MIN;
;;;2160   		data[2]=LPC_RTC->SEC;
;;;2161   		data[3]=0;
;;;2162   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2163   		
;;;2164   		data[0]='C';
;;;2165   		data[1]='C';
;;;2166   		data[2]='C';
;;;2167   		data[3]='C';
;;;2168   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2169   		
;;;2170   		data[0]='C';
;;;2171   		data[1]='C';
;;;2172   		data[2]='C';
;;;2173   		data[3]='C';
;;;2174   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2175   		}
;;;2176   	}
;;;2177   else if(in==10) 	//  
002404  280a              CMP      r0,#0xa
002406  d17c              BNE      |L1.9474|
;;;2178   	{      
;;;2179   	char i;     
;;;2180   
;;;2181   	event_ptr_find=0;
;;;2182   	for (i=0;i<63;i++)
002408  f04f0700          MOV      r7,#0
                  |L1.9228|
;;;2183   		{
;;;2184   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
00240c  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2185   
;;;2186        	lc640_read_long_ptr(lc640_adr,data);
002410  4669              MOV      r1,sp
002412  4628              MOV      r0,r5
002414  f7fffffe          BL       lc640_read_long_ptr
;;;2187        
;;;2188        	if(!((data[0]=='u')&&(data[2]=='Z')))
002418  f89d0000          LDRB     r0,[sp,#0]
00241c  2875              CMP      r0,#0x75
00241e  d171              BNE      |L1.9476|
002420  e11c              B        |L1.9820|
                  |L1.9250|
002422  f44f6560          MOV      r5,#0xe00             ;2052
002426  4628              MOV      r0,r5                 ;2052
002428  f7fffffe          BL       lc640_read_int
00242c  f1000001          ADD      r0,r0,#1              ;2053
002430  4604              MOV      r4,r0                 ;2053
002432  2c3f              CMP      r4,#0x3f              ;2054
002434  d901              BLS      |L1.9274|
002436  f04f0400          MOV      r4,#0                 ;2054
                  |L1.9274|
00243a  b221              SXTH     r1,r4                 ;2055
00243c  4628              MOV      r0,r5                 ;2055
00243e  f7fffffe          BL       lc640_write_int
002442  f6406602          MOV      r6,#0xe02             ;2057
002446  4630              MOV      r0,r6                 ;2057
002448  f7fffffe          BL       lc640_read_int
00244c  283f              CMP      r0,#0x3f              ;2058
00244e  d000              BEQ      |L1.9298|
002450  4620              MOV      r0,r4                 ;2058
                  |L1.9298|
002452  b201              SXTH     r1,r0                 ;2059
002454  4630              MOV      r0,r6                 ;2059
002456  f7fffffe          BL       lc640_write_int
00245a  4628              MOV      r0,r5                 ;2061
00245c  f7fffffe          BL       lc640_read_int
002460  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2061
002464  f04f0075          MOV      r0,#0x75              ;2063
002468  f88d0000          STRB     r0,[sp,#0]            ;2063
00246c  f88d9001          STRB     r9,[sp,#1]            ;2064
002470  f04f005a          MOV      r0,#0x5a              ;2065
002474  f88d0002          STRB     r0,[sp,#2]            ;2065
002478  f88d9003          STRB     r9,[sp,#3]            ;2066
00247c  4669              MOV      r1,sp                 ;2067
00247e  4620              MOV      r0,r4                 ;2067
002480  f7fffffe          BL       lc640_write_long_ptr
002484  f8cd9000          STR      r9,[sp,#0]            ;2072
002488  4669              MOV      r1,sp                 ;2073
00248a  1d20              ADDS     r0,r4,#4              ;2073
00248c  f7fffffe          BL       lc640_write_long_ptr
002490  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2075
002494  f88d0000          STRB     r0,[sp,#0]            ;2075
002498  f8980038          LDRB     r0,[r8,#0x38]         ;2076
00249c  f88d0001          STRB     r0,[sp,#1]            ;2076
0024a0  f898002c          LDRB     r0,[r8,#0x2c]         ;2077
0024a4  f88d0002          STRB     r0,[sp,#2]            ;2077
0024a8  f88d9003          STRB     r9,[sp,#3]            ;2078
0024ac  4669              MOV      r1,sp                 ;2079
0024ae  f1040008          ADD      r0,r4,#8              ;2079
0024b2  f7fffffe          BL       lc640_write_long_ptr
0024b6  f8980028          LDRB     r0,[r8,#0x28]         ;2081
0024ba  f88d0000          STRB     r0,[sp,#0]            ;2081
0024be  f8980024          LDRB     r0,[r8,#0x24]         ;2082
0024c2  f88d0001          STRB     r0,[sp,#1]            ;2082
0024c6  f8980020          LDRB     r0,[r8,#0x20]         ;2083
0024ca  f88d0002          STRB     r0,[sp,#2]            ;2083
0024ce  f88d9003          STRB     r9,[sp,#3]            ;2084
0024d2  4669              MOV      r1,sp                 ;2085
0024d4  f104000c          ADD      r0,r4,#0xc            ;2085
0024d8  f7fffffe          BL       lc640_write_long_ptr
0024dc  f04f0541          MOV      r5,#0x41              ;2087
0024e0  f88d5000          STRB     r5,[sp,#0]            ;2087
0024e4  f88d5001          STRB     r5,[sp,#1]            ;2088
0024e8  f88d5002          STRB     r5,[sp,#2]            ;2089
0024ec  f88d5003          STRB     r5,[sp,#3]            ;2090
0024f0  4669              MOV      r1,sp                 ;2091
0024f2  f1040010          ADD      r0,r4,#0x10           ;2091
0024f6  f7fffffe          BL       lc640_write_long_ptr
0024fa  f88d5000          STRB     r5,[sp,#0]            ;2093
0024fe  e002              B        |L1.9478|
                  |L1.9472|
002500  e027              B        |L1.9554|
                  |L1.9474|
002502  e025              B        |L1.9552|
                  |L1.9476|
002504  e0ae              B        |L1.9828|
                  |L1.9478|
002506  f88d5001          STRB     r5,[sp,#1]            ;2094
00250a  f88d5002          STRB     r5,[sp,#2]            ;2095
00250e  f88d5003          STRB     r5,[sp,#3]            ;2096
002512  4669              MOV      r1,sp                 ;2097
002514  f1040014          ADD      r0,r4,#0x14           ;2097
002518  f7fffffe          BL       lc640_write_long_ptr
00251c  f88d5000          STRB     r5,[sp,#0]            ;2099
002520  f88d5001          STRB     r5,[sp,#1]            ;2100
002524  f88d5002          STRB     r5,[sp,#2]            ;2101
002528  f88d5003          STRB     r5,[sp,#3]            ;2102
00252c  4669              MOV      r1,sp                 ;2103
00252e  f1040018          ADD      r0,r4,#0x18           ;2103
002532  f7fffffe          BL       lc640_write_long_ptr
002536  f88d5000          STRB     r5,[sp,#0]            ;2105
00253a  f88d5001          STRB     r5,[sp,#1]            ;2106
00253e  f88d5002          STRB     r5,[sp,#2]            ;2107
002542  f88d5003          STRB     r5,[sp,#3]            ;2108
002546  4669              MOV      r1,sp                 ;2109
002548  f104001c          ADD      r0,r4,#0x1c           ;2109
00254c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9552|
;;;2189        		{        
;;;2190        		if(event_ptr_find)event_ptr_find--;
;;;2191        		else event_ptr_find=63;
;;;2192        		if(event_ptr_find==event_ptr)
;;;2193   				{
;;;2194   				lc640_adr=0;
;;;2195   				break;
;;;2196   				}
;;;2197        		else continue;
;;;2198        		}
;;;2199        	else 
;;;2200        		{
;;;2201        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2202        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2203        			{        
;;;2204        			if(event_ptr_find)event_ptr_find--;
;;;2205            		else event_ptr_find=63;
;;;2206            		if(event_ptr_find==event_ptr)
;;;2207   					{
;;;2208   					lc640_adr=0;
;;;2209   					break;
;;;2210   					}
;;;2211        			else continue;
;;;2212        			}
;;;2213        		}	
;;;2214   		}
;;;2215   	if(lc640_adr!=0)
;;;2216   		{
;;;2217   		data[0]=LPC_RTC->YEAR;
;;;2218   		data[1]=LPC_RTC->MONTH;
;;;2219   		data[2]=LPC_RTC->DOM;
;;;2220   		data[3]=0;
;;;2221   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2222   	
;;;2223   		data[0]=LPC_RTC->HOUR;
;;;2224   		data[1]=LPC_RTC->MIN;
;;;2225   		data[2]=LPC_RTC->SEC;
;;;2226   		data[3]=0;
;;;2227   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2228   		
;;;2229   		data[0]='B';
;;;2230   		data[1]='B';
;;;2231   		data[2]='B';
;;;2232   		data[3]='B';
;;;2233   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2234   		
;;;2235   		data[0]='B';
;;;2236   		data[1]='B';
;;;2237   		data[2]='B';
;;;2238   		data[3]='B';
;;;2239   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2240   		}
;;;2241   	}
;;;2242   }
002550  e586              B        |L1.8288|
                  |L1.9554|
002552  f04f0700          MOV      r7,#0                 ;2117
                  |L1.9558|
002556  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2119
00255a  4669              MOV      r1,sp                 ;2121
00255c  4628              MOV      r0,r5                 ;2121
00255e  f7fffffe          BL       lc640_read_long_ptr
002562  f89d0000          LDRB     r0,[sp,#0]            ;2123
002566  2875              CMP      r0,#0x75              ;2123
002568  d103              BNE      |L1.9586|
00256a  f89d0002          LDRB     r0,[sp,#2]            ;2123
00256e  285a              CMP      r0,#0x5a              ;2123
002570  d00a              BEQ      |L1.9608|
                  |L1.9586|
002572  b114              CBZ      r4,|L1.9594|
002574  f1a40401          SUB      r4,r4,#1              ;2125
002578  e001              B        |L1.9598|
                  |L1.9594|
00257a  f04f043f          MOV      r4,#0x3f              ;2126
                  |L1.9598|
00257e  42b4              CMP      r4,r6                 ;2127
002580  d122              BNE      |L1.9672|
002582  f04f0500          MOV      r5,#0                 ;2129
002586  e024              B        |L1.9682|
                  |L1.9608|
002588  4669              MOV      r1,sp                 ;2136
00258a  f1050010          ADD      r0,r5,#0x10           ;2136
00258e  f7fffffe          BL       lc640_read_long_ptr
002592  f89d0000          LDRB     r0,[sp,#0]            ;2137
002596  2841              CMP      r0,#0x41              ;2137
002598  d10b              BNE      |L1.9650|
00259a  f89d0001          LDRB     r0,[sp,#1]            ;2137
00259e  2841              CMP      r0,#0x41              ;2137
0025a0  d107              BNE      |L1.9650|
0025a2  f89d0002          LDRB     r0,[sp,#2]            ;2137
0025a6  2841              CMP      r0,#0x41              ;2137
0025a8  d103              BNE      |L1.9650|
0025aa  f89d0003          LDRB     r0,[sp,#3]            ;2137
0025ae  2841              CMP      r0,#0x41              ;2137
0025b0  d00a              BEQ      |L1.9672|
                  |L1.9650|
0025b2  b114              CBZ      r4,|L1.9658|
0025b4  f1a40401          SUB      r4,r4,#1              ;2139
0025b8  e001              B        |L1.9662|
                  |L1.9658|
0025ba  f04f043f          MOV      r4,#0x3f              ;2140
                  |L1.9662|
0025be  42b4              CMP      r4,r6                 ;2141
0025c0  d102              BNE      |L1.9672|
0025c2  f04f0500          MOV      r5,#0                 ;2143
0025c6  e004              B        |L1.9682|
                  |L1.9672|
0025c8  f1070701          ADD      r7,r7,#1              ;2117
0025cc  b2ff              UXTB     r7,r7                 ;2117
0025ce  2f3f              CMP      r7,#0x3f              ;2117
0025d0  d3c1              BCC      |L1.9558|
                  |L1.9682|
0025d2  2d00              CMP      r5,#0                 ;2150
0025d4  d0bc              BEQ      |L1.9552|
0025d6  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2152
0025da  f88d0000          STRB     r0,[sp,#0]            ;2152
0025de  f8980038          LDRB     r0,[r8,#0x38]         ;2153
0025e2  f88d0001          STRB     r0,[sp,#1]            ;2153
0025e6  f898002c          LDRB     r0,[r8,#0x2c]         ;2154
0025ea  f88d0002          STRB     r0,[sp,#2]            ;2154
0025ee  f88d9003          STRB     r9,[sp,#3]            ;2155
0025f2  4669              MOV      r1,sp                 ;2156
0025f4  f1050010          ADD      r0,r5,#0x10           ;2156
0025f8  f7fffffe          BL       lc640_write_long_ptr
0025fc  f8980028          LDRB     r0,[r8,#0x28]         ;2158
002600  f88d0000          STRB     r0,[sp,#0]            ;2158
002604  f8980024          LDRB     r0,[r8,#0x24]         ;2159
002608  f88d0001          STRB     r0,[sp,#1]            ;2159
00260c  f8980020          LDRB     r0,[r8,#0x20]         ;2160
002610  f88d0002          STRB     r0,[sp,#2]            ;2160
002614  f88d9003          STRB     r9,[sp,#3]            ;2161
002618  4669              MOV      r1,sp                 ;2162
00261a  f1050014          ADD      r0,r5,#0x14           ;2162
00261e  f7fffffe          BL       lc640_write_long_ptr
002622  f04f0443          MOV      r4,#0x43              ;2164
002626  f88d4000          STRB     r4,[sp,#0]            ;2164
00262a  f88d4001          STRB     r4,[sp,#1]            ;2165
00262e  f88d4002          STRB     r4,[sp,#2]            ;2166
002632  f88d4003          STRB     r4,[sp,#3]            ;2167
002636  4669              MOV      r1,sp                 ;2168
002638  f1050018          ADD      r0,r5,#0x18           ;2168
00263c  f7fffffe          BL       lc640_write_long_ptr
002640  f88d4000          STRB     r4,[sp,#0]            ;2170
002644  f88d4001          STRB     r4,[sp,#1]            ;2171
002648  f88d4002          STRB     r4,[sp,#2]            ;2172
00264c  f88d4003          STRB     r4,[sp,#3]            ;2173
002650  4669              MOV      r1,sp                 ;2174
002652  f105001c          ADD      r0,r5,#0x1c           ;2174
002656  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9818|
00265a  e501              B        |L1.8288|
                  |L1.9820|
00265c  f89d0002          LDRB     r0,[sp,#2]            ;2188
002660  285a              CMP      r0,#0x5a              ;2188
002662  d00a              BEQ      |L1.9850|
                  |L1.9828|
002664  b114              CBZ      r4,|L1.9836|
002666  f1a40401          SUB      r4,r4,#1              ;2190
00266a  e001              B        |L1.9840|
                  |L1.9836|
00266c  f04f043f          MOV      r4,#0x3f              ;2191
                  |L1.9840|
002670  42b4              CMP      r4,r6                 ;2192
002672  d122              BNE      |L1.9914|
002674  f04f0500          MOV      r5,#0                 ;2194
002678  e025              B        |L1.9926|
                  |L1.9850|
00267a  4669              MOV      r1,sp                 ;2201
00267c  f1050010          ADD      r0,r5,#0x10           ;2201
002680  f7fffffe          BL       lc640_read_long_ptr
002684  f89d0000          LDRB     r0,[sp,#0]            ;2202
002688  2841              CMP      r0,#0x41              ;2202
00268a  d10b              BNE      |L1.9892|
00268c  f89d0001          LDRB     r0,[sp,#1]            ;2202
002690  2841              CMP      r0,#0x41              ;2202
002692  d107              BNE      |L1.9892|
002694  f89d0002          LDRB     r0,[sp,#2]            ;2202
002698  2841              CMP      r0,#0x41              ;2202
00269a  d103              BNE      |L1.9892|
00269c  f89d0003          LDRB     r0,[sp,#3]            ;2202
0026a0  2841              CMP      r0,#0x41              ;2202
0026a2  d00a              BEQ      |L1.9914|
                  |L1.9892|
0026a4  b114              CBZ      r4,|L1.9900|
0026a6  f1a40401          SUB      r4,r4,#1              ;2204
0026aa  e001              B        |L1.9904|
                  |L1.9900|
0026ac  f04f043f          MOV      r4,#0x3f              ;2205
                  |L1.9904|
0026b0  42b4              CMP      r4,r6                 ;2206
0026b2  d102              BNE      |L1.9914|
0026b4  f04f0500          MOV      r5,#0                 ;2208
0026b8  e005              B        |L1.9926|
                  |L1.9914|
0026ba  f1070701          ADD      r7,r7,#1              ;2182
0026be  b2ff              UXTB     r7,r7                 ;2182
0026c0  2f3f              CMP      r7,#0x3f              ;2182
0026c2  f4ffaea3          BCC      |L1.9228|
                  |L1.9926|
0026c6  2d00              CMP      r5,#0                 ;2215
0026c8  d0c7              BEQ      |L1.9818|
0026ca  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2217
0026ce  f88d0000          STRB     r0,[sp,#0]            ;2217
0026d2  f8980038          LDRB     r0,[r8,#0x38]         ;2218
0026d6  f88d0001          STRB     r0,[sp,#1]            ;2218
0026da  f898002c          LDRB     r0,[r8,#0x2c]         ;2219
0026de  f88d0002          STRB     r0,[sp,#2]            ;2219
0026e2  f88d9003          STRB     r9,[sp,#3]            ;2220
0026e6  4669              MOV      r1,sp                 ;2221
0026e8  f1050010          ADD      r0,r5,#0x10           ;2221
0026ec  f7fffffe          BL       lc640_write_long_ptr
0026f0  f8980028          LDRB     r0,[r8,#0x28]         ;2223
0026f4  f88d0000          STRB     r0,[sp,#0]            ;2223
0026f8  f8980024          LDRB     r0,[r8,#0x24]         ;2224
0026fc  f88d0001          STRB     r0,[sp,#1]            ;2224
002700  f8980020          LDRB     r0,[r8,#0x20]         ;2225
002704  f88d0002          STRB     r0,[sp,#2]            ;2225
002708  f88d9003          STRB     r9,[sp,#3]            ;2226
00270c  4669              MOV      r1,sp                 ;2227
00270e  f1050014          ADD      r0,r5,#0x14           ;2227
002712  f7fffffe          BL       lc640_write_long_ptr
002716  f04f0442          MOV      r4,#0x42              ;2229
00271a  f88d4000          STRB     r4,[sp,#0]            ;2229
00271e  f88d4001          STRB     r4,[sp,#1]            ;2230
002722  f88d4002          STRB     r4,[sp,#2]            ;2231
002726  f88d4003          STRB     r4,[sp,#3]            ;2232
00272a  4669              MOV      r1,sp                 ;2233
00272c  f1050018          ADD      r0,r5,#0x18           ;2233
002730  f7fffffe          BL       lc640_write_long_ptr
002734  f88d4000          STRB     r4,[sp,#0]            ;2235
002738  f88d4001          STRB     r4,[sp,#1]            ;2236
00273c  f88d4002          STRB     r4,[sp,#2]            ;2237
002740  f88d4003          STRB     r4,[sp,#3]            ;2238
002744  4669              MOV      r1,sp                 ;2239
002746  f105001c          ADD      r0,r5,#0x1c           ;2239
00274a  f7fffffe          BL       lc640_write_long_ptr
00274e  e487              B        |L1.8288|
;;;2243   
                          ENDP

                  fz_mem_hndl PROC
;;;2244   //-----------------------------------------------
;;;2245   void fz_mem_hndl(unsigned short in)	 //   
002750  e92d4ff8          PUSH     {r3-r11,lr}
;;;2246   {
;;;2247   char data[4];
;;;2248   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
002754  f04f0600          MOV      r6,#0
002758  4634              MOV      r4,r6
;;;2249   //char avar_simbol;
;;;2250   
;;;2251   if(in==1) //  
;;;2252   	{
;;;2253   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2254   	event_ptr++;	
;;;2255   	if(event_ptr>63)event_ptr=0;	
;;;2256   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2257   	
;;;2258       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2259   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2260   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2261   	
;;;2262   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2263   	
;;;2264   	data[0]='f';
;;;2265   	data[1]=0; 
;;;2266   	data[2]='Z';
;;;2267   	data[3]=0;
;;;2268   	lc640_write_long_ptr(lc640_adr,data);
;;;2269   
;;;2270   	data[0]=0;
;;;2271   	data[1]=0;
;;;2272   	data[2]=0;
;;;2273   	data[3]=0;
;;;2274   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2275   
;;;2276   	data[0]=LPC_RTC->YEAR;
00275a  f8df835c          LDR      r8,|L1.10936|
00275e  46a1              MOV      r9,r4                 ;2248
002760  f44f6a80          MOV      r10,#0x400            ;2262
002764  2801              CMP      r0,#1                 ;2251
002766  d010              BEQ      |L1.10122|
;;;2277   	data[1]=LPC_RTC->MONTH;
;;;2278   	data[2]=LPC_RTC->DOM;
;;;2279   	data[3]=0;
;;;2280   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2281   
;;;2282   	data[0]=LPC_RTC->HOUR;
;;;2283   	data[1]=LPC_RTC->MIN;
;;;2284   	data[2]=LPC_RTC->SEC;
;;;2285   	data[3]=0;
;;;2286   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2287   	
;;;2288   	data[0]='A';
;;;2289   	data[1]='A';
;;;2290   	data[2]='A';
;;;2291   	data[3]='A';
;;;2292   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2293   	
;;;2294   	data[0]='A';
;;;2295   	data[1]='A';
;;;2296   	data[2]='A';
;;;2297   	data[3]='A';
;;;2298   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2299   	
;;;2300   	data[0]='A';
;;;2301   	data[1]='A';
;;;2302   	data[2]='A';
;;;2303   	data[3]='A';
;;;2304   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2305   	
;;;2306   	data[0]='A';
;;;2307   	data[1]='A';
;;;2308   	data[2]='A';
;;;2309   	data[3]='A';
;;;2310   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2311    	
;;;2312   	}
;;;2313   
;;;2314   else if(in==0)	// 
002768  2800              CMP      r0,#0
00276a  d07d              BEQ      |L1.10344|
;;;2315   	{      
;;;2316   	char i;     
;;;2317   	event_ptr_find=0;
;;;2318   	for (i=0;i<63;i++)
;;;2319   		{
;;;2320   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2321   
;;;2322        	lc640_read_long_ptr(lc640_adr,data);
;;;2323        
;;;2324        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;2325        		{        
;;;2326        		if(event_ptr_find)event_ptr_find--;
;;;2327        		else event_ptr_find=63;
;;;2328        		if(event_ptr_find==event_ptr)
;;;2329   				{
;;;2330   				lc640_adr=0;
;;;2331   				break;
;;;2332   				}
;;;2333        		else continue;
;;;2334        		}
;;;2335        	else 
;;;2336        		{
;;;2337        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2338        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2339        			{        
;;;2340        			if(event_ptr_find)event_ptr_find--;
;;;2341            		else event_ptr_find=63;
;;;2342            		if(event_ptr_find==event_ptr)
;;;2343   					{
;;;2344   					lc640_adr=0;
;;;2345   					break;
;;;2346   					}
;;;2347        			else continue;
;;;2348        			}
;;;2349        		}	
;;;2350   		}
;;;2351   	if(lc640_adr!=0)
;;;2352   		{
;;;2353   		data[0]=LPC_RTC->YEAR;
;;;2354   		data[1]=LPC_RTC->MONTH;
;;;2355   		data[2]=LPC_RTC->DOM;
;;;2356   		data[3]=0;
;;;2357   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2358   	
;;;2359   		data[0]=LPC_RTC->HOUR;
;;;2360   		data[1]=LPC_RTC->MIN;
;;;2361   		data[2]=LPC_RTC->SEC;
;;;2362   		data[3]=0;
;;;2363   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2364   		
;;;2365   		data[0]='C';
;;;2366   		data[1]='C';
;;;2367   		data[2]='C';
;;;2368   		data[3]='C';
;;;2369   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2370   		
;;;2371   		data[0]='C';
;;;2372   		data[1]='C';
;;;2373   		data[2]='C';
;;;2374   		data[3]='C';
;;;2375   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2376   		}
;;;2377   	}
;;;2378   else if(in==10) 	//  
00276c  280a              CMP      r0,#0xa
00276e  d17c              BNE      |L1.10346|
;;;2379   	{      
;;;2380   	char i;     
;;;2381   
;;;2382   	event_ptr_find=0;
;;;2383   	for (i=0;i<63;i++)
002770  f04f0700          MOV      r7,#0
                  |L1.10100|
;;;2384   		{
;;;2385   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
002774  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2386   
;;;2387        	lc640_read_long_ptr(lc640_adr,data);
002778  4669              MOV      r1,sp
00277a  4628              MOV      r0,r5
00277c  f7fffffe          BL       lc640_read_long_ptr
;;;2388        
;;;2389        	if(!((data[0]=='f')&&(data[2]=='Z')))
002780  f89d0000          LDRB     r0,[sp,#0]
002784  2866              CMP      r0,#0x66
002786  d171              BNE      |L1.10348|
002788  e11c              B        |L1.10692|
                  |L1.10122|
00278a  f44f6560          MOV      r5,#0xe00             ;2253
00278e  4628              MOV      r0,r5                 ;2253
002790  f7fffffe          BL       lc640_read_int
002794  f1000001          ADD      r0,r0,#1              ;2254
002798  4604              MOV      r4,r0                 ;2254
00279a  2c3f              CMP      r4,#0x3f              ;2255
00279c  d901              BLS      |L1.10146|
00279e  f04f0400          MOV      r4,#0                 ;2255
                  |L1.10146|
0027a2  b221              SXTH     r1,r4                 ;2256
0027a4  4628              MOV      r0,r5                 ;2256
0027a6  f7fffffe          BL       lc640_write_int
0027aa  f6406602          MOV      r6,#0xe02             ;2258
0027ae  4630              MOV      r0,r6                 ;2258
0027b0  f7fffffe          BL       lc640_read_int
0027b4  283f              CMP      r0,#0x3f              ;2259
0027b6  d000              BEQ      |L1.10170|
0027b8  4620              MOV      r0,r4                 ;2259
                  |L1.10170|
0027ba  b201              SXTH     r1,r0                 ;2260
0027bc  4630              MOV      r0,r6                 ;2260
0027be  f7fffffe          BL       lc640_write_int
0027c2  4628              MOV      r0,r5                 ;2262
0027c4  f7fffffe          BL       lc640_read_int
0027c8  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2262
0027cc  f04f0066          MOV      r0,#0x66              ;2264
0027d0  f88d0000          STRB     r0,[sp,#0]            ;2264
0027d4  f88d9001          STRB     r9,[sp,#1]            ;2265
0027d8  f04f005a          MOV      r0,#0x5a              ;2266
0027dc  f88d0002          STRB     r0,[sp,#2]            ;2266
0027e0  f88d9003          STRB     r9,[sp,#3]            ;2267
0027e4  4669              MOV      r1,sp                 ;2268
0027e6  4620              MOV      r0,r4                 ;2268
0027e8  f7fffffe          BL       lc640_write_long_ptr
0027ec  f8cd9000          STR      r9,[sp,#0]            ;2273
0027f0  4669              MOV      r1,sp                 ;2274
0027f2  1d20              ADDS     r0,r4,#4              ;2274
0027f4  f7fffffe          BL       lc640_write_long_ptr
0027f8  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2276
0027fc  f88d0000          STRB     r0,[sp,#0]            ;2276
002800  f8980038          LDRB     r0,[r8,#0x38]         ;2277
002804  f88d0001          STRB     r0,[sp,#1]            ;2277
002808  f898002c          LDRB     r0,[r8,#0x2c]         ;2278
00280c  f88d0002          STRB     r0,[sp,#2]            ;2278
002810  f88d9003          STRB     r9,[sp,#3]            ;2279
002814  4669              MOV      r1,sp                 ;2280
002816  f1040008          ADD      r0,r4,#8              ;2280
00281a  f7fffffe          BL       lc640_write_long_ptr
00281e  f8980028          LDRB     r0,[r8,#0x28]         ;2282
002822  f88d0000          STRB     r0,[sp,#0]            ;2282
002826  f8980024          LDRB     r0,[r8,#0x24]         ;2283
00282a  f88d0001          STRB     r0,[sp,#1]            ;2283
00282e  f8980020          LDRB     r0,[r8,#0x20]         ;2284
002832  f88d0002          STRB     r0,[sp,#2]            ;2284
002836  f88d9003          STRB     r9,[sp,#3]            ;2285
00283a  4669              MOV      r1,sp                 ;2286
00283c  f104000c          ADD      r0,r4,#0xc            ;2286
002840  f7fffffe          BL       lc640_write_long_ptr
002844  f04f0541          MOV      r5,#0x41              ;2288
002848  f88d5000          STRB     r5,[sp,#0]            ;2288
00284c  f88d5001          STRB     r5,[sp,#1]            ;2289
002850  f88d5002          STRB     r5,[sp,#2]            ;2290
002854  f88d5003          STRB     r5,[sp,#3]            ;2291
002858  4669              MOV      r1,sp                 ;2292
00285a  f1040010          ADD      r0,r4,#0x10           ;2292
00285e  f7fffffe          BL       lc640_write_long_ptr
002862  f88d5000          STRB     r5,[sp,#0]            ;2294
002866  e002              B        |L1.10350|
                  |L1.10344|
002868  e027              B        |L1.10426|
                  |L1.10346|
00286a  e025              B        |L1.10424|
                  |L1.10348|
00286c  e0ae              B        |L1.10700|
                  |L1.10350|
00286e  f88d5001          STRB     r5,[sp,#1]            ;2295
002872  f88d5002          STRB     r5,[sp,#2]            ;2296
002876  f88d5003          STRB     r5,[sp,#3]            ;2297
00287a  4669              MOV      r1,sp                 ;2298
00287c  f1040014          ADD      r0,r4,#0x14           ;2298
002880  f7fffffe          BL       lc640_write_long_ptr
002884  f88d5000          STRB     r5,[sp,#0]            ;2300
002888  f88d5001          STRB     r5,[sp,#1]            ;2301
00288c  f88d5002          STRB     r5,[sp,#2]            ;2302
002890  f88d5003          STRB     r5,[sp,#3]            ;2303
002894  4669              MOV      r1,sp                 ;2304
002896  f1040018          ADD      r0,r4,#0x18           ;2304
00289a  f7fffffe          BL       lc640_write_long_ptr
00289e  f88d5000          STRB     r5,[sp,#0]            ;2306
0028a2  f88d5001          STRB     r5,[sp,#1]            ;2307
0028a6  f88d5002          STRB     r5,[sp,#2]            ;2308
0028aa  f88d5003          STRB     r5,[sp,#3]            ;2309
0028ae  4669              MOV      r1,sp                 ;2310
0028b0  f104001c          ADD      r0,r4,#0x1c           ;2310
0028b4  f7fffffe          BL       lc640_write_long_ptr
                  |L1.10424|
;;;2390        		{        
;;;2391        		if(event_ptr_find)event_ptr_find--;
;;;2392        		else event_ptr_find=63;
;;;2393        		if(event_ptr_find==event_ptr)
;;;2394   				{
;;;2395   				lc640_adr=0;
;;;2396   				break;
;;;2397   				}
;;;2398        		else continue;
;;;2399        		}
;;;2400        	else 
;;;2401        		{
;;;2402        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2403        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2404        			{        
;;;2405        			if(event_ptr_find)event_ptr_find--;
;;;2406            		else event_ptr_find=63;
;;;2407            		if(event_ptr_find==event_ptr)
;;;2408   					{
;;;2409   					lc640_adr=0;
;;;2410   					break;
;;;2411   					}
;;;2412        			else continue;
;;;2413        			}
;;;2414        		}	
;;;2415   		}
;;;2416   	if(lc640_adr!=0)
;;;2417   		{
;;;2418   		data[0]=LPC_RTC->YEAR;
;;;2419   		data[1]=LPC_RTC->MONTH;
;;;2420   		data[2]=LPC_RTC->DOM;
;;;2421   		data[3]=0;
;;;2422   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2423   	
;;;2424   		data[0]=LPC_RTC->HOUR;
;;;2425   		data[1]=LPC_RTC->MIN;
;;;2426   		data[2]=LPC_RTC->SEC;
;;;2427   		data[3]=0;
;;;2428   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2429   		
;;;2430   		data[0]='B';
;;;2431   		data[1]='B';
;;;2432   		data[2]='B';
;;;2433   		data[3]='B';
;;;2434   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2435   		
;;;2436   		data[0]='B';
;;;2437   		data[1]='B';
;;;2438   		data[2]='B';
;;;2439   		data[3]='B';
;;;2440   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2441   		}
;;;2442   	}
;;;2443   }
0028b8  e496              B        |L1.8680|
                  |L1.10426|
0028ba  f04f0700          MOV      r7,#0                 ;2318
                  |L1.10430|
0028be  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2320
0028c2  4669              MOV      r1,sp                 ;2322
0028c4  4628              MOV      r0,r5                 ;2322
0028c6  f7fffffe          BL       lc640_read_long_ptr
0028ca  f89d0000          LDRB     r0,[sp,#0]            ;2324
0028ce  2866              CMP      r0,#0x66              ;2324
0028d0  d103              BNE      |L1.10458|
0028d2  f89d0002          LDRB     r0,[sp,#2]            ;2324
0028d6  285a              CMP      r0,#0x5a              ;2324
0028d8  d00a              BEQ      |L1.10480|
                  |L1.10458|
0028da  b114              CBZ      r4,|L1.10466|
0028dc  f1a40401          SUB      r4,r4,#1              ;2326
0028e0  e001              B        |L1.10470|
                  |L1.10466|
0028e2  f04f043f          MOV      r4,#0x3f              ;2327
                  |L1.10470|
0028e6  42b4              CMP      r4,r6                 ;2328
0028e8  d122              BNE      |L1.10544|
0028ea  f04f0500          MOV      r5,#0                 ;2330
0028ee  e024              B        |L1.10554|
                  |L1.10480|
0028f0  4669              MOV      r1,sp                 ;2337
0028f2  f1050010          ADD      r0,r5,#0x10           ;2337
0028f6  f7fffffe          BL       lc640_read_long_ptr
0028fa  f89d0000          LDRB     r0,[sp,#0]            ;2338
0028fe  2841              CMP      r0,#0x41              ;2338
002900  d10b              BNE      |L1.10522|
002902  f89d0001          LDRB     r0,[sp,#1]            ;2338
002906  2841              CMP      r0,#0x41              ;2338
002908  d107              BNE      |L1.10522|
00290a  f89d0002          LDRB     r0,[sp,#2]            ;2338
00290e  2841              CMP      r0,#0x41              ;2338
002910  d103              BNE      |L1.10522|
002912  f89d0003          LDRB     r0,[sp,#3]            ;2338
002916  2841              CMP      r0,#0x41              ;2338
002918  d00a              BEQ      |L1.10544|
                  |L1.10522|
00291a  b114              CBZ      r4,|L1.10530|
00291c  f1a40401          SUB      r4,r4,#1              ;2340
002920  e001              B        |L1.10534|
                  |L1.10530|
002922  f04f043f          MOV      r4,#0x3f              ;2341
                  |L1.10534|
002926  42b4              CMP      r4,r6                 ;2342
002928  d102              BNE      |L1.10544|
00292a  f04f0500          MOV      r5,#0                 ;2344
00292e  e004              B        |L1.10554|
                  |L1.10544|
002930  f1070701          ADD      r7,r7,#1              ;2318
002934  b2ff              UXTB     r7,r7                 ;2318
002936  2f3f              CMP      r7,#0x3f              ;2318
002938  d3c1              BCC      |L1.10430|
                  |L1.10554|
00293a  2d00              CMP      r5,#0                 ;2351
00293c  d0bc              BEQ      |L1.10424|
00293e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2353
002942  f88d0000          STRB     r0,[sp,#0]            ;2353
002946  f8980038          LDRB     r0,[r8,#0x38]         ;2354
00294a  f88d0001          STRB     r0,[sp,#1]            ;2354
00294e  f898002c          LDRB     r0,[r8,#0x2c]         ;2355
002952  f88d0002          STRB     r0,[sp,#2]            ;2355
002956  f88d9003          STRB     r9,[sp,#3]            ;2356
00295a  4669              MOV      r1,sp                 ;2357
00295c  f1050010          ADD      r0,r5,#0x10           ;2357
002960  f7fffffe          BL       lc640_write_long_ptr
002964  f8980028          LDRB     r0,[r8,#0x28]         ;2359
002968  f88d0000          STRB     r0,[sp,#0]            ;2359
00296c  f8980024          LDRB     r0,[r8,#0x24]         ;2360
002970  f88d0001          STRB     r0,[sp,#1]            ;2360
002974  f8980020          LDRB     r0,[r8,#0x20]         ;2361
002978  f88d0002          STRB     r0,[sp,#2]            ;2361
00297c  f88d9003          STRB     r9,[sp,#3]            ;2362
002980  4669              MOV      r1,sp                 ;2363
002982  f1050014          ADD      r0,r5,#0x14           ;2363
002986  f7fffffe          BL       lc640_write_long_ptr
00298a  f04f0443          MOV      r4,#0x43              ;2365
00298e  f88d4000          STRB     r4,[sp,#0]            ;2365
002992  f88d4001          STRB     r4,[sp,#1]            ;2366
002996  f88d4002          STRB     r4,[sp,#2]            ;2367
00299a  f88d4003          STRB     r4,[sp,#3]            ;2368
00299e  4669              MOV      r1,sp                 ;2369
0029a0  f1050018          ADD      r0,r5,#0x18           ;2369
0029a4  f7fffffe          BL       lc640_write_long_ptr
0029a8  f88d4000          STRB     r4,[sp,#0]            ;2371
0029ac  f88d4001          STRB     r4,[sp,#1]            ;2372
0029b0  f88d4002          STRB     r4,[sp,#2]            ;2373
0029b4  f88d4003          STRB     r4,[sp,#3]            ;2374
0029b8  4669              MOV      r1,sp                 ;2375
0029ba  f105001c          ADD      r0,r5,#0x1c           ;2375
0029be  f7fffffe          BL       lc640_write_long_ptr
                  |L1.10690|
0029c2  e411              B        |L1.8680|
                  |L1.10692|
0029c4  f89d0002          LDRB     r0,[sp,#2]            ;2389
0029c8  285a              CMP      r0,#0x5a              ;2389
0029ca  d00a              BEQ      |L1.10722|
                  |L1.10700|
0029cc  b114              CBZ      r4,|L1.10708|
0029ce  f1a40401          SUB      r4,r4,#1              ;2391
0029d2  e001              B        |L1.10712|
                  |L1.10708|
0029d4  f04f043f          MOV      r4,#0x3f              ;2392
                  |L1.10712|
0029d8  42b4              CMP      r4,r6                 ;2393
0029da  d122              BNE      |L1.10786|
0029dc  f04f0500          MOV      r5,#0                 ;2395
0029e0  e025              B        |L1.10798|
                  |L1.10722|
0029e2  4669              MOV      r1,sp                 ;2402
0029e4  f1050010          ADD      r0,r5,#0x10           ;2402
0029e8  f7fffffe          BL       lc640_read_long_ptr
0029ec  f89d0000          LDRB     r0,[sp,#0]            ;2403
0029f0  2841              CMP      r0,#0x41              ;2403
0029f2  d10b              BNE      |L1.10764|
0029f4  f89d0001          LDRB     r0,[sp,#1]            ;2403
0029f8  2841              CMP      r0,#0x41              ;2403
0029fa  d107              BNE      |L1.10764|
0029fc  f89d0002          LDRB     r0,[sp,#2]            ;2403
002a00  2841              CMP      r0,#0x41              ;2403
002a02  d103              BNE      |L1.10764|
002a04  f89d0003          LDRB     r0,[sp,#3]            ;2403
002a08  2841              CMP      r0,#0x41              ;2403
002a0a  d00a              BEQ      |L1.10786|
                  |L1.10764|
002a0c  b114              CBZ      r4,|L1.10772|
002a0e  f1a40401          SUB      r4,r4,#1              ;2405
002a12  e001              B        |L1.10776|
                  |L1.10772|
002a14  f04f043f          MOV      r4,#0x3f              ;2406
                  |L1.10776|
002a18  42b4              CMP      r4,r6                 ;2407
002a1a  d102              BNE      |L1.10786|
002a1c  f04f0500          MOV      r5,#0                 ;2409
002a20  e005              B        |L1.10798|
                  |L1.10786|
002a22  f1070701          ADD      r7,r7,#1              ;2383
002a26  b2ff              UXTB     r7,r7                 ;2383
002a28  2f3f              CMP      r7,#0x3f              ;2383
002a2a  f4ffaea3          BCC      |L1.10100|
                  |L1.10798|
002a2e  2d00              CMP      r5,#0                 ;2416
002a30  d0c7              BEQ      |L1.10690|
002a32  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2418
002a36  f88d0000          STRB     r0,[sp,#0]            ;2418
002a3a  f8980038          LDRB     r0,[r8,#0x38]         ;2419
002a3e  f88d0001          STRB     r0,[sp,#1]            ;2419
002a42  f898002c          LDRB     r0,[r8,#0x2c]         ;2420
002a46  f88d0002          STRB     r0,[sp,#2]            ;2420
002a4a  f88d9003          STRB     r9,[sp,#3]            ;2421
002a4e  4669              MOV      r1,sp                 ;2422
002a50  f1050010          ADD      r0,r5,#0x10           ;2422
002a54  f7fffffe          BL       lc640_write_long_ptr
002a58  f8980028          LDRB     r0,[r8,#0x28]         ;2424
002a5c  f88d0000          STRB     r0,[sp,#0]            ;2424
002a60  f8980024          LDRB     r0,[r8,#0x24]         ;2425
002a64  f88d0001          STRB     r0,[sp,#1]            ;2425
002a68  f8980020          LDRB     r0,[r8,#0x20]         ;2426
002a6c  f88d0002          STRB     r0,[sp,#2]            ;2426
002a70  f88d9003          STRB     r9,[sp,#3]            ;2427
002a74  4669              MOV      r1,sp                 ;2428
002a76  f1050014          ADD      r0,r5,#0x14           ;2428
002a7a  f7fffffe          BL       lc640_write_long_ptr
002a7e  f04f0442          MOV      r4,#0x42              ;2430
002a82  f88d4000          STRB     r4,[sp,#0]            ;2430
002a86  f88d4001          STRB     r4,[sp,#1]            ;2431
002a8a  f88d4002          STRB     r4,[sp,#2]            ;2432
002a8e  f88d4003          STRB     r4,[sp,#3]            ;2433
002a92  4669              MOV      r1,sp                 ;2434
002a94  f1050018          ADD      r0,r5,#0x18           ;2434
002a98  f7fffffe          BL       lc640_write_long_ptr
002a9c  f88d4000          STRB     r4,[sp,#0]            ;2436
002aa0  f88d4001          STRB     r4,[sp,#1]            ;2437
002aa4  f88d4002          STRB     r4,[sp,#2]            ;2438
002aa8  f88d4003          STRB     r4,[sp,#3]            ;2439
002aac  4669              MOV      r1,sp                 ;2440
002aae  f105001c          ADD      r0,r5,#0x1c           ;2440
002ab2  f7fffffe          BL       lc640_write_long_ptr
002ab6  e41c              B        |L1.8946|
                          ENDP

                  |L1.10936|
                          DCD      0x40024000

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  ke_mem_hndl PROC
;;;77     //-----------------------------------------------
;;;78     void avar_hndl(void)
000000  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;79     {
;;;80     //static unsigned avar_stat_old;
;;;81     char i;
;;;82     //unsigned avar_stat_new,avar_stat_offed;
;;;83     
;;;84     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  b083              SUB      sp,sp,#0xc
000004  4605              MOV      r5,r0
000006  eb050045          ADD      r0,r5,r5,LSL #1
00000a  4948              LDR      r1,|L2.300|
00000c  eb001005          ADD      r0,r0,r5,LSL #4
000010  eb010180          ADD      r1,r1,r0,LSL #2
;;;85     else	   			SET_REG(avar_stat,0,0,1);
000014  4846              LDR      r0,|L2.304|
000016  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
;;;86     
;;;87     for(i=0;i<2;i++)
00001a  f1000001          ADD      r0,r0,#1
;;;88     	{
;;;89     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
00001e  eb010040          ADD      r0,r1,r0,LSL #1
000022  f9b00020          LDRSH    r0,[r0,#0x20]
000026  9001              STR      r0,[sp,#4]
000028  f44f6660          MOV      r6,#0xe00
00002c  4630              MOV      r0,r6
00002e  f7fffffe          BL       lc640_read_int
000032  f1000001          ADD      r0,r0,#1
000036  4604              MOV      r4,r0
000038  2c3f              CMP      r4,#0x3f
00003a  d901              BLS      |L2.64|
00003c  f04f0400          MOV      r4,#0
                  |L2.64|
000040  b221              SXTH     r1,r4
000042  4630              MOV      r0,r6
000044  f7fffffe          BL       lc640_write_int
000048  f6406702          MOV      r7,#0xe02
00004c  4638              MOV      r0,r7
;;;90     	else	   			SET_REG(avar_stat,0,1+i,1);
00004e  f7fffffe          BL       lc640_read_int
000052  283f              CMP      r0,#0x3f
000054  d000              BEQ      |L2.88|
000056  4620              MOV      r0,r4
                  |L2.88|
000058  b201              SXTH     r1,r0
00005a  4638              MOV      r0,r7
00005c  f7fffffe          BL       lc640_write_int
000060  4630              MOV      r0,r6                 ;87
000062  f7fffffe          BL       lc640_read_int
000066  f44f6180          MOV      r1,#0x400             ;87
;;;91     	}
;;;92     
;;;93     for(i=0;i<12;i++)
00006a  eb011440          ADD      r4,r1,r0,LSL #5
;;;94     	{
;;;95     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00006e  f04f0042          MOV      r0,#0x42
000072  f88d0008          STRB     r0,[sp,#8]
000076  f88d5009          STRB     r5,[sp,#9]
00007a  f04f004b          MOV      r0,#0x4b
00007e  f88d000a          STRB     r0,[sp,#0xa]
000082  f04f0600          MOV      r6,#0
000086  f88d600b          STRB     r6,[sp,#0xb]
00008a  a902              ADD      r1,sp,#8
00008c  4620              MOV      r0,r4
00008e  f7fffffe          BL       lc640_write_long_ptr
000092  f89d0010          LDRB     r0,[sp,#0x10]
000096  f88d0008          STRB     r0,[sp,#8]
;;;96     	else	   		SET_REG(avar_stat,0,3+i,1);
00009a  f89d0011          LDRB     r0,[sp,#0x11]
00009e  f88d0009          STRB     r0,[sp,#9]
0000a2  f89d0004          LDRB     r0,[sp,#4]
0000a6  f88d000a          STRB     r0,[sp,#0xa]
0000aa  f89d0005          LDRB     r0,[sp,#5]            ;93
0000ae  f88d000b          STRB     r0,[sp,#0xb]          ;93
;;;97     	}
;;;98     
;;;99     for(i=0;i<6;i++)
0000b2  a902              ADD      r1,sp,#8
0000b4  1d20              ADDS     r0,r4,#4
;;;100    	{
;;;101    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
0000b6  f7fffffe          BL       lc640_write_long_ptr
0000ba  f24020a2          MOV      r0,#0x2a2
0000be  f7fffffe          BL       lc640_read_long
0000c2  4d1c              LDR      r5,|L2.308|
0000c4  6028              STR      r0,[r5,#0]  ; ke_date
0000c6  4629              MOV      r1,r5
0000c8  f1040008          ADD      r0,r4,#8
0000cc  f7fffffe          BL       lc640_write_long_ptr
0000d0  f24020a6          MOV      r0,#0x2a6
0000d4  f7fffffe          BL       lc640_read_long
;;;102    	else	   		SET_REG(avar_stat,0,15+i,1);
0000d8  6068              STR      r0,[r5,#4]  ; ke_date
0000da  1d29              ADDS     r1,r5,#4
0000dc  f104000c          ADD      r0,r4,#0xc
0000e0  f7fffffe          BL       lc640_write_long_ptr
0000e4  4d14              LDR      r5,|L2.312|
0000e6  8ba8              LDRH     r0,[r5,#0x1c]         ;99
0000e8  f88d0008          STRB     r0,[sp,#8]            ;99
0000ec  7e28              LDRB     r0,[r5,#0x18]         ;99
0000ee  f88d0009          STRB     r0,[sp,#9]            ;99
;;;103    	}
;;;104    
;;;105    /*for(i=0;i<4;i++)
;;;106    	{
;;;107    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;108    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;109    	}  */
;;;110    for(i=0;i<4;i++)
0000f2  7b28              LDRB     r0,[r5,#0xc]
;;;111    	{
;;;112    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000f4  f88d000a          STRB     r0,[sp,#0xa]
0000f8  f88d600b          STRB     r6,[sp,#0xb]
;;;113    	else	   		SET_REG(avar_stat,0,24+i,1);
0000fc  a902              ADD      r1,sp,#8
0000fe  f1040010          ADD      r0,r4,#0x10
000102  f7fffffe          BL       lc640_write_long_ptr
000106  7a28              LDRB     r0,[r5,#8]
000108  f88d0008          STRB     r0,[sp,#8]
00010c  7928              LDRB     r0,[r5,#4]            ;110
00010e  f88d0009          STRB     r0,[sp,#9]            ;110
000112  7828              LDRB     r0,[r5,#0]            ;110
000114  f88d000a          STRB     r0,[sp,#0xa]          ;110
;;;114    	}
;;;115    
;;;116    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;117    //else	   			SET_REG(avar_stat,0,28,1);
;;;118    
;;;119    
;;;120    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000118  f88d600b          STRB     r6,[sp,#0xb]
00011c  a902              ADD      r1,sp,#8
00011e  f1040014          ADD      r0,r4,#0x14
;;;121    
;;;122    avar_ind_stat|=avar_stat_new;
000122  f7fffffe          BL       lc640_write_long_ptr
000126  b005              ADD      sp,sp,#0x14
;;;123    
;;;124    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000128  bdf0              POP      {r4-r7,pc}
;;;125    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
;;;126    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
;;;127    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
;;;128    
;;;129    
;;;130    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
;;;131    
;;;132    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
;;;133    
;;;134    avar_ind_stat&=avar_stat_offed; 
;;;135    
;;;136    avar_stat_old=avar_stat;
;;;137    
;;;138    //oleg_start
;;;139    
;;;140    
;;;141    
;;;142    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
;;;143    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
;;;144    rki_avar1_ind_stat|=rki_avar1_stat_new;
;;;145    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
;;;146    rki_avar1_ind_stat&=rki_avar1_stat_offed;
;;;147    rki_avar1_stat_old=rki_avar1_stat;
;;;148    /*
;;;149    rki_avarI1_stat=status_di1;
;;;150    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;151    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;152    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;153    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;154    rki_avarI1_stat_old=rki_avarI1_stat;
;;;155    
;;;156    rki_avarI2_stat=status_di2;
;;;157    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;158    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;159    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;160    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;161    rki_avarI2_stat_old=rki_avarI2_stat;
;;;162    */
;;;163    //oleg_end
;;;164    }
;;;165    
                          ENDP

00012a  0000              DCW      0x0000
                  |L2.300|
                          DCD      bat
                  |L2.304|
                          DCD      bat_u_old_cnt
                  |L2.308|
                          DCD      ke_date
                  |L2.312|
                          DCD      0x40024020

                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  rki_avar1_stat
                          DCD      0x00000000
                  rki_avar1_ind_stat
                          DCD      0x00000000
                  rki_avar1_stat_old
                          DCD      0x00000000
                  rki_avar1_stat_new
                          DCD      0x00000000
                  rki_avar1_stat_offed
                          DCD      0x00000000
                  av_inv
                          DCD      0x00000000
00002c  0000              DCB      0x00,0x00
