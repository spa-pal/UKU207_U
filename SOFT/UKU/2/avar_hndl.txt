; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\avar_hndl.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DUKU_ZVU --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;82     //-----------------------------------------------
;;;83     void avar_hndl(void)
000000  b570              PUSH     {r4-r6,lr}
;;;84     {
;;;85     //static unsigned avar_stat_old;
;;;86     char i;
;;;87     //unsigned avar_stat_new,avar_stat_offed;
;;;88     
;;;89     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48ff              LDR      r0,|L1.1024|
000004  4aff              LDR      r2,|L1.1028|
000006  7801              LDRB     r1,[r0,#0]  ; net_av
000008  6890              LDR      r0,[r2,#8]
00000a  b119              CBZ      r1,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6090              STR      r0,[r2,#8]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;90     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6090              STR      r0,[r2,#8]  ; avar_stat
                  |L1.26|
;;;91     #ifndef UKU_220_IPS_TERMOKOMPENSAT //o_10
;;;92     for(i=0;i<2;i++)
;;;93     	{
;;;94     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
;;;95     	else	   			SET_REG(avar_stat,0,1+i,1);
;;;96     	}
;;;97     #endif //o_10
;;;98     for(i=0;i<18;i++)
00001a  f04f0000          MOV      r0,#0
;;;99     	{
;;;100    	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00001e  4bfa              LDR      r3,|L1.1032|
000020  f04f0501          MOV      r5,#1
                  |L1.36|
000024  eb0001c0          ADD      r1,r0,r0,LSL #3
000028  eb011100          ADD      r1,r1,r0,LSL #4
00002c  eb030181          ADD      r1,r3,r1,LSL #2
000030  7849              LDRB     r1,[r1,#1]
000032  f0110fef          TST      r1,#0xef
000036  d00a              BEQ      |L1.78|
000038  f1000403          ADD      r4,r0,#3
00003c  fa05f104          LSL      r1,r5,r4
000040  6894              LDR      r4,[r2,#8]  ; avar_stat
000042  ea240401          BIC      r4,r4,r1
000046  ea440401          ORR      r4,r4,r1
00004a  6094              STR      r4,[r2,#8]  ; avar_stat
00004c  e007              B        |L1.94|
                  |L1.78|
;;;101    	else	   			SET_REG(avar_stat,0,3+i,1);
00004e  f1000103          ADD      r1,r0,#3
000052  fa05f401          LSL      r4,r5,r1
000056  6891              LDR      r1,[r2,#8]  ; avar_stat
000058  ea210104          BIC      r1,r1,r4
00005c  6091              STR      r1,[r2,#8]  ; avar_stat
                  |L1.94|
00005e  f1000001          ADD      r0,r0,#1              ;98
000062  b2c0              UXTB     r0,r0                 ;98
000064  2812              CMP      r0,#0x12              ;98
000066  d3dd              BCC      |L1.36|
;;;102    	}
;;;103    
;;;104    /*for(i=0;i<6;i++)
;;;105    	{
;;;106    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
;;;107    	else	   		SET_REG(avar_stat,0,15+i,1);
;;;108    	}*/
;;;109    
;;;110    /*for(i=0;i<4;i++)
;;;111    	{
;;;112    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;113    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;114    	}  */
;;;115    #ifndef UKU_ZVU
;;;116    for(i=0;i<4;i++)
;;;117    	{
;;;118    	if(sk_av_stat[i]==sasON)	SET_REG(sk_avar_stat,1,i,1);
;;;119    	else	   					SET_REG(sk_avar_stat,0,i,1);
;;;120    	}
;;;121    #endif //UKU_ZVU
;;;122    #ifndef UKU_FSO
;;;123    for(i=0;i<4;i++)
000068  f04f0000          MOV      r0,#0
                  |L1.108|
00006c  f1000001          ADD      r0,r0,#1
000070  b2c0              UXTB     r0,r0
000072  2804              CMP      r0,#4
000074  d3fa              BCC      |L1.108|
;;;124    	{
;;;125    //	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
;;;126    //	else	   		SET_REG(avar_stat,0,24+i,1);
;;;127    	}
;;;128    #endif //UKU_FSO
;;;129    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;130    //else	   			SET_REG(avar_stat,0,28,1);
;;;131    
;;;132    
;;;133    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000076  6890              LDR      r0,[r2,#8]  ; avar_stat
000078  6911              LDR      r1,[r2,#0x10]  ; avar_stat_old
00007a  4604              MOV      r4,r0
00007c  ea200001          BIC      r0,r0,r1
000080  6150              STR      r0,[r2,#0x14]  ; avar_stat_new
;;;134    
;;;135    avar_ind_stat|=avar_stat_new;
000082  68d3              LDR      r3,[r2,#0xc]  ; avar_ind_stat
000084  ea430300          ORR      r3,r3,r0
000088  60d3              STR      r3,[r2,#0xc]  ; avar_ind_stat
;;;136    
;;;137    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
00008a  ea210104          BIC      r1,r1,r4
00008e  ea6f0001          MVN      r0,r1
000092  6190              STR      r0,[r2,#0x18]  ; avar_stat_offed
;;;138    
;;;139    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
000094  49dd              LDR      r1,|L1.1036|
000096  f9b15000          LDRSH    r5,[r1,#0]  ; AV_OFF_AVT
00009a  b91d              CBNZ     r5,|L1.164|
00009c  49dc              LDR      r1,|L1.1040|
00009e  ea400001          ORR      r0,r0,r1
0000a2  6190              STR      r0,[r2,#0x18]  ; avar_stat_offed
                  |L1.164|
;;;140    
;;;141    avar_ind_stat&=avar_stat_offed; 
0000a4  6990              LDR      r0,[r2,#0x18]  ; avar_stat_offed
0000a6  ea030300          AND      r3,r3,r0
0000aa  60d3              STR      r3,[r2,#0xc]  ; avar_ind_stat
;;;142    
;;;143    avar_stat_old=avar_stat;
0000ac  6114              STR      r4,[r2,#0x10]  ; avar_stat_old
;;;144    
;;;145    
;;;146    sk_avar_stat_new=(sk_avar_stat^sk_avar_stat_old)&sk_avar_stat;
0000ae  7810              LDRB     r0,[r2,#0]  ; sk_avar_stat
0000b0  7891              LDRB     r1,[r2,#2]  ; sk_avar_stat_old
0000b2  ea200301          BIC      r3,r0,r1
0000b6  70d3              STRB     r3,[r2,#3]
;;;147    
;;;148    sk_avar_ind_stat|=sk_avar_stat_new;
0000b8  7854              LDRB     r4,[r2,#1]  ; sk_avar_ind_stat
0000ba  ea440403          ORR      r4,r4,r3
0000be  7054              STRB     r4,[r2,#1]
;;;149    
;;;150    sk_avar_stat_offed=~((sk_avar_stat^sk_avar_stat_old)&sk_avar_stat_old);
0000c0  ea210100          BIC      r1,r1,r0
0000c4  ea6f0101          MVN      r1,r1
0000c8  b2c9              UXTB     r1,r1
0000ca  7111              STRB     r1,[r2,#4]
;;;151    
;;;152    
;;;153    if((SK_ZVUK_EN[0])) sk_avar_ind_stat&=(~(1UL<<0));
0000cc  4bd1              LDR      r3,|L1.1044|
0000ce  881e              LDRH     r6,[r3,#0]  ; SK_ZVUK_EN
0000d0  b116              CBZ      r6,|L1.216|
0000d2  f0240401          BIC      r4,r4,#1
0000d6  7054              STRB     r4,[r2,#1]
                  |L1.216|
;;;154    if((SK_ZVUK_EN[1])) sk_avar_ind_stat&=(~(1UL<<1));
0000d8  885c              LDRH     r4,[r3,#2]  ; SK_ZVUK_EN
0000da  b11c              CBZ      r4,|L1.228|
0000dc  7854              LDRB     r4,[r2,#1]  ; sk_avar_ind_stat
0000de  f0240402          BIC      r4,r4,#2
0000e2  7054              STRB     r4,[r2,#1]
                  |L1.228|
;;;155    if((SK_ZVUK_EN[2])) sk_avar_ind_stat&=(~(1UL<<2));
0000e4  889c              LDRH     r4,[r3,#4]  ; SK_ZVUK_EN
0000e6  b11c              CBZ      r4,|L1.240|
0000e8  7854              LDRB     r4,[r2,#1]  ; sk_avar_ind_stat
0000ea  f0240404          BIC      r4,r4,#4
0000ee  7054              STRB     r4,[r2,#1]
                  |L1.240|
;;;156    if((SK_ZVUK_EN[3])) sk_avar_ind_stat&=(~(1UL<<3));	
0000f0  88db              LDRH     r3,[r3,#6]  ; SK_ZVUK_EN
0000f2  b11b              CBZ      r3,|L1.252|
0000f4  7853              LDRB     r3,[r2,#1]  ; sk_avar_ind_stat
0000f6  f0230308          BIC      r3,r3,#8
0000fa  7053              STRB     r3,[r2,#1]
                  |L1.252|
;;;157    
;;;158    if(!AV_OFF_AVT)sk_avar_stat_offed|=0x0f;
0000fc  b915              CBNZ     r5,|L1.260|
0000fe  f041010f          ORR      r1,r1,#0xf
000102  7111              STRB     r1,[r2,#4]
                  |L1.260|
;;;159    
;;;160    sk_avar_ind_stat&=sk_avar_stat_offed; 
000104  7851              LDRB     r1,[r2,#1]  ; sk_avar_ind_stat
000106  7913              LDRB     r3,[r2,#4]  ; sk_avar_stat_offed
000108  ea010103          AND      r1,r1,r3
00010c  7051              STRB     r1,[r2,#1]
;;;161    
;;;162    sk_avar_stat_old=sk_avar_stat;
00010e  7090              STRB     r0,[r2,#2]
;;;163    
;;;164    //oleg_start
;;;165    
;;;166    
;;;167    
;;;168    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
000110  48c1              LDR      r0,|L1.1048|
000112  49c2              LDR      r1,|L1.1052|
000114  8800              LDRH     r0,[r0,#0]  ; status_izm_r
000116  6809              LDR      r1,[r1,#0]  ; sk_alarm
000118  f000003f          AND      r0,r0,#0x3f
00011c  ea402001          ORR      r0,r0,r1,LSL #8
000120  61d0              STR      r0,[r2,#0x1c]  ; rki_avar1_stat
;;;169    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
000122  6a53              LDR      r3,[r2,#0x24]  ; rki_avar1_stat_old
000124  ea200103          BIC      r1,r0,r3
000128  6291              STR      r1,[r2,#0x28]  ; rki_avar1_stat_new
;;;170    rki_avar1_ind_stat|=rki_avar1_stat_new;
00012a  6a14              LDR      r4,[r2,#0x20]  ; rki_avar1_ind_stat
00012c  ea440401          ORR      r4,r4,r1
;;;171    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
000130  ea230300          BIC      r3,r3,r0
000134  ea6f0103          MVN      r1,r3
000138  62d1              STR      r1,[r2,#0x2c]  ; rki_avar1_stat_offed
;;;172    rki_avar1_ind_stat&=rki_avar1_stat_offed;
00013a  ea040401          AND      r4,r4,r1
00013e  6214              STR      r4,[r2,#0x20]  ; rki_avar1_ind_stat
;;;173    rki_avar1_stat_old=rki_avar1_stat;
000140  6250              STR      r0,[r2,#0x24]  ; rki_avar1_stat_old
;;;174    /*
;;;175    rki_avarI1_stat=status_di1;
;;;176    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;177    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;178    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;179    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;180    rki_avarI1_stat_old=rki_avarI1_stat;
;;;181    
;;;182    rki_avarI2_stat=status_di2;
;;;183    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;184    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;185    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;186    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;187    rki_avarI2_stat_old=rki_avarI2_stat;
;;;188    */
;;;189    //oleg_end
;;;190    }
000142  bd70              POP      {r4-r6,pc}
;;;191    
                          ENDP

                  reload_hndl PROC
;;;192    //-----------------------------------------------
;;;193    void reload_hndl(void)
000144  b5f8              PUSH     {r3-r7,lr}
;;;194    {
;;;195    
;;;196    char data[4];
;;;197    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;198    
;;;199    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000146  f44f6560          MOV      r5,#0xe00
00014a  4628              MOV      r0,r5
00014c  f7fffffe          BL       lc640_read_int
;;;200    event_ptr++;	
000150  f1000001          ADD      r0,r0,#1
000154  4604              MOV      r4,r0
;;;201    if(event_ptr>63)event_ptr=0;	
000156  2c3f              CMP      r4,#0x3f
000158  d901              BLS      |L1.350|
00015a  f04f0400          MOV      r4,#0
                  |L1.350|
;;;202    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
00015e  b221              SXTH     r1,r4
000160  4628              MOV      r0,r5
000162  f7fffffe          BL       lc640_write_int
;;;203    	
;;;204    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000166  f6406602          MOV      r6,#0xe02
00016a  4630              MOV      r0,r6
00016c  f7fffffe          BL       lc640_read_int
;;;205    if(event_cnt!=63)event_cnt=event_ptr;
000170  283f              CMP      r0,#0x3f
000172  d000              BEQ      |L1.374|
000174  4620              MOV      r0,r4
                  |L1.374|
;;;206    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000176  b201              SXTH     r1,r0
000178  4630              MOV      r0,r6
00017a  f7fffffe          BL       lc640_write_int
;;;207    	
;;;208    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
00017e  4628              MOV      r0,r5
000180  f7fffffe          BL       lc640_read_int
000184  f44f6180          MOV      r1,#0x400
000188  eb011440          ADD      r4,r1,r0,LSL #5
;;;209    	
;;;210    data[0]='U';
00018c  f04f0055          MOV      r0,#0x55
000190  f88d0000          STRB     r0,[sp,#0]
;;;211    data[1]=0;
000194  f04f0600          MOV      r6,#0
000198  f88d6001          STRB     r6,[sp,#1]
;;;212    data[2]='R';
00019c  f04f0052          MOV      r0,#0x52
0001a0  f88d0002          STRB     r0,[sp,#2]
;;;213    data[3]=0;
0001a4  f88d6003          STRB     r6,[sp,#3]
;;;214    lc640_write_long_ptr(lc640_adr,data);
0001a8  4669              MOV      r1,sp
0001aa  4620              MOV      r0,r4
0001ac  f7fffffe          BL       lc640_write_long_ptr
;;;215    
;;;216    data[0]=0;
;;;217    data[1]=0;
;;;218    data[2]=0;
;;;219    data[3]=0;
0001b0  9600              STR      r6,[sp,#0]
;;;220    lc640_write_long_ptr(lc640_adr+4,data);
0001b2  4669              MOV      r1,sp
0001b4  1d20              ADDS     r0,r4,#4
0001b6  f7fffffe          BL       lc640_write_long_ptr
;;;221    
;;;222    data[0]=LPC_RTC->YEAR;
0001ba  4d99              LDR      r5,|L1.1056|
0001bc  8ba8              LDRH     r0,[r5,#0x1c]
0001be  f88d0000          STRB     r0,[sp,#0]
;;;223    data[1]=LPC_RTC->MONTH;
0001c2  7e28              LDRB     r0,[r5,#0x18]
0001c4  f88d0001          STRB     r0,[sp,#1]
;;;224    data[2]=LPC_RTC->DOM;
0001c8  7b28              LDRB     r0,[r5,#0xc]
0001ca  f88d0002          STRB     r0,[sp,#2]
;;;225    data[3]=0;
0001ce  f88d6003          STRB     r6,[sp,#3]
;;;226    lc640_write_long_ptr(lc640_adr+8,data);
0001d2  4669              MOV      r1,sp
0001d4  f1040008          ADD      r0,r4,#8
0001d8  f7fffffe          BL       lc640_write_long_ptr
;;;227    
;;;228    data[0]=LPC_RTC->HOUR;
0001dc  7a28              LDRB     r0,[r5,#8]
0001de  f88d0000          STRB     r0,[sp,#0]
;;;229    data[1]=LPC_RTC->MIN;
0001e2  7928              LDRB     r0,[r5,#4]
0001e4  f88d0001          STRB     r0,[sp,#1]
;;;230    data[2]=LPC_RTC->SEC;
0001e8  7828              LDRB     r0,[r5,#0]
0001ea  f88d0002          STRB     r0,[sp,#2]
;;;231    data[3]=LPC_SC->RSID;
0001ee  488d              LDR      r0,|L1.1060|
0001f0  f8d00180          LDR      r0,[r0,#0x180]
0001f4  f88d0003          STRB     r0,[sp,#3]
;;;232    
;;;233    lc640_write_long_ptr(lc640_adr+12,data);
0001f8  4669              MOV      r1,sp
0001fa  f104000c          ADD      r0,r4,#0xc
0001fe  f7fffffe          BL       lc640_write_long_ptr
;;;234    	
;;;235    data[0]='A';
000202  f04f0541          MOV      r5,#0x41
000206  f88d5000          STRB     r5,[sp,#0]
;;;236    data[1]='A';
00020a  f88d5001          STRB     r5,[sp,#1]
;;;237    data[2]='A';
00020e  f88d5002          STRB     r5,[sp,#2]
;;;238    data[3]='A';
000212  f88d5003          STRB     r5,[sp,#3]
;;;239    lc640_write_long_ptr(lc640_adr+16,data);
000216  4669              MOV      r1,sp
000218  f1040010          ADD      r0,r4,#0x10
00021c  f7fffffe          BL       lc640_write_long_ptr
;;;240    	
;;;241    data[0]='A';
000220  f88d5000          STRB     r5,[sp,#0]
;;;242    data[1]='A';
000224  f88d5001          STRB     r5,[sp,#1]
;;;243    data[2]='A';
000228  f88d5002          STRB     r5,[sp,#2]
;;;244    data[3]='A';
00022c  f88d5003          STRB     r5,[sp,#3]
;;;245    lc640_write_long_ptr(lc640_adr+20,data);
000230  4669              MOV      r1,sp
000232  f1040014          ADD      r0,r4,#0x14
000236  f7fffffe          BL       lc640_write_long_ptr
;;;246    	
;;;247    data[0]='A';
00023a  f88d5000          STRB     r5,[sp,#0]
;;;248    data[1]='A';
00023e  f88d5001          STRB     r5,[sp,#1]
;;;249    data[2]='A';
000242  f88d5002          STRB     r5,[sp,#2]
;;;250    data[3]='A';
000246  f88d5003          STRB     r5,[sp,#3]
;;;251    lc640_write_long_ptr(lc640_adr+24,data);
00024a  4669              MOV      r1,sp
00024c  f1040018          ADD      r0,r4,#0x18
000250  f7fffffe          BL       lc640_write_long_ptr
;;;252    	
;;;253    data[0]='A';
000254  f88d5000          STRB     r5,[sp,#0]
;;;254    data[1]='A';
000258  f88d5001          STRB     r5,[sp,#1]
;;;255    data[2]='A';
00025c  f88d5002          STRB     r5,[sp,#2]
;;;256    data[3]='A';
000260  f88d5003          STRB     r5,[sp,#3]
;;;257    lc640_write_long_ptr(lc640_adr+28,data);				
000264  4669              MOV      r1,sp
000266  f104001c          ADD      r0,r4,#0x1c
00026a  f7fffffe          BL       lc640_write_long_ptr
;;;258    	
;;;259    	
;;;260    }
00026e  bdf8              POP      {r3-r7,pc}
;;;261    
                          ENDP

                  avar_unet_hndl PROC
;;;262    //-----------------------------------------------
;;;263    void avar_unet_hndl(char in)
000270  e92d4ff8          PUSH     {r3-r11,lr}
;;;264    {
000274  4604              MOV      r4,r0
;;;265    
;;;266    char data[4];
;;;267    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;268    
;;;269    
;;;270    if(in==1)
;;;271    	{
;;;272    	net_av|=1; //o_10
000276  4962              LDR      r1,|L1.1024|
;;;273    	net_av_2min_timer=1200;
;;;274    
;;;275    	//beep_init(0x01L,'O');
;;;276    	//a.av.bAN=1;
;;;277    
;;;278    
;;;279    	//beep_init(0x33333333,'A');
;;;280    	 
;;;281    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;282    	event_ptr++;	
;;;283    	if(event_ptr>63)event_ptr=0;	
;;;284    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;285    	
;;;286         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;287    	if(event_cnt!=63)event_cnt=event_ptr;
;;;288    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;289    	
;;;290    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;291    	
;;;292    	data[0]='P';
;;;293    	data[1]=0;
;;;294    	data[2]='A';
;;;295    	data[3]=0;
;;;296    	lc640_write_long_ptr(lc640_adr,data);
;;;297    
;;;298    	data[0]=0;//*((char*)&Unet_store);
;;;299    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;300    	data[2]=0;
;;;301    	data[3]=0;
;;;302    	lc640_write_long_ptr(lc640_adr+4,data);
;;;303    
;;;304    	data[0]=LPC_RTC->YEAR;
000278  4d6b              LDR      r5,|L1.1064|
00027a  f04f0600          MOV      r6,#0                 ;283
00027e  7808              LDRB     r0,[r1,#0]            ;272
000280  f04f0b50          MOV      r11,#0x50             ;292
000284  f04f0841          MOV      r8,#0x41              ;294
000288  f44f6260          MOV      r2,#0xe00             ;281
00028c  f6406a02          MOV      r10,#0xe02            ;286
000290  f44f6780          MOV      r7,#0x400             ;290
000294  2c01              CMP      r4,#1                 ;270
000296  d008              BEQ      |L1.682|
;;;305    	data[1]=LPC_RTC->MONTH;
;;;306    	data[2]=LPC_RTC->DOM;
;;;307    	data[3]=0;
;;;308    	lc640_write_long_ptr(lc640_adr+8,data);
;;;309    
;;;310    	data[0]=LPC_RTC->HOUR;
;;;311    	data[1]=LPC_RTC->MIN;
;;;312    	data[2]=LPC_RTC->SEC;
;;;313    	data[3]=0;
;;;314    	lc640_write_long_ptr(lc640_adr+12,data);
;;;315    	
;;;316    	data[0]='A';
;;;317    	data[1]='A';
;;;318    	data[2]='A';
;;;319    	data[3]='A';
;;;320    	lc640_write_long_ptr(lc640_adr+16,data);
;;;321    	
;;;322    	data[0]='A';
;;;323    	data[1]='A';
;;;324    	data[2]='A';
;;;325    	data[3]='A';
;;;326    	lc640_write_long_ptr(lc640_adr+20,data);
;;;327    	
;;;328    	data[0]='A';
;;;329    	data[1]='A';
;;;330    	data[2]='A';
;;;331    	data[3]='A';
;;;332    	lc640_write_long_ptr(lc640_adr+24,data);
;;;333    	
;;;334    	data[0]='A';
;;;335    	data[1]='A';
;;;336    	data[2]='A';
;;;337    	data[3]='A';
;;;338    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;339    	
;;;340    /*	memo_out0[0]=0x55;
;;;341         memo_out0[1]=0x00+2;
;;;342         memo_out0[2]=1;
;;;343         memo_out0[3]=0x0b;
;;;344         memo_out0[4]=0x55;
;;;345         memo_out0[5]=0x55; 
;;;346         	
;;;347         memo_out0[6]=crc_87(memo_out0,6);
;;;348    	memo_out0[7]=crc_95(memo_out0,6);
;;;349         usart_out_adr0(memo_out0,8); 
;;;350    	*/
;;;351    	snmp_trap_send("Main power alarm, voltage reduced",2,1,0);
;;;352    	}
;;;353    
;;;354    else if(in==2)
;;;355    	{
;;;356    	net_av|=2;	  //o_10
;;;357    
;;;358    	//beep_init(0x01L,'O');
;;;359    	//a.av.bAN=1;
;;;360    
;;;361    
;;;362    	//beep_init(0x33333333,'A');
;;;363    	 
;;;364    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;365    	event_ptr++;	
;;;366    	if(event_ptr>63)event_ptr=0;	
;;;367    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;368    	
;;;369         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;370    	if(event_cnt!=63)event_cnt=event_ptr;
;;;371    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;372    	
;;;373    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;374    	
;;;375    	data[0]='P';
;;;376    	data[1]=0;
;;;377    	data[2]='B';
000298  f04f0942          MOV      r9,#0x42
00029c  2c02              CMP      r4,#2                 ;354
00029e  d07d              BEQ      |L1.924|
;;;378    	data[3]=0;
;;;379    	lc640_write_long_ptr(lc640_adr,data);
;;;380    
;;;381    	data[0]=0;//*((char*)&Unet_store);
;;;382    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;383    	data[2]=0;
;;;384    	data[3]=0;
;;;385    	lc640_write_long_ptr(lc640_adr+4,data);
;;;386    
;;;387    	data[0]=LPC_RTC->YEAR;
;;;388    	data[1]=LPC_RTC->MONTH;
;;;389    	data[2]=LPC_RTC->DOM;
;;;390    	data[3]=0;
;;;391    	lc640_write_long_ptr(lc640_adr+8,data);
;;;392    
;;;393    	data[0]=LPC_RTC->HOUR;
;;;394    	data[1]=LPC_RTC->MIN;
;;;395    	data[2]=LPC_RTC->SEC;
;;;396    	data[3]=0;
;;;397    	lc640_write_long_ptr(lc640_adr+12,data);
;;;398    	
;;;399    	data[0]='A';
;;;400    	data[1]='A';
;;;401    	data[2]='A';
;;;402    	data[3]='A';
;;;403    	lc640_write_long_ptr(lc640_adr+16,data);
;;;404    	
;;;405    	data[0]='A';
;;;406    	data[1]='A';
;;;407    	data[2]='A';
;;;408    	data[3]='A';
;;;409    	lc640_write_long_ptr(lc640_adr+20,data);
;;;410    	
;;;411    	data[0]='A';
;;;412    	data[1]='A';
;;;413    	data[2]='A';
;;;414    	data[3]='A';
;;;415    	lc640_write_long_ptr(lc640_adr+24,data);
;;;416    	
;;;417    	data[0]='A';
;;;418    	data[1]='A';
;;;419    	data[2]='A';
;;;420    	data[3]='A';
;;;421    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;422    	
;;;423    	snmp_trap_send("Main power alarm, voltage increased",2,2,0);
;;;424    	}
;;;425    //o_10_s
;;;426    else if(in==0 || in==4)	
0002a0  2c00              CMP      r4,#0
                  |L1.674|
0002a2  d07c              BEQ      |L1.926|
0002a4  2c04              CMP      r4,#4
0002a6  d0fc              BEQ      |L1.674|
0002a8  e1fd              B        |L1.1702|
                  |L1.682|
0002aa  f0400001          ORR      r0,r0,#1              ;272
0002ae  7008              STRB     r0,[r1,#0]            ;272
0002b0  485e              LDR      r0,|L1.1068|
0002b2  f44f6196          MOV      r1,#0x4b0             ;273
0002b6  8001              STRH     r1,[r0,#0]            ;273
0002b8  4614              MOV      r4,r2                 ;281
0002ba  4620              MOV      r0,r4                 ;281
0002bc  f7fffffe          BL       lc640_read_int
0002c0  f1000001          ADD      r0,r0,#1              ;282
0002c4  4681              MOV      r9,r0                 ;282
0002c6  f1b90f3f          CMP      r9,#0x3f              ;283
0002ca  d901              BLS      |L1.720|
0002cc  f04f0900          MOV      r9,#0                 ;283
                  |L1.720|
0002d0  fa0ff189          SXTH     r1,r9                 ;284
0002d4  4620              MOV      r0,r4                 ;284
0002d6  f7fffffe          BL       lc640_write_int
0002da  4650              MOV      r0,r10                ;286
0002dc  f7fffffe          BL       lc640_read_int
0002e0  283f              CMP      r0,#0x3f              ;287
0002e2  d000              BEQ      |L1.742|
0002e4  4648              MOV      r0,r9                 ;287
                  |L1.742|
0002e6  b201              SXTH     r1,r0                 ;288
0002e8  4650              MOV      r0,r10                ;288
0002ea  f7fffffe          BL       lc640_write_int
0002ee  4620              MOV      r0,r4                 ;290
0002f0  f7fffffe          BL       lc640_read_int
0002f4  eb071440          ADD      r4,r7,r0,LSL #5       ;290
0002f8  f88db000          STRB     r11,[sp,#0]           ;292
0002fc  f88d6001          STRB     r6,[sp,#1]            ;293
000300  f88d8002          STRB     r8,[sp,#2]            ;294
000304  f88d6003          STRB     r6,[sp,#3]            ;295
000308  4669              MOV      r1,sp                 ;296
00030a  4620              MOV      r0,r4                 ;296
00030c  f7fffffe          BL       lc640_write_long_ptr
000310  9600              STR      r6,[sp,#0]            ;301
000312  4669              MOV      r1,sp                 ;302
000314  1d20              ADDS     r0,r4,#4              ;302
000316  f7fffffe          BL       lc640_write_long_ptr
00031a  f1050520          ADD      r5,r5,#0x20           ;304
00031e  8ba8              LDRH     r0,[r5,#0x1c]         ;304
000320  f88d0000          STRB     r0,[sp,#0]            ;304
000324  7e28              LDRB     r0,[r5,#0x18]         ;305
000326  f88d0001          STRB     r0,[sp,#1]            ;305
00032a  7b28              LDRB     r0,[r5,#0xc]          ;306
00032c  f88d0002          STRB     r0,[sp,#2]            ;306
000330  f88d6003          STRB     r6,[sp,#3]            ;307
000334  4669              MOV      r1,sp                 ;308
000336  f1040008          ADD      r0,r4,#8              ;308
00033a  f7fffffe          BL       lc640_write_long_ptr
00033e  7a28              LDRB     r0,[r5,#8]            ;310
000340  f88d0000          STRB     r0,[sp,#0]            ;310
000344  7928              LDRB     r0,[r5,#4]            ;311
000346  f88d0001          STRB     r0,[sp,#1]            ;311
00034a  7828              LDRB     r0,[r5,#0]            ;312
00034c  f88d0002          STRB     r0,[sp,#2]            ;312
000350  f88d6003          STRB     r6,[sp,#3]            ;313
000354  4669              MOV      r1,sp                 ;314
000356  f104000c          ADD      r0,r4,#0xc            ;314
00035a  f7fffffe          BL       lc640_write_long_ptr
00035e  f88d8000          STRB     r8,[sp,#0]            ;316
000362  f88d8001          STRB     r8,[sp,#1]            ;317
000366  f88d8002          STRB     r8,[sp,#2]            ;318
00036a  f88d8003          STRB     r8,[sp,#3]            ;319
00036e  4669              MOV      r1,sp                 ;320
000370  f1040010          ADD      r0,r4,#0x10           ;320
000374  f7fffffe          BL       lc640_write_long_ptr
000378  f88d8000          STRB     r8,[sp,#0]            ;322
00037c  f88d8001          STRB     r8,[sp,#1]            ;323
000380  f88d8002          STRB     r8,[sp,#2]            ;324
000384  f88d8003          STRB     r8,[sp,#3]            ;325
000388  4669              MOV      r1,sp                 ;326
00038a  f1040014          ADD      r0,r4,#0x14           ;326
00038e  f7fffffe          BL       lc640_write_long_ptr
000392  f88d8000          STRB     r8,[sp,#0]            ;328
000396  f88d8001          STRB     r8,[sp,#1]            ;329
00039a  e001              B        |L1.928|
                  |L1.924|
00039c  e01d              B        |L1.986|
                  |L1.926|
00039e  e0d9              B        |L1.1364|
                  |L1.928|
0003a0  f88d8002          STRB     r8,[sp,#2]            ;330
0003a4  f88d8003          STRB     r8,[sp,#3]            ;331
0003a8  4669              MOV      r1,sp                 ;332
0003aa  f1040018          ADD      r0,r4,#0x18           ;332
0003ae  f7fffffe          BL       lc640_write_long_ptr
0003b2  f88d8000          STRB     r8,[sp,#0]            ;334
0003b6  f88d8001          STRB     r8,[sp,#1]            ;335
0003ba  f88d8002          STRB     r8,[sp,#2]            ;336
0003be  f88d8003          STRB     r8,[sp,#3]            ;337
0003c2  4669              MOV      r1,sp                 ;338
0003c4  f104001c          ADD      r0,r4,#0x1c           ;338
0003c8  f7fffffe          BL       lc640_write_long_ptr
0003cc  2300              MOVS     r3,#0                 ;351
0003ce  2201              MOVS     r2,#1                 ;351
0003d0  2102              MOVS     r1,#2                 ;351
0003d2  a017              ADR      r0,|L1.1072|
0003d4  f7fffffe          BL       snmp_trap_send
0003d8  e165              B        |L1.1702|
                  |L1.986|
0003da  f0400002          ORR      r0,r0,#2              ;356
0003de  7008              STRB     r0,[r1,#0]            ;356
0003e0  f44f6060          MOV      r0,#0xe00             ;364
0003e4  f7fffffe          BL       lc640_read_int
0003e8  f1000001          ADD      r0,r0,#1              ;365
0003ec  4604              MOV      r4,r0                 ;365
0003ee  2c3f              CMP      r4,#0x3f              ;366
0003f0  d901              BLS      |L1.1014|
0003f2  f04f0400          MOV      r4,#0                 ;366
                  |L1.1014|
0003f6  b221              SXTH     r1,r4                 ;367
0003f8  f44f6060          MOV      r0,#0xe00             ;367
0003fc  e02a              B        |L1.1108|
0003fe  0000              DCW      0x0000
                  |L1.1024|
                          DCD      net_av
                  |L1.1028|
                          DCD      ||.data||
                  |L1.1032|
                          DCD      bps
                  |L1.1036|
                          DCD      AV_OFF_AVT
                  |L1.1040|
                          DCD      0xeffffffe
                  |L1.1044|
                          DCD      SK_ZVUK_EN
                  |L1.1048|
                          DCD      status_izm_r
                  |L1.1052|
                          DCD      sk_alarm
                  |L1.1056|
                          DCD      0x40024020
                  |L1.1060|
                          DCD      0x400fc000
                  |L1.1064|
                          DCD      0x40024000
                  |L1.1068|
                          DCD      net_av_2min_timer
                  |L1.1072|
000430  4d61696e          DCB      "Main power alarm, voltage reduced",0
000434  20706f77
000438  65722061
00043c  6c61726d
000440  2c20766f
000444  6c746167
000448  65207265
00044c  64756365
000450  6400    
000452  00                DCB      0
000453  00                DCB      0
                  |L1.1108|
000454  f7fffffe          BL       lc640_write_int
000458  4650              MOV      r0,r10                ;369
00045a  f7fffffe          BL       lc640_read_int
00045e  283f              CMP      r0,#0x3f              ;370
000460  d000              BEQ      |L1.1124|
000462  4620              MOV      r0,r4                 ;370
                  |L1.1124|
000464  b201              SXTH     r1,r0                 ;371
000466  4650              MOV      r0,r10                ;371
000468  f7fffffe          BL       lc640_write_int
00046c  f44f6060          MOV      r0,#0xe00             ;373
000470  f7fffffe          BL       lc640_read_int
000474  eb071440          ADD      r4,r7,r0,LSL #5       ;373
000478  f88db000          STRB     r11,[sp,#0]           ;375
00047c  f88d6001          STRB     r6,[sp,#1]            ;376
000480  f88d9002          STRB     r9,[sp,#2]            ;377
000484  f88d6003          STRB     r6,[sp,#3]            ;378
000488  4669              MOV      r1,sp                 ;379
00048a  4620              MOV      r0,r4                 ;379
00048c  f7fffffe          BL       lc640_write_long_ptr
000490  9600              STR      r6,[sp,#0]            ;384
000492  4669              MOV      r1,sp                 ;385
000494  1d20              ADDS     r0,r4,#4              ;385
000496  f7fffffe          BL       lc640_write_long_ptr
00049a  f1050520          ADD      r5,r5,#0x20           ;387
00049e  8ba8              LDRH     r0,[r5,#0x1c]         ;387
0004a0  f88d0000          STRB     r0,[sp,#0]            ;387
0004a4  7e28              LDRB     r0,[r5,#0x18]         ;388
0004a6  f88d0001          STRB     r0,[sp,#1]            ;388
0004aa  7b28              LDRB     r0,[r5,#0xc]          ;389
0004ac  f88d0002          STRB     r0,[sp,#2]            ;389
0004b0  f88d6003          STRB     r6,[sp,#3]            ;390
0004b4  4669              MOV      r1,sp                 ;391
0004b6  f1040008          ADD      r0,r4,#8              ;391
0004ba  f7fffffe          BL       lc640_write_long_ptr
0004be  7a28              LDRB     r0,[r5,#8]            ;393
0004c0  f88d0000          STRB     r0,[sp,#0]            ;393
0004c4  7928              LDRB     r0,[r5,#4]            ;394
0004c6  f88d0001          STRB     r0,[sp,#1]            ;394
0004ca  7828              LDRB     r0,[r5,#0]            ;395
0004cc  f88d0002          STRB     r0,[sp,#2]            ;395
0004d0  f88d6003          STRB     r6,[sp,#3]            ;396
0004d4  4669              MOV      r1,sp                 ;397
0004d6  f104000c          ADD      r0,r4,#0xc            ;397
0004da  f7fffffe          BL       lc640_write_long_ptr
0004de  f88d8000          STRB     r8,[sp,#0]            ;399
0004e2  f88d8001          STRB     r8,[sp,#1]            ;400
0004e6  f88d8002          STRB     r8,[sp,#2]            ;401
0004ea  f88d8003          STRB     r8,[sp,#3]            ;402
0004ee  4669              MOV      r1,sp                 ;403
0004f0  f1040010          ADD      r0,r4,#0x10           ;403
0004f4  f7fffffe          BL       lc640_write_long_ptr
0004f8  f88d8000          STRB     r8,[sp,#0]            ;405
0004fc  f88d8001          STRB     r8,[sp,#1]            ;406
000500  f88d8002          STRB     r8,[sp,#2]            ;407
000504  f88d8003          STRB     r8,[sp,#3]            ;408
000508  4669              MOV      r1,sp                 ;409
00050a  f1040014          ADD      r0,r4,#0x14           ;409
00050e  f7fffffe          BL       lc640_write_long_ptr
000512  f88d8000          STRB     r8,[sp,#0]            ;411
000516  f88d8001          STRB     r8,[sp,#1]            ;412
00051a  f88d8002          STRB     r8,[sp,#2]            ;413
00051e  f88d8003          STRB     r8,[sp,#3]            ;414
000522  4669              MOV      r1,sp                 ;415
000524  f1040018          ADD      r0,r4,#0x18           ;415
000528  f7fffffe          BL       lc640_write_long_ptr
00052c  f88d8000          STRB     r8,[sp,#0]            ;417
000530  f88d8001          STRB     r8,[sp,#1]            ;418
000534  f88d8002          STRB     r8,[sp,#2]            ;419
000538  f88d8003          STRB     r8,[sp,#3]            ;420
00053c  4669              MOV      r1,sp                 ;421
00053e  f104001c          ADD      r0,r4,#0x1c           ;421
000542  f7fffffe          BL       lc640_write_long_ptr
000546  2202              MOVS     r2,#2                 ;423
000548  2300              MOVS     r3,#0                 ;423
00054a  4611              MOV      r1,r2                 ;423
00054c  a0fd              ADR      r0,|L1.2372|
00054e  f7fffffe          BL       snmp_trap_send
000552  e0a8              B        |L1.1702|
                  |L1.1364|
;;;427    	{
;;;428    //	if( (in==0 && (net_av&2)==0) || (in==4 && (net_av&1)==0) )  {
;;;429    		if(in==0) net_av&=~1;
000554  b914              CBNZ     r4,|L1.1372|
000556  f0200001          BIC      r0,r0,#1
00055a  7008              STRB     r0,[r1,#0]
                  |L1.1372|
;;;430    		if(in==4) net_av&=~2;	 
00055c  2c04              CMP      r4,#4
00055e  d103              BNE      |L1.1384|
000560  7808              LDRB     r0,[r1,#0]  ; net_av
000562  f0200002          BIC      r0,r0,#2
000566  7008              STRB     r0,[r1,#0]
                  |L1.1384|
;;;431    		if(net_av==0) if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
000568  7809              LDRB     r1,[r1,#0]  ; net_av
00056a  48ff              LDR      r0,|L1.2408|
00056c  b931              CBNZ     r1,|L1.1404|
00056e  49ff              LDR      r1,|L1.2412|
000570  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
000572  b119              CBZ      r1,|L1.1404|
000574  68c1              LDR      r1,[r0,#0xc]  ; avar_ind_stat
000576  f0210101          BIC      r1,r1,#1
00057a  60c1              STR      r1,[r0,#0xc]  ; avar_ind_stat
                  |L1.1404|
;;;432    
;;;433    	SET_REG(avar_stat,0,0,1);
00057c  6881              LDR      r1,[r0,#8]  ; avar_stat
00057e  f0210101          BIC      r1,r1,#1
000582  6081              STR      r1,[r0,#8]  ; avar_stat
;;;434    	
;;;435    	
;;;436    //}
;;;437    //o_10_e
;;;438    
;;;439         event_ptr=lc640_read_int(PTR_EVENT_LOG);
000584  4610              MOV      r0,r2
000586  f7fffffe          BL       lc640_read_int
00058a  4683              MOV      r11,r0
;;;440    	event_ptr_find=event_ptr;
00058c  46d8              MOV      r8,r11
                  |L1.1422|
;;;441    avar_unet_hndl_lbl1:
;;;442    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
00058e  eb071a48          ADD      r10,r7,r8,LSL #5
;;;443    
;;;444         lc640_read_long_ptr(lc640_adr,data);
000592  4669              MOV      r1,sp
000594  4650              MOV      r0,r10
000596  f7fffffe          BL       lc640_read_long_ptr
;;;445         
;;;446         if( !( (data[0]=='P')&&(data[1]==0)&&( (in==0 && data[2]=='A' )||(in==4 && data[2]=='B') ) ) )	//o_10
00059a  f89d0000          LDRB     r0,[sp,#0]
00059e  2850              CMP      r0,#0x50
0005a0  d10f              BNE      |L1.1474|
0005a2  f89d0001          LDRB     r0,[sp,#1]
0005a6  b960              CBNZ     r0,|L1.1474|
0005a8  b114              CBZ      r4,|L1.1456|
0005aa  2c04              CMP      r4,#4
0005ac  d109              BNE      |L1.1474|
0005ae  e004              B        |L1.1466|
                  |L1.1456|
0005b0  f89d0002          LDRB     r0,[sp,#2]
0005b4  2841              CMP      r0,#0x41
0005b6  d104              BNE      |L1.1474|
0005b8  e00e              B        |L1.1496|
                  |L1.1466|
0005ba  f89d0002          LDRB     r0,[sp,#2]
0005be  2842              CMP      r0,#0x42
0005c0  d00a              BEQ      |L1.1496|
                  |L1.1474|
;;;447         	{        
;;;448         	if(event_ptr_find)event_ptr_find--;
0005c2  f1b80f00          CMP      r8,#0
0005c6  d002              BEQ      |L1.1486|
0005c8  f1a80801          SUB      r8,r8,#1
0005cc  e001              B        |L1.1490|
                  |L1.1486|
;;;449         	else event_ptr_find=63;
0005ce  f04f083f          MOV      r8,#0x3f
                  |L1.1490|
;;;450         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0005d2  45d8              CMP      r8,r11
0005d4  d1db              BNE      |L1.1422|
0005d6  e066              B        |L1.1702|
                  |L1.1496|
;;;451         	else goto avar_unet_hndl_lbl1;
;;;452         	}
;;;453         else 
;;;454         	{
;;;455         	lc640_read_long_ptr(lc640_adr+16,data);
0005d8  4669              MOV      r1,sp
0005da  f10a0010          ADD      r0,r10,#0x10
0005de  f7fffffe          BL       lc640_read_long_ptr
;;;456         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0005e2  f89d0000          LDRB     r0,[sp,#0]
0005e6  2841              CMP      r0,#0x41
0005e8  d10b              BNE      |L1.1538|
0005ea  f89d0001          LDRB     r0,[sp,#1]
0005ee  2841              CMP      r0,#0x41
0005f0  d107              BNE      |L1.1538|
0005f2  f89d0002          LDRB     r0,[sp,#2]
0005f6  2841              CMP      r0,#0x41
0005f8  d103              BNE      |L1.1538|
0005fa  f89d0003          LDRB     r0,[sp,#3]
0005fe  2841              CMP      r0,#0x41
000600  d00a              BEQ      |L1.1560|
                  |L1.1538|
;;;457         		{        
;;;458         		if(event_ptr_find)event_ptr_find--;
000602  f1b80f00          CMP      r8,#0
000606  d002              BEQ      |L1.1550|
000608  f1a80801          SUB      r8,r8,#1
00060c  e001              B        |L1.1554|
                  |L1.1550|
;;;459             		else event_ptr_find=63;
00060e  f04f083f          MOV      r8,#0x3f
                  |L1.1554|
;;;460             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000612  45d8              CMP      r8,r11
000614  d1bb              BNE      |L1.1422|
000616  e046              B        |L1.1702|
                  |L1.1560|
;;;461         		else goto avar_unet_hndl_lbl1;
;;;462         		}
;;;463    
;;;464         	}	
;;;465    	
;;;466    	data[0]=LPC_RTC->YEAR;
000618  f1050520          ADD      r5,r5,#0x20
00061c  8ba8              LDRH     r0,[r5,#0x1c]
00061e  f88d0000          STRB     r0,[sp,#0]
;;;467    	data[1]=LPC_RTC->MONTH;
000622  7e28              LDRB     r0,[r5,#0x18]
000624  f88d0001          STRB     r0,[sp,#1]
;;;468    	data[2]=LPC_RTC->DOM;
000628  7b28              LDRB     r0,[r5,#0xc]
00062a  f88d0002          STRB     r0,[sp,#2]
;;;469    	data[3]=0;
00062e  f88d6003          STRB     r6,[sp,#3]
;;;470    	lc640_write_long_ptr(lc640_adr+16,data);
000632  4669              MOV      r1,sp
000634  f10a0010          ADD      r0,r10,#0x10
000638  f7fffffe          BL       lc640_write_long_ptr
;;;471    
;;;472    	data[0]=LPC_RTC->HOUR;
00063c  7a28              LDRB     r0,[r5,#8]
00063e  f88d0000          STRB     r0,[sp,#0]
;;;473    	data[1]=LPC_RTC->MIN;
000642  7928              LDRB     r0,[r5,#4]
000644  f88d0001          STRB     r0,[sp,#1]
;;;474    	data[2]=LPC_RTC->SEC;
000648  7828              LDRB     r0,[r5,#0]
00064a  f88d0002          STRB     r0,[sp,#2]
;;;475    	data[3]=0;
00064e  f88d6003          STRB     r6,[sp,#3]
;;;476    	lc640_write_long_ptr(lc640_adr+20,data); 
000652  4669              MOV      r1,sp
000654  f10a0014          ADD      r0,r10,#0x14
000658  f7fffffe          BL       lc640_write_long_ptr
;;;477    	
;;;478    	//o_10_s
;;;479    	if(in==4) {
00065c  2c04              CMP      r4,#4
00065e  d025              BEQ      |L1.1708|
;;;480    	   	data[0]=*((char*)(&net_Ustore_max));
;;;481    		data[1]=*(((char*)(&net_Ustore_max))+1);
;;;482    	}else{
;;;483    		data[0]=*((char*)(&net_Ustore));
000660  48c3              LDR      r0,|L1.2416|
000662  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000664  f88d1000          STRB     r1,[sp,#0]
;;;484    		data[1]=*(((char*)(&net_Ustore))+1);
000668  7840              LDRB     r0,[r0,#1]  ; net_Ustore
00066a  f88d0001          STRB     r0,[sp,#1]
                  |L1.1646|
;;;485    	}
;;;486    	//o_10_e
;;;487    	data[2]='B';
00066e  f88d9002          STRB     r9,[sp,#2]
;;;488    	data[3]='B';
000672  f88d9003          STRB     r9,[sp,#3]
;;;489    	lc640_write_long_ptr(lc640_adr+24,data);
000676  4669              MOV      r1,sp
000678  f10a0018          ADD      r0,r10,#0x18
00067c  f7fffffe          BL       lc640_write_long_ptr
;;;490    	
;;;491    	data[0]='B';
000680  f88d9000          STRB     r9,[sp,#0]
;;;492    	data[1]='B';
000684  f88d9001          STRB     r9,[sp,#1]
;;;493    	data[2]='B';
000688  f88d9002          STRB     r9,[sp,#2]
;;;494    	data[3]='B';
00068c  f88d9003          STRB     r9,[sp,#3]
;;;495    	lc640_write_long_ptr(lc640_adr+28,data);	
000690  4669              MOV      r1,sp
000692  f10a001c          ADD      r0,r10,#0x1c
000696  f7fffffe          BL       lc640_write_long_ptr
;;;496    	
;;;497    /*	memo_out0[0]=0x55;
;;;498         memo_out0[1]=0x00+2;
;;;499         memo_out0[2]=1;
;;;500         memo_out0[3]=0x0b;
;;;501         memo_out0[4]=0xaa;
;;;502         memo_out0[5]=0xaa; 
;;;503         	
;;;504         memo_out0[6]=crc_87(memo_out0,6);
;;;505    	memo_out0[7]=crc_95(memo_out0,6);
;;;506         usart_out_adr0(memo_out0,8); */
;;;507         snmp_trap_send("Main power alarm  clear",2,1,1);	
00069a  2301              MOVS     r3,#1
00069c  461a              MOV      r2,r3
00069e  2102              MOVS     r1,#2
0006a0  a0b4              ADR      r0,|L1.2420|
0006a2  f7fffffe          BL       snmp_trap_send
                  |L1.1702|
;;;508    	}
;;;509    avar_unet_hndl_end:
;;;510    	__nop();		
0006a6  bf00              NOP      
                  |L1.1704|
;;;511    }
0006a8  e8bd8ff8          POP      {r3-r11,pc}
                  |L1.1708|
0006ac  48b7              LDR      r0,|L1.2444|
0006ae  7801              LDRB     r1,[r0,#0]            ;480  ; net_Ustore_max
0006b0  f88d1000          STRB     r1,[sp,#0]            ;480
0006b4  7840              LDRB     r0,[r0,#1]            ;481  ; net_Ustore_max
0006b6  f88d0001          STRB     r0,[sp,#1]            ;481
0006ba  e7d8              B        |L1.1646|
;;;512    
                          ENDP

                  avar_uout_hndl PROC
;;;514    //-----------------------------------------------
;;;515    void avar_uout_hndl(char in)
0006bc  e92d4ff8          PUSH     {r3-r11,lr}
;;;516    {
;;;517    
;;;518    char data[4];
;;;519    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;520    char avar_data=0;
;;;521    
;;;522    if(in==1)
;;;523    	{
;;;524    	//net_av=1;
;;;525    
;;;526    	//beep_init(0x01L,'O');
;;;527    	//a.av.bAN=1;
;;;528    
;;;529    
;;;530    	//beep_init(0x33333333,'A');
;;;531    
;;;532    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;533    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;534    	
;;;535    	avar_data=uout_av;
;;;536    		 
;;;537    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;538    	event_ptr++;	
;;;539    	if(event_ptr>63)event_ptr=0;	
;;;540    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;541    	
;;;542        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;543    	if(event_cnt!=63)event_cnt=event_ptr;
;;;544    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;545    	
;;;546    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;547    	
;;;548    	data[0]='Q';
;;;549    	data[1]=0;
;;;550    	data[2]='A';
;;;551    	data[3]=avar_data;
;;;552    	lc640_write_long_ptr(lc640_adr,data);
;;;553    
;;;554    	 //load_U=4321;
;;;555    
;;;556    	data[0]=*((char*)&load_U);
;;;557    	data[1]=*(((char*)&load_U)+1);
;;;558    	data[2]=0;
;;;559    	data[3]=0;
;;;560    	lc640_write_long_ptr(lc640_adr+4,data);
;;;561    
;;;562    	data[0]=LPC_RTC->YEAR;
0006c0  4fb3              LDR      r7,|L1.2448|
0006c2  49b4              LDR      r1,|L1.2452|
0006c4  f44f6560          MOV      r5,#0xe00             ;537
0006c8  f04f0800          MOV      r8,#0                 ;520
0006cc  f44f6980          MOV      r9,#0x400             ;546
0006d0  2801              CMP      r0,#1                 ;522
0006d2  d002              BEQ      |L1.1754|
;;;563    	data[1]=LPC_RTC->MONTH;
;;;564    	data[2]=LPC_RTC->DOM;
;;;565    	data[3]=0;
;;;566    	lc640_write_long_ptr(lc640_adr+8,data);
;;;567    
;;;568    	data[0]=LPC_RTC->HOUR;
;;;569    	data[1]=LPC_RTC->MIN;
;;;570    	data[2]=LPC_RTC->SEC;
;;;571    	data[3]=0;
;;;572    	lc640_write_long_ptr(lc640_adr+12,data);
;;;573    	
;;;574    	data[0]='A';
;;;575    	data[1]='A';
;;;576    	data[2]='A';
;;;577    	data[3]='A';
;;;578    	lc640_write_long_ptr(lc640_adr+16,data);
;;;579    	
;;;580    	data[0]='A';
;;;581    	data[1]='A';
;;;582    	data[2]='A';
;;;583    	data[3]='A';
;;;584    	lc640_write_long_ptr(lc640_adr+20,data);
;;;585    	
;;;586    	data[0]='A';
;;;587    	data[1]='A';
;;;588    	data[2]='A';
;;;589    	data[3]='A';
;;;590    	lc640_write_long_ptr(lc640_adr+24,data);
;;;591    	
;;;592    	data[0]='A';
;;;593    	data[1]='A';
;;;594    	data[2]='A';
;;;595    	data[3]='A';
;;;596    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;597    	
;;;598    /*	memo_out0[0]=0x55;
;;;599         memo_out0[1]=0x00+2;
;;;600         memo_out0[2]=1;
;;;601         memo_out0[3]=0x0b;
;;;602         memo_out0[4]=0x55;
;;;603         memo_out0[5]=0x55; 
;;;604         	
;;;605         memo_out0[6]=crc_87(memo_out0,6);
;;;606    	memo_out0[7]=crc_95(memo_out0,6);
;;;607         usart_out_adr0(memo_out0,8); 
;;;608    	*/
;;;609    	//snmp_trap_send("Main power is off",2,1,0);
;;;610    	}
;;;611    
;;;612    else if(in==0)
0006d4  2800              CMP      r0,#0
0006d6  d07d              BEQ      |L1.2004|
0006d8  e132              B        |L1.2368|
                  |L1.1754|
0006da  f8dfa2bc          LDR      r10,|L1.2456|
0006de  4aaf              LDR      r2,|L1.2460|
0006e0  f9ba0000          LDRSH    r0,[r10,#0]           ;532  ; load_U
0006e4  f9b22000          LDRSH    r2,[r2,#0]            ;532  ; U_OUT_KONTR_MAX
0006e8  4290              CMP      r0,r2                 ;532
0006ea  dd02              BLE      |L1.1778|
0006ec  f04f0201          MOV      r2,#1                 ;532
0006f0  700a              STRB     r2,[r1,#0]            ;532
                  |L1.1778|
0006f2  4aab              LDR      r2,|L1.2464|
0006f4  f9b22000          LDRSH    r2,[r2,#0]            ;533  ; U_OUT_KONTR_MIN
0006f8  4290              CMP      r0,r2                 ;533
0006fa  da02              BGE      |L1.1794|
0006fc  f04f0002          MOV      r0,#2                 ;533
000700  7008              STRB     r0,[r1,#0]            ;533
                  |L1.1794|
000702  780e              LDRB     r6,[r1,#0]            ;535  ; uout_av
000704  4628              MOV      r0,r5                 ;537
000706  f7fffffe          BL       lc640_read_int
00070a  f1000001          ADD      r0,r0,#1              ;538
00070e  4604              MOV      r4,r0                 ;538
000710  2c3f              CMP      r4,#0x3f              ;539
000712  d901              BLS      |L1.1816|
000714  f04f0400          MOV      r4,#0                 ;539
                  |L1.1816|
000718  b221              SXTH     r1,r4                 ;540
00071a  4628              MOV      r0,r5                 ;540
00071c  f7fffffe          BL       lc640_write_int
000720  f6406b02          MOV      r11,#0xe02            ;542
000724  4658              MOV      r0,r11                ;542
000726  f7fffffe          BL       lc640_read_int
00072a  283f              CMP      r0,#0x3f              ;543
00072c  d000              BEQ      |L1.1840|
00072e  4620              MOV      r0,r4                 ;543
                  |L1.1840|
000730  b201              SXTH     r1,r0                 ;544
000732  4658              MOV      r0,r11                ;544
000734  f7fffffe          BL       lc640_write_int
000738  4628              MOV      r0,r5                 ;546
00073a  f7fffffe          BL       lc640_read_int
00073e  eb091540          ADD      r5,r9,r0,LSL #5       ;546
000742  f04f0051          MOV      r0,#0x51              ;548
000746  f88d0000          STRB     r0,[sp,#0]            ;548
00074a  f88d8001          STRB     r8,[sp,#1]            ;549
00074e  f04f0441          MOV      r4,#0x41              ;550
000752  f88d4002          STRB     r4,[sp,#2]            ;550
000756  f88d6003          STRB     r6,[sp,#3]            ;551
00075a  4669              MOV      r1,sp                 ;552
00075c  4628              MOV      r0,r5                 ;552
00075e  f7fffffe          BL       lc640_write_long_ptr
000762  f89a0000          LDRB     r0,[r10,#0]           ;556  ; load_U
000766  f88d0000          STRB     r0,[sp,#0]            ;556
00076a  f89a0001          LDRB     r0,[r10,#1]           ;557  ; load_U
00076e  f88d0001          STRB     r0,[sp,#1]            ;557
000772  f88d8002          STRB     r8,[sp,#2]            ;558
000776  f88d8003          STRB     r8,[sp,#3]            ;559
00077a  4669              MOV      r1,sp                 ;560
00077c  1d28              ADDS     r0,r5,#4              ;560
00077e  f7fffffe          BL       lc640_write_long_ptr
000782  f1070720          ADD      r7,r7,#0x20           ;562
000786  8bb8              LDRH     r0,[r7,#0x1c]         ;562
000788  f88d0000          STRB     r0,[sp,#0]            ;562
00078c  7e38              LDRB     r0,[r7,#0x18]         ;563
00078e  f88d0001          STRB     r0,[sp,#1]            ;563
000792  7b38              LDRB     r0,[r7,#0xc]          ;564
000794  f88d0002          STRB     r0,[sp,#2]            ;564
000798  f88d8003          STRB     r8,[sp,#3]            ;565
00079c  4669              MOV      r1,sp                 ;566
00079e  f1050008          ADD      r0,r5,#8              ;566
0007a2  f7fffffe          BL       lc640_write_long_ptr
0007a6  7a38              LDRB     r0,[r7,#8]            ;568
0007a8  f88d0000          STRB     r0,[sp,#0]            ;568
0007ac  7938              LDRB     r0,[r7,#4]            ;569
0007ae  f88d0001          STRB     r0,[sp,#1]            ;569
0007b2  7838              LDRB     r0,[r7,#0]            ;570
0007b4  f88d0002          STRB     r0,[sp,#2]            ;570
0007b8  f88d8003          STRB     r8,[sp,#3]            ;571
0007bc  4669              MOV      r1,sp                 ;572
0007be  f105000c          ADD      r0,r5,#0xc            ;572
0007c2  f7fffffe          BL       lc640_write_long_ptr
0007c6  f88d4000          STRB     r4,[sp,#0]            ;574
0007ca  f88d4001          STRB     r4,[sp,#1]            ;575
0007ce  f88d4002          STRB     r4,[sp,#2]            ;576
0007d2  e000              B        |L1.2006|
                  |L1.2004|
0007d4  e02e              B        |L1.2100|
                  |L1.2006|
0007d6  f88d4003          STRB     r4,[sp,#3]            ;577
0007da  4669              MOV      r1,sp                 ;578
0007dc  f1050010          ADD      r0,r5,#0x10           ;578
0007e0  f7fffffe          BL       lc640_write_long_ptr
0007e4  f88d4000          STRB     r4,[sp,#0]            ;580
0007e8  f88d4001          STRB     r4,[sp,#1]            ;581
0007ec  f88d4002          STRB     r4,[sp,#2]            ;582
0007f0  f88d4003          STRB     r4,[sp,#3]            ;583
0007f4  4669              MOV      r1,sp                 ;584
0007f6  f1050014          ADD      r0,r5,#0x14           ;584
0007fa  f7fffffe          BL       lc640_write_long_ptr
0007fe  f88d4000          STRB     r4,[sp,#0]            ;586
000802  f88d4001          STRB     r4,[sp,#1]            ;587
000806  f88d4002          STRB     r4,[sp,#2]            ;588
00080a  f88d4003          STRB     r4,[sp,#3]            ;589
00080e  4669              MOV      r1,sp                 ;590
000810  f1050018          ADD      r0,r5,#0x18           ;590
000814  f7fffffe          BL       lc640_write_long_ptr
000818  f88d4000          STRB     r4,[sp,#0]            ;592
00081c  f88d4001          STRB     r4,[sp,#1]            ;593
000820  f88d4002          STRB     r4,[sp,#2]            ;594
000824  f88d4003          STRB     r4,[sp,#3]            ;595
000828  4669              MOV      r1,sp                 ;596
00082a  f105001c          ADD      r0,r5,#0x1c           ;596
00082e  f7fffffe          BL       lc640_write_long_ptr
000832  e085              B        |L1.2368|
                  |L1.2100|
;;;613    	{
;;;614    	uout_av=0;
000834  f8818000          STRB     r8,[r1,#0]
;;;615    
;;;616      /*
;;;617    	SET_REG(C2GSR,3,24,8);
;;;618    	C2MOD=0;
;;;619    	bOUT_FREE2=1;*/
;;;620    
;;;621    
;;;622    	//C2MOD=0;
;;;623    
;;;624    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;625    
;;;626         //beep_init(0x02L,'O');
;;;627    	//a_.av.bAN=0;
;;;628    //	SET_REG(avar_stat,0,0,1);
;;;629    
;;;630    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;631    	
;;;632    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;633    
;;;634        event_ptr=lc640_read_int(PTR_EVENT_LOG);
000838  4628              MOV      r0,r5
00083a  f7fffffe          BL       lc640_read_int
00083e  4606              MOV      r6,r0
;;;635    	event_ptr_find=event_ptr;
000840  4634              MOV      r4,r6
                  |L1.2114|
;;;636    avar_uout_hndl_lbl1:
;;;637    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000842  eb091544          ADD      r5,r9,r4,LSL #5
;;;638    
;;;639         lc640_read_long_ptr(lc640_adr,data);
000846  4669              MOV      r1,sp
000848  4628              MOV      r0,r5
00084a  f7fffffe          BL       lc640_read_long_ptr
;;;640         
;;;641         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
00084e  f89d0000          LDRB     r0,[sp,#0]
000852  2851              CMP      r0,#0x51
000854  d106              BNE      |L1.2148|
000856  f89d0001          LDRB     r0,[sp,#1]
00085a  b918              CBNZ     r0,|L1.2148|
00085c  f89d0002          LDRB     r0,[sp,#2]
000860  2841              CMP      r0,#0x41
000862  d008              BEQ      |L1.2166|
                  |L1.2148|
;;;642         	{        
;;;643         	if(event_ptr_find)event_ptr_find--;
000864  b114              CBZ      r4,|L1.2156|
000866  f1a40401          SUB      r4,r4,#1
00086a  e001              B        |L1.2160|
                  |L1.2156|
;;;644         	else event_ptr_find=63;
00086c  f04f043f          MOV      r4,#0x3f
                  |L1.2160|
;;;645         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000870  42b4              CMP      r4,r6
000872  d1e6              BNE      |L1.2114|
000874  e064              B        |L1.2368|
                  |L1.2166|
;;;646         	else goto avar_uout_hndl_lbl1;
;;;647         	}
;;;648         else 
;;;649         	{
;;;650         	lc640_read_long_ptr(lc640_adr+16,data);
000876  4669              MOV      r1,sp
000878  f1050010          ADD      r0,r5,#0x10
00087c  f7fffffe          BL       lc640_read_long_ptr
;;;651         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000880  f89d0000          LDRB     r0,[sp,#0]
000884  2841              CMP      r0,#0x41
000886  d10b              BNE      |L1.2208|
000888  f89d0001          LDRB     r0,[sp,#1]
00088c  2841              CMP      r0,#0x41
00088e  d107              BNE      |L1.2208|
000890  f89d0002          LDRB     r0,[sp,#2]
000894  2841              CMP      r0,#0x41
000896  d103              BNE      |L1.2208|
000898  f89d0003          LDRB     r0,[sp,#3]
00089c  2841              CMP      r0,#0x41
00089e  d008              BEQ      |L1.2226|
                  |L1.2208|
;;;652         		{        
;;;653         		if(event_ptr_find)event_ptr_find--;
0008a0  b114              CBZ      r4,|L1.2216|
0008a2  f1a40401          SUB      r4,r4,#1
0008a6  e001              B        |L1.2220|
                  |L1.2216|
;;;654             		else event_ptr_find=63;
0008a8  f04f043f          MOV      r4,#0x3f
                  |L1.2220|
;;;655             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0008ac  42b4              CMP      r4,r6
0008ae  d1c8              BNE      |L1.2114|
0008b0  e046              B        |L1.2368|
                  |L1.2226|
;;;656         		else goto avar_uout_hndl_lbl1;
;;;657         		}
;;;658    
;;;659         	}	
;;;660    	
;;;661    	data[0]=LPC_RTC->YEAR;
0008b2  f1070720          ADD      r7,r7,#0x20
0008b6  8bb8              LDRH     r0,[r7,#0x1c]
0008b8  f88d0000          STRB     r0,[sp,#0]
;;;662    	data[1]=LPC_RTC->MONTH;
0008bc  7e38              LDRB     r0,[r7,#0x18]
0008be  f88d0001          STRB     r0,[sp,#1]
;;;663    	data[2]=LPC_RTC->DOM;
0008c2  7b38              LDRB     r0,[r7,#0xc]
0008c4  f88d0002          STRB     r0,[sp,#2]
;;;664    	data[3]=0;
0008c8  f88d8003          STRB     r8,[sp,#3]
;;;665    	lc640_write_long_ptr(lc640_adr+16,data);
0008cc  4669              MOV      r1,sp
0008ce  f1050010          ADD      r0,r5,#0x10
0008d2  f7fffffe          BL       lc640_write_long_ptr
;;;666    
;;;667    	data[0]=LPC_RTC->HOUR;
0008d6  7a38              LDRB     r0,[r7,#8]
0008d8  f88d0000          STRB     r0,[sp,#0]
;;;668    	data[1]=LPC_RTC->MIN;
0008dc  7938              LDRB     r0,[r7,#4]
0008de  f88d0001          STRB     r0,[sp,#1]
;;;669    	data[2]=LPC_RTC->SEC;
0008e2  7838              LDRB     r0,[r7,#0]
0008e4  f88d0002          STRB     r0,[sp,#2]
;;;670    	data[3]=0;
0008e8  f88d8003          STRB     r8,[sp,#3]
;;;671    	lc640_write_long_ptr(lc640_adr+20,data); 
0008ec  4669              MOV      r1,sp
0008ee  f1050014          ADD      r0,r5,#0x14
0008f2  f7fffffe          BL       lc640_write_long_ptr
;;;672    	
;;;673    	data[0]=*((char*)(&net_Ustore));
0008f6  481e              LDR      r0,|L1.2416|
0008f8  7801              LDRB     r1,[r0,#0]  ; net_Ustore
0008fa  f88d1000          STRB     r1,[sp,#0]
;;;674    	data[1]=*(((char*)(&net_Ustore))+1);
0008fe  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000900  f88d0001          STRB     r0,[sp,#1]
;;;675    	data[2]='B';
000904  f04f0442          MOV      r4,#0x42
000908  f88d4002          STRB     r4,[sp,#2]
;;;676    	data[3]='B';
00090c  f88d4003          STRB     r4,[sp,#3]
;;;677    	lc640_write_long_ptr(lc640_adr+24,data);
000910  4669              MOV      r1,sp
000912  f1050018          ADD      r0,r5,#0x18
000916  f7fffffe          BL       lc640_write_long_ptr
;;;678    	
;;;679    	data[0]='B';
00091a  f88d4000          STRB     r4,[sp,#0]
;;;680    	data[1]='B';
00091e  f88d4001          STRB     r4,[sp,#1]
;;;681    	data[2]='B';
000922  f88d4002          STRB     r4,[sp,#2]
;;;682    	data[3]='B';
000926  f88d4003          STRB     r4,[sp,#3]
;;;683    	lc640_write_long_ptr(lc640_adr+28,data);	
00092a  4669              MOV      r1,sp
00092c  f105001c          ADD      r0,r5,#0x1c
000930  f7fffffe          BL       lc640_write_long_ptr
;;;684    	
;;;685    /*	memo_out0[0]=0x55;
;;;686         memo_out0[1]=0x00+2;
;;;687         memo_out0[2]=1;
;;;688         memo_out0[3]=0x0b;
;;;689         memo_out0[4]=0xaa;
;;;690         memo_out0[5]=0xaa; 
;;;691         	
;;;692         memo_out0[6]=crc_87(memo_out0,6);
;;;693    	memo_out0[7]=crc_95(memo_out0,6);
;;;694         usart_out_adr0(memo_out0,8); */
;;;695         snmp_trap_send("Main power is on",2,1,1);	
000934  2301              MOVS     r3,#1
000936  461a              MOV      r2,r3
000938  2102              MOVS     r1,#2
00093a  a01a              ADR      r0,|L1.2468|
00093c  f7fffffe          BL       snmp_trap_send
                  |L1.2368|
;;;696    	}
;;;697    avar_unet_hndl_end:
;;;698    	__nop();		
000940  bf00              NOP      
;;;699    }
000942  e6b1              B        |L1.1704|
                  |L1.2372|
000944  4d61696e          DCB      "Main power alarm, voltage increased",0
000948  20706f77
00094c  65722061
000950  6c61726d
000954  2c20766f
000958  6c746167
00095c  6520696e
000960  63726561
000964  73656400
                  |L1.2408|
                          DCD      ||.data||
                  |L1.2412|
                          DCD      AV_OFF_AVT
                  |L1.2416|
                          DCD      net_Ustore
                  |L1.2420|
000974  4d61696e          DCB      "Main power alarm  clear",0
000978  20706f77
00097c  65722061
000980  6c61726d
000984  2020636c
000988  65617200
                  |L1.2444|
                          DCD      net_Ustore_max
                  |L1.2448|
                          DCD      0x40024000
                  |L1.2452|
                          DCD      uout_av
                  |L1.2456|
                          DCD      load_U
                  |L1.2460|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2464|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2468|
0009a4  4d61696e          DCB      "Main power is on",0
0009a8  20706f77
0009ac  65722069
0009b0  73206f6e
0009b4  00      
0009b5  00                DCB      0
0009b6  00                DCB      0
0009b7  00                DCB      0
                          ENDP

                  avar_bps_hndl PROC
;;;701    //-----------------------------------------------
;;;702    void avar_bps_hndl(char dev, char v, char in)
0009b8  e92d4ff8          PUSH     {r3-r11,lr}
;;;703    {
0009bc  4606              MOV      r6,r0
0009be  460c              MOV      r4,r1
;;;704    char data[4];
;;;705    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;706    char avar_simbol;
;;;707    
;;;708    avar_simbol='T';
0009c0  f04f0754          MOV      r7,#0x54
;;;709    if(v==0)avar_simbol='T';
0009c4  b174              CBZ      r4,|L1.2532|
;;;710    else if(v==1)avar_simbol='U';
0009c6  2c01              CMP      r4,#1
0009c8  d004              BEQ      |L1.2516|
;;;711    else if(v==2)avar_simbol='u';
0009ca  2c02              CMP      r4,#2
0009cc  d005              BEQ      |L1.2522|
;;;712    else if(v==3)avar_simbol='L';
0009ce  2c03              CMP      r4,#3
0009d0  d006              BEQ      |L1.2528|
0009d2  e007              B        |L1.2532|
                  |L1.2516|
0009d4  f04f0755          MOV      r7,#0x55              ;710
0009d8  e004              B        |L1.2532|
                  |L1.2522|
0009da  f04f0775          MOV      r7,#0x75              ;711
0009de  e001              B        |L1.2532|
                  |L1.2528|
0009e0  f04f074c          MOV      r7,#0x4c
                  |L1.2532|
;;;713    
;;;714    if(in==1)
;;;715    	{
;;;716    	//av_src[bps]=1;
;;;717    
;;;718    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;719    //	SET_REG(avar_stat,1,3+dev,1);
;;;720    	
;;;721    	if(v==0)bps[dev]._av|=(1<<0);
;;;722    	else if(v==1) bps[dev]._av|=(1<<1);
;;;723    	else if(v==2) bps[dev]._av|=(1<<2);
;;;724    	else if(v==3) bps[dev]._av|=(1<<3);
;;;725    
;;;726    	bps[dev]._last_avar=v;
;;;727    
;;;728    	//beep_init(0x33333333,'A');
;;;729    
;;;730    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;731    	event_ptr++;	
;;;732    	if(event_ptr>63)event_ptr=0;	
;;;733    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;734    	
;;;735        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;736    	if(event_cnt!=63)event_cnt=event_ptr;
;;;737    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;738    	
;;;739    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;740    	
;;;741    	data[0]='S';
;;;742    	data[1]=dev; 
;;;743    	data[2]=avar_simbol;
;;;744    	data[3]=0;
;;;745    	lc640_write_long_ptr(lc640_adr,data);
;;;746    
;;;747    	data[0]=0;
;;;748    	data[1]=0;
;;;749    	data[2]=0;
;;;750    	data[3]=0;
;;;751    	lc640_write_long_ptr(lc640_adr+4,data);
;;;752    
;;;753    	data[0]=LPC_RTC->YEAR;
0009e4  f8df8400          LDR      r8,|L1.3560|
0009e8  f04f0900          MOV      r9,#0                 ;703
0009ec  48ff              LDR      r0,|L1.3564|
0009ee  eb0601c6          ADD      r1,r6,r6,LSL #3       ;721
0009f2  eb011106          ADD      r1,r1,r6,LSL #4       ;721
0009f6  f44f6a60          MOV      r10,#0xe00            ;730
0009fa  f44f6580          MOV      r5,#0x400             ;739
0009fe  eb000081          ADD      r0,r0,r1,LSL #2       ;721
000a02  2a01              CMP      r2,#1                 ;714
000a04  d002              BEQ      |L1.2572|
;;;754    	data[1]=LPC_RTC->MONTH;
;;;755    	data[2]=LPC_RTC->DOM;
;;;756    	data[3]=0;
;;;757    	lc640_write_long_ptr(lc640_adr+8,data);
;;;758    
;;;759    	data[0]=LPC_RTC->HOUR;
;;;760    	data[1]=LPC_RTC->MIN;
;;;761    	data[2]=LPC_RTC->SEC;
;;;762    	data[3]=0;
;;;763    	lc640_write_long_ptr(lc640_adr+12,data);
;;;764    	
;;;765    	data[0]='A';
;;;766    	data[1]='A';
;;;767    	data[2]='A';
;;;768    	data[3]='A';
;;;769    	lc640_write_long_ptr(lc640_adr+16,data);
;;;770    	
;;;771    	data[0]='A';
;;;772    	data[1]='A';
;;;773    	data[2]='A';
;;;774    	data[3]='A';
;;;775    	lc640_write_long_ptr(lc640_adr+20,data);
;;;776    	
;;;777    	data[0]='A';
;;;778    	data[1]='A';
;;;779    	data[2]='A';
;;;780    	data[3]='A';
;;;781    	lc640_write_long_ptr(lc640_adr+24,data);
;;;782    	
;;;783    	data[0]='A';
;;;784    	data[1]='A';
;;;785    	data[2]='A';
;;;786    	data[3]='A';
;;;787    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;788    
;;;789    
;;;790    	if(dev==0)
;;;791    		{
;;;792    		if(v==0)
;;;793    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;794    		else if(v==1)
;;;795    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;796    		else if(v==2)
;;;797    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;798    		else if(v==3)
;;;799    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;800    		}
;;;801    	else if(dev==1)
;;;802    		{
;;;803    		if(v==0)
;;;804    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;805    		else if(v==1)
;;;806    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;807    		else if(v==2)
;;;808    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;809    		else if(v==3)
;;;810    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;811    		} 
;;;812    	else if(dev==2)
;;;813    		{
;;;814    		if(v==0)
;;;815    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;816    		else if(v==1)
;;;817    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;818    		else if(v==2)
;;;819    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;820    		else if(v==3)
;;;821    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;822    		} 	
;;;823    			
;;;824    	}
;;;825    
;;;826    else if(in==0)
000a06  2a00              CMP      r2,#0
000a08  d07e              BEQ      |L1.2824|
000a0a  e1c4              B        |L1.3478|
                  |L1.2572|
000a0c  b134              CBZ      r4,|L1.2588|
000a0e  2c01              CMP      r4,#1                 ;722
000a10  d009              BEQ      |L1.2598|
000a12  2c02              CMP      r4,#2                 ;723
000a14  d00c              BEQ      |L1.2608|
000a16  2c03              CMP      r4,#3                 ;724
000a18  d00f              BEQ      |L1.2618|
000a1a  e012              B        |L1.2626|
                  |L1.2588|
000a1c  7841              LDRB     r1,[r0,#1]            ;721
000a1e  f0410101          ORR      r1,r1,#1              ;721
000a22  7041              STRB     r1,[r0,#1]            ;721
000a24  e00d              B        |L1.2626|
                  |L1.2598|
000a26  7841              LDRB     r1,[r0,#1]            ;722
000a28  f0410102          ORR      r1,r1,#2              ;722
000a2c  7041              STRB     r1,[r0,#1]            ;722
000a2e  e008              B        |L1.2626|
                  |L1.2608|
000a30  7841              LDRB     r1,[r0,#1]            ;723
000a32  f0410104          ORR      r1,r1,#4              ;723
000a36  7041              STRB     r1,[r0,#1]            ;723
000a38  e003              B        |L1.2626|
                  |L1.2618|
000a3a  7841              LDRB     r1,[r0,#1]            ;724
000a3c  f0410108          ORR      r1,r1,#8              ;724
000a40  7041              STRB     r1,[r0,#1]            ;724
                  |L1.2626|
000a42  f8804057          STRB     r4,[r0,#0x57]         ;726
000a46  4650              MOV      r0,r10                ;730
000a48  f7fffffe          BL       lc640_read_int
000a4c  f1000001          ADD      r0,r0,#1              ;731
000a50  fa1ffb80          UXTH     r11,r0                ;731
000a54  f1bb0f3f          CMP      r11,#0x3f             ;732
000a58  d901              BLS      |L1.2654|
000a5a  f04f0b00          MOV      r11,#0                ;732
                  |L1.2654|
000a5e  fa0ff18b          SXTH     r1,r11                ;733
000a62  4650              MOV      r0,r10                ;733
000a64  f7fffffe          BL       lc640_write_int
000a68  f6406002          MOV      r0,#0xe02             ;735
000a6c  f7fffffe          BL       lc640_read_int
000a70  b280              UXTH     r0,r0                 ;735
000a72  283f              CMP      r0,#0x3f              ;736
000a74  d000              BEQ      |L1.2680|
000a76  4658              MOV      r0,r11                ;736
                  |L1.2680|
000a78  b201              SXTH     r1,r0                 ;737
000a7a  f6406002          MOV      r0,#0xe02             ;737
000a7e  f7fffffe          BL       lc640_write_int
000a82  4650              MOV      r0,r10                ;739
000a84  f7fffffe          BL       lc640_read_int
000a88  eb051040          ADD      r0,r5,r0,LSL #5       ;739
000a8c  b285              UXTH     r5,r0                 ;739
000a8e  f04f0053          MOV      r0,#0x53              ;741
000a92  f88d0000          STRB     r0,[sp,#0]            ;741
000a96  f88d6001          STRB     r6,[sp,#1]            ;742
000a9a  f88d7002          STRB     r7,[sp,#2]            ;743
000a9e  f88d9003          STRB     r9,[sp,#3]            ;744
000aa2  4669              MOV      r1,sp                 ;745
000aa4  4628              MOV      r0,r5                 ;745
000aa6  f7fffffe          BL       lc640_write_long_ptr
000aaa  f8cd9000          STR      r9,[sp,#0]            ;750
000aae  4669              MOV      r1,sp                 ;751
000ab0  1d28              ADDS     r0,r5,#4              ;751
000ab2  f7fffffe          BL       lc640_write_long_ptr
000ab6  f8b8003c          LDRH     r0,[r8,#0x3c]         ;753
000aba  f88d0000          STRB     r0,[sp,#0]            ;753
000abe  f8980038          LDRB     r0,[r8,#0x38]         ;754
000ac2  f88d0001          STRB     r0,[sp,#1]            ;754
000ac6  f898002c          LDRB     r0,[r8,#0x2c]         ;755
000aca  f88d0002          STRB     r0,[sp,#2]            ;755
000ace  f88d9003          STRB     r9,[sp,#3]            ;756
000ad2  4669              MOV      r1,sp                 ;757
000ad4  f1050008          ADD      r0,r5,#8              ;757
000ad8  f7fffffe          BL       lc640_write_long_ptr
000adc  f8980028          LDRB     r0,[r8,#0x28]         ;759
000ae0  f88d0000          STRB     r0,[sp,#0]            ;759
000ae4  f8980024          LDRB     r0,[r8,#0x24]         ;760
000ae8  f88d0001          STRB     r0,[sp,#1]            ;760
000aec  f8980020          LDRB     r0,[r8,#0x20]         ;761
000af0  f88d0002          STRB     r0,[sp,#2]            ;761
000af4  f88d9003          STRB     r9,[sp,#3]            ;762
000af8  4669              MOV      r1,sp                 ;763
000afa  f105000c          ADD      r0,r5,#0xc            ;763
000afe  f7fffffe          BL       lc640_write_long_ptr
000b02  f04f0741          MOV      r7,#0x41              ;765
000b06  e000              B        |L1.2826|
                  |L1.2824|
000b08  e0a5              B        |L1.3158|
                  |L1.2826|
000b0a  f88d7000          STRB     r7,[sp,#0]            ;765
000b0e  f88d7001          STRB     r7,[sp,#1]            ;766
000b12  f88d7002          STRB     r7,[sp,#2]            ;767
000b16  f88d7003          STRB     r7,[sp,#3]            ;768
000b1a  4669              MOV      r1,sp                 ;769
000b1c  f1050010          ADD      r0,r5,#0x10           ;769
000b20  f7fffffe          BL       lc640_write_long_ptr
000b24  f88d7000          STRB     r7,[sp,#0]            ;771
000b28  f88d7001          STRB     r7,[sp,#1]            ;772
000b2c  f88d7002          STRB     r7,[sp,#2]            ;773
000b30  f88d7003          STRB     r7,[sp,#3]            ;774
000b34  4669              MOV      r1,sp                 ;775
000b36  f1050014          ADD      r0,r5,#0x14           ;775
000b3a  f7fffffe          BL       lc640_write_long_ptr
000b3e  f88d7000          STRB     r7,[sp,#0]            ;777
000b42  f88d7001          STRB     r7,[sp,#1]            ;778
000b46  f88d7002          STRB     r7,[sp,#2]            ;779
000b4a  f88d7003          STRB     r7,[sp,#3]            ;780
000b4e  4669              MOV      r1,sp                 ;781
000b50  f1050018          ADD      r0,r5,#0x18           ;781
000b54  f7fffffe          BL       lc640_write_long_ptr
000b58  f88d7000          STRB     r7,[sp,#0]            ;783
000b5c  f88d7001          STRB     r7,[sp,#1]            ;784
000b60  f88d7002          STRB     r7,[sp,#2]            ;785
000b64  f88d7003          STRB     r7,[sp,#3]            ;786
000b68  4669              MOV      r1,sp                 ;787
000b6a  f105001c          ADD      r0,r5,#0x1c           ;787
000b6e  f7fffffe          BL       lc640_write_long_ptr
000b72  b126              CBZ      r6,|L1.2942|
000b74  2e01              CMP      r6,#1                 ;801
000b76  d026              BEQ      |L1.3014|
000b78  2e02              CMP      r6,#2                 ;812
000b7a  d048              BEQ      |L1.3086|
000b7c  e10b              B        |L1.3478|
                  |L1.2942|
000b7e  b134              CBZ      r4,|L1.2958|
000b80  2c01              CMP      r4,#1                 ;794
000b82  d00b              BEQ      |L1.2972|
000b84  2c02              CMP      r4,#2                 ;796
000b86  d010              BEQ      |L1.2986|
000b88  2c03              CMP      r4,#3                 ;798
000b8a  d015              BEQ      |L1.3000|
000b8c  e103              B        |L1.3478|
                  |L1.2958|
000b8e  2300              MOVS     r3,#0                 ;793
000b90  2201              MOVS     r2,#1                 ;793
000b92  2104              MOVS     r1,#4                 ;793
000b94  a096              ADR      r0,|L1.3568|
000b96  f7fffffe          BL       snmp_trap_send
000b9a  e0fc              B        |L1.3478|
                  |L1.2972|
000b9c  2301              MOVS     r3,#1                 ;795
000b9e  461a              MOV      r2,r3                 ;795
000ba0  2104              MOVS     r1,#4                 ;795
000ba2  a099              ADR      r0,|L1.3592|
000ba4  f7fffffe          BL       snmp_trap_send
000ba8  e0f5              B        |L1.3478|
                  |L1.2986|
000baa  2302              MOVS     r3,#2                 ;797
000bac  2201              MOVS     r2,#1                 ;797
000bae  2104              MOVS     r1,#4                 ;797
000bb0  a09c              ADR      r0,|L1.3620|
000bb2  f7fffffe          BL       snmp_trap_send
000bb6  e0ee              B        |L1.3478|
                  |L1.3000|
000bb8  2303              MOVS     r3,#3                 ;799
000bba  2201              MOVS     r2,#1                 ;799
000bbc  2104              MOVS     r1,#4                 ;799
000bbe  a0a1              ADR      r0,|L1.3652|
000bc0  f7fffffe          BL       snmp_trap_send
000bc4  e0e7              B        |L1.3478|
                  |L1.3014|
000bc6  b134              CBZ      r4,|L1.3030|
000bc8  2c01              CMP      r4,#1                 ;805
000bca  d00b              BEQ      |L1.3044|
000bcc  2c02              CMP      r4,#2                 ;807
000bce  d010              BEQ      |L1.3058|
000bd0  2c03              CMP      r4,#3                 ;809
000bd2  d015              BEQ      |L1.3072|
000bd4  e0df              B        |L1.3478|
                  |L1.3030|
000bd6  2300              MOVS     r3,#0                 ;804
000bd8  2202              MOVS     r2,#2                 ;804
000bda  2104              MOVS     r1,#4                 ;804
000bdc  a0a1              ADR      r0,|L1.3684|
000bde  f7fffffe          BL       snmp_trap_send
000be2  e0d8              B        |L1.3478|
                  |L1.3044|
000be4  2301              MOVS     r3,#1                 ;806
000be6  2202              MOVS     r2,#2                 ;806
000be8  2104              MOVS     r1,#4                 ;806
000bea  a0a4              ADR      r0,|L1.3708|
000bec  f7fffffe          BL       snmp_trap_send
000bf0  e0d1              B        |L1.3478|
                  |L1.3058|
000bf2  2302              MOVS     r3,#2                 ;808
000bf4  461a              MOV      r2,r3                 ;808
000bf6  2104              MOVS     r1,#4                 ;808
000bf8  a0a7              ADR      r0,|L1.3736|
000bfa  f7fffffe          BL       snmp_trap_send
000bfe  e0ca              B        |L1.3478|
                  |L1.3072|
000c00  2303              MOVS     r3,#3                 ;810
000c02  2202              MOVS     r2,#2                 ;810
000c04  2104              MOVS     r1,#4                 ;810
000c06  a0ac              ADR      r0,|L1.3768|
000c08  f7fffffe          BL       snmp_trap_send
000c0c  e0c3              B        |L1.3478|
                  |L1.3086|
000c0e  b134              CBZ      r4,|L1.3102|
000c10  2c01              CMP      r4,#1                 ;816
000c12  d00b              BEQ      |L1.3116|
000c14  2c02              CMP      r4,#2                 ;818
000c16  d010              BEQ      |L1.3130|
000c18  2c03              CMP      r4,#3                 ;820
000c1a  d015              BEQ      |L1.3144|
000c1c  e0bb              B        |L1.3478|
                  |L1.3102|
000c1e  2300              MOVS     r3,#0                 ;815
000c20  2203              MOVS     r2,#3                 ;815
000c22  2104              MOVS     r1,#4                 ;815
000c24  a0ac              ADR      r0,|L1.3800|
000c26  f7fffffe          BL       snmp_trap_send
000c2a  e0b4              B        |L1.3478|
                  |L1.3116|
000c2c  2301              MOVS     r3,#1                 ;817
000c2e  2203              MOVS     r2,#3                 ;817
000c30  2104              MOVS     r1,#4                 ;817
000c32  a0af              ADR      r0,|L1.3824|
000c34  f7fffffe          BL       snmp_trap_send
000c38  e0ad              B        |L1.3478|
                  |L1.3130|
000c3a  2302              MOVS     r3,#2                 ;819
000c3c  2203              MOVS     r2,#3                 ;819
000c3e  2104              MOVS     r1,#4                 ;819
000c40  a0b2              ADR      r0,|L1.3852|
000c42  f7fffffe          BL       snmp_trap_send
000c46  e0a6              B        |L1.3478|
                  |L1.3144|
000c48  2303              MOVS     r3,#3                 ;821
000c4a  461a              MOV      r2,r3                 ;821
000c4c  2104              MOVS     r1,#4                 ;821
000c4e  a0b7              ADR      r0,|L1.3884|
000c50  f7fffffe          BL       snmp_trap_send
000c54  e09f              B        |L1.3478|
                  |L1.3158|
;;;827    	{      
;;;828    //	av_bps[bps]=0;
;;;829    
;;;830    	//SET_REG(avar_stat,0,3+bps,1);
;;;831    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;832    
;;;833         if(v==0) bps[dev]._av&=(~(1<<0));
000c56  b134              CBZ      r4,|L1.3174|
;;;834         else if(v==1) bps[dev]._av&=(~(1<<1));
000c58  2c01              CMP      r4,#1
000c5a  d009              BEQ      |L1.3184|
;;;835    	else if(v==2) bps[dev]._av&=(~(1<<2));
000c5c  2c02              CMP      r4,#2
000c5e  d00c              BEQ      |L1.3194|
;;;836    	else if(v==3) bps[dev]._av&=(~(1<<3));
000c60  2c03              CMP      r4,#3
000c62  d00f              BEQ      |L1.3204|
000c64  e012              B        |L1.3212|
                  |L1.3174|
000c66  7841              LDRB     r1,[r0,#1]            ;833
000c68  f0210101          BIC      r1,r1,#1              ;833
000c6c  7041              STRB     r1,[r0,#1]            ;833
000c6e  e00d              B        |L1.3212|
                  |L1.3184|
000c70  7841              LDRB     r1,[r0,#1]            ;834
000c72  f0210102          BIC      r1,r1,#2              ;834
000c76  7041              STRB     r1,[r0,#1]            ;834
000c78  e008              B        |L1.3212|
                  |L1.3194|
000c7a  7841              LDRB     r1,[r0,#1]            ;835
000c7c  f0210104          BIC      r1,r1,#4              ;835
000c80  7041              STRB     r1,[r0,#1]            ;835
000c82  e003              B        |L1.3212|
                  |L1.3204|
000c84  7841              LDRB     r1,[r0,#1]
000c86  f0210108          BIC      r1,r1,#8
000c8a  7041              STRB     r1,[r0,#1]
                  |L1.3212|
;;;837         
;;;838    //	if((bps[dev]._av&0x0f==0))
;;;839    //	     {
;;;840    		//SET_REG(avar_stat,0,3+bps,1);
;;;841    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;842    //	     }
;;;843     
;;;844    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000c8c  4650              MOV      r0,r10
000c8e  f7fffffe          BL       lc640_read_int
000c92  fa1ffb80          UXTH     r11,r0
;;;845    	event_ptr_find=event_ptr;
000c96  465c              MOV      r4,r11
                  |L1.3224|
;;;846    	
;;;847    avar_src_hndl_lbl1: 
;;;848    
;;;849    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000c98  eb051044          ADD      r0,r5,r4,LSL #5
000c9c  fa1ffa80          UXTH     r10,r0
;;;850    
;;;851         lc640_read_long_ptr(lc640_adr,data);
000ca0  4669              MOV      r1,sp
000ca2  4650              MOV      r0,r10
000ca4  f7fffffe          BL       lc640_read_long_ptr
;;;852         
;;;853         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000ca8  f89d0000          LDRB     r0,[sp,#0]
000cac  2853              CMP      r0,#0x53
000cae  d107              BNE      |L1.3264|
000cb0  f89d0001          LDRB     r0,[sp,#1]
000cb4  42b0              CMP      r0,r6
000cb6  d103              BNE      |L1.3264|
000cb8  f89d0002          LDRB     r0,[sp,#2]
000cbc  42b8              CMP      r0,r7
000cbe  d009              BEQ      |L1.3284|
                  |L1.3264|
;;;854         	{        
;;;855         	if(event_ptr_find)event_ptr_find--;
000cc0  b11c              CBZ      r4,|L1.3274|
000cc2  f1a40401          SUB      r4,r4,#1
000cc6  b2a4              UXTH     r4,r4
000cc8  e001              B        |L1.3278|
                  |L1.3274|
;;;856         	else event_ptr_find=63;
000cca  f04f043f          MOV      r4,#0x3f
                  |L1.3278|
;;;857         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000cce  455c              CMP      r4,r11
000cd0  d1e2              BNE      |L1.3224|
000cd2  e060              B        |L1.3478|
                  |L1.3284|
;;;858         	else goto avar_src_hndl_lbl1;
;;;859         	}
;;;860         else 
;;;861         	{
;;;862         	lc640_read_long_ptr(lc640_adr+16,data);
000cd4  4669              MOV      r1,sp
000cd6  f10a0010          ADD      r0,r10,#0x10
000cda  f7fffffe          BL       lc640_read_long_ptr
;;;863         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000cde  f89d0000          LDRB     r0,[sp,#0]
000ce2  2841              CMP      r0,#0x41
000ce4  d10b              BNE      |L1.3326|
000ce6  f89d0001          LDRB     r0,[sp,#1]
000cea  2841              CMP      r0,#0x41
000cec  d107              BNE      |L1.3326|
000cee  f89d0002          LDRB     r0,[sp,#2]
000cf2  2841              CMP      r0,#0x41
000cf4  d103              BNE      |L1.3326|
000cf6  f89d0003          LDRB     r0,[sp,#3]
000cfa  2841              CMP      r0,#0x41
000cfc  d009              BEQ      |L1.3346|
                  |L1.3326|
;;;864         		{        
;;;865         		if(event_ptr_find)event_ptr_find--;
000cfe  b11c              CBZ      r4,|L1.3336|
000d00  f1a40401          SUB      r4,r4,#1
000d04  b2a4              UXTH     r4,r4
000d06  e001              B        |L1.3340|
                  |L1.3336|
;;;866             		else event_ptr_find=63;
000d08  f04f043f          MOV      r4,#0x3f
                  |L1.3340|
;;;867             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000d0c  455c              CMP      r4,r11
000d0e  d1c3              BNE      |L1.3224|
000d10  e041              B        |L1.3478|
                  |L1.3346|
;;;868         		else goto avar_src_hndl_lbl1;
;;;869         		}
;;;870    
;;;871         	}	
;;;872    
;;;873    
;;;874    	
;;;875    	data[0]=LPC_RTC->YEAR;
000d12  f8b8003c          LDRH     r0,[r8,#0x3c]
000d16  f88d0000          STRB     r0,[sp,#0]
;;;876    	data[1]=LPC_RTC->MONTH;
000d1a  f8980038          LDRB     r0,[r8,#0x38]
000d1e  f88d0001          STRB     r0,[sp,#1]
;;;877    	data[2]=LPC_RTC->DOM;
000d22  f898002c          LDRB     r0,[r8,#0x2c]
000d26  f88d0002          STRB     r0,[sp,#2]
;;;878    	data[3]=0;
000d2a  f88d9003          STRB     r9,[sp,#3]
;;;879    	lc640_write_long_ptr(lc640_adr+16,data);
000d2e  4669              MOV      r1,sp
000d30  f10a0010          ADD      r0,r10,#0x10
000d34  f7fffffe          BL       lc640_write_long_ptr
;;;880    
;;;881    	data[0]=LPC_RTC->HOUR;
000d38  f8980028          LDRB     r0,[r8,#0x28]
000d3c  f88d0000          STRB     r0,[sp,#0]
;;;882    	data[1]=LPC_RTC->MIN;
000d40  f8980024          LDRB     r0,[r8,#0x24]
000d44  f88d0001          STRB     r0,[sp,#1]
;;;883    	data[2]=LPC_RTC->SEC;
000d48  f8980020          LDRB     r0,[r8,#0x20]
000d4c  f88d0002          STRB     r0,[sp,#2]
;;;884    	data[3]=0;
000d50  f88d9003          STRB     r9,[sp,#3]
;;;885    	lc640_write_long_ptr(lc640_adr+20,data);
000d54  4669              MOV      r1,sp
000d56  f10a0014          ADD      r0,r10,#0x14
000d5a  f7fffffe          BL       lc640_write_long_ptr
;;;886    	
;;;887    	data[0]='B';
000d5e  f04f0442          MOV      r4,#0x42
000d62  f88d4000          STRB     r4,[sp,#0]
;;;888    	data[1]='B';
000d66  f88d4001          STRB     r4,[sp,#1]
;;;889    	data[2]='B';
000d6a  f88d4002          STRB     r4,[sp,#2]
;;;890    	data[3]='B';
000d6e  f88d4003          STRB     r4,[sp,#3]
;;;891    	lc640_write_long_ptr(lc640_adr+24,data);
000d72  4669              MOV      r1,sp
000d74  f10a0018          ADD      r0,r10,#0x18
000d78  f7fffffe          BL       lc640_write_long_ptr
;;;892    	
;;;893    	data[0]='B';
000d7c  f88d4000          STRB     r4,[sp,#0]
;;;894    	data[1]='B';
000d80  f88d4001          STRB     r4,[sp,#1]
;;;895    	data[2]='B';
000d84  f88d4002          STRB     r4,[sp,#2]
;;;896    	data[3]='B';
000d88  f88d4003          STRB     r4,[sp,#3]
;;;897    	lc640_write_long_ptr(lc640_adr+28,data);
000d8c  4669              MOV      r1,sp
000d8e  f10a001c          ADD      r0,r10,#0x1c
000d92  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3478|
;;;898    	
;;;899    	}
;;;900    	
;;;901    avar_src_hndl_end:
;;;902    __nop();		
000d96  bf00              NOP      
                  |L1.3480|
;;;903    }
000d98  e486              B        |L1.1704|
;;;904    
                          ENDP

                  wrk_mem_hndl PROC
;;;905    //-----------------------------------------------
;;;906    void wrk_mem_hndl(char b)
000d9a  e92d41fc          PUSH     {r2-r8,lr}
;;;907    {
000d9e  4606              MOV      r6,r0
;;;908    char data[4];
;;;909    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;910    
;;;911    signed short temp_temp;
;;;912    
;;;913    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000da0  486a              LDR      r0,|L1.3916|
000da2  eb060186          ADD      r1,r6,r6,LSL #2
000da6  eb001401          ADD      r4,r0,r1,LSL #4
000daa  8c60              LDRH     r0,[r4,#0x22]
000dac  2805              CMP      r0,#5
000dae  d31a              BCC      |L1.3558|
;;;914    
;;;915    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000db0  4867              LDR      r0,|L1.3920|
000db2  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000db4  f1000006          ADD      r0,r0,#6
000db8  f0000007          AND      r0,r0,#7
000dbc  eb040040          ADD      r0,r4,r0,LSL #1
000dc0  8c80              LDRH     r0,[r0,#0x24]
000dc2  9000              STR      r0,[sp,#0]
;;;916    
;;;917    
;;;918    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000dc4  f44f6760          MOV      r7,#0xe00
000dc8  4638              MOV      r0,r7
000dca  f7fffffe          BL       lc640_read_int
;;;919    event_ptr++;	
000dce  f1000001          ADD      r0,r0,#1
000dd2  b285              UXTH     r5,r0
;;;920    if(event_ptr>63)event_ptr=0;	
000dd4  2d3f              CMP      r5,#0x3f
000dd6  d901              BLS      |L1.3548|
000dd8  f04f0500          MOV      r5,#0
                  |L1.3548|
;;;921    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000ddc  b229              SXTH     r1,r5
000dde  4638              MOV      r0,r7
000de0  f7fffffe          BL       lc640_write_int
;;;922    	
;;;923    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000de4  e0b6              B        |L1.3924|
                  |L1.3558|
000de6  e11d              B        |L1.4132|
                  |L1.3560|
                          DCD      0x40024000
                  |L1.3564|
                          DCD      bps
                  |L1.3568|
000df0  42505320          DCB      "BPS #1 Alarm, overheat",0
000df4  23312041
000df8  6c61726d
000dfc  2c206f76
000e00  65726865
000e04  617400  
000e07  00                DCB      0
                  |L1.3592|
000e08  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000e0c  23312041
000e10  6c61726d
000e14  2c20766f
000e18  6c746167
000e1c  65206973
000e20  20757000
                  |L1.3620|
000e24  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000e28  23312041
000e2c  6c61726d
000e30  2c20766f
000e34  6c746167
000e38  65206973
000e3c  20646f77
000e40  6e00    
000e42  00                DCB      0
000e43  00                DCB      0
                  |L1.3652|
000e44  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000e48  23312041
000e4c  6c61726d
000e50  2c20636f
000e54  6e6e6563
000e58  74206973
000e5c  206c6f73
000e60  7400    
000e62  00                DCB      0
000e63  00                DCB      0
                  |L1.3684|
000e64  42505320          DCB      "BPS #2 Alarm, overheat",0
000e68  23322041
000e6c  6c61726d
000e70  2c206f76
000e74  65726865
000e78  617400  
000e7b  00                DCB      0
                  |L1.3708|
000e7c  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000e80  23322041
000e84  6c61726d
000e88  2c20766f
000e8c  6c746167
000e90  65206973
000e94  20757000
                  |L1.3736|
000e98  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000e9c  23322041
000ea0  6c61726d
000ea4  2c20766f
000ea8  6c746167
000eac  65206973
000eb0  20646f77
000eb4  6e00    
000eb6  00                DCB      0
000eb7  00                DCB      0
                  |L1.3768|
000eb8  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000ebc  23322041
000ec0  6c61726d
000ec4  2c20636f
000ec8  6e6e6563
000ecc  74206973
000ed0  206c6f73
000ed4  7400    
000ed6  00                DCB      0
000ed7  00                DCB      0
                  |L1.3800|
000ed8  42505320          DCB      "BPS #3 Alarm, overheat",0
000edc  23332041
000ee0  6c61726d
000ee4  2c206f76
000ee8  65726865
000eec  617400  
000eef  00                DCB      0
                  |L1.3824|
000ef0  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000ef4  23332041
000ef8  6c61726d
000efc  2c20766f
000f00  6c746167
000f04  65206973
000f08  20757000
                  |L1.3852|
000f0c  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000f10  23332041
000f14  6c61726d
000f18  2c20766f
000f1c  6c746167
000f20  65206973
000f24  20646f77
000f28  6e00    
000f2a  00                DCB      0
000f2b  00                DCB      0
                  |L1.3884|
000f2c  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000f30  23332041
000f34  6c61726d
000f38  2c20636f
000f3c  6e6e6563
000f40  74206973
000f44  206c6f73
000f48  7400    
000f4a  00                DCB      0
000f4b  00                DCB      0
                  |L1.3916|
                          DCD      bat
                  |L1.3920|
                          DCD      bat_u_old_cnt
                  |L1.3924|
000f54  f6406802          MOV      r8,#0xe02
000f58  4640              MOV      r0,r8
000f5a  f7fffffe          BL       lc640_read_int
000f5e  b280              UXTH     r0,r0
;;;924    if(event_cnt!=63)event_cnt=event_ptr;
000f60  283f              CMP      r0,#0x3f
000f62  d000              BEQ      |L1.3942|
000f64  4628              MOV      r0,r5
                  |L1.3942|
;;;925    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000f66  b201              SXTH     r1,r0
000f68  4640              MOV      r0,r8
000f6a  f7fffffe          BL       lc640_write_int
;;;926    	
;;;927    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000f6e  4638              MOV      r0,r7
000f70  f7fffffe          BL       lc640_read_int
000f74  f44f6180          MOV      r1,#0x400
000f78  eb011040          ADD      r0,r1,r0,LSL #5
000f7c  b285              UXTH     r5,r0
;;;928    	
;;;929    data[0]='B';
000f7e  f04f0042          MOV      r0,#0x42
000f82  f88d0004          STRB     r0,[sp,#4]
;;;930    data[1]=b; 
000f86  f88d6005          STRB     r6,[sp,#5]
;;;931    data[2]='W';
000f8a  f04f0057          MOV      r0,#0x57
000f8e  f88d0006          STRB     r0,[sp,#6]
;;;932    data[3]=0;
000f92  f04f0600          MOV      r6,#0
000f96  f88d6007          STRB     r6,[sp,#7]
;;;933    
;;;934    lc640_write_long_ptr(lc640_adr,data);
000f9a  a901              ADD      r1,sp,#4
000f9c  4628              MOV      r0,r5
000f9e  f7fffffe          BL       lc640_write_long_ptr
;;;935    
;;;936    data[0]=*((char*)&bat[b]._Iintegr_);
000fa2  f8940022          LDRB     r0,[r4,#0x22]
000fa6  f88d0004          STRB     r0,[sp,#4]
;;;937    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000faa  f8940023          LDRB     r0,[r4,#0x23]
000fae  f88d0005          STRB     r0,[sp,#5]
;;;938    data[2]=*((char*)&temp_temp);
000fb2  f89d0000          LDRB     r0,[sp,#0]
000fb6  f88d0006          STRB     r0,[sp,#6]
;;;939    data[3]=*(((char*)(&temp_temp))+1);
000fba  f89d0001          LDRB     r0,[sp,#1]
000fbe  f88d0007          STRB     r0,[sp,#7]
;;;940    lc640_write_long_ptr(lc640_adr+4,data);
000fc2  a901              ADD      r1,sp,#4
000fc4  1d28              ADDS     r0,r5,#4
000fc6  f7fffffe          BL       lc640_write_long_ptr
;;;941    
;;;942    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000fca  f1040138          ADD      r1,r4,#0x38
000fce  f1050008          ADD      r0,r5,#8
000fd2  f7fffffe          BL       lc640_write_long_ptr
;;;943    	
;;;944    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000fd6  f104013c          ADD      r1,r4,#0x3c
000fda  f105000c          ADD      r0,r5,#0xc
000fde  f7fffffe          BL       lc640_write_long_ptr
;;;945    
;;;946    data[0]=LPC_RTC->YEAR;
000fe2  4cff              LDR      r4,|L1.5088|
000fe4  8ba0              LDRH     r0,[r4,#0x1c]
000fe6  f88d0004          STRB     r0,[sp,#4]
;;;947    data[1]=LPC_RTC->MONTH;
000fea  7e20              LDRB     r0,[r4,#0x18]
000fec  f88d0005          STRB     r0,[sp,#5]
;;;948    data[2]=LPC_RTC->DOM;
000ff0  7b20              LDRB     r0,[r4,#0xc]
000ff2  f88d0006          STRB     r0,[sp,#6]
;;;949    data[3]=0;
000ff6  f88d6007          STRB     r6,[sp,#7]
;;;950    lc640_write_long_ptr(lc640_adr+16,data);
000ffa  a901              ADD      r1,sp,#4
000ffc  f1050010          ADD      r0,r5,#0x10
001000  f7fffffe          BL       lc640_write_long_ptr
;;;951    
;;;952    data[0]=LPC_RTC->HOUR;
001004  7a20              LDRB     r0,[r4,#8]
001006  f88d0004          STRB     r0,[sp,#4]
;;;953    data[1]=LPC_RTC->MIN;
00100a  7920              LDRB     r0,[r4,#4]
00100c  f88d0005          STRB     r0,[sp,#5]
;;;954    data[2]=LPC_RTC->SEC;
001010  7820              LDRB     r0,[r4,#0]
001012  f88d0006          STRB     r0,[sp,#6]
;;;955    data[3]=0;
001016  f88d6007          STRB     r6,[sp,#7]
;;;956    lc640_write_long_ptr(lc640_adr+20,data);
00101a  a901              ADD      r1,sp,#4
00101c  f1050014          ADD      r0,r5,#0x14
001020  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4132|
;;;957    	
;;;958    
;;;959    
;;;960    	
;;;961    wrk_mem_hndl_end:	
;;;962    __nop();
001024  bf00              NOP      
;;;963    }  
001026  e8bd81fc          POP      {r2-r8,pc}
;;;964    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;966    //-----------------------------------------------
;;;967    void avar_bat_ips_hndl(char in)
00102a  e92d4ff8          PUSH     {r3-r11,lr}
;;;968    {
00102e  4602              MOV      r2,r0
;;;969    char data[4];
;;;970    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;971    
;;;972    if(in==1)
;;;973    	{
;;;974    	bat_ips[0]._av|=1;
001030  48ec              LDR      r0,|L1.5092|
;;;975        ips_bat_av_stat[0]=1;
001032  4ced              LDR      r4,|L1.5096|
;;;976    	ips_bat_av_vzvod[0]=1;
001034  4bed              LDR      r3,|L1.5100|
;;;977    
;;;978    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;979    	event_ptr++;	
;;;980    	if(event_ptr>63)event_ptr=0;	
;;;981    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;982    	
;;;983    	event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;984    	if(event_cnt!=63)event_cnt=event_ptr;
;;;985    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;986    	
;;;987    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;988    	
;;;989    	data[0]='B';
;;;990    	data[1]=0;
;;;991    	data[2]='C';
;;;992    	data[3]=0;
;;;993    	lc640_write_long_ptr(lc640_adr,data);
;;;994    
;;;995    	data[0]=0;
;;;996    	data[1]=0;
;;;997    	data[2]=0;
;;;998    	data[3]=0;
;;;999    	lc640_write_long_ptr(lc640_adr+4,data);
;;;1000   
;;;1001   	data[0]=LPC_RTC->YEAR;
001036  f8df83b8          LDR      r8,|L1.5104|
00103a  f8901041          LDRB     r1,[r0,#0x41]         ;974
00103e  f04f0742          MOV      r7,#0x42              ;989
001042  f44f6560          MOV      r5,#0xe00             ;978
001046  f04f0900          MOV      r9,#0                 ;980
00104a  f44f6a80          MOV      r10,#0x400            ;987
00104e  2a01              CMP      r2,#1                 ;972
001050  d002              BEQ      |L1.4184|
;;;1002   	data[1]=LPC_RTC->MONTH;
;;;1003   	data[2]=LPC_RTC->DOM;
;;;1004   	data[3]=0;
;;;1005   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1006   
;;;1007   	data[0]=LPC_RTC->HOUR;
;;;1008   	data[1]=LPC_RTC->MIN;
;;;1009   	data[2]=LPC_RTC->SEC;
;;;1010   	data[3]=0;
;;;1011   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1012   	
;;;1013   	data[0]='A';
;;;1014   	data[1]='A';
;;;1015   	data[2]='A';
;;;1016   	data[3]='A';
;;;1017   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1018   	
;;;1019   	data[0]='A';
;;;1020   	data[1]='A';
;;;1021   	data[2]='A';
;;;1022   	data[3]='A';
;;;1023   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1024   	
;;;1025   	data[0]='A';
;;;1026   	data[1]='A';
;;;1027   	data[2]='A';
;;;1028   	data[3]='A';
;;;1029   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1030   	
;;;1031   	data[0]='A';
;;;1032   	data[1]='A';
;;;1033   	data[2]='A';
;;;1034   	data[3]='A';
;;;1035   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1036   					
;;;1037   	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;1038   		
;;;1039   	}
;;;1040   
;;;1041   else if(in==0)
001052  2a00              CMP      r2,#0
001054  d07e              BEQ      |L1.4436|
001056  e12f              B        |L1.4792|
                  |L1.4184|
001058  f0410101          ORR      r1,r1,#1              ;974
00105c  f8801041          STRB     r1,[r0,#0x41]         ;974
001060  f04f0001          MOV      r0,#1                 ;975
001064  7020              STRB     r0,[r4,#0]            ;975
001066  7018              STRB     r0,[r3,#0]            ;976
001068  4628              MOV      r0,r5                 ;978
00106a  f7fffffe          BL       lc640_read_int
00106e  f1000001          ADD      r0,r0,#1              ;979
001072  b284              UXTH     r4,r0                 ;979
001074  2c3f              CMP      r4,#0x3f              ;980
001076  d901              BLS      |L1.4220|
001078  f04f0400          MOV      r4,#0                 ;980
                  |L1.4220|
00107c  b221              SXTH     r1,r4                 ;981
00107e  4628              MOV      r0,r5                 ;981
001080  f7fffffe          BL       lc640_write_int
001084  f6406602          MOV      r6,#0xe02             ;983
001088  4630              MOV      r0,r6                 ;983
00108a  f7fffffe          BL       lc640_read_int
00108e  b281              UXTH     r1,r0                 ;983
001090  293f              CMP      r1,#0x3f              ;984
001092  d000              BEQ      |L1.4246|
001094  4621              MOV      r1,r4                 ;984
                  |L1.4246|
001096  b209              SXTH     r1,r1                 ;985
001098  4630              MOV      r0,r6                 ;985
00109a  f7fffffe          BL       lc640_write_int
00109e  4628              MOV      r0,r5                 ;987
0010a0  f7fffffe          BL       lc640_read_int
0010a4  eb0a1040          ADD      r0,r10,r0,LSL #5      ;987
0010a8  b284              UXTH     r4,r0                 ;987
0010aa  f88d7000          STRB     r7,[sp,#0]            ;989
0010ae  f88d9001          STRB     r9,[sp,#1]            ;990
0010b2  f04f0043          MOV      r0,#0x43              ;991
0010b6  f88d0002          STRB     r0,[sp,#2]            ;991
0010ba  f88d9003          STRB     r9,[sp,#3]            ;992
0010be  4669              MOV      r1,sp                 ;993
0010c0  4620              MOV      r0,r4                 ;993
0010c2  f7fffffe          BL       lc640_write_long_ptr
0010c6  f8cd9000          STR      r9,[sp,#0]            ;998
0010ca  4669              MOV      r1,sp                 ;999
0010cc  1d20              ADDS     r0,r4,#4              ;999
0010ce  f7fffffe          BL       lc640_write_long_ptr
0010d2  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1001
0010d6  f88d0000          STRB     r0,[sp,#0]            ;1001
0010da  f8980038          LDRB     r0,[r8,#0x38]         ;1002
0010de  f88d0001          STRB     r0,[sp,#1]            ;1002
0010e2  f898002c          LDRB     r0,[r8,#0x2c]         ;1003
0010e6  f88d0002          STRB     r0,[sp,#2]            ;1003
0010ea  f88d9003          STRB     r9,[sp,#3]            ;1004
0010ee  4669              MOV      r1,sp                 ;1005
0010f0  f1040008          ADD      r0,r4,#8              ;1005
0010f4  f7fffffe          BL       lc640_write_long_ptr
0010f8  f8980028          LDRB     r0,[r8,#0x28]         ;1007
0010fc  f88d0000          STRB     r0,[sp,#0]            ;1007
001100  f8980024          LDRB     r0,[r8,#0x24]         ;1008
001104  f88d0001          STRB     r0,[sp,#1]            ;1008
001108  f8980020          LDRB     r0,[r8,#0x20]         ;1009
00110c  f88d0002          STRB     r0,[sp,#2]            ;1009
001110  f88d9003          STRB     r9,[sp,#3]            ;1010
001114  4669              MOV      r1,sp                 ;1011
001116  f104000c          ADD      r0,r4,#0xc            ;1011
00111a  f7fffffe          BL       lc640_write_long_ptr
00111e  f04f0541          MOV      r5,#0x41              ;1013
001122  f88d5000          STRB     r5,[sp,#0]            ;1013
001126  f88d5001          STRB     r5,[sp,#1]            ;1014
00112a  f88d5002          STRB     r5,[sp,#2]            ;1015
00112e  f88d5003          STRB     r5,[sp,#3]            ;1016
001132  4669              MOV      r1,sp                 ;1017
001134  f1040010          ADD      r0,r4,#0x10           ;1017
001138  f7fffffe          BL       lc640_write_long_ptr
00113c  f88d5000          STRB     r5,[sp,#0]            ;1019
001140  f88d5001          STRB     r5,[sp,#1]            ;1020
001144  f88d5002          STRB     r5,[sp,#2]            ;1021
001148  f88d5003          STRB     r5,[sp,#3]            ;1022
00114c  4669              MOV      r1,sp                 ;1023
00114e  f1040014          ADD      r0,r4,#0x14           ;1023
001152  e000              B        |L1.4438|
                  |L1.4436|
001154  e022              B        |L1.4508|
                  |L1.4438|
001156  f7fffffe          BL       lc640_write_long_ptr
00115a  f88d5000          STRB     r5,[sp,#0]            ;1025
00115e  f88d5001          STRB     r5,[sp,#1]            ;1026
001162  f88d5002          STRB     r5,[sp,#2]            ;1027
001166  f88d5003          STRB     r5,[sp,#3]            ;1028
00116a  4669              MOV      r1,sp                 ;1029
00116c  f1040018          ADD      r0,r4,#0x18           ;1029
001170  f7fffffe          BL       lc640_write_long_ptr
001174  f88d5000          STRB     r5,[sp,#0]            ;1031
001178  f88d5001          STRB     r5,[sp,#1]            ;1032
00117c  f88d5002          STRB     r5,[sp,#2]            ;1033
001180  f88d5003          STRB     r5,[sp,#3]            ;1034
001184  4669              MOV      r1,sp                 ;1035
001186  f104001c          ADD      r0,r4,#0x1c           ;1035
00118a  f7fffffe          BL       lc640_write_long_ptr
00118e  2301              MOVS     r3,#1                 ;1037
001190  461a              MOV      r2,r3                 ;1037
001192  2105              MOVS     r1,#5                 ;1037
001194  a097              ADR      r0,|L1.5108|
001196  f7fffffe          BL       snmp_trap_send
00119a  e08d              B        |L1.4792|
                  |L1.4508|
;;;1042   	{
;;;1043   	bat_ips[0]._av&=~1;
00119c  f0210101          BIC      r1,r1,#1
0011a0  f8801041          STRB     r1,[r0,#0x41]
;;;1044   	ips_bat_av_stat[0]=0;
0011a4  f8849000          STRB     r9,[r4,#0]
;;;1045   	ips_bat_av_vzvod[0]=0;
0011a8  f8839000          STRB     r9,[r3,#0]
;;;1046        
;;;1047   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0011ac  4628              MOV      r0,r5
0011ae  f7fffffe          BL       lc640_read_int
0011b2  b286              UXTH     r6,r0
;;;1048   	event_ptr_find=event_ptr;
0011b4  4634              MOV      r4,r6
                  |L1.4534|
;;;1049   	
;;;1050   avar_bat_ips_hndl_lbl1: 
;;;1051   
;;;1052   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0011b6  eb0a1044          ADD      r0,r10,r4,LSL #5
0011ba  b285              UXTH     r5,r0
;;;1053   
;;;1054        lc640_read_long_ptr(lc640_adr,data);
0011bc  4669              MOV      r1,sp
0011be  4628              MOV      r0,r5
0011c0  f7fffffe          BL       lc640_read_long_ptr
;;;1055        
;;;1056        if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
0011c4  f89d0000          LDRB     r0,[sp,#0]
0011c8  2842              CMP      r0,#0x42
0011ca  d106              BNE      |L1.4570|
0011cc  f89d0001          LDRB     r0,[sp,#1]
0011d0  b918              CBNZ     r0,|L1.4570|
0011d2  f89d0002          LDRB     r0,[sp,#2]
0011d6  2843              CMP      r0,#0x43
0011d8  d009              BEQ      |L1.4590|
                  |L1.4570|
;;;1057        	{        
;;;1058        	if(event_ptr_find)event_ptr_find--;
0011da  b11c              CBZ      r4,|L1.4580|
0011dc  f1a40401          SUB      r4,r4,#1
0011e0  b2a4              UXTH     r4,r4
0011e2  e001              B        |L1.4584|
                  |L1.4580|
;;;1059        	else event_ptr_find=63;
0011e4  f04f043f          MOV      r4,#0x3f
                  |L1.4584|
;;;1060        	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
0011e8  42b4              CMP      r4,r6
0011ea  d1e4              BNE      |L1.4534|
0011ec  e064              B        |L1.4792|
                  |L1.4590|
;;;1061        	else goto avar_bat_ips_hndl_lbl1;
;;;1062        	}
;;;1063        else 
;;;1064        	{
;;;1065        	lc640_read_long_ptr(lc640_adr+16,data);
0011ee  4669              MOV      r1,sp
0011f0  f1050010          ADD      r0,r5,#0x10
0011f4  f7fffffe          BL       lc640_read_long_ptr
;;;1066        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0011f8  f89d0000          LDRB     r0,[sp,#0]
0011fc  2841              CMP      r0,#0x41
0011fe  d10b              BNE      |L1.4632|
001200  f89d0001          LDRB     r0,[sp,#1]
001204  2841              CMP      r0,#0x41
001206  d107              BNE      |L1.4632|
001208  f89d0002          LDRB     r0,[sp,#2]
00120c  2841              CMP      r0,#0x41
00120e  d103              BNE      |L1.4632|
001210  f89d0003          LDRB     r0,[sp,#3]
001214  2841              CMP      r0,#0x41
001216  d009              BEQ      |L1.4652|
                  |L1.4632|
;;;1067        		{        
;;;1068        		if(event_ptr_find)event_ptr_find--;
001218  b11c              CBZ      r4,|L1.4642|
00121a  f1a40401          SUB      r4,r4,#1
00121e  b2a4              UXTH     r4,r4
001220  e001              B        |L1.4646|
                  |L1.4642|
;;;1069            		else event_ptr_find=63;
001222  f04f043f          MOV      r4,#0x3f
                  |L1.4646|
;;;1070            	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001226  42b4              CMP      r4,r6
001228  d1c5              BNE      |L1.4534|
00122a  e045              B        |L1.4792|
                  |L1.4652|
;;;1071        		else goto avar_bat_ips_hndl_lbl1;
;;;1072        		}
;;;1073   
;;;1074        	}
;;;1075        		
;;;1076   	data[0]=LPC_RTC->YEAR;
00122c  f8b8003c          LDRH     r0,[r8,#0x3c]
001230  f88d0000          STRB     r0,[sp,#0]
;;;1077   	data[1]=LPC_RTC->MONTH;
001234  f8980038          LDRB     r0,[r8,#0x38]
001238  f88d0001          STRB     r0,[sp,#1]
;;;1078   	data[2]=LPC_RTC->DOM;
00123c  f898002c          LDRB     r0,[r8,#0x2c]
001240  f88d0002          STRB     r0,[sp,#2]
;;;1079   	data[3]=0;
001244  f88d9003          STRB     r9,[sp,#3]
;;;1080   	lc640_write_long_ptr(lc640_adr+16,data);
001248  4669              MOV      r1,sp
00124a  f1050010          ADD      r0,r5,#0x10
00124e  f7fffffe          BL       lc640_write_long_ptr
;;;1081   
;;;1082   	data[0]=LPC_RTC->HOUR;
001252  f8980028          LDRB     r0,[r8,#0x28]
001256  f88d0000          STRB     r0,[sp,#0]
;;;1083   	data[1]=LPC_RTC->MIN;
00125a  f8980024          LDRB     r0,[r8,#0x24]
00125e  f88d0001          STRB     r0,[sp,#1]
;;;1084   	data[2]=LPC_RTC->SEC;
001262  f8980020          LDRB     r0,[r8,#0x20]
001266  f88d0002          STRB     r0,[sp,#2]
;;;1085   	data[3]=0;
00126a  f88d9003          STRB     r9,[sp,#3]
;;;1086   	lc640_write_long_ptr(lc640_adr+20,data);
00126e  4669              MOV      r1,sp
001270  f1050014          ADD      r0,r5,#0x14
001274  f7fffffe          BL       lc640_write_long_ptr
;;;1087   	
;;;1088   	data[0]='B';
001278  f88d7000          STRB     r7,[sp,#0]
;;;1089   	data[1]='B';
00127c  f88d7001          STRB     r7,[sp,#1]
;;;1090   	data[2]='B';
001280  f88d7002          STRB     r7,[sp,#2]
;;;1091   	data[3]='B';
001284  f88d7003          STRB     r7,[sp,#3]
;;;1092   	lc640_write_long_ptr(lc640_adr+24,data);
001288  4669              MOV      r1,sp
00128a  f1050018          ADD      r0,r5,#0x18
00128e  f7fffffe          BL       lc640_write_long_ptr
;;;1093   	
;;;1094   	data[0]='B';
001292  f88d7000          STRB     r7,[sp,#0]
;;;1095   	data[1]='B';
001296  f88d7001          STRB     r7,[sp,#1]
;;;1096   	data[2]='B';
00129a  f88d7002          STRB     r7,[sp,#2]
;;;1097   	data[3]='B';
00129e  f88d7003          STRB     r7,[sp,#3]
;;;1098   	lc640_write_long_ptr(lc640_adr+28,data);
0012a2  4669              MOV      r1,sp
0012a4  f105001c          ADD      r0,r5,#0x1c
0012a8  f7fffffe          BL       lc640_write_long_ptr
;;;1099   	
;;;1100   	snmp_trap_send("BAT #1 detected",5,1,0);
0012ac  2300              MOVS     r3,#0
0012ae  2201              MOVS     r2,#1
0012b0  2105              MOVS     r1,#5
0012b2  a055              ADR      r0,|L1.5128|
0012b4  f7fffffe          BL       snmp_trap_send
                  |L1.4792|
;;;1101   	
;;;1102   	}
;;;1103   	
;;;1104   avar_bat_ips_hndl_end:
;;;1105   __nop();		
0012b8  bf00              NOP      
                  |L1.4794|
;;;1106   }
0012ba  e56d              B        |L1.3480|
;;;1107   
                          ENDP

                  avar_bat_ips_hndl2 PROC
;;;1108   //-----------------------------------------------
;;;1109   void avar_bat_ips_hndl2(char in)
0012bc  e92d4ff8          PUSH     {r3-r11,lr}
;;;1110   {
0012c0  4602              MOV      r2,r0
;;;1111   char data[4];
;;;1112   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1113   
;;;1114   if(in==1)
;;;1115   	{
;;;1116   	bat_ips[1]._av|=1;
0012c2  4948              LDR      r1,|L1.5092|
;;;1117       ips_bat_av_stat[1]=1;
0012c4  4c48              LDR      r4,|L1.5096|
;;;1118   	ips_bat_av_vzvod[1]=1;
0012c6  4b49              LDR      r3,|L1.5100|
;;;1119   
;;;1120   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1121   	event_ptr++;	
;;;1122   	if(event_ptr>63)event_ptr=0;	
;;;1123   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1124   	
;;;1125   	event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1126   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1127   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1128   	
;;;1129   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1130   	
;;;1131   	data[0]='B';
;;;1132   	data[1]=1;
;;;1133   	data[2]='C';
;;;1134   	data[3]=0;
;;;1135   	lc640_write_long_ptr(lc640_adr,data);
;;;1136   
;;;1137   	data[0]=0;
;;;1138   	data[1]=0;
;;;1139   	data[2]=0;
;;;1140   	data[3]=0;
;;;1141   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1142   
;;;1143   	data[0]=LPC_RTC->YEAR;
0012c8  f8df8124          LDR      r8,|L1.5104|
0012cc  f8910091          LDRB     r0,[r1,#0x91]         ;1116
0012d0  f04f0742          MOV      r7,#0x42              ;1131
0012d4  f44f6660          MOV      r6,#0xe00             ;1120
0012d8  f04f0900          MOV      r9,#0                 ;1122
0012dc  f44f6a80          MOV      r10,#0x400            ;1129
0012e0  2a01              CMP      r2,#1                 ;1114
0012e2  d002              BEQ      |L1.4842|
;;;1144   	data[1]=LPC_RTC->MONTH;
;;;1145   	data[2]=LPC_RTC->DOM;
;;;1146   	data[3]=0;
;;;1147   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1148   
;;;1149   	data[0]=LPC_RTC->HOUR;
;;;1150   	data[1]=LPC_RTC->MIN;
;;;1151   	data[2]=LPC_RTC->SEC;
;;;1152   	data[3]=0;
;;;1153   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1154   	
;;;1155   	data[0]='A';
;;;1156   	data[1]='A';
;;;1157   	data[2]='A';
;;;1158   	data[3]='A';
;;;1159   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1160   	
;;;1161   	data[0]='A';
;;;1162   	data[1]='A';
;;;1163   	data[2]='A';
;;;1164   	data[3]='A';
;;;1165   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1166   	
;;;1167   	data[0]='A';
;;;1168   	data[1]='A';
;;;1169   	data[2]='A';
;;;1170   	data[3]='A';
;;;1171   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1172   	
;;;1173   	data[0]='A';
;;;1174   	data[1]='A';
;;;1175   	data[2]='A';
;;;1176   	data[3]='A';
;;;1177   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1178   					
;;;1179   	snmp_trap_send("BAT 2 Alarm, lost",5,2,1);
;;;1180   		
;;;1181   	}
;;;1182   
;;;1183   else if(in==0)
0012e4  2a00              CMP      r2,#0
0012e6  d079              BEQ      |L1.5084|
0012e8  e14c              B        |L1.5508|
                  |L1.4842|
0012ea  f0400001          ORR      r0,r0,#1              ;1116
0012ee  f8810091          STRB     r0,[r1,#0x91]         ;1116
0012f2  f04f0501          MOV      r5,#1                 ;1117
0012f6  7065              STRB     r5,[r4,#1]            ;1117
0012f8  705d              STRB     r5,[r3,#1]            ;1118
0012fa  4630              MOV      r0,r6                 ;1120
0012fc  f7fffffe          BL       lc640_read_int
001300  f1000001          ADD      r0,r0,#1              ;1121
001304  b284              UXTH     r4,r0                 ;1121
001306  2c3f              CMP      r4,#0x3f              ;1122
001308  d901              BLS      |L1.4878|
00130a  f04f0400          MOV      r4,#0                 ;1122
                  |L1.4878|
00130e  b221              SXTH     r1,r4                 ;1123
001310  4630              MOV      r0,r6                 ;1123
001312  f7fffffe          BL       lc640_write_int
001316  f6406b02          MOV      r11,#0xe02            ;1125
00131a  4658              MOV      r0,r11                ;1125
00131c  f7fffffe          BL       lc640_read_int
001320  b280              UXTH     r0,r0                 ;1125
001322  283f              CMP      r0,#0x3f              ;1126
001324  d000              BEQ      |L1.4904|
001326  4620              MOV      r0,r4                 ;1126
                  |L1.4904|
001328  b201              SXTH     r1,r0                 ;1127
00132a  4658              MOV      r0,r11                ;1127
00132c  f7fffffe          BL       lc640_write_int
001330  4630              MOV      r0,r6                 ;1129
001332  f7fffffe          BL       lc640_read_int
001336  eb0a1040          ADD      r0,r10,r0,LSL #5      ;1129
00133a  b284              UXTH     r4,r0                 ;1129
00133c  f88d7000          STRB     r7,[sp,#0]            ;1131
001340  f88d5001          STRB     r5,[sp,#1]            ;1132
001344  f04f0043          MOV      r0,#0x43              ;1133
001348  f88d0002          STRB     r0,[sp,#2]            ;1133
00134c  f88d9003          STRB     r9,[sp,#3]            ;1134
001350  4669              MOV      r1,sp                 ;1135
001352  4620              MOV      r0,r4                 ;1135
001354  f7fffffe          BL       lc640_write_long_ptr
001358  f8cd9000          STR      r9,[sp,#0]            ;1140
00135c  4669              MOV      r1,sp                 ;1141
00135e  1d20              ADDS     r0,r4,#4              ;1141
001360  f7fffffe          BL       lc640_write_long_ptr
001364  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1143
001368  f88d0000          STRB     r0,[sp,#0]            ;1143
00136c  f8980038          LDRB     r0,[r8,#0x38]         ;1144
001370  f88d0001          STRB     r0,[sp,#1]            ;1144
001374  f898002c          LDRB     r0,[r8,#0x2c]         ;1145
001378  f88d0002          STRB     r0,[sp,#2]            ;1145
00137c  f88d9003          STRB     r9,[sp,#3]            ;1146
001380  4669              MOV      r1,sp                 ;1147
001382  f1040008          ADD      r0,r4,#8              ;1147
001386  f7fffffe          BL       lc640_write_long_ptr
00138a  f8980028          LDRB     r0,[r8,#0x28]         ;1149
00138e  f88d0000          STRB     r0,[sp,#0]            ;1149
001392  f8980024          LDRB     r0,[r8,#0x24]         ;1150
001396  f88d0001          STRB     r0,[sp,#1]            ;1150
00139a  f8980020          LDRB     r0,[r8,#0x20]         ;1151
00139e  f88d0002          STRB     r0,[sp,#2]            ;1151
0013a2  f88d9003          STRB     r9,[sp,#3]            ;1152
0013a6  4669              MOV      r1,sp                 ;1153
0013a8  f104000c          ADD      r0,r4,#0xc            ;1153
0013ac  f7fffffe          BL       lc640_write_long_ptr
0013b0  f04f0541          MOV      r5,#0x41              ;1155
0013b4  f88d5000          STRB     r5,[sp,#0]            ;1155
0013b8  f88d5001          STRB     r5,[sp,#1]            ;1156
0013bc  f88d5002          STRB     r5,[sp,#2]            ;1157
0013c0  f88d5003          STRB     r5,[sp,#3]            ;1158
0013c4  4669              MOV      r1,sp                 ;1159
0013c6  f1040010          ADD      r0,r4,#0x10           ;1159
0013ca  f7fffffe          BL       lc640_write_long_ptr
0013ce  f88d5000          STRB     r5,[sp,#0]            ;1161
0013d2  f88d5001          STRB     r5,[sp,#1]            ;1162
0013d6  f88d5002          STRB     r5,[sp,#2]            ;1163
0013da  e01d              B        |L1.5144|
                  |L1.5084|
0013dc  e044              B        |L1.5224|
0013de  0000              DCW      0x0000
                  |L1.5088|
                          DCD      0x40024020
                  |L1.5092|
                          DCD      bat_ips
                  |L1.5096|
                          DCD      ips_bat_av_stat
                  |L1.5100|
                          DCD      ips_bat_av_vzvod
                  |L1.5104|
                          DCD      0x40024000
                  |L1.5108|
0013f4  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
0013f8  b9312041
0013fc  6c61726d
001400  2c206c6f
001404  737400  
001407  00                DCB      0
                  |L1.5128|
001408  42415420          DCB      "BAT #1 detected",0
00140c  23312064
001410  65746563
001414  74656400
                  |L1.5144|
001418  f88d5003          STRB     r5,[sp,#3]            ;1164
00141c  4669              MOV      r1,sp                 ;1165
00141e  f1040014          ADD      r0,r4,#0x14           ;1165
001422  f7fffffe          BL       lc640_write_long_ptr
001426  f88d5000          STRB     r5,[sp,#0]            ;1167
00142a  f88d5001          STRB     r5,[sp,#1]            ;1168
00142e  f88d5002          STRB     r5,[sp,#2]            ;1169
001432  f88d5003          STRB     r5,[sp,#3]            ;1170
001436  4669              MOV      r1,sp                 ;1171
001438  f1040018          ADD      r0,r4,#0x18           ;1171
00143c  f7fffffe          BL       lc640_write_long_ptr
001440  f88d5000          STRB     r5,[sp,#0]            ;1173
001444  f88d5001          STRB     r5,[sp,#1]            ;1174
001448  f88d5002          STRB     r5,[sp,#2]            ;1175
00144c  f88d5003          STRB     r5,[sp,#3]            ;1176
001450  4669              MOV      r1,sp                 ;1177
001452  f104001c          ADD      r0,r4,#0x1c           ;1177
001456  f7fffffe          BL       lc640_write_long_ptr
00145a  2301              MOVS     r3,#1                 ;1179
00145c  2202              MOVS     r2,#2                 ;1179
00145e  2105              MOVS     r1,#5                 ;1179
001460  a0ff              ADR      r0,|L1.6240|
001462  f7fffffe          BL       snmp_trap_send
001466  e08d              B        |L1.5508|
                  |L1.5224|
;;;1184   	{
;;;1185   	bat_ips[1]._av&=~1;
001468  f0200001          BIC      r0,r0,#1
00146c  f8810091          STRB     r0,[r1,#0x91]
;;;1186   	ips_bat_av_stat[1]=0;
001470  f8849001          STRB     r9,[r4,#1]
;;;1187   	ips_bat_av_vzvod[1]=0;
001474  f8839001          STRB     r9,[r3,#1]
;;;1188        
;;;1189   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
001478  4630              MOV      r0,r6
00147a  f7fffffe          BL       lc640_read_int
00147e  b286              UXTH     r6,r0
;;;1190   	event_ptr_find=event_ptr;
001480  4634              MOV      r4,r6
                  |L1.5250|
;;;1191   	
;;;1192   avar_bat2_ips_hndl_lbl1: 
;;;1193   
;;;1194   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001482  eb0a1044          ADD      r0,r10,r4,LSL #5
001486  b285              UXTH     r5,r0
;;;1195   
;;;1196        lc640_read_long_ptr(lc640_adr,data);
001488  4669              MOV      r1,sp
00148a  4628              MOV      r0,r5
00148c  f7fffffe          BL       lc640_read_long_ptr
;;;1197        
;;;1198        if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
001490  f89d0000          LDRB     r0,[sp,#0]
001494  2842              CMP      r0,#0x42
001496  d106              BNE      |L1.5286|
001498  f89d0001          LDRB     r0,[sp,#1]
00149c  b918              CBNZ     r0,|L1.5286|
00149e  f89d0002          LDRB     r0,[sp,#2]
0014a2  2843              CMP      r0,#0x43
0014a4  d009              BEQ      |L1.5306|
                  |L1.5286|
;;;1199        	{        
;;;1200        	if(event_ptr_find)event_ptr_find--;
0014a6  b11c              CBZ      r4,|L1.5296|
0014a8  f1a40401          SUB      r4,r4,#1
0014ac  b2a4              UXTH     r4,r4
0014ae  e001              B        |L1.5300|
                  |L1.5296|
;;;1201        	else event_ptr_find=63;
0014b0  f04f043f          MOV      r4,#0x3f
                  |L1.5300|
;;;1202        	if(event_ptr_find==event_ptr)goto avar_bat2_ips_hndl_end;
0014b4  42b4              CMP      r4,r6
0014b6  d1e4              BNE      |L1.5250|
0014b8  e064              B        |L1.5508|
                  |L1.5306|
;;;1203        	else goto avar_bat2_ips_hndl_lbl1;
;;;1204        	}
;;;1205        else 
;;;1206        	{
;;;1207        	lc640_read_long_ptr(lc640_adr+16,data);
0014ba  4669              MOV      r1,sp
0014bc  f1050010          ADD      r0,r5,#0x10
0014c0  f7fffffe          BL       lc640_read_long_ptr
;;;1208        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0014c4  f89d0000          LDRB     r0,[sp,#0]
0014c8  2841              CMP      r0,#0x41
0014ca  d10b              BNE      |L1.5348|
0014cc  f89d0001          LDRB     r0,[sp,#1]
0014d0  2841              CMP      r0,#0x41
0014d2  d107              BNE      |L1.5348|
0014d4  f89d0002          LDRB     r0,[sp,#2]
0014d8  2841              CMP      r0,#0x41
0014da  d103              BNE      |L1.5348|
0014dc  f89d0003          LDRB     r0,[sp,#3]
0014e0  2841              CMP      r0,#0x41
0014e2  d009              BEQ      |L1.5368|
                  |L1.5348|
;;;1209        		{        
;;;1210        		if(event_ptr_find)event_ptr_find--;
0014e4  b11c              CBZ      r4,|L1.5358|
0014e6  f1a40401          SUB      r4,r4,#1
0014ea  b2a4              UXTH     r4,r4
0014ec  e001              B        |L1.5362|
                  |L1.5358|
;;;1211            		else event_ptr_find=63;
0014ee  f04f043f          MOV      r4,#0x3f
                  |L1.5362|
;;;1212            	    	if(event_ptr_find==event_ptr)goto avar_bat2_ips_hndl_end;
0014f2  42b4              CMP      r4,r6
0014f4  d1c5              BNE      |L1.5250|
0014f6  e045              B        |L1.5508|
                  |L1.5368|
;;;1213        		else goto avar_bat2_ips_hndl_lbl1;
;;;1214        		}
;;;1215   
;;;1216        	}
;;;1217        		
;;;1218   	data[0]=LPC_RTC->YEAR;
0014f8  f8b8003c          LDRH     r0,[r8,#0x3c]
0014fc  f88d0000          STRB     r0,[sp,#0]
;;;1219   	data[1]=LPC_RTC->MONTH;
001500  f8980038          LDRB     r0,[r8,#0x38]
001504  f88d0001          STRB     r0,[sp,#1]
;;;1220   	data[2]=LPC_RTC->DOM;
001508  f898002c          LDRB     r0,[r8,#0x2c]
00150c  f88d0002          STRB     r0,[sp,#2]
;;;1221   	data[3]=0;
001510  f88d9003          STRB     r9,[sp,#3]
;;;1222   	lc640_write_long_ptr(lc640_adr+16,data);
001514  4669              MOV      r1,sp
001516  f1050010          ADD      r0,r5,#0x10
00151a  f7fffffe          BL       lc640_write_long_ptr
;;;1223   
;;;1224   	data[0]=LPC_RTC->HOUR;
00151e  f8980028          LDRB     r0,[r8,#0x28]
001522  f88d0000          STRB     r0,[sp,#0]
;;;1225   	data[1]=LPC_RTC->MIN;
001526  f8980024          LDRB     r0,[r8,#0x24]
00152a  f88d0001          STRB     r0,[sp,#1]
;;;1226   	data[2]=LPC_RTC->SEC;
00152e  f8980020          LDRB     r0,[r8,#0x20]
001532  f88d0002          STRB     r0,[sp,#2]
;;;1227   	data[3]=0;
001536  f88d9003          STRB     r9,[sp,#3]
;;;1228   	lc640_write_long_ptr(lc640_adr+20,data);
00153a  4669              MOV      r1,sp
00153c  f1050014          ADD      r0,r5,#0x14
001540  f7fffffe          BL       lc640_write_long_ptr
;;;1229   	
;;;1230   	data[0]='B';
001544  f88d7000          STRB     r7,[sp,#0]
;;;1231   	data[1]='B';
001548  f88d7001          STRB     r7,[sp,#1]
;;;1232   	data[2]='B';
00154c  f88d7002          STRB     r7,[sp,#2]
;;;1233   	data[3]='B';
001550  f88d7003          STRB     r7,[sp,#3]
;;;1234   	lc640_write_long_ptr(lc640_adr+24,data);
001554  4669              MOV      r1,sp
001556  f1050018          ADD      r0,r5,#0x18
00155a  f7fffffe          BL       lc640_write_long_ptr
;;;1235   	
;;;1236   	data[0]='B';
00155e  f88d7000          STRB     r7,[sp,#0]
;;;1237   	data[1]='B';
001562  f88d7001          STRB     r7,[sp,#1]
;;;1238   	data[2]='B';
001566  f88d7002          STRB     r7,[sp,#2]
;;;1239   	data[3]='B';
00156a  f88d7003          STRB     r7,[sp,#3]
;;;1240   	lc640_write_long_ptr(lc640_adr+28,data);
00156e  4669              MOV      r1,sp
001570  f105001c          ADD      r0,r5,#0x1c
001574  f7fffffe          BL       lc640_write_long_ptr
;;;1241   	
;;;1242   	snmp_trap_send("BAT #2 detected",5,2,0);
001578  2300              MOVS     r3,#0
00157a  2202              MOVS     r2,#2
00157c  2105              MOVS     r1,#5
00157e  a0bd              ADR      r0,|L1.6260|
001580  f7fffffe          BL       snmp_trap_send
                  |L1.5508|
;;;1243   	
;;;1244   	}
;;;1245   	
;;;1246   avar_bat2_ips_hndl_end:
;;;1247   __nop();		
001584  bf00              NOP      
                  |L1.5510|
;;;1248   }
001586  e407              B        |L1.3480|
;;;1249   #endif
                          ENDP

                  avar_bat_hndl PROC
;;;1251   //-----------------------------------------------
;;;1252   void avar_bat_hndl(char b, char in)
001588  4770              BX       lr
;;;1253   {
;;;1254   char data[4];
;;;1255   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1256   #ifndef UKU_220_IPS_TERMOKOMPENSAT	 //o_10
;;;1257   if(in==1)
;;;1258   	{
;;;1259   	bat[b]._av|=1;
;;;1260       
;;;1261   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1262   	event_ptr++;	
;;;1263   	if(event_ptr>63)event_ptr=0;	
;;;1264   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1265   	
;;;1266        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1267   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1268   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1269   	
;;;1270   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1271   	
;;;1272   	data[0]='B';
;;;1273   	data[1]=b;
;;;1274   	data[2]='C';
;;;1275   	data[3]=0;
;;;1276   	lc640_write_long_ptr(lc640_adr,data);
;;;1277   
;;;1278   	data[0]=0;
;;;1279   	data[1]=0;
;;;1280   	data[2]=0;
;;;1281   	data[3]=0;
;;;1282   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1283   
;;;1284   	data[0]=LPC_RTC->YEAR;
;;;1285   	data[1]=LPC_RTC->MONTH;
;;;1286   	data[2]=LPC_RTC->DOM;
;;;1287   	data[3]=0;
;;;1288   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1289   
;;;1290   	data[0]=LPC_RTC->HOUR;
;;;1291   	data[1]=LPC_RTC->MIN;
;;;1292   	data[2]=LPC_RTC->SEC;
;;;1293   	data[3]=0;
;;;1294   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1295   	
;;;1296   	data[0]='A';
;;;1297   	data[1]='A';
;;;1298   	data[2]='A';
;;;1299   	data[3]='A';
;;;1300   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1301   	
;;;1302   	data[0]='A';
;;;1303   	data[1]='A';
;;;1304   	data[2]='A';
;;;1305   	data[3]='A';
;;;1306   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1307   	
;;;1308   	data[0]='A';
;;;1309   	data[1]='A';
;;;1310   	data[2]='A';
;;;1311   	data[3]='A';
;;;1312   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1313   	
;;;1314   	data[0]='A';
;;;1315   	data[1]='A';
;;;1316   	data[2]='A';
;;;1317   	data[3]='A';
;;;1318   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1319   					
;;;1320   	if(b==0)
;;;1321   		{
;;;1322   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1323   		}
;;;1324   	else if(b==1)
;;;1325   		{
;;;1326   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1327   		} 
;;;1328   			
;;;1329   	}
;;;1330   
;;;1331   else if(in==0)
;;;1332   	{
;;;1333   	bat[b]._av&=~1;
;;;1334   
;;;1335        event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1336   	event_ptr_find=event_ptr;
;;;1337   	
;;;1338   avar_bat_hndl_lbl1: 
;;;1339   
;;;1340   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1341   
;;;1342        lc640_read_long_ptr(lc640_adr,data);
;;;1343        
;;;1344        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
;;;1345        	{        
;;;1346        	if(event_ptr_find)event_ptr_find--;
;;;1347        	else event_ptr_find=63;
;;;1348        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
;;;1349        	else goto avar_bat_hndl_lbl1;
;;;1350        	}
;;;1351        else 
;;;1352        	{
;;;1353        	lc640_read_long_ptr(lc640_adr+16,data);
;;;1354        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1355        		{        
;;;1356        		if(event_ptr_find)event_ptr_find--;
;;;1357            		else event_ptr_find=63;
;;;1358            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
;;;1359        		else goto avar_bat_hndl_lbl1;
;;;1360        		}
;;;1361   
;;;1362        	}
;;;1363        		
;;;1364   	data[0]=LPC_RTC->YEAR;
;;;1365   	data[1]=LPC_RTC->MONTH;
;;;1366   	data[2]=LPC_RTC->DOM;
;;;1367   	data[3]=0;
;;;1368   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1369   
;;;1370   	data[0]=LPC_RTC->HOUR;
;;;1371   	data[1]=LPC_RTC->MIN;
;;;1372   	data[2]=LPC_RTC->SEC;
;;;1373   	data[3]=0;
;;;1374   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1375   	
;;;1376   	data[0]='B';
;;;1377   	data[1]='B';
;;;1378   	data[2]='B';
;;;1379   	data[3]='B';
;;;1380   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1381   	
;;;1382   	data[0]='B';
;;;1383   	data[1]='B';
;;;1384   	data[2]='B';
;;;1385   	data[3]='B';
;;;1386   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1387   	
;;;1388   	if(b==0)
;;;1389   		{
;;;1390   		snmp_trap_send("BAT #1 detected",5,1,0);
;;;1391   		}
;;;1392   	else if(b==1)
;;;1393   		{
;;;1394   		snmp_trap_send("BAT #2 detected",5,2,0);
;;;1395   		}
;;;1396   	
;;;1397   	}
;;;1398   	
;;;1399   avar_bat_hndl_end:
;;;1400   __nop();
;;;1401   #endif    //o_10		
;;;1402   }
;;;1403   
                          ENDP

                  avar_bat_temper_hndl PROC
;;;1404   //-----------------------------------------------
;;;1405   void avar_bat_temper_hndl(char b, char in)
00158a  e92d4ff8          PUSH     {r3-r11,lr}
;;;1406   {
00158e  4605              MOV      r5,r0
001590  460e              MOV      r6,r1
;;;1407   char data[4];
;;;1408   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1409   
;;;1410   if((in==1)||(in==3))
;;;1411   	{
;;;1412   	//bat[b]._av|=1;
;;;1413       
;;;1414   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1415   	event_ptr++;	
;;;1416   	if(event_ptr>63)event_ptr=0;	
;;;1417   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1418   	
;;;1419        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1420   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1421   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1422   	
;;;1423   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1424   	
;;;1425   	data[0]='B';
;;;1426   	data[1]=b;
;;;1427   	data[2]='T';
;;;1428   	data[3]='1';
;;;1429   	if(in==3)data[3]='3';
;;;1430   	lc640_write_long_ptr(lc640_adr,data);
;;;1431   
;;;1432   	data[0]=0;
;;;1433   	data[1]=0;
;;;1434   	data[2]=0;
;;;1435   	data[3]=0;
;;;1436   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1437   
;;;1438   	data[0]=LPC_RTC->YEAR;
001592  f8dfa2f0          LDR      r10,|L1.6276|
001596  f44f6060          MOV      r0,#0xe00             ;1414
00159a  f44f6780          MOV      r7,#0x400             ;1423
00159e  2e01              CMP      r6,#1                 ;1410
0015a0  d010              BEQ      |L1.5572|
0015a2  2e03              CMP      r6,#3                 ;1410
0015a4  d00e              BEQ      |L1.5572|
;;;1439   	data[1]=LPC_RTC->MONTH;
;;;1440   	data[2]=LPC_RTC->DOM;
;;;1441   	data[3]=0;
;;;1442   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1443   
;;;1444   	data[0]=LPC_RTC->HOUR;
;;;1445   	data[1]=LPC_RTC->MIN;
;;;1446   	data[2]=LPC_RTC->SEC;
;;;1447   	data[3]=0;
;;;1448   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1449   	
;;;1450   	data[0]='A';
;;;1451   	data[1]='A';
;;;1452   	data[2]='A';
;;;1453   	data[3]='A';
;;;1454   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1455   	
;;;1456   	data[0]='A';
;;;1457   	data[1]='A';
;;;1458   	data[2]='A';
;;;1459   	data[3]='A';
;;;1460   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1461   	
;;;1462   	data[0]='A';
;;;1463   	data[1]='A';
;;;1464   	data[2]='A';
;;;1465   	data[3]='A';
;;;1466   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1467   	
;;;1468   	data[0]='A';
;;;1469   	data[1]='A';
;;;1470   	data[2]='A';
;;;1471   	data[3]='A';
;;;1472   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1473   	if(in==1)
;;;1474   		{				
;;;1475   		if(b==0)
;;;1476   			{
;;;1477   			snmp_trap_send("BAT #1 Alarm, is heated",10,1,1);
;;;1478   			}
;;;1479   		else if(b==1)
;;;1480   			{
;;;1481   			snmp_trap_send("BAT #2 Alarm, is heated",10,2,1);
;;;1482   			} 
;;;1483   		}
;;;1484   	if(in==3)
;;;1485   		{				
;;;1486   		if(b==0)
;;;1487   			{
;;;1488   			snmp_trap_send("BAT #1 Alarm, is overheated",11,1,1);
;;;1489   			}
;;;1490   		else if(b==1)
;;;1491   			{
;;;1492   			snmp_trap_send("BAT #2 Alarm, is overheated",11,2,1);
;;;1493   			} 
;;;1494   		}			
;;;1495   	}
;;;1496   
;;;1497   else if((in==0)||(in==2))
0015a6  b10e              CBZ      r6,|L1.5548|
0015a8  2e02              CMP      r6,#2
0015aa  d17e              BNE      |L1.5802|
                  |L1.5548|
;;;1498   	{
;;;1499   	char i;
;;;1500   
;;;1501   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0015ac  f7fffffe          BL       lc640_read_int
0015b0  fa1ff980          UXTH     r9,r0
;;;1502   	event_ptr_find=event_ptr;
0015b4  464c              MOV      r4,r9
;;;1503   
;;;1504   /*	for (i=0;i<63;i++)
;;;1505   		{
;;;1506   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1507   
;;;1508        	lc640_read_long_ptr(lc640_adr,data);
;;;1509        
;;;1510        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;1511        		{        
;;;1512        		if(event_ptr_find)event_ptr_find--;
;;;1513        		else event_ptr_find=63;
;;;1514        		if(event_ptr_find==event_ptr)
;;;1515   				{
;;;1516   				lc640_adr=0;
;;;1517   				break;
;;;1518   				}
;;;1519        		else continue;
;;;1520        		}
;;;1521        	else 
;;;1522        		{
;;;1523        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1524        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1525        			{        
;;;1526        			if(event_ptr_find)event_ptr_find--;
;;;1527            		else event_ptr_find=63;
;;;1528            		if(event_ptr_find==event_ptr)
;;;1529   					{
;;;1530   					lc640_adr=0;
;;;1531   					break;
;;;1532   					}
;;;1533        			else continue;
;;;1534        			}
;;;1535        		}	
;;;1536   		}*/
;;;1537   	
;;;1538   	for (i=0;i<63;i++)
0015b6  f04f0800          MOV      r8,#0
                  |L1.5562|
;;;1539   		{
;;;1540   		char temp='1';
0015ba  f04f0b31          MOV      r11,#0x31
;;;1541   		if(in==2)temp='3';
0015be  2e02              CMP      r6,#2
0015c0  d074              BEQ      |L1.5804|
0015c2  e0c7              B        |L1.5972|
                  |L1.5572|
0015c4  4680              MOV      r8,r0                 ;1414
0015c6  f7fffffe          BL       lc640_read_int
0015ca  f1000001          ADD      r0,r0,#1              ;1415
0015ce  b284              UXTH     r4,r0                 ;1415
0015d0  2c3f              CMP      r4,#0x3f              ;1416
0015d2  d901              BLS      |L1.5592|
0015d4  f04f0400          MOV      r4,#0                 ;1416
                  |L1.5592|
0015d8  b221              SXTH     r1,r4                 ;1417
0015da  4640              MOV      r0,r8                 ;1417
0015dc  f7fffffe          BL       lc640_write_int
0015e0  f6406902          MOV      r9,#0xe02             ;1419
0015e4  4648              MOV      r0,r9                 ;1419
0015e6  f7fffffe          BL       lc640_read_int
0015ea  b280              UXTH     r0,r0                 ;1419
0015ec  283f              CMP      r0,#0x3f              ;1420
0015ee  d000              BEQ      |L1.5618|
0015f0  4620              MOV      r0,r4                 ;1420
                  |L1.5618|
0015f2  b201              SXTH     r1,r0                 ;1421
0015f4  4648              MOV      r0,r9                 ;1421
0015f6  f7fffffe          BL       lc640_write_int
0015fa  4640              MOV      r0,r8                 ;1423
0015fc  f7fffffe          BL       lc640_read_int
001600  eb071040          ADD      r0,r7,r0,LSL #5       ;1423
001604  b284              UXTH     r4,r0                 ;1423
001606  f04f0042          MOV      r0,#0x42              ;1425
00160a  f88d0000          STRB     r0,[sp,#0]            ;1425
00160e  f88d5001          STRB     r5,[sp,#1]            ;1426
001612  f04f0054          MOV      r0,#0x54              ;1427
001616  f88d0002          STRB     r0,[sp,#2]            ;1427
00161a  f04f0031          MOV      r0,#0x31              ;1428
00161e  f88d0003          STRB     r0,[sp,#3]            ;1428
001622  2e03              CMP      r6,#3                 ;1429
001624  d103              BNE      |L1.5678|
001626  f04f0033          MOV      r0,#0x33              ;1429
00162a  f88d0003          STRB     r0,[sp,#3]            ;1429
                  |L1.5678|
00162e  4669              MOV      r1,sp                 ;1430
001630  4620              MOV      r0,r4                 ;1430
001632  f7fffffe          BL       lc640_write_long_ptr
001636  f04f0700          MOV      r7,#0                 ;1432
00163a  9700              STR      r7,[sp,#0]            ;1435
00163c  4669              MOV      r1,sp                 ;1436
00163e  f1040004          ADD      r0,r4,#4              ;1436
001642  f7fffffe          BL       lc640_write_long_ptr
001646  f8ba003c          LDRH     r0,[r10,#0x3c]        ;1438
00164a  f88d0000          STRB     r0,[sp,#0]            ;1438
00164e  f89a0038          LDRB     r0,[r10,#0x38]        ;1439
001652  f88d0001          STRB     r0,[sp,#1]            ;1439
001656  f89a002c          LDRB     r0,[r10,#0x2c]        ;1440
00165a  f88d0002          STRB     r0,[sp,#2]            ;1440
00165e  f88d7003          STRB     r7,[sp,#3]            ;1441
001662  4669              MOV      r1,sp                 ;1442
001664  f1040008          ADD      r0,r4,#8              ;1442
001668  f7fffffe          BL       lc640_write_long_ptr
00166c  f89a0028          LDRB     r0,[r10,#0x28]        ;1444
001670  f88d0000          STRB     r0,[sp,#0]            ;1444
001674  f89a0024          LDRB     r0,[r10,#0x24]        ;1445
001678  f88d0001          STRB     r0,[sp,#1]            ;1445
00167c  f89a0020          LDRB     r0,[r10,#0x20]        ;1446
001680  f88d0002          STRB     r0,[sp,#2]            ;1446
001684  f88d7003          STRB     r7,[sp,#3]            ;1447
001688  4669              MOV      r1,sp                 ;1448
00168a  f104000c          ADD      r0,r4,#0xc            ;1448
00168e  f7fffffe          BL       lc640_write_long_ptr
001692  f04f0741          MOV      r7,#0x41              ;1450
001696  f88d7000          STRB     r7,[sp,#0]            ;1450
00169a  f88d7001          STRB     r7,[sp,#1]            ;1451
00169e  f88d7002          STRB     r7,[sp,#2]            ;1452
0016a2  f88d7003          STRB     r7,[sp,#3]            ;1453
0016a6  4669              MOV      r1,sp                 ;1454
0016a8  e001              B        |L1.5806|
                  |L1.5802|
0016aa  e049              B        |L1.5952|
                  |L1.5804|
0016ac  e050              B        |L1.5968|
                  |L1.5806|
0016ae  f1040010          ADD      r0,r4,#0x10           ;1454
0016b2  f7fffffe          BL       lc640_write_long_ptr
0016b6  f88d7000          STRB     r7,[sp,#0]            ;1456
0016ba  f88d7001          STRB     r7,[sp,#1]            ;1457
0016be  f88d7002          STRB     r7,[sp,#2]            ;1458
0016c2  f88d7003          STRB     r7,[sp,#3]            ;1459
0016c6  4669              MOV      r1,sp                 ;1460
0016c8  f1040014          ADD      r0,r4,#0x14           ;1460
0016cc  f7fffffe          BL       lc640_write_long_ptr
0016d0  f88d7000          STRB     r7,[sp,#0]            ;1462
0016d4  f88d7001          STRB     r7,[sp,#1]            ;1463
0016d8  f88d7002          STRB     r7,[sp,#2]            ;1464
0016dc  f88d7003          STRB     r7,[sp,#3]            ;1465
0016e0  4669              MOV      r1,sp                 ;1466
0016e2  f1040018          ADD      r0,r4,#0x18           ;1466
0016e6  f7fffffe          BL       lc640_write_long_ptr
0016ea  f88d7000          STRB     r7,[sp,#0]            ;1468
0016ee  f88d7001          STRB     r7,[sp,#1]            ;1469
0016f2  f88d7002          STRB     r7,[sp,#2]            ;1470
0016f6  f88d7003          STRB     r7,[sp,#3]            ;1471
0016fa  4669              MOV      r1,sp                 ;1472
0016fc  f104001c          ADD      r0,r4,#0x1c           ;1472
001700  f7fffffe          BL       lc640_write_long_ptr
001704  2e01              CMP      r6,#1                 ;1473
001706  d110              BNE      |L1.5930|
001708  b115              CBZ      r5,|L1.5904|
00170a  2d01              CMP      r5,#1                 ;1479
00170c  d007              BEQ      |L1.5918|
00170e  e00c              B        |L1.5930|
                  |L1.5904|
001710  2301              MOVS     r3,#1                 ;1477
001712  461a              MOV      r2,r3                 ;1477
001714  210a              MOVS     r1,#0xa               ;1477
001716  a05c              ADR      r0,|L1.6280|
001718  f7fffffe          BL       snmp_trap_send
00171c  e005              B        |L1.5930|
                  |L1.5918|
00171e  2301              MOVS     r3,#1                 ;1481
001720  2202              MOVS     r2,#2                 ;1481
001722  210a              MOVS     r1,#0xa               ;1481
001724  a05e              ADR      r0,|L1.6304|
001726  f7fffffe          BL       snmp_trap_send
                  |L1.5930|
00172a  2e03              CMP      r6,#3                 ;1484
00172c  d108              BNE      |L1.5952|
00172e  b145              CBZ      r5,|L1.5954|
001730  2d01              CMP      r5,#1                 ;1490
001732  d105              BNE      |L1.5952|
001734  2301              MOVS     r3,#1                 ;1492
001736  2202              MOVS     r2,#2                 ;1492
001738  210b              MOVS     r1,#0xb               ;1492
00173a  a05f              ADR      r0,|L1.6328|
00173c  f7fffffe          BL       snmp_trap_send
                  |L1.5952|
;;;1542   
;;;1543   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1544   
;;;1545        	lc640_read_long_ptr(lc640_adr,data);
;;;1546        
;;;1547        	if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='T')&&(data[3]==temp)))
;;;1548        		{        
;;;1549        		if(event_ptr_find)event_ptr_find--;
;;;1550        		else event_ptr_find=63;
;;;1551        		if(event_ptr_find==event_ptr)				{
;;;1552   				lc640_adr=0;
;;;1553   				break;
;;;1554   				}
;;;1555        		else continue;
;;;1556        		}
;;;1557   	     else 
;;;1558   	     	{
;;;1559   	     	lc640_read_long_ptr(lc640_adr+16,data);
;;;1560   	     	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1561   	     		{        
;;;1562   	     		if(event_ptr_find)event_ptr_find--;
;;;1563   	         	else event_ptr_find=63;
;;;1564   	         	if(event_ptr_find==event_ptr)				{
;;;1565   					lc640_adr=0;
;;;1566   					break;
;;;1567   					}
;;;1568   	     		else continue;
;;;1569   	     		}
;;;1570   	
;;;1571   	     	}
;;;1572   		}
;;;1573        		
;;;1574   	data[0]=LPC_RTC->YEAR;
;;;1575   	data[1]=LPC_RTC->MONTH;
;;;1576   	data[2]=LPC_RTC->DOM;
;;;1577   	data[3]=0;
;;;1578   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1579   
;;;1580   	data[0]=LPC_RTC->HOUR;
;;;1581   	data[1]=LPC_RTC->MIN;
;;;1582   	data[2]=LPC_RTC->SEC;
;;;1583   	data[3]=0;
;;;1584   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1585   	
;;;1586   	data[0]='B';
;;;1587   	data[1]='B';
;;;1588   	data[2]='B';
;;;1589   	data[3]='B';
;;;1590   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1591   	
;;;1592   	data[0]='B';
;;;1593   	data[1]='B';
;;;1594   	data[2]='B';
;;;1595   	data[3]='B';
;;;1596   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1597   	
;;;1598   	if(in==0)
;;;1599   		{				
;;;1600   		if(b==0)
;;;1601   			{
;;;1602   			snmp_trap_send("BAT #1 Alarm, heating eliminated",10,1,0);
;;;1603   			}
;;;1604   		else if(b==1)
;;;1605   			{
;;;1606   			snmp_trap_send("BAT #2 Alarm, heating eliminated",10,2,0);
;;;1607   			} 
;;;1608   		}
;;;1609   	if(in==2)
;;;1610   		{				
;;;1611   		if(b==0)
;;;1612   			{
;;;1613   			snmp_trap_send("BAT #1 Alarm, overheating eliminated",11,1,0);
;;;1614   			}
;;;1615   		else if(b==1)
;;;1616   			{
;;;1617   			snmp_trap_send("BAT #2 Alarm, overheating eliminated",11,2,0);
;;;1618   			} 
;;;1619   		}		
;;;1620   	
;;;1621   	}
;;;1622   	
;;;1623   }
001740  e5bb              B        |L1.4794|
                  |L1.5954|
001742  2301              MOVS     r3,#1                 ;1488
001744  461a              MOV      r2,r3                 ;1488
001746  210b              MOVS     r1,#0xb               ;1488
001748  a062              ADR      r0,|L1.6356|
00174a  f7fffffe          BL       snmp_trap_send
00174e  e5b4              B        |L1.4794|
                  |L1.5968|
001750  f04f0b33          MOV      r11,#0x33             ;1541
                  |L1.5972|
001754  f44f6080          MOV      r0,#0x400             ;1543
001758  eb001044          ADD      r0,r0,r4,LSL #5       ;1543
00175c  b287              UXTH     r7,r0                 ;1543
00175e  4669              MOV      r1,sp                 ;1545
001760  4638              MOV      r0,r7                 ;1545
001762  f7fffffe          BL       lc640_read_long_ptr
001766  f89d0000          LDRB     r0,[sp,#0]            ;1547
00176a  2842              CMP      r0,#0x42              ;1547
00176c  d10b              BNE      |L1.6022|
00176e  f89d0001          LDRB     r0,[sp,#1]            ;1547
001772  42a8              CMP      r0,r5                 ;1547
001774  d107              BNE      |L1.6022|
001776  f89d0002          LDRB     r0,[sp,#2]            ;1547
00177a  2854              CMP      r0,#0x54              ;1547
00177c  d103              BNE      |L1.6022|
00177e  f89d0003          LDRB     r0,[sp,#3]            ;1547
001782  4558              CMP      r0,r11                ;1547
001784  d00b              BEQ      |L1.6046|
                  |L1.6022|
001786  b11c              CBZ      r4,|L1.6032|
001788  f1a40401          SUB      r4,r4,#1              ;1549
00178c  b2a4              UXTH     r4,r4                 ;1549
00178e  e001              B        |L1.6036|
                  |L1.6032|
001790  f04f043f          MOV      r4,#0x3f              ;1550
                  |L1.6036|
001794  454c              CMP      r4,r9                 ;1551
001796  d123              BNE      |L1.6112|
001798  f04f0700          MOV      r7,#0                 ;1552
00179c  e028              B        |L1.6128|
                  |L1.6046|
00179e  4669              MOV      r1,sp                 ;1559
0017a0  f1070010          ADD      r0,r7,#0x10           ;1559
0017a4  f7fffffe          BL       lc640_read_long_ptr
0017a8  f89d0000          LDRB     r0,[sp,#0]            ;1560
0017ac  2841              CMP      r0,#0x41              ;1560
0017ae  d10b              BNE      |L1.6088|
0017b0  f89d0001          LDRB     r0,[sp,#1]            ;1560
0017b4  2841              CMP      r0,#0x41              ;1560
0017b6  d107              BNE      |L1.6088|
0017b8  f89d0002          LDRB     r0,[sp,#2]            ;1560
0017bc  2841              CMP      r0,#0x41              ;1560
0017be  d103              BNE      |L1.6088|
0017c0  f89d0003          LDRB     r0,[sp,#3]            ;1560
0017c4  2841              CMP      r0,#0x41              ;1560
0017c6  d00b              BEQ      |L1.6112|
                  |L1.6088|
0017c8  b11c              CBZ      r4,|L1.6098|
0017ca  f1a40401          SUB      r4,r4,#1              ;1562
0017ce  b2a4              UXTH     r4,r4                 ;1562
0017d0  e001              B        |L1.6102|
                  |L1.6098|
0017d2  f04f043f          MOV      r4,#0x3f              ;1563
                  |L1.6102|
0017d6  454c              CMP      r4,r9                 ;1564
0017d8  d102              BNE      |L1.6112|
0017da  f04f0700          MOV      r7,#0                 ;1565
0017de  e007              B        |L1.6128|
                  |L1.6112|
0017e0  f1080801          ADD      r8,r8,#1              ;1538
0017e4  f00808ff          AND      r8,r8,#0xff           ;1538
0017e8  f1b80f3f          CMP      r8,#0x3f              ;1538
0017ec  f4ffaee5          BCC      |L1.5562|
                  |L1.6128|
0017f0  f8ba003c          LDRH     r0,[r10,#0x3c]        ;1574
0017f4  f88d0000          STRB     r0,[sp,#0]            ;1574
0017f8  f89a0038          LDRB     r0,[r10,#0x38]        ;1575
0017fc  f88d0001          STRB     r0,[sp,#1]            ;1575
001800  f89a002c          LDRB     r0,[r10,#0x2c]        ;1576
001804  f88d0002          STRB     r0,[sp,#2]            ;1576
001808  f04f0400          MOV      r4,#0                 ;1577
00180c  f88d4003          STRB     r4,[sp,#3]            ;1577
001810  4669              MOV      r1,sp                 ;1578
001812  f1070010          ADD      r0,r7,#0x10           ;1578
001816  f7fffffe          BL       lc640_write_long_ptr
00181a  f89a0028          LDRB     r0,[r10,#0x28]        ;1580
00181e  f88d0000          STRB     r0,[sp,#0]            ;1580
001822  f89a0024          LDRB     r0,[r10,#0x24]        ;1581
001826  f88d0001          STRB     r0,[sp,#1]            ;1581
00182a  f89a0020          LDRB     r0,[r10,#0x20]        ;1582
00182e  f88d0002          STRB     r0,[sp,#2]            ;1582
001832  f88d4003          STRB     r4,[sp,#3]            ;1583
001836  4669              MOV      r1,sp                 ;1584
001838  f1070014          ADD      r0,r7,#0x14           ;1584
00183c  f7fffffe          BL       lc640_write_long_ptr
001840  f04f0442          MOV      r4,#0x42              ;1586
001844  f88d4000          STRB     r4,[sp,#0]            ;1586
001848  f88d4001          STRB     r4,[sp,#1]            ;1587
00184c  f88d4002          STRB     r4,[sp,#2]            ;1588
001850  f88d4003          STRB     r4,[sp,#3]            ;1589
001854  4669              MOV      r1,sp                 ;1590
001856  f1070018          ADD      r0,r7,#0x18           ;1590
00185a  f7fffffe          BL       lc640_write_long_ptr
00185e  e047              B        |L1.6384|
                  |L1.6240|
001860  42415420          DCB      "BAT ",185,"2 Alarm, lost",0
001864  b9322041
001868  6c61726d
00186c  2c206c6f
001870  737400  
001873  00                DCB      0
                  |L1.6260|
001874  42415420          DCB      "BAT #2 detected",0
001878  23322064
00187c  65746563
001880  74656400
                  |L1.6276|
                          DCD      0x40024000
                  |L1.6280|
001888  42415420          DCB      "BAT #1 Alarm, is heated",0
00188c  23312041
001890  6c61726d
001894  2c206973
001898  20686561
00189c  74656400
                  |L1.6304|
0018a0  42415420          DCB      "BAT #2 Alarm, is heated",0
0018a4  23322041
0018a8  6c61726d
0018ac  2c206973
0018b0  20686561
0018b4  74656400
                  |L1.6328|
0018b8  42415420          DCB      "BAT #2 Alarm, is overheated",0
0018bc  23322041
0018c0  6c61726d
0018c4  2c206973
0018c8  206f7665
0018cc  72686561
0018d0  74656400
                  |L1.6356|
0018d4  42415420          DCB      "BAT #1 Alarm, is overheated",0
0018d8  23312041
0018dc  6c61726d
0018e0  2c206973
0018e4  206f7665
0018e8  72686561
0018ec  74656400
                  |L1.6384|
0018f0  f88d4000          STRB     r4,[sp,#0]            ;1592
0018f4  f88d4001          STRB     r4,[sp,#1]            ;1593
0018f8  f88d4002          STRB     r4,[sp,#2]            ;1594
0018fc  f88d4003          STRB     r4,[sp,#3]            ;1595
001900  4669              MOV      r1,sp                 ;1596
001902  f107001c          ADD      r0,r7,#0x1c           ;1596
001906  f7fffffe          BL       lc640_write_long_ptr
00190a  b986              CBNZ     r6,|L1.6446|
00190c  b115              CBZ      r5,|L1.6420|
00190e  2d01              CMP      r5,#1                 ;1604
001910  d007              BEQ      |L1.6434|
001912  e00c              B        |L1.6446|
                  |L1.6420|
001914  2300              MOVS     r3,#0                 ;1602
001916  2201              MOVS     r2,#1                 ;1602
001918  210a              MOVS     r1,#0xa               ;1602
00191a  a0ea              ADR      r0,|L1.7364|
00191c  f7fffffe          BL       snmp_trap_send
001920  e005              B        |L1.6446|
                  |L1.6434|
001922  2300              MOVS     r3,#0                 ;1606
001924  2202              MOVS     r2,#2                 ;1606
001926  210a              MOVS     r1,#0xa               ;1606
001928  a0ef              ADR      r0,|L1.7400|
00192a  f7fffffe          BL       snmp_trap_send
                  |L1.6446|
00192e  2e02              CMP      r6,#2                 ;1609
                  |L1.6448|
001930  f47faf06          BNE      |L1.5952|
001934  b145              CBZ      r5,|L1.6472|
001936  2d01              CMP      r5,#1                 ;1615
001938  d1fa              BNE      |L1.6448|
00193a  2300              MOVS     r3,#0                 ;1617
00193c  2202              MOVS     r2,#2                 ;1617
00193e  210b              MOVS     r1,#0xb               ;1617
001940  a0f2              ADR      r0,|L1.7436|
001942  f7fffffe          BL       snmp_trap_send
                  |L1.6470|
001946  e4b8              B        |L1.4794|
                  |L1.6472|
001948  2300              MOVS     r3,#0                 ;1613
00194a  2201              MOVS     r2,#1                 ;1613
00194c  210b              MOVS     r1,#0xb               ;1613
00194e  a0f9              ADR      r0,|L1.7476|
001950  f7fffffe          BL       snmp_trap_send
001954  e4b1              B        |L1.4794|
;;;1624   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1625   //-----------------------------------------------
;;;1626   void avar_bat_as_hndl(char b, char in)
001956  e92d4ff8          PUSH     {r3-r11,lr}
;;;1627   {
00195a  4605              MOV      r5,r0
;;;1628   char data[4];
;;;1629   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1630   
;;;1631   if(in==1)
;;;1632   	{
;;;1633   	bat[b]._av|=2;
00195c  48ff              LDR      r0,|L1.7516|
;;;1634       
;;;1635   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1636   	event_ptr++;	
;;;1637   	if(event_ptr>63)event_ptr=0;	
;;;1638   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1639   	
;;;1640        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1641   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1642   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1643   	
;;;1644   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1645   	
;;;1646   	data[0]='B';
;;;1647   	data[1]=b;
;;;1648   	data[2]='S';
;;;1649   	data[3]=0;
;;;1650   	lc640_write_long_ptr(lc640_adr,data);
;;;1651   
;;;1652   	data[0]=0;
;;;1653   	data[1]=0;
;;;1654   	data[2]=0;
;;;1655   	data[3]=0;
;;;1656   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1657   
;;;1658   	data[0]=LPC_RTC->YEAR;
00195e  f8df8400          LDR      r8,|L1.7520|
001962  eb050285          ADD      r2,r5,r5,LSL #2       ;1633
001966  f04f0a00          MOV      r10,#0                ;1637
00196a  f04f0942          MOV      r9,#0x42              ;1646
00196e  f44f6660          MOV      r6,#0xe00             ;1635
001972  f44f6b80          MOV      r11,#0x400            ;1644
001976  eb001002          ADD      r0,r0,r2,LSL #4       ;1633
00197a  2901              CMP      r1,#1                 ;1631
00197c  d002              BEQ      |L1.6532|
;;;1659   	data[1]=LPC_RTC->MONTH;
;;;1660   	data[2]=LPC_RTC->DOM;
;;;1661   	data[3]=0;
;;;1662   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1663   
;;;1664   	data[0]=LPC_RTC->HOUR;
;;;1665   	data[1]=LPC_RTC->MIN;
;;;1666   	data[2]=LPC_RTC->SEC;
;;;1667   	data[3]=0;
;;;1668   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1669   	
;;;1670   	data[0]='A';
;;;1671   	data[1]='A';
;;;1672   	data[2]='A';
;;;1673   	data[3]='A';
;;;1674   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1675   	
;;;1676   	data[0]='A';
;;;1677   	data[1]='A';
;;;1678   	data[2]='A';
;;;1679   	data[3]='A';
;;;1680   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1681   	
;;;1682   	data[0]='A';
;;;1683   	data[1]='A';
;;;1684   	data[2]='A';
;;;1685   	data[3]='A';
;;;1686   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1687   	
;;;1688   	data[0]='A';
;;;1689   	data[1]='A';
;;;1690   	data[2]='A';
;;;1691   	data[3]='A';
;;;1692   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1693   
;;;1694   	if(b==0)
;;;1695   		{
;;;1696   		snmp_trap_send("BAT #1 Alarm, asymmetry",5,1,2);
;;;1697   		}
;;;1698   	else if(b==1)
;;;1699   		{
;;;1700   		snmp_trap_send("BAT #2 Alarm, asymmetry",5,2,2);
;;;1701   		} 
;;;1702   	
;;;1703   	}
;;;1704   
;;;1705   else if(in==0)
00197e  2900              CMP      r1,#0
001980  d07d              BEQ      |L1.6782|
001982  e141              B        |L1.7176|
                  |L1.6532|
001984  f8101f41          LDRB     r1,[r0,#0x41]!        ;1633
001988  f0410102          ORR      r1,r1,#2              ;1633
00198c  7001              STRB     r1,[r0,#0]            ;1633
00198e  4630              MOV      r0,r6                 ;1635
001990  f7fffffe          BL       lc640_read_int
001994  f1000001          ADD      r0,r0,#1              ;1636
001998  b284              UXTH     r4,r0                 ;1636
00199a  2c3f              CMP      r4,#0x3f              ;1637
00199c  d901              BLS      |L1.6562|
00199e  f04f0400          MOV      r4,#0                 ;1637
                  |L1.6562|
0019a2  b221              SXTH     r1,r4                 ;1638
0019a4  4630              MOV      r0,r6                 ;1638
0019a6  f7fffffe          BL       lc640_write_int
0019aa  f6406702          MOV      r7,#0xe02             ;1640
0019ae  4638              MOV      r0,r7                 ;1640
0019b0  f7fffffe          BL       lc640_read_int
0019b4  b280              UXTH     r0,r0                 ;1640
0019b6  283f              CMP      r0,#0x3f              ;1641
0019b8  d000              BEQ      |L1.6588|
0019ba  4620              MOV      r0,r4                 ;1641
                  |L1.6588|
0019bc  b201              SXTH     r1,r0                 ;1642
0019be  4638              MOV      r0,r7                 ;1642
0019c0  f7fffffe          BL       lc640_write_int
0019c4  4630              MOV      r0,r6                 ;1644
0019c6  f7fffffe          BL       lc640_read_int
0019ca  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1644
0019ce  b284              UXTH     r4,r0                 ;1644
0019d0  f88d9000          STRB     r9,[sp,#0]            ;1646
0019d4  f88d5001          STRB     r5,[sp,#1]            ;1647
0019d8  f04f0053          MOV      r0,#0x53              ;1648
0019dc  f88d0002          STRB     r0,[sp,#2]            ;1648
0019e0  f88da003          STRB     r10,[sp,#3]           ;1649
0019e4  4669              MOV      r1,sp                 ;1650
0019e6  4620              MOV      r0,r4                 ;1650
0019e8  f7fffffe          BL       lc640_write_long_ptr
0019ec  f8cda000          STR      r10,[sp,#0]           ;1655
0019f0  4669              MOV      r1,sp                 ;1656
0019f2  1d20              ADDS     r0,r4,#4              ;1656
0019f4  f7fffffe          BL       lc640_write_long_ptr
0019f8  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1658
0019fc  f88d0000          STRB     r0,[sp,#0]            ;1658
001a00  f8980038          LDRB     r0,[r8,#0x38]         ;1659
001a04  f88d0001          STRB     r0,[sp,#1]            ;1659
001a08  f898002c          LDRB     r0,[r8,#0x2c]         ;1660
001a0c  f88d0002          STRB     r0,[sp,#2]            ;1660
001a10  f88da003          STRB     r10,[sp,#3]           ;1661
001a14  4669              MOV      r1,sp                 ;1662
001a16  f1040008          ADD      r0,r4,#8              ;1662
001a1a  f7fffffe          BL       lc640_write_long_ptr
001a1e  f8980028          LDRB     r0,[r8,#0x28]         ;1664
001a22  f88d0000          STRB     r0,[sp,#0]            ;1664
001a26  f8980024          LDRB     r0,[r8,#0x24]         ;1665
001a2a  f88d0001          STRB     r0,[sp,#1]            ;1665
001a2e  f8980020          LDRB     r0,[r8,#0x20]         ;1666
001a32  f88d0002          STRB     r0,[sp,#2]            ;1666
001a36  f88da003          STRB     r10,[sp,#3]           ;1667
001a3a  4669              MOV      r1,sp                 ;1668
001a3c  f104000c          ADD      r0,r4,#0xc            ;1668
001a40  f7fffffe          BL       lc640_write_long_ptr
001a44  f04f0641          MOV      r6,#0x41              ;1670
001a48  f88d6000          STRB     r6,[sp,#0]            ;1670
001a4c  f88d6001          STRB     r6,[sp,#1]            ;1671
001a50  f88d6002          STRB     r6,[sp,#2]            ;1672
001a54  f88d6003          STRB     r6,[sp,#3]            ;1673
001a58  4669              MOV      r1,sp                 ;1674
001a5a  f1040010          ADD      r0,r4,#0x10           ;1674
001a5e  f7fffffe          BL       lc640_write_long_ptr
001a62  f88d6000          STRB     r6,[sp,#0]            ;1676
001a66  f88d6001          STRB     r6,[sp,#1]            ;1677
001a6a  f88d6002          STRB     r6,[sp,#2]            ;1678
001a6e  f88d6003          STRB     r6,[sp,#3]            ;1679
001a72  4669              MOV      r1,sp                 ;1680
001a74  f1040014          ADD      r0,r4,#0x14           ;1680
001a78  f7fffffe          BL       lc640_write_long_ptr
001a7c  e000              B        |L1.6784|
                  |L1.6782|
001a7e  e02b              B        |L1.6872|
                  |L1.6784|
001a80  f88d6000          STRB     r6,[sp,#0]            ;1682
001a84  f88d6001          STRB     r6,[sp,#1]            ;1683
001a88  f88d6002          STRB     r6,[sp,#2]            ;1684
001a8c  f88d6003          STRB     r6,[sp,#3]            ;1685
001a90  4669              MOV      r1,sp                 ;1686
001a92  f1040018          ADD      r0,r4,#0x18           ;1686
001a96  f7fffffe          BL       lc640_write_long_ptr
001a9a  f88d6000          STRB     r6,[sp,#0]            ;1688
001a9e  f88d6001          STRB     r6,[sp,#1]            ;1689
001aa2  f88d6002          STRB     r6,[sp,#2]            ;1690
001aa6  f88d6003          STRB     r6,[sp,#3]            ;1691
001aaa  4669              MOV      r1,sp                 ;1692
001aac  f104001c          ADD      r0,r4,#0x1c           ;1692
001ab0  f7fffffe          BL       lc640_write_long_ptr
001ab4  b115              CBZ      r5,|L1.6844|
001ab6  2d01              CMP      r5,#1                 ;1698
001ab8  d007              BEQ      |L1.6858|
001aba  e0a5              B        |L1.7176|
                  |L1.6844|
001abc  2302              MOVS     r3,#2                 ;1696
001abe  2201              MOVS     r2,#1                 ;1696
001ac0  2105              MOVS     r1,#5                 ;1696
001ac2  a0a8              ADR      r0,|L1.7524|
001ac4  f7fffffe          BL       snmp_trap_send
001ac8  e09e              B        |L1.7176|
                  |L1.6858|
001aca  2302              MOVS     r3,#2                 ;1700
001acc  461a              MOV      r2,r3                 ;1700
001ace  2105              MOVS     r1,#5                 ;1700
001ad0  a0aa              ADR      r0,|L1.7548|
001ad2  f7fffffe          BL       snmp_trap_send
001ad6  e097              B        |L1.7176|
                  |L1.6872|
;;;1706   	{
;;;1707   	bat[b]._av&=~(1<<1);
001ad8  f8101f41          LDRB     r1,[r0,#0x41]!
001adc  f0210102          BIC      r1,r1,#2
001ae0  7001              STRB     r1,[r0,#0]
;;;1708   
;;;1709        event_ptr=lc640_read_int(PTR_EVENT_LOG);
001ae2  4630              MOV      r0,r6
001ae4  f7fffffe          BL       lc640_read_int
001ae8  b284              UXTH     r4,r0
001aea  4627              MOV      r7,r4
;;;1710   	event_ptr_find=event_ptr;
001aec  463c              MOV      r4,r7
                  |L1.6894|
;;;1711   	
;;;1712   avar_bat_as_hndl_lbl1: 
;;;1713   
;;;1714   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001aee  eb0b1044          ADD      r0,r11,r4,LSL #5
001af2  b286              UXTH     r6,r0
;;;1715   
;;;1716        lc640_read_long_ptr(lc640_adr,data);
001af4  4669              MOV      r1,sp
001af6  4630              MOV      r0,r6
001af8  f7fffffe          BL       lc640_read_long_ptr
;;;1717        
;;;1718        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
001afc  f89d0000          LDRB     r0,[sp,#0]
001b00  2842              CMP      r0,#0x42
001b02  d107              BNE      |L1.6932|
001b04  f89d0001          LDRB     r0,[sp,#1]
001b08  42a8              CMP      r0,r5
001b0a  d103              BNE      |L1.6932|
001b0c  f89d0002          LDRB     r0,[sp,#2]
001b10  2843              CMP      r0,#0x43
001b12  d009              BEQ      |L1.6952|
                  |L1.6932|
;;;1719        	{        
;;;1720        	if(event_ptr_find)event_ptr_find--;
001b14  b11c              CBZ      r4,|L1.6942|
001b16  f1a40401          SUB      r4,r4,#1
001b1a  b2a4              UXTH     r4,r4
001b1c  e001              B        |L1.6946|
                  |L1.6942|
;;;1721        	else event_ptr_find=63;
001b1e  f04f043f          MOV      r4,#0x3f
                  |L1.6946|
;;;1722        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001b22  42bc              CMP      r4,r7
001b24  d1e3              BNE      |L1.6894|
001b26  e06f              B        |L1.7176|
                  |L1.6952|
;;;1723        	else goto avar_bat_as_hndl_lbl1;
;;;1724        	}
;;;1725        else 
;;;1726        	{
;;;1727        	lc640_read_long_ptr(lc640_adr+16,data);
001b28  4669              MOV      r1,sp
001b2a  f1060010          ADD      r0,r6,#0x10
001b2e  f7fffffe          BL       lc640_read_long_ptr
;;;1728        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001b32  f89d0000          LDRB     r0,[sp,#0]
001b36  2841              CMP      r0,#0x41
001b38  d10b              BNE      |L1.6994|
001b3a  f89d0001          LDRB     r0,[sp,#1]
001b3e  2841              CMP      r0,#0x41
001b40  d107              BNE      |L1.6994|
001b42  f89d0002          LDRB     r0,[sp,#2]
001b46  2841              CMP      r0,#0x41
001b48  d103              BNE      |L1.6994|
001b4a  f89d0003          LDRB     r0,[sp,#3]
001b4e  2841              CMP      r0,#0x41
001b50  d009              BEQ      |L1.7014|
                  |L1.6994|
;;;1729        		{        
;;;1730        		if(event_ptr_find)event_ptr_find--;
001b52  b11c              CBZ      r4,|L1.7004|
001b54  f1a40401          SUB      r4,r4,#1
001b58  b2a4              UXTH     r4,r4
001b5a  e001              B        |L1.7008|
                  |L1.7004|
;;;1731            		else event_ptr_find=63;
001b5c  f04f043f          MOV      r4,#0x3f
                  |L1.7008|
;;;1732            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001b60  42bc              CMP      r4,r7
001b62  d1c4              BNE      |L1.6894|
001b64  e050              B        |L1.7176|
                  |L1.7014|
;;;1733        		else goto avar_bat_as_hndl_lbl1;
;;;1734        		}
;;;1735   
;;;1736        	}
;;;1737        		
;;;1738   	data[0]=LPC_RTC->YEAR;
001b66  f8b8003c          LDRH     r0,[r8,#0x3c]
001b6a  f88d0000          STRB     r0,[sp,#0]
;;;1739   	data[1]=LPC_RTC->MONTH;
001b6e  f8980038          LDRB     r0,[r8,#0x38]
001b72  f88d0001          STRB     r0,[sp,#1]
;;;1740   	data[2]=LPC_RTC->DOM;
001b76  f898002c          LDRB     r0,[r8,#0x2c]
001b7a  f88d0002          STRB     r0,[sp,#2]
;;;1741   	data[3]=0;
001b7e  f88da003          STRB     r10,[sp,#3]
;;;1742   	lc640_write_long_ptr(lc640_adr+16,data);
001b82  4669              MOV      r1,sp
001b84  f1060010          ADD      r0,r6,#0x10
001b88  f7fffffe          BL       lc640_write_long_ptr
;;;1743   
;;;1744   	data[0]=LPC_RTC->HOUR;
001b8c  f8980028          LDRB     r0,[r8,#0x28]
001b90  f88d0000          STRB     r0,[sp,#0]
;;;1745   	data[1]=LPC_RTC->MIN;
001b94  f8980024          LDRB     r0,[r8,#0x24]
001b98  f88d0001          STRB     r0,[sp,#1]
;;;1746   	data[2]=LPC_RTC->SEC;
001b9c  f8980020          LDRB     r0,[r8,#0x20]
001ba0  f88d0002          STRB     r0,[sp,#2]
;;;1747   	data[3]=0;
001ba4  f88da003          STRB     r10,[sp,#3]
;;;1748   	lc640_write_long_ptr(lc640_adr+20,data);
001ba8  4669              MOV      r1,sp
001baa  f1060014          ADD      r0,r6,#0x14
001bae  f7fffffe          BL       lc640_write_long_ptr
;;;1749   	
;;;1750   	data[0]='B';
001bb2  f88d9000          STRB     r9,[sp,#0]
;;;1751   	data[1]='B';
001bb6  f88d9001          STRB     r9,[sp,#1]
;;;1752   	data[2]='B';
001bba  f88d9002          STRB     r9,[sp,#2]
;;;1753   	data[3]='B';
001bbe  f88d9003          STRB     r9,[sp,#3]
;;;1754   	lc640_write_long_ptr(lc640_adr+24,data);
001bc2  4669              MOV      r1,sp
001bc4  f1060018          ADD      r0,r6,#0x18
001bc8  f7fffffe          BL       lc640_write_long_ptr
;;;1755   	
;;;1756   	data[0]='B';
001bcc  f88d9000          STRB     r9,[sp,#0]
;;;1757   	data[1]='B';
001bd0  f88d9001          STRB     r9,[sp,#1]
;;;1758   	data[2]='B';
001bd4  f88d9002          STRB     r9,[sp,#2]
;;;1759   	data[3]='B';
001bd8  f88d9003          STRB     r9,[sp,#3]
;;;1760   	lc640_write_long_ptr(lc640_adr+28,data);
001bdc  4669              MOV      r1,sp
001bde  f106001c          ADD      r0,r6,#0x1c
001be2  f7fffffe          BL       lc640_write_long_ptr
;;;1761   	
;;;1762   	if(b==0)
001be6  b115              CBZ      r5,|L1.7150|
;;;1763   		{
;;;1764   		snmp_trap_send("BAT #1 Asymmetry alarm clear",5,1,0);
;;;1765   		}
;;;1766   	else if(b==1)
001be8  2d01              CMP      r5,#1
001bea  d007              BEQ      |L1.7164|
001bec  e00c              B        |L1.7176|
                  |L1.7150|
001bee  2300              MOVS     r3,#0                 ;1764
001bf0  2201              MOVS     r2,#1                 ;1764
001bf2  2105              MOVS     r1,#5                 ;1764
001bf4  a067              ADR      r0,|L1.7572|
001bf6  f7fffffe          BL       snmp_trap_send
001bfa  e005              B        |L1.7176|
                  |L1.7164|
;;;1767   		{
;;;1768   		snmp_trap_send("BAT #2 Asymmetry alarm clear",5,2,0);
001bfc  2300              MOVS     r3,#0
001bfe  2202              MOVS     r2,#2
001c00  2105              MOVS     r1,#5
001c02  a06c              ADR      r0,|L1.7604|
001c04  f7fffffe          BL       snmp_trap_send
                  |L1.7176|
;;;1769   		}
;;;1770   	
;;;1771   	}
;;;1772   	
;;;1773   avar_bat_as_hndl_end:
;;;1774   __nop();		
001c08  bf00              NOP      
                  |L1.7178|
;;;1775   }
001c0a  e4bc              B        |L1.5510|
;;;1776   
                          ENDP

                  ke_zvu_mem_hndl PROC
;;;1777   //-----------------------------------------------
;;;1778   void ke_zvu_mem_hndl(char b,unsigned short in,unsigned short in1)
001c0c  b5f7              PUSH     {r0-r2,r4-r7,lr}
;;;1779   {
001c0e  b082              SUB      sp,sp,#8
001c10  4605              MOV      r5,r0
;;;1780   char data[4];
;;;1781   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1782   //unsigned char temp,temp_;
;;;1783   //unsigned int tempUI;
;;;1784   //unsigned long tempUL; 
;;;1785   signed temp_temp;
;;;1786   
;;;1787   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
001c12  4952              LDR      r1,|L1.7516|
001c14  eb050085          ADD      r0,r5,r5,LSL #2
001c18  eb011100          ADD      r1,r1,r0,LSL #4
001c1c  486d              LDR      r0,|L1.7636|
001c1e  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
001c22  f1000001          ADD      r0,r0,#1
001c26  eb010040          ADD      r0,r1,r0,LSL #1
001c2a  f9b00024          LDRSH    r0,[r0,#0x24]
001c2e  9000              STR      r0,[sp,#0]
;;;1788   
;;;1789   event_ptr=lc640_read_int(PTR_EVENT_LOG);
001c30  f44f6660          MOV      r6,#0xe00
001c34  4630              MOV      r0,r6
001c36  f7fffffe          BL       lc640_read_int
;;;1790   event_ptr++;	
001c3a  f1000001          ADD      r0,r0,#1
001c3e  4604              MOV      r4,r0
;;;1791   if(event_ptr>63)event_ptr=0;	
001c40  2c3f              CMP      r4,#0x3f
001c42  d901              BLS      |L1.7240|
001c44  f04f0400          MOV      r4,#0
                  |L1.7240|
;;;1792   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
001c48  b221              SXTH     r1,r4
001c4a  4630              MOV      r0,r6
001c4c  f7fffffe          BL       lc640_write_int
;;;1793   	
;;;1794   event_cnt=lc640_read_int(CNT_EVENT_LOG);
001c50  f6406702          MOV      r7,#0xe02
001c54  4638              MOV      r0,r7
001c56  f7fffffe          BL       lc640_read_int
;;;1795   if(event_cnt!=63)event_cnt=event_ptr;
001c5a  283f              CMP      r0,#0x3f
001c5c  d000              BEQ      |L1.7264|
001c5e  4620              MOV      r0,r4
                  |L1.7264|
;;;1796   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
001c60  b201              SXTH     r1,r0
001c62  4638              MOV      r0,r7
001c64  f7fffffe          BL       lc640_write_int
;;;1797   	
;;;1798   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
001c68  4630              MOV      r0,r6
001c6a  f7fffffe          BL       lc640_read_int
001c6e  f44f6180          MOV      r1,#0x400
001c72  eb011440          ADD      r4,r1,r0,LSL #5
;;;1799   	
;;;1800   data[0]='B';
001c76  f04f0042          MOV      r0,#0x42
001c7a  f88d0004          STRB     r0,[sp,#4]
;;;1801   data[1]=b; 
001c7e  f88d5005          STRB     r5,[sp,#5]
;;;1802   data[2]='K';
001c82  f04f004b          MOV      r0,#0x4b
001c86  f88d0006          STRB     r0,[sp,#6]
;;;1803   data[3]='Z';
001c8a  f04f005a          MOV      r0,#0x5a
001c8e  f88d0007          STRB     r0,[sp,#7]
;;;1804   
;;;1805   lc640_write_long_ptr(lc640_adr,data);
001c92  a901              ADD      r1,sp,#4
001c94  4620              MOV      r0,r4
001c96  f7fffffe          BL       lc640_write_long_ptr
;;;1806   
;;;1807   data[0]=*((char*)&in);
001c9a  f89d000c          LDRB     r0,[sp,#0xc]
001c9e  f88d0004          STRB     r0,[sp,#4]
;;;1808   data[1]=*(((char*)(&in))+1);
001ca2  f89d000d          LDRB     r0,[sp,#0xd]
001ca6  f88d0005          STRB     r0,[sp,#5]
;;;1809   data[2]=*((char*)&temp_temp);
001caa  f89d0000          LDRB     r0,[sp,#0]
001cae  f88d0006          STRB     r0,[sp,#6]
;;;1810   data[3]=*(((char*)(&temp_temp))+1);
001cb2  f89d0001          LDRB     r0,[sp,#1]
001cb6  f88d0007          STRB     r0,[sp,#7]
;;;1811   lc640_write_long_ptr(lc640_adr+4,data);
001cba  a901              ADD      r1,sp,#4
001cbc  1d20              ADDS     r0,r4,#4
001cbe  f7fffffe          BL       lc640_write_long_ptr
;;;1812   
;;;1813   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
001cc2  e089              B        |L1.7640|
                  |L1.7364|
001cc4  42415420          DCB      "BAT #1 Alarm, heating eliminated",0
001cc8  23312041
001ccc  6c61726d
001cd0  2c206865
001cd4  6174696e
001cd8  6720656c
001cdc  696d696e
001ce0  61746564
001ce4  00      
001ce5  00                DCB      0
001ce6  00                DCB      0
001ce7  00                DCB      0
                  |L1.7400|
001ce8  42415420          DCB      "BAT #2 Alarm, heating eliminated",0
001cec  23322041
001cf0  6c61726d
001cf4  2c206865
001cf8  6174696e
001cfc  6720656c
001d00  696d696e
001d04  61746564
001d08  00      
001d09  00                DCB      0
001d0a  00                DCB      0
001d0b  00                DCB      0
                  |L1.7436|
001d0c  42415420          DCB      "BAT #2 Alarm, overheating eliminated",0
001d10  23322041
001d14  6c61726d
001d18  2c206f76
001d1c  65726865
001d20  6174696e
001d24  6720656c
001d28  696d696e
001d2c  61746564
001d30  00      
001d31  00                DCB      0
001d32  00                DCB      0
001d33  00                DCB      0
                  |L1.7476|
001d34  42415420          DCB      "BAT #1 Alarm, overheating eliminated",0
001d38  23312041
001d3c  6c61726d
001d40  2c206f76
001d44  65726865
001d48  6174696e
001d4c  6720656c
001d50  696d696e
001d54  61746564
001d58  00      
001d59  00                DCB      0
001d5a  00                DCB      0
001d5b  00                DCB      0
                  |L1.7516|
                          DCD      bat
                  |L1.7520|
                          DCD      0x40024000
                  |L1.7524|
001d64  42415420          DCB      "BAT #1 Alarm, asymmetry",0
001d68  23312041
001d6c  6c61726d
001d70  2c206173
001d74  796d6d65
001d78  74727900
                  |L1.7548|
001d7c  42415420          DCB      "BAT #2 Alarm, asymmetry",0
001d80  23322041
001d84  6c61726d
001d88  2c206173
001d8c  796d6d65
001d90  74727900
                  |L1.7572|
001d94  42415420          DCB      "BAT #1 Asymmetry alarm clear",0
001d98  23312041
001d9c  73796d6d
001da0  65747279
001da4  20616c61
001da8  726d2063
001dac  6c656172
001db0  00      
001db1  00                DCB      0
001db2  00                DCB      0
001db3  00                DCB      0
                  |L1.7604|
001db4  42415420          DCB      "BAT #2 Asymmetry alarm clear",0
001db8  23322041
001dbc  73796d6d
001dc0  65747279
001dc4  20616c61
001dc8  726d2063
001dcc  6c656172
001dd0  00      
001dd1  00                DCB      0
001dd2  00                DCB      0
001dd3  00                DCB      0
                  |L1.7636|
                          DCD      bat_u_old_cnt
                  |L1.7640|
001dd8  f24020a2          MOV      r0,#0x2a2
001ddc  f7fffffe          BL       lc640_read_long
001de0  4dff              LDR      r5,|L1.8672|
001de2  6028              STR      r0,[r5,#0]  ; ke_date
;;;1814   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
001de4  4629              MOV      r1,r5
001de6  f1040008          ADD      r0,r4,#8
001dea  f7fffffe          BL       lc640_write_long_ptr
;;;1815   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
001dee  f24020a6          MOV      r0,#0x2a6
001df2  f7fffffe          BL       lc640_read_long
001df6  6068              STR      r0,[r5,#4]  ; ke_date
;;;1816   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
001df8  1d29              ADDS     r1,r5,#4
001dfa  f104000c          ADD      r0,r4,#0xc
001dfe  f7fffffe          BL       lc640_write_long_ptr
;;;1817   
;;;1818   data[0]=LPC_RTC->YEAR;
001e02  4df8              LDR      r5,|L1.8676|
001e04  8ba8              LDRH     r0,[r5,#0x1c]
001e06  f88d0004          STRB     r0,[sp,#4]
;;;1819   data[1]=LPC_RTC->MONTH;
001e0a  7e28              LDRB     r0,[r5,#0x18]
001e0c  f88d0005          STRB     r0,[sp,#5]
;;;1820   data[2]=LPC_RTC->DOM;
001e10  7b28              LDRB     r0,[r5,#0xc]
001e12  f88d0006          STRB     r0,[sp,#6]
;;;1821   data[3]=*((char*)&in1);
001e16  f89d0010          LDRB     r0,[sp,#0x10]
001e1a  f88d0007          STRB     r0,[sp,#7]
;;;1822   lc640_write_long_ptr(lc640_adr+16,data);
001e1e  a901              ADD      r1,sp,#4
001e20  f1040010          ADD      r0,r4,#0x10
001e24  f7fffffe          BL       lc640_write_long_ptr
;;;1823   
;;;1824   data[0]=LPC_RTC->HOUR;
001e28  7a28              LDRB     r0,[r5,#8]
001e2a  f88d0004          STRB     r0,[sp,#4]
;;;1825   data[1]=LPC_RTC->MIN;
001e2e  7928              LDRB     r0,[r5,#4]
001e30  f88d0005          STRB     r0,[sp,#5]
;;;1826   data[2]=LPC_RTC->SEC;
001e34  7828              LDRB     r0,[r5,#0]
001e36  f88d0006          STRB     r0,[sp,#6]
;;;1827   data[3]=*(((char*)(&in1))+1);
001e3a  f89d0011          LDRB     r0,[sp,#0x11]
001e3e  f88d0007          STRB     r0,[sp,#7]
;;;1828   lc640_write_long_ptr(lc640_adr+20,data);
001e42  a901              ADD      r1,sp,#4
001e44  f1040014          ADD      r0,r4,#0x14
001e48  f7fffffe          BL       lc640_write_long_ptr
;;;1829    
;;;1830   }
001e4c  b005              ADD      sp,sp,#0x14
001e4e  bdf0              POP      {r4-r7,pc}
;;;1831   
                          ENDP

                  vz_mem_hndl PROC
;;;1888   //-----------------------------------------------
;;;1889   void vz_mem_hndl(unsigned short in)
001e50  e92d4ff8          PUSH     {r3-r11,lr}
;;;1890   {
;;;1891   char data[4];
;;;1892   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001e54  f04f0600          MOV      r6,#0
001e58  4634              MOV      r4,r6
;;;1893   //char avar_simbol;
;;;1894   
;;;1895   if(in==1)
;;;1896   	{
;;;1897   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1898   	event_ptr++;	
;;;1899   	if(event_ptr>63)event_ptr=0;	
;;;1900   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1901   	
;;;1902        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1903   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1904   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1905   	
;;;1906   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1907   	
;;;1908   	data[0]='B';
;;;1909   	data[1]=0; 
;;;1910   	data[2]='Z';
;;;1911   	data[3]=0;
;;;1912   	lc640_write_long_ptr(lc640_adr,data);
;;;1913   
;;;1914   	data[0]=0;
;;;1915   	data[1]=0;
;;;1916   	data[2]=0;
;;;1917   	data[3]=0;
;;;1918   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1919   
;;;1920   	data[0]=LPC_RTC->YEAR;
001e5a  f8df838c          LDR      r8,|L1.8680|
001e5e  46a1              MOV      r9,r4                 ;1892
001e60  f04f0742          MOV      r7,#0x42              ;1908
001e64  f44f6a80          MOV      r10,#0x400            ;1906
001e68  2801              CMP      r0,#1                 ;1895
001e6a  d002              BEQ      |L1.7794|
;;;1921   	data[1]=LPC_RTC->MONTH;
;;;1922   	data[2]=LPC_RTC->DOM;
;;;1923   	data[3]=0;
;;;1924   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1925   
;;;1926   	data[0]=LPC_RTC->HOUR;
;;;1927   	data[1]=LPC_RTC->MIN;
;;;1928   	data[2]=LPC_RTC->SEC;
;;;1929   	data[3]=0;
;;;1930   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1931   	
;;;1932   	data[0]='A';
;;;1933   	data[1]='A';
;;;1934   	data[2]='A';
;;;1935   	data[3]='A';
;;;1936   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1937   	
;;;1938   	data[0]='A';
;;;1939   	data[1]='A';
;;;1940   	data[2]='A';
;;;1941   	data[3]='A';
;;;1942   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1943   	
;;;1944   	data[0]='A';
;;;1945   	data[1]='A';
;;;1946   	data[2]='A';
;;;1947   	data[3]='A';
;;;1948   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1949   	
;;;1950   	data[0]='A';
;;;1951   	data[1]='A';
;;;1952   	data[2]='A';
;;;1953   	data[3]='A';
;;;1954   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1955    	
;;;1956   	}
;;;1957   
;;;1958   else if(in==0)
001e6c  2800              CMP      r0,#0
001e6e  d07e              BEQ      |L1.8046|
001e70  e108              B        |L1.8324|
                  |L1.7794|
001e72  f44f6560          MOV      r5,#0xe00             ;1897
001e76  4628              MOV      r0,r5                 ;1897
001e78  f7fffffe          BL       lc640_read_int
001e7c  f1000001          ADD      r0,r0,#1              ;1898
001e80  4604              MOV      r4,r0                 ;1898
001e82  2c3f              CMP      r4,#0x3f              ;1899
001e84  d901              BLS      |L1.7818|
001e86  f04f0400          MOV      r4,#0                 ;1899
                  |L1.7818|
001e8a  b221              SXTH     r1,r4                 ;1900
001e8c  4628              MOV      r0,r5                 ;1900
001e8e  f7fffffe          BL       lc640_write_int
001e92  f6406602          MOV      r6,#0xe02             ;1902
001e96  4630              MOV      r0,r6                 ;1902
001e98  f7fffffe          BL       lc640_read_int
001e9c  283f              CMP      r0,#0x3f              ;1903
001e9e  d000              BEQ      |L1.7842|
001ea0  4620              MOV      r0,r4                 ;1903
                  |L1.7842|
001ea2  b201              SXTH     r1,r0                 ;1904
001ea4  4630              MOV      r0,r6                 ;1904
001ea6  f7fffffe          BL       lc640_write_int
001eaa  4628              MOV      r0,r5                 ;1906
001eac  f7fffffe          BL       lc640_read_int
001eb0  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1906
001eb4  f88d7000          STRB     r7,[sp,#0]            ;1908
001eb8  f88d9001          STRB     r9,[sp,#1]            ;1909
001ebc  f04f005a          MOV      r0,#0x5a              ;1910
001ec0  f88d0002          STRB     r0,[sp,#2]            ;1910
001ec4  f88d9003          STRB     r9,[sp,#3]            ;1911
001ec8  4669              MOV      r1,sp                 ;1912
001eca  4620              MOV      r0,r4                 ;1912
001ecc  f7fffffe          BL       lc640_write_long_ptr
001ed0  f8cd9000          STR      r9,[sp,#0]            ;1917
001ed4  4669              MOV      r1,sp                 ;1918
001ed6  1d20              ADDS     r0,r4,#4              ;1918
001ed8  f7fffffe          BL       lc640_write_long_ptr
001edc  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1920
001ee0  f88d0000          STRB     r0,[sp,#0]            ;1920
001ee4  f8980038          LDRB     r0,[r8,#0x38]         ;1921
001ee8  f88d0001          STRB     r0,[sp,#1]            ;1921
001eec  f898002c          LDRB     r0,[r8,#0x2c]         ;1922
001ef0  f88d0002          STRB     r0,[sp,#2]            ;1922
001ef4  f88d9003          STRB     r9,[sp,#3]            ;1923
001ef8  4669              MOV      r1,sp                 ;1924
001efa  f1040008          ADD      r0,r4,#8              ;1924
001efe  f7fffffe          BL       lc640_write_long_ptr
001f02  f8980028          LDRB     r0,[r8,#0x28]         ;1926
001f06  f88d0000          STRB     r0,[sp,#0]            ;1926
001f0a  f8980024          LDRB     r0,[r8,#0x24]         ;1927
001f0e  f88d0001          STRB     r0,[sp,#1]            ;1927
001f12  f8980020          LDRB     r0,[r8,#0x20]         ;1928
001f16  f88d0002          STRB     r0,[sp,#2]            ;1928
001f1a  f88d9003          STRB     r9,[sp,#3]            ;1929
001f1e  4669              MOV      r1,sp                 ;1930
001f20  f104000c          ADD      r0,r4,#0xc            ;1930
001f24  f7fffffe          BL       lc640_write_long_ptr
001f28  f04f0541          MOV      r5,#0x41              ;1932
001f2c  f88d5000          STRB     r5,[sp,#0]            ;1932
001f30  f88d5001          STRB     r5,[sp,#1]            ;1933
001f34  f88d5002          STRB     r5,[sp,#2]            ;1934
001f38  f88d5003          STRB     r5,[sp,#3]            ;1935
001f3c  4669              MOV      r1,sp                 ;1936
001f3e  f1040010          ADD      r0,r4,#0x10           ;1936
001f42  f7fffffe          BL       lc640_write_long_ptr
001f46  f88d5000          STRB     r5,[sp,#0]            ;1938
001f4a  f88d5001          STRB     r5,[sp,#1]            ;1939
001f4e  f88d5002          STRB     r5,[sp,#2]            ;1940
001f52  f88d5003          STRB     r5,[sp,#3]            ;1941
001f56  4669              MOV      r1,sp                 ;1942
001f58  f1040014          ADD      r0,r4,#0x14           ;1942
001f5c  f7fffffe          BL       lc640_write_long_ptr
001f60  f88d5000          STRB     r5,[sp,#0]            ;1944
001f64  f88d5001          STRB     r5,[sp,#1]            ;1945
001f68  f88d5002          STRB     r5,[sp,#2]            ;1946
001f6c  e000              B        |L1.8048|
                  |L1.8046|
001f6e  e014              B        |L1.8090|
                  |L1.8048|
001f70  f88d5003          STRB     r5,[sp,#3]            ;1947
001f74  4669              MOV      r1,sp                 ;1948
001f76  f1040018          ADD      r0,r4,#0x18           ;1948
001f7a  f7fffffe          BL       lc640_write_long_ptr
001f7e  f88d5000          STRB     r5,[sp,#0]            ;1950
001f82  f88d5001          STRB     r5,[sp,#1]            ;1951
001f86  f88d5002          STRB     r5,[sp,#2]            ;1952
001f8a  f88d5003          STRB     r5,[sp,#3]            ;1953
001f8e  4669              MOV      r1,sp                 ;1954
001f90  f104001c          ADD      r0,r4,#0x1c           ;1954
001f94  f7fffffe          BL       lc640_write_long_ptr
001f98  e074              B        |L1.8324|
                  |L1.8090|
;;;1959   	{      
;;;1960        
;;;1961   vz_mem_hndl_lbl1: 
;;;1962   
;;;1963   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001f9a  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1964   
;;;1965        lc640_read_long_ptr(lc640_adr,data);
001f9e  4669              MOV      r1,sp
001fa0  4628              MOV      r0,r5
001fa2  f7fffffe          BL       lc640_read_long_ptr
;;;1966        
;;;1967        if(!((data[0]=='B')&&(data[2]=='Z')))
001fa6  f89d0000          LDRB     r0,[sp,#0]
001faa  2842              CMP      r0,#0x42
001fac  d103              BNE      |L1.8118|
001fae  f89d0002          LDRB     r0,[sp,#2]
001fb2  285a              CMP      r0,#0x5a
001fb4  d008              BEQ      |L1.8136|
                  |L1.8118|
;;;1968        	{        
;;;1969        	if(event_ptr_find)event_ptr_find--;
001fb6  b114              CBZ      r4,|L1.8126|
001fb8  f1a40401          SUB      r4,r4,#1
001fbc  e001              B        |L1.8130|
                  |L1.8126|
;;;1970        	else event_ptr_find=63;
001fbe  f04f043f          MOV      r4,#0x3f
                  |L1.8130|
;;;1971        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001fc2  42b4              CMP      r4,r6
001fc4  d1e9              BNE      |L1.8090|
001fc6  e05d              B        |L1.8324|
                  |L1.8136|
;;;1972        	else goto vz_mem_hndl_lbl1;
;;;1973        	}
;;;1974        else 
;;;1975        	{
;;;1976        	lc640_read_long_ptr(lc640_adr+16,data);
001fc8  4669              MOV      r1,sp
001fca  f1050010          ADD      r0,r5,#0x10
001fce  f7fffffe          BL       lc640_read_long_ptr
;;;1977        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001fd2  f89d0000          LDRB     r0,[sp,#0]
001fd6  2841              CMP      r0,#0x41
001fd8  d10b              BNE      |L1.8178|
001fda  f89d0001          LDRB     r0,[sp,#1]
001fde  2841              CMP      r0,#0x41
001fe0  d107              BNE      |L1.8178|
001fe2  f89d0002          LDRB     r0,[sp,#2]
001fe6  2841              CMP      r0,#0x41
001fe8  d103              BNE      |L1.8178|
001fea  f89d0003          LDRB     r0,[sp,#3]
001fee  2841              CMP      r0,#0x41
001ff0  d008              BEQ      |L1.8196|
                  |L1.8178|
;;;1978        		{        
;;;1979        		if(event_ptr_find)event_ptr_find--;
001ff2  b114              CBZ      r4,|L1.8186|
001ff4  f1a40401          SUB      r4,r4,#1
001ff8  e001              B        |L1.8190|
                  |L1.8186|
;;;1980            		else event_ptr_find=63;
001ffa  f04f043f          MOV      r4,#0x3f
                  |L1.8190|
;;;1981            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001ffe  42b4              CMP      r4,r6
002000  d1cb              BNE      |L1.8090|
002002  e03f              B        |L1.8324|
                  |L1.8196|
;;;1982        		else goto vz_mem_hndl_lbl1;
;;;1983        		}
;;;1984   
;;;1985        	}	
;;;1986   
;;;1987   
;;;1988   	
;;;1989   	data[0]=LPC_RTC->YEAR;
002004  f8b8003c          LDRH     r0,[r8,#0x3c]
002008  f88d0000          STRB     r0,[sp,#0]
;;;1990   	data[1]=LPC_RTC->MONTH;
00200c  f8980038          LDRB     r0,[r8,#0x38]
002010  f88d0001          STRB     r0,[sp,#1]
;;;1991   	data[2]=LPC_RTC->DOM;
002014  f898002c          LDRB     r0,[r8,#0x2c]
002018  f88d0002          STRB     r0,[sp,#2]
;;;1992   	data[3]=0;
00201c  f88d9003          STRB     r9,[sp,#3]
;;;1993   	lc640_write_long_ptr(lc640_adr+16,data);
002020  4669              MOV      r1,sp
002022  f1050010          ADD      r0,r5,#0x10
002026  f7fffffe          BL       lc640_write_long_ptr
;;;1994   
;;;1995   	data[0]=LPC_RTC->HOUR;
00202a  f8980028          LDRB     r0,[r8,#0x28]
00202e  f88d0000          STRB     r0,[sp,#0]
;;;1996   	data[1]=LPC_RTC->MIN;
002032  f8980024          LDRB     r0,[r8,#0x24]
002036  f88d0001          STRB     r0,[sp,#1]
;;;1997   	data[2]=LPC_RTC->SEC;
00203a  f8980020          LDRB     r0,[r8,#0x20]
00203e  f88d0002          STRB     r0,[sp,#2]
;;;1998   	data[3]=0;
002042  f88d9003          STRB     r9,[sp,#3]
;;;1999   	lc640_write_long_ptr(lc640_adr+20,data);
002046  4669              MOV      r1,sp
002048  f1050014          ADD      r0,r5,#0x14
00204c  f7fffffe          BL       lc640_write_long_ptr
;;;2000   	
;;;2001   	data[0]='B';
002050  f88d7000          STRB     r7,[sp,#0]
;;;2002   	data[1]='B';
002054  f88d7001          STRB     r7,[sp,#1]
;;;2003   	data[2]='B';
002058  f88d7002          STRB     r7,[sp,#2]
;;;2004   	data[3]='B';
00205c  f88d7003          STRB     r7,[sp,#3]
;;;2005   	lc640_write_long_ptr(lc640_adr+24,data);
002060  4669              MOV      r1,sp
002062  f1050018          ADD      r0,r5,#0x18
002066  f7fffffe          BL       lc640_write_long_ptr
;;;2006   	
;;;2007   	data[0]='B';
00206a  f88d7000          STRB     r7,[sp,#0]
;;;2008   	data[1]='B';
00206e  f88d7001          STRB     r7,[sp,#1]
;;;2009   	data[2]='B';
002072  f88d7002          STRB     r7,[sp,#2]
;;;2010   	data[3]='B';
002076  f88d7003          STRB     r7,[sp,#3]
;;;2011   	lc640_write_long_ptr(lc640_adr+28,data);
00207a  4669              MOV      r1,sp
00207c  f105001c          ADD      r0,r5,#0x1c
002080  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8324|
;;;2012   	
;;;2013   	}
;;;2014   
;;;2015   vz_mem_hndl_end:
;;;2016   __nop(); 
002084  bf00              NOP      
                  |L1.8326|
;;;2017   
;;;2018   }
002086  e45e              B        |L1.6470|
;;;2019   
                          ENDP

                  speedz_mem_hndl PROC
;;;2020   //-----------------------------------------------
;;;2021   void speedz_mem_hndl(unsigned short in)	 //    (1-, 5- , 0- , 10- )
002088  e92d4ff8          PUSH     {r3-r11,lr}
;;;2022   {
00208c  4605              MOV      r5,r0
;;;2023   char data[4];
;;;2024   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
00208e  f04f0600          MOV      r6,#0
002092  4634              MOV      r4,r6
;;;2025   //char avar_simbol;
;;;2026   
;;;2027   if((in==1)||(in==5)) //  
;;;2028   	{
;;;2029   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2030   	event_ptr++;	
;;;2031   	if(event_ptr>63)event_ptr=0;	
;;;2032   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2033   	
;;;2034       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2035   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2036   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2037   	
;;;2038   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2039   	
;;;2040   	data[0]='s';
;;;2041   	data[1]=0;
;;;2042   	if(in==5)data[1]='a'; 
;;;2043   	data[2]='Z';
;;;2044   	data[3]=0;
;;;2045   	lc640_write_long_ptr(lc640_adr,data);
;;;2046   
;;;2047   	data[0]=0;
;;;2048   	data[1]=0;
;;;2049   	data[2]=0;
;;;2050   	data[3]=0;
;;;2051   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2052   
;;;2053   	data[0]=LPC_RTC->YEAR;
002094  f8df8150          LDR      r8,|L1.8680|
002098  46a1              MOV      r9,r4                 ;2024
00209a  f44f6a80          MOV      r10,#0x400            ;2038
00209e  2d01              CMP      r5,#1                 ;2027
0020a0  d012              BEQ      |L1.8392|
0020a2  2d05              CMP      r5,#5                 ;2027
0020a4  d010              BEQ      |L1.8392|
;;;2054   	data[1]=LPC_RTC->MONTH;
;;;2055   	data[2]=LPC_RTC->DOM;
;;;2056   	data[3]=0;
;;;2057   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2058   
;;;2059   	data[0]=LPC_RTC->HOUR;
;;;2060   	data[1]=LPC_RTC->MIN;
;;;2061   	data[2]=LPC_RTC->SEC;
;;;2062   	data[3]=0;
;;;2063   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2064   	
;;;2065   	data[0]='A';
;;;2066   	data[1]='A';
;;;2067   	data[2]='A';
;;;2068   	data[3]='A';
;;;2069   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2070   	
;;;2071   	data[0]='A';
;;;2072   	data[1]='A';
;;;2073   	data[2]='A';
;;;2074   	data[3]='A';
;;;2075   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2076   	
;;;2077   	data[0]='A';
;;;2078   	data[1]='A';
;;;2079   	data[2]='A';
;;;2080   	data[3]='A';
;;;2081   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2082   	
;;;2083   	data[0]='A';
;;;2084   	data[1]='A';
;;;2085   	data[2]='A';
;;;2086   	data[3]='A';
;;;2087   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2088    	
;;;2089   	}
;;;2090   
;;;2091   else if(in==0)	// 
0020a6  2d00              CMP      r5,#0
0020a8  d07d              BEQ      |L1.8614|
;;;2092   	{      
;;;2093   	char i;     
;;;2094   	event_ptr_find=0;
;;;2095   	for (i=0;i<63;i++)
;;;2096   		{
;;;2097   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2098   
;;;2099        	lc640_read_long_ptr(lc640_adr,data);
;;;2100        
;;;2101        	if(!((data[0]=='s')&&(data[2]=='Z')))
;;;2102        		{        
;;;2103        		if(event_ptr_find)event_ptr_find--;
;;;2104        		else event_ptr_find=63;
;;;2105        		if(event_ptr_find==event_ptr)
;;;2106   				{
;;;2107   				lc640_adr=0;
;;;2108   				break;
;;;2109   				}
;;;2110        		else continue;
;;;2111        		}
;;;2112        	else 
;;;2113        		{
;;;2114        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2115        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2116        			{        
;;;2117        			if(event_ptr_find)event_ptr_find--;
;;;2118            		else event_ptr_find=63;
;;;2119            		if(event_ptr_find==event_ptr)
;;;2120   					{
;;;2121   					lc640_adr=0;
;;;2122   					break;
;;;2123   					}
;;;2124        			else continue;
;;;2125        			}
;;;2126        		}	
;;;2127   		}
;;;2128   	if(lc640_adr!=0)
;;;2129   		{
;;;2130   		data[0]=LPC_RTC->YEAR;
;;;2131   		data[1]=LPC_RTC->MONTH;
;;;2132   		data[2]=LPC_RTC->DOM;
;;;2133   		data[3]=0;
;;;2134   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2135   	
;;;2136   		data[0]=LPC_RTC->HOUR;
;;;2137   		data[1]=LPC_RTC->MIN;
;;;2138   		data[2]=LPC_RTC->SEC;
;;;2139   		data[3]=0;
;;;2140   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2141   		
;;;2142   		data[0]='C';
;;;2143   		data[1]='C';
;;;2144   		data[2]='C';
;;;2145   		data[3]='C';
;;;2146   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2147   		
;;;2148   		data[0]='C';
;;;2149   		data[1]='C';
;;;2150   		data[2]='C';
;;;2151   		data[3]='C';
;;;2152   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2153   		}
;;;2154   	}
;;;2155   else if(in==10) 	//  
0020aa  2d0a              CMP      r5,#0xa
0020ac  d17c              BNE      |L1.8616|
;;;2156   	{      
;;;2157   	char i;     
;;;2158   
;;;2159   	event_ptr_find=0;
;;;2160   	for (i=0;i<63;i++)
0020ae  f04f0700          MOV      r7,#0
                  |L1.8370|
;;;2161   		{
;;;2162   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
0020b2  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2163   
;;;2164        	lc640_read_long_ptr(lc640_adr,data);
0020b6  4669              MOV      r1,sp
0020b8  4628              MOV      r0,r5
0020ba  f7fffffe          BL       lc640_read_long_ptr
;;;2165        
;;;2166        	if(!((data[0]=='s')&&(data[2]=='Z')))
0020be  f89d0000          LDRB     r0,[sp,#0]
0020c2  2873              CMP      r0,#0x73
0020c4  d171              BNE      |L1.8618|
0020c6  e129              B        |L1.8988|
                  |L1.8392|
0020c8  f44f6660          MOV      r6,#0xe00             ;2029
0020cc  4630              MOV      r0,r6                 ;2029
0020ce  f7fffffe          BL       lc640_read_int
0020d2  f1000001          ADD      r0,r0,#1              ;2030
0020d6  4604              MOV      r4,r0                 ;2030
0020d8  2c3f              CMP      r4,#0x3f              ;2031
0020da  d901              BLS      |L1.8416|
0020dc  f04f0400          MOV      r4,#0                 ;2031
                  |L1.8416|
0020e0  b221              SXTH     r1,r4                 ;2032
0020e2  4630              MOV      r0,r6                 ;2032
0020e4  f7fffffe          BL       lc640_write_int
0020e8  f6406702          MOV      r7,#0xe02             ;2034
0020ec  4638              MOV      r0,r7                 ;2034
0020ee  f7fffffe          BL       lc640_read_int
0020f2  283f              CMP      r0,#0x3f              ;2035
0020f4  d000              BEQ      |L1.8440|
0020f6  4620              MOV      r0,r4                 ;2035
                  |L1.8440|
0020f8  b201              SXTH     r1,r0                 ;2036
0020fa  4638              MOV      r0,r7                 ;2036
0020fc  f7fffffe          BL       lc640_write_int
002100  4630              MOV      r0,r6                 ;2038
002102  f7fffffe          BL       lc640_read_int
002106  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2038
00210a  f04f0073          MOV      r0,#0x73              ;2040
00210e  f88d0000          STRB     r0,[sp,#0]            ;2040
002112  f88d9001          STRB     r9,[sp,#1]            ;2041
002116  2d05              CMP      r5,#5                 ;2042
002118  d103              BNE      |L1.8482|
00211a  f04f0061          MOV      r0,#0x61              ;2042
00211e  f88d0001          STRB     r0,[sp,#1]            ;2042
                  |L1.8482|
002122  f04f005a          MOV      r0,#0x5a              ;2043
002126  f88d0002          STRB     r0,[sp,#2]            ;2043
00212a  f88d9003          STRB     r9,[sp,#3]            ;2044
00212e  4669              MOV      r1,sp                 ;2045
002130  4620              MOV      r0,r4                 ;2045
002132  f7fffffe          BL       lc640_write_long_ptr
002136  f8cd9000          STR      r9,[sp,#0]            ;2050
00213a  4669              MOV      r1,sp                 ;2051
00213c  1d20              ADDS     r0,r4,#4              ;2051
00213e  f7fffffe          BL       lc640_write_long_ptr
002142  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2053
002146  f88d0000          STRB     r0,[sp,#0]            ;2053
00214a  f8980038          LDRB     r0,[r8,#0x38]         ;2054
00214e  f88d0001          STRB     r0,[sp,#1]            ;2054
002152  f898002c          LDRB     r0,[r8,#0x2c]         ;2055
002156  f88d0002          STRB     r0,[sp,#2]            ;2055
00215a  f88d9003          STRB     r9,[sp,#3]            ;2056
00215e  4669              MOV      r1,sp                 ;2057
002160  f1040008          ADD      r0,r4,#8              ;2057
002164  f7fffffe          BL       lc640_write_long_ptr
002168  f8980028          LDRB     r0,[r8,#0x28]         ;2059
00216c  f88d0000          STRB     r0,[sp,#0]            ;2059
002170  f8980024          LDRB     r0,[r8,#0x24]         ;2060
002174  f88d0001          STRB     r0,[sp,#1]            ;2060
002178  f8980020          LDRB     r0,[r8,#0x20]         ;2061
00217c  f88d0002          STRB     r0,[sp,#2]            ;2061
002180  f88d9003          STRB     r9,[sp,#3]            ;2062
002184  4669              MOV      r1,sp                 ;2063
002186  f104000c          ADD      r0,r4,#0xc            ;2063
00218a  f7fffffe          BL       lc640_write_long_ptr
00218e  f04f0541          MOV      r5,#0x41              ;2065
002192  f88d5000          STRB     r5,[sp,#0]            ;2065
002196  f88d5001          STRB     r5,[sp,#1]            ;2066
00219a  f88d5002          STRB     r5,[sp,#2]            ;2067
00219e  f88d5003          STRB     r5,[sp,#3]            ;2068
0021a2  4669              MOV      r1,sp                 ;2069
0021a4  e002              B        |L1.8620|
                  |L1.8614|
0021a6  e034              B        |L1.8722|
                  |L1.8616|
0021a8  e032              B        |L1.8720|
                  |L1.8618|
0021aa  e0bb              B        |L1.8996|
                  |L1.8620|
0021ac  f1040010          ADD      r0,r4,#0x10           ;2069
0021b0  f7fffffe          BL       lc640_write_long_ptr
0021b4  f88d5000          STRB     r5,[sp,#0]            ;2071
0021b8  f88d5001          STRB     r5,[sp,#1]            ;2072
0021bc  f88d5002          STRB     r5,[sp,#2]            ;2073
0021c0  f88d5003          STRB     r5,[sp,#3]            ;2074
0021c4  4669              MOV      r1,sp                 ;2075
0021c6  f1040014          ADD      r0,r4,#0x14           ;2075
0021ca  f7fffffe          BL       lc640_write_long_ptr
0021ce  f88d5000          STRB     r5,[sp,#0]            ;2077
0021d2  f88d5001          STRB     r5,[sp,#1]            ;2078
0021d6  f88d5002          STRB     r5,[sp,#2]            ;2079
0021da  f88d5003          STRB     r5,[sp,#3]            ;2080
0021de  e005              B        |L1.8684|
                  |L1.8672|
                          DCD      ke_date
                  |L1.8676|
                          DCD      0x40024020
                  |L1.8680|
                          DCD      0x40024000
                  |L1.8684|
0021ec  4669              MOV      r1,sp                 ;2081
0021ee  f1040018          ADD      r0,r4,#0x18           ;2081
0021f2  f7fffffe          BL       lc640_write_long_ptr
0021f6  f88d5000          STRB     r5,[sp,#0]            ;2083
0021fa  f88d5001          STRB     r5,[sp,#1]            ;2084
0021fe  f88d5002          STRB     r5,[sp,#2]            ;2085
002202  f88d5003          STRB     r5,[sp,#3]            ;2086
002206  4669              MOV      r1,sp                 ;2087
002208  f104001c          ADD      r0,r4,#0x1c           ;2087
00220c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8720|
;;;2167        		{        
;;;2168        		if(event_ptr_find)event_ptr_find--;
;;;2169        		else event_ptr_find=63;
;;;2170        		if(event_ptr_find==event_ptr)
;;;2171   				{
;;;2172   				lc640_adr=0;
;;;2173   				break;
;;;2174   				}
;;;2175        		else continue;
;;;2176        		}
;;;2177        	else 
;;;2178        		{
;;;2179        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2180        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2181        			{        
;;;2182        			if(event_ptr_find)event_ptr_find--;
;;;2183            		else event_ptr_find=63;
;;;2184            		if(event_ptr_find==event_ptr)
;;;2185   					{
;;;2186   					lc640_adr=0;
;;;2187   					break;
;;;2188   					}
;;;2189        			else continue;
;;;2190        			}
;;;2191        		}	
;;;2192   		}
;;;2193   	if(lc640_adr!=0)
;;;2194   		{
;;;2195   		data[0]=LPC_RTC->YEAR;
;;;2196   		data[1]=LPC_RTC->MONTH;
;;;2197   		data[2]=LPC_RTC->DOM;
;;;2198   		data[3]=0;
;;;2199   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2200   	
;;;2201   		data[0]=LPC_RTC->HOUR;
;;;2202   		data[1]=LPC_RTC->MIN;
;;;2203   		data[2]=LPC_RTC->SEC;
;;;2204   		data[3]=0;
;;;2205   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2206   		
;;;2207   		data[0]='B';
;;;2208   		data[1]='B';
;;;2209   		data[2]='B';
;;;2210   		data[3]='B';
;;;2211   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2212   		
;;;2213   		data[0]='B';
;;;2214   		data[1]='B';
;;;2215   		data[2]='B';
;;;2216   		data[3]='B';
;;;2217   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2218   		}
;;;2219   	}
;;;2220   }
002210  e4fb              B        |L1.7178|
                  |L1.8722|
002212  f04f0700          MOV      r7,#0                 ;2095
                  |L1.8726|
002216  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2097
00221a  4669              MOV      r1,sp                 ;2099
00221c  4628              MOV      r0,r5                 ;2099
00221e  f7fffffe          BL       lc640_read_long_ptr
002222  f89d0000          LDRB     r0,[sp,#0]            ;2101
002226  2873              CMP      r0,#0x73              ;2101
002228  d103              BNE      |L1.8754|
00222a  f89d0002          LDRB     r0,[sp,#2]            ;2101
00222e  285a              CMP      r0,#0x5a              ;2101
002230  d00a              BEQ      |L1.8776|
                  |L1.8754|
002232  b114              CBZ      r4,|L1.8762|
002234  f1a40401          SUB      r4,r4,#1              ;2103
002238  e001              B        |L1.8766|
                  |L1.8762|
00223a  f04f043f          MOV      r4,#0x3f              ;2104
                  |L1.8766|
00223e  42b4              CMP      r4,r6                 ;2105
002240  d122              BNE      |L1.8840|
002242  f04f0500          MOV      r5,#0                 ;2107
002246  e024              B        |L1.8850|
                  |L1.8776|
002248  4669              MOV      r1,sp                 ;2114
00224a  f1050010          ADD      r0,r5,#0x10           ;2114
00224e  f7fffffe          BL       lc640_read_long_ptr
002252  f89d0000          LDRB     r0,[sp,#0]            ;2115
002256  2841              CMP      r0,#0x41              ;2115
002258  d10b              BNE      |L1.8818|
00225a  f89d0001          LDRB     r0,[sp,#1]            ;2115
00225e  2841              CMP      r0,#0x41              ;2115
002260  d107              BNE      |L1.8818|
002262  f89d0002          LDRB     r0,[sp,#2]            ;2115
002266  2841              CMP      r0,#0x41              ;2115
002268  d103              BNE      |L1.8818|
00226a  f89d0003          LDRB     r0,[sp,#3]            ;2115
00226e  2841              CMP      r0,#0x41              ;2115
002270  d00a              BEQ      |L1.8840|
                  |L1.8818|
002272  b114              CBZ      r4,|L1.8826|
002274  f1a40401          SUB      r4,r4,#1              ;2117
002278  e001              B        |L1.8830|
                  |L1.8826|
00227a  f04f043f          MOV      r4,#0x3f              ;2118
                  |L1.8830|
00227e  42b4              CMP      r4,r6                 ;2119
002280  d102              BNE      |L1.8840|
002282  f04f0500          MOV      r5,#0                 ;2121
002286  e004              B        |L1.8850|
                  |L1.8840|
002288  f1070701          ADD      r7,r7,#1              ;2095
00228c  b2ff              UXTB     r7,r7                 ;2095
00228e  2f3f              CMP      r7,#0x3f              ;2095
002290  d3c1              BCC      |L1.8726|
                  |L1.8850|
002292  2d00              CMP      r5,#0                 ;2128
002294  d0bc              BEQ      |L1.8720|
002296  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2130
00229a  f88d0000          STRB     r0,[sp,#0]            ;2130
00229e  f8980038          LDRB     r0,[r8,#0x38]         ;2131
0022a2  f88d0001          STRB     r0,[sp,#1]            ;2131
0022a6  f898002c          LDRB     r0,[r8,#0x2c]         ;2132
0022aa  f88d0002          STRB     r0,[sp,#2]            ;2132
0022ae  f88d9003          STRB     r9,[sp,#3]            ;2133
0022b2  4669              MOV      r1,sp                 ;2134
0022b4  f1050010          ADD      r0,r5,#0x10           ;2134
0022b8  f7fffffe          BL       lc640_write_long_ptr
0022bc  f8980028          LDRB     r0,[r8,#0x28]         ;2136
0022c0  f88d0000          STRB     r0,[sp,#0]            ;2136
0022c4  f8980024          LDRB     r0,[r8,#0x24]         ;2137
0022c8  f88d0001          STRB     r0,[sp,#1]            ;2137
0022cc  f8980020          LDRB     r0,[r8,#0x20]         ;2138
0022d0  f88d0002          STRB     r0,[sp,#2]            ;2138
0022d4  f88d9003          STRB     r9,[sp,#3]            ;2139
0022d8  4669              MOV      r1,sp                 ;2140
0022da  f1050014          ADD      r0,r5,#0x14           ;2140
0022de  f7fffffe          BL       lc640_write_long_ptr
0022e2  f04f0443          MOV      r4,#0x43              ;2142
0022e6  f88d4000          STRB     r4,[sp,#0]            ;2142
0022ea  f88d4001          STRB     r4,[sp,#1]            ;2143
0022ee  f88d4002          STRB     r4,[sp,#2]            ;2144
0022f2  f88d4003          STRB     r4,[sp,#3]            ;2145
0022f6  4669              MOV      r1,sp                 ;2146
0022f8  f1050018          ADD      r0,r5,#0x18           ;2146
0022fc  f7fffffe          BL       lc640_write_long_ptr
002300  f88d4000          STRB     r4,[sp,#0]            ;2148
002304  f88d4001          STRB     r4,[sp,#1]            ;2149
002308  f88d4002          STRB     r4,[sp,#2]            ;2150
00230c  f88d4003          STRB     r4,[sp,#3]            ;2151
002310  4669              MOV      r1,sp                 ;2152
002312  f105001c          ADD      r0,r5,#0x1c           ;2152
002316  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8986|
00231a  e476              B        |L1.7178|
                  |L1.8988|
00231c  f89d0002          LDRB     r0,[sp,#2]            ;2166
002320  285a              CMP      r0,#0x5a              ;2166
002322  d00a              BEQ      |L1.9018|
                  |L1.8996|
002324  b114              CBZ      r4,|L1.9004|
002326  f1a40401          SUB      r4,r4,#1              ;2168
00232a  e001              B        |L1.9008|
                  |L1.9004|
00232c  f04f043f          MOV      r4,#0x3f              ;2169
                  |L1.9008|
002330  42b4              CMP      r4,r6                 ;2170
002332  d122              BNE      |L1.9082|
002334  f04f0500          MOV      r5,#0                 ;2172
002338  e025              B        |L1.9094|
                  |L1.9018|
00233a  4669              MOV      r1,sp                 ;2179
00233c  f1050010          ADD      r0,r5,#0x10           ;2179
002340  f7fffffe          BL       lc640_read_long_ptr
002344  f89d0000          LDRB     r0,[sp,#0]            ;2180
002348  2841              CMP      r0,#0x41              ;2180
00234a  d10b              BNE      |L1.9060|
00234c  f89d0001          LDRB     r0,[sp,#1]            ;2180
002350  2841              CMP      r0,#0x41              ;2180
002352  d107              BNE      |L1.9060|
002354  f89d0002          LDRB     r0,[sp,#2]            ;2180
002358  2841              CMP      r0,#0x41              ;2180
00235a  d103              BNE      |L1.9060|
00235c  f89d0003          LDRB     r0,[sp,#3]            ;2180
002360  2841              CMP      r0,#0x41              ;2180
002362  d00a              BEQ      |L1.9082|
                  |L1.9060|
002364  b114              CBZ      r4,|L1.9068|
002366  f1a40401          SUB      r4,r4,#1              ;2182
00236a  e001              B        |L1.9072|
                  |L1.9068|
00236c  f04f043f          MOV      r4,#0x3f              ;2183
                  |L1.9072|
002370  42b4              CMP      r4,r6                 ;2184
002372  d102              BNE      |L1.9082|
002374  f04f0500          MOV      r5,#0                 ;2186
002378  e005              B        |L1.9094|
                  |L1.9082|
00237a  f1070701          ADD      r7,r7,#1              ;2160
00237e  b2ff              UXTB     r7,r7                 ;2160
002380  2f3f              CMP      r7,#0x3f              ;2160
002382  f4ffae96          BCC      |L1.8370|
                  |L1.9094|
002386  2d00              CMP      r5,#0                 ;2193
002388  d0c7              BEQ      |L1.8986|
00238a  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2195
00238e  f88d0000          STRB     r0,[sp,#0]            ;2195
002392  f8980038          LDRB     r0,[r8,#0x38]         ;2196
002396  f88d0001          STRB     r0,[sp,#1]            ;2196
00239a  f898002c          LDRB     r0,[r8,#0x2c]         ;2197
00239e  f88d0002          STRB     r0,[sp,#2]            ;2197
0023a2  f88d9003          STRB     r9,[sp,#3]            ;2198
0023a6  4669              MOV      r1,sp                 ;2199
0023a8  f1050010          ADD      r0,r5,#0x10           ;2199
0023ac  f7fffffe          BL       lc640_write_long_ptr
0023b0  f8980028          LDRB     r0,[r8,#0x28]         ;2201
0023b4  f88d0000          STRB     r0,[sp,#0]            ;2201
0023b8  f8980024          LDRB     r0,[r8,#0x24]         ;2202
0023bc  f88d0001          STRB     r0,[sp,#1]            ;2202
0023c0  f8980020          LDRB     r0,[r8,#0x20]         ;2203
0023c4  f88d0002          STRB     r0,[sp,#2]            ;2203
0023c8  f88d9003          STRB     r9,[sp,#3]            ;2204
0023cc  4669              MOV      r1,sp                 ;2205
0023ce  f1050014          ADD      r0,r5,#0x14           ;2205
0023d2  f7fffffe          BL       lc640_write_long_ptr
0023d6  f04f0442          MOV      r4,#0x42              ;2207
0023da  f88d4000          STRB     r4,[sp,#0]            ;2207
0023de  f88d4001          STRB     r4,[sp,#1]            ;2208
0023e2  f88d4002          STRB     r4,[sp,#2]            ;2209
0023e6  f88d4003          STRB     r4,[sp,#3]            ;2210
0023ea  4669              MOV      r1,sp                 ;2211
0023ec  f1050018          ADD      r0,r5,#0x18           ;2211
0023f0  f7fffffe          BL       lc640_write_long_ptr
0023f4  f88d4000          STRB     r4,[sp,#0]            ;2213
0023f8  f88d4001          STRB     r4,[sp,#1]            ;2214
0023fc  f88d4002          STRB     r4,[sp,#2]            ;2215
002400  f88d4003          STRB     r4,[sp,#3]            ;2216
002404  4669              MOV      r1,sp                 ;2217
002406  f105001c          ADD      r0,r5,#0x1c           ;2217
00240a  f7fffffe          BL       lc640_write_long_ptr
00240e  e63a              B        |L1.8326|
;;;2221     
                          ENDP

                  uz_mem_hndl PROC
;;;2223   //-----------------------------------------------
;;;2224   void uz_mem_hndl(unsigned short in)	 //   
002410  e92d4ff8          PUSH     {r3-r11,lr}
;;;2225   {
;;;2226   char data[4];
;;;2227   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
002414  f04f0600          MOV      r6,#0
002418  4634              MOV      r4,r6
;;;2228   //char avar_simbol;
;;;2229   
;;;2230   if(in==1) //  
;;;2231   	{
;;;2232   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2233   	event_ptr++;	
;;;2234   	if(event_ptr>63)event_ptr=0;	
;;;2235   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2236   	
;;;2237       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2238   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2239   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2240   	
;;;2241   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2242   	
;;;2243   	data[0]='u';
;;;2244   	data[1]=0; 
;;;2245   	data[2]='Z';
;;;2246   	data[3]=0;
;;;2247   	lc640_write_long_ptr(lc640_adr,data);
;;;2248   
;;;2249   	data[0]=0;
;;;2250   	data[1]=0;
;;;2251   	data[2]=0;
;;;2252   	data[3]=0;
;;;2253   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2254   
;;;2255   	data[0]=LPC_RTC->YEAR;
00241a  f8df86c4          LDR      r8,|L1.10976|
00241e  46a1              MOV      r9,r4                 ;2227
002420  f44f6a80          MOV      r10,#0x400            ;2241
002424  2801              CMP      r0,#1                 ;2230
002426  d010              BEQ      |L1.9290|
;;;2256   	data[1]=LPC_RTC->MONTH;
;;;2257   	data[2]=LPC_RTC->DOM;
;;;2258   	data[3]=0;
;;;2259   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2260   
;;;2261   	data[0]=LPC_RTC->HOUR;
;;;2262   	data[1]=LPC_RTC->MIN;
;;;2263   	data[2]=LPC_RTC->SEC;
;;;2264   	data[3]=0;
;;;2265   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2266   	
;;;2267   	data[0]='A';
;;;2268   	data[1]='A';
;;;2269   	data[2]='A';
;;;2270   	data[3]='A';
;;;2271   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2272   	
;;;2273   	data[0]='A';
;;;2274   	data[1]='A';
;;;2275   	data[2]='A';
;;;2276   	data[3]='A';
;;;2277   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2278   	
;;;2279   	data[0]='A';
;;;2280   	data[1]='A';
;;;2281   	data[2]='A';
;;;2282   	data[3]='A';
;;;2283   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2284   	
;;;2285   	data[0]='A';
;;;2286   	data[1]='A';
;;;2287   	data[2]='A';
;;;2288   	data[3]='A';
;;;2289   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2290    	
;;;2291   	}
;;;2292   
;;;2293   else if(in==0)	// 
002428  2800              CMP      r0,#0
00242a  d07d              BEQ      |L1.9512|
;;;2294   	{      
;;;2295   	char i;     
;;;2296   	event_ptr_find=0;
;;;2297   	for (i=0;i<63;i++)
;;;2298   		{
;;;2299   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2300   
;;;2301        	lc640_read_long_ptr(lc640_adr,data);
;;;2302        
;;;2303        	if(!((data[0]=='u')&&(data[2]=='Z')))
;;;2304        		{        
;;;2305        		if(event_ptr_find)event_ptr_find--;
;;;2306        		else event_ptr_find=63;
;;;2307        		if(event_ptr_find==event_ptr)
;;;2308   				{
;;;2309   				lc640_adr=0;
;;;2310   				break;
;;;2311   				}
;;;2312        		else continue;
;;;2313        		}
;;;2314        	else 
;;;2315        		{
;;;2316        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2317        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2318        			{        
;;;2319        			if(event_ptr_find)event_ptr_find--;
;;;2320            		else event_ptr_find=63;
;;;2321            		if(event_ptr_find==event_ptr)
;;;2322   					{
;;;2323   					lc640_adr=0;
;;;2324   					break;
;;;2325   					}
;;;2326        			else continue;
;;;2327        			}
;;;2328        		}	
;;;2329   		}
;;;2330   	if(lc640_adr!=0)
;;;2331   		{
;;;2332   		data[0]=LPC_RTC->YEAR;
;;;2333   		data[1]=LPC_RTC->MONTH;
;;;2334   		data[2]=LPC_RTC->DOM;
;;;2335   		data[3]=0;
;;;2336   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2337   	
;;;2338   		data[0]=LPC_RTC->HOUR;
;;;2339   		data[1]=LPC_RTC->MIN;
;;;2340   		data[2]=LPC_RTC->SEC;
;;;2341   		data[3]=0;
;;;2342   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2343   		
;;;2344   		data[0]='C';
;;;2345   		data[1]='C';
;;;2346   		data[2]='C';
;;;2347   		data[3]='C';
;;;2348   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2349   		
;;;2350   		data[0]='C';
;;;2351   		data[1]='C';
;;;2352   		data[2]='C';
;;;2353   		data[3]='C';
;;;2354   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2355   		}
;;;2356   	}
;;;2357   else if(in==10) 	//  
00242c  280a              CMP      r0,#0xa
00242e  d17c              BNE      |L1.9514|
;;;2358   	{      
;;;2359   	char i;     
;;;2360   
;;;2361   	event_ptr_find=0;
;;;2362   	for (i=0;i<63;i++)
002430  f04f0700          MOV      r7,#0
                  |L1.9268|
;;;2363   		{
;;;2364   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
002434  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2365   
;;;2366        	lc640_read_long_ptr(lc640_adr,data);
002438  4669              MOV      r1,sp
00243a  4628              MOV      r0,r5
00243c  f7fffffe          BL       lc640_read_long_ptr
;;;2367        
;;;2368        	if(!((data[0]=='u')&&(data[2]=='Z')))
002440  f89d0000          LDRB     r0,[sp,#0]
002444  2875              CMP      r0,#0x75
002446  d171              BNE      |L1.9516|
002448  e11c              B        |L1.9860|
                  |L1.9290|
00244a  f44f6560          MOV      r5,#0xe00             ;2232
00244e  4628              MOV      r0,r5                 ;2232
002450  f7fffffe          BL       lc640_read_int
002454  f1000001          ADD      r0,r0,#1              ;2233
002458  4604              MOV      r4,r0                 ;2233
00245a  2c3f              CMP      r4,#0x3f              ;2234
00245c  d901              BLS      |L1.9314|
00245e  f04f0400          MOV      r4,#0                 ;2234
                  |L1.9314|
002462  b221              SXTH     r1,r4                 ;2235
002464  4628              MOV      r0,r5                 ;2235
002466  f7fffffe          BL       lc640_write_int
00246a  f6406602          MOV      r6,#0xe02             ;2237
00246e  4630              MOV      r0,r6                 ;2237
002470  f7fffffe          BL       lc640_read_int
002474  283f              CMP      r0,#0x3f              ;2238
002476  d000              BEQ      |L1.9338|
002478  4620              MOV      r0,r4                 ;2238
                  |L1.9338|
00247a  b201              SXTH     r1,r0                 ;2239
00247c  4630              MOV      r0,r6                 ;2239
00247e  f7fffffe          BL       lc640_write_int
002482  4628              MOV      r0,r5                 ;2241
002484  f7fffffe          BL       lc640_read_int
002488  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2241
00248c  f04f0075          MOV      r0,#0x75              ;2243
002490  f88d0000          STRB     r0,[sp,#0]            ;2243
002494  f88d9001          STRB     r9,[sp,#1]            ;2244
002498  f04f005a          MOV      r0,#0x5a              ;2245
00249c  f88d0002          STRB     r0,[sp,#2]            ;2245
0024a0  f88d9003          STRB     r9,[sp,#3]            ;2246
0024a4  4669              MOV      r1,sp                 ;2247
0024a6  4620              MOV      r0,r4                 ;2247
0024a8  f7fffffe          BL       lc640_write_long_ptr
0024ac  f8cd9000          STR      r9,[sp,#0]            ;2252
0024b0  4669              MOV      r1,sp                 ;2253
0024b2  1d20              ADDS     r0,r4,#4              ;2253
0024b4  f7fffffe          BL       lc640_write_long_ptr
0024b8  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2255
0024bc  f88d0000          STRB     r0,[sp,#0]            ;2255
0024c0  f8980038          LDRB     r0,[r8,#0x38]         ;2256
0024c4  f88d0001          STRB     r0,[sp,#1]            ;2256
0024c8  f898002c          LDRB     r0,[r8,#0x2c]         ;2257
0024cc  f88d0002          STRB     r0,[sp,#2]            ;2257
0024d0  f88d9003          STRB     r9,[sp,#3]            ;2258
0024d4  4669              MOV      r1,sp                 ;2259
0024d6  f1040008          ADD      r0,r4,#8              ;2259
0024da  f7fffffe          BL       lc640_write_long_ptr
0024de  f8980028          LDRB     r0,[r8,#0x28]         ;2261
0024e2  f88d0000          STRB     r0,[sp,#0]            ;2261
0024e6  f8980024          LDRB     r0,[r8,#0x24]         ;2262
0024ea  f88d0001          STRB     r0,[sp,#1]            ;2262
0024ee  f8980020          LDRB     r0,[r8,#0x20]         ;2263
0024f2  f88d0002          STRB     r0,[sp,#2]            ;2263
0024f6  f88d9003          STRB     r9,[sp,#3]            ;2264
0024fa  4669              MOV      r1,sp                 ;2265
0024fc  f104000c          ADD      r0,r4,#0xc            ;2265
002500  f7fffffe          BL       lc640_write_long_ptr
002504  f04f0541          MOV      r5,#0x41              ;2267
002508  f88d5000          STRB     r5,[sp,#0]            ;2267
00250c  f88d5001          STRB     r5,[sp,#1]            ;2268
002510  f88d5002          STRB     r5,[sp,#2]            ;2269
002514  f88d5003          STRB     r5,[sp,#3]            ;2270
002518  4669              MOV      r1,sp                 ;2271
00251a  f1040010          ADD      r0,r4,#0x10           ;2271
00251e  f7fffffe          BL       lc640_write_long_ptr
002522  f88d5000          STRB     r5,[sp,#0]            ;2273
002526  e002              B        |L1.9518|
                  |L1.9512|
002528  e027              B        |L1.9594|
                  |L1.9514|
00252a  e025              B        |L1.9592|
                  |L1.9516|
00252c  e0ae              B        |L1.9868|
                  |L1.9518|
00252e  f88d5001          STRB     r5,[sp,#1]            ;2274
002532  f88d5002          STRB     r5,[sp,#2]            ;2275
002536  f88d5003          STRB     r5,[sp,#3]            ;2276
00253a  4669              MOV      r1,sp                 ;2277
00253c  f1040014          ADD      r0,r4,#0x14           ;2277
002540  f7fffffe          BL       lc640_write_long_ptr
002544  f88d5000          STRB     r5,[sp,#0]            ;2279
002548  f88d5001          STRB     r5,[sp,#1]            ;2280
00254c  f88d5002          STRB     r5,[sp,#2]            ;2281
002550  f88d5003          STRB     r5,[sp,#3]            ;2282
002554  4669              MOV      r1,sp                 ;2283
002556  f1040018          ADD      r0,r4,#0x18           ;2283
00255a  f7fffffe          BL       lc640_write_long_ptr
00255e  f88d5000          STRB     r5,[sp,#0]            ;2285
002562  f88d5001          STRB     r5,[sp,#1]            ;2286
002566  f88d5002          STRB     r5,[sp,#2]            ;2287
00256a  f88d5003          STRB     r5,[sp,#3]            ;2288
00256e  4669              MOV      r1,sp                 ;2289
002570  f104001c          ADD      r0,r4,#0x1c           ;2289
002574  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9592|
;;;2369        		{        
;;;2370        		if(event_ptr_find)event_ptr_find--;
;;;2371        		else event_ptr_find=63;
;;;2372        		if(event_ptr_find==event_ptr)
;;;2373   				{
;;;2374   				lc640_adr=0;
;;;2375   				break;
;;;2376   				}
;;;2377        		else continue;
;;;2378        		}
;;;2379        	else 
;;;2380        		{
;;;2381        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2382        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2383        			{        
;;;2384        			if(event_ptr_find)event_ptr_find--;
;;;2385            		else event_ptr_find=63;
;;;2386            		if(event_ptr_find==event_ptr)
;;;2387   					{
;;;2388   					lc640_adr=0;
;;;2389   					break;
;;;2390   					}
;;;2391        			else continue;
;;;2392        			}
;;;2393        		}	
;;;2394   		}
;;;2395   	if(lc640_adr!=0)
;;;2396   		{
;;;2397   		data[0]=LPC_RTC->YEAR;
;;;2398   		data[1]=LPC_RTC->MONTH;
;;;2399   		data[2]=LPC_RTC->DOM;
;;;2400   		data[3]=0;
;;;2401   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2402   	
;;;2403   		data[0]=LPC_RTC->HOUR;
;;;2404   		data[1]=LPC_RTC->MIN;
;;;2405   		data[2]=LPC_RTC->SEC;
;;;2406   		data[3]=0;
;;;2407   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2408   		
;;;2409   		data[0]='B';
;;;2410   		data[1]='B';
;;;2411   		data[2]='B';
;;;2412   		data[3]='B';
;;;2413   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2414   		
;;;2415   		data[0]='B';
;;;2416   		data[1]='B';
;;;2417   		data[2]='B';
;;;2418   		data[3]='B';
;;;2419   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2420   		}
;;;2421   	}
;;;2422   }
002578  e585              B        |L1.8326|
                  |L1.9594|
00257a  f04f0700          MOV      r7,#0                 ;2297
                  |L1.9598|
00257e  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2299
002582  4669              MOV      r1,sp                 ;2301
002584  4628              MOV      r0,r5                 ;2301
002586  f7fffffe          BL       lc640_read_long_ptr
00258a  f89d0000          LDRB     r0,[sp,#0]            ;2303
00258e  2875              CMP      r0,#0x75              ;2303
002590  d103              BNE      |L1.9626|
002592  f89d0002          LDRB     r0,[sp,#2]            ;2303
002596  285a              CMP      r0,#0x5a              ;2303
002598  d00a              BEQ      |L1.9648|
                  |L1.9626|
00259a  b114              CBZ      r4,|L1.9634|
00259c  f1a40401          SUB      r4,r4,#1              ;2305
0025a0  e001              B        |L1.9638|
                  |L1.9634|
0025a2  f04f043f          MOV      r4,#0x3f              ;2306
                  |L1.9638|
0025a6  42b4              CMP      r4,r6                 ;2307
0025a8  d122              BNE      |L1.9712|
0025aa  f04f0500          MOV      r5,#0                 ;2309
0025ae  e024              B        |L1.9722|
                  |L1.9648|
0025b0  4669              MOV      r1,sp                 ;2316
0025b2  f1050010          ADD      r0,r5,#0x10           ;2316
0025b6  f7fffffe          BL       lc640_read_long_ptr
0025ba  f89d0000          LDRB     r0,[sp,#0]            ;2317
0025be  2841              CMP      r0,#0x41              ;2317
0025c0  d10b              BNE      |L1.9690|
0025c2  f89d0001          LDRB     r0,[sp,#1]            ;2317
0025c6  2841              CMP      r0,#0x41              ;2317
0025c8  d107              BNE      |L1.9690|
0025ca  f89d0002          LDRB     r0,[sp,#2]            ;2317
0025ce  2841              CMP      r0,#0x41              ;2317
0025d0  d103              BNE      |L1.9690|
0025d2  f89d0003          LDRB     r0,[sp,#3]            ;2317
0025d6  2841              CMP      r0,#0x41              ;2317
0025d8  d00a              BEQ      |L1.9712|
                  |L1.9690|
0025da  b114              CBZ      r4,|L1.9698|
0025dc  f1a40401          SUB      r4,r4,#1              ;2319
0025e0  e001              B        |L1.9702|
                  |L1.9698|
0025e2  f04f043f          MOV      r4,#0x3f              ;2320
                  |L1.9702|
0025e6  42b4              CMP      r4,r6                 ;2321
0025e8  d102              BNE      |L1.9712|
0025ea  f04f0500          MOV      r5,#0                 ;2323
0025ee  e004              B        |L1.9722|
                  |L1.9712|
0025f0  f1070701          ADD      r7,r7,#1              ;2297
0025f4  b2ff              UXTB     r7,r7                 ;2297
0025f6  2f3f              CMP      r7,#0x3f              ;2297
0025f8  d3c1              BCC      |L1.9598|
                  |L1.9722|
0025fa  2d00              CMP      r5,#0                 ;2330
0025fc  d0bc              BEQ      |L1.9592|
0025fe  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2332
002602  f88d0000          STRB     r0,[sp,#0]            ;2332
002606  f8980038          LDRB     r0,[r8,#0x38]         ;2333
00260a  f88d0001          STRB     r0,[sp,#1]            ;2333
00260e  f898002c          LDRB     r0,[r8,#0x2c]         ;2334
002612  f88d0002          STRB     r0,[sp,#2]            ;2334
002616  f88d9003          STRB     r9,[sp,#3]            ;2335
00261a  4669              MOV      r1,sp                 ;2336
00261c  f1050010          ADD      r0,r5,#0x10           ;2336
002620  f7fffffe          BL       lc640_write_long_ptr
002624  f8980028          LDRB     r0,[r8,#0x28]         ;2338
002628  f88d0000          STRB     r0,[sp,#0]            ;2338
00262c  f8980024          LDRB     r0,[r8,#0x24]         ;2339
002630  f88d0001          STRB     r0,[sp,#1]            ;2339
002634  f8980020          LDRB     r0,[r8,#0x20]         ;2340
002638  f88d0002          STRB     r0,[sp,#2]            ;2340
00263c  f88d9003          STRB     r9,[sp,#3]            ;2341
002640  4669              MOV      r1,sp                 ;2342
002642  f1050014          ADD      r0,r5,#0x14           ;2342
002646  f7fffffe          BL       lc640_write_long_ptr
00264a  f04f0443          MOV      r4,#0x43              ;2344
00264e  f88d4000          STRB     r4,[sp,#0]            ;2344
002652  f88d4001          STRB     r4,[sp,#1]            ;2345
002656  f88d4002          STRB     r4,[sp,#2]            ;2346
00265a  f88d4003          STRB     r4,[sp,#3]            ;2347
00265e  4669              MOV      r1,sp                 ;2348
002660  f1050018          ADD      r0,r5,#0x18           ;2348
002664  f7fffffe          BL       lc640_write_long_ptr
002668  f88d4000          STRB     r4,[sp,#0]            ;2350
00266c  f88d4001          STRB     r4,[sp,#1]            ;2351
002670  f88d4002          STRB     r4,[sp,#2]            ;2352
002674  f88d4003          STRB     r4,[sp,#3]            ;2353
002678  4669              MOV      r1,sp                 ;2354
00267a  f105001c          ADD      r0,r5,#0x1c           ;2354
00267e  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9858|
002682  e500              B        |L1.8326|
                  |L1.9860|
002684  f89d0002          LDRB     r0,[sp,#2]            ;2368
002688  285a              CMP      r0,#0x5a              ;2368
00268a  d00a              BEQ      |L1.9890|
                  |L1.9868|
00268c  b114              CBZ      r4,|L1.9876|
00268e  f1a40401          SUB      r4,r4,#1              ;2370
002692  e001              B        |L1.9880|
                  |L1.9876|
002694  f04f043f          MOV      r4,#0x3f              ;2371
                  |L1.9880|
002698  42b4              CMP      r4,r6                 ;2372
00269a  d122              BNE      |L1.9954|
00269c  f04f0500          MOV      r5,#0                 ;2374
0026a0  e025              B        |L1.9966|
                  |L1.9890|
0026a2  4669              MOV      r1,sp                 ;2381
0026a4  f1050010          ADD      r0,r5,#0x10           ;2381
0026a8  f7fffffe          BL       lc640_read_long_ptr
0026ac  f89d0000          LDRB     r0,[sp,#0]            ;2382
0026b0  2841              CMP      r0,#0x41              ;2382
0026b2  d10b              BNE      |L1.9932|
0026b4  f89d0001          LDRB     r0,[sp,#1]            ;2382
0026b8  2841              CMP      r0,#0x41              ;2382
0026ba  d107              BNE      |L1.9932|
0026bc  f89d0002          LDRB     r0,[sp,#2]            ;2382
0026c0  2841              CMP      r0,#0x41              ;2382
0026c2  d103              BNE      |L1.9932|
0026c4  f89d0003          LDRB     r0,[sp,#3]            ;2382
0026c8  2841              CMP      r0,#0x41              ;2382
0026ca  d00a              BEQ      |L1.9954|
                  |L1.9932|
0026cc  b114              CBZ      r4,|L1.9940|
0026ce  f1a40401          SUB      r4,r4,#1              ;2384
0026d2  e001              B        |L1.9944|
                  |L1.9940|
0026d4  f04f043f          MOV      r4,#0x3f              ;2385
                  |L1.9944|
0026d8  42b4              CMP      r4,r6                 ;2386
0026da  d102              BNE      |L1.9954|
0026dc  f04f0500          MOV      r5,#0                 ;2388
0026e0  e005              B        |L1.9966|
                  |L1.9954|
0026e2  f1070701          ADD      r7,r7,#1              ;2362
0026e6  b2ff              UXTB     r7,r7                 ;2362
0026e8  2f3f              CMP      r7,#0x3f              ;2362
0026ea  f4ffaea3          BCC      |L1.9268|
                  |L1.9966|
0026ee  2d00              CMP      r5,#0                 ;2395
0026f0  d0c7              BEQ      |L1.9858|
0026f2  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2397
0026f6  f88d0000          STRB     r0,[sp,#0]            ;2397
0026fa  f8980038          LDRB     r0,[r8,#0x38]         ;2398
0026fe  f88d0001          STRB     r0,[sp,#1]            ;2398
002702  f898002c          LDRB     r0,[r8,#0x2c]         ;2399
002706  f88d0002          STRB     r0,[sp,#2]            ;2399
00270a  f88d9003          STRB     r9,[sp,#3]            ;2400
00270e  4669              MOV      r1,sp                 ;2401
002710  f1050010          ADD      r0,r5,#0x10           ;2401
002714  f7fffffe          BL       lc640_write_long_ptr
002718  f8980028          LDRB     r0,[r8,#0x28]         ;2403
00271c  f88d0000          STRB     r0,[sp,#0]            ;2403
002720  f8980024          LDRB     r0,[r8,#0x24]         ;2404
002724  f88d0001          STRB     r0,[sp,#1]            ;2404
002728  f8980020          LDRB     r0,[r8,#0x20]         ;2405
00272c  f88d0002          STRB     r0,[sp,#2]            ;2405
002730  f88d9003          STRB     r9,[sp,#3]            ;2406
002734  4669              MOV      r1,sp                 ;2407
002736  f1050014          ADD      r0,r5,#0x14           ;2407
00273a  f7fffffe          BL       lc640_write_long_ptr
00273e  f04f0442          MOV      r4,#0x42              ;2409
002742  f88d4000          STRB     r4,[sp,#0]            ;2409
002746  f88d4001          STRB     r4,[sp,#1]            ;2410
00274a  f88d4002          STRB     r4,[sp,#2]            ;2411
00274e  f88d4003          STRB     r4,[sp,#3]            ;2412
002752  4669              MOV      r1,sp                 ;2413
002754  f1050018          ADD      r0,r5,#0x18           ;2413
002758  f7fffffe          BL       lc640_write_long_ptr
00275c  f88d4000          STRB     r4,[sp,#0]            ;2415
002760  f88d4001          STRB     r4,[sp,#1]            ;2416
002764  f88d4002          STRB     r4,[sp,#2]            ;2417
002768  f88d4003          STRB     r4,[sp,#3]            ;2418
00276c  4669              MOV      r1,sp                 ;2419
00276e  f105001c          ADD      r0,r5,#0x1c           ;2419
002772  f7fffffe          BL       lc640_write_long_ptr
002776  e486              B        |L1.8326|
;;;2423   
                          ENDP

                  fz_mem_hndl PROC
;;;2424   //-----------------------------------------------
;;;2425   void fz_mem_hndl(unsigned short in)	 //   
002778  e92d4ff8          PUSH     {r3-r11,lr}
;;;2426   {
;;;2427   char data[4];
;;;2428   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
00277c  f04f0600          MOV      r6,#0
002780  4634              MOV      r4,r6
;;;2429   //char avar_simbol;
;;;2430   
;;;2431   if(in==1) //  
;;;2432   	{
;;;2433   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2434   	event_ptr++;	
;;;2435   	if(event_ptr>63)event_ptr=0;	
;;;2436   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2437   	
;;;2438       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2439   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2440   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2441   	
;;;2442   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2443   	
;;;2444   	data[0]='f';
;;;2445   	data[1]=0; 
;;;2446   	data[2]='Z';
;;;2447   	data[3]=0;
;;;2448   	lc640_write_long_ptr(lc640_adr,data);
;;;2449   
;;;2450   	data[0]=0;
;;;2451   	data[1]=0;
;;;2452   	data[2]=0;
;;;2453   	data[3]=0;
;;;2454   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2455   
;;;2456   	data[0]=LPC_RTC->YEAR;
002782  f8df835c          LDR      r8,|L1.10976|
002786  46a1              MOV      r9,r4                 ;2428
002788  f44f6a80          MOV      r10,#0x400            ;2442
00278c  2801              CMP      r0,#1                 ;2431
00278e  d010              BEQ      |L1.10162|
;;;2457   	data[1]=LPC_RTC->MONTH;
;;;2458   	data[2]=LPC_RTC->DOM;
;;;2459   	data[3]=0;
;;;2460   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2461   
;;;2462   	data[0]=LPC_RTC->HOUR;
;;;2463   	data[1]=LPC_RTC->MIN;
;;;2464   	data[2]=LPC_RTC->SEC;
;;;2465   	data[3]=0;
;;;2466   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2467   	
;;;2468   	data[0]='A';
;;;2469   	data[1]='A';
;;;2470   	data[2]='A';
;;;2471   	data[3]='A';
;;;2472   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2473   	
;;;2474   	data[0]='A';
;;;2475   	data[1]='A';
;;;2476   	data[2]='A';
;;;2477   	data[3]='A';
;;;2478   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2479   	
;;;2480   	data[0]='A';
;;;2481   	data[1]='A';
;;;2482   	data[2]='A';
;;;2483   	data[3]='A';
;;;2484   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2485   	
;;;2486   	data[0]='A';
;;;2487   	data[1]='A';
;;;2488   	data[2]='A';
;;;2489   	data[3]='A';
;;;2490   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2491    	
;;;2492   	}
;;;2493   
;;;2494   else if(in==0)	// 
002790  2800              CMP      r0,#0
002792  d07d              BEQ      |L1.10384|
;;;2495   	{      
;;;2496   	char i;     
;;;2497   	event_ptr_find=0;
;;;2498   	for (i=0;i<63;i++)
;;;2499   		{
;;;2500   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2501   
;;;2502        	lc640_read_long_ptr(lc640_adr,data);
;;;2503        
;;;2504        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;2505        		{        
;;;2506        		if(event_ptr_find)event_ptr_find--;
;;;2507        		else event_ptr_find=63;
;;;2508        		if(event_ptr_find==event_ptr)
;;;2509   				{
;;;2510   				lc640_adr=0;
;;;2511   				break;
;;;2512   				}
;;;2513        		else continue;
;;;2514        		}
;;;2515        	else 
;;;2516        		{
;;;2517        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2518        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2519        			{        
;;;2520        			if(event_ptr_find)event_ptr_find--;
;;;2521            		else event_ptr_find=63;
;;;2522            		if(event_ptr_find==event_ptr)
;;;2523   					{
;;;2524   					lc640_adr=0;
;;;2525   					break;
;;;2526   					}
;;;2527        			else continue;
;;;2528        			}
;;;2529        		}	
;;;2530   		}
;;;2531   	if(lc640_adr!=0)
;;;2532   		{
;;;2533   		data[0]=LPC_RTC->YEAR;
;;;2534   		data[1]=LPC_RTC->MONTH;
;;;2535   		data[2]=LPC_RTC->DOM;
;;;2536   		data[3]=0;
;;;2537   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2538   	
;;;2539   		data[0]=LPC_RTC->HOUR;
;;;2540   		data[1]=LPC_RTC->MIN;
;;;2541   		data[2]=LPC_RTC->SEC;
;;;2542   		data[3]=0;
;;;2543   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2544   		
;;;2545   		data[0]='C';
;;;2546   		data[1]='C';
;;;2547   		data[2]='C';
;;;2548   		data[3]='C';
;;;2549   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2550   		
;;;2551   		data[0]='C';
;;;2552   		data[1]='C';
;;;2553   		data[2]='C';
;;;2554   		data[3]='C';
;;;2555   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2556   		}
;;;2557   	}
;;;2558   else if(in==10) 	//  
002794  280a              CMP      r0,#0xa
002796  d17c              BNE      |L1.10386|
;;;2559   	{      
;;;2560   	char i;     
;;;2561   
;;;2562   	event_ptr_find=0;
;;;2563   	for (i=0;i<63;i++)
002798  f04f0700          MOV      r7,#0
                  |L1.10140|
;;;2564   		{
;;;2565   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
00279c  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2566   
;;;2567        	lc640_read_long_ptr(lc640_adr,data);
0027a0  4669              MOV      r1,sp
0027a2  4628              MOV      r0,r5
0027a4  f7fffffe          BL       lc640_read_long_ptr
;;;2568        
;;;2569        	if(!((data[0]=='f')&&(data[2]=='Z')))
0027a8  f89d0000          LDRB     r0,[sp,#0]
0027ac  2866              CMP      r0,#0x66
0027ae  d171              BNE      |L1.10388|
0027b0  e11c              B        |L1.10732|
                  |L1.10162|
0027b2  f44f6560          MOV      r5,#0xe00             ;2433
0027b6  4628              MOV      r0,r5                 ;2433
0027b8  f7fffffe          BL       lc640_read_int
0027bc  f1000001          ADD      r0,r0,#1              ;2434
0027c0  4604              MOV      r4,r0                 ;2434
0027c2  2c3f              CMP      r4,#0x3f              ;2435
0027c4  d901              BLS      |L1.10186|
0027c6  f04f0400          MOV      r4,#0                 ;2435
                  |L1.10186|
0027ca  b221              SXTH     r1,r4                 ;2436
0027cc  4628              MOV      r0,r5                 ;2436
0027ce  f7fffffe          BL       lc640_write_int
0027d2  f6406602          MOV      r6,#0xe02             ;2438
0027d6  4630              MOV      r0,r6                 ;2438
0027d8  f7fffffe          BL       lc640_read_int
0027dc  283f              CMP      r0,#0x3f              ;2439
0027de  d000              BEQ      |L1.10210|
0027e0  4620              MOV      r0,r4                 ;2439
                  |L1.10210|
0027e2  b201              SXTH     r1,r0                 ;2440
0027e4  4630              MOV      r0,r6                 ;2440
0027e6  f7fffffe          BL       lc640_write_int
0027ea  4628              MOV      r0,r5                 ;2442
0027ec  f7fffffe          BL       lc640_read_int
0027f0  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2442
0027f4  f04f0066          MOV      r0,#0x66              ;2444
0027f8  f88d0000          STRB     r0,[sp,#0]            ;2444
0027fc  f88d9001          STRB     r9,[sp,#1]            ;2445
002800  f04f005a          MOV      r0,#0x5a              ;2446
002804  f88d0002          STRB     r0,[sp,#2]            ;2446
002808  f88d9003          STRB     r9,[sp,#3]            ;2447
00280c  4669              MOV      r1,sp                 ;2448
00280e  4620              MOV      r0,r4                 ;2448
002810  f7fffffe          BL       lc640_write_long_ptr
002814  f8cd9000          STR      r9,[sp,#0]            ;2453
002818  4669              MOV      r1,sp                 ;2454
00281a  1d20              ADDS     r0,r4,#4              ;2454
00281c  f7fffffe          BL       lc640_write_long_ptr
002820  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2456
002824  f88d0000          STRB     r0,[sp,#0]            ;2456
002828  f8980038          LDRB     r0,[r8,#0x38]         ;2457
00282c  f88d0001          STRB     r0,[sp,#1]            ;2457
002830  f898002c          LDRB     r0,[r8,#0x2c]         ;2458
002834  f88d0002          STRB     r0,[sp,#2]            ;2458
002838  f88d9003          STRB     r9,[sp,#3]            ;2459
00283c  4669              MOV      r1,sp                 ;2460
00283e  f1040008          ADD      r0,r4,#8              ;2460
002842  f7fffffe          BL       lc640_write_long_ptr
002846  f8980028          LDRB     r0,[r8,#0x28]         ;2462
00284a  f88d0000          STRB     r0,[sp,#0]            ;2462
00284e  f8980024          LDRB     r0,[r8,#0x24]         ;2463
002852  f88d0001          STRB     r0,[sp,#1]            ;2463
002856  f8980020          LDRB     r0,[r8,#0x20]         ;2464
00285a  f88d0002          STRB     r0,[sp,#2]            ;2464
00285e  f88d9003          STRB     r9,[sp,#3]            ;2465
002862  4669              MOV      r1,sp                 ;2466
002864  f104000c          ADD      r0,r4,#0xc            ;2466
002868  f7fffffe          BL       lc640_write_long_ptr
00286c  f04f0541          MOV      r5,#0x41              ;2468
002870  f88d5000          STRB     r5,[sp,#0]            ;2468
002874  f88d5001          STRB     r5,[sp,#1]            ;2469
002878  f88d5002          STRB     r5,[sp,#2]            ;2470
00287c  f88d5003          STRB     r5,[sp,#3]            ;2471
002880  4669              MOV      r1,sp                 ;2472
002882  f1040010          ADD      r0,r4,#0x10           ;2472
002886  f7fffffe          BL       lc640_write_long_ptr
00288a  f88d5000          STRB     r5,[sp,#0]            ;2474
00288e  e002              B        |L1.10390|
                  |L1.10384|
002890  e027              B        |L1.10466|
                  |L1.10386|
002892  e025              B        |L1.10464|
                  |L1.10388|
002894  e0ae              B        |L1.10740|
                  |L1.10390|
002896  f88d5001          STRB     r5,[sp,#1]            ;2475
00289a  f88d5002          STRB     r5,[sp,#2]            ;2476
00289e  f88d5003          STRB     r5,[sp,#3]            ;2477
0028a2  4669              MOV      r1,sp                 ;2478
0028a4  f1040014          ADD      r0,r4,#0x14           ;2478
0028a8  f7fffffe          BL       lc640_write_long_ptr
0028ac  f88d5000          STRB     r5,[sp,#0]            ;2480
0028b0  f88d5001          STRB     r5,[sp,#1]            ;2481
0028b4  f88d5002          STRB     r5,[sp,#2]            ;2482
0028b8  f88d5003          STRB     r5,[sp,#3]            ;2483
0028bc  4669              MOV      r1,sp                 ;2484
0028be  f1040018          ADD      r0,r4,#0x18           ;2484
0028c2  f7fffffe          BL       lc640_write_long_ptr
0028c6  f88d5000          STRB     r5,[sp,#0]            ;2486
0028ca  f88d5001          STRB     r5,[sp,#1]            ;2487
0028ce  f88d5002          STRB     r5,[sp,#2]            ;2488
0028d2  f88d5003          STRB     r5,[sp,#3]            ;2489
0028d6  4669              MOV      r1,sp                 ;2490
0028d8  f104001c          ADD      r0,r4,#0x1c           ;2490
0028dc  f7fffffe          BL       lc640_write_long_ptr
                  |L1.10464|
;;;2570        		{        
;;;2571        		if(event_ptr_find)event_ptr_find--;
;;;2572        		else event_ptr_find=63;
;;;2573        		if(event_ptr_find==event_ptr)
;;;2574   				{
;;;2575   				lc640_adr=0;
;;;2576   				break;
;;;2577   				}
;;;2578        		else continue;
;;;2579        		}
;;;2580        	else 
;;;2581        		{
;;;2582        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2583        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2584        			{        
;;;2585        			if(event_ptr_find)event_ptr_find--;
;;;2586            		else event_ptr_find=63;
;;;2587            		if(event_ptr_find==event_ptr)
;;;2588   					{
;;;2589   					lc640_adr=0;
;;;2590   					break;
;;;2591   					}
;;;2592        			else continue;
;;;2593        			}
;;;2594        		}	
;;;2595   		}
;;;2596   	if(lc640_adr!=0)
;;;2597   		{
;;;2598   		data[0]=LPC_RTC->YEAR;
;;;2599   		data[1]=LPC_RTC->MONTH;
;;;2600   		data[2]=LPC_RTC->DOM;
;;;2601   		data[3]=0;
;;;2602   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2603   	
;;;2604   		data[0]=LPC_RTC->HOUR;
;;;2605   		data[1]=LPC_RTC->MIN;
;;;2606   		data[2]=LPC_RTC->SEC;
;;;2607   		data[3]=0;
;;;2608   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2609   		
;;;2610   		data[0]='B';
;;;2611   		data[1]='B';
;;;2612   		data[2]='B';
;;;2613   		data[3]='B';
;;;2614   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2615   		
;;;2616   		data[0]='B';
;;;2617   		data[1]='B';
;;;2618   		data[2]='B';
;;;2619   		data[3]='B';
;;;2620   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2621   		}
;;;2622   	}
;;;2623   }
0028e0  e496              B        |L1.8720|
                  |L1.10466|
0028e2  f04f0700          MOV      r7,#0                 ;2498
                  |L1.10470|
0028e6  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2500
0028ea  4669              MOV      r1,sp                 ;2502
0028ec  4628              MOV      r0,r5                 ;2502
0028ee  f7fffffe          BL       lc640_read_long_ptr
0028f2  f89d0000          LDRB     r0,[sp,#0]            ;2504
0028f6  2866              CMP      r0,#0x66              ;2504
0028f8  d103              BNE      |L1.10498|
0028fa  f89d0002          LDRB     r0,[sp,#2]            ;2504
0028fe  285a              CMP      r0,#0x5a              ;2504
002900  d00a              BEQ      |L1.10520|
                  |L1.10498|
002902  b114              CBZ      r4,|L1.10506|
002904  f1a40401          SUB      r4,r4,#1              ;2506
002908  e001              B        |L1.10510|
                  |L1.10506|
00290a  f04f043f          MOV      r4,#0x3f              ;2507
                  |L1.10510|
00290e  42b4              CMP      r4,r6                 ;2508
002910  d122              BNE      |L1.10584|
002912  f04f0500          MOV      r5,#0                 ;2510
002916  e024              B        |L1.10594|
                  |L1.10520|
002918  4669              MOV      r1,sp                 ;2517
00291a  f1050010          ADD      r0,r5,#0x10           ;2517
00291e  f7fffffe          BL       lc640_read_long_ptr
002922  f89d0000          LDRB     r0,[sp,#0]            ;2518
002926  2841              CMP      r0,#0x41              ;2518
002928  d10b              BNE      |L1.10562|
00292a  f89d0001          LDRB     r0,[sp,#1]            ;2518
00292e  2841              CMP      r0,#0x41              ;2518
002930  d107              BNE      |L1.10562|
002932  f89d0002          LDRB     r0,[sp,#2]            ;2518
002936  2841              CMP      r0,#0x41              ;2518
002938  d103              BNE      |L1.10562|
00293a  f89d0003          LDRB     r0,[sp,#3]            ;2518
00293e  2841              CMP      r0,#0x41              ;2518
002940  d00a              BEQ      |L1.10584|
                  |L1.10562|
002942  b114              CBZ      r4,|L1.10570|
002944  f1a40401          SUB      r4,r4,#1              ;2520
002948  e001              B        |L1.10574|
                  |L1.10570|
00294a  f04f043f          MOV      r4,#0x3f              ;2521
                  |L1.10574|
00294e  42b4              CMP      r4,r6                 ;2522
002950  d102              BNE      |L1.10584|
002952  f04f0500          MOV      r5,#0                 ;2524
002956  e004              B        |L1.10594|
                  |L1.10584|
002958  f1070701          ADD      r7,r7,#1              ;2498
00295c  b2ff              UXTB     r7,r7                 ;2498
00295e  2f3f              CMP      r7,#0x3f              ;2498
002960  d3c1              BCC      |L1.10470|
                  |L1.10594|
002962  2d00              CMP      r5,#0                 ;2531
002964  d0bc              BEQ      |L1.10464|
002966  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2533
00296a  f88d0000          STRB     r0,[sp,#0]            ;2533
00296e  f8980038          LDRB     r0,[r8,#0x38]         ;2534
002972  f88d0001          STRB     r0,[sp,#1]            ;2534
002976  f898002c          LDRB     r0,[r8,#0x2c]         ;2535
00297a  f88d0002          STRB     r0,[sp,#2]            ;2535
00297e  f88d9003          STRB     r9,[sp,#3]            ;2536
002982  4669              MOV      r1,sp                 ;2537
002984  f1050010          ADD      r0,r5,#0x10           ;2537
002988  f7fffffe          BL       lc640_write_long_ptr
00298c  f8980028          LDRB     r0,[r8,#0x28]         ;2539
002990  f88d0000          STRB     r0,[sp,#0]            ;2539
002994  f8980024          LDRB     r0,[r8,#0x24]         ;2540
002998  f88d0001          STRB     r0,[sp,#1]            ;2540
00299c  f8980020          LDRB     r0,[r8,#0x20]         ;2541
0029a0  f88d0002          STRB     r0,[sp,#2]            ;2541
0029a4  f88d9003          STRB     r9,[sp,#3]            ;2542
0029a8  4669              MOV      r1,sp                 ;2543
0029aa  f1050014          ADD      r0,r5,#0x14           ;2543
0029ae  f7fffffe          BL       lc640_write_long_ptr
0029b2  f04f0443          MOV      r4,#0x43              ;2545
0029b6  f88d4000          STRB     r4,[sp,#0]            ;2545
0029ba  f88d4001          STRB     r4,[sp,#1]            ;2546
0029be  f88d4002          STRB     r4,[sp,#2]            ;2547
0029c2  f88d4003          STRB     r4,[sp,#3]            ;2548
0029c6  4669              MOV      r1,sp                 ;2549
0029c8  f1050018          ADD      r0,r5,#0x18           ;2549
0029cc  f7fffffe          BL       lc640_write_long_ptr
0029d0  f88d4000          STRB     r4,[sp,#0]            ;2551
0029d4  f88d4001          STRB     r4,[sp,#1]            ;2552
0029d8  f88d4002          STRB     r4,[sp,#2]            ;2553
0029dc  f88d4003          STRB     r4,[sp,#3]            ;2554
0029e0  4669              MOV      r1,sp                 ;2555
0029e2  f105001c          ADD      r0,r5,#0x1c           ;2555
0029e6  f7fffffe          BL       lc640_write_long_ptr
                  |L1.10730|
0029ea  e411              B        |L1.8720|
                  |L1.10732|
0029ec  f89d0002          LDRB     r0,[sp,#2]            ;2569
0029f0  285a              CMP      r0,#0x5a              ;2569
0029f2  d00a              BEQ      |L1.10762|
                  |L1.10740|
0029f4  b114              CBZ      r4,|L1.10748|
0029f6  f1a40401          SUB      r4,r4,#1              ;2571
0029fa  e001              B        |L1.10752|
                  |L1.10748|
0029fc  f04f043f          MOV      r4,#0x3f              ;2572
                  |L1.10752|
002a00  42b4              CMP      r4,r6                 ;2573
002a02  d122              BNE      |L1.10826|
002a04  f04f0500          MOV      r5,#0                 ;2575
002a08  e025              B        |L1.10838|
                  |L1.10762|
002a0a  4669              MOV      r1,sp                 ;2582
002a0c  f1050010          ADD      r0,r5,#0x10           ;2582
002a10  f7fffffe          BL       lc640_read_long_ptr
002a14  f89d0000          LDRB     r0,[sp,#0]            ;2583
002a18  2841              CMP      r0,#0x41              ;2583
002a1a  d10b              BNE      |L1.10804|
002a1c  f89d0001          LDRB     r0,[sp,#1]            ;2583
002a20  2841              CMP      r0,#0x41              ;2583
002a22  d107              BNE      |L1.10804|
002a24  f89d0002          LDRB     r0,[sp,#2]            ;2583
002a28  2841              CMP      r0,#0x41              ;2583
002a2a  d103              BNE      |L1.10804|
002a2c  f89d0003          LDRB     r0,[sp,#3]            ;2583
002a30  2841              CMP      r0,#0x41              ;2583
002a32  d00a              BEQ      |L1.10826|
                  |L1.10804|
002a34  b114              CBZ      r4,|L1.10812|
002a36  f1a40401          SUB      r4,r4,#1              ;2585
002a3a  e001              B        |L1.10816|
                  |L1.10812|
002a3c  f04f043f          MOV      r4,#0x3f              ;2586
                  |L1.10816|
002a40  42b4              CMP      r4,r6                 ;2587
002a42  d102              BNE      |L1.10826|
002a44  f04f0500          MOV      r5,#0                 ;2589
002a48  e005              B        |L1.10838|
                  |L1.10826|
002a4a  f1070701          ADD      r7,r7,#1              ;2563
002a4e  b2ff              UXTB     r7,r7                 ;2563
002a50  2f3f              CMP      r7,#0x3f              ;2563
002a52  f4ffaea3          BCC      |L1.10140|
                  |L1.10838|
002a56  2d00              CMP      r5,#0                 ;2596
002a58  d0c7              BEQ      |L1.10730|
002a5a  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2598
002a5e  f88d0000          STRB     r0,[sp,#0]            ;2598
002a62  f8980038          LDRB     r0,[r8,#0x38]         ;2599
002a66  f88d0001          STRB     r0,[sp,#1]            ;2599
002a6a  f898002c          LDRB     r0,[r8,#0x2c]         ;2600
002a6e  f88d0002          STRB     r0,[sp,#2]            ;2600
002a72  f88d9003          STRB     r9,[sp,#3]            ;2601
002a76  4669              MOV      r1,sp                 ;2602
002a78  f1050010          ADD      r0,r5,#0x10           ;2602
002a7c  f7fffffe          BL       lc640_write_long_ptr
002a80  f8980028          LDRB     r0,[r8,#0x28]         ;2604
002a84  f88d0000          STRB     r0,[sp,#0]            ;2604
002a88  f8980024          LDRB     r0,[r8,#0x24]         ;2605
002a8c  f88d0001          STRB     r0,[sp,#1]            ;2605
002a90  f8980020          LDRB     r0,[r8,#0x20]         ;2606
002a94  f88d0002          STRB     r0,[sp,#2]            ;2606
002a98  f88d9003          STRB     r9,[sp,#3]            ;2607
002a9c  4669              MOV      r1,sp                 ;2608
002a9e  f1050014          ADD      r0,r5,#0x14           ;2608
002aa2  f7fffffe          BL       lc640_write_long_ptr
002aa6  f04f0442          MOV      r4,#0x42              ;2610
002aaa  f88d4000          STRB     r4,[sp,#0]            ;2610
002aae  f88d4001          STRB     r4,[sp,#1]            ;2611
002ab2  f88d4002          STRB     r4,[sp,#2]            ;2612
002ab6  f88d4003          STRB     r4,[sp,#3]            ;2613
002aba  4669              MOV      r1,sp                 ;2614
002abc  f1050018          ADD      r0,r5,#0x18           ;2614
002ac0  f7fffffe          BL       lc640_write_long_ptr
002ac4  f88d4000          STRB     r4,[sp,#0]            ;2616
002ac8  f88d4001          STRB     r4,[sp,#1]            ;2617
002acc  f88d4002          STRB     r4,[sp,#2]            ;2618
002ad0  f88d4003          STRB     r4,[sp,#3]            ;2619
002ad4  4669              MOV      r1,sp                 ;2620
002ad6  f105001c          ADD      r0,r5,#0x1c           ;2620
002ada  f7fffffe          BL       lc640_write_long_ptr
002ade  e41c              B        |L1.8986|
                          ENDP

                  |L1.10976|
                          DCD      0x40024000

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  ke_mem_hndl PROC
;;;82     //-----------------------------------------------
;;;83     void avar_hndl(void)
000000  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;84     {
;;;85     //static unsigned avar_stat_old;
;;;86     char i;
;;;87     //unsigned avar_stat_new,avar_stat_offed;
;;;88     
;;;89     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  b083              SUB      sp,sp,#0xc
000004  4605              MOV      r5,r0
000006  4948              LDR      r1,|L2.296|
000008  eb050085          ADD      r0,r5,r5,LSL #2
00000c  eb011100          ADD      r1,r1,r0,LSL #4
000010  4846              LDR      r0,|L2.300|
000012  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
;;;90     else	   			SET_REG(avar_stat,0,0,1);
000016  f1000001          ADD      r0,r0,#1
;;;91     #ifndef UKU_220_IPS_TERMOKOMPENSAT //o_10
;;;92     for(i=0;i<2;i++)
;;;93     	{
;;;94     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
;;;95     	else	   			SET_REG(avar_stat,0,1+i,1);
;;;96     	}
;;;97     #endif //o_10
;;;98     for(i=0;i<18;i++)
00001a  eb010040          ADD      r0,r1,r0,LSL #1
;;;99     	{
;;;100    	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00001e  f9b00024          LDRSH    r0,[r0,#0x24]
000022  9001              STR      r0,[sp,#4]
000024  f44f6660          MOV      r6,#0xe00
000028  4630              MOV      r0,r6
00002a  f7fffffe          BL       lc640_read_int
00002e  f1000001          ADD      r0,r0,#1
000032  4604              MOV      r4,r0
000034  2c3f              CMP      r4,#0x3f
000036  d901              BLS      |L2.60|
000038  f04f0400          MOV      r4,#0
                  |L2.60|
00003c  b221              SXTH     r1,r4
00003e  4630              MOV      r0,r6
000040  f7fffffe          BL       lc640_write_int
000044  f6406702          MOV      r7,#0xe02
000048  4638              MOV      r0,r7
00004a  f7fffffe          BL       lc640_read_int
;;;101    	else	   			SET_REG(avar_stat,0,3+i,1);
00004e  283f              CMP      r0,#0x3f
000050  d000              BEQ      |L2.84|
000052  4620              MOV      r0,r4
                  |L2.84|
000054  b201              SXTH     r1,r0
000056  4638              MOV      r0,r7
000058  f7fffffe          BL       lc640_write_int
00005c  4630              MOV      r0,r6
00005e  f7fffffe          BL       lc640_read_int
000062  f44f6180          MOV      r1,#0x400             ;98
000066  eb011440          ADD      r4,r1,r0,LSL #5       ;98
;;;102    	}
;;;103    
;;;104    /*for(i=0;i<6;i++)
;;;105    	{
;;;106    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
;;;107    	else	   		SET_REG(avar_stat,0,15+i,1);
;;;108    	}*/
;;;109    
;;;110    /*for(i=0;i<4;i++)
;;;111    	{
;;;112    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;113    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;114    	}  */
;;;115    #ifndef UKU_ZVU
;;;116    for(i=0;i<4;i++)
;;;117    	{
;;;118    	if(sk_av_stat[i]==sasON)	SET_REG(sk_avar_stat,1,i,1);
;;;119    	else	   					SET_REG(sk_avar_stat,0,i,1);
;;;120    	}
;;;121    #endif //UKU_ZVU
;;;122    #ifndef UKU_FSO
;;;123    for(i=0;i<4;i++)
00006a  f04f0042          MOV      r0,#0x42
00006e  f88d0008          STRB     r0,[sp,#8]
000072  f88d5009          STRB     r5,[sp,#9]
;;;124    	{
;;;125    //	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
;;;126    //	else	   		SET_REG(avar_stat,0,24+i,1);
;;;127    	}
;;;128    #endif //UKU_FSO
;;;129    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;130    //else	   			SET_REG(avar_stat,0,28,1);
;;;131    
;;;132    
;;;133    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000076  f04f004b          MOV      r0,#0x4b
00007a  f88d000a          STRB     r0,[sp,#0xa]
00007e  f04f0600          MOV      r6,#0
;;;134    
;;;135    avar_ind_stat|=avar_stat_new;
000082  f88d600b          STRB     r6,[sp,#0xb]
000086  a902              ADD      r1,sp,#8
000088  4620              MOV      r0,r4
;;;136    
;;;137    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
00008a  f7fffffe          BL       lc640_write_long_ptr
00008e  f89d0010          LDRB     r0,[sp,#0x10]
000092  f88d0008          STRB     r0,[sp,#8]
;;;138    
;;;139    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
000096  f89d0011          LDRB     r0,[sp,#0x11]
00009a  f88d0009          STRB     r0,[sp,#9]
00009e  f89d0004          LDRB     r0,[sp,#4]
0000a2  f88d000a          STRB     r0,[sp,#0xa]
;;;140    
;;;141    avar_ind_stat&=avar_stat_offed; 
0000a6  f89d0005          LDRB     r0,[sp,#5]
0000aa  f88d000b          STRB     r0,[sp,#0xb]
;;;142    
;;;143    avar_stat_old=avar_stat;
;;;144    
;;;145    
;;;146    sk_avar_stat_new=(sk_avar_stat^sk_avar_stat_old)&sk_avar_stat;
0000ae  a902              ADD      r1,sp,#8
0000b0  1d20              ADDS     r0,r4,#4
0000b2  f7fffffe          BL       lc640_write_long_ptr
0000b6  f24020a2          MOV      r0,#0x2a2
;;;147    
;;;148    sk_avar_ind_stat|=sk_avar_stat_new;
0000ba  f7fffffe          BL       lc640_read_long
0000be  4d1c              LDR      r5,|L2.304|
;;;149    
;;;150    sk_avar_stat_offed=~((sk_avar_stat^sk_avar_stat_old)&sk_avar_stat_old);
0000c0  6028              STR      r0,[r5,#0]  ; ke_date
0000c2  4629              MOV      r1,r5
0000c4  f1040008          ADD      r0,r4,#8
0000c8  f7fffffe          BL       lc640_write_long_ptr
;;;151    
;;;152    
;;;153    if((SK_ZVUK_EN[0])) sk_avar_ind_stat&=(~(1UL<<0));
0000cc  f24020a6          MOV      r0,#0x2a6
0000d0  f7fffffe          BL       lc640_read_long
0000d4  6068              STR      r0,[r5,#4]  ; ke_date
0000d6  1d29              ADDS     r1,r5,#4
;;;154    if((SK_ZVUK_EN[1])) sk_avar_ind_stat&=(~(1UL<<1));
0000d8  f104000c          ADD      r0,r4,#0xc
0000dc  f7fffffe          BL       lc640_write_long_ptr
0000e0  4d14              LDR      r5,|L2.308|
0000e2  8ba8              LDRH     r0,[r5,#0x1c]
;;;155    if((SK_ZVUK_EN[2])) sk_avar_ind_stat&=(~(1UL<<2));
0000e4  f88d0008          STRB     r0,[sp,#8]
0000e8  7e28              LDRB     r0,[r5,#0x18]
0000ea  f88d0009          STRB     r0,[sp,#9]
0000ee  7b28              LDRB     r0,[r5,#0xc]
;;;156    if((SK_ZVUK_EN[3])) sk_avar_ind_stat&=(~(1UL<<3));	
0000f0  f88d000a          STRB     r0,[sp,#0xa]
0000f4  f88d600b          STRB     r6,[sp,#0xb]
0000f8  a902              ADD      r1,sp,#8
0000fa  f1040010          ADD      r0,r4,#0x10
;;;157    
;;;158    if(!AV_OFF_AVT)sk_avar_stat_offed|=0x0f;
0000fe  f7fffffe          BL       lc640_write_long_ptr
000102  7a28              LDRB     r0,[r5,#8]
;;;159    
;;;160    sk_avar_ind_stat&=sk_avar_stat_offed; 
000104  f88d0008          STRB     r0,[sp,#8]
000108  7928              LDRB     r0,[r5,#4]
00010a  f88d0009          STRB     r0,[sp,#9]
;;;161    
;;;162    sk_avar_stat_old=sk_avar_stat;
00010e  7828              LDRB     r0,[r5,#0]
;;;163    
;;;164    //oleg_start
;;;165    
;;;166    
;;;167    
;;;168    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
000110  f88d000a          STRB     r0,[sp,#0xa]
000114  f88d600b          STRB     r6,[sp,#0xb]
000118  a902              ADD      r1,sp,#8
00011a  f1040014          ADD      r0,r4,#0x14
00011e  f7fffffe          BL       lc640_write_long_ptr
;;;169    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
000122  b005              ADD      sp,sp,#0x14
000124  bdf0              POP      {r4-r7,pc}
;;;170    rki_avar1_ind_stat|=rki_avar1_stat_new;
;;;171    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
;;;172    rki_avar1_ind_stat&=rki_avar1_stat_offed;
;;;173    rki_avar1_stat_old=rki_avar1_stat;
;;;174    /*
;;;175    rki_avarI1_stat=status_di1;
;;;176    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;177    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;178    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;179    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;180    rki_avarI1_stat_old=rki_avarI1_stat;
;;;181    
;;;182    rki_avarI2_stat=status_di2;
;;;183    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;184    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;185    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;186    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;187    rki_avarI2_stat_old=rki_avarI2_stat;
;;;188    */
;;;189    //oleg_end
;;;190    }
;;;191    
                          ENDP

000126  0000              DCW      0x0000
                  |L2.296|
                          DCD      bat
                  |L2.300|
                          DCD      bat_u_old_cnt
                  |L2.304|
                          DCD      ke_date
                  |L2.308|
                          DCD      0x40024020

                          AREA ||.data||, DATA, ALIGN=2

                  sk_avar_stat
000000  00                DCB      0x00
                  sk_avar_ind_stat
000001  00                DCB      0x00
                  sk_avar_stat_old
000002  00                DCB      0x00
                  sk_avar_stat_new
000003  00                DCB      0x00
                  sk_avar_stat_offed
000004  00000000          DCB      0x00,0x00,0x00,0x00
                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  rki_avar1_stat
                          DCD      0x00000000
                  rki_avar1_ind_stat
                          DCD      0x00000000
                  rki_avar1_stat_old
                          DCD      0x00000000
                  rki_avar1_stat_new
                          DCD      0x00000000
                  rki_avar1_stat_offed
                          DCD      0x00000000

                          AREA ||area_number.6||, DATA, ALIGN=0

                          EXPORTAS ||area_number.6||, ||.data||
                  av_inv
                          DCDU     0x00000000
000004  0000              DCB      0x00,0x00
