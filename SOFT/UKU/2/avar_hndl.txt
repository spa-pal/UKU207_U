; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\avar_hndl.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;57     //-----------------------------------------------
;;;58     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;59     {
;;;60     //static unsigned avar_stat_old;
;;;61     char i;
;;;62     //unsigned avar_stat_new,avar_stat_offed;
;;;63     
;;;64     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48fd              LDR      r0,|L1.1016|
000004  4afd              LDR      r2,|L1.1020|
000006  7801              LDRB     r1,[r0,#0]  ; net_av
000008  6810              LDR      r0,[r2,#0]
00000a  b119              CBZ      r1,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6010              STR      r0,[r2,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;65     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6010              STR      r0,[r2,#0]  ; avar_stat
                  |L1.26|
;;;66     
;;;67     for(i=0;i<2;i++)
00001a  f04f0000          MOV      r0,#0
;;;68     	{
;;;69     	if(bat[i]._av&1)	SET_REG(avar_stat,1,1+i,1);
00001e  4cf8              LDR      r4,|L1.1024|
000020  f04f0301          MOV      r3,#1
                  |L1.36|
000024  eb000140          ADD      r1,r0,r0,LSL #1
000028  eb011100          ADD      r1,r1,r0,LSL #4
00002c  eb040181          ADD      r1,r4,r1,LSL #2
000030  f891103d          LDRB     r1,[r1,#0x3d]
000034  07c9              LSLS     r1,r1,#31
000036  d00a              BEQ      |L1.78|
000038  f1000501          ADD      r5,r0,#1
00003c  fa03f105          LSL      r1,r3,r5
000040  6815              LDR      r5,[r2,#0]  ; avar_stat
000042  ea250501          BIC      r5,r5,r1
000046  ea450501          ORR      r5,r5,r1
00004a  6015              STR      r5,[r2,#0]  ; avar_stat
00004c  e007              B        |L1.94|
                  |L1.78|
;;;70     	else	   		SET_REG(avar_stat,0,1+i,1);
00004e  f1000501          ADD      r5,r0,#1
000052  fa03f105          LSL      r1,r3,r5
000056  6815              LDR      r5,[r2,#0]  ; avar_stat
000058  ea250501          BIC      r5,r5,r1
00005c  6015              STR      r5,[r2,#0]  ; avar_stat
                  |L1.94|
00005e  f1000001          ADD      r0,r0,#1              ;67
000062  b2c0              UXTB     r0,r0                 ;67
000064  2802              CMP      r0,#2                 ;67
000066  d3dd              BCC      |L1.36|
;;;71     	}
;;;72     
;;;73     for(i=0;i<12;i++)
000068  f04f0000          MOV      r0,#0
;;;74     	{
;;;75     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00006c  4ce5              LDR      r4,|L1.1028|
                  |L1.110|
00006e  ebc001c0          RSB      r1,r0,r0,LSL #3
000072  eb011100          ADD      r1,r1,r0,LSL #4
000076  eb040181          ADD      r1,r4,r1,LSL #2
00007a  7849              LDRB     r1,[r1,#1]
00007c  f0110fef          TST      r1,#0xef
000080  d00a              BEQ      |L1.152|
000082  f1000503          ADD      r5,r0,#3
000086  fa03f105          LSL      r1,r3,r5
00008a  6815              LDR      r5,[r2,#0]  ; avar_stat
00008c  ea250501          BIC      r5,r5,r1
000090  ea450501          ORR      r5,r5,r1
000094  6015              STR      r5,[r2,#0]  ; avar_stat
000096  e007              B        |L1.168|
                  |L1.152|
;;;76     	else	   		SET_REG(avar_stat,0,3+i,1);
000098  f1000103          ADD      r1,r0,#3
00009c  fa03f501          LSL      r5,r3,r1
0000a0  6811              LDR      r1,[r2,#0]  ; avar_stat
0000a2  ea210105          BIC      r1,r1,r5
0000a6  6011              STR      r1,[r2,#0]  ; avar_stat
                  |L1.168|
0000a8  f1000001          ADD      r0,r0,#1              ;73
0000ac  b2c0              UXTB     r0,r0                 ;73
0000ae  280c              CMP      r0,#0xc               ;73
0000b0  d3dd              BCC      |L1.110|
;;;77     	}
;;;78     
;;;79     for(i=0;i<6;i++)
0000b2  f04f0000          MOV      r0,#0
;;;80     	{
;;;81     	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
0000b6  4cd1              LDR      r4,|L1.1020|
0000b8  f1040414          ADD      r4,r4,#0x14
                  |L1.188|
0000bc  5c21              LDRB     r1,[r4,r0]
0000be  b151              CBZ      r1,|L1.214|
0000c0  f100050f          ADD      r5,r0,#0xf
0000c4  fa03f105          LSL      r1,r3,r5
0000c8  6815              LDR      r5,[r2,#0]  ; avar_stat
0000ca  ea250501          BIC      r5,r5,r1
0000ce  ea450501          ORR      r5,r5,r1
0000d2  6015              STR      r5,[r2,#0]  ; avar_stat
0000d4  e007              B        |L1.230|
                  |L1.214|
;;;82     	else	   		SET_REG(avar_stat,0,15+i,1);
0000d6  f100010f          ADD      r1,r0,#0xf
0000da  6815              LDR      r5,[r2,#0]  ; avar_stat
0000dc  fa03f101          LSL      r1,r3,r1
0000e0  ea250501          BIC      r5,r5,r1
0000e4  6015              STR      r5,[r2,#0]  ; avar_stat
                  |L1.230|
0000e6  f1000001          ADD      r0,r0,#1              ;79
0000ea  b2c0              UXTB     r0,r0                 ;79
0000ec  2806              CMP      r0,#6                 ;79
0000ee  d3e5              BCC      |L1.188|
;;;83     	}
;;;84     
;;;85     /*for(i=0;i<4;i++)
;;;86     	{
;;;87     	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;88     	else	   		SET_REG(avar_stat,0,21+i,1);
;;;89     	}  */
;;;90     for(i=0;i<4;i++)
0000f0  f04f0000          MOV      r0,#0
;;;91     	{
;;;92     	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000f4  4dc4              LDR      r5,|L1.1032|
0000f6  461c              MOV      r4,r3                 ;69
                  |L1.248|
0000f8  5c29              LDRB     r1,[r5,r0]
0000fa  2901              CMP      r1,#1
0000fc  d014              BEQ      |L1.296|
;;;93     	else	   		SET_REG(avar_stat,0,24+i,1);
0000fe  f1000118          ADD      r1,r0,#0x18
000102  fa04f301          LSL      r3,r4,r1
000106  6811              LDR      r1,[r2,#0]  ; avar_stat
000108  ea210103          BIC      r1,r1,r3
00010c  6011              STR      r1,[r2,#0]  ; avar_stat
                  |L1.270|
00010e  f1000001          ADD      r0,r0,#1              ;90
000112  b2c0              UXTB     r0,r0                 ;90
000114  2804              CMP      r0,#4                 ;90
000116  d3ef              BCC      |L1.248|
;;;94     	}
;;;95     
;;;96     if(uout_av)			SET_REG(avar_stat,1,28,1);
000118  48bc              LDR      r0,|L1.1036|
00011a  7800              LDRB     r0,[r0,#0]  ; uout_av
00011c  b178              CBZ      r0,|L1.318|
00011e  6810              LDR      r0,[r2,#0]  ; avar_stat
000120  f0405080          ORR      r0,r0,#0x10000000
000124  6010              STR      r0,[r2,#0]  ; avar_stat
000126  e00e              B        |L1.326|
                  |L1.296|
000128  f1000318          ADD      r3,r0,#0x18           ;92
00012c  fa04f103          LSL      r1,r4,r3              ;92
000130  6813              LDR      r3,[r2,#0]            ;92  ; avar_stat
000132  ea230301          BIC      r3,r3,r1              ;92
000136  ea430301          ORR      r3,r3,r1              ;92
00013a  6013              STR      r3,[r2,#0]            ;92  ; avar_stat
00013c  e7e7              B        |L1.270|
                  |L1.318|
;;;97     else	   			SET_REG(avar_stat,0,28,1);
00013e  6810              LDR      r0,[r2,#0]  ; avar_stat
000140  f0205080          BIC      r0,r0,#0x10000000
000144  6010              STR      r0,[r2,#0]  ; avar_stat
                  |L1.326|
;;;98     
;;;99     
;;;100    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000146  6894              LDR      r4,[r2,#8]  ; avar_stat_old
000148  6810              LDR      r0,[r2,#0]  ; avar_stat
00014a  ea200104          BIC      r1,r0,r4
00014e  60d1              STR      r1,[r2,#0xc]  ; avar_stat_new
;;;101    
;;;102    avar_ind_stat|=avar_stat_new;
000150  6853              LDR      r3,[r2,#4]  ; avar_ind_stat
000152  ea430301          ORR      r3,r3,r1
000156  6053              STR      r3,[r2,#4]  ; avar_ind_stat
;;;103    
;;;104    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000158  49ad              LDR      r1,|L1.1040|
00015a  880d              LDRH     r5,[r1,#0]  ; SK_ZVUK_EN
00015c  b115              CBZ      r5,|L1.356|
00015e  f0237380          BIC      r3,r3,#0x1000000
000162  6053              STR      r3,[r2,#4]  ; avar_ind_stat
                  |L1.356|
;;;105    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
000164  884b              LDRH     r3,[r1,#2]  ; SK_ZVUK_EN
000166  b11b              CBZ      r3,|L1.368|
000168  6853              LDR      r3,[r2,#4]  ; avar_ind_stat
00016a  f0237300          BIC      r3,r3,#0x2000000
00016e  6053              STR      r3,[r2,#4]  ; avar_ind_stat
                  |L1.368|
;;;106    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
000170  888b              LDRH     r3,[r1,#4]  ; SK_ZVUK_EN
000172  b11b              CBZ      r3,|L1.380|
000174  6853              LDR      r3,[r2,#4]  ; avar_ind_stat
000176  f0236380          BIC      r3,r3,#0x4000000
00017a  6053              STR      r3,[r2,#4]  ; avar_ind_stat
                  |L1.380|
;;;107    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
00017c  88c9              LDRH     r1,[r1,#6]  ; SK_ZVUK_EN
00017e  b119              CBZ      r1,|L1.392|
000180  6851              LDR      r1,[r2,#4]  ; avar_ind_stat
000182  f0216100          BIC      r1,r1,#0x8000000
000186  6051              STR      r1,[r2,#4]  ; avar_ind_stat
                  |L1.392|
;;;108    
;;;109    
;;;110    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
000188  ea240400          BIC      r4,r4,r0
00018c  ea6f0104          MVN      r1,r4
000190  6111              STR      r1,[r2,#0x10]  ; avar_stat_offed
;;;111    
;;;112    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
000192  4ba0              LDR      r3,|L1.1044|
000194  881b              LDRH     r3,[r3,#0]  ; AV_OFF_AVT
000196  b91b              CBNZ     r3,|L1.416|
000198  4b9f              LDR      r3,|L1.1048|
00019a  ea410103          ORR      r1,r1,r3
00019e  6111              STR      r1,[r2,#0x10]  ; avar_stat_offed
                  |L1.416|
;;;113    
;;;114    avar_ind_stat&=avar_stat_offed; 
0001a0  6913              LDR      r3,[r2,#0x10]  ; avar_stat_offed
0001a2  6851              LDR      r1,[r2,#4]  ; avar_ind_stat
0001a4  ea010103          AND      r1,r1,r3
0001a8  6051              STR      r1,[r2,#4]  ; avar_ind_stat
;;;115    
;;;116    avar_stat_old=avar_stat;
0001aa  6090              STR      r0,[r2,#8]  ; avar_stat_old
;;;117    }
0001ac  bd30              POP      {r4,r5,pc}
;;;118    
                          ENDP

                  reload_hndl PROC
;;;119    //-----------------------------------------------
;;;120    void reload_hndl(void)
0001ae  b5f8              PUSH     {r3-r7,lr}
;;;121    {
;;;122    char data[4];
;;;123    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;124    
;;;125    event_ptr=lc640_read_int(PTR_EVENT_LOG);
0001b0  f44f6560          MOV      r5,#0xe00
0001b4  4628              MOV      r0,r5
0001b6  f7fffffe          BL       lc640_read_int
;;;126    event_ptr++;	
0001ba  f1000001          ADD      r0,r0,#1
0001be  4604              MOV      r4,r0
;;;127    if(event_ptr>63)event_ptr=0;	
0001c0  2c3f              CMP      r4,#0x3f
0001c2  d901              BLS      |L1.456|
0001c4  f04f0400          MOV      r4,#0
                  |L1.456|
;;;128    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
0001c8  b221              SXTH     r1,r4
0001ca  4628              MOV      r0,r5
0001cc  f7fffffe          BL       lc640_write_int
;;;129    	
;;;130    event_cnt=lc640_read_int(CNT_EVENT_LOG);
0001d0  f6406602          MOV      r6,#0xe02
0001d4  4630              MOV      r0,r6
0001d6  f7fffffe          BL       lc640_read_int
;;;131    if(event_cnt!=63)event_cnt=event_ptr;
0001da  283f              CMP      r0,#0x3f
0001dc  d000              BEQ      |L1.480|
0001de  4620              MOV      r0,r4
                  |L1.480|
;;;132    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
0001e0  b201              SXTH     r1,r0
0001e2  4630              MOV      r0,r6
0001e4  f7fffffe          BL       lc640_write_int
;;;133    	
;;;134    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
0001e8  4628              MOV      r0,r5
0001ea  f7fffffe          BL       lc640_read_int
0001ee  f44f6180          MOV      r1,#0x400
0001f2  eb011440          ADD      r4,r1,r0,LSL #5
;;;135    	
;;;136    data[0]='U';
0001f6  f04f0055          MOV      r0,#0x55
0001fa  f88d0000          STRB     r0,[sp,#0]
;;;137    data[1]=0;
0001fe  f04f0600          MOV      r6,#0
000202  f88d6001          STRB     r6,[sp,#1]
;;;138    data[2]='R';
000206  f04f0052          MOV      r0,#0x52
00020a  f88d0002          STRB     r0,[sp,#2]
;;;139    data[3]=0;
00020e  f88d6003          STRB     r6,[sp,#3]
;;;140    lc640_write_long_ptr(lc640_adr,data);
000212  4669              MOV      r1,sp
000214  4620              MOV      r0,r4
000216  f7fffffe          BL       lc640_write_long_ptr
;;;141    
;;;142    data[0]=0;
;;;143    data[1]=0;
;;;144    data[2]=0;
;;;145    data[3]=0;
00021a  9600              STR      r6,[sp,#0]
;;;146    lc640_write_long_ptr(lc640_adr+4,data);
00021c  4669              MOV      r1,sp
00021e  1d20              ADDS     r0,r4,#4
000220  f7fffffe          BL       lc640_write_long_ptr
;;;147    
;;;148    data[0]=LPC_RTC->YEAR;
000224  4d7d              LDR      r5,|L1.1052|
000226  8ba8              LDRH     r0,[r5,#0x1c]
000228  f88d0000          STRB     r0,[sp,#0]
;;;149    data[1]=LPC_RTC->MONTH;
00022c  7e28              LDRB     r0,[r5,#0x18]
00022e  f88d0001          STRB     r0,[sp,#1]
;;;150    data[2]=LPC_RTC->DOM;
000232  7b28              LDRB     r0,[r5,#0xc]
000234  f88d0002          STRB     r0,[sp,#2]
;;;151    data[3]=0;
000238  f88d6003          STRB     r6,[sp,#3]
;;;152    lc640_write_long_ptr(lc640_adr+8,data);
00023c  4669              MOV      r1,sp
00023e  f1040008          ADD      r0,r4,#8
000242  f7fffffe          BL       lc640_write_long_ptr
;;;153    
;;;154    data[0]=LPC_RTC->HOUR;
000246  7a28              LDRB     r0,[r5,#8]
000248  f88d0000          STRB     r0,[sp,#0]
;;;155    data[1]=LPC_RTC->MIN;
00024c  7928              LDRB     r0,[r5,#4]
00024e  f88d0001          STRB     r0,[sp,#1]
;;;156    data[2]=LPC_RTC->SEC;
000252  7828              LDRB     r0,[r5,#0]
000254  f88d0002          STRB     r0,[sp,#2]
;;;157    data[3]=LPC_SC->RSID;
000258  4871              LDR      r0,|L1.1056|
00025a  f8d00180          LDR      r0,[r0,#0x180]
00025e  f88d0003          STRB     r0,[sp,#3]
;;;158    
;;;159    lc640_write_long_ptr(lc640_adr+12,data);
000262  4669              MOV      r1,sp
000264  f104000c          ADD      r0,r4,#0xc
000268  f7fffffe          BL       lc640_write_long_ptr
;;;160    	
;;;161    data[0]='A';
00026c  f04f0541          MOV      r5,#0x41
000270  f88d5000          STRB     r5,[sp,#0]
;;;162    data[1]='A';
000274  f88d5001          STRB     r5,[sp,#1]
;;;163    data[2]='A';
000278  f88d5002          STRB     r5,[sp,#2]
;;;164    data[3]='A';
00027c  f88d5003          STRB     r5,[sp,#3]
;;;165    lc640_write_long_ptr(lc640_adr+16,data);
000280  4669              MOV      r1,sp
000282  f1040010          ADD      r0,r4,#0x10
000286  f7fffffe          BL       lc640_write_long_ptr
;;;166    	
;;;167    data[0]='A';
00028a  f88d5000          STRB     r5,[sp,#0]
;;;168    data[1]='A';
00028e  f88d5001          STRB     r5,[sp,#1]
;;;169    data[2]='A';
000292  f88d5002          STRB     r5,[sp,#2]
;;;170    data[3]='A';
000296  f88d5003          STRB     r5,[sp,#3]
;;;171    lc640_write_long_ptr(lc640_adr+20,data);
00029a  4669              MOV      r1,sp
00029c  f1040014          ADD      r0,r4,#0x14
0002a0  f7fffffe          BL       lc640_write_long_ptr
;;;172    	
;;;173    data[0]='A';
0002a4  f88d5000          STRB     r5,[sp,#0]
;;;174    data[1]='A';
0002a8  f88d5001          STRB     r5,[sp,#1]
;;;175    data[2]='A';
0002ac  f88d5002          STRB     r5,[sp,#2]
;;;176    data[3]='A';
0002b0  f88d5003          STRB     r5,[sp,#3]
;;;177    lc640_write_long_ptr(lc640_adr+24,data);
0002b4  4669              MOV      r1,sp
0002b6  f1040018          ADD      r0,r4,#0x18
0002ba  f7fffffe          BL       lc640_write_long_ptr
;;;178    	
;;;179    data[0]='A';
0002be  f88d5000          STRB     r5,[sp,#0]
;;;180    data[1]='A';
0002c2  f88d5001          STRB     r5,[sp,#1]
;;;181    data[2]='A';
0002c6  f88d5002          STRB     r5,[sp,#2]
;;;182    data[3]='A';
0002ca  f88d5003          STRB     r5,[sp,#3]
;;;183    lc640_write_long_ptr(lc640_adr+28,data);				
0002ce  4669              MOV      r1,sp
0002d0  f104001c          ADD      r0,r4,#0x1c
0002d4  f7fffffe          BL       lc640_write_long_ptr
;;;184    	
;;;185    	
;;;186    }
0002d8  bdf8              POP      {r3-r7,pc}
;;;187    
                          ENDP

                  avar_unet_hndl PROC
;;;188    //-----------------------------------------------
;;;189    void avar_unet_hndl(char in)
0002da  e92d43f8          PUSH     {r3-r9,lr}
;;;190    {
;;;191    
;;;192    char data[4];
;;;193    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;194    
;;;195    
;;;196    if(in==1)
;;;197    	{
;;;198    	net_av=1;
;;;199    
;;;200    	//beep_init(0x01L,'O');
;;;201    	//a.av.bAN=1;
;;;202    
;;;203    
;;;204    	//beep_init(0x33333333,'A');
;;;205    	 
;;;206    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;207    	event_ptr++;	
;;;208    	if(event_ptr>63)event_ptr=0;	
;;;209    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;210    	
;;;211         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;212    	if(event_cnt!=63)event_cnt=event_ptr;
;;;213    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;214    	
;;;215    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;216    	
;;;217    	data[0]='P';
;;;218    	data[1]=0;
;;;219    	data[2]='A';
;;;220    	data[3]=0;
;;;221    	lc640_write_long_ptr(lc640_adr,data);
;;;222    
;;;223    	data[0]=0;//*((char*)&Unet_store);
;;;224    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;225    	data[2]=0;
;;;226    	data[3]=0;
;;;227    	lc640_write_long_ptr(lc640_adr+4,data);
;;;228    
;;;229    	data[0]=LPC_RTC->YEAR;
0002de  4f4f              LDR      r7,|L1.1052|
0002e0  4945              LDR      r1,|L1.1016|
0002e2  3f20              SUBS     r7,r7,#0x20
0002e4  f44f6560          MOV      r5,#0xe00             ;206
0002e8  f04f0800          MOV      r8,#0                 ;208
0002ec  f44f6980          MOV      r9,#0x400             ;215
0002f0  2801              CMP      r0,#1                 ;196
0002f2  d002              BEQ      |L1.762|
;;;230    	data[1]=LPC_RTC->MONTH;
;;;231    	data[2]=LPC_RTC->DOM;
;;;232    	data[3]=0;
;;;233    	lc640_write_long_ptr(lc640_adr+8,data);
;;;234    
;;;235    	data[0]=LPC_RTC->HOUR;
;;;236    	data[1]=LPC_RTC->MIN;
;;;237    	data[2]=LPC_RTC->SEC;
;;;238    	data[3]=0;
;;;239    	lc640_write_long_ptr(lc640_adr+12,data);
;;;240    	
;;;241    	data[0]='A';
;;;242    	data[1]='A';
;;;243    	data[2]='A';
;;;244    	data[3]='A';
;;;245    	lc640_write_long_ptr(lc640_adr+16,data);
;;;246    	
;;;247    	data[0]='A';
;;;248    	data[1]='A';
;;;249    	data[2]='A';
;;;250    	data[3]='A';
;;;251    	lc640_write_long_ptr(lc640_adr+20,data);
;;;252    	
;;;253    	data[0]='A';
;;;254    	data[1]='A';
;;;255    	data[2]='A';
;;;256    	data[3]='A';
;;;257    	lc640_write_long_ptr(lc640_adr+24,data);
;;;258    	
;;;259    	data[0]='A';
;;;260    	data[1]='A';
;;;261    	data[2]='A';
;;;262    	data[3]='A';
;;;263    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;264    	
;;;265    /*	memo_out0[0]=0x55;
;;;266         memo_out0[1]=0x00+2;
;;;267         memo_out0[2]=1;
;;;268         memo_out0[3]=0x0b;
;;;269         memo_out0[4]=0x55;
;;;270         memo_out0[5]=0x55; 
;;;271         	
;;;272         memo_out0[6]=crc_87(memo_out0,6);
;;;273    	memo_out0[7]=crc_95(memo_out0,6);
;;;274         usart_out_adr0(memo_out0,8); 
;;;275    	*/
;;;276    	snmp_trap_send("Main power is off",2,1,0);
;;;277    	}
;;;278    
;;;279    else if(in==0)
0002f4  2800              CMP      r0,#0
0002f6  d07e              BEQ      |L1.1014|
0002f8  e13e              B        |L1.1400|
                  |L1.762|
0002fa  f04f0001          MOV      r0,#1                 ;198
0002fe  7008              STRB     r0,[r1,#0]            ;198
000300  4628              MOV      r0,r5                 ;206
000302  f7fffffe          BL       lc640_read_int
000306  f1000001          ADD      r0,r0,#1              ;207
00030a  4604              MOV      r4,r0                 ;207
00030c  2c3f              CMP      r4,#0x3f              ;208
00030e  d901              BLS      |L1.788|
000310  f04f0400          MOV      r4,#0                 ;208
                  |L1.788|
000314  b221              SXTH     r1,r4                 ;209
000316  4628              MOV      r0,r5                 ;209
000318  f7fffffe          BL       lc640_write_int
00031c  f6406602          MOV      r6,#0xe02             ;211
000320  4630              MOV      r0,r6                 ;211
000322  f7fffffe          BL       lc640_read_int
000326  283f              CMP      r0,#0x3f              ;212
000328  d000              BEQ      |L1.812|
00032a  4620              MOV      r0,r4                 ;212
                  |L1.812|
00032c  b201              SXTH     r1,r0                 ;213
00032e  4630              MOV      r0,r6                 ;213
000330  f7fffffe          BL       lc640_write_int
000334  4628              MOV      r0,r5                 ;215
000336  f7fffffe          BL       lc640_read_int
00033a  eb091540          ADD      r5,r9,r0,LSL #5       ;215
00033e  f04f0050          MOV      r0,#0x50              ;217
000342  f88d0000          STRB     r0,[sp,#0]            ;217
000346  f88d8001          STRB     r8,[sp,#1]            ;218
00034a  f04f0441          MOV      r4,#0x41              ;219
00034e  f88d4002          STRB     r4,[sp,#2]            ;219
000352  f88d8003          STRB     r8,[sp,#3]            ;220
000356  4669              MOV      r1,sp                 ;221
000358  4628              MOV      r0,r5                 ;221
00035a  f7fffffe          BL       lc640_write_long_ptr
00035e  f8cd8000          STR      r8,[sp,#0]            ;226
000362  4669              MOV      r1,sp                 ;227
000364  1d28              ADDS     r0,r5,#4              ;227
000366  f7fffffe          BL       lc640_write_long_ptr
00036a  f1070720          ADD      r7,r7,#0x20           ;229
00036e  8bb8              LDRH     r0,[r7,#0x1c]         ;229
000370  f88d0000          STRB     r0,[sp,#0]            ;229
000374  7e38              LDRB     r0,[r7,#0x18]         ;230
000376  f88d0001          STRB     r0,[sp,#1]            ;230
00037a  7b38              LDRB     r0,[r7,#0xc]          ;231
00037c  f88d0002          STRB     r0,[sp,#2]            ;231
000380  f88d8003          STRB     r8,[sp,#3]            ;232
000384  4669              MOV      r1,sp                 ;233
000386  f1050008          ADD      r0,r5,#8              ;233
00038a  f7fffffe          BL       lc640_write_long_ptr
00038e  7a38              LDRB     r0,[r7,#8]            ;235
000390  f88d0000          STRB     r0,[sp,#0]            ;235
000394  7938              LDRB     r0,[r7,#4]            ;236
000396  f88d0001          STRB     r0,[sp,#1]            ;236
00039a  7838              LDRB     r0,[r7,#0]            ;237
00039c  f88d0002          STRB     r0,[sp,#2]            ;237
0003a0  f88d8003          STRB     r8,[sp,#3]            ;238
0003a4  4669              MOV      r1,sp                 ;239
0003a6  f105000c          ADD      r0,r5,#0xc            ;239
0003aa  f7fffffe          BL       lc640_write_long_ptr
0003ae  f88d4000          STRB     r4,[sp,#0]            ;241
0003b2  f88d4001          STRB     r4,[sp,#1]            ;242
0003b6  f88d4002          STRB     r4,[sp,#2]            ;243
0003ba  f88d4003          STRB     r4,[sp,#3]            ;244
0003be  4669              MOV      r1,sp                 ;245
0003c0  f1050010          ADD      r0,r5,#0x10           ;245
0003c4  f7fffffe          BL       lc640_write_long_ptr
0003c8  f88d4000          STRB     r4,[sp,#0]            ;247
0003cc  f88d4001          STRB     r4,[sp,#1]            ;248
0003d0  f88d4002          STRB     r4,[sp,#2]            ;249
0003d4  f88d4003          STRB     r4,[sp,#3]            ;250
0003d8  4669              MOV      r1,sp                 ;251
0003da  f1050014          ADD      r0,r5,#0x14           ;251
0003de  f7fffffe          BL       lc640_write_long_ptr
0003e2  f88d4000          STRB     r4,[sp,#0]            ;253
0003e6  f88d4001          STRB     r4,[sp,#1]            ;254
0003ea  f88d4002          STRB     r4,[sp,#2]            ;255
0003ee  f88d4003          STRB     r4,[sp,#3]            ;256
0003f2  4669              MOV      r1,sp                 ;257
0003f4  e016              B        |L1.1060|
                  |L1.1014|
0003f6  e02d              B        |L1.1108|
                  |L1.1016|
                          DCD      net_av
                  |L1.1020|
                          DCD      ||.data||
                  |L1.1024|
                          DCD      bat
                  |L1.1028|
                          DCD      bps
                  |L1.1032|
                          DCD      sk_av_stat
                  |L1.1036|
                          DCD      uout_av
                  |L1.1040|
                          DCD      SK_ZVUK_EN
                  |L1.1044|
                          DCD      AV_OFF_AVT
                  |L1.1048|
                          DCD      0xeffffffe
                  |L1.1052|
                          DCD      0x40024020
                  |L1.1056|
                          DCD      0x400fc000
                  |L1.1060|
000424  f1050018          ADD      r0,r5,#0x18           ;257
000428  f7fffffe          BL       lc640_write_long_ptr
00042c  f88d4000          STRB     r4,[sp,#0]            ;259
000430  f88d4001          STRB     r4,[sp,#1]            ;260
000434  f88d4002          STRB     r4,[sp,#2]            ;261
000438  f88d4003          STRB     r4,[sp,#3]            ;262
00043c  4669              MOV      r1,sp                 ;263
00043e  f105001c          ADD      r0,r5,#0x1c           ;263
000442  f7fffffe          BL       lc640_write_long_ptr
000446  2300              MOVS     r3,#0                 ;276
000448  2201              MOVS     r2,#1                 ;276
00044a  2102              MOVS     r1,#2                 ;276
00044c  a0fd              ADR      r0,|L1.2116|
00044e  f7fffffe          BL       snmp_trap_send
000452  e091              B        |L1.1400|
                  |L1.1108|
;;;280    	{
;;;281    	net_av=0;
000454  f8818000          STRB     r8,[r1,#0]
;;;282    
;;;283      /*
;;;284    	SET_REG(C2GSR,3,24,8);
;;;285    	C2MOD=0;
;;;286    	bOUT_FREE2=1;*/
;;;287    
;;;288    
;;;289    	//C2MOD=0;
;;;290    
;;;291    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;292    
;;;293         //beep_init(0x02L,'O');
;;;294    	//a_.av.bAN=0;
;;;295    	SET_REG(avar_stat,0,0,1);
000458  48ff              LDR      r0,|L1.2136|
00045a  6801              LDR      r1,[r0,#0]  ; avar_stat
00045c  f0210101          BIC      r1,r1,#1
000460  6001              STR      r1,[r0,#0]  ; avar_stat
;;;296    
;;;297    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;298    	
;;;299    	if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
000462  49fe              LDR      r1,|L1.2140|
000464  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
000466  b119              CBZ      r1,|L1.1136|
000468  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
00046a  f0210101          BIC      r1,r1,#1
00046e  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.1136|
;;;300    
;;;301         event_ptr=lc640_read_int(PTR_EVENT_LOG);
000470  4628              MOV      r0,r5
000472  f7fffffe          BL       lc640_read_int
000476  4606              MOV      r6,r0
;;;302    	event_ptr_find=event_ptr;
000478  4634              MOV      r4,r6
                  |L1.1146|
;;;303    avar_unet_hndl_lbl1:
;;;304    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
00047a  eb091544          ADD      r5,r9,r4,LSL #5
;;;305    
;;;306         lc640_read_long_ptr(lc640_adr,data);
00047e  4669              MOV      r1,sp
000480  4628              MOV      r0,r5
000482  f7fffffe          BL       lc640_read_long_ptr
;;;307         
;;;308         if(!((data[0]=='P')&&(data[1]==0)&&(data[2]=='A')))
000486  f89d0000          LDRB     r0,[sp,#0]
00048a  2850              CMP      r0,#0x50
00048c  d106              BNE      |L1.1180|
00048e  f89d0001          LDRB     r0,[sp,#1]
000492  b918              CBNZ     r0,|L1.1180|
000494  f89d0002          LDRB     r0,[sp,#2]
000498  2841              CMP      r0,#0x41
00049a  d008              BEQ      |L1.1198|
                  |L1.1180|
;;;309         	{        
;;;310         	if(event_ptr_find)event_ptr_find--;
00049c  b114              CBZ      r4,|L1.1188|
00049e  f1a40401          SUB      r4,r4,#1
0004a2  e001              B        |L1.1192|
                  |L1.1188|
;;;311         	else event_ptr_find=63;
0004a4  f04f043f          MOV      r4,#0x3f
                  |L1.1192|
;;;312         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0004a8  42b4              CMP      r4,r6
0004aa  d1e6              BNE      |L1.1146|
0004ac  e064              B        |L1.1400|
                  |L1.1198|
;;;313         	else goto avar_unet_hndl_lbl1;
;;;314         	}
;;;315         else 
;;;316         	{
;;;317         	lc640_read_long_ptr(lc640_adr+16,data);
0004ae  4669              MOV      r1,sp
0004b0  f1050010          ADD      r0,r5,#0x10
0004b4  f7fffffe          BL       lc640_read_long_ptr
;;;318         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0004b8  f89d0000          LDRB     r0,[sp,#0]
0004bc  2841              CMP      r0,#0x41
0004be  d10b              BNE      |L1.1240|
0004c0  f89d0001          LDRB     r0,[sp,#1]
0004c4  2841              CMP      r0,#0x41
0004c6  d107              BNE      |L1.1240|
0004c8  f89d0002          LDRB     r0,[sp,#2]
0004cc  2841              CMP      r0,#0x41
0004ce  d103              BNE      |L1.1240|
0004d0  f89d0003          LDRB     r0,[sp,#3]
0004d4  2841              CMP      r0,#0x41
0004d6  d008              BEQ      |L1.1258|
                  |L1.1240|
;;;319         		{        
;;;320         		if(event_ptr_find)event_ptr_find--;
0004d8  b114              CBZ      r4,|L1.1248|
0004da  f1a40401          SUB      r4,r4,#1
0004de  e001              B        |L1.1252|
                  |L1.1248|
;;;321             		else event_ptr_find=63;
0004e0  f04f043f          MOV      r4,#0x3f
                  |L1.1252|
;;;322             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0004e4  42b4              CMP      r4,r6
0004e6  d1c8              BNE      |L1.1146|
0004e8  e046              B        |L1.1400|
                  |L1.1258|
;;;323         		else goto avar_unet_hndl_lbl1;
;;;324         		}
;;;325    
;;;326         	}	
;;;327    	
;;;328    	data[0]=LPC_RTC->YEAR;
0004ea  f1070720          ADD      r7,r7,#0x20
0004ee  8bb8              LDRH     r0,[r7,#0x1c]
0004f0  f88d0000          STRB     r0,[sp,#0]
;;;329    	data[1]=LPC_RTC->MONTH;
0004f4  7e38              LDRB     r0,[r7,#0x18]
0004f6  f88d0001          STRB     r0,[sp,#1]
;;;330    	data[2]=LPC_RTC->DOM;
0004fa  7b38              LDRB     r0,[r7,#0xc]
0004fc  f88d0002          STRB     r0,[sp,#2]
;;;331    	data[3]=0;
000500  f88d8003          STRB     r8,[sp,#3]
;;;332    	lc640_write_long_ptr(lc640_adr+16,data);
000504  4669              MOV      r1,sp
000506  f1050010          ADD      r0,r5,#0x10
00050a  f7fffffe          BL       lc640_write_long_ptr
;;;333    
;;;334    	data[0]=LPC_RTC->HOUR;
00050e  7a38              LDRB     r0,[r7,#8]
000510  f88d0000          STRB     r0,[sp,#0]
;;;335    	data[1]=LPC_RTC->MIN;
000514  7938              LDRB     r0,[r7,#4]
000516  f88d0001          STRB     r0,[sp,#1]
;;;336    	data[2]=LPC_RTC->SEC;
00051a  7838              LDRB     r0,[r7,#0]
00051c  f88d0002          STRB     r0,[sp,#2]
;;;337    	data[3]=0;
000520  f88d8003          STRB     r8,[sp,#3]
;;;338    	lc640_write_long_ptr(lc640_adr+20,data); 
000524  4669              MOV      r1,sp
000526  f1050014          ADD      r0,r5,#0x14
00052a  f7fffffe          BL       lc640_write_long_ptr
;;;339    	
;;;340    	data[0]=*((char*)(&net_Ustore));
00052e  48cc              LDR      r0,|L1.2144|
000530  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000532  f88d1000          STRB     r1,[sp,#0]
;;;341    	data[1]=*(((char*)(&net_Ustore))+1);
000536  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000538  f88d0001          STRB     r0,[sp,#1]
;;;342    	data[2]='B';
00053c  f04f0442          MOV      r4,#0x42
000540  f88d4002          STRB     r4,[sp,#2]
;;;343    	data[3]='B';
000544  f88d4003          STRB     r4,[sp,#3]
;;;344    	lc640_write_long_ptr(lc640_adr+24,data);
000548  4669              MOV      r1,sp
00054a  f1050018          ADD      r0,r5,#0x18
00054e  f7fffffe          BL       lc640_write_long_ptr
;;;345    	
;;;346    	data[0]='B';
000552  f88d4000          STRB     r4,[sp,#0]
;;;347    	data[1]='B';
000556  f88d4001          STRB     r4,[sp,#1]
;;;348    	data[2]='B';
00055a  f88d4002          STRB     r4,[sp,#2]
;;;349    	data[3]='B';
00055e  f88d4003          STRB     r4,[sp,#3]
;;;350    	lc640_write_long_ptr(lc640_adr+28,data);	
000562  4669              MOV      r1,sp
000564  f105001c          ADD      r0,r5,#0x1c
000568  f7fffffe          BL       lc640_write_long_ptr
;;;351    	
;;;352    /*	memo_out0[0]=0x55;
;;;353         memo_out0[1]=0x00+2;
;;;354         memo_out0[2]=1;
;;;355         memo_out0[3]=0x0b;
;;;356         memo_out0[4]=0xaa;
;;;357         memo_out0[5]=0xaa; 
;;;358         	
;;;359         memo_out0[6]=crc_87(memo_out0,6);
;;;360    	memo_out0[7]=crc_95(memo_out0,6);
;;;361         usart_out_adr0(memo_out0,8); */
;;;362         snmp_trap_send("Main power is on",2,1,1);	
00056c  2301              MOVS     r3,#1
00056e  461a              MOV      r2,r3
000570  2102              MOVS     r1,#2
000572  a0bc              ADR      r0,|L1.2148|
000574  f7fffffe          BL       snmp_trap_send
                  |L1.1400|
;;;363    	}
;;;364    avar_unet_hndl_end:
;;;365    	__nop();		
000578  bf00              NOP      
                  |L1.1402|
;;;366    }
00057a  e8bd83f8          POP      {r3-r9,pc}
;;;367    
                          ENDP

                  avar_uout_hndl PROC
;;;369    //-----------------------------------------------
;;;370    void avar_uout_hndl(char in)
00057e  e92d43f8          PUSH     {r3-r9,lr}
;;;371    {
;;;372    
;;;373    char data[4];
;;;374    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;375    
;;;376    
;;;377    if(in==1)
;;;378    	{
;;;379    	//net_av=1;
;;;380    
;;;381    	//beep_init(0x01L,'O');
;;;382    	//a.av.bAN=1;
;;;383    
;;;384    
;;;385    	//beep_init(0x33333333,'A');
;;;386    
;;;387    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;388    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;389    		 
;;;390    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;391    	event_ptr++;	
;;;392    	if(event_ptr>63)event_ptr=0;	
;;;393    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;394    	
;;;395        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;396    	if(event_cnt!=63)event_cnt=event_ptr;
;;;397    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;398    	
;;;399    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;400    	
;;;401    	data[0]='Q';
;;;402    	data[1]=0;
;;;403    	data[2]='A';
;;;404    	data[3]=0;
;;;405    	lc640_write_long_ptr(lc640_adr,data);
;;;406    
;;;407    	data[0]=0;//*((char*)&Unet_store);
;;;408    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;409    	data[2]=0;
;;;410    	data[3]=0;
;;;411    	lc640_write_long_ptr(lc640_adr+4,data);
;;;412    
;;;413    	data[0]=LPC_RTC->YEAR;
000582  4fbd              LDR      r7,|L1.2168|
000584  49bd              LDR      r1,|L1.2172|
000586  f44f6560          MOV      r5,#0xe00             ;390
00058a  f04f0800          MOV      r8,#0                 ;392
00058e  f44f6980          MOV      r9,#0x400             ;399
000592  2801              CMP      r0,#1                 ;377
000594  d002              BEQ      |L1.1436|
;;;414    	data[1]=LPC_RTC->MONTH;
;;;415    	data[2]=LPC_RTC->DOM;
;;;416    	data[3]=0;
;;;417    	lc640_write_long_ptr(lc640_adr+8,data);
;;;418    
;;;419    	data[0]=LPC_RTC->HOUR;
;;;420    	data[1]=LPC_RTC->MIN;
;;;421    	data[2]=LPC_RTC->SEC;
;;;422    	data[3]=0;
;;;423    	lc640_write_long_ptr(lc640_adr+12,data);
;;;424    	
;;;425    	data[0]='A';
;;;426    	data[1]='A';
;;;427    	data[2]='A';
;;;428    	data[3]='A';
;;;429    	lc640_write_long_ptr(lc640_adr+16,data);
;;;430    	
;;;431    	data[0]='A';
;;;432    	data[1]='A';
;;;433    	data[2]='A';
;;;434    	data[3]='A';
;;;435    	lc640_write_long_ptr(lc640_adr+20,data);
;;;436    	
;;;437    	data[0]='A';
;;;438    	data[1]='A';
;;;439    	data[2]='A';
;;;440    	data[3]='A';
;;;441    	lc640_write_long_ptr(lc640_adr+24,data);
;;;442    	
;;;443    	data[0]='A';
;;;444    	data[1]='A';
;;;445    	data[2]='A';
;;;446    	data[3]='A';
;;;447    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;448    	
;;;449    /*	memo_out0[0]=0x55;
;;;450         memo_out0[1]=0x00+2;
;;;451         memo_out0[2]=1;
;;;452         memo_out0[3]=0x0b;
;;;453         memo_out0[4]=0x55;
;;;454         memo_out0[5]=0x55; 
;;;455         	
;;;456         memo_out0[6]=crc_87(memo_out0,6);
;;;457    	memo_out0[7]=crc_95(memo_out0,6);
;;;458         usart_out_adr0(memo_out0,8); 
;;;459    	*/
;;;460    	//snmp_trap_send("Main power is off",2,1,0);
;;;461    	}
;;;462    
;;;463    else if(in==0)
000596  2800              CMP      r0,#0
000598  d07e              BEQ      |L1.1688|
00059a  e126              B        |L1.2026|
                  |L1.1436|
00059c  48b8              LDR      r0,|L1.2176|
00059e  4ab9              LDR      r2,|L1.2180|
0005a0  f9b00000          LDRSH    r0,[r0,#0]            ;387  ; load_U
0005a4  f9b22000          LDRSH    r2,[r2,#0]            ;387  ; U_OUT_KONTR_MAX
0005a8  4290              CMP      r0,r2                 ;387
0005aa  dd02              BLE      |L1.1458|
0005ac  f04f0201          MOV      r2,#1                 ;387
0005b0  700a              STRB     r2,[r1,#0]            ;387
                  |L1.1458|
0005b2  4ab5              LDR      r2,|L1.2184|
0005b4  f9b22000          LDRSH    r2,[r2,#0]            ;388  ; U_OUT_KONTR_MIN
0005b8  4290              CMP      r0,r2                 ;388
0005ba  da02              BGE      |L1.1474|
0005bc  f04f0002          MOV      r0,#2                 ;388
0005c0  7008              STRB     r0,[r1,#0]            ;388
                  |L1.1474|
0005c2  4628              MOV      r0,r5                 ;390
0005c4  f7fffffe          BL       lc640_read_int
0005c8  f1000001          ADD      r0,r0,#1              ;391
0005cc  4604              MOV      r4,r0                 ;391
0005ce  2c3f              CMP      r4,#0x3f              ;392
0005d0  d901              BLS      |L1.1494|
0005d2  f04f0400          MOV      r4,#0                 ;392
                  |L1.1494|
0005d6  b221              SXTH     r1,r4                 ;393
0005d8  4628              MOV      r0,r5                 ;393
0005da  f7fffffe          BL       lc640_write_int
0005de  f6406602          MOV      r6,#0xe02             ;395
0005e2  4630              MOV      r0,r6                 ;395
0005e4  f7fffffe          BL       lc640_read_int
0005e8  283f              CMP      r0,#0x3f              ;396
0005ea  d000              BEQ      |L1.1518|
0005ec  4620              MOV      r0,r4                 ;396
                  |L1.1518|
0005ee  b201              SXTH     r1,r0                 ;397
0005f0  4630              MOV      r0,r6                 ;397
0005f2  f7fffffe          BL       lc640_write_int
0005f6  4628              MOV      r0,r5                 ;399
0005f8  f7fffffe          BL       lc640_read_int
0005fc  eb091540          ADD      r5,r9,r0,LSL #5       ;399
000600  f04f0051          MOV      r0,#0x51              ;401
000604  f88d0000          STRB     r0,[sp,#0]            ;401
000608  f88d8001          STRB     r8,[sp,#1]            ;402
00060c  f04f0441          MOV      r4,#0x41              ;403
000610  f88d4002          STRB     r4,[sp,#2]            ;403
000614  f88d8003          STRB     r8,[sp,#3]            ;404
000618  4669              MOV      r1,sp                 ;405
00061a  4628              MOV      r0,r5                 ;405
00061c  f7fffffe          BL       lc640_write_long_ptr
000620  f8cd8000          STR      r8,[sp,#0]            ;410
000624  4669              MOV      r1,sp                 ;411
000626  1d28              ADDS     r0,r5,#4              ;411
000628  f7fffffe          BL       lc640_write_long_ptr
00062c  f1070720          ADD      r7,r7,#0x20           ;413
000630  8bb8              LDRH     r0,[r7,#0x1c]         ;413
000632  f88d0000          STRB     r0,[sp,#0]            ;413
000636  7e38              LDRB     r0,[r7,#0x18]         ;414
000638  f88d0001          STRB     r0,[sp,#1]            ;414
00063c  7b38              LDRB     r0,[r7,#0xc]          ;415
00063e  f88d0002          STRB     r0,[sp,#2]            ;415
000642  f88d8003          STRB     r8,[sp,#3]            ;416
000646  4669              MOV      r1,sp                 ;417
000648  f1050008          ADD      r0,r5,#8              ;417
00064c  f7fffffe          BL       lc640_write_long_ptr
000650  7a38              LDRB     r0,[r7,#8]            ;419
000652  f88d0000          STRB     r0,[sp,#0]            ;419
000656  7938              LDRB     r0,[r7,#4]            ;420
000658  f88d0001          STRB     r0,[sp,#1]            ;420
00065c  7838              LDRB     r0,[r7,#0]            ;421
00065e  f88d0002          STRB     r0,[sp,#2]            ;421
000662  f88d8003          STRB     r8,[sp,#3]            ;422
000666  4669              MOV      r1,sp                 ;423
000668  f105000c          ADD      r0,r5,#0xc            ;423
00066c  f7fffffe          BL       lc640_write_long_ptr
000670  f88d4000          STRB     r4,[sp,#0]            ;425
000674  f88d4001          STRB     r4,[sp,#1]            ;426
000678  f88d4002          STRB     r4,[sp,#2]            ;427
00067c  f88d4003          STRB     r4,[sp,#3]            ;428
000680  4669              MOV      r1,sp                 ;429
000682  f1050010          ADD      r0,r5,#0x10           ;429
000686  f7fffffe          BL       lc640_write_long_ptr
00068a  f88d4000          STRB     r4,[sp,#0]            ;431
00068e  f88d4001          STRB     r4,[sp,#1]            ;432
000692  f88d4002          STRB     r4,[sp,#2]            ;433
000696  e000              B        |L1.1690|
                  |L1.1688|
000698  e021              B        |L1.1758|
                  |L1.1690|
00069a  f88d4003          STRB     r4,[sp,#3]            ;434
00069e  4669              MOV      r1,sp                 ;435
0006a0  f1050014          ADD      r0,r5,#0x14           ;435
0006a4  f7fffffe          BL       lc640_write_long_ptr
0006a8  f88d4000          STRB     r4,[sp,#0]            ;437
0006ac  f88d4001          STRB     r4,[sp,#1]            ;438
0006b0  f88d4002          STRB     r4,[sp,#2]            ;439
0006b4  f88d4003          STRB     r4,[sp,#3]            ;440
0006b8  4669              MOV      r1,sp                 ;441
0006ba  f1050018          ADD      r0,r5,#0x18           ;441
0006be  f7fffffe          BL       lc640_write_long_ptr
0006c2  f88d4000          STRB     r4,[sp,#0]            ;443
0006c6  f88d4001          STRB     r4,[sp,#1]            ;444
0006ca  f88d4002          STRB     r4,[sp,#2]            ;445
0006ce  f88d4003          STRB     r4,[sp,#3]            ;446
0006d2  4669              MOV      r1,sp                 ;447
0006d4  f105001c          ADD      r0,r5,#0x1c           ;447
0006d8  f7fffffe          BL       lc640_write_long_ptr
0006dc  e085              B        |L1.2026|
                  |L1.1758|
;;;464    	{
;;;465    	uout_av=0;
0006de  f8818000          STRB     r8,[r1,#0]
;;;466    
;;;467      /*
;;;468    	SET_REG(C2GSR,3,24,8);
;;;469    	C2MOD=0;
;;;470    	bOUT_FREE2=1;*/
;;;471    
;;;472    
;;;473    	//C2MOD=0;
;;;474    
;;;475    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;476    
;;;477         //beep_init(0x02L,'O');
;;;478    	//a_.av.bAN=0;
;;;479    //	SET_REG(avar_stat,0,0,1);
;;;480    
;;;481    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;482    	
;;;483    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;484    
;;;485        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0006e2  4628              MOV      r0,r5
0006e4  f7fffffe          BL       lc640_read_int
0006e8  4606              MOV      r6,r0
;;;486    	event_ptr_find=event_ptr;
0006ea  4634              MOV      r4,r6
                  |L1.1772|
;;;487    avar_uout_hndl_lbl1:
;;;488    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0006ec  eb091544          ADD      r5,r9,r4,LSL #5
;;;489    
;;;490         lc640_read_long_ptr(lc640_adr,data);
0006f0  4669              MOV      r1,sp
0006f2  4628              MOV      r0,r5
0006f4  f7fffffe          BL       lc640_read_long_ptr
;;;491         
;;;492         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
0006f8  f89d0000          LDRB     r0,[sp,#0]
0006fc  2851              CMP      r0,#0x51
0006fe  d106              BNE      |L1.1806|
000700  f89d0001          LDRB     r0,[sp,#1]
000704  b918              CBNZ     r0,|L1.1806|
000706  f89d0002          LDRB     r0,[sp,#2]
00070a  2841              CMP      r0,#0x41
00070c  d008              BEQ      |L1.1824|
                  |L1.1806|
;;;493         	{        
;;;494         	if(event_ptr_find)event_ptr_find--;
00070e  b114              CBZ      r4,|L1.1814|
000710  f1a40401          SUB      r4,r4,#1
000714  e001              B        |L1.1818|
                  |L1.1814|
;;;495         	else event_ptr_find=63;
000716  f04f043f          MOV      r4,#0x3f
                  |L1.1818|
;;;496         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
00071a  42b4              CMP      r4,r6
00071c  d1e6              BNE      |L1.1772|
00071e  e064              B        |L1.2026|
                  |L1.1824|
;;;497         	else goto avar_uout_hndl_lbl1;
;;;498         	}
;;;499         else 
;;;500         	{
;;;501         	lc640_read_long_ptr(lc640_adr+16,data);
000720  4669              MOV      r1,sp
000722  f1050010          ADD      r0,r5,#0x10
000726  f7fffffe          BL       lc640_read_long_ptr
;;;502         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00072a  f89d0000          LDRB     r0,[sp,#0]
00072e  2841              CMP      r0,#0x41
000730  d10b              BNE      |L1.1866|
000732  f89d0001          LDRB     r0,[sp,#1]
000736  2841              CMP      r0,#0x41
000738  d107              BNE      |L1.1866|
00073a  f89d0002          LDRB     r0,[sp,#2]
00073e  2841              CMP      r0,#0x41
000740  d103              BNE      |L1.1866|
000742  f89d0003          LDRB     r0,[sp,#3]
000746  2841              CMP      r0,#0x41
000748  d008              BEQ      |L1.1884|
                  |L1.1866|
;;;503         		{        
;;;504         		if(event_ptr_find)event_ptr_find--;
00074a  b114              CBZ      r4,|L1.1874|
00074c  f1a40401          SUB      r4,r4,#1
000750  e001              B        |L1.1878|
                  |L1.1874|
;;;505             		else event_ptr_find=63;
000752  f04f043f          MOV      r4,#0x3f
                  |L1.1878|
;;;506             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000756  42b4              CMP      r4,r6
000758  d1c8              BNE      |L1.1772|
00075a  e046              B        |L1.2026|
                  |L1.1884|
;;;507         		else goto avar_uout_hndl_lbl1;
;;;508         		}
;;;509    
;;;510         	}	
;;;511    	
;;;512    	data[0]=LPC_RTC->YEAR;
00075c  f1070720          ADD      r7,r7,#0x20
000760  8bb8              LDRH     r0,[r7,#0x1c]
000762  f88d0000          STRB     r0,[sp,#0]
;;;513    	data[1]=LPC_RTC->MONTH;
000766  7e38              LDRB     r0,[r7,#0x18]
000768  f88d0001          STRB     r0,[sp,#1]
;;;514    	data[2]=LPC_RTC->DOM;
00076c  7b38              LDRB     r0,[r7,#0xc]
00076e  f88d0002          STRB     r0,[sp,#2]
;;;515    	data[3]=0;
000772  f88d8003          STRB     r8,[sp,#3]
;;;516    	lc640_write_long_ptr(lc640_adr+16,data);
000776  4669              MOV      r1,sp
000778  f1050010          ADD      r0,r5,#0x10
00077c  f7fffffe          BL       lc640_write_long_ptr
;;;517    
;;;518    	data[0]=LPC_RTC->HOUR;
000780  7a38              LDRB     r0,[r7,#8]
000782  f88d0000          STRB     r0,[sp,#0]
;;;519    	data[1]=LPC_RTC->MIN;
000786  7938              LDRB     r0,[r7,#4]
000788  f88d0001          STRB     r0,[sp,#1]
;;;520    	data[2]=LPC_RTC->SEC;
00078c  7838              LDRB     r0,[r7,#0]
00078e  f88d0002          STRB     r0,[sp,#2]
;;;521    	data[3]=0;
000792  f88d8003          STRB     r8,[sp,#3]
;;;522    	lc640_write_long_ptr(lc640_adr+20,data); 
000796  4669              MOV      r1,sp
000798  f1050014          ADD      r0,r5,#0x14
00079c  f7fffffe          BL       lc640_write_long_ptr
;;;523    	
;;;524    	data[0]=*((char*)(&net_Ustore));
0007a0  482f              LDR      r0,|L1.2144|
0007a2  7801              LDRB     r1,[r0,#0]  ; net_Ustore
0007a4  f88d1000          STRB     r1,[sp,#0]
;;;525    	data[1]=*(((char*)(&net_Ustore))+1);
0007a8  7840              LDRB     r0,[r0,#1]  ; net_Ustore
0007aa  f88d0001          STRB     r0,[sp,#1]
;;;526    	data[2]='B';
0007ae  f04f0442          MOV      r4,#0x42
0007b2  f88d4002          STRB     r4,[sp,#2]
;;;527    	data[3]='B';
0007b6  f88d4003          STRB     r4,[sp,#3]
;;;528    	lc640_write_long_ptr(lc640_adr+24,data);
0007ba  4669              MOV      r1,sp
0007bc  f1050018          ADD      r0,r5,#0x18
0007c0  f7fffffe          BL       lc640_write_long_ptr
;;;529    	
;;;530    	data[0]='B';
0007c4  f88d4000          STRB     r4,[sp,#0]
;;;531    	data[1]='B';
0007c8  f88d4001          STRB     r4,[sp,#1]
;;;532    	data[2]='B';
0007cc  f88d4002          STRB     r4,[sp,#2]
;;;533    	data[3]='B';
0007d0  f88d4003          STRB     r4,[sp,#3]
;;;534    	lc640_write_long_ptr(lc640_adr+28,data);	
0007d4  4669              MOV      r1,sp
0007d6  f105001c          ADD      r0,r5,#0x1c
0007da  f7fffffe          BL       lc640_write_long_ptr
;;;535    	
;;;536    /*	memo_out0[0]=0x55;
;;;537         memo_out0[1]=0x00+2;
;;;538         memo_out0[2]=1;
;;;539         memo_out0[3]=0x0b;
;;;540         memo_out0[4]=0xaa;
;;;541         memo_out0[5]=0xaa; 
;;;542         	
;;;543         memo_out0[6]=crc_87(memo_out0,6);
;;;544    	memo_out0[7]=crc_95(memo_out0,6);
;;;545         usart_out_adr0(memo_out0,8); */
;;;546         snmp_trap_send("Main power is on",2,1,1);	
0007de  2301              MOVS     r3,#1
0007e0  461a              MOV      r2,r3
0007e2  2102              MOVS     r1,#2
0007e4  a01f              ADR      r0,|L1.2148|
0007e6  f7fffffe          BL       snmp_trap_send
                  |L1.2026|
;;;547    	}
;;;548    avar_unet_hndl_end:
;;;549    	__nop();		
0007ea  bf00              NOP      
;;;550    }
0007ec  e6c5              B        |L1.1402|
;;;551    
                          ENDP

                  avar_bps_hndl PROC
;;;552    //-----------------------------------------------
;;;553    void avar_bps_hndl(char dev, char v, char in)
0007ee  e92d4ff8          PUSH     {r3-r11,lr}
;;;554    {
0007f2  4606              MOV      r6,r0
0007f4  460c              MOV      r4,r1
;;;555    char data[4];
;;;556    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;557    char avar_simbol;
;;;558    
;;;559    avar_simbol='T';
0007f6  f04f0754          MOV      r7,#0x54
;;;560    if(v==0)avar_simbol='T';
0007fa  b174              CBZ      r4,|L1.2074|
;;;561    else if(v==1)avar_simbol='U';
0007fc  2c01              CMP      r4,#1
0007fe  d004              BEQ      |L1.2058|
;;;562    else if(v==2)avar_simbol='u';
000800  2c02              CMP      r4,#2
000802  d005              BEQ      |L1.2064|
;;;563    else if(v==3)avar_simbol='L';
000804  2c03              CMP      r4,#3
000806  d006              BEQ      |L1.2070|
000808  e007              B        |L1.2074|
                  |L1.2058|
00080a  f04f0755          MOV      r7,#0x55              ;561
00080e  e004              B        |L1.2074|
                  |L1.2064|
000810  f04f0775          MOV      r7,#0x75              ;562
000814  e001              B        |L1.2074|
                  |L1.2070|
000816  f04f074c          MOV      r7,#0x4c
                  |L1.2074|
;;;564    
;;;565    if(in==1)
;;;566    	{
;;;567    	//av_src[bps]=1;
;;;568    
;;;569    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;570    //	SET_REG(avar_stat,1,3+dev,1);
;;;571    	
;;;572    	if(v==0)bps[dev]._av|=(1<<0);
00081a  481c              LDR      r0,|L1.2188|
00081c  ebc601c6          RSB      r1,r6,r6,LSL #3
;;;573    	else if(v==1) bps[dev]._av|=(1<<1);
;;;574    	else if(v==2) bps[dev]._av|=(1<<2);
;;;575    	else if(v==3) bps[dev]._av|=(1<<3);
;;;576    
;;;577    	bps[dev]._last_avar=v;
;;;578    
;;;579    	//beep_init(0x33333333,'A');
;;;580    
;;;581    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;582    	event_ptr++;	
;;;583    	if(event_ptr>63)event_ptr=0;	
;;;584    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;585    	
;;;586         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;587    	if(event_cnt!=63)event_cnt=event_ptr;
;;;588    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;589    	
;;;590    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;591    	
;;;592    	data[0]='S';
;;;593    	data[1]=dev; 
;;;594    	data[2]=avar_simbol;
;;;595    	data[3]=0;
;;;596    	lc640_write_long_ptr(lc640_adr,data);
;;;597    
;;;598    	data[0]=0;
;;;599    	data[1]=0;
;;;600    	data[2]=0;
;;;601    	data[3]=0;
;;;602    	lc640_write_long_ptr(lc640_adr+4,data);
;;;603    
;;;604    	data[0]=LPC_RTC->YEAR;
000820  f8df8054          LDR      r8,|L1.2168|
000824  eb011106          ADD      r1,r1,r6,LSL #4       ;572
000828  f04f0900          MOV      r9,#0                 ;554
00082c  f44f6a60          MOV      r10,#0xe00            ;581
000830  f44f6580          MOV      r5,#0x400             ;590
000834  eb000081          ADD      r0,r0,r1,LSL #2       ;572
000838  2a01              CMP      r2,#1                 ;565
00083a  d029              BEQ      |L1.2192|
;;;605    	data[1]=LPC_RTC->MONTH;
;;;606    	data[2]=LPC_RTC->DOM;
;;;607    	data[3]=0;
;;;608    	lc640_write_long_ptr(lc640_adr+8,data);
;;;609    
;;;610    	data[0]=LPC_RTC->HOUR;
;;;611    	data[1]=LPC_RTC->MIN;
;;;612    	data[2]=LPC_RTC->SEC;
;;;613    	data[3]=0;
;;;614    	lc640_write_long_ptr(lc640_adr+12,data);
;;;615    	
;;;616    	data[0]='A';
;;;617    	data[1]='A';
;;;618    	data[2]='A';
;;;619    	data[3]='A';
;;;620    	lc640_write_long_ptr(lc640_adr+16,data);
;;;621    	
;;;622    	data[0]='A';
;;;623    	data[1]='A';
;;;624    	data[2]='A';
;;;625    	data[3]='A';
;;;626    	lc640_write_long_ptr(lc640_adr+20,data);
;;;627    	
;;;628    	data[0]='A';
;;;629    	data[1]='A';
;;;630    	data[2]='A';
;;;631    	data[3]='A';
;;;632    	lc640_write_long_ptr(lc640_adr+24,data);
;;;633    	
;;;634    	data[0]='A';
;;;635    	data[1]='A';
;;;636    	data[2]='A';
;;;637    	data[3]='A';
;;;638    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;639    
;;;640    
;;;641    	if(dev==0)
;;;642    		{
;;;643    		if(v==0)
;;;644    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;645    		else if(v==1)
;;;646    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;647    		else if(v==2)
;;;648    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;649    		else if(v==3)
;;;650    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;651    		}
;;;652    	else if(dev==1)
;;;653    		{
;;;654    		if(v==0)
;;;655    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;656    		else if(v==1)
;;;657    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;658    		else if(v==2)
;;;659    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;660    		else if(v==3)
;;;661    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;662    		} 
;;;663    	else if(dev==2)
;;;664    		{
;;;665    		if(v==0)
;;;666    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;667    		else if(v==1)
;;;668    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;669    		else if(v==2)
;;;670    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;671    		else if(v==3)
;;;672    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;673    		} 	
;;;674    			
;;;675    	}
;;;676    
;;;677    else if(in==0)
00083c  2a00              CMP      r2,#0
00083e  d07d              BEQ      |L1.2364|
000840  e1eb              B        |L1.3098|
000842  0000              DCW      0x0000
                  |L1.2116|
000844  4d61696e          DCB      "Main power is off",0
000848  20706f77
00084c  65722069
000850  73206f66
000854  6600    
000856  00                DCB      0
000857  00                DCB      0
                  |L1.2136|
                          DCD      ||.data||
                  |L1.2140|
                          DCD      AV_OFF_AVT
                  |L1.2144|
                          DCD      net_Ustore
                  |L1.2148|
000864  4d61696e          DCB      "Main power is on",0
000868  20706f77
00086c  65722069
000870  73206f6e
000874  00      
000875  00                DCB      0
000876  00                DCB      0
000877  00                DCB      0
                  |L1.2168|
                          DCD      0x40024000
                  |L1.2172|
                          DCD      uout_av
                  |L1.2176|
                          DCD      load_U
                  |L1.2180|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2184|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2188|
                          DCD      bps
                  |L1.2192|
000890  b134              CBZ      r4,|L1.2208|
000892  2c01              CMP      r4,#1                 ;573
000894  d009              BEQ      |L1.2218|
000896  2c02              CMP      r4,#2                 ;574
000898  d00c              BEQ      |L1.2228|
00089a  2c03              CMP      r4,#3                 ;575
00089c  d00f              BEQ      |L1.2238|
00089e  e012              B        |L1.2246|
                  |L1.2208|
0008a0  7841              LDRB     r1,[r0,#1]            ;572
0008a2  f0410101          ORR      r1,r1,#1              ;572
0008a6  7041              STRB     r1,[r0,#1]            ;572
0008a8  e00d              B        |L1.2246|
                  |L1.2218|
0008aa  7841              LDRB     r1,[r0,#1]            ;573
0008ac  f0410102          ORR      r1,r1,#2              ;573
0008b0  7041              STRB     r1,[r0,#1]            ;573
0008b2  e008              B        |L1.2246|
                  |L1.2228|
0008b4  7841              LDRB     r1,[r0,#1]            ;574
0008b6  f0410104          ORR      r1,r1,#4              ;574
0008ba  7041              STRB     r1,[r0,#1]            ;574
0008bc  e003              B        |L1.2246|
                  |L1.2238|
0008be  7841              LDRB     r1,[r0,#1]            ;575
0008c0  f0410108          ORR      r1,r1,#8              ;575
0008c4  7041              STRB     r1,[r0,#1]            ;575
                  |L1.2246|
0008c6  f8804053          STRB     r4,[r0,#0x53]         ;577
0008ca  4650              MOV      r0,r10                ;581
0008cc  f7fffffe          BL       lc640_read_int
0008d0  f1000001          ADD      r0,r0,#1              ;582
0008d4  fa1ffb80          UXTH     r11,r0                ;582
0008d8  f1bb0f3f          CMP      r11,#0x3f             ;583
0008dc  d901              BLS      |L1.2274|
0008de  f04f0b00          MOV      r11,#0                ;583
                  |L1.2274|
0008e2  fa0ff18b          SXTH     r1,r11                ;584
0008e6  4650              MOV      r0,r10                ;584
0008e8  f7fffffe          BL       lc640_write_int
0008ec  f6406002          MOV      r0,#0xe02             ;586
0008f0  f7fffffe          BL       lc640_read_int
0008f4  b280              UXTH     r0,r0                 ;586
0008f6  283f              CMP      r0,#0x3f              ;587
0008f8  d000              BEQ      |L1.2300|
0008fa  4658              MOV      r0,r11                ;587
                  |L1.2300|
0008fc  b201              SXTH     r1,r0                 ;588
0008fe  f6406002          MOV      r0,#0xe02             ;588
000902  f7fffffe          BL       lc640_write_int
000906  4650              MOV      r0,r10                ;590
000908  f7fffffe          BL       lc640_read_int
00090c  eb051040          ADD      r0,r5,r0,LSL #5       ;590
000910  b285              UXTH     r5,r0                 ;590
000912  f04f0053          MOV      r0,#0x53              ;592
000916  f88d0000          STRB     r0,[sp,#0]            ;592
00091a  f88d6001          STRB     r6,[sp,#1]            ;593
00091e  f88d7002          STRB     r7,[sp,#2]            ;594
000922  f88d9003          STRB     r9,[sp,#3]            ;595
000926  4669              MOV      r1,sp                 ;596
000928  4628              MOV      r0,r5                 ;596
00092a  f7fffffe          BL       lc640_write_long_ptr
00092e  f8cd9000          STR      r9,[sp,#0]            ;601
000932  4669              MOV      r1,sp                 ;602
000934  1d28              ADDS     r0,r5,#4              ;602
000936  f7fffffe          BL       lc640_write_long_ptr
00093a  e000              B        |L1.2366|
                  |L1.2364|
00093c  e0cd              B        |L1.2778|
                  |L1.2366|
00093e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;604
000942  f88d0000          STRB     r0,[sp,#0]            ;604
000946  f8980038          LDRB     r0,[r8,#0x38]         ;605
00094a  f88d0001          STRB     r0,[sp,#1]            ;605
00094e  f898002c          LDRB     r0,[r8,#0x2c]         ;606
000952  f88d0002          STRB     r0,[sp,#2]            ;606
000956  f88d9003          STRB     r9,[sp,#3]            ;607
00095a  4669              MOV      r1,sp                 ;608
00095c  f1050008          ADD      r0,r5,#8              ;608
000960  f7fffffe          BL       lc640_write_long_ptr
000964  f8980028          LDRB     r0,[r8,#0x28]         ;610
000968  f88d0000          STRB     r0,[sp,#0]            ;610
00096c  f8980024          LDRB     r0,[r8,#0x24]         ;611
000970  f88d0001          STRB     r0,[sp,#1]            ;611
000974  f8980020          LDRB     r0,[r8,#0x20]         ;612
000978  f88d0002          STRB     r0,[sp,#2]            ;612
00097c  f88d9003          STRB     r9,[sp,#3]            ;613
000980  4669              MOV      r1,sp                 ;614
000982  f105000c          ADD      r0,r5,#0xc            ;614
000986  f7fffffe          BL       lc640_write_long_ptr
00098a  f04f0741          MOV      r7,#0x41              ;616
00098e  f88d7000          STRB     r7,[sp,#0]            ;616
000992  f88d7001          STRB     r7,[sp,#1]            ;617
000996  f88d7002          STRB     r7,[sp,#2]            ;618
00099a  f88d7003          STRB     r7,[sp,#3]            ;619
00099e  4669              MOV      r1,sp                 ;620
0009a0  f1050010          ADD      r0,r5,#0x10           ;620
0009a4  f7fffffe          BL       lc640_write_long_ptr
0009a8  f88d7000          STRB     r7,[sp,#0]            ;622
0009ac  f88d7001          STRB     r7,[sp,#1]            ;623
0009b0  f88d7002          STRB     r7,[sp,#2]            ;624
0009b4  f88d7003          STRB     r7,[sp,#3]            ;625
0009b8  4669              MOV      r1,sp                 ;626
0009ba  f1050014          ADD      r0,r5,#0x14           ;626
0009be  f7fffffe          BL       lc640_write_long_ptr
0009c2  f88d7000          STRB     r7,[sp,#0]            ;628
0009c6  f88d7001          STRB     r7,[sp,#1]            ;629
0009ca  f88d7002          STRB     r7,[sp,#2]            ;630
0009ce  f88d7003          STRB     r7,[sp,#3]            ;631
0009d2  4669              MOV      r1,sp                 ;632
0009d4  f1050018          ADD      r0,r5,#0x18           ;632
0009d8  f7fffffe          BL       lc640_write_long_ptr
0009dc  f88d7000          STRB     r7,[sp,#0]            ;634
0009e0  f88d7001          STRB     r7,[sp,#1]            ;635
0009e4  f88d7002          STRB     r7,[sp,#2]            ;636
0009e8  f88d7003          STRB     r7,[sp,#3]            ;637
0009ec  4669              MOV      r1,sp                 ;638
0009ee  f105001c          ADD      r0,r5,#0x1c           ;638
0009f2  f7fffffe          BL       lc640_write_long_ptr
0009f6  b126              CBZ      r6,|L1.2562|
0009f8  2e01              CMP      r6,#1                 ;652
0009fa  d026              BEQ      |L1.2634|
0009fc  2e02              CMP      r6,#2                 ;663
0009fe  d048              BEQ      |L1.2706|
000a00  e10b              B        |L1.3098|
                  |L1.2562|
000a02  b134              CBZ      r4,|L1.2578|
000a04  2c01              CMP      r4,#1                 ;645
000a06  d00b              BEQ      |L1.2592|
000a08  2c02              CMP      r4,#2                 ;647
000a0a  d010              BEQ      |L1.2606|
000a0c  2c03              CMP      r4,#3                 ;649
000a0e  d015              BEQ      |L1.2620|
000a10  e103              B        |L1.3098|
                  |L1.2578|
000a12  2300              MOVS     r3,#0                 ;644
000a14  2201              MOVS     r2,#1                 ;644
000a16  2104              MOVS     r1,#4                 ;644
000a18  a0d7              ADR      r0,|L1.3448|
000a1a  f7fffffe          BL       snmp_trap_send
000a1e  e0fc              B        |L1.3098|
                  |L1.2592|
000a20  2301              MOVS     r3,#1                 ;646
000a22  461a              MOV      r2,r3                 ;646
000a24  2104              MOVS     r1,#4                 ;646
000a26  a0da              ADR      r0,|L1.3472|
000a28  f7fffffe          BL       snmp_trap_send
000a2c  e0f5              B        |L1.3098|
                  |L1.2606|
000a2e  2302              MOVS     r3,#2                 ;648
000a30  2201              MOVS     r2,#1                 ;648
000a32  2104              MOVS     r1,#4                 ;648
000a34  a0dd              ADR      r0,|L1.3500|
000a36  f7fffffe          BL       snmp_trap_send
000a3a  e0ee              B        |L1.3098|
                  |L1.2620|
000a3c  2303              MOVS     r3,#3                 ;650
000a3e  2201              MOVS     r2,#1                 ;650
000a40  2104              MOVS     r1,#4                 ;650
000a42  a0e2              ADR      r0,|L1.3532|
000a44  f7fffffe          BL       snmp_trap_send
000a48  e0e7              B        |L1.3098|
                  |L1.2634|
000a4a  b134              CBZ      r4,|L1.2650|
000a4c  2c01              CMP      r4,#1                 ;656
000a4e  d00b              BEQ      |L1.2664|
000a50  2c02              CMP      r4,#2                 ;658
000a52  d010              BEQ      |L1.2678|
000a54  2c03              CMP      r4,#3                 ;660
000a56  d015              BEQ      |L1.2692|
000a58  e0df              B        |L1.3098|
                  |L1.2650|
000a5a  2300              MOVS     r3,#0                 ;655
000a5c  2202              MOVS     r2,#2                 ;655
000a5e  2104              MOVS     r1,#4                 ;655
000a60  a0e2              ADR      r0,|L1.3564|
000a62  f7fffffe          BL       snmp_trap_send
000a66  e0d8              B        |L1.3098|
                  |L1.2664|
000a68  2301              MOVS     r3,#1                 ;657
000a6a  2202              MOVS     r2,#2                 ;657
000a6c  2104              MOVS     r1,#4                 ;657
000a6e  a0e5              ADR      r0,|L1.3588|
000a70  f7fffffe          BL       snmp_trap_send
000a74  e0d1              B        |L1.3098|
                  |L1.2678|
000a76  2302              MOVS     r3,#2                 ;659
000a78  461a              MOV      r2,r3                 ;659
000a7a  2104              MOVS     r1,#4                 ;659
000a7c  a0e8              ADR      r0,|L1.3616|
000a7e  f7fffffe          BL       snmp_trap_send
000a82  e0ca              B        |L1.3098|
                  |L1.2692|
000a84  2303              MOVS     r3,#3                 ;661
000a86  2202              MOVS     r2,#2                 ;661
000a88  2104              MOVS     r1,#4                 ;661
000a8a  a0ed              ADR      r0,|L1.3648|
000a8c  f7fffffe          BL       snmp_trap_send
000a90  e0c3              B        |L1.3098|
                  |L1.2706|
000a92  b134              CBZ      r4,|L1.2722|
000a94  2c01              CMP      r4,#1                 ;667
000a96  d00b              BEQ      |L1.2736|
000a98  2c02              CMP      r4,#2                 ;669
000a9a  d010              BEQ      |L1.2750|
000a9c  2c03              CMP      r4,#3                 ;671
000a9e  d015              BEQ      |L1.2764|
000aa0  e0bb              B        |L1.3098|
                  |L1.2722|
000aa2  2300              MOVS     r3,#0                 ;666
000aa4  2203              MOVS     r2,#3                 ;666
000aa6  2104              MOVS     r1,#4                 ;666
000aa8  a0ed              ADR      r0,|L1.3680|
000aaa  f7fffffe          BL       snmp_trap_send
000aae  e0b4              B        |L1.3098|
                  |L1.2736|
000ab0  2301              MOVS     r3,#1                 ;668
000ab2  2203              MOVS     r2,#3                 ;668
000ab4  2104              MOVS     r1,#4                 ;668
000ab6  a0f0              ADR      r0,|L1.3704|
000ab8  f7fffffe          BL       snmp_trap_send
000abc  e0ad              B        |L1.3098|
                  |L1.2750|
000abe  2302              MOVS     r3,#2                 ;670
000ac0  2203              MOVS     r2,#3                 ;670
000ac2  2104              MOVS     r1,#4                 ;670
000ac4  a0f3              ADR      r0,|L1.3732|
000ac6  f7fffffe          BL       snmp_trap_send
000aca  e0a6              B        |L1.3098|
                  |L1.2764|
000acc  2303              MOVS     r3,#3                 ;672
000ace  461a              MOV      r2,r3                 ;672
000ad0  2104              MOVS     r1,#4                 ;672
000ad2  a0f8              ADR      r0,|L1.3764|
000ad4  f7fffffe          BL       snmp_trap_send
000ad8  e09f              B        |L1.3098|
                  |L1.2778|
;;;678    	{      
;;;679    //	av_bps[bps]=0;
;;;680    
;;;681    	//SET_REG(avar_stat,0,3+bps,1);
;;;682    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;683    
;;;684         if(v==0) bps[dev]._av&=(~(1<<0));
000ada  b134              CBZ      r4,|L1.2794|
;;;685         else if(v==1) bps[dev]._av&=(~(1<<1));
000adc  2c01              CMP      r4,#1
000ade  d009              BEQ      |L1.2804|
;;;686    	else if(v==2) bps[dev]._av&=(~(1<<2));
000ae0  2c02              CMP      r4,#2
000ae2  d00c              BEQ      |L1.2814|
;;;687    	else if(v==3) bps[dev]._av&=(~(1<<3));
000ae4  2c03              CMP      r4,#3
000ae6  d00f              BEQ      |L1.2824|
000ae8  e012              B        |L1.2832|
                  |L1.2794|
000aea  7841              LDRB     r1,[r0,#1]            ;684
000aec  f0210101          BIC      r1,r1,#1              ;684
000af0  7041              STRB     r1,[r0,#1]            ;684
000af2  e00d              B        |L1.2832|
                  |L1.2804|
000af4  7841              LDRB     r1,[r0,#1]            ;685
000af6  f0210102          BIC      r1,r1,#2              ;685
000afa  7041              STRB     r1,[r0,#1]            ;685
000afc  e008              B        |L1.2832|
                  |L1.2814|
000afe  7841              LDRB     r1,[r0,#1]            ;686
000b00  f0210104          BIC      r1,r1,#4              ;686
000b04  7041              STRB     r1,[r0,#1]            ;686
000b06  e003              B        |L1.2832|
                  |L1.2824|
000b08  7841              LDRB     r1,[r0,#1]
000b0a  f0210108          BIC      r1,r1,#8
000b0e  7041              STRB     r1,[r0,#1]
                  |L1.2832|
;;;688         
;;;689    //	if((bps[dev]._av&0x0f==0))
;;;690    //	     {
;;;691    		//SET_REG(avar_stat,0,3+bps,1);
;;;692    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;693    //	     }
;;;694     
;;;695    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000b10  4650              MOV      r0,r10
000b12  f7fffffe          BL       lc640_read_int
000b16  fa1ffb80          UXTH     r11,r0
;;;696    	event_ptr_find=event_ptr;
000b1a  465c              MOV      r4,r11
                  |L1.2844|
;;;697    	
;;;698    avar_src_hndl_lbl1: 
;;;699    
;;;700    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000b1c  eb051044          ADD      r0,r5,r4,LSL #5
000b20  fa1ffa80          UXTH     r10,r0
;;;701    
;;;702         lc640_read_long_ptr(lc640_adr,data);
000b24  4669              MOV      r1,sp
000b26  4650              MOV      r0,r10
000b28  f7fffffe          BL       lc640_read_long_ptr
;;;703         
;;;704         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000b2c  f89d0000          LDRB     r0,[sp,#0]
000b30  2853              CMP      r0,#0x53
000b32  d107              BNE      |L1.2884|
000b34  f89d0001          LDRB     r0,[sp,#1]
000b38  42b0              CMP      r0,r6
000b3a  d103              BNE      |L1.2884|
000b3c  f89d0002          LDRB     r0,[sp,#2]
000b40  42b8              CMP      r0,r7
000b42  d009              BEQ      |L1.2904|
                  |L1.2884|
;;;705         	{        
;;;706         	if(event_ptr_find)event_ptr_find--;
000b44  b11c              CBZ      r4,|L1.2894|
000b46  f1a40401          SUB      r4,r4,#1
000b4a  b2a4              UXTH     r4,r4
000b4c  e001              B        |L1.2898|
                  |L1.2894|
;;;707         	else event_ptr_find=63;
000b4e  f04f043f          MOV      r4,#0x3f
                  |L1.2898|
;;;708         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000b52  455c              CMP      r4,r11
000b54  d1e2              BNE      |L1.2844|
000b56  e060              B        |L1.3098|
                  |L1.2904|
;;;709         	else goto avar_src_hndl_lbl1;
;;;710         	}
;;;711         else 
;;;712         	{
;;;713         	lc640_read_long_ptr(lc640_adr+16,data);
000b58  4669              MOV      r1,sp
000b5a  f10a0010          ADD      r0,r10,#0x10
000b5e  f7fffffe          BL       lc640_read_long_ptr
;;;714         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000b62  f89d0000          LDRB     r0,[sp,#0]
000b66  2841              CMP      r0,#0x41
000b68  d10b              BNE      |L1.2946|
000b6a  f89d0001          LDRB     r0,[sp,#1]
000b6e  2841              CMP      r0,#0x41
000b70  d107              BNE      |L1.2946|
000b72  f89d0002          LDRB     r0,[sp,#2]
000b76  2841              CMP      r0,#0x41
000b78  d103              BNE      |L1.2946|
000b7a  f89d0003          LDRB     r0,[sp,#3]
000b7e  2841              CMP      r0,#0x41
000b80  d009              BEQ      |L1.2966|
                  |L1.2946|
;;;715         		{        
;;;716         		if(event_ptr_find)event_ptr_find--;
000b82  b11c              CBZ      r4,|L1.2956|
000b84  f1a40401          SUB      r4,r4,#1
000b88  b2a4              UXTH     r4,r4
000b8a  e001              B        |L1.2960|
                  |L1.2956|
;;;717             		else event_ptr_find=63;
000b8c  f04f043f          MOV      r4,#0x3f
                  |L1.2960|
;;;718             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000b90  455c              CMP      r4,r11
000b92  d1c3              BNE      |L1.2844|
000b94  e041              B        |L1.3098|
                  |L1.2966|
;;;719         		else goto avar_src_hndl_lbl1;
;;;720         		}
;;;721    
;;;722         	}	
;;;723    
;;;724    
;;;725    	
;;;726    	data[0]=LPC_RTC->YEAR;
000b96  f8b8003c          LDRH     r0,[r8,#0x3c]
000b9a  f88d0000          STRB     r0,[sp,#0]
;;;727    	data[1]=LPC_RTC->MONTH;
000b9e  f8980038          LDRB     r0,[r8,#0x38]
000ba2  f88d0001          STRB     r0,[sp,#1]
;;;728    	data[2]=LPC_RTC->DOM;
000ba6  f898002c          LDRB     r0,[r8,#0x2c]
000baa  f88d0002          STRB     r0,[sp,#2]
;;;729    	data[3]=0;
000bae  f88d9003          STRB     r9,[sp,#3]
;;;730    	lc640_write_long_ptr(lc640_adr+16,data);
000bb2  4669              MOV      r1,sp
000bb4  f10a0010          ADD      r0,r10,#0x10
000bb8  f7fffffe          BL       lc640_write_long_ptr
;;;731    
;;;732    	data[0]=LPC_RTC->HOUR;
000bbc  f8980028          LDRB     r0,[r8,#0x28]
000bc0  f88d0000          STRB     r0,[sp,#0]
;;;733    	data[1]=LPC_RTC->MIN;
000bc4  f8980024          LDRB     r0,[r8,#0x24]
000bc8  f88d0001          STRB     r0,[sp,#1]
;;;734    	data[2]=LPC_RTC->SEC;
000bcc  f8980020          LDRB     r0,[r8,#0x20]
000bd0  f88d0002          STRB     r0,[sp,#2]
;;;735    	data[3]=0;
000bd4  f88d9003          STRB     r9,[sp,#3]
;;;736    	lc640_write_long_ptr(lc640_adr+20,data);
000bd8  4669              MOV      r1,sp
000bda  f10a0014          ADD      r0,r10,#0x14
000bde  f7fffffe          BL       lc640_write_long_ptr
;;;737    	
;;;738    	data[0]='B';
000be2  f04f0442          MOV      r4,#0x42
000be6  f88d4000          STRB     r4,[sp,#0]
;;;739    	data[1]='B';
000bea  f88d4001          STRB     r4,[sp,#1]
;;;740    	data[2]='B';
000bee  f88d4002          STRB     r4,[sp,#2]
;;;741    	data[3]='B';
000bf2  f88d4003          STRB     r4,[sp,#3]
;;;742    	lc640_write_long_ptr(lc640_adr+24,data);
000bf6  4669              MOV      r1,sp
000bf8  f10a0018          ADD      r0,r10,#0x18
000bfc  f7fffffe          BL       lc640_write_long_ptr
;;;743    	
;;;744    	data[0]='B';
000c00  f88d4000          STRB     r4,[sp,#0]
;;;745    	data[1]='B';
000c04  f88d4001          STRB     r4,[sp,#1]
;;;746    	data[2]='B';
000c08  f88d4002          STRB     r4,[sp,#2]
;;;747    	data[3]='B';
000c0c  f88d4003          STRB     r4,[sp,#3]
;;;748    	lc640_write_long_ptr(lc640_adr+28,data);
000c10  4669              MOV      r1,sp
000c12  f10a001c          ADD      r0,r10,#0x1c
000c16  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3098|
;;;749    	
;;;750    	}
;;;751    	
;;;752    avar_src_hndl_end:
;;;753    __nop();		
000c1a  bf00              NOP      
                  |L1.3100|
;;;754    }
000c1c  e8bd8ff8          POP      {r3-r11,pc}
;;;755    
                          ENDP

                  wrk_mem_hndl PROC
;;;756    //-----------------------------------------------
;;;757    void wrk_mem_hndl(char b)
000c20  e92d41fc          PUSH     {r2-r8,lr}
;;;758    {
000c24  4606              MOV      r6,r0
;;;759    char data[4];
;;;760    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;761    
;;;762    signed short temp_temp;
;;;763    
;;;764    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000c26  eb060046          ADD      r0,r6,r6,LSL #1
000c2a  eb001106          ADD      r1,r0,r6,LSL #4
000c2e  48a9              LDR      r0,|L1.3796|
000c30  eb000481          ADD      r4,r0,r1,LSL #2
000c34  8be0              LDRH     r0,[r4,#0x1e]
000c36  2805              CMP      r0,#5
000c38  d37e              BCC      |L1.3384|
;;;765    
;;;766    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000c3a  48a7              LDR      r0,|L1.3800|
000c3c  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000c3e  f1000006          ADD      r0,r0,#6
000c42  f0000007          AND      r0,r0,#7
000c46  eb040040          ADD      r0,r4,r0,LSL #1
000c4a  8c00              LDRH     r0,[r0,#0x20]
000c4c  9000              STR      r0,[sp,#0]
;;;767    
;;;768    
;;;769    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000c4e  f44f6760          MOV      r7,#0xe00
000c52  4638              MOV      r0,r7
000c54  f7fffffe          BL       lc640_read_int
;;;770    event_ptr++;	
000c58  f1000001          ADD      r0,r0,#1
000c5c  b285              UXTH     r5,r0
;;;771    if(event_ptr>63)event_ptr=0;	
000c5e  2d3f              CMP      r5,#0x3f
000c60  d901              BLS      |L1.3174|
000c62  f04f0500          MOV      r5,#0
                  |L1.3174|
;;;772    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000c66  b229              SXTH     r1,r5
000c68  4638              MOV      r0,r7
000c6a  f7fffffe          BL       lc640_write_int
;;;773    	
;;;774    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000c6e  f6406802          MOV      r8,#0xe02
000c72  4640              MOV      r0,r8
000c74  f7fffffe          BL       lc640_read_int
000c78  b280              UXTH     r0,r0
;;;775    if(event_cnt!=63)event_cnt=event_ptr;
000c7a  283f              CMP      r0,#0x3f
000c7c  d000              BEQ      |L1.3200|
000c7e  4628              MOV      r0,r5
                  |L1.3200|
;;;776    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000c80  b201              SXTH     r1,r0
000c82  4640              MOV      r0,r8
000c84  f7fffffe          BL       lc640_write_int
;;;777    	
;;;778    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000c88  4638              MOV      r0,r7
000c8a  f7fffffe          BL       lc640_read_int
000c8e  f44f6180          MOV      r1,#0x400
000c92  eb011040          ADD      r0,r1,r0,LSL #5
000c96  b285              UXTH     r5,r0
;;;779    	
;;;780    data[0]='B';
000c98  f04f0042          MOV      r0,#0x42
000c9c  f88d0004          STRB     r0,[sp,#4]
;;;781    data[1]=b; 
000ca0  f88d6005          STRB     r6,[sp,#5]
;;;782    data[2]='W';
000ca4  f04f0057          MOV      r0,#0x57
000ca8  f88d0006          STRB     r0,[sp,#6]
;;;783    data[3]=0;
000cac  f04f0600          MOV      r6,#0
000cb0  f88d6007          STRB     r6,[sp,#7]
;;;784    
;;;785    lc640_write_long_ptr(lc640_adr,data);
000cb4  a901              ADD      r1,sp,#4
000cb6  4628              MOV      r0,r5
000cb8  f7fffffe          BL       lc640_write_long_ptr
;;;786    
;;;787    data[0]=*((char*)&bat[b]._Iintegr_);
000cbc  7fa0              LDRB     r0,[r4,#0x1e]
000cbe  f88d0004          STRB     r0,[sp,#4]
;;;788    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000cc2  7fe0              LDRB     r0,[r4,#0x1f]
000cc4  f88d0005          STRB     r0,[sp,#5]
;;;789    data[2]=*((char*)&temp_temp);
000cc8  f89d0000          LDRB     r0,[sp,#0]
000ccc  f88d0006          STRB     r0,[sp,#6]
;;;790    data[3]=*(((char*)(&temp_temp))+1);
000cd0  f89d0001          LDRB     r0,[sp,#1]
000cd4  f88d0007          STRB     r0,[sp,#7]
;;;791    lc640_write_long_ptr(lc640_adr+4,data);
000cd8  a901              ADD      r1,sp,#4
000cda  1d28              ADDS     r0,r5,#4
000cdc  f7fffffe          BL       lc640_write_long_ptr
;;;792    
;;;793    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000ce0  f1040134          ADD      r1,r4,#0x34
000ce4  f1050008          ADD      r0,r5,#8
000ce8  f7fffffe          BL       lc640_write_long_ptr
;;;794    	
;;;795    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000cec  f1040138          ADD      r1,r4,#0x38
000cf0  f105000c          ADD      r0,r5,#0xc
000cf4  f7fffffe          BL       lc640_write_long_ptr
;;;796    
;;;797    data[0]=LPC_RTC->YEAR;
000cf8  4c78              LDR      r4,|L1.3804|
000cfa  8ba0              LDRH     r0,[r4,#0x1c]
000cfc  f88d0004          STRB     r0,[sp,#4]
;;;798    data[1]=LPC_RTC->MONTH;
000d00  7e20              LDRB     r0,[r4,#0x18]
000d02  f88d0005          STRB     r0,[sp,#5]
;;;799    data[2]=LPC_RTC->DOM;
000d06  7b20              LDRB     r0,[r4,#0xc]
000d08  f88d0006          STRB     r0,[sp,#6]
;;;800    data[3]=0;
000d0c  f88d6007          STRB     r6,[sp,#7]
;;;801    lc640_write_long_ptr(lc640_adr+16,data);
000d10  a901              ADD      r1,sp,#4
000d12  f1050010          ADD      r0,r5,#0x10
000d16  f7fffffe          BL       lc640_write_long_ptr
;;;802    
;;;803    data[0]=LPC_RTC->HOUR;
000d1a  7a20              LDRB     r0,[r4,#8]
000d1c  f88d0004          STRB     r0,[sp,#4]
;;;804    data[1]=LPC_RTC->MIN;
000d20  7920              LDRB     r0,[r4,#4]
000d22  f88d0005          STRB     r0,[sp,#5]
;;;805    data[2]=LPC_RTC->SEC;
000d26  7820              LDRB     r0,[r4,#0]
000d28  f88d0006          STRB     r0,[sp,#6]
;;;806    data[3]=0;
000d2c  f88d6007          STRB     r6,[sp,#7]
;;;807    lc640_write_long_ptr(lc640_adr+20,data);
000d30  a901              ADD      r1,sp,#4
000d32  f1050014          ADD      r0,r5,#0x14
000d36  e000              B        |L1.3386|
                  |L1.3384|
000d38  e001              B        |L1.3390|
                  |L1.3386|
000d3a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3390|
;;;808    	
;;;809    
;;;810    
;;;811    	
;;;812    wrk_mem_hndl_end:	
;;;813    __nop();
000d3e  bf00              NOP      
;;;814    }  
000d40  e8bd81fc          POP      {r2-r8,pc}
;;;815    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;817    //-----------------------------------------------
;;;818    void avar_bat_ips_hndl(char in)
000d44  e92d4ff8          PUSH     {r3-r11,lr}
;;;819    {
000d48  4602              MOV      r2,r0
;;;820    char data[4];
;;;821    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;822    
;;;823    if(in==1)
;;;824    	{
;;;825    	bat_ips._av|=1;
000d4a  4865              LDR      r0,|L1.3808|
;;;826        	ips_bat_av_stat=1;
000d4c  4c65              LDR      r4,|L1.3812|
;;;827    	ips_bat_av_vzvod=1;
000d4e  4b66              LDR      r3,|L1.3816|
;;;828    
;;;829    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;830    	event_ptr++;	
;;;831    	if(event_ptr>63)event_ptr=0;	
;;;832    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;833    	
;;;834         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;835    	if(event_cnt!=63)event_cnt=event_ptr;
;;;836    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;837    	
;;;838    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;839    	
;;;840    	data[0]='B';
;;;841    	data[1]=0;
;;;842    	data[2]='C';
;;;843    	data[3]=0;
;;;844    	lc640_write_long_ptr(lc640_adr,data);
;;;845    
;;;846    	data[0]=0;
;;;847    	data[1]=0;
;;;848    	data[2]=0;
;;;849    	data[3]=0;
;;;850    	lc640_write_long_ptr(lc640_adr+4,data);
;;;851    
;;;852    	data[0]=LPC_RTC->YEAR;
000d50  f8df8198          LDR      r8,|L1.3820|
000d54  f890103d          LDRB     r1,[r0,#0x3d]         ;825
000d58  f04f0742          MOV      r7,#0x42              ;840
000d5c  f44f6560          MOV      r5,#0xe00             ;829
000d60  f04f0900          MOV      r9,#0                 ;831
000d64  f44f6a80          MOV      r10,#0x400            ;838
000d68  2a01              CMP      r2,#1                 ;823
000d6a  d002              BEQ      |L1.3442|
;;;853    	data[1]=LPC_RTC->MONTH;
;;;854    	data[2]=LPC_RTC->DOM;
;;;855    	data[3]=0;
;;;856    	lc640_write_long_ptr(lc640_adr+8,data);
;;;857    
;;;858    	data[0]=LPC_RTC->HOUR;
;;;859    	data[1]=LPC_RTC->MIN;
;;;860    	data[2]=LPC_RTC->SEC;
;;;861    	data[3]=0;
;;;862    	lc640_write_long_ptr(lc640_adr+12,data);
;;;863    	
;;;864    	data[0]='A';
;;;865    	data[1]='A';
;;;866    	data[2]='A';
;;;867    	data[3]='A';
;;;868    	lc640_write_long_ptr(lc640_adr+16,data);
;;;869    	
;;;870    	data[0]='A';
;;;871    	data[1]='A';
;;;872    	data[2]='A';
;;;873    	data[3]='A';
;;;874    	lc640_write_long_ptr(lc640_adr+20,data);
;;;875    	
;;;876    	data[0]='A';
;;;877    	data[1]='A';
;;;878    	data[2]='A';
;;;879    	data[3]='A';
;;;880    	lc640_write_long_ptr(lc640_adr+24,data);
;;;881    	
;;;882    	data[0]='A';
;;;883    	data[1]='A';
;;;884    	data[2]='A';
;;;885    	data[3]='A';
;;;886    	lc640_write_long_ptr(lc640_adr+28,data);
;;;887    					
;;;888    	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;889    		
;;;890    	}
;;;891    
;;;892    else if(in==0)
000d6c  2a00              CMP      r2,#0
000d6e  d001              BEQ      |L1.3444|
000d70  e1e6              B        |L1.4416|
                  |L1.3442|
000d72  e0bd              B        |L1.3824|
                  |L1.3444|
000d74  e15c              B        |L1.4144|
000d76  0000              DCW      0x0000
                  |L1.3448|
000d78  42505320          DCB      "BPS #1 Alarm, overheat",0
000d7c  23312041
000d80  6c61726d
000d84  2c206f76
000d88  65726865
000d8c  617400  
000d8f  00                DCB      0
                  |L1.3472|
000d90  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000d94  23312041
000d98  6c61726d
000d9c  2c20766f
000da0  6c746167
000da4  65206973
000da8  20757000
                  |L1.3500|
000dac  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000db0  23312041
000db4  6c61726d
000db8  2c20766f
000dbc  6c746167
000dc0  65206973
000dc4  20646f77
000dc8  6e00    
000dca  00                DCB      0
000dcb  00                DCB      0
                  |L1.3532|
000dcc  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000dd0  23312041
000dd4  6c61726d
000dd8  2c20636f
000ddc  6e6e6563
000de0  74206973
000de4  206c6f73
000de8  7400    
000dea  00                DCB      0
000deb  00                DCB      0
                  |L1.3564|
000dec  42505320          DCB      "BPS #2 Alarm, overheat",0
000df0  23322041
000df4  6c61726d
000df8  2c206f76
000dfc  65726865
000e00  617400  
000e03  00                DCB      0
                  |L1.3588|
000e04  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000e08  23322041
000e0c  6c61726d
000e10  2c20766f
000e14  6c746167
000e18  65206973
000e1c  20757000
                  |L1.3616|
000e20  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000e24  23322041
000e28  6c61726d
000e2c  2c20766f
000e30  6c746167
000e34  65206973
000e38  20646f77
000e3c  6e00    
000e3e  00                DCB      0
000e3f  00                DCB      0
                  |L1.3648|
000e40  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000e44  23322041
000e48  6c61726d
000e4c  2c20636f
000e50  6e6e6563
000e54  74206973
000e58  206c6f73
000e5c  7400    
000e5e  00                DCB      0
000e5f  00                DCB      0
                  |L1.3680|
000e60  42505320          DCB      "BPS #3 Alarm, overheat",0
000e64  23332041
000e68  6c61726d
000e6c  2c206f76
000e70  65726865
000e74  617400  
000e77  00                DCB      0
                  |L1.3704|
000e78  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000e7c  23332041
000e80  6c61726d
000e84  2c20766f
000e88  6c746167
000e8c  65206973
000e90  20757000
                  |L1.3732|
000e94  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000e98  23332041
000e9c  6c61726d
000ea0  2c20766f
000ea4  6c746167
000ea8  65206973
000eac  20646f77
000eb0  6e00    
000eb2  00                DCB      0
000eb3  00                DCB      0
                  |L1.3764|
000eb4  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000eb8  23332041
000ebc  6c61726d
000ec0  2c20636f
000ec4  6e6e6563
000ec8  74206973
000ecc  206c6f73
000ed0  7400    
000ed2  00                DCB      0
000ed3  00                DCB      0
                  |L1.3796|
                          DCD      bat
                  |L1.3800|
                          DCD      bat_u_old_cnt
                  |L1.3804|
                          DCD      0x40024020
                  |L1.3808|
                          DCD      bat_ips
                  |L1.3812|
                          DCD      ips_bat_av_stat
                  |L1.3816|
                          DCD      ips_bat_av_vzvod
                  |L1.3820|
                          DCD      0x40024000
                  |L1.3824|
000ef0  f0410101          ORR      r1,r1,#1              ;825
000ef4  f880103d          STRB     r1,[r0,#0x3d]         ;825
000ef8  f04f0001          MOV      r0,#1                 ;826
000efc  7020              STRB     r0,[r4,#0]            ;826
000efe  7018              STRB     r0,[r3,#0]            ;827
000f00  4628              MOV      r0,r5                 ;829
000f02  f7fffffe          BL       lc640_read_int
000f06  f1000001          ADD      r0,r0,#1              ;830
000f0a  b284              UXTH     r4,r0                 ;830
000f0c  2c3f              CMP      r4,#0x3f              ;831
000f0e  d901              BLS      |L1.3860|
000f10  f04f0400          MOV      r4,#0                 ;831
                  |L1.3860|
000f14  b221              SXTH     r1,r4                 ;832
000f16  4628              MOV      r0,r5                 ;832
000f18  f7fffffe          BL       lc640_write_int
000f1c  f6406602          MOV      r6,#0xe02             ;834
000f20  4630              MOV      r0,r6                 ;834
000f22  f7fffffe          BL       lc640_read_int
000f26  b281              UXTH     r1,r0                 ;834
000f28  293f              CMP      r1,#0x3f              ;835
000f2a  d000              BEQ      |L1.3886|
000f2c  4621              MOV      r1,r4                 ;835
                  |L1.3886|
000f2e  b209              SXTH     r1,r1                 ;836
000f30  4630              MOV      r0,r6                 ;836
000f32  f7fffffe          BL       lc640_write_int
000f36  4628              MOV      r0,r5                 ;838
000f38  f7fffffe          BL       lc640_read_int
000f3c  eb0a1040          ADD      r0,r10,r0,LSL #5      ;838
000f40  b284              UXTH     r4,r0                 ;838
000f42  f88d7000          STRB     r7,[sp,#0]            ;840
000f46  f88d9001          STRB     r9,[sp,#1]            ;841
000f4a  f04f0043          MOV      r0,#0x43              ;842
000f4e  f88d0002          STRB     r0,[sp,#2]            ;842
000f52  f88d9003          STRB     r9,[sp,#3]            ;843
000f56  4669              MOV      r1,sp                 ;844
000f58  4620              MOV      r0,r4                 ;844
000f5a  f7fffffe          BL       lc640_write_long_ptr
000f5e  f8cd9000          STR      r9,[sp,#0]            ;849
000f62  4669              MOV      r1,sp                 ;850
000f64  1d20              ADDS     r0,r4,#4              ;850
000f66  f7fffffe          BL       lc640_write_long_ptr
000f6a  f8b8003c          LDRH     r0,[r8,#0x3c]         ;852
000f6e  f88d0000          STRB     r0,[sp,#0]            ;852
000f72  f8980038          LDRB     r0,[r8,#0x38]         ;853
000f76  f88d0001          STRB     r0,[sp,#1]            ;853
000f7a  f898002c          LDRB     r0,[r8,#0x2c]         ;854
000f7e  f88d0002          STRB     r0,[sp,#2]            ;854
000f82  f88d9003          STRB     r9,[sp,#3]            ;855
000f86  4669              MOV      r1,sp                 ;856
000f88  f1040008          ADD      r0,r4,#8              ;856
000f8c  f7fffffe          BL       lc640_write_long_ptr
000f90  f8980028          LDRB     r0,[r8,#0x28]         ;858
000f94  f88d0000          STRB     r0,[sp,#0]            ;858
000f98  f8980024          LDRB     r0,[r8,#0x24]         ;859
000f9c  f88d0001          STRB     r0,[sp,#1]            ;859
000fa0  f8980020          LDRB     r0,[r8,#0x20]         ;860
000fa4  f88d0002          STRB     r0,[sp,#2]            ;860
000fa8  f88d9003          STRB     r9,[sp,#3]            ;861
000fac  4669              MOV      r1,sp                 ;862
000fae  f104000c          ADD      r0,r4,#0xc            ;862
000fb2  f7fffffe          BL       lc640_write_long_ptr
000fb6  f04f0541          MOV      r5,#0x41              ;864
000fba  f88d5000          STRB     r5,[sp,#0]            ;864
000fbe  f88d5001          STRB     r5,[sp,#1]            ;865
000fc2  f88d5002          STRB     r5,[sp,#2]            ;866
000fc6  f88d5003          STRB     r5,[sp,#3]            ;867
000fca  4669              MOV      r1,sp                 ;868
000fcc  f1040010          ADD      r0,r4,#0x10           ;868
000fd0  f7fffffe          BL       lc640_write_long_ptr
000fd4  f88d5000          STRB     r5,[sp,#0]            ;870
000fd8  f88d5001          STRB     r5,[sp,#1]            ;871
000fdc  f88d5002          STRB     r5,[sp,#2]            ;872
000fe0  f88d5003          STRB     r5,[sp,#3]            ;873
000fe4  4669              MOV      r1,sp                 ;874
000fe6  f1040014          ADD      r0,r4,#0x14           ;874
000fea  f7fffffe          BL       lc640_write_long_ptr
000fee  f88d5000          STRB     r5,[sp,#0]            ;876
000ff2  f88d5001          STRB     r5,[sp,#1]            ;877
000ff6  f88d5002          STRB     r5,[sp,#2]            ;878
000ffa  f88d5003          STRB     r5,[sp,#3]            ;879
000ffe  4669              MOV      r1,sp                 ;880
001000  f1040018          ADD      r0,r4,#0x18           ;880
001004  f7fffffe          BL       lc640_write_long_ptr
001008  f88d5000          STRB     r5,[sp,#0]            ;882
00100c  f88d5001          STRB     r5,[sp,#1]            ;883
001010  f88d5002          STRB     r5,[sp,#2]            ;884
001014  f88d5003          STRB     r5,[sp,#3]            ;885
001018  4669              MOV      r1,sp                 ;886
00101a  f104001c          ADD      r0,r4,#0x1c           ;886
00101e  f7fffffe          BL       lc640_write_long_ptr
001022  2301              MOVS     r3,#1                 ;888
001024  461a              MOV      r2,r3                 ;888
001026  2105              MOVS     r1,#5                 ;888
001028  a0ff              ADR      r0,|L1.5160|
00102a  f7fffffe          BL       snmp_trap_send
00102e  e087              B        |L1.4416|
                  |L1.4144|
;;;893    	{
;;;894    	bat_ips._av&=~1;
001030  f0210101          BIC      r1,r1,#1
001034  f880103d          STRB     r1,[r0,#0x3d]
;;;895    	ips_bat_av_stat=0;
001038  f8849000          STRB     r9,[r4,#0]
;;;896    	ips_bat_av_vzvod=0;
00103c  f8839000          STRB     r9,[r3,#0]
;;;897         
;;;898    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
001040  4628              MOV      r0,r5
001042  f7fffffe          BL       lc640_read_int
001046  b286              UXTH     r6,r0
;;;899    	event_ptr_find=event_ptr;
001048  4634              MOV      r4,r6
                  |L1.4170|
;;;900    	
;;;901    avar_bat_ips_hndl_lbl1: 
;;;902    
;;;903    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
00104a  eb0a1044          ADD      r0,r10,r4,LSL #5
00104e  b285              UXTH     r5,r0
;;;904    
;;;905         lc640_read_long_ptr(lc640_adr,data);
001050  4669              MOV      r1,sp
001052  4628              MOV      r0,r5
001054  f7fffffe          BL       lc640_read_long_ptr
;;;906         
;;;907         if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
001058  f89d0000          LDRB     r0,[sp,#0]
00105c  2842              CMP      r0,#0x42
00105e  d106              BNE      |L1.4206|
001060  f89d0001          LDRB     r0,[sp,#1]
001064  b918              CBNZ     r0,|L1.4206|
001066  f89d0002          LDRB     r0,[sp,#2]
00106a  2843              CMP      r0,#0x43
00106c  d009              BEQ      |L1.4226|
                  |L1.4206|
;;;908         	{        
;;;909         	if(event_ptr_find)event_ptr_find--;
00106e  b11c              CBZ      r4,|L1.4216|
001070  f1a40401          SUB      r4,r4,#1
001074  b2a4              UXTH     r4,r4
001076  e001              B        |L1.4220|
                  |L1.4216|
;;;910         	else event_ptr_find=63;
001078  f04f043f          MOV      r4,#0x3f
                  |L1.4220|
;;;911         	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
00107c  42b4              CMP      r4,r6
00107e  d1e4              BNE      |L1.4170|
001080  e05e              B        |L1.4416|
                  |L1.4226|
;;;912         	else goto avar_bat_ips_hndl_lbl1;
;;;913         	}
;;;914         else 
;;;915         	{
;;;916         	lc640_read_long_ptr(lc640_adr+16,data);
001082  4669              MOV      r1,sp
001084  f1050010          ADD      r0,r5,#0x10
001088  f7fffffe          BL       lc640_read_long_ptr
;;;917         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00108c  f89d0000          LDRB     r0,[sp,#0]
001090  2841              CMP      r0,#0x41
001092  d10b              BNE      |L1.4268|
001094  f89d0001          LDRB     r0,[sp,#1]
001098  2841              CMP      r0,#0x41
00109a  d107              BNE      |L1.4268|
00109c  f89d0002          LDRB     r0,[sp,#2]
0010a0  2841              CMP      r0,#0x41
0010a2  d103              BNE      |L1.4268|
0010a4  f89d0003          LDRB     r0,[sp,#3]
0010a8  2841              CMP      r0,#0x41
0010aa  d009              BEQ      |L1.4288|
                  |L1.4268|
;;;918         		{        
;;;919         		if(event_ptr_find)event_ptr_find--;
0010ac  b11c              CBZ      r4,|L1.4278|
0010ae  f1a40401          SUB      r4,r4,#1
0010b2  b2a4              UXTH     r4,r4
0010b4  e001              B        |L1.4282|
                  |L1.4278|
;;;920             		else event_ptr_find=63;
0010b6  f04f043f          MOV      r4,#0x3f
                  |L1.4282|
;;;921             	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
0010ba  42b4              CMP      r4,r6
0010bc  d1c5              BNE      |L1.4170|
0010be  e03f              B        |L1.4416|
                  |L1.4288|
;;;922         		else goto avar_bat_ips_hndl_lbl1;
;;;923         		}
;;;924    
;;;925         	}
;;;926         		
;;;927    	data[0]=LPC_RTC->YEAR;
0010c0  f8b8003c          LDRH     r0,[r8,#0x3c]
0010c4  f88d0000          STRB     r0,[sp,#0]
;;;928    	data[1]=LPC_RTC->MONTH;
0010c8  f8980038          LDRB     r0,[r8,#0x38]
0010cc  f88d0001          STRB     r0,[sp,#1]
;;;929    	data[2]=LPC_RTC->DOM;
0010d0  f898002c          LDRB     r0,[r8,#0x2c]
0010d4  f88d0002          STRB     r0,[sp,#2]
;;;930    	data[3]=0;
0010d8  f88d9003          STRB     r9,[sp,#3]
;;;931    	lc640_write_long_ptr(lc640_adr+16,data);
0010dc  4669              MOV      r1,sp
0010de  f1050010          ADD      r0,r5,#0x10
0010e2  f7fffffe          BL       lc640_write_long_ptr
;;;932    
;;;933    	data[0]=LPC_RTC->HOUR;
0010e6  f8980028          LDRB     r0,[r8,#0x28]
0010ea  f88d0000          STRB     r0,[sp,#0]
;;;934    	data[1]=LPC_RTC->MIN;
0010ee  f8980024          LDRB     r0,[r8,#0x24]
0010f2  f88d0001          STRB     r0,[sp,#1]
;;;935    	data[2]=LPC_RTC->SEC;
0010f6  f8980020          LDRB     r0,[r8,#0x20]
0010fa  f88d0002          STRB     r0,[sp,#2]
;;;936    	data[3]=0;
0010fe  f88d9003          STRB     r9,[sp,#3]
;;;937    	lc640_write_long_ptr(lc640_adr+20,data);
001102  4669              MOV      r1,sp
001104  f1050014          ADD      r0,r5,#0x14
001108  f7fffffe          BL       lc640_write_long_ptr
;;;938    	
;;;939    	data[0]='B';
00110c  f88d7000          STRB     r7,[sp,#0]
;;;940    	data[1]='B';
001110  f88d7001          STRB     r7,[sp,#1]
;;;941    	data[2]='B';
001114  f88d7002          STRB     r7,[sp,#2]
;;;942    	data[3]='B';
001118  f88d7003          STRB     r7,[sp,#3]
;;;943    	lc640_write_long_ptr(lc640_adr+24,data);
00111c  4669              MOV      r1,sp
00111e  f1050018          ADD      r0,r5,#0x18
001122  f7fffffe          BL       lc640_write_long_ptr
;;;944    	
;;;945    	data[0]='B';
001126  f88d7000          STRB     r7,[sp,#0]
;;;946    	data[1]='B';
00112a  f88d7001          STRB     r7,[sp,#1]
;;;947    	data[2]='B';
00112e  f88d7002          STRB     r7,[sp,#2]
;;;948    	data[3]='B';
001132  f88d7003          STRB     r7,[sp,#3]
;;;949    	lc640_write_long_ptr(lc640_adr+28,data);
001136  4669              MOV      r1,sp
001138  f105001c          ADD      r0,r5,#0x1c
00113c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4416|
;;;950    	
;;;951    
;;;952    	
;;;953    	}
;;;954    	
;;;955    avar_bat_ips_hndl_end:
;;;956    __nop();		
001140  bf00              NOP      
                  |L1.4418|
;;;957    }
001142  e56b              B        |L1.3100|
;;;958    
                          ENDP

                  avar_bat_hndl PROC
;;;961    //-----------------------------------------------
;;;962    void avar_bat_hndl(char b, char in)
001144  e92d4ff8          PUSH     {r3-r11,lr}
;;;963    {
001148  4606              MOV      r6,r0
;;;964    char data[4];
;;;965    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;966    
;;;967    if(in==1)
;;;968    	{
;;;969    	bat[b]._av|=1;
00114a  48bc              LDR      r0,|L1.5180|
00114c  eb060246          ADD      r2,r6,r6,LSL #1
;;;970        
;;;971    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;972    	event_ptr++;	
;;;973    	if(event_ptr>63)event_ptr=0;	
;;;974    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;975    	
;;;976         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;977    	if(event_cnt!=63)event_cnt=event_ptr;
;;;978    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;979    	
;;;980    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;981    	
;;;982    	data[0]='B';
;;;983    	data[1]=b;
;;;984    	data[2]='C';
;;;985    	data[3]=0;
;;;986    	lc640_write_long_ptr(lc640_adr,data);
;;;987    
;;;988    	data[0]=0;
;;;989    	data[1]=0;
;;;990    	data[2]=0;
;;;991    	data[3]=0;
;;;992    	lc640_write_long_ptr(lc640_adr+4,data);
;;;993    
;;;994    	data[0]=LPC_RTC->YEAR;
001150  f8df82ec          LDR      r8,|L1.5184|
001154  eb021206          ADD      r2,r2,r6,LSL #4       ;969
001158  f04f0a00          MOV      r10,#0                ;973
00115c  f04f0942          MOV      r9,#0x42              ;982
001160  f44f6560          MOV      r5,#0xe00             ;971
001164  f44f6b80          MOV      r11,#0x400            ;980
001168  eb000082          ADD      r0,r0,r2,LSL #2       ;969
00116c  2901              CMP      r1,#1                 ;967
00116e  d002              BEQ      |L1.4470|
;;;995    	data[1]=LPC_RTC->MONTH;
;;;996    	data[2]=LPC_RTC->DOM;
;;;997    	data[3]=0;
;;;998    	lc640_write_long_ptr(lc640_adr+8,data);
;;;999    
;;;1000   	data[0]=LPC_RTC->HOUR;
;;;1001   	data[1]=LPC_RTC->MIN;
;;;1002   	data[2]=LPC_RTC->SEC;
;;;1003   	data[3]=0;
;;;1004   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1005   	
;;;1006   	data[0]='A';
;;;1007   	data[1]='A';
;;;1008   	data[2]='A';
;;;1009   	data[3]='A';
;;;1010   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1011   	
;;;1012   	data[0]='A';
;;;1013   	data[1]='A';
;;;1014   	data[2]='A';
;;;1015   	data[3]='A';
;;;1016   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1017   	
;;;1018   	data[0]='A';
;;;1019   	data[1]='A';
;;;1020   	data[2]='A';
;;;1021   	data[3]='A';
;;;1022   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1023   	
;;;1024   	data[0]='A';
;;;1025   	data[1]='A';
;;;1026   	data[2]='A';
;;;1027   	data[3]='A';
;;;1028   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1029   					
;;;1030   	if(b==0)
;;;1031   		{
;;;1032   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1033   		}
;;;1034   	else if(b==1)
;;;1035   		{
;;;1036   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1037   		} 
;;;1038   			
;;;1039   	}
;;;1040   
;;;1041   else if(in==0)
001170  2900              CMP      r1,#0
001172  d07d              BEQ      |L1.4720|
001174  e12f              B        |L1.5078|
                  |L1.4470|
001176  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;969
00117a  f0410101          ORR      r1,r1,#1              ;969
00117e  7001              STRB     r1,[r0,#0]            ;969
001180  4628              MOV      r0,r5                 ;971
001182  f7fffffe          BL       lc640_read_int
001186  f1000001          ADD      r0,r0,#1              ;972
00118a  b284              UXTH     r4,r0                 ;972
00118c  2c3f              CMP      r4,#0x3f              ;973
00118e  d901              BLS      |L1.4500|
001190  f04f0400          MOV      r4,#0                 ;973
                  |L1.4500|
001194  b221              SXTH     r1,r4                 ;974
001196  4628              MOV      r0,r5                 ;974
001198  f7fffffe          BL       lc640_write_int
00119c  f6406702          MOV      r7,#0xe02             ;976
0011a0  4638              MOV      r0,r7                 ;976
0011a2  f7fffffe          BL       lc640_read_int
0011a6  b280              UXTH     r0,r0                 ;976
0011a8  283f              CMP      r0,#0x3f              ;977
0011aa  d000              BEQ      |L1.4526|
0011ac  4620              MOV      r0,r4                 ;977
                  |L1.4526|
0011ae  b201              SXTH     r1,r0                 ;978
0011b0  4638              MOV      r0,r7                 ;978
0011b2  f7fffffe          BL       lc640_write_int
0011b6  4628              MOV      r0,r5                 ;980
0011b8  f7fffffe          BL       lc640_read_int
0011bc  eb0b1040          ADD      r0,r11,r0,LSL #5      ;980
0011c0  b284              UXTH     r4,r0                 ;980
0011c2  f88d9000          STRB     r9,[sp,#0]            ;982
0011c6  f88d6001          STRB     r6,[sp,#1]            ;983
0011ca  f04f0043          MOV      r0,#0x43              ;984
0011ce  f88d0002          STRB     r0,[sp,#2]            ;984
0011d2  f88da003          STRB     r10,[sp,#3]           ;985
0011d6  4669              MOV      r1,sp                 ;986
0011d8  4620              MOV      r0,r4                 ;986
0011da  f7fffffe          BL       lc640_write_long_ptr
0011de  f8cda000          STR      r10,[sp,#0]           ;991
0011e2  4669              MOV      r1,sp                 ;992
0011e4  1d20              ADDS     r0,r4,#4              ;992
0011e6  f7fffffe          BL       lc640_write_long_ptr
0011ea  f8b8003c          LDRH     r0,[r8,#0x3c]         ;994
0011ee  f88d0000          STRB     r0,[sp,#0]            ;994
0011f2  f8980038          LDRB     r0,[r8,#0x38]         ;995
0011f6  f88d0001          STRB     r0,[sp,#1]            ;995
0011fa  f898002c          LDRB     r0,[r8,#0x2c]         ;996
0011fe  f88d0002          STRB     r0,[sp,#2]            ;996
001202  f88da003          STRB     r10,[sp,#3]           ;997
001206  4669              MOV      r1,sp                 ;998
001208  f1040008          ADD      r0,r4,#8              ;998
00120c  f7fffffe          BL       lc640_write_long_ptr
001210  f8980028          LDRB     r0,[r8,#0x28]         ;1000
001214  f88d0000          STRB     r0,[sp,#0]            ;1000
001218  f8980024          LDRB     r0,[r8,#0x24]         ;1001
00121c  f88d0001          STRB     r0,[sp,#1]            ;1001
001220  f8980020          LDRB     r0,[r8,#0x20]         ;1002
001224  f88d0002          STRB     r0,[sp,#2]            ;1002
001228  f88da003          STRB     r10,[sp,#3]           ;1003
00122c  4669              MOV      r1,sp                 ;1004
00122e  f104000c          ADD      r0,r4,#0xc            ;1004
001232  f7fffffe          BL       lc640_write_long_ptr
001236  f04f0541          MOV      r5,#0x41              ;1006
00123a  f88d5000          STRB     r5,[sp,#0]            ;1006
00123e  f88d5001          STRB     r5,[sp,#1]            ;1007
001242  f88d5002          STRB     r5,[sp,#2]            ;1008
001246  f88d5003          STRB     r5,[sp,#3]            ;1009
00124a  4669              MOV      r1,sp                 ;1010
00124c  f1040010          ADD      r0,r4,#0x10           ;1010
001250  f7fffffe          BL       lc640_write_long_ptr
001254  f88d5000          STRB     r5,[sp,#0]            ;1012
001258  f88d5001          STRB     r5,[sp,#1]            ;1013
00125c  f88d5002          STRB     r5,[sp,#2]            ;1014
001260  f88d5003          STRB     r5,[sp,#3]            ;1015
001264  4669              MOV      r1,sp                 ;1016
001266  f1040014          ADD      r0,r4,#0x14           ;1016
00126a  f7fffffe          BL       lc640_write_long_ptr
00126e  e000              B        |L1.4722|
                  |L1.4720|
001270  e02b              B        |L1.4810|
                  |L1.4722|
001272  f88d5000          STRB     r5,[sp,#0]            ;1018
001276  f88d5001          STRB     r5,[sp,#1]            ;1019
00127a  f88d5002          STRB     r5,[sp,#2]            ;1020
00127e  f88d5003          STRB     r5,[sp,#3]            ;1021
001282  4669              MOV      r1,sp                 ;1022
001284  f1040018          ADD      r0,r4,#0x18           ;1022
001288  f7fffffe          BL       lc640_write_long_ptr
00128c  f88d5000          STRB     r5,[sp,#0]            ;1024
001290  f88d5001          STRB     r5,[sp,#1]            ;1025
001294  f88d5002          STRB     r5,[sp,#2]            ;1026
001298  f88d5003          STRB     r5,[sp,#3]            ;1027
00129c  4669              MOV      r1,sp                 ;1028
00129e  f104001c          ADD      r0,r4,#0x1c           ;1028
0012a2  f7fffffe          BL       lc640_write_long_ptr
0012a6  b116              CBZ      r6,|L1.4782|
0012a8  2e01              CMP      r6,#1                 ;1034
0012aa  d007              BEQ      |L1.4796|
0012ac  e093              B        |L1.5078|
                  |L1.4782|
0012ae  2301              MOVS     r3,#1                 ;1032
0012b0  461a              MOV      r2,r3                 ;1032
0012b2  2105              MOVS     r1,#5                 ;1032
0012b4  a063              ADR      r0,|L1.5188|
0012b6  f7fffffe          BL       snmp_trap_send
0012ba  e08c              B        |L1.5078|
                  |L1.4796|
0012bc  2301              MOVS     r3,#1                 ;1036
0012be  2202              MOVS     r2,#2                 ;1036
0012c0  2105              MOVS     r1,#5                 ;1036
0012c2  a065              ADR      r0,|L1.5208|
0012c4  f7fffffe          BL       snmp_trap_send
0012c8  e085              B        |L1.5078|
                  |L1.4810|
;;;1042   	{
;;;1043   	bat[b]._av&=~1;
0012ca  f8101f3d          LDRB     r1,[r0,#0x3d]!
0012ce  f0210101          BIC      r1,r1,#1
0012d2  7001              STRB     r1,[r0,#0]
;;;1044   
;;;1045        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0012d4  4628              MOV      r0,r5
0012d6  f7fffffe          BL       lc640_read_int
0012da  b287              UXTH     r7,r0
;;;1046   	event_ptr_find=event_ptr;
0012dc  463c              MOV      r4,r7
                  |L1.4830|
;;;1047   	
;;;1048   avar_bat_hndl_lbl1: 
;;;1049   
;;;1050   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0012de  eb0b1044          ADD      r0,r11,r4,LSL #5
0012e2  b285              UXTH     r5,r0
;;;1051   
;;;1052        lc640_read_long_ptr(lc640_adr,data);
0012e4  4669              MOV      r1,sp
0012e6  4628              MOV      r0,r5
0012e8  f7fffffe          BL       lc640_read_long_ptr
;;;1053        
;;;1054        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
0012ec  f89d0000          LDRB     r0,[sp,#0]
0012f0  2842              CMP      r0,#0x42
0012f2  d107              BNE      |L1.4868|
0012f4  f89d0001          LDRB     r0,[sp,#1]
0012f8  42b0              CMP      r0,r6
0012fa  d103              BNE      |L1.4868|
0012fc  f89d0002          LDRB     r0,[sp,#2]
001300  2843              CMP      r0,#0x43
001302  d009              BEQ      |L1.4888|
                  |L1.4868|
;;;1055        	{        
;;;1056        	if(event_ptr_find)event_ptr_find--;
001304  b11c              CBZ      r4,|L1.4878|
001306  f1a40401          SUB      r4,r4,#1
00130a  b2a4              UXTH     r4,r4
00130c  e001              B        |L1.4882|
                  |L1.4878|
;;;1057        	else event_ptr_find=63;
00130e  f04f043f          MOV      r4,#0x3f
                  |L1.4882|
;;;1058        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
001312  42bc              CMP      r4,r7
001314  d1e3              BNE      |L1.4830|
001316  e05e              B        |L1.5078|
                  |L1.4888|
;;;1059        	else goto avar_bat_hndl_lbl1;
;;;1060        	}
;;;1061        else 
;;;1062        	{
;;;1063        	lc640_read_long_ptr(lc640_adr+16,data);
001318  4669              MOV      r1,sp
00131a  f1050010          ADD      r0,r5,#0x10
00131e  f7fffffe          BL       lc640_read_long_ptr
;;;1064        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001322  f89d0000          LDRB     r0,[sp,#0]
001326  2841              CMP      r0,#0x41
001328  d10b              BNE      |L1.4930|
00132a  f89d0001          LDRB     r0,[sp,#1]
00132e  2841              CMP      r0,#0x41
001330  d107              BNE      |L1.4930|
001332  f89d0002          LDRB     r0,[sp,#2]
001336  2841              CMP      r0,#0x41
001338  d103              BNE      |L1.4930|
00133a  f89d0003          LDRB     r0,[sp,#3]
00133e  2841              CMP      r0,#0x41
001340  d009              BEQ      |L1.4950|
                  |L1.4930|
;;;1065        		{        
;;;1066        		if(event_ptr_find)event_ptr_find--;
001342  b11c              CBZ      r4,|L1.4940|
001344  f1a40401          SUB      r4,r4,#1
001348  b2a4              UXTH     r4,r4
00134a  e001              B        |L1.4944|
                  |L1.4940|
;;;1067            		else event_ptr_find=63;
00134c  f04f043f          MOV      r4,#0x3f
                  |L1.4944|
;;;1068            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
001350  42bc              CMP      r4,r7
001352  d1c4              BNE      |L1.4830|
001354  e03f              B        |L1.5078|
                  |L1.4950|
;;;1069        		else goto avar_bat_hndl_lbl1;
;;;1070        		}
;;;1071   
;;;1072        	}
;;;1073        		
;;;1074   	data[0]=LPC_RTC->YEAR;
001356  f8b8003c          LDRH     r0,[r8,#0x3c]
00135a  f88d0000          STRB     r0,[sp,#0]
;;;1075   	data[1]=LPC_RTC->MONTH;
00135e  f8980038          LDRB     r0,[r8,#0x38]
001362  f88d0001          STRB     r0,[sp,#1]
;;;1076   	data[2]=LPC_RTC->DOM;
001366  f898002c          LDRB     r0,[r8,#0x2c]
00136a  f88d0002          STRB     r0,[sp,#2]
;;;1077   	data[3]=0;
00136e  f88da003          STRB     r10,[sp,#3]
;;;1078   	lc640_write_long_ptr(lc640_adr+16,data);
001372  4669              MOV      r1,sp
001374  f1050010          ADD      r0,r5,#0x10
001378  f7fffffe          BL       lc640_write_long_ptr
;;;1079   
;;;1080   	data[0]=LPC_RTC->HOUR;
00137c  f8980028          LDRB     r0,[r8,#0x28]
001380  f88d0000          STRB     r0,[sp,#0]
;;;1081   	data[1]=LPC_RTC->MIN;
001384  f8980024          LDRB     r0,[r8,#0x24]
001388  f88d0001          STRB     r0,[sp,#1]
;;;1082   	data[2]=LPC_RTC->SEC;
00138c  f8980020          LDRB     r0,[r8,#0x20]
001390  f88d0002          STRB     r0,[sp,#2]
;;;1083   	data[3]=0;
001394  f88da003          STRB     r10,[sp,#3]
;;;1084   	lc640_write_long_ptr(lc640_adr+20,data);
001398  4669              MOV      r1,sp
00139a  f1050014          ADD      r0,r5,#0x14
00139e  f7fffffe          BL       lc640_write_long_ptr
;;;1085   	
;;;1086   	data[0]='B';
0013a2  f88d9000          STRB     r9,[sp,#0]
;;;1087   	data[1]='B';
0013a6  f88d9001          STRB     r9,[sp,#1]
;;;1088   	data[2]='B';
0013aa  f88d9002          STRB     r9,[sp,#2]
;;;1089   	data[3]='B';
0013ae  f88d9003          STRB     r9,[sp,#3]
;;;1090   	lc640_write_long_ptr(lc640_adr+24,data);
0013b2  4669              MOV      r1,sp
0013b4  f1050018          ADD      r0,r5,#0x18
0013b8  f7fffffe          BL       lc640_write_long_ptr
;;;1091   	
;;;1092   	data[0]='B';
0013bc  f88d9000          STRB     r9,[sp,#0]
;;;1093   	data[1]='B';
0013c0  f88d9001          STRB     r9,[sp,#1]
;;;1094   	data[2]='B';
0013c4  f88d9002          STRB     r9,[sp,#2]
;;;1095   	data[3]='B';
0013c8  f88d9003          STRB     r9,[sp,#3]
;;;1096   	lc640_write_long_ptr(lc640_adr+28,data);
0013cc  4669              MOV      r1,sp
0013ce  f105001c          ADD      r0,r5,#0x1c
0013d2  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5078|
;;;1097   	
;;;1098   
;;;1099   	
;;;1100   	}
;;;1101   	
;;;1102   avar_bat_hndl_end:
;;;1103   __nop();		
0013d6  bf00              NOP      
                  |L1.5080|
;;;1104   }
0013d8  e420              B        |L1.3100|
;;;1105   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1106   //-----------------------------------------------
;;;1107   void avar_bat_as_hndl(char b, char in)
0013da  e92d4ff8          PUSH     {r3-r11,lr}
;;;1108   {
0013de  4606              MOV      r6,r0
;;;1109   char data[4];
;;;1110   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1111   
;;;1112   if(in==1)
;;;1113   	{
;;;1114   	bat[b]._av|=2;
;;;1115       
;;;1116   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1117   	event_ptr++;	
;;;1118   	if(event_ptr>63)event_ptr=0;	
;;;1119   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1120   	
;;;1121        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1122   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1123   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1124   	
;;;1125   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1126   	
;;;1127   	data[0]='B';
;;;1128   	data[1]=b;
;;;1129   	data[2]='S';
;;;1130   	data[3]=0;
;;;1131   	lc640_write_long_ptr(lc640_adr,data);
;;;1132   
;;;1133   	data[0]=0;
;;;1134   	data[1]=0;
;;;1135   	data[2]=0;
;;;1136   	data[3]=0;
;;;1137   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1138   
;;;1139   	data[0]=LPC_RTC->YEAR;
0013e0  f8df805c          LDR      r8,|L1.5184|
0013e4  f04f0a00          MOV      r10,#0                ;1118
0013e8  f04f0942          MOV      r9,#0x42              ;1127
0013ec  f44f6560          MOV      r5,#0xe00             ;1116
0013f0  f44f6b80          MOV      r11,#0x400            ;1125
0013f4  2901              CMP      r1,#1                 ;1112
0013f6  d002              BEQ      |L1.5118|
;;;1140   	data[1]=LPC_RTC->MONTH;
;;;1141   	data[2]=LPC_RTC->DOM;
;;;1142   	data[3]=0;
;;;1143   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1144   
;;;1145   	data[0]=LPC_RTC->HOUR;
;;;1146   	data[1]=LPC_RTC->MIN;
;;;1147   	data[2]=LPC_RTC->SEC;
;;;1148   	data[3]=0;
;;;1149   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1150   	
;;;1151   	data[0]='A';
;;;1152   	data[1]='A';
;;;1153   	data[2]='A';
;;;1154   	data[3]='A';
;;;1155   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1156   	
;;;1157   	data[0]='A';
;;;1158   	data[1]='A';
;;;1159   	data[2]='A';
;;;1160   	data[3]='A';
;;;1161   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1162   	
;;;1163   	data[0]='A';
;;;1164   	data[1]='A';
;;;1165   	data[2]='A';
;;;1166   	data[3]='A';
;;;1167   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1168   	
;;;1169   	data[0]='A';
;;;1170   	data[1]='A';
;;;1171   	data[2]='A';
;;;1172   	data[3]='A';
;;;1173   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1174   
;;;1175   	if(b==0)
;;;1176   		{
;;;1177   		snmp_trap_send("BAT #1 Alarm, assimetry",5,1,2);
;;;1178   		}
;;;1179   	else if(b==1)
;;;1180   		{
;;;1181   		snmp_trap_send("BAT #2 Alarm, assimetry",5,2,2);
;;;1182   		} 
;;;1183   	
;;;1184   	}
;;;1185   
;;;1186   else if(in==0)
0013f8  2900              CMP      r1,#0
0013fa  d07e              BEQ      |L1.5370|
0013fc  e154              B        |L1.5800|
                  |L1.5118|
0013fe  eb060046          ADD      r0,r6,r6,LSL #1       ;1114
001402  eb001106          ADD      r1,r0,r6,LSL #4       ;1114
001406  480d              LDR      r0,|L1.5180|
001408  eb000081          ADD      r0,r0,r1,LSL #2       ;1114
00140c  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1114
001410  f0410102          ORR      r1,r1,#2              ;1114
001414  7001              STRB     r1,[r0,#0]            ;1114
001416  4628              MOV      r0,r5                 ;1116
001418  f7fffffe          BL       lc640_read_int
00141c  f1000001          ADD      r0,r0,#1              ;1117
001420  b284              UXTH     r4,r0                 ;1117
001422  2c3f              CMP      r4,#0x3f              ;1118
001424  d924              BLS      |L1.5232|
001426  e021              B        |L1.5228|
                  |L1.5160|
001428  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
00142c  b9312041
001430  6c61726d
001434  2c206c6f
001438  737400  
00143b  00                DCB      0
                  |L1.5180|
                          DCD      bat
                  |L1.5184|
                          DCD      0x40024000
                  |L1.5188|
001444  42415420          DCB      "BAT #1 Alarm, lost",0
001448  23312041
00144c  6c61726d
001450  2c206c6f
001454  737400  
001457  00                DCB      0
                  |L1.5208|
001458  42415420          DCB      "BAT #2 Alarm, lost",0
00145c  23322041
001460  6c61726d
001464  2c206c6f
001468  737400  
00146b  00                DCB      0
                  |L1.5228|
00146c  f04f0400          MOV      r4,#0                 ;1118
                  |L1.5232|
001470  b221              SXTH     r1,r4                 ;1119
001472  4628              MOV      r0,r5                 ;1119
001474  f7fffffe          BL       lc640_write_int
001478  f6406702          MOV      r7,#0xe02             ;1121
00147c  4638              MOV      r0,r7                 ;1121
00147e  f7fffffe          BL       lc640_read_int
001482  b280              UXTH     r0,r0                 ;1121
001484  283f              CMP      r0,#0x3f              ;1122
001486  d000              BEQ      |L1.5258|
001488  4620              MOV      r0,r4                 ;1122
                  |L1.5258|
00148a  b201              SXTH     r1,r0                 ;1123
00148c  4638              MOV      r0,r7                 ;1123
00148e  f7fffffe          BL       lc640_write_int
001492  4628              MOV      r0,r5                 ;1125
001494  f7fffffe          BL       lc640_read_int
001498  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1125
00149c  b284              UXTH     r4,r0                 ;1125
00149e  f88d9000          STRB     r9,[sp,#0]            ;1127
0014a2  f88d6001          STRB     r6,[sp,#1]            ;1128
0014a6  f04f0053          MOV      r0,#0x53              ;1129
0014aa  f88d0002          STRB     r0,[sp,#2]            ;1129
0014ae  f88da003          STRB     r10,[sp,#3]           ;1130
0014b2  4669              MOV      r1,sp                 ;1131
0014b4  4620              MOV      r0,r4                 ;1131
0014b6  f7fffffe          BL       lc640_write_long_ptr
0014ba  f8cda000          STR      r10,[sp,#0]           ;1136
0014be  4669              MOV      r1,sp                 ;1137
0014c0  1d20              ADDS     r0,r4,#4              ;1137
0014c2  f7fffffe          BL       lc640_write_long_ptr
0014c6  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1139
0014ca  f88d0000          STRB     r0,[sp,#0]            ;1139
0014ce  f8980038          LDRB     r0,[r8,#0x38]         ;1140
0014d2  f88d0001          STRB     r0,[sp,#1]            ;1140
0014d6  f898002c          LDRB     r0,[r8,#0x2c]         ;1141
0014da  f88d0002          STRB     r0,[sp,#2]            ;1141
0014de  f88da003          STRB     r10,[sp,#3]           ;1142
0014e2  4669              MOV      r1,sp                 ;1143
0014e4  f1040008          ADD      r0,r4,#8              ;1143
0014e8  f7fffffe          BL       lc640_write_long_ptr
0014ec  f8980028          LDRB     r0,[r8,#0x28]         ;1145
0014f0  f88d0000          STRB     r0,[sp,#0]            ;1145
0014f4  f8980024          LDRB     r0,[r8,#0x24]         ;1146
0014f8  e000              B        |L1.5372|
                  |L1.5370|
0014fa  e054              B        |L1.5542|
                  |L1.5372|
0014fc  f88d0001          STRB     r0,[sp,#1]            ;1146
001500  f8980020          LDRB     r0,[r8,#0x20]         ;1147
001504  f88d0002          STRB     r0,[sp,#2]            ;1147
001508  f88da003          STRB     r10,[sp,#3]           ;1148
00150c  4669              MOV      r1,sp                 ;1149
00150e  f104000c          ADD      r0,r4,#0xc            ;1149
001512  f7fffffe          BL       lc640_write_long_ptr
001516  f04f0541          MOV      r5,#0x41              ;1151
00151a  f88d5000          STRB     r5,[sp,#0]            ;1151
00151e  f88d5001          STRB     r5,[sp,#1]            ;1152
001522  f88d5002          STRB     r5,[sp,#2]            ;1153
001526  f88d5003          STRB     r5,[sp,#3]            ;1154
00152a  4669              MOV      r1,sp                 ;1155
00152c  f1040010          ADD      r0,r4,#0x10           ;1155
001530  f7fffffe          BL       lc640_write_long_ptr
001534  f88d5000          STRB     r5,[sp,#0]            ;1157
001538  f88d5001          STRB     r5,[sp,#1]            ;1158
00153c  f88d5002          STRB     r5,[sp,#2]            ;1159
001540  f88d5003          STRB     r5,[sp,#3]            ;1160
001544  4669              MOV      r1,sp                 ;1161
001546  f1040014          ADD      r0,r4,#0x14           ;1161
00154a  f7fffffe          BL       lc640_write_long_ptr
00154e  f88d5000          STRB     r5,[sp,#0]            ;1163
001552  f88d5001          STRB     r5,[sp,#1]            ;1164
001556  f88d5002          STRB     r5,[sp,#2]            ;1165
00155a  f88d5003          STRB     r5,[sp,#3]            ;1166
00155e  4669              MOV      r1,sp                 ;1167
001560  f1040018          ADD      r0,r4,#0x18           ;1167
001564  f7fffffe          BL       lc640_write_long_ptr
001568  f88d5000          STRB     r5,[sp,#0]            ;1169
00156c  f88d5001          STRB     r5,[sp,#1]            ;1170
001570  f88d5002          STRB     r5,[sp,#2]            ;1171
001574  f88d5003          STRB     r5,[sp,#3]            ;1172
001578  4669              MOV      r1,sp                 ;1173
00157a  f104001c          ADD      r0,r4,#0x1c           ;1173
00157e  f7fffffe          BL       lc640_write_long_ptr
001582  b116              CBZ      r6,|L1.5514|
001584  2e01              CMP      r6,#1                 ;1179
001586  d007              BEQ      |L1.5528|
001588  e08e              B        |L1.5800|
                  |L1.5514|
00158a  2302              MOVS     r3,#2                 ;1177
00158c  2201              MOVS     r2,#1                 ;1177
00158e  2105              MOVS     r1,#5                 ;1177
001590  a0fb              ADR      r0,|L1.6528|
001592  f7fffffe          BL       snmp_trap_send
001596  e087              B        |L1.5800|
                  |L1.5528|
001598  2302              MOVS     r3,#2                 ;1181
00159a  461a              MOV      r2,r3                 ;1181
00159c  2105              MOVS     r1,#5                 ;1181
00159e  a0fe              ADR      r0,|L1.6552|
0015a0  f7fffffe          BL       snmp_trap_send
0015a4  e080              B        |L1.5800|
                  |L1.5542|
;;;1187   	{
;;;1188   	//bat[b]._av=0;
;;;1189   
;;;1190        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0015a6  4628              MOV      r0,r5
0015a8  f7fffffe          BL       lc640_read_int
0015ac  b287              UXTH     r7,r0
;;;1191   	event_ptr_find=event_ptr;
0015ae  463c              MOV      r4,r7
                  |L1.5552|
;;;1192   	
;;;1193   avar_bat_as_hndl_lbl1: 
;;;1194   
;;;1195   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0015b0  eb0b1044          ADD      r0,r11,r4,LSL #5
0015b4  b285              UXTH     r5,r0
;;;1196   
;;;1197        lc640_read_long_ptr(lc640_adr,data);
0015b6  4669              MOV      r1,sp
0015b8  4628              MOV      r0,r5
0015ba  f7fffffe          BL       lc640_read_long_ptr
;;;1198        
;;;1199        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
0015be  f89d0000          LDRB     r0,[sp,#0]
0015c2  2842              CMP      r0,#0x42
0015c4  d107              BNE      |L1.5590|
0015c6  f89d0001          LDRB     r0,[sp,#1]
0015ca  42b0              CMP      r0,r6
0015cc  d103              BNE      |L1.5590|
0015ce  f89d0002          LDRB     r0,[sp,#2]
0015d2  2843              CMP      r0,#0x43
0015d4  d009              BEQ      |L1.5610|
                  |L1.5590|
;;;1200        	{        
;;;1201        	if(event_ptr_find)event_ptr_find--;
0015d6  b11c              CBZ      r4,|L1.5600|
0015d8  f1a40401          SUB      r4,r4,#1
0015dc  b2a4              UXTH     r4,r4
0015de  e001              B        |L1.5604|
                  |L1.5600|
;;;1202        	else event_ptr_find=63;
0015e0  f04f043f          MOV      r4,#0x3f
                  |L1.5604|
;;;1203        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
0015e4  42bc              CMP      r4,r7
0015e6  d1e3              BNE      |L1.5552|
0015e8  e05e              B        |L1.5800|
                  |L1.5610|
;;;1204        	else goto avar_bat_as_hndl_lbl1;
;;;1205        	}
;;;1206        else 
;;;1207        	{
;;;1208        	lc640_read_long_ptr(lc640_adr+16,data);
0015ea  4669              MOV      r1,sp
0015ec  f1050010          ADD      r0,r5,#0x10
0015f0  f7fffffe          BL       lc640_read_long_ptr
;;;1209        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0015f4  f89d0000          LDRB     r0,[sp,#0]
0015f8  2841              CMP      r0,#0x41
0015fa  d10b              BNE      |L1.5652|
0015fc  f89d0001          LDRB     r0,[sp,#1]
001600  2841              CMP      r0,#0x41
001602  d107              BNE      |L1.5652|
001604  f89d0002          LDRB     r0,[sp,#2]
001608  2841              CMP      r0,#0x41
00160a  d103              BNE      |L1.5652|
00160c  f89d0003          LDRB     r0,[sp,#3]
001610  2841              CMP      r0,#0x41
001612  d009              BEQ      |L1.5672|
                  |L1.5652|
;;;1210        		{        
;;;1211        		if(event_ptr_find)event_ptr_find--;
001614  b11c              CBZ      r4,|L1.5662|
001616  f1a40401          SUB      r4,r4,#1
00161a  b2a4              UXTH     r4,r4
00161c  e001              B        |L1.5666|
                  |L1.5662|
;;;1212            		else event_ptr_find=63;
00161e  f04f043f          MOV      r4,#0x3f
                  |L1.5666|
;;;1213            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001622  42bc              CMP      r4,r7
001624  d1c4              BNE      |L1.5552|
001626  e03f              B        |L1.5800|
                  |L1.5672|
;;;1214        		else goto avar_bat_as_hndl_lbl1;
;;;1215        		}
;;;1216   
;;;1217        	}
;;;1218        		
;;;1219   	data[0]=LPC_RTC->YEAR;
001628  f8b8003c          LDRH     r0,[r8,#0x3c]
00162c  f88d0000          STRB     r0,[sp,#0]
;;;1220   	data[1]=LPC_RTC->MONTH;
001630  f8980038          LDRB     r0,[r8,#0x38]
001634  f88d0001          STRB     r0,[sp,#1]
;;;1221   	data[2]=LPC_RTC->DOM;
001638  f898002c          LDRB     r0,[r8,#0x2c]
00163c  f88d0002          STRB     r0,[sp,#2]
;;;1222   	data[3]=0;
001640  f88da003          STRB     r10,[sp,#3]
;;;1223   	lc640_write_long_ptr(lc640_adr+16,data);
001644  4669              MOV      r1,sp
001646  f1050010          ADD      r0,r5,#0x10
00164a  f7fffffe          BL       lc640_write_long_ptr
;;;1224   
;;;1225   	data[0]=LPC_RTC->HOUR;
00164e  f8980028          LDRB     r0,[r8,#0x28]
001652  f88d0000          STRB     r0,[sp,#0]
;;;1226   	data[1]=LPC_RTC->MIN;
001656  f8980024          LDRB     r0,[r8,#0x24]
00165a  f88d0001          STRB     r0,[sp,#1]
;;;1227   	data[2]=LPC_RTC->SEC;
00165e  f8980020          LDRB     r0,[r8,#0x20]
001662  f88d0002          STRB     r0,[sp,#2]
;;;1228   	data[3]=0;
001666  f88da003          STRB     r10,[sp,#3]
;;;1229   	lc640_write_long_ptr(lc640_adr+20,data);
00166a  4669              MOV      r1,sp
00166c  f1050014          ADD      r0,r5,#0x14
001670  f7fffffe          BL       lc640_write_long_ptr
;;;1230   	
;;;1231   	data[0]='B';
001674  f88d9000          STRB     r9,[sp,#0]
;;;1232   	data[1]='B';
001678  f88d9001          STRB     r9,[sp,#1]
;;;1233   	data[2]='B';
00167c  f88d9002          STRB     r9,[sp,#2]
;;;1234   	data[3]='B';
001680  f88d9003          STRB     r9,[sp,#3]
;;;1235   	lc640_write_long_ptr(lc640_adr+24,data);
001684  4669              MOV      r1,sp
001686  f1050018          ADD      r0,r5,#0x18
00168a  f7fffffe          BL       lc640_write_long_ptr
;;;1236   	
;;;1237   	data[0]='B';
00168e  f88d9000          STRB     r9,[sp,#0]
;;;1238   	data[1]='B';
001692  f88d9001          STRB     r9,[sp,#1]
;;;1239   	data[2]='B';
001696  f88d9002          STRB     r9,[sp,#2]
;;;1240   	data[3]='B';
00169a  f88d9003          STRB     r9,[sp,#3]
;;;1241   	lc640_write_long_ptr(lc640_adr+28,data);
00169e  4669              MOV      r1,sp
0016a0  f105001c          ADD      r0,r5,#0x1c
0016a4  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5800|
;;;1242   	
;;;1243   
;;;1244   	
;;;1245   	}
;;;1246   	
;;;1247   avar_bat_as_hndl_end:
;;;1248   __nop();		
0016a8  bf00              NOP      
;;;1249   }
0016aa  e54a              B        |L1.4418|
;;;1250   
                          ENDP

                  ke_mem_hndl PROC
;;;1252   //-----------------------------------------------
;;;1253   void ke_mem_hndl(char b,unsigned short in)
0016ac  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;1254   {
0016ae  b083              SUB      sp,sp,#0xc
0016b0  4605              MOV      r5,r0
;;;1255   char data[4];
;;;1256   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1257   //unsigned char temp,temp_;
;;;1258   //unsigned int tempUI;
;;;1259   //unsigned long tempUL; 
;;;1260   signed temp_temp;
;;;1261   
;;;1262   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
0016b2  eb050045          ADD      r0,r5,r5,LSL #1
0016b6  49be              LDR      r1,|L1.6576|
0016b8  eb001005          ADD      r0,r0,r5,LSL #4
0016bc  eb010180          ADD      r1,r1,r0,LSL #2
0016c0  48bc              LDR      r0,|L1.6580|
0016c2  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
0016c6  f1000001          ADD      r0,r0,#1
0016ca  eb010040          ADD      r0,r1,r0,LSL #1
0016ce  f9b00020          LDRSH    r0,[r0,#0x20]
0016d2  9001              STR      r0,[sp,#4]
;;;1263   
;;;1264   event_ptr=lc640_read_int(PTR_EVENT_LOG);
0016d4  f44f6660          MOV      r6,#0xe00
0016d8  4630              MOV      r0,r6
0016da  f7fffffe          BL       lc640_read_int
;;;1265   event_ptr++;	
0016de  f1000001          ADD      r0,r0,#1
0016e2  4604              MOV      r4,r0
;;;1266   if(event_ptr>63)event_ptr=0;	
0016e4  2c3f              CMP      r4,#0x3f
0016e6  d901              BLS      |L1.5868|
0016e8  f04f0400          MOV      r4,#0
                  |L1.5868|
;;;1267   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
0016ec  b221              SXTH     r1,r4
0016ee  4630              MOV      r0,r6
0016f0  f7fffffe          BL       lc640_write_int
;;;1268   	
;;;1269   event_cnt=lc640_read_int(CNT_EVENT_LOG);
0016f4  f6406702          MOV      r7,#0xe02
0016f8  4638              MOV      r0,r7
0016fa  f7fffffe          BL       lc640_read_int
;;;1270   if(event_cnt!=63)event_cnt=event_ptr;
0016fe  283f              CMP      r0,#0x3f
001700  d000              BEQ      |L1.5892|
001702  4620              MOV      r0,r4
                  |L1.5892|
;;;1271   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
001704  b201              SXTH     r1,r0
001706  4638              MOV      r0,r7
001708  f7fffffe          BL       lc640_write_int
;;;1272   	
;;;1273   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
00170c  4630              MOV      r0,r6
00170e  f7fffffe          BL       lc640_read_int
001712  f44f6180          MOV      r1,#0x400
001716  eb011440          ADD      r4,r1,r0,LSL #5
;;;1274   	
;;;1275   data[0]='B';
00171a  f04f0042          MOV      r0,#0x42
00171e  f88d0008          STRB     r0,[sp,#8]
;;;1276   data[1]=b; 
001722  f88d5009          STRB     r5,[sp,#9]
;;;1277   data[2]='K';
001726  f04f004b          MOV      r0,#0x4b
00172a  f88d000a          STRB     r0,[sp,#0xa]
;;;1278   data[3]=0;
00172e  f04f0600          MOV      r6,#0
001732  f88d600b          STRB     r6,[sp,#0xb]
;;;1279   
;;;1280   lc640_write_long_ptr(lc640_adr,data);
001736  a902              ADD      r1,sp,#8
001738  4620              MOV      r0,r4
00173a  f7fffffe          BL       lc640_write_long_ptr
;;;1281   
;;;1282   data[0]=*((char*)&in);
00173e  f89d0010          LDRB     r0,[sp,#0x10]
001742  f88d0008          STRB     r0,[sp,#8]
;;;1283   data[1]=*(((char*)(&in))+1);
001746  f89d0011          LDRB     r0,[sp,#0x11]
00174a  f88d0009          STRB     r0,[sp,#9]
;;;1284   data[2]=*((char*)&temp_temp);
00174e  f89d0004          LDRB     r0,[sp,#4]
001752  f88d000a          STRB     r0,[sp,#0xa]
;;;1285   data[3]=*(((char*)(&temp_temp))+1);
001756  f89d0005          LDRB     r0,[sp,#5]
00175a  f88d000b          STRB     r0,[sp,#0xb]
;;;1286   lc640_write_long_ptr(lc640_adr+4,data);
00175e  a902              ADD      r1,sp,#8
001760  1d20              ADDS     r0,r4,#4
001762  f7fffffe          BL       lc640_write_long_ptr
;;;1287   
;;;1288   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
001766  f44f70fc          MOV      r0,#0x1f8
00176a  f7fffffe          BL       lc640_read_long
00176e  4d92              LDR      r5,|L1.6584|
001770  6028              STR      r0,[r5,#0]  ; ke_date
;;;1289   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
001772  4629              MOV      r1,r5
001774  f1040008          ADD      r0,r4,#8
001778  f7fffffe          BL       lc640_write_long_ptr
;;;1290   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
00177c  f44f70fe          MOV      r0,#0x1fc
001780  f7fffffe          BL       lc640_read_long
001784  6068              STR      r0,[r5,#4]  ; ke_date
;;;1291   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
001786  1d29              ADDS     r1,r5,#4
001788  f104000c          ADD      r0,r4,#0xc
00178c  f7fffffe          BL       lc640_write_long_ptr
;;;1292   
;;;1293   data[0]=LPC_RTC->YEAR;
001790  4d8a              LDR      r5,|L1.6588|
001792  8ba8              LDRH     r0,[r5,#0x1c]
001794  f88d0008          STRB     r0,[sp,#8]
;;;1294   data[1]=LPC_RTC->MONTH;
001798  7e28              LDRB     r0,[r5,#0x18]
00179a  f88d0009          STRB     r0,[sp,#9]
;;;1295   data[2]=LPC_RTC->DOM;
00179e  7b28              LDRB     r0,[r5,#0xc]
0017a0  f88d000a          STRB     r0,[sp,#0xa]
;;;1296   data[3]=0;
0017a4  f88d600b          STRB     r6,[sp,#0xb]
;;;1297   lc640_write_long_ptr(lc640_adr+16,data);
0017a8  a902              ADD      r1,sp,#8
0017aa  f1040010          ADD      r0,r4,#0x10
0017ae  f7fffffe          BL       lc640_write_long_ptr
;;;1298   
;;;1299   data[0]=LPC_RTC->HOUR;
0017b2  7a28              LDRB     r0,[r5,#8]
0017b4  f88d0008          STRB     r0,[sp,#8]
;;;1300   data[1]=LPC_RTC->MIN;
0017b8  7928              LDRB     r0,[r5,#4]
0017ba  f88d0009          STRB     r0,[sp,#9]
;;;1301   data[2]=LPC_RTC->SEC;
0017be  7828              LDRB     r0,[r5,#0]
0017c0  f88d000a          STRB     r0,[sp,#0xa]
;;;1302   data[3]=0;
0017c4  f88d600b          STRB     r6,[sp,#0xb]
;;;1303   lc640_write_long_ptr(lc640_adr+20,data);
0017c8  a902              ADD      r1,sp,#8
0017ca  f1040014          ADD      r0,r4,#0x14
0017ce  f7fffffe          BL       lc640_write_long_ptr
;;;1304    
;;;1305   }
0017d2  b005              ADD      sp,sp,#0x14
0017d4  bdf0              POP      {r4-r7,pc}
;;;1306   
                          ENDP

                  vz_mem_hndl PROC
;;;1308   //-----------------------------------------------
;;;1309   void vz_mem_hndl(unsigned short in)
0017d6  e92d4ff8          PUSH     {r3-r11,lr}
;;;1310   {
;;;1311   char data[4];
;;;1312   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
0017da  f04f0600          MOV      r6,#0
0017de  4634              MOV      r4,r6
;;;1313   //char avar_simbol;
;;;1314   
;;;1315   if(in==1)
;;;1316   	{
;;;1317   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1318   	event_ptr++;	
;;;1319   	if(event_ptr>63)event_ptr=0;	
;;;1320   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1321   	
;;;1322        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1323   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1324   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1325   	
;;;1326   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1327   	
;;;1328   	data[0]='B';
;;;1329   	data[1]=0; 
;;;1330   	data[2]='Z';
;;;1331   	data[3]=0;
;;;1332   	lc640_write_long_ptr(lc640_adr,data);
;;;1333   
;;;1334   	data[0]=0;
;;;1335   	data[1]=0;
;;;1336   	data[2]=0;
;;;1337   	data[3]=0;
;;;1338   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1339   
;;;1340   	data[0]=LPC_RTC->YEAR;
0017e0  f8df81dc          LDR      r8,|L1.6592|
0017e4  46a1              MOV      r9,r4                 ;1312
0017e6  f04f0742          MOV      r7,#0x42              ;1328
0017ea  f44f6a80          MOV      r10,#0x400            ;1326
0017ee  2801              CMP      r0,#1                 ;1315
0017f0  d002              BEQ      |L1.6136|
;;;1341   	data[1]=LPC_RTC->MONTH;
;;;1342   	data[2]=LPC_RTC->DOM;
;;;1343   	data[3]=0;
;;;1344   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1345   
;;;1346   	data[0]=LPC_RTC->HOUR;
;;;1347   	data[1]=LPC_RTC->MIN;
;;;1348   	data[2]=LPC_RTC->SEC;
;;;1349   	data[3]=0;
;;;1350   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1351   	
;;;1352   	data[0]='A';
;;;1353   	data[1]='A';
;;;1354   	data[2]='A';
;;;1355   	data[3]='A';
;;;1356   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1357   	
;;;1358   	data[0]='A';
;;;1359   	data[1]='A';
;;;1360   	data[2]='A';
;;;1361   	data[3]='A';
;;;1362   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1363   	
;;;1364   	data[0]='A';
;;;1365   	data[1]='A';
;;;1366   	data[2]='A';
;;;1367   	data[3]='A';
;;;1368   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1369   	
;;;1370   	data[0]='A';
;;;1371   	data[1]='A';
;;;1372   	data[2]='A';
;;;1373   	data[3]='A';
;;;1374   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1375    	
;;;1376   	}
;;;1377   
;;;1378   else if(in==0)
0017f2  2800              CMP      r0,#0
0017f4  d07e              BEQ      |L1.6388|
0017f6  e12a              B        |L1.6734|
                  |L1.6136|
0017f8  f44f6560          MOV      r5,#0xe00             ;1317
0017fc  4628              MOV      r0,r5                 ;1317
0017fe  f7fffffe          BL       lc640_read_int
001802  f1000001          ADD      r0,r0,#1              ;1318
001806  4604              MOV      r4,r0                 ;1318
001808  2c3f              CMP      r4,#0x3f              ;1319
00180a  d901              BLS      |L1.6160|
00180c  f04f0400          MOV      r4,#0                 ;1319
                  |L1.6160|
001810  b221              SXTH     r1,r4                 ;1320
001812  4628              MOV      r0,r5                 ;1320
001814  f7fffffe          BL       lc640_write_int
001818  f6406602          MOV      r6,#0xe02             ;1322
00181c  4630              MOV      r0,r6                 ;1322
00181e  f7fffffe          BL       lc640_read_int
001822  283f              CMP      r0,#0x3f              ;1323
001824  d000              BEQ      |L1.6184|
001826  4620              MOV      r0,r4                 ;1323
                  |L1.6184|
001828  b201              SXTH     r1,r0                 ;1324
00182a  4630              MOV      r0,r6                 ;1324
00182c  f7fffffe          BL       lc640_write_int
001830  4628              MOV      r0,r5                 ;1326
001832  f7fffffe          BL       lc640_read_int
001836  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1326
00183a  f88d7000          STRB     r7,[sp,#0]            ;1328
00183e  f88d9001          STRB     r9,[sp,#1]            ;1329
001842  f04f005a          MOV      r0,#0x5a              ;1330
001846  f88d0002          STRB     r0,[sp,#2]            ;1330
00184a  f88d9003          STRB     r9,[sp,#3]            ;1331
00184e  4669              MOV      r1,sp                 ;1332
001850  4620              MOV      r0,r4                 ;1332
001852  f7fffffe          BL       lc640_write_long_ptr
001856  f8cd9000          STR      r9,[sp,#0]            ;1337
00185a  4669              MOV      r1,sp                 ;1338
00185c  1d20              ADDS     r0,r4,#4              ;1338
00185e  f7fffffe          BL       lc640_write_long_ptr
001862  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1340
001866  f88d0000          STRB     r0,[sp,#0]            ;1340
00186a  f8980038          LDRB     r0,[r8,#0x38]         ;1341
00186e  f88d0001          STRB     r0,[sp,#1]            ;1341
001872  f898002c          LDRB     r0,[r8,#0x2c]         ;1342
001876  f88d0002          STRB     r0,[sp,#2]            ;1342
00187a  f88d9003          STRB     r9,[sp,#3]            ;1343
00187e  4669              MOV      r1,sp                 ;1344
001880  f1040008          ADD      r0,r4,#8              ;1344
001884  f7fffffe          BL       lc640_write_long_ptr
001888  f8980028          LDRB     r0,[r8,#0x28]         ;1346
00188c  f88d0000          STRB     r0,[sp,#0]            ;1346
001890  f8980024          LDRB     r0,[r8,#0x24]         ;1347
001894  f88d0001          STRB     r0,[sp,#1]            ;1347
001898  f8980020          LDRB     r0,[r8,#0x20]         ;1348
00189c  f88d0002          STRB     r0,[sp,#2]            ;1348
0018a0  f88d9003          STRB     r9,[sp,#3]            ;1349
0018a4  4669              MOV      r1,sp                 ;1350
0018a6  f104000c          ADD      r0,r4,#0xc            ;1350
0018aa  f7fffffe          BL       lc640_write_long_ptr
0018ae  f04f0541          MOV      r5,#0x41              ;1352
0018b2  f88d5000          STRB     r5,[sp,#0]            ;1352
0018b6  f88d5001          STRB     r5,[sp,#1]            ;1353
0018ba  f88d5002          STRB     r5,[sp,#2]            ;1354
0018be  f88d5003          STRB     r5,[sp,#3]            ;1355
0018c2  4669              MOV      r1,sp                 ;1356
0018c4  f1040010          ADD      r0,r4,#0x10           ;1356
0018c8  f7fffffe          BL       lc640_write_long_ptr
0018cc  f88d5000          STRB     r5,[sp,#0]            ;1358
0018d0  f88d5001          STRB     r5,[sp,#1]            ;1359
0018d4  f88d5002          STRB     r5,[sp,#2]            ;1360
0018d8  f88d5003          STRB     r5,[sp,#3]            ;1361
0018dc  4669              MOV      r1,sp                 ;1362
0018de  f1040014          ADD      r0,r4,#0x14           ;1362
0018e2  f7fffffe          BL       lc640_write_long_ptr
0018e6  f88d5000          STRB     r5,[sp,#0]            ;1364
0018ea  f88d5001          STRB     r5,[sp,#1]            ;1365
0018ee  f88d5002          STRB     r5,[sp,#2]            ;1366
0018f2  e000              B        |L1.6390|
                  |L1.6388|
0018f4  e014              B        |L1.6432|
                  |L1.6390|
0018f6  f88d5003          STRB     r5,[sp,#3]            ;1367
0018fa  4669              MOV      r1,sp                 ;1368
0018fc  f1040018          ADD      r0,r4,#0x18           ;1368
001900  f7fffffe          BL       lc640_write_long_ptr
001904  f88d5000          STRB     r5,[sp,#0]            ;1370
001908  f88d5001          STRB     r5,[sp,#1]            ;1371
00190c  f88d5002          STRB     r5,[sp,#2]            ;1372
001910  f88d5003          STRB     r5,[sp,#3]            ;1373
001914  4669              MOV      r1,sp                 ;1374
001916  f104001c          ADD      r0,r4,#0x1c           ;1374
00191a  f7fffffe          BL       lc640_write_long_ptr
00191e  e096              B        |L1.6734|
                  |L1.6432|
;;;1379   	{      
;;;1380        
;;;1381   vz_mem_hndl_lbl1: 
;;;1382   
;;;1383   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001920  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1384   
;;;1385        lc640_read_long_ptr(lc640_adr,data);
001924  4669              MOV      r1,sp
001926  4628              MOV      r0,r5
001928  f7fffffe          BL       lc640_read_long_ptr
;;;1386        
;;;1387        if(!((data[0]=='B')&&(data[2]=='Z')))
00192c  f89d0000          LDRB     r0,[sp,#0]
001930  2842              CMP      r0,#0x42
001932  d103              BNE      |L1.6460|
001934  f89d0002          LDRB     r0,[sp,#2]
001938  285a              CMP      r0,#0x5a
00193a  d008              BEQ      |L1.6478|
                  |L1.6460|
;;;1388        	{        
;;;1389        	if(event_ptr_find)event_ptr_find--;
00193c  b114              CBZ      r4,|L1.6468|
00193e  f1a40401          SUB      r4,r4,#1
001942  e001              B        |L1.6472|
                  |L1.6468|
;;;1390        	else event_ptr_find=63;
001944  f04f043f          MOV      r4,#0x3f
                  |L1.6472|
;;;1391        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001948  42b4              CMP      r4,r6
00194a  d1e9              BNE      |L1.6432|
00194c  e07f              B        |L1.6734|
                  |L1.6478|
;;;1392        	else goto vz_mem_hndl_lbl1;
;;;1393        	}
;;;1394        else 
;;;1395        	{
;;;1396        	lc640_read_long_ptr(lc640_adr+16,data);
00194e  4669              MOV      r1,sp
001950  f1050010          ADD      r0,r5,#0x10
001954  f7fffffe          BL       lc640_read_long_ptr
;;;1397        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001958  f89d0000          LDRB     r0,[sp,#0]
00195c  2841              CMP      r0,#0x41
00195e  d10b              BNE      |L1.6520|
001960  f89d0001          LDRB     r0,[sp,#1]
001964  2841              CMP      r0,#0x41
001966  d107              BNE      |L1.6520|
001968  f89d0002          LDRB     r0,[sp,#2]
00196c  2841              CMP      r0,#0x41
00196e  d103              BNE      |L1.6520|
001970  f89d0003          LDRB     r0,[sp,#3]
001974  2841              CMP      r0,#0x41
001976  d02a              BEQ      |L1.6606|
                  |L1.6520|
;;;1398        		{        
;;;1399        		if(event_ptr_find)event_ptr_find--;
001978  b324              CBZ      r4,|L1.6596|
00197a  f1a40401          SUB      r4,r4,#1
00197e  e023              B        |L1.6600|
                  |L1.6528|
001980  42415420          DCB      "BAT #1 Alarm, assimetry",0
001984  23312041
001988  6c61726d
00198c  2c206173
001990  73696d65
001994  74727900
                  |L1.6552|
001998  42415420          DCB      "BAT #2 Alarm, assimetry",0
00199c  23322041
0019a0  6c61726d
0019a4  2c206173
0019a8  73696d65
0019ac  74727900
                  |L1.6576|
                          DCD      bat
                  |L1.6580|
                          DCD      bat_u_old_cnt
                  |L1.6584|
                          DCD      ke_date
                  |L1.6588|
                          DCD      0x40024020
                  |L1.6592|
                          DCD      0x40024000
                  |L1.6596|
;;;1400            		else event_ptr_find=63;
0019c4  f04f043f          MOV      r4,#0x3f
                  |L1.6600|
;;;1401            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
0019c8  42b4              CMP      r4,r6
0019ca  d1a9              BNE      |L1.6432|
0019cc  e03f              B        |L1.6734|
                  |L1.6606|
;;;1402        		else goto vz_mem_hndl_lbl1;
;;;1403        		}
;;;1404   
;;;1405        	}	
;;;1406   
;;;1407   
;;;1408   	
;;;1409   	data[0]=LPC_RTC->YEAR;
0019ce  f8b8003c          LDRH     r0,[r8,#0x3c]
0019d2  f88d0000          STRB     r0,[sp,#0]
;;;1410   	data[1]=LPC_RTC->MONTH;
0019d6  f8980038          LDRB     r0,[r8,#0x38]
0019da  f88d0001          STRB     r0,[sp,#1]
;;;1411   	data[2]=LPC_RTC->DOM;
0019de  f898002c          LDRB     r0,[r8,#0x2c]
0019e2  f88d0002          STRB     r0,[sp,#2]
;;;1412   	data[3]=0;
0019e6  f88d9003          STRB     r9,[sp,#3]
;;;1413   	lc640_write_long_ptr(lc640_adr+16,data);
0019ea  4669              MOV      r1,sp
0019ec  f1050010          ADD      r0,r5,#0x10
0019f0  f7fffffe          BL       lc640_write_long_ptr
;;;1414   
;;;1415   	data[0]=LPC_RTC->HOUR;
0019f4  f8980028          LDRB     r0,[r8,#0x28]
0019f8  f88d0000          STRB     r0,[sp,#0]
;;;1416   	data[1]=LPC_RTC->MIN;
0019fc  f8980024          LDRB     r0,[r8,#0x24]
001a00  f88d0001          STRB     r0,[sp,#1]
;;;1417   	data[2]=LPC_RTC->SEC;
001a04  f8980020          LDRB     r0,[r8,#0x20]
001a08  f88d0002          STRB     r0,[sp,#2]
;;;1418   	data[3]=0;
001a0c  f88d9003          STRB     r9,[sp,#3]
;;;1419   	lc640_write_long_ptr(lc640_adr+20,data);
001a10  4669              MOV      r1,sp
001a12  f1050014          ADD      r0,r5,#0x14
001a16  f7fffffe          BL       lc640_write_long_ptr
;;;1420   	
;;;1421   	data[0]='B';
001a1a  f88d7000          STRB     r7,[sp,#0]
;;;1422   	data[1]='B';
001a1e  f88d7001          STRB     r7,[sp,#1]
;;;1423   	data[2]='B';
001a22  f88d7002          STRB     r7,[sp,#2]
;;;1424   	data[3]='B';
001a26  f88d7003          STRB     r7,[sp,#3]
;;;1425   	lc640_write_long_ptr(lc640_adr+24,data);
001a2a  4669              MOV      r1,sp
001a2c  f1050018          ADD      r0,r5,#0x18
001a30  f7fffffe          BL       lc640_write_long_ptr
;;;1426   	
;;;1427   	data[0]='B';
001a34  f88d7000          STRB     r7,[sp,#0]
;;;1428   	data[1]='B';
001a38  f88d7001          STRB     r7,[sp,#1]
;;;1429   	data[2]='B';
001a3c  f88d7002          STRB     r7,[sp,#2]
;;;1430   	data[3]='B';
001a40  f88d7003          STRB     r7,[sp,#3]
;;;1431   	lc640_write_long_ptr(lc640_adr+28,data);
001a44  4669              MOV      r1,sp
001a46  f105001c          ADD      r0,r5,#0x1c
001a4a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.6734|
;;;1432   	
;;;1433   	}
;;;1434   
;;;1435   vz_mem_hndl_end:
;;;1436   __nop(); 
001a4e  bf00              NOP      
;;;1437   
;;;1438   }
001a50  e4c2              B        |L1.5080|
;;;1439     
                          ENDP


                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  av_inv
                          DCD      0x00000000
000018  0000              DCB      0x00,0x00
