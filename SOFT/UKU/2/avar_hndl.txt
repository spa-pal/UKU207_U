; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\avar_hndl.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;56     //-----------------------------------------------
;;;57     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;58     {
;;;59     //static unsigned avar_stat_old;
;;;60     char i;
;;;61     //unsigned avar_stat_new,avar_stat_offed;
;;;62     
;;;63     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48fc              LDR      r0,|L1.1012|
000004  4bfc              LDR      r3,|L1.1016|
000006  7801              LDRB     r1,[r0,#0]  ; net_av
000008  6818              LDR      r0,[r3,#0]
00000a  b119              CBZ      r1,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6018              STR      r0,[r3,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;64     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6018              STR      r0,[r3,#0]  ; avar_stat
                  |L1.26|
;;;65     
;;;66     for(i=0;i<2;i++)
00001a  f04f0000          MOV      r0,#0
;;;67     	{
;;;68     	if(bat[i]._av&1)	SET_REG(avar_stat,1,1+i,1);
00001e  49f7              LDR      r1,|L1.1020|
000020  f04f0401          MOV      r4,#1
                  |L1.36|
000024  eb000240          ADD      r2,r0,r0,LSL #1
000028  eb021200          ADD      r2,r2,r0,LSL #4
00002c  eb010282          ADD      r2,r1,r2,LSL #2
000030  f892203d          LDRB     r2,[r2,#0x3d]
000034  07d2              LSLS     r2,r2,#31
000036  d00a              BEQ      |L1.78|
000038  f1000501          ADD      r5,r0,#1
00003c  fa04f205          LSL      r2,r4,r5
000040  681d              LDR      r5,[r3,#0]  ; avar_stat
000042  ea250502          BIC      r5,r5,r2
000046  ea450502          ORR      r5,r5,r2
00004a  601d              STR      r5,[r3,#0]  ; avar_stat
00004c  e007              B        |L1.94|
                  |L1.78|
;;;69     	else	   		SET_REG(avar_stat,0,1+i,1);
00004e  f1000201          ADD      r2,r0,#1
000052  fa04f502          LSL      r5,r4,r2
000056  681a              LDR      r2,[r3,#0]  ; avar_stat
000058  ea220205          BIC      r2,r2,r5
00005c  601a              STR      r2,[r3,#0]  ; avar_stat
                  |L1.94|
00005e  f1000001          ADD      r0,r0,#1              ;66
000062  b2c0              UXTB     r0,r0                 ;66
000064  2802              CMP      r0,#2                 ;66
000066  d3dd              BCC      |L1.36|
;;;70     	}
;;;71     
;;;72     for(i=0;i<12;i++)
000068  f04f0000          MOV      r0,#0
;;;73     	{
;;;74     	if(bps[i]._av)	SET_REG(avar_stat,1,3+i,1);
00006c  4de4              LDR      r5,|L1.1024|
                  |L1.110|
00006e  ebc002c0          RSB      r2,r0,r0,LSL #3
000072  eb020142          ADD      r1,r2,r2,LSL #1
000076  eb050181          ADD      r1,r5,r1,LSL #2
00007a  7849              LDRB     r1,[r1,#1]
00007c  b151              CBZ      r1,|L1.148|
00007e  f1000203          ADD      r2,r0,#3
000082  fa04f102          LSL      r1,r4,r2
000086  681a              LDR      r2,[r3,#0]  ; avar_stat
000088  ea220201          BIC      r2,r2,r1
00008c  ea420201          ORR      r2,r2,r1
000090  601a              STR      r2,[r3,#0]  ; avar_stat
000092  e007              B        |L1.164|
                  |L1.148|
;;;75     	else	   		SET_REG(avar_stat,0,3+i,1);
000094  f1000103          ADD      r1,r0,#3
000098  fa04f201          LSL      r2,r4,r1
00009c  6819              LDR      r1,[r3,#0]  ; avar_stat
00009e  ea210102          BIC      r1,r1,r2
0000a2  6019              STR      r1,[r3,#0]  ; avar_stat
                  |L1.164|
0000a4  f1000001          ADD      r0,r0,#1              ;72
0000a8  b2c0              UXTB     r0,r0                 ;72
0000aa  280c              CMP      r0,#0xc               ;72
0000ac  d3df              BCC      |L1.110|
;;;76     	}
;;;77     
;;;78     for(i=0;i<6;i++)
0000ae  f04f0000          MOV      r0,#0
;;;79     	{
;;;80     	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
0000b2  4dd1              LDR      r5,|L1.1016|
0000b4  f1050514          ADD      r5,r5,#0x14
                  |L1.184|
0000b8  5c29              LDRB     r1,[r5,r0]
0000ba  b151              CBZ      r1,|L1.210|
0000bc  f100010f          ADD      r1,r0,#0xf
0000c0  fa04f201          LSL      r2,r4,r1
0000c4  6819              LDR      r1,[r3,#0]  ; avar_stat
0000c6  ea210102          BIC      r1,r1,r2
0000ca  ea410102          ORR      r1,r1,r2
0000ce  6019              STR      r1,[r3,#0]  ; avar_stat
0000d0  e007              B        |L1.226|
                  |L1.210|
;;;81     	else	   		SET_REG(avar_stat,0,15+i,1);
0000d2  f100010f          ADD      r1,r0,#0xf
0000d6  681a              LDR      r2,[r3,#0]  ; avar_stat
0000d8  fa04f101          LSL      r1,r4,r1
0000dc  ea220201          BIC      r2,r2,r1
0000e0  601a              STR      r2,[r3,#0]  ; avar_stat
                  |L1.226|
0000e2  f1000001          ADD      r0,r0,#1              ;78
0000e6  b2c0              UXTB     r0,r0                 ;78
0000e8  2806              CMP      r0,#6                 ;78
0000ea  d3e5              BCC      |L1.184|
;;;82     	}
;;;83     
;;;84     /*for(i=0;i<4;i++)
;;;85     	{
;;;86     	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;87     	else	   		SET_REG(avar_stat,0,21+i,1);
;;;88     	}  */
;;;89     for(i=0;i<4;i++)
0000ec  f04f0000          MOV      r0,#0
;;;90     	{
;;;91     	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000f0  49c4              LDR      r1,|L1.1028|
                  |L1.242|
0000f2  5c0a              LDRB     r2,[r1,r0]
0000f4  2a01              CMP      r2,#1
0000f6  d014              BEQ      |L1.290|
;;;92     	else	   		SET_REG(avar_stat,0,24+i,1);
0000f8  f1000218          ADD      r2,r0,#0x18
0000fc  681d              LDR      r5,[r3,#0]  ; avar_stat
0000fe  fa04f202          LSL      r2,r4,r2
000102  ea250502          BIC      r5,r5,r2
000106  601d              STR      r5,[r3,#0]  ; avar_stat
                  |L1.264|
000108  f1000001          ADD      r0,r0,#1              ;89
00010c  b2c0              UXTB     r0,r0                 ;89
00010e  2804              CMP      r0,#4                 ;89
000110  d3ef              BCC      |L1.242|
;;;93     	}
;;;94     
;;;95     if(uout_av)			SET_REG(avar_stat,1,28,1);
000112  48bd              LDR      r0,|L1.1032|
000114  7800              LDRB     r0,[r0,#0]  ; uout_av
000116  b178              CBZ      r0,|L1.312|
000118  6818              LDR      r0,[r3,#0]  ; avar_stat
00011a  f0405080          ORR      r0,r0,#0x10000000
00011e  6018              STR      r0,[r3,#0]  ; avar_stat
000120  e00e              B        |L1.320|
                  |L1.290|
000122  f1000518          ADD      r5,r0,#0x18           ;91
000126  fa04f205          LSL      r2,r4,r5              ;91
00012a  681d              LDR      r5,[r3,#0]            ;91  ; avar_stat
00012c  ea250502          BIC      r5,r5,r2              ;91
000130  ea450502          ORR      r5,r5,r2              ;91
000134  601d              STR      r5,[r3,#0]            ;91  ; avar_stat
000136  e7e7              B        |L1.264|
                  |L1.312|
;;;96     else	   			SET_REG(avar_stat,0,28,1);
000138  6818              LDR      r0,[r3,#0]  ; avar_stat
00013a  f0205080          BIC      r0,r0,#0x10000000
00013e  6018              STR      r0,[r3,#0]  ; avar_stat
                  |L1.320|
;;;97     
;;;98     
;;;99     avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000140  689c              LDR      r4,[r3,#8]  ; avar_stat_old
000142  6818              LDR      r0,[r3,#0]  ; avar_stat
000144  ea200104          BIC      r1,r0,r4
000148  60d9              STR      r1,[r3,#0xc]  ; avar_stat_new
;;;100    
;;;101    avar_ind_stat|=avar_stat_new;
00014a  685a              LDR      r2,[r3,#4]  ; avar_ind_stat
00014c  ea420201          ORR      r2,r2,r1
000150  605a              STR      r2,[r3,#4]  ; avar_ind_stat
;;;102    
;;;103    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000152  49ae              LDR      r1,|L1.1036|
000154  880d              LDRH     r5,[r1,#0]  ; SK_ZVUK_EN
000156  b115              CBZ      r5,|L1.350|
000158  f0227280          BIC      r2,r2,#0x1000000
00015c  605a              STR      r2,[r3,#4]  ; avar_ind_stat
                  |L1.350|
;;;104    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
00015e  884a              LDRH     r2,[r1,#2]  ; SK_ZVUK_EN
000160  b11a              CBZ      r2,|L1.362|
000162  685a              LDR      r2,[r3,#4]  ; avar_ind_stat
000164  f0227200          BIC      r2,r2,#0x2000000
000168  605a              STR      r2,[r3,#4]  ; avar_ind_stat
                  |L1.362|
;;;105    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
00016a  888a              LDRH     r2,[r1,#4]  ; SK_ZVUK_EN
00016c  b11a              CBZ      r2,|L1.374|
00016e  685a              LDR      r2,[r3,#4]  ; avar_ind_stat
000170  f0226280          BIC      r2,r2,#0x4000000
000174  605a              STR      r2,[r3,#4]  ; avar_ind_stat
                  |L1.374|
;;;106    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
000176  88c9              LDRH     r1,[r1,#6]  ; SK_ZVUK_EN
000178  b119              CBZ      r1,|L1.386|
00017a  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
00017c  f0216100          BIC      r1,r1,#0x8000000
000180  6059              STR      r1,[r3,#4]  ; avar_ind_stat
                  |L1.386|
;;;107    
;;;108    
;;;109    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
000182  ea240400          BIC      r4,r4,r0
000186  ea6f0104          MVN      r1,r4
00018a  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
;;;110    
;;;111    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
00018c  4aa0              LDR      r2,|L1.1040|
00018e  8812              LDRH     r2,[r2,#0]  ; AV_OFF_AVT
000190  b91a              CBNZ     r2,|L1.410|
000192  4aa0              LDR      r2,|L1.1044|
000194  ea410102          ORR      r1,r1,r2
000198  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
                  |L1.410|
;;;112    
;;;113    avar_ind_stat&=avar_stat_offed; 
00019a  691a              LDR      r2,[r3,#0x10]  ; avar_stat_offed
00019c  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
00019e  ea010102          AND      r1,r1,r2
0001a2  6059              STR      r1,[r3,#4]  ; avar_ind_stat
;;;114    
;;;115    avar_stat_old=avar_stat;
0001a4  6098              STR      r0,[r3,#8]  ; avar_stat_old
;;;116    }
0001a6  bd30              POP      {r4,r5,pc}
;;;117    
                          ENDP

                  reload_hndl PROC
;;;118    //-----------------------------------------------
;;;119    void reload_hndl(void)
0001a8  b5f8              PUSH     {r3-r7,lr}
;;;120    {
;;;121    char data[4];
;;;122    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;123    
;;;124    event_ptr=lc640_read_int(PTR_EVENT_LOG);
0001aa  f44f6560          MOV      r5,#0xe00
0001ae  4628              MOV      r0,r5
0001b0  f7fffffe          BL       lc640_read_int
;;;125    event_ptr++;	
0001b4  f1000001          ADD      r0,r0,#1
0001b8  4604              MOV      r4,r0
;;;126    if(event_ptr>63)event_ptr=0;	
0001ba  2c3f              CMP      r4,#0x3f
0001bc  d901              BLS      |L1.450|
0001be  f04f0400          MOV      r4,#0
                  |L1.450|
;;;127    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
0001c2  b221              SXTH     r1,r4
0001c4  4628              MOV      r0,r5
0001c6  f7fffffe          BL       lc640_write_int
;;;128    	
;;;129    event_cnt=lc640_read_int(CNT_EVENT_LOG);
0001ca  f6406602          MOV      r6,#0xe02
0001ce  4630              MOV      r0,r6
0001d0  f7fffffe          BL       lc640_read_int
;;;130    if(event_cnt!=63)event_cnt=event_ptr;
0001d4  283f              CMP      r0,#0x3f
0001d6  d000              BEQ      |L1.474|
0001d8  4620              MOV      r0,r4
                  |L1.474|
;;;131    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
0001da  b201              SXTH     r1,r0
0001dc  4630              MOV      r0,r6
0001de  f7fffffe          BL       lc640_write_int
;;;132    	
;;;133    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
0001e2  4628              MOV      r0,r5
0001e4  f7fffffe          BL       lc640_read_int
0001e8  f44f6180          MOV      r1,#0x400
0001ec  eb011440          ADD      r4,r1,r0,LSL #5
;;;134    	
;;;135    data[0]='U';
0001f0  f04f0055          MOV      r0,#0x55
0001f4  f88d0000          STRB     r0,[sp,#0]
;;;136    data[1]=0;
0001f8  f04f0600          MOV      r6,#0
0001fc  f88d6001          STRB     r6,[sp,#1]
;;;137    data[2]='R';
000200  f04f0052          MOV      r0,#0x52
000204  f88d0002          STRB     r0,[sp,#2]
;;;138    data[3]=0;
000208  f88d6003          STRB     r6,[sp,#3]
;;;139    lc640_write_long_ptr(lc640_adr,data);
00020c  4669              MOV      r1,sp
00020e  4620              MOV      r0,r4
000210  f7fffffe          BL       lc640_write_long_ptr
;;;140    
;;;141    data[0]=0;
;;;142    data[1]=0;
;;;143    data[2]=0;
;;;144    data[3]=0;
000214  9600              STR      r6,[sp,#0]
;;;145    lc640_write_long_ptr(lc640_adr+4,data);
000216  4669              MOV      r1,sp
000218  1d20              ADDS     r0,r4,#4
00021a  f7fffffe          BL       lc640_write_long_ptr
;;;146    
;;;147    data[0]=LPC_RTC->YEAR;
00021e  4d7e              LDR      r5,|L1.1048|
000220  8ba8              LDRH     r0,[r5,#0x1c]
000222  f88d0000          STRB     r0,[sp,#0]
;;;148    data[1]=LPC_RTC->MONTH;
000226  7e28              LDRB     r0,[r5,#0x18]
000228  f88d0001          STRB     r0,[sp,#1]
;;;149    data[2]=LPC_RTC->DOM;
00022c  7b28              LDRB     r0,[r5,#0xc]
00022e  f88d0002          STRB     r0,[sp,#2]
;;;150    data[3]=0;
000232  f88d6003          STRB     r6,[sp,#3]
;;;151    lc640_write_long_ptr(lc640_adr+8,data);
000236  4669              MOV      r1,sp
000238  f1040008          ADD      r0,r4,#8
00023c  f7fffffe          BL       lc640_write_long_ptr
;;;152    
;;;153    data[0]=LPC_RTC->HOUR;
000240  7a28              LDRB     r0,[r5,#8]
000242  f88d0000          STRB     r0,[sp,#0]
;;;154    data[1]=LPC_RTC->MIN;
000246  7928              LDRB     r0,[r5,#4]
000248  f88d0001          STRB     r0,[sp,#1]
;;;155    data[2]=LPC_RTC->SEC;
00024c  7828              LDRB     r0,[r5,#0]
00024e  f88d0002          STRB     r0,[sp,#2]
;;;156    data[3]=LPC_SC->RSID;
000252  4872              LDR      r0,|L1.1052|
000254  f8d00180          LDR      r0,[r0,#0x180]
000258  f88d0003          STRB     r0,[sp,#3]
;;;157    
;;;158    lc640_write_long_ptr(lc640_adr+12,data);
00025c  4669              MOV      r1,sp
00025e  f104000c          ADD      r0,r4,#0xc
000262  f7fffffe          BL       lc640_write_long_ptr
;;;159    	
;;;160    data[0]='A';
000266  f04f0541          MOV      r5,#0x41
00026a  f88d5000          STRB     r5,[sp,#0]
;;;161    data[1]='A';
00026e  f88d5001          STRB     r5,[sp,#1]
;;;162    data[2]='A';
000272  f88d5002          STRB     r5,[sp,#2]
;;;163    data[3]='A';
000276  f88d5003          STRB     r5,[sp,#3]
;;;164    lc640_write_long_ptr(lc640_adr+16,data);
00027a  4669              MOV      r1,sp
00027c  f1040010          ADD      r0,r4,#0x10
000280  f7fffffe          BL       lc640_write_long_ptr
;;;165    	
;;;166    data[0]='A';
000284  f88d5000          STRB     r5,[sp,#0]
;;;167    data[1]='A';
000288  f88d5001          STRB     r5,[sp,#1]
;;;168    data[2]='A';
00028c  f88d5002          STRB     r5,[sp,#2]
;;;169    data[3]='A';
000290  f88d5003          STRB     r5,[sp,#3]
;;;170    lc640_write_long_ptr(lc640_adr+20,data);
000294  4669              MOV      r1,sp
000296  f1040014          ADD      r0,r4,#0x14
00029a  f7fffffe          BL       lc640_write_long_ptr
;;;171    	
;;;172    data[0]='A';
00029e  f88d5000          STRB     r5,[sp,#0]
;;;173    data[1]='A';
0002a2  f88d5001          STRB     r5,[sp,#1]
;;;174    data[2]='A';
0002a6  f88d5002          STRB     r5,[sp,#2]
;;;175    data[3]='A';
0002aa  f88d5003          STRB     r5,[sp,#3]
;;;176    lc640_write_long_ptr(lc640_adr+24,data);
0002ae  4669              MOV      r1,sp
0002b0  f1040018          ADD      r0,r4,#0x18
0002b4  f7fffffe          BL       lc640_write_long_ptr
;;;177    	
;;;178    data[0]='A';
0002b8  f88d5000          STRB     r5,[sp,#0]
;;;179    data[1]='A';
0002bc  f88d5001          STRB     r5,[sp,#1]
;;;180    data[2]='A';
0002c0  f88d5002          STRB     r5,[sp,#2]
;;;181    data[3]='A';
0002c4  f88d5003          STRB     r5,[sp,#3]
;;;182    lc640_write_long_ptr(lc640_adr+28,data);				
0002c8  4669              MOV      r1,sp
0002ca  f104001c          ADD      r0,r4,#0x1c
0002ce  f7fffffe          BL       lc640_write_long_ptr
;;;183    	
;;;184    	
;;;185    }
0002d2  bdf8              POP      {r3-r7,pc}
;;;186    
                          ENDP

                  avar_unet_hndl PROC
;;;187    //-----------------------------------------------
;;;188    void avar_unet_hndl(char in)
0002d4  e92d43f8          PUSH     {r3-r9,lr}
;;;189    {
;;;190    
;;;191    char data[4];
;;;192    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;193    
;;;194    
;;;195    if(in==1)
;;;196    	{
;;;197    	net_av=1;
;;;198    
;;;199    	//beep_init(0x01L,'O');
;;;200    	//a.av.bAN=1;
;;;201    
;;;202    
;;;203    	//beep_init(0x33333333,'A');
;;;204    	 
;;;205    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;206    	event_ptr++;	
;;;207    	if(event_ptr>63)event_ptr=0;	
;;;208    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;209    	
;;;210         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;211    	if(event_cnt!=63)event_cnt=event_ptr;
;;;212    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;213    	
;;;214    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;215    	
;;;216    	data[0]='P';
;;;217    	data[1]=0;
;;;218    	data[2]='A';
;;;219    	data[3]=0;
;;;220    	lc640_write_long_ptr(lc640_adr,data);
;;;221    
;;;222    	data[0]=0;//*((char*)&Unet_store);
;;;223    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;224    	data[2]=0;
;;;225    	data[3]=0;
;;;226    	lc640_write_long_ptr(lc640_adr+4,data);
;;;227    
;;;228    	data[0]=LPC_RTC->YEAR;
0002d8  4f4f              LDR      r7,|L1.1048|
0002da  4946              LDR      r1,|L1.1012|
0002dc  3f20              SUBS     r7,r7,#0x20
0002de  f44f6560          MOV      r5,#0xe00             ;205
0002e2  f04f0800          MOV      r8,#0                 ;207
0002e6  f44f6980          MOV      r9,#0x400             ;214
0002ea  2801              CMP      r0,#1                 ;195
0002ec  d002              BEQ      |L1.756|
;;;229    	data[1]=LPC_RTC->MONTH;
;;;230    	data[2]=LPC_RTC->DOM;
;;;231    	data[3]=0;
;;;232    	lc640_write_long_ptr(lc640_adr+8,data);
;;;233    
;;;234    	data[0]=LPC_RTC->HOUR;
;;;235    	data[1]=LPC_RTC->MIN;
;;;236    	data[2]=LPC_RTC->SEC;
;;;237    	data[3]=0;
;;;238    	lc640_write_long_ptr(lc640_adr+12,data);
;;;239    	
;;;240    	data[0]='A';
;;;241    	data[1]='A';
;;;242    	data[2]='A';
;;;243    	data[3]='A';
;;;244    	lc640_write_long_ptr(lc640_adr+16,data);
;;;245    	
;;;246    	data[0]='A';
;;;247    	data[1]='A';
;;;248    	data[2]='A';
;;;249    	data[3]='A';
;;;250    	lc640_write_long_ptr(lc640_adr+20,data);
;;;251    	
;;;252    	data[0]='A';
;;;253    	data[1]='A';
;;;254    	data[2]='A';
;;;255    	data[3]='A';
;;;256    	lc640_write_long_ptr(lc640_adr+24,data);
;;;257    	
;;;258    	data[0]='A';
;;;259    	data[1]='A';
;;;260    	data[2]='A';
;;;261    	data[3]='A';
;;;262    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;263    	
;;;264    /*	memo_out0[0]=0x55;
;;;265         memo_out0[1]=0x00+2;
;;;266         memo_out0[2]=1;
;;;267         memo_out0[3]=0x0b;
;;;268         memo_out0[4]=0x55;
;;;269         memo_out0[5]=0x55; 
;;;270         	
;;;271         memo_out0[6]=crc_87(memo_out0,6);
;;;272    	memo_out0[7]=crc_95(memo_out0,6);
;;;273         usart_out_adr0(memo_out0,8); 
;;;274    	*/
;;;275    	snmp_trap_send("Main power is off",2,1,0);
;;;276    	}
;;;277    
;;;278    else if(in==0)
0002ee  2800              CMP      r0,#0
0002f0  d07e              BEQ      |L1.1008|
0002f2  e13f              B        |L1.1396|
                  |L1.756|
0002f4  f04f0001          MOV      r0,#1                 ;197
0002f8  7008              STRB     r0,[r1,#0]            ;197
0002fa  4628              MOV      r0,r5                 ;205
0002fc  f7fffffe          BL       lc640_read_int
000300  f1000001          ADD      r0,r0,#1              ;206
000304  4604              MOV      r4,r0                 ;206
000306  2c3f              CMP      r4,#0x3f              ;207
000308  d901              BLS      |L1.782|
00030a  f04f0400          MOV      r4,#0                 ;207
                  |L1.782|
00030e  b221              SXTH     r1,r4                 ;208
000310  4628              MOV      r0,r5                 ;208
000312  f7fffffe          BL       lc640_write_int
000316  f6406602          MOV      r6,#0xe02             ;210
00031a  4630              MOV      r0,r6                 ;210
00031c  f7fffffe          BL       lc640_read_int
000320  283f              CMP      r0,#0x3f              ;211
000322  d000              BEQ      |L1.806|
000324  4620              MOV      r0,r4                 ;211
                  |L1.806|
000326  b201              SXTH     r1,r0                 ;212
000328  4630              MOV      r0,r6                 ;212
00032a  f7fffffe          BL       lc640_write_int
00032e  4628              MOV      r0,r5                 ;214
000330  f7fffffe          BL       lc640_read_int
000334  eb091540          ADD      r5,r9,r0,LSL #5       ;214
000338  f04f0050          MOV      r0,#0x50              ;216
00033c  f88d0000          STRB     r0,[sp,#0]            ;216
000340  f88d8001          STRB     r8,[sp,#1]            ;217
000344  f04f0441          MOV      r4,#0x41              ;218
000348  f88d4002          STRB     r4,[sp,#2]            ;218
00034c  f88d8003          STRB     r8,[sp,#3]            ;219
000350  4669              MOV      r1,sp                 ;220
000352  4628              MOV      r0,r5                 ;220
000354  f7fffffe          BL       lc640_write_long_ptr
000358  f8cd8000          STR      r8,[sp,#0]            ;225
00035c  4669              MOV      r1,sp                 ;226
00035e  1d28              ADDS     r0,r5,#4              ;226
000360  f7fffffe          BL       lc640_write_long_ptr
000364  f1070720          ADD      r7,r7,#0x20           ;228
000368  8bb8              LDRH     r0,[r7,#0x1c]         ;228
00036a  f88d0000          STRB     r0,[sp,#0]            ;228
00036e  7e38              LDRB     r0,[r7,#0x18]         ;229
000370  f88d0001          STRB     r0,[sp,#1]            ;229
000374  7b38              LDRB     r0,[r7,#0xc]          ;230
000376  f88d0002          STRB     r0,[sp,#2]            ;230
00037a  f88d8003          STRB     r8,[sp,#3]            ;231
00037e  4669              MOV      r1,sp                 ;232
000380  f1050008          ADD      r0,r5,#8              ;232
000384  f7fffffe          BL       lc640_write_long_ptr
000388  7a38              LDRB     r0,[r7,#8]            ;234
00038a  f88d0000          STRB     r0,[sp,#0]            ;234
00038e  7938              LDRB     r0,[r7,#4]            ;235
000390  f88d0001          STRB     r0,[sp,#1]            ;235
000394  7838              LDRB     r0,[r7,#0]            ;236
000396  f88d0002          STRB     r0,[sp,#2]            ;236
00039a  f88d8003          STRB     r8,[sp,#3]            ;237
00039e  4669              MOV      r1,sp                 ;238
0003a0  f105000c          ADD      r0,r5,#0xc            ;238
0003a4  f7fffffe          BL       lc640_write_long_ptr
0003a8  f88d4000          STRB     r4,[sp,#0]            ;240
0003ac  f88d4001          STRB     r4,[sp,#1]            ;241
0003b0  f88d4002          STRB     r4,[sp,#2]            ;242
0003b4  f88d4003          STRB     r4,[sp,#3]            ;243
0003b8  4669              MOV      r1,sp                 ;244
0003ba  f1050010          ADD      r0,r5,#0x10           ;244
0003be  f7fffffe          BL       lc640_write_long_ptr
0003c2  f88d4000          STRB     r4,[sp,#0]            ;246
0003c6  f88d4001          STRB     r4,[sp,#1]            ;247
0003ca  f88d4002          STRB     r4,[sp,#2]            ;248
0003ce  f88d4003          STRB     r4,[sp,#3]            ;249
0003d2  4669              MOV      r1,sp                 ;250
0003d4  f1050014          ADD      r0,r5,#0x14           ;250
0003d8  f7fffffe          BL       lc640_write_long_ptr
0003dc  f88d4000          STRB     r4,[sp,#0]            ;252
0003e0  f88d4001          STRB     r4,[sp,#1]            ;253
0003e4  f88d4002          STRB     r4,[sp,#2]            ;254
0003e8  f88d4003          STRB     r4,[sp,#3]            ;255
0003ec  4669              MOV      r1,sp                 ;256
0003ee  e017              B        |L1.1056|
                  |L1.1008|
0003f0  e02e              B        |L1.1104|
0003f2  0000              DCW      0x0000
                  |L1.1012|
                          DCD      net_av
                  |L1.1016|
                          DCD      ||.data||
                  |L1.1020|
                          DCD      bat
                  |L1.1024|
                          DCD      bps
                  |L1.1028|
                          DCD      sk_av_stat
                  |L1.1032|
                          DCD      uout_av
                  |L1.1036|
                          DCD      SK_ZVUK_EN
                  |L1.1040|
                          DCD      AV_OFF_AVT
                  |L1.1044|
                          DCD      0xeffffffe
                  |L1.1048|
                          DCD      0x40024020
                  |L1.1052|
                          DCD      0x400fc000
                  |L1.1056|
000420  f1050018          ADD      r0,r5,#0x18           ;256
000424  f7fffffe          BL       lc640_write_long_ptr
000428  f88d4000          STRB     r4,[sp,#0]            ;258
00042c  f88d4001          STRB     r4,[sp,#1]            ;259
000430  f88d4002          STRB     r4,[sp,#2]            ;260
000434  f88d4003          STRB     r4,[sp,#3]            ;261
000438  4669              MOV      r1,sp                 ;262
00043a  f105001c          ADD      r0,r5,#0x1c           ;262
00043e  f7fffffe          BL       lc640_write_long_ptr
000442  2300              MOVS     r3,#0                 ;275
000444  2201              MOVS     r2,#1                 ;275
000446  2102              MOVS     r1,#2                 ;275
000448  a0fd              ADR      r0,|L1.2112|
00044a  f7fffffe          BL       snmp_trap_send
00044e  e091              B        |L1.1396|
                  |L1.1104|
;;;279    	{
;;;280    	net_av=0;
000450  f8818000          STRB     r8,[r1,#0]
;;;281    
;;;282      /*
;;;283    	SET_REG(C2GSR,3,24,8);
;;;284    	C2MOD=0;
;;;285    	bOUT_FREE2=1;*/
;;;286    
;;;287    
;;;288    	//C2MOD=0;
;;;289    
;;;290    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;291    
;;;292         //beep_init(0x02L,'O');
;;;293    	//a_.av.bAN=0;
;;;294    	SET_REG(avar_stat,0,0,1);
000454  48ff              LDR      r0,|L1.2132|
000456  6801              LDR      r1,[r0,#0]  ; avar_stat
000458  f0210101          BIC      r1,r1,#1
00045c  6001              STR      r1,[r0,#0]  ; avar_stat
;;;295    
;;;296    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;297    	
;;;298    	if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
00045e  49fe              LDR      r1,|L1.2136|
000460  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
000462  b119              CBZ      r1,|L1.1132|
000464  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
000466  f0210101          BIC      r1,r1,#1
00046a  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.1132|
;;;299    
;;;300         event_ptr=lc640_read_int(PTR_EVENT_LOG);
00046c  4628              MOV      r0,r5
00046e  f7fffffe          BL       lc640_read_int
000472  4606              MOV      r6,r0
;;;301    	event_ptr_find=event_ptr;
000474  4634              MOV      r4,r6
                  |L1.1142|
;;;302    avar_unet_hndl_lbl1:
;;;303    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000476  eb091544          ADD      r5,r9,r4,LSL #5
;;;304    
;;;305         lc640_read_long_ptr(lc640_adr,data);
00047a  4669              MOV      r1,sp
00047c  4628              MOV      r0,r5
00047e  f7fffffe          BL       lc640_read_long_ptr
;;;306         
;;;307         if(!((data[0]=='P')&&(data[1]==0)&&(data[2]=='A')))
000482  f89d0000          LDRB     r0,[sp,#0]
000486  2850              CMP      r0,#0x50
000488  d106              BNE      |L1.1176|
00048a  f89d0001          LDRB     r0,[sp,#1]
00048e  b918              CBNZ     r0,|L1.1176|
000490  f89d0002          LDRB     r0,[sp,#2]
000494  2841              CMP      r0,#0x41
000496  d008              BEQ      |L1.1194|
                  |L1.1176|
;;;308         	{        
;;;309         	if(event_ptr_find)event_ptr_find--;
000498  b114              CBZ      r4,|L1.1184|
00049a  f1a40401          SUB      r4,r4,#1
00049e  e001              B        |L1.1188|
                  |L1.1184|
;;;310         	else event_ptr_find=63;
0004a0  f04f043f          MOV      r4,#0x3f
                  |L1.1188|
;;;311         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0004a4  42b4              CMP      r4,r6
0004a6  d1e6              BNE      |L1.1142|
0004a8  e064              B        |L1.1396|
                  |L1.1194|
;;;312         	else goto avar_unet_hndl_lbl1;
;;;313         	}
;;;314         else 
;;;315         	{
;;;316         	lc640_read_long_ptr(lc640_adr+16,data);
0004aa  4669              MOV      r1,sp
0004ac  f1050010          ADD      r0,r5,#0x10
0004b0  f7fffffe          BL       lc640_read_long_ptr
;;;317         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0004b4  f89d0000          LDRB     r0,[sp,#0]
0004b8  2841              CMP      r0,#0x41
0004ba  d10b              BNE      |L1.1236|
0004bc  f89d0001          LDRB     r0,[sp,#1]
0004c0  2841              CMP      r0,#0x41
0004c2  d107              BNE      |L1.1236|
0004c4  f89d0002          LDRB     r0,[sp,#2]
0004c8  2841              CMP      r0,#0x41
0004ca  d103              BNE      |L1.1236|
0004cc  f89d0003          LDRB     r0,[sp,#3]
0004d0  2841              CMP      r0,#0x41
0004d2  d008              BEQ      |L1.1254|
                  |L1.1236|
;;;318         		{        
;;;319         		if(event_ptr_find)event_ptr_find--;
0004d4  b114              CBZ      r4,|L1.1244|
0004d6  f1a40401          SUB      r4,r4,#1
0004da  e001              B        |L1.1248|
                  |L1.1244|
;;;320             		else event_ptr_find=63;
0004dc  f04f043f          MOV      r4,#0x3f
                  |L1.1248|
;;;321             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0004e0  42b4              CMP      r4,r6
0004e2  d1c8              BNE      |L1.1142|
0004e4  e046              B        |L1.1396|
                  |L1.1254|
;;;322         		else goto avar_unet_hndl_lbl1;
;;;323         		}
;;;324    
;;;325         	}	
;;;326    	
;;;327    	data[0]=LPC_RTC->YEAR;
0004e6  f1070720          ADD      r7,r7,#0x20
0004ea  8bb8              LDRH     r0,[r7,#0x1c]
0004ec  f88d0000          STRB     r0,[sp,#0]
;;;328    	data[1]=LPC_RTC->MONTH;
0004f0  7e38              LDRB     r0,[r7,#0x18]
0004f2  f88d0001          STRB     r0,[sp,#1]
;;;329    	data[2]=LPC_RTC->DOM;
0004f6  7b38              LDRB     r0,[r7,#0xc]
0004f8  f88d0002          STRB     r0,[sp,#2]
;;;330    	data[3]=0;
0004fc  f88d8003          STRB     r8,[sp,#3]
;;;331    	lc640_write_long_ptr(lc640_adr+16,data);
000500  4669              MOV      r1,sp
000502  f1050010          ADD      r0,r5,#0x10
000506  f7fffffe          BL       lc640_write_long_ptr
;;;332    
;;;333    	data[0]=LPC_RTC->HOUR;
00050a  7a38              LDRB     r0,[r7,#8]
00050c  f88d0000          STRB     r0,[sp,#0]
;;;334    	data[1]=LPC_RTC->MIN;
000510  7938              LDRB     r0,[r7,#4]
000512  f88d0001          STRB     r0,[sp,#1]
;;;335    	data[2]=LPC_RTC->SEC;
000516  7838              LDRB     r0,[r7,#0]
000518  f88d0002          STRB     r0,[sp,#2]
;;;336    	data[3]=0;
00051c  f88d8003          STRB     r8,[sp,#3]
;;;337    	lc640_write_long_ptr(lc640_adr+20,data); 
000520  4669              MOV      r1,sp
000522  f1050014          ADD      r0,r5,#0x14
000526  f7fffffe          BL       lc640_write_long_ptr
;;;338    	
;;;339    	data[0]=*((char*)(&net_Ustore));
00052a  48cc              LDR      r0,|L1.2140|
00052c  7801              LDRB     r1,[r0,#0]  ; net_Ustore
00052e  f88d1000          STRB     r1,[sp,#0]
;;;340    	data[1]=*(((char*)(&net_Ustore))+1);
000532  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000534  f88d0001          STRB     r0,[sp,#1]
;;;341    	data[2]='B';
000538  f04f0442          MOV      r4,#0x42
00053c  f88d4002          STRB     r4,[sp,#2]
;;;342    	data[3]='B';
000540  f88d4003          STRB     r4,[sp,#3]
;;;343    	lc640_write_long_ptr(lc640_adr+24,data);
000544  4669              MOV      r1,sp
000546  f1050018          ADD      r0,r5,#0x18
00054a  f7fffffe          BL       lc640_write_long_ptr
;;;344    	
;;;345    	data[0]='B';
00054e  f88d4000          STRB     r4,[sp,#0]
;;;346    	data[1]='B';
000552  f88d4001          STRB     r4,[sp,#1]
;;;347    	data[2]='B';
000556  f88d4002          STRB     r4,[sp,#2]
;;;348    	data[3]='B';
00055a  f88d4003          STRB     r4,[sp,#3]
;;;349    	lc640_write_long_ptr(lc640_adr+28,data);	
00055e  4669              MOV      r1,sp
000560  f105001c          ADD      r0,r5,#0x1c
000564  f7fffffe          BL       lc640_write_long_ptr
;;;350    	
;;;351    /*	memo_out0[0]=0x55;
;;;352         memo_out0[1]=0x00+2;
;;;353         memo_out0[2]=1;
;;;354         memo_out0[3]=0x0b;
;;;355         memo_out0[4]=0xaa;
;;;356         memo_out0[5]=0xaa; 
;;;357         	
;;;358         memo_out0[6]=crc_87(memo_out0,6);
;;;359    	memo_out0[7]=crc_95(memo_out0,6);
;;;360         usart_out_adr0(memo_out0,8); */
;;;361         snmp_trap_send("Main power is on",2,1,1);	
000568  2301              MOVS     r3,#1
00056a  461a              MOV      r2,r3
00056c  2102              MOVS     r1,#2
00056e  a0bc              ADR      r0,|L1.2144|
000570  f7fffffe          BL       snmp_trap_send
                  |L1.1396|
;;;362    	}
;;;363    avar_unet_hndl_end:
;;;364    	__nop();		
000574  bf00              NOP      
                  |L1.1398|
;;;365    }
000576  e8bd83f8          POP      {r3-r9,pc}
;;;366    
                          ENDP

                  avar_uout_hndl PROC
;;;368    //-----------------------------------------------
;;;369    void avar_uout_hndl(char in)
00057a  e92d43f8          PUSH     {r3-r9,lr}
;;;370    {
;;;371    
;;;372    char data[4];
;;;373    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;374    
;;;375    
;;;376    if(in==1)
;;;377    	{
;;;378    	//net_av=1;
;;;379    
;;;380    	//beep_init(0x01L,'O');
;;;381    	//a.av.bAN=1;
;;;382    
;;;383    
;;;384    	//beep_init(0x33333333,'A');
;;;385    
;;;386    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;387    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;388    		 
;;;389    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;390    	event_ptr++;	
;;;391    	if(event_ptr>63)event_ptr=0;	
;;;392    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;393    	
;;;394        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;395    	if(event_cnt!=63)event_cnt=event_ptr;
;;;396    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;397    	
;;;398    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;399    	
;;;400    	data[0]='Q';
;;;401    	data[1]=0;
;;;402    	data[2]='A';
;;;403    	data[3]=0;
;;;404    	lc640_write_long_ptr(lc640_adr,data);
;;;405    
;;;406    	data[0]=0;//*((char*)&Unet_store);
;;;407    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;408    	data[2]=0;
;;;409    	data[3]=0;
;;;410    	lc640_write_long_ptr(lc640_adr+4,data);
;;;411    
;;;412    	data[0]=LPC_RTC->YEAR;
00057e  4fbd              LDR      r7,|L1.2164|
000580  49bd              LDR      r1,|L1.2168|
000582  f44f6560          MOV      r5,#0xe00             ;389
000586  f04f0800          MOV      r8,#0                 ;391
00058a  f44f6980          MOV      r9,#0x400             ;398
00058e  2801              CMP      r0,#1                 ;376
000590  d002              BEQ      |L1.1432|
;;;413    	data[1]=LPC_RTC->MONTH;
;;;414    	data[2]=LPC_RTC->DOM;
;;;415    	data[3]=0;
;;;416    	lc640_write_long_ptr(lc640_adr+8,data);
;;;417    
;;;418    	data[0]=LPC_RTC->HOUR;
;;;419    	data[1]=LPC_RTC->MIN;
;;;420    	data[2]=LPC_RTC->SEC;
;;;421    	data[3]=0;
;;;422    	lc640_write_long_ptr(lc640_adr+12,data);
;;;423    	
;;;424    	data[0]='A';
;;;425    	data[1]='A';
;;;426    	data[2]='A';
;;;427    	data[3]='A';
;;;428    	lc640_write_long_ptr(lc640_adr+16,data);
;;;429    	
;;;430    	data[0]='A';
;;;431    	data[1]='A';
;;;432    	data[2]='A';
;;;433    	data[3]='A';
;;;434    	lc640_write_long_ptr(lc640_adr+20,data);
;;;435    	
;;;436    	data[0]='A';
;;;437    	data[1]='A';
;;;438    	data[2]='A';
;;;439    	data[3]='A';
;;;440    	lc640_write_long_ptr(lc640_adr+24,data);
;;;441    	
;;;442    	data[0]='A';
;;;443    	data[1]='A';
;;;444    	data[2]='A';
;;;445    	data[3]='A';
;;;446    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;447    	
;;;448    /*	memo_out0[0]=0x55;
;;;449         memo_out0[1]=0x00+2;
;;;450         memo_out0[2]=1;
;;;451         memo_out0[3]=0x0b;
;;;452         memo_out0[4]=0x55;
;;;453         memo_out0[5]=0x55; 
;;;454         	
;;;455         memo_out0[6]=crc_87(memo_out0,6);
;;;456    	memo_out0[7]=crc_95(memo_out0,6);
;;;457         usart_out_adr0(memo_out0,8); 
;;;458    	*/
;;;459    	//snmp_trap_send("Main power is off",2,1,0);
;;;460    	}
;;;461    
;;;462    else if(in==0)
000592  2800              CMP      r0,#0
000594  d07e              BEQ      |L1.1684|
000596  e126              B        |L1.2022|
                  |L1.1432|
000598  48b8              LDR      r0,|L1.2172|
00059a  4ab9              LDR      r2,|L1.2176|
00059c  f9b00000          LDRSH    r0,[r0,#0]            ;386  ; load_U
0005a0  f9b22000          LDRSH    r2,[r2,#0]            ;386  ; U_OUT_KONTR_MAX
0005a4  4290              CMP      r0,r2                 ;386
0005a6  dd02              BLE      |L1.1454|
0005a8  f04f0201          MOV      r2,#1                 ;386
0005ac  700a              STRB     r2,[r1,#0]            ;386
                  |L1.1454|
0005ae  4ab5              LDR      r2,|L1.2180|
0005b0  f9b22000          LDRSH    r2,[r2,#0]            ;387  ; U_OUT_KONTR_MIN
0005b4  4290              CMP      r0,r2                 ;387
0005b6  da02              BGE      |L1.1470|
0005b8  f04f0002          MOV      r0,#2                 ;387
0005bc  7008              STRB     r0,[r1,#0]            ;387
                  |L1.1470|
0005be  4628              MOV      r0,r5                 ;389
0005c0  f7fffffe          BL       lc640_read_int
0005c4  f1000001          ADD      r0,r0,#1              ;390
0005c8  4604              MOV      r4,r0                 ;390
0005ca  2c3f              CMP      r4,#0x3f              ;391
0005cc  d901              BLS      |L1.1490|
0005ce  f04f0400          MOV      r4,#0                 ;391
                  |L1.1490|
0005d2  b221              SXTH     r1,r4                 ;392
0005d4  4628              MOV      r0,r5                 ;392
0005d6  f7fffffe          BL       lc640_write_int
0005da  f6406602          MOV      r6,#0xe02             ;394
0005de  4630              MOV      r0,r6                 ;394
0005e0  f7fffffe          BL       lc640_read_int
0005e4  283f              CMP      r0,#0x3f              ;395
0005e6  d000              BEQ      |L1.1514|
0005e8  4620              MOV      r0,r4                 ;395
                  |L1.1514|
0005ea  b201              SXTH     r1,r0                 ;396
0005ec  4630              MOV      r0,r6                 ;396
0005ee  f7fffffe          BL       lc640_write_int
0005f2  4628              MOV      r0,r5                 ;398
0005f4  f7fffffe          BL       lc640_read_int
0005f8  eb091540          ADD      r5,r9,r0,LSL #5       ;398
0005fc  f04f0051          MOV      r0,#0x51              ;400
000600  f88d0000          STRB     r0,[sp,#0]            ;400
000604  f88d8001          STRB     r8,[sp,#1]            ;401
000608  f04f0441          MOV      r4,#0x41              ;402
00060c  f88d4002          STRB     r4,[sp,#2]            ;402
000610  f88d8003          STRB     r8,[sp,#3]            ;403
000614  4669              MOV      r1,sp                 ;404
000616  4628              MOV      r0,r5                 ;404
000618  f7fffffe          BL       lc640_write_long_ptr
00061c  f8cd8000          STR      r8,[sp,#0]            ;409
000620  4669              MOV      r1,sp                 ;410
000622  1d28              ADDS     r0,r5,#4              ;410
000624  f7fffffe          BL       lc640_write_long_ptr
000628  f1070720          ADD      r7,r7,#0x20           ;412
00062c  8bb8              LDRH     r0,[r7,#0x1c]         ;412
00062e  f88d0000          STRB     r0,[sp,#0]            ;412
000632  7e38              LDRB     r0,[r7,#0x18]         ;413
000634  f88d0001          STRB     r0,[sp,#1]            ;413
000638  7b38              LDRB     r0,[r7,#0xc]          ;414
00063a  f88d0002          STRB     r0,[sp,#2]            ;414
00063e  f88d8003          STRB     r8,[sp,#3]            ;415
000642  4669              MOV      r1,sp                 ;416
000644  f1050008          ADD      r0,r5,#8              ;416
000648  f7fffffe          BL       lc640_write_long_ptr
00064c  7a38              LDRB     r0,[r7,#8]            ;418
00064e  f88d0000          STRB     r0,[sp,#0]            ;418
000652  7938              LDRB     r0,[r7,#4]            ;419
000654  f88d0001          STRB     r0,[sp,#1]            ;419
000658  7838              LDRB     r0,[r7,#0]            ;420
00065a  f88d0002          STRB     r0,[sp,#2]            ;420
00065e  f88d8003          STRB     r8,[sp,#3]            ;421
000662  4669              MOV      r1,sp                 ;422
000664  f105000c          ADD      r0,r5,#0xc            ;422
000668  f7fffffe          BL       lc640_write_long_ptr
00066c  f88d4000          STRB     r4,[sp,#0]            ;424
000670  f88d4001          STRB     r4,[sp,#1]            ;425
000674  f88d4002          STRB     r4,[sp,#2]            ;426
000678  f88d4003          STRB     r4,[sp,#3]            ;427
00067c  4669              MOV      r1,sp                 ;428
00067e  f1050010          ADD      r0,r5,#0x10           ;428
000682  f7fffffe          BL       lc640_write_long_ptr
000686  f88d4000          STRB     r4,[sp,#0]            ;430
00068a  f88d4001          STRB     r4,[sp,#1]            ;431
00068e  f88d4002          STRB     r4,[sp,#2]            ;432
000692  e000              B        |L1.1686|
                  |L1.1684|
000694  e021              B        |L1.1754|
                  |L1.1686|
000696  f88d4003          STRB     r4,[sp,#3]            ;433
00069a  4669              MOV      r1,sp                 ;434
00069c  f1050014          ADD      r0,r5,#0x14           ;434
0006a0  f7fffffe          BL       lc640_write_long_ptr
0006a4  f88d4000          STRB     r4,[sp,#0]            ;436
0006a8  f88d4001          STRB     r4,[sp,#1]            ;437
0006ac  f88d4002          STRB     r4,[sp,#2]            ;438
0006b0  f88d4003          STRB     r4,[sp,#3]            ;439
0006b4  4669              MOV      r1,sp                 ;440
0006b6  f1050018          ADD      r0,r5,#0x18           ;440
0006ba  f7fffffe          BL       lc640_write_long_ptr
0006be  f88d4000          STRB     r4,[sp,#0]            ;442
0006c2  f88d4001          STRB     r4,[sp,#1]            ;443
0006c6  f88d4002          STRB     r4,[sp,#2]            ;444
0006ca  f88d4003          STRB     r4,[sp,#3]            ;445
0006ce  4669              MOV      r1,sp                 ;446
0006d0  f105001c          ADD      r0,r5,#0x1c           ;446
0006d4  f7fffffe          BL       lc640_write_long_ptr
0006d8  e085              B        |L1.2022|
                  |L1.1754|
;;;463    	{
;;;464    	uout_av=0;
0006da  f8818000          STRB     r8,[r1,#0]
;;;465    
;;;466      /*
;;;467    	SET_REG(C2GSR,3,24,8);
;;;468    	C2MOD=0;
;;;469    	bOUT_FREE2=1;*/
;;;470    
;;;471    
;;;472    	//C2MOD=0;
;;;473    
;;;474    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;475    
;;;476         //beep_init(0x02L,'O');
;;;477    	//a_.av.bAN=0;
;;;478    //	SET_REG(avar_stat,0,0,1);
;;;479    
;;;480    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;481    	
;;;482    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;483    
;;;484        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0006de  4628              MOV      r0,r5
0006e0  f7fffffe          BL       lc640_read_int
0006e4  4606              MOV      r6,r0
;;;485    	event_ptr_find=event_ptr;
0006e6  4634              MOV      r4,r6
                  |L1.1768|
;;;486    avar_uout_hndl_lbl1:
;;;487    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0006e8  eb091544          ADD      r5,r9,r4,LSL #5
;;;488    
;;;489         lc640_read_long_ptr(lc640_adr,data);
0006ec  4669              MOV      r1,sp
0006ee  4628              MOV      r0,r5
0006f0  f7fffffe          BL       lc640_read_long_ptr
;;;490         
;;;491         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
0006f4  f89d0000          LDRB     r0,[sp,#0]
0006f8  2851              CMP      r0,#0x51
0006fa  d106              BNE      |L1.1802|
0006fc  f89d0001          LDRB     r0,[sp,#1]
000700  b918              CBNZ     r0,|L1.1802|
000702  f89d0002          LDRB     r0,[sp,#2]
000706  2841              CMP      r0,#0x41
000708  d008              BEQ      |L1.1820|
                  |L1.1802|
;;;492         	{        
;;;493         	if(event_ptr_find)event_ptr_find--;
00070a  b114              CBZ      r4,|L1.1810|
00070c  f1a40401          SUB      r4,r4,#1
000710  e001              B        |L1.1814|
                  |L1.1810|
;;;494         	else event_ptr_find=63;
000712  f04f043f          MOV      r4,#0x3f
                  |L1.1814|
;;;495         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000716  42b4              CMP      r4,r6
000718  d1e6              BNE      |L1.1768|
00071a  e064              B        |L1.2022|
                  |L1.1820|
;;;496         	else goto avar_uout_hndl_lbl1;
;;;497         	}
;;;498         else 
;;;499         	{
;;;500         	lc640_read_long_ptr(lc640_adr+16,data);
00071c  4669              MOV      r1,sp
00071e  f1050010          ADD      r0,r5,#0x10
000722  f7fffffe          BL       lc640_read_long_ptr
;;;501         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000726  f89d0000          LDRB     r0,[sp,#0]
00072a  2841              CMP      r0,#0x41
00072c  d10b              BNE      |L1.1862|
00072e  f89d0001          LDRB     r0,[sp,#1]
000732  2841              CMP      r0,#0x41
000734  d107              BNE      |L1.1862|
000736  f89d0002          LDRB     r0,[sp,#2]
00073a  2841              CMP      r0,#0x41
00073c  d103              BNE      |L1.1862|
00073e  f89d0003          LDRB     r0,[sp,#3]
000742  2841              CMP      r0,#0x41
000744  d008              BEQ      |L1.1880|
                  |L1.1862|
;;;502         		{        
;;;503         		if(event_ptr_find)event_ptr_find--;
000746  b114              CBZ      r4,|L1.1870|
000748  f1a40401          SUB      r4,r4,#1
00074c  e001              B        |L1.1874|
                  |L1.1870|
;;;504             		else event_ptr_find=63;
00074e  f04f043f          MOV      r4,#0x3f
                  |L1.1874|
;;;505             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000752  42b4              CMP      r4,r6
000754  d1c8              BNE      |L1.1768|
000756  e046              B        |L1.2022|
                  |L1.1880|
;;;506         		else goto avar_uout_hndl_lbl1;
;;;507         		}
;;;508    
;;;509         	}	
;;;510    	
;;;511    	data[0]=LPC_RTC->YEAR;
000758  f1070720          ADD      r7,r7,#0x20
00075c  8bb8              LDRH     r0,[r7,#0x1c]
00075e  f88d0000          STRB     r0,[sp,#0]
;;;512    	data[1]=LPC_RTC->MONTH;
000762  7e38              LDRB     r0,[r7,#0x18]
000764  f88d0001          STRB     r0,[sp,#1]
;;;513    	data[2]=LPC_RTC->DOM;
000768  7b38              LDRB     r0,[r7,#0xc]
00076a  f88d0002          STRB     r0,[sp,#2]
;;;514    	data[3]=0;
00076e  f88d8003          STRB     r8,[sp,#3]
;;;515    	lc640_write_long_ptr(lc640_adr+16,data);
000772  4669              MOV      r1,sp
000774  f1050010          ADD      r0,r5,#0x10
000778  f7fffffe          BL       lc640_write_long_ptr
;;;516    
;;;517    	data[0]=LPC_RTC->HOUR;
00077c  7a38              LDRB     r0,[r7,#8]
00077e  f88d0000          STRB     r0,[sp,#0]
;;;518    	data[1]=LPC_RTC->MIN;
000782  7938              LDRB     r0,[r7,#4]
000784  f88d0001          STRB     r0,[sp,#1]
;;;519    	data[2]=LPC_RTC->SEC;
000788  7838              LDRB     r0,[r7,#0]
00078a  f88d0002          STRB     r0,[sp,#2]
;;;520    	data[3]=0;
00078e  f88d8003          STRB     r8,[sp,#3]
;;;521    	lc640_write_long_ptr(lc640_adr+20,data); 
000792  4669              MOV      r1,sp
000794  f1050014          ADD      r0,r5,#0x14
000798  f7fffffe          BL       lc640_write_long_ptr
;;;522    	
;;;523    	data[0]=*((char*)(&net_Ustore));
00079c  482f              LDR      r0,|L1.2140|
00079e  7801              LDRB     r1,[r0,#0]  ; net_Ustore
0007a0  f88d1000          STRB     r1,[sp,#0]
;;;524    	data[1]=*(((char*)(&net_Ustore))+1);
0007a4  7840              LDRB     r0,[r0,#1]  ; net_Ustore
0007a6  f88d0001          STRB     r0,[sp,#1]
;;;525    	data[2]='B';
0007aa  f04f0442          MOV      r4,#0x42
0007ae  f88d4002          STRB     r4,[sp,#2]
;;;526    	data[3]='B';
0007b2  f88d4003          STRB     r4,[sp,#3]
;;;527    	lc640_write_long_ptr(lc640_adr+24,data);
0007b6  4669              MOV      r1,sp
0007b8  f1050018          ADD      r0,r5,#0x18
0007bc  f7fffffe          BL       lc640_write_long_ptr
;;;528    	
;;;529    	data[0]='B';
0007c0  f88d4000          STRB     r4,[sp,#0]
;;;530    	data[1]='B';
0007c4  f88d4001          STRB     r4,[sp,#1]
;;;531    	data[2]='B';
0007c8  f88d4002          STRB     r4,[sp,#2]
;;;532    	data[3]='B';
0007cc  f88d4003          STRB     r4,[sp,#3]
;;;533    	lc640_write_long_ptr(lc640_adr+28,data);	
0007d0  4669              MOV      r1,sp
0007d2  f105001c          ADD      r0,r5,#0x1c
0007d6  f7fffffe          BL       lc640_write_long_ptr
;;;534    	
;;;535    /*	memo_out0[0]=0x55;
;;;536         memo_out0[1]=0x00+2;
;;;537         memo_out0[2]=1;
;;;538         memo_out0[3]=0x0b;
;;;539         memo_out0[4]=0xaa;
;;;540         memo_out0[5]=0xaa; 
;;;541         	
;;;542         memo_out0[6]=crc_87(memo_out0,6);
;;;543    	memo_out0[7]=crc_95(memo_out0,6);
;;;544         usart_out_adr0(memo_out0,8); */
;;;545         snmp_trap_send("Main power is on",2,1,1);	
0007da  2301              MOVS     r3,#1
0007dc  461a              MOV      r2,r3
0007de  2102              MOVS     r1,#2
0007e0  a01f              ADR      r0,|L1.2144|
0007e2  f7fffffe          BL       snmp_trap_send
                  |L1.2022|
;;;546    	}
;;;547    avar_unet_hndl_end:
;;;548    	__nop();		
0007e6  bf00              NOP      
;;;549    }
0007e8  e6c5              B        |L1.1398|
;;;550    
                          ENDP

                  avar_bps_hndl PROC
;;;551    //-----------------------------------------------
;;;552    void avar_bps_hndl(char dev, char v, char in)
0007ea  e92d4ff8          PUSH     {r3-r11,lr}
;;;553    {
0007ee  4606              MOV      r6,r0
0007f0  460c              MOV      r4,r1
;;;554    char data[4];
;;;555    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;556    char avar_simbol;
;;;557    
;;;558    avar_simbol='T';
0007f2  f04f0754          MOV      r7,#0x54
;;;559    if(v==0)avar_simbol='T';
0007f6  b174              CBZ      r4,|L1.2070|
;;;560    else if(v==1)avar_simbol='U';
0007f8  2c01              CMP      r4,#1
0007fa  d004              BEQ      |L1.2054|
;;;561    else if(v==2)avar_simbol='u';
0007fc  2c02              CMP      r4,#2
0007fe  d005              BEQ      |L1.2060|
;;;562    else if(v==3)avar_simbol='L';
000800  2c03              CMP      r4,#3
000802  d006              BEQ      |L1.2066|
000804  e007              B        |L1.2070|
                  |L1.2054|
000806  f04f0755          MOV      r7,#0x55              ;560
00080a  e004              B        |L1.2070|
                  |L1.2060|
00080c  f04f0775          MOV      r7,#0x75              ;561
000810  e001              B        |L1.2070|
                  |L1.2066|
000812  f04f074c          MOV      r7,#0x4c
                  |L1.2070|
;;;563    
;;;564    if(in==1)
;;;565    	{
;;;566    	//av_src[bps]=1;
;;;567    
;;;568    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;569    //	SET_REG(avar_stat,1,3+dev,1);
;;;570    	
;;;571    	if(v==0)bps[dev]._av|=(1<<0);
000816  491c              LDR      r1,|L1.2184|
000818  ebc600c6          RSB      r0,r6,r6,LSL #3
;;;572    	else if(v==1) bps[dev]._av|=(1<<1);
;;;573    	else if(v==2) bps[dev]._av|=(1<<2);
;;;574    	else if(v==3) bps[dev]._av|=(1<<3);
;;;575    
;;;576    	bps[dev]._last_avar=v;
;;;577    
;;;578    	//beep_init(0x33333333,'A');
;;;579    
;;;580    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;581    	event_ptr++;	
;;;582    	if(event_ptr>63)event_ptr=0;	
;;;583    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;584    	
;;;585         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;586    	if(event_cnt!=63)event_cnt=event_ptr;
;;;587    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;588    	
;;;589    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;590    	
;;;591    	data[0]='S';
;;;592    	data[1]=dev; 
;;;593    	data[2]=avar_simbol;
;;;594    	data[3]=0;
;;;595    	lc640_write_long_ptr(lc640_adr,data);
;;;596    
;;;597    	data[0]=0;
;;;598    	data[1]=0;
;;;599    	data[2]=0;
;;;600    	data[3]=0;
;;;601    	lc640_write_long_ptr(lc640_adr+4,data);
;;;602    
;;;603    	data[0]=LPC_RTC->YEAR;
00081c  f8df8054          LDR      r8,|L1.2164|
000820  eb000040          ADD      r0,r0,r0,LSL #1       ;571
000824  f04f0900          MOV      r9,#0                 ;553
000828  f44f6a60          MOV      r10,#0xe00            ;580
00082c  f44f6580          MOV      r5,#0x400             ;589
000830  eb010080          ADD      r0,r1,r0,LSL #2       ;571
000834  2a01              CMP      r2,#1                 ;564
000836  d029              BEQ      |L1.2188|
;;;604    	data[1]=LPC_RTC->MONTH;
;;;605    	data[2]=LPC_RTC->DOM;
;;;606    	data[3]=0;
;;;607    	lc640_write_long_ptr(lc640_adr+8,data);
;;;608    
;;;609    	data[0]=LPC_RTC->HOUR;
;;;610    	data[1]=LPC_RTC->MIN;
;;;611    	data[2]=LPC_RTC->SEC;
;;;612    	data[3]=0;
;;;613    	lc640_write_long_ptr(lc640_adr+12,data);
;;;614    	
;;;615    	data[0]='A';
;;;616    	data[1]='A';
;;;617    	data[2]='A';
;;;618    	data[3]='A';
;;;619    	lc640_write_long_ptr(lc640_adr+16,data);
;;;620    	
;;;621    	data[0]='A';
;;;622    	data[1]='A';
;;;623    	data[2]='A';
;;;624    	data[3]='A';
;;;625    	lc640_write_long_ptr(lc640_adr+20,data);
;;;626    	
;;;627    	data[0]='A';
;;;628    	data[1]='A';
;;;629    	data[2]='A';
;;;630    	data[3]='A';
;;;631    	lc640_write_long_ptr(lc640_adr+24,data);
;;;632    	
;;;633    	data[0]='A';
;;;634    	data[1]='A';
;;;635    	data[2]='A';
;;;636    	data[3]='A';
;;;637    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;638    
;;;639    
;;;640    	if(dev==0)
;;;641    		{
;;;642    		if(v==0)
;;;643    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;644    		else if(v==1)
;;;645    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;646    		else if(v==2)
;;;647    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;648    		else if(v==3)
;;;649    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;650    		}
;;;651    	else if(dev==1)
;;;652    		{
;;;653    		if(v==0)
;;;654    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;655    		else if(v==1)
;;;656    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;657    		else if(v==2)
;;;658    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;659    		else if(v==3)
;;;660    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;661    		} 
;;;662    	else if(dev==2)
;;;663    		{
;;;664    		if(v==0)
;;;665    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;666    		else if(v==1)
;;;667    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;668    		else if(v==2)
;;;669    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;670    		else if(v==3)
;;;671    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;672    		} 	
;;;673    			
;;;674    	}
;;;675    
;;;676    else if(in==0)
000838  2a00              CMP      r2,#0
00083a  d07d              BEQ      |L1.2360|
00083c  e1eb              B        |L1.3094|
00083e  0000              DCW      0x0000
                  |L1.2112|
000840  4d61696e          DCB      "Main power is off",0
000844  20706f77
000848  65722069
00084c  73206f66
000850  6600    
000852  00                DCB      0
000853  00                DCB      0
                  |L1.2132|
                          DCD      ||.data||
                  |L1.2136|
                          DCD      AV_OFF_AVT
                  |L1.2140|
                          DCD      net_Ustore
                  |L1.2144|
000860  4d61696e          DCB      "Main power is on",0
000864  20706f77
000868  65722069
00086c  73206f6e
000870  00      
000871  00                DCB      0
000872  00                DCB      0
000873  00                DCB      0
                  |L1.2164|
                          DCD      0x40024000
                  |L1.2168|
                          DCD      uout_av
                  |L1.2172|
                          DCD      load_U
                  |L1.2176|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2180|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2184|
                          DCD      bps
                  |L1.2188|
00088c  b134              CBZ      r4,|L1.2204|
00088e  2c01              CMP      r4,#1                 ;572
000890  d009              BEQ      |L1.2214|
000892  2c02              CMP      r4,#2                 ;573
000894  d00c              BEQ      |L1.2224|
000896  2c03              CMP      r4,#3                 ;574
000898  d00f              BEQ      |L1.2234|
00089a  e012              B        |L1.2242|
                  |L1.2204|
00089c  7841              LDRB     r1,[r0,#1]            ;571
00089e  f0410101          ORR      r1,r1,#1              ;571
0008a2  7041              STRB     r1,[r0,#1]            ;571
0008a4  e00d              B        |L1.2242|
                  |L1.2214|
0008a6  7841              LDRB     r1,[r0,#1]            ;572
0008a8  f0410102          ORR      r1,r1,#2              ;572
0008ac  7041              STRB     r1,[r0,#1]            ;572
0008ae  e008              B        |L1.2242|
                  |L1.2224|
0008b0  7841              LDRB     r1,[r0,#1]            ;573
0008b2  f0410104          ORR      r1,r1,#4              ;573
0008b6  7041              STRB     r1,[r0,#1]            ;573
0008b8  e003              B        |L1.2242|
                  |L1.2234|
0008ba  7841              LDRB     r1,[r0,#1]            ;574
0008bc  f0410108          ORR      r1,r1,#8              ;574
0008c0  7041              STRB     r1,[r0,#1]            ;574
                  |L1.2242|
0008c2  f8804053          STRB     r4,[r0,#0x53]         ;576
0008c6  4650              MOV      r0,r10                ;580
0008c8  f7fffffe          BL       lc640_read_int
0008cc  f1000001          ADD      r0,r0,#1              ;581
0008d0  fa1ffb80          UXTH     r11,r0                ;581
0008d4  f1bb0f3f          CMP      r11,#0x3f             ;582
0008d8  d901              BLS      |L1.2270|
0008da  f04f0b00          MOV      r11,#0                ;582
                  |L1.2270|
0008de  fa0ff18b          SXTH     r1,r11                ;583
0008e2  4650              MOV      r0,r10                ;583
0008e4  f7fffffe          BL       lc640_write_int
0008e8  f6406002          MOV      r0,#0xe02             ;585
0008ec  f7fffffe          BL       lc640_read_int
0008f0  b280              UXTH     r0,r0                 ;585
0008f2  283f              CMP      r0,#0x3f              ;586
0008f4  d000              BEQ      |L1.2296|
0008f6  4658              MOV      r0,r11                ;586
                  |L1.2296|
0008f8  b201              SXTH     r1,r0                 ;587
0008fa  f6406002          MOV      r0,#0xe02             ;587
0008fe  f7fffffe          BL       lc640_write_int
000902  4650              MOV      r0,r10                ;589
000904  f7fffffe          BL       lc640_read_int
000908  eb051040          ADD      r0,r5,r0,LSL #5       ;589
00090c  b285              UXTH     r5,r0                 ;589
00090e  f04f0053          MOV      r0,#0x53              ;591
000912  f88d0000          STRB     r0,[sp,#0]            ;591
000916  f88d6001          STRB     r6,[sp,#1]            ;592
00091a  f88d7002          STRB     r7,[sp,#2]            ;593
00091e  f88d9003          STRB     r9,[sp,#3]            ;594
000922  4669              MOV      r1,sp                 ;595
000924  4628              MOV      r0,r5                 ;595
000926  f7fffffe          BL       lc640_write_long_ptr
00092a  f8cd9000          STR      r9,[sp,#0]            ;600
00092e  4669              MOV      r1,sp                 ;601
000930  1d28              ADDS     r0,r5,#4              ;601
000932  f7fffffe          BL       lc640_write_long_ptr
000936  e000              B        |L1.2362|
                  |L1.2360|
000938  e0cd              B        |L1.2774|
                  |L1.2362|
00093a  f8b8003c          LDRH     r0,[r8,#0x3c]         ;603
00093e  f88d0000          STRB     r0,[sp,#0]            ;603
000942  f8980038          LDRB     r0,[r8,#0x38]         ;604
000946  f88d0001          STRB     r0,[sp,#1]            ;604
00094a  f898002c          LDRB     r0,[r8,#0x2c]         ;605
00094e  f88d0002          STRB     r0,[sp,#2]            ;605
000952  f88d9003          STRB     r9,[sp,#3]            ;606
000956  4669              MOV      r1,sp                 ;607
000958  f1050008          ADD      r0,r5,#8              ;607
00095c  f7fffffe          BL       lc640_write_long_ptr
000960  f8980028          LDRB     r0,[r8,#0x28]         ;609
000964  f88d0000          STRB     r0,[sp,#0]            ;609
000968  f8980024          LDRB     r0,[r8,#0x24]         ;610
00096c  f88d0001          STRB     r0,[sp,#1]            ;610
000970  f8980020          LDRB     r0,[r8,#0x20]         ;611
000974  f88d0002          STRB     r0,[sp,#2]            ;611
000978  f88d9003          STRB     r9,[sp,#3]            ;612
00097c  4669              MOV      r1,sp                 ;613
00097e  f105000c          ADD      r0,r5,#0xc            ;613
000982  f7fffffe          BL       lc640_write_long_ptr
000986  f04f0741          MOV      r7,#0x41              ;615
00098a  f88d7000          STRB     r7,[sp,#0]            ;615
00098e  f88d7001          STRB     r7,[sp,#1]            ;616
000992  f88d7002          STRB     r7,[sp,#2]            ;617
000996  f88d7003          STRB     r7,[sp,#3]            ;618
00099a  4669              MOV      r1,sp                 ;619
00099c  f1050010          ADD      r0,r5,#0x10           ;619
0009a0  f7fffffe          BL       lc640_write_long_ptr
0009a4  f88d7000          STRB     r7,[sp,#0]            ;621
0009a8  f88d7001          STRB     r7,[sp,#1]            ;622
0009ac  f88d7002          STRB     r7,[sp,#2]            ;623
0009b0  f88d7003          STRB     r7,[sp,#3]            ;624
0009b4  4669              MOV      r1,sp                 ;625
0009b6  f1050014          ADD      r0,r5,#0x14           ;625
0009ba  f7fffffe          BL       lc640_write_long_ptr
0009be  f88d7000          STRB     r7,[sp,#0]            ;627
0009c2  f88d7001          STRB     r7,[sp,#1]            ;628
0009c6  f88d7002          STRB     r7,[sp,#2]            ;629
0009ca  f88d7003          STRB     r7,[sp,#3]            ;630
0009ce  4669              MOV      r1,sp                 ;631
0009d0  f1050018          ADD      r0,r5,#0x18           ;631
0009d4  f7fffffe          BL       lc640_write_long_ptr
0009d8  f88d7000          STRB     r7,[sp,#0]            ;633
0009dc  f88d7001          STRB     r7,[sp,#1]            ;634
0009e0  f88d7002          STRB     r7,[sp,#2]            ;635
0009e4  f88d7003          STRB     r7,[sp,#3]            ;636
0009e8  4669              MOV      r1,sp                 ;637
0009ea  f105001c          ADD      r0,r5,#0x1c           ;637
0009ee  f7fffffe          BL       lc640_write_long_ptr
0009f2  b126              CBZ      r6,|L1.2558|
0009f4  2e01              CMP      r6,#1                 ;651
0009f6  d026              BEQ      |L1.2630|
0009f8  2e02              CMP      r6,#2                 ;662
0009fa  d048              BEQ      |L1.2702|
0009fc  e10b              B        |L1.3094|
                  |L1.2558|
0009fe  b134              CBZ      r4,|L1.2574|
000a00  2c01              CMP      r4,#1                 ;644
000a02  d00b              BEQ      |L1.2588|
000a04  2c02              CMP      r4,#2                 ;646
000a06  d010              BEQ      |L1.2602|
000a08  2c03              CMP      r4,#3                 ;648
000a0a  d015              BEQ      |L1.2616|
000a0c  e103              B        |L1.3094|
                  |L1.2574|
000a0e  2300              MOVS     r3,#0                 ;643
000a10  2201              MOVS     r2,#1                 ;643
000a12  2104              MOVS     r1,#4                 ;643
000a14  a0d7              ADR      r0,|L1.3444|
000a16  f7fffffe          BL       snmp_trap_send
000a1a  e0fc              B        |L1.3094|
                  |L1.2588|
000a1c  2301              MOVS     r3,#1                 ;645
000a1e  461a              MOV      r2,r3                 ;645
000a20  2104              MOVS     r1,#4                 ;645
000a22  a0da              ADR      r0,|L1.3468|
000a24  f7fffffe          BL       snmp_trap_send
000a28  e0f5              B        |L1.3094|
                  |L1.2602|
000a2a  2302              MOVS     r3,#2                 ;647
000a2c  2201              MOVS     r2,#1                 ;647
000a2e  2104              MOVS     r1,#4                 ;647
000a30  a0dd              ADR      r0,|L1.3496|
000a32  f7fffffe          BL       snmp_trap_send
000a36  e0ee              B        |L1.3094|
                  |L1.2616|
000a38  2303              MOVS     r3,#3                 ;649
000a3a  2201              MOVS     r2,#1                 ;649
000a3c  2104              MOVS     r1,#4                 ;649
000a3e  a0e2              ADR      r0,|L1.3528|
000a40  f7fffffe          BL       snmp_trap_send
000a44  e0e7              B        |L1.3094|
                  |L1.2630|
000a46  b134              CBZ      r4,|L1.2646|
000a48  2c01              CMP      r4,#1                 ;655
000a4a  d00b              BEQ      |L1.2660|
000a4c  2c02              CMP      r4,#2                 ;657
000a4e  d010              BEQ      |L1.2674|
000a50  2c03              CMP      r4,#3                 ;659
000a52  d015              BEQ      |L1.2688|
000a54  e0df              B        |L1.3094|
                  |L1.2646|
000a56  2300              MOVS     r3,#0                 ;654
000a58  2202              MOVS     r2,#2                 ;654
000a5a  2104              MOVS     r1,#4                 ;654
000a5c  a0e2              ADR      r0,|L1.3560|
000a5e  f7fffffe          BL       snmp_trap_send
000a62  e0d8              B        |L1.3094|
                  |L1.2660|
000a64  2301              MOVS     r3,#1                 ;656
000a66  2202              MOVS     r2,#2                 ;656
000a68  2104              MOVS     r1,#4                 ;656
000a6a  a0e5              ADR      r0,|L1.3584|
000a6c  f7fffffe          BL       snmp_trap_send
000a70  e0d1              B        |L1.3094|
                  |L1.2674|
000a72  2302              MOVS     r3,#2                 ;658
000a74  461a              MOV      r2,r3                 ;658
000a76  2104              MOVS     r1,#4                 ;658
000a78  a0e8              ADR      r0,|L1.3612|
000a7a  f7fffffe          BL       snmp_trap_send
000a7e  e0ca              B        |L1.3094|
                  |L1.2688|
000a80  2303              MOVS     r3,#3                 ;660
000a82  2202              MOVS     r2,#2                 ;660
000a84  2104              MOVS     r1,#4                 ;660
000a86  a0ed              ADR      r0,|L1.3644|
000a88  f7fffffe          BL       snmp_trap_send
000a8c  e0c3              B        |L1.3094|
                  |L1.2702|
000a8e  b134              CBZ      r4,|L1.2718|
000a90  2c01              CMP      r4,#1                 ;666
000a92  d00b              BEQ      |L1.2732|
000a94  2c02              CMP      r4,#2                 ;668
000a96  d010              BEQ      |L1.2746|
000a98  2c03              CMP      r4,#3                 ;670
000a9a  d015              BEQ      |L1.2760|
000a9c  e0bb              B        |L1.3094|
                  |L1.2718|
000a9e  2300              MOVS     r3,#0                 ;665
000aa0  2203              MOVS     r2,#3                 ;665
000aa2  2104              MOVS     r1,#4                 ;665
000aa4  a0ed              ADR      r0,|L1.3676|
000aa6  f7fffffe          BL       snmp_trap_send
000aaa  e0b4              B        |L1.3094|
                  |L1.2732|
000aac  2301              MOVS     r3,#1                 ;667
000aae  2203              MOVS     r2,#3                 ;667
000ab0  2104              MOVS     r1,#4                 ;667
000ab2  a0f0              ADR      r0,|L1.3700|
000ab4  f7fffffe          BL       snmp_trap_send
000ab8  e0ad              B        |L1.3094|
                  |L1.2746|
000aba  2302              MOVS     r3,#2                 ;669
000abc  2203              MOVS     r2,#3                 ;669
000abe  2104              MOVS     r1,#4                 ;669
000ac0  a0f3              ADR      r0,|L1.3728|
000ac2  f7fffffe          BL       snmp_trap_send
000ac6  e0a6              B        |L1.3094|
                  |L1.2760|
000ac8  2303              MOVS     r3,#3                 ;671
000aca  461a              MOV      r2,r3                 ;671
000acc  2104              MOVS     r1,#4                 ;671
000ace  a0f8              ADR      r0,|L1.3760|
000ad0  f7fffffe          BL       snmp_trap_send
000ad4  e09f              B        |L1.3094|
                  |L1.2774|
;;;677    	{      
;;;678    //	av_bps[bps]=0;
;;;679    
;;;680    	//SET_REG(avar_stat,0,3+bps,1);
;;;681    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;682    
;;;683         if(v==0) bps[dev]._av&=(~(1<<0));
000ad6  b134              CBZ      r4,|L1.2790|
;;;684         else if(v==1) bps[dev]._av&=(~(1<<1));
000ad8  2c01              CMP      r4,#1
000ada  d009              BEQ      |L1.2800|
;;;685    	else if(v==2) bps[dev]._av&=(~(1<<2));
000adc  2c02              CMP      r4,#2
000ade  d00c              BEQ      |L1.2810|
;;;686    	else if(v==3) bps[dev]._av&=(~(1<<3));
000ae0  2c03              CMP      r4,#3
000ae2  d00f              BEQ      |L1.2820|
000ae4  e012              B        |L1.2828|
                  |L1.2790|
000ae6  7841              LDRB     r1,[r0,#1]            ;683
000ae8  f0210101          BIC      r1,r1,#1              ;683
000aec  7041              STRB     r1,[r0,#1]            ;683
000aee  e00d              B        |L1.2828|
                  |L1.2800|
000af0  7841              LDRB     r1,[r0,#1]            ;684
000af2  f0210102          BIC      r1,r1,#2              ;684
000af6  7041              STRB     r1,[r0,#1]            ;684
000af8  e008              B        |L1.2828|
                  |L1.2810|
000afa  7841              LDRB     r1,[r0,#1]            ;685
000afc  f0210104          BIC      r1,r1,#4              ;685
000b00  7041              STRB     r1,[r0,#1]            ;685
000b02  e003              B        |L1.2828|
                  |L1.2820|
000b04  7841              LDRB     r1,[r0,#1]
000b06  f0210108          BIC      r1,r1,#8
000b0a  7041              STRB     r1,[r0,#1]
                  |L1.2828|
;;;687         
;;;688    //	if((bps[dev]._av&0x0f==0))
;;;689    //	     {
;;;690    		//SET_REG(avar_stat,0,3+bps,1);
;;;691    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;692    //	     }
;;;693     
;;;694    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000b0c  4650              MOV      r0,r10
000b0e  f7fffffe          BL       lc640_read_int
000b12  fa1ffb80          UXTH     r11,r0
;;;695    	event_ptr_find=event_ptr;
000b16  465c              MOV      r4,r11
                  |L1.2840|
;;;696    	
;;;697    avar_src_hndl_lbl1: 
;;;698    
;;;699    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000b18  eb051044          ADD      r0,r5,r4,LSL #5
000b1c  fa1ffa80          UXTH     r10,r0
;;;700    
;;;701         lc640_read_long_ptr(lc640_adr,data);
000b20  4669              MOV      r1,sp
000b22  4650              MOV      r0,r10
000b24  f7fffffe          BL       lc640_read_long_ptr
;;;702         
;;;703         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000b28  f89d0000          LDRB     r0,[sp,#0]
000b2c  2853              CMP      r0,#0x53
000b2e  d107              BNE      |L1.2880|
000b30  f89d0001          LDRB     r0,[sp,#1]
000b34  42b0              CMP      r0,r6
000b36  d103              BNE      |L1.2880|
000b38  f89d0002          LDRB     r0,[sp,#2]
000b3c  42b8              CMP      r0,r7
000b3e  d009              BEQ      |L1.2900|
                  |L1.2880|
;;;704         	{        
;;;705         	if(event_ptr_find)event_ptr_find--;
000b40  b11c              CBZ      r4,|L1.2890|
000b42  f1a40401          SUB      r4,r4,#1
000b46  b2a4              UXTH     r4,r4
000b48  e001              B        |L1.2894|
                  |L1.2890|
;;;706         	else event_ptr_find=63;
000b4a  f04f043f          MOV      r4,#0x3f
                  |L1.2894|
;;;707         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000b4e  455c              CMP      r4,r11
000b50  d1e2              BNE      |L1.2840|
000b52  e060              B        |L1.3094|
                  |L1.2900|
;;;708         	else goto avar_src_hndl_lbl1;
;;;709         	}
;;;710         else 
;;;711         	{
;;;712         	lc640_read_long_ptr(lc640_adr+16,data);
000b54  4669              MOV      r1,sp
000b56  f10a0010          ADD      r0,r10,#0x10
000b5a  f7fffffe          BL       lc640_read_long_ptr
;;;713         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000b5e  f89d0000          LDRB     r0,[sp,#0]
000b62  2841              CMP      r0,#0x41
000b64  d10b              BNE      |L1.2942|
000b66  f89d0001          LDRB     r0,[sp,#1]
000b6a  2841              CMP      r0,#0x41
000b6c  d107              BNE      |L1.2942|
000b6e  f89d0002          LDRB     r0,[sp,#2]
000b72  2841              CMP      r0,#0x41
000b74  d103              BNE      |L1.2942|
000b76  f89d0003          LDRB     r0,[sp,#3]
000b7a  2841              CMP      r0,#0x41
000b7c  d009              BEQ      |L1.2962|
                  |L1.2942|
;;;714         		{        
;;;715         		if(event_ptr_find)event_ptr_find--;
000b7e  b11c              CBZ      r4,|L1.2952|
000b80  f1a40401          SUB      r4,r4,#1
000b84  b2a4              UXTH     r4,r4
000b86  e001              B        |L1.2956|
                  |L1.2952|
;;;716             		else event_ptr_find=63;
000b88  f04f043f          MOV      r4,#0x3f
                  |L1.2956|
;;;717             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000b8c  455c              CMP      r4,r11
000b8e  d1c3              BNE      |L1.2840|
000b90  e041              B        |L1.3094|
                  |L1.2962|
;;;718         		else goto avar_src_hndl_lbl1;
;;;719         		}
;;;720    
;;;721         	}	
;;;722    
;;;723    
;;;724    	
;;;725    	data[0]=LPC_RTC->YEAR;
000b92  f8b8003c          LDRH     r0,[r8,#0x3c]
000b96  f88d0000          STRB     r0,[sp,#0]
;;;726    	data[1]=LPC_RTC->MONTH;
000b9a  f8980038          LDRB     r0,[r8,#0x38]
000b9e  f88d0001          STRB     r0,[sp,#1]
;;;727    	data[2]=LPC_RTC->DOM;
000ba2  f898002c          LDRB     r0,[r8,#0x2c]
000ba6  f88d0002          STRB     r0,[sp,#2]
;;;728    	data[3]=0;
000baa  f88d9003          STRB     r9,[sp,#3]
;;;729    	lc640_write_long_ptr(lc640_adr+16,data);
000bae  4669              MOV      r1,sp
000bb0  f10a0010          ADD      r0,r10,#0x10
000bb4  f7fffffe          BL       lc640_write_long_ptr
;;;730    
;;;731    	data[0]=LPC_RTC->HOUR;
000bb8  f8980028          LDRB     r0,[r8,#0x28]
000bbc  f88d0000          STRB     r0,[sp,#0]
;;;732    	data[1]=LPC_RTC->MIN;
000bc0  f8980024          LDRB     r0,[r8,#0x24]
000bc4  f88d0001          STRB     r0,[sp,#1]
;;;733    	data[2]=LPC_RTC->SEC;
000bc8  f8980020          LDRB     r0,[r8,#0x20]
000bcc  f88d0002          STRB     r0,[sp,#2]
;;;734    	data[3]=0;
000bd0  f88d9003          STRB     r9,[sp,#3]
;;;735    	lc640_write_long_ptr(lc640_adr+20,data);
000bd4  4669              MOV      r1,sp
000bd6  f10a0014          ADD      r0,r10,#0x14
000bda  f7fffffe          BL       lc640_write_long_ptr
;;;736    	
;;;737    	data[0]='B';
000bde  f04f0442          MOV      r4,#0x42
000be2  f88d4000          STRB     r4,[sp,#0]
;;;738    	data[1]='B';
000be6  f88d4001          STRB     r4,[sp,#1]
;;;739    	data[2]='B';
000bea  f88d4002          STRB     r4,[sp,#2]
;;;740    	data[3]='B';
000bee  f88d4003          STRB     r4,[sp,#3]
;;;741    	lc640_write_long_ptr(lc640_adr+24,data);
000bf2  4669              MOV      r1,sp
000bf4  f10a0018          ADD      r0,r10,#0x18
000bf8  f7fffffe          BL       lc640_write_long_ptr
;;;742    	
;;;743    	data[0]='B';
000bfc  f88d4000          STRB     r4,[sp,#0]
;;;744    	data[1]='B';
000c00  f88d4001          STRB     r4,[sp,#1]
;;;745    	data[2]='B';
000c04  f88d4002          STRB     r4,[sp,#2]
;;;746    	data[3]='B';
000c08  f88d4003          STRB     r4,[sp,#3]
;;;747    	lc640_write_long_ptr(lc640_adr+28,data);
000c0c  4669              MOV      r1,sp
000c0e  f10a001c          ADD      r0,r10,#0x1c
000c12  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3094|
;;;748    	
;;;749    	}
;;;750    	
;;;751    avar_src_hndl_end:
;;;752    __nop();		
000c16  bf00              NOP      
                  |L1.3096|
;;;753    }
000c18  e8bd8ff8          POP      {r3-r11,pc}
;;;754    
                          ENDP

                  wrk_mem_hndl PROC
;;;755    //-----------------------------------------------
;;;756    void wrk_mem_hndl(char b)
000c1c  e92d41fc          PUSH     {r2-r8,lr}
;;;757    {
000c20  4606              MOV      r6,r0
;;;758    char data[4];
;;;759    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;760    
;;;761    signed short temp_temp;
;;;762    
;;;763    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000c22  eb060046          ADD      r0,r6,r6,LSL #1
000c26  eb001106          ADD      r1,r0,r6,LSL #4
000c2a  48a9              LDR      r0,|L1.3792|
000c2c  eb000481          ADD      r4,r0,r1,LSL #2
000c30  8be0              LDRH     r0,[r4,#0x1e]
000c32  2805              CMP      r0,#5
000c34  d37e              BCC      |L1.3380|
;;;764    
;;;765    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000c36  48a7              LDR      r0,|L1.3796|
000c38  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000c3a  f1000006          ADD      r0,r0,#6
000c3e  f0000007          AND      r0,r0,#7
000c42  eb040040          ADD      r0,r4,r0,LSL #1
000c46  8c00              LDRH     r0,[r0,#0x20]
000c48  9000              STR      r0,[sp,#0]
;;;766    
;;;767    
;;;768    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000c4a  f44f6760          MOV      r7,#0xe00
000c4e  4638              MOV      r0,r7
000c50  f7fffffe          BL       lc640_read_int
;;;769    event_ptr++;	
000c54  f1000001          ADD      r0,r0,#1
000c58  b285              UXTH     r5,r0
;;;770    if(event_ptr>63)event_ptr=0;	
000c5a  2d3f              CMP      r5,#0x3f
000c5c  d901              BLS      |L1.3170|
000c5e  f04f0500          MOV      r5,#0
                  |L1.3170|
;;;771    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000c62  b229              SXTH     r1,r5
000c64  4638              MOV      r0,r7
000c66  f7fffffe          BL       lc640_write_int
;;;772    	
;;;773    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000c6a  f6406802          MOV      r8,#0xe02
000c6e  4640              MOV      r0,r8
000c70  f7fffffe          BL       lc640_read_int
000c74  b280              UXTH     r0,r0
;;;774    if(event_cnt!=63)event_cnt=event_ptr;
000c76  283f              CMP      r0,#0x3f
000c78  d000              BEQ      |L1.3196|
000c7a  4628              MOV      r0,r5
                  |L1.3196|
;;;775    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000c7c  b201              SXTH     r1,r0
000c7e  4640              MOV      r0,r8
000c80  f7fffffe          BL       lc640_write_int
;;;776    	
;;;777    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000c84  4638              MOV      r0,r7
000c86  f7fffffe          BL       lc640_read_int
000c8a  f44f6180          MOV      r1,#0x400
000c8e  eb011040          ADD      r0,r1,r0,LSL #5
000c92  b285              UXTH     r5,r0
;;;778    	
;;;779    data[0]='B';
000c94  f04f0042          MOV      r0,#0x42
000c98  f88d0004          STRB     r0,[sp,#4]
;;;780    data[1]=b; 
000c9c  f88d6005          STRB     r6,[sp,#5]
;;;781    data[2]='W';
000ca0  f04f0057          MOV      r0,#0x57
000ca4  f88d0006          STRB     r0,[sp,#6]
;;;782    data[3]=0;
000ca8  f04f0600          MOV      r6,#0
000cac  f88d6007          STRB     r6,[sp,#7]
;;;783    
;;;784    lc640_write_long_ptr(lc640_adr,data);
000cb0  a901              ADD      r1,sp,#4
000cb2  4628              MOV      r0,r5
000cb4  f7fffffe          BL       lc640_write_long_ptr
;;;785    
;;;786    data[0]=*((char*)&bat[b]._Iintegr_);
000cb8  7fa0              LDRB     r0,[r4,#0x1e]
000cba  f88d0004          STRB     r0,[sp,#4]
;;;787    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000cbe  7fe0              LDRB     r0,[r4,#0x1f]
000cc0  f88d0005          STRB     r0,[sp,#5]
;;;788    data[2]=*((char*)&temp_temp);
000cc4  f89d0000          LDRB     r0,[sp,#0]
000cc8  f88d0006          STRB     r0,[sp,#6]
;;;789    data[3]=*(((char*)(&temp_temp))+1);
000ccc  f89d0001          LDRB     r0,[sp,#1]
000cd0  f88d0007          STRB     r0,[sp,#7]
;;;790    lc640_write_long_ptr(lc640_adr+4,data);
000cd4  a901              ADD      r1,sp,#4
000cd6  1d28              ADDS     r0,r5,#4
000cd8  f7fffffe          BL       lc640_write_long_ptr
;;;791    
;;;792    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000cdc  f1040134          ADD      r1,r4,#0x34
000ce0  f1050008          ADD      r0,r5,#8
000ce4  f7fffffe          BL       lc640_write_long_ptr
;;;793    	
;;;794    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000ce8  f1040138          ADD      r1,r4,#0x38
000cec  f105000c          ADD      r0,r5,#0xc
000cf0  f7fffffe          BL       lc640_write_long_ptr
;;;795    
;;;796    data[0]=LPC_RTC->YEAR;
000cf4  4c78              LDR      r4,|L1.3800|
000cf6  8ba0              LDRH     r0,[r4,#0x1c]
000cf8  f88d0004          STRB     r0,[sp,#4]
;;;797    data[1]=LPC_RTC->MONTH;
000cfc  7e20              LDRB     r0,[r4,#0x18]
000cfe  f88d0005          STRB     r0,[sp,#5]
;;;798    data[2]=LPC_RTC->DOM;
000d02  7b20              LDRB     r0,[r4,#0xc]
000d04  f88d0006          STRB     r0,[sp,#6]
;;;799    data[3]=0;
000d08  f88d6007          STRB     r6,[sp,#7]
;;;800    lc640_write_long_ptr(lc640_adr+16,data);
000d0c  a901              ADD      r1,sp,#4
000d0e  f1050010          ADD      r0,r5,#0x10
000d12  f7fffffe          BL       lc640_write_long_ptr
;;;801    
;;;802    data[0]=LPC_RTC->HOUR;
000d16  7a20              LDRB     r0,[r4,#8]
000d18  f88d0004          STRB     r0,[sp,#4]
;;;803    data[1]=LPC_RTC->MIN;
000d1c  7920              LDRB     r0,[r4,#4]
000d1e  f88d0005          STRB     r0,[sp,#5]
;;;804    data[2]=LPC_RTC->SEC;
000d22  7820              LDRB     r0,[r4,#0]
000d24  f88d0006          STRB     r0,[sp,#6]
;;;805    data[3]=0;
000d28  f88d6007          STRB     r6,[sp,#7]
;;;806    lc640_write_long_ptr(lc640_adr+20,data);
000d2c  a901              ADD      r1,sp,#4
000d2e  f1050014          ADD      r0,r5,#0x14
000d32  e000              B        |L1.3382|
                  |L1.3380|
000d34  e001              B        |L1.3386|
                  |L1.3382|
000d36  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3386|
;;;807    	
;;;808    
;;;809    
;;;810    	
;;;811    wrk_mem_hndl_end:	
;;;812    __nop();
000d3a  bf00              NOP      
;;;813    }  
000d3c  e8bd81fc          POP      {r2-r8,pc}
;;;814    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;816    //-----------------------------------------------
;;;817    void avar_bat_ips_hndl(char in)
000d40  e92d4ff8          PUSH     {r3-r11,lr}
;;;818    {
000d44  4602              MOV      r2,r0
;;;819    char data[4];
;;;820    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;821    
;;;822    if(in==1)
;;;823    	{
;;;824    	bat_ips._av|=1;
000d46  4865              LDR      r0,|L1.3804|
;;;825        	ips_bat_av_stat=1;
000d48  4c65              LDR      r4,|L1.3808|
;;;826    	ips_bat_av_vzvod=1;
000d4a  4b66              LDR      r3,|L1.3812|
;;;827    
;;;828    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;829    	event_ptr++;	
;;;830    	if(event_ptr>63)event_ptr=0;	
;;;831    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;832    	
;;;833         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;834    	if(event_cnt!=63)event_cnt=event_ptr;
;;;835    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;836    	
;;;837    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;838    	
;;;839    	data[0]='B';
;;;840    	data[1]=0;
;;;841    	data[2]='C';
;;;842    	data[3]=0;
;;;843    	lc640_write_long_ptr(lc640_adr,data);
;;;844    
;;;845    	data[0]=0;
;;;846    	data[1]=0;
;;;847    	data[2]=0;
;;;848    	data[3]=0;
;;;849    	lc640_write_long_ptr(lc640_adr+4,data);
;;;850    
;;;851    	data[0]=LPC_RTC->YEAR;
000d4c  f8df8198          LDR      r8,|L1.3816|
000d50  f890103d          LDRB     r1,[r0,#0x3d]         ;824
000d54  f04f0742          MOV      r7,#0x42              ;839
000d58  f44f6560          MOV      r5,#0xe00             ;828
000d5c  f04f0900          MOV      r9,#0                 ;830
000d60  f44f6a80          MOV      r10,#0x400            ;837
000d64  2a01              CMP      r2,#1                 ;822
000d66  d002              BEQ      |L1.3438|
;;;852    	data[1]=LPC_RTC->MONTH;
;;;853    	data[2]=LPC_RTC->DOM;
;;;854    	data[3]=0;
;;;855    	lc640_write_long_ptr(lc640_adr+8,data);
;;;856    
;;;857    	data[0]=LPC_RTC->HOUR;
;;;858    	data[1]=LPC_RTC->MIN;
;;;859    	data[2]=LPC_RTC->SEC;
;;;860    	data[3]=0;
;;;861    	lc640_write_long_ptr(lc640_adr+12,data);
;;;862    	
;;;863    	data[0]='A';
;;;864    	data[1]='A';
;;;865    	data[2]='A';
;;;866    	data[3]='A';
;;;867    	lc640_write_long_ptr(lc640_adr+16,data);
;;;868    	
;;;869    	data[0]='A';
;;;870    	data[1]='A';
;;;871    	data[2]='A';
;;;872    	data[3]='A';
;;;873    	lc640_write_long_ptr(lc640_adr+20,data);
;;;874    	
;;;875    	data[0]='A';
;;;876    	data[1]='A';
;;;877    	data[2]='A';
;;;878    	data[3]='A';
;;;879    	lc640_write_long_ptr(lc640_adr+24,data);
;;;880    	
;;;881    	data[0]='A';
;;;882    	data[1]='A';
;;;883    	data[2]='A';
;;;884    	data[3]='A';
;;;885    	lc640_write_long_ptr(lc640_adr+28,data);
;;;886    					
;;;887    	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;888    		
;;;889    	}
;;;890    
;;;891    else if(in==0)
000d68  2a00              CMP      r2,#0
000d6a  d001              BEQ      |L1.3440|
000d6c  e1e6              B        |L1.4412|
                  |L1.3438|
000d6e  e0bd              B        |L1.3820|
                  |L1.3440|
000d70  e15c              B        |L1.4140|
000d72  0000              DCW      0x0000
                  |L1.3444|
000d74  42505320          DCB      "BPS #1 Alarm, overheat",0
000d78  23312041
000d7c  6c61726d
000d80  2c206f76
000d84  65726865
000d88  617400  
000d8b  00                DCB      0
                  |L1.3468|
000d8c  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000d90  23312041
000d94  6c61726d
000d98  2c20766f
000d9c  6c746167
000da0  65206973
000da4  20757000
                  |L1.3496|
000da8  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000dac  23312041
000db0  6c61726d
000db4  2c20766f
000db8  6c746167
000dbc  65206973
000dc0  20646f77
000dc4  6e00    
000dc6  00                DCB      0
000dc7  00                DCB      0
                  |L1.3528|
000dc8  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000dcc  23312041
000dd0  6c61726d
000dd4  2c20636f
000dd8  6e6e6563
000ddc  74206973
000de0  206c6f73
000de4  7400    
000de6  00                DCB      0
000de7  00                DCB      0
                  |L1.3560|
000de8  42505320          DCB      "BPS #2 Alarm, overheat",0
000dec  23322041
000df0  6c61726d
000df4  2c206f76
000df8  65726865
000dfc  617400  
000dff  00                DCB      0
                  |L1.3584|
000e00  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000e04  23322041
000e08  6c61726d
000e0c  2c20766f
000e10  6c746167
000e14  65206973
000e18  20757000
                  |L1.3612|
000e1c  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000e20  23322041
000e24  6c61726d
000e28  2c20766f
000e2c  6c746167
000e30  65206973
000e34  20646f77
000e38  6e00    
000e3a  00                DCB      0
000e3b  00                DCB      0
                  |L1.3644|
000e3c  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000e40  23322041
000e44  6c61726d
000e48  2c20636f
000e4c  6e6e6563
000e50  74206973
000e54  206c6f73
000e58  7400    
000e5a  00                DCB      0
000e5b  00                DCB      0
                  |L1.3676|
000e5c  42505320          DCB      "BPS #3 Alarm, overheat",0
000e60  23332041
000e64  6c61726d
000e68  2c206f76
000e6c  65726865
000e70  617400  
000e73  00                DCB      0
                  |L1.3700|
000e74  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000e78  23332041
000e7c  6c61726d
000e80  2c20766f
000e84  6c746167
000e88  65206973
000e8c  20757000
                  |L1.3728|
000e90  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000e94  23332041
000e98  6c61726d
000e9c  2c20766f
000ea0  6c746167
000ea4  65206973
000ea8  20646f77
000eac  6e00    
000eae  00                DCB      0
000eaf  00                DCB      0
                  |L1.3760|
000eb0  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000eb4  23332041
000eb8  6c61726d
000ebc  2c20636f
000ec0  6e6e6563
000ec4  74206973
000ec8  206c6f73
000ecc  7400    
000ece  00                DCB      0
000ecf  00                DCB      0
                  |L1.3792|
                          DCD      bat
                  |L1.3796|
                          DCD      bat_u_old_cnt
                  |L1.3800|
                          DCD      0x40024020
                  |L1.3804|
                          DCD      bat_ips
                  |L1.3808|
                          DCD      ips_bat_av_stat
                  |L1.3812|
                          DCD      ips_bat_av_vzvod
                  |L1.3816|
                          DCD      0x40024000
                  |L1.3820|
000eec  f0410101          ORR      r1,r1,#1              ;824
000ef0  f880103d          STRB     r1,[r0,#0x3d]         ;824
000ef4  f04f0001          MOV      r0,#1                 ;825
000ef8  7020              STRB     r0,[r4,#0]            ;825
000efa  7018              STRB     r0,[r3,#0]            ;826
000efc  4628              MOV      r0,r5                 ;828
000efe  f7fffffe          BL       lc640_read_int
000f02  f1000001          ADD      r0,r0,#1              ;829
000f06  b284              UXTH     r4,r0                 ;829
000f08  2c3f              CMP      r4,#0x3f              ;830
000f0a  d901              BLS      |L1.3856|
000f0c  f04f0400          MOV      r4,#0                 ;830
                  |L1.3856|
000f10  b221              SXTH     r1,r4                 ;831
000f12  4628              MOV      r0,r5                 ;831
000f14  f7fffffe          BL       lc640_write_int
000f18  f6406602          MOV      r6,#0xe02             ;833
000f1c  4630              MOV      r0,r6                 ;833
000f1e  f7fffffe          BL       lc640_read_int
000f22  b281              UXTH     r1,r0                 ;833
000f24  293f              CMP      r1,#0x3f              ;834
000f26  d000              BEQ      |L1.3882|
000f28  4621              MOV      r1,r4                 ;834
                  |L1.3882|
000f2a  b209              SXTH     r1,r1                 ;835
000f2c  4630              MOV      r0,r6                 ;835
000f2e  f7fffffe          BL       lc640_write_int
000f32  4628              MOV      r0,r5                 ;837
000f34  f7fffffe          BL       lc640_read_int
000f38  eb0a1040          ADD      r0,r10,r0,LSL #5      ;837
000f3c  b284              UXTH     r4,r0                 ;837
000f3e  f88d7000          STRB     r7,[sp,#0]            ;839
000f42  f88d9001          STRB     r9,[sp,#1]            ;840
000f46  f04f0043          MOV      r0,#0x43              ;841
000f4a  f88d0002          STRB     r0,[sp,#2]            ;841
000f4e  f88d9003          STRB     r9,[sp,#3]            ;842
000f52  4669              MOV      r1,sp                 ;843
000f54  4620              MOV      r0,r4                 ;843
000f56  f7fffffe          BL       lc640_write_long_ptr
000f5a  f8cd9000          STR      r9,[sp,#0]            ;848
000f5e  4669              MOV      r1,sp                 ;849
000f60  1d20              ADDS     r0,r4,#4              ;849
000f62  f7fffffe          BL       lc640_write_long_ptr
000f66  f8b8003c          LDRH     r0,[r8,#0x3c]         ;851
000f6a  f88d0000          STRB     r0,[sp,#0]            ;851
000f6e  f8980038          LDRB     r0,[r8,#0x38]         ;852
000f72  f88d0001          STRB     r0,[sp,#1]            ;852
000f76  f898002c          LDRB     r0,[r8,#0x2c]         ;853
000f7a  f88d0002          STRB     r0,[sp,#2]            ;853
000f7e  f88d9003          STRB     r9,[sp,#3]            ;854
000f82  4669              MOV      r1,sp                 ;855
000f84  f1040008          ADD      r0,r4,#8              ;855
000f88  f7fffffe          BL       lc640_write_long_ptr
000f8c  f8980028          LDRB     r0,[r8,#0x28]         ;857
000f90  f88d0000          STRB     r0,[sp,#0]            ;857
000f94  f8980024          LDRB     r0,[r8,#0x24]         ;858
000f98  f88d0001          STRB     r0,[sp,#1]            ;858
000f9c  f8980020          LDRB     r0,[r8,#0x20]         ;859
000fa0  f88d0002          STRB     r0,[sp,#2]            ;859
000fa4  f88d9003          STRB     r9,[sp,#3]            ;860
000fa8  4669              MOV      r1,sp                 ;861
000faa  f104000c          ADD      r0,r4,#0xc            ;861
000fae  f7fffffe          BL       lc640_write_long_ptr
000fb2  f04f0541          MOV      r5,#0x41              ;863
000fb6  f88d5000          STRB     r5,[sp,#0]            ;863
000fba  f88d5001          STRB     r5,[sp,#1]            ;864
000fbe  f88d5002          STRB     r5,[sp,#2]            ;865
000fc2  f88d5003          STRB     r5,[sp,#3]            ;866
000fc6  4669              MOV      r1,sp                 ;867
000fc8  f1040010          ADD      r0,r4,#0x10           ;867
000fcc  f7fffffe          BL       lc640_write_long_ptr
000fd0  f88d5000          STRB     r5,[sp,#0]            ;869
000fd4  f88d5001          STRB     r5,[sp,#1]            ;870
000fd8  f88d5002          STRB     r5,[sp,#2]            ;871
000fdc  f88d5003          STRB     r5,[sp,#3]            ;872
000fe0  4669              MOV      r1,sp                 ;873
000fe2  f1040014          ADD      r0,r4,#0x14           ;873
000fe6  f7fffffe          BL       lc640_write_long_ptr
000fea  f88d5000          STRB     r5,[sp,#0]            ;875
000fee  f88d5001          STRB     r5,[sp,#1]            ;876
000ff2  f88d5002          STRB     r5,[sp,#2]            ;877
000ff6  f88d5003          STRB     r5,[sp,#3]            ;878
000ffa  4669              MOV      r1,sp                 ;879
000ffc  f1040018          ADD      r0,r4,#0x18           ;879
001000  f7fffffe          BL       lc640_write_long_ptr
001004  f88d5000          STRB     r5,[sp,#0]            ;881
001008  f88d5001          STRB     r5,[sp,#1]            ;882
00100c  f88d5002          STRB     r5,[sp,#2]            ;883
001010  f88d5003          STRB     r5,[sp,#3]            ;884
001014  4669              MOV      r1,sp                 ;885
001016  f104001c          ADD      r0,r4,#0x1c           ;885
00101a  f7fffffe          BL       lc640_write_long_ptr
00101e  2301              MOVS     r3,#1                 ;887
001020  461a              MOV      r2,r3                 ;887
001022  2105              MOVS     r1,#5                 ;887
001024  a0ff              ADR      r0,|L1.5156|
001026  f7fffffe          BL       snmp_trap_send
00102a  e087              B        |L1.4412|
                  |L1.4140|
;;;892    	{
;;;893    	bat_ips._av&=~1;
00102c  f0210101          BIC      r1,r1,#1
001030  f880103d          STRB     r1,[r0,#0x3d]
;;;894    	ips_bat_av_stat=0;
001034  f8849000          STRB     r9,[r4,#0]
;;;895    	ips_bat_av_vzvod=0;
001038  f8839000          STRB     r9,[r3,#0]
;;;896         
;;;897    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
00103c  4628              MOV      r0,r5
00103e  f7fffffe          BL       lc640_read_int
001042  b286              UXTH     r6,r0
;;;898    	event_ptr_find=event_ptr;
001044  4634              MOV      r4,r6
                  |L1.4166|
;;;899    	
;;;900    avar_bat_ips_hndl_lbl1: 
;;;901    
;;;902    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001046  eb0a1044          ADD      r0,r10,r4,LSL #5
00104a  b285              UXTH     r5,r0
;;;903    
;;;904         lc640_read_long_ptr(lc640_adr,data);
00104c  4669              MOV      r1,sp
00104e  4628              MOV      r0,r5
001050  f7fffffe          BL       lc640_read_long_ptr
;;;905         
;;;906         if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
001054  f89d0000          LDRB     r0,[sp,#0]
001058  2842              CMP      r0,#0x42
00105a  d106              BNE      |L1.4202|
00105c  f89d0001          LDRB     r0,[sp,#1]
001060  b918              CBNZ     r0,|L1.4202|
001062  f89d0002          LDRB     r0,[sp,#2]
001066  2843              CMP      r0,#0x43
001068  d009              BEQ      |L1.4222|
                  |L1.4202|
;;;907         	{        
;;;908         	if(event_ptr_find)event_ptr_find--;
00106a  b11c              CBZ      r4,|L1.4212|
00106c  f1a40401          SUB      r4,r4,#1
001070  b2a4              UXTH     r4,r4
001072  e001              B        |L1.4216|
                  |L1.4212|
;;;909         	else event_ptr_find=63;
001074  f04f043f          MOV      r4,#0x3f
                  |L1.4216|
;;;910         	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001078  42b4              CMP      r4,r6
00107a  d1e4              BNE      |L1.4166|
00107c  e05e              B        |L1.4412|
                  |L1.4222|
;;;911         	else goto avar_bat_ips_hndl_lbl1;
;;;912         	}
;;;913         else 
;;;914         	{
;;;915         	lc640_read_long_ptr(lc640_adr+16,data);
00107e  4669              MOV      r1,sp
001080  f1050010          ADD      r0,r5,#0x10
001084  f7fffffe          BL       lc640_read_long_ptr
;;;916         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001088  f89d0000          LDRB     r0,[sp,#0]
00108c  2841              CMP      r0,#0x41
00108e  d10b              BNE      |L1.4264|
001090  f89d0001          LDRB     r0,[sp,#1]
001094  2841              CMP      r0,#0x41
001096  d107              BNE      |L1.4264|
001098  f89d0002          LDRB     r0,[sp,#2]
00109c  2841              CMP      r0,#0x41
00109e  d103              BNE      |L1.4264|
0010a0  f89d0003          LDRB     r0,[sp,#3]
0010a4  2841              CMP      r0,#0x41
0010a6  d009              BEQ      |L1.4284|
                  |L1.4264|
;;;917         		{        
;;;918         		if(event_ptr_find)event_ptr_find--;
0010a8  b11c              CBZ      r4,|L1.4274|
0010aa  f1a40401          SUB      r4,r4,#1
0010ae  b2a4              UXTH     r4,r4
0010b0  e001              B        |L1.4278|
                  |L1.4274|
;;;919             		else event_ptr_find=63;
0010b2  f04f043f          MOV      r4,#0x3f
                  |L1.4278|
;;;920             	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
0010b6  42b4              CMP      r4,r6
0010b8  d1c5              BNE      |L1.4166|
0010ba  e03f              B        |L1.4412|
                  |L1.4284|
;;;921         		else goto avar_bat_ips_hndl_lbl1;
;;;922         		}
;;;923    
;;;924         	}
;;;925         		
;;;926    	data[0]=LPC_RTC->YEAR;
0010bc  f8b8003c          LDRH     r0,[r8,#0x3c]
0010c0  f88d0000          STRB     r0,[sp,#0]
;;;927    	data[1]=LPC_RTC->MONTH;
0010c4  f8980038          LDRB     r0,[r8,#0x38]
0010c8  f88d0001          STRB     r0,[sp,#1]
;;;928    	data[2]=LPC_RTC->DOM;
0010cc  f898002c          LDRB     r0,[r8,#0x2c]
0010d0  f88d0002          STRB     r0,[sp,#2]
;;;929    	data[3]=0;
0010d4  f88d9003          STRB     r9,[sp,#3]
;;;930    	lc640_write_long_ptr(lc640_adr+16,data);
0010d8  4669              MOV      r1,sp
0010da  f1050010          ADD      r0,r5,#0x10
0010de  f7fffffe          BL       lc640_write_long_ptr
;;;931    
;;;932    	data[0]=LPC_RTC->HOUR;
0010e2  f8980028          LDRB     r0,[r8,#0x28]
0010e6  f88d0000          STRB     r0,[sp,#0]
;;;933    	data[1]=LPC_RTC->MIN;
0010ea  f8980024          LDRB     r0,[r8,#0x24]
0010ee  f88d0001          STRB     r0,[sp,#1]
;;;934    	data[2]=LPC_RTC->SEC;
0010f2  f8980020          LDRB     r0,[r8,#0x20]
0010f6  f88d0002          STRB     r0,[sp,#2]
;;;935    	data[3]=0;
0010fa  f88d9003          STRB     r9,[sp,#3]
;;;936    	lc640_write_long_ptr(lc640_adr+20,data);
0010fe  4669              MOV      r1,sp
001100  f1050014          ADD      r0,r5,#0x14
001104  f7fffffe          BL       lc640_write_long_ptr
;;;937    	
;;;938    	data[0]='B';
001108  f88d7000          STRB     r7,[sp,#0]
;;;939    	data[1]='B';
00110c  f88d7001          STRB     r7,[sp,#1]
;;;940    	data[2]='B';
001110  f88d7002          STRB     r7,[sp,#2]
;;;941    	data[3]='B';
001114  f88d7003          STRB     r7,[sp,#3]
;;;942    	lc640_write_long_ptr(lc640_adr+24,data);
001118  4669              MOV      r1,sp
00111a  f1050018          ADD      r0,r5,#0x18
00111e  f7fffffe          BL       lc640_write_long_ptr
;;;943    	
;;;944    	data[0]='B';
001122  f88d7000          STRB     r7,[sp,#0]
;;;945    	data[1]='B';
001126  f88d7001          STRB     r7,[sp,#1]
;;;946    	data[2]='B';
00112a  f88d7002          STRB     r7,[sp,#2]
;;;947    	data[3]='B';
00112e  f88d7003          STRB     r7,[sp,#3]
;;;948    	lc640_write_long_ptr(lc640_adr+28,data);
001132  4669              MOV      r1,sp
001134  f105001c          ADD      r0,r5,#0x1c
001138  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4412|
;;;949    	
;;;950    
;;;951    	
;;;952    	}
;;;953    	
;;;954    avar_bat_ips_hndl_end:
;;;955    __nop();		
00113c  bf00              NOP      
                  |L1.4414|
;;;956    }
00113e  e56b              B        |L1.3096|
;;;957    
                          ENDP

                  avar_bat_hndl PROC
;;;960    //-----------------------------------------------
;;;961    void avar_bat_hndl(char b, char in)
001140  e92d4ff8          PUSH     {r3-r11,lr}
;;;962    {
001144  4606              MOV      r6,r0
;;;963    char data[4];
;;;964    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;965    
;;;966    if(in==1)
;;;967    	{
;;;968    	bat[b]._av|=1;
001146  48bc              LDR      r0,|L1.5176|
001148  eb060246          ADD      r2,r6,r6,LSL #1
;;;969        
;;;970    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;971    	event_ptr++;	
;;;972    	if(event_ptr>63)event_ptr=0;	
;;;973    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;974    	
;;;975         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;976    	if(event_cnt!=63)event_cnt=event_ptr;
;;;977    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;978    	
;;;979    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;980    	
;;;981    	data[0]='B';
;;;982    	data[1]=b;
;;;983    	data[2]='C';
;;;984    	data[3]=0;
;;;985    	lc640_write_long_ptr(lc640_adr,data);
;;;986    
;;;987    	data[0]=0;
;;;988    	data[1]=0;
;;;989    	data[2]=0;
;;;990    	data[3]=0;
;;;991    	lc640_write_long_ptr(lc640_adr+4,data);
;;;992    
;;;993    	data[0]=LPC_RTC->YEAR;
00114c  f8df82ec          LDR      r8,|L1.5180|
001150  eb021206          ADD      r2,r2,r6,LSL #4       ;968
001154  f04f0a00          MOV      r10,#0                ;972
001158  f04f0942          MOV      r9,#0x42              ;981
00115c  f44f6560          MOV      r5,#0xe00             ;970
001160  f44f6b80          MOV      r11,#0x400            ;979
001164  eb000082          ADD      r0,r0,r2,LSL #2       ;968
001168  2901              CMP      r1,#1                 ;966
00116a  d002              BEQ      |L1.4466|
;;;994    	data[1]=LPC_RTC->MONTH;
;;;995    	data[2]=LPC_RTC->DOM;
;;;996    	data[3]=0;
;;;997    	lc640_write_long_ptr(lc640_adr+8,data);
;;;998    
;;;999    	data[0]=LPC_RTC->HOUR;
;;;1000   	data[1]=LPC_RTC->MIN;
;;;1001   	data[2]=LPC_RTC->SEC;
;;;1002   	data[3]=0;
;;;1003   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1004   	
;;;1005   	data[0]='A';
;;;1006   	data[1]='A';
;;;1007   	data[2]='A';
;;;1008   	data[3]='A';
;;;1009   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1010   	
;;;1011   	data[0]='A';
;;;1012   	data[1]='A';
;;;1013   	data[2]='A';
;;;1014   	data[3]='A';
;;;1015   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1016   	
;;;1017   	data[0]='A';
;;;1018   	data[1]='A';
;;;1019   	data[2]='A';
;;;1020   	data[3]='A';
;;;1021   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1022   	
;;;1023   	data[0]='A';
;;;1024   	data[1]='A';
;;;1025   	data[2]='A';
;;;1026   	data[3]='A';
;;;1027   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1028   					
;;;1029   	if(b==0)
;;;1030   		{
;;;1031   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1032   		}
;;;1033   	else if(b==1)
;;;1034   		{
;;;1035   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1036   		} 
;;;1037   			
;;;1038   	}
;;;1039   
;;;1040   else if(in==0)
00116c  2900              CMP      r1,#0
00116e  d07d              BEQ      |L1.4716|
001170  e12f              B        |L1.5074|
                  |L1.4466|
001172  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;968
001176  f0410101          ORR      r1,r1,#1              ;968
00117a  7001              STRB     r1,[r0,#0]            ;968
00117c  4628              MOV      r0,r5                 ;970
00117e  f7fffffe          BL       lc640_read_int
001182  f1000001          ADD      r0,r0,#1              ;971
001186  b284              UXTH     r4,r0                 ;971
001188  2c3f              CMP      r4,#0x3f              ;972
00118a  d901              BLS      |L1.4496|
00118c  f04f0400          MOV      r4,#0                 ;972
                  |L1.4496|
001190  b221              SXTH     r1,r4                 ;973
001192  4628              MOV      r0,r5                 ;973
001194  f7fffffe          BL       lc640_write_int
001198  f6406702          MOV      r7,#0xe02             ;975
00119c  4638              MOV      r0,r7                 ;975
00119e  f7fffffe          BL       lc640_read_int
0011a2  b280              UXTH     r0,r0                 ;975
0011a4  283f              CMP      r0,#0x3f              ;976
0011a6  d000              BEQ      |L1.4522|
0011a8  4620              MOV      r0,r4                 ;976
                  |L1.4522|
0011aa  b201              SXTH     r1,r0                 ;977
0011ac  4638              MOV      r0,r7                 ;977
0011ae  f7fffffe          BL       lc640_write_int
0011b2  4628              MOV      r0,r5                 ;979
0011b4  f7fffffe          BL       lc640_read_int
0011b8  eb0b1040          ADD      r0,r11,r0,LSL #5      ;979
0011bc  b284              UXTH     r4,r0                 ;979
0011be  f88d9000          STRB     r9,[sp,#0]            ;981
0011c2  f88d6001          STRB     r6,[sp,#1]            ;982
0011c6  f04f0043          MOV      r0,#0x43              ;983
0011ca  f88d0002          STRB     r0,[sp,#2]            ;983
0011ce  f88da003          STRB     r10,[sp,#3]           ;984
0011d2  4669              MOV      r1,sp                 ;985
0011d4  4620              MOV      r0,r4                 ;985
0011d6  f7fffffe          BL       lc640_write_long_ptr
0011da  f8cda000          STR      r10,[sp,#0]           ;990
0011de  4669              MOV      r1,sp                 ;991
0011e0  1d20              ADDS     r0,r4,#4              ;991
0011e2  f7fffffe          BL       lc640_write_long_ptr
0011e6  f8b8003c          LDRH     r0,[r8,#0x3c]         ;993
0011ea  f88d0000          STRB     r0,[sp,#0]            ;993
0011ee  f8980038          LDRB     r0,[r8,#0x38]         ;994
0011f2  f88d0001          STRB     r0,[sp,#1]            ;994
0011f6  f898002c          LDRB     r0,[r8,#0x2c]         ;995
0011fa  f88d0002          STRB     r0,[sp,#2]            ;995
0011fe  f88da003          STRB     r10,[sp,#3]           ;996
001202  4669              MOV      r1,sp                 ;997
001204  f1040008          ADD      r0,r4,#8              ;997
001208  f7fffffe          BL       lc640_write_long_ptr
00120c  f8980028          LDRB     r0,[r8,#0x28]         ;999
001210  f88d0000          STRB     r0,[sp,#0]            ;999
001214  f8980024          LDRB     r0,[r8,#0x24]         ;1000
001218  f88d0001          STRB     r0,[sp,#1]            ;1000
00121c  f8980020          LDRB     r0,[r8,#0x20]         ;1001
001220  f88d0002          STRB     r0,[sp,#2]            ;1001
001224  f88da003          STRB     r10,[sp,#3]           ;1002
001228  4669              MOV      r1,sp                 ;1003
00122a  f104000c          ADD      r0,r4,#0xc            ;1003
00122e  f7fffffe          BL       lc640_write_long_ptr
001232  f04f0541          MOV      r5,#0x41              ;1005
001236  f88d5000          STRB     r5,[sp,#0]            ;1005
00123a  f88d5001          STRB     r5,[sp,#1]            ;1006
00123e  f88d5002          STRB     r5,[sp,#2]            ;1007
001242  f88d5003          STRB     r5,[sp,#3]            ;1008
001246  4669              MOV      r1,sp                 ;1009
001248  f1040010          ADD      r0,r4,#0x10           ;1009
00124c  f7fffffe          BL       lc640_write_long_ptr
001250  f88d5000          STRB     r5,[sp,#0]            ;1011
001254  f88d5001          STRB     r5,[sp,#1]            ;1012
001258  f88d5002          STRB     r5,[sp,#2]            ;1013
00125c  f88d5003          STRB     r5,[sp,#3]            ;1014
001260  4669              MOV      r1,sp                 ;1015
001262  f1040014          ADD      r0,r4,#0x14           ;1015
001266  f7fffffe          BL       lc640_write_long_ptr
00126a  e000              B        |L1.4718|
                  |L1.4716|
00126c  e02b              B        |L1.4806|
                  |L1.4718|
00126e  f88d5000          STRB     r5,[sp,#0]            ;1017
001272  f88d5001          STRB     r5,[sp,#1]            ;1018
001276  f88d5002          STRB     r5,[sp,#2]            ;1019
00127a  f88d5003          STRB     r5,[sp,#3]            ;1020
00127e  4669              MOV      r1,sp                 ;1021
001280  f1040018          ADD      r0,r4,#0x18           ;1021
001284  f7fffffe          BL       lc640_write_long_ptr
001288  f88d5000          STRB     r5,[sp,#0]            ;1023
00128c  f88d5001          STRB     r5,[sp,#1]            ;1024
001290  f88d5002          STRB     r5,[sp,#2]            ;1025
001294  f88d5003          STRB     r5,[sp,#3]            ;1026
001298  4669              MOV      r1,sp                 ;1027
00129a  f104001c          ADD      r0,r4,#0x1c           ;1027
00129e  f7fffffe          BL       lc640_write_long_ptr
0012a2  b116              CBZ      r6,|L1.4778|
0012a4  2e01              CMP      r6,#1                 ;1033
0012a6  d007              BEQ      |L1.4792|
0012a8  e093              B        |L1.5074|
                  |L1.4778|
0012aa  2301              MOVS     r3,#1                 ;1031
0012ac  461a              MOV      r2,r3                 ;1031
0012ae  2105              MOVS     r1,#5                 ;1031
0012b0  a063              ADR      r0,|L1.5184|
0012b2  f7fffffe          BL       snmp_trap_send
0012b6  e08c              B        |L1.5074|
                  |L1.4792|
0012b8  2301              MOVS     r3,#1                 ;1035
0012ba  2202              MOVS     r2,#2                 ;1035
0012bc  2105              MOVS     r1,#5                 ;1035
0012be  a065              ADR      r0,|L1.5204|
0012c0  f7fffffe          BL       snmp_trap_send
0012c4  e085              B        |L1.5074|
                  |L1.4806|
;;;1041   	{
;;;1042   	bat[b]._av&=~1;
0012c6  f8101f3d          LDRB     r1,[r0,#0x3d]!
0012ca  f0210101          BIC      r1,r1,#1
0012ce  7001              STRB     r1,[r0,#0]
;;;1043   
;;;1044        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0012d0  4628              MOV      r0,r5
0012d2  f7fffffe          BL       lc640_read_int
0012d6  b287              UXTH     r7,r0
;;;1045   	event_ptr_find=event_ptr;
0012d8  463c              MOV      r4,r7
                  |L1.4826|
;;;1046   	
;;;1047   avar_bat_hndl_lbl1: 
;;;1048   
;;;1049   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0012da  eb0b1044          ADD      r0,r11,r4,LSL #5
0012de  b285              UXTH     r5,r0
;;;1050   
;;;1051        lc640_read_long_ptr(lc640_adr,data);
0012e0  4669              MOV      r1,sp
0012e2  4628              MOV      r0,r5
0012e4  f7fffffe          BL       lc640_read_long_ptr
;;;1052        
;;;1053        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
0012e8  f89d0000          LDRB     r0,[sp,#0]
0012ec  2842              CMP      r0,#0x42
0012ee  d107              BNE      |L1.4864|
0012f0  f89d0001          LDRB     r0,[sp,#1]
0012f4  42b0              CMP      r0,r6
0012f6  d103              BNE      |L1.4864|
0012f8  f89d0002          LDRB     r0,[sp,#2]
0012fc  2843              CMP      r0,#0x43
0012fe  d009              BEQ      |L1.4884|
                  |L1.4864|
;;;1054        	{        
;;;1055        	if(event_ptr_find)event_ptr_find--;
001300  b11c              CBZ      r4,|L1.4874|
001302  f1a40401          SUB      r4,r4,#1
001306  b2a4              UXTH     r4,r4
001308  e001              B        |L1.4878|
                  |L1.4874|
;;;1056        	else event_ptr_find=63;
00130a  f04f043f          MOV      r4,#0x3f
                  |L1.4878|
;;;1057        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
00130e  42bc              CMP      r4,r7
001310  d1e3              BNE      |L1.4826|
001312  e05e              B        |L1.5074|
                  |L1.4884|
;;;1058        	else goto avar_bat_hndl_lbl1;
;;;1059        	}
;;;1060        else 
;;;1061        	{
;;;1062        	lc640_read_long_ptr(lc640_adr+16,data);
001314  4669              MOV      r1,sp
001316  f1050010          ADD      r0,r5,#0x10
00131a  f7fffffe          BL       lc640_read_long_ptr
;;;1063        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00131e  f89d0000          LDRB     r0,[sp,#0]
001322  2841              CMP      r0,#0x41
001324  d10b              BNE      |L1.4926|
001326  f89d0001          LDRB     r0,[sp,#1]
00132a  2841              CMP      r0,#0x41
00132c  d107              BNE      |L1.4926|
00132e  f89d0002          LDRB     r0,[sp,#2]
001332  2841              CMP      r0,#0x41
001334  d103              BNE      |L1.4926|
001336  f89d0003          LDRB     r0,[sp,#3]
00133a  2841              CMP      r0,#0x41
00133c  d009              BEQ      |L1.4946|
                  |L1.4926|
;;;1064        		{        
;;;1065        		if(event_ptr_find)event_ptr_find--;
00133e  b11c              CBZ      r4,|L1.4936|
001340  f1a40401          SUB      r4,r4,#1
001344  b2a4              UXTH     r4,r4
001346  e001              B        |L1.4940|
                  |L1.4936|
;;;1066            		else event_ptr_find=63;
001348  f04f043f          MOV      r4,#0x3f
                  |L1.4940|
;;;1067            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
00134c  42bc              CMP      r4,r7
00134e  d1c4              BNE      |L1.4826|
001350  e03f              B        |L1.5074|
                  |L1.4946|
;;;1068        		else goto avar_bat_hndl_lbl1;
;;;1069        		}
;;;1070   
;;;1071        	}
;;;1072        		
;;;1073   	data[0]=LPC_RTC->YEAR;
001352  f8b8003c          LDRH     r0,[r8,#0x3c]
001356  f88d0000          STRB     r0,[sp,#0]
;;;1074   	data[1]=LPC_RTC->MONTH;
00135a  f8980038          LDRB     r0,[r8,#0x38]
00135e  f88d0001          STRB     r0,[sp,#1]
;;;1075   	data[2]=LPC_RTC->DOM;
001362  f898002c          LDRB     r0,[r8,#0x2c]
001366  f88d0002          STRB     r0,[sp,#2]
;;;1076   	data[3]=0;
00136a  f88da003          STRB     r10,[sp,#3]
;;;1077   	lc640_write_long_ptr(lc640_adr+16,data);
00136e  4669              MOV      r1,sp
001370  f1050010          ADD      r0,r5,#0x10
001374  f7fffffe          BL       lc640_write_long_ptr
;;;1078   
;;;1079   	data[0]=LPC_RTC->HOUR;
001378  f8980028          LDRB     r0,[r8,#0x28]
00137c  f88d0000          STRB     r0,[sp,#0]
;;;1080   	data[1]=LPC_RTC->MIN;
001380  f8980024          LDRB     r0,[r8,#0x24]
001384  f88d0001          STRB     r0,[sp,#1]
;;;1081   	data[2]=LPC_RTC->SEC;
001388  f8980020          LDRB     r0,[r8,#0x20]
00138c  f88d0002          STRB     r0,[sp,#2]
;;;1082   	data[3]=0;
001390  f88da003          STRB     r10,[sp,#3]
;;;1083   	lc640_write_long_ptr(lc640_adr+20,data);
001394  4669              MOV      r1,sp
001396  f1050014          ADD      r0,r5,#0x14
00139a  f7fffffe          BL       lc640_write_long_ptr
;;;1084   	
;;;1085   	data[0]='B';
00139e  f88d9000          STRB     r9,[sp,#0]
;;;1086   	data[1]='B';
0013a2  f88d9001          STRB     r9,[sp,#1]
;;;1087   	data[2]='B';
0013a6  f88d9002          STRB     r9,[sp,#2]
;;;1088   	data[3]='B';
0013aa  f88d9003          STRB     r9,[sp,#3]
;;;1089   	lc640_write_long_ptr(lc640_adr+24,data);
0013ae  4669              MOV      r1,sp
0013b0  f1050018          ADD      r0,r5,#0x18
0013b4  f7fffffe          BL       lc640_write_long_ptr
;;;1090   	
;;;1091   	data[0]='B';
0013b8  f88d9000          STRB     r9,[sp,#0]
;;;1092   	data[1]='B';
0013bc  f88d9001          STRB     r9,[sp,#1]
;;;1093   	data[2]='B';
0013c0  f88d9002          STRB     r9,[sp,#2]
;;;1094   	data[3]='B';
0013c4  f88d9003          STRB     r9,[sp,#3]
;;;1095   	lc640_write_long_ptr(lc640_adr+28,data);
0013c8  4669              MOV      r1,sp
0013ca  f105001c          ADD      r0,r5,#0x1c
0013ce  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5074|
;;;1096   	
;;;1097   
;;;1098   	
;;;1099   	}
;;;1100   	
;;;1101   avar_bat_hndl_end:
;;;1102   __nop();		
0013d2  bf00              NOP      
                  |L1.5076|
;;;1103   }
0013d4  e420              B        |L1.3096|
;;;1104   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1105   //-----------------------------------------------
;;;1106   void avar_bat_as_hndl(char b, char in)
0013d6  e92d4ff8          PUSH     {r3-r11,lr}
;;;1107   {
0013da  4606              MOV      r6,r0
;;;1108   char data[4];
;;;1109   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1110   
;;;1111   if(in==1)
;;;1112   	{
;;;1113   	bat[b]._av|=2;
;;;1114       
;;;1115   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1116   	event_ptr++;	
;;;1117   	if(event_ptr>63)event_ptr=0;	
;;;1118   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1119   	
;;;1120        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1121   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1122   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1123   	
;;;1124   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1125   	
;;;1126   	data[0]='B';
;;;1127   	data[1]=b;
;;;1128   	data[2]='S';
;;;1129   	data[3]=0;
;;;1130   	lc640_write_long_ptr(lc640_adr,data);
;;;1131   
;;;1132   	data[0]=0;
;;;1133   	data[1]=0;
;;;1134   	data[2]=0;
;;;1135   	data[3]=0;
;;;1136   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1137   
;;;1138   	data[0]=LPC_RTC->YEAR;
0013dc  f8df805c          LDR      r8,|L1.5180|
0013e0  f04f0a00          MOV      r10,#0                ;1117
0013e4  f04f0942          MOV      r9,#0x42              ;1126
0013e8  f44f6560          MOV      r5,#0xe00             ;1115
0013ec  f44f6b80          MOV      r11,#0x400            ;1124
0013f0  2901              CMP      r1,#1                 ;1111
0013f2  d002              BEQ      |L1.5114|
;;;1139   	data[1]=LPC_RTC->MONTH;
;;;1140   	data[2]=LPC_RTC->DOM;
;;;1141   	data[3]=0;
;;;1142   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1143   
;;;1144   	data[0]=LPC_RTC->HOUR;
;;;1145   	data[1]=LPC_RTC->MIN;
;;;1146   	data[2]=LPC_RTC->SEC;
;;;1147   	data[3]=0;
;;;1148   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1149   	
;;;1150   	data[0]='A';
;;;1151   	data[1]='A';
;;;1152   	data[2]='A';
;;;1153   	data[3]='A';
;;;1154   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1155   	
;;;1156   	data[0]='A';
;;;1157   	data[1]='A';
;;;1158   	data[2]='A';
;;;1159   	data[3]='A';
;;;1160   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1161   	
;;;1162   	data[0]='A';
;;;1163   	data[1]='A';
;;;1164   	data[2]='A';
;;;1165   	data[3]='A';
;;;1166   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1167   	
;;;1168   	data[0]='A';
;;;1169   	data[1]='A';
;;;1170   	data[2]='A';
;;;1171   	data[3]='A';
;;;1172   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1173   
;;;1174   	if(b==0)
;;;1175   		{
;;;1176   		snmp_trap_send("BAT #1 Alarm, assimetry",5,1,2);
;;;1177   		}
;;;1178   	else if(b==1)
;;;1179   		{
;;;1180   		snmp_trap_send("BAT #2 Alarm, assimetry",5,2,2);
;;;1181   		} 
;;;1182   	
;;;1183   	}
;;;1184   
;;;1185   else if(in==0)
0013f4  2900              CMP      r1,#0
0013f6  d07e              BEQ      |L1.5366|
0013f8  e154              B        |L1.5796|
                  |L1.5114|
0013fa  eb060046          ADD      r0,r6,r6,LSL #1       ;1113
0013fe  eb001106          ADD      r1,r0,r6,LSL #4       ;1113
001402  480d              LDR      r0,|L1.5176|
001404  eb000081          ADD      r0,r0,r1,LSL #2       ;1113
001408  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1113
00140c  f0410102          ORR      r1,r1,#2              ;1113
001410  7001              STRB     r1,[r0,#0]            ;1113
001412  4628              MOV      r0,r5                 ;1115
001414  f7fffffe          BL       lc640_read_int
001418  f1000001          ADD      r0,r0,#1              ;1116
00141c  b284              UXTH     r4,r0                 ;1116
00141e  2c3f              CMP      r4,#0x3f              ;1117
001420  d924              BLS      |L1.5228|
001422  e021              B        |L1.5224|
                  |L1.5156|
001424  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
001428  b9312041
00142c  6c61726d
001430  2c206c6f
001434  737400  
001437  00                DCB      0
                  |L1.5176|
                          DCD      bat
                  |L1.5180|
                          DCD      0x40024000
                  |L1.5184|
001440  42415420          DCB      "BAT #1 Alarm, lost",0
001444  23312041
001448  6c61726d
00144c  2c206c6f
001450  737400  
001453  00                DCB      0
                  |L1.5204|
001454  42415420          DCB      "BAT #2 Alarm, lost",0
001458  23322041
00145c  6c61726d
001460  2c206c6f
001464  737400  
001467  00                DCB      0
                  |L1.5224|
001468  f04f0400          MOV      r4,#0                 ;1117
                  |L1.5228|
00146c  b221              SXTH     r1,r4                 ;1118
00146e  4628              MOV      r0,r5                 ;1118
001470  f7fffffe          BL       lc640_write_int
001474  f6406702          MOV      r7,#0xe02             ;1120
001478  4638              MOV      r0,r7                 ;1120
00147a  f7fffffe          BL       lc640_read_int
00147e  b280              UXTH     r0,r0                 ;1120
001480  283f              CMP      r0,#0x3f              ;1121
001482  d000              BEQ      |L1.5254|
001484  4620              MOV      r0,r4                 ;1121
                  |L1.5254|
001486  b201              SXTH     r1,r0                 ;1122
001488  4638              MOV      r0,r7                 ;1122
00148a  f7fffffe          BL       lc640_write_int
00148e  4628              MOV      r0,r5                 ;1124
001490  f7fffffe          BL       lc640_read_int
001494  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1124
001498  b284              UXTH     r4,r0                 ;1124
00149a  f88d9000          STRB     r9,[sp,#0]            ;1126
00149e  f88d6001          STRB     r6,[sp,#1]            ;1127
0014a2  f04f0053          MOV      r0,#0x53              ;1128
0014a6  f88d0002          STRB     r0,[sp,#2]            ;1128
0014aa  f88da003          STRB     r10,[sp,#3]           ;1129
0014ae  4669              MOV      r1,sp                 ;1130
0014b0  4620              MOV      r0,r4                 ;1130
0014b2  f7fffffe          BL       lc640_write_long_ptr
0014b6  f8cda000          STR      r10,[sp,#0]           ;1135
0014ba  4669              MOV      r1,sp                 ;1136
0014bc  1d20              ADDS     r0,r4,#4              ;1136
0014be  f7fffffe          BL       lc640_write_long_ptr
0014c2  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1138
0014c6  f88d0000          STRB     r0,[sp,#0]            ;1138
0014ca  f8980038          LDRB     r0,[r8,#0x38]         ;1139
0014ce  f88d0001          STRB     r0,[sp,#1]            ;1139
0014d2  f898002c          LDRB     r0,[r8,#0x2c]         ;1140
0014d6  f88d0002          STRB     r0,[sp,#2]            ;1140
0014da  f88da003          STRB     r10,[sp,#3]           ;1141
0014de  4669              MOV      r1,sp                 ;1142
0014e0  f1040008          ADD      r0,r4,#8              ;1142
0014e4  f7fffffe          BL       lc640_write_long_ptr
0014e8  f8980028          LDRB     r0,[r8,#0x28]         ;1144
0014ec  f88d0000          STRB     r0,[sp,#0]            ;1144
0014f0  f8980024          LDRB     r0,[r8,#0x24]         ;1145
0014f4  e000              B        |L1.5368|
                  |L1.5366|
0014f6  e054              B        |L1.5538|
                  |L1.5368|
0014f8  f88d0001          STRB     r0,[sp,#1]            ;1145
0014fc  f8980020          LDRB     r0,[r8,#0x20]         ;1146
001500  f88d0002          STRB     r0,[sp,#2]            ;1146
001504  f88da003          STRB     r10,[sp,#3]           ;1147
001508  4669              MOV      r1,sp                 ;1148
00150a  f104000c          ADD      r0,r4,#0xc            ;1148
00150e  f7fffffe          BL       lc640_write_long_ptr
001512  f04f0541          MOV      r5,#0x41              ;1150
001516  f88d5000          STRB     r5,[sp,#0]            ;1150
00151a  f88d5001          STRB     r5,[sp,#1]            ;1151
00151e  f88d5002          STRB     r5,[sp,#2]            ;1152
001522  f88d5003          STRB     r5,[sp,#3]            ;1153
001526  4669              MOV      r1,sp                 ;1154
001528  f1040010          ADD      r0,r4,#0x10           ;1154
00152c  f7fffffe          BL       lc640_write_long_ptr
001530  f88d5000          STRB     r5,[sp,#0]            ;1156
001534  f88d5001          STRB     r5,[sp,#1]            ;1157
001538  f88d5002          STRB     r5,[sp,#2]            ;1158
00153c  f88d5003          STRB     r5,[sp,#3]            ;1159
001540  4669              MOV      r1,sp                 ;1160
001542  f1040014          ADD      r0,r4,#0x14           ;1160
001546  f7fffffe          BL       lc640_write_long_ptr
00154a  f88d5000          STRB     r5,[sp,#0]            ;1162
00154e  f88d5001          STRB     r5,[sp,#1]            ;1163
001552  f88d5002          STRB     r5,[sp,#2]            ;1164
001556  f88d5003          STRB     r5,[sp,#3]            ;1165
00155a  4669              MOV      r1,sp                 ;1166
00155c  f1040018          ADD      r0,r4,#0x18           ;1166
001560  f7fffffe          BL       lc640_write_long_ptr
001564  f88d5000          STRB     r5,[sp,#0]            ;1168
001568  f88d5001          STRB     r5,[sp,#1]            ;1169
00156c  f88d5002          STRB     r5,[sp,#2]            ;1170
001570  f88d5003          STRB     r5,[sp,#3]            ;1171
001574  4669              MOV      r1,sp                 ;1172
001576  f104001c          ADD      r0,r4,#0x1c           ;1172
00157a  f7fffffe          BL       lc640_write_long_ptr
00157e  b116              CBZ      r6,|L1.5510|
001580  2e01              CMP      r6,#1                 ;1178
001582  d007              BEQ      |L1.5524|
001584  e08e              B        |L1.5796|
                  |L1.5510|
001586  2302              MOVS     r3,#2                 ;1176
001588  2201              MOVS     r2,#1                 ;1176
00158a  2105              MOVS     r1,#5                 ;1176
00158c  a0fb              ADR      r0,|L1.6524|
00158e  f7fffffe          BL       snmp_trap_send
001592  e087              B        |L1.5796|
                  |L1.5524|
001594  2302              MOVS     r3,#2                 ;1180
001596  461a              MOV      r2,r3                 ;1180
001598  2105              MOVS     r1,#5                 ;1180
00159a  a0fe              ADR      r0,|L1.6548|
00159c  f7fffffe          BL       snmp_trap_send
0015a0  e080              B        |L1.5796|
                  |L1.5538|
;;;1186   	{
;;;1187   	//bat[b]._av=0;
;;;1188   
;;;1189        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0015a2  4628              MOV      r0,r5
0015a4  f7fffffe          BL       lc640_read_int
0015a8  b287              UXTH     r7,r0
;;;1190   	event_ptr_find=event_ptr;
0015aa  463c              MOV      r4,r7
                  |L1.5548|
;;;1191   	
;;;1192   avar_bat_as_hndl_lbl1: 
;;;1193   
;;;1194   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0015ac  eb0b1044          ADD      r0,r11,r4,LSL #5
0015b0  b285              UXTH     r5,r0
;;;1195   
;;;1196        lc640_read_long_ptr(lc640_adr,data);
0015b2  4669              MOV      r1,sp
0015b4  4628              MOV      r0,r5
0015b6  f7fffffe          BL       lc640_read_long_ptr
;;;1197        
;;;1198        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
0015ba  f89d0000          LDRB     r0,[sp,#0]
0015be  2842              CMP      r0,#0x42
0015c0  d107              BNE      |L1.5586|
0015c2  f89d0001          LDRB     r0,[sp,#1]
0015c6  42b0              CMP      r0,r6
0015c8  d103              BNE      |L1.5586|
0015ca  f89d0002          LDRB     r0,[sp,#2]
0015ce  2843              CMP      r0,#0x43
0015d0  d009              BEQ      |L1.5606|
                  |L1.5586|
;;;1199        	{        
;;;1200        	if(event_ptr_find)event_ptr_find--;
0015d2  b11c              CBZ      r4,|L1.5596|
0015d4  f1a40401          SUB      r4,r4,#1
0015d8  b2a4              UXTH     r4,r4
0015da  e001              B        |L1.5600|
                  |L1.5596|
;;;1201        	else event_ptr_find=63;
0015dc  f04f043f          MOV      r4,#0x3f
                  |L1.5600|
;;;1202        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
0015e0  42bc              CMP      r4,r7
0015e2  d1e3              BNE      |L1.5548|
0015e4  e05e              B        |L1.5796|
                  |L1.5606|
;;;1203        	else goto avar_bat_as_hndl_lbl1;
;;;1204        	}
;;;1205        else 
;;;1206        	{
;;;1207        	lc640_read_long_ptr(lc640_adr+16,data);
0015e6  4669              MOV      r1,sp
0015e8  f1050010          ADD      r0,r5,#0x10
0015ec  f7fffffe          BL       lc640_read_long_ptr
;;;1208        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0015f0  f89d0000          LDRB     r0,[sp,#0]
0015f4  2841              CMP      r0,#0x41
0015f6  d10b              BNE      |L1.5648|
0015f8  f89d0001          LDRB     r0,[sp,#1]
0015fc  2841              CMP      r0,#0x41
0015fe  d107              BNE      |L1.5648|
001600  f89d0002          LDRB     r0,[sp,#2]
001604  2841              CMP      r0,#0x41
001606  d103              BNE      |L1.5648|
001608  f89d0003          LDRB     r0,[sp,#3]
00160c  2841              CMP      r0,#0x41
00160e  d009              BEQ      |L1.5668|
                  |L1.5648|
;;;1209        		{        
;;;1210        		if(event_ptr_find)event_ptr_find--;
001610  b11c              CBZ      r4,|L1.5658|
001612  f1a40401          SUB      r4,r4,#1
001616  b2a4              UXTH     r4,r4
001618  e001              B        |L1.5662|
                  |L1.5658|
;;;1211            		else event_ptr_find=63;
00161a  f04f043f          MOV      r4,#0x3f
                  |L1.5662|
;;;1212            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
00161e  42bc              CMP      r4,r7
001620  d1c4              BNE      |L1.5548|
001622  e03f              B        |L1.5796|
                  |L1.5668|
;;;1213        		else goto avar_bat_as_hndl_lbl1;
;;;1214        		}
;;;1215   
;;;1216        	}
;;;1217        		
;;;1218   	data[0]=LPC_RTC->YEAR;
001624  f8b8003c          LDRH     r0,[r8,#0x3c]
001628  f88d0000          STRB     r0,[sp,#0]
;;;1219   	data[1]=LPC_RTC->MONTH;
00162c  f8980038          LDRB     r0,[r8,#0x38]
001630  f88d0001          STRB     r0,[sp,#1]
;;;1220   	data[2]=LPC_RTC->DOM;
001634  f898002c          LDRB     r0,[r8,#0x2c]
001638  f88d0002          STRB     r0,[sp,#2]
;;;1221   	data[3]=0;
00163c  f88da003          STRB     r10,[sp,#3]
;;;1222   	lc640_write_long_ptr(lc640_adr+16,data);
001640  4669              MOV      r1,sp
001642  f1050010          ADD      r0,r5,#0x10
001646  f7fffffe          BL       lc640_write_long_ptr
;;;1223   
;;;1224   	data[0]=LPC_RTC->HOUR;
00164a  f8980028          LDRB     r0,[r8,#0x28]
00164e  f88d0000          STRB     r0,[sp,#0]
;;;1225   	data[1]=LPC_RTC->MIN;
001652  f8980024          LDRB     r0,[r8,#0x24]
001656  f88d0001          STRB     r0,[sp,#1]
;;;1226   	data[2]=LPC_RTC->SEC;
00165a  f8980020          LDRB     r0,[r8,#0x20]
00165e  f88d0002          STRB     r0,[sp,#2]
;;;1227   	data[3]=0;
001662  f88da003          STRB     r10,[sp,#3]
;;;1228   	lc640_write_long_ptr(lc640_adr+20,data);
001666  4669              MOV      r1,sp
001668  f1050014          ADD      r0,r5,#0x14
00166c  f7fffffe          BL       lc640_write_long_ptr
;;;1229   	
;;;1230   	data[0]='B';
001670  f88d9000          STRB     r9,[sp,#0]
;;;1231   	data[1]='B';
001674  f88d9001          STRB     r9,[sp,#1]
;;;1232   	data[2]='B';
001678  f88d9002          STRB     r9,[sp,#2]
;;;1233   	data[3]='B';
00167c  f88d9003          STRB     r9,[sp,#3]
;;;1234   	lc640_write_long_ptr(lc640_adr+24,data);
001680  4669              MOV      r1,sp
001682  f1050018          ADD      r0,r5,#0x18
001686  f7fffffe          BL       lc640_write_long_ptr
;;;1235   	
;;;1236   	data[0]='B';
00168a  f88d9000          STRB     r9,[sp,#0]
;;;1237   	data[1]='B';
00168e  f88d9001          STRB     r9,[sp,#1]
;;;1238   	data[2]='B';
001692  f88d9002          STRB     r9,[sp,#2]
;;;1239   	data[3]='B';
001696  f88d9003          STRB     r9,[sp,#3]
;;;1240   	lc640_write_long_ptr(lc640_adr+28,data);
00169a  4669              MOV      r1,sp
00169c  f105001c          ADD      r0,r5,#0x1c
0016a0  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5796|
;;;1241   	
;;;1242   
;;;1243   	
;;;1244   	}
;;;1245   	
;;;1246   avar_bat_as_hndl_end:
;;;1247   __nop();		
0016a4  bf00              NOP      
;;;1248   }
0016a6  e54a              B        |L1.4414|
;;;1249   
                          ENDP

                  ke_mem_hndl PROC
;;;1251   //-----------------------------------------------
;;;1252   void ke_mem_hndl(char b,unsigned short in)
0016a8  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;1253   {
0016aa  b083              SUB      sp,sp,#0xc
0016ac  4605              MOV      r5,r0
;;;1254   char data[4];
;;;1255   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1256   //unsigned char temp,temp_;
;;;1257   //unsigned int tempUI;
;;;1258   //unsigned long tempUL; 
;;;1259   signed temp_temp;
;;;1260   
;;;1261   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
0016ae  eb050045          ADD      r0,r5,r5,LSL #1
0016b2  49be              LDR      r1,|L1.6572|
0016b4  eb001005          ADD      r0,r0,r5,LSL #4
0016b8  eb010180          ADD      r1,r1,r0,LSL #2
0016bc  48bc              LDR      r0,|L1.6576|
0016be  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
0016c2  f1000001          ADD      r0,r0,#1
0016c6  eb010040          ADD      r0,r1,r0,LSL #1
0016ca  f9b00020          LDRSH    r0,[r0,#0x20]
0016ce  9001              STR      r0,[sp,#4]
;;;1262   
;;;1263   event_ptr=lc640_read_int(PTR_EVENT_LOG);
0016d0  f44f6660          MOV      r6,#0xe00
0016d4  4630              MOV      r0,r6
0016d6  f7fffffe          BL       lc640_read_int
;;;1264   event_ptr++;	
0016da  f1000001          ADD      r0,r0,#1
0016de  4604              MOV      r4,r0
;;;1265   if(event_ptr>63)event_ptr=0;	
0016e0  2c3f              CMP      r4,#0x3f
0016e2  d901              BLS      |L1.5864|
0016e4  f04f0400          MOV      r4,#0
                  |L1.5864|
;;;1266   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
0016e8  b221              SXTH     r1,r4
0016ea  4630              MOV      r0,r6
0016ec  f7fffffe          BL       lc640_write_int
;;;1267   	
;;;1268   event_cnt=lc640_read_int(CNT_EVENT_LOG);
0016f0  f6406702          MOV      r7,#0xe02
0016f4  4638              MOV      r0,r7
0016f6  f7fffffe          BL       lc640_read_int
;;;1269   if(event_cnt!=63)event_cnt=event_ptr;
0016fa  283f              CMP      r0,#0x3f
0016fc  d000              BEQ      |L1.5888|
0016fe  4620              MOV      r0,r4
                  |L1.5888|
;;;1270   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
001700  b201              SXTH     r1,r0
001702  4638              MOV      r0,r7
001704  f7fffffe          BL       lc640_write_int
;;;1271   	
;;;1272   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
001708  4630              MOV      r0,r6
00170a  f7fffffe          BL       lc640_read_int
00170e  f44f6180          MOV      r1,#0x400
001712  eb011440          ADD      r4,r1,r0,LSL #5
;;;1273   	
;;;1274   data[0]='B';
001716  f04f0042          MOV      r0,#0x42
00171a  f88d0008          STRB     r0,[sp,#8]
;;;1275   data[1]=b; 
00171e  f88d5009          STRB     r5,[sp,#9]
;;;1276   data[2]='K';
001722  f04f004b          MOV      r0,#0x4b
001726  f88d000a          STRB     r0,[sp,#0xa]
;;;1277   data[3]=0;
00172a  f04f0600          MOV      r6,#0
00172e  f88d600b          STRB     r6,[sp,#0xb]
;;;1278   
;;;1279   lc640_write_long_ptr(lc640_adr,data);
001732  a902              ADD      r1,sp,#8
001734  4620              MOV      r0,r4
001736  f7fffffe          BL       lc640_write_long_ptr
;;;1280   
;;;1281   data[0]=*((char*)&in);
00173a  f89d0010          LDRB     r0,[sp,#0x10]
00173e  f88d0008          STRB     r0,[sp,#8]
;;;1282   data[1]=*(((char*)(&in))+1);
001742  f89d0011          LDRB     r0,[sp,#0x11]
001746  f88d0009          STRB     r0,[sp,#9]
;;;1283   data[2]=*((char*)&temp_temp);
00174a  f89d0004          LDRB     r0,[sp,#4]
00174e  f88d000a          STRB     r0,[sp,#0xa]
;;;1284   data[3]=*(((char*)(&temp_temp))+1);
001752  f89d0005          LDRB     r0,[sp,#5]
001756  f88d000b          STRB     r0,[sp,#0xb]
;;;1285   lc640_write_long_ptr(lc640_adr+4,data);
00175a  a902              ADD      r1,sp,#8
00175c  1d20              ADDS     r0,r4,#4
00175e  f7fffffe          BL       lc640_write_long_ptr
;;;1286   
;;;1287   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
001762  f44f70fc          MOV      r0,#0x1f8
001766  f7fffffe          BL       lc640_read_long
00176a  4d92              LDR      r5,|L1.6580|
00176c  6028              STR      r0,[r5,#0]  ; ke_date
;;;1288   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
00176e  4629              MOV      r1,r5
001770  f1040008          ADD      r0,r4,#8
001774  f7fffffe          BL       lc640_write_long_ptr
;;;1289   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
001778  f44f70fe          MOV      r0,#0x1fc
00177c  f7fffffe          BL       lc640_read_long
001780  6068              STR      r0,[r5,#4]  ; ke_date
;;;1290   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
001782  1d29              ADDS     r1,r5,#4
001784  f104000c          ADD      r0,r4,#0xc
001788  f7fffffe          BL       lc640_write_long_ptr
;;;1291   
;;;1292   data[0]=LPC_RTC->YEAR;
00178c  4d8a              LDR      r5,|L1.6584|
00178e  8ba8              LDRH     r0,[r5,#0x1c]
001790  f88d0008          STRB     r0,[sp,#8]
;;;1293   data[1]=LPC_RTC->MONTH;
001794  7e28              LDRB     r0,[r5,#0x18]
001796  f88d0009          STRB     r0,[sp,#9]
;;;1294   data[2]=LPC_RTC->DOM;
00179a  7b28              LDRB     r0,[r5,#0xc]
00179c  f88d000a          STRB     r0,[sp,#0xa]
;;;1295   data[3]=0;
0017a0  f88d600b          STRB     r6,[sp,#0xb]
;;;1296   lc640_write_long_ptr(lc640_adr+16,data);
0017a4  a902              ADD      r1,sp,#8
0017a6  f1040010          ADD      r0,r4,#0x10
0017aa  f7fffffe          BL       lc640_write_long_ptr
;;;1297   
;;;1298   data[0]=LPC_RTC->HOUR;
0017ae  7a28              LDRB     r0,[r5,#8]
0017b0  f88d0008          STRB     r0,[sp,#8]
;;;1299   data[1]=LPC_RTC->MIN;
0017b4  7928              LDRB     r0,[r5,#4]
0017b6  f88d0009          STRB     r0,[sp,#9]
;;;1300   data[2]=LPC_RTC->SEC;
0017ba  7828              LDRB     r0,[r5,#0]
0017bc  f88d000a          STRB     r0,[sp,#0xa]
;;;1301   data[3]=0;
0017c0  f88d600b          STRB     r6,[sp,#0xb]
;;;1302   lc640_write_long_ptr(lc640_adr+20,data);
0017c4  a902              ADD      r1,sp,#8
0017c6  f1040014          ADD      r0,r4,#0x14
0017ca  f7fffffe          BL       lc640_write_long_ptr
;;;1303    
;;;1304   }
0017ce  b005              ADD      sp,sp,#0x14
0017d0  bdf0              POP      {r4-r7,pc}
;;;1305   
                          ENDP

                  vz_mem_hndl PROC
;;;1307   //-----------------------------------------------
;;;1308   void vz_mem_hndl(unsigned short in)
0017d2  e92d4ff8          PUSH     {r3-r11,lr}
;;;1309   {
;;;1310   char data[4];
;;;1311   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
0017d6  f04f0600          MOV      r6,#0
0017da  4634              MOV      r4,r6
;;;1312   //char avar_simbol;
;;;1313   
;;;1314   if(in==1)
;;;1315   	{
;;;1316   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1317   	event_ptr++;	
;;;1318   	if(event_ptr>63)event_ptr=0;	
;;;1319   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1320   	
;;;1321        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1322   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1323   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1324   	
;;;1325   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1326   	
;;;1327   	data[0]='B';
;;;1328   	data[1]=0; 
;;;1329   	data[2]='Z';
;;;1330   	data[3]=0;
;;;1331   	lc640_write_long_ptr(lc640_adr,data);
;;;1332   
;;;1333   	data[0]=0;
;;;1334   	data[1]=0;
;;;1335   	data[2]=0;
;;;1336   	data[3]=0;
;;;1337   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1338   
;;;1339   	data[0]=LPC_RTC->YEAR;
0017dc  f8df81dc          LDR      r8,|L1.6588|
0017e0  46a1              MOV      r9,r4                 ;1311
0017e2  f04f0742          MOV      r7,#0x42              ;1327
0017e6  f44f6a80          MOV      r10,#0x400            ;1325
0017ea  2801              CMP      r0,#1                 ;1314
0017ec  d002              BEQ      |L1.6132|
;;;1340   	data[1]=LPC_RTC->MONTH;
;;;1341   	data[2]=LPC_RTC->DOM;
;;;1342   	data[3]=0;
;;;1343   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1344   
;;;1345   	data[0]=LPC_RTC->HOUR;
;;;1346   	data[1]=LPC_RTC->MIN;
;;;1347   	data[2]=LPC_RTC->SEC;
;;;1348   	data[3]=0;
;;;1349   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1350   	
;;;1351   	data[0]='A';
;;;1352   	data[1]='A';
;;;1353   	data[2]='A';
;;;1354   	data[3]='A';
;;;1355   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1356   	
;;;1357   	data[0]='A';
;;;1358   	data[1]='A';
;;;1359   	data[2]='A';
;;;1360   	data[3]='A';
;;;1361   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1362   	
;;;1363   	data[0]='A';
;;;1364   	data[1]='A';
;;;1365   	data[2]='A';
;;;1366   	data[3]='A';
;;;1367   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1368   	
;;;1369   	data[0]='A';
;;;1370   	data[1]='A';
;;;1371   	data[2]='A';
;;;1372   	data[3]='A';
;;;1373   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1374    	
;;;1375   	}
;;;1376   
;;;1377   else if(in==0)
0017ee  2800              CMP      r0,#0
0017f0  d07e              BEQ      |L1.6384|
0017f2  e12a              B        |L1.6730|
                  |L1.6132|
0017f4  f44f6560          MOV      r5,#0xe00             ;1316
0017f8  4628              MOV      r0,r5                 ;1316
0017fa  f7fffffe          BL       lc640_read_int
0017fe  f1000001          ADD      r0,r0,#1              ;1317
001802  4604              MOV      r4,r0                 ;1317
001804  2c3f              CMP      r4,#0x3f              ;1318
001806  d901              BLS      |L1.6156|
001808  f04f0400          MOV      r4,#0                 ;1318
                  |L1.6156|
00180c  b221              SXTH     r1,r4                 ;1319
00180e  4628              MOV      r0,r5                 ;1319
001810  f7fffffe          BL       lc640_write_int
001814  f6406602          MOV      r6,#0xe02             ;1321
001818  4630              MOV      r0,r6                 ;1321
00181a  f7fffffe          BL       lc640_read_int
00181e  283f              CMP      r0,#0x3f              ;1322
001820  d000              BEQ      |L1.6180|
001822  4620              MOV      r0,r4                 ;1322
                  |L1.6180|
001824  b201              SXTH     r1,r0                 ;1323
001826  4630              MOV      r0,r6                 ;1323
001828  f7fffffe          BL       lc640_write_int
00182c  4628              MOV      r0,r5                 ;1325
00182e  f7fffffe          BL       lc640_read_int
001832  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1325
001836  f88d7000          STRB     r7,[sp,#0]            ;1327
00183a  f88d9001          STRB     r9,[sp,#1]            ;1328
00183e  f04f005a          MOV      r0,#0x5a              ;1329
001842  f88d0002          STRB     r0,[sp,#2]            ;1329
001846  f88d9003          STRB     r9,[sp,#3]            ;1330
00184a  4669              MOV      r1,sp                 ;1331
00184c  4620              MOV      r0,r4                 ;1331
00184e  f7fffffe          BL       lc640_write_long_ptr
001852  f8cd9000          STR      r9,[sp,#0]            ;1336
001856  4669              MOV      r1,sp                 ;1337
001858  1d20              ADDS     r0,r4,#4              ;1337
00185a  f7fffffe          BL       lc640_write_long_ptr
00185e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1339
001862  f88d0000          STRB     r0,[sp,#0]            ;1339
001866  f8980038          LDRB     r0,[r8,#0x38]         ;1340
00186a  f88d0001          STRB     r0,[sp,#1]            ;1340
00186e  f898002c          LDRB     r0,[r8,#0x2c]         ;1341
001872  f88d0002          STRB     r0,[sp,#2]            ;1341
001876  f88d9003          STRB     r9,[sp,#3]            ;1342
00187a  4669              MOV      r1,sp                 ;1343
00187c  f1040008          ADD      r0,r4,#8              ;1343
001880  f7fffffe          BL       lc640_write_long_ptr
001884  f8980028          LDRB     r0,[r8,#0x28]         ;1345
001888  f88d0000          STRB     r0,[sp,#0]            ;1345
00188c  f8980024          LDRB     r0,[r8,#0x24]         ;1346
001890  f88d0001          STRB     r0,[sp,#1]            ;1346
001894  f8980020          LDRB     r0,[r8,#0x20]         ;1347
001898  f88d0002          STRB     r0,[sp,#2]            ;1347
00189c  f88d9003          STRB     r9,[sp,#3]            ;1348
0018a0  4669              MOV      r1,sp                 ;1349
0018a2  f104000c          ADD      r0,r4,#0xc            ;1349
0018a6  f7fffffe          BL       lc640_write_long_ptr
0018aa  f04f0541          MOV      r5,#0x41              ;1351
0018ae  f88d5000          STRB     r5,[sp,#0]            ;1351
0018b2  f88d5001          STRB     r5,[sp,#1]            ;1352
0018b6  f88d5002          STRB     r5,[sp,#2]            ;1353
0018ba  f88d5003          STRB     r5,[sp,#3]            ;1354
0018be  4669              MOV      r1,sp                 ;1355
0018c0  f1040010          ADD      r0,r4,#0x10           ;1355
0018c4  f7fffffe          BL       lc640_write_long_ptr
0018c8  f88d5000          STRB     r5,[sp,#0]            ;1357
0018cc  f88d5001          STRB     r5,[sp,#1]            ;1358
0018d0  f88d5002          STRB     r5,[sp,#2]            ;1359
0018d4  f88d5003          STRB     r5,[sp,#3]            ;1360
0018d8  4669              MOV      r1,sp                 ;1361
0018da  f1040014          ADD      r0,r4,#0x14           ;1361
0018de  f7fffffe          BL       lc640_write_long_ptr
0018e2  f88d5000          STRB     r5,[sp,#0]            ;1363
0018e6  f88d5001          STRB     r5,[sp,#1]            ;1364
0018ea  f88d5002          STRB     r5,[sp,#2]            ;1365
0018ee  e000              B        |L1.6386|
                  |L1.6384|
0018f0  e014              B        |L1.6428|
                  |L1.6386|
0018f2  f88d5003          STRB     r5,[sp,#3]            ;1366
0018f6  4669              MOV      r1,sp                 ;1367
0018f8  f1040018          ADD      r0,r4,#0x18           ;1367
0018fc  f7fffffe          BL       lc640_write_long_ptr
001900  f88d5000          STRB     r5,[sp,#0]            ;1369
001904  f88d5001          STRB     r5,[sp,#1]            ;1370
001908  f88d5002          STRB     r5,[sp,#2]            ;1371
00190c  f88d5003          STRB     r5,[sp,#3]            ;1372
001910  4669              MOV      r1,sp                 ;1373
001912  f104001c          ADD      r0,r4,#0x1c           ;1373
001916  f7fffffe          BL       lc640_write_long_ptr
00191a  e096              B        |L1.6730|
                  |L1.6428|
;;;1378   	{      
;;;1379        
;;;1380   vz_mem_hndl_lbl1: 
;;;1381   
;;;1382   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
00191c  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1383   
;;;1384        lc640_read_long_ptr(lc640_adr,data);
001920  4669              MOV      r1,sp
001922  4628              MOV      r0,r5
001924  f7fffffe          BL       lc640_read_long_ptr
;;;1385        
;;;1386        if(!((data[0]=='B')&&(data[2]=='Z')))
001928  f89d0000          LDRB     r0,[sp,#0]
00192c  2842              CMP      r0,#0x42
00192e  d103              BNE      |L1.6456|
001930  f89d0002          LDRB     r0,[sp,#2]
001934  285a              CMP      r0,#0x5a
001936  d008              BEQ      |L1.6474|
                  |L1.6456|
;;;1387        	{        
;;;1388        	if(event_ptr_find)event_ptr_find--;
001938  b114              CBZ      r4,|L1.6464|
00193a  f1a40401          SUB      r4,r4,#1
00193e  e001              B        |L1.6468|
                  |L1.6464|
;;;1389        	else event_ptr_find=63;
001940  f04f043f          MOV      r4,#0x3f
                  |L1.6468|
;;;1390        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001944  42b4              CMP      r4,r6
001946  d1e9              BNE      |L1.6428|
001948  e07f              B        |L1.6730|
                  |L1.6474|
;;;1391        	else goto vz_mem_hndl_lbl1;
;;;1392        	}
;;;1393        else 
;;;1394        	{
;;;1395        	lc640_read_long_ptr(lc640_adr+16,data);
00194a  4669              MOV      r1,sp
00194c  f1050010          ADD      r0,r5,#0x10
001950  f7fffffe          BL       lc640_read_long_ptr
;;;1396        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001954  f89d0000          LDRB     r0,[sp,#0]
001958  2841              CMP      r0,#0x41
00195a  d10b              BNE      |L1.6516|
00195c  f89d0001          LDRB     r0,[sp,#1]
001960  2841              CMP      r0,#0x41
001962  d107              BNE      |L1.6516|
001964  f89d0002          LDRB     r0,[sp,#2]
001968  2841              CMP      r0,#0x41
00196a  d103              BNE      |L1.6516|
00196c  f89d0003          LDRB     r0,[sp,#3]
001970  2841              CMP      r0,#0x41
001972  d02a              BEQ      |L1.6602|
                  |L1.6516|
;;;1397        		{        
;;;1398        		if(event_ptr_find)event_ptr_find--;
001974  b324              CBZ      r4,|L1.6592|
001976  f1a40401          SUB      r4,r4,#1
00197a  e023              B        |L1.6596|
                  |L1.6524|
00197c  42415420          DCB      "BAT #1 Alarm, assimetry",0
001980  23312041
001984  6c61726d
001988  2c206173
00198c  73696d65
001990  74727900
                  |L1.6548|
001994  42415420          DCB      "BAT #2 Alarm, assimetry",0
001998  23322041
00199c  6c61726d
0019a0  2c206173
0019a4  73696d65
0019a8  74727900
                  |L1.6572|
                          DCD      bat
                  |L1.6576|
                          DCD      bat_u_old_cnt
                  |L1.6580|
                          DCD      ke_date
                  |L1.6584|
                          DCD      0x40024020
                  |L1.6588|
                          DCD      0x40024000
                  |L1.6592|
;;;1399            		else event_ptr_find=63;
0019c0  f04f043f          MOV      r4,#0x3f
                  |L1.6596|
;;;1400            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
0019c4  42b4              CMP      r4,r6
0019c6  d1a9              BNE      |L1.6428|
0019c8  e03f              B        |L1.6730|
                  |L1.6602|
;;;1401        		else goto vz_mem_hndl_lbl1;
;;;1402        		}
;;;1403   
;;;1404        	}	
;;;1405   
;;;1406   
;;;1407   	
;;;1408   	data[0]=LPC_RTC->YEAR;
0019ca  f8b8003c          LDRH     r0,[r8,#0x3c]
0019ce  f88d0000          STRB     r0,[sp,#0]
;;;1409   	data[1]=LPC_RTC->MONTH;
0019d2  f8980038          LDRB     r0,[r8,#0x38]
0019d6  f88d0001          STRB     r0,[sp,#1]
;;;1410   	data[2]=LPC_RTC->DOM;
0019da  f898002c          LDRB     r0,[r8,#0x2c]
0019de  f88d0002          STRB     r0,[sp,#2]
;;;1411   	data[3]=0;
0019e2  f88d9003          STRB     r9,[sp,#3]
;;;1412   	lc640_write_long_ptr(lc640_adr+16,data);
0019e6  4669              MOV      r1,sp
0019e8  f1050010          ADD      r0,r5,#0x10
0019ec  f7fffffe          BL       lc640_write_long_ptr
;;;1413   
;;;1414   	data[0]=LPC_RTC->HOUR;
0019f0  f8980028          LDRB     r0,[r8,#0x28]
0019f4  f88d0000          STRB     r0,[sp,#0]
;;;1415   	data[1]=LPC_RTC->MIN;
0019f8  f8980024          LDRB     r0,[r8,#0x24]
0019fc  f88d0001          STRB     r0,[sp,#1]
;;;1416   	data[2]=LPC_RTC->SEC;
001a00  f8980020          LDRB     r0,[r8,#0x20]
001a04  f88d0002          STRB     r0,[sp,#2]
;;;1417   	data[3]=0;
001a08  f88d9003          STRB     r9,[sp,#3]
;;;1418   	lc640_write_long_ptr(lc640_adr+20,data);
001a0c  4669              MOV      r1,sp
001a0e  f1050014          ADD      r0,r5,#0x14
001a12  f7fffffe          BL       lc640_write_long_ptr
;;;1419   	
;;;1420   	data[0]='B';
001a16  f88d7000          STRB     r7,[sp,#0]
;;;1421   	data[1]='B';
001a1a  f88d7001          STRB     r7,[sp,#1]
;;;1422   	data[2]='B';
001a1e  f88d7002          STRB     r7,[sp,#2]
;;;1423   	data[3]='B';
001a22  f88d7003          STRB     r7,[sp,#3]
;;;1424   	lc640_write_long_ptr(lc640_adr+24,data);
001a26  4669              MOV      r1,sp
001a28  f1050018          ADD      r0,r5,#0x18
001a2c  f7fffffe          BL       lc640_write_long_ptr
;;;1425   	
;;;1426   	data[0]='B';
001a30  f88d7000          STRB     r7,[sp,#0]
;;;1427   	data[1]='B';
001a34  f88d7001          STRB     r7,[sp,#1]
;;;1428   	data[2]='B';
001a38  f88d7002          STRB     r7,[sp,#2]
;;;1429   	data[3]='B';
001a3c  f88d7003          STRB     r7,[sp,#3]
;;;1430   	lc640_write_long_ptr(lc640_adr+28,data);
001a40  4669              MOV      r1,sp
001a42  f105001c          ADD      r0,r5,#0x1c
001a46  f7fffffe          BL       lc640_write_long_ptr
                  |L1.6730|
;;;1431   	
;;;1432   	}
;;;1433   
;;;1434   vz_mem_hndl_end:
;;;1435   __nop(); 
001a4a  bf00              NOP      
;;;1436   
;;;1437   }
001a4c  e4c2              B        |L1.5076|
;;;1438     
                          ENDP


                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  av_inv
                          DCD      0x00000000
000018  0000              DCB      0x00,0x00
