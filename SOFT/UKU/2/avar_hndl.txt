; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\avar_hndl.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DAPSENERGIA --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;76     //-----------------------------------------------
;;;77     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;78     {
;;;79     //static unsigned avar_stat_old;
;;;80     char i;
;;;81     //unsigned avar_stat_new,avar_stat_offed;
;;;82     
;;;83     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48ff              LDR      r0,|L1.1024|
000004  49ff              LDR      r1,|L1.1028|
000006  7802              LDRB     r2,[r0,#0]  ; net_av
000008  6808              LDR      r0,[r1,#0]
00000a  b11a              CBZ      r2,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6008              STR      r0,[r1,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;84     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6008              STR      r0,[r1,#0]  ; avar_stat
                  |L1.26|
;;;85     
;;;86     for(i=0;i<2;i++)
00001a  f04f0000          MOV      r0,#0
;;;87     	{
;;;88     	if(bat[i]._av&1)	SET_REG(avar_stat,1,1+i,1);
00001e  4dfa              LDR      r5,|L1.1032|
000020  f04f0401          MOV      r4,#1
                  |L1.36|
000024  eb000240          ADD      r2,r0,r0,LSL #1
000028  eb021200          ADD      r2,r2,r0,LSL #4
00002c  eb050282          ADD      r2,r5,r2,LSL #2
000030  f892203d          LDRB     r2,[r2,#0x3d]
000034  07d2              LSLS     r2,r2,#31
000036  d00a              BEQ      |L1.78|
000038  f1000301          ADD      r3,r0,#1
00003c  fa04f203          LSL      r2,r4,r3
000040  680b              LDR      r3,[r1,#0]  ; avar_stat
000042  ea230302          BIC      r3,r3,r2
000046  ea430302          ORR      r3,r3,r2
00004a  600b              STR      r3,[r1,#0]  ; avar_stat
00004c  e007              B        |L1.94|
                  |L1.78|
;;;89     	else	   		SET_REG(avar_stat,0,1+i,1);
00004e  f1000201          ADD      r2,r0,#1
000052  fa04f302          LSL      r3,r4,r2
000056  680a              LDR      r2,[r1,#0]  ; avar_stat
000058  ea220203          BIC      r2,r2,r3
00005c  600a              STR      r2,[r1,#0]  ; avar_stat
                  |L1.94|
00005e  f1000001          ADD      r0,r0,#1              ;86
000062  b2c0              UXTB     r0,r0                 ;86
000064  2802              CMP      r0,#2                 ;86
000066  d3dd              BCC      |L1.36|
;;;90     	}
;;;91     
;;;92     for(i=0;i<12;i++)
000068  f04f0000          MOV      r0,#0
;;;93     	{
;;;94     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00006c  4ae7              LDR      r2,|L1.1036|
                  |L1.110|
00006e  ebc003c0          RSB      r3,r0,r0,LSL #3
000072  eb031300          ADD      r3,r3,r0,LSL #4
000076  eb020383          ADD      r3,r2,r3,LSL #2
00007a  785b              LDRB     r3,[r3,#1]
00007c  f0130fef          TST      r3,#0xef
000080  d00a              BEQ      |L1.152|
000082  f1000503          ADD      r5,r0,#3
000086  fa04f305          LSL      r3,r4,r5
00008a  680d              LDR      r5,[r1,#0]  ; avar_stat
00008c  ea250503          BIC      r5,r5,r3
000090  ea450503          ORR      r5,r5,r3
000094  600d              STR      r5,[r1,#0]  ; avar_stat
000096  e007              B        |L1.168|
                  |L1.152|
;;;95     	else	   		SET_REG(avar_stat,0,3+i,1);
000098  f1000303          ADD      r3,r0,#3
00009c  fa04f503          LSL      r5,r4,r3
0000a0  680b              LDR      r3,[r1,#0]  ; avar_stat
0000a2  ea230305          BIC      r3,r3,r5
0000a6  600b              STR      r3,[r1,#0]  ; avar_stat
                  |L1.168|
0000a8  f1000001          ADD      r0,r0,#1              ;92
0000ac  b2c0              UXTB     r0,r0                 ;92
0000ae  280c              CMP      r0,#0xc               ;92
0000b0  d3dd              BCC      |L1.110|
;;;96     	}
;;;97     
;;;98     for(i=0;i<6;i++)
0000b2  f04f0000          MOV      r0,#0
;;;99     	{
;;;100    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
0000b6  4dd3              LDR      r5,|L1.1028|
0000b8  f1050550          ADD      r5,r5,#0x50
                  |L1.188|
0000bc  5c2a              LDRB     r2,[r5,r0]
0000be  b152              CBZ      r2,|L1.214|
0000c0  f100030f          ADD      r3,r0,#0xf
0000c4  fa04f203          LSL      r2,r4,r3
0000c8  680b              LDR      r3,[r1,#0]  ; avar_stat
0000ca  ea230302          BIC      r3,r3,r2
0000ce  ea430302          ORR      r3,r3,r2
0000d2  600b              STR      r3,[r1,#0]  ; avar_stat
0000d4  e007              B        |L1.230|
                  |L1.214|
;;;101    	else	   		SET_REG(avar_stat,0,15+i,1);
0000d6  f100020f          ADD      r2,r0,#0xf
0000da  680b              LDR      r3,[r1,#0]  ; avar_stat
0000dc  fa04f202          LSL      r2,r4,r2
0000e0  ea230302          BIC      r3,r3,r2
0000e4  600b              STR      r3,[r1,#0]  ; avar_stat
                  |L1.230|
0000e6  f1000001          ADD      r0,r0,#1              ;98
0000ea  b2c0              UXTB     r0,r0                 ;98
0000ec  2806              CMP      r0,#6                 ;98
0000ee  d3e5              BCC      |L1.188|
;;;102    	}
;;;103    
;;;104    /*for(i=0;i<4;i++)
;;;105    	{
;;;106    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;107    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;108    	}  */
;;;109    for(i=0;i<4;i++)
0000f0  f04f0000          MOV      r0,#0
;;;110    	{
;;;111    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000f4  4bc6              LDR      r3,|L1.1040|
                  |L1.246|
0000f6  5c1a              LDRB     r2,[r3,r0]
0000f8  2a01              CMP      r2,#1
0000fa  d014              BEQ      |L1.294|
;;;112    	else	   		SET_REG(avar_stat,0,24+i,1);
0000fc  f1000218          ADD      r2,r0,#0x18
000100  fa04f502          LSL      r5,r4,r2
000104  680a              LDR      r2,[r1,#0]  ; avar_stat
000106  ea220205          BIC      r2,r2,r5
00010a  600a              STR      r2,[r1,#0]  ; avar_stat
                  |L1.268|
00010c  f1000001          ADD      r0,r0,#1              ;109
000110  b2c0              UXTB     r0,r0                 ;109
000112  2804              CMP      r0,#4                 ;109
000114  d3ef              BCC      |L1.246|
;;;113    	}
;;;114    
;;;115    if(uout_av)			SET_REG(avar_stat,1,28,1);
000116  48bf              LDR      r0,|L1.1044|
000118  7800              LDRB     r0,[r0,#0]  ; uout_av
00011a  b178              CBZ      r0,|L1.316|
00011c  6808              LDR      r0,[r1,#0]  ; avar_stat
00011e  f0405080          ORR      r0,r0,#0x10000000
000122  6008              STR      r0,[r1,#0]  ; avar_stat
000124  e00e              B        |L1.324|
                  |L1.294|
000126  f1000518          ADD      r5,r0,#0x18           ;111
00012a  fa04f205          LSL      r2,r4,r5              ;111
00012e  680d              LDR      r5,[r1,#0]            ;111  ; avar_stat
000130  ea250502          BIC      r5,r5,r2              ;111
000134  ea450502          ORR      r5,r5,r2              ;111
000138  600d              STR      r5,[r1,#0]            ;111  ; avar_stat
00013a  e7e7              B        |L1.268|
                  |L1.316|
;;;116    else	   			SET_REG(avar_stat,0,28,1);
00013c  6808              LDR      r0,[r1,#0]  ; avar_stat
00013e  f0205080          BIC      r0,r0,#0x10000000
000142  6008              STR      r0,[r1,#0]  ; avar_stat
                  |L1.324|
;;;117    
;;;118    
;;;119    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000144  688a              LDR      r2,[r1,#8]  ; avar_stat_old
000146  6808              LDR      r0,[r1,#0]  ; avar_stat
000148  ea200302          BIC      r3,r0,r2
00014c  60cb              STR      r3,[r1,#0xc]  ; avar_stat_new
;;;120    
;;;121    avar_ind_stat|=avar_stat_new;
00014e  684c              LDR      r4,[r1,#4]  ; avar_ind_stat
000150  ea440403          ORR      r4,r4,r3
000154  604c              STR      r4,[r1,#4]  ; avar_ind_stat
;;;122    
;;;123    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000156  4bb0              LDR      r3,|L1.1048|
000158  881d              LDRH     r5,[r3,#0]  ; SK_ZVUK_EN
00015a  b115              CBZ      r5,|L1.354|
00015c  f0247480          BIC      r4,r4,#0x1000000
000160  604c              STR      r4,[r1,#4]  ; avar_ind_stat
                  |L1.354|
;;;124    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
000162  885c              LDRH     r4,[r3,#2]  ; SK_ZVUK_EN
000164  b11c              CBZ      r4,|L1.366|
000166  684c              LDR      r4,[r1,#4]  ; avar_ind_stat
000168  f0247400          BIC      r4,r4,#0x2000000
00016c  604c              STR      r4,[r1,#4]  ; avar_ind_stat
                  |L1.366|
;;;125    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
00016e  889c              LDRH     r4,[r3,#4]  ; SK_ZVUK_EN
000170  b11c              CBZ      r4,|L1.378|
000172  684c              LDR      r4,[r1,#4]  ; avar_ind_stat
000174  f0246480          BIC      r4,r4,#0x4000000
000178  604c              STR      r4,[r1,#4]  ; avar_ind_stat
                  |L1.378|
;;;126    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
00017a  88db              LDRH     r3,[r3,#6]  ; SK_ZVUK_EN
00017c  b11b              CBZ      r3,|L1.390|
00017e  684b              LDR      r3,[r1,#4]  ; avar_ind_stat
000180  f0236300          BIC      r3,r3,#0x8000000
000184  604b              STR      r3,[r1,#4]  ; avar_ind_stat
                  |L1.390|
;;;127    
;;;128    
;;;129    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
000186  ea220200          BIC      r2,r2,r0
00018a  ea6f0202          MVN      r2,r2
00018e  610a              STR      r2,[r1,#0x10]  ; avar_stat_offed
;;;130    
;;;131    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
000190  4ba2              LDR      r3,|L1.1052|
000192  881b              LDRH     r3,[r3,#0]  ; AV_OFF_AVT
000194  b91b              CBNZ     r3,|L1.414|
000196  4ba2              LDR      r3,|L1.1056|
000198  ea420203          ORR      r2,r2,r3
00019c  610a              STR      r2,[r1,#0x10]  ; avar_stat_offed
                  |L1.414|
;;;132    
;;;133    avar_ind_stat&=avar_stat_offed; 
00019e  690b              LDR      r3,[r1,#0x10]  ; avar_stat_offed
0001a0  684a              LDR      r2,[r1,#4]  ; avar_ind_stat
0001a2  ea020203          AND      r2,r2,r3
0001a6  604a              STR      r2,[r1,#4]  ; avar_ind_stat
;;;134    
;;;135    avar_stat_old=avar_stat;
0001a8  6088              STR      r0,[r1,#8]  ; avar_stat_old
;;;136    
;;;137    //oleg_start+
;;;138    
;;;139    
;;;140    
;;;141    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
0001aa  489e              LDR      r0,|L1.1060|
0001ac  4a9e              LDR      r2,|L1.1064|
0001ae  8800              LDRH     r0,[r0,#0]  ; status_izm_r
0001b0  6812              LDR      r2,[r2,#0]  ; sk_alarm
0001b2  f000003f          AND      r0,r0,#0x3f
0001b6  ea402002          ORR      r0,r0,r2,LSL #8
0001ba  6148              STR      r0,[r1,#0x14]  ; rki_avar1_stat
;;;142    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
0001bc  69cb              LDR      r3,[r1,#0x1c]  ; rki_avar1_stat_old
0001be  ea200203          BIC      r2,r0,r3
0001c2  620a              STR      r2,[r1,#0x20]  ; rki_avar1_stat_new
;;;143    rki_avar1_ind_stat|=rki_avar1_stat_new;
0001c4  698c              LDR      r4,[r1,#0x18]  ; rki_avar1_ind_stat
0001c6  ea440402          ORR      r4,r4,r2
;;;144    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
0001ca  ea230300          BIC      r3,r3,r0
0001ce  ea6f0203          MVN      r2,r3
0001d2  624a              STR      r2,[r1,#0x24]  ; rki_avar1_stat_offed
;;;145    rki_avar1_ind_stat&=rki_avar1_stat_offed;
0001d4  ea040402          AND      r4,r4,r2
0001d8  618c              STR      r4,[r1,#0x18]  ; rki_avar1_ind_stat
;;;146    rki_avar1_stat_old=rki_avar1_stat;
0001da  61c8              STR      r0,[r1,#0x1c]  ; rki_avar1_stat_old
;;;147    
;;;148    rki_avarI1_stat=status_di1;
0001dc  4893              LDR      r0,|L1.1068|
0001de  6800              LDR      r0,[r0,#0]  ; status_di1
0001e0  6288              STR      r0,[r1,#0x28]  ; rki_avarI1_stat
;;;149    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
0001e2  6b0b              LDR      r3,[r1,#0x30]  ; rki_avarI1_stat_old
0001e4  ea200203          BIC      r2,r0,r3
0001e8  634a              STR      r2,[r1,#0x34]  ; rki_avarI1_stat_new
;;;150    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
0001ea  6acc              LDR      r4,[r1,#0x2c]  ; rki_avarI1_ind_stat
0001ec  ea440402          ORR      r4,r4,r2
;;;151    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
0001f0  ea230300          BIC      r3,r3,r0
0001f4  ea6f0203          MVN      r2,r3
0001f8  638a              STR      r2,[r1,#0x38]  ; rki_avarI1_stat_offed
;;;152    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
0001fa  ea040402          AND      r4,r4,r2
0001fe  62cc              STR      r4,[r1,#0x2c]  ; rki_avarI1_ind_stat
;;;153    rki_avarI1_stat_old=rki_avarI1_stat;
000200  6308              STR      r0,[r1,#0x30]  ; rki_avarI1_stat_old
;;;154    
;;;155    rki_avarI2_stat=status_di2;
000202  488b              LDR      r0,|L1.1072|
000204  6800              LDR      r0,[r0,#0]  ; status_di2
000206  63c8              STR      r0,[r1,#0x3c]  ; rki_avarI2_stat
;;;156    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
000208  6c4b              LDR      r3,[r1,#0x44]  ; rki_avarI2_stat_old
00020a  ea200203          BIC      r2,r0,r3
00020e  648a              STR      r2,[r1,#0x48]  ; rki_avarI2_stat_new
;;;157    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
000210  6c0c              LDR      r4,[r1,#0x40]  ; rki_avarI2_ind_stat
000212  ea440402          ORR      r4,r4,r2
;;;158    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
000216  ea230300          BIC      r3,r3,r0
00021a  ea6f0203          MVN      r2,r3
00021e  64ca              STR      r2,[r1,#0x4c]  ; rki_avarI2_stat_offed
;;;159    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
000220  ea040402          AND      r4,r4,r2
000224  640c              STR      r4,[r1,#0x40]  ; rki_avarI2_ind_stat
;;;160    rki_avarI2_stat_old=rki_avarI2_stat;
000226  6448              STR      r0,[r1,#0x44]  ; rki_avarI2_stat_old
;;;161    //oleg_end
;;;162    }
000228  bd30              POP      {r4,r5,pc}
;;;163    
                          ENDP

                  reload_hndl PROC
;;;164    //-----------------------------------------------
;;;165    void reload_hndl(void)
00022a  b5f8              PUSH     {r3-r7,lr}
;;;166    {
;;;167    char data[4];
;;;168    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;169    
;;;170    event_ptr=lc640_read_int(PTR_EVENT_LOG);
00022c  f44f6560          MOV      r5,#0xe00
000230  4628              MOV      r0,r5
000232  f7fffffe          BL       lc640_read_int
;;;171    event_ptr++;	
000236  f1000001          ADD      r0,r0,#1
00023a  4604              MOV      r4,r0
;;;172    if(event_ptr>63)event_ptr=0;	
00023c  2c3f              CMP      r4,#0x3f
00023e  d901              BLS      |L1.580|
000240  f04f0400          MOV      r4,#0
                  |L1.580|
;;;173    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000244  b221              SXTH     r1,r4
000246  4628              MOV      r0,r5
000248  f7fffffe          BL       lc640_write_int
;;;174    	
;;;175    event_cnt=lc640_read_int(CNT_EVENT_LOG);
00024c  f6406602          MOV      r6,#0xe02
000250  4630              MOV      r0,r6
000252  f7fffffe          BL       lc640_read_int
;;;176    if(event_cnt!=63)event_cnt=event_ptr;
000256  283f              CMP      r0,#0x3f
000258  d000              BEQ      |L1.604|
00025a  4620              MOV      r0,r4
                  |L1.604|
;;;177    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
00025c  b201              SXTH     r1,r0
00025e  4630              MOV      r0,r6
000260  f7fffffe          BL       lc640_write_int
;;;178    	
;;;179    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000264  4628              MOV      r0,r5
000266  f7fffffe          BL       lc640_read_int
00026a  f44f6180          MOV      r1,#0x400
00026e  eb011440          ADD      r4,r1,r0,LSL #5
;;;180    	
;;;181    data[0]='U';
000272  f04f0055          MOV      r0,#0x55
000276  f88d0000          STRB     r0,[sp,#0]
;;;182    data[1]=0;
00027a  f04f0600          MOV      r6,#0
00027e  f88d6001          STRB     r6,[sp,#1]
;;;183    data[2]='R';
000282  f04f0052          MOV      r0,#0x52
000286  f88d0002          STRB     r0,[sp,#2]
;;;184    data[3]=0;
00028a  f88d6003          STRB     r6,[sp,#3]
;;;185    lc640_write_long_ptr(lc640_adr,data);
00028e  4669              MOV      r1,sp
000290  4620              MOV      r0,r4
000292  f7fffffe          BL       lc640_write_long_ptr
;;;186    
;;;187    data[0]=0;
;;;188    data[1]=0;
;;;189    data[2]=0;
;;;190    data[3]=0;
000296  9600              STR      r6,[sp,#0]
;;;191    lc640_write_long_ptr(lc640_adr+4,data);
000298  4669              MOV      r1,sp
00029a  1d20              ADDS     r0,r4,#4
00029c  f7fffffe          BL       lc640_write_long_ptr
;;;192    
;;;193    data[0]=LPC_RTC->YEAR;
0002a0  4d64              LDR      r5,|L1.1076|
0002a2  8ba8              LDRH     r0,[r5,#0x1c]
0002a4  f88d0000          STRB     r0,[sp,#0]
;;;194    data[1]=LPC_RTC->MONTH;
0002a8  7e28              LDRB     r0,[r5,#0x18]
0002aa  f88d0001          STRB     r0,[sp,#1]
;;;195    data[2]=LPC_RTC->DOM;
0002ae  7b28              LDRB     r0,[r5,#0xc]
0002b0  f88d0002          STRB     r0,[sp,#2]
;;;196    data[3]=0;
0002b4  f88d6003          STRB     r6,[sp,#3]
;;;197    lc640_write_long_ptr(lc640_adr+8,data);
0002b8  4669              MOV      r1,sp
0002ba  f1040008          ADD      r0,r4,#8
0002be  f7fffffe          BL       lc640_write_long_ptr
;;;198    
;;;199    data[0]=LPC_RTC->HOUR;
0002c2  7a28              LDRB     r0,[r5,#8]
0002c4  f88d0000          STRB     r0,[sp,#0]
;;;200    data[1]=LPC_RTC->MIN;
0002c8  7928              LDRB     r0,[r5,#4]
0002ca  f88d0001          STRB     r0,[sp,#1]
;;;201    data[2]=LPC_RTC->SEC;
0002ce  7828              LDRB     r0,[r5,#0]
0002d0  f88d0002          STRB     r0,[sp,#2]
;;;202    data[3]=LPC_SC->RSID;
0002d4  4858              LDR      r0,|L1.1080|
0002d6  f8d00180          LDR      r0,[r0,#0x180]
0002da  f88d0003          STRB     r0,[sp,#3]
;;;203    
;;;204    lc640_write_long_ptr(lc640_adr+12,data);
0002de  4669              MOV      r1,sp
0002e0  f104000c          ADD      r0,r4,#0xc
0002e4  f7fffffe          BL       lc640_write_long_ptr
;;;205    	
;;;206    data[0]='A';
0002e8  f04f0541          MOV      r5,#0x41
0002ec  f88d5000          STRB     r5,[sp,#0]
;;;207    data[1]='A';
0002f0  f88d5001          STRB     r5,[sp,#1]
;;;208    data[2]='A';
0002f4  f88d5002          STRB     r5,[sp,#2]
;;;209    data[3]='A';
0002f8  f88d5003          STRB     r5,[sp,#3]
;;;210    lc640_write_long_ptr(lc640_adr+16,data);
0002fc  4669              MOV      r1,sp
0002fe  f1040010          ADD      r0,r4,#0x10
000302  f7fffffe          BL       lc640_write_long_ptr
;;;211    	
;;;212    data[0]='A';
000306  f88d5000          STRB     r5,[sp,#0]
;;;213    data[1]='A';
00030a  f88d5001          STRB     r5,[sp,#1]
;;;214    data[2]='A';
00030e  f88d5002          STRB     r5,[sp,#2]
;;;215    data[3]='A';
000312  f88d5003          STRB     r5,[sp,#3]
;;;216    lc640_write_long_ptr(lc640_adr+20,data);
000316  4669              MOV      r1,sp
000318  f1040014          ADD      r0,r4,#0x14
00031c  f7fffffe          BL       lc640_write_long_ptr
;;;217    	
;;;218    data[0]='A';
000320  f88d5000          STRB     r5,[sp,#0]
;;;219    data[1]='A';
000324  f88d5001          STRB     r5,[sp,#1]
;;;220    data[2]='A';
000328  f88d5002          STRB     r5,[sp,#2]
;;;221    data[3]='A';
00032c  f88d5003          STRB     r5,[sp,#3]
;;;222    lc640_write_long_ptr(lc640_adr+24,data);
000330  4669              MOV      r1,sp
000332  f1040018          ADD      r0,r4,#0x18
000336  f7fffffe          BL       lc640_write_long_ptr
;;;223    	
;;;224    data[0]='A';
00033a  f88d5000          STRB     r5,[sp,#0]
;;;225    data[1]='A';
00033e  f88d5001          STRB     r5,[sp,#1]
;;;226    data[2]='A';
000342  f88d5002          STRB     r5,[sp,#2]
;;;227    data[3]='A';
000346  f88d5003          STRB     r5,[sp,#3]
;;;228    lc640_write_long_ptr(lc640_adr+28,data);				
00034a  4669              MOV      r1,sp
00034c  f104001c          ADD      r0,r4,#0x1c
000350  f7fffffe          BL       lc640_write_long_ptr
;;;229    	
;;;230    	
;;;231    }
000354  bdf8              POP      {r3-r7,pc}
;;;232    
                          ENDP

                  avar_unet_hndl PROC
;;;233    //-----------------------------------------------
;;;234    void avar_unet_hndl(char in)
000356  e92d43f8          PUSH     {r3-r9,lr}
;;;235    {
;;;236    
;;;237    char data[4];
;;;238    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;239    
;;;240    
;;;241    if(in==1)
;;;242    	{
;;;243    	net_av=1;
;;;244    
;;;245    	//beep_init(0x01L,'O');
;;;246    	//a.av.bAN=1;
;;;247    
;;;248    
;;;249    	//beep_init(0x33333333,'A');
;;;250    	 
;;;251    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;252    	event_ptr++;	
;;;253    	if(event_ptr>63)event_ptr=0;	
;;;254    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;255    	
;;;256         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;257    	if(event_cnt!=63)event_cnt=event_ptr;
;;;258    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;259    	
;;;260    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;261    	
;;;262    	data[0]='P';
;;;263    	data[1]=0;
;;;264    	data[2]='A';
;;;265    	data[3]=0;
;;;266    	lc640_write_long_ptr(lc640_adr,data);
;;;267    
;;;268    	data[0]=0;//*((char*)&Unet_store);
;;;269    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;270    	data[2]=0;
;;;271    	data[3]=0;
;;;272    	lc640_write_long_ptr(lc640_adr+4,data);
;;;273    
;;;274    	data[0]=LPC_RTC->YEAR;
00035a  4f36              LDR      r7,|L1.1076|
00035c  4928              LDR      r1,|L1.1024|
00035e  3f20              SUBS     r7,r7,#0x20
000360  f44f6560          MOV      r5,#0xe00             ;251
000364  f04f0800          MOV      r8,#0                 ;253
000368  f44f6980          MOV      r9,#0x400             ;260
00036c  2801              CMP      r0,#1                 ;241
00036e  d002              BEQ      |L1.886|
;;;275    	data[1]=LPC_RTC->MONTH;
;;;276    	data[2]=LPC_RTC->DOM;
;;;277    	data[3]=0;
;;;278    	lc640_write_long_ptr(lc640_adr+8,data);
;;;279    
;;;280    	data[0]=LPC_RTC->HOUR;
;;;281    	data[1]=LPC_RTC->MIN;
;;;282    	data[2]=LPC_RTC->SEC;
;;;283    	data[3]=0;
;;;284    	lc640_write_long_ptr(lc640_adr+12,data);
;;;285    	
;;;286    	data[0]='A';
;;;287    	data[1]='A';
;;;288    	data[2]='A';
;;;289    	data[3]='A';
;;;290    	lc640_write_long_ptr(lc640_adr+16,data);
;;;291    	
;;;292    	data[0]='A';
;;;293    	data[1]='A';
;;;294    	data[2]='A';
;;;295    	data[3]='A';
;;;296    	lc640_write_long_ptr(lc640_adr+20,data);
;;;297    	
;;;298    	data[0]='A';
;;;299    	data[1]='A';
;;;300    	data[2]='A';
;;;301    	data[3]='A';
;;;302    	lc640_write_long_ptr(lc640_adr+24,data);
;;;303    	
;;;304    	data[0]='A';
;;;305    	data[1]='A';
;;;306    	data[2]='A';
;;;307    	data[3]='A';
;;;308    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;309    	
;;;310    /*	memo_out0[0]=0x55;
;;;311         memo_out0[1]=0x00+2;
;;;312         memo_out0[2]=1;
;;;313         memo_out0[3]=0x0b;
;;;314         memo_out0[4]=0x55;
;;;315         memo_out0[5]=0x55; 
;;;316         	
;;;317         memo_out0[6]=crc_87(memo_out0,6);
;;;318    	memo_out0[7]=crc_95(memo_out0,6);
;;;319         usart_out_adr0(memo_out0,8); 
;;;320    	*/
;;;321    	snmp_trap_send("Main power alarm",2,1,0);
;;;322    	}
;;;323    
;;;324    else if(in==0)
000370  2800              CMP      r0,#0
000372  d044              BEQ      |L1.1022|
000374  e146              B        |L1.1540|
                  |L1.886|
000376  f04f0001          MOV      r0,#1                 ;243
00037a  7008              STRB     r0,[r1,#0]            ;243
00037c  4628              MOV      r0,r5                 ;251
00037e  f7fffffe          BL       lc640_read_int
000382  f1000001          ADD      r0,r0,#1              ;252
000386  4604              MOV      r4,r0                 ;252
000388  2c3f              CMP      r4,#0x3f              ;253
00038a  d901              BLS      |L1.912|
00038c  f04f0400          MOV      r4,#0                 ;253
                  |L1.912|
000390  b221              SXTH     r1,r4                 ;254
000392  4628              MOV      r0,r5                 ;254
000394  f7fffffe          BL       lc640_write_int
000398  f6406602          MOV      r6,#0xe02             ;256
00039c  4630              MOV      r0,r6                 ;256
00039e  f7fffffe          BL       lc640_read_int
0003a2  283f              CMP      r0,#0x3f              ;257
0003a4  d000              BEQ      |L1.936|
0003a6  4620              MOV      r0,r4                 ;257
                  |L1.936|
0003a8  b201              SXTH     r1,r0                 ;258
0003aa  4630              MOV      r0,r6                 ;258
0003ac  f7fffffe          BL       lc640_write_int
0003b0  4628              MOV      r0,r5                 ;260
0003b2  f7fffffe          BL       lc640_read_int
0003b6  eb091540          ADD      r5,r9,r0,LSL #5       ;260
0003ba  f04f0050          MOV      r0,#0x50              ;262
0003be  f88d0000          STRB     r0,[sp,#0]            ;262
0003c2  f88d8001          STRB     r8,[sp,#1]            ;263
0003c6  f04f0441          MOV      r4,#0x41              ;264
0003ca  f88d4002          STRB     r4,[sp,#2]            ;264
0003ce  f88d8003          STRB     r8,[sp,#3]            ;265
0003d2  4669              MOV      r1,sp                 ;266
0003d4  4628              MOV      r0,r5                 ;266
0003d6  f7fffffe          BL       lc640_write_long_ptr
0003da  f8cd8000          STR      r8,[sp,#0]            ;271
0003de  4669              MOV      r1,sp                 ;272
0003e0  1d28              ADDS     r0,r5,#4              ;272
0003e2  f7fffffe          BL       lc640_write_long_ptr
0003e6  f1070720          ADD      r7,r7,#0x20           ;274
0003ea  8bb8              LDRH     r0,[r7,#0x1c]         ;274
0003ec  f88d0000          STRB     r0,[sp,#0]            ;274
0003f0  7e38              LDRB     r0,[r7,#0x18]         ;275
0003f2  f88d0001          STRB     r0,[sp,#1]            ;275
0003f6  7b38              LDRB     r0,[r7,#0xc]          ;276
0003f8  f88d0002          STRB     r0,[sp,#2]            ;276
0003fc  e01e              B        |L1.1084|
                  |L1.1022|
0003fe  e06f              B        |L1.1248|
                  |L1.1024|
                          DCD      net_av
                  |L1.1028|
                          DCD      ||.data||
                  |L1.1032|
                          DCD      bat
                  |L1.1036|
                          DCD      bps
                  |L1.1040|
                          DCD      sk_av_stat
                  |L1.1044|
                          DCD      uout_av
                  |L1.1048|
                          DCD      SK_ZVUK_EN
                  |L1.1052|
                          DCD      AV_OFF_AVT
                  |L1.1056|
                          DCD      0xeffffffe
                  |L1.1060|
                          DCD      status_izm_r
                  |L1.1064|
                          DCD      sk_alarm
                  |L1.1068|
                          DCD      status_di1
                  |L1.1072|
                          DCD      status_di2
                  |L1.1076|
                          DCD      0x40024020
                  |L1.1080|
                          DCD      0x400fc000
                  |L1.1084|
00043c  f88d8003          STRB     r8,[sp,#3]            ;277
000440  4669              MOV      r1,sp                 ;278
000442  f1050008          ADD      r0,r5,#8              ;278
000446  f7fffffe          BL       lc640_write_long_ptr
00044a  7a38              LDRB     r0,[r7,#8]            ;280
00044c  f88d0000          STRB     r0,[sp,#0]            ;280
000450  7938              LDRB     r0,[r7,#4]            ;281
000452  f88d0001          STRB     r0,[sp,#1]            ;281
000456  7838              LDRB     r0,[r7,#0]            ;282
000458  f88d0002          STRB     r0,[sp,#2]            ;282
00045c  f88d8003          STRB     r8,[sp,#3]            ;283
000460  4669              MOV      r1,sp                 ;284
000462  f105000c          ADD      r0,r5,#0xc            ;284
000466  f7fffffe          BL       lc640_write_long_ptr
00046a  f88d4000          STRB     r4,[sp,#0]            ;286
00046e  f88d4001          STRB     r4,[sp,#1]            ;287
000472  f88d4002          STRB     r4,[sp,#2]            ;288
000476  f88d4003          STRB     r4,[sp,#3]            ;289
00047a  4669              MOV      r1,sp                 ;290
00047c  f1050010          ADD      r0,r5,#0x10           ;290
000480  f7fffffe          BL       lc640_write_long_ptr
000484  f88d4000          STRB     r4,[sp,#0]            ;292
000488  f88d4001          STRB     r4,[sp,#1]            ;293
00048c  f88d4002          STRB     r4,[sp,#2]            ;294
000490  f88d4003          STRB     r4,[sp,#3]            ;295
000494  4669              MOV      r1,sp                 ;296
000496  f1050014          ADD      r0,r5,#0x14           ;296
00049a  f7fffffe          BL       lc640_write_long_ptr
00049e  f88d4000          STRB     r4,[sp,#0]            ;298
0004a2  f88d4001          STRB     r4,[sp,#1]            ;299
0004a6  f88d4002          STRB     r4,[sp,#2]            ;300
0004aa  f88d4003          STRB     r4,[sp,#3]            ;301
0004ae  4669              MOV      r1,sp                 ;302
0004b0  f1050018          ADD      r0,r5,#0x18           ;302
0004b4  f7fffffe          BL       lc640_write_long_ptr
0004b8  f88d4000          STRB     r4,[sp,#0]            ;304
0004bc  f88d4001          STRB     r4,[sp,#1]            ;305
0004c0  f88d4002          STRB     r4,[sp,#2]            ;306
0004c4  f88d4003          STRB     r4,[sp,#3]            ;307
0004c8  4669              MOV      r1,sp                 ;308
0004ca  f105001c          ADD      r0,r5,#0x1c           ;308
0004ce  f7fffffe          BL       lc640_write_long_ptr
0004d2  2300              MOVS     r3,#0                 ;321
0004d4  2201              MOVS     r2,#1                 ;321
0004d6  2102              MOVS     r1,#2                 ;321
0004d8  a0fd              ADR      r0,|L1.2256|
0004da  f7fffffe          BL       snmp_trap_send
0004de  e091              B        |L1.1540|
                  |L1.1248|
;;;325    	{
;;;326    	net_av=0;
0004e0  f8818000          STRB     r8,[r1,#0]
;;;327    
;;;328      /*
;;;329    	SET_REG(C2GSR,3,24,8);
;;;330    	C2MOD=0;
;;;331    	bOUT_FREE2=1;*/
;;;332    
;;;333    
;;;334    	//C2MOD=0;
;;;335    
;;;336    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;337    
;;;338         //beep_init(0x02L,'O');
;;;339    	//a_.av.bAN=0;
;;;340    	SET_REG(avar_stat,0,0,1);
0004e4  48ff              LDR      r0,|L1.2276|
0004e6  6801              LDR      r1,[r0,#0]  ; avar_stat
0004e8  f0210101          BIC      r1,r1,#1
0004ec  6001              STR      r1,[r0,#0]  ; avar_stat
;;;341    
;;;342    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;343    	
;;;344    	if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
0004ee  49fe              LDR      r1,|L1.2280|
0004f0  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
0004f2  b119              CBZ      r1,|L1.1276|
0004f4  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
0004f6  f0210101          BIC      r1,r1,#1
0004fa  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.1276|
;;;345    
;;;346         event_ptr=lc640_read_int(PTR_EVENT_LOG);
0004fc  4628              MOV      r0,r5
0004fe  f7fffffe          BL       lc640_read_int
000502  4606              MOV      r6,r0
;;;347    	event_ptr_find=event_ptr;
000504  4634              MOV      r4,r6
                  |L1.1286|
;;;348    avar_unet_hndl_lbl1:
;;;349    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000506  eb091544          ADD      r5,r9,r4,LSL #5
;;;350    
;;;351         lc640_read_long_ptr(lc640_adr,data);
00050a  4669              MOV      r1,sp
00050c  4628              MOV      r0,r5
00050e  f7fffffe          BL       lc640_read_long_ptr
;;;352         
;;;353         if(!((data[0]=='P')&&(data[1]==0)&&(data[2]=='A')))
000512  f89d0000          LDRB     r0,[sp,#0]
000516  2850              CMP      r0,#0x50
000518  d106              BNE      |L1.1320|
00051a  f89d0001          LDRB     r0,[sp,#1]
00051e  b918              CBNZ     r0,|L1.1320|
000520  f89d0002          LDRB     r0,[sp,#2]
000524  2841              CMP      r0,#0x41
000526  d008              BEQ      |L1.1338|
                  |L1.1320|
;;;354         	{        
;;;355         	if(event_ptr_find)event_ptr_find--;
000528  b114              CBZ      r4,|L1.1328|
00052a  f1a40401          SUB      r4,r4,#1
00052e  e001              B        |L1.1332|
                  |L1.1328|
;;;356         	else event_ptr_find=63;
000530  f04f043f          MOV      r4,#0x3f
                  |L1.1332|
;;;357         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000534  42b4              CMP      r4,r6
000536  d1e6              BNE      |L1.1286|
000538  e064              B        |L1.1540|
                  |L1.1338|
;;;358         	else goto avar_unet_hndl_lbl1;
;;;359         	}
;;;360         else 
;;;361         	{
;;;362         	lc640_read_long_ptr(lc640_adr+16,data);
00053a  4669              MOV      r1,sp
00053c  f1050010          ADD      r0,r5,#0x10
000540  f7fffffe          BL       lc640_read_long_ptr
;;;363         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000544  f89d0000          LDRB     r0,[sp,#0]
000548  2841              CMP      r0,#0x41
00054a  d10b              BNE      |L1.1380|
00054c  f89d0001          LDRB     r0,[sp,#1]
000550  2841              CMP      r0,#0x41
000552  d107              BNE      |L1.1380|
000554  f89d0002          LDRB     r0,[sp,#2]
000558  2841              CMP      r0,#0x41
00055a  d103              BNE      |L1.1380|
00055c  f89d0003          LDRB     r0,[sp,#3]
000560  2841              CMP      r0,#0x41
000562  d008              BEQ      |L1.1398|
                  |L1.1380|
;;;364         		{        
;;;365         		if(event_ptr_find)event_ptr_find--;
000564  b114              CBZ      r4,|L1.1388|
000566  f1a40401          SUB      r4,r4,#1
00056a  e001              B        |L1.1392|
                  |L1.1388|
;;;366             		else event_ptr_find=63;
00056c  f04f043f          MOV      r4,#0x3f
                  |L1.1392|
;;;367             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000570  42b4              CMP      r4,r6
000572  d1c8              BNE      |L1.1286|
000574  e046              B        |L1.1540|
                  |L1.1398|
;;;368         		else goto avar_unet_hndl_lbl1;
;;;369         		}
;;;370    
;;;371         	}	
;;;372    	
;;;373    	data[0]=LPC_RTC->YEAR;
000576  f1070720          ADD      r7,r7,#0x20
00057a  8bb8              LDRH     r0,[r7,#0x1c]
00057c  f88d0000          STRB     r0,[sp,#0]
;;;374    	data[1]=LPC_RTC->MONTH;
000580  7e38              LDRB     r0,[r7,#0x18]
000582  f88d0001          STRB     r0,[sp,#1]
;;;375    	data[2]=LPC_RTC->DOM;
000586  7b38              LDRB     r0,[r7,#0xc]
000588  f88d0002          STRB     r0,[sp,#2]
;;;376    	data[3]=0;
00058c  f88d8003          STRB     r8,[sp,#3]
;;;377    	lc640_write_long_ptr(lc640_adr+16,data);
000590  4669              MOV      r1,sp
000592  f1050010          ADD      r0,r5,#0x10
000596  f7fffffe          BL       lc640_write_long_ptr
;;;378    
;;;379    	data[0]=LPC_RTC->HOUR;
00059a  7a38              LDRB     r0,[r7,#8]
00059c  f88d0000          STRB     r0,[sp,#0]
;;;380    	data[1]=LPC_RTC->MIN;
0005a0  7938              LDRB     r0,[r7,#4]
0005a2  f88d0001          STRB     r0,[sp,#1]
;;;381    	data[2]=LPC_RTC->SEC;
0005a6  7838              LDRB     r0,[r7,#0]
0005a8  f88d0002          STRB     r0,[sp,#2]
;;;382    	data[3]=0;
0005ac  f88d8003          STRB     r8,[sp,#3]
;;;383    	lc640_write_long_ptr(lc640_adr+20,data); 
0005b0  4669              MOV      r1,sp
0005b2  f1050014          ADD      r0,r5,#0x14
0005b6  f7fffffe          BL       lc640_write_long_ptr
;;;384    	
;;;385    	data[0]=*((char*)(&net_Ustore));
0005ba  48cc              LDR      r0,|L1.2284|
0005bc  7801              LDRB     r1,[r0,#0]  ; net_Ustore
0005be  f88d1000          STRB     r1,[sp,#0]
;;;386    	data[1]=*(((char*)(&net_Ustore))+1);
0005c2  7840              LDRB     r0,[r0,#1]  ; net_Ustore
0005c4  f88d0001          STRB     r0,[sp,#1]
;;;387    	data[2]='B';
0005c8  f04f0442          MOV      r4,#0x42
0005cc  f88d4002          STRB     r4,[sp,#2]
;;;388    	data[3]='B';
0005d0  f88d4003          STRB     r4,[sp,#3]
;;;389    	lc640_write_long_ptr(lc640_adr+24,data);
0005d4  4669              MOV      r1,sp
0005d6  f1050018          ADD      r0,r5,#0x18
0005da  f7fffffe          BL       lc640_write_long_ptr
;;;390    	
;;;391    	data[0]='B';
0005de  f88d4000          STRB     r4,[sp,#0]
;;;392    	data[1]='B';
0005e2  f88d4001          STRB     r4,[sp,#1]
;;;393    	data[2]='B';
0005e6  f88d4002          STRB     r4,[sp,#2]
;;;394    	data[3]='B';
0005ea  f88d4003          STRB     r4,[sp,#3]
;;;395    	lc640_write_long_ptr(lc640_adr+28,data);	
0005ee  4669              MOV      r1,sp
0005f0  f105001c          ADD      r0,r5,#0x1c
0005f4  f7fffffe          BL       lc640_write_long_ptr
;;;396    	
;;;397    /*	memo_out0[0]=0x55;
;;;398         memo_out0[1]=0x00+2;
;;;399         memo_out0[2]=1;
;;;400         memo_out0[3]=0x0b;
;;;401         memo_out0[4]=0xaa;
;;;402         memo_out0[5]=0xaa; 
;;;403         	
;;;404         memo_out0[6]=crc_87(memo_out0,6);
;;;405    	memo_out0[7]=crc_95(memo_out0,6);
;;;406         usart_out_adr0(memo_out0,8); */
;;;407         snmp_trap_send("Main power alarm  clear",2,1,1);	
0005f8  2301              MOVS     r3,#1
0005fa  461a              MOV      r2,r3
0005fc  2102              MOVS     r1,#2
0005fe  a0bc              ADR      r0,|L1.2288|
000600  f7fffffe          BL       snmp_trap_send
                  |L1.1540|
;;;408    	}
;;;409    avar_unet_hndl_end:
;;;410    	__nop();		
000604  bf00              NOP      
                  |L1.1542|
;;;411    }
000606  e8bd83f8          POP      {r3-r9,pc}
;;;412    
                          ENDP

                  avar_uout_hndl PROC
;;;414    //-----------------------------------------------
;;;415    void avar_uout_hndl(char in)
00060a  e92d43f8          PUSH     {r3-r9,lr}
;;;416    {
;;;417    
;;;418    char data[4];
;;;419    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;420    
;;;421    
;;;422    if(in==1)
;;;423    	{
;;;424    	//net_av=1;
;;;425    
;;;426    	//beep_init(0x01L,'O');
;;;427    	//a.av.bAN=1;
;;;428    
;;;429    
;;;430    	//beep_init(0x33333333,'A');
;;;431    
;;;432    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;433    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;434    		 
;;;435    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;436    	event_ptr++;	
;;;437    	if(event_ptr>63)event_ptr=0;	
;;;438    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;439    	
;;;440        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;441    	if(event_cnt!=63)event_cnt=event_ptr;
;;;442    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;443    	
;;;444    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;445    	
;;;446    	data[0]='Q';
;;;447    	data[1]=0;
;;;448    	data[2]='A';
;;;449    	data[3]=0;
;;;450    	lc640_write_long_ptr(lc640_adr,data);
;;;451    
;;;452    	data[0]=0;//*((char*)&Unet_store);
;;;453    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;454    	data[2]=0;
;;;455    	data[3]=0;
;;;456    	lc640_write_long_ptr(lc640_adr+4,data);
;;;457    
;;;458    	data[0]=LPC_RTC->YEAR;
00060e  4fbe              LDR      r7,|L1.2312|
000610  49be              LDR      r1,|L1.2316|
000612  f44f6560          MOV      r5,#0xe00             ;435
000616  f04f0800          MOV      r8,#0                 ;437
00061a  f44f6980          MOV      r9,#0x400             ;444
00061e  2801              CMP      r0,#1                 ;422
000620  d002              BEQ      |L1.1576|
;;;459    	data[1]=LPC_RTC->MONTH;
;;;460    	data[2]=LPC_RTC->DOM;
;;;461    	data[3]=0;
;;;462    	lc640_write_long_ptr(lc640_adr+8,data);
;;;463    
;;;464    	data[0]=LPC_RTC->HOUR;
;;;465    	data[1]=LPC_RTC->MIN;
;;;466    	data[2]=LPC_RTC->SEC;
;;;467    	data[3]=0;
;;;468    	lc640_write_long_ptr(lc640_adr+12,data);
;;;469    	
;;;470    	data[0]='A';
;;;471    	data[1]='A';
;;;472    	data[2]='A';
;;;473    	data[3]='A';
;;;474    	lc640_write_long_ptr(lc640_adr+16,data);
;;;475    	
;;;476    	data[0]='A';
;;;477    	data[1]='A';
;;;478    	data[2]='A';
;;;479    	data[3]='A';
;;;480    	lc640_write_long_ptr(lc640_adr+20,data);
;;;481    	
;;;482    	data[0]='A';
;;;483    	data[1]='A';
;;;484    	data[2]='A';
;;;485    	data[3]='A';
;;;486    	lc640_write_long_ptr(lc640_adr+24,data);
;;;487    	
;;;488    	data[0]='A';
;;;489    	data[1]='A';
;;;490    	data[2]='A';
;;;491    	data[3]='A';
;;;492    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;493    	
;;;494    /*	memo_out0[0]=0x55;
;;;495         memo_out0[1]=0x00+2;
;;;496         memo_out0[2]=1;
;;;497         memo_out0[3]=0x0b;
;;;498         memo_out0[4]=0x55;
;;;499         memo_out0[5]=0x55; 
;;;500         	
;;;501         memo_out0[6]=crc_87(memo_out0,6);
;;;502    	memo_out0[7]=crc_95(memo_out0,6);
;;;503         usart_out_adr0(memo_out0,8); 
;;;504    	*/
;;;505    	//snmp_trap_send("Main power is off",2,1,0);
;;;506    	}
;;;507    
;;;508    else if(in==0)
000622  2800              CMP      r0,#0
000624  d07e              BEQ      |L1.1828|
000626  e126              B        |L1.2166|
                  |L1.1576|
000628  48b9              LDR      r0,|L1.2320|
00062a  4aba              LDR      r2,|L1.2324|
00062c  f9b00000          LDRSH    r0,[r0,#0]            ;432  ; load_U
000630  f9b22000          LDRSH    r2,[r2,#0]            ;432  ; U_OUT_KONTR_MAX
000634  4290              CMP      r0,r2                 ;432
000636  dd02              BLE      |L1.1598|
000638  f04f0201          MOV      r2,#1                 ;432
00063c  700a              STRB     r2,[r1,#0]            ;432
                  |L1.1598|
00063e  4ab6              LDR      r2,|L1.2328|
000640  f9b22000          LDRSH    r2,[r2,#0]            ;433  ; U_OUT_KONTR_MIN
000644  4290              CMP      r0,r2                 ;433
000646  da02              BGE      |L1.1614|
000648  f04f0002          MOV      r0,#2                 ;433
00064c  7008              STRB     r0,[r1,#0]            ;433
                  |L1.1614|
00064e  4628              MOV      r0,r5                 ;435
000650  f7fffffe          BL       lc640_read_int
000654  f1000001          ADD      r0,r0,#1              ;436
000658  4604              MOV      r4,r0                 ;436
00065a  2c3f              CMP      r4,#0x3f              ;437
00065c  d901              BLS      |L1.1634|
00065e  f04f0400          MOV      r4,#0                 ;437
                  |L1.1634|
000662  b221              SXTH     r1,r4                 ;438
000664  4628              MOV      r0,r5                 ;438
000666  f7fffffe          BL       lc640_write_int
00066a  f6406602          MOV      r6,#0xe02             ;440
00066e  4630              MOV      r0,r6                 ;440
000670  f7fffffe          BL       lc640_read_int
000674  283f              CMP      r0,#0x3f              ;441
000676  d000              BEQ      |L1.1658|
000678  4620              MOV      r0,r4                 ;441
                  |L1.1658|
00067a  b201              SXTH     r1,r0                 ;442
00067c  4630              MOV      r0,r6                 ;442
00067e  f7fffffe          BL       lc640_write_int
000682  4628              MOV      r0,r5                 ;444
000684  f7fffffe          BL       lc640_read_int
000688  eb091540          ADD      r5,r9,r0,LSL #5       ;444
00068c  f04f0051          MOV      r0,#0x51              ;446
000690  f88d0000          STRB     r0,[sp,#0]            ;446
000694  f88d8001          STRB     r8,[sp,#1]            ;447
000698  f04f0441          MOV      r4,#0x41              ;448
00069c  f88d4002          STRB     r4,[sp,#2]            ;448
0006a0  f88d8003          STRB     r8,[sp,#3]            ;449
0006a4  4669              MOV      r1,sp                 ;450
0006a6  4628              MOV      r0,r5                 ;450
0006a8  f7fffffe          BL       lc640_write_long_ptr
0006ac  f8cd8000          STR      r8,[sp,#0]            ;455
0006b0  4669              MOV      r1,sp                 ;456
0006b2  1d28              ADDS     r0,r5,#4              ;456
0006b4  f7fffffe          BL       lc640_write_long_ptr
0006b8  f1070720          ADD      r7,r7,#0x20           ;458
0006bc  8bb8              LDRH     r0,[r7,#0x1c]         ;458
0006be  f88d0000          STRB     r0,[sp,#0]            ;458
0006c2  7e38              LDRB     r0,[r7,#0x18]         ;459
0006c4  f88d0001          STRB     r0,[sp,#1]            ;459
0006c8  7b38              LDRB     r0,[r7,#0xc]          ;460
0006ca  f88d0002          STRB     r0,[sp,#2]            ;460
0006ce  f88d8003          STRB     r8,[sp,#3]            ;461
0006d2  4669              MOV      r1,sp                 ;462
0006d4  f1050008          ADD      r0,r5,#8              ;462
0006d8  f7fffffe          BL       lc640_write_long_ptr
0006dc  7a38              LDRB     r0,[r7,#8]            ;464
0006de  f88d0000          STRB     r0,[sp,#0]            ;464
0006e2  7938              LDRB     r0,[r7,#4]            ;465
0006e4  f88d0001          STRB     r0,[sp,#1]            ;465
0006e8  7838              LDRB     r0,[r7,#0]            ;466
0006ea  f88d0002          STRB     r0,[sp,#2]            ;466
0006ee  f88d8003          STRB     r8,[sp,#3]            ;467
0006f2  4669              MOV      r1,sp                 ;468
0006f4  f105000c          ADD      r0,r5,#0xc            ;468
0006f8  f7fffffe          BL       lc640_write_long_ptr
0006fc  f88d4000          STRB     r4,[sp,#0]            ;470
000700  f88d4001          STRB     r4,[sp,#1]            ;471
000704  f88d4002          STRB     r4,[sp,#2]            ;472
000708  f88d4003          STRB     r4,[sp,#3]            ;473
00070c  4669              MOV      r1,sp                 ;474
00070e  f1050010          ADD      r0,r5,#0x10           ;474
000712  f7fffffe          BL       lc640_write_long_ptr
000716  f88d4000          STRB     r4,[sp,#0]            ;476
00071a  f88d4001          STRB     r4,[sp,#1]            ;477
00071e  f88d4002          STRB     r4,[sp,#2]            ;478
000722  e000              B        |L1.1830|
                  |L1.1828|
000724  e021              B        |L1.1898|
                  |L1.1830|
000726  f88d4003          STRB     r4,[sp,#3]            ;479
00072a  4669              MOV      r1,sp                 ;480
00072c  f1050014          ADD      r0,r5,#0x14           ;480
000730  f7fffffe          BL       lc640_write_long_ptr
000734  f88d4000          STRB     r4,[sp,#0]            ;482
000738  f88d4001          STRB     r4,[sp,#1]            ;483
00073c  f88d4002          STRB     r4,[sp,#2]            ;484
000740  f88d4003          STRB     r4,[sp,#3]            ;485
000744  4669              MOV      r1,sp                 ;486
000746  f1050018          ADD      r0,r5,#0x18           ;486
00074a  f7fffffe          BL       lc640_write_long_ptr
00074e  f88d4000          STRB     r4,[sp,#0]            ;488
000752  f88d4001          STRB     r4,[sp,#1]            ;489
000756  f88d4002          STRB     r4,[sp,#2]            ;490
00075a  f88d4003          STRB     r4,[sp,#3]            ;491
00075e  4669              MOV      r1,sp                 ;492
000760  f105001c          ADD      r0,r5,#0x1c           ;492
000764  f7fffffe          BL       lc640_write_long_ptr
000768  e085              B        |L1.2166|
                  |L1.1898|
;;;509    	{
;;;510    	uout_av=0;
00076a  f8818000          STRB     r8,[r1,#0]
;;;511    
;;;512      /*
;;;513    	SET_REG(C2GSR,3,24,8);
;;;514    	C2MOD=0;
;;;515    	bOUT_FREE2=1;*/
;;;516    
;;;517    
;;;518    	//C2MOD=0;
;;;519    
;;;520    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;521    
;;;522         //beep_init(0x02L,'O');
;;;523    	//a_.av.bAN=0;
;;;524    //	SET_REG(avar_stat,0,0,1);
;;;525    
;;;526    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;527    	
;;;528    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;529    
;;;530        event_ptr=lc640_read_int(PTR_EVENT_LOG);
00076e  4628              MOV      r0,r5
000770  f7fffffe          BL       lc640_read_int
000774  4606              MOV      r6,r0
;;;531    	event_ptr_find=event_ptr;
000776  4634              MOV      r4,r6
                  |L1.1912|
;;;532    avar_uout_hndl_lbl1:
;;;533    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000778  eb091544          ADD      r5,r9,r4,LSL #5
;;;534    
;;;535         lc640_read_long_ptr(lc640_adr,data);
00077c  4669              MOV      r1,sp
00077e  4628              MOV      r0,r5
000780  f7fffffe          BL       lc640_read_long_ptr
;;;536         
;;;537         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
000784  f89d0000          LDRB     r0,[sp,#0]
000788  2851              CMP      r0,#0x51
00078a  d106              BNE      |L1.1946|
00078c  f89d0001          LDRB     r0,[sp,#1]
000790  b918              CBNZ     r0,|L1.1946|
000792  f89d0002          LDRB     r0,[sp,#2]
000796  2841              CMP      r0,#0x41
000798  d008              BEQ      |L1.1964|
                  |L1.1946|
;;;538         	{        
;;;539         	if(event_ptr_find)event_ptr_find--;
00079a  b114              CBZ      r4,|L1.1954|
00079c  f1a40401          SUB      r4,r4,#1
0007a0  e001              B        |L1.1958|
                  |L1.1954|
;;;540         	else event_ptr_find=63;
0007a2  f04f043f          MOV      r4,#0x3f
                  |L1.1958|
;;;541         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0007a6  42b4              CMP      r4,r6
0007a8  d1e6              BNE      |L1.1912|
0007aa  e064              B        |L1.2166|
                  |L1.1964|
;;;542         	else goto avar_uout_hndl_lbl1;
;;;543         	}
;;;544         else 
;;;545         	{
;;;546         	lc640_read_long_ptr(lc640_adr+16,data);
0007ac  4669              MOV      r1,sp
0007ae  f1050010          ADD      r0,r5,#0x10
0007b2  f7fffffe          BL       lc640_read_long_ptr
;;;547         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0007b6  f89d0000          LDRB     r0,[sp,#0]
0007ba  2841              CMP      r0,#0x41
0007bc  d10b              BNE      |L1.2006|
0007be  f89d0001          LDRB     r0,[sp,#1]
0007c2  2841              CMP      r0,#0x41
0007c4  d107              BNE      |L1.2006|
0007c6  f89d0002          LDRB     r0,[sp,#2]
0007ca  2841              CMP      r0,#0x41
0007cc  d103              BNE      |L1.2006|
0007ce  f89d0003          LDRB     r0,[sp,#3]
0007d2  2841              CMP      r0,#0x41
0007d4  d008              BEQ      |L1.2024|
                  |L1.2006|
;;;548         		{        
;;;549         		if(event_ptr_find)event_ptr_find--;
0007d6  b114              CBZ      r4,|L1.2014|
0007d8  f1a40401          SUB      r4,r4,#1
0007dc  e001              B        |L1.2018|
                  |L1.2014|
;;;550             		else event_ptr_find=63;
0007de  f04f043f          MOV      r4,#0x3f
                  |L1.2018|
;;;551             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0007e2  42b4              CMP      r4,r6
0007e4  d1c8              BNE      |L1.1912|
0007e6  e046              B        |L1.2166|
                  |L1.2024|
;;;552         		else goto avar_uout_hndl_lbl1;
;;;553         		}
;;;554    
;;;555         	}	
;;;556    	
;;;557    	data[0]=LPC_RTC->YEAR;
0007e8  f1070720          ADD      r7,r7,#0x20
0007ec  8bb8              LDRH     r0,[r7,#0x1c]
0007ee  f88d0000          STRB     r0,[sp,#0]
;;;558    	data[1]=LPC_RTC->MONTH;
0007f2  7e38              LDRB     r0,[r7,#0x18]
0007f4  f88d0001          STRB     r0,[sp,#1]
;;;559    	data[2]=LPC_RTC->DOM;
0007f8  7b38              LDRB     r0,[r7,#0xc]
0007fa  f88d0002          STRB     r0,[sp,#2]
;;;560    	data[3]=0;
0007fe  f88d8003          STRB     r8,[sp,#3]
;;;561    	lc640_write_long_ptr(lc640_adr+16,data);
000802  4669              MOV      r1,sp
000804  f1050010          ADD      r0,r5,#0x10
000808  f7fffffe          BL       lc640_write_long_ptr
;;;562    
;;;563    	data[0]=LPC_RTC->HOUR;
00080c  7a38              LDRB     r0,[r7,#8]
00080e  f88d0000          STRB     r0,[sp,#0]
;;;564    	data[1]=LPC_RTC->MIN;
000812  7938              LDRB     r0,[r7,#4]
000814  f88d0001          STRB     r0,[sp,#1]
;;;565    	data[2]=LPC_RTC->SEC;
000818  7838              LDRB     r0,[r7,#0]
00081a  f88d0002          STRB     r0,[sp,#2]
;;;566    	data[3]=0;
00081e  f88d8003          STRB     r8,[sp,#3]
;;;567    	lc640_write_long_ptr(lc640_adr+20,data); 
000822  4669              MOV      r1,sp
000824  f1050014          ADD      r0,r5,#0x14
000828  f7fffffe          BL       lc640_write_long_ptr
;;;568    	
;;;569    	data[0]=*((char*)(&net_Ustore));
00082c  482f              LDR      r0,|L1.2284|
00082e  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000830  f88d1000          STRB     r1,[sp,#0]
;;;570    	data[1]=*(((char*)(&net_Ustore))+1);
000834  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000836  f88d0001          STRB     r0,[sp,#1]
;;;571    	data[2]='B';
00083a  f04f0442          MOV      r4,#0x42
00083e  f88d4002          STRB     r4,[sp,#2]
;;;572    	data[3]='B';
000842  f88d4003          STRB     r4,[sp,#3]
;;;573    	lc640_write_long_ptr(lc640_adr+24,data);
000846  4669              MOV      r1,sp
000848  f1050018          ADD      r0,r5,#0x18
00084c  f7fffffe          BL       lc640_write_long_ptr
;;;574    	
;;;575    	data[0]='B';
000850  f88d4000          STRB     r4,[sp,#0]
;;;576    	data[1]='B';
000854  f88d4001          STRB     r4,[sp,#1]
;;;577    	data[2]='B';
000858  f88d4002          STRB     r4,[sp,#2]
;;;578    	data[3]='B';
00085c  f88d4003          STRB     r4,[sp,#3]
;;;579    	lc640_write_long_ptr(lc640_adr+28,data);	
000860  4669              MOV      r1,sp
000862  f105001c          ADD      r0,r5,#0x1c
000866  f7fffffe          BL       lc640_write_long_ptr
;;;580    	
;;;581    /*	memo_out0[0]=0x55;
;;;582         memo_out0[1]=0x00+2;
;;;583         memo_out0[2]=1;
;;;584         memo_out0[3]=0x0b;
;;;585         memo_out0[4]=0xaa;
;;;586         memo_out0[5]=0xaa; 
;;;587         	
;;;588         memo_out0[6]=crc_87(memo_out0,6);
;;;589    	memo_out0[7]=crc_95(memo_out0,6);
;;;590         usart_out_adr0(memo_out0,8); */
;;;591         snmp_trap_send("Main power is on",2,1,1);	
00086a  2301              MOVS     r3,#1
00086c  461a              MOV      r2,r3
00086e  2102              MOVS     r1,#2
000870  a02a              ADR      r0,|L1.2332|
000872  f7fffffe          BL       snmp_trap_send
                  |L1.2166|
;;;592    	}
;;;593    avar_unet_hndl_end:
;;;594    	__nop();		
000876  bf00              NOP      
;;;595    }
000878  e6c5              B        |L1.1542|
;;;596    
                          ENDP

                  avar_bps_hndl PROC
;;;597    //-----------------------------------------------
;;;598    void avar_bps_hndl(char dev, char v, char in)
00087a  e92d4ff8          PUSH     {r3-r11,lr}
;;;599    {
00087e  4606              MOV      r6,r0
000880  460c              MOV      r4,r1
;;;600    char data[4];
;;;601    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;602    char avar_simbol;
;;;603    
;;;604    avar_simbol='T';
000882  f04f0754          MOV      r7,#0x54
;;;605    if(v==0)avar_simbol='T';
000886  b174              CBZ      r4,|L1.2214|
;;;606    else if(v==1)avar_simbol='U';
000888  2c01              CMP      r4,#1
00088a  d004              BEQ      |L1.2198|
;;;607    else if(v==2)avar_simbol='u';
00088c  2c02              CMP      r4,#2
00088e  d005              BEQ      |L1.2204|
;;;608    else if(v==3)avar_simbol='L';
000890  2c03              CMP      r4,#3
000892  d006              BEQ      |L1.2210|
000894  e007              B        |L1.2214|
                  |L1.2198|
000896  f04f0755          MOV      r7,#0x55              ;606
00089a  e004              B        |L1.2214|
                  |L1.2204|
00089c  f04f0775          MOV      r7,#0x75              ;607
0008a0  e001              B        |L1.2214|
                  |L1.2210|
0008a2  f04f074c          MOV      r7,#0x4c
                  |L1.2214|
;;;609    
;;;610    if(in==1)
;;;611    	{
;;;612    	//av_src[bps]=1;
;;;613    
;;;614    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;615    //	SET_REG(avar_stat,1,3+dev,1);
;;;616    	
;;;617    	if(v==0)bps[dev]._av|=(1<<0);
0008a6  4822              LDR      r0,|L1.2352|
0008a8  ebc601c6          RSB      r1,r6,r6,LSL #3
;;;618    	else if(v==1) bps[dev]._av|=(1<<1);
;;;619    	else if(v==2) bps[dev]._av|=(1<<2);
;;;620    	else if(v==3) bps[dev]._av|=(1<<3);
;;;621    
;;;622    	bps[dev]._last_avar=v;
;;;623    
;;;624    	//beep_init(0x33333333,'A');
;;;625    
;;;626    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;627    	event_ptr++;	
;;;628    	if(event_ptr>63)event_ptr=0;	
;;;629    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;630    	
;;;631         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;632    	if(event_cnt!=63)event_cnt=event_ptr;
;;;633    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;634    	
;;;635    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;636    	
;;;637    	data[0]='S';
;;;638    	data[1]=dev; 
;;;639    	data[2]=avar_simbol;
;;;640    	data[3]=0;
;;;641    	lc640_write_long_ptr(lc640_adr,data);
;;;642    
;;;643    	data[0]=0;
;;;644    	data[1]=0;
;;;645    	data[2]=0;
;;;646    	data[3]=0;
;;;647    	lc640_write_long_ptr(lc640_adr+4,data);
;;;648    
;;;649    	data[0]=LPC_RTC->YEAR;
0008ac  f8df8058          LDR      r8,|L1.2312|
0008b0  eb011106          ADD      r1,r1,r6,LSL #4       ;617
0008b4  f04f0900          MOV      r9,#0                 ;599
0008b8  f44f6a60          MOV      r10,#0xe00            ;626
0008bc  f44f6580          MOV      r5,#0x400             ;635
0008c0  eb000081          ADD      r0,r0,r1,LSL #2       ;617
0008c4  2a01              CMP      r2,#1                 ;610
0008c6  d035              BEQ      |L1.2356|
;;;650    	data[1]=LPC_RTC->MONTH;
;;;651    	data[2]=LPC_RTC->DOM;
;;;652    	data[3]=0;
;;;653    	lc640_write_long_ptr(lc640_adr+8,data);
;;;654    
;;;655    	data[0]=LPC_RTC->HOUR;
;;;656    	data[1]=LPC_RTC->MIN;
;;;657    	data[2]=LPC_RTC->SEC;
;;;658    	data[3]=0;
;;;659    	lc640_write_long_ptr(lc640_adr+12,data);
;;;660    	
;;;661    	data[0]='A';
;;;662    	data[1]='A';
;;;663    	data[2]='A';
;;;664    	data[3]='A';
;;;665    	lc640_write_long_ptr(lc640_adr+16,data);
;;;666    	
;;;667    	data[0]='A';
;;;668    	data[1]='A';
;;;669    	data[2]='A';
;;;670    	data[3]='A';
;;;671    	lc640_write_long_ptr(lc640_adr+20,data);
;;;672    	
;;;673    	data[0]='A';
;;;674    	data[1]='A';
;;;675    	data[2]='A';
;;;676    	data[3]='A';
;;;677    	lc640_write_long_ptr(lc640_adr+24,data);
;;;678    	
;;;679    	data[0]='A';
;;;680    	data[1]='A';
;;;681    	data[2]='A';
;;;682    	data[3]='A';
;;;683    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;684    
;;;685    
;;;686    	if(dev==0)
;;;687    		{
;;;688    		if(v==0)
;;;689    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;690    		else if(v==1)
;;;691    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;692    		else if(v==2)
;;;693    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;694    		else if(v==3)
;;;695    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;696    		}
;;;697    	else if(dev==1)
;;;698    		{
;;;699    		if(v==0)
;;;700    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;701    		else if(v==1)
;;;702    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;703    		else if(v==2)
;;;704    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;705    		else if(v==3)
;;;706    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;707    		} 
;;;708    	else if(dev==2)
;;;709    		{
;;;710    		if(v==0)
;;;711    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;712    		else if(v==1)
;;;713    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;714    		else if(v==2)
;;;715    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;716    		else if(v==3)
;;;717    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;718    		} 	
;;;719    			
;;;720    	}
;;;721    
;;;722    else if(in==0)
0008c8  2a00              CMP      r2,#0
0008ca  d07d              BEQ      |L1.2504|
0008cc  e1f7              B        |L1.3262|
0008ce  0000              DCW      0x0000
                  |L1.2256|
0008d0  4d61696e          DCB      "Main power alarm",0
0008d4  20706f77
0008d8  65722061
0008dc  6c61726d
0008e0  00      
0008e1  00                DCB      0
0008e2  00                DCB      0
0008e3  00                DCB      0
                  |L1.2276|
                          DCD      ||.data||
                  |L1.2280|
                          DCD      AV_OFF_AVT
                  |L1.2284|
                          DCD      net_Ustore
                  |L1.2288|
0008f0  4d61696e          DCB      "Main power alarm  clear",0
0008f4  20706f77
0008f8  65722061
0008fc  6c61726d
000900  2020636c
000904  65617200
                  |L1.2312|
                          DCD      0x40024000
                  |L1.2316|
                          DCD      uout_av
                  |L1.2320|
                          DCD      load_U
                  |L1.2324|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2328|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2332|
00091c  4d61696e          DCB      "Main power is on",0
000920  20706f77
000924  65722069
000928  73206f6e
00092c  00      
00092d  00                DCB      0
00092e  00                DCB      0
00092f  00                DCB      0
                  |L1.2352|
                          DCD      bps
                  |L1.2356|
000934  b134              CBZ      r4,|L1.2372|
000936  2c01              CMP      r4,#1                 ;618
000938  d009              BEQ      |L1.2382|
00093a  2c02              CMP      r4,#2                 ;619
00093c  d00c              BEQ      |L1.2392|
00093e  2c03              CMP      r4,#3                 ;620
000940  d00f              BEQ      |L1.2402|
000942  e012              B        |L1.2410|
                  |L1.2372|
000944  7841              LDRB     r1,[r0,#1]            ;617
000946  f0410101          ORR      r1,r1,#1              ;617
00094a  7041              STRB     r1,[r0,#1]            ;617
00094c  e00d              B        |L1.2410|
                  |L1.2382|
00094e  7841              LDRB     r1,[r0,#1]            ;618
000950  f0410102          ORR      r1,r1,#2              ;618
000954  7041              STRB     r1,[r0,#1]            ;618
000956  e008              B        |L1.2410|
                  |L1.2392|
000958  7841              LDRB     r1,[r0,#1]            ;619
00095a  f0410104          ORR      r1,r1,#4              ;619
00095e  7041              STRB     r1,[r0,#1]            ;619
000960  e003              B        |L1.2410|
                  |L1.2402|
000962  7841              LDRB     r1,[r0,#1]            ;620
000964  f0410108          ORR      r1,r1,#8              ;620
000968  7041              STRB     r1,[r0,#1]            ;620
                  |L1.2410|
00096a  f8804053          STRB     r4,[r0,#0x53]         ;622
00096e  4650              MOV      r0,r10                ;626
000970  f7fffffe          BL       lc640_read_int
000974  f1000001          ADD      r0,r0,#1              ;627
000978  fa1ffb80          UXTH     r11,r0                ;627
00097c  f1bb0f3f          CMP      r11,#0x3f             ;628
000980  d901              BLS      |L1.2438|
000982  f04f0b00          MOV      r11,#0                ;628
                  |L1.2438|
000986  fa0ff18b          SXTH     r1,r11                ;629
00098a  4650              MOV      r0,r10                ;629
00098c  f7fffffe          BL       lc640_write_int
000990  f6406002          MOV      r0,#0xe02             ;631
000994  f7fffffe          BL       lc640_read_int
000998  b280              UXTH     r0,r0                 ;631
00099a  283f              CMP      r0,#0x3f              ;632
00099c  d000              BEQ      |L1.2464|
00099e  4658              MOV      r0,r11                ;632
                  |L1.2464|
0009a0  b201              SXTH     r1,r0                 ;633
0009a2  f6406002          MOV      r0,#0xe02             ;633
0009a6  f7fffffe          BL       lc640_write_int
0009aa  4650              MOV      r0,r10                ;635
0009ac  f7fffffe          BL       lc640_read_int
0009b0  eb051040          ADD      r0,r5,r0,LSL #5       ;635
0009b4  b285              UXTH     r5,r0                 ;635
0009b6  f04f0053          MOV      r0,#0x53              ;637
0009ba  f88d0000          STRB     r0,[sp,#0]            ;637
0009be  f88d6001          STRB     r6,[sp,#1]            ;638
0009c2  f88d7002          STRB     r7,[sp,#2]            ;639
0009c6  e000              B        |L1.2506|
                  |L1.2504|
0009c8  e0d9              B        |L1.2942|
                  |L1.2506|
0009ca  f88d9003          STRB     r9,[sp,#3]            ;640
0009ce  4669              MOV      r1,sp                 ;641
0009d0  4628              MOV      r0,r5                 ;641
0009d2  f7fffffe          BL       lc640_write_long_ptr
0009d6  f8cd9000          STR      r9,[sp,#0]            ;646
0009da  4669              MOV      r1,sp                 ;647
0009dc  1d28              ADDS     r0,r5,#4              ;647
0009de  f7fffffe          BL       lc640_write_long_ptr
0009e2  f8b8003c          LDRH     r0,[r8,#0x3c]         ;649
0009e6  f88d0000          STRB     r0,[sp,#0]            ;649
0009ea  f8980038          LDRB     r0,[r8,#0x38]         ;650
0009ee  f88d0001          STRB     r0,[sp,#1]            ;650
0009f2  f898002c          LDRB     r0,[r8,#0x2c]         ;651
0009f6  f88d0002          STRB     r0,[sp,#2]            ;651
0009fa  f88d9003          STRB     r9,[sp,#3]            ;652
0009fe  4669              MOV      r1,sp                 ;653
000a00  f1050008          ADD      r0,r5,#8              ;653
000a04  f7fffffe          BL       lc640_write_long_ptr
000a08  f8980028          LDRB     r0,[r8,#0x28]         ;655
000a0c  f88d0000          STRB     r0,[sp,#0]            ;655
000a10  f8980024          LDRB     r0,[r8,#0x24]         ;656
000a14  f88d0001          STRB     r0,[sp,#1]            ;656
000a18  f8980020          LDRB     r0,[r8,#0x20]         ;657
000a1c  f88d0002          STRB     r0,[sp,#2]            ;657
000a20  f88d9003          STRB     r9,[sp,#3]            ;658
000a24  4669              MOV      r1,sp                 ;659
000a26  f105000c          ADD      r0,r5,#0xc            ;659
000a2a  f7fffffe          BL       lc640_write_long_ptr
000a2e  f04f0741          MOV      r7,#0x41              ;661
000a32  f88d7000          STRB     r7,[sp,#0]            ;661
000a36  f88d7001          STRB     r7,[sp,#1]            ;662
000a3a  f88d7002          STRB     r7,[sp,#2]            ;663
000a3e  f88d7003          STRB     r7,[sp,#3]            ;664
000a42  4669              MOV      r1,sp                 ;665
000a44  f1050010          ADD      r0,r5,#0x10           ;665
000a48  f7fffffe          BL       lc640_write_long_ptr
000a4c  f88d7000          STRB     r7,[sp,#0]            ;667
000a50  f88d7001          STRB     r7,[sp,#1]            ;668
000a54  f88d7002          STRB     r7,[sp,#2]            ;669
000a58  f88d7003          STRB     r7,[sp,#3]            ;670
000a5c  4669              MOV      r1,sp                 ;671
000a5e  f1050014          ADD      r0,r5,#0x14           ;671
000a62  f7fffffe          BL       lc640_write_long_ptr
000a66  f88d7000          STRB     r7,[sp,#0]            ;673
000a6a  f88d7001          STRB     r7,[sp,#1]            ;674
000a6e  f88d7002          STRB     r7,[sp,#2]            ;675
000a72  f88d7003          STRB     r7,[sp,#3]            ;676
000a76  4669              MOV      r1,sp                 ;677
000a78  f1050018          ADD      r0,r5,#0x18           ;677
000a7c  f7fffffe          BL       lc640_write_long_ptr
000a80  f88d7000          STRB     r7,[sp,#0]            ;679
000a84  f88d7001          STRB     r7,[sp,#1]            ;680
000a88  f88d7002          STRB     r7,[sp,#2]            ;681
000a8c  f88d7003          STRB     r7,[sp,#3]            ;682
000a90  4669              MOV      r1,sp                 ;683
000a92  f105001c          ADD      r0,r5,#0x1c           ;683
000a96  f7fffffe          BL       lc640_write_long_ptr
000a9a  b126              CBZ      r6,|L1.2726|
000a9c  2e01              CMP      r6,#1                 ;697
000a9e  d026              BEQ      |L1.2798|
000aa0  2e02              CMP      r6,#2                 ;708
000aa2  d048              BEQ      |L1.2870|
000aa4  e10b              B        |L1.3262|
                  |L1.2726|
000aa6  b134              CBZ      r4,|L1.2742|
000aa8  2c01              CMP      r4,#1                 ;690
000aaa  d00b              BEQ      |L1.2756|
000aac  2c02              CMP      r4,#2                 ;692
000aae  d010              BEQ      |L1.2770|
000ab0  2c03              CMP      r4,#3                 ;694
000ab2  d015              BEQ      |L1.2784|
000ab4  e103              B        |L1.3262|
                  |L1.2742|
000ab6  2300              MOVS     r3,#0                 ;689
000ab8  2201              MOVS     r2,#1                 ;689
000aba  2104              MOVS     r1,#4                 ;689
000abc  a0d7              ADR      r0,|L1.3612|
000abe  f7fffffe          BL       snmp_trap_send
000ac2  e0fc              B        |L1.3262|
                  |L1.2756|
000ac4  2301              MOVS     r3,#1                 ;691
000ac6  461a              MOV      r2,r3                 ;691
000ac8  2104              MOVS     r1,#4                 ;691
000aca  a0da              ADR      r0,|L1.3636|
000acc  f7fffffe          BL       snmp_trap_send
000ad0  e0f5              B        |L1.3262|
                  |L1.2770|
000ad2  2302              MOVS     r3,#2                 ;693
000ad4  2201              MOVS     r2,#1                 ;693
000ad6  2104              MOVS     r1,#4                 ;693
000ad8  a0dd              ADR      r0,|L1.3664|
000ada  f7fffffe          BL       snmp_trap_send
000ade  e0ee              B        |L1.3262|
                  |L1.2784|
000ae0  2303              MOVS     r3,#3                 ;695
000ae2  2201              MOVS     r2,#1                 ;695
000ae4  2104              MOVS     r1,#4                 ;695
000ae6  a0e2              ADR      r0,|L1.3696|
000ae8  f7fffffe          BL       snmp_trap_send
000aec  e0e7              B        |L1.3262|
                  |L1.2798|
000aee  b134              CBZ      r4,|L1.2814|
000af0  2c01              CMP      r4,#1                 ;701
000af2  d00b              BEQ      |L1.2828|
000af4  2c02              CMP      r4,#2                 ;703
000af6  d010              BEQ      |L1.2842|
000af8  2c03              CMP      r4,#3                 ;705
000afa  d015              BEQ      |L1.2856|
000afc  e0df              B        |L1.3262|
                  |L1.2814|
000afe  2300              MOVS     r3,#0                 ;700
000b00  2202              MOVS     r2,#2                 ;700
000b02  2104              MOVS     r1,#4                 ;700
000b04  a0e2              ADR      r0,|L1.3728|
000b06  f7fffffe          BL       snmp_trap_send
000b0a  e0d8              B        |L1.3262|
                  |L1.2828|
000b0c  2301              MOVS     r3,#1                 ;702
000b0e  2202              MOVS     r2,#2                 ;702
000b10  2104              MOVS     r1,#4                 ;702
000b12  a0e5              ADR      r0,|L1.3752|
000b14  f7fffffe          BL       snmp_trap_send
000b18  e0d1              B        |L1.3262|
                  |L1.2842|
000b1a  2302              MOVS     r3,#2                 ;704
000b1c  461a              MOV      r2,r3                 ;704
000b1e  2104              MOVS     r1,#4                 ;704
000b20  a0e8              ADR      r0,|L1.3780|
000b22  f7fffffe          BL       snmp_trap_send
000b26  e0ca              B        |L1.3262|
                  |L1.2856|
000b28  2303              MOVS     r3,#3                 ;706
000b2a  2202              MOVS     r2,#2                 ;706
000b2c  2104              MOVS     r1,#4                 ;706
000b2e  a0ed              ADR      r0,|L1.3812|
000b30  f7fffffe          BL       snmp_trap_send
000b34  e0c3              B        |L1.3262|
                  |L1.2870|
000b36  b134              CBZ      r4,|L1.2886|
000b38  2c01              CMP      r4,#1                 ;712
000b3a  d00b              BEQ      |L1.2900|
000b3c  2c02              CMP      r4,#2                 ;714
000b3e  d010              BEQ      |L1.2914|
000b40  2c03              CMP      r4,#3                 ;716
000b42  d015              BEQ      |L1.2928|
000b44  e0bb              B        |L1.3262|
                  |L1.2886|
000b46  2300              MOVS     r3,#0                 ;711
000b48  2203              MOVS     r2,#3                 ;711
000b4a  2104              MOVS     r1,#4                 ;711
000b4c  a0ed              ADR      r0,|L1.3844|
000b4e  f7fffffe          BL       snmp_trap_send
000b52  e0b4              B        |L1.3262|
                  |L1.2900|
000b54  2301              MOVS     r3,#1                 ;713
000b56  2203              MOVS     r2,#3                 ;713
000b58  2104              MOVS     r1,#4                 ;713
000b5a  a0f0              ADR      r0,|L1.3868|
000b5c  f7fffffe          BL       snmp_trap_send
000b60  e0ad              B        |L1.3262|
                  |L1.2914|
000b62  2302              MOVS     r3,#2                 ;715
000b64  2203              MOVS     r2,#3                 ;715
000b66  2104              MOVS     r1,#4                 ;715
000b68  a0f3              ADR      r0,|L1.3896|
000b6a  f7fffffe          BL       snmp_trap_send
000b6e  e0a6              B        |L1.3262|
                  |L1.2928|
000b70  2303              MOVS     r3,#3                 ;717
000b72  461a              MOV      r2,r3                 ;717
000b74  2104              MOVS     r1,#4                 ;717
000b76  a0f8              ADR      r0,|L1.3928|
000b78  f7fffffe          BL       snmp_trap_send
000b7c  e09f              B        |L1.3262|
                  |L1.2942|
;;;723    	{      
;;;724    //	av_bps[bps]=0;
;;;725    
;;;726    	//SET_REG(avar_stat,0,3+bps,1);
;;;727    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;728    
;;;729         if(v==0) bps[dev]._av&=(~(1<<0));
000b7e  b134              CBZ      r4,|L1.2958|
;;;730         else if(v==1) bps[dev]._av&=(~(1<<1));
000b80  2c01              CMP      r4,#1
000b82  d009              BEQ      |L1.2968|
;;;731    	else if(v==2) bps[dev]._av&=(~(1<<2));
000b84  2c02              CMP      r4,#2
000b86  d00c              BEQ      |L1.2978|
;;;732    	else if(v==3) bps[dev]._av&=(~(1<<3));
000b88  2c03              CMP      r4,#3
000b8a  d00f              BEQ      |L1.2988|
000b8c  e012              B        |L1.2996|
                  |L1.2958|
000b8e  7841              LDRB     r1,[r0,#1]            ;729
000b90  f0210101          BIC      r1,r1,#1              ;729
000b94  7041              STRB     r1,[r0,#1]            ;729
000b96  e00d              B        |L1.2996|
                  |L1.2968|
000b98  7841              LDRB     r1,[r0,#1]            ;730
000b9a  f0210102          BIC      r1,r1,#2              ;730
000b9e  7041              STRB     r1,[r0,#1]            ;730
000ba0  e008              B        |L1.2996|
                  |L1.2978|
000ba2  7841              LDRB     r1,[r0,#1]            ;731
000ba4  f0210104          BIC      r1,r1,#4              ;731
000ba8  7041              STRB     r1,[r0,#1]            ;731
000baa  e003              B        |L1.2996|
                  |L1.2988|
000bac  7841              LDRB     r1,[r0,#1]
000bae  f0210108          BIC      r1,r1,#8
000bb2  7041              STRB     r1,[r0,#1]
                  |L1.2996|
;;;733         
;;;734    //	if((bps[dev]._av&0x0f==0))
;;;735    //	     {
;;;736    		//SET_REG(avar_stat,0,3+bps,1);
;;;737    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;738    //	     }
;;;739     
;;;740    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000bb4  4650              MOV      r0,r10
000bb6  f7fffffe          BL       lc640_read_int
000bba  fa1ffb80          UXTH     r11,r0
;;;741    	event_ptr_find=event_ptr;
000bbe  465c              MOV      r4,r11
                  |L1.3008|
;;;742    	
;;;743    avar_src_hndl_lbl1: 
;;;744    
;;;745    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000bc0  eb051044          ADD      r0,r5,r4,LSL #5
000bc4  fa1ffa80          UXTH     r10,r0
;;;746    
;;;747         lc640_read_long_ptr(lc640_adr,data);
000bc8  4669              MOV      r1,sp
000bca  4650              MOV      r0,r10
000bcc  f7fffffe          BL       lc640_read_long_ptr
;;;748         
;;;749         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000bd0  f89d0000          LDRB     r0,[sp,#0]
000bd4  2853              CMP      r0,#0x53
000bd6  d107              BNE      |L1.3048|
000bd8  f89d0001          LDRB     r0,[sp,#1]
000bdc  42b0              CMP      r0,r6
000bde  d103              BNE      |L1.3048|
000be0  f89d0002          LDRB     r0,[sp,#2]
000be4  42b8              CMP      r0,r7
000be6  d009              BEQ      |L1.3068|
                  |L1.3048|
;;;750         	{        
;;;751         	if(event_ptr_find)event_ptr_find--;
000be8  b11c              CBZ      r4,|L1.3058|
000bea  f1a40401          SUB      r4,r4,#1
000bee  b2a4              UXTH     r4,r4
000bf0  e001              B        |L1.3062|
                  |L1.3058|
;;;752         	else event_ptr_find=63;
000bf2  f04f043f          MOV      r4,#0x3f
                  |L1.3062|
;;;753         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000bf6  455c              CMP      r4,r11
000bf8  d1e2              BNE      |L1.3008|
000bfa  e060              B        |L1.3262|
                  |L1.3068|
;;;754         	else goto avar_src_hndl_lbl1;
;;;755         	}
;;;756         else 
;;;757         	{
;;;758         	lc640_read_long_ptr(lc640_adr+16,data);
000bfc  4669              MOV      r1,sp
000bfe  f10a0010          ADD      r0,r10,#0x10
000c02  f7fffffe          BL       lc640_read_long_ptr
;;;759         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000c06  f89d0000          LDRB     r0,[sp,#0]
000c0a  2841              CMP      r0,#0x41
000c0c  d10b              BNE      |L1.3110|
000c0e  f89d0001          LDRB     r0,[sp,#1]
000c12  2841              CMP      r0,#0x41
000c14  d107              BNE      |L1.3110|
000c16  f89d0002          LDRB     r0,[sp,#2]
000c1a  2841              CMP      r0,#0x41
000c1c  d103              BNE      |L1.3110|
000c1e  f89d0003          LDRB     r0,[sp,#3]
000c22  2841              CMP      r0,#0x41
000c24  d009              BEQ      |L1.3130|
                  |L1.3110|
;;;760         		{        
;;;761         		if(event_ptr_find)event_ptr_find--;
000c26  b11c              CBZ      r4,|L1.3120|
000c28  f1a40401          SUB      r4,r4,#1
000c2c  b2a4              UXTH     r4,r4
000c2e  e001              B        |L1.3124|
                  |L1.3120|
;;;762             		else event_ptr_find=63;
000c30  f04f043f          MOV      r4,#0x3f
                  |L1.3124|
;;;763             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000c34  455c              CMP      r4,r11
000c36  d1c3              BNE      |L1.3008|
000c38  e041              B        |L1.3262|
                  |L1.3130|
;;;764         		else goto avar_src_hndl_lbl1;
;;;765         		}
;;;766    
;;;767         	}	
;;;768    
;;;769    
;;;770    	
;;;771    	data[0]=LPC_RTC->YEAR;
000c3a  f8b8003c          LDRH     r0,[r8,#0x3c]
000c3e  f88d0000          STRB     r0,[sp,#0]
;;;772    	data[1]=LPC_RTC->MONTH;
000c42  f8980038          LDRB     r0,[r8,#0x38]
000c46  f88d0001          STRB     r0,[sp,#1]
;;;773    	data[2]=LPC_RTC->DOM;
000c4a  f898002c          LDRB     r0,[r8,#0x2c]
000c4e  f88d0002          STRB     r0,[sp,#2]
;;;774    	data[3]=0;
000c52  f88d9003          STRB     r9,[sp,#3]
;;;775    	lc640_write_long_ptr(lc640_adr+16,data);
000c56  4669              MOV      r1,sp
000c58  f10a0010          ADD      r0,r10,#0x10
000c5c  f7fffffe          BL       lc640_write_long_ptr
;;;776    
;;;777    	data[0]=LPC_RTC->HOUR;
000c60  f8980028          LDRB     r0,[r8,#0x28]
000c64  f88d0000          STRB     r0,[sp,#0]
;;;778    	data[1]=LPC_RTC->MIN;
000c68  f8980024          LDRB     r0,[r8,#0x24]
000c6c  f88d0001          STRB     r0,[sp,#1]
;;;779    	data[2]=LPC_RTC->SEC;
000c70  f8980020          LDRB     r0,[r8,#0x20]
000c74  f88d0002          STRB     r0,[sp,#2]
;;;780    	data[3]=0;
000c78  f88d9003          STRB     r9,[sp,#3]
;;;781    	lc640_write_long_ptr(lc640_adr+20,data);
000c7c  4669              MOV      r1,sp
000c7e  f10a0014          ADD      r0,r10,#0x14
000c82  f7fffffe          BL       lc640_write_long_ptr
;;;782    	
;;;783    	data[0]='B';
000c86  f04f0442          MOV      r4,#0x42
000c8a  f88d4000          STRB     r4,[sp,#0]
;;;784    	data[1]='B';
000c8e  f88d4001          STRB     r4,[sp,#1]
;;;785    	data[2]='B';
000c92  f88d4002          STRB     r4,[sp,#2]
;;;786    	data[3]='B';
000c96  f88d4003          STRB     r4,[sp,#3]
;;;787    	lc640_write_long_ptr(lc640_adr+24,data);
000c9a  4669              MOV      r1,sp
000c9c  f10a0018          ADD      r0,r10,#0x18
000ca0  f7fffffe          BL       lc640_write_long_ptr
;;;788    	
;;;789    	data[0]='B';
000ca4  f88d4000          STRB     r4,[sp,#0]
;;;790    	data[1]='B';
000ca8  f88d4001          STRB     r4,[sp,#1]
;;;791    	data[2]='B';
000cac  f88d4002          STRB     r4,[sp,#2]
;;;792    	data[3]='B';
000cb0  f88d4003          STRB     r4,[sp,#3]
;;;793    	lc640_write_long_ptr(lc640_adr+28,data);
000cb4  4669              MOV      r1,sp
000cb6  f10a001c          ADD      r0,r10,#0x1c
000cba  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3262|
;;;794    	
;;;795    	}
;;;796    	
;;;797    avar_src_hndl_end:
;;;798    __nop();		
000cbe  bf00              NOP      
                  |L1.3264|
;;;799    }
000cc0  e8bd8ff8          POP      {r3-r11,pc}
;;;800    
                          ENDP

                  wrk_mem_hndl PROC
;;;801    //-----------------------------------------------
;;;802    void wrk_mem_hndl(char b)
000cc4  e92d41fc          PUSH     {r2-r8,lr}
;;;803    {
000cc8  4606              MOV      r6,r0
;;;804    char data[4];
;;;805    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;806    
;;;807    signed short temp_temp;
;;;808    
;;;809    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000cca  eb060046          ADD      r0,r6,r6,LSL #1
000cce  eb001106          ADD      r1,r0,r6,LSL #4
000cd2  48a9              LDR      r0,|L1.3960|
000cd4  eb000481          ADD      r4,r0,r1,LSL #2
000cd8  8be0              LDRH     r0,[r4,#0x1e]
000cda  2805              CMP      r0,#5
000cdc  d37e              BCC      |L1.3548|
;;;810    
;;;811    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000cde  48a7              LDR      r0,|L1.3964|
000ce0  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000ce2  f1000006          ADD      r0,r0,#6
000ce6  f0000007          AND      r0,r0,#7
000cea  eb040040          ADD      r0,r4,r0,LSL #1
000cee  8c00              LDRH     r0,[r0,#0x20]
000cf0  9000              STR      r0,[sp,#0]
;;;812    
;;;813    
;;;814    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000cf2  f44f6760          MOV      r7,#0xe00
000cf6  4638              MOV      r0,r7
000cf8  f7fffffe          BL       lc640_read_int
;;;815    event_ptr++;	
000cfc  f1000001          ADD      r0,r0,#1
000d00  b285              UXTH     r5,r0
;;;816    if(event_ptr>63)event_ptr=0;	
000d02  2d3f              CMP      r5,#0x3f
000d04  d901              BLS      |L1.3338|
000d06  f04f0500          MOV      r5,#0
                  |L1.3338|
;;;817    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000d0a  b229              SXTH     r1,r5
000d0c  4638              MOV      r0,r7
000d0e  f7fffffe          BL       lc640_write_int
;;;818    	
;;;819    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000d12  f6406802          MOV      r8,#0xe02
000d16  4640              MOV      r0,r8
000d18  f7fffffe          BL       lc640_read_int
000d1c  b280              UXTH     r0,r0
;;;820    if(event_cnt!=63)event_cnt=event_ptr;
000d1e  283f              CMP      r0,#0x3f
000d20  d000              BEQ      |L1.3364|
000d22  4628              MOV      r0,r5
                  |L1.3364|
;;;821    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000d24  b201              SXTH     r1,r0
000d26  4640              MOV      r0,r8
000d28  f7fffffe          BL       lc640_write_int
;;;822    	
;;;823    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000d2c  4638              MOV      r0,r7
000d2e  f7fffffe          BL       lc640_read_int
000d32  f44f6180          MOV      r1,#0x400
000d36  eb011040          ADD      r0,r1,r0,LSL #5
000d3a  b285              UXTH     r5,r0
;;;824    	
;;;825    data[0]='B';
000d3c  f04f0042          MOV      r0,#0x42
000d40  f88d0004          STRB     r0,[sp,#4]
;;;826    data[1]=b; 
000d44  f88d6005          STRB     r6,[sp,#5]
;;;827    data[2]='W';
000d48  f04f0057          MOV      r0,#0x57
000d4c  f88d0006          STRB     r0,[sp,#6]
;;;828    data[3]=0;
000d50  f04f0600          MOV      r6,#0
000d54  f88d6007          STRB     r6,[sp,#7]
;;;829    
;;;830    lc640_write_long_ptr(lc640_adr,data);
000d58  a901              ADD      r1,sp,#4
000d5a  4628              MOV      r0,r5
000d5c  f7fffffe          BL       lc640_write_long_ptr
;;;831    
;;;832    data[0]=*((char*)&bat[b]._Iintegr_);
000d60  7fa0              LDRB     r0,[r4,#0x1e]
000d62  f88d0004          STRB     r0,[sp,#4]
;;;833    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000d66  7fe0              LDRB     r0,[r4,#0x1f]
000d68  f88d0005          STRB     r0,[sp,#5]
;;;834    data[2]=*((char*)&temp_temp);
000d6c  f89d0000          LDRB     r0,[sp,#0]
000d70  f88d0006          STRB     r0,[sp,#6]
;;;835    data[3]=*(((char*)(&temp_temp))+1);
000d74  f89d0001          LDRB     r0,[sp,#1]
000d78  f88d0007          STRB     r0,[sp,#7]
;;;836    lc640_write_long_ptr(lc640_adr+4,data);
000d7c  a901              ADD      r1,sp,#4
000d7e  1d28              ADDS     r0,r5,#4
000d80  f7fffffe          BL       lc640_write_long_ptr
;;;837    
;;;838    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000d84  f1040134          ADD      r1,r4,#0x34
000d88  f1050008          ADD      r0,r5,#8
000d8c  f7fffffe          BL       lc640_write_long_ptr
;;;839    	
;;;840    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000d90  f1040138          ADD      r1,r4,#0x38
000d94  f105000c          ADD      r0,r5,#0xc
000d98  f7fffffe          BL       lc640_write_long_ptr
;;;841    
;;;842    data[0]=LPC_RTC->YEAR;
000d9c  4c78              LDR      r4,|L1.3968|
000d9e  8ba0              LDRH     r0,[r4,#0x1c]
000da0  f88d0004          STRB     r0,[sp,#4]
;;;843    data[1]=LPC_RTC->MONTH;
000da4  7e20              LDRB     r0,[r4,#0x18]
000da6  f88d0005          STRB     r0,[sp,#5]
;;;844    data[2]=LPC_RTC->DOM;
000daa  7b20              LDRB     r0,[r4,#0xc]
000dac  f88d0006          STRB     r0,[sp,#6]
;;;845    data[3]=0;
000db0  f88d6007          STRB     r6,[sp,#7]
;;;846    lc640_write_long_ptr(lc640_adr+16,data);
000db4  a901              ADD      r1,sp,#4
000db6  f1050010          ADD      r0,r5,#0x10
000dba  f7fffffe          BL       lc640_write_long_ptr
;;;847    
;;;848    data[0]=LPC_RTC->HOUR;
000dbe  7a20              LDRB     r0,[r4,#8]
000dc0  f88d0004          STRB     r0,[sp,#4]
;;;849    data[1]=LPC_RTC->MIN;
000dc4  7920              LDRB     r0,[r4,#4]
000dc6  f88d0005          STRB     r0,[sp,#5]
;;;850    data[2]=LPC_RTC->SEC;
000dca  7820              LDRB     r0,[r4,#0]
000dcc  f88d0006          STRB     r0,[sp,#6]
;;;851    data[3]=0;
000dd0  f88d6007          STRB     r6,[sp,#7]
;;;852    lc640_write_long_ptr(lc640_adr+20,data);
000dd4  a901              ADD      r1,sp,#4
000dd6  f1050014          ADD      r0,r5,#0x14
000dda  e000              B        |L1.3550|
                  |L1.3548|
000ddc  e001              B        |L1.3554|
                  |L1.3550|
000dde  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3554|
;;;853    	
;;;854    
;;;855    
;;;856    	
;;;857    wrk_mem_hndl_end:	
;;;858    __nop();
000de2  bf00              NOP      
;;;859    }  
000de4  e8bd81fc          POP      {r2-r8,pc}
;;;860    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;862    //-----------------------------------------------
;;;863    void avar_bat_ips_hndl(char in)
000de8  e92d4ff8          PUSH     {r3-r11,lr}
;;;864    {
000dec  4602              MOV      r2,r0
;;;865    char data[4];
;;;866    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;867    
;;;868    if(in==1)
;;;869    	{
;;;870    	bat_ips._av|=1;
000dee  4865              LDR      r0,|L1.3972|
;;;871        ips_bat_av_stat=1;
000df0  4c65              LDR      r4,|L1.3976|
;;;872    	ips_bat_av_vzvod=1;
000df2  4b66              LDR      r3,|L1.3980|
;;;873    
;;;874    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;875    	event_ptr++;	
;;;876    	if(event_ptr>63)event_ptr=0;	
;;;877    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;878    	
;;;879         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;880    	if(event_cnt!=63)event_cnt=event_ptr;
;;;881    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;882    	
;;;883    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;884    	
;;;885    	data[0]='B';
;;;886    	data[1]=0;
;;;887    	data[2]='C';
;;;888    	data[3]=0;
;;;889    	lc640_write_long_ptr(lc640_adr,data);
;;;890    
;;;891    	data[0]=0;
;;;892    	data[1]=0;
;;;893    	data[2]=0;
;;;894    	data[3]=0;
;;;895    	lc640_write_long_ptr(lc640_adr+4,data);
;;;896    
;;;897    	data[0]=LPC_RTC->YEAR;
000df4  f8df8198          LDR      r8,|L1.3984|
000df8  f890103d          LDRB     r1,[r0,#0x3d]         ;870
000dfc  f04f0742          MOV      r7,#0x42              ;885
000e00  f44f6560          MOV      r5,#0xe00             ;874
000e04  f04f0900          MOV      r9,#0                 ;876
000e08  f44f6a80          MOV      r10,#0x400            ;883
000e0c  2a01              CMP      r2,#1                 ;868
000e0e  d002              BEQ      |L1.3606|
;;;898    	data[1]=LPC_RTC->MONTH;
;;;899    	data[2]=LPC_RTC->DOM;
;;;900    	data[3]=0;
;;;901    	lc640_write_long_ptr(lc640_adr+8,data);
;;;902    
;;;903    	data[0]=LPC_RTC->HOUR;
;;;904    	data[1]=LPC_RTC->MIN;
;;;905    	data[2]=LPC_RTC->SEC;
;;;906    	data[3]=0;
;;;907    	lc640_write_long_ptr(lc640_adr+12,data);
;;;908    	
;;;909    	data[0]='A';
;;;910    	data[1]='A';
;;;911    	data[2]='A';
;;;912    	data[3]='A';
;;;913    	lc640_write_long_ptr(lc640_adr+16,data);
;;;914    	
;;;915    	data[0]='A';
;;;916    	data[1]='A';
;;;917    	data[2]='A';
;;;918    	data[3]='A';
;;;919    	lc640_write_long_ptr(lc640_adr+20,data);
;;;920    	
;;;921    	data[0]='A';
;;;922    	data[1]='A';
;;;923    	data[2]='A';
;;;924    	data[3]='A';
;;;925    	lc640_write_long_ptr(lc640_adr+24,data);
;;;926    	
;;;927    	data[0]='A';
;;;928    	data[1]='A';
;;;929    	data[2]='A';
;;;930    	data[3]='A';
;;;931    	lc640_write_long_ptr(lc640_adr+28,data);
;;;932    					
;;;933    	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;934    		
;;;935    	}
;;;936    
;;;937    else if(in==0)
000e10  2a00              CMP      r2,#0
000e12  d001              BEQ      |L1.3608|
000e14  e1e6              B        |L1.4580|
                  |L1.3606|
000e16  e0bd              B        |L1.3988|
                  |L1.3608|
000e18  e15c              B        |L1.4308|
000e1a  0000              DCW      0x0000
                  |L1.3612|
000e1c  42505320          DCB      "BPS #1 Alarm, overheat",0
000e20  23312041
000e24  6c61726d
000e28  2c206f76
000e2c  65726865
000e30  617400  
000e33  00                DCB      0
                  |L1.3636|
000e34  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000e38  23312041
000e3c  6c61726d
000e40  2c20766f
000e44  6c746167
000e48  65206973
000e4c  20757000
                  |L1.3664|
000e50  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000e54  23312041
000e58  6c61726d
000e5c  2c20766f
000e60  6c746167
000e64  65206973
000e68  20646f77
000e6c  6e00    
000e6e  00                DCB      0
000e6f  00                DCB      0
                  |L1.3696|
000e70  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000e74  23312041
000e78  6c61726d
000e7c  2c20636f
000e80  6e6e6563
000e84  74206973
000e88  206c6f73
000e8c  7400    
000e8e  00                DCB      0
000e8f  00                DCB      0
                  |L1.3728|
000e90  42505320          DCB      "BPS #2 Alarm, overheat",0
000e94  23322041
000e98  6c61726d
000e9c  2c206f76
000ea0  65726865
000ea4  617400  
000ea7  00                DCB      0
                  |L1.3752|
000ea8  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000eac  23322041
000eb0  6c61726d
000eb4  2c20766f
000eb8  6c746167
000ebc  65206973
000ec0  20757000
                  |L1.3780|
000ec4  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000ec8  23322041
000ecc  6c61726d
000ed0  2c20766f
000ed4  6c746167
000ed8  65206973
000edc  20646f77
000ee0  6e00    
000ee2  00                DCB      0
000ee3  00                DCB      0
                  |L1.3812|
000ee4  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000ee8  23322041
000eec  6c61726d
000ef0  2c20636f
000ef4  6e6e6563
000ef8  74206973
000efc  206c6f73
000f00  7400    
000f02  00                DCB      0
000f03  00                DCB      0
                  |L1.3844|
000f04  42505320          DCB      "BPS #3 Alarm, overheat",0
000f08  23332041
000f0c  6c61726d
000f10  2c206f76
000f14  65726865
000f18  617400  
000f1b  00                DCB      0
                  |L1.3868|
000f1c  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000f20  23332041
000f24  6c61726d
000f28  2c20766f
000f2c  6c746167
000f30  65206973
000f34  20757000
                  |L1.3896|
000f38  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000f3c  23332041
000f40  6c61726d
000f44  2c20766f
000f48  6c746167
000f4c  65206973
000f50  20646f77
000f54  6e00    
000f56  00                DCB      0
000f57  00                DCB      0
                  |L1.3928|
000f58  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000f5c  23332041
000f60  6c61726d
000f64  2c20636f
000f68  6e6e6563
000f6c  74206973
000f70  206c6f73
000f74  7400    
000f76  00                DCB      0
000f77  00                DCB      0
                  |L1.3960|
                          DCD      bat
                  |L1.3964|
                          DCD      bat_u_old_cnt
                  |L1.3968|
                          DCD      0x40024020
                  |L1.3972|
                          DCD      bat_ips
                  |L1.3976|
                          DCD      ips_bat_av_stat
                  |L1.3980|
                          DCD      ips_bat_av_vzvod
                  |L1.3984|
                          DCD      0x40024000
                  |L1.3988|
000f94  f0410101          ORR      r1,r1,#1              ;870
000f98  f880103d          STRB     r1,[r0,#0x3d]         ;870
000f9c  f04f0001          MOV      r0,#1                 ;871
000fa0  7020              STRB     r0,[r4,#0]            ;871
000fa2  7018              STRB     r0,[r3,#0]            ;872
000fa4  4628              MOV      r0,r5                 ;874
000fa6  f7fffffe          BL       lc640_read_int
000faa  f1000001          ADD      r0,r0,#1              ;875
000fae  b284              UXTH     r4,r0                 ;875
000fb0  2c3f              CMP      r4,#0x3f              ;876
000fb2  d901              BLS      |L1.4024|
000fb4  f04f0400          MOV      r4,#0                 ;876
                  |L1.4024|
000fb8  b221              SXTH     r1,r4                 ;877
000fba  4628              MOV      r0,r5                 ;877
000fbc  f7fffffe          BL       lc640_write_int
000fc0  f6406602          MOV      r6,#0xe02             ;879
000fc4  4630              MOV      r0,r6                 ;879
000fc6  f7fffffe          BL       lc640_read_int
000fca  b281              UXTH     r1,r0                 ;879
000fcc  293f              CMP      r1,#0x3f              ;880
000fce  d000              BEQ      |L1.4050|
000fd0  4621              MOV      r1,r4                 ;880
                  |L1.4050|
000fd2  b209              SXTH     r1,r1                 ;881
000fd4  4630              MOV      r0,r6                 ;881
000fd6  f7fffffe          BL       lc640_write_int
000fda  4628              MOV      r0,r5                 ;883
000fdc  f7fffffe          BL       lc640_read_int
000fe0  eb0a1040          ADD      r0,r10,r0,LSL #5      ;883
000fe4  b284              UXTH     r4,r0                 ;883
000fe6  f88d7000          STRB     r7,[sp,#0]            ;885
000fea  f88d9001          STRB     r9,[sp,#1]            ;886
000fee  f04f0043          MOV      r0,#0x43              ;887
000ff2  f88d0002          STRB     r0,[sp,#2]            ;887
000ff6  f88d9003          STRB     r9,[sp,#3]            ;888
000ffa  4669              MOV      r1,sp                 ;889
000ffc  4620              MOV      r0,r4                 ;889
000ffe  f7fffffe          BL       lc640_write_long_ptr
001002  f8cd9000          STR      r9,[sp,#0]            ;894
001006  4669              MOV      r1,sp                 ;895
001008  1d20              ADDS     r0,r4,#4              ;895
00100a  f7fffffe          BL       lc640_write_long_ptr
00100e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;897
001012  f88d0000          STRB     r0,[sp,#0]            ;897
001016  f8980038          LDRB     r0,[r8,#0x38]         ;898
00101a  f88d0001          STRB     r0,[sp,#1]            ;898
00101e  f898002c          LDRB     r0,[r8,#0x2c]         ;899
001022  f88d0002          STRB     r0,[sp,#2]            ;899
001026  f88d9003          STRB     r9,[sp,#3]            ;900
00102a  4669              MOV      r1,sp                 ;901
00102c  f1040008          ADD      r0,r4,#8              ;901
001030  f7fffffe          BL       lc640_write_long_ptr
001034  f8980028          LDRB     r0,[r8,#0x28]         ;903
001038  f88d0000          STRB     r0,[sp,#0]            ;903
00103c  f8980024          LDRB     r0,[r8,#0x24]         ;904
001040  f88d0001          STRB     r0,[sp,#1]            ;904
001044  f8980020          LDRB     r0,[r8,#0x20]         ;905
001048  f88d0002          STRB     r0,[sp,#2]            ;905
00104c  f88d9003          STRB     r9,[sp,#3]            ;906
001050  4669              MOV      r1,sp                 ;907
001052  f104000c          ADD      r0,r4,#0xc            ;907
001056  f7fffffe          BL       lc640_write_long_ptr
00105a  f04f0541          MOV      r5,#0x41              ;909
00105e  f88d5000          STRB     r5,[sp,#0]            ;909
001062  f88d5001          STRB     r5,[sp,#1]            ;910
001066  f88d5002          STRB     r5,[sp,#2]            ;911
00106a  f88d5003          STRB     r5,[sp,#3]            ;912
00106e  4669              MOV      r1,sp                 ;913
001070  f1040010          ADD      r0,r4,#0x10           ;913
001074  f7fffffe          BL       lc640_write_long_ptr
001078  f88d5000          STRB     r5,[sp,#0]            ;915
00107c  f88d5001          STRB     r5,[sp,#1]            ;916
001080  f88d5002          STRB     r5,[sp,#2]            ;917
001084  f88d5003          STRB     r5,[sp,#3]            ;918
001088  4669              MOV      r1,sp                 ;919
00108a  f1040014          ADD      r0,r4,#0x14           ;919
00108e  f7fffffe          BL       lc640_write_long_ptr
001092  f88d5000          STRB     r5,[sp,#0]            ;921
001096  f88d5001          STRB     r5,[sp,#1]            ;922
00109a  f88d5002          STRB     r5,[sp,#2]            ;923
00109e  f88d5003          STRB     r5,[sp,#3]            ;924
0010a2  4669              MOV      r1,sp                 ;925
0010a4  f1040018          ADD      r0,r4,#0x18           ;925
0010a8  f7fffffe          BL       lc640_write_long_ptr
0010ac  f88d5000          STRB     r5,[sp,#0]            ;927
0010b0  f88d5001          STRB     r5,[sp,#1]            ;928
0010b4  f88d5002          STRB     r5,[sp,#2]            ;929
0010b8  f88d5003          STRB     r5,[sp,#3]            ;930
0010bc  4669              MOV      r1,sp                 ;931
0010be  f104001c          ADD      r0,r4,#0x1c           ;931
0010c2  f7fffffe          BL       lc640_write_long_ptr
0010c6  2301              MOVS     r3,#1                 ;933
0010c8  461a              MOV      r2,r3                 ;933
0010ca  2105              MOVS     r1,#5                 ;933
0010cc  a0ff              ADR      r0,|L1.5324|
0010ce  f7fffffe          BL       snmp_trap_send
0010d2  e087              B        |L1.4580|
                  |L1.4308|
;;;938    	{
;;;939    	bat_ips._av&=~1;
0010d4  f0210101          BIC      r1,r1,#1
0010d8  f880103d          STRB     r1,[r0,#0x3d]
;;;940    	ips_bat_av_stat=0;
0010dc  f8849000          STRB     r9,[r4,#0]
;;;941    	ips_bat_av_vzvod=0;
0010e0  f8839000          STRB     r9,[r3,#0]
;;;942         
;;;943    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0010e4  4628              MOV      r0,r5
0010e6  f7fffffe          BL       lc640_read_int
0010ea  b286              UXTH     r6,r0
;;;944    	event_ptr_find=event_ptr;
0010ec  4634              MOV      r4,r6
                  |L1.4334|
;;;945    	
;;;946    avar_bat_ips_hndl_lbl1: 
;;;947    
;;;948    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0010ee  eb0a1044          ADD      r0,r10,r4,LSL #5
0010f2  b285              UXTH     r5,r0
;;;949    
;;;950         lc640_read_long_ptr(lc640_adr,data);
0010f4  4669              MOV      r1,sp
0010f6  4628              MOV      r0,r5
0010f8  f7fffffe          BL       lc640_read_long_ptr
;;;951         
;;;952         if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
0010fc  f89d0000          LDRB     r0,[sp,#0]
001100  2842              CMP      r0,#0x42
001102  d106              BNE      |L1.4370|
001104  f89d0001          LDRB     r0,[sp,#1]
001108  b918              CBNZ     r0,|L1.4370|
00110a  f89d0002          LDRB     r0,[sp,#2]
00110e  2843              CMP      r0,#0x43
001110  d009              BEQ      |L1.4390|
                  |L1.4370|
;;;953         	{        
;;;954         	if(event_ptr_find)event_ptr_find--;
001112  b11c              CBZ      r4,|L1.4380|
001114  f1a40401          SUB      r4,r4,#1
001118  b2a4              UXTH     r4,r4
00111a  e001              B        |L1.4384|
                  |L1.4380|
;;;955         	else event_ptr_find=63;
00111c  f04f043f          MOV      r4,#0x3f
                  |L1.4384|
;;;956         	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001120  42b4              CMP      r4,r6
001122  d1e4              BNE      |L1.4334|
001124  e05e              B        |L1.4580|
                  |L1.4390|
;;;957         	else goto avar_bat_ips_hndl_lbl1;
;;;958         	}
;;;959         else 
;;;960         	{
;;;961         	lc640_read_long_ptr(lc640_adr+16,data);
001126  4669              MOV      r1,sp
001128  f1050010          ADD      r0,r5,#0x10
00112c  f7fffffe          BL       lc640_read_long_ptr
;;;962         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001130  f89d0000          LDRB     r0,[sp,#0]
001134  2841              CMP      r0,#0x41
001136  d10b              BNE      |L1.4432|
001138  f89d0001          LDRB     r0,[sp,#1]
00113c  2841              CMP      r0,#0x41
00113e  d107              BNE      |L1.4432|
001140  f89d0002          LDRB     r0,[sp,#2]
001144  2841              CMP      r0,#0x41
001146  d103              BNE      |L1.4432|
001148  f89d0003          LDRB     r0,[sp,#3]
00114c  2841              CMP      r0,#0x41
00114e  d009              BEQ      |L1.4452|
                  |L1.4432|
;;;963         		{        
;;;964         		if(event_ptr_find)event_ptr_find--;
001150  b11c              CBZ      r4,|L1.4442|
001152  f1a40401          SUB      r4,r4,#1
001156  b2a4              UXTH     r4,r4
001158  e001              B        |L1.4446|
                  |L1.4442|
;;;965             		else event_ptr_find=63;
00115a  f04f043f          MOV      r4,#0x3f
                  |L1.4446|
;;;966             	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
00115e  42b4              CMP      r4,r6
001160  d1c5              BNE      |L1.4334|
001162  e03f              B        |L1.4580|
                  |L1.4452|
;;;967         		else goto avar_bat_ips_hndl_lbl1;
;;;968         		}
;;;969    
;;;970         	}
;;;971         		
;;;972    	data[0]=LPC_RTC->YEAR;
001164  f8b8003c          LDRH     r0,[r8,#0x3c]
001168  f88d0000          STRB     r0,[sp,#0]
;;;973    	data[1]=LPC_RTC->MONTH;
00116c  f8980038          LDRB     r0,[r8,#0x38]
001170  f88d0001          STRB     r0,[sp,#1]
;;;974    	data[2]=LPC_RTC->DOM;
001174  f898002c          LDRB     r0,[r8,#0x2c]
001178  f88d0002          STRB     r0,[sp,#2]
;;;975    	data[3]=0;
00117c  f88d9003          STRB     r9,[sp,#3]
;;;976    	lc640_write_long_ptr(lc640_adr+16,data);
001180  4669              MOV      r1,sp
001182  f1050010          ADD      r0,r5,#0x10
001186  f7fffffe          BL       lc640_write_long_ptr
;;;977    
;;;978    	data[0]=LPC_RTC->HOUR;
00118a  f8980028          LDRB     r0,[r8,#0x28]
00118e  f88d0000          STRB     r0,[sp,#0]
;;;979    	data[1]=LPC_RTC->MIN;
001192  f8980024          LDRB     r0,[r8,#0x24]
001196  f88d0001          STRB     r0,[sp,#1]
;;;980    	data[2]=LPC_RTC->SEC;
00119a  f8980020          LDRB     r0,[r8,#0x20]
00119e  f88d0002          STRB     r0,[sp,#2]
;;;981    	data[3]=0;
0011a2  f88d9003          STRB     r9,[sp,#3]
;;;982    	lc640_write_long_ptr(lc640_adr+20,data);
0011a6  4669              MOV      r1,sp
0011a8  f1050014          ADD      r0,r5,#0x14
0011ac  f7fffffe          BL       lc640_write_long_ptr
;;;983    	
;;;984    	data[0]='B';
0011b0  f88d7000          STRB     r7,[sp,#0]
;;;985    	data[1]='B';
0011b4  f88d7001          STRB     r7,[sp,#1]
;;;986    	data[2]='B';
0011b8  f88d7002          STRB     r7,[sp,#2]
;;;987    	data[3]='B';
0011bc  f88d7003          STRB     r7,[sp,#3]
;;;988    	lc640_write_long_ptr(lc640_adr+24,data);
0011c0  4669              MOV      r1,sp
0011c2  f1050018          ADD      r0,r5,#0x18
0011c6  f7fffffe          BL       lc640_write_long_ptr
;;;989    	
;;;990    	data[0]='B';
0011ca  f88d7000          STRB     r7,[sp,#0]
;;;991    	data[1]='B';
0011ce  f88d7001          STRB     r7,[sp,#1]
;;;992    	data[2]='B';
0011d2  f88d7002          STRB     r7,[sp,#2]
;;;993    	data[3]='B';
0011d6  f88d7003          STRB     r7,[sp,#3]
;;;994    	lc640_write_long_ptr(lc640_adr+28,data);
0011da  4669              MOV      r1,sp
0011dc  f105001c          ADD      r0,r5,#0x1c
0011e0  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4580|
;;;995    	
;;;996    
;;;997    	
;;;998    	}
;;;999    	
;;;1000   avar_bat_ips_hndl_end:
;;;1001   __nop();		
0011e4  bf00              NOP      
                  |L1.4582|
;;;1002   }
0011e6  e56b              B        |L1.3264|
;;;1003   
                          ENDP

                  avar_bat_hndl PROC
;;;1006   //-----------------------------------------------
;;;1007   void avar_bat_hndl(char b, char in)
0011e8  e92d4ff8          PUSH     {r3-r11,lr}
;;;1008   {
0011ec  4606              MOV      r6,r0
;;;1009   char data[4];
;;;1010   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1011   
;;;1012   if(in==1)
;;;1013   	{
;;;1014   	bat[b]._av|=1;
0011ee  48bc              LDR      r0,|L1.5344|
0011f0  eb060246          ADD      r2,r6,r6,LSL #1
;;;1015       
;;;1016   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1017   	event_ptr++;	
;;;1018   	if(event_ptr>63)event_ptr=0;	
;;;1019   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1020   	
;;;1021        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1022   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1023   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1024   	
;;;1025   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1026   	
;;;1027   	data[0]='B';
;;;1028   	data[1]=b;
;;;1029   	data[2]='C';
;;;1030   	data[3]=0;
;;;1031   	lc640_write_long_ptr(lc640_adr,data);
;;;1032   
;;;1033   	data[0]=0;
;;;1034   	data[1]=0;
;;;1035   	data[2]=0;
;;;1036   	data[3]=0;
;;;1037   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1038   
;;;1039   	data[0]=LPC_RTC->YEAR;
0011f4  f8df82ec          LDR      r8,|L1.5348|
0011f8  eb021206          ADD      r2,r2,r6,LSL #4       ;1014
0011fc  f04f0a00          MOV      r10,#0                ;1018
001200  f04f0942          MOV      r9,#0x42              ;1027
001204  f44f6560          MOV      r5,#0xe00             ;1016
001208  f44f6b80          MOV      r11,#0x400            ;1025
00120c  eb000082          ADD      r0,r0,r2,LSL #2       ;1014
001210  2901              CMP      r1,#1                 ;1012
001212  d002              BEQ      |L1.4634|
;;;1040   	data[1]=LPC_RTC->MONTH;
;;;1041   	data[2]=LPC_RTC->DOM;
;;;1042   	data[3]=0;
;;;1043   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1044   
;;;1045   	data[0]=LPC_RTC->HOUR;
;;;1046   	data[1]=LPC_RTC->MIN;
;;;1047   	data[2]=LPC_RTC->SEC;
;;;1048   	data[3]=0;
;;;1049   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1050   	
;;;1051   	data[0]='A';
;;;1052   	data[1]='A';
;;;1053   	data[2]='A';
;;;1054   	data[3]='A';
;;;1055   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1056   	
;;;1057   	data[0]='A';
;;;1058   	data[1]='A';
;;;1059   	data[2]='A';
;;;1060   	data[3]='A';
;;;1061   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1062   	
;;;1063   	data[0]='A';
;;;1064   	data[1]='A';
;;;1065   	data[2]='A';
;;;1066   	data[3]='A';
;;;1067   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1068   	
;;;1069   	data[0]='A';
;;;1070   	data[1]='A';
;;;1071   	data[2]='A';
;;;1072   	data[3]='A';
;;;1073   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1074   					
;;;1075   	if(b==0)
;;;1076   		{
;;;1077   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1078   		}
;;;1079   	else if(b==1)
;;;1080   		{
;;;1081   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1082   		} 
;;;1083   			
;;;1084   	}
;;;1085   
;;;1086   else if(in==0)
001214  2900              CMP      r1,#0
001216  d07d              BEQ      |L1.4884|
001218  e12f              B        |L1.5242|
                  |L1.4634|
00121a  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1014
00121e  f0410101          ORR      r1,r1,#1              ;1014
001222  7001              STRB     r1,[r0,#0]            ;1014
001224  4628              MOV      r0,r5                 ;1016
001226  f7fffffe          BL       lc640_read_int
00122a  f1000001          ADD      r0,r0,#1              ;1017
00122e  b284              UXTH     r4,r0                 ;1017
001230  2c3f              CMP      r4,#0x3f              ;1018
001232  d901              BLS      |L1.4664|
001234  f04f0400          MOV      r4,#0                 ;1018
                  |L1.4664|
001238  b221              SXTH     r1,r4                 ;1019
00123a  4628              MOV      r0,r5                 ;1019
00123c  f7fffffe          BL       lc640_write_int
001240  f6406702          MOV      r7,#0xe02             ;1021
001244  4638              MOV      r0,r7                 ;1021
001246  f7fffffe          BL       lc640_read_int
00124a  b280              UXTH     r0,r0                 ;1021
00124c  283f              CMP      r0,#0x3f              ;1022
00124e  d000              BEQ      |L1.4690|
001250  4620              MOV      r0,r4                 ;1022
                  |L1.4690|
001252  b201              SXTH     r1,r0                 ;1023
001254  4638              MOV      r0,r7                 ;1023
001256  f7fffffe          BL       lc640_write_int
00125a  4628              MOV      r0,r5                 ;1025
00125c  f7fffffe          BL       lc640_read_int
001260  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1025
001264  b284              UXTH     r4,r0                 ;1025
001266  f88d9000          STRB     r9,[sp,#0]            ;1027
00126a  f88d6001          STRB     r6,[sp,#1]            ;1028
00126e  f04f0043          MOV      r0,#0x43              ;1029
001272  f88d0002          STRB     r0,[sp,#2]            ;1029
001276  f88da003          STRB     r10,[sp,#3]           ;1030
00127a  4669              MOV      r1,sp                 ;1031
00127c  4620              MOV      r0,r4                 ;1031
00127e  f7fffffe          BL       lc640_write_long_ptr
001282  f8cda000          STR      r10,[sp,#0]           ;1036
001286  4669              MOV      r1,sp                 ;1037
001288  1d20              ADDS     r0,r4,#4              ;1037
00128a  f7fffffe          BL       lc640_write_long_ptr
00128e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1039
001292  f88d0000          STRB     r0,[sp,#0]            ;1039
001296  f8980038          LDRB     r0,[r8,#0x38]         ;1040
00129a  f88d0001          STRB     r0,[sp,#1]            ;1040
00129e  f898002c          LDRB     r0,[r8,#0x2c]         ;1041
0012a2  f88d0002          STRB     r0,[sp,#2]            ;1041
0012a6  f88da003          STRB     r10,[sp,#3]           ;1042
0012aa  4669              MOV      r1,sp                 ;1043
0012ac  f1040008          ADD      r0,r4,#8              ;1043
0012b0  f7fffffe          BL       lc640_write_long_ptr
0012b4  f8980028          LDRB     r0,[r8,#0x28]         ;1045
0012b8  f88d0000          STRB     r0,[sp,#0]            ;1045
0012bc  f8980024          LDRB     r0,[r8,#0x24]         ;1046
0012c0  f88d0001          STRB     r0,[sp,#1]            ;1046
0012c4  f8980020          LDRB     r0,[r8,#0x20]         ;1047
0012c8  f88d0002          STRB     r0,[sp,#2]            ;1047
0012cc  f88da003          STRB     r10,[sp,#3]           ;1048
0012d0  4669              MOV      r1,sp                 ;1049
0012d2  f104000c          ADD      r0,r4,#0xc            ;1049
0012d6  f7fffffe          BL       lc640_write_long_ptr
0012da  f04f0541          MOV      r5,#0x41              ;1051
0012de  f88d5000          STRB     r5,[sp,#0]            ;1051
0012e2  f88d5001          STRB     r5,[sp,#1]            ;1052
0012e6  f88d5002          STRB     r5,[sp,#2]            ;1053
0012ea  f88d5003          STRB     r5,[sp,#3]            ;1054
0012ee  4669              MOV      r1,sp                 ;1055
0012f0  f1040010          ADD      r0,r4,#0x10           ;1055
0012f4  f7fffffe          BL       lc640_write_long_ptr
0012f8  f88d5000          STRB     r5,[sp,#0]            ;1057
0012fc  f88d5001          STRB     r5,[sp,#1]            ;1058
001300  f88d5002          STRB     r5,[sp,#2]            ;1059
001304  f88d5003          STRB     r5,[sp,#3]            ;1060
001308  4669              MOV      r1,sp                 ;1061
00130a  f1040014          ADD      r0,r4,#0x14           ;1061
00130e  f7fffffe          BL       lc640_write_long_ptr
001312  e000              B        |L1.4886|
                  |L1.4884|
001314  e02b              B        |L1.4974|
                  |L1.4886|
001316  f88d5000          STRB     r5,[sp,#0]            ;1063
00131a  f88d5001          STRB     r5,[sp,#1]            ;1064
00131e  f88d5002          STRB     r5,[sp,#2]            ;1065
001322  f88d5003          STRB     r5,[sp,#3]            ;1066
001326  4669              MOV      r1,sp                 ;1067
001328  f1040018          ADD      r0,r4,#0x18           ;1067
00132c  f7fffffe          BL       lc640_write_long_ptr
001330  f88d5000          STRB     r5,[sp,#0]            ;1069
001334  f88d5001          STRB     r5,[sp,#1]            ;1070
001338  f88d5002          STRB     r5,[sp,#2]            ;1071
00133c  f88d5003          STRB     r5,[sp,#3]            ;1072
001340  4669              MOV      r1,sp                 ;1073
001342  f104001c          ADD      r0,r4,#0x1c           ;1073
001346  f7fffffe          BL       lc640_write_long_ptr
00134a  b116              CBZ      r6,|L1.4946|
00134c  2e01              CMP      r6,#1                 ;1079
00134e  d007              BEQ      |L1.4960|
001350  e093              B        |L1.5242|
                  |L1.4946|
001352  2301              MOVS     r3,#1                 ;1077
001354  461a              MOV      r2,r3                 ;1077
001356  2105              MOVS     r1,#5                 ;1077
001358  a063              ADR      r0,|L1.5352|
00135a  f7fffffe          BL       snmp_trap_send
00135e  e08c              B        |L1.5242|
                  |L1.4960|
001360  2301              MOVS     r3,#1                 ;1081
001362  2202              MOVS     r2,#2                 ;1081
001364  2105              MOVS     r1,#5                 ;1081
001366  a065              ADR      r0,|L1.5372|
001368  f7fffffe          BL       snmp_trap_send
00136c  e085              B        |L1.5242|
                  |L1.4974|
;;;1087   	{
;;;1088   	bat[b]._av&=~1;
00136e  f8101f3d          LDRB     r1,[r0,#0x3d]!
001372  f0210101          BIC      r1,r1,#1
001376  7001              STRB     r1,[r0,#0]
;;;1089   
;;;1090        event_ptr=lc640_read_int(PTR_EVENT_LOG);
001378  4628              MOV      r0,r5
00137a  f7fffffe          BL       lc640_read_int
00137e  b287              UXTH     r7,r0
;;;1091   	event_ptr_find=event_ptr;
001380  463c              MOV      r4,r7
                  |L1.4994|
;;;1092   	
;;;1093   avar_bat_hndl_lbl1: 
;;;1094   
;;;1095   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001382  eb0b1044          ADD      r0,r11,r4,LSL #5
001386  b285              UXTH     r5,r0
;;;1096   
;;;1097        lc640_read_long_ptr(lc640_adr,data);
001388  4669              MOV      r1,sp
00138a  4628              MOV      r0,r5
00138c  f7fffffe          BL       lc640_read_long_ptr
;;;1098        
;;;1099        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
001390  f89d0000          LDRB     r0,[sp,#0]
001394  2842              CMP      r0,#0x42
001396  d107              BNE      |L1.5032|
001398  f89d0001          LDRB     r0,[sp,#1]
00139c  42b0              CMP      r0,r6
00139e  d103              BNE      |L1.5032|
0013a0  f89d0002          LDRB     r0,[sp,#2]
0013a4  2843              CMP      r0,#0x43
0013a6  d009              BEQ      |L1.5052|
                  |L1.5032|
;;;1100        	{        
;;;1101        	if(event_ptr_find)event_ptr_find--;
0013a8  b11c              CBZ      r4,|L1.5042|
0013aa  f1a40401          SUB      r4,r4,#1
0013ae  b2a4              UXTH     r4,r4
0013b0  e001              B        |L1.5046|
                  |L1.5042|
;;;1102        	else event_ptr_find=63;
0013b2  f04f043f          MOV      r4,#0x3f
                  |L1.5046|
;;;1103        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
0013b6  42bc              CMP      r4,r7
0013b8  d1e3              BNE      |L1.4994|
0013ba  e05e              B        |L1.5242|
                  |L1.5052|
;;;1104        	else goto avar_bat_hndl_lbl1;
;;;1105        	}
;;;1106        else 
;;;1107        	{
;;;1108        	lc640_read_long_ptr(lc640_adr+16,data);
0013bc  4669              MOV      r1,sp
0013be  f1050010          ADD      r0,r5,#0x10
0013c2  f7fffffe          BL       lc640_read_long_ptr
;;;1109        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0013c6  f89d0000          LDRB     r0,[sp,#0]
0013ca  2841              CMP      r0,#0x41
0013cc  d10b              BNE      |L1.5094|
0013ce  f89d0001          LDRB     r0,[sp,#1]
0013d2  2841              CMP      r0,#0x41
0013d4  d107              BNE      |L1.5094|
0013d6  f89d0002          LDRB     r0,[sp,#2]
0013da  2841              CMP      r0,#0x41
0013dc  d103              BNE      |L1.5094|
0013de  f89d0003          LDRB     r0,[sp,#3]
0013e2  2841              CMP      r0,#0x41
0013e4  d009              BEQ      |L1.5114|
                  |L1.5094|
;;;1110        		{        
;;;1111        		if(event_ptr_find)event_ptr_find--;
0013e6  b11c              CBZ      r4,|L1.5104|
0013e8  f1a40401          SUB      r4,r4,#1
0013ec  b2a4              UXTH     r4,r4
0013ee  e001              B        |L1.5108|
                  |L1.5104|
;;;1112            		else event_ptr_find=63;
0013f0  f04f043f          MOV      r4,#0x3f
                  |L1.5108|
;;;1113            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
0013f4  42bc              CMP      r4,r7
0013f6  d1c4              BNE      |L1.4994|
0013f8  e03f              B        |L1.5242|
                  |L1.5114|
;;;1114        		else goto avar_bat_hndl_lbl1;
;;;1115        		}
;;;1116   
;;;1117        	}
;;;1118        		
;;;1119   	data[0]=LPC_RTC->YEAR;
0013fa  f8b8003c          LDRH     r0,[r8,#0x3c]
0013fe  f88d0000          STRB     r0,[sp,#0]
;;;1120   	data[1]=LPC_RTC->MONTH;
001402  f8980038          LDRB     r0,[r8,#0x38]
001406  f88d0001          STRB     r0,[sp,#1]
;;;1121   	data[2]=LPC_RTC->DOM;
00140a  f898002c          LDRB     r0,[r8,#0x2c]
00140e  f88d0002          STRB     r0,[sp,#2]
;;;1122   	data[3]=0;
001412  f88da003          STRB     r10,[sp,#3]
;;;1123   	lc640_write_long_ptr(lc640_adr+16,data);
001416  4669              MOV      r1,sp
001418  f1050010          ADD      r0,r5,#0x10
00141c  f7fffffe          BL       lc640_write_long_ptr
;;;1124   
;;;1125   	data[0]=LPC_RTC->HOUR;
001420  f8980028          LDRB     r0,[r8,#0x28]
001424  f88d0000          STRB     r0,[sp,#0]
;;;1126   	data[1]=LPC_RTC->MIN;
001428  f8980024          LDRB     r0,[r8,#0x24]
00142c  f88d0001          STRB     r0,[sp,#1]
;;;1127   	data[2]=LPC_RTC->SEC;
001430  f8980020          LDRB     r0,[r8,#0x20]
001434  f88d0002          STRB     r0,[sp,#2]
;;;1128   	data[3]=0;
001438  f88da003          STRB     r10,[sp,#3]
;;;1129   	lc640_write_long_ptr(lc640_adr+20,data);
00143c  4669              MOV      r1,sp
00143e  f1050014          ADD      r0,r5,#0x14
001442  f7fffffe          BL       lc640_write_long_ptr
;;;1130   	
;;;1131   	data[0]='B';
001446  f88d9000          STRB     r9,[sp,#0]
;;;1132   	data[1]='B';
00144a  f88d9001          STRB     r9,[sp,#1]
;;;1133   	data[2]='B';
00144e  f88d9002          STRB     r9,[sp,#2]
;;;1134   	data[3]='B';
001452  f88d9003          STRB     r9,[sp,#3]
;;;1135   	lc640_write_long_ptr(lc640_adr+24,data);
001456  4669              MOV      r1,sp
001458  f1050018          ADD      r0,r5,#0x18
00145c  f7fffffe          BL       lc640_write_long_ptr
;;;1136   	
;;;1137   	data[0]='B';
001460  f88d9000          STRB     r9,[sp,#0]
;;;1138   	data[1]='B';
001464  f88d9001          STRB     r9,[sp,#1]
;;;1139   	data[2]='B';
001468  f88d9002          STRB     r9,[sp,#2]
;;;1140   	data[3]='B';
00146c  f88d9003          STRB     r9,[sp,#3]
;;;1141   	lc640_write_long_ptr(lc640_adr+28,data);
001470  4669              MOV      r1,sp
001472  f105001c          ADD      r0,r5,#0x1c
001476  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5242|
;;;1142   	
;;;1143   
;;;1144   	
;;;1145   	}
;;;1146   	
;;;1147   avar_bat_hndl_end:
;;;1148   __nop();		
00147a  bf00              NOP      
                  |L1.5244|
;;;1149   }
00147c  e420              B        |L1.3264|
;;;1150   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1151   //-----------------------------------------------
;;;1152   void avar_bat_as_hndl(char b, char in)
00147e  e92d4ff8          PUSH     {r3-r11,lr}
;;;1153   {
001482  4606              MOV      r6,r0
;;;1154   char data[4];
;;;1155   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1156   
;;;1157   if(in==1)
;;;1158   	{
;;;1159   	bat[b]._av|=2;
;;;1160       
;;;1161   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1162   	event_ptr++;	
;;;1163   	if(event_ptr>63)event_ptr=0;	
;;;1164   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1165   	
;;;1166        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1167   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1168   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1169   	
;;;1170   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1171   	
;;;1172   	data[0]='B';
;;;1173   	data[1]=b;
;;;1174   	data[2]='S';
;;;1175   	data[3]=0;
;;;1176   	lc640_write_long_ptr(lc640_adr,data);
;;;1177   
;;;1178   	data[0]=0;
;;;1179   	data[1]=0;
;;;1180   	data[2]=0;
;;;1181   	data[3]=0;
;;;1182   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1183   
;;;1184   	data[0]=LPC_RTC->YEAR;
001484  f8df805c          LDR      r8,|L1.5348|
001488  f04f0a00          MOV      r10,#0                ;1163
00148c  f04f0942          MOV      r9,#0x42              ;1172
001490  f44f6560          MOV      r5,#0xe00             ;1161
001494  f44f6b80          MOV      r11,#0x400            ;1170
001498  2901              CMP      r1,#1                 ;1157
00149a  d002              BEQ      |L1.5282|
;;;1185   	data[1]=LPC_RTC->MONTH;
;;;1186   	data[2]=LPC_RTC->DOM;
;;;1187   	data[3]=0;
;;;1188   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1189   
;;;1190   	data[0]=LPC_RTC->HOUR;
;;;1191   	data[1]=LPC_RTC->MIN;
;;;1192   	data[2]=LPC_RTC->SEC;
;;;1193   	data[3]=0;
;;;1194   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1195   	
;;;1196   	data[0]='A';
;;;1197   	data[1]='A';
;;;1198   	data[2]='A';
;;;1199   	data[3]='A';
;;;1200   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1201   	
;;;1202   	data[0]='A';
;;;1203   	data[1]='A';
;;;1204   	data[2]='A';
;;;1205   	data[3]='A';
;;;1206   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1207   	
;;;1208   	data[0]='A';
;;;1209   	data[1]='A';
;;;1210   	data[2]='A';
;;;1211   	data[3]='A';
;;;1212   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1213   	
;;;1214   	data[0]='A';
;;;1215   	data[1]='A';
;;;1216   	data[2]='A';
;;;1217   	data[3]='A';
;;;1218   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1219   
;;;1220   	if(b==0)
;;;1221   		{
;;;1222   		snmp_trap_send("BAT #1 Alarm, assimetry",5,1,2);
;;;1223   		}
;;;1224   	else if(b==1)
;;;1225   		{
;;;1226   		snmp_trap_send("BAT #2 Alarm, assimetry",5,2,2);
;;;1227   		} 
;;;1228   	
;;;1229   	}
;;;1230   
;;;1231   else if(in==0)
00149c  2900              CMP      r1,#0
00149e  d07e              BEQ      |L1.5534|
0014a0  e154              B        |L1.5964|
                  |L1.5282|
0014a2  eb060046          ADD      r0,r6,r6,LSL #1       ;1159
0014a6  eb001106          ADD      r1,r0,r6,LSL #4       ;1159
0014aa  480d              LDR      r0,|L1.5344|
0014ac  eb000081          ADD      r0,r0,r1,LSL #2       ;1159
0014b0  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1159
0014b4  f0410102          ORR      r1,r1,#2              ;1159
0014b8  7001              STRB     r1,[r0,#0]            ;1159
0014ba  4628              MOV      r0,r5                 ;1161
0014bc  f7fffffe          BL       lc640_read_int
0014c0  f1000001          ADD      r0,r0,#1              ;1162
0014c4  b284              UXTH     r4,r0                 ;1162
0014c6  2c3f              CMP      r4,#0x3f              ;1163
0014c8  d924              BLS      |L1.5396|
0014ca  e021              B        |L1.5392|
                  |L1.5324|
0014cc  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
0014d0  b9312041
0014d4  6c61726d
0014d8  2c206c6f
0014dc  737400  
0014df  00                DCB      0
                  |L1.5344|
                          DCD      bat
                  |L1.5348|
                          DCD      0x40024000
                  |L1.5352|
0014e8  42415420          DCB      "BAT #1 Alarm, lost",0
0014ec  23312041
0014f0  6c61726d
0014f4  2c206c6f
0014f8  737400  
0014fb  00                DCB      0
                  |L1.5372|
0014fc  42415420          DCB      "BAT #2 Alarm, lost",0
001500  23322041
001504  6c61726d
001508  2c206c6f
00150c  737400  
00150f  00                DCB      0
                  |L1.5392|
001510  f04f0400          MOV      r4,#0                 ;1163
                  |L1.5396|
001514  b221              SXTH     r1,r4                 ;1164
001516  4628              MOV      r0,r5                 ;1164
001518  f7fffffe          BL       lc640_write_int
00151c  f6406702          MOV      r7,#0xe02             ;1166
001520  4638              MOV      r0,r7                 ;1166
001522  f7fffffe          BL       lc640_read_int
001526  b280              UXTH     r0,r0                 ;1166
001528  283f              CMP      r0,#0x3f              ;1167
00152a  d000              BEQ      |L1.5422|
00152c  4620              MOV      r0,r4                 ;1167
                  |L1.5422|
00152e  b201              SXTH     r1,r0                 ;1168
001530  4638              MOV      r0,r7                 ;1168
001532  f7fffffe          BL       lc640_write_int
001536  4628              MOV      r0,r5                 ;1170
001538  f7fffffe          BL       lc640_read_int
00153c  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1170
001540  b284              UXTH     r4,r0                 ;1170
001542  f88d9000          STRB     r9,[sp,#0]            ;1172
001546  f88d6001          STRB     r6,[sp,#1]            ;1173
00154a  f04f0053          MOV      r0,#0x53              ;1174
00154e  f88d0002          STRB     r0,[sp,#2]            ;1174
001552  f88da003          STRB     r10,[sp,#3]           ;1175
001556  4669              MOV      r1,sp                 ;1176
001558  4620              MOV      r0,r4                 ;1176
00155a  f7fffffe          BL       lc640_write_long_ptr
00155e  f8cda000          STR      r10,[sp,#0]           ;1181
001562  4669              MOV      r1,sp                 ;1182
001564  1d20              ADDS     r0,r4,#4              ;1182
001566  f7fffffe          BL       lc640_write_long_ptr
00156a  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1184
00156e  f88d0000          STRB     r0,[sp,#0]            ;1184
001572  f8980038          LDRB     r0,[r8,#0x38]         ;1185
001576  f88d0001          STRB     r0,[sp,#1]            ;1185
00157a  f898002c          LDRB     r0,[r8,#0x2c]         ;1186
00157e  f88d0002          STRB     r0,[sp,#2]            ;1186
001582  f88da003          STRB     r10,[sp,#3]           ;1187
001586  4669              MOV      r1,sp                 ;1188
001588  f1040008          ADD      r0,r4,#8              ;1188
00158c  f7fffffe          BL       lc640_write_long_ptr
001590  f8980028          LDRB     r0,[r8,#0x28]         ;1190
001594  f88d0000          STRB     r0,[sp,#0]            ;1190
001598  f8980024          LDRB     r0,[r8,#0x24]         ;1191
00159c  e000              B        |L1.5536|
                  |L1.5534|
00159e  e054              B        |L1.5706|
                  |L1.5536|
0015a0  f88d0001          STRB     r0,[sp,#1]            ;1191
0015a4  f8980020          LDRB     r0,[r8,#0x20]         ;1192
0015a8  f88d0002          STRB     r0,[sp,#2]            ;1192
0015ac  f88da003          STRB     r10,[sp,#3]           ;1193
0015b0  4669              MOV      r1,sp                 ;1194
0015b2  f104000c          ADD      r0,r4,#0xc            ;1194
0015b6  f7fffffe          BL       lc640_write_long_ptr
0015ba  f04f0541          MOV      r5,#0x41              ;1196
0015be  f88d5000          STRB     r5,[sp,#0]            ;1196
0015c2  f88d5001          STRB     r5,[sp,#1]            ;1197
0015c6  f88d5002          STRB     r5,[sp,#2]            ;1198
0015ca  f88d5003          STRB     r5,[sp,#3]            ;1199
0015ce  4669              MOV      r1,sp                 ;1200
0015d0  f1040010          ADD      r0,r4,#0x10           ;1200
0015d4  f7fffffe          BL       lc640_write_long_ptr
0015d8  f88d5000          STRB     r5,[sp,#0]            ;1202
0015dc  f88d5001          STRB     r5,[sp,#1]            ;1203
0015e0  f88d5002          STRB     r5,[sp,#2]            ;1204
0015e4  f88d5003          STRB     r5,[sp,#3]            ;1205
0015e8  4669              MOV      r1,sp                 ;1206
0015ea  f1040014          ADD      r0,r4,#0x14           ;1206
0015ee  f7fffffe          BL       lc640_write_long_ptr
0015f2  f88d5000          STRB     r5,[sp,#0]            ;1208
0015f6  f88d5001          STRB     r5,[sp,#1]            ;1209
0015fa  f88d5002          STRB     r5,[sp,#2]            ;1210
0015fe  f88d5003          STRB     r5,[sp,#3]            ;1211
001602  4669              MOV      r1,sp                 ;1212
001604  f1040018          ADD      r0,r4,#0x18           ;1212
001608  f7fffffe          BL       lc640_write_long_ptr
00160c  f88d5000          STRB     r5,[sp,#0]            ;1214
001610  f88d5001          STRB     r5,[sp,#1]            ;1215
001614  f88d5002          STRB     r5,[sp,#2]            ;1216
001618  f88d5003          STRB     r5,[sp,#3]            ;1217
00161c  4669              MOV      r1,sp                 ;1218
00161e  f104001c          ADD      r0,r4,#0x1c           ;1218
001622  f7fffffe          BL       lc640_write_long_ptr
001626  b116              CBZ      r6,|L1.5678|
001628  2e01              CMP      r6,#1                 ;1224
00162a  d007              BEQ      |L1.5692|
00162c  e08e              B        |L1.5964|
                  |L1.5678|
00162e  2302              MOVS     r3,#2                 ;1222
001630  2201              MOVS     r2,#1                 ;1222
001632  2105              MOVS     r1,#5                 ;1222
001634  a0fb              ADR      r0,|L1.6692|
001636  f7fffffe          BL       snmp_trap_send
00163a  e087              B        |L1.5964|
                  |L1.5692|
00163c  2302              MOVS     r3,#2                 ;1226
00163e  461a              MOV      r2,r3                 ;1226
001640  2105              MOVS     r1,#5                 ;1226
001642  a0fe              ADR      r0,|L1.6716|
001644  f7fffffe          BL       snmp_trap_send
001648  e080              B        |L1.5964|
                  |L1.5706|
;;;1232   	{
;;;1233   	//bat[b]._av=0;
;;;1234   
;;;1235        event_ptr=lc640_read_int(PTR_EVENT_LOG);
00164a  4628              MOV      r0,r5
00164c  f7fffffe          BL       lc640_read_int
001650  b287              UXTH     r7,r0
;;;1236   	event_ptr_find=event_ptr;
001652  463c              MOV      r4,r7
                  |L1.5716|
;;;1237   	
;;;1238   avar_bat_as_hndl_lbl1: 
;;;1239   
;;;1240   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001654  eb0b1044          ADD      r0,r11,r4,LSL #5
001658  b285              UXTH     r5,r0
;;;1241   
;;;1242        lc640_read_long_ptr(lc640_adr,data);
00165a  4669              MOV      r1,sp
00165c  4628              MOV      r0,r5
00165e  f7fffffe          BL       lc640_read_long_ptr
;;;1243        
;;;1244        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
001662  f89d0000          LDRB     r0,[sp,#0]
001666  2842              CMP      r0,#0x42
001668  d107              BNE      |L1.5754|
00166a  f89d0001          LDRB     r0,[sp,#1]
00166e  42b0              CMP      r0,r6
001670  d103              BNE      |L1.5754|
001672  f89d0002          LDRB     r0,[sp,#2]
001676  2843              CMP      r0,#0x43
001678  d009              BEQ      |L1.5774|
                  |L1.5754|
;;;1245        	{        
;;;1246        	if(event_ptr_find)event_ptr_find--;
00167a  b11c              CBZ      r4,|L1.5764|
00167c  f1a40401          SUB      r4,r4,#1
001680  b2a4              UXTH     r4,r4
001682  e001              B        |L1.5768|
                  |L1.5764|
;;;1247        	else event_ptr_find=63;
001684  f04f043f          MOV      r4,#0x3f
                  |L1.5768|
;;;1248        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001688  42bc              CMP      r4,r7
00168a  d1e3              BNE      |L1.5716|
00168c  e05e              B        |L1.5964|
                  |L1.5774|
;;;1249        	else goto avar_bat_as_hndl_lbl1;
;;;1250        	}
;;;1251        else 
;;;1252        	{
;;;1253        	lc640_read_long_ptr(lc640_adr+16,data);
00168e  4669              MOV      r1,sp
001690  f1050010          ADD      r0,r5,#0x10
001694  f7fffffe          BL       lc640_read_long_ptr
;;;1254        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001698  f89d0000          LDRB     r0,[sp,#0]
00169c  2841              CMP      r0,#0x41
00169e  d10b              BNE      |L1.5816|
0016a0  f89d0001          LDRB     r0,[sp,#1]
0016a4  2841              CMP      r0,#0x41
0016a6  d107              BNE      |L1.5816|
0016a8  f89d0002          LDRB     r0,[sp,#2]
0016ac  2841              CMP      r0,#0x41
0016ae  d103              BNE      |L1.5816|
0016b0  f89d0003          LDRB     r0,[sp,#3]
0016b4  2841              CMP      r0,#0x41
0016b6  d009              BEQ      |L1.5836|
                  |L1.5816|
;;;1255        		{        
;;;1256        		if(event_ptr_find)event_ptr_find--;
0016b8  b11c              CBZ      r4,|L1.5826|
0016ba  f1a40401          SUB      r4,r4,#1
0016be  b2a4              UXTH     r4,r4
0016c0  e001              B        |L1.5830|
                  |L1.5826|
;;;1257            		else event_ptr_find=63;
0016c2  f04f043f          MOV      r4,#0x3f
                  |L1.5830|
;;;1258            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
0016c6  42bc              CMP      r4,r7
0016c8  d1c4              BNE      |L1.5716|
0016ca  e03f              B        |L1.5964|
                  |L1.5836|
;;;1259        		else goto avar_bat_as_hndl_lbl1;
;;;1260        		}
;;;1261   
;;;1262        	}
;;;1263        		
;;;1264   	data[0]=LPC_RTC->YEAR;
0016cc  f8b8003c          LDRH     r0,[r8,#0x3c]
0016d0  f88d0000          STRB     r0,[sp,#0]
;;;1265   	data[1]=LPC_RTC->MONTH;
0016d4  f8980038          LDRB     r0,[r8,#0x38]
0016d8  f88d0001          STRB     r0,[sp,#1]
;;;1266   	data[2]=LPC_RTC->DOM;
0016dc  f898002c          LDRB     r0,[r8,#0x2c]
0016e0  f88d0002          STRB     r0,[sp,#2]
;;;1267   	data[3]=0;
0016e4  f88da003          STRB     r10,[sp,#3]
;;;1268   	lc640_write_long_ptr(lc640_adr+16,data);
0016e8  4669              MOV      r1,sp
0016ea  f1050010          ADD      r0,r5,#0x10
0016ee  f7fffffe          BL       lc640_write_long_ptr
;;;1269   
;;;1270   	data[0]=LPC_RTC->HOUR;
0016f2  f8980028          LDRB     r0,[r8,#0x28]
0016f6  f88d0000          STRB     r0,[sp,#0]
;;;1271   	data[1]=LPC_RTC->MIN;
0016fa  f8980024          LDRB     r0,[r8,#0x24]
0016fe  f88d0001          STRB     r0,[sp,#1]
;;;1272   	data[2]=LPC_RTC->SEC;
001702  f8980020          LDRB     r0,[r8,#0x20]
001706  f88d0002          STRB     r0,[sp,#2]
;;;1273   	data[3]=0;
00170a  f88da003          STRB     r10,[sp,#3]
;;;1274   	lc640_write_long_ptr(lc640_adr+20,data);
00170e  4669              MOV      r1,sp
001710  f1050014          ADD      r0,r5,#0x14
001714  f7fffffe          BL       lc640_write_long_ptr
;;;1275   	
;;;1276   	data[0]='B';
001718  f88d9000          STRB     r9,[sp,#0]
;;;1277   	data[1]='B';
00171c  f88d9001          STRB     r9,[sp,#1]
;;;1278   	data[2]='B';
001720  f88d9002          STRB     r9,[sp,#2]
;;;1279   	data[3]='B';
001724  f88d9003          STRB     r9,[sp,#3]
;;;1280   	lc640_write_long_ptr(lc640_adr+24,data);
001728  4669              MOV      r1,sp
00172a  f1050018          ADD      r0,r5,#0x18
00172e  f7fffffe          BL       lc640_write_long_ptr
;;;1281   	
;;;1282   	data[0]='B';
001732  f88d9000          STRB     r9,[sp,#0]
;;;1283   	data[1]='B';
001736  f88d9001          STRB     r9,[sp,#1]
;;;1284   	data[2]='B';
00173a  f88d9002          STRB     r9,[sp,#2]
;;;1285   	data[3]='B';
00173e  f88d9003          STRB     r9,[sp,#3]
;;;1286   	lc640_write_long_ptr(lc640_adr+28,data);
001742  4669              MOV      r1,sp
001744  f105001c          ADD      r0,r5,#0x1c
001748  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5964|
;;;1287   	
;;;1288   
;;;1289   	
;;;1290   	}
;;;1291   	
;;;1292   avar_bat_as_hndl_end:
;;;1293   __nop();		
00174c  bf00              NOP      
;;;1294   }
00174e  e54a              B        |L1.4582|
;;;1295   
                          ENDP

                  ke_mem_hndl PROC
;;;1297   //-----------------------------------------------
;;;1298   void ke_mem_hndl(char b,unsigned short in)
001750  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;1299   {
001752  b083              SUB      sp,sp,#0xc
001754  4605              MOV      r5,r0
;;;1300   char data[4];
;;;1301   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1302   //unsigned char temp,temp_;
;;;1303   //unsigned int tempUI;
;;;1304   //unsigned long tempUL; 
;;;1305   signed temp_temp;
;;;1306   
;;;1307   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
001756  eb050045          ADD      r0,r5,r5,LSL #1
00175a  49be              LDR      r1,|L1.6740|
00175c  eb001005          ADD      r0,r0,r5,LSL #4
001760  eb010180          ADD      r1,r1,r0,LSL #2
001764  48bc              LDR      r0,|L1.6744|
001766  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
00176a  f1000001          ADD      r0,r0,#1
00176e  eb010040          ADD      r0,r1,r0,LSL #1
001772  f9b00020          LDRSH    r0,[r0,#0x20]
001776  9001              STR      r0,[sp,#4]
;;;1308   
;;;1309   event_ptr=lc640_read_int(PTR_EVENT_LOG);
001778  f44f6660          MOV      r6,#0xe00
00177c  4630              MOV      r0,r6
00177e  f7fffffe          BL       lc640_read_int
;;;1310   event_ptr++;	
001782  f1000001          ADD      r0,r0,#1
001786  4604              MOV      r4,r0
;;;1311   if(event_ptr>63)event_ptr=0;	
001788  2c3f              CMP      r4,#0x3f
00178a  d901              BLS      |L1.6032|
00178c  f04f0400          MOV      r4,#0
                  |L1.6032|
;;;1312   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
001790  b221              SXTH     r1,r4
001792  4630              MOV      r0,r6
001794  f7fffffe          BL       lc640_write_int
;;;1313   	
;;;1314   event_cnt=lc640_read_int(CNT_EVENT_LOG);
001798  f6406702          MOV      r7,#0xe02
00179c  4638              MOV      r0,r7
00179e  f7fffffe          BL       lc640_read_int
;;;1315   if(event_cnt!=63)event_cnt=event_ptr;
0017a2  283f              CMP      r0,#0x3f
0017a4  d000              BEQ      |L1.6056|
0017a6  4620              MOV      r0,r4
                  |L1.6056|
;;;1316   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
0017a8  b201              SXTH     r1,r0
0017aa  4638              MOV      r0,r7
0017ac  f7fffffe          BL       lc640_write_int
;;;1317   	
;;;1318   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
0017b0  4630              MOV      r0,r6
0017b2  f7fffffe          BL       lc640_read_int
0017b6  f44f6180          MOV      r1,#0x400
0017ba  eb011440          ADD      r4,r1,r0,LSL #5
;;;1319   	
;;;1320   data[0]='B';
0017be  f04f0042          MOV      r0,#0x42
0017c2  f88d0008          STRB     r0,[sp,#8]
;;;1321   data[1]=b; 
0017c6  f88d5009          STRB     r5,[sp,#9]
;;;1322   data[2]='K';
0017ca  f04f004b          MOV      r0,#0x4b
0017ce  f88d000a          STRB     r0,[sp,#0xa]
;;;1323   data[3]=0;
0017d2  f04f0600          MOV      r6,#0
0017d6  f88d600b          STRB     r6,[sp,#0xb]
;;;1324   
;;;1325   lc640_write_long_ptr(lc640_adr,data);
0017da  a902              ADD      r1,sp,#8
0017dc  4620              MOV      r0,r4
0017de  f7fffffe          BL       lc640_write_long_ptr
;;;1326   
;;;1327   data[0]=*((char*)&in);
0017e2  f89d0010          LDRB     r0,[sp,#0x10]
0017e6  f88d0008          STRB     r0,[sp,#8]
;;;1328   data[1]=*(((char*)(&in))+1);
0017ea  f89d0011          LDRB     r0,[sp,#0x11]
0017ee  f88d0009          STRB     r0,[sp,#9]
;;;1329   data[2]=*((char*)&temp_temp);
0017f2  f89d0004          LDRB     r0,[sp,#4]
0017f6  f88d000a          STRB     r0,[sp,#0xa]
;;;1330   data[3]=*(((char*)(&temp_temp))+1);
0017fa  f89d0005          LDRB     r0,[sp,#5]
0017fe  f88d000b          STRB     r0,[sp,#0xb]
;;;1331   lc640_write_long_ptr(lc640_adr+4,data);
001802  a902              ADD      r1,sp,#8
001804  1d20              ADDS     r0,r4,#4
001806  f7fffffe          BL       lc640_write_long_ptr
;;;1332   
;;;1333   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
00180a  f44f70fc          MOV      r0,#0x1f8
00180e  f7fffffe          BL       lc640_read_long
001812  4d92              LDR      r5,|L1.6748|
001814  6028              STR      r0,[r5,#0]  ; ke_date
;;;1334   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
001816  4629              MOV      r1,r5
001818  f1040008          ADD      r0,r4,#8
00181c  f7fffffe          BL       lc640_write_long_ptr
;;;1335   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
001820  f44f70fe          MOV      r0,#0x1fc
001824  f7fffffe          BL       lc640_read_long
001828  6068              STR      r0,[r5,#4]  ; ke_date
;;;1336   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
00182a  1d29              ADDS     r1,r5,#4
00182c  f104000c          ADD      r0,r4,#0xc
001830  f7fffffe          BL       lc640_write_long_ptr
;;;1337   
;;;1338   data[0]=LPC_RTC->YEAR;
001834  4d8a              LDR      r5,|L1.6752|
001836  8ba8              LDRH     r0,[r5,#0x1c]
001838  f88d0008          STRB     r0,[sp,#8]
;;;1339   data[1]=LPC_RTC->MONTH;
00183c  7e28              LDRB     r0,[r5,#0x18]
00183e  f88d0009          STRB     r0,[sp,#9]
;;;1340   data[2]=LPC_RTC->DOM;
001842  7b28              LDRB     r0,[r5,#0xc]
001844  f88d000a          STRB     r0,[sp,#0xa]
;;;1341   data[3]=0;
001848  f88d600b          STRB     r6,[sp,#0xb]
;;;1342   lc640_write_long_ptr(lc640_adr+16,data);
00184c  a902              ADD      r1,sp,#8
00184e  f1040010          ADD      r0,r4,#0x10
001852  f7fffffe          BL       lc640_write_long_ptr
;;;1343   
;;;1344   data[0]=LPC_RTC->HOUR;
001856  7a28              LDRB     r0,[r5,#8]
001858  f88d0008          STRB     r0,[sp,#8]
;;;1345   data[1]=LPC_RTC->MIN;
00185c  7928              LDRB     r0,[r5,#4]
00185e  f88d0009          STRB     r0,[sp,#9]
;;;1346   data[2]=LPC_RTC->SEC;
001862  7828              LDRB     r0,[r5,#0]
001864  f88d000a          STRB     r0,[sp,#0xa]
;;;1347   data[3]=0;
001868  f88d600b          STRB     r6,[sp,#0xb]
;;;1348   lc640_write_long_ptr(lc640_adr+20,data);
00186c  a902              ADD      r1,sp,#8
00186e  f1040014          ADD      r0,r4,#0x14
001872  f7fffffe          BL       lc640_write_long_ptr
;;;1349    
;;;1350   }
001876  b005              ADD      sp,sp,#0x14
001878  bdf0              POP      {r4-r7,pc}
;;;1351   
                          ENDP

                  vz_mem_hndl PROC
;;;1353   //-----------------------------------------------
;;;1354   void vz_mem_hndl(unsigned short in)
00187a  e92d4ff8          PUSH     {r3-r11,lr}
;;;1355   {
;;;1356   char data[4];
;;;1357   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
00187e  f04f0600          MOV      r6,#0
001882  4634              MOV      r4,r6
;;;1358   //char avar_simbol;
;;;1359   
;;;1360   if(in==1)
;;;1361   	{
;;;1362   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1363   	event_ptr++;	
;;;1364   	if(event_ptr>63)event_ptr=0;	
;;;1365   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1366   	
;;;1367        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1368   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1369   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1370   	
;;;1371   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1372   	
;;;1373   	data[0]='B';
;;;1374   	data[1]=0; 
;;;1375   	data[2]='Z';
;;;1376   	data[3]=0;
;;;1377   	lc640_write_long_ptr(lc640_adr,data);
;;;1378   
;;;1379   	data[0]=0;
;;;1380   	data[1]=0;
;;;1381   	data[2]=0;
;;;1382   	data[3]=0;
;;;1383   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1384   
;;;1385   	data[0]=LPC_RTC->YEAR;
001884  f8df81dc          LDR      r8,|L1.6756|
001888  46a1              MOV      r9,r4                 ;1357
00188a  f04f0742          MOV      r7,#0x42              ;1373
00188e  f44f6a80          MOV      r10,#0x400            ;1371
001892  2801              CMP      r0,#1                 ;1360
001894  d002              BEQ      |L1.6300|
;;;1386   	data[1]=LPC_RTC->MONTH;
;;;1387   	data[2]=LPC_RTC->DOM;
;;;1388   	data[3]=0;
;;;1389   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1390   
;;;1391   	data[0]=LPC_RTC->HOUR;
;;;1392   	data[1]=LPC_RTC->MIN;
;;;1393   	data[2]=LPC_RTC->SEC;
;;;1394   	data[3]=0;
;;;1395   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1396   	
;;;1397   	data[0]='A';
;;;1398   	data[1]='A';
;;;1399   	data[2]='A';
;;;1400   	data[3]='A';
;;;1401   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1402   	
;;;1403   	data[0]='A';
;;;1404   	data[1]='A';
;;;1405   	data[2]='A';
;;;1406   	data[3]='A';
;;;1407   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1408   	
;;;1409   	data[0]='A';
;;;1410   	data[1]='A';
;;;1411   	data[2]='A';
;;;1412   	data[3]='A';
;;;1413   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1414   	
;;;1415   	data[0]='A';
;;;1416   	data[1]='A';
;;;1417   	data[2]='A';
;;;1418   	data[3]='A';
;;;1419   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1420    	
;;;1421   	}
;;;1422   
;;;1423   else if(in==0)
001896  2800              CMP      r0,#0
001898  d07e              BEQ      |L1.6552|
00189a  e12a              B        |L1.6898|
                  |L1.6300|
00189c  f44f6560          MOV      r5,#0xe00             ;1362
0018a0  4628              MOV      r0,r5                 ;1362
0018a2  f7fffffe          BL       lc640_read_int
0018a6  f1000001          ADD      r0,r0,#1              ;1363
0018aa  4604              MOV      r4,r0                 ;1363
0018ac  2c3f              CMP      r4,#0x3f              ;1364
0018ae  d901              BLS      |L1.6324|
0018b0  f04f0400          MOV      r4,#0                 ;1364
                  |L1.6324|
0018b4  b221              SXTH     r1,r4                 ;1365
0018b6  4628              MOV      r0,r5                 ;1365
0018b8  f7fffffe          BL       lc640_write_int
0018bc  f6406602          MOV      r6,#0xe02             ;1367
0018c0  4630              MOV      r0,r6                 ;1367
0018c2  f7fffffe          BL       lc640_read_int
0018c6  283f              CMP      r0,#0x3f              ;1368
0018c8  d000              BEQ      |L1.6348|
0018ca  4620              MOV      r0,r4                 ;1368
                  |L1.6348|
0018cc  b201              SXTH     r1,r0                 ;1369
0018ce  4630              MOV      r0,r6                 ;1369
0018d0  f7fffffe          BL       lc640_write_int
0018d4  4628              MOV      r0,r5                 ;1371
0018d6  f7fffffe          BL       lc640_read_int
0018da  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1371
0018de  f88d7000          STRB     r7,[sp,#0]            ;1373
0018e2  f88d9001          STRB     r9,[sp,#1]            ;1374
0018e6  f04f005a          MOV      r0,#0x5a              ;1375
0018ea  f88d0002          STRB     r0,[sp,#2]            ;1375
0018ee  f88d9003          STRB     r9,[sp,#3]            ;1376
0018f2  4669              MOV      r1,sp                 ;1377
0018f4  4620              MOV      r0,r4                 ;1377
0018f6  f7fffffe          BL       lc640_write_long_ptr
0018fa  f8cd9000          STR      r9,[sp,#0]            ;1382
0018fe  4669              MOV      r1,sp                 ;1383
001900  1d20              ADDS     r0,r4,#4              ;1383
001902  f7fffffe          BL       lc640_write_long_ptr
001906  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1385
00190a  f88d0000          STRB     r0,[sp,#0]            ;1385
00190e  f8980038          LDRB     r0,[r8,#0x38]         ;1386
001912  f88d0001          STRB     r0,[sp,#1]            ;1386
001916  f898002c          LDRB     r0,[r8,#0x2c]         ;1387
00191a  f88d0002          STRB     r0,[sp,#2]            ;1387
00191e  f88d9003          STRB     r9,[sp,#3]            ;1388
001922  4669              MOV      r1,sp                 ;1389
001924  f1040008          ADD      r0,r4,#8              ;1389
001928  f7fffffe          BL       lc640_write_long_ptr
00192c  f8980028          LDRB     r0,[r8,#0x28]         ;1391
001930  f88d0000          STRB     r0,[sp,#0]            ;1391
001934  f8980024          LDRB     r0,[r8,#0x24]         ;1392
001938  f88d0001          STRB     r0,[sp,#1]            ;1392
00193c  f8980020          LDRB     r0,[r8,#0x20]         ;1393
001940  f88d0002          STRB     r0,[sp,#2]            ;1393
001944  f88d9003          STRB     r9,[sp,#3]            ;1394
001948  4669              MOV      r1,sp                 ;1395
00194a  f104000c          ADD      r0,r4,#0xc            ;1395
00194e  f7fffffe          BL       lc640_write_long_ptr
001952  f04f0541          MOV      r5,#0x41              ;1397
001956  f88d5000          STRB     r5,[sp,#0]            ;1397
00195a  f88d5001          STRB     r5,[sp,#1]            ;1398
00195e  f88d5002          STRB     r5,[sp,#2]            ;1399
001962  f88d5003          STRB     r5,[sp,#3]            ;1400
001966  4669              MOV      r1,sp                 ;1401
001968  f1040010          ADD      r0,r4,#0x10           ;1401
00196c  f7fffffe          BL       lc640_write_long_ptr
001970  f88d5000          STRB     r5,[sp,#0]            ;1403
001974  f88d5001          STRB     r5,[sp,#1]            ;1404
001978  f88d5002          STRB     r5,[sp,#2]            ;1405
00197c  f88d5003          STRB     r5,[sp,#3]            ;1406
001980  4669              MOV      r1,sp                 ;1407
001982  f1040014          ADD      r0,r4,#0x14           ;1407
001986  f7fffffe          BL       lc640_write_long_ptr
00198a  f88d5000          STRB     r5,[sp,#0]            ;1409
00198e  f88d5001          STRB     r5,[sp,#1]            ;1410
001992  f88d5002          STRB     r5,[sp,#2]            ;1411
001996  e000              B        |L1.6554|
                  |L1.6552|
001998  e014              B        |L1.6596|
                  |L1.6554|
00199a  f88d5003          STRB     r5,[sp,#3]            ;1412
00199e  4669              MOV      r1,sp                 ;1413
0019a0  f1040018          ADD      r0,r4,#0x18           ;1413
0019a4  f7fffffe          BL       lc640_write_long_ptr
0019a8  f88d5000          STRB     r5,[sp,#0]            ;1415
0019ac  f88d5001          STRB     r5,[sp,#1]            ;1416
0019b0  f88d5002          STRB     r5,[sp,#2]            ;1417
0019b4  f88d5003          STRB     r5,[sp,#3]            ;1418
0019b8  4669              MOV      r1,sp                 ;1419
0019ba  f104001c          ADD      r0,r4,#0x1c           ;1419
0019be  f7fffffe          BL       lc640_write_long_ptr
0019c2  e096              B        |L1.6898|
                  |L1.6596|
;;;1424   	{      
;;;1425        
;;;1426   vz_mem_hndl_lbl1: 
;;;1427   
;;;1428   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0019c4  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1429   
;;;1430        lc640_read_long_ptr(lc640_adr,data);
0019c8  4669              MOV      r1,sp
0019ca  4628              MOV      r0,r5
0019cc  f7fffffe          BL       lc640_read_long_ptr
;;;1431        
;;;1432        if(!((data[0]=='B')&&(data[2]=='Z')))
0019d0  f89d0000          LDRB     r0,[sp,#0]
0019d4  2842              CMP      r0,#0x42
0019d6  d103              BNE      |L1.6624|
0019d8  f89d0002          LDRB     r0,[sp,#2]
0019dc  285a              CMP      r0,#0x5a
0019de  d008              BEQ      |L1.6642|
                  |L1.6624|
;;;1433        	{        
;;;1434        	if(event_ptr_find)event_ptr_find--;
0019e0  b114              CBZ      r4,|L1.6632|
0019e2  f1a40401          SUB      r4,r4,#1
0019e6  e001              B        |L1.6636|
                  |L1.6632|
;;;1435        	else event_ptr_find=63;
0019e8  f04f043f          MOV      r4,#0x3f
                  |L1.6636|
;;;1436        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
0019ec  42b4              CMP      r4,r6
0019ee  d1e9              BNE      |L1.6596|
0019f0  e07f              B        |L1.6898|
                  |L1.6642|
;;;1437        	else goto vz_mem_hndl_lbl1;
;;;1438        	}
;;;1439        else 
;;;1440        	{
;;;1441        	lc640_read_long_ptr(lc640_adr+16,data);
0019f2  4669              MOV      r1,sp
0019f4  f1050010          ADD      r0,r5,#0x10
0019f8  f7fffffe          BL       lc640_read_long_ptr
;;;1442        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0019fc  f89d0000          LDRB     r0,[sp,#0]
001a00  2841              CMP      r0,#0x41
001a02  d10b              BNE      |L1.6684|
001a04  f89d0001          LDRB     r0,[sp,#1]
001a08  2841              CMP      r0,#0x41
001a0a  d107              BNE      |L1.6684|
001a0c  f89d0002          LDRB     r0,[sp,#2]
001a10  2841              CMP      r0,#0x41
001a12  d103              BNE      |L1.6684|
001a14  f89d0003          LDRB     r0,[sp,#3]
001a18  2841              CMP      r0,#0x41
001a1a  d02a              BEQ      |L1.6770|
                  |L1.6684|
;;;1443        		{        
;;;1444        		if(event_ptr_find)event_ptr_find--;
001a1c  b324              CBZ      r4,|L1.6760|
001a1e  f1a40401          SUB      r4,r4,#1
001a22  e023              B        |L1.6764|
                  |L1.6692|
001a24  42415420          DCB      "BAT #1 Alarm, assimetry",0
001a28  23312041
001a2c  6c61726d
001a30  2c206173
001a34  73696d65
001a38  74727900
                  |L1.6716|
001a3c  42415420          DCB      "BAT #2 Alarm, assimetry",0
001a40  23322041
001a44  6c61726d
001a48  2c206173
001a4c  73696d65
001a50  74727900
                  |L1.6740|
                          DCD      bat
                  |L1.6744|
                          DCD      bat_u_old_cnt
                  |L1.6748|
                          DCD      ke_date
                  |L1.6752|
                          DCD      0x40024020
                  |L1.6756|
                          DCD      0x40024000
                  |L1.6760|
;;;1445            		else event_ptr_find=63;
001a68  f04f043f          MOV      r4,#0x3f
                  |L1.6764|
;;;1446            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001a6c  42b4              CMP      r4,r6
001a6e  d1a9              BNE      |L1.6596|
001a70  e03f              B        |L1.6898|
                  |L1.6770|
;;;1447        		else goto vz_mem_hndl_lbl1;
;;;1448        		}
;;;1449   
;;;1450        	}	
;;;1451   
;;;1452   
;;;1453   	
;;;1454   	data[0]=LPC_RTC->YEAR;
001a72  f8b8003c          LDRH     r0,[r8,#0x3c]
001a76  f88d0000          STRB     r0,[sp,#0]
;;;1455   	data[1]=LPC_RTC->MONTH;
001a7a  f8980038          LDRB     r0,[r8,#0x38]
001a7e  f88d0001          STRB     r0,[sp,#1]
;;;1456   	data[2]=LPC_RTC->DOM;
001a82  f898002c          LDRB     r0,[r8,#0x2c]
001a86  f88d0002          STRB     r0,[sp,#2]
;;;1457   	data[3]=0;
001a8a  f88d9003          STRB     r9,[sp,#3]
;;;1458   	lc640_write_long_ptr(lc640_adr+16,data);
001a8e  4669              MOV      r1,sp
001a90  f1050010          ADD      r0,r5,#0x10
001a94  f7fffffe          BL       lc640_write_long_ptr
;;;1459   
;;;1460   	data[0]=LPC_RTC->HOUR;
001a98  f8980028          LDRB     r0,[r8,#0x28]
001a9c  f88d0000          STRB     r0,[sp,#0]
;;;1461   	data[1]=LPC_RTC->MIN;
001aa0  f8980024          LDRB     r0,[r8,#0x24]
001aa4  f88d0001          STRB     r0,[sp,#1]
;;;1462   	data[2]=LPC_RTC->SEC;
001aa8  f8980020          LDRB     r0,[r8,#0x20]
001aac  f88d0002          STRB     r0,[sp,#2]
;;;1463   	data[3]=0;
001ab0  f88d9003          STRB     r9,[sp,#3]
;;;1464   	lc640_write_long_ptr(lc640_adr+20,data);
001ab4  4669              MOV      r1,sp
001ab6  f1050014          ADD      r0,r5,#0x14
001aba  f7fffffe          BL       lc640_write_long_ptr
;;;1465   	
;;;1466   	data[0]='B';
001abe  f88d7000          STRB     r7,[sp,#0]
;;;1467   	data[1]='B';
001ac2  f88d7001          STRB     r7,[sp,#1]
;;;1468   	data[2]='B';
001ac6  f88d7002          STRB     r7,[sp,#2]
;;;1469   	data[3]='B';
001aca  f88d7003          STRB     r7,[sp,#3]
;;;1470   	lc640_write_long_ptr(lc640_adr+24,data);
001ace  4669              MOV      r1,sp
001ad0  f1050018          ADD      r0,r5,#0x18
001ad4  f7fffffe          BL       lc640_write_long_ptr
;;;1471   	
;;;1472   	data[0]='B';
001ad8  f88d7000          STRB     r7,[sp,#0]
;;;1473   	data[1]='B';
001adc  f88d7001          STRB     r7,[sp,#1]
;;;1474   	data[2]='B';
001ae0  f88d7002          STRB     r7,[sp,#2]
;;;1475   	data[3]='B';
001ae4  f88d7003          STRB     r7,[sp,#3]
;;;1476   	lc640_write_long_ptr(lc640_adr+28,data);
001ae8  4669              MOV      r1,sp
001aea  f105001c          ADD      r0,r5,#0x1c
001aee  f7fffffe          BL       lc640_write_long_ptr
                  |L1.6898|
;;;1477   	
;;;1478   	}
;;;1479   
;;;1480   vz_mem_hndl_end:
;;;1481   __nop(); 
001af2  bf00              NOP      
;;;1482   
;;;1483   }
001af4  e4c2              B        |L1.5244|
;;;1484     
                          ENDP


                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  rki_avar1_stat
                          DCD      0x00000000
                  rki_avar1_ind_stat
                          DCD      0x00000000
                  rki_avar1_stat_old
                          DCD      0x00000000
                  rki_avar1_stat_new
                          DCD      0x00000000
                  rki_avar1_stat_offed
                          DCD      0x00000000
                  rki_avarI1_stat
                          DCD      0x00000000
                  rki_avarI1_ind_stat
                          DCD      0x00000000
                  rki_avarI1_stat_old
                          DCD      0x00000000
                  rki_avarI1_stat_new
                          DCD      0x00000000
                  rki_avarI1_stat_offed
                          DCD      0x00000000
                  rki_avarI2_stat
                          DCD      0x00000000
                  rki_avarI2_ind_stat
                          DCD      0x00000000
                  rki_avarI2_stat_old
                          DCD      0x00000000
                  rki_avarI2_stat_new
                          DCD      0x00000000
                  rki_avarI2_stat_offed
                          DCD      0x00000000
                  av_inv
                          DCD      0x00000000
000054  0000              DCB      0x00,0x00
