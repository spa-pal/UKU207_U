; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\avar_hndl.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DUKU_ZVU --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;82     //-----------------------------------------------
;;;83     void avar_hndl(void)
000000  b570              PUSH     {r4-r6,lr}
;;;84     {
;;;85     //static unsigned avar_stat_old;
;;;86     char i;
;;;87     //unsigned avar_stat_new,avar_stat_offed;
;;;88     
;;;89     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48ff              LDR      r0,|L1.1024|
000004  4aff              LDR      r2,|L1.1028|
000006  7801              LDRB     r1,[r0,#0]  ; net_av
000008  6890              LDR      r0,[r2,#8]
00000a  b119              CBZ      r1,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6090              STR      r0,[r2,#8]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;90     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6090              STR      r0,[r2,#8]  ; avar_stat
                  |L1.26|
;;;91     #ifndef UKU_220_IPS_TERMOKOMPENSAT //o_10
;;;92     for(i=0;i<2;i++)
;;;93     	{
;;;94     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
;;;95     	else	   			SET_REG(avar_stat,0,1+i,1);
;;;96     	}
;;;97     #endif //o_10
;;;98     for(i=0;i<18;i++)
00001a  f04f0000          MOV      r0,#0
;;;99     	{
;;;100    	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00001e  4bfa              LDR      r3,|L1.1032|
000020  f04f0501          MOV      r5,#1
                  |L1.36|
000024  eb0001c0          ADD      r1,r0,r0,LSL #3
000028  eb011100          ADD      r1,r1,r0,LSL #4
00002c  eb030181          ADD      r1,r3,r1,LSL #2
000030  7849              LDRB     r1,[r1,#1]
000032  f0110fef          TST      r1,#0xef
000036  d00a              BEQ      |L1.78|
000038  f1000403          ADD      r4,r0,#3
00003c  fa05f104          LSL      r1,r5,r4
000040  6894              LDR      r4,[r2,#8]  ; avar_stat
000042  ea240401          BIC      r4,r4,r1
000046  ea440401          ORR      r4,r4,r1
00004a  6094              STR      r4,[r2,#8]  ; avar_stat
00004c  e007              B        |L1.94|
                  |L1.78|
;;;101    	else	   			SET_REG(avar_stat,0,3+i,1);
00004e  f1000103          ADD      r1,r0,#3
000052  fa05f401          LSL      r4,r5,r1
000056  6891              LDR      r1,[r2,#8]  ; avar_stat
000058  ea210104          BIC      r1,r1,r4
00005c  6091              STR      r1,[r2,#8]  ; avar_stat
                  |L1.94|
00005e  f1000001          ADD      r0,r0,#1              ;98
000062  b2c0              UXTB     r0,r0                 ;98
000064  2812              CMP      r0,#0x12              ;98
000066  d3dd              BCC      |L1.36|
;;;102    	}
;;;103    
;;;104    /*for(i=0;i<6;i++)
;;;105    	{
;;;106    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
;;;107    	else	   		SET_REG(avar_stat,0,15+i,1);
;;;108    	}*/
;;;109    
;;;110    /*for(i=0;i<4;i++)
;;;111    	{
;;;112    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;113    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;114    	}  */
;;;115    #ifndef UKU_ZVU
;;;116    for(i=0;i<4;i++)
;;;117    	{
;;;118    	if(sk_av_stat[i]==sasON)	SET_REG(sk_avar_stat,1,i,1);
;;;119    	else	   					SET_REG(sk_avar_stat,0,i,1);
;;;120    	}
;;;121    #endif //UKU_ZVU
;;;122    #ifndef UKU_FSO
;;;123    for(i=0;i<4;i++)
000068  f04f0000          MOV      r0,#0
                  |L1.108|
00006c  f1000001          ADD      r0,r0,#1
000070  b2c0              UXTB     r0,r0
000072  2804              CMP      r0,#4
000074  d3fa              BCC      |L1.108|
;;;124    	{
;;;125    //	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
;;;126    //	else	   		SET_REG(avar_stat,0,24+i,1);
;;;127    	}
;;;128    #endif //UKU_FSO
;;;129    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;130    //else	   			SET_REG(avar_stat,0,28,1);
;;;131    
;;;132    
;;;133    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000076  6890              LDR      r0,[r2,#8]  ; avar_stat
000078  6911              LDR      r1,[r2,#0x10]  ; avar_stat_old
00007a  4604              MOV      r4,r0
00007c  ea200001          BIC      r0,r0,r1
000080  6150              STR      r0,[r2,#0x14]  ; avar_stat_new
;;;134    
;;;135    avar_ind_stat|=avar_stat_new;
000082  68d3              LDR      r3,[r2,#0xc]  ; avar_ind_stat
000084  ea430300          ORR      r3,r3,r0
000088  60d3              STR      r3,[r2,#0xc]  ; avar_ind_stat
;;;136    
;;;137    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
00008a  ea210104          BIC      r1,r1,r4
00008e  ea6f0001          MVN      r0,r1
000092  6190              STR      r0,[r2,#0x18]  ; avar_stat_offed
;;;138    
;;;139    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
000094  49dd              LDR      r1,|L1.1036|
000096  f9b15000          LDRSH    r5,[r1,#0]  ; AV_OFF_AVT
00009a  b91d              CBNZ     r5,|L1.164|
00009c  49dc              LDR      r1,|L1.1040|
00009e  ea400001          ORR      r0,r0,r1
0000a2  6190              STR      r0,[r2,#0x18]  ; avar_stat_offed
                  |L1.164|
;;;140    
;;;141    avar_ind_stat&=avar_stat_offed; 
0000a4  6990              LDR      r0,[r2,#0x18]  ; avar_stat_offed
0000a6  ea030300          AND      r3,r3,r0
0000aa  60d3              STR      r3,[r2,#0xc]  ; avar_ind_stat
;;;142    
;;;143    avar_stat_old=avar_stat;
0000ac  6114              STR      r4,[r2,#0x10]  ; avar_stat_old
;;;144    
;;;145    
;;;146    sk_avar_stat_new=(sk_avar_stat^sk_avar_stat_old)&sk_avar_stat;
0000ae  7810              LDRB     r0,[r2,#0]  ; sk_avar_stat
0000b0  7891              LDRB     r1,[r2,#2]  ; sk_avar_stat_old
0000b2  ea200301          BIC      r3,r0,r1
0000b6  70d3              STRB     r3,[r2,#3]
;;;147    
;;;148    sk_avar_ind_stat|=sk_avar_stat_new;
0000b8  7854              LDRB     r4,[r2,#1]  ; sk_avar_ind_stat
0000ba  ea440403          ORR      r4,r4,r3
0000be  7054              STRB     r4,[r2,#1]
;;;149    
;;;150    sk_avar_stat_offed=~((sk_avar_stat^sk_avar_stat_old)&sk_avar_stat_old);
0000c0  ea210100          BIC      r1,r1,r0
0000c4  ea6f0101          MVN      r1,r1
0000c8  b2c9              UXTB     r1,r1
0000ca  7111              STRB     r1,[r2,#4]
;;;151    
;;;152    
;;;153    if((SK_ZVUK_EN[0])) sk_avar_ind_stat&=(~(1UL<<0));
0000cc  4bd1              LDR      r3,|L1.1044|
0000ce  881e              LDRH     r6,[r3,#0]  ; SK_ZVUK_EN
0000d0  b116              CBZ      r6,|L1.216|
0000d2  f0240401          BIC      r4,r4,#1
0000d6  7054              STRB     r4,[r2,#1]
                  |L1.216|
;;;154    if((SK_ZVUK_EN[1])) sk_avar_ind_stat&=(~(1UL<<1));
0000d8  885c              LDRH     r4,[r3,#2]  ; SK_ZVUK_EN
0000da  b11c              CBZ      r4,|L1.228|
0000dc  7854              LDRB     r4,[r2,#1]  ; sk_avar_ind_stat
0000de  f0240402          BIC      r4,r4,#2
0000e2  7054              STRB     r4,[r2,#1]
                  |L1.228|
;;;155    if((SK_ZVUK_EN[2])) sk_avar_ind_stat&=(~(1UL<<2));
0000e4  889c              LDRH     r4,[r3,#4]  ; SK_ZVUK_EN
0000e6  b11c              CBZ      r4,|L1.240|
0000e8  7854              LDRB     r4,[r2,#1]  ; sk_avar_ind_stat
0000ea  f0240404          BIC      r4,r4,#4
0000ee  7054              STRB     r4,[r2,#1]
                  |L1.240|
;;;156    if((SK_ZVUK_EN[3])) sk_avar_ind_stat&=(~(1UL<<3));	
0000f0  88db              LDRH     r3,[r3,#6]  ; SK_ZVUK_EN
0000f2  b11b              CBZ      r3,|L1.252|
0000f4  7853              LDRB     r3,[r2,#1]  ; sk_avar_ind_stat
0000f6  f0230308          BIC      r3,r3,#8
0000fa  7053              STRB     r3,[r2,#1]
                  |L1.252|
;;;157    
;;;158    if(!AV_OFF_AVT)sk_avar_stat_offed|=0x0f;
0000fc  b915              CBNZ     r5,|L1.260|
0000fe  f041010f          ORR      r1,r1,#0xf
000102  7111              STRB     r1,[r2,#4]
                  |L1.260|
;;;159    
;;;160    sk_avar_ind_stat&=sk_avar_stat_offed; 
000104  7851              LDRB     r1,[r2,#1]  ; sk_avar_ind_stat
000106  7913              LDRB     r3,[r2,#4]  ; sk_avar_stat_offed
000108  ea010103          AND      r1,r1,r3
00010c  7051              STRB     r1,[r2,#1]
;;;161    
;;;162    sk_avar_stat_old=sk_avar_stat;
00010e  7090              STRB     r0,[r2,#2]
;;;163    
;;;164    //oleg_start
;;;165    
;;;166    
;;;167    
;;;168    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
000110  48c1              LDR      r0,|L1.1048|
000112  49c2              LDR      r1,|L1.1052|
000114  8800              LDRH     r0,[r0,#0]  ; status_izm_r
000116  6809              LDR      r1,[r1,#0]  ; sk_alarm
000118  f000003f          AND      r0,r0,#0x3f
00011c  ea402001          ORR      r0,r0,r1,LSL #8
000120  61d0              STR      r0,[r2,#0x1c]  ; rki_avar1_stat
;;;169    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
000122  6a53              LDR      r3,[r2,#0x24]  ; rki_avar1_stat_old
000124  ea200103          BIC      r1,r0,r3
000128  6291              STR      r1,[r2,#0x28]  ; rki_avar1_stat_new
;;;170    rki_avar1_ind_stat|=rki_avar1_stat_new;
00012a  6a14              LDR      r4,[r2,#0x20]  ; rki_avar1_ind_stat
00012c  ea440401          ORR      r4,r4,r1
;;;171    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
000130  ea230300          BIC      r3,r3,r0
000134  ea6f0103          MVN      r1,r3
000138  62d1              STR      r1,[r2,#0x2c]  ; rki_avar1_stat_offed
;;;172    rki_avar1_ind_stat&=rki_avar1_stat_offed;
00013a  ea040401          AND      r4,r4,r1
00013e  6214              STR      r4,[r2,#0x20]  ; rki_avar1_ind_stat
;;;173    rki_avar1_stat_old=rki_avar1_stat;
000140  6250              STR      r0,[r2,#0x24]  ; rki_avar1_stat_old
;;;174    /*
;;;175    rki_avarI1_stat=status_di1;
;;;176    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;177    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;178    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;179    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;180    rki_avarI1_stat_old=rki_avarI1_stat;
;;;181    
;;;182    rki_avarI2_stat=status_di2;
;;;183    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;184    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;185    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;186    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;187    rki_avarI2_stat_old=rki_avarI2_stat;
;;;188    */
;;;189    //oleg_end
;;;190    }
000142  bd70              POP      {r4-r6,pc}
;;;191    
                          ENDP

                  reload_hndl PROC
;;;192    //-----------------------------------------------
;;;193    void reload_hndl(void)
000144  b5f8              PUSH     {r3-r7,lr}
;;;194    {
;;;195    
;;;196    char data[4];
;;;197    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;198    
;;;199    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000146  f44f6560          MOV      r5,#0xe00
00014a  4628              MOV      r0,r5
00014c  f7fffffe          BL       lc640_read_int
;;;200    event_ptr++;	
000150  f1000001          ADD      r0,r0,#1
000154  4604              MOV      r4,r0
;;;201    if(event_ptr>63)event_ptr=0;	
000156  2c3f              CMP      r4,#0x3f
000158  d901              BLS      |L1.350|
00015a  f04f0400          MOV      r4,#0
                  |L1.350|
;;;202    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
00015e  b221              SXTH     r1,r4
000160  4628              MOV      r0,r5
000162  f7fffffe          BL       lc640_write_int
;;;203    	
;;;204    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000166  f6406602          MOV      r6,#0xe02
00016a  4630              MOV      r0,r6
00016c  f7fffffe          BL       lc640_read_int
;;;205    if(event_cnt!=63)event_cnt=event_ptr;
000170  283f              CMP      r0,#0x3f
000172  d000              BEQ      |L1.374|
000174  4620              MOV      r0,r4
                  |L1.374|
;;;206    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000176  b201              SXTH     r1,r0
000178  4630              MOV      r0,r6
00017a  f7fffffe          BL       lc640_write_int
;;;207    	
;;;208    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
00017e  4628              MOV      r0,r5
000180  f7fffffe          BL       lc640_read_int
000184  f44f6180          MOV      r1,#0x400
000188  eb011440          ADD      r4,r1,r0,LSL #5
;;;209    	
;;;210    data[0]='U';
00018c  f04f0055          MOV      r0,#0x55
000190  f88d0000          STRB     r0,[sp,#0]
;;;211    data[1]=0;
000194  f04f0600          MOV      r6,#0
000198  f88d6001          STRB     r6,[sp,#1]
;;;212    data[2]='R';
00019c  f04f0052          MOV      r0,#0x52
0001a0  f88d0002          STRB     r0,[sp,#2]
;;;213    data[3]=0;
0001a4  f88d6003          STRB     r6,[sp,#3]
;;;214    lc640_write_long_ptr(lc640_adr,data);
0001a8  4669              MOV      r1,sp
0001aa  4620              MOV      r0,r4
0001ac  f7fffffe          BL       lc640_write_long_ptr
;;;215    
;;;216    data[0]=0;
;;;217    data[1]=0;
;;;218    data[2]=0;
;;;219    data[3]=0;
0001b0  9600              STR      r6,[sp,#0]
;;;220    lc640_write_long_ptr(lc640_adr+4,data);
0001b2  4669              MOV      r1,sp
0001b4  1d20              ADDS     r0,r4,#4
0001b6  f7fffffe          BL       lc640_write_long_ptr
;;;221    
;;;222    data[0]=LPC_RTC->YEAR;
0001ba  4d99              LDR      r5,|L1.1056|
0001bc  8ba8              LDRH     r0,[r5,#0x1c]
0001be  f88d0000          STRB     r0,[sp,#0]
;;;223    data[1]=LPC_RTC->MONTH;
0001c2  7e28              LDRB     r0,[r5,#0x18]
0001c4  f88d0001          STRB     r0,[sp,#1]
;;;224    data[2]=LPC_RTC->DOM;
0001c8  7b28              LDRB     r0,[r5,#0xc]
0001ca  f88d0002          STRB     r0,[sp,#2]
;;;225    data[3]=0;
0001ce  f88d6003          STRB     r6,[sp,#3]
;;;226    lc640_write_long_ptr(lc640_adr+8,data);
0001d2  4669              MOV      r1,sp
0001d4  f1040008          ADD      r0,r4,#8
0001d8  f7fffffe          BL       lc640_write_long_ptr
;;;227    
;;;228    data[0]=LPC_RTC->HOUR;
0001dc  7a28              LDRB     r0,[r5,#8]
0001de  f88d0000          STRB     r0,[sp,#0]
;;;229    data[1]=LPC_RTC->MIN;
0001e2  7928              LDRB     r0,[r5,#4]
0001e4  f88d0001          STRB     r0,[sp,#1]
;;;230    data[2]=LPC_RTC->SEC;
0001e8  7828              LDRB     r0,[r5,#0]
0001ea  f88d0002          STRB     r0,[sp,#2]
;;;231    data[3]=LPC_SC->RSID;
0001ee  488d              LDR      r0,|L1.1060|
0001f0  f8d00180          LDR      r0,[r0,#0x180]
0001f4  f88d0003          STRB     r0,[sp,#3]
;;;232    
;;;233    lc640_write_long_ptr(lc640_adr+12,data);
0001f8  4669              MOV      r1,sp
0001fa  f104000c          ADD      r0,r4,#0xc
0001fe  f7fffffe          BL       lc640_write_long_ptr
;;;234    	
;;;235    data[0]='A';
000202  f04f0541          MOV      r5,#0x41
000206  f88d5000          STRB     r5,[sp,#0]
;;;236    data[1]='A';
00020a  f88d5001          STRB     r5,[sp,#1]
;;;237    data[2]='A';
00020e  f88d5002          STRB     r5,[sp,#2]
;;;238    data[3]='A';
000212  f88d5003          STRB     r5,[sp,#3]
;;;239    lc640_write_long_ptr(lc640_adr+16,data);
000216  4669              MOV      r1,sp
000218  f1040010          ADD      r0,r4,#0x10
00021c  f7fffffe          BL       lc640_write_long_ptr
;;;240    	
;;;241    data[0]='A';
000220  f88d5000          STRB     r5,[sp,#0]
;;;242    data[1]='A';
000224  f88d5001          STRB     r5,[sp,#1]
;;;243    data[2]='A';
000228  f88d5002          STRB     r5,[sp,#2]
;;;244    data[3]='A';
00022c  f88d5003          STRB     r5,[sp,#3]
;;;245    lc640_write_long_ptr(lc640_adr+20,data);
000230  4669              MOV      r1,sp
000232  f1040014          ADD      r0,r4,#0x14
000236  f7fffffe          BL       lc640_write_long_ptr
;;;246    	
;;;247    data[0]='A';
00023a  f88d5000          STRB     r5,[sp,#0]
;;;248    data[1]='A';
00023e  f88d5001          STRB     r5,[sp,#1]
;;;249    data[2]='A';
000242  f88d5002          STRB     r5,[sp,#2]
;;;250    data[3]='A';
000246  f88d5003          STRB     r5,[sp,#3]
;;;251    lc640_write_long_ptr(lc640_adr+24,data);
00024a  4669              MOV      r1,sp
00024c  f1040018          ADD      r0,r4,#0x18
000250  f7fffffe          BL       lc640_write_long_ptr
;;;252    	
;;;253    data[0]='A';
000254  f88d5000          STRB     r5,[sp,#0]
;;;254    data[1]='A';
000258  f88d5001          STRB     r5,[sp,#1]
;;;255    data[2]='A';
00025c  f88d5002          STRB     r5,[sp,#2]
;;;256    data[3]='A';
000260  f88d5003          STRB     r5,[sp,#3]
;;;257    lc640_write_long_ptr(lc640_adr+28,data);				
000264  4669              MOV      r1,sp
000266  f104001c          ADD      r0,r4,#0x1c
00026a  f7fffffe          BL       lc640_write_long_ptr
;;;258    	
;;;259    	
;;;260    }
00026e  bdf8              POP      {r3-r7,pc}
;;;261    
                          ENDP

                  avar_unet_hndl PROC
;;;262    //-----------------------------------------------
;;;263    void avar_unet_hndl(char in)
000270  e92d4ff8          PUSH     {r3-r11,lr}
;;;264    {
000274  4604              MOV      r4,r0
;;;265    
;;;266    char data[4];
;;;267    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;268    
;;;269    
;;;270    if(in==1)
;;;271    	{
;;;272    	net_av|=1; //o_10
000276  4962              LDR      r1,|L1.1024|
;;;273    	net_av_2min_timer=1200;
;;;274    
;;;275    	//beep_init(0x01L,'O');
;;;276    	//a.av.bAN=1;
;;;277    
;;;278    
;;;279    	//beep_init(0x33333333,'A');
;;;280    	 
;;;281    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;282    	event_ptr++;	
;;;283    	if(event_ptr>63)event_ptr=0;	
;;;284    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;285    	
;;;286         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;287    	if(event_cnt!=63)event_cnt=event_ptr;
;;;288    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;289    	
;;;290    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;291    	
;;;292    	data[0]='P';
;;;293    	data[1]=0;
;;;294    	data[2]='A';
;;;295    	data[3]=0;
;;;296    	lc640_write_long_ptr(lc640_adr,data);
;;;297    
;;;298    	data[0]=0;//*((char*)&Unet_store);
;;;299    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;300    	data[2]=0;
;;;301    	data[3]=0;
;;;302    	lc640_write_long_ptr(lc640_adr+4,data);
;;;303    
;;;304    	data[0]=LPC_RTC->YEAR;
000278  4d6b              LDR      r5,|L1.1064|
00027a  f04f0600          MOV      r6,#0                 ;283
00027e  7808              LDRB     r0,[r1,#0]            ;272
000280  f04f0b50          MOV      r11,#0x50             ;292
000284  f04f0841          MOV      r8,#0x41              ;294
000288  f44f6260          MOV      r2,#0xe00             ;281
00028c  f6406a02          MOV      r10,#0xe02            ;286
000290  f44f6780          MOV      r7,#0x400             ;290
000294  2c01              CMP      r4,#1                 ;270
000296  d008              BEQ      |L1.682|
;;;305    	data[1]=LPC_RTC->MONTH;
;;;306    	data[2]=LPC_RTC->DOM;
;;;307    	data[3]=0;
;;;308    	lc640_write_long_ptr(lc640_adr+8,data);
;;;309    
;;;310    	data[0]=LPC_RTC->HOUR;
;;;311    	data[1]=LPC_RTC->MIN;
;;;312    	data[2]=LPC_RTC->SEC;
;;;313    	data[3]=0;
;;;314    	lc640_write_long_ptr(lc640_adr+12,data);
;;;315    	
;;;316    	data[0]='A';
;;;317    	data[1]='A';
;;;318    	data[2]='A';
;;;319    	data[3]='A';
;;;320    	lc640_write_long_ptr(lc640_adr+16,data);
;;;321    	
;;;322    	data[0]='A';
;;;323    	data[1]='A';
;;;324    	data[2]='A';
;;;325    	data[3]='A';
;;;326    	lc640_write_long_ptr(lc640_adr+20,data);
;;;327    	
;;;328    	data[0]='A';
;;;329    	data[1]='A';
;;;330    	data[2]='A';
;;;331    	data[3]='A';
;;;332    	lc640_write_long_ptr(lc640_adr+24,data);
;;;333    	
;;;334    	data[0]='A';
;;;335    	data[1]='A';
;;;336    	data[2]='A';
;;;337    	data[3]='A';
;;;338    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;339    	
;;;340    /*	memo_out0[0]=0x55;
;;;341         memo_out0[1]=0x00+2;
;;;342         memo_out0[2]=1;
;;;343         memo_out0[3]=0x0b;
;;;344         memo_out0[4]=0x55;
;;;345         memo_out0[5]=0x55; 
;;;346         	
;;;347         memo_out0[6]=crc_87(memo_out0,6);
;;;348    	memo_out0[7]=crc_95(memo_out0,6);
;;;349         usart_out_adr0(memo_out0,8); 
;;;350    	*/
;;;351    	snmp_trap_send("Main power alarm, voltage reduced",2,1,0);
;;;352    	}
;;;353    
;;;354    else if(in==2)
;;;355    	{
;;;356    	net_av|=2;	  //o_10
;;;357    
;;;358    	//beep_init(0x01L,'O');
;;;359    	//a.av.bAN=1;
;;;360    
;;;361    
;;;362    	//beep_init(0x33333333,'A');
;;;363    	 
;;;364    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;365    	event_ptr++;	
;;;366    	if(event_ptr>63)event_ptr=0;	
;;;367    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;368    	
;;;369         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;370    	if(event_cnt!=63)event_cnt=event_ptr;
;;;371    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;372    	
;;;373    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;374    	
;;;375    	data[0]='P';
;;;376    	data[1]=0;
;;;377    	data[2]='B';
000298  f04f0942          MOV      r9,#0x42
00029c  2c02              CMP      r4,#2                 ;354
00029e  d07d              BEQ      |L1.924|
;;;378    	data[3]=0;
;;;379    	lc640_write_long_ptr(lc640_adr,data);
;;;380    
;;;381    	data[0]=0;//*((char*)&Unet_store);
;;;382    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;383    	data[2]=0;
;;;384    	data[3]=0;
;;;385    	lc640_write_long_ptr(lc640_adr+4,data);
;;;386    
;;;387    	data[0]=LPC_RTC->YEAR;
;;;388    	data[1]=LPC_RTC->MONTH;
;;;389    	data[2]=LPC_RTC->DOM;
;;;390    	data[3]=0;
;;;391    	lc640_write_long_ptr(lc640_adr+8,data);
;;;392    
;;;393    	data[0]=LPC_RTC->HOUR;
;;;394    	data[1]=LPC_RTC->MIN;
;;;395    	data[2]=LPC_RTC->SEC;
;;;396    	data[3]=0;
;;;397    	lc640_write_long_ptr(lc640_adr+12,data);
;;;398    	
;;;399    	data[0]='A';
;;;400    	data[1]='A';
;;;401    	data[2]='A';
;;;402    	data[3]='A';
;;;403    	lc640_write_long_ptr(lc640_adr+16,data);
;;;404    	
;;;405    	data[0]='A';
;;;406    	data[1]='A';
;;;407    	data[2]='A';
;;;408    	data[3]='A';
;;;409    	lc640_write_long_ptr(lc640_adr+20,data);
;;;410    	
;;;411    	data[0]='A';
;;;412    	data[1]='A';
;;;413    	data[2]='A';
;;;414    	data[3]='A';
;;;415    	lc640_write_long_ptr(lc640_adr+24,data);
;;;416    	
;;;417    	data[0]='A';
;;;418    	data[1]='A';
;;;419    	data[2]='A';
;;;420    	data[3]='A';
;;;421    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;422    	
;;;423    	snmp_trap_send("Main power alarm, voltage increased",2,2,0);
;;;424    	}
;;;425    //o_10_s
;;;426    else if(in==0 || in==4)	
0002a0  2c00              CMP      r4,#0
                  |L1.674|
0002a2  d07c              BEQ      |L1.926|
0002a4  2c04              CMP      r4,#4
0002a6  d0fc              BEQ      |L1.674|
0002a8  e1fd              B        |L1.1702|
                  |L1.682|
0002aa  f0400001          ORR      r0,r0,#1              ;272
0002ae  7008              STRB     r0,[r1,#0]            ;272
0002b0  485e              LDR      r0,|L1.1068|
0002b2  f44f6196          MOV      r1,#0x4b0             ;273
0002b6  8001              STRH     r1,[r0,#0]            ;273
0002b8  4614              MOV      r4,r2                 ;281
0002ba  4620              MOV      r0,r4                 ;281
0002bc  f7fffffe          BL       lc640_read_int
0002c0  f1000001          ADD      r0,r0,#1              ;282
0002c4  4681              MOV      r9,r0                 ;282
0002c6  f1b90f3f          CMP      r9,#0x3f              ;283
0002ca  d901              BLS      |L1.720|
0002cc  f04f0900          MOV      r9,#0                 ;283
                  |L1.720|
0002d0  fa0ff189          SXTH     r1,r9                 ;284
0002d4  4620              MOV      r0,r4                 ;284
0002d6  f7fffffe          BL       lc640_write_int
0002da  4650              MOV      r0,r10                ;286
0002dc  f7fffffe          BL       lc640_read_int
0002e0  283f              CMP      r0,#0x3f              ;287
0002e2  d000              BEQ      |L1.742|
0002e4  4648              MOV      r0,r9                 ;287
                  |L1.742|
0002e6  b201              SXTH     r1,r0                 ;288
0002e8  4650              MOV      r0,r10                ;288
0002ea  f7fffffe          BL       lc640_write_int
0002ee  4620              MOV      r0,r4                 ;290
0002f0  f7fffffe          BL       lc640_read_int
0002f4  eb071440          ADD      r4,r7,r0,LSL #5       ;290
0002f8  f88db000          STRB     r11,[sp,#0]           ;292
0002fc  f88d6001          STRB     r6,[sp,#1]            ;293
000300  f88d8002          STRB     r8,[sp,#2]            ;294
000304  f88d6003          STRB     r6,[sp,#3]            ;295
000308  4669              MOV      r1,sp                 ;296
00030a  4620              MOV      r0,r4                 ;296
00030c  f7fffffe          BL       lc640_write_long_ptr
000310  9600              STR      r6,[sp,#0]            ;301
000312  4669              MOV      r1,sp                 ;302
000314  1d20              ADDS     r0,r4,#4              ;302
000316  f7fffffe          BL       lc640_write_long_ptr
00031a  f1050520          ADD      r5,r5,#0x20           ;304
00031e  8ba8              LDRH     r0,[r5,#0x1c]         ;304
000320  f88d0000          STRB     r0,[sp,#0]            ;304
000324  7e28              LDRB     r0,[r5,#0x18]         ;305
000326  f88d0001          STRB     r0,[sp,#1]            ;305
00032a  7b28              LDRB     r0,[r5,#0xc]          ;306
00032c  f88d0002          STRB     r0,[sp,#2]            ;306
000330  f88d6003          STRB     r6,[sp,#3]            ;307
000334  4669              MOV      r1,sp                 ;308
000336  f1040008          ADD      r0,r4,#8              ;308
00033a  f7fffffe          BL       lc640_write_long_ptr
00033e  7a28              LDRB     r0,[r5,#8]            ;310
000340  f88d0000          STRB     r0,[sp,#0]            ;310
000344  7928              LDRB     r0,[r5,#4]            ;311
000346  f88d0001          STRB     r0,[sp,#1]            ;311
00034a  7828              LDRB     r0,[r5,#0]            ;312
00034c  f88d0002          STRB     r0,[sp,#2]            ;312
000350  f88d6003          STRB     r6,[sp,#3]            ;313
000354  4669              MOV      r1,sp                 ;314
000356  f104000c          ADD      r0,r4,#0xc            ;314
00035a  f7fffffe          BL       lc640_write_long_ptr
00035e  f88d8000          STRB     r8,[sp,#0]            ;316
000362  f88d8001          STRB     r8,[sp,#1]            ;317
000366  f88d8002          STRB     r8,[sp,#2]            ;318
00036a  f88d8003          STRB     r8,[sp,#3]            ;319
00036e  4669              MOV      r1,sp                 ;320
000370  f1040010          ADD      r0,r4,#0x10           ;320
000374  f7fffffe          BL       lc640_write_long_ptr
000378  f88d8000          STRB     r8,[sp,#0]            ;322
00037c  f88d8001          STRB     r8,[sp,#1]            ;323
000380  f88d8002          STRB     r8,[sp,#2]            ;324
000384  f88d8003          STRB     r8,[sp,#3]            ;325
000388  4669              MOV      r1,sp                 ;326
00038a  f1040014          ADD      r0,r4,#0x14           ;326
00038e  f7fffffe          BL       lc640_write_long_ptr
000392  f88d8000          STRB     r8,[sp,#0]            ;328
000396  f88d8001          STRB     r8,[sp,#1]            ;329
00039a  e001              B        |L1.928|
                  |L1.924|
00039c  e01d              B        |L1.986|
                  |L1.926|
00039e  e0d9              B        |L1.1364|
                  |L1.928|
0003a0  f88d8002          STRB     r8,[sp,#2]            ;330
0003a4  f88d8003          STRB     r8,[sp,#3]            ;331
0003a8  4669              MOV      r1,sp                 ;332
0003aa  f1040018          ADD      r0,r4,#0x18           ;332
0003ae  f7fffffe          BL       lc640_write_long_ptr
0003b2  f88d8000          STRB     r8,[sp,#0]            ;334
0003b6  f88d8001          STRB     r8,[sp,#1]            ;335
0003ba  f88d8002          STRB     r8,[sp,#2]            ;336
0003be  f88d8003          STRB     r8,[sp,#3]            ;337
0003c2  4669              MOV      r1,sp                 ;338
0003c4  f104001c          ADD      r0,r4,#0x1c           ;338
0003c8  f7fffffe          BL       lc640_write_long_ptr
0003cc  2300              MOVS     r3,#0                 ;351
0003ce  2201              MOVS     r2,#1                 ;351
0003d0  2102              MOVS     r1,#2                 ;351
0003d2  a017              ADR      r0,|L1.1072|
0003d4  f7fffffe          BL       snmp_trap_send
0003d8  e165              B        |L1.1702|
                  |L1.986|
0003da  f0400002          ORR      r0,r0,#2              ;356
0003de  7008              STRB     r0,[r1,#0]            ;356
0003e0  f44f6060          MOV      r0,#0xe00             ;364
0003e4  f7fffffe          BL       lc640_read_int
0003e8  f1000001          ADD      r0,r0,#1              ;365
0003ec  4604              MOV      r4,r0                 ;365
0003ee  2c3f              CMP      r4,#0x3f              ;366
0003f0  d901              BLS      |L1.1014|
0003f2  f04f0400          MOV      r4,#0                 ;366
                  |L1.1014|
0003f6  b221              SXTH     r1,r4                 ;367
0003f8  f44f6060          MOV      r0,#0xe00             ;367
0003fc  e02a              B        |L1.1108|
0003fe  0000              DCW      0x0000
                  |L1.1024|
                          DCD      net_av
                  |L1.1028|
                          DCD      ||.data||
                  |L1.1032|
                          DCD      bps
                  |L1.1036|
                          DCD      AV_OFF_AVT
                  |L1.1040|
                          DCD      0xeffffffe
                  |L1.1044|
                          DCD      SK_ZVUK_EN
                  |L1.1048|
                          DCD      status_izm_r
                  |L1.1052|
                          DCD      sk_alarm
                  |L1.1056|
                          DCD      0x40024020
                  |L1.1060|
                          DCD      0x400fc000
                  |L1.1064|
                          DCD      0x40024000
                  |L1.1068|
                          DCD      net_av_2min_timer
                  |L1.1072|
000430  4d61696e          DCB      "Main power alarm, voltage reduced",0
000434  20706f77
000438  65722061
00043c  6c61726d
000440  2c20766f
000444  6c746167
000448  65207265
00044c  64756365
000450  6400    
000452  00                DCB      0
000453  00                DCB      0
                  |L1.1108|
000454  f7fffffe          BL       lc640_write_int
000458  4650              MOV      r0,r10                ;369
00045a  f7fffffe          BL       lc640_read_int
00045e  283f              CMP      r0,#0x3f              ;370
000460  d000              BEQ      |L1.1124|
000462  4620              MOV      r0,r4                 ;370
                  |L1.1124|
000464  b201              SXTH     r1,r0                 ;371
000466  4650              MOV      r0,r10                ;371
000468  f7fffffe          BL       lc640_write_int
00046c  f44f6060          MOV      r0,#0xe00             ;373
000470  f7fffffe          BL       lc640_read_int
000474  eb071440          ADD      r4,r7,r0,LSL #5       ;373
000478  f88db000          STRB     r11,[sp,#0]           ;375
00047c  f88d6001          STRB     r6,[sp,#1]            ;376
000480  f88d9002          STRB     r9,[sp,#2]            ;377
000484  f88d6003          STRB     r6,[sp,#3]            ;378
000488  4669              MOV      r1,sp                 ;379
00048a  4620              MOV      r0,r4                 ;379
00048c  f7fffffe          BL       lc640_write_long_ptr
000490  9600              STR      r6,[sp,#0]            ;384
000492  4669              MOV      r1,sp                 ;385
000494  1d20              ADDS     r0,r4,#4              ;385
000496  f7fffffe          BL       lc640_write_long_ptr
00049a  f1050520          ADD      r5,r5,#0x20           ;387
00049e  8ba8              LDRH     r0,[r5,#0x1c]         ;387
0004a0  f88d0000          STRB     r0,[sp,#0]            ;387
0004a4  7e28              LDRB     r0,[r5,#0x18]         ;388
0004a6  f88d0001          STRB     r0,[sp,#1]            ;388
0004aa  7b28              LDRB     r0,[r5,#0xc]          ;389
0004ac  f88d0002          STRB     r0,[sp,#2]            ;389
0004b0  f88d6003          STRB     r6,[sp,#3]            ;390
0004b4  4669              MOV      r1,sp                 ;391
0004b6  f1040008          ADD      r0,r4,#8              ;391
0004ba  f7fffffe          BL       lc640_write_long_ptr
0004be  7a28              LDRB     r0,[r5,#8]            ;393
0004c0  f88d0000          STRB     r0,[sp,#0]            ;393
0004c4  7928              LDRB     r0,[r5,#4]            ;394
0004c6  f88d0001          STRB     r0,[sp,#1]            ;394
0004ca  7828              LDRB     r0,[r5,#0]            ;395
0004cc  f88d0002          STRB     r0,[sp,#2]            ;395
0004d0  f88d6003          STRB     r6,[sp,#3]            ;396
0004d4  4669              MOV      r1,sp                 ;397
0004d6  f104000c          ADD      r0,r4,#0xc            ;397
0004da  f7fffffe          BL       lc640_write_long_ptr
0004de  f88d8000          STRB     r8,[sp,#0]            ;399
0004e2  f88d8001          STRB     r8,[sp,#1]            ;400
0004e6  f88d8002          STRB     r8,[sp,#2]            ;401
0004ea  f88d8003          STRB     r8,[sp,#3]            ;402
0004ee  4669              MOV      r1,sp                 ;403
0004f0  f1040010          ADD      r0,r4,#0x10           ;403
0004f4  f7fffffe          BL       lc640_write_long_ptr
0004f8  f88d8000          STRB     r8,[sp,#0]            ;405
0004fc  f88d8001          STRB     r8,[sp,#1]            ;406
000500  f88d8002          STRB     r8,[sp,#2]            ;407
000504  f88d8003          STRB     r8,[sp,#3]            ;408
000508  4669              MOV      r1,sp                 ;409
00050a  f1040014          ADD      r0,r4,#0x14           ;409
00050e  f7fffffe          BL       lc640_write_long_ptr
000512  f88d8000          STRB     r8,[sp,#0]            ;411
000516  f88d8001          STRB     r8,[sp,#1]            ;412
00051a  f88d8002          STRB     r8,[sp,#2]            ;413
00051e  f88d8003          STRB     r8,[sp,#3]            ;414
000522  4669              MOV      r1,sp                 ;415
000524  f1040018          ADD      r0,r4,#0x18           ;415
000528  f7fffffe          BL       lc640_write_long_ptr
00052c  f88d8000          STRB     r8,[sp,#0]            ;417
000530  f88d8001          STRB     r8,[sp,#1]            ;418
000534  f88d8002          STRB     r8,[sp,#2]            ;419
000538  f88d8003          STRB     r8,[sp,#3]            ;420
00053c  4669              MOV      r1,sp                 ;421
00053e  f104001c          ADD      r0,r4,#0x1c           ;421
000542  f7fffffe          BL       lc640_write_long_ptr
000546  2202              MOVS     r2,#2                 ;423
000548  2300              MOVS     r3,#0                 ;423
00054a  4611              MOV      r1,r2                 ;423
00054c  a0fd              ADR      r0,|L1.2372|
00054e  f7fffffe          BL       snmp_trap_send
000552  e0a8              B        |L1.1702|
                  |L1.1364|
;;;427    	{
;;;428    //	if( (in==0 && (net_av&2)==0) || (in==4 && (net_av&1)==0) )  {
;;;429    		if(in==0) net_av&=~1;
000554  b914              CBNZ     r4,|L1.1372|
000556  f0200001          BIC      r0,r0,#1
00055a  7008              STRB     r0,[r1,#0]
                  |L1.1372|
;;;430    		if(in==4) net_av&=~2;	 
00055c  2c04              CMP      r4,#4
00055e  d103              BNE      |L1.1384|
000560  7808              LDRB     r0,[r1,#0]  ; net_av
000562  f0200002          BIC      r0,r0,#2
000566  7008              STRB     r0,[r1,#0]
                  |L1.1384|
;;;431    		if(net_av==0) if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
000568  7809              LDRB     r1,[r1,#0]  ; net_av
00056a  48ff              LDR      r0,|L1.2408|
00056c  b931              CBNZ     r1,|L1.1404|
00056e  49ff              LDR      r1,|L1.2412|
000570  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
000572  b119              CBZ      r1,|L1.1404|
000574  68c1              LDR      r1,[r0,#0xc]  ; avar_ind_stat
000576  f0210101          BIC      r1,r1,#1
00057a  60c1              STR      r1,[r0,#0xc]  ; avar_ind_stat
                  |L1.1404|
;;;432    
;;;433    	SET_REG(avar_stat,0,0,1);
00057c  6881              LDR      r1,[r0,#8]  ; avar_stat
00057e  f0210101          BIC      r1,r1,#1
000582  6081              STR      r1,[r0,#8]  ; avar_stat
;;;434    	
;;;435    	
;;;436    //}
;;;437    //o_10_e
;;;438    
;;;439         event_ptr=lc640_read_int(PTR_EVENT_LOG);
000584  4610              MOV      r0,r2
000586  f7fffffe          BL       lc640_read_int
00058a  4683              MOV      r11,r0
;;;440    	event_ptr_find=event_ptr;
00058c  46d8              MOV      r8,r11
                  |L1.1422|
;;;441    avar_unet_hndl_lbl1:
;;;442    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
00058e  eb071a48          ADD      r10,r7,r8,LSL #5
;;;443    
;;;444         lc640_read_long_ptr(lc640_adr,data);
000592  4669              MOV      r1,sp
000594  4650              MOV      r0,r10
000596  f7fffffe          BL       lc640_read_long_ptr
;;;445         
;;;446         if( !( (data[0]=='P')&&(data[1]==0)&&( (in==0 && data[2]=='A' )||(in==4 && data[2]=='B') ) ) )	//o_10
00059a  f89d0000          LDRB     r0,[sp,#0]
00059e  2850              CMP      r0,#0x50
0005a0  d10f              BNE      |L1.1474|
0005a2  f89d0001          LDRB     r0,[sp,#1]
0005a6  b960              CBNZ     r0,|L1.1474|
0005a8  b114              CBZ      r4,|L1.1456|
0005aa  2c04              CMP      r4,#4
0005ac  d109              BNE      |L1.1474|
0005ae  e004              B        |L1.1466|
                  |L1.1456|
0005b0  f89d0002          LDRB     r0,[sp,#2]
0005b4  2841              CMP      r0,#0x41
0005b6  d104              BNE      |L1.1474|
0005b8  e00e              B        |L1.1496|
                  |L1.1466|
0005ba  f89d0002          LDRB     r0,[sp,#2]
0005be  2842              CMP      r0,#0x42
0005c0  d00a              BEQ      |L1.1496|
                  |L1.1474|
;;;447         	{        
;;;448         	if(event_ptr_find)event_ptr_find--;
0005c2  f1b80f00          CMP      r8,#0
0005c6  d002              BEQ      |L1.1486|
0005c8  f1a80801          SUB      r8,r8,#1
0005cc  e001              B        |L1.1490|
                  |L1.1486|
;;;449         	else event_ptr_find=63;
0005ce  f04f083f          MOV      r8,#0x3f
                  |L1.1490|
;;;450         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0005d2  45d8              CMP      r8,r11
0005d4  d1db              BNE      |L1.1422|
0005d6  e066              B        |L1.1702|
                  |L1.1496|
;;;451         	else goto avar_unet_hndl_lbl1;
;;;452         	}
;;;453         else 
;;;454         	{
;;;455         	lc640_read_long_ptr(lc640_adr+16,data);
0005d8  4669              MOV      r1,sp
0005da  f10a0010          ADD      r0,r10,#0x10
0005de  f7fffffe          BL       lc640_read_long_ptr
;;;456         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0005e2  f89d0000          LDRB     r0,[sp,#0]
0005e6  2841              CMP      r0,#0x41
0005e8  d10b              BNE      |L1.1538|
0005ea  f89d0001          LDRB     r0,[sp,#1]
0005ee  2841              CMP      r0,#0x41
0005f0  d107              BNE      |L1.1538|
0005f2  f89d0002          LDRB     r0,[sp,#2]
0005f6  2841              CMP      r0,#0x41
0005f8  d103              BNE      |L1.1538|
0005fa  f89d0003          LDRB     r0,[sp,#3]
0005fe  2841              CMP      r0,#0x41
000600  d00a              BEQ      |L1.1560|
                  |L1.1538|
;;;457         		{        
;;;458         		if(event_ptr_find)event_ptr_find--;
000602  f1b80f00          CMP      r8,#0
000606  d002              BEQ      |L1.1550|
000608  f1a80801          SUB      r8,r8,#1
00060c  e001              B        |L1.1554|
                  |L1.1550|
;;;459             		else event_ptr_find=63;
00060e  f04f083f          MOV      r8,#0x3f
                  |L1.1554|
;;;460             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000612  45d8              CMP      r8,r11
000614  d1bb              BNE      |L1.1422|
000616  e046              B        |L1.1702|
                  |L1.1560|
;;;461         		else goto avar_unet_hndl_lbl1;
;;;462         		}
;;;463    
;;;464         	}	
;;;465    	
;;;466    	data[0]=LPC_RTC->YEAR;
000618  f1050520          ADD      r5,r5,#0x20
00061c  8ba8              LDRH     r0,[r5,#0x1c]
00061e  f88d0000          STRB     r0,[sp,#0]
;;;467    	data[1]=LPC_RTC->MONTH;
000622  7e28              LDRB     r0,[r5,#0x18]
000624  f88d0001          STRB     r0,[sp,#1]
;;;468    	data[2]=LPC_RTC->DOM;
000628  7b28              LDRB     r0,[r5,#0xc]
00062a  f88d0002          STRB     r0,[sp,#2]
;;;469    	data[3]=0;
00062e  f88d6003          STRB     r6,[sp,#3]
;;;470    	lc640_write_long_ptr(lc640_adr+16,data);
000632  4669              MOV      r1,sp
000634  f10a0010          ADD      r0,r10,#0x10
000638  f7fffffe          BL       lc640_write_long_ptr
;;;471    
;;;472    	data[0]=LPC_RTC->HOUR;
00063c  7a28              LDRB     r0,[r5,#8]
00063e  f88d0000          STRB     r0,[sp,#0]
;;;473    	data[1]=LPC_RTC->MIN;
000642  7928              LDRB     r0,[r5,#4]
000644  f88d0001          STRB     r0,[sp,#1]
;;;474    	data[2]=LPC_RTC->SEC;
000648  7828              LDRB     r0,[r5,#0]
00064a  f88d0002          STRB     r0,[sp,#2]
;;;475    	data[3]=0;
00064e  f88d6003          STRB     r6,[sp,#3]
;;;476    	lc640_write_long_ptr(lc640_adr+20,data); 
000652  4669              MOV      r1,sp
000654  f10a0014          ADD      r0,r10,#0x14
000658  f7fffffe          BL       lc640_write_long_ptr
;;;477    	
;;;478    	//o_10_s
;;;479    	if(in==4) {
00065c  2c04              CMP      r4,#4
00065e  d025              BEQ      |L1.1708|
;;;480    	   	data[0]=*((char*)(&net_Ustore_max));
;;;481    		data[1]=*(((char*)(&net_Ustore_max))+1);
;;;482    	}else{
;;;483    		data[0]=*((char*)(&net_Ustore));
000660  48c3              LDR      r0,|L1.2416|
000662  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000664  f88d1000          STRB     r1,[sp,#0]
;;;484    		data[1]=*(((char*)(&net_Ustore))+1);
000668  7840              LDRB     r0,[r0,#1]  ; net_Ustore
00066a  f88d0001          STRB     r0,[sp,#1]
                  |L1.1646|
;;;485    	}
;;;486    	//o_10_e
;;;487    	data[2]='B';
00066e  f88d9002          STRB     r9,[sp,#2]
;;;488    	data[3]='B';
000672  f88d9003          STRB     r9,[sp,#3]
;;;489    	lc640_write_long_ptr(lc640_adr+24,data);
000676  4669              MOV      r1,sp
000678  f10a0018          ADD      r0,r10,#0x18
00067c  f7fffffe          BL       lc640_write_long_ptr
;;;490    	
;;;491    	data[0]='B';
000680  f88d9000          STRB     r9,[sp,#0]
;;;492    	data[1]='B';
000684  f88d9001          STRB     r9,[sp,#1]
;;;493    	data[2]='B';
000688  f88d9002          STRB     r9,[sp,#2]
;;;494    	data[3]='B';
00068c  f88d9003          STRB     r9,[sp,#3]
;;;495    	lc640_write_long_ptr(lc640_adr+28,data);	
000690  4669              MOV      r1,sp
000692  f10a001c          ADD      r0,r10,#0x1c
000696  f7fffffe          BL       lc640_write_long_ptr
;;;496    	
;;;497    /*	memo_out0[0]=0x55;
;;;498         memo_out0[1]=0x00+2;
;;;499         memo_out0[2]=1;
;;;500         memo_out0[3]=0x0b;
;;;501         memo_out0[4]=0xaa;
;;;502         memo_out0[5]=0xaa; 
;;;503         	
;;;504         memo_out0[6]=crc_87(memo_out0,6);
;;;505    	memo_out0[7]=crc_95(memo_out0,6);
;;;506         usart_out_adr0(memo_out0,8); */
;;;507         snmp_trap_send("Main power alarm  clear",2,1,1);	
00069a  2301              MOVS     r3,#1
00069c  461a              MOV      r2,r3
00069e  2102              MOVS     r1,#2
0006a0  a0b4              ADR      r0,|L1.2420|
0006a2  f7fffffe          BL       snmp_trap_send
                  |L1.1702|
;;;508    	}
;;;509    avar_unet_hndl_end:
;;;510    	__nop();		
0006a6  bf00              NOP      
                  |L1.1704|
;;;511    }
0006a8  e8bd8ff8          POP      {r3-r11,pc}
                  |L1.1708|
0006ac  48b7              LDR      r0,|L1.2444|
0006ae  7801              LDRB     r1,[r0,#0]            ;480  ; net_Ustore_max
0006b0  f88d1000          STRB     r1,[sp,#0]            ;480
0006b4  7840              LDRB     r0,[r0,#1]            ;481  ; net_Ustore_max
0006b6  f88d0001          STRB     r0,[sp,#1]            ;481
0006ba  e7d8              B        |L1.1646|
;;;512    
                          ENDP

                  avar_uout_hndl PROC
;;;514    //-----------------------------------------------
;;;515    void avar_uout_hndl(char in)
0006bc  e92d4ff8          PUSH     {r3-r11,lr}
;;;516    {
;;;517    
;;;518    char data[4];
;;;519    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;520    char avar_data=0;
;;;521    
;;;522    if(in==1)
;;;523    	{
;;;524    	//net_av=1;
;;;525    
;;;526    	//beep_init(0x01L,'O');
;;;527    	//a.av.bAN=1;
;;;528    
;;;529    
;;;530    	//beep_init(0x33333333,'A');
;;;531    
;;;532    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;533    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;534    	
;;;535    	avar_data=uout_av;
;;;536    		 
;;;537    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;538    	event_ptr++;	
;;;539    	if(event_ptr>63)event_ptr=0;	
;;;540    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;541    	
;;;542        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;543    	if(event_cnt!=63)event_cnt=event_ptr;
;;;544    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;545    	
;;;546    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;547    	
;;;548    	data[0]='Q';
;;;549    	data[1]=0;
;;;550    	data[2]='A';
;;;551    	data[3]=avar_data;
;;;552    	lc640_write_long_ptr(lc640_adr,data);
;;;553    
;;;554    	 //load_U=4321;
;;;555    
;;;556    	data[0]=*((char*)&load_U);
;;;557    	data[1]=*(((char*)&load_U)+1);
;;;558    	data[2]=0;
;;;559    	data[3]=0;
;;;560    	lc640_write_long_ptr(lc640_adr+4,data);
;;;561    
;;;562    	data[0]=LPC_RTC->YEAR;
0006c0  4fb3              LDR      r7,|L1.2448|
0006c2  49b4              LDR      r1,|L1.2452|
0006c4  f44f6560          MOV      r5,#0xe00             ;537
0006c8  f04f0800          MOV      r8,#0                 ;520
0006cc  f44f6980          MOV      r9,#0x400             ;546
0006d0  2801              CMP      r0,#1                 ;522
0006d2  d002              BEQ      |L1.1754|
;;;563    	data[1]=LPC_RTC->MONTH;
;;;564    	data[2]=LPC_RTC->DOM;
;;;565    	data[3]=0;
;;;566    	lc640_write_long_ptr(lc640_adr+8,data);
;;;567    
;;;568    	data[0]=LPC_RTC->HOUR;
;;;569    	data[1]=LPC_RTC->MIN;
;;;570    	data[2]=LPC_RTC->SEC;
;;;571    	data[3]=0;
;;;572    	lc640_write_long_ptr(lc640_adr+12,data);
;;;573    	
;;;574    	data[0]='A';
;;;575    	data[1]='A';
;;;576    	data[2]='A';
;;;577    	data[3]='A';
;;;578    	lc640_write_long_ptr(lc640_adr+16,data);
;;;579    	
;;;580    	data[0]='A';
;;;581    	data[1]='A';
;;;582    	data[2]='A';
;;;583    	data[3]='A';
;;;584    	lc640_write_long_ptr(lc640_adr+20,data);
;;;585    	
;;;586    	data[0]='A';
;;;587    	data[1]='A';
;;;588    	data[2]='A';
;;;589    	data[3]='A';
;;;590    	lc640_write_long_ptr(lc640_adr+24,data);
;;;591    	
;;;592    	data[0]='A';
;;;593    	data[1]='A';
;;;594    	data[2]='A';
;;;595    	data[3]='A';
;;;596    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;597    	
;;;598    /*	memo_out0[0]=0x55;
;;;599         memo_out0[1]=0x00+2;
;;;600         memo_out0[2]=1;
;;;601         memo_out0[3]=0x0b;
;;;602         memo_out0[4]=0x55;
;;;603         memo_out0[5]=0x55; 
;;;604         	
;;;605         memo_out0[6]=crc_87(memo_out0,6);
;;;606    	memo_out0[7]=crc_95(memo_out0,6);
;;;607         usart_out_adr0(memo_out0,8); 
;;;608    	*/
;;;609    	//snmp_trap_send("Main power is off",2,1,0);
;;;610    	}
;;;611    
;;;612    else if(in==0)
0006d4  2800              CMP      r0,#0
0006d6  d07d              BEQ      |L1.2004|
0006d8  e132              B        |L1.2368|
                  |L1.1754|
0006da  f8dfa2bc          LDR      r10,|L1.2456|
0006de  4aaf              LDR      r2,|L1.2460|
0006e0  f9ba0000          LDRSH    r0,[r10,#0]           ;532  ; load_U
0006e4  f9b22000          LDRSH    r2,[r2,#0]            ;532  ; U_OUT_KONTR_MAX
0006e8  4290              CMP      r0,r2                 ;532
0006ea  dd02              BLE      |L1.1778|
0006ec  f04f0201          MOV      r2,#1                 ;532
0006f0  700a              STRB     r2,[r1,#0]            ;532
                  |L1.1778|
0006f2  4aab              LDR      r2,|L1.2464|
0006f4  f9b22000          LDRSH    r2,[r2,#0]            ;533  ; U_OUT_KONTR_MIN
0006f8  4290              CMP      r0,r2                 ;533
0006fa  da02              BGE      |L1.1794|
0006fc  f04f0002          MOV      r0,#2                 ;533
000700  7008              STRB     r0,[r1,#0]            ;533
                  |L1.1794|
000702  780e              LDRB     r6,[r1,#0]            ;535  ; uout_av
000704  4628              MOV      r0,r5                 ;537
000706  f7fffffe          BL       lc640_read_int
00070a  f1000001          ADD      r0,r0,#1              ;538
00070e  4604              MOV      r4,r0                 ;538
000710  2c3f              CMP      r4,#0x3f              ;539
000712  d901              BLS      |L1.1816|
000714  f04f0400          MOV      r4,#0                 ;539
                  |L1.1816|
000718  b221              SXTH     r1,r4                 ;540
00071a  4628              MOV      r0,r5                 ;540
00071c  f7fffffe          BL       lc640_write_int
000720  f6406b02          MOV      r11,#0xe02            ;542
000724  4658              MOV      r0,r11                ;542
000726  f7fffffe          BL       lc640_read_int
00072a  283f              CMP      r0,#0x3f              ;543
00072c  d000              BEQ      |L1.1840|
00072e  4620              MOV      r0,r4                 ;543
                  |L1.1840|
000730  b201              SXTH     r1,r0                 ;544
000732  4658              MOV      r0,r11                ;544
000734  f7fffffe          BL       lc640_write_int
000738  4628              MOV      r0,r5                 ;546
00073a  f7fffffe          BL       lc640_read_int
00073e  eb091540          ADD      r5,r9,r0,LSL #5       ;546
000742  f04f0051          MOV      r0,#0x51              ;548
000746  f88d0000          STRB     r0,[sp,#0]            ;548
00074a  f88d8001          STRB     r8,[sp,#1]            ;549
00074e  f04f0441          MOV      r4,#0x41              ;550
000752  f88d4002          STRB     r4,[sp,#2]            ;550
000756  f88d6003          STRB     r6,[sp,#3]            ;551
00075a  4669              MOV      r1,sp                 ;552
00075c  4628              MOV      r0,r5                 ;552
00075e  f7fffffe          BL       lc640_write_long_ptr
000762  f89a0000          LDRB     r0,[r10,#0]           ;556  ; load_U
000766  f88d0000          STRB     r0,[sp,#0]            ;556
00076a  f89a0001          LDRB     r0,[r10,#1]           ;557  ; load_U
00076e  f88d0001          STRB     r0,[sp,#1]            ;557
000772  f88d8002          STRB     r8,[sp,#2]            ;558
000776  f88d8003          STRB     r8,[sp,#3]            ;559
00077a  4669              MOV      r1,sp                 ;560
00077c  1d28              ADDS     r0,r5,#4              ;560
00077e  f7fffffe          BL       lc640_write_long_ptr
000782  f1070720          ADD      r7,r7,#0x20           ;562
000786  8bb8              LDRH     r0,[r7,#0x1c]         ;562
000788  f88d0000          STRB     r0,[sp,#0]            ;562
00078c  7e38              LDRB     r0,[r7,#0x18]         ;563
00078e  f88d0001          STRB     r0,[sp,#1]            ;563
000792  7b38              LDRB     r0,[r7,#0xc]          ;564
000794  f88d0002          STRB     r0,[sp,#2]            ;564
000798  f88d8003          STRB     r8,[sp,#3]            ;565
00079c  4669              MOV      r1,sp                 ;566
00079e  f1050008          ADD      r0,r5,#8              ;566
0007a2  f7fffffe          BL       lc640_write_long_ptr
0007a6  7a38              LDRB     r0,[r7,#8]            ;568
0007a8  f88d0000          STRB     r0,[sp,#0]            ;568
0007ac  7938              LDRB     r0,[r7,#4]            ;569
0007ae  f88d0001          STRB     r0,[sp,#1]            ;569
0007b2  7838              LDRB     r0,[r7,#0]            ;570
0007b4  f88d0002          STRB     r0,[sp,#2]            ;570
0007b8  f88d8003          STRB     r8,[sp,#3]            ;571
0007bc  4669              MOV      r1,sp                 ;572
0007be  f105000c          ADD      r0,r5,#0xc            ;572
0007c2  f7fffffe          BL       lc640_write_long_ptr
0007c6  f88d4000          STRB     r4,[sp,#0]            ;574
0007ca  f88d4001          STRB     r4,[sp,#1]            ;575
0007ce  f88d4002          STRB     r4,[sp,#2]            ;576
0007d2  e000              B        |L1.2006|
                  |L1.2004|
0007d4  e02e              B        |L1.2100|
                  |L1.2006|
0007d6  f88d4003          STRB     r4,[sp,#3]            ;577
0007da  4669              MOV      r1,sp                 ;578
0007dc  f1050010          ADD      r0,r5,#0x10           ;578
0007e0  f7fffffe          BL       lc640_write_long_ptr
0007e4  f88d4000          STRB     r4,[sp,#0]            ;580
0007e8  f88d4001          STRB     r4,[sp,#1]            ;581
0007ec  f88d4002          STRB     r4,[sp,#2]            ;582
0007f0  f88d4003          STRB     r4,[sp,#3]            ;583
0007f4  4669              MOV      r1,sp                 ;584
0007f6  f1050014          ADD      r0,r5,#0x14           ;584
0007fa  f7fffffe          BL       lc640_write_long_ptr
0007fe  f88d4000          STRB     r4,[sp,#0]            ;586
000802  f88d4001          STRB     r4,[sp,#1]            ;587
000806  f88d4002          STRB     r4,[sp,#2]            ;588
00080a  f88d4003          STRB     r4,[sp,#3]            ;589
00080e  4669              MOV      r1,sp                 ;590
000810  f1050018          ADD      r0,r5,#0x18           ;590
000814  f7fffffe          BL       lc640_write_long_ptr
000818  f88d4000          STRB     r4,[sp,#0]            ;592
00081c  f88d4001          STRB     r4,[sp,#1]            ;593
000820  f88d4002          STRB     r4,[sp,#2]            ;594
000824  f88d4003          STRB     r4,[sp,#3]            ;595
000828  4669              MOV      r1,sp                 ;596
00082a  f105001c          ADD      r0,r5,#0x1c           ;596
00082e  f7fffffe          BL       lc640_write_long_ptr
000832  e085              B        |L1.2368|
                  |L1.2100|
;;;613    	{
;;;614    	uout_av=0;
000834  f8818000          STRB     r8,[r1,#0]
;;;615    
;;;616      /*
;;;617    	SET_REG(C2GSR,3,24,8);
;;;618    	C2MOD=0;
;;;619    	bOUT_FREE2=1;*/
;;;620    
;;;621    
;;;622    	//C2MOD=0;
;;;623    
;;;624    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;625    
;;;626         //beep_init(0x02L,'O');
;;;627    	//a_.av.bAN=0;
;;;628    //	SET_REG(avar_stat,0,0,1);
;;;629    
;;;630    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;631    	
;;;632    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;633    
;;;634        event_ptr=lc640_read_int(PTR_EVENT_LOG);
000838  4628              MOV      r0,r5
00083a  f7fffffe          BL       lc640_read_int
00083e  4606              MOV      r6,r0
;;;635    	event_ptr_find=event_ptr;
000840  4634              MOV      r4,r6
                  |L1.2114|
;;;636    avar_uout_hndl_lbl1:
;;;637    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000842  eb091544          ADD      r5,r9,r4,LSL #5
;;;638    
;;;639         lc640_read_long_ptr(lc640_adr,data);
000846  4669              MOV      r1,sp
000848  4628              MOV      r0,r5
00084a  f7fffffe          BL       lc640_read_long_ptr
;;;640         
;;;641         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
00084e  f89d0000          LDRB     r0,[sp,#0]
000852  2851              CMP      r0,#0x51
000854  d106              BNE      |L1.2148|
000856  f89d0001          LDRB     r0,[sp,#1]
00085a  b918              CBNZ     r0,|L1.2148|
00085c  f89d0002          LDRB     r0,[sp,#2]
000860  2841              CMP      r0,#0x41
000862  d008              BEQ      |L1.2166|
                  |L1.2148|
;;;642         	{        
;;;643         	if(event_ptr_find)event_ptr_find--;
000864  b114              CBZ      r4,|L1.2156|
000866  f1a40401          SUB      r4,r4,#1
00086a  e001              B        |L1.2160|
                  |L1.2156|
;;;644         	else event_ptr_find=63;
00086c  f04f043f          MOV      r4,#0x3f
                  |L1.2160|
;;;645         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000870  42b4              CMP      r4,r6
000872  d1e6              BNE      |L1.2114|
000874  e064              B        |L1.2368|
                  |L1.2166|
;;;646         	else goto avar_uout_hndl_lbl1;
;;;647         	}
;;;648         else 
;;;649         	{
;;;650         	lc640_read_long_ptr(lc640_adr+16,data);
000876  4669              MOV      r1,sp
000878  f1050010          ADD      r0,r5,#0x10
00087c  f7fffffe          BL       lc640_read_long_ptr
;;;651         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000880  f89d0000          LDRB     r0,[sp,#0]
000884  2841              CMP      r0,#0x41
000886  d10b              BNE      |L1.2208|
000888  f89d0001          LDRB     r0,[sp,#1]
00088c  2841              CMP      r0,#0x41
00088e  d107              BNE      |L1.2208|
000890  f89d0002          LDRB     r0,[sp,#2]
000894  2841              CMP      r0,#0x41
000896  d103              BNE      |L1.2208|
000898  f89d0003          LDRB     r0,[sp,#3]
00089c  2841              CMP      r0,#0x41
00089e  d008              BEQ      |L1.2226|
                  |L1.2208|
;;;652         		{        
;;;653         		if(event_ptr_find)event_ptr_find--;
0008a0  b114              CBZ      r4,|L1.2216|
0008a2  f1a40401          SUB      r4,r4,#1
0008a6  e001              B        |L1.2220|
                  |L1.2216|
;;;654             		else event_ptr_find=63;
0008a8  f04f043f          MOV      r4,#0x3f
                  |L1.2220|
;;;655             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0008ac  42b4              CMP      r4,r6
0008ae  d1c8              BNE      |L1.2114|
0008b0  e046              B        |L1.2368|
                  |L1.2226|
;;;656         		else goto avar_uout_hndl_lbl1;
;;;657         		}
;;;658    
;;;659         	}	
;;;660    	
;;;661    	data[0]=LPC_RTC->YEAR;
0008b2  f1070720          ADD      r7,r7,#0x20
0008b6  8bb8              LDRH     r0,[r7,#0x1c]
0008b8  f88d0000          STRB     r0,[sp,#0]
;;;662    	data[1]=LPC_RTC->MONTH;
0008bc  7e38              LDRB     r0,[r7,#0x18]
0008be  f88d0001          STRB     r0,[sp,#1]
;;;663    	data[2]=LPC_RTC->DOM;
0008c2  7b38              LDRB     r0,[r7,#0xc]
0008c4  f88d0002          STRB     r0,[sp,#2]
;;;664    	data[3]=0;
0008c8  f88d8003          STRB     r8,[sp,#3]
;;;665    	lc640_write_long_ptr(lc640_adr+16,data);
0008cc  4669              MOV      r1,sp
0008ce  f1050010          ADD      r0,r5,#0x10
0008d2  f7fffffe          BL       lc640_write_long_ptr
;;;666    
;;;667    	data[0]=LPC_RTC->HOUR;
0008d6  7a38              LDRB     r0,[r7,#8]
0008d8  f88d0000          STRB     r0,[sp,#0]
;;;668    	data[1]=LPC_RTC->MIN;
0008dc  7938              LDRB     r0,[r7,#4]
0008de  f88d0001          STRB     r0,[sp,#1]
;;;669    	data[2]=LPC_RTC->SEC;
0008e2  7838              LDRB     r0,[r7,#0]
0008e4  f88d0002          STRB     r0,[sp,#2]
;;;670    	data[3]=0;
0008e8  f88d8003          STRB     r8,[sp,#3]
;;;671    	lc640_write_long_ptr(lc640_adr+20,data); 
0008ec  4669              MOV      r1,sp
0008ee  f1050014          ADD      r0,r5,#0x14
0008f2  f7fffffe          BL       lc640_write_long_ptr
;;;672    	
;;;673    	data[0]=*((char*)(&net_Ustore));
0008f6  481e              LDR      r0,|L1.2416|
0008f8  7801              LDRB     r1,[r0,#0]  ; net_Ustore
0008fa  f88d1000          STRB     r1,[sp,#0]
;;;674    	data[1]=*(((char*)(&net_Ustore))+1);
0008fe  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000900  f88d0001          STRB     r0,[sp,#1]
;;;675    	data[2]='B';
000904  f04f0442          MOV      r4,#0x42
000908  f88d4002          STRB     r4,[sp,#2]
;;;676    	data[3]='B';
00090c  f88d4003          STRB     r4,[sp,#3]
;;;677    	lc640_write_long_ptr(lc640_adr+24,data);
000910  4669              MOV      r1,sp
000912  f1050018          ADD      r0,r5,#0x18
000916  f7fffffe          BL       lc640_write_long_ptr
;;;678    	
;;;679    	data[0]='B';
00091a  f88d4000          STRB     r4,[sp,#0]
;;;680    	data[1]='B';
00091e  f88d4001          STRB     r4,[sp,#1]
;;;681    	data[2]='B';
000922  f88d4002          STRB     r4,[sp,#2]
;;;682    	data[3]='B';
000926  f88d4003          STRB     r4,[sp,#3]
;;;683    	lc640_write_long_ptr(lc640_adr+28,data);	
00092a  4669              MOV      r1,sp
00092c  f105001c          ADD      r0,r5,#0x1c
000930  f7fffffe          BL       lc640_write_long_ptr
;;;684    	
;;;685    /*	memo_out0[0]=0x55;
;;;686         memo_out0[1]=0x00+2;
;;;687         memo_out0[2]=1;
;;;688         memo_out0[3]=0x0b;
;;;689         memo_out0[4]=0xaa;
;;;690         memo_out0[5]=0xaa; 
;;;691         	
;;;692         memo_out0[6]=crc_87(memo_out0,6);
;;;693    	memo_out0[7]=crc_95(memo_out0,6);
;;;694         usart_out_adr0(memo_out0,8); */
;;;695         snmp_trap_send("Main power is on",2,1,1);	
000934  2301              MOVS     r3,#1
000936  461a              MOV      r2,r3
000938  2102              MOVS     r1,#2
00093a  a01a              ADR      r0,|L1.2468|
00093c  f7fffffe          BL       snmp_trap_send
                  |L1.2368|
;;;696    	}
;;;697    avar_unet_hndl_end:
;;;698    	__nop();		
000940  bf00              NOP      
;;;699    }
000942  e6b1              B        |L1.1704|
                  |L1.2372|
000944  4d61696e          DCB      "Main power alarm, voltage increased",0
000948  20706f77
00094c  65722061
000950  6c61726d
000954  2c20766f
000958  6c746167
00095c  6520696e
000960  63726561
000964  73656400
                  |L1.2408|
                          DCD      ||.data||
                  |L1.2412|
                          DCD      AV_OFF_AVT
                  |L1.2416|
                          DCD      net_Ustore
                  |L1.2420|
000974  4d61696e          DCB      "Main power alarm  clear",0
000978  20706f77
00097c  65722061
000980  6c61726d
000984  2020636c
000988  65617200
                  |L1.2444|
                          DCD      net_Ustore_max
                  |L1.2448|
                          DCD      0x40024000
                  |L1.2452|
                          DCD      uout_av
                  |L1.2456|
                          DCD      load_U
                  |L1.2460|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2464|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2468|
0009a4  4d61696e          DCB      "Main power is on",0
0009a8  20706f77
0009ac  65722069
0009b0  73206f6e
0009b4  00      
0009b5  00                DCB      0
0009b6  00                DCB      0
0009b7  00                DCB      0
                          ENDP

                  avar_bps_hndl PROC
;;;701    //-----------------------------------------------
;;;702    void avar_bps_hndl(char dev, char v, char in)
0009b8  e92d4ff8          PUSH     {r3-r11,lr}
;;;703    {
0009bc  4606              MOV      r6,r0
0009be  460c              MOV      r4,r1
;;;704    char data[4];
;;;705    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;706    char avar_simbol;
;;;707    
;;;708    avar_simbol='T';
0009c0  f04f0754          MOV      r7,#0x54
;;;709    if(v==0)avar_simbol='T';
0009c4  b174              CBZ      r4,|L1.2532|
;;;710    else if(v==1)avar_simbol='U';
0009c6  2c01              CMP      r4,#1
0009c8  d004              BEQ      |L1.2516|
;;;711    else if(v==2)avar_simbol='u';
0009ca  2c02              CMP      r4,#2
0009cc  d005              BEQ      |L1.2522|
;;;712    else if(v==3)avar_simbol='L';
0009ce  2c03              CMP      r4,#3
0009d0  d006              BEQ      |L1.2528|
0009d2  e007              B        |L1.2532|
                  |L1.2516|
0009d4  f04f0755          MOV      r7,#0x55              ;710
0009d8  e004              B        |L1.2532|
                  |L1.2522|
0009da  f04f0775          MOV      r7,#0x75              ;711
0009de  e001              B        |L1.2532|
                  |L1.2528|
0009e0  f04f074c          MOV      r7,#0x4c
                  |L1.2532|
;;;713    
;;;714    if(in==1)
;;;715    	{
;;;716    	//av_src[bps]=1;
;;;717    
;;;718    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;719    //	SET_REG(avar_stat,1,3+dev,1);
;;;720    	
;;;721    	if(v==0)bps[dev]._av|=(1<<0);
;;;722    	else if(v==1) bps[dev]._av|=(1<<1);
;;;723    	else if(v==2) bps[dev]._av|=(1<<2);
;;;724    	else if(v==3) bps[dev]._av|=(1<<3);
;;;725    
;;;726    	bps[dev]._last_avar=v;
;;;727    
;;;728    	//beep_init(0x33333333,'A');
;;;729    
;;;730    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;731    	event_ptr++;	
;;;732    	if(event_ptr>63)event_ptr=0;	
;;;733    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;734    	
;;;735        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;736    	if(event_cnt!=63)event_cnt=event_ptr;
;;;737    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;738    	
;;;739    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;740    	
;;;741    	data[0]='S';
;;;742    	data[1]=dev; 
;;;743    	data[2]=avar_simbol;
;;;744    	data[3]=0;
;;;745    	lc640_write_long_ptr(lc640_adr,data);
;;;746    
;;;747    	data[0]=0;
;;;748    	data[1]=0;
;;;749    	data[2]=0;
;;;750    	data[3]=0;
;;;751    	lc640_write_long_ptr(lc640_adr+4,data);
;;;752    
;;;753    	data[0]=LPC_RTC->YEAR;
0009e4  f8df8400          LDR      r8,|L1.3560|
0009e8  f04f0900          MOV      r9,#0                 ;703
0009ec  48ff              LDR      r0,|L1.3564|
0009ee  eb0601c6          ADD      r1,r6,r6,LSL #3       ;721
0009f2  eb011106          ADD      r1,r1,r6,LSL #4       ;721
0009f6  f44f6a60          MOV      r10,#0xe00            ;730
0009fa  f44f6580          MOV      r5,#0x400             ;739
0009fe  eb000081          ADD      r0,r0,r1,LSL #2       ;721
000a02  2a01              CMP      r2,#1                 ;714
000a04  d002              BEQ      |L1.2572|
;;;754    	data[1]=LPC_RTC->MONTH;
;;;755    	data[2]=LPC_RTC->DOM;
;;;756    	data[3]=0;
;;;757    	lc640_write_long_ptr(lc640_adr+8,data);
;;;758    
;;;759    	data[0]=LPC_RTC->HOUR;
;;;760    	data[1]=LPC_RTC->MIN;
;;;761    	data[2]=LPC_RTC->SEC;
;;;762    	data[3]=0;
;;;763    	lc640_write_long_ptr(lc640_adr+12,data);
;;;764    	
;;;765    	data[0]='A';
;;;766    	data[1]='A';
;;;767    	data[2]='A';
;;;768    	data[3]='A';
;;;769    	lc640_write_long_ptr(lc640_adr+16,data);
;;;770    	
;;;771    	data[0]='A';
;;;772    	data[1]='A';
;;;773    	data[2]='A';
;;;774    	data[3]='A';
;;;775    	lc640_write_long_ptr(lc640_adr+20,data);
;;;776    	
;;;777    	data[0]='A';
;;;778    	data[1]='A';
;;;779    	data[2]='A';
;;;780    	data[3]='A';
;;;781    	lc640_write_long_ptr(lc640_adr+24,data);
;;;782    	
;;;783    	data[0]='A';
;;;784    	data[1]='A';
;;;785    	data[2]='A';
;;;786    	data[3]='A';
;;;787    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;788    
;;;789    
;;;790    	if(dev==0)
;;;791    		{
;;;792    		if(v==0)
;;;793    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;794    		else if(v==1)
;;;795    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;796    		else if(v==2)
;;;797    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;798    		else if(v==3)
;;;799    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;800    		}
;;;801    	else if(dev==1)
;;;802    		{
;;;803    		if(v==0)
;;;804    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;805    		else if(v==1)
;;;806    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;807    		else if(v==2)
;;;808    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;809    		else if(v==3)
;;;810    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;811    		} 
;;;812    	else if(dev==2)
;;;813    		{
;;;814    		if(v==0)
;;;815    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;816    		else if(v==1)
;;;817    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;818    		else if(v==2)
;;;819    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;820    		else if(v==3)
;;;821    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;822    		} 	
;;;823    			
;;;824    	}
;;;825    
;;;826    else if(in==0)
000a06  2a00              CMP      r2,#0
000a08  d07e              BEQ      |L1.2824|
000a0a  e1c4              B        |L1.3478|
                  |L1.2572|
000a0c  b134              CBZ      r4,|L1.2588|
000a0e  2c01              CMP      r4,#1                 ;722
000a10  d009              BEQ      |L1.2598|
000a12  2c02              CMP      r4,#2                 ;723
000a14  d00c              BEQ      |L1.2608|
000a16  2c03              CMP      r4,#3                 ;724
000a18  d00f              BEQ      |L1.2618|
000a1a  e012              B        |L1.2626|
                  |L1.2588|
000a1c  7841              LDRB     r1,[r0,#1]            ;721
000a1e  f0410101          ORR      r1,r1,#1              ;721
000a22  7041              STRB     r1,[r0,#1]            ;721
000a24  e00d              B        |L1.2626|
                  |L1.2598|
000a26  7841              LDRB     r1,[r0,#1]            ;722
000a28  f0410102          ORR      r1,r1,#2              ;722
000a2c  7041              STRB     r1,[r0,#1]            ;722
000a2e  e008              B        |L1.2626|
                  |L1.2608|
000a30  7841              LDRB     r1,[r0,#1]            ;723
000a32  f0410104          ORR      r1,r1,#4              ;723
000a36  7041              STRB     r1,[r0,#1]            ;723
000a38  e003              B        |L1.2626|
                  |L1.2618|
000a3a  7841              LDRB     r1,[r0,#1]            ;724
000a3c  f0410108          ORR      r1,r1,#8              ;724
000a40  7041              STRB     r1,[r0,#1]            ;724
                  |L1.2626|
000a42  f8804057          STRB     r4,[r0,#0x57]         ;726
000a46  4650              MOV      r0,r10                ;730
000a48  f7fffffe          BL       lc640_read_int
000a4c  f1000001          ADD      r0,r0,#1              ;731
000a50  fa1ffb80          UXTH     r11,r0                ;731
000a54  f1bb0f3f          CMP      r11,#0x3f             ;732
000a58  d901              BLS      |L1.2654|
000a5a  f04f0b00          MOV      r11,#0                ;732
                  |L1.2654|
000a5e  fa0ff18b          SXTH     r1,r11                ;733
000a62  4650              MOV      r0,r10                ;733
000a64  f7fffffe          BL       lc640_write_int
000a68  f6406002          MOV      r0,#0xe02             ;735
000a6c  f7fffffe          BL       lc640_read_int
000a70  b280              UXTH     r0,r0                 ;735
000a72  283f              CMP      r0,#0x3f              ;736
000a74  d000              BEQ      |L1.2680|
000a76  4658              MOV      r0,r11                ;736
                  |L1.2680|
000a78  b201              SXTH     r1,r0                 ;737
000a7a  f6406002          MOV      r0,#0xe02             ;737
000a7e  f7fffffe          BL       lc640_write_int
000a82  4650              MOV      r0,r10                ;739
000a84  f7fffffe          BL       lc640_read_int
000a88  eb051040          ADD      r0,r5,r0,LSL #5       ;739
000a8c  b285              UXTH     r5,r0                 ;739
000a8e  f04f0053          MOV      r0,#0x53              ;741
000a92  f88d0000          STRB     r0,[sp,#0]            ;741
000a96  f88d6001          STRB     r6,[sp,#1]            ;742
000a9a  f88d7002          STRB     r7,[sp,#2]            ;743
000a9e  f88d9003          STRB     r9,[sp,#3]            ;744
000aa2  4669              MOV      r1,sp                 ;745
000aa4  4628              MOV      r0,r5                 ;745
000aa6  f7fffffe          BL       lc640_write_long_ptr
000aaa  f8cd9000          STR      r9,[sp,#0]            ;750
000aae  4669              MOV      r1,sp                 ;751
000ab0  1d28              ADDS     r0,r5,#4              ;751
000ab2  f7fffffe          BL       lc640_write_long_ptr
000ab6  f8b8003c          LDRH     r0,[r8,#0x3c]         ;753
000aba  f88d0000          STRB     r0,[sp,#0]            ;753
000abe  f8980038          LDRB     r0,[r8,#0x38]         ;754
000ac2  f88d0001          STRB     r0,[sp,#1]            ;754
000ac6  f898002c          LDRB     r0,[r8,#0x2c]         ;755
000aca  f88d0002          STRB     r0,[sp,#2]            ;755
000ace  f88d9003          STRB     r9,[sp,#3]            ;756
000ad2  4669              MOV      r1,sp                 ;757
000ad4  f1050008          ADD      r0,r5,#8              ;757
000ad8  f7fffffe          BL       lc640_write_long_ptr
000adc  f8980028          LDRB     r0,[r8,#0x28]         ;759
000ae0  f88d0000          STRB     r0,[sp,#0]            ;759
000ae4  f8980024          LDRB     r0,[r8,#0x24]         ;760
000ae8  f88d0001          STRB     r0,[sp,#1]            ;760
000aec  f8980020          LDRB     r0,[r8,#0x20]         ;761
000af0  f88d0002          STRB     r0,[sp,#2]            ;761
000af4  f88d9003          STRB     r9,[sp,#3]            ;762
000af8  4669              MOV      r1,sp                 ;763
000afa  f105000c          ADD      r0,r5,#0xc            ;763
000afe  f7fffffe          BL       lc640_write_long_ptr
000b02  f04f0741          MOV      r7,#0x41              ;765
000b06  e000              B        |L1.2826|
                  |L1.2824|
000b08  e0a5              B        |L1.3158|
                  |L1.2826|
000b0a  f88d7000          STRB     r7,[sp,#0]            ;765
000b0e  f88d7001          STRB     r7,[sp,#1]            ;766
000b12  f88d7002          STRB     r7,[sp,#2]            ;767
000b16  f88d7003          STRB     r7,[sp,#3]            ;768
000b1a  4669              MOV      r1,sp                 ;769
000b1c  f1050010          ADD      r0,r5,#0x10           ;769
000b20  f7fffffe          BL       lc640_write_long_ptr
000b24  f88d7000          STRB     r7,[sp,#0]            ;771
000b28  f88d7001          STRB     r7,[sp,#1]            ;772
000b2c  f88d7002          STRB     r7,[sp,#2]            ;773
000b30  f88d7003          STRB     r7,[sp,#3]            ;774
000b34  4669              MOV      r1,sp                 ;775
000b36  f1050014          ADD      r0,r5,#0x14           ;775
000b3a  f7fffffe          BL       lc640_write_long_ptr
000b3e  f88d7000          STRB     r7,[sp,#0]            ;777
000b42  f88d7001          STRB     r7,[sp,#1]            ;778
000b46  f88d7002          STRB     r7,[sp,#2]            ;779
000b4a  f88d7003          STRB     r7,[sp,#3]            ;780
000b4e  4669              MOV      r1,sp                 ;781
000b50  f1050018          ADD      r0,r5,#0x18           ;781
000b54  f7fffffe          BL       lc640_write_long_ptr
000b58  f88d7000          STRB     r7,[sp,#0]            ;783
000b5c  f88d7001          STRB     r7,[sp,#1]            ;784
000b60  f88d7002          STRB     r7,[sp,#2]            ;785
000b64  f88d7003          STRB     r7,[sp,#3]            ;786
000b68  4669              MOV      r1,sp                 ;787
000b6a  f105001c          ADD      r0,r5,#0x1c           ;787
000b6e  f7fffffe          BL       lc640_write_long_ptr
000b72  b126              CBZ      r6,|L1.2942|
000b74  2e01              CMP      r6,#1                 ;801
000b76  d026              BEQ      |L1.3014|
000b78  2e02              CMP      r6,#2                 ;812
000b7a  d048              BEQ      |L1.3086|
000b7c  e10b              B        |L1.3478|
                  |L1.2942|
000b7e  b134              CBZ      r4,|L1.2958|
000b80  2c01              CMP      r4,#1                 ;794
000b82  d00b              BEQ      |L1.2972|
000b84  2c02              CMP      r4,#2                 ;796
000b86  d010              BEQ      |L1.2986|
000b88  2c03              CMP      r4,#3                 ;798
000b8a  d015              BEQ      |L1.3000|
000b8c  e103              B        |L1.3478|
                  |L1.2958|
000b8e  2300              MOVS     r3,#0                 ;793
000b90  2201              MOVS     r2,#1                 ;793
000b92  2104              MOVS     r1,#4                 ;793
000b94  a096              ADR      r0,|L1.3568|
000b96  f7fffffe          BL       snmp_trap_send
000b9a  e0fc              B        |L1.3478|
                  |L1.2972|
000b9c  2301              MOVS     r3,#1                 ;795
000b9e  461a              MOV      r2,r3                 ;795
000ba0  2104              MOVS     r1,#4                 ;795
000ba2  a099              ADR      r0,|L1.3592|
000ba4  f7fffffe          BL       snmp_trap_send
000ba8  e0f5              B        |L1.3478|
                  |L1.2986|
000baa  2302              MOVS     r3,#2                 ;797
000bac  2201              MOVS     r2,#1                 ;797
000bae  2104              MOVS     r1,#4                 ;797
000bb0  a09c              ADR      r0,|L1.3620|
000bb2  f7fffffe          BL       snmp_trap_send
000bb6  e0ee              B        |L1.3478|
                  |L1.3000|
000bb8  2303              MOVS     r3,#3                 ;799
000bba  2201              MOVS     r2,#1                 ;799
000bbc  2104              MOVS     r1,#4                 ;799
000bbe  a0a1              ADR      r0,|L1.3652|
000bc0  f7fffffe          BL       snmp_trap_send
000bc4  e0e7              B        |L1.3478|
                  |L1.3014|
000bc6  b134              CBZ      r4,|L1.3030|
000bc8  2c01              CMP      r4,#1                 ;805
000bca  d00b              BEQ      |L1.3044|
000bcc  2c02              CMP      r4,#2                 ;807
000bce  d010              BEQ      |L1.3058|
000bd0  2c03              CMP      r4,#3                 ;809
000bd2  d015              BEQ      |L1.3072|
000bd4  e0df              B        |L1.3478|
                  |L1.3030|
000bd6  2300              MOVS     r3,#0                 ;804
000bd8  2202              MOVS     r2,#2                 ;804
000bda  2104              MOVS     r1,#4                 ;804
000bdc  a0a1              ADR      r0,|L1.3684|
000bde  f7fffffe          BL       snmp_trap_send
000be2  e0d8              B        |L1.3478|
                  |L1.3044|
000be4  2301              MOVS     r3,#1                 ;806
000be6  2202              MOVS     r2,#2                 ;806
000be8  2104              MOVS     r1,#4                 ;806
000bea  a0a4              ADR      r0,|L1.3708|
000bec  f7fffffe          BL       snmp_trap_send
000bf0  e0d1              B        |L1.3478|
                  |L1.3058|
000bf2  2302              MOVS     r3,#2                 ;808
000bf4  461a              MOV      r2,r3                 ;808
000bf6  2104              MOVS     r1,#4                 ;808
000bf8  a0a7              ADR      r0,|L1.3736|
000bfa  f7fffffe          BL       snmp_trap_send
000bfe  e0ca              B        |L1.3478|
                  |L1.3072|
000c00  2303              MOVS     r3,#3                 ;810
000c02  2202              MOVS     r2,#2                 ;810
000c04  2104              MOVS     r1,#4                 ;810
000c06  a0ac              ADR      r0,|L1.3768|
000c08  f7fffffe          BL       snmp_trap_send
000c0c  e0c3              B        |L1.3478|
                  |L1.3086|
000c0e  b134              CBZ      r4,|L1.3102|
000c10  2c01              CMP      r4,#1                 ;816
000c12  d00b              BEQ      |L1.3116|
000c14  2c02              CMP      r4,#2                 ;818
000c16  d010              BEQ      |L1.3130|
000c18  2c03              CMP      r4,#3                 ;820
000c1a  d015              BEQ      |L1.3144|
000c1c  e0bb              B        |L1.3478|
                  |L1.3102|
000c1e  2300              MOVS     r3,#0                 ;815
000c20  2203              MOVS     r2,#3                 ;815
000c22  2104              MOVS     r1,#4                 ;815
000c24  a0ac              ADR      r0,|L1.3800|
000c26  f7fffffe          BL       snmp_trap_send
000c2a  e0b4              B        |L1.3478|
                  |L1.3116|
000c2c  2301              MOVS     r3,#1                 ;817
000c2e  2203              MOVS     r2,#3                 ;817
000c30  2104              MOVS     r1,#4                 ;817
000c32  a0af              ADR      r0,|L1.3824|
000c34  f7fffffe          BL       snmp_trap_send
000c38  e0ad              B        |L1.3478|
                  |L1.3130|
000c3a  2302              MOVS     r3,#2                 ;819
000c3c  2203              MOVS     r2,#3                 ;819
000c3e  2104              MOVS     r1,#4                 ;819
000c40  a0b2              ADR      r0,|L1.3852|
000c42  f7fffffe          BL       snmp_trap_send
000c46  e0a6              B        |L1.3478|
                  |L1.3144|
000c48  2303              MOVS     r3,#3                 ;821
000c4a  461a              MOV      r2,r3                 ;821
000c4c  2104              MOVS     r1,#4                 ;821
000c4e  a0b7              ADR      r0,|L1.3884|
000c50  f7fffffe          BL       snmp_trap_send
000c54  e09f              B        |L1.3478|
                  |L1.3158|
;;;827    	{      
;;;828    //	av_bps[bps]=0;
;;;829    
;;;830    	//SET_REG(avar_stat,0,3+bps,1);
;;;831    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;832    
;;;833         if(v==0) bps[dev]._av&=(~(1<<0));
000c56  b134              CBZ      r4,|L1.3174|
;;;834         else if(v==1) bps[dev]._av&=(~(1<<1));
000c58  2c01              CMP      r4,#1
000c5a  d009              BEQ      |L1.3184|
;;;835    	else if(v==2) bps[dev]._av&=(~(1<<2));
000c5c  2c02              CMP      r4,#2
000c5e  d00c              BEQ      |L1.3194|
;;;836    	else if(v==3) bps[dev]._av&=(~(1<<3));
000c60  2c03              CMP      r4,#3
000c62  d00f              BEQ      |L1.3204|
000c64  e012              B        |L1.3212|
                  |L1.3174|
000c66  7841              LDRB     r1,[r0,#1]            ;833
000c68  f0210101          BIC      r1,r1,#1              ;833
000c6c  7041              STRB     r1,[r0,#1]            ;833
000c6e  e00d              B        |L1.3212|
                  |L1.3184|
000c70  7841              LDRB     r1,[r0,#1]            ;834
000c72  f0210102          BIC      r1,r1,#2              ;834
000c76  7041              STRB     r1,[r0,#1]            ;834
000c78  e008              B        |L1.3212|
                  |L1.3194|
000c7a  7841              LDRB     r1,[r0,#1]            ;835
000c7c  f0210104          BIC      r1,r1,#4              ;835
000c80  7041              STRB     r1,[r0,#1]            ;835
000c82  e003              B        |L1.3212|
                  |L1.3204|
000c84  7841              LDRB     r1,[r0,#1]
000c86  f0210108          BIC      r1,r1,#8
000c8a  7041              STRB     r1,[r0,#1]
                  |L1.3212|
;;;837         
;;;838    //	if((bps[dev]._av&0x0f==0))
;;;839    //	     {
;;;840    		//SET_REG(avar_stat,0,3+bps,1);
;;;841    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;842    //	     }
;;;843     
;;;844    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000c8c  4650              MOV      r0,r10
000c8e  f7fffffe          BL       lc640_read_int
000c92  fa1ffb80          UXTH     r11,r0
;;;845    	event_ptr_find=event_ptr;
000c96  465c              MOV      r4,r11
                  |L1.3224|
;;;846    	
;;;847    avar_src_hndl_lbl1: 
;;;848    
;;;849    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000c98  eb051044          ADD      r0,r5,r4,LSL #5
000c9c  fa1ffa80          UXTH     r10,r0
;;;850    
;;;851         lc640_read_long_ptr(lc640_adr,data);
000ca0  4669              MOV      r1,sp
000ca2  4650              MOV      r0,r10
000ca4  f7fffffe          BL       lc640_read_long_ptr
;;;852         
;;;853         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000ca8  f89d0000          LDRB     r0,[sp,#0]
000cac  2853              CMP      r0,#0x53
000cae  d107              BNE      |L1.3264|
000cb0  f89d0001          LDRB     r0,[sp,#1]
000cb4  42b0              CMP      r0,r6
000cb6  d103              BNE      |L1.3264|
000cb8  f89d0002          LDRB     r0,[sp,#2]
000cbc  42b8              CMP      r0,r7
000cbe  d009              BEQ      |L1.3284|
                  |L1.3264|
;;;854         	{        
;;;855         	if(event_ptr_find)event_ptr_find--;
000cc0  b11c              CBZ      r4,|L1.3274|
000cc2  f1a40401          SUB      r4,r4,#1
000cc6  b2a4              UXTH     r4,r4
000cc8  e001              B        |L1.3278|
                  |L1.3274|
;;;856         	else event_ptr_find=63;
000cca  f04f043f          MOV      r4,#0x3f
                  |L1.3278|
;;;857         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000cce  455c              CMP      r4,r11
000cd0  d1e2              BNE      |L1.3224|
000cd2  e060              B        |L1.3478|
                  |L1.3284|
;;;858         	else goto avar_src_hndl_lbl1;
;;;859         	}
;;;860         else 
;;;861         	{
;;;862         	lc640_read_long_ptr(lc640_adr+16,data);
000cd4  4669              MOV      r1,sp
000cd6  f10a0010          ADD      r0,r10,#0x10
000cda  f7fffffe          BL       lc640_read_long_ptr
;;;863         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000cde  f89d0000          LDRB     r0,[sp,#0]
000ce2  2841              CMP      r0,#0x41
000ce4  d10b              BNE      |L1.3326|
000ce6  f89d0001          LDRB     r0,[sp,#1]
000cea  2841              CMP      r0,#0x41
000cec  d107              BNE      |L1.3326|
000cee  f89d0002          LDRB     r0,[sp,#2]
000cf2  2841              CMP      r0,#0x41
000cf4  d103              BNE      |L1.3326|
000cf6  f89d0003          LDRB     r0,[sp,#3]
000cfa  2841              CMP      r0,#0x41
000cfc  d009              BEQ      |L1.3346|
                  |L1.3326|
;;;864         		{        
;;;865         		if(event_ptr_find)event_ptr_find--;
000cfe  b11c              CBZ      r4,|L1.3336|
000d00  f1a40401          SUB      r4,r4,#1
000d04  b2a4              UXTH     r4,r4
000d06  e001              B        |L1.3340|
                  |L1.3336|
;;;866             		else event_ptr_find=63;
000d08  f04f043f          MOV      r4,#0x3f
                  |L1.3340|
;;;867             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000d0c  455c              CMP      r4,r11
000d0e  d1c3              BNE      |L1.3224|
000d10  e041              B        |L1.3478|
                  |L1.3346|
;;;868         		else goto avar_src_hndl_lbl1;
;;;869         		}
;;;870    
;;;871         	}	
;;;872    
;;;873    
;;;874    	
;;;875    	data[0]=LPC_RTC->YEAR;
000d12  f8b8003c          LDRH     r0,[r8,#0x3c]
000d16  f88d0000          STRB     r0,[sp,#0]
;;;876    	data[1]=LPC_RTC->MONTH;
000d1a  f8980038          LDRB     r0,[r8,#0x38]
000d1e  f88d0001          STRB     r0,[sp,#1]
;;;877    	data[2]=LPC_RTC->DOM;
000d22  f898002c          LDRB     r0,[r8,#0x2c]
000d26  f88d0002          STRB     r0,[sp,#2]
;;;878    	data[3]=0;
000d2a  f88d9003          STRB     r9,[sp,#3]
;;;879    	lc640_write_long_ptr(lc640_adr+16,data);
000d2e  4669              MOV      r1,sp
000d30  f10a0010          ADD      r0,r10,#0x10
000d34  f7fffffe          BL       lc640_write_long_ptr
;;;880    
;;;881    	data[0]=LPC_RTC->HOUR;
000d38  f8980028          LDRB     r0,[r8,#0x28]
000d3c  f88d0000          STRB     r0,[sp,#0]
;;;882    	data[1]=LPC_RTC->MIN;
000d40  f8980024          LDRB     r0,[r8,#0x24]
000d44  f88d0001          STRB     r0,[sp,#1]
;;;883    	data[2]=LPC_RTC->SEC;
000d48  f8980020          LDRB     r0,[r8,#0x20]
000d4c  f88d0002          STRB     r0,[sp,#2]
;;;884    	data[3]=0;
000d50  f88d9003          STRB     r9,[sp,#3]
;;;885    	lc640_write_long_ptr(lc640_adr+20,data);
000d54  4669              MOV      r1,sp
000d56  f10a0014          ADD      r0,r10,#0x14
000d5a  f7fffffe          BL       lc640_write_long_ptr
;;;886    	
;;;887    	data[0]='B';
000d5e  f04f0442          MOV      r4,#0x42
000d62  f88d4000          STRB     r4,[sp,#0]
;;;888    	data[1]='B';
000d66  f88d4001          STRB     r4,[sp,#1]
;;;889    	data[2]='B';
000d6a  f88d4002          STRB     r4,[sp,#2]
;;;890    	data[3]='B';
000d6e  f88d4003          STRB     r4,[sp,#3]
;;;891    	lc640_write_long_ptr(lc640_adr+24,data);
000d72  4669              MOV      r1,sp
000d74  f10a0018          ADD      r0,r10,#0x18
000d78  f7fffffe          BL       lc640_write_long_ptr
;;;892    	
;;;893    	data[0]='B';
000d7c  f88d4000          STRB     r4,[sp,#0]
;;;894    	data[1]='B';
000d80  f88d4001          STRB     r4,[sp,#1]
;;;895    	data[2]='B';
000d84  f88d4002          STRB     r4,[sp,#2]
;;;896    	data[3]='B';
000d88  f88d4003          STRB     r4,[sp,#3]
;;;897    	lc640_write_long_ptr(lc640_adr+28,data);
000d8c  4669              MOV      r1,sp
000d8e  f10a001c          ADD      r0,r10,#0x1c
000d92  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3478|
;;;898    	
;;;899    	}
;;;900    	
;;;901    avar_src_hndl_end:
;;;902    __nop();		
000d96  bf00              NOP      
                  |L1.3480|
;;;903    }
000d98  e486              B        |L1.1704|
;;;904    
                          ENDP

                  wrk_mem_hndl PROC
;;;905    //-----------------------------------------------
;;;906    void wrk_mem_hndl(char b)
000d9a  e92d41fc          PUSH     {r2-r8,lr}
;;;907    {
000d9e  4606              MOV      r6,r0
;;;908    char data[4];
;;;909    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;910    
;;;911    signed short temp_temp;
;;;912    
;;;913    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000da0  486a              LDR      r0,|L1.3916|
000da2  eb060186          ADD      r1,r6,r6,LSL #2
000da6  eb001401          ADD      r4,r0,r1,LSL #4
000daa  8c60              LDRH     r0,[r4,#0x22]
000dac  2805              CMP      r0,#5
000dae  d31a              BCC      |L1.3558|
;;;914    
;;;915    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000db0  4867              LDR      r0,|L1.3920|
000db2  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000db4  f1000006          ADD      r0,r0,#6
000db8  f0000007          AND      r0,r0,#7
000dbc  eb040040          ADD      r0,r4,r0,LSL #1
000dc0  8c80              LDRH     r0,[r0,#0x24]
000dc2  9000              STR      r0,[sp,#0]
;;;916    
;;;917    
;;;918    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000dc4  f44f6760          MOV      r7,#0xe00
000dc8  4638              MOV      r0,r7
000dca  f7fffffe          BL       lc640_read_int
;;;919    event_ptr++;	
000dce  f1000001          ADD      r0,r0,#1
000dd2  b285              UXTH     r5,r0
;;;920    if(event_ptr>63)event_ptr=0;	
000dd4  2d3f              CMP      r5,#0x3f
000dd6  d901              BLS      |L1.3548|
000dd8  f04f0500          MOV      r5,#0
                  |L1.3548|
;;;921    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000ddc  b229              SXTH     r1,r5
000dde  4638              MOV      r0,r7
000de0  f7fffffe          BL       lc640_write_int
;;;922    	
;;;923    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000de4  e0b6              B        |L1.3924|
                  |L1.3558|
000de6  e11d              B        |L1.4132|
                  |L1.3560|
                          DCD      0x40024000
                  |L1.3564|
                          DCD      bps
                  |L1.3568|
000df0  42505320          DCB      "BPS #1 Alarm, overheat",0
000df4  23312041
000df8  6c61726d
000dfc  2c206f76
000e00  65726865
000e04  617400  
000e07  00                DCB      0
                  |L1.3592|
000e08  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000e0c  23312041
000e10  6c61726d
000e14  2c20766f
000e18  6c746167
000e1c  65206973
000e20  20757000
                  |L1.3620|
000e24  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000e28  23312041
000e2c  6c61726d
000e30  2c20766f
000e34  6c746167
000e38  65206973
000e3c  20646f77
000e40  6e00    
000e42  00                DCB      0
000e43  00                DCB      0
                  |L1.3652|
000e44  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000e48  23312041
000e4c  6c61726d
000e50  2c20636f
000e54  6e6e6563
000e58  74206973
000e5c  206c6f73
000e60  7400    
000e62  00                DCB      0
000e63  00                DCB      0
                  |L1.3684|
000e64  42505320          DCB      "BPS #2 Alarm, overheat",0
000e68  23322041
000e6c  6c61726d
000e70  2c206f76
000e74  65726865
000e78  617400  
000e7b  00                DCB      0
                  |L1.3708|
000e7c  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000e80  23322041
000e84  6c61726d
000e88  2c20766f
000e8c  6c746167
000e90  65206973
000e94  20757000
                  |L1.3736|
000e98  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000e9c  23322041
000ea0  6c61726d
000ea4  2c20766f
000ea8  6c746167
000eac  65206973
000eb0  20646f77
000eb4  6e00    
000eb6  00                DCB      0
000eb7  00                DCB      0
                  |L1.3768|
000eb8  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000ebc  23322041
000ec0  6c61726d
000ec4  2c20636f
000ec8  6e6e6563
000ecc  74206973
000ed0  206c6f73
000ed4  7400    
000ed6  00                DCB      0
000ed7  00                DCB      0
                  |L1.3800|
000ed8  42505320          DCB      "BPS #3 Alarm, overheat",0
000edc  23332041
000ee0  6c61726d
000ee4  2c206f76
000ee8  65726865
000eec  617400  
000eef  00                DCB      0
                  |L1.3824|
000ef0  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000ef4  23332041
000ef8  6c61726d
000efc  2c20766f
000f00  6c746167
000f04  65206973
000f08  20757000
                  |L1.3852|
000f0c  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000f10  23332041
000f14  6c61726d
000f18  2c20766f
000f1c  6c746167
000f20  65206973
000f24  20646f77
000f28  6e00    
000f2a  00                DCB      0
000f2b  00                DCB      0
                  |L1.3884|
000f2c  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000f30  23332041
000f34  6c61726d
000f38  2c20636f
000f3c  6e6e6563
000f40  74206973
000f44  206c6f73
000f48  7400    
000f4a  00                DCB      0
000f4b  00                DCB      0
                  |L1.3916|
                          DCD      bat
                  |L1.3920|
                          DCD      bat_u_old_cnt
                  |L1.3924|
000f54  f6406802          MOV      r8,#0xe02
000f58  4640              MOV      r0,r8
000f5a  f7fffffe          BL       lc640_read_int
000f5e  b280              UXTH     r0,r0
;;;924    if(event_cnt!=63)event_cnt=event_ptr;
000f60  283f              CMP      r0,#0x3f
000f62  d000              BEQ      |L1.3942|
000f64  4628              MOV      r0,r5
                  |L1.3942|
;;;925    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000f66  b201              SXTH     r1,r0
000f68  4640              MOV      r0,r8
000f6a  f7fffffe          BL       lc640_write_int
;;;926    	
;;;927    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000f6e  4638              MOV      r0,r7
000f70  f7fffffe          BL       lc640_read_int
000f74  f44f6180          MOV      r1,#0x400
000f78  eb011040          ADD      r0,r1,r0,LSL #5
000f7c  b285              UXTH     r5,r0
;;;928    	
;;;929    data[0]='B';
000f7e  f04f0042          MOV      r0,#0x42
000f82  f88d0004          STRB     r0,[sp,#4]
;;;930    data[1]=b; 
000f86  f88d6005          STRB     r6,[sp,#5]
;;;931    data[2]='W';
000f8a  f04f0057          MOV      r0,#0x57
000f8e  f88d0006          STRB     r0,[sp,#6]
;;;932    data[3]=0;
000f92  f04f0600          MOV      r6,#0
000f96  f88d6007          STRB     r6,[sp,#7]
;;;933    
;;;934    lc640_write_long_ptr(lc640_adr,data);
000f9a  a901              ADD      r1,sp,#4
000f9c  4628              MOV      r0,r5
000f9e  f7fffffe          BL       lc640_write_long_ptr
;;;935    
;;;936    data[0]=*((char*)&bat[b]._Iintegr_);
000fa2  f8940022          LDRB     r0,[r4,#0x22]
000fa6  f88d0004          STRB     r0,[sp,#4]
;;;937    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000faa  f8940023          LDRB     r0,[r4,#0x23]
000fae  f88d0005          STRB     r0,[sp,#5]
;;;938    data[2]=*((char*)&temp_temp);
000fb2  f89d0000          LDRB     r0,[sp,#0]
000fb6  f88d0006          STRB     r0,[sp,#6]
;;;939    data[3]=*(((char*)(&temp_temp))+1);
000fba  f89d0001          LDRB     r0,[sp,#1]
000fbe  f88d0007          STRB     r0,[sp,#7]
;;;940    lc640_write_long_ptr(lc640_adr+4,data);
000fc2  a901              ADD      r1,sp,#4
000fc4  1d28              ADDS     r0,r5,#4
000fc6  f7fffffe          BL       lc640_write_long_ptr
;;;941    
;;;942    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000fca  f1040138          ADD      r1,r4,#0x38
000fce  f1050008          ADD      r0,r5,#8
000fd2  f7fffffe          BL       lc640_write_long_ptr
;;;943    	
;;;944    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000fd6  f104013c          ADD      r1,r4,#0x3c
000fda  f105000c          ADD      r0,r5,#0xc
000fde  f7fffffe          BL       lc640_write_long_ptr
;;;945    
;;;946    data[0]=LPC_RTC->YEAR;
000fe2  4cff              LDR      r4,|L1.5088|
000fe4  8ba0              LDRH     r0,[r4,#0x1c]
000fe6  f88d0004          STRB     r0,[sp,#4]
;;;947    data[1]=LPC_RTC->MONTH;
000fea  7e20              LDRB     r0,[r4,#0x18]
000fec  f88d0005          STRB     r0,[sp,#5]
;;;948    data[2]=LPC_RTC->DOM;
000ff0  7b20              LDRB     r0,[r4,#0xc]
000ff2  f88d0006          STRB     r0,[sp,#6]
;;;949    data[3]=0;
000ff6  f88d6007          STRB     r6,[sp,#7]
;;;950    lc640_write_long_ptr(lc640_adr+16,data);
000ffa  a901              ADD      r1,sp,#4
000ffc  f1050010          ADD      r0,r5,#0x10
001000  f7fffffe          BL       lc640_write_long_ptr
;;;951    
;;;952    data[0]=LPC_RTC->HOUR;
001004  7a20              LDRB     r0,[r4,#8]
001006  f88d0004          STRB     r0,[sp,#4]
;;;953    data[1]=LPC_RTC->MIN;
00100a  7920              LDRB     r0,[r4,#4]
00100c  f88d0005          STRB     r0,[sp,#5]
;;;954    data[2]=LPC_RTC->SEC;
001010  7820              LDRB     r0,[r4,#0]
001012  f88d0006          STRB     r0,[sp,#6]
;;;955    data[3]=0;
001016  f88d6007          STRB     r6,[sp,#7]
;;;956    lc640_write_long_ptr(lc640_adr+20,data);
00101a  a901              ADD      r1,sp,#4
00101c  f1050014          ADD      r0,r5,#0x14
001020  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4132|
;;;957    	
;;;958    
;;;959    
;;;960    	
;;;961    wrk_mem_hndl_end:	
;;;962    __nop();
001024  bf00              NOP      
;;;963    }  
001026  e8bd81fc          POP      {r2-r8,pc}
;;;964    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;966    //-----------------------------------------------
;;;967    void avar_bat_ips_hndl(char in)
00102a  e92d4ff8          PUSH     {r3-r11,lr}
;;;968    {
00102e  4602              MOV      r2,r0
;;;969    char data[4];
;;;970    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;971    
;;;972    if(in==1)
;;;973    	{
;;;974    	bat_ips._av|=1;
001030  48ec              LDR      r0,|L1.5092|
;;;975        ips_bat_av_stat=1;
001032  4ced              LDR      r4,|L1.5096|
;;;976    	ips_bat_av_vzvod=1;
001034  4bed              LDR      r3,|L1.5100|
;;;977    
;;;978    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;979    	event_ptr++;	
;;;980    	if(event_ptr>63)event_ptr=0;	
;;;981    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;982    	
;;;983    	event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;984    	if(event_cnt!=63)event_cnt=event_ptr;
;;;985    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;986    	
;;;987    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;988    	
;;;989    	data[0]='B';
;;;990    	data[1]=0;
;;;991    	data[2]='C';
;;;992    	data[3]=0;
;;;993    	lc640_write_long_ptr(lc640_adr,data);
;;;994    
;;;995    	data[0]=0;
;;;996    	data[1]=0;
;;;997    	data[2]=0;
;;;998    	data[3]=0;
;;;999    	lc640_write_long_ptr(lc640_adr+4,data);
;;;1000   
;;;1001   	data[0]=LPC_RTC->YEAR;
001036  f8df83b8          LDR      r8,|L1.5104|
00103a  f8901041          LDRB     r1,[r0,#0x41]         ;974
00103e  f04f0742          MOV      r7,#0x42              ;989
001042  f44f6560          MOV      r5,#0xe00             ;978
001046  f04f0900          MOV      r9,#0                 ;980
00104a  f44f6a80          MOV      r10,#0x400            ;987
00104e  2a01              CMP      r2,#1                 ;972
001050  d002              BEQ      |L1.4184|
;;;1002   	data[1]=LPC_RTC->MONTH;
;;;1003   	data[2]=LPC_RTC->DOM;
;;;1004   	data[3]=0;
;;;1005   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1006   
;;;1007   	data[0]=LPC_RTC->HOUR;
;;;1008   	data[1]=LPC_RTC->MIN;
;;;1009   	data[2]=LPC_RTC->SEC;
;;;1010   	data[3]=0;
;;;1011   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1012   	
;;;1013   	data[0]='A';
;;;1014   	data[1]='A';
;;;1015   	data[2]='A';
;;;1016   	data[3]='A';
;;;1017   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1018   	
;;;1019   	data[0]='A';
;;;1020   	data[1]='A';
;;;1021   	data[2]='A';
;;;1022   	data[3]='A';
;;;1023   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1024   	
;;;1025   	data[0]='A';
;;;1026   	data[1]='A';
;;;1027   	data[2]='A';
;;;1028   	data[3]='A';
;;;1029   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1030   	
;;;1031   	data[0]='A';
;;;1032   	data[1]='A';
;;;1033   	data[2]='A';
;;;1034   	data[3]='A';
;;;1035   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1036   					
;;;1037   	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;1038   		
;;;1039   	}
;;;1040   
;;;1041   else if(in==0)
001052  2a00              CMP      r2,#0
001054  d07e              BEQ      |L1.4436|
001056  e12f              B        |L1.4792|
                  |L1.4184|
001058  f0410101          ORR      r1,r1,#1              ;974
00105c  f8801041          STRB     r1,[r0,#0x41]         ;974
001060  f04f0001          MOV      r0,#1                 ;975
001064  7020              STRB     r0,[r4,#0]            ;975
001066  7018              STRB     r0,[r3,#0]            ;976
001068  4628              MOV      r0,r5                 ;978
00106a  f7fffffe          BL       lc640_read_int
00106e  f1000001          ADD      r0,r0,#1              ;979
001072  b284              UXTH     r4,r0                 ;979
001074  2c3f              CMP      r4,#0x3f              ;980
001076  d901              BLS      |L1.4220|
001078  f04f0400          MOV      r4,#0                 ;980
                  |L1.4220|
00107c  b221              SXTH     r1,r4                 ;981
00107e  4628              MOV      r0,r5                 ;981
001080  f7fffffe          BL       lc640_write_int
001084  f6406602          MOV      r6,#0xe02             ;983
001088  4630              MOV      r0,r6                 ;983
00108a  f7fffffe          BL       lc640_read_int
00108e  b281              UXTH     r1,r0                 ;983
001090  293f              CMP      r1,#0x3f              ;984
001092  d000              BEQ      |L1.4246|
001094  4621              MOV      r1,r4                 ;984
                  |L1.4246|
001096  b209              SXTH     r1,r1                 ;985
001098  4630              MOV      r0,r6                 ;985
00109a  f7fffffe          BL       lc640_write_int
00109e  4628              MOV      r0,r5                 ;987
0010a0  f7fffffe          BL       lc640_read_int
0010a4  eb0a1040          ADD      r0,r10,r0,LSL #5      ;987
0010a8  b284              UXTH     r4,r0                 ;987
0010aa  f88d7000          STRB     r7,[sp,#0]            ;989
0010ae  f88d9001          STRB     r9,[sp,#1]            ;990
0010b2  f04f0043          MOV      r0,#0x43              ;991
0010b6  f88d0002          STRB     r0,[sp,#2]            ;991
0010ba  f88d9003          STRB     r9,[sp,#3]            ;992
0010be  4669              MOV      r1,sp                 ;993
0010c0  4620              MOV      r0,r4                 ;993
0010c2  f7fffffe          BL       lc640_write_long_ptr
0010c6  f8cd9000          STR      r9,[sp,#0]            ;998
0010ca  4669              MOV      r1,sp                 ;999
0010cc  1d20              ADDS     r0,r4,#4              ;999
0010ce  f7fffffe          BL       lc640_write_long_ptr
0010d2  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1001
0010d6  f88d0000          STRB     r0,[sp,#0]            ;1001
0010da  f8980038          LDRB     r0,[r8,#0x38]         ;1002
0010de  f88d0001          STRB     r0,[sp,#1]            ;1002
0010e2  f898002c          LDRB     r0,[r8,#0x2c]         ;1003
0010e6  f88d0002          STRB     r0,[sp,#2]            ;1003
0010ea  f88d9003          STRB     r9,[sp,#3]            ;1004
0010ee  4669              MOV      r1,sp                 ;1005
0010f0  f1040008          ADD      r0,r4,#8              ;1005
0010f4  f7fffffe          BL       lc640_write_long_ptr
0010f8  f8980028          LDRB     r0,[r8,#0x28]         ;1007
0010fc  f88d0000          STRB     r0,[sp,#0]            ;1007
001100  f8980024          LDRB     r0,[r8,#0x24]         ;1008
001104  f88d0001          STRB     r0,[sp,#1]            ;1008
001108  f8980020          LDRB     r0,[r8,#0x20]         ;1009
00110c  f88d0002          STRB     r0,[sp,#2]            ;1009
001110  f88d9003          STRB     r9,[sp,#3]            ;1010
001114  4669              MOV      r1,sp                 ;1011
001116  f104000c          ADD      r0,r4,#0xc            ;1011
00111a  f7fffffe          BL       lc640_write_long_ptr
00111e  f04f0541          MOV      r5,#0x41              ;1013
001122  f88d5000          STRB     r5,[sp,#0]            ;1013
001126  f88d5001          STRB     r5,[sp,#1]            ;1014
00112a  f88d5002          STRB     r5,[sp,#2]            ;1015
00112e  f88d5003          STRB     r5,[sp,#3]            ;1016
001132  4669              MOV      r1,sp                 ;1017
001134  f1040010          ADD      r0,r4,#0x10           ;1017
001138  f7fffffe          BL       lc640_write_long_ptr
00113c  f88d5000          STRB     r5,[sp,#0]            ;1019
001140  f88d5001          STRB     r5,[sp,#1]            ;1020
001144  f88d5002          STRB     r5,[sp,#2]            ;1021
001148  f88d5003          STRB     r5,[sp,#3]            ;1022
00114c  4669              MOV      r1,sp                 ;1023
00114e  f1040014          ADD      r0,r4,#0x14           ;1023
001152  e000              B        |L1.4438|
                  |L1.4436|
001154  e022              B        |L1.4508|
                  |L1.4438|
001156  f7fffffe          BL       lc640_write_long_ptr
00115a  f88d5000          STRB     r5,[sp,#0]            ;1025
00115e  f88d5001          STRB     r5,[sp,#1]            ;1026
001162  f88d5002          STRB     r5,[sp,#2]            ;1027
001166  f88d5003          STRB     r5,[sp,#3]            ;1028
00116a  4669              MOV      r1,sp                 ;1029
00116c  f1040018          ADD      r0,r4,#0x18           ;1029
001170  f7fffffe          BL       lc640_write_long_ptr
001174  f88d5000          STRB     r5,[sp,#0]            ;1031
001178  f88d5001          STRB     r5,[sp,#1]            ;1032
00117c  f88d5002          STRB     r5,[sp,#2]            ;1033
001180  f88d5003          STRB     r5,[sp,#3]            ;1034
001184  4669              MOV      r1,sp                 ;1035
001186  f104001c          ADD      r0,r4,#0x1c           ;1035
00118a  f7fffffe          BL       lc640_write_long_ptr
00118e  2301              MOVS     r3,#1                 ;1037
001190  461a              MOV      r2,r3                 ;1037
001192  2105              MOVS     r1,#5                 ;1037
001194  a097              ADR      r0,|L1.5108|
001196  f7fffffe          BL       snmp_trap_send
00119a  e08d              B        |L1.4792|
                  |L1.4508|
;;;1042   	{
;;;1043   	bat_ips._av&=~1;
00119c  f0210101          BIC      r1,r1,#1
0011a0  f8801041          STRB     r1,[r0,#0x41]
;;;1044   	ips_bat_av_stat=0;
0011a4  f8849000          STRB     r9,[r4,#0]
;;;1045   	ips_bat_av_vzvod=0;
0011a8  f8839000          STRB     r9,[r3,#0]
;;;1046        
;;;1047   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0011ac  4628              MOV      r0,r5
0011ae  f7fffffe          BL       lc640_read_int
0011b2  b286              UXTH     r6,r0
;;;1048   	event_ptr_find=event_ptr;
0011b4  4634              MOV      r4,r6
                  |L1.4534|
;;;1049   	
;;;1050   avar_bat_ips_hndl_lbl1: 
;;;1051   
;;;1052   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0011b6  eb0a1044          ADD      r0,r10,r4,LSL #5
0011ba  b285              UXTH     r5,r0
;;;1053   
;;;1054        lc640_read_long_ptr(lc640_adr,data);
0011bc  4669              MOV      r1,sp
0011be  4628              MOV      r0,r5
0011c0  f7fffffe          BL       lc640_read_long_ptr
;;;1055        
;;;1056        if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
0011c4  f89d0000          LDRB     r0,[sp,#0]
0011c8  2842              CMP      r0,#0x42
0011ca  d106              BNE      |L1.4570|
0011cc  f89d0001          LDRB     r0,[sp,#1]
0011d0  b918              CBNZ     r0,|L1.4570|
0011d2  f89d0002          LDRB     r0,[sp,#2]
0011d6  2843              CMP      r0,#0x43
0011d8  d009              BEQ      |L1.4590|
                  |L1.4570|
;;;1057        	{        
;;;1058        	if(event_ptr_find)event_ptr_find--;
0011da  b11c              CBZ      r4,|L1.4580|
0011dc  f1a40401          SUB      r4,r4,#1
0011e0  b2a4              UXTH     r4,r4
0011e2  e001              B        |L1.4584|
                  |L1.4580|
;;;1059        	else event_ptr_find=63;
0011e4  f04f043f          MOV      r4,#0x3f
                  |L1.4584|
;;;1060        	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
0011e8  42b4              CMP      r4,r6
0011ea  d1e4              BNE      |L1.4534|
0011ec  e064              B        |L1.4792|
                  |L1.4590|
;;;1061        	else goto avar_bat_ips_hndl_lbl1;
;;;1062        	}
;;;1063        else 
;;;1064        	{
;;;1065        	lc640_read_long_ptr(lc640_adr+16,data);
0011ee  4669              MOV      r1,sp
0011f0  f1050010          ADD      r0,r5,#0x10
0011f4  f7fffffe          BL       lc640_read_long_ptr
;;;1066        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0011f8  f89d0000          LDRB     r0,[sp,#0]
0011fc  2841              CMP      r0,#0x41
0011fe  d10b              BNE      |L1.4632|
001200  f89d0001          LDRB     r0,[sp,#1]
001204  2841              CMP      r0,#0x41
001206  d107              BNE      |L1.4632|
001208  f89d0002          LDRB     r0,[sp,#2]
00120c  2841              CMP      r0,#0x41
00120e  d103              BNE      |L1.4632|
001210  f89d0003          LDRB     r0,[sp,#3]
001214  2841              CMP      r0,#0x41
001216  d009              BEQ      |L1.4652|
                  |L1.4632|
;;;1067        		{        
;;;1068        		if(event_ptr_find)event_ptr_find--;
001218  b11c              CBZ      r4,|L1.4642|
00121a  f1a40401          SUB      r4,r4,#1
00121e  b2a4              UXTH     r4,r4
001220  e001              B        |L1.4646|
                  |L1.4642|
;;;1069            		else event_ptr_find=63;
001222  f04f043f          MOV      r4,#0x3f
                  |L1.4646|
;;;1070            	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001226  42b4              CMP      r4,r6
001228  d1c5              BNE      |L1.4534|
00122a  e045              B        |L1.4792|
                  |L1.4652|
;;;1071        		else goto avar_bat_ips_hndl_lbl1;
;;;1072        		}
;;;1073   
;;;1074        	}
;;;1075        		
;;;1076   	data[0]=LPC_RTC->YEAR;
00122c  f8b8003c          LDRH     r0,[r8,#0x3c]
001230  f88d0000          STRB     r0,[sp,#0]
;;;1077   	data[1]=LPC_RTC->MONTH;
001234  f8980038          LDRB     r0,[r8,#0x38]
001238  f88d0001          STRB     r0,[sp,#1]
;;;1078   	data[2]=LPC_RTC->DOM;
00123c  f898002c          LDRB     r0,[r8,#0x2c]
001240  f88d0002          STRB     r0,[sp,#2]
;;;1079   	data[3]=0;
001244  f88d9003          STRB     r9,[sp,#3]
;;;1080   	lc640_write_long_ptr(lc640_adr+16,data);
001248  4669              MOV      r1,sp
00124a  f1050010          ADD      r0,r5,#0x10
00124e  f7fffffe          BL       lc640_write_long_ptr
;;;1081   
;;;1082   	data[0]=LPC_RTC->HOUR;
001252  f8980028          LDRB     r0,[r8,#0x28]
001256  f88d0000          STRB     r0,[sp,#0]
;;;1083   	data[1]=LPC_RTC->MIN;
00125a  f8980024          LDRB     r0,[r8,#0x24]
00125e  f88d0001          STRB     r0,[sp,#1]
;;;1084   	data[2]=LPC_RTC->SEC;
001262  f8980020          LDRB     r0,[r8,#0x20]
001266  f88d0002          STRB     r0,[sp,#2]
;;;1085   	data[3]=0;
00126a  f88d9003          STRB     r9,[sp,#3]
;;;1086   	lc640_write_long_ptr(lc640_adr+20,data);
00126e  4669              MOV      r1,sp
001270  f1050014          ADD      r0,r5,#0x14
001274  f7fffffe          BL       lc640_write_long_ptr
;;;1087   	
;;;1088   	data[0]='B';
001278  f88d7000          STRB     r7,[sp,#0]
;;;1089   	data[1]='B';
00127c  f88d7001          STRB     r7,[sp,#1]
;;;1090   	data[2]='B';
001280  f88d7002          STRB     r7,[sp,#2]
;;;1091   	data[3]='B';
001284  f88d7003          STRB     r7,[sp,#3]
;;;1092   	lc640_write_long_ptr(lc640_adr+24,data);
001288  4669              MOV      r1,sp
00128a  f1050018          ADD      r0,r5,#0x18
00128e  f7fffffe          BL       lc640_write_long_ptr
;;;1093   	
;;;1094   	data[0]='B';
001292  f88d7000          STRB     r7,[sp,#0]
;;;1095   	data[1]='B';
001296  f88d7001          STRB     r7,[sp,#1]
;;;1096   	data[2]='B';
00129a  f88d7002          STRB     r7,[sp,#2]
;;;1097   	data[3]='B';
00129e  f88d7003          STRB     r7,[sp,#3]
;;;1098   	lc640_write_long_ptr(lc640_adr+28,data);
0012a2  4669              MOV      r1,sp
0012a4  f105001c          ADD      r0,r5,#0x1c
0012a8  f7fffffe          BL       lc640_write_long_ptr
;;;1099   	
;;;1100   	snmp_trap_send("BAT #1 detected",5,1,0);
0012ac  2300              MOVS     r3,#0
0012ae  2201              MOVS     r2,#1
0012b0  2105              MOVS     r1,#5
0012b2  a055              ADR      r0,|L1.5128|
0012b4  f7fffffe          BL       snmp_trap_send
                  |L1.4792|
;;;1101   	
;;;1102   	}
;;;1103   	
;;;1104   avar_bat_ips_hndl_end:
;;;1105   __nop();		
0012b8  bf00              NOP      
                  |L1.4794|
;;;1106   }
0012ba  e56d              B        |L1.3480|
;;;1107   
                          ENDP

                  avar_bat_hndl PROC
;;;1110   //-----------------------------------------------
;;;1111   void avar_bat_hndl(char b, char in)
0012bc  4770              BX       lr
;;;1112   {
;;;1113   char data[4];
;;;1114   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1115   #ifndef UKU_220_IPS_TERMOKOMPENSAT	 //o_10
;;;1116   if(in==1)
;;;1117   	{
;;;1118   	bat[b]._av|=1;
;;;1119       
;;;1120   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1121   	event_ptr++;	
;;;1122   	if(event_ptr>63)event_ptr=0;	
;;;1123   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1124   	
;;;1125        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1126   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1127   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1128   	
;;;1129   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1130   	
;;;1131   	data[0]='B';
;;;1132   	data[1]=b;
;;;1133   	data[2]='C';
;;;1134   	data[3]=0;
;;;1135   	lc640_write_long_ptr(lc640_adr,data);
;;;1136   
;;;1137   	data[0]=0;
;;;1138   	data[1]=0;
;;;1139   	data[2]=0;
;;;1140   	data[3]=0;
;;;1141   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1142   
;;;1143   	data[0]=LPC_RTC->YEAR;
;;;1144   	data[1]=LPC_RTC->MONTH;
;;;1145   	data[2]=LPC_RTC->DOM;
;;;1146   	data[3]=0;
;;;1147   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1148   
;;;1149   	data[0]=LPC_RTC->HOUR;
;;;1150   	data[1]=LPC_RTC->MIN;
;;;1151   	data[2]=LPC_RTC->SEC;
;;;1152   	data[3]=0;
;;;1153   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1154   	
;;;1155   	data[0]='A';
;;;1156   	data[1]='A';
;;;1157   	data[2]='A';
;;;1158   	data[3]='A';
;;;1159   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1160   	
;;;1161   	data[0]='A';
;;;1162   	data[1]='A';
;;;1163   	data[2]='A';
;;;1164   	data[3]='A';
;;;1165   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1166   	
;;;1167   	data[0]='A';
;;;1168   	data[1]='A';
;;;1169   	data[2]='A';
;;;1170   	data[3]='A';
;;;1171   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1172   	
;;;1173   	data[0]='A';
;;;1174   	data[1]='A';
;;;1175   	data[2]='A';
;;;1176   	data[3]='A';
;;;1177   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1178   					
;;;1179   	if(b==0)
;;;1180   		{
;;;1181   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1182   		}
;;;1183   	else if(b==1)
;;;1184   		{
;;;1185   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1186   		} 
;;;1187   			
;;;1188   	}
;;;1189   
;;;1190   else if(in==0)
;;;1191   	{
;;;1192   	bat[b]._av&=~1;
;;;1193   
;;;1194        event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1195   	event_ptr_find=event_ptr;
;;;1196   	
;;;1197   avar_bat_hndl_lbl1: 
;;;1198   
;;;1199   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1200   
;;;1201        lc640_read_long_ptr(lc640_adr,data);
;;;1202        
;;;1203        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
;;;1204        	{        
;;;1205        	if(event_ptr_find)event_ptr_find--;
;;;1206        	else event_ptr_find=63;
;;;1207        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
;;;1208        	else goto avar_bat_hndl_lbl1;
;;;1209        	}
;;;1210        else 
;;;1211        	{
;;;1212        	lc640_read_long_ptr(lc640_adr+16,data);
;;;1213        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1214        		{        
;;;1215        		if(event_ptr_find)event_ptr_find--;
;;;1216            		else event_ptr_find=63;
;;;1217            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
;;;1218        		else goto avar_bat_hndl_lbl1;
;;;1219        		}
;;;1220   
;;;1221        	}
;;;1222        		
;;;1223   	data[0]=LPC_RTC->YEAR;
;;;1224   	data[1]=LPC_RTC->MONTH;
;;;1225   	data[2]=LPC_RTC->DOM;
;;;1226   	data[3]=0;
;;;1227   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1228   
;;;1229   	data[0]=LPC_RTC->HOUR;
;;;1230   	data[1]=LPC_RTC->MIN;
;;;1231   	data[2]=LPC_RTC->SEC;
;;;1232   	data[3]=0;
;;;1233   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1234   	
;;;1235   	data[0]='B';
;;;1236   	data[1]='B';
;;;1237   	data[2]='B';
;;;1238   	data[3]='B';
;;;1239   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1240   	
;;;1241   	data[0]='B';
;;;1242   	data[1]='B';
;;;1243   	data[2]='B';
;;;1244   	data[3]='B';
;;;1245   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1246   	
;;;1247   	if(b==0)
;;;1248   		{
;;;1249   		snmp_trap_send("BAT #1 detected",5,1,0);
;;;1250   		}
;;;1251   	else if(b==1)
;;;1252   		{
;;;1253   		snmp_trap_send("BAT #2 detected",5,2,0);
;;;1254   		}
;;;1255   	
;;;1256   	}
;;;1257   	
;;;1258   avar_bat_hndl_end:
;;;1259   __nop();
;;;1260   #endif    //o_10		
;;;1261   }
;;;1262   
                          ENDP

                  avar_bat_temper_hndl PROC
;;;1263   //-----------------------------------------------
;;;1264   void avar_bat_temper_hndl(char b, char in)
0012be  e92d4ff8          PUSH     {r3-r11,lr}
;;;1265   {
0012c2  4605              MOV      r5,r0
0012c4  460e              MOV      r6,r1
;;;1266   char data[4];
;;;1267   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1268   
;;;1269   if((in==1)||(in==3))
;;;1270   	{
;;;1271   	//bat[b]._av|=1;
;;;1272       
;;;1273   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1274   	event_ptr++;	
;;;1275   	if(event_ptr>63)event_ptr=0;	
;;;1276   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1277   	
;;;1278        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1279   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1280   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1281   	
;;;1282   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1283   	
;;;1284   	data[0]='B';
;;;1285   	data[1]=b;
;;;1286   	data[2]='T';
;;;1287   	data[3]='1';
;;;1288   	if(in==3)data[3]='3';
;;;1289   	lc640_write_long_ptr(lc640_adr,data);
;;;1290   
;;;1291   	data[0]=0;
;;;1292   	data[1]=0;
;;;1293   	data[2]=0;
;;;1294   	data[3]=0;
;;;1295   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1296   
;;;1297   	data[0]=LPC_RTC->YEAR;
0012c6  f8dfa128          LDR      r10,|L1.5104|
0012ca  f44f6060          MOV      r0,#0xe00             ;1273
0012ce  f44f6780          MOV      r7,#0x400             ;1282
0012d2  2e01              CMP      r6,#1                 ;1269
0012d4  d010              BEQ      |L1.4856|
0012d6  2e03              CMP      r6,#3                 ;1269
0012d8  d00e              BEQ      |L1.4856|
;;;1298   	data[1]=LPC_RTC->MONTH;
;;;1299   	data[2]=LPC_RTC->DOM;
;;;1300   	data[3]=0;
;;;1301   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1302   
;;;1303   	data[0]=LPC_RTC->HOUR;
;;;1304   	data[1]=LPC_RTC->MIN;
;;;1305   	data[2]=LPC_RTC->SEC;
;;;1306   	data[3]=0;
;;;1307   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1308   	
;;;1309   	data[0]='A';
;;;1310   	data[1]='A';
;;;1311   	data[2]='A';
;;;1312   	data[3]='A';
;;;1313   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1314   	
;;;1315   	data[0]='A';
;;;1316   	data[1]='A';
;;;1317   	data[2]='A';
;;;1318   	data[3]='A';
;;;1319   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1320   	
;;;1321   	data[0]='A';
;;;1322   	data[1]='A';
;;;1323   	data[2]='A';
;;;1324   	data[3]='A';
;;;1325   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1326   	
;;;1327   	data[0]='A';
;;;1328   	data[1]='A';
;;;1329   	data[2]='A';
;;;1330   	data[3]='A';
;;;1331   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1332   	if(in==1)
;;;1333   		{				
;;;1334   		if(b==0)
;;;1335   			{
;;;1336   			snmp_trap_send("BAT #1 Alarm, is heated",10,1,1);
;;;1337   			}
;;;1338   		else if(b==1)
;;;1339   			{
;;;1340   			snmp_trap_send("BAT #2 Alarm, is heated",10,2,1);
;;;1341   			} 
;;;1342   		}
;;;1343   	if(in==3)
;;;1344   		{				
;;;1345   		if(b==0)
;;;1346   			{
;;;1347   			snmp_trap_send("BAT #1 Alarm, is overheated",11,1,1);
;;;1348   			}
;;;1349   		else if(b==1)
;;;1350   			{
;;;1351   			snmp_trap_send("BAT #2 Alarm, is overheated",11,2,1);
;;;1352   			} 
;;;1353   		}			
;;;1354   	}
;;;1355   
;;;1356   else if((in==0)||(in==2))
0012da  b10e              CBZ      r6,|L1.4832|
0012dc  2e02              CMP      r6,#2
0012de  d17d              BNE      |L1.5084|
                  |L1.4832|
;;;1357   	{
;;;1358   	char i;
;;;1359   
;;;1360   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0012e0  f7fffffe          BL       lc640_read_int
0012e4  fa1ff980          UXTH     r9,r0
;;;1361   	event_ptr_find=event_ptr;
0012e8  464c              MOV      r4,r9
;;;1362   
;;;1363   /*	for (i=0;i<63;i++)
;;;1364   		{
;;;1365   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1366   
;;;1367        	lc640_read_long_ptr(lc640_adr,data);
;;;1368        
;;;1369        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;1370        		{        
;;;1371        		if(event_ptr_find)event_ptr_find--;
;;;1372        		else event_ptr_find=63;
;;;1373        		if(event_ptr_find==event_ptr)
;;;1374   				{
;;;1375   				lc640_adr=0;
;;;1376   				break;
;;;1377   				}
;;;1378        		else continue;
;;;1379        		}
;;;1380        	else 
;;;1381        		{
;;;1382        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1383        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1384        			{        
;;;1385        			if(event_ptr_find)event_ptr_find--;
;;;1386            		else event_ptr_find=63;
;;;1387            		if(event_ptr_find==event_ptr)
;;;1388   					{
;;;1389   					lc640_adr=0;
;;;1390   					break;
;;;1391   					}
;;;1392        			else continue;
;;;1393        			}
;;;1394        		}	
;;;1395   		}*/
;;;1396   	
;;;1397   	for (i=0;i<63;i++)
0012ea  f04f0800          MOV      r8,#0
                  |L1.4846|
;;;1398   		{
;;;1399   		char temp='1';
0012ee  f04f0b31          MOV      r11,#0x31
;;;1400   		if(in==2)temp='3';
0012f2  2e02              CMP      r6,#2
0012f4  d073              BEQ      |L1.5086|
0012f6  e0e3              B        |L1.5312|
                  |L1.4856|
0012f8  4680              MOV      r8,r0                 ;1273
0012fa  f7fffffe          BL       lc640_read_int
0012fe  f1000001          ADD      r0,r0,#1              ;1274
001302  b284              UXTH     r4,r0                 ;1274
001304  2c3f              CMP      r4,#0x3f              ;1275
001306  d901              BLS      |L1.4876|
001308  f04f0400          MOV      r4,#0                 ;1275
                  |L1.4876|
00130c  b221              SXTH     r1,r4                 ;1276
00130e  4640              MOV      r0,r8                 ;1276
001310  f7fffffe          BL       lc640_write_int
001314  f6406902          MOV      r9,#0xe02             ;1278
001318  4648              MOV      r0,r9                 ;1278
00131a  f7fffffe          BL       lc640_read_int
00131e  b280              UXTH     r0,r0                 ;1278
001320  283f              CMP      r0,#0x3f              ;1279
001322  d000              BEQ      |L1.4902|
001324  4620              MOV      r0,r4                 ;1279
                  |L1.4902|
001326  b201              SXTH     r1,r0                 ;1280
001328  4648              MOV      r0,r9                 ;1280
00132a  f7fffffe          BL       lc640_write_int
00132e  4640              MOV      r0,r8                 ;1282
001330  f7fffffe          BL       lc640_read_int
001334  eb071040          ADD      r0,r7,r0,LSL #5       ;1282
001338  b284              UXTH     r4,r0                 ;1282
00133a  f04f0042          MOV      r0,#0x42              ;1284
00133e  f88d0000          STRB     r0,[sp,#0]            ;1284
001342  f88d5001          STRB     r5,[sp,#1]            ;1285
001346  f04f0054          MOV      r0,#0x54              ;1286
00134a  f88d0002          STRB     r0,[sp,#2]            ;1286
00134e  f04f0031          MOV      r0,#0x31              ;1287
001352  f88d0003          STRB     r0,[sp,#3]            ;1287
001356  2e03              CMP      r6,#3                 ;1288
001358  d103              BNE      |L1.4962|
00135a  f04f0033          MOV      r0,#0x33              ;1288
00135e  f88d0003          STRB     r0,[sp,#3]            ;1288
                  |L1.4962|
001362  4669              MOV      r1,sp                 ;1289
001364  4620              MOV      r0,r4                 ;1289
001366  f7fffffe          BL       lc640_write_long_ptr
00136a  f04f0700          MOV      r7,#0                 ;1291
00136e  9700              STR      r7,[sp,#0]            ;1294
001370  4669              MOV      r1,sp                 ;1295
001372  f1040004          ADD      r0,r4,#4              ;1295
001376  f7fffffe          BL       lc640_write_long_ptr
00137a  f8ba003c          LDRH     r0,[r10,#0x3c]        ;1297
00137e  f88d0000          STRB     r0,[sp,#0]            ;1297
001382  f89a0038          LDRB     r0,[r10,#0x38]        ;1298
001386  f88d0001          STRB     r0,[sp,#1]            ;1298
00138a  f89a002c          LDRB     r0,[r10,#0x2c]        ;1299
00138e  f88d0002          STRB     r0,[sp,#2]            ;1299
001392  f88d7003          STRB     r7,[sp,#3]            ;1300
001396  4669              MOV      r1,sp                 ;1301
001398  f1040008          ADD      r0,r4,#8              ;1301
00139c  f7fffffe          BL       lc640_write_long_ptr
0013a0  f89a0028          LDRB     r0,[r10,#0x28]        ;1303
0013a4  f88d0000          STRB     r0,[sp,#0]            ;1303
0013a8  f89a0024          LDRB     r0,[r10,#0x24]        ;1304
0013ac  f88d0001          STRB     r0,[sp,#1]            ;1304
0013b0  f89a0020          LDRB     r0,[r10,#0x20]        ;1305
0013b4  f88d0002          STRB     r0,[sp,#2]            ;1305
0013b8  f88d7003          STRB     r7,[sp,#3]            ;1306
0013bc  4669              MOV      r1,sp                 ;1307
0013be  f104000c          ADD      r0,r4,#0xc            ;1307
0013c2  f7fffffe          BL       lc640_write_long_ptr
0013c6  f04f0741          MOV      r7,#0x41              ;1309
0013ca  f88d7000          STRB     r7,[sp,#0]            ;1309
0013ce  f88d7001          STRB     r7,[sp,#1]            ;1310
0013d2  f88d7002          STRB     r7,[sp,#2]            ;1311
0013d6  f88d7003          STRB     r7,[sp,#3]            ;1312
0013da  e01d              B        |L1.5144|
                  |L1.5084|
0013dc  e066              B        |L1.5292|
                  |L1.5086|
0013de  e06d              B        |L1.5308|
                  |L1.5088|
                          DCD      0x40024020
                  |L1.5092|
                          DCD      bat_ips
                  |L1.5096|
                          DCD      ips_bat_av_stat
                  |L1.5100|
                          DCD      ips_bat_av_vzvod
                  |L1.5104|
                          DCD      0x40024000
                  |L1.5108|
0013f4  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
0013f8  b9312041
0013fc  6c61726d
001400  2c206c6f
001404  737400  
001407  00                DCB      0
                  |L1.5128|
001408  42415420          DCB      "BAT #1 detected",0
00140c  23312064
001410  65746563
001414  74656400
                  |L1.5144|
001418  4669              MOV      r1,sp                 ;1313
00141a  f1040010          ADD      r0,r4,#0x10           ;1313
00141e  f7fffffe          BL       lc640_write_long_ptr
001422  f88d7000          STRB     r7,[sp,#0]            ;1315
001426  f88d7001          STRB     r7,[sp,#1]            ;1316
00142a  f88d7002          STRB     r7,[sp,#2]            ;1317
00142e  f88d7003          STRB     r7,[sp,#3]            ;1318
001432  4669              MOV      r1,sp                 ;1319
001434  f1040014          ADD      r0,r4,#0x14           ;1319
001438  f7fffffe          BL       lc640_write_long_ptr
00143c  f88d7000          STRB     r7,[sp,#0]            ;1321
001440  f88d7001          STRB     r7,[sp,#1]            ;1322
001444  f88d7002          STRB     r7,[sp,#2]            ;1323
001448  f88d7003          STRB     r7,[sp,#3]            ;1324
00144c  4669              MOV      r1,sp                 ;1325
00144e  f1040018          ADD      r0,r4,#0x18           ;1325
001452  f7fffffe          BL       lc640_write_long_ptr
001456  f88d7000          STRB     r7,[sp,#0]            ;1327
00145a  f88d7001          STRB     r7,[sp,#1]            ;1328
00145e  f88d7002          STRB     r7,[sp,#2]            ;1329
001462  f88d7003          STRB     r7,[sp,#3]            ;1330
001466  4669              MOV      r1,sp                 ;1331
001468  f104001c          ADD      r0,r4,#0x1c           ;1331
00146c  f7fffffe          BL       lc640_write_long_ptr
001470  2e01              CMP      r6,#1                 ;1332
001472  d110              BNE      |L1.5270|
001474  b115              CBZ      r5,|L1.5244|
001476  2d01              CMP      r5,#1                 ;1338
001478  d007              BEQ      |L1.5258|
00147a  e00c              B        |L1.5270|
                  |L1.5244|
00147c  2301              MOVS     r3,#1                 ;1336
00147e  461a              MOV      r2,r3                 ;1336
001480  210a              MOVS     r1,#0xa               ;1336
001482  a0f9              ADR      r0,|L1.6248|
001484  f7fffffe          BL       snmp_trap_send
001488  e005              B        |L1.5270|
                  |L1.5258|
00148a  2301              MOVS     r3,#1                 ;1340
00148c  2202              MOVS     r2,#2                 ;1340
00148e  210a              MOVS     r1,#0xa               ;1340
001490  a0fb              ADR      r0,|L1.6272|
001492  f7fffffe          BL       snmp_trap_send
                  |L1.5270|
001496  2e03              CMP      r6,#3                 ;1343
001498  d108              BNE      |L1.5292|
00149a  b145              CBZ      r5,|L1.5294|
00149c  2d01              CMP      r5,#1                 ;1349
00149e  d105              BNE      |L1.5292|
0014a0  2301              MOVS     r3,#1                 ;1351
0014a2  2202              MOVS     r2,#2                 ;1351
0014a4  210b              MOVS     r1,#0xb               ;1351
0014a6  a0fc              ADR      r0,|L1.6296|
0014a8  f7fffffe          BL       snmp_trap_send
                  |L1.5292|
;;;1401   
;;;1402   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1403   
;;;1404        	lc640_read_long_ptr(lc640_adr,data);
;;;1405        
;;;1406        	if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='T')&&(data[3]==temp)))
;;;1407        		{        
;;;1408        		if(event_ptr_find)event_ptr_find--;
;;;1409        		else event_ptr_find=63;
;;;1410        		if(event_ptr_find==event_ptr)				{
;;;1411   				lc640_adr=0;
;;;1412   				break;
;;;1413   				}
;;;1414        		else continue;
;;;1415        		}
;;;1416   	     else 
;;;1417   	     	{
;;;1418   	     	lc640_read_long_ptr(lc640_adr+16,data);
;;;1419   	     	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1420   	     		{        
;;;1421   	     		if(event_ptr_find)event_ptr_find--;
;;;1422   	         	else event_ptr_find=63;
;;;1423   	         	if(event_ptr_find==event_ptr)				{
;;;1424   					lc640_adr=0;
;;;1425   					break;
;;;1426   					}
;;;1427   	     		else continue;
;;;1428   	     		}
;;;1429   	
;;;1430   	     	}
;;;1431   		}
;;;1432        		
;;;1433   	data[0]=LPC_RTC->YEAR;
;;;1434   	data[1]=LPC_RTC->MONTH;
;;;1435   	data[2]=LPC_RTC->DOM;
;;;1436   	data[3]=0;
;;;1437   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1438   
;;;1439   	data[0]=LPC_RTC->HOUR;
;;;1440   	data[1]=LPC_RTC->MIN;
;;;1441   	data[2]=LPC_RTC->SEC;
;;;1442   	data[3]=0;
;;;1443   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1444   	
;;;1445   	data[0]='B';
;;;1446   	data[1]='B';
;;;1447   	data[2]='B';
;;;1448   	data[3]='B';
;;;1449   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1450   	
;;;1451   	data[0]='B';
;;;1452   	data[1]='B';
;;;1453   	data[2]='B';
;;;1454   	data[3]='B';
;;;1455   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1456   	
;;;1457   	if(in==0)
;;;1458   		{				
;;;1459   		if(b==0)
;;;1460   			{
;;;1461   			snmp_trap_send("BAT #1 Alarm, heating eliminated",10,1,0);
;;;1462   			}
;;;1463   		else if(b==1)
;;;1464   			{
;;;1465   			snmp_trap_send("BAT #2 Alarm, heating eliminated",10,2,0);
;;;1466   			} 
;;;1467   		}
;;;1468   	if(in==2)
;;;1469   		{				
;;;1470   		if(b==0)
;;;1471   			{
;;;1472   			snmp_trap_send("BAT #1 Alarm, overheating eliminated",11,1,0);
;;;1473   			}
;;;1474   		else if(b==1)
;;;1475   			{
;;;1476   			snmp_trap_send("BAT #2 Alarm, overheating eliminated",11,2,0);
;;;1477   			} 
;;;1478   		}		
;;;1479   	
;;;1480   	}
;;;1481   	
;;;1482   }
0014ac  e474              B        |L1.3480|
                  |L1.5294|
0014ae  2301              MOVS     r3,#1                 ;1347
0014b0  461a              MOV      r2,r3                 ;1347
0014b2  210b              MOVS     r1,#0xb               ;1347
0014b4  a0ff              ADR      r0,|L1.6324|
0014b6  f7fffffe          BL       snmp_trap_send
0014ba  e46d              B        |L1.3480|
                  |L1.5308|
0014bc  f04f0b33          MOV      r11,#0x33             ;1400
                  |L1.5312|
0014c0  f44f6080          MOV      r0,#0x400             ;1402
0014c4  eb001044          ADD      r0,r0,r4,LSL #5       ;1402
0014c8  b287              UXTH     r7,r0                 ;1402
0014ca  4669              MOV      r1,sp                 ;1404
0014cc  4638              MOV      r0,r7                 ;1404
0014ce  f7fffffe          BL       lc640_read_long_ptr
0014d2  f89d0000          LDRB     r0,[sp,#0]            ;1406
0014d6  2842              CMP      r0,#0x42              ;1406
0014d8  d10b              BNE      |L1.5362|
0014da  f89d0001          LDRB     r0,[sp,#1]            ;1406
0014de  42a8              CMP      r0,r5                 ;1406
0014e0  d107              BNE      |L1.5362|
0014e2  f89d0002          LDRB     r0,[sp,#2]            ;1406
0014e6  2854              CMP      r0,#0x54              ;1406
0014e8  d103              BNE      |L1.5362|
0014ea  f89d0003          LDRB     r0,[sp,#3]            ;1406
0014ee  4558              CMP      r0,r11                ;1406
0014f0  d00b              BEQ      |L1.5386|
                  |L1.5362|
0014f2  b11c              CBZ      r4,|L1.5372|
0014f4  f1a40401          SUB      r4,r4,#1              ;1408
0014f8  b2a4              UXTH     r4,r4                 ;1408
0014fa  e001              B        |L1.5376|
                  |L1.5372|
0014fc  f04f043f          MOV      r4,#0x3f              ;1409
                  |L1.5376|
001500  454c              CMP      r4,r9                 ;1410
001502  d123              BNE      |L1.5452|
001504  f04f0700          MOV      r7,#0                 ;1411
001508  e028              B        |L1.5468|
                  |L1.5386|
00150a  4669              MOV      r1,sp                 ;1418
00150c  f1070010          ADD      r0,r7,#0x10           ;1418
001510  f7fffffe          BL       lc640_read_long_ptr
001514  f89d0000          LDRB     r0,[sp,#0]            ;1419
001518  2841              CMP      r0,#0x41              ;1419
00151a  d10b              BNE      |L1.5428|
00151c  f89d0001          LDRB     r0,[sp,#1]            ;1419
001520  2841              CMP      r0,#0x41              ;1419
001522  d107              BNE      |L1.5428|
001524  f89d0002          LDRB     r0,[sp,#2]            ;1419
001528  2841              CMP      r0,#0x41              ;1419
00152a  d103              BNE      |L1.5428|
00152c  f89d0003          LDRB     r0,[sp,#3]            ;1419
001530  2841              CMP      r0,#0x41              ;1419
001532  d00b              BEQ      |L1.5452|
                  |L1.5428|
001534  b11c              CBZ      r4,|L1.5438|
001536  f1a40401          SUB      r4,r4,#1              ;1421
00153a  b2a4              UXTH     r4,r4                 ;1421
00153c  e001              B        |L1.5442|
                  |L1.5438|
00153e  f04f043f          MOV      r4,#0x3f              ;1422
                  |L1.5442|
001542  454c              CMP      r4,r9                 ;1423
001544  d102              BNE      |L1.5452|
001546  f04f0700          MOV      r7,#0                 ;1424
00154a  e007              B        |L1.5468|
                  |L1.5452|
00154c  f1080801          ADD      r8,r8,#1              ;1397
001550  f00808ff          AND      r8,r8,#0xff           ;1397
001554  f1b80f3f          CMP      r8,#0x3f              ;1397
001558  f4ffaec9          BCC      |L1.4846|
                  |L1.5468|
00155c  f8ba003c          LDRH     r0,[r10,#0x3c]        ;1433
001560  f88d0000          STRB     r0,[sp,#0]            ;1433
001564  f89a0038          LDRB     r0,[r10,#0x38]        ;1434
001568  f88d0001          STRB     r0,[sp,#1]            ;1434
00156c  f89a002c          LDRB     r0,[r10,#0x2c]        ;1435
001570  f88d0002          STRB     r0,[sp,#2]            ;1435
001574  f04f0400          MOV      r4,#0                 ;1436
001578  f88d4003          STRB     r4,[sp,#3]            ;1436
00157c  4669              MOV      r1,sp                 ;1437
00157e  f1070010          ADD      r0,r7,#0x10           ;1437
001582  f7fffffe          BL       lc640_write_long_ptr
001586  f89a0028          LDRB     r0,[r10,#0x28]        ;1439
00158a  f88d0000          STRB     r0,[sp,#0]            ;1439
00158e  f89a0024          LDRB     r0,[r10,#0x24]        ;1440
001592  f88d0001          STRB     r0,[sp,#1]            ;1440
001596  f89a0020          LDRB     r0,[r10,#0x20]        ;1441
00159a  f88d0002          STRB     r0,[sp,#2]            ;1441
00159e  f88d4003          STRB     r4,[sp,#3]            ;1442
0015a2  4669              MOV      r1,sp                 ;1443
0015a4  f1070014          ADD      r0,r7,#0x14           ;1443
0015a8  f7fffffe          BL       lc640_write_long_ptr
0015ac  f04f0442          MOV      r4,#0x42              ;1445
0015b0  f88d4000          STRB     r4,[sp,#0]            ;1445
0015b4  f88d4001          STRB     r4,[sp,#1]            ;1446
0015b8  f88d4002          STRB     r4,[sp,#2]            ;1447
0015bc  f88d4003          STRB     r4,[sp,#3]            ;1448
0015c0  4669              MOV      r1,sp                 ;1449
0015c2  f1070018          ADD      r0,r7,#0x18           ;1449
0015c6  f7fffffe          BL       lc640_write_long_ptr
0015ca  f88d4000          STRB     r4,[sp,#0]            ;1451
0015ce  f88d4001          STRB     r4,[sp,#1]            ;1452
0015d2  f88d4002          STRB     r4,[sp,#2]            ;1453
0015d6  f88d4003          STRB     r4,[sp,#3]            ;1454
0015da  4669              MOV      r1,sp                 ;1455
0015dc  f107001c          ADD      r0,r7,#0x1c           ;1455
0015e0  f7fffffe          BL       lc640_write_long_ptr
0015e4  b986              CBNZ     r6,|L1.5640|
0015e6  b115              CBZ      r5,|L1.5614|
0015e8  2d01              CMP      r5,#1                 ;1463
0015ea  d007              BEQ      |L1.5628|
0015ec  e00c              B        |L1.5640|
                  |L1.5614|
0015ee  2300              MOVS     r3,#0                 ;1461
0015f0  2201              MOVS     r2,#1                 ;1461
0015f2  210a              MOVS     r1,#0xa               ;1461
0015f4  a0b6              ADR      r0,|L1.6352|
0015f6  f7fffffe          BL       snmp_trap_send
0015fa  e005              B        |L1.5640|
                  |L1.5628|
0015fc  2300              MOVS     r3,#0                 ;1465
0015fe  2202              MOVS     r2,#2                 ;1465
001600  210a              MOVS     r1,#0xa               ;1465
001602  a0bc              ADR      r0,|L1.6388|
001604  f7fffffe          BL       snmp_trap_send
                  |L1.5640|
001608  2e02              CMP      r6,#2                 ;1468
                  |L1.5642|
00160a  f47faf4f          BNE      |L1.5292|
00160e  b145              CBZ      r5,|L1.5666|
001610  2d01              CMP      r5,#1                 ;1474
001612  d1fa              BNE      |L1.5642|
001614  2300              MOVS     r3,#0                 ;1476
001616  2202              MOVS     r2,#2                 ;1476
001618  210b              MOVS     r1,#0xb               ;1476
00161a  a0bf              ADR      r0,|L1.6424|
00161c  f7fffffe          BL       snmp_trap_send
                  |L1.5664|
001620  e64b              B        |L1.4794|
                  |L1.5666|
001622  2300              MOVS     r3,#0                 ;1472
001624  2201              MOVS     r2,#1                 ;1472
001626  210b              MOVS     r1,#0xb               ;1472
001628  a0c5              ADR      r0,|L1.6464|
00162a  f7fffffe          BL       snmp_trap_send
00162e  e644              B        |L1.4794|
;;;1483   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1484   //-----------------------------------------------
;;;1485   void avar_bat_as_hndl(char b, char in)
001630  e92d4ff8          PUSH     {r3-r11,lr}
;;;1486   {
001634  4605              MOV      r5,r0
;;;1487   char data[4];
;;;1488   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1489   
;;;1490   if(in==1)
;;;1491   	{
;;;1492   	bat[b]._av|=2;
001636  48cc              LDR      r0,|L1.6504|
;;;1493       
;;;1494   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1495   	event_ptr++;	
;;;1496   	if(event_ptr>63)event_ptr=0;	
;;;1497   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1498   	
;;;1499        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1500   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1501   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1502   	
;;;1503   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1504   	
;;;1505   	data[0]='B';
;;;1506   	data[1]=b;
;;;1507   	data[2]='S';
;;;1508   	data[3]=0;
;;;1509   	lc640_write_long_ptr(lc640_adr,data);
;;;1510   
;;;1511   	data[0]=0;
;;;1512   	data[1]=0;
;;;1513   	data[2]=0;
;;;1514   	data[3]=0;
;;;1515   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1516   
;;;1517   	data[0]=LPC_RTC->YEAR;
001638  f8df8330          LDR      r8,|L1.6508|
00163c  eb050285          ADD      r2,r5,r5,LSL #2       ;1492
001640  f04f0a00          MOV      r10,#0                ;1496
001644  f04f0942          MOV      r9,#0x42              ;1505
001648  f44f6660          MOV      r6,#0xe00             ;1494
00164c  f44f6b80          MOV      r11,#0x400            ;1503
001650  eb001002          ADD      r0,r0,r2,LSL #4       ;1492
001654  2901              CMP      r1,#1                 ;1490
001656  d002              BEQ      |L1.5726|
;;;1518   	data[1]=LPC_RTC->MONTH;
;;;1519   	data[2]=LPC_RTC->DOM;
;;;1520   	data[3]=0;
;;;1521   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1522   
;;;1523   	data[0]=LPC_RTC->HOUR;
;;;1524   	data[1]=LPC_RTC->MIN;
;;;1525   	data[2]=LPC_RTC->SEC;
;;;1526   	data[3]=0;
;;;1527   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1528   	
;;;1529   	data[0]='A';
;;;1530   	data[1]='A';
;;;1531   	data[2]='A';
;;;1532   	data[3]='A';
;;;1533   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1534   	
;;;1535   	data[0]='A';
;;;1536   	data[1]='A';
;;;1537   	data[2]='A';
;;;1538   	data[3]='A';
;;;1539   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1540   	
;;;1541   	data[0]='A';
;;;1542   	data[1]='A';
;;;1543   	data[2]='A';
;;;1544   	data[3]='A';
;;;1545   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1546   	
;;;1547   	data[0]='A';
;;;1548   	data[1]='A';
;;;1549   	data[2]='A';
;;;1550   	data[3]='A';
;;;1551   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1552   
;;;1553   	if(b==0)
;;;1554   		{
;;;1555   		snmp_trap_send("BAT #1 Alarm, asymmetry",5,1,2);
;;;1556   		}
;;;1557   	else if(b==1)
;;;1558   		{
;;;1559   		snmp_trap_send("BAT #2 Alarm, asymmetry",5,2,2);
;;;1560   		} 
;;;1561   	
;;;1562   	}
;;;1563   
;;;1564   else if(in==0)
001658  2900              CMP      r1,#0
00165a  d07d              BEQ      |L1.5976|
00165c  e1de              B        |L1.6684|
                  |L1.5726|
00165e  f8101f41          LDRB     r1,[r0,#0x41]!        ;1492
001662  f0410102          ORR      r1,r1,#2              ;1492
001666  7001              STRB     r1,[r0,#0]            ;1492
001668  4630              MOV      r0,r6                 ;1494
00166a  f7fffffe          BL       lc640_read_int
00166e  f1000001          ADD      r0,r0,#1              ;1495
001672  b284              UXTH     r4,r0                 ;1495
001674  2c3f              CMP      r4,#0x3f              ;1496
001676  d901              BLS      |L1.5756|
001678  f04f0400          MOV      r4,#0                 ;1496
                  |L1.5756|
00167c  b221              SXTH     r1,r4                 ;1497
00167e  4630              MOV      r0,r6                 ;1497
001680  f7fffffe          BL       lc640_write_int
001684  f6406702          MOV      r7,#0xe02             ;1499
001688  4638              MOV      r0,r7                 ;1499
00168a  f7fffffe          BL       lc640_read_int
00168e  b280              UXTH     r0,r0                 ;1499
001690  283f              CMP      r0,#0x3f              ;1500
001692  d000              BEQ      |L1.5782|
001694  4620              MOV      r0,r4                 ;1500
                  |L1.5782|
001696  b201              SXTH     r1,r0                 ;1501
001698  4638              MOV      r0,r7                 ;1501
00169a  f7fffffe          BL       lc640_write_int
00169e  4630              MOV      r0,r6                 ;1503
0016a0  f7fffffe          BL       lc640_read_int
0016a4  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1503
0016a8  b284              UXTH     r4,r0                 ;1503
0016aa  f88d9000          STRB     r9,[sp,#0]            ;1505
0016ae  f88d5001          STRB     r5,[sp,#1]            ;1506
0016b2  f04f0053          MOV      r0,#0x53              ;1507
0016b6  f88d0002          STRB     r0,[sp,#2]            ;1507
0016ba  f88da003          STRB     r10,[sp,#3]           ;1508
0016be  4669              MOV      r1,sp                 ;1509
0016c0  4620              MOV      r0,r4                 ;1509
0016c2  f7fffffe          BL       lc640_write_long_ptr
0016c6  f8cda000          STR      r10,[sp,#0]           ;1514
0016ca  4669              MOV      r1,sp                 ;1515
0016cc  1d20              ADDS     r0,r4,#4              ;1515
0016ce  f7fffffe          BL       lc640_write_long_ptr
0016d2  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1517
0016d6  f88d0000          STRB     r0,[sp,#0]            ;1517
0016da  f8980038          LDRB     r0,[r8,#0x38]         ;1518
0016de  f88d0001          STRB     r0,[sp,#1]            ;1518
0016e2  f898002c          LDRB     r0,[r8,#0x2c]         ;1519
0016e6  f88d0002          STRB     r0,[sp,#2]            ;1519
0016ea  f88da003          STRB     r10,[sp,#3]           ;1520
0016ee  4669              MOV      r1,sp                 ;1521
0016f0  f1040008          ADD      r0,r4,#8              ;1521
0016f4  f7fffffe          BL       lc640_write_long_ptr
0016f8  f8980028          LDRB     r0,[r8,#0x28]         ;1523
0016fc  f88d0000          STRB     r0,[sp,#0]            ;1523
001700  f8980024          LDRB     r0,[r8,#0x24]         ;1524
001704  f88d0001          STRB     r0,[sp,#1]            ;1524
001708  f8980020          LDRB     r0,[r8,#0x20]         ;1525
00170c  f88d0002          STRB     r0,[sp,#2]            ;1525
001710  f88da003          STRB     r10,[sp,#3]           ;1526
001714  4669              MOV      r1,sp                 ;1527
001716  f104000c          ADD      r0,r4,#0xc            ;1527
00171a  f7fffffe          BL       lc640_write_long_ptr
00171e  f04f0641          MOV      r6,#0x41              ;1529
001722  f88d6000          STRB     r6,[sp,#0]            ;1529
001726  f88d6001          STRB     r6,[sp,#1]            ;1530
00172a  f88d6002          STRB     r6,[sp,#2]            ;1531
00172e  f88d6003          STRB     r6,[sp,#3]            ;1532
001732  4669              MOV      r1,sp                 ;1533
001734  f1040010          ADD      r0,r4,#0x10           ;1533
001738  f7fffffe          BL       lc640_write_long_ptr
00173c  f88d6000          STRB     r6,[sp,#0]            ;1535
001740  f88d6001          STRB     r6,[sp,#1]            ;1536
001744  f88d6002          STRB     r6,[sp,#2]            ;1537
001748  f88d6003          STRB     r6,[sp,#3]            ;1538
00174c  4669              MOV      r1,sp                 ;1539
00174e  f1040014          ADD      r0,r4,#0x14           ;1539
001752  f7fffffe          BL       lc640_write_long_ptr
001756  e000              B        |L1.5978|
                  |L1.5976|
001758  e02b              B        |L1.6066|
                  |L1.5978|
00175a  f88d6000          STRB     r6,[sp,#0]            ;1541
00175e  f88d6001          STRB     r6,[sp,#1]            ;1542
001762  f88d6002          STRB     r6,[sp,#2]            ;1543
001766  f88d6003          STRB     r6,[sp,#3]            ;1544
00176a  4669              MOV      r1,sp                 ;1545
00176c  f1040018          ADD      r0,r4,#0x18           ;1545
001770  f7fffffe          BL       lc640_write_long_ptr
001774  f88d6000          STRB     r6,[sp,#0]            ;1547
001778  f88d6001          STRB     r6,[sp,#1]            ;1548
00177c  f88d6002          STRB     r6,[sp,#2]            ;1549
001780  f88d6003          STRB     r6,[sp,#3]            ;1550
001784  4669              MOV      r1,sp                 ;1551
001786  f104001c          ADD      r0,r4,#0x1c           ;1551
00178a  f7fffffe          BL       lc640_write_long_ptr
00178e  b115              CBZ      r5,|L1.6038|
001790  2d01              CMP      r5,#1                 ;1557
001792  d007              BEQ      |L1.6052|
001794  e142              B        |L1.6684|
                  |L1.6038|
001796  2302              MOVS     r3,#2                 ;1555
001798  2201              MOVS     r2,#1                 ;1555
00179a  2105              MOVS     r1,#5                 ;1555
00179c  a074              ADR      r0,|L1.6512|
00179e  f7fffffe          BL       snmp_trap_send
0017a2  e13b              B        |L1.6684|
                  |L1.6052|
0017a4  2302              MOVS     r3,#2                 ;1559
0017a6  461a              MOV      r2,r3                 ;1559
0017a8  2105              MOVS     r1,#5                 ;1559
0017aa  a077              ADR      r0,|L1.6536|
0017ac  f7fffffe          BL       snmp_trap_send
0017b0  e134              B        |L1.6684|
                  |L1.6066|
;;;1565   	{
;;;1566   	bat[b]._av&=~(1<<1);
0017b2  f8101f41          LDRB     r1,[r0,#0x41]!
0017b6  f0210102          BIC      r1,r1,#2
0017ba  7001              STRB     r1,[r0,#0]
;;;1567   
;;;1568        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0017bc  4630              MOV      r0,r6
0017be  f7fffffe          BL       lc640_read_int
0017c2  b284              UXTH     r4,r0
0017c4  4627              MOV      r7,r4
;;;1569   	event_ptr_find=event_ptr;
0017c6  463c              MOV      r4,r7
                  |L1.6088|
;;;1570   	
;;;1571   avar_bat_as_hndl_lbl1: 
;;;1572   
;;;1573   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0017c8  eb0b1044          ADD      r0,r11,r4,LSL #5
0017cc  b286              UXTH     r6,r0
;;;1574   
;;;1575        lc640_read_long_ptr(lc640_adr,data);
0017ce  4669              MOV      r1,sp
0017d0  4630              MOV      r0,r6
0017d2  f7fffffe          BL       lc640_read_long_ptr
;;;1576        
;;;1577        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
0017d6  f89d0000          LDRB     r0,[sp,#0]
0017da  2842              CMP      r0,#0x42
0017dc  d107              BNE      |L1.6126|
0017de  f89d0001          LDRB     r0,[sp,#1]
0017e2  42a8              CMP      r0,r5
0017e4  d103              BNE      |L1.6126|
0017e6  f89d0002          LDRB     r0,[sp,#2]
0017ea  2843              CMP      r0,#0x43
0017ec  d009              BEQ      |L1.6146|
                  |L1.6126|
;;;1578        	{        
;;;1579        	if(event_ptr_find)event_ptr_find--;
0017ee  b11c              CBZ      r4,|L1.6136|
0017f0  f1a40401          SUB      r4,r4,#1
0017f4  b2a4              UXTH     r4,r4
0017f6  e001              B        |L1.6140|
                  |L1.6136|
;;;1580        	else event_ptr_find=63;
0017f8  f04f043f          MOV      r4,#0x3f
                  |L1.6140|
;;;1581        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
0017fc  42bc              CMP      r4,r7
0017fe  d1e3              BNE      |L1.6088|
001800  e10c              B        |L1.6684|
                  |L1.6146|
;;;1582        	else goto avar_bat_as_hndl_lbl1;
;;;1583        	}
;;;1584        else 
;;;1585        	{
;;;1586        	lc640_read_long_ptr(lc640_adr+16,data);
001802  4669              MOV      r1,sp
001804  f1060010          ADD      r0,r6,#0x10
001808  f7fffffe          BL       lc640_read_long_ptr
;;;1587        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00180c  f89d0000          LDRB     r0,[sp,#0]
001810  2841              CMP      r0,#0x41
001812  d10b              BNE      |L1.6188|
001814  f89d0001          LDRB     r0,[sp,#1]
001818  2841              CMP      r0,#0x41
00181a  d107              BNE      |L1.6188|
00181c  f89d0002          LDRB     r0,[sp,#2]
001820  2841              CMP      r0,#0x41
001822  d103              BNE      |L1.6188|
001824  f89d0003          LDRB     r0,[sp,#3]
001828  2841              CMP      r0,#0x41
00182a  d009              BEQ      |L1.6208|
                  |L1.6188|
;;;1588        		{        
;;;1589        		if(event_ptr_find)event_ptr_find--;
00182c  b11c              CBZ      r4,|L1.6198|
00182e  f1a40401          SUB      r4,r4,#1
001832  b2a4              UXTH     r4,r4
001834  e001              B        |L1.6202|
                  |L1.6198|
;;;1590            		else event_ptr_find=63;
001836  f04f043f          MOV      r4,#0x3f
                  |L1.6202|
;;;1591            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
00183a  42bc              CMP      r4,r7
00183c  d1c4              BNE      |L1.6088|
00183e  e0ed              B        |L1.6684|
                  |L1.6208|
;;;1592        		else goto avar_bat_as_hndl_lbl1;
;;;1593        		}
;;;1594   
;;;1595        	}
;;;1596        		
;;;1597   	data[0]=LPC_RTC->YEAR;
001840  f8b8003c          LDRH     r0,[r8,#0x3c]
001844  f88d0000          STRB     r0,[sp,#0]
;;;1598   	data[1]=LPC_RTC->MONTH;
001848  f8980038          LDRB     r0,[r8,#0x38]
00184c  f88d0001          STRB     r0,[sp,#1]
;;;1599   	data[2]=LPC_RTC->DOM;
001850  f898002c          LDRB     r0,[r8,#0x2c]
001854  f88d0002          STRB     r0,[sp,#2]
;;;1600   	data[3]=0;
001858  f88da003          STRB     r10,[sp,#3]
;;;1601   	lc640_write_long_ptr(lc640_adr+16,data);
00185c  4669              MOV      r1,sp
00185e  f1060010          ADD      r0,r6,#0x10
001862  f7fffffe          BL       lc640_write_long_ptr
;;;1602   
;;;1603   	data[0]=LPC_RTC->HOUR;
001866  e09b              B        |L1.6560|
                  |L1.6248|
001868  42415420          DCB      "BAT #1 Alarm, is heated",0
00186c  23312041
001870  6c61726d
001874  2c206973
001878  20686561
00187c  74656400
                  |L1.6272|
001880  42415420          DCB      "BAT #2 Alarm, is heated",0
001884  23322041
001888  6c61726d
00188c  2c206973
001890  20686561
001894  74656400
                  |L1.6296|
001898  42415420          DCB      "BAT #2 Alarm, is overheated",0
00189c  23322041
0018a0  6c61726d
0018a4  2c206973
0018a8  206f7665
0018ac  72686561
0018b0  74656400
                  |L1.6324|
0018b4  42415420          DCB      "BAT #1 Alarm, is overheated",0
0018b8  23312041
0018bc  6c61726d
0018c0  2c206973
0018c4  206f7665
0018c8  72686561
0018cc  74656400
                  |L1.6352|
0018d0  42415420          DCB      "BAT #1 Alarm, heating eliminated",0
0018d4  23312041
0018d8  6c61726d
0018dc  2c206865
0018e0  6174696e
0018e4  6720656c
0018e8  696d696e
0018ec  61746564
0018f0  00      
0018f1  00                DCB      0
0018f2  00                DCB      0
0018f3  00                DCB      0
                  |L1.6388|
0018f4  42415420          DCB      "BAT #2 Alarm, heating eliminated",0
0018f8  23322041
0018fc  6c61726d
001900  2c206865
001904  6174696e
001908  6720656c
00190c  696d696e
001910  61746564
001914  00      
001915  00                DCB      0
001916  00                DCB      0
001917  00                DCB      0
                  |L1.6424|
001918  42415420          DCB      "BAT #2 Alarm, overheating eliminated",0
00191c  23322041
001920  6c61726d
001924  2c206f76
001928  65726865
00192c  6174696e
001930  6720656c
001934  696d696e
001938  61746564
00193c  00      
00193d  00                DCB      0
00193e  00                DCB      0
00193f  00                DCB      0
                  |L1.6464|
001940  42415420          DCB      "BAT #1 Alarm, overheating eliminated",0
001944  23312041
001948  6c61726d
00194c  2c206f76
001950  65726865
001954  6174696e
001958  6720656c
00195c  696d696e
001960  61746564
001964  00      
001965  00                DCB      0
001966  00                DCB      0
001967  00                DCB      0
                  |L1.6504|
                          DCD      bat
                  |L1.6508|
                          DCD      0x40024000
                  |L1.6512|
001970  42415420          DCB      "BAT #1 Alarm, asymmetry",0
001974  23312041
001978  6c61726d
00197c  2c206173
001980  796d6d65
001984  74727900
                  |L1.6536|
001988  42415420          DCB      "BAT #2 Alarm, asymmetry",0
00198c  23322041
001990  6c61726d
001994  2c206173
001998  796d6d65
00199c  74727900
                  |L1.6560|
0019a0  f8980028          LDRB     r0,[r8,#0x28]
0019a4  f88d0000          STRB     r0,[sp,#0]
;;;1604   	data[1]=LPC_RTC->MIN;
0019a8  f8980024          LDRB     r0,[r8,#0x24]
0019ac  f88d0001          STRB     r0,[sp,#1]
;;;1605   	data[2]=LPC_RTC->SEC;
0019b0  f8980020          LDRB     r0,[r8,#0x20]
0019b4  f88d0002          STRB     r0,[sp,#2]
;;;1606   	data[3]=0;
0019b8  f88da003          STRB     r10,[sp,#3]
;;;1607   	lc640_write_long_ptr(lc640_adr+20,data);
0019bc  4669              MOV      r1,sp
0019be  f1060014          ADD      r0,r6,#0x14
0019c2  f7fffffe          BL       lc640_write_long_ptr
;;;1608   	
;;;1609   	data[0]='B';
0019c6  f88d9000          STRB     r9,[sp,#0]
;;;1610   	data[1]='B';
0019ca  f88d9001          STRB     r9,[sp,#1]
;;;1611   	data[2]='B';
0019ce  f88d9002          STRB     r9,[sp,#2]
;;;1612   	data[3]='B';
0019d2  f88d9003          STRB     r9,[sp,#3]
;;;1613   	lc640_write_long_ptr(lc640_adr+24,data);
0019d6  4669              MOV      r1,sp
0019d8  f1060018          ADD      r0,r6,#0x18
0019dc  f7fffffe          BL       lc640_write_long_ptr
;;;1614   	
;;;1615   	data[0]='B';
0019e0  f88d9000          STRB     r9,[sp,#0]
;;;1616   	data[1]='B';
0019e4  f88d9001          STRB     r9,[sp,#1]
;;;1617   	data[2]='B';
0019e8  f88d9002          STRB     r9,[sp,#2]
;;;1618   	data[3]='B';
0019ec  f88d9003          STRB     r9,[sp,#3]
;;;1619   	lc640_write_long_ptr(lc640_adr+28,data);
0019f0  4669              MOV      r1,sp
0019f2  f106001c          ADD      r0,r6,#0x1c
0019f6  f7fffffe          BL       lc640_write_long_ptr
;;;1620   	
;;;1621   	if(b==0)
0019fa  b115              CBZ      r5,|L1.6658|
;;;1622   		{
;;;1623   		snmp_trap_send("BAT #1 Asymmetry alarm clear",5,1,0);
;;;1624   		}
;;;1625   	else if(b==1)
0019fc  2d01              CMP      r5,#1
0019fe  d007              BEQ      |L1.6672|
001a00  e00c              B        |L1.6684|
                  |L1.6658|
001a02  2300              MOVS     r3,#0                 ;1623
001a04  2201              MOVS     r2,#1                 ;1623
001a06  2105              MOVS     r1,#5                 ;1623
001a08  a0f7              ADR      r0,|L1.7656|
001a0a  f7fffffe          BL       snmp_trap_send
001a0e  e005              B        |L1.6684|
                  |L1.6672|
;;;1626   		{
;;;1627   		snmp_trap_send("BAT #2 Asymmetry alarm clear",5,2,0);
001a10  2300              MOVS     r3,#0
001a12  2202              MOVS     r2,#2
001a14  2105              MOVS     r1,#5
001a16  a0fc              ADR      r0,|L1.7688|
001a18  f7fffffe          BL       snmp_trap_send
                  |L1.6684|
;;;1628   		}
;;;1629   	
;;;1630   	}
;;;1631   	
;;;1632   avar_bat_as_hndl_end:
;;;1633   __nop();		
001a1c  bf00              NOP      
                  |L1.6686|
;;;1634   }
001a1e  e44c              B        |L1.4794|
;;;1635   
                          ENDP

                  ke_zvu_mem_hndl PROC
;;;1636   //-----------------------------------------------
;;;1637   void ke_zvu_mem_hndl(char b,unsigned short in,unsigned short in1)
001a20  b5f7              PUSH     {r0-r2,r4-r7,lr}
;;;1638   {
001a22  b082              SUB      sp,sp,#8
001a24  4605              MOV      r5,r0
;;;1639   char data[4];
;;;1640   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1641   //unsigned char temp,temp_;
;;;1642   //unsigned int tempUI;
;;;1643   //unsigned long tempUL; 
;;;1644   signed temp_temp;
;;;1645   
;;;1646   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
001a26  eb050085          ADD      r0,r5,r5,LSL #2
001a2a  49ff              LDR      r1,|L1.7720|
001a2c  eb011100          ADD      r1,r1,r0,LSL #4
001a30  48fe              LDR      r0,|L1.7724|
001a32  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
001a36  f1000001          ADD      r0,r0,#1
001a3a  eb010040          ADD      r0,r1,r0,LSL #1
001a3e  f9b00024          LDRSH    r0,[r0,#0x24]
001a42  9000              STR      r0,[sp,#0]
;;;1647   
;;;1648   event_ptr=lc640_read_int(PTR_EVENT_LOG);
001a44  f44f6660          MOV      r6,#0xe00
001a48  4630              MOV      r0,r6
001a4a  f7fffffe          BL       lc640_read_int
;;;1649   event_ptr++;	
001a4e  f1000001          ADD      r0,r0,#1
001a52  4604              MOV      r4,r0
;;;1650   if(event_ptr>63)event_ptr=0;	
001a54  2c3f              CMP      r4,#0x3f
001a56  d901              BLS      |L1.6748|
001a58  f04f0400          MOV      r4,#0
                  |L1.6748|
;;;1651   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
001a5c  b221              SXTH     r1,r4
001a5e  4630              MOV      r0,r6
001a60  f7fffffe          BL       lc640_write_int
;;;1652   	
;;;1653   event_cnt=lc640_read_int(CNT_EVENT_LOG);
001a64  f6406702          MOV      r7,#0xe02
001a68  4638              MOV      r0,r7
001a6a  f7fffffe          BL       lc640_read_int
;;;1654   if(event_cnt!=63)event_cnt=event_ptr;
001a6e  283f              CMP      r0,#0x3f
001a70  d000              BEQ      |L1.6772|
001a72  4620              MOV      r0,r4
                  |L1.6772|
;;;1655   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
001a74  b201              SXTH     r1,r0
001a76  4638              MOV      r0,r7
001a78  f7fffffe          BL       lc640_write_int
;;;1656   	
;;;1657   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
001a7c  4630              MOV      r0,r6
001a7e  f7fffffe          BL       lc640_read_int
001a82  f44f6180          MOV      r1,#0x400
001a86  eb011440          ADD      r4,r1,r0,LSL #5
;;;1658   	
;;;1659   data[0]='B';
001a8a  f04f0042          MOV      r0,#0x42
001a8e  f88d0004          STRB     r0,[sp,#4]
;;;1660   data[1]=b; 
001a92  f88d5005          STRB     r5,[sp,#5]
;;;1661   data[2]='K';
001a96  f04f004b          MOV      r0,#0x4b
001a9a  f88d0006          STRB     r0,[sp,#6]
;;;1662   data[3]='Z';
001a9e  f04f005a          MOV      r0,#0x5a
001aa2  f88d0007          STRB     r0,[sp,#7]
;;;1663   
;;;1664   lc640_write_long_ptr(lc640_adr,data);
001aa6  a901              ADD      r1,sp,#4
001aa8  4620              MOV      r0,r4
001aaa  f7fffffe          BL       lc640_write_long_ptr
;;;1665   
;;;1666   data[0]=*((char*)&in);
001aae  f89d000c          LDRB     r0,[sp,#0xc]
001ab2  f88d0004          STRB     r0,[sp,#4]
;;;1667   data[1]=*(((char*)(&in))+1);
001ab6  f89d000d          LDRB     r0,[sp,#0xd]
001aba  f88d0005          STRB     r0,[sp,#5]
;;;1668   data[2]=*((char*)&temp_temp);
001abe  f89d0000          LDRB     r0,[sp,#0]
001ac2  f88d0006          STRB     r0,[sp,#6]
;;;1669   data[3]=*(((char*)(&temp_temp))+1);
001ac6  f89d0001          LDRB     r0,[sp,#1]
001aca  f88d0007          STRB     r0,[sp,#7]
;;;1670   lc640_write_long_ptr(lc640_adr+4,data);
001ace  a901              ADD      r1,sp,#4
001ad0  1d20              ADDS     r0,r4,#4
001ad2  f7fffffe          BL       lc640_write_long_ptr
;;;1671   
;;;1672   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
001ad6  f24020a2          MOV      r0,#0x2a2
001ada  f7fffffe          BL       lc640_read_long
001ade  4dd4              LDR      r5,|L1.7728|
001ae0  6028              STR      r0,[r5,#0]  ; ke_date
;;;1673   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
001ae2  4629              MOV      r1,r5
001ae4  f1040008          ADD      r0,r4,#8
001ae8  f7fffffe          BL       lc640_write_long_ptr
;;;1674   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
001aec  f24020a6          MOV      r0,#0x2a6
001af0  f7fffffe          BL       lc640_read_long
001af4  6068              STR      r0,[r5,#4]  ; ke_date
;;;1675   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
001af6  1d29              ADDS     r1,r5,#4
001af8  f104000c          ADD      r0,r4,#0xc
001afc  f7fffffe          BL       lc640_write_long_ptr
;;;1676   
;;;1677   data[0]=LPC_RTC->YEAR;
001b00  4dcc              LDR      r5,|L1.7732|
001b02  8ba8              LDRH     r0,[r5,#0x1c]
001b04  f88d0004          STRB     r0,[sp,#4]
;;;1678   data[1]=LPC_RTC->MONTH;
001b08  7e28              LDRB     r0,[r5,#0x18]
001b0a  f88d0005          STRB     r0,[sp,#5]
;;;1679   data[2]=LPC_RTC->DOM;
001b0e  7b28              LDRB     r0,[r5,#0xc]
001b10  f88d0006          STRB     r0,[sp,#6]
;;;1680   data[3]=*((char*)&in1);
001b14  f89d0010          LDRB     r0,[sp,#0x10]
001b18  f88d0007          STRB     r0,[sp,#7]
;;;1681   lc640_write_long_ptr(lc640_adr+16,data);
001b1c  a901              ADD      r1,sp,#4
001b1e  f1040010          ADD      r0,r4,#0x10
001b22  f7fffffe          BL       lc640_write_long_ptr
;;;1682   
;;;1683   data[0]=LPC_RTC->HOUR;
001b26  7a28              LDRB     r0,[r5,#8]
001b28  f88d0004          STRB     r0,[sp,#4]
;;;1684   data[1]=LPC_RTC->MIN;
001b2c  7928              LDRB     r0,[r5,#4]
001b2e  f88d0005          STRB     r0,[sp,#5]
;;;1685   data[2]=LPC_RTC->SEC;
001b32  7828              LDRB     r0,[r5,#0]
001b34  f88d0006          STRB     r0,[sp,#6]
;;;1686   data[3]=*(((char*)(&in1))+1);
001b38  f89d0011          LDRB     r0,[sp,#0x11]
001b3c  f88d0007          STRB     r0,[sp,#7]
;;;1687   lc640_write_long_ptr(lc640_adr+20,data);
001b40  a901              ADD      r1,sp,#4
001b42  f1040014          ADD      r0,r4,#0x14
001b46  f7fffffe          BL       lc640_write_long_ptr
;;;1688    
;;;1689   }
001b4a  b005              ADD      sp,sp,#0x14
001b4c  bdf0              POP      {r4-r7,pc}
;;;1690   
                          ENDP

                  vz_mem_hndl PROC
;;;1747   //-----------------------------------------------
;;;1748   void vz_mem_hndl(unsigned short in)
001b4e  e92d4ff8          PUSH     {r3-r11,lr}
;;;1749   {
;;;1750   char data[4];
;;;1751   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001b52  f04f0600          MOV      r6,#0
001b56  4634              MOV      r4,r6
;;;1752   //char avar_simbol;
;;;1753   
;;;1754   if(in==1)
;;;1755   	{
;;;1756   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1757   	event_ptr++;	
;;;1758   	if(event_ptr>63)event_ptr=0;	
;;;1759   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1760   	
;;;1761        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1762   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1763   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1764   	
;;;1765   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1766   	
;;;1767   	data[0]='B';
;;;1768   	data[1]=0; 
;;;1769   	data[2]='Z';
;;;1770   	data[3]=0;
;;;1771   	lc640_write_long_ptr(lc640_adr,data);
;;;1772   
;;;1773   	data[0]=0;
;;;1774   	data[1]=0;
;;;1775   	data[2]=0;
;;;1776   	data[3]=0;
;;;1777   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1778   
;;;1779   	data[0]=LPC_RTC->YEAR;
001b58  f8df82dc          LDR      r8,|L1.7736|
001b5c  46a1              MOV      r9,r4                 ;1751
001b5e  f04f0742          MOV      r7,#0x42              ;1767
001b62  f44f6a80          MOV      r10,#0x400            ;1765
001b66  2801              CMP      r0,#1                 ;1754
001b68  d002              BEQ      |L1.7024|
;;;1780   	data[1]=LPC_RTC->MONTH;
;;;1781   	data[2]=LPC_RTC->DOM;
;;;1782   	data[3]=0;
;;;1783   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1784   
;;;1785   	data[0]=LPC_RTC->HOUR;
;;;1786   	data[1]=LPC_RTC->MIN;
;;;1787   	data[2]=LPC_RTC->SEC;
;;;1788   	data[3]=0;
;;;1789   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1790   	
;;;1791   	data[0]='A';
;;;1792   	data[1]='A';
;;;1793   	data[2]='A';
;;;1794   	data[3]='A';
;;;1795   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1796   	
;;;1797   	data[0]='A';
;;;1798   	data[1]='A';
;;;1799   	data[2]='A';
;;;1800   	data[3]='A';
;;;1801   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1802   	
;;;1803   	data[0]='A';
;;;1804   	data[1]='A';
;;;1805   	data[2]='A';
;;;1806   	data[3]='A';
;;;1807   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1808   	
;;;1809   	data[0]='A';
;;;1810   	data[1]='A';
;;;1811   	data[2]='A';
;;;1812   	data[3]='A';
;;;1813   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1814    	
;;;1815   	}
;;;1816   
;;;1817   else if(in==0)
001b6a  2800              CMP      r0,#0
001b6c  d07e              BEQ      |L1.7276|
001b6e  e108              B        |L1.7554|
                  |L1.7024|
001b70  f44f6560          MOV      r5,#0xe00             ;1756
001b74  4628              MOV      r0,r5                 ;1756
001b76  f7fffffe          BL       lc640_read_int
001b7a  f1000001          ADD      r0,r0,#1              ;1757
001b7e  4604              MOV      r4,r0                 ;1757
001b80  2c3f              CMP      r4,#0x3f              ;1758
001b82  d901              BLS      |L1.7048|
001b84  f04f0400          MOV      r4,#0                 ;1758
                  |L1.7048|
001b88  b221              SXTH     r1,r4                 ;1759
001b8a  4628              MOV      r0,r5                 ;1759
001b8c  f7fffffe          BL       lc640_write_int
001b90  f6406602          MOV      r6,#0xe02             ;1761
001b94  4630              MOV      r0,r6                 ;1761
001b96  f7fffffe          BL       lc640_read_int
001b9a  283f              CMP      r0,#0x3f              ;1762
001b9c  d000              BEQ      |L1.7072|
001b9e  4620              MOV      r0,r4                 ;1762
                  |L1.7072|
001ba0  b201              SXTH     r1,r0                 ;1763
001ba2  4630              MOV      r0,r6                 ;1763
001ba4  f7fffffe          BL       lc640_write_int
001ba8  4628              MOV      r0,r5                 ;1765
001baa  f7fffffe          BL       lc640_read_int
001bae  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1765
001bb2  f88d7000          STRB     r7,[sp,#0]            ;1767
001bb6  f88d9001          STRB     r9,[sp,#1]            ;1768
001bba  f04f005a          MOV      r0,#0x5a              ;1769
001bbe  f88d0002          STRB     r0,[sp,#2]            ;1769
001bc2  f88d9003          STRB     r9,[sp,#3]            ;1770
001bc6  4669              MOV      r1,sp                 ;1771
001bc8  4620              MOV      r0,r4                 ;1771
001bca  f7fffffe          BL       lc640_write_long_ptr
001bce  f8cd9000          STR      r9,[sp,#0]            ;1776
001bd2  4669              MOV      r1,sp                 ;1777
001bd4  1d20              ADDS     r0,r4,#4              ;1777
001bd6  f7fffffe          BL       lc640_write_long_ptr
001bda  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1779
001bde  f88d0000          STRB     r0,[sp,#0]            ;1779
001be2  f8980038          LDRB     r0,[r8,#0x38]         ;1780
001be6  f88d0001          STRB     r0,[sp,#1]            ;1780
001bea  f898002c          LDRB     r0,[r8,#0x2c]         ;1781
001bee  f88d0002          STRB     r0,[sp,#2]            ;1781
001bf2  f88d9003          STRB     r9,[sp,#3]            ;1782
001bf6  4669              MOV      r1,sp                 ;1783
001bf8  f1040008          ADD      r0,r4,#8              ;1783
001bfc  f7fffffe          BL       lc640_write_long_ptr
001c00  f8980028          LDRB     r0,[r8,#0x28]         ;1785
001c04  f88d0000          STRB     r0,[sp,#0]            ;1785
001c08  f8980024          LDRB     r0,[r8,#0x24]         ;1786
001c0c  f88d0001          STRB     r0,[sp,#1]            ;1786
001c10  f8980020          LDRB     r0,[r8,#0x20]         ;1787
001c14  f88d0002          STRB     r0,[sp,#2]            ;1787
001c18  f88d9003          STRB     r9,[sp,#3]            ;1788
001c1c  4669              MOV      r1,sp                 ;1789
001c1e  f104000c          ADD      r0,r4,#0xc            ;1789
001c22  f7fffffe          BL       lc640_write_long_ptr
001c26  f04f0541          MOV      r5,#0x41              ;1791
001c2a  f88d5000          STRB     r5,[sp,#0]            ;1791
001c2e  f88d5001          STRB     r5,[sp,#1]            ;1792
001c32  f88d5002          STRB     r5,[sp,#2]            ;1793
001c36  f88d5003          STRB     r5,[sp,#3]            ;1794
001c3a  4669              MOV      r1,sp                 ;1795
001c3c  f1040010          ADD      r0,r4,#0x10           ;1795
001c40  f7fffffe          BL       lc640_write_long_ptr
001c44  f88d5000          STRB     r5,[sp,#0]            ;1797
001c48  f88d5001          STRB     r5,[sp,#1]            ;1798
001c4c  f88d5002          STRB     r5,[sp,#2]            ;1799
001c50  f88d5003          STRB     r5,[sp,#3]            ;1800
001c54  4669              MOV      r1,sp                 ;1801
001c56  f1040014          ADD      r0,r4,#0x14           ;1801
001c5a  f7fffffe          BL       lc640_write_long_ptr
001c5e  f88d5000          STRB     r5,[sp,#0]            ;1803
001c62  f88d5001          STRB     r5,[sp,#1]            ;1804
001c66  f88d5002          STRB     r5,[sp,#2]            ;1805
001c6a  e000              B        |L1.7278|
                  |L1.7276|
001c6c  e014              B        |L1.7320|
                  |L1.7278|
001c6e  f88d5003          STRB     r5,[sp,#3]            ;1806
001c72  4669              MOV      r1,sp                 ;1807
001c74  f1040018          ADD      r0,r4,#0x18           ;1807
001c78  f7fffffe          BL       lc640_write_long_ptr
001c7c  f88d5000          STRB     r5,[sp,#0]            ;1809
001c80  f88d5001          STRB     r5,[sp,#1]            ;1810
001c84  f88d5002          STRB     r5,[sp,#2]            ;1811
001c88  f88d5003          STRB     r5,[sp,#3]            ;1812
001c8c  4669              MOV      r1,sp                 ;1813
001c8e  f104001c          ADD      r0,r4,#0x1c           ;1813
001c92  f7fffffe          BL       lc640_write_long_ptr
001c96  e074              B        |L1.7554|
                  |L1.7320|
;;;1818   	{      
;;;1819        
;;;1820   vz_mem_hndl_lbl1: 
;;;1821   
;;;1822   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001c98  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1823   
;;;1824        lc640_read_long_ptr(lc640_adr,data);
001c9c  4669              MOV      r1,sp
001c9e  4628              MOV      r0,r5
001ca0  f7fffffe          BL       lc640_read_long_ptr
;;;1825        
;;;1826        if(!((data[0]=='B')&&(data[2]=='Z')))
001ca4  f89d0000          LDRB     r0,[sp,#0]
001ca8  2842              CMP      r0,#0x42
001caa  d103              BNE      |L1.7348|
001cac  f89d0002          LDRB     r0,[sp,#2]
001cb0  285a              CMP      r0,#0x5a
001cb2  d008              BEQ      |L1.7366|
                  |L1.7348|
;;;1827        	{        
;;;1828        	if(event_ptr_find)event_ptr_find--;
001cb4  b114              CBZ      r4,|L1.7356|
001cb6  f1a40401          SUB      r4,r4,#1
001cba  e001              B        |L1.7360|
                  |L1.7356|
;;;1829        	else event_ptr_find=63;
001cbc  f04f043f          MOV      r4,#0x3f
                  |L1.7360|
;;;1830        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001cc0  42b4              CMP      r4,r6
001cc2  d1e9              BNE      |L1.7320|
001cc4  e05d              B        |L1.7554|
                  |L1.7366|
;;;1831        	else goto vz_mem_hndl_lbl1;
;;;1832        	}
;;;1833        else 
;;;1834        	{
;;;1835        	lc640_read_long_ptr(lc640_adr+16,data);
001cc6  4669              MOV      r1,sp
001cc8  f1050010          ADD      r0,r5,#0x10
001ccc  f7fffffe          BL       lc640_read_long_ptr
;;;1836        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001cd0  f89d0000          LDRB     r0,[sp,#0]
001cd4  2841              CMP      r0,#0x41
001cd6  d10b              BNE      |L1.7408|
001cd8  f89d0001          LDRB     r0,[sp,#1]
001cdc  2841              CMP      r0,#0x41
001cde  d107              BNE      |L1.7408|
001ce0  f89d0002          LDRB     r0,[sp,#2]
001ce4  2841              CMP      r0,#0x41
001ce6  d103              BNE      |L1.7408|
001ce8  f89d0003          LDRB     r0,[sp,#3]
001cec  2841              CMP      r0,#0x41
001cee  d008              BEQ      |L1.7426|
                  |L1.7408|
;;;1837        		{        
;;;1838        		if(event_ptr_find)event_ptr_find--;
001cf0  b114              CBZ      r4,|L1.7416|
001cf2  f1a40401          SUB      r4,r4,#1
001cf6  e001              B        |L1.7420|
                  |L1.7416|
;;;1839            		else event_ptr_find=63;
001cf8  f04f043f          MOV      r4,#0x3f
                  |L1.7420|
;;;1840            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001cfc  42b4              CMP      r4,r6
001cfe  d1cb              BNE      |L1.7320|
001d00  e03f              B        |L1.7554|
                  |L1.7426|
;;;1841        		else goto vz_mem_hndl_lbl1;
;;;1842        		}
;;;1843   
;;;1844        	}	
;;;1845   
;;;1846   
;;;1847   	
;;;1848   	data[0]=LPC_RTC->YEAR;
001d02  f8b8003c          LDRH     r0,[r8,#0x3c]
001d06  f88d0000          STRB     r0,[sp,#0]
;;;1849   	data[1]=LPC_RTC->MONTH;
001d0a  f8980038          LDRB     r0,[r8,#0x38]
001d0e  f88d0001          STRB     r0,[sp,#1]
;;;1850   	data[2]=LPC_RTC->DOM;
001d12  f898002c          LDRB     r0,[r8,#0x2c]
001d16  f88d0002          STRB     r0,[sp,#2]
;;;1851   	data[3]=0;
001d1a  f88d9003          STRB     r9,[sp,#3]
;;;1852   	lc640_write_long_ptr(lc640_adr+16,data);
001d1e  4669              MOV      r1,sp
001d20  f1050010          ADD      r0,r5,#0x10
001d24  f7fffffe          BL       lc640_write_long_ptr
;;;1853   
;;;1854   	data[0]=LPC_RTC->HOUR;
001d28  f8980028          LDRB     r0,[r8,#0x28]
001d2c  f88d0000          STRB     r0,[sp,#0]
;;;1855   	data[1]=LPC_RTC->MIN;
001d30  f8980024          LDRB     r0,[r8,#0x24]
001d34  f88d0001          STRB     r0,[sp,#1]
;;;1856   	data[2]=LPC_RTC->SEC;
001d38  f8980020          LDRB     r0,[r8,#0x20]
001d3c  f88d0002          STRB     r0,[sp,#2]
;;;1857   	data[3]=0;
001d40  f88d9003          STRB     r9,[sp,#3]
;;;1858   	lc640_write_long_ptr(lc640_adr+20,data);
001d44  4669              MOV      r1,sp
001d46  f1050014          ADD      r0,r5,#0x14
001d4a  f7fffffe          BL       lc640_write_long_ptr
;;;1859   	
;;;1860   	data[0]='B';
001d4e  f88d7000          STRB     r7,[sp,#0]
;;;1861   	data[1]='B';
001d52  f88d7001          STRB     r7,[sp,#1]
;;;1862   	data[2]='B';
001d56  f88d7002          STRB     r7,[sp,#2]
;;;1863   	data[3]='B';
001d5a  f88d7003          STRB     r7,[sp,#3]
;;;1864   	lc640_write_long_ptr(lc640_adr+24,data);
001d5e  4669              MOV      r1,sp
001d60  f1050018          ADD      r0,r5,#0x18
001d64  f7fffffe          BL       lc640_write_long_ptr
;;;1865   	
;;;1866   	data[0]='B';
001d68  f88d7000          STRB     r7,[sp,#0]
;;;1867   	data[1]='B';
001d6c  f88d7001          STRB     r7,[sp,#1]
;;;1868   	data[2]='B';
001d70  f88d7002          STRB     r7,[sp,#2]
;;;1869   	data[3]='B';
001d74  f88d7003          STRB     r7,[sp,#3]
;;;1870   	lc640_write_long_ptr(lc640_adr+28,data);
001d78  4669              MOV      r1,sp
001d7a  f105001c          ADD      r0,r5,#0x1c
001d7e  f7fffffe          BL       lc640_write_long_ptr
                  |L1.7554|
;;;1871   	
;;;1872   	}
;;;1873   
;;;1874   vz_mem_hndl_end:
;;;1875   __nop(); 
001d82  bf00              NOP      
                  |L1.7556|
;;;1876   
;;;1877   }
001d84  e44c              B        |L1.5664|
;;;1878   
                          ENDP

                  speedz_mem_hndl PROC
;;;1879   //-----------------------------------------------
;;;1880   void speedz_mem_hndl(unsigned short in)	 //    (1-, 5- , 0- , 10- )
001d86  e92d4ff8          PUSH     {r3-r11,lr}
;;;1881   {
001d8a  4605              MOV      r5,r0
;;;1882   char data[4];
;;;1883   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001d8c  f04f0600          MOV      r6,#0
001d90  4634              MOV      r4,r6
;;;1884   //char avar_simbol;
;;;1885   
;;;1886   if((in==1)||(in==5)) //  
;;;1887   	{
;;;1888   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1889   	event_ptr++;	
;;;1890   	if(event_ptr>63)event_ptr=0;	
;;;1891   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1892   	
;;;1893       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1894   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1895   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1896   	
;;;1897   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1898   	
;;;1899   	data[0]='s';
;;;1900   	data[1]=0;
;;;1901   	if(in==5)data[1]='a'; 
;;;1902   	data[2]='Z';
;;;1903   	data[3]=0;
;;;1904   	lc640_write_long_ptr(lc640_adr,data);
;;;1905   
;;;1906   	data[0]=0;
;;;1907   	data[1]=0;
;;;1908   	data[2]=0;
;;;1909   	data[3]=0;
;;;1910   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1911   
;;;1912   	data[0]=LPC_RTC->YEAR;
001d92  f8df80a4          LDR      r8,|L1.7736|
001d96  46a1              MOV      r9,r4                 ;1883
001d98  f44f6a80          MOV      r10,#0x400            ;1897
001d9c  2d01              CMP      r5,#1                 ;1886
001d9e  d012              BEQ      |L1.7622|
001da0  2d05              CMP      r5,#5                 ;1886
001da2  d010              BEQ      |L1.7622|
;;;1913   	data[1]=LPC_RTC->MONTH;
;;;1914   	data[2]=LPC_RTC->DOM;
;;;1915   	data[3]=0;
;;;1916   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1917   
;;;1918   	data[0]=LPC_RTC->HOUR;
;;;1919   	data[1]=LPC_RTC->MIN;
;;;1920   	data[2]=LPC_RTC->SEC;
;;;1921   	data[3]=0;
;;;1922   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1923   	
;;;1924   	data[0]='A';
;;;1925   	data[1]='A';
;;;1926   	data[2]='A';
;;;1927   	data[3]='A';
;;;1928   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1929   	
;;;1930   	data[0]='A';
;;;1931   	data[1]='A';
;;;1932   	data[2]='A';
;;;1933   	data[3]='A';
;;;1934   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1935   	
;;;1936   	data[0]='A';
;;;1937   	data[1]='A';
;;;1938   	data[2]='A';
;;;1939   	data[3]='A';
;;;1940   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1941   	
;;;1942   	data[0]='A';
;;;1943   	data[1]='A';
;;;1944   	data[2]='A';
;;;1945   	data[3]='A';
;;;1946   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1947    	
;;;1948   	}
;;;1949   
;;;1950   else if(in==0)	// 
001da4  2d00              CMP      r5,#0
001da6  d07d              BEQ      |L1.7844|
;;;1951   	{      
;;;1952   	char i;     
;;;1953   	event_ptr_find=0;
;;;1954   	for (i=0;i<63;i++)
;;;1955   		{
;;;1956   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1957   
;;;1958        	lc640_read_long_ptr(lc640_adr,data);
;;;1959        
;;;1960        	if(!((data[0]=='s')&&(data[2]=='Z')))
;;;1961        		{        
;;;1962        		if(event_ptr_find)event_ptr_find--;
;;;1963        		else event_ptr_find=63;
;;;1964        		if(event_ptr_find==event_ptr)
;;;1965   				{
;;;1966   				lc640_adr=0;
;;;1967   				break;
;;;1968   				}
;;;1969        		else continue;
;;;1970        		}
;;;1971        	else 
;;;1972        		{
;;;1973        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1974        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1975        			{        
;;;1976        			if(event_ptr_find)event_ptr_find--;
;;;1977            		else event_ptr_find=63;
;;;1978            		if(event_ptr_find==event_ptr)
;;;1979   					{
;;;1980   					lc640_adr=0;
;;;1981   					break;
;;;1982   					}
;;;1983        			else continue;
;;;1984        			}
;;;1985        		}	
;;;1986   		}
;;;1987   	if(lc640_adr!=0)
;;;1988   		{
;;;1989   		data[0]=LPC_RTC->YEAR;
;;;1990   		data[1]=LPC_RTC->MONTH;
;;;1991   		data[2]=LPC_RTC->DOM;
;;;1992   		data[3]=0;
;;;1993   		lc640_write_long_ptr(lc640_adr+16,data);
;;;1994   	
;;;1995   		data[0]=LPC_RTC->HOUR;
;;;1996   		data[1]=LPC_RTC->MIN;
;;;1997   		data[2]=LPC_RTC->SEC;
;;;1998   		data[3]=0;
;;;1999   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2000   		
;;;2001   		data[0]='C';
;;;2002   		data[1]='C';
;;;2003   		data[2]='C';
;;;2004   		data[3]='C';
;;;2005   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2006   		
;;;2007   		data[0]='C';
;;;2008   		data[1]='C';
;;;2009   		data[2]='C';
;;;2010   		data[3]='C';
;;;2011   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2012   		}
;;;2013   	}
;;;2014   else if(in==10) 	//  
001da8  2d0a              CMP      r5,#0xa
001daa  d17c              BNE      |L1.7846|
;;;2015   	{      
;;;2016   	char i;     
;;;2017   
;;;2018   	event_ptr_find=0;
;;;2019   	for (i=0;i<63;i++)
001dac  f04f0700          MOV      r7,#0
                  |L1.7600|
;;;2020   		{
;;;2021   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
001db0  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2022   
;;;2023        	lc640_read_long_ptr(lc640_adr,data);
001db4  4669              MOV      r1,sp
001db6  4628              MOV      r0,r5
001db8  f7fffffe          BL       lc640_read_long_ptr
;;;2024        
;;;2025        	if(!((data[0]=='s')&&(data[2]=='Z')))
001dbc  f89d0000          LDRB     r0,[sp,#0]
001dc0  2873              CMP      r0,#0x73
001dc2  d171              BNE      |L1.7848|
001dc4  e14d              B        |L1.8290|
                  |L1.7622|
001dc6  f44f6660          MOV      r6,#0xe00             ;1888
001dca  4630              MOV      r0,r6                 ;1888
001dcc  f7fffffe          BL       lc640_read_int
001dd0  f1000001          ADD      r0,r0,#1              ;1889
001dd4  4604              MOV      r4,r0                 ;1889
001dd6  2c3f              CMP      r4,#0x3f              ;1890
001dd8  d901              BLS      |L1.7646|
001dda  f04f0400          MOV      r4,#0                 ;1890
                  |L1.7646|
001dde  b221              SXTH     r1,r4                 ;1891
001de0  4630              MOV      r0,r6                 ;1891
001de2  f7fffffe          BL       lc640_write_int
001de6  e029              B        |L1.7740|
                  |L1.7656|
001de8  42415420          DCB      "BAT #1 Asymmetry alarm clear",0
001dec  23312041
001df0  73796d6d
001df4  65747279
001df8  20616c61
001dfc  726d2063
001e00  6c656172
001e04  00      
001e05  00                DCB      0
001e06  00                DCB      0
001e07  00                DCB      0
                  |L1.7688|
001e08  42415420          DCB      "BAT #2 Asymmetry alarm clear",0
001e0c  23322041
001e10  73796d6d
001e14  65747279
001e18  20616c61
001e1c  726d2063
001e20  6c656172
001e24  00      
001e25  00                DCB      0
001e26  00                DCB      0
001e27  00                DCB      0
                  |L1.7720|
                          DCD      bat
                  |L1.7724|
                          DCD      bat_u_old_cnt
                  |L1.7728|
                          DCD      ke_date
                  |L1.7732|
                          DCD      0x40024020
                  |L1.7736|
                          DCD      0x40024000
                  |L1.7740|
001e3c  f6406702          MOV      r7,#0xe02             ;1893
001e40  4638              MOV      r0,r7                 ;1893
001e42  f7fffffe          BL       lc640_read_int
001e46  283f              CMP      r0,#0x3f              ;1894
001e48  d000              BEQ      |L1.7756|
001e4a  4620              MOV      r0,r4                 ;1894
                  |L1.7756|
001e4c  b201              SXTH     r1,r0                 ;1895
001e4e  4638              MOV      r0,r7                 ;1895
001e50  f7fffffe          BL       lc640_write_int
001e54  4630              MOV      r0,r6                 ;1897
001e56  f7fffffe          BL       lc640_read_int
001e5a  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1897
001e5e  f04f0073          MOV      r0,#0x73              ;1899
001e62  f88d0000          STRB     r0,[sp,#0]            ;1899
001e66  f88d9001          STRB     r9,[sp,#1]            ;1900
001e6a  2d05              CMP      r5,#5                 ;1901
001e6c  d103              BNE      |L1.7798|
001e6e  f04f0061          MOV      r0,#0x61              ;1901
001e72  f88d0001          STRB     r0,[sp,#1]            ;1901
                  |L1.7798|
001e76  f04f005a          MOV      r0,#0x5a              ;1902
001e7a  f88d0002          STRB     r0,[sp,#2]            ;1902
001e7e  f88d9003          STRB     r9,[sp,#3]            ;1903
001e82  4669              MOV      r1,sp                 ;1904
001e84  4620              MOV      r0,r4                 ;1904
001e86  f7fffffe          BL       lc640_write_long_ptr
001e8a  f8cd9000          STR      r9,[sp,#0]            ;1909
001e8e  4669              MOV      r1,sp                 ;1910
001e90  1d20              ADDS     r0,r4,#4              ;1910
001e92  f7fffffe          BL       lc640_write_long_ptr
001e96  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1912
001e9a  f88d0000          STRB     r0,[sp,#0]            ;1912
001e9e  f8980038          LDRB     r0,[r8,#0x38]         ;1913
001ea2  e002              B        |L1.7850|
                  |L1.7844|
001ea4  e058              B        |L1.8024|
                  |L1.7846|
001ea6  e056              B        |L1.8022|
                  |L1.7848|
001ea8  e0df              B        |L1.8298|
                  |L1.7850|
001eaa  f88d0001          STRB     r0,[sp,#1]            ;1913
001eae  f898002c          LDRB     r0,[r8,#0x2c]         ;1914
001eb2  f88d0002          STRB     r0,[sp,#2]            ;1914
001eb6  f88d9003          STRB     r9,[sp,#3]            ;1915
001eba  4669              MOV      r1,sp                 ;1916
001ebc  f1040008          ADD      r0,r4,#8              ;1916
001ec0  f7fffffe          BL       lc640_write_long_ptr
001ec4  f8980028          LDRB     r0,[r8,#0x28]         ;1918
001ec8  f88d0000          STRB     r0,[sp,#0]            ;1918
001ecc  f8980024          LDRB     r0,[r8,#0x24]         ;1919
001ed0  f88d0001          STRB     r0,[sp,#1]            ;1919
001ed4  f8980020          LDRB     r0,[r8,#0x20]         ;1920
001ed8  f88d0002          STRB     r0,[sp,#2]            ;1920
001edc  f88d9003          STRB     r9,[sp,#3]            ;1921
001ee0  4669              MOV      r1,sp                 ;1922
001ee2  f104000c          ADD      r0,r4,#0xc            ;1922
001ee6  f7fffffe          BL       lc640_write_long_ptr
001eea  f04f0541          MOV      r5,#0x41              ;1924
001eee  f88d5000          STRB     r5,[sp,#0]            ;1924
001ef2  f88d5001          STRB     r5,[sp,#1]            ;1925
001ef6  f88d5002          STRB     r5,[sp,#2]            ;1926
001efa  f88d5003          STRB     r5,[sp,#3]            ;1927
001efe  4669              MOV      r1,sp                 ;1928
001f00  f1040010          ADD      r0,r4,#0x10           ;1928
001f04  f7fffffe          BL       lc640_write_long_ptr
001f08  f88d5000          STRB     r5,[sp,#0]            ;1930
001f0c  f88d5001          STRB     r5,[sp,#1]            ;1931
001f10  f88d5002          STRB     r5,[sp,#2]            ;1932
001f14  f88d5003          STRB     r5,[sp,#3]            ;1933
001f18  4669              MOV      r1,sp                 ;1934
001f1a  f1040014          ADD      r0,r4,#0x14           ;1934
001f1e  f7fffffe          BL       lc640_write_long_ptr
001f22  f88d5000          STRB     r5,[sp,#0]            ;1936
001f26  f88d5001          STRB     r5,[sp,#1]            ;1937
001f2a  f88d5002          STRB     r5,[sp,#2]            ;1938
001f2e  f88d5003          STRB     r5,[sp,#3]            ;1939
001f32  4669              MOV      r1,sp                 ;1940
001f34  f1040018          ADD      r0,r4,#0x18           ;1940
001f38  f7fffffe          BL       lc640_write_long_ptr
001f3c  f88d5000          STRB     r5,[sp,#0]            ;1942
001f40  f88d5001          STRB     r5,[sp,#1]            ;1943
001f44  f88d5002          STRB     r5,[sp,#2]            ;1944
001f48  f88d5003          STRB     r5,[sp,#3]            ;1945
001f4c  4669              MOV      r1,sp                 ;1946
001f4e  f104001c          ADD      r0,r4,#0x1c           ;1946
001f52  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8022|
;;;2026        		{        
;;;2027        		if(event_ptr_find)event_ptr_find--;
;;;2028        		else event_ptr_find=63;
;;;2029        		if(event_ptr_find==event_ptr)
;;;2030   				{
;;;2031   				lc640_adr=0;
;;;2032   				break;
;;;2033   				}
;;;2034        		else continue;
;;;2035        		}
;;;2036        	else 
;;;2037        		{
;;;2038        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2039        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2040        			{        
;;;2041        			if(event_ptr_find)event_ptr_find--;
;;;2042            		else event_ptr_find=63;
;;;2043            		if(event_ptr_find==event_ptr)
;;;2044   					{
;;;2045   					lc640_adr=0;
;;;2046   					break;
;;;2047   					}
;;;2048        			else continue;
;;;2049        			}
;;;2050        		}	
;;;2051   		}
;;;2052   	if(lc640_adr!=0)
;;;2053   		{
;;;2054   		data[0]=LPC_RTC->YEAR;
;;;2055   		data[1]=LPC_RTC->MONTH;
;;;2056   		data[2]=LPC_RTC->DOM;
;;;2057   		data[3]=0;
;;;2058   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2059   	
;;;2060   		data[0]=LPC_RTC->HOUR;
;;;2061   		data[1]=LPC_RTC->MIN;
;;;2062   		data[2]=LPC_RTC->SEC;
;;;2063   		data[3]=0;
;;;2064   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2065   		
;;;2066   		data[0]='B';
;;;2067   		data[1]='B';
;;;2068   		data[2]='B';
;;;2069   		data[3]='B';
;;;2070   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2071   		
;;;2072   		data[0]='B';
;;;2073   		data[1]='B';
;;;2074   		data[2]='B';
;;;2075   		data[3]='B';
;;;2076   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2077   		}
;;;2078   	}
;;;2079   }
001f56  e562              B        |L1.6686|
                  |L1.8024|
001f58  f04f0700          MOV      r7,#0                 ;1954
                  |L1.8028|
001f5c  eb0a1544          ADD      r5,r10,r4,LSL #5      ;1956
001f60  4669              MOV      r1,sp                 ;1958
001f62  4628              MOV      r0,r5                 ;1958
001f64  f7fffffe          BL       lc640_read_long_ptr
001f68  f89d0000          LDRB     r0,[sp,#0]            ;1960
001f6c  2873              CMP      r0,#0x73              ;1960
001f6e  d103              BNE      |L1.8056|
001f70  f89d0002          LDRB     r0,[sp,#2]            ;1960
001f74  285a              CMP      r0,#0x5a              ;1960
001f76  d00a              BEQ      |L1.8078|
                  |L1.8056|
001f78  b114              CBZ      r4,|L1.8064|
001f7a  f1a40401          SUB      r4,r4,#1              ;1962
001f7e  e001              B        |L1.8068|
                  |L1.8064|
001f80  f04f043f          MOV      r4,#0x3f              ;1963
                  |L1.8068|
001f84  42b4              CMP      r4,r6                 ;1964
001f86  d122              BNE      |L1.8142|
001f88  f04f0500          MOV      r5,#0                 ;1966
001f8c  e024              B        |L1.8152|
                  |L1.8078|
001f8e  4669              MOV      r1,sp                 ;1973
001f90  f1050010          ADD      r0,r5,#0x10           ;1973
001f94  f7fffffe          BL       lc640_read_long_ptr
001f98  f89d0000          LDRB     r0,[sp,#0]            ;1974
001f9c  2841              CMP      r0,#0x41              ;1974
001f9e  d10b              BNE      |L1.8120|
001fa0  f89d0001          LDRB     r0,[sp,#1]            ;1974
001fa4  2841              CMP      r0,#0x41              ;1974
001fa6  d107              BNE      |L1.8120|
001fa8  f89d0002          LDRB     r0,[sp,#2]            ;1974
001fac  2841              CMP      r0,#0x41              ;1974
001fae  d103              BNE      |L1.8120|
001fb0  f89d0003          LDRB     r0,[sp,#3]            ;1974
001fb4  2841              CMP      r0,#0x41              ;1974
001fb6  d00a              BEQ      |L1.8142|
                  |L1.8120|
001fb8  b114              CBZ      r4,|L1.8128|
001fba  f1a40401          SUB      r4,r4,#1              ;1976
001fbe  e001              B        |L1.8132|
                  |L1.8128|
001fc0  f04f043f          MOV      r4,#0x3f              ;1977
                  |L1.8132|
001fc4  42b4              CMP      r4,r6                 ;1978
001fc6  d102              BNE      |L1.8142|
001fc8  f04f0500          MOV      r5,#0                 ;1980
001fcc  e004              B        |L1.8152|
                  |L1.8142|
001fce  f1070701          ADD      r7,r7,#1              ;1954
001fd2  b2ff              UXTB     r7,r7                 ;1954
001fd4  2f3f              CMP      r7,#0x3f              ;1954
001fd6  d3c1              BCC      |L1.8028|
                  |L1.8152|
001fd8  2d00              CMP      r5,#0                 ;1987
001fda  d0bc              BEQ      |L1.8022|
001fdc  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1989
001fe0  f88d0000          STRB     r0,[sp,#0]            ;1989
001fe4  f8980038          LDRB     r0,[r8,#0x38]         ;1990
001fe8  f88d0001          STRB     r0,[sp,#1]            ;1990
001fec  f898002c          LDRB     r0,[r8,#0x2c]         ;1991
001ff0  f88d0002          STRB     r0,[sp,#2]            ;1991
001ff4  f88d9003          STRB     r9,[sp,#3]            ;1992
001ff8  4669              MOV      r1,sp                 ;1993
001ffa  f1050010          ADD      r0,r5,#0x10           ;1993
001ffe  f7fffffe          BL       lc640_write_long_ptr
002002  f8980028          LDRB     r0,[r8,#0x28]         ;1995
002006  f88d0000          STRB     r0,[sp,#0]            ;1995
00200a  f8980024          LDRB     r0,[r8,#0x24]         ;1996
00200e  f88d0001          STRB     r0,[sp,#1]            ;1996
002012  f8980020          LDRB     r0,[r8,#0x20]         ;1997
002016  f88d0002          STRB     r0,[sp,#2]            ;1997
00201a  f88d9003          STRB     r9,[sp,#3]            ;1998
00201e  4669              MOV      r1,sp                 ;1999
002020  f1050014          ADD      r0,r5,#0x14           ;1999
002024  f7fffffe          BL       lc640_write_long_ptr
002028  f04f0443          MOV      r4,#0x43              ;2001
00202c  f88d4000          STRB     r4,[sp,#0]            ;2001
002030  f88d4001          STRB     r4,[sp,#1]            ;2002
002034  f88d4002          STRB     r4,[sp,#2]            ;2003
002038  f88d4003          STRB     r4,[sp,#3]            ;2004
00203c  4669              MOV      r1,sp                 ;2005
00203e  f1050018          ADD      r0,r5,#0x18           ;2005
002042  f7fffffe          BL       lc640_write_long_ptr
002046  f88d4000          STRB     r4,[sp,#0]            ;2007
00204a  f88d4001          STRB     r4,[sp,#1]            ;2008
00204e  f88d4002          STRB     r4,[sp,#2]            ;2009
002052  f88d4003          STRB     r4,[sp,#3]            ;2010
002056  4669              MOV      r1,sp                 ;2011
002058  f105001c          ADD      r0,r5,#0x1c           ;2011
00205c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8288|
002060  e4dd              B        |L1.6686|
                  |L1.8290|
002062  f89d0002          LDRB     r0,[sp,#2]            ;2025
002066  285a              CMP      r0,#0x5a              ;2025
002068  d00a              BEQ      |L1.8320|
                  |L1.8298|
00206a  b114              CBZ      r4,|L1.8306|
00206c  f1a40401          SUB      r4,r4,#1              ;2027
002070  e001              B        |L1.8310|
                  |L1.8306|
002072  f04f043f          MOV      r4,#0x3f              ;2028
                  |L1.8310|
002076  42b4              CMP      r4,r6                 ;2029
002078  d122              BNE      |L1.8384|
00207a  f04f0500          MOV      r5,#0                 ;2031
00207e  e025              B        |L1.8396|
                  |L1.8320|
002080  4669              MOV      r1,sp                 ;2038
002082  f1050010          ADD      r0,r5,#0x10           ;2038
002086  f7fffffe          BL       lc640_read_long_ptr
00208a  f89d0000          LDRB     r0,[sp,#0]            ;2039
00208e  2841              CMP      r0,#0x41              ;2039
002090  d10b              BNE      |L1.8362|
002092  f89d0001          LDRB     r0,[sp,#1]            ;2039
002096  2841              CMP      r0,#0x41              ;2039
002098  d107              BNE      |L1.8362|
00209a  f89d0002          LDRB     r0,[sp,#2]            ;2039
00209e  2841              CMP      r0,#0x41              ;2039
0020a0  d103              BNE      |L1.8362|
0020a2  f89d0003          LDRB     r0,[sp,#3]            ;2039
0020a6  2841              CMP      r0,#0x41              ;2039
0020a8  d00a              BEQ      |L1.8384|
                  |L1.8362|
0020aa  b114              CBZ      r4,|L1.8370|
0020ac  f1a40401          SUB      r4,r4,#1              ;2041
0020b0  e001              B        |L1.8374|
                  |L1.8370|
0020b2  f04f043f          MOV      r4,#0x3f              ;2042
                  |L1.8374|
0020b6  42b4              CMP      r4,r6                 ;2043
0020b8  d102              BNE      |L1.8384|
0020ba  f04f0500          MOV      r5,#0                 ;2045
0020be  e005              B        |L1.8396|
                  |L1.8384|
0020c0  f1070701          ADD      r7,r7,#1              ;2019
0020c4  b2ff              UXTB     r7,r7                 ;2019
0020c6  2f3f              CMP      r7,#0x3f              ;2019
0020c8  f4ffae72          BCC      |L1.7600|
                  |L1.8396|
0020cc  2d00              CMP      r5,#0                 ;2052
0020ce  d0c7              BEQ      |L1.8288|
0020d0  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2054
0020d4  f88d0000          STRB     r0,[sp,#0]            ;2054
0020d8  f8980038          LDRB     r0,[r8,#0x38]         ;2055
0020dc  f88d0001          STRB     r0,[sp,#1]            ;2055
0020e0  f898002c          LDRB     r0,[r8,#0x2c]         ;2056
0020e4  f88d0002          STRB     r0,[sp,#2]            ;2056
0020e8  f88d9003          STRB     r9,[sp,#3]            ;2057
0020ec  4669              MOV      r1,sp                 ;2058
0020ee  f1050010          ADD      r0,r5,#0x10           ;2058
0020f2  f7fffffe          BL       lc640_write_long_ptr
0020f6  f8980028          LDRB     r0,[r8,#0x28]         ;2060
0020fa  f88d0000          STRB     r0,[sp,#0]            ;2060
0020fe  f8980024          LDRB     r0,[r8,#0x24]         ;2061
002102  f88d0001          STRB     r0,[sp,#1]            ;2061
002106  f8980020          LDRB     r0,[r8,#0x20]         ;2062
00210a  f88d0002          STRB     r0,[sp,#2]            ;2062
00210e  f88d9003          STRB     r9,[sp,#3]            ;2063
002112  4669              MOV      r1,sp                 ;2064
002114  f1050014          ADD      r0,r5,#0x14           ;2064
002118  f7fffffe          BL       lc640_write_long_ptr
00211c  f04f0442          MOV      r4,#0x42              ;2066
002120  f88d4000          STRB     r4,[sp,#0]            ;2066
002124  f88d4001          STRB     r4,[sp,#1]            ;2067
002128  f88d4002          STRB     r4,[sp,#2]            ;2068
00212c  f88d4003          STRB     r4,[sp,#3]            ;2069
002130  4669              MOV      r1,sp                 ;2070
002132  f1050018          ADD      r0,r5,#0x18           ;2070
002136  f7fffffe          BL       lc640_write_long_ptr
00213a  f88d4000          STRB     r4,[sp,#0]            ;2072
00213e  f88d4001          STRB     r4,[sp,#1]            ;2073
002142  f88d4002          STRB     r4,[sp,#2]            ;2074
002146  f88d4003          STRB     r4,[sp,#3]            ;2075
00214a  4669              MOV      r1,sp                 ;2076
00214c  f105001c          ADD      r0,r5,#0x1c           ;2076
002150  f7fffffe          BL       lc640_write_long_ptr
002154  e463              B        |L1.6686|
;;;2080     
                          ENDP

                  uz_mem_hndl PROC
;;;2082   //-----------------------------------------------
;;;2083   void uz_mem_hndl(unsigned short in)	 //   
002156  e92d4ff8          PUSH     {r3-r11,lr}
;;;2084   {
;;;2085   char data[4];
;;;2086   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
00215a  f04f0600          MOV      r6,#0
00215e  4634              MOV      r4,r6
;;;2087   //char avar_simbol;
;;;2088   
;;;2089   if(in==1) //  
;;;2090   	{
;;;2091   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2092   	event_ptr++;	
;;;2093   	if(event_ptr>63)event_ptr=0;	
;;;2094   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2095   	
;;;2096       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2097   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2098   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2099   	
;;;2100   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2101   	
;;;2102   	data[0]='u';
;;;2103   	data[1]=0; 
;;;2104   	data[2]='Z';
;;;2105   	data[3]=0;
;;;2106   	lc640_write_long_ptr(lc640_adr,data);
;;;2107   
;;;2108   	data[0]=0;
;;;2109   	data[1]=0;
;;;2110   	data[2]=0;
;;;2111   	data[3]=0;
;;;2112   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2113   
;;;2114   	data[0]=LPC_RTC->YEAR;
002160  f8df86c4          LDR      r8,|L1.10280|
002164  46a1              MOV      r9,r4                 ;2086
002166  f44f6a80          MOV      r10,#0x400            ;2100
00216a  2801              CMP      r0,#1                 ;2089
00216c  d010              BEQ      |L1.8592|
;;;2115   	data[1]=LPC_RTC->MONTH;
;;;2116   	data[2]=LPC_RTC->DOM;
;;;2117   	data[3]=0;
;;;2118   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2119   
;;;2120   	data[0]=LPC_RTC->HOUR;
;;;2121   	data[1]=LPC_RTC->MIN;
;;;2122   	data[2]=LPC_RTC->SEC;
;;;2123   	data[3]=0;
;;;2124   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2125   	
;;;2126   	data[0]='A';
;;;2127   	data[1]='A';
;;;2128   	data[2]='A';
;;;2129   	data[3]='A';
;;;2130   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2131   	
;;;2132   	data[0]='A';
;;;2133   	data[1]='A';
;;;2134   	data[2]='A';
;;;2135   	data[3]='A';
;;;2136   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2137   	
;;;2138   	data[0]='A';
;;;2139   	data[1]='A';
;;;2140   	data[2]='A';
;;;2141   	data[3]='A';
;;;2142   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2143   	
;;;2144   	data[0]='A';
;;;2145   	data[1]='A';
;;;2146   	data[2]='A';
;;;2147   	data[3]='A';
;;;2148   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2149    	
;;;2150   	}
;;;2151   
;;;2152   else if(in==0)	// 
00216e  2800              CMP      r0,#0
002170  d07d              BEQ      |L1.8814|
;;;2153   	{      
;;;2154   	char i;     
;;;2155   	event_ptr_find=0;
;;;2156   	for (i=0;i<63;i++)
;;;2157   		{
;;;2158   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2159   
;;;2160        	lc640_read_long_ptr(lc640_adr,data);
;;;2161        
;;;2162        	if(!((data[0]=='u')&&(data[2]=='Z')))
;;;2163        		{        
;;;2164        		if(event_ptr_find)event_ptr_find--;
;;;2165        		else event_ptr_find=63;
;;;2166        		if(event_ptr_find==event_ptr)
;;;2167   				{
;;;2168   				lc640_adr=0;
;;;2169   				break;
;;;2170   				}
;;;2171        		else continue;
;;;2172        		}
;;;2173        	else 
;;;2174        		{
;;;2175        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2176        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2177        			{        
;;;2178        			if(event_ptr_find)event_ptr_find--;
;;;2179            		else event_ptr_find=63;
;;;2180            		if(event_ptr_find==event_ptr)
;;;2181   					{
;;;2182   					lc640_adr=0;
;;;2183   					break;
;;;2184   					}
;;;2185        			else continue;
;;;2186        			}
;;;2187        		}	
;;;2188   		}
;;;2189   	if(lc640_adr!=0)
;;;2190   		{
;;;2191   		data[0]=LPC_RTC->YEAR;
;;;2192   		data[1]=LPC_RTC->MONTH;
;;;2193   		data[2]=LPC_RTC->DOM;
;;;2194   		data[3]=0;
;;;2195   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2196   	
;;;2197   		data[0]=LPC_RTC->HOUR;
;;;2198   		data[1]=LPC_RTC->MIN;
;;;2199   		data[2]=LPC_RTC->SEC;
;;;2200   		data[3]=0;
;;;2201   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2202   		
;;;2203   		data[0]='C';
;;;2204   		data[1]='C';
;;;2205   		data[2]='C';
;;;2206   		data[3]='C';
;;;2207   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2208   		
;;;2209   		data[0]='C';
;;;2210   		data[1]='C';
;;;2211   		data[2]='C';
;;;2212   		data[3]='C';
;;;2213   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2214   		}
;;;2215   	}
;;;2216   else if(in==10) 	//  
002172  280a              CMP      r0,#0xa
002174  d17c              BNE      |L1.8816|
;;;2217   	{      
;;;2218   	char i;     
;;;2219   
;;;2220   	event_ptr_find=0;
;;;2221   	for (i=0;i<63;i++)
002176  f04f0700          MOV      r7,#0
                  |L1.8570|
;;;2222   		{
;;;2223   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
00217a  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2224   
;;;2225        	lc640_read_long_ptr(lc640_adr,data);
00217e  4669              MOV      r1,sp
002180  4628              MOV      r0,r5
002182  f7fffffe          BL       lc640_read_long_ptr
;;;2226        
;;;2227        	if(!((data[0]=='u')&&(data[2]=='Z')))
002186  f89d0000          LDRB     r0,[sp,#0]
00218a  2875              CMP      r0,#0x75
00218c  d171              BNE      |L1.8818|
00218e  e11c              B        |L1.9162|
                  |L1.8592|
002190  f44f6560          MOV      r5,#0xe00             ;2091
002194  4628              MOV      r0,r5                 ;2091
002196  f7fffffe          BL       lc640_read_int
00219a  f1000001          ADD      r0,r0,#1              ;2092
00219e  4604              MOV      r4,r0                 ;2092
0021a0  2c3f              CMP      r4,#0x3f              ;2093
0021a2  d901              BLS      |L1.8616|
0021a4  f04f0400          MOV      r4,#0                 ;2093
                  |L1.8616|
0021a8  b221              SXTH     r1,r4                 ;2094
0021aa  4628              MOV      r0,r5                 ;2094
0021ac  f7fffffe          BL       lc640_write_int
0021b0  f6406602          MOV      r6,#0xe02             ;2096
0021b4  4630              MOV      r0,r6                 ;2096
0021b6  f7fffffe          BL       lc640_read_int
0021ba  283f              CMP      r0,#0x3f              ;2097
0021bc  d000              BEQ      |L1.8640|
0021be  4620              MOV      r0,r4                 ;2097
                  |L1.8640|
0021c0  b201              SXTH     r1,r0                 ;2098
0021c2  4630              MOV      r0,r6                 ;2098
0021c4  f7fffffe          BL       lc640_write_int
0021c8  4628              MOV      r0,r5                 ;2100
0021ca  f7fffffe          BL       lc640_read_int
0021ce  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2100
0021d2  f04f0075          MOV      r0,#0x75              ;2102
0021d6  f88d0000          STRB     r0,[sp,#0]            ;2102
0021da  f88d9001          STRB     r9,[sp,#1]            ;2103
0021de  f04f005a          MOV      r0,#0x5a              ;2104
0021e2  f88d0002          STRB     r0,[sp,#2]            ;2104
0021e6  f88d9003          STRB     r9,[sp,#3]            ;2105
0021ea  4669              MOV      r1,sp                 ;2106
0021ec  4620              MOV      r0,r4                 ;2106
0021ee  f7fffffe          BL       lc640_write_long_ptr
0021f2  f8cd9000          STR      r9,[sp,#0]            ;2111
0021f6  4669              MOV      r1,sp                 ;2112
0021f8  1d20              ADDS     r0,r4,#4              ;2112
0021fa  f7fffffe          BL       lc640_write_long_ptr
0021fe  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2114
002202  f88d0000          STRB     r0,[sp,#0]            ;2114
002206  f8980038          LDRB     r0,[r8,#0x38]         ;2115
00220a  f88d0001          STRB     r0,[sp,#1]            ;2115
00220e  f898002c          LDRB     r0,[r8,#0x2c]         ;2116
002212  f88d0002          STRB     r0,[sp,#2]            ;2116
002216  f88d9003          STRB     r9,[sp,#3]            ;2117
00221a  4669              MOV      r1,sp                 ;2118
00221c  f1040008          ADD      r0,r4,#8              ;2118
002220  f7fffffe          BL       lc640_write_long_ptr
002224  f8980028          LDRB     r0,[r8,#0x28]         ;2120
002228  f88d0000          STRB     r0,[sp,#0]            ;2120
00222c  f8980024          LDRB     r0,[r8,#0x24]         ;2121
002230  f88d0001          STRB     r0,[sp,#1]            ;2121
002234  f8980020          LDRB     r0,[r8,#0x20]         ;2122
002238  f88d0002          STRB     r0,[sp,#2]            ;2122
00223c  f88d9003          STRB     r9,[sp,#3]            ;2123
002240  4669              MOV      r1,sp                 ;2124
002242  f104000c          ADD      r0,r4,#0xc            ;2124
002246  f7fffffe          BL       lc640_write_long_ptr
00224a  f04f0541          MOV      r5,#0x41              ;2126
00224e  f88d5000          STRB     r5,[sp,#0]            ;2126
002252  f88d5001          STRB     r5,[sp,#1]            ;2127
002256  f88d5002          STRB     r5,[sp,#2]            ;2128
00225a  f88d5003          STRB     r5,[sp,#3]            ;2129
00225e  4669              MOV      r1,sp                 ;2130
002260  f1040010          ADD      r0,r4,#0x10           ;2130
002264  f7fffffe          BL       lc640_write_long_ptr
002268  f88d5000          STRB     r5,[sp,#0]            ;2132
00226c  e002              B        |L1.8820|
                  |L1.8814|
00226e  e027              B        |L1.8896|
                  |L1.8816|
002270  e025              B        |L1.8894|
                  |L1.8818|
002272  e0ae              B        |L1.9170|
                  |L1.8820|
002274  f88d5001          STRB     r5,[sp,#1]            ;2133
002278  f88d5002          STRB     r5,[sp,#2]            ;2134
00227c  f88d5003          STRB     r5,[sp,#3]            ;2135
002280  4669              MOV      r1,sp                 ;2136
002282  f1040014          ADD      r0,r4,#0x14           ;2136
002286  f7fffffe          BL       lc640_write_long_ptr
00228a  f88d5000          STRB     r5,[sp,#0]            ;2138
00228e  f88d5001          STRB     r5,[sp,#1]            ;2139
002292  f88d5002          STRB     r5,[sp,#2]            ;2140
002296  f88d5003          STRB     r5,[sp,#3]            ;2141
00229a  4669              MOV      r1,sp                 ;2142
00229c  f1040018          ADD      r0,r4,#0x18           ;2142
0022a0  f7fffffe          BL       lc640_write_long_ptr
0022a4  f88d5000          STRB     r5,[sp,#0]            ;2144
0022a8  f88d5001          STRB     r5,[sp,#1]            ;2145
0022ac  f88d5002          STRB     r5,[sp,#2]            ;2146
0022b0  f88d5003          STRB     r5,[sp,#3]            ;2147
0022b4  4669              MOV      r1,sp                 ;2148
0022b6  f104001c          ADD      r0,r4,#0x1c           ;2148
0022ba  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8894|
;;;2228        		{        
;;;2229        		if(event_ptr_find)event_ptr_find--;
;;;2230        		else event_ptr_find=63;
;;;2231        		if(event_ptr_find==event_ptr)
;;;2232   				{
;;;2233   				lc640_adr=0;
;;;2234   				break;
;;;2235   				}
;;;2236        		else continue;
;;;2237        		}
;;;2238        	else 
;;;2239        		{
;;;2240        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2241        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2242        			{        
;;;2243        			if(event_ptr_find)event_ptr_find--;
;;;2244            		else event_ptr_find=63;
;;;2245            		if(event_ptr_find==event_ptr)
;;;2246   					{
;;;2247   					lc640_adr=0;
;;;2248   					break;
;;;2249   					}
;;;2250        			else continue;
;;;2251        			}
;;;2252        		}	
;;;2253   		}
;;;2254   	if(lc640_adr!=0)
;;;2255   		{
;;;2256   		data[0]=LPC_RTC->YEAR;
;;;2257   		data[1]=LPC_RTC->MONTH;
;;;2258   		data[2]=LPC_RTC->DOM;
;;;2259   		data[3]=0;
;;;2260   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2261   	
;;;2262   		data[0]=LPC_RTC->HOUR;
;;;2263   		data[1]=LPC_RTC->MIN;
;;;2264   		data[2]=LPC_RTC->SEC;
;;;2265   		data[3]=0;
;;;2266   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2267   		
;;;2268   		data[0]='B';
;;;2269   		data[1]='B';
;;;2270   		data[2]='B';
;;;2271   		data[3]='B';
;;;2272   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2273   		
;;;2274   		data[0]='B';
;;;2275   		data[1]='B';
;;;2276   		data[2]='B';
;;;2277   		data[3]='B';
;;;2278   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2279   		}
;;;2280   	}
;;;2281   }
0022be  e561              B        |L1.7556|
                  |L1.8896|
0022c0  f04f0700          MOV      r7,#0                 ;2156
                  |L1.8900|
0022c4  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2158
0022c8  4669              MOV      r1,sp                 ;2160
0022ca  4628              MOV      r0,r5                 ;2160
0022cc  f7fffffe          BL       lc640_read_long_ptr
0022d0  f89d0000          LDRB     r0,[sp,#0]            ;2162
0022d4  2875              CMP      r0,#0x75              ;2162
0022d6  d103              BNE      |L1.8928|
0022d8  f89d0002          LDRB     r0,[sp,#2]            ;2162
0022dc  285a              CMP      r0,#0x5a              ;2162
0022de  d00a              BEQ      |L1.8950|
                  |L1.8928|
0022e0  b114              CBZ      r4,|L1.8936|
0022e2  f1a40401          SUB      r4,r4,#1              ;2164
0022e6  e001              B        |L1.8940|
                  |L1.8936|
0022e8  f04f043f          MOV      r4,#0x3f              ;2165
                  |L1.8940|
0022ec  42b4              CMP      r4,r6                 ;2166
0022ee  d122              BNE      |L1.9014|
0022f0  f04f0500          MOV      r5,#0                 ;2168
0022f4  e024              B        |L1.9024|
                  |L1.8950|
0022f6  4669              MOV      r1,sp                 ;2175
0022f8  f1050010          ADD      r0,r5,#0x10           ;2175
0022fc  f7fffffe          BL       lc640_read_long_ptr
002300  f89d0000          LDRB     r0,[sp,#0]            ;2176
002304  2841              CMP      r0,#0x41              ;2176
002306  d10b              BNE      |L1.8992|
002308  f89d0001          LDRB     r0,[sp,#1]            ;2176
00230c  2841              CMP      r0,#0x41              ;2176
00230e  d107              BNE      |L1.8992|
002310  f89d0002          LDRB     r0,[sp,#2]            ;2176
002314  2841              CMP      r0,#0x41              ;2176
002316  d103              BNE      |L1.8992|
002318  f89d0003          LDRB     r0,[sp,#3]            ;2176
00231c  2841              CMP      r0,#0x41              ;2176
00231e  d00a              BEQ      |L1.9014|
                  |L1.8992|
002320  b114              CBZ      r4,|L1.9000|
002322  f1a40401          SUB      r4,r4,#1              ;2178
002326  e001              B        |L1.9004|
                  |L1.9000|
002328  f04f043f          MOV      r4,#0x3f              ;2179
                  |L1.9004|
00232c  42b4              CMP      r4,r6                 ;2180
00232e  d102              BNE      |L1.9014|
002330  f04f0500          MOV      r5,#0                 ;2182
002334  e004              B        |L1.9024|
                  |L1.9014|
002336  f1070701          ADD      r7,r7,#1              ;2156
00233a  b2ff              UXTB     r7,r7                 ;2156
00233c  2f3f              CMP      r7,#0x3f              ;2156
00233e  d3c1              BCC      |L1.8900|
                  |L1.9024|
002340  2d00              CMP      r5,#0                 ;2189
002342  d0bc              BEQ      |L1.8894|
002344  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2191
002348  f88d0000          STRB     r0,[sp,#0]            ;2191
00234c  f8980038          LDRB     r0,[r8,#0x38]         ;2192
002350  f88d0001          STRB     r0,[sp,#1]            ;2192
002354  f898002c          LDRB     r0,[r8,#0x2c]         ;2193
002358  f88d0002          STRB     r0,[sp,#2]            ;2193
00235c  f88d9003          STRB     r9,[sp,#3]            ;2194
002360  4669              MOV      r1,sp                 ;2195
002362  f1050010          ADD      r0,r5,#0x10           ;2195
002366  f7fffffe          BL       lc640_write_long_ptr
00236a  f8980028          LDRB     r0,[r8,#0x28]         ;2197
00236e  f88d0000          STRB     r0,[sp,#0]            ;2197
002372  f8980024          LDRB     r0,[r8,#0x24]         ;2198
002376  f88d0001          STRB     r0,[sp,#1]            ;2198
00237a  f8980020          LDRB     r0,[r8,#0x20]         ;2199
00237e  f88d0002          STRB     r0,[sp,#2]            ;2199
002382  f88d9003          STRB     r9,[sp,#3]            ;2200
002386  4669              MOV      r1,sp                 ;2201
002388  f1050014          ADD      r0,r5,#0x14           ;2201
00238c  f7fffffe          BL       lc640_write_long_ptr
002390  f04f0443          MOV      r4,#0x43              ;2203
002394  f88d4000          STRB     r4,[sp,#0]            ;2203
002398  f88d4001          STRB     r4,[sp,#1]            ;2204
00239c  f88d4002          STRB     r4,[sp,#2]            ;2205
0023a0  f88d4003          STRB     r4,[sp,#3]            ;2206
0023a4  4669              MOV      r1,sp                 ;2207
0023a6  f1050018          ADD      r0,r5,#0x18           ;2207
0023aa  f7fffffe          BL       lc640_write_long_ptr
0023ae  f88d4000          STRB     r4,[sp,#0]            ;2209
0023b2  f88d4001          STRB     r4,[sp,#1]            ;2210
0023b6  f88d4002          STRB     r4,[sp,#2]            ;2211
0023ba  f88d4003          STRB     r4,[sp,#3]            ;2212
0023be  4669              MOV      r1,sp                 ;2213
0023c0  f105001c          ADD      r0,r5,#0x1c           ;2213
0023c4  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9160|
0023c8  e4dc              B        |L1.7556|
                  |L1.9162|
0023ca  f89d0002          LDRB     r0,[sp,#2]            ;2227
0023ce  285a              CMP      r0,#0x5a              ;2227
0023d0  d00a              BEQ      |L1.9192|
                  |L1.9170|
0023d2  b114              CBZ      r4,|L1.9178|
0023d4  f1a40401          SUB      r4,r4,#1              ;2229
0023d8  e001              B        |L1.9182|
                  |L1.9178|
0023da  f04f043f          MOV      r4,#0x3f              ;2230
                  |L1.9182|
0023de  42b4              CMP      r4,r6                 ;2231
0023e0  d122              BNE      |L1.9256|
0023e2  f04f0500          MOV      r5,#0                 ;2233
0023e6  e025              B        |L1.9268|
                  |L1.9192|
0023e8  4669              MOV      r1,sp                 ;2240
0023ea  f1050010          ADD      r0,r5,#0x10           ;2240
0023ee  f7fffffe          BL       lc640_read_long_ptr
0023f2  f89d0000          LDRB     r0,[sp,#0]            ;2241
0023f6  2841              CMP      r0,#0x41              ;2241
0023f8  d10b              BNE      |L1.9234|
0023fa  f89d0001          LDRB     r0,[sp,#1]            ;2241
0023fe  2841              CMP      r0,#0x41              ;2241
002400  d107              BNE      |L1.9234|
002402  f89d0002          LDRB     r0,[sp,#2]            ;2241
002406  2841              CMP      r0,#0x41              ;2241
002408  d103              BNE      |L1.9234|
00240a  f89d0003          LDRB     r0,[sp,#3]            ;2241
00240e  2841              CMP      r0,#0x41              ;2241
002410  d00a              BEQ      |L1.9256|
                  |L1.9234|
002412  b114              CBZ      r4,|L1.9242|
002414  f1a40401          SUB      r4,r4,#1              ;2243
002418  e001              B        |L1.9246|
                  |L1.9242|
00241a  f04f043f          MOV      r4,#0x3f              ;2244
                  |L1.9246|
00241e  42b4              CMP      r4,r6                 ;2245
002420  d102              BNE      |L1.9256|
002422  f04f0500          MOV      r5,#0                 ;2247
002426  e005              B        |L1.9268|
                  |L1.9256|
002428  f1070701          ADD      r7,r7,#1              ;2221
00242c  b2ff              UXTB     r7,r7                 ;2221
00242e  2f3f              CMP      r7,#0x3f              ;2221
002430  f4ffaea3          BCC      |L1.8570|
                  |L1.9268|
002434  2d00              CMP      r5,#0                 ;2254
002436  d0c7              BEQ      |L1.9160|
002438  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2256
00243c  f88d0000          STRB     r0,[sp,#0]            ;2256
002440  f8980038          LDRB     r0,[r8,#0x38]         ;2257
002444  f88d0001          STRB     r0,[sp,#1]            ;2257
002448  f898002c          LDRB     r0,[r8,#0x2c]         ;2258
00244c  f88d0002          STRB     r0,[sp,#2]            ;2258
002450  f88d9003          STRB     r9,[sp,#3]            ;2259
002454  4669              MOV      r1,sp                 ;2260
002456  f1050010          ADD      r0,r5,#0x10           ;2260
00245a  f7fffffe          BL       lc640_write_long_ptr
00245e  f8980028          LDRB     r0,[r8,#0x28]         ;2262
002462  f88d0000          STRB     r0,[sp,#0]            ;2262
002466  f8980024          LDRB     r0,[r8,#0x24]         ;2263
00246a  f88d0001          STRB     r0,[sp,#1]            ;2263
00246e  f8980020          LDRB     r0,[r8,#0x20]         ;2264
002472  f88d0002          STRB     r0,[sp,#2]            ;2264
002476  f88d9003          STRB     r9,[sp,#3]            ;2265
00247a  4669              MOV      r1,sp                 ;2266
00247c  f1050014          ADD      r0,r5,#0x14           ;2266
002480  f7fffffe          BL       lc640_write_long_ptr
002484  f04f0442          MOV      r4,#0x42              ;2268
002488  f88d4000          STRB     r4,[sp,#0]            ;2268
00248c  f88d4001          STRB     r4,[sp,#1]            ;2269
002490  f88d4002          STRB     r4,[sp,#2]            ;2270
002494  f88d4003          STRB     r4,[sp,#3]            ;2271
002498  4669              MOV      r1,sp                 ;2272
00249a  f1050018          ADD      r0,r5,#0x18           ;2272
00249e  f7fffffe          BL       lc640_write_long_ptr
0024a2  f88d4000          STRB     r4,[sp,#0]            ;2274
0024a6  f88d4001          STRB     r4,[sp,#1]            ;2275
0024aa  f88d4002          STRB     r4,[sp,#2]            ;2276
0024ae  f88d4003          STRB     r4,[sp,#3]            ;2277
0024b2  4669              MOV      r1,sp                 ;2278
0024b4  f105001c          ADD      r0,r5,#0x1c           ;2278
0024b8  f7fffffe          BL       lc640_write_long_ptr
0024bc  e462              B        |L1.7556|
;;;2282   
                          ENDP

                  fz_mem_hndl PROC
;;;2283   //-----------------------------------------------
;;;2284   void fz_mem_hndl(unsigned short in)	 //   
0024be  e92d4ff8          PUSH     {r3-r11,lr}
;;;2285   {
;;;2286   char data[4];
;;;2287   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
0024c2  f04f0600          MOV      r6,#0
0024c6  4634              MOV      r4,r6
;;;2288   //char avar_simbol;
;;;2289   
;;;2290   if(in==1) //  
;;;2291   	{
;;;2292   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2293   	event_ptr++;	
;;;2294   	if(event_ptr>63)event_ptr=0;	
;;;2295   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2296   	
;;;2297       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2298   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2299   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2300   	
;;;2301   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2302   	
;;;2303   	data[0]='f';
;;;2304   	data[1]=0; 
;;;2305   	data[2]='Z';
;;;2306   	data[3]=0;
;;;2307   	lc640_write_long_ptr(lc640_adr,data);
;;;2308   
;;;2309   	data[0]=0;
;;;2310   	data[1]=0;
;;;2311   	data[2]=0;
;;;2312   	data[3]=0;
;;;2313   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2314   
;;;2315   	data[0]=LPC_RTC->YEAR;
0024c8  f8df835c          LDR      r8,|L1.10280|
0024cc  46a1              MOV      r9,r4                 ;2287
0024ce  f44f6a80          MOV      r10,#0x400            ;2301
0024d2  2801              CMP      r0,#1                 ;2290
0024d4  d010              BEQ      |L1.9464|
;;;2316   	data[1]=LPC_RTC->MONTH;
;;;2317   	data[2]=LPC_RTC->DOM;
;;;2318   	data[3]=0;
;;;2319   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2320   
;;;2321   	data[0]=LPC_RTC->HOUR;
;;;2322   	data[1]=LPC_RTC->MIN;
;;;2323   	data[2]=LPC_RTC->SEC;
;;;2324   	data[3]=0;
;;;2325   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2326   	
;;;2327   	data[0]='A';
;;;2328   	data[1]='A';
;;;2329   	data[2]='A';
;;;2330   	data[3]='A';
;;;2331   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2332   	
;;;2333   	data[0]='A';
;;;2334   	data[1]='A';
;;;2335   	data[2]='A';
;;;2336   	data[3]='A';
;;;2337   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2338   	
;;;2339   	data[0]='A';
;;;2340   	data[1]='A';
;;;2341   	data[2]='A';
;;;2342   	data[3]='A';
;;;2343   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2344   	
;;;2345   	data[0]='A';
;;;2346   	data[1]='A';
;;;2347   	data[2]='A';
;;;2348   	data[3]='A';
;;;2349   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2350    	
;;;2351   	}
;;;2352   
;;;2353   else if(in==0)	// 
0024d6  2800              CMP      r0,#0
0024d8  d07d              BEQ      |L1.9686|
;;;2354   	{      
;;;2355   	char i;     
;;;2356   	event_ptr_find=0;
;;;2357   	for (i=0;i<63;i++)
;;;2358   		{
;;;2359   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2360   
;;;2361        	lc640_read_long_ptr(lc640_adr,data);
;;;2362        
;;;2363        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;2364        		{        
;;;2365        		if(event_ptr_find)event_ptr_find--;
;;;2366        		else event_ptr_find=63;
;;;2367        		if(event_ptr_find==event_ptr)
;;;2368   				{
;;;2369   				lc640_adr=0;
;;;2370   				break;
;;;2371   				}
;;;2372        		else continue;
;;;2373        		}
;;;2374        	else 
;;;2375        		{
;;;2376        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2377        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2378        			{        
;;;2379        			if(event_ptr_find)event_ptr_find--;
;;;2380            		else event_ptr_find=63;
;;;2381            		if(event_ptr_find==event_ptr)
;;;2382   					{
;;;2383   					lc640_adr=0;
;;;2384   					break;
;;;2385   					}
;;;2386        			else continue;
;;;2387        			}
;;;2388        		}	
;;;2389   		}
;;;2390   	if(lc640_adr!=0)
;;;2391   		{
;;;2392   		data[0]=LPC_RTC->YEAR;
;;;2393   		data[1]=LPC_RTC->MONTH;
;;;2394   		data[2]=LPC_RTC->DOM;
;;;2395   		data[3]=0;
;;;2396   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2397   	
;;;2398   		data[0]=LPC_RTC->HOUR;
;;;2399   		data[1]=LPC_RTC->MIN;
;;;2400   		data[2]=LPC_RTC->SEC;
;;;2401   		data[3]=0;
;;;2402   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2403   		
;;;2404   		data[0]='C';
;;;2405   		data[1]='C';
;;;2406   		data[2]='C';
;;;2407   		data[3]='C';
;;;2408   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2409   		
;;;2410   		data[0]='C';
;;;2411   		data[1]='C';
;;;2412   		data[2]='C';
;;;2413   		data[3]='C';
;;;2414   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2415   		}
;;;2416   	}
;;;2417   else if(in==10) 	//  
0024da  280a              CMP      r0,#0xa
0024dc  d17c              BNE      |L1.9688|
;;;2418   	{      
;;;2419   	char i;     
;;;2420   
;;;2421   	event_ptr_find=0;
;;;2422   	for (i=0;i<63;i++)
0024de  f04f0700          MOV      r7,#0
                  |L1.9442|
;;;2423   		{
;;;2424   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
0024e2  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2425   
;;;2426        	lc640_read_long_ptr(lc640_adr,data);
0024e6  4669              MOV      r1,sp
0024e8  4628              MOV      r0,r5
0024ea  f7fffffe          BL       lc640_read_long_ptr
;;;2427        
;;;2428        	if(!((data[0]=='f')&&(data[2]=='Z')))
0024ee  f89d0000          LDRB     r0,[sp,#0]
0024f2  2866              CMP      r0,#0x66
0024f4  d171              BNE      |L1.9690|
0024f6  e11c              B        |L1.10034|
                  |L1.9464|
0024f8  f44f6560          MOV      r5,#0xe00             ;2292
0024fc  4628              MOV      r0,r5                 ;2292
0024fe  f7fffffe          BL       lc640_read_int
002502  f1000001          ADD      r0,r0,#1              ;2293
002506  4604              MOV      r4,r0                 ;2293
002508  2c3f              CMP      r4,#0x3f              ;2294
00250a  d901              BLS      |L1.9488|
00250c  f04f0400          MOV      r4,#0                 ;2294
                  |L1.9488|
002510  b221              SXTH     r1,r4                 ;2295
002512  4628              MOV      r0,r5                 ;2295
002514  f7fffffe          BL       lc640_write_int
002518  f6406602          MOV      r6,#0xe02             ;2297
00251c  4630              MOV      r0,r6                 ;2297
00251e  f7fffffe          BL       lc640_read_int
002522  283f              CMP      r0,#0x3f              ;2298
002524  d000              BEQ      |L1.9512|
002526  4620              MOV      r0,r4                 ;2298
                  |L1.9512|
002528  b201              SXTH     r1,r0                 ;2299
00252a  4630              MOV      r0,r6                 ;2299
00252c  f7fffffe          BL       lc640_write_int
002530  4628              MOV      r0,r5                 ;2301
002532  f7fffffe          BL       lc640_read_int
002536  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2301
00253a  f04f0066          MOV      r0,#0x66              ;2303
00253e  f88d0000          STRB     r0,[sp,#0]            ;2303
002542  f88d9001          STRB     r9,[sp,#1]            ;2304
002546  f04f005a          MOV      r0,#0x5a              ;2305
00254a  f88d0002          STRB     r0,[sp,#2]            ;2305
00254e  f88d9003          STRB     r9,[sp,#3]            ;2306
002552  4669              MOV      r1,sp                 ;2307
002554  4620              MOV      r0,r4                 ;2307
002556  f7fffffe          BL       lc640_write_long_ptr
00255a  f8cd9000          STR      r9,[sp,#0]            ;2312
00255e  4669              MOV      r1,sp                 ;2313
002560  1d20              ADDS     r0,r4,#4              ;2313
002562  f7fffffe          BL       lc640_write_long_ptr
002566  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2315
00256a  f88d0000          STRB     r0,[sp,#0]            ;2315
00256e  f8980038          LDRB     r0,[r8,#0x38]         ;2316
002572  f88d0001          STRB     r0,[sp,#1]            ;2316
002576  f898002c          LDRB     r0,[r8,#0x2c]         ;2317
00257a  f88d0002          STRB     r0,[sp,#2]            ;2317
00257e  f88d9003          STRB     r9,[sp,#3]            ;2318
002582  4669              MOV      r1,sp                 ;2319
002584  f1040008          ADD      r0,r4,#8              ;2319
002588  f7fffffe          BL       lc640_write_long_ptr
00258c  f8980028          LDRB     r0,[r8,#0x28]         ;2321
002590  f88d0000          STRB     r0,[sp,#0]            ;2321
002594  f8980024          LDRB     r0,[r8,#0x24]         ;2322
002598  f88d0001          STRB     r0,[sp,#1]            ;2322
00259c  f8980020          LDRB     r0,[r8,#0x20]         ;2323
0025a0  f88d0002          STRB     r0,[sp,#2]            ;2323
0025a4  f88d9003          STRB     r9,[sp,#3]            ;2324
0025a8  4669              MOV      r1,sp                 ;2325
0025aa  f104000c          ADD      r0,r4,#0xc            ;2325
0025ae  f7fffffe          BL       lc640_write_long_ptr
0025b2  f04f0541          MOV      r5,#0x41              ;2327
0025b6  f88d5000          STRB     r5,[sp,#0]            ;2327
0025ba  f88d5001          STRB     r5,[sp,#1]            ;2328
0025be  f88d5002          STRB     r5,[sp,#2]            ;2329
0025c2  f88d5003          STRB     r5,[sp,#3]            ;2330
0025c6  4669              MOV      r1,sp                 ;2331
0025c8  f1040010          ADD      r0,r4,#0x10           ;2331
0025cc  f7fffffe          BL       lc640_write_long_ptr
0025d0  f88d5000          STRB     r5,[sp,#0]            ;2333
0025d4  e002              B        |L1.9692|
                  |L1.9686|
0025d6  e027              B        |L1.9768|
                  |L1.9688|
0025d8  e025              B        |L1.9766|
                  |L1.9690|
0025da  e0ae              B        |L1.10042|
                  |L1.9692|
0025dc  f88d5001          STRB     r5,[sp,#1]            ;2334
0025e0  f88d5002          STRB     r5,[sp,#2]            ;2335
0025e4  f88d5003          STRB     r5,[sp,#3]            ;2336
0025e8  4669              MOV      r1,sp                 ;2337
0025ea  f1040014          ADD      r0,r4,#0x14           ;2337
0025ee  f7fffffe          BL       lc640_write_long_ptr
0025f2  f88d5000          STRB     r5,[sp,#0]            ;2339
0025f6  f88d5001          STRB     r5,[sp,#1]            ;2340
0025fa  f88d5002          STRB     r5,[sp,#2]            ;2341
0025fe  f88d5003          STRB     r5,[sp,#3]            ;2342
002602  4669              MOV      r1,sp                 ;2343
002604  f1040018          ADD      r0,r4,#0x18           ;2343
002608  f7fffffe          BL       lc640_write_long_ptr
00260c  f88d5000          STRB     r5,[sp,#0]            ;2345
002610  f88d5001          STRB     r5,[sp,#1]            ;2346
002614  f88d5002          STRB     r5,[sp,#2]            ;2347
002618  f88d5003          STRB     r5,[sp,#3]            ;2348
00261c  4669              MOV      r1,sp                 ;2349
00261e  f104001c          ADD      r0,r4,#0x1c           ;2349
002622  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9766|
;;;2429        		{        
;;;2430        		if(event_ptr_find)event_ptr_find--;
;;;2431        		else event_ptr_find=63;
;;;2432        		if(event_ptr_find==event_ptr)
;;;2433   				{
;;;2434   				lc640_adr=0;
;;;2435   				break;
;;;2436   				}
;;;2437        		else continue;
;;;2438        		}
;;;2439        	else 
;;;2440        		{
;;;2441        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2442        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2443        			{        
;;;2444        			if(event_ptr_find)event_ptr_find--;
;;;2445            		else event_ptr_find=63;
;;;2446            		if(event_ptr_find==event_ptr)
;;;2447   					{
;;;2448   					lc640_adr=0;
;;;2449   					break;
;;;2450   					}
;;;2451        			else continue;
;;;2452        			}
;;;2453        		}	
;;;2454   		}
;;;2455   	if(lc640_adr!=0)
;;;2456   		{
;;;2457   		data[0]=LPC_RTC->YEAR;
;;;2458   		data[1]=LPC_RTC->MONTH;
;;;2459   		data[2]=LPC_RTC->DOM;
;;;2460   		data[3]=0;
;;;2461   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2462   	
;;;2463   		data[0]=LPC_RTC->HOUR;
;;;2464   		data[1]=LPC_RTC->MIN;
;;;2465   		data[2]=LPC_RTC->SEC;
;;;2466   		data[3]=0;
;;;2467   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2468   		
;;;2469   		data[0]='B';
;;;2470   		data[1]='B';
;;;2471   		data[2]='B';
;;;2472   		data[3]='B';
;;;2473   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2474   		
;;;2475   		data[0]='B';
;;;2476   		data[1]='B';
;;;2477   		data[2]='B';
;;;2478   		data[3]='B';
;;;2479   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2480   		}
;;;2481   	}
;;;2482   }
002626  e496              B        |L1.8022|
                  |L1.9768|
002628  f04f0700          MOV      r7,#0                 ;2357
                  |L1.9772|
00262c  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2359
002630  4669              MOV      r1,sp                 ;2361
002632  4628              MOV      r0,r5                 ;2361
002634  f7fffffe          BL       lc640_read_long_ptr
002638  f89d0000          LDRB     r0,[sp,#0]            ;2363
00263c  2866              CMP      r0,#0x66              ;2363
00263e  d103              BNE      |L1.9800|
002640  f89d0002          LDRB     r0,[sp,#2]            ;2363
002644  285a              CMP      r0,#0x5a              ;2363
002646  d00a              BEQ      |L1.9822|
                  |L1.9800|
002648  b114              CBZ      r4,|L1.9808|
00264a  f1a40401          SUB      r4,r4,#1              ;2365
00264e  e001              B        |L1.9812|
                  |L1.9808|
002650  f04f043f          MOV      r4,#0x3f              ;2366
                  |L1.9812|
002654  42b4              CMP      r4,r6                 ;2367
002656  d122              BNE      |L1.9886|
002658  f04f0500          MOV      r5,#0                 ;2369
00265c  e024              B        |L1.9896|
                  |L1.9822|
00265e  4669              MOV      r1,sp                 ;2376
002660  f1050010          ADD      r0,r5,#0x10           ;2376
002664  f7fffffe          BL       lc640_read_long_ptr
002668  f89d0000          LDRB     r0,[sp,#0]            ;2377
00266c  2841              CMP      r0,#0x41              ;2377
00266e  d10b              BNE      |L1.9864|
002670  f89d0001          LDRB     r0,[sp,#1]            ;2377
002674  2841              CMP      r0,#0x41              ;2377
002676  d107              BNE      |L1.9864|
002678  f89d0002          LDRB     r0,[sp,#2]            ;2377
00267c  2841              CMP      r0,#0x41              ;2377
00267e  d103              BNE      |L1.9864|
002680  f89d0003          LDRB     r0,[sp,#3]            ;2377
002684  2841              CMP      r0,#0x41              ;2377
002686  d00a              BEQ      |L1.9886|
                  |L1.9864|
002688  b114              CBZ      r4,|L1.9872|
00268a  f1a40401          SUB      r4,r4,#1              ;2379
00268e  e001              B        |L1.9876|
                  |L1.9872|
002690  f04f043f          MOV      r4,#0x3f              ;2380
                  |L1.9876|
002694  42b4              CMP      r4,r6                 ;2381
002696  d102              BNE      |L1.9886|
002698  f04f0500          MOV      r5,#0                 ;2383
00269c  e004              B        |L1.9896|
                  |L1.9886|
00269e  f1070701          ADD      r7,r7,#1              ;2357
0026a2  b2ff              UXTB     r7,r7                 ;2357
0026a4  2f3f              CMP      r7,#0x3f              ;2357
0026a6  d3c1              BCC      |L1.9772|
                  |L1.9896|
0026a8  2d00              CMP      r5,#0                 ;2390
0026aa  d0bc              BEQ      |L1.9766|
0026ac  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2392
0026b0  f88d0000          STRB     r0,[sp,#0]            ;2392
0026b4  f8980038          LDRB     r0,[r8,#0x38]         ;2393
0026b8  f88d0001          STRB     r0,[sp,#1]            ;2393
0026bc  f898002c          LDRB     r0,[r8,#0x2c]         ;2394
0026c0  f88d0002          STRB     r0,[sp,#2]            ;2394
0026c4  f88d9003          STRB     r9,[sp,#3]            ;2395
0026c8  4669              MOV      r1,sp                 ;2396
0026ca  f1050010          ADD      r0,r5,#0x10           ;2396
0026ce  f7fffffe          BL       lc640_write_long_ptr
0026d2  f8980028          LDRB     r0,[r8,#0x28]         ;2398
0026d6  f88d0000          STRB     r0,[sp,#0]            ;2398
0026da  f8980024          LDRB     r0,[r8,#0x24]         ;2399
0026de  f88d0001          STRB     r0,[sp,#1]            ;2399
0026e2  f8980020          LDRB     r0,[r8,#0x20]         ;2400
0026e6  f88d0002          STRB     r0,[sp,#2]            ;2400
0026ea  f88d9003          STRB     r9,[sp,#3]            ;2401
0026ee  4669              MOV      r1,sp                 ;2402
0026f0  f1050014          ADD      r0,r5,#0x14           ;2402
0026f4  f7fffffe          BL       lc640_write_long_ptr
0026f8  f04f0443          MOV      r4,#0x43              ;2404
0026fc  f88d4000          STRB     r4,[sp,#0]            ;2404
002700  f88d4001          STRB     r4,[sp,#1]            ;2405
002704  f88d4002          STRB     r4,[sp,#2]            ;2406
002708  f88d4003          STRB     r4,[sp,#3]            ;2407
00270c  4669              MOV      r1,sp                 ;2408
00270e  f1050018          ADD      r0,r5,#0x18           ;2408
002712  f7fffffe          BL       lc640_write_long_ptr
002716  f88d4000          STRB     r4,[sp,#0]            ;2410
00271a  f88d4001          STRB     r4,[sp,#1]            ;2411
00271e  f88d4002          STRB     r4,[sp,#2]            ;2412
002722  f88d4003          STRB     r4,[sp,#3]            ;2413
002726  4669              MOV      r1,sp                 ;2414
002728  f105001c          ADD      r0,r5,#0x1c           ;2414
00272c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.10032|
002730  e411              B        |L1.8022|
                  |L1.10034|
002732  f89d0002          LDRB     r0,[sp,#2]            ;2428
002736  285a              CMP      r0,#0x5a              ;2428
002738  d00a              BEQ      |L1.10064|
                  |L1.10042|
00273a  b114              CBZ      r4,|L1.10050|
00273c  f1a40401          SUB      r4,r4,#1              ;2430
002740  e001              B        |L1.10054|
                  |L1.10050|
002742  f04f043f          MOV      r4,#0x3f              ;2431
                  |L1.10054|
002746  42b4              CMP      r4,r6                 ;2432
002748  d122              BNE      |L1.10128|
00274a  f04f0500          MOV      r5,#0                 ;2434
00274e  e025              B        |L1.10140|
                  |L1.10064|
002750  4669              MOV      r1,sp                 ;2441
002752  f1050010          ADD      r0,r5,#0x10           ;2441
002756  f7fffffe          BL       lc640_read_long_ptr
00275a  f89d0000          LDRB     r0,[sp,#0]            ;2442
00275e  2841              CMP      r0,#0x41              ;2442
002760  d10b              BNE      |L1.10106|
002762  f89d0001          LDRB     r0,[sp,#1]            ;2442
002766  2841              CMP      r0,#0x41              ;2442
002768  d107              BNE      |L1.10106|
00276a  f89d0002          LDRB     r0,[sp,#2]            ;2442
00276e  2841              CMP      r0,#0x41              ;2442
002770  d103              BNE      |L1.10106|
002772  f89d0003          LDRB     r0,[sp,#3]            ;2442
002776  2841              CMP      r0,#0x41              ;2442
002778  d00a              BEQ      |L1.10128|
                  |L1.10106|
00277a  b114              CBZ      r4,|L1.10114|
00277c  f1a40401          SUB      r4,r4,#1              ;2444
002780  e001              B        |L1.10118|
                  |L1.10114|
002782  f04f043f          MOV      r4,#0x3f              ;2445
                  |L1.10118|
002786  42b4              CMP      r4,r6                 ;2446
002788  d102              BNE      |L1.10128|
00278a  f04f0500          MOV      r5,#0                 ;2448
00278e  e005              B        |L1.10140|
                  |L1.10128|
002790  f1070701          ADD      r7,r7,#1              ;2422
002794  b2ff              UXTB     r7,r7                 ;2422
002796  2f3f              CMP      r7,#0x3f              ;2422
002798  f4ffaea3          BCC      |L1.9442|
                  |L1.10140|
00279c  2d00              CMP      r5,#0                 ;2455
00279e  d0c7              BEQ      |L1.10032|
0027a0  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2457
0027a4  f88d0000          STRB     r0,[sp,#0]            ;2457
0027a8  f8980038          LDRB     r0,[r8,#0x38]         ;2458
0027ac  f88d0001          STRB     r0,[sp,#1]            ;2458
0027b0  f898002c          LDRB     r0,[r8,#0x2c]         ;2459
0027b4  f88d0002          STRB     r0,[sp,#2]            ;2459
0027b8  f88d9003          STRB     r9,[sp,#3]            ;2460
0027bc  4669              MOV      r1,sp                 ;2461
0027be  f1050010          ADD      r0,r5,#0x10           ;2461
0027c2  f7fffffe          BL       lc640_write_long_ptr
0027c6  f8980028          LDRB     r0,[r8,#0x28]         ;2463
0027ca  f88d0000          STRB     r0,[sp,#0]            ;2463
0027ce  f8980024          LDRB     r0,[r8,#0x24]         ;2464
0027d2  f88d0001          STRB     r0,[sp,#1]            ;2464
0027d6  f8980020          LDRB     r0,[r8,#0x20]         ;2465
0027da  f88d0002          STRB     r0,[sp,#2]            ;2465
0027de  f88d9003          STRB     r9,[sp,#3]            ;2466
0027e2  4669              MOV      r1,sp                 ;2467
0027e4  f1050014          ADD      r0,r5,#0x14           ;2467
0027e8  f7fffffe          BL       lc640_write_long_ptr
0027ec  f04f0442          MOV      r4,#0x42              ;2469
0027f0  f88d4000          STRB     r4,[sp,#0]            ;2469
0027f4  f88d4001          STRB     r4,[sp,#1]            ;2470
0027f8  f88d4002          STRB     r4,[sp,#2]            ;2471
0027fc  f88d4003          STRB     r4,[sp,#3]            ;2472
002800  4669              MOV      r1,sp                 ;2473
002802  f1050018          ADD      r0,r5,#0x18           ;2473
002806  f7fffffe          BL       lc640_write_long_ptr
00280a  f88d4000          STRB     r4,[sp,#0]            ;2475
00280e  f88d4001          STRB     r4,[sp,#1]            ;2476
002812  f88d4002          STRB     r4,[sp,#2]            ;2477
002816  f88d4003          STRB     r4,[sp,#3]            ;2478
00281a  4669              MOV      r1,sp                 ;2479
00281c  f105001c          ADD      r0,r5,#0x1c           ;2479
002820  f7fffffe          BL       lc640_write_long_ptr
002824  e41c              B        |L1.8288|
                          ENDP

002826  0000              DCW      0x0000
                  |L1.10280|
                          DCD      0x40024000

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  ke_mem_hndl PROC
;;;82     //-----------------------------------------------
;;;83     void avar_hndl(void)
000000  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;84     {
;;;85     //static unsigned avar_stat_old;
;;;86     char i;
;;;87     //unsigned avar_stat_new,avar_stat_offed;
;;;88     
;;;89     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  b083              SUB      sp,sp,#0xc
000004  4605              MOV      r5,r0
000006  4948              LDR      r1,|L2.296|
000008  eb050085          ADD      r0,r5,r5,LSL #2
00000c  eb011100          ADD      r1,r1,r0,LSL #4
000010  4846              LDR      r0,|L2.300|
000012  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
;;;90     else	   			SET_REG(avar_stat,0,0,1);
000016  f1000001          ADD      r0,r0,#1
;;;91     #ifndef UKU_220_IPS_TERMOKOMPENSAT //o_10
;;;92     for(i=0;i<2;i++)
;;;93     	{
;;;94     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
;;;95     	else	   			SET_REG(avar_stat,0,1+i,1);
;;;96     	}
;;;97     #endif //o_10
;;;98     for(i=0;i<18;i++)
00001a  eb010040          ADD      r0,r1,r0,LSL #1
;;;99     	{
;;;100    	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00001e  f9b00024          LDRSH    r0,[r0,#0x24]
000022  9001              STR      r0,[sp,#4]
000024  f44f6660          MOV      r6,#0xe00
000028  4630              MOV      r0,r6
00002a  f7fffffe          BL       lc640_read_int
00002e  f1000001          ADD      r0,r0,#1
000032  4604              MOV      r4,r0
000034  2c3f              CMP      r4,#0x3f
000036  d901              BLS      |L2.60|
000038  f04f0400          MOV      r4,#0
                  |L2.60|
00003c  b221              SXTH     r1,r4
00003e  4630              MOV      r0,r6
000040  f7fffffe          BL       lc640_write_int
000044  f6406702          MOV      r7,#0xe02
000048  4638              MOV      r0,r7
00004a  f7fffffe          BL       lc640_read_int
;;;101    	else	   			SET_REG(avar_stat,0,3+i,1);
00004e  283f              CMP      r0,#0x3f
000050  d000              BEQ      |L2.84|
000052  4620              MOV      r0,r4
                  |L2.84|
000054  b201              SXTH     r1,r0
000056  4638              MOV      r0,r7
000058  f7fffffe          BL       lc640_write_int
00005c  4630              MOV      r0,r6
00005e  f7fffffe          BL       lc640_read_int
000062  f44f6180          MOV      r1,#0x400             ;98
000066  eb011440          ADD      r4,r1,r0,LSL #5       ;98
;;;102    	}
;;;103    
;;;104    /*for(i=0;i<6;i++)
;;;105    	{
;;;106    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
;;;107    	else	   		SET_REG(avar_stat,0,15+i,1);
;;;108    	}*/
;;;109    
;;;110    /*for(i=0;i<4;i++)
;;;111    	{
;;;112    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;113    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;114    	}  */
;;;115    #ifndef UKU_ZVU
;;;116    for(i=0;i<4;i++)
;;;117    	{
;;;118    	if(sk_av_stat[i]==sasON)	SET_REG(sk_avar_stat,1,i,1);
;;;119    	else	   					SET_REG(sk_avar_stat,0,i,1);
;;;120    	}
;;;121    #endif //UKU_ZVU
;;;122    #ifndef UKU_FSO
;;;123    for(i=0;i<4;i++)
00006a  f04f0042          MOV      r0,#0x42
00006e  f88d0008          STRB     r0,[sp,#8]
000072  f88d5009          STRB     r5,[sp,#9]
;;;124    	{
;;;125    //	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
;;;126    //	else	   		SET_REG(avar_stat,0,24+i,1);
;;;127    	}
;;;128    #endif //UKU_FSO
;;;129    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;130    //else	   			SET_REG(avar_stat,0,28,1);
;;;131    
;;;132    
;;;133    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000076  f04f004b          MOV      r0,#0x4b
00007a  f88d000a          STRB     r0,[sp,#0xa]
00007e  f04f0600          MOV      r6,#0
;;;134    
;;;135    avar_ind_stat|=avar_stat_new;
000082  f88d600b          STRB     r6,[sp,#0xb]
000086  a902              ADD      r1,sp,#8
000088  4620              MOV      r0,r4
;;;136    
;;;137    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
00008a  f7fffffe          BL       lc640_write_long_ptr
00008e  f89d0010          LDRB     r0,[sp,#0x10]
000092  f88d0008          STRB     r0,[sp,#8]
;;;138    
;;;139    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
000096  f89d0011          LDRB     r0,[sp,#0x11]
00009a  f88d0009          STRB     r0,[sp,#9]
00009e  f89d0004          LDRB     r0,[sp,#4]
0000a2  f88d000a          STRB     r0,[sp,#0xa]
;;;140    
;;;141    avar_ind_stat&=avar_stat_offed; 
0000a6  f89d0005          LDRB     r0,[sp,#5]
0000aa  f88d000b          STRB     r0,[sp,#0xb]
;;;142    
;;;143    avar_stat_old=avar_stat;
;;;144    
;;;145    
;;;146    sk_avar_stat_new=(sk_avar_stat^sk_avar_stat_old)&sk_avar_stat;
0000ae  a902              ADD      r1,sp,#8
0000b0  1d20              ADDS     r0,r4,#4
0000b2  f7fffffe          BL       lc640_write_long_ptr
0000b6  f24020a2          MOV      r0,#0x2a2
;;;147    
;;;148    sk_avar_ind_stat|=sk_avar_stat_new;
0000ba  f7fffffe          BL       lc640_read_long
0000be  4d1c              LDR      r5,|L2.304|
;;;149    
;;;150    sk_avar_stat_offed=~((sk_avar_stat^sk_avar_stat_old)&sk_avar_stat_old);
0000c0  6028              STR      r0,[r5,#0]  ; ke_date
0000c2  4629              MOV      r1,r5
0000c4  f1040008          ADD      r0,r4,#8
0000c8  f7fffffe          BL       lc640_write_long_ptr
;;;151    
;;;152    
;;;153    if((SK_ZVUK_EN[0])) sk_avar_ind_stat&=(~(1UL<<0));
0000cc  f24020a6          MOV      r0,#0x2a6
0000d0  f7fffffe          BL       lc640_read_long
0000d4  6068              STR      r0,[r5,#4]  ; ke_date
0000d6  1d29              ADDS     r1,r5,#4
;;;154    if((SK_ZVUK_EN[1])) sk_avar_ind_stat&=(~(1UL<<1));
0000d8  f104000c          ADD      r0,r4,#0xc
0000dc  f7fffffe          BL       lc640_write_long_ptr
0000e0  4d14              LDR      r5,|L2.308|
0000e2  8ba8              LDRH     r0,[r5,#0x1c]
;;;155    if((SK_ZVUK_EN[2])) sk_avar_ind_stat&=(~(1UL<<2));
0000e4  f88d0008          STRB     r0,[sp,#8]
0000e8  7e28              LDRB     r0,[r5,#0x18]
0000ea  f88d0009          STRB     r0,[sp,#9]
0000ee  7b28              LDRB     r0,[r5,#0xc]
;;;156    if((SK_ZVUK_EN[3])) sk_avar_ind_stat&=(~(1UL<<3));	
0000f0  f88d000a          STRB     r0,[sp,#0xa]
0000f4  f88d600b          STRB     r6,[sp,#0xb]
0000f8  a902              ADD      r1,sp,#8
0000fa  f1040010          ADD      r0,r4,#0x10
;;;157    
;;;158    if(!AV_OFF_AVT)sk_avar_stat_offed|=0x0f;
0000fe  f7fffffe          BL       lc640_write_long_ptr
000102  7a28              LDRB     r0,[r5,#8]
;;;159    
;;;160    sk_avar_ind_stat&=sk_avar_stat_offed; 
000104  f88d0008          STRB     r0,[sp,#8]
000108  7928              LDRB     r0,[r5,#4]
00010a  f88d0009          STRB     r0,[sp,#9]
;;;161    
;;;162    sk_avar_stat_old=sk_avar_stat;
00010e  7828              LDRB     r0,[r5,#0]
;;;163    
;;;164    //oleg_start
;;;165    
;;;166    
;;;167    
;;;168    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
000110  f88d000a          STRB     r0,[sp,#0xa]
000114  f88d600b          STRB     r6,[sp,#0xb]
000118  a902              ADD      r1,sp,#8
00011a  f1040014          ADD      r0,r4,#0x14
00011e  f7fffffe          BL       lc640_write_long_ptr
;;;169    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
000122  b005              ADD      sp,sp,#0x14
000124  bdf0              POP      {r4-r7,pc}
;;;170    rki_avar1_ind_stat|=rki_avar1_stat_new;
;;;171    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
;;;172    rki_avar1_ind_stat&=rki_avar1_stat_offed;
;;;173    rki_avar1_stat_old=rki_avar1_stat;
;;;174    /*
;;;175    rki_avarI1_stat=status_di1;
;;;176    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;177    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;178    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;179    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;180    rki_avarI1_stat_old=rki_avarI1_stat;
;;;181    
;;;182    rki_avarI2_stat=status_di2;
;;;183    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;184    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;185    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;186    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;187    rki_avarI2_stat_old=rki_avarI2_stat;
;;;188    */
;;;189    //oleg_end
;;;190    }
;;;191    
                          ENDP

000126  0000              DCW      0x0000
                  |L2.296|
                          DCD      bat
                  |L2.300|
                          DCD      bat_u_old_cnt
                  |L2.304|
                          DCD      ke_date
                  |L2.308|
                          DCD      0x40024020

                          AREA ||.data||, DATA, ALIGN=2

                  sk_avar_stat
000000  00                DCB      0x00
                  sk_avar_ind_stat
000001  00                DCB      0x00
                  sk_avar_stat_old
000002  00                DCB      0x00
                  sk_avar_stat_new
000003  00                DCB      0x00
                  sk_avar_stat_offed
000004  00000000          DCB      0x00,0x00,0x00,0x00
                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  rki_avar1_stat
                          DCD      0x00000000
                  rki_avar1_ind_stat
                          DCD      0x00000000
                  rki_avar1_stat_old
                          DCD      0x00000000
                  rki_avar1_stat_new
                          DCD      0x00000000
                  rki_avar1_stat_offed
                          DCD      0x00000000

                          AREA ||area_number.6||, DATA, ALIGN=0

                          EXPORTAS ||area_number.6||, ||.data||
                  av_inv
                          DCDU     0x00000000
000004  0000              DCB      0x00,0x00
