; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\avar_hndl.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;75     //-----------------------------------------------
;;;76     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;77     {
;;;78     //static unsigned avar_stat_old;
;;;79     char i;
;;;80     //unsigned avar_stat_new,avar_stat_offed;
;;;81     
;;;82     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48ff              LDR      r0,|L1.1024|
000004  49ff              LDR      r1,|L1.1028|
000006  7802              LDRB     r2,[r0,#0]  ; net_av
000008  6808              LDR      r0,[r1,#0]
00000a  b11a              CBZ      r2,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6008              STR      r0,[r1,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;83     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6008              STR      r0,[r1,#0]  ; avar_stat
                  |L1.26|
;;;84     
;;;85     for(i=0;i<2;i++)
00001a  f04f0000          MOV      r0,#0
;;;86     	{
;;;87     	if(bat[i]._av&1)	SET_REG(avar_stat,1,1+i,1);
00001e  4dfa              LDR      r5,|L1.1032|
000020  f04f0401          MOV      r4,#1
                  |L1.36|
000024  eb000240          ADD      r2,r0,r0,LSL #1
000028  eb021200          ADD      r2,r2,r0,LSL #4
00002c  eb050282          ADD      r2,r5,r2,LSL #2
000030  f892203d          LDRB     r2,[r2,#0x3d]
000034  07d2              LSLS     r2,r2,#31
000036  d00a              BEQ      |L1.78|
000038  f1000301          ADD      r3,r0,#1
00003c  fa04f203          LSL      r2,r4,r3
000040  680b              LDR      r3,[r1,#0]  ; avar_stat
000042  ea230302          BIC      r3,r3,r2
000046  ea430302          ORR      r3,r3,r2
00004a  600b              STR      r3,[r1,#0]  ; avar_stat
00004c  e007              B        |L1.94|
                  |L1.78|
;;;88     	else	   		SET_REG(avar_stat,0,1+i,1);
00004e  f1000201          ADD      r2,r0,#1
000052  fa04f302          LSL      r3,r4,r2
000056  680a              LDR      r2,[r1,#0]  ; avar_stat
000058  ea220203          BIC      r2,r2,r3
00005c  600a              STR      r2,[r1,#0]  ; avar_stat
                  |L1.94|
00005e  f1000001          ADD      r0,r0,#1              ;85
000062  b2c0              UXTB     r0,r0                 ;85
000064  2802              CMP      r0,#2                 ;85
000066  d3dd              BCC      |L1.36|
;;;89     	}
;;;90     
;;;91     for(i=0;i<12;i++)
000068  f04f0000          MOV      r0,#0
;;;92     	{
;;;93     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00006c  4ae7              LDR      r2,|L1.1036|
                  |L1.110|
00006e  ebc003c0          RSB      r3,r0,r0,LSL #3
000072  eb031300          ADD      r3,r3,r0,LSL #4
000076  eb020383          ADD      r3,r2,r3,LSL #2
00007a  785b              LDRB     r3,[r3,#1]
00007c  f0130fef          TST      r3,#0xef
000080  d00a              BEQ      |L1.152|
000082  f1000503          ADD      r5,r0,#3
000086  fa04f305          LSL      r3,r4,r5
00008a  680d              LDR      r5,[r1,#0]  ; avar_stat
00008c  ea250503          BIC      r5,r5,r3
000090  ea450503          ORR      r5,r5,r3
000094  600d              STR      r5,[r1,#0]  ; avar_stat
000096  e007              B        |L1.168|
                  |L1.152|
;;;94     	else	   		SET_REG(avar_stat,0,3+i,1);
000098  f1000303          ADD      r3,r0,#3
00009c  fa04f503          LSL      r5,r4,r3
0000a0  680b              LDR      r3,[r1,#0]  ; avar_stat
0000a2  ea230305          BIC      r3,r3,r5
0000a6  600b              STR      r3,[r1,#0]  ; avar_stat
                  |L1.168|
0000a8  f1000001          ADD      r0,r0,#1              ;91
0000ac  b2c0              UXTB     r0,r0                 ;91
0000ae  280c              CMP      r0,#0xc               ;91
0000b0  d3dd              BCC      |L1.110|
;;;95     	}
;;;96     
;;;97     for(i=0;i<6;i++)
0000b2  f04f0000          MOV      r0,#0
;;;98     	{
;;;99     	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
0000b6  4dd3              LDR      r5,|L1.1028|
0000b8  f1050550          ADD      r5,r5,#0x50
                  |L1.188|
0000bc  5c2a              LDRB     r2,[r5,r0]
0000be  b152              CBZ      r2,|L1.214|
0000c0  f100030f          ADD      r3,r0,#0xf
0000c4  fa04f203          LSL      r2,r4,r3
0000c8  680b              LDR      r3,[r1,#0]  ; avar_stat
0000ca  ea230302          BIC      r3,r3,r2
0000ce  ea430302          ORR      r3,r3,r2
0000d2  600b              STR      r3,[r1,#0]  ; avar_stat
0000d4  e007              B        |L1.230|
                  |L1.214|
;;;100    	else	   		SET_REG(avar_stat,0,15+i,1);
0000d6  f100020f          ADD      r2,r0,#0xf
0000da  680b              LDR      r3,[r1,#0]  ; avar_stat
0000dc  fa04f202          LSL      r2,r4,r2
0000e0  ea230302          BIC      r3,r3,r2
0000e4  600b              STR      r3,[r1,#0]  ; avar_stat
                  |L1.230|
0000e6  f1000001          ADD      r0,r0,#1              ;97
0000ea  b2c0              UXTB     r0,r0                 ;97
0000ec  2806              CMP      r0,#6                 ;97
0000ee  d3e5              BCC      |L1.188|
;;;101    	}
;;;102    
;;;103    /*for(i=0;i<4;i++)
;;;104    	{
;;;105    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;106    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;107    	}  */
;;;108    for(i=0;i<4;i++)
0000f0  f04f0000          MOV      r0,#0
;;;109    	{
;;;110    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000f4  4bc6              LDR      r3,|L1.1040|
                  |L1.246|
0000f6  5c1a              LDRB     r2,[r3,r0]
0000f8  2a01              CMP      r2,#1
0000fa  d014              BEQ      |L1.294|
;;;111    	else	   		SET_REG(avar_stat,0,24+i,1);
0000fc  f1000218          ADD      r2,r0,#0x18
000100  fa04f502          LSL      r5,r4,r2
000104  680a              LDR      r2,[r1,#0]  ; avar_stat
000106  ea220205          BIC      r2,r2,r5
00010a  600a              STR      r2,[r1,#0]  ; avar_stat
                  |L1.268|
00010c  f1000001          ADD      r0,r0,#1              ;108
000110  b2c0              UXTB     r0,r0                 ;108
000112  2804              CMP      r0,#4                 ;108
000114  d3ef              BCC      |L1.246|
;;;112    	}
;;;113    
;;;114    if(uout_av)			SET_REG(avar_stat,1,28,1);
000116  48bf              LDR      r0,|L1.1044|
000118  7800              LDRB     r0,[r0,#0]  ; uout_av
00011a  b178              CBZ      r0,|L1.316|
00011c  6808              LDR      r0,[r1,#0]  ; avar_stat
00011e  f0405080          ORR      r0,r0,#0x10000000
000122  6008              STR      r0,[r1,#0]  ; avar_stat
000124  e00e              B        |L1.324|
                  |L1.294|
000126  f1000518          ADD      r5,r0,#0x18           ;110
00012a  fa04f205          LSL      r2,r4,r5              ;110
00012e  680d              LDR      r5,[r1,#0]            ;110  ; avar_stat
000130  ea250502          BIC      r5,r5,r2              ;110
000134  ea450502          ORR      r5,r5,r2              ;110
000138  600d              STR      r5,[r1,#0]            ;110  ; avar_stat
00013a  e7e7              B        |L1.268|
                  |L1.316|
;;;115    else	   			SET_REG(avar_stat,0,28,1);
00013c  6808              LDR      r0,[r1,#0]  ; avar_stat
00013e  f0205080          BIC      r0,r0,#0x10000000
000142  6008              STR      r0,[r1,#0]  ; avar_stat
                  |L1.324|
;;;116    
;;;117    
;;;118    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000144  688a              LDR      r2,[r1,#8]  ; avar_stat_old
000146  6808              LDR      r0,[r1,#0]  ; avar_stat
000148  ea200302          BIC      r3,r0,r2
00014c  60cb              STR      r3,[r1,#0xc]  ; avar_stat_new
;;;119    
;;;120    avar_ind_stat|=avar_stat_new;
00014e  684c              LDR      r4,[r1,#4]  ; avar_ind_stat
000150  ea440403          ORR      r4,r4,r3
000154  604c              STR      r4,[r1,#4]  ; avar_ind_stat
;;;121    
;;;122    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000156  4bb0              LDR      r3,|L1.1048|
000158  881d              LDRH     r5,[r3,#0]  ; SK_ZVUK_EN
00015a  b115              CBZ      r5,|L1.354|
00015c  f0247480          BIC      r4,r4,#0x1000000
000160  604c              STR      r4,[r1,#4]  ; avar_ind_stat
                  |L1.354|
;;;123    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
000162  885c              LDRH     r4,[r3,#2]  ; SK_ZVUK_EN
000164  b11c              CBZ      r4,|L1.366|
000166  684c              LDR      r4,[r1,#4]  ; avar_ind_stat
000168  f0247400          BIC      r4,r4,#0x2000000
00016c  604c              STR      r4,[r1,#4]  ; avar_ind_stat
                  |L1.366|
;;;124    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
00016e  889c              LDRH     r4,[r3,#4]  ; SK_ZVUK_EN
000170  b11c              CBZ      r4,|L1.378|
000172  684c              LDR      r4,[r1,#4]  ; avar_ind_stat
000174  f0246480          BIC      r4,r4,#0x4000000
000178  604c              STR      r4,[r1,#4]  ; avar_ind_stat
                  |L1.378|
;;;125    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
00017a  88db              LDRH     r3,[r3,#6]  ; SK_ZVUK_EN
00017c  b11b              CBZ      r3,|L1.390|
00017e  684b              LDR      r3,[r1,#4]  ; avar_ind_stat
000180  f0236300          BIC      r3,r3,#0x8000000
000184  604b              STR      r3,[r1,#4]  ; avar_ind_stat
                  |L1.390|
;;;126    
;;;127    
;;;128    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
000186  ea220200          BIC      r2,r2,r0
00018a  ea6f0202          MVN      r2,r2
00018e  610a              STR      r2,[r1,#0x10]  ; avar_stat_offed
;;;129    
;;;130    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
000190  4ba2              LDR      r3,|L1.1052|
000192  881b              LDRH     r3,[r3,#0]  ; AV_OFF_AVT
000194  b91b              CBNZ     r3,|L1.414|
000196  4ba2              LDR      r3,|L1.1056|
000198  ea420203          ORR      r2,r2,r3
00019c  610a              STR      r2,[r1,#0x10]  ; avar_stat_offed
                  |L1.414|
;;;131    
;;;132    avar_ind_stat&=avar_stat_offed; 
00019e  690b              LDR      r3,[r1,#0x10]  ; avar_stat_offed
0001a0  684a              LDR      r2,[r1,#4]  ; avar_ind_stat
0001a2  ea020203          AND      r2,r2,r3
0001a6  604a              STR      r2,[r1,#4]  ; avar_ind_stat
;;;133    
;;;134    avar_stat_old=avar_stat;
0001a8  6088              STR      r0,[r1,#8]  ; avar_stat_old
;;;135    
;;;136    //oleg_start
;;;137    
;;;138    
;;;139    
;;;140    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
0001aa  489e              LDR      r0,|L1.1060|
0001ac  4a9e              LDR      r2,|L1.1064|
0001ae  8800              LDRH     r0,[r0,#0]  ; status_izm_r
0001b0  6812              LDR      r2,[r2,#0]  ; sk_alarm
0001b2  f000003f          AND      r0,r0,#0x3f
0001b6  ea402002          ORR      r0,r0,r2,LSL #8
0001ba  6148              STR      r0,[r1,#0x14]  ; rki_avar1_stat
;;;141    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
0001bc  69cb              LDR      r3,[r1,#0x1c]  ; rki_avar1_stat_old
0001be  ea200203          BIC      r2,r0,r3
0001c2  620a              STR      r2,[r1,#0x20]  ; rki_avar1_stat_new
;;;142    rki_avar1_ind_stat|=rki_avar1_stat_new;
0001c4  698c              LDR      r4,[r1,#0x18]  ; rki_avar1_ind_stat
0001c6  ea440402          ORR      r4,r4,r2
;;;143    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
0001ca  ea230300          BIC      r3,r3,r0
0001ce  ea6f0203          MVN      r2,r3
0001d2  624a              STR      r2,[r1,#0x24]  ; rki_avar1_stat_offed
;;;144    rki_avar1_ind_stat&=rki_avar1_stat_offed;
0001d4  ea040402          AND      r4,r4,r2
0001d8  618c              STR      r4,[r1,#0x18]  ; rki_avar1_ind_stat
;;;145    rki_avar1_stat_old=rki_avar1_stat;
0001da  61c8              STR      r0,[r1,#0x1c]  ; rki_avar1_stat_old
;;;146    
;;;147    rki_avarI1_stat=status_di1;
0001dc  4893              LDR      r0,|L1.1068|
0001de  6800              LDR      r0,[r0,#0]  ; status_di1
0001e0  6288              STR      r0,[r1,#0x28]  ; rki_avarI1_stat
;;;148    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
0001e2  6b0b              LDR      r3,[r1,#0x30]  ; rki_avarI1_stat_old
0001e4  ea200203          BIC      r2,r0,r3
0001e8  634a              STR      r2,[r1,#0x34]  ; rki_avarI1_stat_new
;;;149    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
0001ea  6acc              LDR      r4,[r1,#0x2c]  ; rki_avarI1_ind_stat
0001ec  ea440402          ORR      r4,r4,r2
;;;150    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
0001f0  ea230300          BIC      r3,r3,r0
0001f4  ea6f0203          MVN      r2,r3
0001f8  638a              STR      r2,[r1,#0x38]  ; rki_avarI1_stat_offed
;;;151    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
0001fa  ea040402          AND      r4,r4,r2
0001fe  62cc              STR      r4,[r1,#0x2c]  ; rki_avarI1_ind_stat
;;;152    rki_avarI1_stat_old=rki_avarI1_stat;
000200  6308              STR      r0,[r1,#0x30]  ; rki_avarI1_stat_old
;;;153    
;;;154    rki_avarI2_stat=status_di2;
000202  488b              LDR      r0,|L1.1072|
000204  6800              LDR      r0,[r0,#0]  ; status_di2
000206  63c8              STR      r0,[r1,#0x3c]  ; rki_avarI2_stat
;;;155    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
000208  6c4b              LDR      r3,[r1,#0x44]  ; rki_avarI2_stat_old
00020a  ea200203          BIC      r2,r0,r3
00020e  648a              STR      r2,[r1,#0x48]  ; rki_avarI2_stat_new
;;;156    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
000210  6c0c              LDR      r4,[r1,#0x40]  ; rki_avarI2_ind_stat
000212  ea440402          ORR      r4,r4,r2
;;;157    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
000216  ea230300          BIC      r3,r3,r0
00021a  ea6f0203          MVN      r2,r3
00021e  64ca              STR      r2,[r1,#0x4c]  ; rki_avarI2_stat_offed
;;;158    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
000220  ea040402          AND      r4,r4,r2
000224  640c              STR      r4,[r1,#0x40]  ; rki_avarI2_ind_stat
;;;159    rki_avarI2_stat_old=rki_avarI2_stat;
000226  6448              STR      r0,[r1,#0x44]  ; rki_avarI2_stat_old
;;;160    //oleg_end
;;;161    }
000228  bd30              POP      {r4,r5,pc}
;;;162    
                          ENDP

                  reload_hndl PROC
;;;163    //-----------------------------------------------
;;;164    void reload_hndl(void)
00022a  b5f8              PUSH     {r3-r7,lr}
;;;165    {
;;;166    char data[4];
;;;167    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;168    
;;;169    event_ptr=lc640_read_int(PTR_EVENT_LOG);
00022c  f44f6560          MOV      r5,#0xe00
000230  4628              MOV      r0,r5
000232  f7fffffe          BL       lc640_read_int
;;;170    event_ptr++;	
000236  f1000001          ADD      r0,r0,#1
00023a  4604              MOV      r4,r0
;;;171    if(event_ptr>63)event_ptr=0;	
00023c  2c3f              CMP      r4,#0x3f
00023e  d901              BLS      |L1.580|
000240  f04f0400          MOV      r4,#0
                  |L1.580|
;;;172    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000244  b221              SXTH     r1,r4
000246  4628              MOV      r0,r5
000248  f7fffffe          BL       lc640_write_int
;;;173    	
;;;174    event_cnt=lc640_read_int(CNT_EVENT_LOG);
00024c  f6406602          MOV      r6,#0xe02
000250  4630              MOV      r0,r6
000252  f7fffffe          BL       lc640_read_int
;;;175    if(event_cnt!=63)event_cnt=event_ptr;
000256  283f              CMP      r0,#0x3f
000258  d000              BEQ      |L1.604|
00025a  4620              MOV      r0,r4
                  |L1.604|
;;;176    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
00025c  b201              SXTH     r1,r0
00025e  4630              MOV      r0,r6
000260  f7fffffe          BL       lc640_write_int
;;;177    	
;;;178    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000264  4628              MOV      r0,r5
000266  f7fffffe          BL       lc640_read_int
00026a  f44f6180          MOV      r1,#0x400
00026e  eb011440          ADD      r4,r1,r0,LSL #5
;;;179    	
;;;180    data[0]='U';
000272  f04f0055          MOV      r0,#0x55
000276  f88d0000          STRB     r0,[sp,#0]
;;;181    data[1]=0;
00027a  f04f0600          MOV      r6,#0
00027e  f88d6001          STRB     r6,[sp,#1]
;;;182    data[2]='R';
000282  f04f0052          MOV      r0,#0x52
000286  f88d0002          STRB     r0,[sp,#2]
;;;183    data[3]=0;
00028a  f88d6003          STRB     r6,[sp,#3]
;;;184    lc640_write_long_ptr(lc640_adr,data);
00028e  4669              MOV      r1,sp
000290  4620              MOV      r0,r4
000292  f7fffffe          BL       lc640_write_long_ptr
;;;185    
;;;186    data[0]=0;
;;;187    data[1]=0;
;;;188    data[2]=0;
;;;189    data[3]=0;
000296  9600              STR      r6,[sp,#0]
;;;190    lc640_write_long_ptr(lc640_adr+4,data);
000298  4669              MOV      r1,sp
00029a  1d20              ADDS     r0,r4,#4
00029c  f7fffffe          BL       lc640_write_long_ptr
;;;191    
;;;192    data[0]=LPC_RTC->YEAR;
0002a0  4d64              LDR      r5,|L1.1076|
0002a2  8ba8              LDRH     r0,[r5,#0x1c]
0002a4  f88d0000          STRB     r0,[sp,#0]
;;;193    data[1]=LPC_RTC->MONTH;
0002a8  7e28              LDRB     r0,[r5,#0x18]
0002aa  f88d0001          STRB     r0,[sp,#1]
;;;194    data[2]=LPC_RTC->DOM;
0002ae  7b28              LDRB     r0,[r5,#0xc]
0002b0  f88d0002          STRB     r0,[sp,#2]
;;;195    data[3]=0;
0002b4  f88d6003          STRB     r6,[sp,#3]
;;;196    lc640_write_long_ptr(lc640_adr+8,data);
0002b8  4669              MOV      r1,sp
0002ba  f1040008          ADD      r0,r4,#8
0002be  f7fffffe          BL       lc640_write_long_ptr
;;;197    
;;;198    data[0]=LPC_RTC->HOUR;
0002c2  7a28              LDRB     r0,[r5,#8]
0002c4  f88d0000          STRB     r0,[sp,#0]
;;;199    data[1]=LPC_RTC->MIN;
0002c8  7928              LDRB     r0,[r5,#4]
0002ca  f88d0001          STRB     r0,[sp,#1]
;;;200    data[2]=LPC_RTC->SEC;
0002ce  7828              LDRB     r0,[r5,#0]
0002d0  f88d0002          STRB     r0,[sp,#2]
;;;201    data[3]=LPC_SC->RSID;
0002d4  4858              LDR      r0,|L1.1080|
0002d6  f8d00180          LDR      r0,[r0,#0x180]
0002da  f88d0003          STRB     r0,[sp,#3]
;;;202    
;;;203    lc640_write_long_ptr(lc640_adr+12,data);
0002de  4669              MOV      r1,sp
0002e0  f104000c          ADD      r0,r4,#0xc
0002e4  f7fffffe          BL       lc640_write_long_ptr
;;;204    	
;;;205    data[0]='A';
0002e8  f04f0541          MOV      r5,#0x41
0002ec  f88d5000          STRB     r5,[sp,#0]
;;;206    data[1]='A';
0002f0  f88d5001          STRB     r5,[sp,#1]
;;;207    data[2]='A';
0002f4  f88d5002          STRB     r5,[sp,#2]
;;;208    data[3]='A';
0002f8  f88d5003          STRB     r5,[sp,#3]
;;;209    lc640_write_long_ptr(lc640_adr+16,data);
0002fc  4669              MOV      r1,sp
0002fe  f1040010          ADD      r0,r4,#0x10
000302  f7fffffe          BL       lc640_write_long_ptr
;;;210    	
;;;211    data[0]='A';
000306  f88d5000          STRB     r5,[sp,#0]
;;;212    data[1]='A';
00030a  f88d5001          STRB     r5,[sp,#1]
;;;213    data[2]='A';
00030e  f88d5002          STRB     r5,[sp,#2]
;;;214    data[3]='A';
000312  f88d5003          STRB     r5,[sp,#3]
;;;215    lc640_write_long_ptr(lc640_adr+20,data);
000316  4669              MOV      r1,sp
000318  f1040014          ADD      r0,r4,#0x14
00031c  f7fffffe          BL       lc640_write_long_ptr
;;;216    	
;;;217    data[0]='A';
000320  f88d5000          STRB     r5,[sp,#0]
;;;218    data[1]='A';
000324  f88d5001          STRB     r5,[sp,#1]
;;;219    data[2]='A';
000328  f88d5002          STRB     r5,[sp,#2]
;;;220    data[3]='A';
00032c  f88d5003          STRB     r5,[sp,#3]
;;;221    lc640_write_long_ptr(lc640_adr+24,data);
000330  4669              MOV      r1,sp
000332  f1040018          ADD      r0,r4,#0x18
000336  f7fffffe          BL       lc640_write_long_ptr
;;;222    	
;;;223    data[0]='A';
00033a  f88d5000          STRB     r5,[sp,#0]
;;;224    data[1]='A';
00033e  f88d5001          STRB     r5,[sp,#1]
;;;225    data[2]='A';
000342  f88d5002          STRB     r5,[sp,#2]
;;;226    data[3]='A';
000346  f88d5003          STRB     r5,[sp,#3]
;;;227    lc640_write_long_ptr(lc640_adr+28,data);				
00034a  4669              MOV      r1,sp
00034c  f104001c          ADD      r0,r4,#0x1c
000350  f7fffffe          BL       lc640_write_long_ptr
;;;228    	
;;;229    	
;;;230    }
000354  bdf8              POP      {r3-r7,pc}
;;;231    
                          ENDP

                  avar_unet_hndl PROC
;;;232    //-----------------------------------------------
;;;233    void avar_unet_hndl(char in)
000356  e92d43f8          PUSH     {r3-r9,lr}
;;;234    {
;;;235    
;;;236    char data[4];
;;;237    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;238    
;;;239    
;;;240    if(in==1)
;;;241    	{
;;;242    	net_av=1;
;;;243    
;;;244    	//beep_init(0x01L,'O');
;;;245    	//a.av.bAN=1;
;;;246    
;;;247    
;;;248    	//beep_init(0x33333333,'A');
;;;249    	 
;;;250    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;251    	event_ptr++;	
;;;252    	if(event_ptr>63)event_ptr=0;	
;;;253    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;254    	
;;;255         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;256    	if(event_cnt!=63)event_cnt=event_ptr;
;;;257    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;258    	
;;;259    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;260    	
;;;261    	data[0]='P';
;;;262    	data[1]=0;
;;;263    	data[2]='A';
;;;264    	data[3]=0;
;;;265    	lc640_write_long_ptr(lc640_adr,data);
;;;266    
;;;267    	data[0]=0;//*((char*)&Unet_store);
;;;268    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;269    	data[2]=0;
;;;270    	data[3]=0;
;;;271    	lc640_write_long_ptr(lc640_adr+4,data);
;;;272    
;;;273    	data[0]=LPC_RTC->YEAR;
00035a  4f36              LDR      r7,|L1.1076|
00035c  4928              LDR      r1,|L1.1024|
00035e  3f20              SUBS     r7,r7,#0x20
000360  f44f6560          MOV      r5,#0xe00             ;250
000364  f04f0800          MOV      r8,#0                 ;252
000368  f44f6980          MOV      r9,#0x400             ;259
00036c  2801              CMP      r0,#1                 ;240
00036e  d002              BEQ      |L1.886|
;;;274    	data[1]=LPC_RTC->MONTH;
;;;275    	data[2]=LPC_RTC->DOM;
;;;276    	data[3]=0;
;;;277    	lc640_write_long_ptr(lc640_adr+8,data);
;;;278    
;;;279    	data[0]=LPC_RTC->HOUR;
;;;280    	data[1]=LPC_RTC->MIN;
;;;281    	data[2]=LPC_RTC->SEC;
;;;282    	data[3]=0;
;;;283    	lc640_write_long_ptr(lc640_adr+12,data);
;;;284    	
;;;285    	data[0]='A';
;;;286    	data[1]='A';
;;;287    	data[2]='A';
;;;288    	data[3]='A';
;;;289    	lc640_write_long_ptr(lc640_adr+16,data);
;;;290    	
;;;291    	data[0]='A';
;;;292    	data[1]='A';
;;;293    	data[2]='A';
;;;294    	data[3]='A';
;;;295    	lc640_write_long_ptr(lc640_adr+20,data);
;;;296    	
;;;297    	data[0]='A';
;;;298    	data[1]='A';
;;;299    	data[2]='A';
;;;300    	data[3]='A';
;;;301    	lc640_write_long_ptr(lc640_adr+24,data);
;;;302    	
;;;303    	data[0]='A';
;;;304    	data[1]='A';
;;;305    	data[2]='A';
;;;306    	data[3]='A';
;;;307    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;308    	
;;;309    /*	memo_out0[0]=0x55;
;;;310         memo_out0[1]=0x00+2;
;;;311         memo_out0[2]=1;
;;;312         memo_out0[3]=0x0b;
;;;313         memo_out0[4]=0x55;
;;;314         memo_out0[5]=0x55; 
;;;315         	
;;;316         memo_out0[6]=crc_87(memo_out0,6);
;;;317    	memo_out0[7]=crc_95(memo_out0,6);
;;;318         usart_out_adr0(memo_out0,8); 
;;;319    	*/
;;;320    	snmp_trap_send("Main power alarm",2,1,0);
;;;321    	}
;;;322    
;;;323    else if(in==0)
000370  2800              CMP      r0,#0
000372  d044              BEQ      |L1.1022|
000374  e146              B        |L1.1540|
                  |L1.886|
000376  f04f0001          MOV      r0,#1                 ;242
00037a  7008              STRB     r0,[r1,#0]            ;242
00037c  4628              MOV      r0,r5                 ;250
00037e  f7fffffe          BL       lc640_read_int
000382  f1000001          ADD      r0,r0,#1              ;251
000386  4604              MOV      r4,r0                 ;251
000388  2c3f              CMP      r4,#0x3f              ;252
00038a  d901              BLS      |L1.912|
00038c  f04f0400          MOV      r4,#0                 ;252
                  |L1.912|
000390  b221              SXTH     r1,r4                 ;253
000392  4628              MOV      r0,r5                 ;253
000394  f7fffffe          BL       lc640_write_int
000398  f6406602          MOV      r6,#0xe02             ;255
00039c  4630              MOV      r0,r6                 ;255
00039e  f7fffffe          BL       lc640_read_int
0003a2  283f              CMP      r0,#0x3f              ;256
0003a4  d000              BEQ      |L1.936|
0003a6  4620              MOV      r0,r4                 ;256
                  |L1.936|
0003a8  b201              SXTH     r1,r0                 ;257
0003aa  4630              MOV      r0,r6                 ;257
0003ac  f7fffffe          BL       lc640_write_int
0003b0  4628              MOV      r0,r5                 ;259
0003b2  f7fffffe          BL       lc640_read_int
0003b6  eb091540          ADD      r5,r9,r0,LSL #5       ;259
0003ba  f04f0050          MOV      r0,#0x50              ;261
0003be  f88d0000          STRB     r0,[sp,#0]            ;261
0003c2  f88d8001          STRB     r8,[sp,#1]            ;262
0003c6  f04f0441          MOV      r4,#0x41              ;263
0003ca  f88d4002          STRB     r4,[sp,#2]            ;263
0003ce  f88d8003          STRB     r8,[sp,#3]            ;264
0003d2  4669              MOV      r1,sp                 ;265
0003d4  4628              MOV      r0,r5                 ;265
0003d6  f7fffffe          BL       lc640_write_long_ptr
0003da  f8cd8000          STR      r8,[sp,#0]            ;270
0003de  4669              MOV      r1,sp                 ;271
0003e0  1d28              ADDS     r0,r5,#4              ;271
0003e2  f7fffffe          BL       lc640_write_long_ptr
0003e6  f1070720          ADD      r7,r7,#0x20           ;273
0003ea  8bb8              LDRH     r0,[r7,#0x1c]         ;273
0003ec  f88d0000          STRB     r0,[sp,#0]            ;273
0003f0  7e38              LDRB     r0,[r7,#0x18]         ;274
0003f2  f88d0001          STRB     r0,[sp,#1]            ;274
0003f6  7b38              LDRB     r0,[r7,#0xc]          ;275
0003f8  f88d0002          STRB     r0,[sp,#2]            ;275
0003fc  e01e              B        |L1.1084|
                  |L1.1022|
0003fe  e06f              B        |L1.1248|
                  |L1.1024|
                          DCD      net_av
                  |L1.1028|
                          DCD      ||.data||
                  |L1.1032|
                          DCD      bat
                  |L1.1036|
                          DCD      bps
                  |L1.1040|
                          DCD      sk_av_stat
                  |L1.1044|
                          DCD      uout_av
                  |L1.1048|
                          DCD      SK_ZVUK_EN
                  |L1.1052|
                          DCD      AV_OFF_AVT
                  |L1.1056|
                          DCD      0xeffffffe
                  |L1.1060|
                          DCD      status_izm_r
                  |L1.1064|
                          DCD      sk_alarm
                  |L1.1068|
                          DCD      status_di1
                  |L1.1072|
                          DCD      status_di2
                  |L1.1076|
                          DCD      0x40024020
                  |L1.1080|
                          DCD      0x400fc000
                  |L1.1084|
00043c  f88d8003          STRB     r8,[sp,#3]            ;276
000440  4669              MOV      r1,sp                 ;277
000442  f1050008          ADD      r0,r5,#8              ;277
000446  f7fffffe          BL       lc640_write_long_ptr
00044a  7a38              LDRB     r0,[r7,#8]            ;279
00044c  f88d0000          STRB     r0,[sp,#0]            ;279
000450  7938              LDRB     r0,[r7,#4]            ;280
000452  f88d0001          STRB     r0,[sp,#1]            ;280
000456  7838              LDRB     r0,[r7,#0]            ;281
000458  f88d0002          STRB     r0,[sp,#2]            ;281
00045c  f88d8003          STRB     r8,[sp,#3]            ;282
000460  4669              MOV      r1,sp                 ;283
000462  f105000c          ADD      r0,r5,#0xc            ;283
000466  f7fffffe          BL       lc640_write_long_ptr
00046a  f88d4000          STRB     r4,[sp,#0]            ;285
00046e  f88d4001          STRB     r4,[sp,#1]            ;286
000472  f88d4002          STRB     r4,[sp,#2]            ;287
000476  f88d4003          STRB     r4,[sp,#3]            ;288
00047a  4669              MOV      r1,sp                 ;289
00047c  f1050010          ADD      r0,r5,#0x10           ;289
000480  f7fffffe          BL       lc640_write_long_ptr
000484  f88d4000          STRB     r4,[sp,#0]            ;291
000488  f88d4001          STRB     r4,[sp,#1]            ;292
00048c  f88d4002          STRB     r4,[sp,#2]            ;293
000490  f88d4003          STRB     r4,[sp,#3]            ;294
000494  4669              MOV      r1,sp                 ;295
000496  f1050014          ADD      r0,r5,#0x14           ;295
00049a  f7fffffe          BL       lc640_write_long_ptr
00049e  f88d4000          STRB     r4,[sp,#0]            ;297
0004a2  f88d4001          STRB     r4,[sp,#1]            ;298
0004a6  f88d4002          STRB     r4,[sp,#2]            ;299
0004aa  f88d4003          STRB     r4,[sp,#3]            ;300
0004ae  4669              MOV      r1,sp                 ;301
0004b0  f1050018          ADD      r0,r5,#0x18           ;301
0004b4  f7fffffe          BL       lc640_write_long_ptr
0004b8  f88d4000          STRB     r4,[sp,#0]            ;303
0004bc  f88d4001          STRB     r4,[sp,#1]            ;304
0004c0  f88d4002          STRB     r4,[sp,#2]            ;305
0004c4  f88d4003          STRB     r4,[sp,#3]            ;306
0004c8  4669              MOV      r1,sp                 ;307
0004ca  f105001c          ADD      r0,r5,#0x1c           ;307
0004ce  f7fffffe          BL       lc640_write_long_ptr
0004d2  2300              MOVS     r3,#0                 ;320
0004d4  2201              MOVS     r2,#1                 ;320
0004d6  2102              MOVS     r1,#2                 ;320
0004d8  a0fd              ADR      r0,|L1.2256|
0004da  f7fffffe          BL       snmp_trap_send
0004de  e091              B        |L1.1540|
                  |L1.1248|
;;;324    	{
;;;325    	net_av=0;
0004e0  f8818000          STRB     r8,[r1,#0]
;;;326    
;;;327      /*
;;;328    	SET_REG(C2GSR,3,24,8);
;;;329    	C2MOD=0;
;;;330    	bOUT_FREE2=1;*/
;;;331    
;;;332    
;;;333    	//C2MOD=0;
;;;334    
;;;335    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;336    
;;;337         //beep_init(0x02L,'O');
;;;338    	//a_.av.bAN=0;
;;;339    	SET_REG(avar_stat,0,0,1);
0004e4  48ff              LDR      r0,|L1.2276|
0004e6  6801              LDR      r1,[r0,#0]  ; avar_stat
0004e8  f0210101          BIC      r1,r1,#1
0004ec  6001              STR      r1,[r0,#0]  ; avar_stat
;;;340    
;;;341    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;342    	
;;;343    	if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
0004ee  49fe              LDR      r1,|L1.2280|
0004f0  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
0004f2  b119              CBZ      r1,|L1.1276|
0004f4  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
0004f6  f0210101          BIC      r1,r1,#1
0004fa  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.1276|
;;;344    
;;;345         event_ptr=lc640_read_int(PTR_EVENT_LOG);
0004fc  4628              MOV      r0,r5
0004fe  f7fffffe          BL       lc640_read_int
000502  4606              MOV      r6,r0
;;;346    	event_ptr_find=event_ptr;
000504  4634              MOV      r4,r6
                  |L1.1286|
;;;347    avar_unet_hndl_lbl1:
;;;348    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000506  eb091544          ADD      r5,r9,r4,LSL #5
;;;349    
;;;350         lc640_read_long_ptr(lc640_adr,data);
00050a  4669              MOV      r1,sp
00050c  4628              MOV      r0,r5
00050e  f7fffffe          BL       lc640_read_long_ptr
;;;351         
;;;352         if(!((data[0]=='P')&&(data[1]==0)&&(data[2]=='A')))
000512  f89d0000          LDRB     r0,[sp,#0]
000516  2850              CMP      r0,#0x50
000518  d106              BNE      |L1.1320|
00051a  f89d0001          LDRB     r0,[sp,#1]
00051e  b918              CBNZ     r0,|L1.1320|
000520  f89d0002          LDRB     r0,[sp,#2]
000524  2841              CMP      r0,#0x41
000526  d008              BEQ      |L1.1338|
                  |L1.1320|
;;;353         	{        
;;;354         	if(event_ptr_find)event_ptr_find--;
000528  b114              CBZ      r4,|L1.1328|
00052a  f1a40401          SUB      r4,r4,#1
00052e  e001              B        |L1.1332|
                  |L1.1328|
;;;355         	else event_ptr_find=63;
000530  f04f043f          MOV      r4,#0x3f
                  |L1.1332|
;;;356         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000534  42b4              CMP      r4,r6
000536  d1e6              BNE      |L1.1286|
000538  e064              B        |L1.1540|
                  |L1.1338|
;;;357         	else goto avar_unet_hndl_lbl1;
;;;358         	}
;;;359         else 
;;;360         	{
;;;361         	lc640_read_long_ptr(lc640_adr+16,data);
00053a  4669              MOV      r1,sp
00053c  f1050010          ADD      r0,r5,#0x10
000540  f7fffffe          BL       lc640_read_long_ptr
;;;362         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000544  f89d0000          LDRB     r0,[sp,#0]
000548  2841              CMP      r0,#0x41
00054a  d10b              BNE      |L1.1380|
00054c  f89d0001          LDRB     r0,[sp,#1]
000550  2841              CMP      r0,#0x41
000552  d107              BNE      |L1.1380|
000554  f89d0002          LDRB     r0,[sp,#2]
000558  2841              CMP      r0,#0x41
00055a  d103              BNE      |L1.1380|
00055c  f89d0003          LDRB     r0,[sp,#3]
000560  2841              CMP      r0,#0x41
000562  d008              BEQ      |L1.1398|
                  |L1.1380|
;;;363         		{        
;;;364         		if(event_ptr_find)event_ptr_find--;
000564  b114              CBZ      r4,|L1.1388|
000566  f1a40401          SUB      r4,r4,#1
00056a  e001              B        |L1.1392|
                  |L1.1388|
;;;365             		else event_ptr_find=63;
00056c  f04f043f          MOV      r4,#0x3f
                  |L1.1392|
;;;366             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000570  42b4              CMP      r4,r6
000572  d1c8              BNE      |L1.1286|
000574  e046              B        |L1.1540|
                  |L1.1398|
;;;367         		else goto avar_unet_hndl_lbl1;
;;;368         		}
;;;369    
;;;370         	}	
;;;371    	
;;;372    	data[0]=LPC_RTC->YEAR;
000576  f1070720          ADD      r7,r7,#0x20
00057a  8bb8              LDRH     r0,[r7,#0x1c]
00057c  f88d0000          STRB     r0,[sp,#0]
;;;373    	data[1]=LPC_RTC->MONTH;
000580  7e38              LDRB     r0,[r7,#0x18]
000582  f88d0001          STRB     r0,[sp,#1]
;;;374    	data[2]=LPC_RTC->DOM;
000586  7b38              LDRB     r0,[r7,#0xc]
000588  f88d0002          STRB     r0,[sp,#2]
;;;375    	data[3]=0;
00058c  f88d8003          STRB     r8,[sp,#3]
;;;376    	lc640_write_long_ptr(lc640_adr+16,data);
000590  4669              MOV      r1,sp
000592  f1050010          ADD      r0,r5,#0x10
000596  f7fffffe          BL       lc640_write_long_ptr
;;;377    
;;;378    	data[0]=LPC_RTC->HOUR;
00059a  7a38              LDRB     r0,[r7,#8]
00059c  f88d0000          STRB     r0,[sp,#0]
;;;379    	data[1]=LPC_RTC->MIN;
0005a0  7938              LDRB     r0,[r7,#4]
0005a2  f88d0001          STRB     r0,[sp,#1]
;;;380    	data[2]=LPC_RTC->SEC;
0005a6  7838              LDRB     r0,[r7,#0]
0005a8  f88d0002          STRB     r0,[sp,#2]
;;;381    	data[3]=0;
0005ac  f88d8003          STRB     r8,[sp,#3]
;;;382    	lc640_write_long_ptr(lc640_adr+20,data); 
0005b0  4669              MOV      r1,sp
0005b2  f1050014          ADD      r0,r5,#0x14
0005b6  f7fffffe          BL       lc640_write_long_ptr
;;;383    	
;;;384    	data[0]=*((char*)(&net_Ustore));
0005ba  48cc              LDR      r0,|L1.2284|
0005bc  7801              LDRB     r1,[r0,#0]  ; net_Ustore
0005be  f88d1000          STRB     r1,[sp,#0]
;;;385    	data[1]=*(((char*)(&net_Ustore))+1);
0005c2  7840              LDRB     r0,[r0,#1]  ; net_Ustore
0005c4  f88d0001          STRB     r0,[sp,#1]
;;;386    	data[2]='B';
0005c8  f04f0442          MOV      r4,#0x42
0005cc  f88d4002          STRB     r4,[sp,#2]
;;;387    	data[3]='B';
0005d0  f88d4003          STRB     r4,[sp,#3]
;;;388    	lc640_write_long_ptr(lc640_adr+24,data);
0005d4  4669              MOV      r1,sp
0005d6  f1050018          ADD      r0,r5,#0x18
0005da  f7fffffe          BL       lc640_write_long_ptr
;;;389    	
;;;390    	data[0]='B';
0005de  f88d4000          STRB     r4,[sp,#0]
;;;391    	data[1]='B';
0005e2  f88d4001          STRB     r4,[sp,#1]
;;;392    	data[2]='B';
0005e6  f88d4002          STRB     r4,[sp,#2]
;;;393    	data[3]='B';
0005ea  f88d4003          STRB     r4,[sp,#3]
;;;394    	lc640_write_long_ptr(lc640_adr+28,data);	
0005ee  4669              MOV      r1,sp
0005f0  f105001c          ADD      r0,r5,#0x1c
0005f4  f7fffffe          BL       lc640_write_long_ptr
;;;395    	
;;;396    /*	memo_out0[0]=0x55;
;;;397         memo_out0[1]=0x00+2;
;;;398         memo_out0[2]=1;
;;;399         memo_out0[3]=0x0b;
;;;400         memo_out0[4]=0xaa;
;;;401         memo_out0[5]=0xaa; 
;;;402         	
;;;403         memo_out0[6]=crc_87(memo_out0,6);
;;;404    	memo_out0[7]=crc_95(memo_out0,6);
;;;405         usart_out_adr0(memo_out0,8); */
;;;406         snmp_trap_send("Main power alarm  clear",2,1,1);	
0005f8  2301              MOVS     r3,#1
0005fa  461a              MOV      r2,r3
0005fc  2102              MOVS     r1,#2
0005fe  a0bc              ADR      r0,|L1.2288|
000600  f7fffffe          BL       snmp_trap_send
                  |L1.1540|
;;;407    	}
;;;408    avar_unet_hndl_end:
;;;409    	__nop();		
000604  bf00              NOP      
                  |L1.1542|
;;;410    }
000606  e8bd83f8          POP      {r3-r9,pc}
;;;411    
                          ENDP

                  avar_uout_hndl PROC
;;;413    //-----------------------------------------------
;;;414    void avar_uout_hndl(char in)
00060a  e92d43f8          PUSH     {r3-r9,lr}
;;;415    {
;;;416    
;;;417    char data[4];
;;;418    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;419    
;;;420    
;;;421    if(in==1)
;;;422    	{
;;;423    	//net_av=1;
;;;424    
;;;425    	//beep_init(0x01L,'O');
;;;426    	//a.av.bAN=1;
;;;427    
;;;428    
;;;429    	//beep_init(0x33333333,'A');
;;;430    
;;;431    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;432    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;433    		 
;;;434    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;435    	event_ptr++;	
;;;436    	if(event_ptr>63)event_ptr=0;	
;;;437    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;438    	
;;;439        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;440    	if(event_cnt!=63)event_cnt=event_ptr;
;;;441    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;442    	
;;;443    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;444    	
;;;445    	data[0]='Q';
;;;446    	data[1]=0;
;;;447    	data[2]='A';
;;;448    	data[3]=0;
;;;449    	lc640_write_long_ptr(lc640_adr,data);
;;;450    
;;;451    	data[0]=0;//*((char*)&Unet_store);
;;;452    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;453    	data[2]=0;
;;;454    	data[3]=0;
;;;455    	lc640_write_long_ptr(lc640_adr+4,data);
;;;456    
;;;457    	data[0]=LPC_RTC->YEAR;
00060e  4fbe              LDR      r7,|L1.2312|
000610  49be              LDR      r1,|L1.2316|
000612  f44f6560          MOV      r5,#0xe00             ;434
000616  f04f0800          MOV      r8,#0                 ;436
00061a  f44f6980          MOV      r9,#0x400             ;443
00061e  2801              CMP      r0,#1                 ;421
000620  d002              BEQ      |L1.1576|
;;;458    	data[1]=LPC_RTC->MONTH;
;;;459    	data[2]=LPC_RTC->DOM;
;;;460    	data[3]=0;
;;;461    	lc640_write_long_ptr(lc640_adr+8,data);
;;;462    
;;;463    	data[0]=LPC_RTC->HOUR;
;;;464    	data[1]=LPC_RTC->MIN;
;;;465    	data[2]=LPC_RTC->SEC;
;;;466    	data[3]=0;
;;;467    	lc640_write_long_ptr(lc640_adr+12,data);
;;;468    	
;;;469    	data[0]='A';
;;;470    	data[1]='A';
;;;471    	data[2]='A';
;;;472    	data[3]='A';
;;;473    	lc640_write_long_ptr(lc640_adr+16,data);
;;;474    	
;;;475    	data[0]='A';
;;;476    	data[1]='A';
;;;477    	data[2]='A';
;;;478    	data[3]='A';
;;;479    	lc640_write_long_ptr(lc640_adr+20,data);
;;;480    	
;;;481    	data[0]='A';
;;;482    	data[1]='A';
;;;483    	data[2]='A';
;;;484    	data[3]='A';
;;;485    	lc640_write_long_ptr(lc640_adr+24,data);
;;;486    	
;;;487    	data[0]='A';
;;;488    	data[1]='A';
;;;489    	data[2]='A';
;;;490    	data[3]='A';
;;;491    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;492    	
;;;493    /*	memo_out0[0]=0x55;
;;;494         memo_out0[1]=0x00+2;
;;;495         memo_out0[2]=1;
;;;496         memo_out0[3]=0x0b;
;;;497         memo_out0[4]=0x55;
;;;498         memo_out0[5]=0x55; 
;;;499         	
;;;500         memo_out0[6]=crc_87(memo_out0,6);
;;;501    	memo_out0[7]=crc_95(memo_out0,6);
;;;502         usart_out_adr0(memo_out0,8); 
;;;503    	*/
;;;504    	//snmp_trap_send("Main power is off",2,1,0);
;;;505    	}
;;;506    
;;;507    else if(in==0)
000622  2800              CMP      r0,#0
000624  d07e              BEQ      |L1.1828|
000626  e126              B        |L1.2166|
                  |L1.1576|
000628  48b9              LDR      r0,|L1.2320|
00062a  4aba              LDR      r2,|L1.2324|
00062c  f9b00000          LDRSH    r0,[r0,#0]            ;431  ; load_U
000630  f9b22000          LDRSH    r2,[r2,#0]            ;431  ; U_OUT_KONTR_MAX
000634  4290              CMP      r0,r2                 ;431
000636  dd02              BLE      |L1.1598|
000638  f04f0201          MOV      r2,#1                 ;431
00063c  700a              STRB     r2,[r1,#0]            ;431
                  |L1.1598|
00063e  4ab6              LDR      r2,|L1.2328|
000640  f9b22000          LDRSH    r2,[r2,#0]            ;432  ; U_OUT_KONTR_MIN
000644  4290              CMP      r0,r2                 ;432
000646  da02              BGE      |L1.1614|
000648  f04f0002          MOV      r0,#2                 ;432
00064c  7008              STRB     r0,[r1,#0]            ;432
                  |L1.1614|
00064e  4628              MOV      r0,r5                 ;434
000650  f7fffffe          BL       lc640_read_int
000654  f1000001          ADD      r0,r0,#1              ;435
000658  4604              MOV      r4,r0                 ;435
00065a  2c3f              CMP      r4,#0x3f              ;436
00065c  d901              BLS      |L1.1634|
00065e  f04f0400          MOV      r4,#0                 ;436
                  |L1.1634|
000662  b221              SXTH     r1,r4                 ;437
000664  4628              MOV      r0,r5                 ;437
000666  f7fffffe          BL       lc640_write_int
00066a  f6406602          MOV      r6,#0xe02             ;439
00066e  4630              MOV      r0,r6                 ;439
000670  f7fffffe          BL       lc640_read_int
000674  283f              CMP      r0,#0x3f              ;440
000676  d000              BEQ      |L1.1658|
000678  4620              MOV      r0,r4                 ;440
                  |L1.1658|
00067a  b201              SXTH     r1,r0                 ;441
00067c  4630              MOV      r0,r6                 ;441
00067e  f7fffffe          BL       lc640_write_int
000682  4628              MOV      r0,r5                 ;443
000684  f7fffffe          BL       lc640_read_int
000688  eb091540          ADD      r5,r9,r0,LSL #5       ;443
00068c  f04f0051          MOV      r0,#0x51              ;445
000690  f88d0000          STRB     r0,[sp,#0]            ;445
000694  f88d8001          STRB     r8,[sp,#1]            ;446
000698  f04f0441          MOV      r4,#0x41              ;447
00069c  f88d4002          STRB     r4,[sp,#2]            ;447
0006a0  f88d8003          STRB     r8,[sp,#3]            ;448
0006a4  4669              MOV      r1,sp                 ;449
0006a6  4628              MOV      r0,r5                 ;449
0006a8  f7fffffe          BL       lc640_write_long_ptr
0006ac  f8cd8000          STR      r8,[sp,#0]            ;454
0006b0  4669              MOV      r1,sp                 ;455
0006b2  1d28              ADDS     r0,r5,#4              ;455
0006b4  f7fffffe          BL       lc640_write_long_ptr
0006b8  f1070720          ADD      r7,r7,#0x20           ;457
0006bc  8bb8              LDRH     r0,[r7,#0x1c]         ;457
0006be  f88d0000          STRB     r0,[sp,#0]            ;457
0006c2  7e38              LDRB     r0,[r7,#0x18]         ;458
0006c4  f88d0001          STRB     r0,[sp,#1]            ;458
0006c8  7b38              LDRB     r0,[r7,#0xc]          ;459
0006ca  f88d0002          STRB     r0,[sp,#2]            ;459
0006ce  f88d8003          STRB     r8,[sp,#3]            ;460
0006d2  4669              MOV      r1,sp                 ;461
0006d4  f1050008          ADD      r0,r5,#8              ;461
0006d8  f7fffffe          BL       lc640_write_long_ptr
0006dc  7a38              LDRB     r0,[r7,#8]            ;463
0006de  f88d0000          STRB     r0,[sp,#0]            ;463
0006e2  7938              LDRB     r0,[r7,#4]            ;464
0006e4  f88d0001          STRB     r0,[sp,#1]            ;464
0006e8  7838              LDRB     r0,[r7,#0]            ;465
0006ea  f88d0002          STRB     r0,[sp,#2]            ;465
0006ee  f88d8003          STRB     r8,[sp,#3]            ;466
0006f2  4669              MOV      r1,sp                 ;467
0006f4  f105000c          ADD      r0,r5,#0xc            ;467
0006f8  f7fffffe          BL       lc640_write_long_ptr
0006fc  f88d4000          STRB     r4,[sp,#0]            ;469
000700  f88d4001          STRB     r4,[sp,#1]            ;470
000704  f88d4002          STRB     r4,[sp,#2]            ;471
000708  f88d4003          STRB     r4,[sp,#3]            ;472
00070c  4669              MOV      r1,sp                 ;473
00070e  f1050010          ADD      r0,r5,#0x10           ;473
000712  f7fffffe          BL       lc640_write_long_ptr
000716  f88d4000          STRB     r4,[sp,#0]            ;475
00071a  f88d4001          STRB     r4,[sp,#1]            ;476
00071e  f88d4002          STRB     r4,[sp,#2]            ;477
000722  e000              B        |L1.1830|
                  |L1.1828|
000724  e021              B        |L1.1898|
                  |L1.1830|
000726  f88d4003          STRB     r4,[sp,#3]            ;478
00072a  4669              MOV      r1,sp                 ;479
00072c  f1050014          ADD      r0,r5,#0x14           ;479
000730  f7fffffe          BL       lc640_write_long_ptr
000734  f88d4000          STRB     r4,[sp,#0]            ;481
000738  f88d4001          STRB     r4,[sp,#1]            ;482
00073c  f88d4002          STRB     r4,[sp,#2]            ;483
000740  f88d4003          STRB     r4,[sp,#3]            ;484
000744  4669              MOV      r1,sp                 ;485
000746  f1050018          ADD      r0,r5,#0x18           ;485
00074a  f7fffffe          BL       lc640_write_long_ptr
00074e  f88d4000          STRB     r4,[sp,#0]            ;487
000752  f88d4001          STRB     r4,[sp,#1]            ;488
000756  f88d4002          STRB     r4,[sp,#2]            ;489
00075a  f88d4003          STRB     r4,[sp,#3]            ;490
00075e  4669              MOV      r1,sp                 ;491
000760  f105001c          ADD      r0,r5,#0x1c           ;491
000764  f7fffffe          BL       lc640_write_long_ptr
000768  e085              B        |L1.2166|
                  |L1.1898|
;;;508    	{
;;;509    	uout_av=0;
00076a  f8818000          STRB     r8,[r1,#0]
;;;510    
;;;511      /*
;;;512    	SET_REG(C2GSR,3,24,8);
;;;513    	C2MOD=0;
;;;514    	bOUT_FREE2=1;*/
;;;515    
;;;516    
;;;517    	//C2MOD=0;
;;;518    
;;;519    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;520    
;;;521         //beep_init(0x02L,'O');
;;;522    	//a_.av.bAN=0;
;;;523    //	SET_REG(avar_stat,0,0,1);
;;;524    
;;;525    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;526    	
;;;527    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;528    
;;;529        event_ptr=lc640_read_int(PTR_EVENT_LOG);
00076e  4628              MOV      r0,r5
000770  f7fffffe          BL       lc640_read_int
000774  4606              MOV      r6,r0
;;;530    	event_ptr_find=event_ptr;
000776  4634              MOV      r4,r6
                  |L1.1912|
;;;531    avar_uout_hndl_lbl1:
;;;532    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000778  eb091544          ADD      r5,r9,r4,LSL #5
;;;533    
;;;534         lc640_read_long_ptr(lc640_adr,data);
00077c  4669              MOV      r1,sp
00077e  4628              MOV      r0,r5
000780  f7fffffe          BL       lc640_read_long_ptr
;;;535         
;;;536         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
000784  f89d0000          LDRB     r0,[sp,#0]
000788  2851              CMP      r0,#0x51
00078a  d106              BNE      |L1.1946|
00078c  f89d0001          LDRB     r0,[sp,#1]
000790  b918              CBNZ     r0,|L1.1946|
000792  f89d0002          LDRB     r0,[sp,#2]
000796  2841              CMP      r0,#0x41
000798  d008              BEQ      |L1.1964|
                  |L1.1946|
;;;537         	{        
;;;538         	if(event_ptr_find)event_ptr_find--;
00079a  b114              CBZ      r4,|L1.1954|
00079c  f1a40401          SUB      r4,r4,#1
0007a0  e001              B        |L1.1958|
                  |L1.1954|
;;;539         	else event_ptr_find=63;
0007a2  f04f043f          MOV      r4,#0x3f
                  |L1.1958|
;;;540         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0007a6  42b4              CMP      r4,r6
0007a8  d1e6              BNE      |L1.1912|
0007aa  e064              B        |L1.2166|
                  |L1.1964|
;;;541         	else goto avar_uout_hndl_lbl1;
;;;542         	}
;;;543         else 
;;;544         	{
;;;545         	lc640_read_long_ptr(lc640_adr+16,data);
0007ac  4669              MOV      r1,sp
0007ae  f1050010          ADD      r0,r5,#0x10
0007b2  f7fffffe          BL       lc640_read_long_ptr
;;;546         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0007b6  f89d0000          LDRB     r0,[sp,#0]
0007ba  2841              CMP      r0,#0x41
0007bc  d10b              BNE      |L1.2006|
0007be  f89d0001          LDRB     r0,[sp,#1]
0007c2  2841              CMP      r0,#0x41
0007c4  d107              BNE      |L1.2006|
0007c6  f89d0002          LDRB     r0,[sp,#2]
0007ca  2841              CMP      r0,#0x41
0007cc  d103              BNE      |L1.2006|
0007ce  f89d0003          LDRB     r0,[sp,#3]
0007d2  2841              CMP      r0,#0x41
0007d4  d008              BEQ      |L1.2024|
                  |L1.2006|
;;;547         		{        
;;;548         		if(event_ptr_find)event_ptr_find--;
0007d6  b114              CBZ      r4,|L1.2014|
0007d8  f1a40401          SUB      r4,r4,#1
0007dc  e001              B        |L1.2018|
                  |L1.2014|
;;;549             		else event_ptr_find=63;
0007de  f04f043f          MOV      r4,#0x3f
                  |L1.2018|
;;;550             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0007e2  42b4              CMP      r4,r6
0007e4  d1c8              BNE      |L1.1912|
0007e6  e046              B        |L1.2166|
                  |L1.2024|
;;;551         		else goto avar_uout_hndl_lbl1;
;;;552         		}
;;;553    
;;;554         	}	
;;;555    	
;;;556    	data[0]=LPC_RTC->YEAR;
0007e8  f1070720          ADD      r7,r7,#0x20
0007ec  8bb8              LDRH     r0,[r7,#0x1c]
0007ee  f88d0000          STRB     r0,[sp,#0]
;;;557    	data[1]=LPC_RTC->MONTH;
0007f2  7e38              LDRB     r0,[r7,#0x18]
0007f4  f88d0001          STRB     r0,[sp,#1]
;;;558    	data[2]=LPC_RTC->DOM;
0007f8  7b38              LDRB     r0,[r7,#0xc]
0007fa  f88d0002          STRB     r0,[sp,#2]
;;;559    	data[3]=0;
0007fe  f88d8003          STRB     r8,[sp,#3]
;;;560    	lc640_write_long_ptr(lc640_adr+16,data);
000802  4669              MOV      r1,sp
000804  f1050010          ADD      r0,r5,#0x10
000808  f7fffffe          BL       lc640_write_long_ptr
;;;561    
;;;562    	data[0]=LPC_RTC->HOUR;
00080c  7a38              LDRB     r0,[r7,#8]
00080e  f88d0000          STRB     r0,[sp,#0]
;;;563    	data[1]=LPC_RTC->MIN;
000812  7938              LDRB     r0,[r7,#4]
000814  f88d0001          STRB     r0,[sp,#1]
;;;564    	data[2]=LPC_RTC->SEC;
000818  7838              LDRB     r0,[r7,#0]
00081a  f88d0002          STRB     r0,[sp,#2]
;;;565    	data[3]=0;
00081e  f88d8003          STRB     r8,[sp,#3]
;;;566    	lc640_write_long_ptr(lc640_adr+20,data); 
000822  4669              MOV      r1,sp
000824  f1050014          ADD      r0,r5,#0x14
000828  f7fffffe          BL       lc640_write_long_ptr
;;;567    	
;;;568    	data[0]=*((char*)(&net_Ustore));
00082c  482f              LDR      r0,|L1.2284|
00082e  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000830  f88d1000          STRB     r1,[sp,#0]
;;;569    	data[1]=*(((char*)(&net_Ustore))+1);
000834  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000836  f88d0001          STRB     r0,[sp,#1]
;;;570    	data[2]='B';
00083a  f04f0442          MOV      r4,#0x42
00083e  f88d4002          STRB     r4,[sp,#2]
;;;571    	data[3]='B';
000842  f88d4003          STRB     r4,[sp,#3]
;;;572    	lc640_write_long_ptr(lc640_adr+24,data);
000846  4669              MOV      r1,sp
000848  f1050018          ADD      r0,r5,#0x18
00084c  f7fffffe          BL       lc640_write_long_ptr
;;;573    	
;;;574    	data[0]='B';
000850  f88d4000          STRB     r4,[sp,#0]
;;;575    	data[1]='B';
000854  f88d4001          STRB     r4,[sp,#1]
;;;576    	data[2]='B';
000858  f88d4002          STRB     r4,[sp,#2]
;;;577    	data[3]='B';
00085c  f88d4003          STRB     r4,[sp,#3]
;;;578    	lc640_write_long_ptr(lc640_adr+28,data);	
000860  4669              MOV      r1,sp
000862  f105001c          ADD      r0,r5,#0x1c
000866  f7fffffe          BL       lc640_write_long_ptr
;;;579    	
;;;580    /*	memo_out0[0]=0x55;
;;;581         memo_out0[1]=0x00+2;
;;;582         memo_out0[2]=1;
;;;583         memo_out0[3]=0x0b;
;;;584         memo_out0[4]=0xaa;
;;;585         memo_out0[5]=0xaa; 
;;;586         	
;;;587         memo_out0[6]=crc_87(memo_out0,6);
;;;588    	memo_out0[7]=crc_95(memo_out0,6);
;;;589         usart_out_adr0(memo_out0,8); */
;;;590         snmp_trap_send("Main power is on",2,1,1);	
00086a  2301              MOVS     r3,#1
00086c  461a              MOV      r2,r3
00086e  2102              MOVS     r1,#2
000870  a02a              ADR      r0,|L1.2332|
000872  f7fffffe          BL       snmp_trap_send
                  |L1.2166|
;;;591    	}
;;;592    avar_unet_hndl_end:
;;;593    	__nop();		
000876  bf00              NOP      
;;;594    }
000878  e6c5              B        |L1.1542|
;;;595    
                          ENDP

                  avar_bps_hndl PROC
;;;596    //-----------------------------------------------
;;;597    void avar_bps_hndl(char dev, char v, char in)
00087a  e92d4ff8          PUSH     {r3-r11,lr}
;;;598    {
00087e  4606              MOV      r6,r0
000880  460c              MOV      r4,r1
;;;599    char data[4];
;;;600    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;601    char avar_simbol;
;;;602    
;;;603    avar_simbol='T';
000882  f04f0754          MOV      r7,#0x54
;;;604    if(v==0)avar_simbol='T';
000886  b174              CBZ      r4,|L1.2214|
;;;605    else if(v==1)avar_simbol='U';
000888  2c01              CMP      r4,#1
00088a  d004              BEQ      |L1.2198|
;;;606    else if(v==2)avar_simbol='u';
00088c  2c02              CMP      r4,#2
00088e  d005              BEQ      |L1.2204|
;;;607    else if(v==3)avar_simbol='L';
000890  2c03              CMP      r4,#3
000892  d006              BEQ      |L1.2210|
000894  e007              B        |L1.2214|
                  |L1.2198|
000896  f04f0755          MOV      r7,#0x55              ;605
00089a  e004              B        |L1.2214|
                  |L1.2204|
00089c  f04f0775          MOV      r7,#0x75              ;606
0008a0  e001              B        |L1.2214|
                  |L1.2210|
0008a2  f04f074c          MOV      r7,#0x4c
                  |L1.2214|
;;;608    
;;;609    if(in==1)
;;;610    	{
;;;611    	//av_src[bps]=1;
;;;612    
;;;613    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;614    //	SET_REG(avar_stat,1,3+dev,1);
;;;615    	
;;;616    	if(v==0)bps[dev]._av|=(1<<0);
0008a6  4822              LDR      r0,|L1.2352|
0008a8  ebc601c6          RSB      r1,r6,r6,LSL #3
;;;617    	else if(v==1) bps[dev]._av|=(1<<1);
;;;618    	else if(v==2) bps[dev]._av|=(1<<2);
;;;619    	else if(v==3) bps[dev]._av|=(1<<3);
;;;620    
;;;621    	bps[dev]._last_avar=v;
;;;622    
;;;623    	//beep_init(0x33333333,'A');
;;;624    
;;;625    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;626    	event_ptr++;	
;;;627    	if(event_ptr>63)event_ptr=0;	
;;;628    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;629    	
;;;630         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;631    	if(event_cnt!=63)event_cnt=event_ptr;
;;;632    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;633    	
;;;634    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;635    	
;;;636    	data[0]='S';
;;;637    	data[1]=dev; 
;;;638    	data[2]=avar_simbol;
;;;639    	data[3]=0;
;;;640    	lc640_write_long_ptr(lc640_adr,data);
;;;641    
;;;642    	data[0]=0;
;;;643    	data[1]=0;
;;;644    	data[2]=0;
;;;645    	data[3]=0;
;;;646    	lc640_write_long_ptr(lc640_adr+4,data);
;;;647    
;;;648    	data[0]=LPC_RTC->YEAR;
0008ac  f8df8058          LDR      r8,|L1.2312|
0008b0  eb011106          ADD      r1,r1,r6,LSL #4       ;616
0008b4  f04f0900          MOV      r9,#0                 ;598
0008b8  f44f6a60          MOV      r10,#0xe00            ;625
0008bc  f44f6580          MOV      r5,#0x400             ;634
0008c0  eb000081          ADD      r0,r0,r1,LSL #2       ;616
0008c4  2a01              CMP      r2,#1                 ;609
0008c6  d035              BEQ      |L1.2356|
;;;649    	data[1]=LPC_RTC->MONTH;
;;;650    	data[2]=LPC_RTC->DOM;
;;;651    	data[3]=0;
;;;652    	lc640_write_long_ptr(lc640_adr+8,data);
;;;653    
;;;654    	data[0]=LPC_RTC->HOUR;
;;;655    	data[1]=LPC_RTC->MIN;
;;;656    	data[2]=LPC_RTC->SEC;
;;;657    	data[3]=0;
;;;658    	lc640_write_long_ptr(lc640_adr+12,data);
;;;659    	
;;;660    	data[0]='A';
;;;661    	data[1]='A';
;;;662    	data[2]='A';
;;;663    	data[3]='A';
;;;664    	lc640_write_long_ptr(lc640_adr+16,data);
;;;665    	
;;;666    	data[0]='A';
;;;667    	data[1]='A';
;;;668    	data[2]='A';
;;;669    	data[3]='A';
;;;670    	lc640_write_long_ptr(lc640_adr+20,data);
;;;671    	
;;;672    	data[0]='A';
;;;673    	data[1]='A';
;;;674    	data[2]='A';
;;;675    	data[3]='A';
;;;676    	lc640_write_long_ptr(lc640_adr+24,data);
;;;677    	
;;;678    	data[0]='A';
;;;679    	data[1]='A';
;;;680    	data[2]='A';
;;;681    	data[3]='A';
;;;682    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;683    
;;;684    
;;;685    	if(dev==0)
;;;686    		{
;;;687    		if(v==0)
;;;688    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;689    		else if(v==1)
;;;690    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;691    		else if(v==2)
;;;692    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;693    		else if(v==3)
;;;694    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;695    		}
;;;696    	else if(dev==1)
;;;697    		{
;;;698    		if(v==0)
;;;699    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;700    		else if(v==1)
;;;701    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;702    		else if(v==2)
;;;703    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;704    		else if(v==3)
;;;705    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;706    		} 
;;;707    	else if(dev==2)
;;;708    		{
;;;709    		if(v==0)
;;;710    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;711    		else if(v==1)
;;;712    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;713    		else if(v==2)
;;;714    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;715    		else if(v==3)
;;;716    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;717    		} 	
;;;718    			
;;;719    	}
;;;720    
;;;721    else if(in==0)
0008c8  2a00              CMP      r2,#0
0008ca  d07d              BEQ      |L1.2504|
0008cc  e1f7              B        |L1.3262|
0008ce  0000              DCW      0x0000
                  |L1.2256|
0008d0  4d61696e          DCB      "Main power alarm",0
0008d4  20706f77
0008d8  65722061
0008dc  6c61726d
0008e0  00      
0008e1  00                DCB      0
0008e2  00                DCB      0
0008e3  00                DCB      0
                  |L1.2276|
                          DCD      ||.data||
                  |L1.2280|
                          DCD      AV_OFF_AVT
                  |L1.2284|
                          DCD      net_Ustore
                  |L1.2288|
0008f0  4d61696e          DCB      "Main power alarm  clear",0
0008f4  20706f77
0008f8  65722061
0008fc  6c61726d
000900  2020636c
000904  65617200
                  |L1.2312|
                          DCD      0x40024000
                  |L1.2316|
                          DCD      uout_av
                  |L1.2320|
                          DCD      load_U
                  |L1.2324|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2328|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2332|
00091c  4d61696e          DCB      "Main power is on",0
000920  20706f77
000924  65722069
000928  73206f6e
00092c  00      
00092d  00                DCB      0
00092e  00                DCB      0
00092f  00                DCB      0
                  |L1.2352|
                          DCD      bps
                  |L1.2356|
000934  b134              CBZ      r4,|L1.2372|
000936  2c01              CMP      r4,#1                 ;617
000938  d009              BEQ      |L1.2382|
00093a  2c02              CMP      r4,#2                 ;618
00093c  d00c              BEQ      |L1.2392|
00093e  2c03              CMP      r4,#3                 ;619
000940  d00f              BEQ      |L1.2402|
000942  e012              B        |L1.2410|
                  |L1.2372|
000944  7841              LDRB     r1,[r0,#1]            ;616
000946  f0410101          ORR      r1,r1,#1              ;616
00094a  7041              STRB     r1,[r0,#1]            ;616
00094c  e00d              B        |L1.2410|
                  |L1.2382|
00094e  7841              LDRB     r1,[r0,#1]            ;617
000950  f0410102          ORR      r1,r1,#2              ;617
000954  7041              STRB     r1,[r0,#1]            ;617
000956  e008              B        |L1.2410|
                  |L1.2392|
000958  7841              LDRB     r1,[r0,#1]            ;618
00095a  f0410104          ORR      r1,r1,#4              ;618
00095e  7041              STRB     r1,[r0,#1]            ;618
000960  e003              B        |L1.2410|
                  |L1.2402|
000962  7841              LDRB     r1,[r0,#1]            ;619
000964  f0410108          ORR      r1,r1,#8              ;619
000968  7041              STRB     r1,[r0,#1]            ;619
                  |L1.2410|
00096a  f8804053          STRB     r4,[r0,#0x53]         ;621
00096e  4650              MOV      r0,r10                ;625
000970  f7fffffe          BL       lc640_read_int
000974  f1000001          ADD      r0,r0,#1              ;626
000978  fa1ffb80          UXTH     r11,r0                ;626
00097c  f1bb0f3f          CMP      r11,#0x3f             ;627
000980  d901              BLS      |L1.2438|
000982  f04f0b00          MOV      r11,#0                ;627
                  |L1.2438|
000986  fa0ff18b          SXTH     r1,r11                ;628
00098a  4650              MOV      r0,r10                ;628
00098c  f7fffffe          BL       lc640_write_int
000990  f6406002          MOV      r0,#0xe02             ;630
000994  f7fffffe          BL       lc640_read_int
000998  b280              UXTH     r0,r0                 ;630
00099a  283f              CMP      r0,#0x3f              ;631
00099c  d000              BEQ      |L1.2464|
00099e  4658              MOV      r0,r11                ;631
                  |L1.2464|
0009a0  b201              SXTH     r1,r0                 ;632
0009a2  f6406002          MOV      r0,#0xe02             ;632
0009a6  f7fffffe          BL       lc640_write_int
0009aa  4650              MOV      r0,r10                ;634
0009ac  f7fffffe          BL       lc640_read_int
0009b0  eb051040          ADD      r0,r5,r0,LSL #5       ;634
0009b4  b285              UXTH     r5,r0                 ;634
0009b6  f04f0053          MOV      r0,#0x53              ;636
0009ba  f88d0000          STRB     r0,[sp,#0]            ;636
0009be  f88d6001          STRB     r6,[sp,#1]            ;637
0009c2  f88d7002          STRB     r7,[sp,#2]            ;638
0009c6  e000              B        |L1.2506|
                  |L1.2504|
0009c8  e0d9              B        |L1.2942|
                  |L1.2506|
0009ca  f88d9003          STRB     r9,[sp,#3]            ;639
0009ce  4669              MOV      r1,sp                 ;640
0009d0  4628              MOV      r0,r5                 ;640
0009d2  f7fffffe          BL       lc640_write_long_ptr
0009d6  f8cd9000          STR      r9,[sp,#0]            ;645
0009da  4669              MOV      r1,sp                 ;646
0009dc  1d28              ADDS     r0,r5,#4              ;646
0009de  f7fffffe          BL       lc640_write_long_ptr
0009e2  f8b8003c          LDRH     r0,[r8,#0x3c]         ;648
0009e6  f88d0000          STRB     r0,[sp,#0]            ;648
0009ea  f8980038          LDRB     r0,[r8,#0x38]         ;649
0009ee  f88d0001          STRB     r0,[sp,#1]            ;649
0009f2  f898002c          LDRB     r0,[r8,#0x2c]         ;650
0009f6  f88d0002          STRB     r0,[sp,#2]            ;650
0009fa  f88d9003          STRB     r9,[sp,#3]            ;651
0009fe  4669              MOV      r1,sp                 ;652
000a00  f1050008          ADD      r0,r5,#8              ;652
000a04  f7fffffe          BL       lc640_write_long_ptr
000a08  f8980028          LDRB     r0,[r8,#0x28]         ;654
000a0c  f88d0000          STRB     r0,[sp,#0]            ;654
000a10  f8980024          LDRB     r0,[r8,#0x24]         ;655
000a14  f88d0001          STRB     r0,[sp,#1]            ;655
000a18  f8980020          LDRB     r0,[r8,#0x20]         ;656
000a1c  f88d0002          STRB     r0,[sp,#2]            ;656
000a20  f88d9003          STRB     r9,[sp,#3]            ;657
000a24  4669              MOV      r1,sp                 ;658
000a26  f105000c          ADD      r0,r5,#0xc            ;658
000a2a  f7fffffe          BL       lc640_write_long_ptr
000a2e  f04f0741          MOV      r7,#0x41              ;660
000a32  f88d7000          STRB     r7,[sp,#0]            ;660
000a36  f88d7001          STRB     r7,[sp,#1]            ;661
000a3a  f88d7002          STRB     r7,[sp,#2]            ;662
000a3e  f88d7003          STRB     r7,[sp,#3]            ;663
000a42  4669              MOV      r1,sp                 ;664
000a44  f1050010          ADD      r0,r5,#0x10           ;664
000a48  f7fffffe          BL       lc640_write_long_ptr
000a4c  f88d7000          STRB     r7,[sp,#0]            ;666
000a50  f88d7001          STRB     r7,[sp,#1]            ;667
000a54  f88d7002          STRB     r7,[sp,#2]            ;668
000a58  f88d7003          STRB     r7,[sp,#3]            ;669
000a5c  4669              MOV      r1,sp                 ;670
000a5e  f1050014          ADD      r0,r5,#0x14           ;670
000a62  f7fffffe          BL       lc640_write_long_ptr
000a66  f88d7000          STRB     r7,[sp,#0]            ;672
000a6a  f88d7001          STRB     r7,[sp,#1]            ;673
000a6e  f88d7002          STRB     r7,[sp,#2]            ;674
000a72  f88d7003          STRB     r7,[sp,#3]            ;675
000a76  4669              MOV      r1,sp                 ;676
000a78  f1050018          ADD      r0,r5,#0x18           ;676
000a7c  f7fffffe          BL       lc640_write_long_ptr
000a80  f88d7000          STRB     r7,[sp,#0]            ;678
000a84  f88d7001          STRB     r7,[sp,#1]            ;679
000a88  f88d7002          STRB     r7,[sp,#2]            ;680
000a8c  f88d7003          STRB     r7,[sp,#3]            ;681
000a90  4669              MOV      r1,sp                 ;682
000a92  f105001c          ADD      r0,r5,#0x1c           ;682
000a96  f7fffffe          BL       lc640_write_long_ptr
000a9a  b126              CBZ      r6,|L1.2726|
000a9c  2e01              CMP      r6,#1                 ;696
000a9e  d026              BEQ      |L1.2798|
000aa0  2e02              CMP      r6,#2                 ;707
000aa2  d048              BEQ      |L1.2870|
000aa4  e10b              B        |L1.3262|
                  |L1.2726|
000aa6  b134              CBZ      r4,|L1.2742|
000aa8  2c01              CMP      r4,#1                 ;689
000aaa  d00b              BEQ      |L1.2756|
000aac  2c02              CMP      r4,#2                 ;691
000aae  d010              BEQ      |L1.2770|
000ab0  2c03              CMP      r4,#3                 ;693
000ab2  d015              BEQ      |L1.2784|
000ab4  e103              B        |L1.3262|
                  |L1.2742|
000ab6  2300              MOVS     r3,#0                 ;688
000ab8  2201              MOVS     r2,#1                 ;688
000aba  2104              MOVS     r1,#4                 ;688
000abc  a0d7              ADR      r0,|L1.3612|
000abe  f7fffffe          BL       snmp_trap_send
000ac2  e0fc              B        |L1.3262|
                  |L1.2756|
000ac4  2301              MOVS     r3,#1                 ;690
000ac6  461a              MOV      r2,r3                 ;690
000ac8  2104              MOVS     r1,#4                 ;690
000aca  a0da              ADR      r0,|L1.3636|
000acc  f7fffffe          BL       snmp_trap_send
000ad0  e0f5              B        |L1.3262|
                  |L1.2770|
000ad2  2302              MOVS     r3,#2                 ;692
000ad4  2201              MOVS     r2,#1                 ;692
000ad6  2104              MOVS     r1,#4                 ;692
000ad8  a0dd              ADR      r0,|L1.3664|
000ada  f7fffffe          BL       snmp_trap_send
000ade  e0ee              B        |L1.3262|
                  |L1.2784|
000ae0  2303              MOVS     r3,#3                 ;694
000ae2  2201              MOVS     r2,#1                 ;694
000ae4  2104              MOVS     r1,#4                 ;694
000ae6  a0e2              ADR      r0,|L1.3696|
000ae8  f7fffffe          BL       snmp_trap_send
000aec  e0e7              B        |L1.3262|
                  |L1.2798|
000aee  b134              CBZ      r4,|L1.2814|
000af0  2c01              CMP      r4,#1                 ;700
000af2  d00b              BEQ      |L1.2828|
000af4  2c02              CMP      r4,#2                 ;702
000af6  d010              BEQ      |L1.2842|
000af8  2c03              CMP      r4,#3                 ;704
000afa  d015              BEQ      |L1.2856|
000afc  e0df              B        |L1.3262|
                  |L1.2814|
000afe  2300              MOVS     r3,#0                 ;699
000b00  2202              MOVS     r2,#2                 ;699
000b02  2104              MOVS     r1,#4                 ;699
000b04  a0e2              ADR      r0,|L1.3728|
000b06  f7fffffe          BL       snmp_trap_send
000b0a  e0d8              B        |L1.3262|
                  |L1.2828|
000b0c  2301              MOVS     r3,#1                 ;701
000b0e  2202              MOVS     r2,#2                 ;701
000b10  2104              MOVS     r1,#4                 ;701
000b12  a0e5              ADR      r0,|L1.3752|
000b14  f7fffffe          BL       snmp_trap_send
000b18  e0d1              B        |L1.3262|
                  |L1.2842|
000b1a  2302              MOVS     r3,#2                 ;703
000b1c  461a              MOV      r2,r3                 ;703
000b1e  2104              MOVS     r1,#4                 ;703
000b20  a0e8              ADR      r0,|L1.3780|
000b22  f7fffffe          BL       snmp_trap_send
000b26  e0ca              B        |L1.3262|
                  |L1.2856|
000b28  2303              MOVS     r3,#3                 ;705
000b2a  2202              MOVS     r2,#2                 ;705
000b2c  2104              MOVS     r1,#4                 ;705
000b2e  a0ed              ADR      r0,|L1.3812|
000b30  f7fffffe          BL       snmp_trap_send
000b34  e0c3              B        |L1.3262|
                  |L1.2870|
000b36  b134              CBZ      r4,|L1.2886|
000b38  2c01              CMP      r4,#1                 ;711
000b3a  d00b              BEQ      |L1.2900|
000b3c  2c02              CMP      r4,#2                 ;713
000b3e  d010              BEQ      |L1.2914|
000b40  2c03              CMP      r4,#3                 ;715
000b42  d015              BEQ      |L1.2928|
000b44  e0bb              B        |L1.3262|
                  |L1.2886|
000b46  2300              MOVS     r3,#0                 ;710
000b48  2203              MOVS     r2,#3                 ;710
000b4a  2104              MOVS     r1,#4                 ;710
000b4c  a0ed              ADR      r0,|L1.3844|
000b4e  f7fffffe          BL       snmp_trap_send
000b52  e0b4              B        |L1.3262|
                  |L1.2900|
000b54  2301              MOVS     r3,#1                 ;712
000b56  2203              MOVS     r2,#3                 ;712
000b58  2104              MOVS     r1,#4                 ;712
000b5a  a0f0              ADR      r0,|L1.3868|
000b5c  f7fffffe          BL       snmp_trap_send
000b60  e0ad              B        |L1.3262|
                  |L1.2914|
000b62  2302              MOVS     r3,#2                 ;714
000b64  2203              MOVS     r2,#3                 ;714
000b66  2104              MOVS     r1,#4                 ;714
000b68  a0f3              ADR      r0,|L1.3896|
000b6a  f7fffffe          BL       snmp_trap_send
000b6e  e0a6              B        |L1.3262|
                  |L1.2928|
000b70  2303              MOVS     r3,#3                 ;716
000b72  461a              MOV      r2,r3                 ;716
000b74  2104              MOVS     r1,#4                 ;716
000b76  a0f8              ADR      r0,|L1.3928|
000b78  f7fffffe          BL       snmp_trap_send
000b7c  e09f              B        |L1.3262|
                  |L1.2942|
;;;722    	{      
;;;723    //	av_bps[bps]=0;
;;;724    
;;;725    	//SET_REG(avar_stat,0,3+bps,1);
;;;726    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;727    
;;;728         if(v==0) bps[dev]._av&=(~(1<<0));
000b7e  b134              CBZ      r4,|L1.2958|
;;;729         else if(v==1) bps[dev]._av&=(~(1<<1));
000b80  2c01              CMP      r4,#1
000b82  d009              BEQ      |L1.2968|
;;;730    	else if(v==2) bps[dev]._av&=(~(1<<2));
000b84  2c02              CMP      r4,#2
000b86  d00c              BEQ      |L1.2978|
;;;731    	else if(v==3) bps[dev]._av&=(~(1<<3));
000b88  2c03              CMP      r4,#3
000b8a  d00f              BEQ      |L1.2988|
000b8c  e012              B        |L1.2996|
                  |L1.2958|
000b8e  7841              LDRB     r1,[r0,#1]            ;728
000b90  f0210101          BIC      r1,r1,#1              ;728
000b94  7041              STRB     r1,[r0,#1]            ;728
000b96  e00d              B        |L1.2996|
                  |L1.2968|
000b98  7841              LDRB     r1,[r0,#1]            ;729
000b9a  f0210102          BIC      r1,r1,#2              ;729
000b9e  7041              STRB     r1,[r0,#1]            ;729
000ba0  e008              B        |L1.2996|
                  |L1.2978|
000ba2  7841              LDRB     r1,[r0,#1]            ;730
000ba4  f0210104          BIC      r1,r1,#4              ;730
000ba8  7041              STRB     r1,[r0,#1]            ;730
000baa  e003              B        |L1.2996|
                  |L1.2988|
000bac  7841              LDRB     r1,[r0,#1]
000bae  f0210108          BIC      r1,r1,#8
000bb2  7041              STRB     r1,[r0,#1]
                  |L1.2996|
;;;732         
;;;733    //	if((bps[dev]._av&0x0f==0))
;;;734    //	     {
;;;735    		//SET_REG(avar_stat,0,3+bps,1);
;;;736    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;737    //	     }
;;;738     
;;;739    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000bb4  4650              MOV      r0,r10
000bb6  f7fffffe          BL       lc640_read_int
000bba  fa1ffb80          UXTH     r11,r0
;;;740    	event_ptr_find=event_ptr;
000bbe  465c              MOV      r4,r11
                  |L1.3008|
;;;741    	
;;;742    avar_src_hndl_lbl1: 
;;;743    
;;;744    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000bc0  eb051044          ADD      r0,r5,r4,LSL #5
000bc4  fa1ffa80          UXTH     r10,r0
;;;745    
;;;746         lc640_read_long_ptr(lc640_adr,data);
000bc8  4669              MOV      r1,sp
000bca  4650              MOV      r0,r10
000bcc  f7fffffe          BL       lc640_read_long_ptr
;;;747         
;;;748         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000bd0  f89d0000          LDRB     r0,[sp,#0]
000bd4  2853              CMP      r0,#0x53
000bd6  d107              BNE      |L1.3048|
000bd8  f89d0001          LDRB     r0,[sp,#1]
000bdc  42b0              CMP      r0,r6
000bde  d103              BNE      |L1.3048|
000be0  f89d0002          LDRB     r0,[sp,#2]
000be4  42b8              CMP      r0,r7
000be6  d009              BEQ      |L1.3068|
                  |L1.3048|
;;;749         	{        
;;;750         	if(event_ptr_find)event_ptr_find--;
000be8  b11c              CBZ      r4,|L1.3058|
000bea  f1a40401          SUB      r4,r4,#1
000bee  b2a4              UXTH     r4,r4
000bf0  e001              B        |L1.3062|
                  |L1.3058|
;;;751         	else event_ptr_find=63;
000bf2  f04f043f          MOV      r4,#0x3f
                  |L1.3062|
;;;752         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000bf6  455c              CMP      r4,r11
000bf8  d1e2              BNE      |L1.3008|
000bfa  e060              B        |L1.3262|
                  |L1.3068|
;;;753         	else goto avar_src_hndl_lbl1;
;;;754         	}
;;;755         else 
;;;756         	{
;;;757         	lc640_read_long_ptr(lc640_adr+16,data);
000bfc  4669              MOV      r1,sp
000bfe  f10a0010          ADD      r0,r10,#0x10
000c02  f7fffffe          BL       lc640_read_long_ptr
;;;758         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000c06  f89d0000          LDRB     r0,[sp,#0]
000c0a  2841              CMP      r0,#0x41
000c0c  d10b              BNE      |L1.3110|
000c0e  f89d0001          LDRB     r0,[sp,#1]
000c12  2841              CMP      r0,#0x41
000c14  d107              BNE      |L1.3110|
000c16  f89d0002          LDRB     r0,[sp,#2]
000c1a  2841              CMP      r0,#0x41
000c1c  d103              BNE      |L1.3110|
000c1e  f89d0003          LDRB     r0,[sp,#3]
000c22  2841              CMP      r0,#0x41
000c24  d009              BEQ      |L1.3130|
                  |L1.3110|
;;;759         		{        
;;;760         		if(event_ptr_find)event_ptr_find--;
000c26  b11c              CBZ      r4,|L1.3120|
000c28  f1a40401          SUB      r4,r4,#1
000c2c  b2a4              UXTH     r4,r4
000c2e  e001              B        |L1.3124|
                  |L1.3120|
;;;761             		else event_ptr_find=63;
000c30  f04f043f          MOV      r4,#0x3f
                  |L1.3124|
;;;762             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000c34  455c              CMP      r4,r11
000c36  d1c3              BNE      |L1.3008|
000c38  e041              B        |L1.3262|
                  |L1.3130|
;;;763         		else goto avar_src_hndl_lbl1;
;;;764         		}
;;;765    
;;;766         	}	
;;;767    
;;;768    
;;;769    	
;;;770    	data[0]=LPC_RTC->YEAR;
000c3a  f8b8003c          LDRH     r0,[r8,#0x3c]
000c3e  f88d0000          STRB     r0,[sp,#0]
;;;771    	data[1]=LPC_RTC->MONTH;
000c42  f8980038          LDRB     r0,[r8,#0x38]
000c46  f88d0001          STRB     r0,[sp,#1]
;;;772    	data[2]=LPC_RTC->DOM;
000c4a  f898002c          LDRB     r0,[r8,#0x2c]
000c4e  f88d0002          STRB     r0,[sp,#2]
;;;773    	data[3]=0;
000c52  f88d9003          STRB     r9,[sp,#3]
;;;774    	lc640_write_long_ptr(lc640_adr+16,data);
000c56  4669              MOV      r1,sp
000c58  f10a0010          ADD      r0,r10,#0x10
000c5c  f7fffffe          BL       lc640_write_long_ptr
;;;775    
;;;776    	data[0]=LPC_RTC->HOUR;
000c60  f8980028          LDRB     r0,[r8,#0x28]
000c64  f88d0000          STRB     r0,[sp,#0]
;;;777    	data[1]=LPC_RTC->MIN;
000c68  f8980024          LDRB     r0,[r8,#0x24]
000c6c  f88d0001          STRB     r0,[sp,#1]
;;;778    	data[2]=LPC_RTC->SEC;
000c70  f8980020          LDRB     r0,[r8,#0x20]
000c74  f88d0002          STRB     r0,[sp,#2]
;;;779    	data[3]=0;
000c78  f88d9003          STRB     r9,[sp,#3]
;;;780    	lc640_write_long_ptr(lc640_adr+20,data);
000c7c  4669              MOV      r1,sp
000c7e  f10a0014          ADD      r0,r10,#0x14
000c82  f7fffffe          BL       lc640_write_long_ptr
;;;781    	
;;;782    	data[0]='B';
000c86  f04f0442          MOV      r4,#0x42
000c8a  f88d4000          STRB     r4,[sp,#0]
;;;783    	data[1]='B';
000c8e  f88d4001          STRB     r4,[sp,#1]
;;;784    	data[2]='B';
000c92  f88d4002          STRB     r4,[sp,#2]
;;;785    	data[3]='B';
000c96  f88d4003          STRB     r4,[sp,#3]
;;;786    	lc640_write_long_ptr(lc640_adr+24,data);
000c9a  4669              MOV      r1,sp
000c9c  f10a0018          ADD      r0,r10,#0x18
000ca0  f7fffffe          BL       lc640_write_long_ptr
;;;787    	
;;;788    	data[0]='B';
000ca4  f88d4000          STRB     r4,[sp,#0]
;;;789    	data[1]='B';
000ca8  f88d4001          STRB     r4,[sp,#1]
;;;790    	data[2]='B';
000cac  f88d4002          STRB     r4,[sp,#2]
;;;791    	data[3]='B';
000cb0  f88d4003          STRB     r4,[sp,#3]
;;;792    	lc640_write_long_ptr(lc640_adr+28,data);
000cb4  4669              MOV      r1,sp
000cb6  f10a001c          ADD      r0,r10,#0x1c
000cba  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3262|
;;;793    	
;;;794    	}
;;;795    	
;;;796    avar_src_hndl_end:
;;;797    __nop();		
000cbe  bf00              NOP      
                  |L1.3264|
;;;798    }
000cc0  e8bd8ff8          POP      {r3-r11,pc}
;;;799    
                          ENDP

                  wrk_mem_hndl PROC
;;;800    //-----------------------------------------------
;;;801    void wrk_mem_hndl(char b)
000cc4  e92d41fc          PUSH     {r2-r8,lr}
;;;802    {
000cc8  4606              MOV      r6,r0
;;;803    char data[4];
;;;804    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;805    
;;;806    signed short temp_temp;
;;;807    
;;;808    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000cca  eb060046          ADD      r0,r6,r6,LSL #1
000cce  eb001106          ADD      r1,r0,r6,LSL #4
000cd2  48a9              LDR      r0,|L1.3960|
000cd4  eb000481          ADD      r4,r0,r1,LSL #2
000cd8  8be0              LDRH     r0,[r4,#0x1e]
000cda  2805              CMP      r0,#5
000cdc  d37e              BCC      |L1.3548|
;;;809    
;;;810    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000cde  48a7              LDR      r0,|L1.3964|
000ce0  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000ce2  f1000006          ADD      r0,r0,#6
000ce6  f0000007          AND      r0,r0,#7
000cea  eb040040          ADD      r0,r4,r0,LSL #1
000cee  8c00              LDRH     r0,[r0,#0x20]
000cf0  9000              STR      r0,[sp,#0]
;;;811    
;;;812    
;;;813    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000cf2  f44f6760          MOV      r7,#0xe00
000cf6  4638              MOV      r0,r7
000cf8  f7fffffe          BL       lc640_read_int
;;;814    event_ptr++;	
000cfc  f1000001          ADD      r0,r0,#1
000d00  b285              UXTH     r5,r0
;;;815    if(event_ptr>63)event_ptr=0;	
000d02  2d3f              CMP      r5,#0x3f
000d04  d901              BLS      |L1.3338|
000d06  f04f0500          MOV      r5,#0
                  |L1.3338|
;;;816    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000d0a  b229              SXTH     r1,r5
000d0c  4638              MOV      r0,r7
000d0e  f7fffffe          BL       lc640_write_int
;;;817    	
;;;818    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000d12  f6406802          MOV      r8,#0xe02
000d16  4640              MOV      r0,r8
000d18  f7fffffe          BL       lc640_read_int
000d1c  b280              UXTH     r0,r0
;;;819    if(event_cnt!=63)event_cnt=event_ptr;
000d1e  283f              CMP      r0,#0x3f
000d20  d000              BEQ      |L1.3364|
000d22  4628              MOV      r0,r5
                  |L1.3364|
;;;820    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000d24  b201              SXTH     r1,r0
000d26  4640              MOV      r0,r8
000d28  f7fffffe          BL       lc640_write_int
;;;821    	
;;;822    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000d2c  4638              MOV      r0,r7
000d2e  f7fffffe          BL       lc640_read_int
000d32  f44f6180          MOV      r1,#0x400
000d36  eb011040          ADD      r0,r1,r0,LSL #5
000d3a  b285              UXTH     r5,r0
;;;823    	
;;;824    data[0]='B';
000d3c  f04f0042          MOV      r0,#0x42
000d40  f88d0004          STRB     r0,[sp,#4]
;;;825    data[1]=b; 
000d44  f88d6005          STRB     r6,[sp,#5]
;;;826    data[2]='W';
000d48  f04f0057          MOV      r0,#0x57
000d4c  f88d0006          STRB     r0,[sp,#6]
;;;827    data[3]=0;
000d50  f04f0600          MOV      r6,#0
000d54  f88d6007          STRB     r6,[sp,#7]
;;;828    
;;;829    lc640_write_long_ptr(lc640_adr,data);
000d58  a901              ADD      r1,sp,#4
000d5a  4628              MOV      r0,r5
000d5c  f7fffffe          BL       lc640_write_long_ptr
;;;830    
;;;831    data[0]=*((char*)&bat[b]._Iintegr_);
000d60  7fa0              LDRB     r0,[r4,#0x1e]
000d62  f88d0004          STRB     r0,[sp,#4]
;;;832    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000d66  7fe0              LDRB     r0,[r4,#0x1f]
000d68  f88d0005          STRB     r0,[sp,#5]
;;;833    data[2]=*((char*)&temp_temp);
000d6c  f89d0000          LDRB     r0,[sp,#0]
000d70  f88d0006          STRB     r0,[sp,#6]
;;;834    data[3]=*(((char*)(&temp_temp))+1);
000d74  f89d0001          LDRB     r0,[sp,#1]
000d78  f88d0007          STRB     r0,[sp,#7]
;;;835    lc640_write_long_ptr(lc640_adr+4,data);
000d7c  a901              ADD      r1,sp,#4
000d7e  1d28              ADDS     r0,r5,#4
000d80  f7fffffe          BL       lc640_write_long_ptr
;;;836    
;;;837    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000d84  f1040134          ADD      r1,r4,#0x34
000d88  f1050008          ADD      r0,r5,#8
000d8c  f7fffffe          BL       lc640_write_long_ptr
;;;838    	
;;;839    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000d90  f1040138          ADD      r1,r4,#0x38
000d94  f105000c          ADD      r0,r5,#0xc
000d98  f7fffffe          BL       lc640_write_long_ptr
;;;840    
;;;841    data[0]=LPC_RTC->YEAR;
000d9c  4c78              LDR      r4,|L1.3968|
000d9e  8ba0              LDRH     r0,[r4,#0x1c]
000da0  f88d0004          STRB     r0,[sp,#4]
;;;842    data[1]=LPC_RTC->MONTH;
000da4  7e20              LDRB     r0,[r4,#0x18]
000da6  f88d0005          STRB     r0,[sp,#5]
;;;843    data[2]=LPC_RTC->DOM;
000daa  7b20              LDRB     r0,[r4,#0xc]
000dac  f88d0006          STRB     r0,[sp,#6]
;;;844    data[3]=0;
000db0  f88d6007          STRB     r6,[sp,#7]
;;;845    lc640_write_long_ptr(lc640_adr+16,data);
000db4  a901              ADD      r1,sp,#4
000db6  f1050010          ADD      r0,r5,#0x10
000dba  f7fffffe          BL       lc640_write_long_ptr
;;;846    
;;;847    data[0]=LPC_RTC->HOUR;
000dbe  7a20              LDRB     r0,[r4,#8]
000dc0  f88d0004          STRB     r0,[sp,#4]
;;;848    data[1]=LPC_RTC->MIN;
000dc4  7920              LDRB     r0,[r4,#4]
000dc6  f88d0005          STRB     r0,[sp,#5]
;;;849    data[2]=LPC_RTC->SEC;
000dca  7820              LDRB     r0,[r4,#0]
000dcc  f88d0006          STRB     r0,[sp,#6]
;;;850    data[3]=0;
000dd0  f88d6007          STRB     r6,[sp,#7]
;;;851    lc640_write_long_ptr(lc640_adr+20,data);
000dd4  a901              ADD      r1,sp,#4
000dd6  f1050014          ADD      r0,r5,#0x14
000dda  e000              B        |L1.3550|
                  |L1.3548|
000ddc  e001              B        |L1.3554|
                  |L1.3550|
000dde  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3554|
;;;852    	
;;;853    
;;;854    
;;;855    	
;;;856    wrk_mem_hndl_end:	
;;;857    __nop();
000de2  bf00              NOP      
;;;858    }  
000de4  e8bd81fc          POP      {r2-r8,pc}
;;;859    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;861    //-----------------------------------------------
;;;862    void avar_bat_ips_hndl(char in)
000de8  e92d4ff8          PUSH     {r3-r11,lr}
;;;863    {
000dec  4602              MOV      r2,r0
;;;864    char data[4];
;;;865    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;866    
;;;867    if(in==1)
;;;868    	{
;;;869    	bat_ips._av|=1;
000dee  4865              LDR      r0,|L1.3972|
;;;870        ips_bat_av_stat=1;
000df0  4c65              LDR      r4,|L1.3976|
;;;871    	ips_bat_av_vzvod=1;
000df2  4b66              LDR      r3,|L1.3980|
;;;872    
;;;873    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;874    	event_ptr++;	
;;;875    	if(event_ptr>63)event_ptr=0;	
;;;876    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;877    	
;;;878         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;879    	if(event_cnt!=63)event_cnt=event_ptr;
;;;880    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;881    	
;;;882    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;883    	
;;;884    	data[0]='B';
;;;885    	data[1]=0;
;;;886    	data[2]='C';
;;;887    	data[3]=0;
;;;888    	lc640_write_long_ptr(lc640_adr,data);
;;;889    
;;;890    	data[0]=0;
;;;891    	data[1]=0;
;;;892    	data[2]=0;
;;;893    	data[3]=0;
;;;894    	lc640_write_long_ptr(lc640_adr+4,data);
;;;895    
;;;896    	data[0]=LPC_RTC->YEAR;
000df4  f8df8198          LDR      r8,|L1.3984|
000df8  f890103d          LDRB     r1,[r0,#0x3d]         ;869
000dfc  f04f0742          MOV      r7,#0x42              ;884
000e00  f44f6560          MOV      r5,#0xe00             ;873
000e04  f04f0900          MOV      r9,#0                 ;875
000e08  f44f6a80          MOV      r10,#0x400            ;882
000e0c  2a01              CMP      r2,#1                 ;867
000e0e  d002              BEQ      |L1.3606|
;;;897    	data[1]=LPC_RTC->MONTH;
;;;898    	data[2]=LPC_RTC->DOM;
;;;899    	data[3]=0;
;;;900    	lc640_write_long_ptr(lc640_adr+8,data);
;;;901    
;;;902    	data[0]=LPC_RTC->HOUR;
;;;903    	data[1]=LPC_RTC->MIN;
;;;904    	data[2]=LPC_RTC->SEC;
;;;905    	data[3]=0;
;;;906    	lc640_write_long_ptr(lc640_adr+12,data);
;;;907    	
;;;908    	data[0]='A';
;;;909    	data[1]='A';
;;;910    	data[2]='A';
;;;911    	data[3]='A';
;;;912    	lc640_write_long_ptr(lc640_adr+16,data);
;;;913    	
;;;914    	data[0]='A';
;;;915    	data[1]='A';
;;;916    	data[2]='A';
;;;917    	data[3]='A';
;;;918    	lc640_write_long_ptr(lc640_adr+20,data);
;;;919    	
;;;920    	data[0]='A';
;;;921    	data[1]='A';
;;;922    	data[2]='A';
;;;923    	data[3]='A';
;;;924    	lc640_write_long_ptr(lc640_adr+24,data);
;;;925    	
;;;926    	data[0]='A';
;;;927    	data[1]='A';
;;;928    	data[2]='A';
;;;929    	data[3]='A';
;;;930    	lc640_write_long_ptr(lc640_adr+28,data);
;;;931    					
;;;932    	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;933    		
;;;934    	}
;;;935    
;;;936    else if(in==0)
000e10  2a00              CMP      r2,#0
000e12  d001              BEQ      |L1.3608|
000e14  e1e6              B        |L1.4580|
                  |L1.3606|
000e16  e0bd              B        |L1.3988|
                  |L1.3608|
000e18  e15c              B        |L1.4308|
000e1a  0000              DCW      0x0000
                  |L1.3612|
000e1c  42505320          DCB      "BPS #1 Alarm, overheat",0
000e20  23312041
000e24  6c61726d
000e28  2c206f76
000e2c  65726865
000e30  617400  
000e33  00                DCB      0
                  |L1.3636|
000e34  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000e38  23312041
000e3c  6c61726d
000e40  2c20766f
000e44  6c746167
000e48  65206973
000e4c  20757000
                  |L1.3664|
000e50  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000e54  23312041
000e58  6c61726d
000e5c  2c20766f
000e60  6c746167
000e64  65206973
000e68  20646f77
000e6c  6e00    
000e6e  00                DCB      0
000e6f  00                DCB      0
                  |L1.3696|
000e70  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000e74  23312041
000e78  6c61726d
000e7c  2c20636f
000e80  6e6e6563
000e84  74206973
000e88  206c6f73
000e8c  7400    
000e8e  00                DCB      0
000e8f  00                DCB      0
                  |L1.3728|
000e90  42505320          DCB      "BPS #2 Alarm, overheat",0
000e94  23322041
000e98  6c61726d
000e9c  2c206f76
000ea0  65726865
000ea4  617400  
000ea7  00                DCB      0
                  |L1.3752|
000ea8  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000eac  23322041
000eb0  6c61726d
000eb4  2c20766f
000eb8  6c746167
000ebc  65206973
000ec0  20757000
                  |L1.3780|
000ec4  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000ec8  23322041
000ecc  6c61726d
000ed0  2c20766f
000ed4  6c746167
000ed8  65206973
000edc  20646f77
000ee0  6e00    
000ee2  00                DCB      0
000ee3  00                DCB      0
                  |L1.3812|
000ee4  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000ee8  23322041
000eec  6c61726d
000ef0  2c20636f
000ef4  6e6e6563
000ef8  74206973
000efc  206c6f73
000f00  7400    
000f02  00                DCB      0
000f03  00                DCB      0
                  |L1.3844|
000f04  42505320          DCB      "BPS #3 Alarm, overheat",0
000f08  23332041
000f0c  6c61726d
000f10  2c206f76
000f14  65726865
000f18  617400  
000f1b  00                DCB      0
                  |L1.3868|
000f1c  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000f20  23332041
000f24  6c61726d
000f28  2c20766f
000f2c  6c746167
000f30  65206973
000f34  20757000
                  |L1.3896|
000f38  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000f3c  23332041
000f40  6c61726d
000f44  2c20766f
000f48  6c746167
000f4c  65206973
000f50  20646f77
000f54  6e00    
000f56  00                DCB      0
000f57  00                DCB      0
                  |L1.3928|
000f58  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000f5c  23332041
000f60  6c61726d
000f64  2c20636f
000f68  6e6e6563
000f6c  74206973
000f70  206c6f73
000f74  7400    
000f76  00                DCB      0
000f77  00                DCB      0
                  |L1.3960|
                          DCD      bat
                  |L1.3964|
                          DCD      bat_u_old_cnt
                  |L1.3968|
                          DCD      0x40024020
                  |L1.3972|
                          DCD      bat_ips
                  |L1.3976|
                          DCD      ips_bat_av_stat
                  |L1.3980|
                          DCD      ips_bat_av_vzvod
                  |L1.3984|
                          DCD      0x40024000
                  |L1.3988|
000f94  f0410101          ORR      r1,r1,#1              ;869
000f98  f880103d          STRB     r1,[r0,#0x3d]         ;869
000f9c  f04f0001          MOV      r0,#1                 ;870
000fa0  7020              STRB     r0,[r4,#0]            ;870
000fa2  7018              STRB     r0,[r3,#0]            ;871
000fa4  4628              MOV      r0,r5                 ;873
000fa6  f7fffffe          BL       lc640_read_int
000faa  f1000001          ADD      r0,r0,#1              ;874
000fae  b284              UXTH     r4,r0                 ;874
000fb0  2c3f              CMP      r4,#0x3f              ;875
000fb2  d901              BLS      |L1.4024|
000fb4  f04f0400          MOV      r4,#0                 ;875
                  |L1.4024|
000fb8  b221              SXTH     r1,r4                 ;876
000fba  4628              MOV      r0,r5                 ;876
000fbc  f7fffffe          BL       lc640_write_int
000fc0  f6406602          MOV      r6,#0xe02             ;878
000fc4  4630              MOV      r0,r6                 ;878
000fc6  f7fffffe          BL       lc640_read_int
000fca  b281              UXTH     r1,r0                 ;878
000fcc  293f              CMP      r1,#0x3f              ;879
000fce  d000              BEQ      |L1.4050|
000fd0  4621              MOV      r1,r4                 ;879
                  |L1.4050|
000fd2  b209              SXTH     r1,r1                 ;880
000fd4  4630              MOV      r0,r6                 ;880
000fd6  f7fffffe          BL       lc640_write_int
000fda  4628              MOV      r0,r5                 ;882
000fdc  f7fffffe          BL       lc640_read_int
000fe0  eb0a1040          ADD      r0,r10,r0,LSL #5      ;882
000fe4  b284              UXTH     r4,r0                 ;882
000fe6  f88d7000          STRB     r7,[sp,#0]            ;884
000fea  f88d9001          STRB     r9,[sp,#1]            ;885
000fee  f04f0043          MOV      r0,#0x43              ;886
000ff2  f88d0002          STRB     r0,[sp,#2]            ;886
000ff6  f88d9003          STRB     r9,[sp,#3]            ;887
000ffa  4669              MOV      r1,sp                 ;888
000ffc  4620              MOV      r0,r4                 ;888
000ffe  f7fffffe          BL       lc640_write_long_ptr
001002  f8cd9000          STR      r9,[sp,#0]            ;893
001006  4669              MOV      r1,sp                 ;894
001008  1d20              ADDS     r0,r4,#4              ;894
00100a  f7fffffe          BL       lc640_write_long_ptr
00100e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;896
001012  f88d0000          STRB     r0,[sp,#0]            ;896
001016  f8980038          LDRB     r0,[r8,#0x38]         ;897
00101a  f88d0001          STRB     r0,[sp,#1]            ;897
00101e  f898002c          LDRB     r0,[r8,#0x2c]         ;898
001022  f88d0002          STRB     r0,[sp,#2]            ;898
001026  f88d9003          STRB     r9,[sp,#3]            ;899
00102a  4669              MOV      r1,sp                 ;900
00102c  f1040008          ADD      r0,r4,#8              ;900
001030  f7fffffe          BL       lc640_write_long_ptr
001034  f8980028          LDRB     r0,[r8,#0x28]         ;902
001038  f88d0000          STRB     r0,[sp,#0]            ;902
00103c  f8980024          LDRB     r0,[r8,#0x24]         ;903
001040  f88d0001          STRB     r0,[sp,#1]            ;903
001044  f8980020          LDRB     r0,[r8,#0x20]         ;904
001048  f88d0002          STRB     r0,[sp,#2]            ;904
00104c  f88d9003          STRB     r9,[sp,#3]            ;905
001050  4669              MOV      r1,sp                 ;906
001052  f104000c          ADD      r0,r4,#0xc            ;906
001056  f7fffffe          BL       lc640_write_long_ptr
00105a  f04f0541          MOV      r5,#0x41              ;908
00105e  f88d5000          STRB     r5,[sp,#0]            ;908
001062  f88d5001          STRB     r5,[sp,#1]            ;909
001066  f88d5002          STRB     r5,[sp,#2]            ;910
00106a  f88d5003          STRB     r5,[sp,#3]            ;911
00106e  4669              MOV      r1,sp                 ;912
001070  f1040010          ADD      r0,r4,#0x10           ;912
001074  f7fffffe          BL       lc640_write_long_ptr
001078  f88d5000          STRB     r5,[sp,#0]            ;914
00107c  f88d5001          STRB     r5,[sp,#1]            ;915
001080  f88d5002          STRB     r5,[sp,#2]            ;916
001084  f88d5003          STRB     r5,[sp,#3]            ;917
001088  4669              MOV      r1,sp                 ;918
00108a  f1040014          ADD      r0,r4,#0x14           ;918
00108e  f7fffffe          BL       lc640_write_long_ptr
001092  f88d5000          STRB     r5,[sp,#0]            ;920
001096  f88d5001          STRB     r5,[sp,#1]            ;921
00109a  f88d5002          STRB     r5,[sp,#2]            ;922
00109e  f88d5003          STRB     r5,[sp,#3]            ;923
0010a2  4669              MOV      r1,sp                 ;924
0010a4  f1040018          ADD      r0,r4,#0x18           ;924
0010a8  f7fffffe          BL       lc640_write_long_ptr
0010ac  f88d5000          STRB     r5,[sp,#0]            ;926
0010b0  f88d5001          STRB     r5,[sp,#1]            ;927
0010b4  f88d5002          STRB     r5,[sp,#2]            ;928
0010b8  f88d5003          STRB     r5,[sp,#3]            ;929
0010bc  4669              MOV      r1,sp                 ;930
0010be  f104001c          ADD      r0,r4,#0x1c           ;930
0010c2  f7fffffe          BL       lc640_write_long_ptr
0010c6  2301              MOVS     r3,#1                 ;932
0010c8  461a              MOV      r2,r3                 ;932
0010ca  2105              MOVS     r1,#5                 ;932
0010cc  a0ff              ADR      r0,|L1.5324|
0010ce  f7fffffe          BL       snmp_trap_send
0010d2  e087              B        |L1.4580|
                  |L1.4308|
;;;937    	{
;;;938    	bat_ips._av&=~1;
0010d4  f0210101          BIC      r1,r1,#1
0010d8  f880103d          STRB     r1,[r0,#0x3d]
;;;939    	ips_bat_av_stat=0;
0010dc  f8849000          STRB     r9,[r4,#0]
;;;940    	ips_bat_av_vzvod=0;
0010e0  f8839000          STRB     r9,[r3,#0]
;;;941         
;;;942    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0010e4  4628              MOV      r0,r5
0010e6  f7fffffe          BL       lc640_read_int
0010ea  b286              UXTH     r6,r0
;;;943    	event_ptr_find=event_ptr;
0010ec  4634              MOV      r4,r6
                  |L1.4334|
;;;944    	
;;;945    avar_bat_ips_hndl_lbl1: 
;;;946    
;;;947    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0010ee  eb0a1044          ADD      r0,r10,r4,LSL #5
0010f2  b285              UXTH     r5,r0
;;;948    
;;;949         lc640_read_long_ptr(lc640_adr,data);
0010f4  4669              MOV      r1,sp
0010f6  4628              MOV      r0,r5
0010f8  f7fffffe          BL       lc640_read_long_ptr
;;;950         
;;;951         if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
0010fc  f89d0000          LDRB     r0,[sp,#0]
001100  2842              CMP      r0,#0x42
001102  d106              BNE      |L1.4370|
001104  f89d0001          LDRB     r0,[sp,#1]
001108  b918              CBNZ     r0,|L1.4370|
00110a  f89d0002          LDRB     r0,[sp,#2]
00110e  2843              CMP      r0,#0x43
001110  d009              BEQ      |L1.4390|
                  |L1.4370|
;;;952         	{        
;;;953         	if(event_ptr_find)event_ptr_find--;
001112  b11c              CBZ      r4,|L1.4380|
001114  f1a40401          SUB      r4,r4,#1
001118  b2a4              UXTH     r4,r4
00111a  e001              B        |L1.4384|
                  |L1.4380|
;;;954         	else event_ptr_find=63;
00111c  f04f043f          MOV      r4,#0x3f
                  |L1.4384|
;;;955         	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001120  42b4              CMP      r4,r6
001122  d1e4              BNE      |L1.4334|
001124  e05e              B        |L1.4580|
                  |L1.4390|
;;;956         	else goto avar_bat_ips_hndl_lbl1;
;;;957         	}
;;;958         else 
;;;959         	{
;;;960         	lc640_read_long_ptr(lc640_adr+16,data);
001126  4669              MOV      r1,sp
001128  f1050010          ADD      r0,r5,#0x10
00112c  f7fffffe          BL       lc640_read_long_ptr
;;;961         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001130  f89d0000          LDRB     r0,[sp,#0]
001134  2841              CMP      r0,#0x41
001136  d10b              BNE      |L1.4432|
001138  f89d0001          LDRB     r0,[sp,#1]
00113c  2841              CMP      r0,#0x41
00113e  d107              BNE      |L1.4432|
001140  f89d0002          LDRB     r0,[sp,#2]
001144  2841              CMP      r0,#0x41
001146  d103              BNE      |L1.4432|
001148  f89d0003          LDRB     r0,[sp,#3]
00114c  2841              CMP      r0,#0x41
00114e  d009              BEQ      |L1.4452|
                  |L1.4432|
;;;962         		{        
;;;963         		if(event_ptr_find)event_ptr_find--;
001150  b11c              CBZ      r4,|L1.4442|
001152  f1a40401          SUB      r4,r4,#1
001156  b2a4              UXTH     r4,r4
001158  e001              B        |L1.4446|
                  |L1.4442|
;;;964             		else event_ptr_find=63;
00115a  f04f043f          MOV      r4,#0x3f
                  |L1.4446|
;;;965             	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
00115e  42b4              CMP      r4,r6
001160  d1c5              BNE      |L1.4334|
001162  e03f              B        |L1.4580|
                  |L1.4452|
;;;966         		else goto avar_bat_ips_hndl_lbl1;
;;;967         		}
;;;968    
;;;969         	}
;;;970         		
;;;971    	data[0]=LPC_RTC->YEAR;
001164  f8b8003c          LDRH     r0,[r8,#0x3c]
001168  f88d0000          STRB     r0,[sp,#0]
;;;972    	data[1]=LPC_RTC->MONTH;
00116c  f8980038          LDRB     r0,[r8,#0x38]
001170  f88d0001          STRB     r0,[sp,#1]
;;;973    	data[2]=LPC_RTC->DOM;
001174  f898002c          LDRB     r0,[r8,#0x2c]
001178  f88d0002          STRB     r0,[sp,#2]
;;;974    	data[3]=0;
00117c  f88d9003          STRB     r9,[sp,#3]
;;;975    	lc640_write_long_ptr(lc640_adr+16,data);
001180  4669              MOV      r1,sp
001182  f1050010          ADD      r0,r5,#0x10
001186  f7fffffe          BL       lc640_write_long_ptr
;;;976    
;;;977    	data[0]=LPC_RTC->HOUR;
00118a  f8980028          LDRB     r0,[r8,#0x28]
00118e  f88d0000          STRB     r0,[sp,#0]
;;;978    	data[1]=LPC_RTC->MIN;
001192  f8980024          LDRB     r0,[r8,#0x24]
001196  f88d0001          STRB     r0,[sp,#1]
;;;979    	data[2]=LPC_RTC->SEC;
00119a  f8980020          LDRB     r0,[r8,#0x20]
00119e  f88d0002          STRB     r0,[sp,#2]
;;;980    	data[3]=0;
0011a2  f88d9003          STRB     r9,[sp,#3]
;;;981    	lc640_write_long_ptr(lc640_adr+20,data);
0011a6  4669              MOV      r1,sp
0011a8  f1050014          ADD      r0,r5,#0x14
0011ac  f7fffffe          BL       lc640_write_long_ptr
;;;982    	
;;;983    	data[0]='B';
0011b0  f88d7000          STRB     r7,[sp,#0]
;;;984    	data[1]='B';
0011b4  f88d7001          STRB     r7,[sp,#1]
;;;985    	data[2]='B';
0011b8  f88d7002          STRB     r7,[sp,#2]
;;;986    	data[3]='B';
0011bc  f88d7003          STRB     r7,[sp,#3]
;;;987    	lc640_write_long_ptr(lc640_adr+24,data);
0011c0  4669              MOV      r1,sp
0011c2  f1050018          ADD      r0,r5,#0x18
0011c6  f7fffffe          BL       lc640_write_long_ptr
;;;988    	
;;;989    	data[0]='B';
0011ca  f88d7000          STRB     r7,[sp,#0]
;;;990    	data[1]='B';
0011ce  f88d7001          STRB     r7,[sp,#1]
;;;991    	data[2]='B';
0011d2  f88d7002          STRB     r7,[sp,#2]
;;;992    	data[3]='B';
0011d6  f88d7003          STRB     r7,[sp,#3]
;;;993    	lc640_write_long_ptr(lc640_adr+28,data);
0011da  4669              MOV      r1,sp
0011dc  f105001c          ADD      r0,r5,#0x1c
0011e0  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4580|
;;;994    	
;;;995    
;;;996    	
;;;997    	}
;;;998    	
;;;999    avar_bat_ips_hndl_end:
;;;1000   __nop();		
0011e4  bf00              NOP      
                  |L1.4582|
;;;1001   }
0011e6  e56b              B        |L1.3264|
;;;1002   
                          ENDP

                  avar_bat_hndl PROC
;;;1005   //-----------------------------------------------
;;;1006   void avar_bat_hndl(char b, char in)
0011e8  e92d4ff8          PUSH     {r3-r11,lr}
;;;1007   {
0011ec  4606              MOV      r6,r0
;;;1008   char data[4];
;;;1009   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1010   
;;;1011   if(in==1)
;;;1012   	{
;;;1013   	bat[b]._av|=1;
0011ee  48bc              LDR      r0,|L1.5344|
0011f0  eb060246          ADD      r2,r6,r6,LSL #1
;;;1014       
;;;1015   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1016   	event_ptr++;	
;;;1017   	if(event_ptr>63)event_ptr=0;	
;;;1018   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1019   	
;;;1020        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1021   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1022   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1023   	
;;;1024   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1025   	
;;;1026   	data[0]='B';
;;;1027   	data[1]=b;
;;;1028   	data[2]='C';
;;;1029   	data[3]=0;
;;;1030   	lc640_write_long_ptr(lc640_adr,data);
;;;1031   
;;;1032   	data[0]=0;
;;;1033   	data[1]=0;
;;;1034   	data[2]=0;
;;;1035   	data[3]=0;
;;;1036   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1037   
;;;1038   	data[0]=LPC_RTC->YEAR;
0011f4  f8df82ec          LDR      r8,|L1.5348|
0011f8  eb021206          ADD      r2,r2,r6,LSL #4       ;1013
0011fc  f04f0a00          MOV      r10,#0                ;1017
001200  f04f0942          MOV      r9,#0x42              ;1026
001204  f44f6560          MOV      r5,#0xe00             ;1015
001208  f44f6b80          MOV      r11,#0x400            ;1024
00120c  eb000082          ADD      r0,r0,r2,LSL #2       ;1013
001210  2901              CMP      r1,#1                 ;1011
001212  d002              BEQ      |L1.4634|
;;;1039   	data[1]=LPC_RTC->MONTH;
;;;1040   	data[2]=LPC_RTC->DOM;
;;;1041   	data[3]=0;
;;;1042   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1043   
;;;1044   	data[0]=LPC_RTC->HOUR;
;;;1045   	data[1]=LPC_RTC->MIN;
;;;1046   	data[2]=LPC_RTC->SEC;
;;;1047   	data[3]=0;
;;;1048   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1049   	
;;;1050   	data[0]='A';
;;;1051   	data[1]='A';
;;;1052   	data[2]='A';
;;;1053   	data[3]='A';
;;;1054   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1055   	
;;;1056   	data[0]='A';
;;;1057   	data[1]='A';
;;;1058   	data[2]='A';
;;;1059   	data[3]='A';
;;;1060   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1061   	
;;;1062   	data[0]='A';
;;;1063   	data[1]='A';
;;;1064   	data[2]='A';
;;;1065   	data[3]='A';
;;;1066   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1067   	
;;;1068   	data[0]='A';
;;;1069   	data[1]='A';
;;;1070   	data[2]='A';
;;;1071   	data[3]='A';
;;;1072   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1073   					
;;;1074   	if(b==0)
;;;1075   		{
;;;1076   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1077   		}
;;;1078   	else if(b==1)
;;;1079   		{
;;;1080   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1081   		} 
;;;1082   			
;;;1083   	}
;;;1084   
;;;1085   else if(in==0)
001214  2900              CMP      r1,#0
001216  d07d              BEQ      |L1.4884|
001218  e12f              B        |L1.5242|
                  |L1.4634|
00121a  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1013
00121e  f0410101          ORR      r1,r1,#1              ;1013
001222  7001              STRB     r1,[r0,#0]            ;1013
001224  4628              MOV      r0,r5                 ;1015
001226  f7fffffe          BL       lc640_read_int
00122a  f1000001          ADD      r0,r0,#1              ;1016
00122e  b284              UXTH     r4,r0                 ;1016
001230  2c3f              CMP      r4,#0x3f              ;1017
001232  d901              BLS      |L1.4664|
001234  f04f0400          MOV      r4,#0                 ;1017
                  |L1.4664|
001238  b221              SXTH     r1,r4                 ;1018
00123a  4628              MOV      r0,r5                 ;1018
00123c  f7fffffe          BL       lc640_write_int
001240  f6406702          MOV      r7,#0xe02             ;1020
001244  4638              MOV      r0,r7                 ;1020
001246  f7fffffe          BL       lc640_read_int
00124a  b280              UXTH     r0,r0                 ;1020
00124c  283f              CMP      r0,#0x3f              ;1021
00124e  d000              BEQ      |L1.4690|
001250  4620              MOV      r0,r4                 ;1021
                  |L1.4690|
001252  b201              SXTH     r1,r0                 ;1022
001254  4638              MOV      r0,r7                 ;1022
001256  f7fffffe          BL       lc640_write_int
00125a  4628              MOV      r0,r5                 ;1024
00125c  f7fffffe          BL       lc640_read_int
001260  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1024
001264  b284              UXTH     r4,r0                 ;1024
001266  f88d9000          STRB     r9,[sp,#0]            ;1026
00126a  f88d6001          STRB     r6,[sp,#1]            ;1027
00126e  f04f0043          MOV      r0,#0x43              ;1028
001272  f88d0002          STRB     r0,[sp,#2]            ;1028
001276  f88da003          STRB     r10,[sp,#3]           ;1029
00127a  4669              MOV      r1,sp                 ;1030
00127c  4620              MOV      r0,r4                 ;1030
00127e  f7fffffe          BL       lc640_write_long_ptr
001282  f8cda000          STR      r10,[sp,#0]           ;1035
001286  4669              MOV      r1,sp                 ;1036
001288  1d20              ADDS     r0,r4,#4              ;1036
00128a  f7fffffe          BL       lc640_write_long_ptr
00128e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1038
001292  f88d0000          STRB     r0,[sp,#0]            ;1038
001296  f8980038          LDRB     r0,[r8,#0x38]         ;1039
00129a  f88d0001          STRB     r0,[sp,#1]            ;1039
00129e  f898002c          LDRB     r0,[r8,#0x2c]         ;1040
0012a2  f88d0002          STRB     r0,[sp,#2]            ;1040
0012a6  f88da003          STRB     r10,[sp,#3]           ;1041
0012aa  4669              MOV      r1,sp                 ;1042
0012ac  f1040008          ADD      r0,r4,#8              ;1042
0012b0  f7fffffe          BL       lc640_write_long_ptr
0012b4  f8980028          LDRB     r0,[r8,#0x28]         ;1044
0012b8  f88d0000          STRB     r0,[sp,#0]            ;1044
0012bc  f8980024          LDRB     r0,[r8,#0x24]         ;1045
0012c0  f88d0001          STRB     r0,[sp,#1]            ;1045
0012c4  f8980020          LDRB     r0,[r8,#0x20]         ;1046
0012c8  f88d0002          STRB     r0,[sp,#2]            ;1046
0012cc  f88da003          STRB     r10,[sp,#3]           ;1047
0012d0  4669              MOV      r1,sp                 ;1048
0012d2  f104000c          ADD      r0,r4,#0xc            ;1048
0012d6  f7fffffe          BL       lc640_write_long_ptr
0012da  f04f0541          MOV      r5,#0x41              ;1050
0012de  f88d5000          STRB     r5,[sp,#0]            ;1050
0012e2  f88d5001          STRB     r5,[sp,#1]            ;1051
0012e6  f88d5002          STRB     r5,[sp,#2]            ;1052
0012ea  f88d5003          STRB     r5,[sp,#3]            ;1053
0012ee  4669              MOV      r1,sp                 ;1054
0012f0  f1040010          ADD      r0,r4,#0x10           ;1054
0012f4  f7fffffe          BL       lc640_write_long_ptr
0012f8  f88d5000          STRB     r5,[sp,#0]            ;1056
0012fc  f88d5001          STRB     r5,[sp,#1]            ;1057
001300  f88d5002          STRB     r5,[sp,#2]            ;1058
001304  f88d5003          STRB     r5,[sp,#3]            ;1059
001308  4669              MOV      r1,sp                 ;1060
00130a  f1040014          ADD      r0,r4,#0x14           ;1060
00130e  f7fffffe          BL       lc640_write_long_ptr
001312  e000              B        |L1.4886|
                  |L1.4884|
001314  e02b              B        |L1.4974|
                  |L1.4886|
001316  f88d5000          STRB     r5,[sp,#0]            ;1062
00131a  f88d5001          STRB     r5,[sp,#1]            ;1063
00131e  f88d5002          STRB     r5,[sp,#2]            ;1064
001322  f88d5003          STRB     r5,[sp,#3]            ;1065
001326  4669              MOV      r1,sp                 ;1066
001328  f1040018          ADD      r0,r4,#0x18           ;1066
00132c  f7fffffe          BL       lc640_write_long_ptr
001330  f88d5000          STRB     r5,[sp,#0]            ;1068
001334  f88d5001          STRB     r5,[sp,#1]            ;1069
001338  f88d5002          STRB     r5,[sp,#2]            ;1070
00133c  f88d5003          STRB     r5,[sp,#3]            ;1071
001340  4669              MOV      r1,sp                 ;1072
001342  f104001c          ADD      r0,r4,#0x1c           ;1072
001346  f7fffffe          BL       lc640_write_long_ptr
00134a  b116              CBZ      r6,|L1.4946|
00134c  2e01              CMP      r6,#1                 ;1078
00134e  d007              BEQ      |L1.4960|
001350  e093              B        |L1.5242|
                  |L1.4946|
001352  2301              MOVS     r3,#1                 ;1076
001354  461a              MOV      r2,r3                 ;1076
001356  2105              MOVS     r1,#5                 ;1076
001358  a063              ADR      r0,|L1.5352|
00135a  f7fffffe          BL       snmp_trap_send
00135e  e08c              B        |L1.5242|
                  |L1.4960|
001360  2301              MOVS     r3,#1                 ;1080
001362  2202              MOVS     r2,#2                 ;1080
001364  2105              MOVS     r1,#5                 ;1080
001366  a065              ADR      r0,|L1.5372|
001368  f7fffffe          BL       snmp_trap_send
00136c  e085              B        |L1.5242|
                  |L1.4974|
;;;1086   	{
;;;1087   	bat[b]._av&=~1;
00136e  f8101f3d          LDRB     r1,[r0,#0x3d]!
001372  f0210101          BIC      r1,r1,#1
001376  7001              STRB     r1,[r0,#0]
;;;1088   
;;;1089        event_ptr=lc640_read_int(PTR_EVENT_LOG);
001378  4628              MOV      r0,r5
00137a  f7fffffe          BL       lc640_read_int
00137e  b287              UXTH     r7,r0
;;;1090   	event_ptr_find=event_ptr;
001380  463c              MOV      r4,r7
                  |L1.4994|
;;;1091   	
;;;1092   avar_bat_hndl_lbl1: 
;;;1093   
;;;1094   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001382  eb0b1044          ADD      r0,r11,r4,LSL #5
001386  b285              UXTH     r5,r0
;;;1095   
;;;1096        lc640_read_long_ptr(lc640_adr,data);
001388  4669              MOV      r1,sp
00138a  4628              MOV      r0,r5
00138c  f7fffffe          BL       lc640_read_long_ptr
;;;1097        
;;;1098        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
001390  f89d0000          LDRB     r0,[sp,#0]
001394  2842              CMP      r0,#0x42
001396  d107              BNE      |L1.5032|
001398  f89d0001          LDRB     r0,[sp,#1]
00139c  42b0              CMP      r0,r6
00139e  d103              BNE      |L1.5032|
0013a0  f89d0002          LDRB     r0,[sp,#2]
0013a4  2843              CMP      r0,#0x43
0013a6  d009              BEQ      |L1.5052|
                  |L1.5032|
;;;1099        	{        
;;;1100        	if(event_ptr_find)event_ptr_find--;
0013a8  b11c              CBZ      r4,|L1.5042|
0013aa  f1a40401          SUB      r4,r4,#1
0013ae  b2a4              UXTH     r4,r4
0013b0  e001              B        |L1.5046|
                  |L1.5042|
;;;1101        	else event_ptr_find=63;
0013b2  f04f043f          MOV      r4,#0x3f
                  |L1.5046|
;;;1102        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
0013b6  42bc              CMP      r4,r7
0013b8  d1e3              BNE      |L1.4994|
0013ba  e05e              B        |L1.5242|
                  |L1.5052|
;;;1103        	else goto avar_bat_hndl_lbl1;
;;;1104        	}
;;;1105        else 
;;;1106        	{
;;;1107        	lc640_read_long_ptr(lc640_adr+16,data);
0013bc  4669              MOV      r1,sp
0013be  f1050010          ADD      r0,r5,#0x10
0013c2  f7fffffe          BL       lc640_read_long_ptr
;;;1108        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0013c6  f89d0000          LDRB     r0,[sp,#0]
0013ca  2841              CMP      r0,#0x41
0013cc  d10b              BNE      |L1.5094|
0013ce  f89d0001          LDRB     r0,[sp,#1]
0013d2  2841              CMP      r0,#0x41
0013d4  d107              BNE      |L1.5094|
0013d6  f89d0002          LDRB     r0,[sp,#2]
0013da  2841              CMP      r0,#0x41
0013dc  d103              BNE      |L1.5094|
0013de  f89d0003          LDRB     r0,[sp,#3]
0013e2  2841              CMP      r0,#0x41
0013e4  d009              BEQ      |L1.5114|
                  |L1.5094|
;;;1109        		{        
;;;1110        		if(event_ptr_find)event_ptr_find--;
0013e6  b11c              CBZ      r4,|L1.5104|
0013e8  f1a40401          SUB      r4,r4,#1
0013ec  b2a4              UXTH     r4,r4
0013ee  e001              B        |L1.5108|
                  |L1.5104|
;;;1111            		else event_ptr_find=63;
0013f0  f04f043f          MOV      r4,#0x3f
                  |L1.5108|
;;;1112            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
0013f4  42bc              CMP      r4,r7
0013f6  d1c4              BNE      |L1.4994|
0013f8  e03f              B        |L1.5242|
                  |L1.5114|
;;;1113        		else goto avar_bat_hndl_lbl1;
;;;1114        		}
;;;1115   
;;;1116        	}
;;;1117        		
;;;1118   	data[0]=LPC_RTC->YEAR;
0013fa  f8b8003c          LDRH     r0,[r8,#0x3c]
0013fe  f88d0000          STRB     r0,[sp,#0]
;;;1119   	data[1]=LPC_RTC->MONTH;
001402  f8980038          LDRB     r0,[r8,#0x38]
001406  f88d0001          STRB     r0,[sp,#1]
;;;1120   	data[2]=LPC_RTC->DOM;
00140a  f898002c          LDRB     r0,[r8,#0x2c]
00140e  f88d0002          STRB     r0,[sp,#2]
;;;1121   	data[3]=0;
001412  f88da003          STRB     r10,[sp,#3]
;;;1122   	lc640_write_long_ptr(lc640_adr+16,data);
001416  4669              MOV      r1,sp
001418  f1050010          ADD      r0,r5,#0x10
00141c  f7fffffe          BL       lc640_write_long_ptr
;;;1123   
;;;1124   	data[0]=LPC_RTC->HOUR;
001420  f8980028          LDRB     r0,[r8,#0x28]
001424  f88d0000          STRB     r0,[sp,#0]
;;;1125   	data[1]=LPC_RTC->MIN;
001428  f8980024          LDRB     r0,[r8,#0x24]
00142c  f88d0001          STRB     r0,[sp,#1]
;;;1126   	data[2]=LPC_RTC->SEC;
001430  f8980020          LDRB     r0,[r8,#0x20]
001434  f88d0002          STRB     r0,[sp,#2]
;;;1127   	data[3]=0;
001438  f88da003          STRB     r10,[sp,#3]
;;;1128   	lc640_write_long_ptr(lc640_adr+20,data);
00143c  4669              MOV      r1,sp
00143e  f1050014          ADD      r0,r5,#0x14
001442  f7fffffe          BL       lc640_write_long_ptr
;;;1129   	
;;;1130   	data[0]='B';
001446  f88d9000          STRB     r9,[sp,#0]
;;;1131   	data[1]='B';
00144a  f88d9001          STRB     r9,[sp,#1]
;;;1132   	data[2]='B';
00144e  f88d9002          STRB     r9,[sp,#2]
;;;1133   	data[3]='B';
001452  f88d9003          STRB     r9,[sp,#3]
;;;1134   	lc640_write_long_ptr(lc640_adr+24,data);
001456  4669              MOV      r1,sp
001458  f1050018          ADD      r0,r5,#0x18
00145c  f7fffffe          BL       lc640_write_long_ptr
;;;1135   	
;;;1136   	data[0]='B';
001460  f88d9000          STRB     r9,[sp,#0]
;;;1137   	data[1]='B';
001464  f88d9001          STRB     r9,[sp,#1]
;;;1138   	data[2]='B';
001468  f88d9002          STRB     r9,[sp,#2]
;;;1139   	data[3]='B';
00146c  f88d9003          STRB     r9,[sp,#3]
;;;1140   	lc640_write_long_ptr(lc640_adr+28,data);
001470  4669              MOV      r1,sp
001472  f105001c          ADD      r0,r5,#0x1c
001476  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5242|
;;;1141   	
;;;1142   
;;;1143   	
;;;1144   	}
;;;1145   	
;;;1146   avar_bat_hndl_end:
;;;1147   __nop();		
00147a  bf00              NOP      
                  |L1.5244|
;;;1148   }
00147c  e420              B        |L1.3264|
;;;1149   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1150   //-----------------------------------------------
;;;1151   void avar_bat_as_hndl(char b, char in)
00147e  e92d4ff8          PUSH     {r3-r11,lr}
;;;1152   {
001482  4606              MOV      r6,r0
;;;1153   char data[4];
;;;1154   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1155   
;;;1156   if(in==1)
;;;1157   	{
;;;1158   	bat[b]._av|=2;
;;;1159       
;;;1160   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1161   	event_ptr++;	
;;;1162   	if(event_ptr>63)event_ptr=0;	
;;;1163   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1164   	
;;;1165        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1166   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1167   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1168   	
;;;1169   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1170   	
;;;1171   	data[0]='B';
;;;1172   	data[1]=b;
;;;1173   	data[2]='S';
;;;1174   	data[3]=0;
;;;1175   	lc640_write_long_ptr(lc640_adr,data);
;;;1176   
;;;1177   	data[0]=0;
;;;1178   	data[1]=0;
;;;1179   	data[2]=0;
;;;1180   	data[3]=0;
;;;1181   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1182   
;;;1183   	data[0]=LPC_RTC->YEAR;
001484  f8df805c          LDR      r8,|L1.5348|
001488  f04f0a00          MOV      r10,#0                ;1162
00148c  f04f0942          MOV      r9,#0x42              ;1171
001490  f44f6560          MOV      r5,#0xe00             ;1160
001494  f44f6b80          MOV      r11,#0x400            ;1169
001498  2901              CMP      r1,#1                 ;1156
00149a  d002              BEQ      |L1.5282|
;;;1184   	data[1]=LPC_RTC->MONTH;
;;;1185   	data[2]=LPC_RTC->DOM;
;;;1186   	data[3]=0;
;;;1187   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1188   
;;;1189   	data[0]=LPC_RTC->HOUR;
;;;1190   	data[1]=LPC_RTC->MIN;
;;;1191   	data[2]=LPC_RTC->SEC;
;;;1192   	data[3]=0;
;;;1193   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1194   	
;;;1195   	data[0]='A';
;;;1196   	data[1]='A';
;;;1197   	data[2]='A';
;;;1198   	data[3]='A';
;;;1199   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1200   	
;;;1201   	data[0]='A';
;;;1202   	data[1]='A';
;;;1203   	data[2]='A';
;;;1204   	data[3]='A';
;;;1205   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1206   	
;;;1207   	data[0]='A';
;;;1208   	data[1]='A';
;;;1209   	data[2]='A';
;;;1210   	data[3]='A';
;;;1211   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1212   	
;;;1213   	data[0]='A';
;;;1214   	data[1]='A';
;;;1215   	data[2]='A';
;;;1216   	data[3]='A';
;;;1217   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1218   
;;;1219   	if(b==0)
;;;1220   		{
;;;1221   		snmp_trap_send("BAT #1 Alarm, assimetry",5,1,2);
;;;1222   		}
;;;1223   	else if(b==1)
;;;1224   		{
;;;1225   		snmp_trap_send("BAT #2 Alarm, assimetry",5,2,2);
;;;1226   		} 
;;;1227   	
;;;1228   	}
;;;1229   
;;;1230   else if(in==0)
00149c  2900              CMP      r1,#0
00149e  d07e              BEQ      |L1.5534|
0014a0  e154              B        |L1.5964|
                  |L1.5282|
0014a2  eb060046          ADD      r0,r6,r6,LSL #1       ;1158
0014a6  eb001106          ADD      r1,r0,r6,LSL #4       ;1158
0014aa  480d              LDR      r0,|L1.5344|
0014ac  eb000081          ADD      r0,r0,r1,LSL #2       ;1158
0014b0  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1158
0014b4  f0410102          ORR      r1,r1,#2              ;1158
0014b8  7001              STRB     r1,[r0,#0]            ;1158
0014ba  4628              MOV      r0,r5                 ;1160
0014bc  f7fffffe          BL       lc640_read_int
0014c0  f1000001          ADD      r0,r0,#1              ;1161
0014c4  b284              UXTH     r4,r0                 ;1161
0014c6  2c3f              CMP      r4,#0x3f              ;1162
0014c8  d924              BLS      |L1.5396|
0014ca  e021              B        |L1.5392|
                  |L1.5324|
0014cc  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
0014d0  b9312041
0014d4  6c61726d
0014d8  2c206c6f
0014dc  737400  
0014df  00                DCB      0
                  |L1.5344|
                          DCD      bat
                  |L1.5348|
                          DCD      0x40024000
                  |L1.5352|
0014e8  42415420          DCB      "BAT #1 Alarm, lost",0
0014ec  23312041
0014f0  6c61726d
0014f4  2c206c6f
0014f8  737400  
0014fb  00                DCB      0
                  |L1.5372|
0014fc  42415420          DCB      "BAT #2 Alarm, lost",0
001500  23322041
001504  6c61726d
001508  2c206c6f
00150c  737400  
00150f  00                DCB      0
                  |L1.5392|
001510  f04f0400          MOV      r4,#0                 ;1162
                  |L1.5396|
001514  b221              SXTH     r1,r4                 ;1163
001516  4628              MOV      r0,r5                 ;1163
001518  f7fffffe          BL       lc640_write_int
00151c  f6406702          MOV      r7,#0xe02             ;1165
001520  4638              MOV      r0,r7                 ;1165
001522  f7fffffe          BL       lc640_read_int
001526  b280              UXTH     r0,r0                 ;1165
001528  283f              CMP      r0,#0x3f              ;1166
00152a  d000              BEQ      |L1.5422|
00152c  4620              MOV      r0,r4                 ;1166
                  |L1.5422|
00152e  b201              SXTH     r1,r0                 ;1167
001530  4638              MOV      r0,r7                 ;1167
001532  f7fffffe          BL       lc640_write_int
001536  4628              MOV      r0,r5                 ;1169
001538  f7fffffe          BL       lc640_read_int
00153c  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1169
001540  b284              UXTH     r4,r0                 ;1169
001542  f88d9000          STRB     r9,[sp,#0]            ;1171
001546  f88d6001          STRB     r6,[sp,#1]            ;1172
00154a  f04f0053          MOV      r0,#0x53              ;1173
00154e  f88d0002          STRB     r0,[sp,#2]            ;1173
001552  f88da003          STRB     r10,[sp,#3]           ;1174
001556  4669              MOV      r1,sp                 ;1175
001558  4620              MOV      r0,r4                 ;1175
00155a  f7fffffe          BL       lc640_write_long_ptr
00155e  f8cda000          STR      r10,[sp,#0]           ;1180
001562  4669              MOV      r1,sp                 ;1181
001564  1d20              ADDS     r0,r4,#4              ;1181
001566  f7fffffe          BL       lc640_write_long_ptr
00156a  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1183
00156e  f88d0000          STRB     r0,[sp,#0]            ;1183
001572  f8980038          LDRB     r0,[r8,#0x38]         ;1184
001576  f88d0001          STRB     r0,[sp,#1]            ;1184
00157a  f898002c          LDRB     r0,[r8,#0x2c]         ;1185
00157e  f88d0002          STRB     r0,[sp,#2]            ;1185
001582  f88da003          STRB     r10,[sp,#3]           ;1186
001586  4669              MOV      r1,sp                 ;1187
001588  f1040008          ADD      r0,r4,#8              ;1187
00158c  f7fffffe          BL       lc640_write_long_ptr
001590  f8980028          LDRB     r0,[r8,#0x28]         ;1189
001594  f88d0000          STRB     r0,[sp,#0]            ;1189
001598  f8980024          LDRB     r0,[r8,#0x24]         ;1190
00159c  e000              B        |L1.5536|
                  |L1.5534|
00159e  e054              B        |L1.5706|
                  |L1.5536|
0015a0  f88d0001          STRB     r0,[sp,#1]            ;1190
0015a4  f8980020          LDRB     r0,[r8,#0x20]         ;1191
0015a8  f88d0002          STRB     r0,[sp,#2]            ;1191
0015ac  f88da003          STRB     r10,[sp,#3]           ;1192
0015b0  4669              MOV      r1,sp                 ;1193
0015b2  f104000c          ADD      r0,r4,#0xc            ;1193
0015b6  f7fffffe          BL       lc640_write_long_ptr
0015ba  f04f0541          MOV      r5,#0x41              ;1195
0015be  f88d5000          STRB     r5,[sp,#0]            ;1195
0015c2  f88d5001          STRB     r5,[sp,#1]            ;1196
0015c6  f88d5002          STRB     r5,[sp,#2]            ;1197
0015ca  f88d5003          STRB     r5,[sp,#3]            ;1198
0015ce  4669              MOV      r1,sp                 ;1199
0015d0  f1040010          ADD      r0,r4,#0x10           ;1199
0015d4  f7fffffe          BL       lc640_write_long_ptr
0015d8  f88d5000          STRB     r5,[sp,#0]            ;1201
0015dc  f88d5001          STRB     r5,[sp,#1]            ;1202
0015e0  f88d5002          STRB     r5,[sp,#2]            ;1203
0015e4  f88d5003          STRB     r5,[sp,#3]            ;1204
0015e8  4669              MOV      r1,sp                 ;1205
0015ea  f1040014          ADD      r0,r4,#0x14           ;1205
0015ee  f7fffffe          BL       lc640_write_long_ptr
0015f2  f88d5000          STRB     r5,[sp,#0]            ;1207
0015f6  f88d5001          STRB     r5,[sp,#1]            ;1208
0015fa  f88d5002          STRB     r5,[sp,#2]            ;1209
0015fe  f88d5003          STRB     r5,[sp,#3]            ;1210
001602  4669              MOV      r1,sp                 ;1211
001604  f1040018          ADD      r0,r4,#0x18           ;1211
001608  f7fffffe          BL       lc640_write_long_ptr
00160c  f88d5000          STRB     r5,[sp,#0]            ;1213
001610  f88d5001          STRB     r5,[sp,#1]            ;1214
001614  f88d5002          STRB     r5,[sp,#2]            ;1215
001618  f88d5003          STRB     r5,[sp,#3]            ;1216
00161c  4669              MOV      r1,sp                 ;1217
00161e  f104001c          ADD      r0,r4,#0x1c           ;1217
001622  f7fffffe          BL       lc640_write_long_ptr
001626  b116              CBZ      r6,|L1.5678|
001628  2e01              CMP      r6,#1                 ;1223
00162a  d007              BEQ      |L1.5692|
00162c  e08e              B        |L1.5964|
                  |L1.5678|
00162e  2302              MOVS     r3,#2                 ;1221
001630  2201              MOVS     r2,#1                 ;1221
001632  2105              MOVS     r1,#5                 ;1221
001634  a0fb              ADR      r0,|L1.6692|
001636  f7fffffe          BL       snmp_trap_send
00163a  e087              B        |L1.5964|
                  |L1.5692|
00163c  2302              MOVS     r3,#2                 ;1225
00163e  461a              MOV      r2,r3                 ;1225
001640  2105              MOVS     r1,#5                 ;1225
001642  a0fe              ADR      r0,|L1.6716|
001644  f7fffffe          BL       snmp_trap_send
001648  e080              B        |L1.5964|
                  |L1.5706|
;;;1231   	{
;;;1232   	//bat[b]._av=0;
;;;1233   
;;;1234        event_ptr=lc640_read_int(PTR_EVENT_LOG);
00164a  4628              MOV      r0,r5
00164c  f7fffffe          BL       lc640_read_int
001650  b287              UXTH     r7,r0
;;;1235   	event_ptr_find=event_ptr;
001652  463c              MOV      r4,r7
                  |L1.5716|
;;;1236   	
;;;1237   avar_bat_as_hndl_lbl1: 
;;;1238   
;;;1239   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001654  eb0b1044          ADD      r0,r11,r4,LSL #5
001658  b285              UXTH     r5,r0
;;;1240   
;;;1241        lc640_read_long_ptr(lc640_adr,data);
00165a  4669              MOV      r1,sp
00165c  4628              MOV      r0,r5
00165e  f7fffffe          BL       lc640_read_long_ptr
;;;1242        
;;;1243        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
001662  f89d0000          LDRB     r0,[sp,#0]
001666  2842              CMP      r0,#0x42
001668  d107              BNE      |L1.5754|
00166a  f89d0001          LDRB     r0,[sp,#1]
00166e  42b0              CMP      r0,r6
001670  d103              BNE      |L1.5754|
001672  f89d0002          LDRB     r0,[sp,#2]
001676  2843              CMP      r0,#0x43
001678  d009              BEQ      |L1.5774|
                  |L1.5754|
;;;1244        	{        
;;;1245        	if(event_ptr_find)event_ptr_find--;
00167a  b11c              CBZ      r4,|L1.5764|
00167c  f1a40401          SUB      r4,r4,#1
001680  b2a4              UXTH     r4,r4
001682  e001              B        |L1.5768|
                  |L1.5764|
;;;1246        	else event_ptr_find=63;
001684  f04f043f          MOV      r4,#0x3f
                  |L1.5768|
;;;1247        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001688  42bc              CMP      r4,r7
00168a  d1e3              BNE      |L1.5716|
00168c  e05e              B        |L1.5964|
                  |L1.5774|
;;;1248        	else goto avar_bat_as_hndl_lbl1;
;;;1249        	}
;;;1250        else 
;;;1251        	{
;;;1252        	lc640_read_long_ptr(lc640_adr+16,data);
00168e  4669              MOV      r1,sp
001690  f1050010          ADD      r0,r5,#0x10
001694  f7fffffe          BL       lc640_read_long_ptr
;;;1253        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001698  f89d0000          LDRB     r0,[sp,#0]
00169c  2841              CMP      r0,#0x41
00169e  d10b              BNE      |L1.5816|
0016a0  f89d0001          LDRB     r0,[sp,#1]
0016a4  2841              CMP      r0,#0x41
0016a6  d107              BNE      |L1.5816|
0016a8  f89d0002          LDRB     r0,[sp,#2]
0016ac  2841              CMP      r0,#0x41
0016ae  d103              BNE      |L1.5816|
0016b0  f89d0003          LDRB     r0,[sp,#3]
0016b4  2841              CMP      r0,#0x41
0016b6  d009              BEQ      |L1.5836|
                  |L1.5816|
;;;1254        		{        
;;;1255        		if(event_ptr_find)event_ptr_find--;
0016b8  b11c              CBZ      r4,|L1.5826|
0016ba  f1a40401          SUB      r4,r4,#1
0016be  b2a4              UXTH     r4,r4
0016c0  e001              B        |L1.5830|
                  |L1.5826|
;;;1256            		else event_ptr_find=63;
0016c2  f04f043f          MOV      r4,#0x3f
                  |L1.5830|
;;;1257            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
0016c6  42bc              CMP      r4,r7
0016c8  d1c4              BNE      |L1.5716|
0016ca  e03f              B        |L1.5964|
                  |L1.5836|
;;;1258        		else goto avar_bat_as_hndl_lbl1;
;;;1259        		}
;;;1260   
;;;1261        	}
;;;1262        		
;;;1263   	data[0]=LPC_RTC->YEAR;
0016cc  f8b8003c          LDRH     r0,[r8,#0x3c]
0016d0  f88d0000          STRB     r0,[sp,#0]
;;;1264   	data[1]=LPC_RTC->MONTH;
0016d4  f8980038          LDRB     r0,[r8,#0x38]
0016d8  f88d0001          STRB     r0,[sp,#1]
;;;1265   	data[2]=LPC_RTC->DOM;
0016dc  f898002c          LDRB     r0,[r8,#0x2c]
0016e0  f88d0002          STRB     r0,[sp,#2]
;;;1266   	data[3]=0;
0016e4  f88da003          STRB     r10,[sp,#3]
;;;1267   	lc640_write_long_ptr(lc640_adr+16,data);
0016e8  4669              MOV      r1,sp
0016ea  f1050010          ADD      r0,r5,#0x10
0016ee  f7fffffe          BL       lc640_write_long_ptr
;;;1268   
;;;1269   	data[0]=LPC_RTC->HOUR;
0016f2  f8980028          LDRB     r0,[r8,#0x28]
0016f6  f88d0000          STRB     r0,[sp,#0]
;;;1270   	data[1]=LPC_RTC->MIN;
0016fa  f8980024          LDRB     r0,[r8,#0x24]
0016fe  f88d0001          STRB     r0,[sp,#1]
;;;1271   	data[2]=LPC_RTC->SEC;
001702  f8980020          LDRB     r0,[r8,#0x20]
001706  f88d0002          STRB     r0,[sp,#2]
;;;1272   	data[3]=0;
00170a  f88da003          STRB     r10,[sp,#3]
;;;1273   	lc640_write_long_ptr(lc640_adr+20,data);
00170e  4669              MOV      r1,sp
001710  f1050014          ADD      r0,r5,#0x14
001714  f7fffffe          BL       lc640_write_long_ptr
;;;1274   	
;;;1275   	data[0]='B';
001718  f88d9000          STRB     r9,[sp,#0]
;;;1276   	data[1]='B';
00171c  f88d9001          STRB     r9,[sp,#1]
;;;1277   	data[2]='B';
001720  f88d9002          STRB     r9,[sp,#2]
;;;1278   	data[3]='B';
001724  f88d9003          STRB     r9,[sp,#3]
;;;1279   	lc640_write_long_ptr(lc640_adr+24,data);
001728  4669              MOV      r1,sp
00172a  f1050018          ADD      r0,r5,#0x18
00172e  f7fffffe          BL       lc640_write_long_ptr
;;;1280   	
;;;1281   	data[0]='B';
001732  f88d9000          STRB     r9,[sp,#0]
;;;1282   	data[1]='B';
001736  f88d9001          STRB     r9,[sp,#1]
;;;1283   	data[2]='B';
00173a  f88d9002          STRB     r9,[sp,#2]
;;;1284   	data[3]='B';
00173e  f88d9003          STRB     r9,[sp,#3]
;;;1285   	lc640_write_long_ptr(lc640_adr+28,data);
001742  4669              MOV      r1,sp
001744  f105001c          ADD      r0,r5,#0x1c
001748  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5964|
;;;1286   	
;;;1287   
;;;1288   	
;;;1289   	}
;;;1290   	
;;;1291   avar_bat_as_hndl_end:
;;;1292   __nop();		
00174c  bf00              NOP      
;;;1293   }
00174e  e54a              B        |L1.4582|
;;;1294   
                          ENDP

                  ke_mem_hndl PROC
;;;1296   //-----------------------------------------------
;;;1297   void ke_mem_hndl(char b,unsigned short in)
001750  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;1298   {
001752  b083              SUB      sp,sp,#0xc
001754  4605              MOV      r5,r0
;;;1299   char data[4];
;;;1300   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1301   //unsigned char temp,temp_;
;;;1302   //unsigned int tempUI;
;;;1303   //unsigned long tempUL; 
;;;1304   signed temp_temp;
;;;1305   
;;;1306   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
001756  eb050045          ADD      r0,r5,r5,LSL #1
00175a  49be              LDR      r1,|L1.6740|
00175c  eb001005          ADD      r0,r0,r5,LSL #4
001760  eb010180          ADD      r1,r1,r0,LSL #2
001764  48bc              LDR      r0,|L1.6744|
001766  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
00176a  f1000001          ADD      r0,r0,#1
00176e  eb010040          ADD      r0,r1,r0,LSL #1
001772  f9b00020          LDRSH    r0,[r0,#0x20]
001776  9001              STR      r0,[sp,#4]
;;;1307   
;;;1308   event_ptr=lc640_read_int(PTR_EVENT_LOG);
001778  f44f6660          MOV      r6,#0xe00
00177c  4630              MOV      r0,r6
00177e  f7fffffe          BL       lc640_read_int
;;;1309   event_ptr++;	
001782  f1000001          ADD      r0,r0,#1
001786  4604              MOV      r4,r0
;;;1310   if(event_ptr>63)event_ptr=0;	
001788  2c3f              CMP      r4,#0x3f
00178a  d901              BLS      |L1.6032|
00178c  f04f0400          MOV      r4,#0
                  |L1.6032|
;;;1311   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
001790  b221              SXTH     r1,r4
001792  4630              MOV      r0,r6
001794  f7fffffe          BL       lc640_write_int
;;;1312   	
;;;1313   event_cnt=lc640_read_int(CNT_EVENT_LOG);
001798  f6406702          MOV      r7,#0xe02
00179c  4638              MOV      r0,r7
00179e  f7fffffe          BL       lc640_read_int
;;;1314   if(event_cnt!=63)event_cnt=event_ptr;
0017a2  283f              CMP      r0,#0x3f
0017a4  d000              BEQ      |L1.6056|
0017a6  4620              MOV      r0,r4
                  |L1.6056|
;;;1315   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
0017a8  b201              SXTH     r1,r0
0017aa  4638              MOV      r0,r7
0017ac  f7fffffe          BL       lc640_write_int
;;;1316   	
;;;1317   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
0017b0  4630              MOV      r0,r6
0017b2  f7fffffe          BL       lc640_read_int
0017b6  f44f6180          MOV      r1,#0x400
0017ba  eb011440          ADD      r4,r1,r0,LSL #5
;;;1318   	
;;;1319   data[0]='B';
0017be  f04f0042          MOV      r0,#0x42
0017c2  f88d0008          STRB     r0,[sp,#8]
;;;1320   data[1]=b; 
0017c6  f88d5009          STRB     r5,[sp,#9]
;;;1321   data[2]='K';
0017ca  f04f004b          MOV      r0,#0x4b
0017ce  f88d000a          STRB     r0,[sp,#0xa]
;;;1322   data[3]=0;
0017d2  f04f0600          MOV      r6,#0
0017d6  f88d600b          STRB     r6,[sp,#0xb]
;;;1323   
;;;1324   lc640_write_long_ptr(lc640_adr,data);
0017da  a902              ADD      r1,sp,#8
0017dc  4620              MOV      r0,r4
0017de  f7fffffe          BL       lc640_write_long_ptr
;;;1325   
;;;1326   data[0]=*((char*)&in);
0017e2  f89d0010          LDRB     r0,[sp,#0x10]
0017e6  f88d0008          STRB     r0,[sp,#8]
;;;1327   data[1]=*(((char*)(&in))+1);
0017ea  f89d0011          LDRB     r0,[sp,#0x11]
0017ee  f88d0009          STRB     r0,[sp,#9]
;;;1328   data[2]=*((char*)&temp_temp);
0017f2  f89d0004          LDRB     r0,[sp,#4]
0017f6  f88d000a          STRB     r0,[sp,#0xa]
;;;1329   data[3]=*(((char*)(&temp_temp))+1);
0017fa  f89d0005          LDRB     r0,[sp,#5]
0017fe  f88d000b          STRB     r0,[sp,#0xb]
;;;1330   lc640_write_long_ptr(lc640_adr+4,data);
001802  a902              ADD      r1,sp,#8
001804  1d20              ADDS     r0,r4,#4
001806  f7fffffe          BL       lc640_write_long_ptr
;;;1331   
;;;1332   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
00180a  f44f70fc          MOV      r0,#0x1f8
00180e  f7fffffe          BL       lc640_read_long
001812  4d92              LDR      r5,|L1.6748|
001814  6028              STR      r0,[r5,#0]  ; ke_date
;;;1333   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
001816  4629              MOV      r1,r5
001818  f1040008          ADD      r0,r4,#8
00181c  f7fffffe          BL       lc640_write_long_ptr
;;;1334   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
001820  f44f70fe          MOV      r0,#0x1fc
001824  f7fffffe          BL       lc640_read_long
001828  6068              STR      r0,[r5,#4]  ; ke_date
;;;1335   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
00182a  1d29              ADDS     r1,r5,#4
00182c  f104000c          ADD      r0,r4,#0xc
001830  f7fffffe          BL       lc640_write_long_ptr
;;;1336   
;;;1337   data[0]=LPC_RTC->YEAR;
001834  4d8a              LDR      r5,|L1.6752|
001836  8ba8              LDRH     r0,[r5,#0x1c]
001838  f88d0008          STRB     r0,[sp,#8]
;;;1338   data[1]=LPC_RTC->MONTH;
00183c  7e28              LDRB     r0,[r5,#0x18]
00183e  f88d0009          STRB     r0,[sp,#9]
;;;1339   data[2]=LPC_RTC->DOM;
001842  7b28              LDRB     r0,[r5,#0xc]
001844  f88d000a          STRB     r0,[sp,#0xa]
;;;1340   data[3]=0;
001848  f88d600b          STRB     r6,[sp,#0xb]
;;;1341   lc640_write_long_ptr(lc640_adr+16,data);
00184c  a902              ADD      r1,sp,#8
00184e  f1040010          ADD      r0,r4,#0x10
001852  f7fffffe          BL       lc640_write_long_ptr
;;;1342   
;;;1343   data[0]=LPC_RTC->HOUR;
001856  7a28              LDRB     r0,[r5,#8]
001858  f88d0008          STRB     r0,[sp,#8]
;;;1344   data[1]=LPC_RTC->MIN;
00185c  7928              LDRB     r0,[r5,#4]
00185e  f88d0009          STRB     r0,[sp,#9]
;;;1345   data[2]=LPC_RTC->SEC;
001862  7828              LDRB     r0,[r5,#0]
001864  f88d000a          STRB     r0,[sp,#0xa]
;;;1346   data[3]=0;
001868  f88d600b          STRB     r6,[sp,#0xb]
;;;1347   lc640_write_long_ptr(lc640_adr+20,data);
00186c  a902              ADD      r1,sp,#8
00186e  f1040014          ADD      r0,r4,#0x14
001872  f7fffffe          BL       lc640_write_long_ptr
;;;1348    
;;;1349   }
001876  b005              ADD      sp,sp,#0x14
001878  bdf0              POP      {r4-r7,pc}
;;;1350   
                          ENDP

                  vz_mem_hndl PROC
;;;1352   //-----------------------------------------------
;;;1353   void vz_mem_hndl(unsigned short in)
00187a  e92d4ff8          PUSH     {r3-r11,lr}
;;;1354   {
;;;1355   char data[4];
;;;1356   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
00187e  f04f0600          MOV      r6,#0
001882  4634              MOV      r4,r6
;;;1357   //char avar_simbol;
;;;1358   
;;;1359   if(in==1)
;;;1360   	{
;;;1361   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1362   	event_ptr++;	
;;;1363   	if(event_ptr>63)event_ptr=0;	
;;;1364   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1365   	
;;;1366        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1367   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1368   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1369   	
;;;1370   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1371   	
;;;1372   	data[0]='B';
;;;1373   	data[1]=0; 
;;;1374   	data[2]='Z';
;;;1375   	data[3]=0;
;;;1376   	lc640_write_long_ptr(lc640_adr,data);
;;;1377   
;;;1378   	data[0]=0;
;;;1379   	data[1]=0;
;;;1380   	data[2]=0;
;;;1381   	data[3]=0;
;;;1382   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1383   
;;;1384   	data[0]=LPC_RTC->YEAR;
001884  f8df81dc          LDR      r8,|L1.6756|
001888  46a1              MOV      r9,r4                 ;1356
00188a  f04f0742          MOV      r7,#0x42              ;1372
00188e  f44f6a80          MOV      r10,#0x400            ;1370
001892  2801              CMP      r0,#1                 ;1359
001894  d002              BEQ      |L1.6300|
;;;1385   	data[1]=LPC_RTC->MONTH;
;;;1386   	data[2]=LPC_RTC->DOM;
;;;1387   	data[3]=0;
;;;1388   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1389   
;;;1390   	data[0]=LPC_RTC->HOUR;
;;;1391   	data[1]=LPC_RTC->MIN;
;;;1392   	data[2]=LPC_RTC->SEC;
;;;1393   	data[3]=0;
;;;1394   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1395   	
;;;1396   	data[0]='A';
;;;1397   	data[1]='A';
;;;1398   	data[2]='A';
;;;1399   	data[3]='A';
;;;1400   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1401   	
;;;1402   	data[0]='A';
;;;1403   	data[1]='A';
;;;1404   	data[2]='A';
;;;1405   	data[3]='A';
;;;1406   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1407   	
;;;1408   	data[0]='A';
;;;1409   	data[1]='A';
;;;1410   	data[2]='A';
;;;1411   	data[3]='A';
;;;1412   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1413   	
;;;1414   	data[0]='A';
;;;1415   	data[1]='A';
;;;1416   	data[2]='A';
;;;1417   	data[3]='A';
;;;1418   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1419    	
;;;1420   	}
;;;1421   
;;;1422   else if(in==0)
001896  2800              CMP      r0,#0
001898  d07e              BEQ      |L1.6552|
00189a  e12a              B        |L1.6898|
                  |L1.6300|
00189c  f44f6560          MOV      r5,#0xe00             ;1361
0018a0  4628              MOV      r0,r5                 ;1361
0018a2  f7fffffe          BL       lc640_read_int
0018a6  f1000001          ADD      r0,r0,#1              ;1362
0018aa  4604              MOV      r4,r0                 ;1362
0018ac  2c3f              CMP      r4,#0x3f              ;1363
0018ae  d901              BLS      |L1.6324|
0018b0  f04f0400          MOV      r4,#0                 ;1363
                  |L1.6324|
0018b4  b221              SXTH     r1,r4                 ;1364
0018b6  4628              MOV      r0,r5                 ;1364
0018b8  f7fffffe          BL       lc640_write_int
0018bc  f6406602          MOV      r6,#0xe02             ;1366
0018c0  4630              MOV      r0,r6                 ;1366
0018c2  f7fffffe          BL       lc640_read_int
0018c6  283f              CMP      r0,#0x3f              ;1367
0018c8  d000              BEQ      |L1.6348|
0018ca  4620              MOV      r0,r4                 ;1367
                  |L1.6348|
0018cc  b201              SXTH     r1,r0                 ;1368
0018ce  4630              MOV      r0,r6                 ;1368
0018d0  f7fffffe          BL       lc640_write_int
0018d4  4628              MOV      r0,r5                 ;1370
0018d6  f7fffffe          BL       lc640_read_int
0018da  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1370
0018de  f88d7000          STRB     r7,[sp,#0]            ;1372
0018e2  f88d9001          STRB     r9,[sp,#1]            ;1373
0018e6  f04f005a          MOV      r0,#0x5a              ;1374
0018ea  f88d0002          STRB     r0,[sp,#2]            ;1374
0018ee  f88d9003          STRB     r9,[sp,#3]            ;1375
0018f2  4669              MOV      r1,sp                 ;1376
0018f4  4620              MOV      r0,r4                 ;1376
0018f6  f7fffffe          BL       lc640_write_long_ptr
0018fa  f8cd9000          STR      r9,[sp,#0]            ;1381
0018fe  4669              MOV      r1,sp                 ;1382
001900  1d20              ADDS     r0,r4,#4              ;1382
001902  f7fffffe          BL       lc640_write_long_ptr
001906  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1384
00190a  f88d0000          STRB     r0,[sp,#0]            ;1384
00190e  f8980038          LDRB     r0,[r8,#0x38]         ;1385
001912  f88d0001          STRB     r0,[sp,#1]            ;1385
001916  f898002c          LDRB     r0,[r8,#0x2c]         ;1386
00191a  f88d0002          STRB     r0,[sp,#2]            ;1386
00191e  f88d9003          STRB     r9,[sp,#3]            ;1387
001922  4669              MOV      r1,sp                 ;1388
001924  f1040008          ADD      r0,r4,#8              ;1388
001928  f7fffffe          BL       lc640_write_long_ptr
00192c  f8980028          LDRB     r0,[r8,#0x28]         ;1390
001930  f88d0000          STRB     r0,[sp,#0]            ;1390
001934  f8980024          LDRB     r0,[r8,#0x24]         ;1391
001938  f88d0001          STRB     r0,[sp,#1]            ;1391
00193c  f8980020          LDRB     r0,[r8,#0x20]         ;1392
001940  f88d0002          STRB     r0,[sp,#2]            ;1392
001944  f88d9003          STRB     r9,[sp,#3]            ;1393
001948  4669              MOV      r1,sp                 ;1394
00194a  f104000c          ADD      r0,r4,#0xc            ;1394
00194e  f7fffffe          BL       lc640_write_long_ptr
001952  f04f0541          MOV      r5,#0x41              ;1396
001956  f88d5000          STRB     r5,[sp,#0]            ;1396
00195a  f88d5001          STRB     r5,[sp,#1]            ;1397
00195e  f88d5002          STRB     r5,[sp,#2]            ;1398
001962  f88d5003          STRB     r5,[sp,#3]            ;1399
001966  4669              MOV      r1,sp                 ;1400
001968  f1040010          ADD      r0,r4,#0x10           ;1400
00196c  f7fffffe          BL       lc640_write_long_ptr
001970  f88d5000          STRB     r5,[sp,#0]            ;1402
001974  f88d5001          STRB     r5,[sp,#1]            ;1403
001978  f88d5002          STRB     r5,[sp,#2]            ;1404
00197c  f88d5003          STRB     r5,[sp,#3]            ;1405
001980  4669              MOV      r1,sp                 ;1406
001982  f1040014          ADD      r0,r4,#0x14           ;1406
001986  f7fffffe          BL       lc640_write_long_ptr
00198a  f88d5000          STRB     r5,[sp,#0]            ;1408
00198e  f88d5001          STRB     r5,[sp,#1]            ;1409
001992  f88d5002          STRB     r5,[sp,#2]            ;1410
001996  e000              B        |L1.6554|
                  |L1.6552|
001998  e014              B        |L1.6596|
                  |L1.6554|
00199a  f88d5003          STRB     r5,[sp,#3]            ;1411
00199e  4669              MOV      r1,sp                 ;1412
0019a0  f1040018          ADD      r0,r4,#0x18           ;1412
0019a4  f7fffffe          BL       lc640_write_long_ptr
0019a8  f88d5000          STRB     r5,[sp,#0]            ;1414
0019ac  f88d5001          STRB     r5,[sp,#1]            ;1415
0019b0  f88d5002          STRB     r5,[sp,#2]            ;1416
0019b4  f88d5003          STRB     r5,[sp,#3]            ;1417
0019b8  4669              MOV      r1,sp                 ;1418
0019ba  f104001c          ADD      r0,r4,#0x1c           ;1418
0019be  f7fffffe          BL       lc640_write_long_ptr
0019c2  e096              B        |L1.6898|
                  |L1.6596|
;;;1423   	{      
;;;1424        
;;;1425   vz_mem_hndl_lbl1: 
;;;1426   
;;;1427   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0019c4  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1428   
;;;1429        lc640_read_long_ptr(lc640_adr,data);
0019c8  4669              MOV      r1,sp
0019ca  4628              MOV      r0,r5
0019cc  f7fffffe          BL       lc640_read_long_ptr
;;;1430        
;;;1431        if(!((data[0]=='B')&&(data[2]=='Z')))
0019d0  f89d0000          LDRB     r0,[sp,#0]
0019d4  2842              CMP      r0,#0x42
0019d6  d103              BNE      |L1.6624|
0019d8  f89d0002          LDRB     r0,[sp,#2]
0019dc  285a              CMP      r0,#0x5a
0019de  d008              BEQ      |L1.6642|
                  |L1.6624|
;;;1432        	{        
;;;1433        	if(event_ptr_find)event_ptr_find--;
0019e0  b114              CBZ      r4,|L1.6632|
0019e2  f1a40401          SUB      r4,r4,#1
0019e6  e001              B        |L1.6636|
                  |L1.6632|
;;;1434        	else event_ptr_find=63;
0019e8  f04f043f          MOV      r4,#0x3f
                  |L1.6636|
;;;1435        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
0019ec  42b4              CMP      r4,r6
0019ee  d1e9              BNE      |L1.6596|
0019f0  e07f              B        |L1.6898|
                  |L1.6642|
;;;1436        	else goto vz_mem_hndl_lbl1;
;;;1437        	}
;;;1438        else 
;;;1439        	{
;;;1440        	lc640_read_long_ptr(lc640_adr+16,data);
0019f2  4669              MOV      r1,sp
0019f4  f1050010          ADD      r0,r5,#0x10
0019f8  f7fffffe          BL       lc640_read_long_ptr
;;;1441        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0019fc  f89d0000          LDRB     r0,[sp,#0]
001a00  2841              CMP      r0,#0x41
001a02  d10b              BNE      |L1.6684|
001a04  f89d0001          LDRB     r0,[sp,#1]
001a08  2841              CMP      r0,#0x41
001a0a  d107              BNE      |L1.6684|
001a0c  f89d0002          LDRB     r0,[sp,#2]
001a10  2841              CMP      r0,#0x41
001a12  d103              BNE      |L1.6684|
001a14  f89d0003          LDRB     r0,[sp,#3]
001a18  2841              CMP      r0,#0x41
001a1a  d02a              BEQ      |L1.6770|
                  |L1.6684|
;;;1442        		{        
;;;1443        		if(event_ptr_find)event_ptr_find--;
001a1c  b324              CBZ      r4,|L1.6760|
001a1e  f1a40401          SUB      r4,r4,#1
001a22  e023              B        |L1.6764|
                  |L1.6692|
001a24  42415420          DCB      "BAT #1 Alarm, assimetry",0
001a28  23312041
001a2c  6c61726d
001a30  2c206173
001a34  73696d65
001a38  74727900
                  |L1.6716|
001a3c  42415420          DCB      "BAT #2 Alarm, assimetry",0
001a40  23322041
001a44  6c61726d
001a48  2c206173
001a4c  73696d65
001a50  74727900
                  |L1.6740|
                          DCD      bat
                  |L1.6744|
                          DCD      bat_u_old_cnt
                  |L1.6748|
                          DCD      ke_date
                  |L1.6752|
                          DCD      0x40024020
                  |L1.6756|
                          DCD      0x40024000
                  |L1.6760|
;;;1444            		else event_ptr_find=63;
001a68  f04f043f          MOV      r4,#0x3f
                  |L1.6764|
;;;1445            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001a6c  42b4              CMP      r4,r6
001a6e  d1a9              BNE      |L1.6596|
001a70  e03f              B        |L1.6898|
                  |L1.6770|
;;;1446        		else goto vz_mem_hndl_lbl1;
;;;1447        		}
;;;1448   
;;;1449        	}	
;;;1450   
;;;1451   
;;;1452   	
;;;1453   	data[0]=LPC_RTC->YEAR;
001a72  f8b8003c          LDRH     r0,[r8,#0x3c]
001a76  f88d0000          STRB     r0,[sp,#0]
;;;1454   	data[1]=LPC_RTC->MONTH;
001a7a  f8980038          LDRB     r0,[r8,#0x38]
001a7e  f88d0001          STRB     r0,[sp,#1]
;;;1455   	data[2]=LPC_RTC->DOM;
001a82  f898002c          LDRB     r0,[r8,#0x2c]
001a86  f88d0002          STRB     r0,[sp,#2]
;;;1456   	data[3]=0;
001a8a  f88d9003          STRB     r9,[sp,#3]
;;;1457   	lc640_write_long_ptr(lc640_adr+16,data);
001a8e  4669              MOV      r1,sp
001a90  f1050010          ADD      r0,r5,#0x10
001a94  f7fffffe          BL       lc640_write_long_ptr
;;;1458   
;;;1459   	data[0]=LPC_RTC->HOUR;
001a98  f8980028          LDRB     r0,[r8,#0x28]
001a9c  f88d0000          STRB     r0,[sp,#0]
;;;1460   	data[1]=LPC_RTC->MIN;
001aa0  f8980024          LDRB     r0,[r8,#0x24]
001aa4  f88d0001          STRB     r0,[sp,#1]
;;;1461   	data[2]=LPC_RTC->SEC;
001aa8  f8980020          LDRB     r0,[r8,#0x20]
001aac  f88d0002          STRB     r0,[sp,#2]
;;;1462   	data[3]=0;
001ab0  f88d9003          STRB     r9,[sp,#3]
;;;1463   	lc640_write_long_ptr(lc640_adr+20,data);
001ab4  4669              MOV      r1,sp
001ab6  f1050014          ADD      r0,r5,#0x14
001aba  f7fffffe          BL       lc640_write_long_ptr
;;;1464   	
;;;1465   	data[0]='B';
001abe  f88d7000          STRB     r7,[sp,#0]
;;;1466   	data[1]='B';
001ac2  f88d7001          STRB     r7,[sp,#1]
;;;1467   	data[2]='B';
001ac6  f88d7002          STRB     r7,[sp,#2]
;;;1468   	data[3]='B';
001aca  f88d7003          STRB     r7,[sp,#3]
;;;1469   	lc640_write_long_ptr(lc640_adr+24,data);
001ace  4669              MOV      r1,sp
001ad0  f1050018          ADD      r0,r5,#0x18
001ad4  f7fffffe          BL       lc640_write_long_ptr
;;;1470   	
;;;1471   	data[0]='B';
001ad8  f88d7000          STRB     r7,[sp,#0]
;;;1472   	data[1]='B';
001adc  f88d7001          STRB     r7,[sp,#1]
;;;1473   	data[2]='B';
001ae0  f88d7002          STRB     r7,[sp,#2]
;;;1474   	data[3]='B';
001ae4  f88d7003          STRB     r7,[sp,#3]
;;;1475   	lc640_write_long_ptr(lc640_adr+28,data);
001ae8  4669              MOV      r1,sp
001aea  f105001c          ADD      r0,r5,#0x1c
001aee  f7fffffe          BL       lc640_write_long_ptr
                  |L1.6898|
;;;1476   	
;;;1477   	}
;;;1478   
;;;1479   vz_mem_hndl_end:
;;;1480   __nop(); 
001af2  bf00              NOP      
;;;1481   
;;;1482   }
001af4  e4c2              B        |L1.5244|
;;;1483     
                          ENDP


                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  rki_avar1_stat
                          DCD      0x00000000
                  rki_avar1_ind_stat
                          DCD      0x00000000
                  rki_avar1_stat_old
                          DCD      0x00000000
                  rki_avar1_stat_new
                          DCD      0x00000000
                  rki_avar1_stat_offed
                          DCD      0x00000000
                  rki_avarI1_stat
                          DCD      0x00000000
                  rki_avarI1_ind_stat
                          DCD      0x00000000
                  rki_avarI1_stat_old
                          DCD      0x00000000
                  rki_avarI1_stat_new
                          DCD      0x00000000
                  rki_avarI1_stat_offed
                          DCD      0x00000000
                  rki_avarI2_stat
                          DCD      0x00000000
                  rki_avarI2_ind_stat
                          DCD      0x00000000
                  rki_avarI2_stat_old
                          DCD      0x00000000
                  rki_avarI2_stat_new
                          DCD      0x00000000
                  rki_avarI2_stat_offed
                          DCD      0x00000000
                  av_inv
                          DCD      0x00000000
000054  0000              DCB      0x00,0x00
