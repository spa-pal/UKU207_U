; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\avar_hndl.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DUKU_ZVU --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;78     //-----------------------------------------------
;;;79     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;80     {
;;;81     //static unsigned avar_stat_old;
;;;82     char i;
;;;83     //unsigned avar_stat_new,avar_stat_offed;
;;;84     
;;;85     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48ff              LDR      r0,|L1.1024|
000004  4aff              LDR      r2,|L1.1028|
000006  7801              LDRB     r1,[r0,#0]  ; net_av
000008  6810              LDR      r0,[r2,#0]
00000a  b119              CBZ      r1,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6010              STR      r0,[r2,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;86     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6010              STR      r0,[r2,#0]  ; avar_stat
                  |L1.26|
;;;87     #ifndef UKU_220_IPS_TERMOKOMPENSAT //o_10
;;;88     for(i=0;i<2;i++)
;;;89     	{
;;;90     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
;;;91     	else	   			SET_REG(avar_stat,0,1+i,1);
;;;92     	}
;;;93     #endif //o_10
;;;94     for(i=0;i<18;i++)
00001a  f04f0000          MOV      r0,#0
;;;95     	{
;;;96     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00001e  4dfa              LDR      r5,|L1.1032|
000020  f04f0301          MOV      r3,#1
                  |L1.36|
000024  eb0001c0          ADD      r1,r0,r0,LSL #3
000028  eb011100          ADD      r1,r1,r0,LSL #4
00002c  eb050181          ADD      r1,r5,r1,LSL #2
000030  7849              LDRB     r1,[r1,#1]
000032  f0110fef          TST      r1,#0xef
000036  d00a              BEQ      |L1.78|
000038  f1000403          ADD      r4,r0,#3
00003c  fa03f104          LSL      r1,r3,r4
000040  6814              LDR      r4,[r2,#0]  ; avar_stat
000042  ea240401          BIC      r4,r4,r1
000046  ea440401          ORR      r4,r4,r1
00004a  6014              STR      r4,[r2,#0]  ; avar_stat
00004c  e007              B        |L1.94|
                  |L1.78|
;;;97     	else	   		SET_REG(avar_stat,0,3+i,1);
00004e  f1000103          ADD      r1,r0,#3
000052  6814              LDR      r4,[r2,#0]  ; avar_stat
000054  fa03f101          LSL      r1,r3,r1
000058  ea240401          BIC      r4,r4,r1
00005c  6014              STR      r4,[r2,#0]  ; avar_stat
                  |L1.94|
00005e  f1000001          ADD      r0,r0,#1              ;94
000062  b2c0              UXTB     r0,r0                 ;94
000064  2812              CMP      r0,#0x12              ;94
000066  d3dd              BCC      |L1.36|
;;;98     	}
;;;99     
;;;100    /*for(i=0;i<6;i++)
;;;101    	{
;;;102    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
;;;103    	else	   		SET_REG(avar_stat,0,15+i,1);
;;;104    	}*/
;;;105    
;;;106    /*for(i=0;i<4;i++)
;;;107    	{
;;;108    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;109    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;110    	}  */
;;;111    #ifndef UKU_ZVU
;;;112    for(i=0;i<4;i++)
;;;113    	{
;;;114    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
;;;115    	else	   		SET_REG(avar_stat,0,24+i,1);
;;;116    	}
;;;117    #endif //UKU_ZVU
;;;118    #ifndef UKU_FSO
;;;119    for(i=0;i<4;i++)
000068  f04f0000          MOV      r0,#0
;;;120    	{
;;;121    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
00006c  4de7              LDR      r5,|L1.1036|
                  |L1.110|
00006e  5c29              LDRB     r1,[r5,r0]
000070  2901              CMP      r1,#1
000072  d036              BEQ      |L1.226|
;;;122    	else	   		SET_REG(avar_stat,0,24+i,1);
000074  f1000118          ADD      r1,r0,#0x18
000078  fa03f401          LSL      r4,r3,r1
00007c  6811              LDR      r1,[r2,#0]  ; avar_stat
00007e  ea210104          BIC      r1,r1,r4
000082  6011              STR      r1,[r2,#0]  ; avar_stat
                  |L1.132|
000084  f1000001          ADD      r0,r0,#1              ;119
000088  b2c0              UXTB     r0,r0                 ;119
00008a  2804              CMP      r0,#4                 ;119
00008c  d3ef              BCC      |L1.110|
;;;123    	}
;;;124    #endif //UKU_FSO
;;;125    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;126    //else	   			SET_REG(avar_stat,0,28,1);
;;;127    
;;;128    
;;;129    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
00008e  6893              LDR      r3,[r2,#8]  ; avar_stat_old
000090  6810              LDR      r0,[r2,#0]  ; avar_stat
000092  ea200103          BIC      r1,r0,r3
000096  60d1              STR      r1,[r2,#0xc]  ; avar_stat_new
;;;130    
;;;131    avar_ind_stat|=avar_stat_new;
000098  6854              LDR      r4,[r2,#4]  ; avar_ind_stat
00009a  ea440401          ORR      r4,r4,r1
00009e  6054              STR      r4,[r2,#4]  ; avar_ind_stat
;;;132    
;;;133    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
0000a0  49db              LDR      r1,|L1.1040|
0000a2  880d              LDRH     r5,[r1,#0]  ; SK_ZVUK_EN
0000a4  b115              CBZ      r5,|L1.172|
0000a6  f0247480          BIC      r4,r4,#0x1000000
0000aa  6054              STR      r4,[r2,#4]  ; avar_ind_stat
                  |L1.172|
;;;134    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
0000ac  884c              LDRH     r4,[r1,#2]  ; SK_ZVUK_EN
0000ae  b11c              CBZ      r4,|L1.184|
0000b0  6854              LDR      r4,[r2,#4]  ; avar_ind_stat
0000b2  f0247400          BIC      r4,r4,#0x2000000
0000b6  6054              STR      r4,[r2,#4]  ; avar_ind_stat
                  |L1.184|
;;;135    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
0000b8  888c              LDRH     r4,[r1,#4]  ; SK_ZVUK_EN
0000ba  b11c              CBZ      r4,|L1.196|
0000bc  6854              LDR      r4,[r2,#4]  ; avar_ind_stat
0000be  f0246480          BIC      r4,r4,#0x4000000
0000c2  6054              STR      r4,[r2,#4]  ; avar_ind_stat
                  |L1.196|
;;;136    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
0000c4  88c9              LDRH     r1,[r1,#6]  ; SK_ZVUK_EN
0000c6  b119              CBZ      r1,|L1.208|
0000c8  6851              LDR      r1,[r2,#4]  ; avar_ind_stat
0000ca  f0216100          BIC      r1,r1,#0x8000000
0000ce  6051              STR      r1,[r2,#4]  ; avar_ind_stat
                  |L1.208|
;;;137    
;;;138    
;;;139    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
0000d0  ea230300          BIC      r3,r3,r0
0000d4  ea6f0103          MVN      r1,r3
0000d8  6111              STR      r1,[r2,#0x10]  ; avar_stat_offed
;;;140    
;;;141    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
0000da  4bce              LDR      r3,|L1.1044|
0000dc  881b              LDRH     r3,[r3,#0]  ; AV_OFF_AVT
0000de  b15b              CBZ      r3,|L1.248|
0000e0  e00e              B        |L1.256|
                  |L1.226|
0000e2  f1000418          ADD      r4,r0,#0x18           ;121
0000e6  fa03f104          LSL      r1,r3,r4              ;121
0000ea  6814              LDR      r4,[r2,#0]            ;121  ; avar_stat
0000ec  ea240401          BIC      r4,r4,r1              ;121
0000f0  ea440401          ORR      r4,r4,r1              ;121
0000f4  6014              STR      r4,[r2,#0]            ;121  ; avar_stat
0000f6  e7c5              B        |L1.132|
                  |L1.248|
0000f8  4bc7              LDR      r3,|L1.1048|
0000fa  ea410103          ORR      r1,r1,r3
0000fe  6111              STR      r1,[r2,#0x10]  ; avar_stat_offed
                  |L1.256|
;;;142    
;;;143    avar_ind_stat&=avar_stat_offed; 
000100  6913              LDR      r3,[r2,#0x10]  ; avar_stat_offed
000102  6851              LDR      r1,[r2,#4]  ; avar_ind_stat
000104  ea010103          AND      r1,r1,r3
000108  6051              STR      r1,[r2,#4]  ; avar_ind_stat
;;;144    
;;;145    avar_stat_old=avar_stat;
00010a  6090              STR      r0,[r2,#8]  ; avar_stat_old
;;;146    
;;;147    //oleg_start
;;;148    
;;;149    
;;;150    
;;;151    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
00010c  48c3              LDR      r0,|L1.1052|
00010e  49c4              LDR      r1,|L1.1056|
000110  8800              LDRH     r0,[r0,#0]  ; status_izm_r
000112  6809              LDR      r1,[r1,#0]  ; sk_alarm
000114  f000003f          AND      r0,r0,#0x3f
000118  ea402001          ORR      r0,r0,r1,LSL #8
00011c  6150              STR      r0,[r2,#0x14]  ; rki_avar1_stat
;;;152    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
00011e  69d3              LDR      r3,[r2,#0x1c]  ; rki_avar1_stat_old
000120  ea200103          BIC      r1,r0,r3
000124  6211              STR      r1,[r2,#0x20]  ; rki_avar1_stat_new
;;;153    rki_avar1_ind_stat|=rki_avar1_stat_new;
000126  6994              LDR      r4,[r2,#0x18]  ; rki_avar1_ind_stat
000128  ea440401          ORR      r4,r4,r1
;;;154    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
00012c  ea230300          BIC      r3,r3,r0
000130  ea6f0103          MVN      r1,r3
000134  6251              STR      r1,[r2,#0x24]  ; rki_avar1_stat_offed
;;;155    rki_avar1_ind_stat&=rki_avar1_stat_offed;
000136  ea040401          AND      r4,r4,r1
00013a  6194              STR      r4,[r2,#0x18]  ; rki_avar1_ind_stat
;;;156    rki_avar1_stat_old=rki_avar1_stat;
00013c  61d0              STR      r0,[r2,#0x1c]  ; rki_avar1_stat_old
;;;157    /*
;;;158    rki_avarI1_stat=status_di1;
;;;159    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;160    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;161    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;162    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;163    rki_avarI1_stat_old=rki_avarI1_stat;
;;;164    
;;;165    rki_avarI2_stat=status_di2;
;;;166    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;167    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;168    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;169    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;170    rki_avarI2_stat_old=rki_avarI2_stat;
;;;171    */
;;;172    //oleg_end
;;;173    }
00013e  bd30              POP      {r4,r5,pc}
;;;174    
                          ENDP

                  reload_hndl PROC
;;;175    //-----------------------------------------------
;;;176    void reload_hndl(void)
000140  b5f8              PUSH     {r3-r7,lr}
;;;177    {
;;;178    
;;;179    char data[4];
;;;180    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;181    
;;;182    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000142  f44f6560          MOV      r5,#0xe00
000146  4628              MOV      r0,r5
000148  f7fffffe          BL       lc640_read_int
;;;183    event_ptr++;	
00014c  f1000001          ADD      r0,r0,#1
000150  4604              MOV      r4,r0
;;;184    if(event_ptr>63)event_ptr=0;	
000152  2c3f              CMP      r4,#0x3f
000154  d901              BLS      |L1.346|
000156  f04f0400          MOV      r4,#0
                  |L1.346|
;;;185    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
00015a  b221              SXTH     r1,r4
00015c  4628              MOV      r0,r5
00015e  f7fffffe          BL       lc640_write_int
;;;186    	
;;;187    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000162  f6406602          MOV      r6,#0xe02
000166  4630              MOV      r0,r6
000168  f7fffffe          BL       lc640_read_int
;;;188    if(event_cnt!=63)event_cnt=event_ptr;
00016c  283f              CMP      r0,#0x3f
00016e  d000              BEQ      |L1.370|
000170  4620              MOV      r0,r4
                  |L1.370|
;;;189    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000172  b201              SXTH     r1,r0
000174  4630              MOV      r0,r6
000176  f7fffffe          BL       lc640_write_int
;;;190    	
;;;191    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
00017a  4628              MOV      r0,r5
00017c  f7fffffe          BL       lc640_read_int
000180  f44f6180          MOV      r1,#0x400
000184  eb011440          ADD      r4,r1,r0,LSL #5
;;;192    	
;;;193    data[0]='U';
000188  f04f0055          MOV      r0,#0x55
00018c  f88d0000          STRB     r0,[sp,#0]
;;;194    data[1]=0;
000190  f04f0600          MOV      r6,#0
000194  f88d6001          STRB     r6,[sp,#1]
;;;195    data[2]='R';
000198  f04f0052          MOV      r0,#0x52
00019c  f88d0002          STRB     r0,[sp,#2]
;;;196    data[3]=0;
0001a0  f88d6003          STRB     r6,[sp,#3]
;;;197    lc640_write_long_ptr(lc640_adr,data);
0001a4  4669              MOV      r1,sp
0001a6  4620              MOV      r0,r4
0001a8  f7fffffe          BL       lc640_write_long_ptr
;;;198    
;;;199    data[0]=0;
;;;200    data[1]=0;
;;;201    data[2]=0;
;;;202    data[3]=0;
0001ac  9600              STR      r6,[sp,#0]
;;;203    lc640_write_long_ptr(lc640_adr+4,data);
0001ae  4669              MOV      r1,sp
0001b0  1d20              ADDS     r0,r4,#4
0001b2  f7fffffe          BL       lc640_write_long_ptr
;;;204    
;;;205    data[0]=LPC_RTC->YEAR;
0001b6  4d9b              LDR      r5,|L1.1060|
0001b8  8ba8              LDRH     r0,[r5,#0x1c]
0001ba  f88d0000          STRB     r0,[sp,#0]
;;;206    data[1]=LPC_RTC->MONTH;
0001be  7e28              LDRB     r0,[r5,#0x18]
0001c0  f88d0001          STRB     r0,[sp,#1]
;;;207    data[2]=LPC_RTC->DOM;
0001c4  7b28              LDRB     r0,[r5,#0xc]
0001c6  f88d0002          STRB     r0,[sp,#2]
;;;208    data[3]=0;
0001ca  f88d6003          STRB     r6,[sp,#3]
;;;209    lc640_write_long_ptr(lc640_adr+8,data);
0001ce  4669              MOV      r1,sp
0001d0  f1040008          ADD      r0,r4,#8
0001d4  f7fffffe          BL       lc640_write_long_ptr
;;;210    
;;;211    data[0]=LPC_RTC->HOUR;
0001d8  7a28              LDRB     r0,[r5,#8]
0001da  f88d0000          STRB     r0,[sp,#0]
;;;212    data[1]=LPC_RTC->MIN;
0001de  7928              LDRB     r0,[r5,#4]
0001e0  f88d0001          STRB     r0,[sp,#1]
;;;213    data[2]=LPC_RTC->SEC;
0001e4  7828              LDRB     r0,[r5,#0]
0001e6  f88d0002          STRB     r0,[sp,#2]
;;;214    data[3]=LPC_SC->RSID;
0001ea  488f              LDR      r0,|L1.1064|
0001ec  f8d00180          LDR      r0,[r0,#0x180]
0001f0  f88d0003          STRB     r0,[sp,#3]
;;;215    
;;;216    lc640_write_long_ptr(lc640_adr+12,data);
0001f4  4669              MOV      r1,sp
0001f6  f104000c          ADD      r0,r4,#0xc
0001fa  f7fffffe          BL       lc640_write_long_ptr
;;;217    	
;;;218    data[0]='A';
0001fe  f04f0541          MOV      r5,#0x41
000202  f88d5000          STRB     r5,[sp,#0]
;;;219    data[1]='A';
000206  f88d5001          STRB     r5,[sp,#1]
;;;220    data[2]='A';
00020a  f88d5002          STRB     r5,[sp,#2]
;;;221    data[3]='A';
00020e  f88d5003          STRB     r5,[sp,#3]
;;;222    lc640_write_long_ptr(lc640_adr+16,data);
000212  4669              MOV      r1,sp
000214  f1040010          ADD      r0,r4,#0x10
000218  f7fffffe          BL       lc640_write_long_ptr
;;;223    	
;;;224    data[0]='A';
00021c  f88d5000          STRB     r5,[sp,#0]
;;;225    data[1]='A';
000220  f88d5001          STRB     r5,[sp,#1]
;;;226    data[2]='A';
000224  f88d5002          STRB     r5,[sp,#2]
;;;227    data[3]='A';
000228  f88d5003          STRB     r5,[sp,#3]
;;;228    lc640_write_long_ptr(lc640_adr+20,data);
00022c  4669              MOV      r1,sp
00022e  f1040014          ADD      r0,r4,#0x14
000232  f7fffffe          BL       lc640_write_long_ptr
;;;229    	
;;;230    data[0]='A';
000236  f88d5000          STRB     r5,[sp,#0]
;;;231    data[1]='A';
00023a  f88d5001          STRB     r5,[sp,#1]
;;;232    data[2]='A';
00023e  f88d5002          STRB     r5,[sp,#2]
;;;233    data[3]='A';
000242  f88d5003          STRB     r5,[sp,#3]
;;;234    lc640_write_long_ptr(lc640_adr+24,data);
000246  4669              MOV      r1,sp
000248  f1040018          ADD      r0,r4,#0x18
00024c  f7fffffe          BL       lc640_write_long_ptr
;;;235    	
;;;236    data[0]='A';
000250  f88d5000          STRB     r5,[sp,#0]
;;;237    data[1]='A';
000254  f88d5001          STRB     r5,[sp,#1]
;;;238    data[2]='A';
000258  f88d5002          STRB     r5,[sp,#2]
;;;239    data[3]='A';
00025c  f88d5003          STRB     r5,[sp,#3]
;;;240    lc640_write_long_ptr(lc640_adr+28,data);				
000260  4669              MOV      r1,sp
000262  f104001c          ADD      r0,r4,#0x1c
000266  f7fffffe          BL       lc640_write_long_ptr
;;;241    	
;;;242    	
;;;243    }
00026a  bdf8              POP      {r3-r7,pc}
;;;244    
                          ENDP

                  avar_unet_hndl PROC
;;;245    //-----------------------------------------------
;;;246    void avar_unet_hndl(char in)
00026c  e92d4ff8          PUSH     {r3-r11,lr}
;;;247    {
000270  4604              MOV      r4,r0
;;;248    
;;;249    char data[4];
;;;250    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;251    
;;;252    
;;;253    if(in==1)
;;;254    	{
;;;255    	net_av|=1; //o_10
000272  4963              LDR      r1,|L1.1024|
;;;256    	net_av_2min_timer=1200;
;;;257    
;;;258    	//beep_init(0x01L,'O');
;;;259    	//a.av.bAN=1;
;;;260    
;;;261    
;;;262    	//beep_init(0x33333333,'A');
;;;263    	 
;;;264    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;265    	event_ptr++;	
;;;266    	if(event_ptr>63)event_ptr=0;	
;;;267    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;268    	
;;;269         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;270    	if(event_cnt!=63)event_cnt=event_ptr;
;;;271    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;272    	
;;;273    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;274    	
;;;275    	data[0]='P';
;;;276    	data[1]=0;
;;;277    	data[2]='A';
;;;278    	data[3]=0;
;;;279    	lc640_write_long_ptr(lc640_adr,data);
;;;280    
;;;281    	data[0]=0;//*((char*)&Unet_store);
;;;282    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;283    	data[2]=0;
;;;284    	data[3]=0;
;;;285    	lc640_write_long_ptr(lc640_adr+4,data);
;;;286    
;;;287    	data[0]=LPC_RTC->YEAR;
000274  4d6d              LDR      r5,|L1.1068|
000276  f04f0600          MOV      r6,#0                 ;266
00027a  7808              LDRB     r0,[r1,#0]            ;255
00027c  f04f0b50          MOV      r11,#0x50             ;275
000280  f04f0841          MOV      r8,#0x41              ;277
000284  f44f6260          MOV      r2,#0xe00             ;264
000288  f6406a02          MOV      r10,#0xe02            ;269
00028c  f44f6780          MOV      r7,#0x400             ;273
000290  2c01              CMP      r4,#1                 ;253
000292  d008              BEQ      |L1.678|
;;;288    	data[1]=LPC_RTC->MONTH;
;;;289    	data[2]=LPC_RTC->DOM;
;;;290    	data[3]=0;
;;;291    	lc640_write_long_ptr(lc640_adr+8,data);
;;;292    
;;;293    	data[0]=LPC_RTC->HOUR;
;;;294    	data[1]=LPC_RTC->MIN;
;;;295    	data[2]=LPC_RTC->SEC;
;;;296    	data[3]=0;
;;;297    	lc640_write_long_ptr(lc640_adr+12,data);
;;;298    	
;;;299    	data[0]='A';
;;;300    	data[1]='A';
;;;301    	data[2]='A';
;;;302    	data[3]='A';
;;;303    	lc640_write_long_ptr(lc640_adr+16,data);
;;;304    	
;;;305    	data[0]='A';
;;;306    	data[1]='A';
;;;307    	data[2]='A';
;;;308    	data[3]='A';
;;;309    	lc640_write_long_ptr(lc640_adr+20,data);
;;;310    	
;;;311    	data[0]='A';
;;;312    	data[1]='A';
;;;313    	data[2]='A';
;;;314    	data[3]='A';
;;;315    	lc640_write_long_ptr(lc640_adr+24,data);
;;;316    	
;;;317    	data[0]='A';
;;;318    	data[1]='A';
;;;319    	data[2]='A';
;;;320    	data[3]='A';
;;;321    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;322    	
;;;323    /*	memo_out0[0]=0x55;
;;;324         memo_out0[1]=0x00+2;
;;;325         memo_out0[2]=1;
;;;326         memo_out0[3]=0x0b;
;;;327         memo_out0[4]=0x55;
;;;328         memo_out0[5]=0x55; 
;;;329         	
;;;330         memo_out0[6]=crc_87(memo_out0,6);
;;;331    	memo_out0[7]=crc_95(memo_out0,6);
;;;332         usart_out_adr0(memo_out0,8); 
;;;333    	*/
;;;334    	snmp_trap_send("Main power alarm, voltage reduced",2,1,0);
;;;335    	}
;;;336    
;;;337    else if(in==2)
;;;338    	{
;;;339    	net_av|=2;	  //o_10
;;;340    
;;;341    	//beep_init(0x01L,'O');
;;;342    	//a.av.bAN=1;
;;;343    
;;;344    
;;;345    	//beep_init(0x33333333,'A');
;;;346    	 
;;;347    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;348    	event_ptr++;	
;;;349    	if(event_ptr>63)event_ptr=0;	
;;;350    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;351    	
;;;352         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;353    	if(event_cnt!=63)event_cnt=event_ptr;
;;;354    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;355    	
;;;356    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;357    	
;;;358    	data[0]='P';
;;;359    	data[1]=0;
;;;360    	data[2]='B';
000294  f04f0942          MOV      r9,#0x42
000298  2c02              CMP      r4,#2                 ;337
00029a  d07d              BEQ      |L1.920|
;;;361    	data[3]=0;
;;;362    	lc640_write_long_ptr(lc640_adr,data);
;;;363    
;;;364    	data[0]=0;//*((char*)&Unet_store);
;;;365    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;366    	data[2]=0;
;;;367    	data[3]=0;
;;;368    	lc640_write_long_ptr(lc640_adr+4,data);
;;;369    
;;;370    	data[0]=LPC_RTC->YEAR;
;;;371    	data[1]=LPC_RTC->MONTH;
;;;372    	data[2]=LPC_RTC->DOM;
;;;373    	data[3]=0;
;;;374    	lc640_write_long_ptr(lc640_adr+8,data);
;;;375    
;;;376    	data[0]=LPC_RTC->HOUR;
;;;377    	data[1]=LPC_RTC->MIN;
;;;378    	data[2]=LPC_RTC->SEC;
;;;379    	data[3]=0;
;;;380    	lc640_write_long_ptr(lc640_adr+12,data);
;;;381    	
;;;382    	data[0]='A';
;;;383    	data[1]='A';
;;;384    	data[2]='A';
;;;385    	data[3]='A';
;;;386    	lc640_write_long_ptr(lc640_adr+16,data);
;;;387    	
;;;388    	data[0]='A';
;;;389    	data[1]='A';
;;;390    	data[2]='A';
;;;391    	data[3]='A';
;;;392    	lc640_write_long_ptr(lc640_adr+20,data);
;;;393    	
;;;394    	data[0]='A';
;;;395    	data[1]='A';
;;;396    	data[2]='A';
;;;397    	data[3]='A';
;;;398    	lc640_write_long_ptr(lc640_adr+24,data);
;;;399    	
;;;400    	data[0]='A';
;;;401    	data[1]='A';
;;;402    	data[2]='A';
;;;403    	data[3]='A';
;;;404    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;405    	
;;;406    	snmp_trap_send("Main power alarm, voltage increased",2,2,0);
;;;407    	}
;;;408    //o_10_s
;;;409    else if(in==0 || in==4)	
00029c  2c00              CMP      r4,#0
                  |L1.670|
00029e  d07c              BEQ      |L1.922|
0002a0  2c04              CMP      r4,#4
0002a2  d0fc              BEQ      |L1.670|
0002a4  e1fe              B        |L1.1700|
                  |L1.678|
0002a6  f0400001          ORR      r0,r0,#1              ;255
0002aa  7008              STRB     r0,[r1,#0]            ;255
0002ac  4860              LDR      r0,|L1.1072|
0002ae  f44f6196          MOV      r1,#0x4b0             ;256
0002b2  8001              STRH     r1,[r0,#0]            ;256
0002b4  4614              MOV      r4,r2                 ;264
0002b6  4620              MOV      r0,r4                 ;264
0002b8  f7fffffe          BL       lc640_read_int
0002bc  f1000001          ADD      r0,r0,#1              ;265
0002c0  4681              MOV      r9,r0                 ;265
0002c2  f1b90f3f          CMP      r9,#0x3f              ;266
0002c6  d901              BLS      |L1.716|
0002c8  f04f0900          MOV      r9,#0                 ;266
                  |L1.716|
0002cc  fa0ff189          SXTH     r1,r9                 ;267
0002d0  4620              MOV      r0,r4                 ;267
0002d2  f7fffffe          BL       lc640_write_int
0002d6  4650              MOV      r0,r10                ;269
0002d8  f7fffffe          BL       lc640_read_int
0002dc  283f              CMP      r0,#0x3f              ;270
0002de  d000              BEQ      |L1.738|
0002e0  4648              MOV      r0,r9                 ;270
                  |L1.738|
0002e2  b201              SXTH     r1,r0                 ;271
0002e4  4650              MOV      r0,r10                ;271
0002e6  f7fffffe          BL       lc640_write_int
0002ea  4620              MOV      r0,r4                 ;273
0002ec  f7fffffe          BL       lc640_read_int
0002f0  eb071440          ADD      r4,r7,r0,LSL #5       ;273
0002f4  f88db000          STRB     r11,[sp,#0]           ;275
0002f8  f88d6001          STRB     r6,[sp,#1]            ;276
0002fc  f88d8002          STRB     r8,[sp,#2]            ;277
000300  f88d6003          STRB     r6,[sp,#3]            ;278
000304  4669              MOV      r1,sp                 ;279
000306  4620              MOV      r0,r4                 ;279
000308  f7fffffe          BL       lc640_write_long_ptr
00030c  9600              STR      r6,[sp,#0]            ;284
00030e  4669              MOV      r1,sp                 ;285
000310  1d20              ADDS     r0,r4,#4              ;285
000312  f7fffffe          BL       lc640_write_long_ptr
000316  f1050520          ADD      r5,r5,#0x20           ;287
00031a  8ba8              LDRH     r0,[r5,#0x1c]         ;287
00031c  f88d0000          STRB     r0,[sp,#0]            ;287
000320  7e28              LDRB     r0,[r5,#0x18]         ;288
000322  f88d0001          STRB     r0,[sp,#1]            ;288
000326  7b28              LDRB     r0,[r5,#0xc]          ;289
000328  f88d0002          STRB     r0,[sp,#2]            ;289
00032c  f88d6003          STRB     r6,[sp,#3]            ;290
000330  4669              MOV      r1,sp                 ;291
000332  f1040008          ADD      r0,r4,#8              ;291
000336  f7fffffe          BL       lc640_write_long_ptr
00033a  7a28              LDRB     r0,[r5,#8]            ;293
00033c  f88d0000          STRB     r0,[sp,#0]            ;293
000340  7928              LDRB     r0,[r5,#4]            ;294
000342  f88d0001          STRB     r0,[sp,#1]            ;294
000346  7828              LDRB     r0,[r5,#0]            ;295
000348  f88d0002          STRB     r0,[sp,#2]            ;295
00034c  f88d6003          STRB     r6,[sp,#3]            ;296
000350  4669              MOV      r1,sp                 ;297
000352  f104000c          ADD      r0,r4,#0xc            ;297
000356  f7fffffe          BL       lc640_write_long_ptr
00035a  f88d8000          STRB     r8,[sp,#0]            ;299
00035e  f88d8001          STRB     r8,[sp,#1]            ;300
000362  f88d8002          STRB     r8,[sp,#2]            ;301
000366  f88d8003          STRB     r8,[sp,#3]            ;302
00036a  4669              MOV      r1,sp                 ;303
00036c  f1040010          ADD      r0,r4,#0x10           ;303
000370  f7fffffe          BL       lc640_write_long_ptr
000374  f88d8000          STRB     r8,[sp,#0]            ;305
000378  f88d8001          STRB     r8,[sp,#1]            ;306
00037c  f88d8002          STRB     r8,[sp,#2]            ;307
000380  f88d8003          STRB     r8,[sp,#3]            ;308
000384  4669              MOV      r1,sp                 ;309
000386  f1040014          ADD      r0,r4,#0x14           ;309
00038a  f7fffffe          BL       lc640_write_long_ptr
00038e  f88d8000          STRB     r8,[sp,#0]            ;311
000392  f88d8001          STRB     r8,[sp,#1]            ;312
000396  e001              B        |L1.924|
                  |L1.920|
000398  e01d              B        |L1.982|
                  |L1.922|
00039a  e0da              B        |L1.1362|
                  |L1.924|
00039c  f88d8002          STRB     r8,[sp,#2]            ;313
0003a0  f88d8003          STRB     r8,[sp,#3]            ;314
0003a4  4669              MOV      r1,sp                 ;315
0003a6  f1040018          ADD      r0,r4,#0x18           ;315
0003aa  f7fffffe          BL       lc640_write_long_ptr
0003ae  f88d8000          STRB     r8,[sp,#0]            ;317
0003b2  f88d8001          STRB     r8,[sp,#1]            ;318
0003b6  f88d8002          STRB     r8,[sp,#2]            ;319
0003ba  f88d8003          STRB     r8,[sp,#3]            ;320
0003be  4669              MOV      r1,sp                 ;321
0003c0  f104001c          ADD      r0,r4,#0x1c           ;321
0003c4  f7fffffe          BL       lc640_write_long_ptr
0003c8  2300              MOVS     r3,#0                 ;334
0003ca  2201              MOVS     r2,#1                 ;334
0003cc  2102              MOVS     r1,#2                 ;334
0003ce  a019              ADR      r0,|L1.1076|
0003d0  f7fffffe          BL       snmp_trap_send
0003d4  e166              B        |L1.1700|
                  |L1.982|
0003d6  f0400002          ORR      r0,r0,#2              ;339
0003da  7008              STRB     r0,[r1,#0]            ;339
0003dc  f44f6060          MOV      r0,#0xe00             ;347
0003e0  f7fffffe          BL       lc640_read_int
0003e4  f1000001          ADD      r0,r0,#1              ;348
0003e8  4604              MOV      r4,r0                 ;348
0003ea  2c3f              CMP      r4,#0x3f              ;349
0003ec  d901              BLS      |L1.1010|
0003ee  f04f0400          MOV      r4,#0                 ;349
                  |L1.1010|
0003f2  b221              SXTH     r1,r4                 ;350
0003f4  f44f6060          MOV      r0,#0xe00             ;350
0003f8  f7fffffe          BL       lc640_write_int
0003fc  4650              MOV      r0,r10                ;352
0003fe  e02b              B        |L1.1112|
                  |L1.1024|
                          DCD      net_av
                  |L1.1028|
                          DCD      ||.data||
                  |L1.1032|
                          DCD      bps
                  |L1.1036|
                          DCD      sk_av_stat
                  |L1.1040|
                          DCD      SK_ZVUK_EN
                  |L1.1044|
                          DCD      AV_OFF_AVT
                  |L1.1048|
                          DCD      0xeffffffe
                  |L1.1052|
                          DCD      status_izm_r
                  |L1.1056|
                          DCD      sk_alarm
                  |L1.1060|
                          DCD      0x40024020
                  |L1.1064|
                          DCD      0x400fc000
                  |L1.1068|
                          DCD      0x40024000
                  |L1.1072|
                          DCD      net_av_2min_timer
                  |L1.1076|
000434  4d61696e          DCB      "Main power alarm, voltage reduced",0
000438  20706f77
00043c  65722061
000440  6c61726d
000444  2c20766f
000448  6c746167
00044c  65207265
000450  64756365
000454  6400    
000456  00                DCB      0
000457  00                DCB      0
                  |L1.1112|
000458  f7fffffe          BL       lc640_read_int
00045c  283f              CMP      r0,#0x3f              ;353
00045e  d000              BEQ      |L1.1122|
000460  4620              MOV      r0,r4                 ;353
                  |L1.1122|
000462  b201              SXTH     r1,r0                 ;354
000464  4650              MOV      r0,r10                ;354
000466  f7fffffe          BL       lc640_write_int
00046a  f44f6060          MOV      r0,#0xe00             ;356
00046e  f7fffffe          BL       lc640_read_int
000472  eb071440          ADD      r4,r7,r0,LSL #5       ;356
000476  f88db000          STRB     r11,[sp,#0]           ;358
00047a  f88d6001          STRB     r6,[sp,#1]            ;359
00047e  f88d9002          STRB     r9,[sp,#2]            ;360
000482  f88d6003          STRB     r6,[sp,#3]            ;361
000486  4669              MOV      r1,sp                 ;362
000488  4620              MOV      r0,r4                 ;362
00048a  f7fffffe          BL       lc640_write_long_ptr
00048e  9600              STR      r6,[sp,#0]            ;367
000490  4669              MOV      r1,sp                 ;368
000492  1d20              ADDS     r0,r4,#4              ;368
000494  f7fffffe          BL       lc640_write_long_ptr
000498  f1050520          ADD      r5,r5,#0x20           ;370
00049c  8ba8              LDRH     r0,[r5,#0x1c]         ;370
00049e  f88d0000          STRB     r0,[sp,#0]            ;370
0004a2  7e28              LDRB     r0,[r5,#0x18]         ;371
0004a4  f88d0001          STRB     r0,[sp,#1]            ;371
0004a8  7b28              LDRB     r0,[r5,#0xc]          ;372
0004aa  f88d0002          STRB     r0,[sp,#2]            ;372
0004ae  f88d6003          STRB     r6,[sp,#3]            ;373
0004b2  4669              MOV      r1,sp                 ;374
0004b4  f1040008          ADD      r0,r4,#8              ;374
0004b8  f7fffffe          BL       lc640_write_long_ptr
0004bc  7a28              LDRB     r0,[r5,#8]            ;376
0004be  f88d0000          STRB     r0,[sp,#0]            ;376
0004c2  7928              LDRB     r0,[r5,#4]            ;377
0004c4  f88d0001          STRB     r0,[sp,#1]            ;377
0004c8  7828              LDRB     r0,[r5,#0]            ;378
0004ca  f88d0002          STRB     r0,[sp,#2]            ;378
0004ce  f88d6003          STRB     r6,[sp,#3]            ;379
0004d2  4669              MOV      r1,sp                 ;380
0004d4  f104000c          ADD      r0,r4,#0xc            ;380
0004d8  f7fffffe          BL       lc640_write_long_ptr
0004dc  f88d8000          STRB     r8,[sp,#0]            ;382
0004e0  f88d8001          STRB     r8,[sp,#1]            ;383
0004e4  f88d8002          STRB     r8,[sp,#2]            ;384
0004e8  f88d8003          STRB     r8,[sp,#3]            ;385
0004ec  4669              MOV      r1,sp                 ;386
0004ee  f1040010          ADD      r0,r4,#0x10           ;386
0004f2  f7fffffe          BL       lc640_write_long_ptr
0004f6  f88d8000          STRB     r8,[sp,#0]            ;388
0004fa  f88d8001          STRB     r8,[sp,#1]            ;389
0004fe  f88d8002          STRB     r8,[sp,#2]            ;390
000502  f88d8003          STRB     r8,[sp,#3]            ;391
000506  4669              MOV      r1,sp                 ;392
000508  f1040014          ADD      r0,r4,#0x14           ;392
00050c  f7fffffe          BL       lc640_write_long_ptr
000510  f88d8000          STRB     r8,[sp,#0]            ;394
000514  f88d8001          STRB     r8,[sp,#1]            ;395
000518  f88d8002          STRB     r8,[sp,#2]            ;396
00051c  f88d8003          STRB     r8,[sp,#3]            ;397
000520  4669              MOV      r1,sp                 ;398
000522  f1040018          ADD      r0,r4,#0x18           ;398
000526  f7fffffe          BL       lc640_write_long_ptr
00052a  f88d8000          STRB     r8,[sp,#0]            ;400
00052e  f88d8001          STRB     r8,[sp,#1]            ;401
000532  f88d8002          STRB     r8,[sp,#2]            ;402
000536  f88d8003          STRB     r8,[sp,#3]            ;403
00053a  4669              MOV      r1,sp                 ;404
00053c  f104001c          ADD      r0,r4,#0x1c           ;404
000540  f7fffffe          BL       lc640_write_long_ptr
000544  2202              MOVS     r2,#2                 ;406
000546  2300              MOVS     r3,#0                 ;406
000548  4611              MOV      r1,r2                 ;406
00054a  a0fe              ADR      r0,|L1.2372|
00054c  f7fffffe          BL       snmp_trap_send
000550  e0a8              B        |L1.1700|
                  |L1.1362|
;;;410    	{
;;;411    //	if( (in==0 && (net_av&2)==0) || (in==4 && (net_av&1)==0) )  {
;;;412    		if(in==0) net_av&=~1;
000552  b914              CBNZ     r4,|L1.1370|
000554  f0200001          BIC      r0,r0,#1
000558  7008              STRB     r0,[r1,#0]
                  |L1.1370|
;;;413    		if(in==4) net_av&=~2;	 
00055a  2c04              CMP      r4,#4
00055c  d103              BNE      |L1.1382|
00055e  7808              LDRB     r0,[r1,#0]  ; net_av
000560  f0200002          BIC      r0,r0,#2
000564  7008              STRB     r0,[r1,#0]
                  |L1.1382|
;;;414    		if(net_av==0) if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
000566  7809              LDRB     r1,[r1,#0]  ; net_av
000568  48ff              LDR      r0,|L1.2408|
00056a  b931              CBNZ     r1,|L1.1402|
00056c  49ff              LDR      r1,|L1.2412|
00056e  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
000570  b119              CBZ      r1,|L1.1402|
000572  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
000574  f0210101          BIC      r1,r1,#1
000578  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.1402|
;;;415    
;;;416    	SET_REG(avar_stat,0,0,1);
00057a  6801              LDR      r1,[r0,#0]  ; avar_stat
00057c  f0210101          BIC      r1,r1,#1
000580  6001              STR      r1,[r0,#0]  ; avar_stat
;;;417    	
;;;418    	
;;;419    //}
;;;420    //o_10_e
;;;421    
;;;422         event_ptr=lc640_read_int(PTR_EVENT_LOG);
000582  4610              MOV      r0,r2
000584  f7fffffe          BL       lc640_read_int
000588  4683              MOV      r11,r0
;;;423    	event_ptr_find=event_ptr;
00058a  46d8              MOV      r8,r11
                  |L1.1420|
;;;424    avar_unet_hndl_lbl1:
;;;425    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
00058c  eb071a48          ADD      r10,r7,r8,LSL #5
;;;426    
;;;427         lc640_read_long_ptr(lc640_adr,data);
000590  4669              MOV      r1,sp
000592  4650              MOV      r0,r10
000594  f7fffffe          BL       lc640_read_long_ptr
;;;428         
;;;429         if( !( (data[0]=='P')&&(data[1]==0)&&( (in==0 && data[2]=='A' )||(in==4 && data[2]=='B') ) ) )	//o_10
000598  f89d0000          LDRB     r0,[sp,#0]
00059c  2850              CMP      r0,#0x50
00059e  d10f              BNE      |L1.1472|
0005a0  f89d0001          LDRB     r0,[sp,#1]
0005a4  b960              CBNZ     r0,|L1.1472|
0005a6  b114              CBZ      r4,|L1.1454|
0005a8  2c04              CMP      r4,#4
0005aa  d109              BNE      |L1.1472|
0005ac  e004              B        |L1.1464|
                  |L1.1454|
0005ae  f89d0002          LDRB     r0,[sp,#2]
0005b2  2841              CMP      r0,#0x41
0005b4  d104              BNE      |L1.1472|
0005b6  e00e              B        |L1.1494|
                  |L1.1464|
0005b8  f89d0002          LDRB     r0,[sp,#2]
0005bc  2842              CMP      r0,#0x42
0005be  d00a              BEQ      |L1.1494|
                  |L1.1472|
;;;430         	{        
;;;431         	if(event_ptr_find)event_ptr_find--;
0005c0  f1b80f00          CMP      r8,#0
0005c4  d002              BEQ      |L1.1484|
0005c6  f1a80801          SUB      r8,r8,#1
0005ca  e001              B        |L1.1488|
                  |L1.1484|
;;;432         	else event_ptr_find=63;
0005cc  f04f083f          MOV      r8,#0x3f
                  |L1.1488|
;;;433         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0005d0  45d8              CMP      r8,r11
0005d2  d1db              BNE      |L1.1420|
0005d4  e066              B        |L1.1700|
                  |L1.1494|
;;;434         	else goto avar_unet_hndl_lbl1;
;;;435         	}
;;;436         else 
;;;437         	{
;;;438         	lc640_read_long_ptr(lc640_adr+16,data);
0005d6  4669              MOV      r1,sp
0005d8  f10a0010          ADD      r0,r10,#0x10
0005dc  f7fffffe          BL       lc640_read_long_ptr
;;;439         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0005e0  f89d0000          LDRB     r0,[sp,#0]
0005e4  2841              CMP      r0,#0x41
0005e6  d10b              BNE      |L1.1536|
0005e8  f89d0001          LDRB     r0,[sp,#1]
0005ec  2841              CMP      r0,#0x41
0005ee  d107              BNE      |L1.1536|
0005f0  f89d0002          LDRB     r0,[sp,#2]
0005f4  2841              CMP      r0,#0x41
0005f6  d103              BNE      |L1.1536|
0005f8  f89d0003          LDRB     r0,[sp,#3]
0005fc  2841              CMP      r0,#0x41
0005fe  d00a              BEQ      |L1.1558|
                  |L1.1536|
;;;440         		{        
;;;441         		if(event_ptr_find)event_ptr_find--;
000600  f1b80f00          CMP      r8,#0
000604  d002              BEQ      |L1.1548|
000606  f1a80801          SUB      r8,r8,#1
00060a  e001              B        |L1.1552|
                  |L1.1548|
;;;442             		else event_ptr_find=63;
00060c  f04f083f          MOV      r8,#0x3f
                  |L1.1552|
;;;443             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000610  45d8              CMP      r8,r11
000612  d1bb              BNE      |L1.1420|
000614  e046              B        |L1.1700|
                  |L1.1558|
;;;444         		else goto avar_unet_hndl_lbl1;
;;;445         		}
;;;446    
;;;447         	}	
;;;448    	
;;;449    	data[0]=LPC_RTC->YEAR;
000616  f1050520          ADD      r5,r5,#0x20
00061a  8ba8              LDRH     r0,[r5,#0x1c]
00061c  f88d0000          STRB     r0,[sp,#0]
;;;450    	data[1]=LPC_RTC->MONTH;
000620  7e28              LDRB     r0,[r5,#0x18]
000622  f88d0001          STRB     r0,[sp,#1]
;;;451    	data[2]=LPC_RTC->DOM;
000626  7b28              LDRB     r0,[r5,#0xc]
000628  f88d0002          STRB     r0,[sp,#2]
;;;452    	data[3]=0;
00062c  f88d6003          STRB     r6,[sp,#3]
;;;453    	lc640_write_long_ptr(lc640_adr+16,data);
000630  4669              MOV      r1,sp
000632  f10a0010          ADD      r0,r10,#0x10
000636  f7fffffe          BL       lc640_write_long_ptr
;;;454    
;;;455    	data[0]=LPC_RTC->HOUR;
00063a  7a28              LDRB     r0,[r5,#8]
00063c  f88d0000          STRB     r0,[sp,#0]
;;;456    	data[1]=LPC_RTC->MIN;
000640  7928              LDRB     r0,[r5,#4]
000642  f88d0001          STRB     r0,[sp,#1]
;;;457    	data[2]=LPC_RTC->SEC;
000646  7828              LDRB     r0,[r5,#0]
000648  f88d0002          STRB     r0,[sp,#2]
;;;458    	data[3]=0;
00064c  f88d6003          STRB     r6,[sp,#3]
;;;459    	lc640_write_long_ptr(lc640_adr+20,data); 
000650  4669              MOV      r1,sp
000652  f10a0014          ADD      r0,r10,#0x14
000656  f7fffffe          BL       lc640_write_long_ptr
;;;460    	
;;;461    	//o_10_s
;;;462    	if(in==4) {
00065a  2c04              CMP      r4,#4
00065c  d025              BEQ      |L1.1706|
;;;463    	   	data[0]=*((char*)(&net_Ustore_max));
;;;464    		data[1]=*(((char*)(&net_Ustore_max))+1);
;;;465    	}else{
;;;466    		data[0]=*((char*)(&net_Ustore));
00065e  48c4              LDR      r0,|L1.2416|
000660  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000662  f88d1000          STRB     r1,[sp,#0]
;;;467    		data[1]=*(((char*)(&net_Ustore))+1);
000666  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000668  f88d0001          STRB     r0,[sp,#1]
                  |L1.1644|
;;;468    	}
;;;469    	//o_10_e
;;;470    	data[2]='B';
00066c  f88d9002          STRB     r9,[sp,#2]
;;;471    	data[3]='B';
000670  f88d9003          STRB     r9,[sp,#3]
;;;472    	lc640_write_long_ptr(lc640_adr+24,data);
000674  4669              MOV      r1,sp
000676  f10a0018          ADD      r0,r10,#0x18
00067a  f7fffffe          BL       lc640_write_long_ptr
;;;473    	
;;;474    	data[0]='B';
00067e  f88d9000          STRB     r9,[sp,#0]
;;;475    	data[1]='B';
000682  f88d9001          STRB     r9,[sp,#1]
;;;476    	data[2]='B';
000686  f88d9002          STRB     r9,[sp,#2]
;;;477    	data[3]='B';
00068a  f88d9003          STRB     r9,[sp,#3]
;;;478    	lc640_write_long_ptr(lc640_adr+28,data);	
00068e  4669              MOV      r1,sp
000690  f10a001c          ADD      r0,r10,#0x1c
000694  f7fffffe          BL       lc640_write_long_ptr
;;;479    	
;;;480    /*	memo_out0[0]=0x55;
;;;481         memo_out0[1]=0x00+2;
;;;482         memo_out0[2]=1;
;;;483         memo_out0[3]=0x0b;
;;;484         memo_out0[4]=0xaa;
;;;485         memo_out0[5]=0xaa; 
;;;486         	
;;;487         memo_out0[6]=crc_87(memo_out0,6);
;;;488    	memo_out0[7]=crc_95(memo_out0,6);
;;;489         usart_out_adr0(memo_out0,8); */
;;;490         snmp_trap_send("Main power alarm  clear",2,1,1);	
000698  2301              MOVS     r3,#1
00069a  461a              MOV      r2,r3
00069c  2102              MOVS     r1,#2
00069e  a0b5              ADR      r0,|L1.2420|
0006a0  f7fffffe          BL       snmp_trap_send
                  |L1.1700|
;;;491    	}
;;;492    avar_unet_hndl_end:
;;;493    	__nop();		
0006a4  bf00              NOP      
                  |L1.1702|
;;;494    }
0006a6  e8bd8ff8          POP      {r3-r11,pc}
                  |L1.1706|
0006aa  48b8              LDR      r0,|L1.2444|
0006ac  7801              LDRB     r1,[r0,#0]            ;463  ; net_Ustore_max
0006ae  f88d1000          STRB     r1,[sp,#0]            ;463
0006b2  7840              LDRB     r0,[r0,#1]            ;464  ; net_Ustore_max
0006b4  f88d0001          STRB     r0,[sp,#1]            ;464
0006b8  e7d8              B        |L1.1644|
;;;495    
                          ENDP

                  avar_uout_hndl PROC
;;;497    //-----------------------------------------------
;;;498    void avar_uout_hndl(char in)
0006ba  e92d4ff8          PUSH     {r3-r11,lr}
;;;499    {
;;;500    
;;;501    char data[4];
;;;502    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;503    char avar_data=0;
;;;504    
;;;505    if(in==1)
;;;506    	{
;;;507    	//net_av=1;
;;;508    
;;;509    	//beep_init(0x01L,'O');
;;;510    	//a.av.bAN=1;
;;;511    
;;;512    
;;;513    	//beep_init(0x33333333,'A');
;;;514    
;;;515    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;516    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;517    	
;;;518    	avar_data=uout_av;
;;;519    		 
;;;520    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;521    	event_ptr++;	
;;;522    	if(event_ptr>63)event_ptr=0;	
;;;523    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;524    	
;;;525        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;526    	if(event_cnt!=63)event_cnt=event_ptr;
;;;527    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;528    	
;;;529    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;530    	
;;;531    	data[0]='Q';
;;;532    	data[1]=0;
;;;533    	data[2]='A';
;;;534    	data[3]=avar_data;
;;;535    	lc640_write_long_ptr(lc640_adr,data);
;;;536    
;;;537    	 //load_U=4321;
;;;538    
;;;539    	data[0]=*((char*)&load_U);
;;;540    	data[1]=*(((char*)&load_U)+1);
;;;541    	data[2]=0;
;;;542    	data[3]=0;
;;;543    	lc640_write_long_ptr(lc640_adr+4,data);
;;;544    
;;;545    	data[0]=LPC_RTC->YEAR;
0006be  4fb4              LDR      r7,|L1.2448|
0006c0  49b4              LDR      r1,|L1.2452|
0006c2  f44f6560          MOV      r5,#0xe00             ;520
0006c6  f04f0800          MOV      r8,#0                 ;503
0006ca  f44f6980          MOV      r9,#0x400             ;529
0006ce  2801              CMP      r0,#1                 ;505
0006d0  d002              BEQ      |L1.1752|
;;;546    	data[1]=LPC_RTC->MONTH;
;;;547    	data[2]=LPC_RTC->DOM;
;;;548    	data[3]=0;
;;;549    	lc640_write_long_ptr(lc640_adr+8,data);
;;;550    
;;;551    	data[0]=LPC_RTC->HOUR;
;;;552    	data[1]=LPC_RTC->MIN;
;;;553    	data[2]=LPC_RTC->SEC;
;;;554    	data[3]=0;
;;;555    	lc640_write_long_ptr(lc640_adr+12,data);
;;;556    	
;;;557    	data[0]='A';
;;;558    	data[1]='A';
;;;559    	data[2]='A';
;;;560    	data[3]='A';
;;;561    	lc640_write_long_ptr(lc640_adr+16,data);
;;;562    	
;;;563    	data[0]='A';
;;;564    	data[1]='A';
;;;565    	data[2]='A';
;;;566    	data[3]='A';
;;;567    	lc640_write_long_ptr(lc640_adr+20,data);
;;;568    	
;;;569    	data[0]='A';
;;;570    	data[1]='A';
;;;571    	data[2]='A';
;;;572    	data[3]='A';
;;;573    	lc640_write_long_ptr(lc640_adr+24,data);
;;;574    	
;;;575    	data[0]='A';
;;;576    	data[1]='A';
;;;577    	data[2]='A';
;;;578    	data[3]='A';
;;;579    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;580    	
;;;581    /*	memo_out0[0]=0x55;
;;;582         memo_out0[1]=0x00+2;
;;;583         memo_out0[2]=1;
;;;584         memo_out0[3]=0x0b;
;;;585         memo_out0[4]=0x55;
;;;586         memo_out0[5]=0x55; 
;;;587         	
;;;588         memo_out0[6]=crc_87(memo_out0,6);
;;;589    	memo_out0[7]=crc_95(memo_out0,6);
;;;590         usart_out_adr0(memo_out0,8); 
;;;591    	*/
;;;592    	//snmp_trap_send("Main power is off",2,1,0);
;;;593    	}
;;;594    
;;;595    else if(in==0)
0006d2  2800              CMP      r0,#0
0006d4  d07d              BEQ      |L1.2002|
0006d6  e132              B        |L1.2366|
                  |L1.1752|
0006d8  f8dfa2bc          LDR      r10,|L1.2456|
0006dc  4aaf              LDR      r2,|L1.2460|
0006de  f9ba0000          LDRSH    r0,[r10,#0]           ;515  ; load_U
0006e2  f9b22000          LDRSH    r2,[r2,#0]            ;515  ; U_OUT_KONTR_MAX
0006e6  4290              CMP      r0,r2                 ;515
0006e8  dd02              BLE      |L1.1776|
0006ea  f04f0201          MOV      r2,#1                 ;515
0006ee  700a              STRB     r2,[r1,#0]            ;515
                  |L1.1776|
0006f0  4aab              LDR      r2,|L1.2464|
0006f2  f9b22000          LDRSH    r2,[r2,#0]            ;516  ; U_OUT_KONTR_MIN
0006f6  4290              CMP      r0,r2                 ;516
0006f8  da02              BGE      |L1.1792|
0006fa  f04f0002          MOV      r0,#2                 ;516
0006fe  7008              STRB     r0,[r1,#0]            ;516
                  |L1.1792|
000700  780e              LDRB     r6,[r1,#0]            ;518  ; uout_av
000702  4628              MOV      r0,r5                 ;520
000704  f7fffffe          BL       lc640_read_int
000708  f1000001          ADD      r0,r0,#1              ;521
00070c  4604              MOV      r4,r0                 ;521
00070e  2c3f              CMP      r4,#0x3f              ;522
000710  d901              BLS      |L1.1814|
000712  f04f0400          MOV      r4,#0                 ;522
                  |L1.1814|
000716  b221              SXTH     r1,r4                 ;523
000718  4628              MOV      r0,r5                 ;523
00071a  f7fffffe          BL       lc640_write_int
00071e  f6406b02          MOV      r11,#0xe02            ;525
000722  4658              MOV      r0,r11                ;525
000724  f7fffffe          BL       lc640_read_int
000728  283f              CMP      r0,#0x3f              ;526
00072a  d000              BEQ      |L1.1838|
00072c  4620              MOV      r0,r4                 ;526
                  |L1.1838|
00072e  b201              SXTH     r1,r0                 ;527
000730  4658              MOV      r0,r11                ;527
000732  f7fffffe          BL       lc640_write_int
000736  4628              MOV      r0,r5                 ;529
000738  f7fffffe          BL       lc640_read_int
00073c  eb091540          ADD      r5,r9,r0,LSL #5       ;529
000740  f04f0051          MOV      r0,#0x51              ;531
000744  f88d0000          STRB     r0,[sp,#0]            ;531
000748  f88d8001          STRB     r8,[sp,#1]            ;532
00074c  f04f0441          MOV      r4,#0x41              ;533
000750  f88d4002          STRB     r4,[sp,#2]            ;533
000754  f88d6003          STRB     r6,[sp,#3]            ;534
000758  4669              MOV      r1,sp                 ;535
00075a  4628              MOV      r0,r5                 ;535
00075c  f7fffffe          BL       lc640_write_long_ptr
000760  f89a0000          LDRB     r0,[r10,#0]           ;539  ; load_U
000764  f88d0000          STRB     r0,[sp,#0]            ;539
000768  f89a0001          LDRB     r0,[r10,#1]           ;540  ; load_U
00076c  f88d0001          STRB     r0,[sp,#1]            ;540
000770  f88d8002          STRB     r8,[sp,#2]            ;541
000774  f88d8003          STRB     r8,[sp,#3]            ;542
000778  4669              MOV      r1,sp                 ;543
00077a  1d28              ADDS     r0,r5,#4              ;543
00077c  f7fffffe          BL       lc640_write_long_ptr
000780  f1070720          ADD      r7,r7,#0x20           ;545
000784  8bb8              LDRH     r0,[r7,#0x1c]         ;545
000786  f88d0000          STRB     r0,[sp,#0]            ;545
00078a  7e38              LDRB     r0,[r7,#0x18]         ;546
00078c  f88d0001          STRB     r0,[sp,#1]            ;546
000790  7b38              LDRB     r0,[r7,#0xc]          ;547
000792  f88d0002          STRB     r0,[sp,#2]            ;547
000796  f88d8003          STRB     r8,[sp,#3]            ;548
00079a  4669              MOV      r1,sp                 ;549
00079c  f1050008          ADD      r0,r5,#8              ;549
0007a0  f7fffffe          BL       lc640_write_long_ptr
0007a4  7a38              LDRB     r0,[r7,#8]            ;551
0007a6  f88d0000          STRB     r0,[sp,#0]            ;551
0007aa  7938              LDRB     r0,[r7,#4]            ;552
0007ac  f88d0001          STRB     r0,[sp,#1]            ;552
0007b0  7838              LDRB     r0,[r7,#0]            ;553
0007b2  f88d0002          STRB     r0,[sp,#2]            ;553
0007b6  f88d8003          STRB     r8,[sp,#3]            ;554
0007ba  4669              MOV      r1,sp                 ;555
0007bc  f105000c          ADD      r0,r5,#0xc            ;555
0007c0  f7fffffe          BL       lc640_write_long_ptr
0007c4  f88d4000          STRB     r4,[sp,#0]            ;557
0007c8  f88d4001          STRB     r4,[sp,#1]            ;558
0007cc  f88d4002          STRB     r4,[sp,#2]            ;559
0007d0  e000              B        |L1.2004|
                  |L1.2002|
0007d2  e02e              B        |L1.2098|
                  |L1.2004|
0007d4  f88d4003          STRB     r4,[sp,#3]            ;560
0007d8  4669              MOV      r1,sp                 ;561
0007da  f1050010          ADD      r0,r5,#0x10           ;561
0007de  f7fffffe          BL       lc640_write_long_ptr
0007e2  f88d4000          STRB     r4,[sp,#0]            ;563
0007e6  f88d4001          STRB     r4,[sp,#1]            ;564
0007ea  f88d4002          STRB     r4,[sp,#2]            ;565
0007ee  f88d4003          STRB     r4,[sp,#3]            ;566
0007f2  4669              MOV      r1,sp                 ;567
0007f4  f1050014          ADD      r0,r5,#0x14           ;567
0007f8  f7fffffe          BL       lc640_write_long_ptr
0007fc  f88d4000          STRB     r4,[sp,#0]            ;569
000800  f88d4001          STRB     r4,[sp,#1]            ;570
000804  f88d4002          STRB     r4,[sp,#2]            ;571
000808  f88d4003          STRB     r4,[sp,#3]            ;572
00080c  4669              MOV      r1,sp                 ;573
00080e  f1050018          ADD      r0,r5,#0x18           ;573
000812  f7fffffe          BL       lc640_write_long_ptr
000816  f88d4000          STRB     r4,[sp,#0]            ;575
00081a  f88d4001          STRB     r4,[sp,#1]            ;576
00081e  f88d4002          STRB     r4,[sp,#2]            ;577
000822  f88d4003          STRB     r4,[sp,#3]            ;578
000826  4669              MOV      r1,sp                 ;579
000828  f105001c          ADD      r0,r5,#0x1c           ;579
00082c  f7fffffe          BL       lc640_write_long_ptr
000830  e085              B        |L1.2366|
                  |L1.2098|
;;;596    	{
;;;597    	uout_av=0;
000832  f8818000          STRB     r8,[r1,#0]
;;;598    
;;;599      /*
;;;600    	SET_REG(C2GSR,3,24,8);
;;;601    	C2MOD=0;
;;;602    	bOUT_FREE2=1;*/
;;;603    
;;;604    
;;;605    	//C2MOD=0;
;;;606    
;;;607    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;608    
;;;609         //beep_init(0x02L,'O');
;;;610    	//a_.av.bAN=0;
;;;611    //	SET_REG(avar_stat,0,0,1);
;;;612    
;;;613    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;614    	
;;;615    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;616    
;;;617        event_ptr=lc640_read_int(PTR_EVENT_LOG);
000836  4628              MOV      r0,r5
000838  f7fffffe          BL       lc640_read_int
00083c  4606              MOV      r6,r0
;;;618    	event_ptr_find=event_ptr;
00083e  4634              MOV      r4,r6
                  |L1.2112|
;;;619    avar_uout_hndl_lbl1:
;;;620    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000840  eb091544          ADD      r5,r9,r4,LSL #5
;;;621    
;;;622         lc640_read_long_ptr(lc640_adr,data);
000844  4669              MOV      r1,sp
000846  4628              MOV      r0,r5
000848  f7fffffe          BL       lc640_read_long_ptr
;;;623         
;;;624         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
00084c  f89d0000          LDRB     r0,[sp,#0]
000850  2851              CMP      r0,#0x51
000852  d106              BNE      |L1.2146|
000854  f89d0001          LDRB     r0,[sp,#1]
000858  b918              CBNZ     r0,|L1.2146|
00085a  f89d0002          LDRB     r0,[sp,#2]
00085e  2841              CMP      r0,#0x41
000860  d008              BEQ      |L1.2164|
                  |L1.2146|
;;;625         	{        
;;;626         	if(event_ptr_find)event_ptr_find--;
000862  b114              CBZ      r4,|L1.2154|
000864  f1a40401          SUB      r4,r4,#1
000868  e001              B        |L1.2158|
                  |L1.2154|
;;;627         	else event_ptr_find=63;
00086a  f04f043f          MOV      r4,#0x3f
                  |L1.2158|
;;;628         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
00086e  42b4              CMP      r4,r6
000870  d1e6              BNE      |L1.2112|
000872  e064              B        |L1.2366|
                  |L1.2164|
;;;629         	else goto avar_uout_hndl_lbl1;
;;;630         	}
;;;631         else 
;;;632         	{
;;;633         	lc640_read_long_ptr(lc640_adr+16,data);
000874  4669              MOV      r1,sp
000876  f1050010          ADD      r0,r5,#0x10
00087a  f7fffffe          BL       lc640_read_long_ptr
;;;634         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00087e  f89d0000          LDRB     r0,[sp,#0]
000882  2841              CMP      r0,#0x41
000884  d10b              BNE      |L1.2206|
000886  f89d0001          LDRB     r0,[sp,#1]
00088a  2841              CMP      r0,#0x41
00088c  d107              BNE      |L1.2206|
00088e  f89d0002          LDRB     r0,[sp,#2]
000892  2841              CMP      r0,#0x41
000894  d103              BNE      |L1.2206|
000896  f89d0003          LDRB     r0,[sp,#3]
00089a  2841              CMP      r0,#0x41
00089c  d008              BEQ      |L1.2224|
                  |L1.2206|
;;;635         		{        
;;;636         		if(event_ptr_find)event_ptr_find--;
00089e  b114              CBZ      r4,|L1.2214|
0008a0  f1a40401          SUB      r4,r4,#1
0008a4  e001              B        |L1.2218|
                  |L1.2214|
;;;637             		else event_ptr_find=63;
0008a6  f04f043f          MOV      r4,#0x3f
                  |L1.2218|
;;;638             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0008aa  42b4              CMP      r4,r6
0008ac  d1c8              BNE      |L1.2112|
0008ae  e046              B        |L1.2366|
                  |L1.2224|
;;;639         		else goto avar_uout_hndl_lbl1;
;;;640         		}
;;;641    
;;;642         	}	
;;;643    	
;;;644    	data[0]=LPC_RTC->YEAR;
0008b0  f1070720          ADD      r7,r7,#0x20
0008b4  8bb8              LDRH     r0,[r7,#0x1c]
0008b6  f88d0000          STRB     r0,[sp,#0]
;;;645    	data[1]=LPC_RTC->MONTH;
0008ba  7e38              LDRB     r0,[r7,#0x18]
0008bc  f88d0001          STRB     r0,[sp,#1]
;;;646    	data[2]=LPC_RTC->DOM;
0008c0  7b38              LDRB     r0,[r7,#0xc]
0008c2  f88d0002          STRB     r0,[sp,#2]
;;;647    	data[3]=0;
0008c6  f88d8003          STRB     r8,[sp,#3]
;;;648    	lc640_write_long_ptr(lc640_adr+16,data);
0008ca  4669              MOV      r1,sp
0008cc  f1050010          ADD      r0,r5,#0x10
0008d0  f7fffffe          BL       lc640_write_long_ptr
;;;649    
;;;650    	data[0]=LPC_RTC->HOUR;
0008d4  7a38              LDRB     r0,[r7,#8]
0008d6  f88d0000          STRB     r0,[sp,#0]
;;;651    	data[1]=LPC_RTC->MIN;
0008da  7938              LDRB     r0,[r7,#4]
0008dc  f88d0001          STRB     r0,[sp,#1]
;;;652    	data[2]=LPC_RTC->SEC;
0008e0  7838              LDRB     r0,[r7,#0]
0008e2  f88d0002          STRB     r0,[sp,#2]
;;;653    	data[3]=0;
0008e6  f88d8003          STRB     r8,[sp,#3]
;;;654    	lc640_write_long_ptr(lc640_adr+20,data); 
0008ea  4669              MOV      r1,sp
0008ec  f1050014          ADD      r0,r5,#0x14
0008f0  f7fffffe          BL       lc640_write_long_ptr
;;;655    	
;;;656    	data[0]=*((char*)(&net_Ustore));
0008f4  481e              LDR      r0,|L1.2416|
0008f6  7801              LDRB     r1,[r0,#0]  ; net_Ustore
0008f8  f88d1000          STRB     r1,[sp,#0]
;;;657    	data[1]=*(((char*)(&net_Ustore))+1);
0008fc  7840              LDRB     r0,[r0,#1]  ; net_Ustore
0008fe  f88d0001          STRB     r0,[sp,#1]
;;;658    	data[2]='B';
000902  f04f0442          MOV      r4,#0x42
000906  f88d4002          STRB     r4,[sp,#2]
;;;659    	data[3]='B';
00090a  f88d4003          STRB     r4,[sp,#3]
;;;660    	lc640_write_long_ptr(lc640_adr+24,data);
00090e  4669              MOV      r1,sp
000910  f1050018          ADD      r0,r5,#0x18
000914  f7fffffe          BL       lc640_write_long_ptr
;;;661    	
;;;662    	data[0]='B';
000918  f88d4000          STRB     r4,[sp,#0]
;;;663    	data[1]='B';
00091c  f88d4001          STRB     r4,[sp,#1]
;;;664    	data[2]='B';
000920  f88d4002          STRB     r4,[sp,#2]
;;;665    	data[3]='B';
000924  f88d4003          STRB     r4,[sp,#3]
;;;666    	lc640_write_long_ptr(lc640_adr+28,data);	
000928  4669              MOV      r1,sp
00092a  f105001c          ADD      r0,r5,#0x1c
00092e  f7fffffe          BL       lc640_write_long_ptr
;;;667    	
;;;668    /*	memo_out0[0]=0x55;
;;;669         memo_out0[1]=0x00+2;
;;;670         memo_out0[2]=1;
;;;671         memo_out0[3]=0x0b;
;;;672         memo_out0[4]=0xaa;
;;;673         memo_out0[5]=0xaa; 
;;;674         	
;;;675         memo_out0[6]=crc_87(memo_out0,6);
;;;676    	memo_out0[7]=crc_95(memo_out0,6);
;;;677         usart_out_adr0(memo_out0,8); */
;;;678         snmp_trap_send("Main power is on",2,1,1);	
000932  2301              MOVS     r3,#1
000934  461a              MOV      r2,r3
000936  2102              MOVS     r1,#2
000938  a01a              ADR      r0,|L1.2468|
00093a  f7fffffe          BL       snmp_trap_send
                  |L1.2366|
;;;679    	}
;;;680    avar_unet_hndl_end:
;;;681    	__nop();		
00093e  bf00              NOP      
;;;682    }
000940  e6b1              B        |L1.1702|
000942  0000              DCW      0x0000
                  |L1.2372|
000944  4d61696e          DCB      "Main power alarm, voltage increased",0
000948  20706f77
00094c  65722061
000950  6c61726d
000954  2c20766f
000958  6c746167
00095c  6520696e
000960  63726561
000964  73656400
                  |L1.2408|
                          DCD      ||.data||
                  |L1.2412|
                          DCD      AV_OFF_AVT
                  |L1.2416|
                          DCD      net_Ustore
                  |L1.2420|
000974  4d61696e          DCB      "Main power alarm  clear",0
000978  20706f77
00097c  65722061
000980  6c61726d
000984  2020636c
000988  65617200
                  |L1.2444|
                          DCD      net_Ustore_max
                  |L1.2448|
                          DCD      0x40024000
                  |L1.2452|
                          DCD      uout_av
                  |L1.2456|
                          DCD      load_U
                  |L1.2460|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2464|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2468|
0009a4  4d61696e          DCB      "Main power is on",0
0009a8  20706f77
0009ac  65722069
0009b0  73206f6e
0009b4  00      
0009b5  00                DCB      0
0009b6  00                DCB      0
0009b7  00                DCB      0
                          ENDP

                  avar_bps_hndl PROC
;;;684    //-----------------------------------------------
;;;685    void avar_bps_hndl(char dev, char v, char in)
0009b8  e92d4ff8          PUSH     {r3-r11,lr}
;;;686    {
0009bc  4606              MOV      r6,r0
0009be  460c              MOV      r4,r1
;;;687    char data[4];
;;;688    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;689    char avar_simbol;
;;;690    
;;;691    avar_simbol='T';
0009c0  f04f0754          MOV      r7,#0x54
;;;692    if(v==0)avar_simbol='T';
0009c4  b174              CBZ      r4,|L1.2532|
;;;693    else if(v==1)avar_simbol='U';
0009c6  2c01              CMP      r4,#1
0009c8  d004              BEQ      |L1.2516|
;;;694    else if(v==2)avar_simbol='u';
0009ca  2c02              CMP      r4,#2
0009cc  d005              BEQ      |L1.2522|
;;;695    else if(v==3)avar_simbol='L';
0009ce  2c03              CMP      r4,#3
0009d0  d006              BEQ      |L1.2528|
0009d2  e007              B        |L1.2532|
                  |L1.2516|
0009d4  f04f0755          MOV      r7,#0x55              ;693
0009d8  e004              B        |L1.2532|
                  |L1.2522|
0009da  f04f0775          MOV      r7,#0x75              ;694
0009de  e001              B        |L1.2532|
                  |L1.2528|
0009e0  f04f074c          MOV      r7,#0x4c
                  |L1.2532|
;;;696    
;;;697    if(in==1)
;;;698    	{
;;;699    	//av_src[bps]=1;
;;;700    
;;;701    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;702    //	SET_REG(avar_stat,1,3+dev,1);
;;;703    	
;;;704    	if(v==0)bps[dev]._av|=(1<<0);
;;;705    	else if(v==1) bps[dev]._av|=(1<<1);
;;;706    	else if(v==2) bps[dev]._av|=(1<<2);
;;;707    	else if(v==3) bps[dev]._av|=(1<<3);
;;;708    
;;;709    	bps[dev]._last_avar=v;
;;;710    
;;;711    	//beep_init(0x33333333,'A');
;;;712    
;;;713    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;714    	event_ptr++;	
;;;715    	if(event_ptr>63)event_ptr=0;	
;;;716    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;717    	
;;;718        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;719    	if(event_cnt!=63)event_cnt=event_ptr;
;;;720    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;721    	
;;;722    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;723    	
;;;724    	data[0]='S';
;;;725    	data[1]=dev; 
;;;726    	data[2]=avar_simbol;
;;;727    	data[3]=0;
;;;728    	lc640_write_long_ptr(lc640_adr,data);
;;;729    
;;;730    	data[0]=0;
;;;731    	data[1]=0;
;;;732    	data[2]=0;
;;;733    	data[3]=0;
;;;734    	lc640_write_long_ptr(lc640_adr+4,data);
;;;735    
;;;736    	data[0]=LPC_RTC->YEAR;
0009e4  f8df8400          LDR      r8,|L1.3560|
0009e8  f04f0900          MOV      r9,#0                 ;686
0009ec  48ff              LDR      r0,|L1.3564|
0009ee  eb0601c6          ADD      r1,r6,r6,LSL #3       ;704
0009f2  eb011106          ADD      r1,r1,r6,LSL #4       ;704
0009f6  f44f6a60          MOV      r10,#0xe00            ;713
0009fa  f44f6580          MOV      r5,#0x400             ;722
0009fe  eb000081          ADD      r0,r0,r1,LSL #2       ;704
000a02  2a01              CMP      r2,#1                 ;697
000a04  d002              BEQ      |L1.2572|
;;;737    	data[1]=LPC_RTC->MONTH;
;;;738    	data[2]=LPC_RTC->DOM;
;;;739    	data[3]=0;
;;;740    	lc640_write_long_ptr(lc640_adr+8,data);
;;;741    
;;;742    	data[0]=LPC_RTC->HOUR;
;;;743    	data[1]=LPC_RTC->MIN;
;;;744    	data[2]=LPC_RTC->SEC;
;;;745    	data[3]=0;
;;;746    	lc640_write_long_ptr(lc640_adr+12,data);
;;;747    	
;;;748    	data[0]='A';
;;;749    	data[1]='A';
;;;750    	data[2]='A';
;;;751    	data[3]='A';
;;;752    	lc640_write_long_ptr(lc640_adr+16,data);
;;;753    	
;;;754    	data[0]='A';
;;;755    	data[1]='A';
;;;756    	data[2]='A';
;;;757    	data[3]='A';
;;;758    	lc640_write_long_ptr(lc640_adr+20,data);
;;;759    	
;;;760    	data[0]='A';
;;;761    	data[1]='A';
;;;762    	data[2]='A';
;;;763    	data[3]='A';
;;;764    	lc640_write_long_ptr(lc640_adr+24,data);
;;;765    	
;;;766    	data[0]='A';
;;;767    	data[1]='A';
;;;768    	data[2]='A';
;;;769    	data[3]='A';
;;;770    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;771    
;;;772    
;;;773    	if(dev==0)
;;;774    		{
;;;775    		if(v==0)
;;;776    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;777    		else if(v==1)
;;;778    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;779    		else if(v==2)
;;;780    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;781    		else if(v==3)
;;;782    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;783    		}
;;;784    	else if(dev==1)
;;;785    		{
;;;786    		if(v==0)
;;;787    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;788    		else if(v==1)
;;;789    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;790    		else if(v==2)
;;;791    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;792    		else if(v==3)
;;;793    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;794    		} 
;;;795    	else if(dev==2)
;;;796    		{
;;;797    		if(v==0)
;;;798    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;799    		else if(v==1)
;;;800    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;801    		else if(v==2)
;;;802    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;803    		else if(v==3)
;;;804    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;805    		} 	
;;;806    			
;;;807    	}
;;;808    
;;;809    else if(in==0)
000a06  2a00              CMP      r2,#0
000a08  d07e              BEQ      |L1.2824|
000a0a  e1c4              B        |L1.3478|
                  |L1.2572|
000a0c  b134              CBZ      r4,|L1.2588|
000a0e  2c01              CMP      r4,#1                 ;705
000a10  d009              BEQ      |L1.2598|
000a12  2c02              CMP      r4,#2                 ;706
000a14  d00c              BEQ      |L1.2608|
000a16  2c03              CMP      r4,#3                 ;707
000a18  d00f              BEQ      |L1.2618|
000a1a  e012              B        |L1.2626|
                  |L1.2588|
000a1c  7841              LDRB     r1,[r0,#1]            ;704
000a1e  f0410101          ORR      r1,r1,#1              ;704
000a22  7041              STRB     r1,[r0,#1]            ;704
000a24  e00d              B        |L1.2626|
                  |L1.2598|
000a26  7841              LDRB     r1,[r0,#1]            ;705
000a28  f0410102          ORR      r1,r1,#2              ;705
000a2c  7041              STRB     r1,[r0,#1]            ;705
000a2e  e008              B        |L1.2626|
                  |L1.2608|
000a30  7841              LDRB     r1,[r0,#1]            ;706
000a32  f0410104          ORR      r1,r1,#4              ;706
000a36  7041              STRB     r1,[r0,#1]            ;706
000a38  e003              B        |L1.2626|
                  |L1.2618|
000a3a  7841              LDRB     r1,[r0,#1]            ;707
000a3c  f0410108          ORR      r1,r1,#8              ;707
000a40  7041              STRB     r1,[r0,#1]            ;707
                  |L1.2626|
000a42  f8804057          STRB     r4,[r0,#0x57]         ;709
000a46  4650              MOV      r0,r10                ;713
000a48  f7fffffe          BL       lc640_read_int
000a4c  f1000001          ADD      r0,r0,#1              ;714
000a50  fa1ffb80          UXTH     r11,r0                ;714
000a54  f1bb0f3f          CMP      r11,#0x3f             ;715
000a58  d901              BLS      |L1.2654|
000a5a  f04f0b00          MOV      r11,#0                ;715
                  |L1.2654|
000a5e  fa0ff18b          SXTH     r1,r11                ;716
000a62  4650              MOV      r0,r10                ;716
000a64  f7fffffe          BL       lc640_write_int
000a68  f6406002          MOV      r0,#0xe02             ;718
000a6c  f7fffffe          BL       lc640_read_int
000a70  b280              UXTH     r0,r0                 ;718
000a72  283f              CMP      r0,#0x3f              ;719
000a74  d000              BEQ      |L1.2680|
000a76  4658              MOV      r0,r11                ;719
                  |L1.2680|
000a78  b201              SXTH     r1,r0                 ;720
000a7a  f6406002          MOV      r0,#0xe02             ;720
000a7e  f7fffffe          BL       lc640_write_int
000a82  4650              MOV      r0,r10                ;722
000a84  f7fffffe          BL       lc640_read_int
000a88  eb051040          ADD      r0,r5,r0,LSL #5       ;722
000a8c  b285              UXTH     r5,r0                 ;722
000a8e  f04f0053          MOV      r0,#0x53              ;724
000a92  f88d0000          STRB     r0,[sp,#0]            ;724
000a96  f88d6001          STRB     r6,[sp,#1]            ;725
000a9a  f88d7002          STRB     r7,[sp,#2]            ;726
000a9e  f88d9003          STRB     r9,[sp,#3]            ;727
000aa2  4669              MOV      r1,sp                 ;728
000aa4  4628              MOV      r0,r5                 ;728
000aa6  f7fffffe          BL       lc640_write_long_ptr
000aaa  f8cd9000          STR      r9,[sp,#0]            ;733
000aae  4669              MOV      r1,sp                 ;734
000ab0  1d28              ADDS     r0,r5,#4              ;734
000ab2  f7fffffe          BL       lc640_write_long_ptr
000ab6  f8b8003c          LDRH     r0,[r8,#0x3c]         ;736
000aba  f88d0000          STRB     r0,[sp,#0]            ;736
000abe  f8980038          LDRB     r0,[r8,#0x38]         ;737
000ac2  f88d0001          STRB     r0,[sp,#1]            ;737
000ac6  f898002c          LDRB     r0,[r8,#0x2c]         ;738
000aca  f88d0002          STRB     r0,[sp,#2]            ;738
000ace  f88d9003          STRB     r9,[sp,#3]            ;739
000ad2  4669              MOV      r1,sp                 ;740
000ad4  f1050008          ADD      r0,r5,#8              ;740
000ad8  f7fffffe          BL       lc640_write_long_ptr
000adc  f8980028          LDRB     r0,[r8,#0x28]         ;742
000ae0  f88d0000          STRB     r0,[sp,#0]            ;742
000ae4  f8980024          LDRB     r0,[r8,#0x24]         ;743
000ae8  f88d0001          STRB     r0,[sp,#1]            ;743
000aec  f8980020          LDRB     r0,[r8,#0x20]         ;744
000af0  f88d0002          STRB     r0,[sp,#2]            ;744
000af4  f88d9003          STRB     r9,[sp,#3]            ;745
000af8  4669              MOV      r1,sp                 ;746
000afa  f105000c          ADD      r0,r5,#0xc            ;746
000afe  f7fffffe          BL       lc640_write_long_ptr
000b02  f04f0741          MOV      r7,#0x41              ;748
000b06  e000              B        |L1.2826|
                  |L1.2824|
000b08  e0a5              B        |L1.3158|
                  |L1.2826|
000b0a  f88d7000          STRB     r7,[sp,#0]            ;748
000b0e  f88d7001          STRB     r7,[sp,#1]            ;749
000b12  f88d7002          STRB     r7,[sp,#2]            ;750
000b16  f88d7003          STRB     r7,[sp,#3]            ;751
000b1a  4669              MOV      r1,sp                 ;752
000b1c  f1050010          ADD      r0,r5,#0x10           ;752
000b20  f7fffffe          BL       lc640_write_long_ptr
000b24  f88d7000          STRB     r7,[sp,#0]            ;754
000b28  f88d7001          STRB     r7,[sp,#1]            ;755
000b2c  f88d7002          STRB     r7,[sp,#2]            ;756
000b30  f88d7003          STRB     r7,[sp,#3]            ;757
000b34  4669              MOV      r1,sp                 ;758
000b36  f1050014          ADD      r0,r5,#0x14           ;758
000b3a  f7fffffe          BL       lc640_write_long_ptr
000b3e  f88d7000          STRB     r7,[sp,#0]            ;760
000b42  f88d7001          STRB     r7,[sp,#1]            ;761
000b46  f88d7002          STRB     r7,[sp,#2]            ;762
000b4a  f88d7003          STRB     r7,[sp,#3]            ;763
000b4e  4669              MOV      r1,sp                 ;764
000b50  f1050018          ADD      r0,r5,#0x18           ;764
000b54  f7fffffe          BL       lc640_write_long_ptr
000b58  f88d7000          STRB     r7,[sp,#0]            ;766
000b5c  f88d7001          STRB     r7,[sp,#1]            ;767
000b60  f88d7002          STRB     r7,[sp,#2]            ;768
000b64  f88d7003          STRB     r7,[sp,#3]            ;769
000b68  4669              MOV      r1,sp                 ;770
000b6a  f105001c          ADD      r0,r5,#0x1c           ;770
000b6e  f7fffffe          BL       lc640_write_long_ptr
000b72  b126              CBZ      r6,|L1.2942|
000b74  2e01              CMP      r6,#1                 ;784
000b76  d026              BEQ      |L1.3014|
000b78  2e02              CMP      r6,#2                 ;795
000b7a  d048              BEQ      |L1.3086|
000b7c  e10b              B        |L1.3478|
                  |L1.2942|
000b7e  b134              CBZ      r4,|L1.2958|
000b80  2c01              CMP      r4,#1                 ;777
000b82  d00b              BEQ      |L1.2972|
000b84  2c02              CMP      r4,#2                 ;779
000b86  d010              BEQ      |L1.2986|
000b88  2c03              CMP      r4,#3                 ;781
000b8a  d015              BEQ      |L1.3000|
000b8c  e103              B        |L1.3478|
                  |L1.2958|
000b8e  2300              MOVS     r3,#0                 ;776
000b90  2201              MOVS     r2,#1                 ;776
000b92  2104              MOVS     r1,#4                 ;776
000b94  a096              ADR      r0,|L1.3568|
000b96  f7fffffe          BL       snmp_trap_send
000b9a  e0fc              B        |L1.3478|
                  |L1.2972|
000b9c  2301              MOVS     r3,#1                 ;778
000b9e  461a              MOV      r2,r3                 ;778
000ba0  2104              MOVS     r1,#4                 ;778
000ba2  a099              ADR      r0,|L1.3592|
000ba4  f7fffffe          BL       snmp_trap_send
000ba8  e0f5              B        |L1.3478|
                  |L1.2986|
000baa  2302              MOVS     r3,#2                 ;780
000bac  2201              MOVS     r2,#1                 ;780
000bae  2104              MOVS     r1,#4                 ;780
000bb0  a09c              ADR      r0,|L1.3620|
000bb2  f7fffffe          BL       snmp_trap_send
000bb6  e0ee              B        |L1.3478|
                  |L1.3000|
000bb8  2303              MOVS     r3,#3                 ;782
000bba  2201              MOVS     r2,#1                 ;782
000bbc  2104              MOVS     r1,#4                 ;782
000bbe  a0a1              ADR      r0,|L1.3652|
000bc0  f7fffffe          BL       snmp_trap_send
000bc4  e0e7              B        |L1.3478|
                  |L1.3014|
000bc6  b134              CBZ      r4,|L1.3030|
000bc8  2c01              CMP      r4,#1                 ;788
000bca  d00b              BEQ      |L1.3044|
000bcc  2c02              CMP      r4,#2                 ;790
000bce  d010              BEQ      |L1.3058|
000bd0  2c03              CMP      r4,#3                 ;792
000bd2  d015              BEQ      |L1.3072|
000bd4  e0df              B        |L1.3478|
                  |L1.3030|
000bd6  2300              MOVS     r3,#0                 ;787
000bd8  2202              MOVS     r2,#2                 ;787
000bda  2104              MOVS     r1,#4                 ;787
000bdc  a0a1              ADR      r0,|L1.3684|
000bde  f7fffffe          BL       snmp_trap_send
000be2  e0d8              B        |L1.3478|
                  |L1.3044|
000be4  2301              MOVS     r3,#1                 ;789
000be6  2202              MOVS     r2,#2                 ;789
000be8  2104              MOVS     r1,#4                 ;789
000bea  a0a4              ADR      r0,|L1.3708|
000bec  f7fffffe          BL       snmp_trap_send
000bf0  e0d1              B        |L1.3478|
                  |L1.3058|
000bf2  2302              MOVS     r3,#2                 ;791
000bf4  461a              MOV      r2,r3                 ;791
000bf6  2104              MOVS     r1,#4                 ;791
000bf8  a0a7              ADR      r0,|L1.3736|
000bfa  f7fffffe          BL       snmp_trap_send
000bfe  e0ca              B        |L1.3478|
                  |L1.3072|
000c00  2303              MOVS     r3,#3                 ;793
000c02  2202              MOVS     r2,#2                 ;793
000c04  2104              MOVS     r1,#4                 ;793
000c06  a0ac              ADR      r0,|L1.3768|
000c08  f7fffffe          BL       snmp_trap_send
000c0c  e0c3              B        |L1.3478|
                  |L1.3086|
000c0e  b134              CBZ      r4,|L1.3102|
000c10  2c01              CMP      r4,#1                 ;799
000c12  d00b              BEQ      |L1.3116|
000c14  2c02              CMP      r4,#2                 ;801
000c16  d010              BEQ      |L1.3130|
000c18  2c03              CMP      r4,#3                 ;803
000c1a  d015              BEQ      |L1.3144|
000c1c  e0bb              B        |L1.3478|
                  |L1.3102|
000c1e  2300              MOVS     r3,#0                 ;798
000c20  2203              MOVS     r2,#3                 ;798
000c22  2104              MOVS     r1,#4                 ;798
000c24  a0ac              ADR      r0,|L1.3800|
000c26  f7fffffe          BL       snmp_trap_send
000c2a  e0b4              B        |L1.3478|
                  |L1.3116|
000c2c  2301              MOVS     r3,#1                 ;800
000c2e  2203              MOVS     r2,#3                 ;800
000c30  2104              MOVS     r1,#4                 ;800
000c32  a0af              ADR      r0,|L1.3824|
000c34  f7fffffe          BL       snmp_trap_send
000c38  e0ad              B        |L1.3478|
                  |L1.3130|
000c3a  2302              MOVS     r3,#2                 ;802
000c3c  2203              MOVS     r2,#3                 ;802
000c3e  2104              MOVS     r1,#4                 ;802
000c40  a0b2              ADR      r0,|L1.3852|
000c42  f7fffffe          BL       snmp_trap_send
000c46  e0a6              B        |L1.3478|
                  |L1.3144|
000c48  2303              MOVS     r3,#3                 ;804
000c4a  461a              MOV      r2,r3                 ;804
000c4c  2104              MOVS     r1,#4                 ;804
000c4e  a0b7              ADR      r0,|L1.3884|
000c50  f7fffffe          BL       snmp_trap_send
000c54  e09f              B        |L1.3478|
                  |L1.3158|
;;;810    	{      
;;;811    //	av_bps[bps]=0;
;;;812    
;;;813    	//SET_REG(avar_stat,0,3+bps,1);
;;;814    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;815    
;;;816         if(v==0) bps[dev]._av&=(~(1<<0));
000c56  b134              CBZ      r4,|L1.3174|
;;;817         else if(v==1) bps[dev]._av&=(~(1<<1));
000c58  2c01              CMP      r4,#1
000c5a  d009              BEQ      |L1.3184|
;;;818    	else if(v==2) bps[dev]._av&=(~(1<<2));
000c5c  2c02              CMP      r4,#2
000c5e  d00c              BEQ      |L1.3194|
;;;819    	else if(v==3) bps[dev]._av&=(~(1<<3));
000c60  2c03              CMP      r4,#3
000c62  d00f              BEQ      |L1.3204|
000c64  e012              B        |L1.3212|
                  |L1.3174|
000c66  7841              LDRB     r1,[r0,#1]            ;816
000c68  f0210101          BIC      r1,r1,#1              ;816
000c6c  7041              STRB     r1,[r0,#1]            ;816
000c6e  e00d              B        |L1.3212|
                  |L1.3184|
000c70  7841              LDRB     r1,[r0,#1]            ;817
000c72  f0210102          BIC      r1,r1,#2              ;817
000c76  7041              STRB     r1,[r0,#1]            ;817
000c78  e008              B        |L1.3212|
                  |L1.3194|
000c7a  7841              LDRB     r1,[r0,#1]            ;818
000c7c  f0210104          BIC      r1,r1,#4              ;818
000c80  7041              STRB     r1,[r0,#1]            ;818
000c82  e003              B        |L1.3212|
                  |L1.3204|
000c84  7841              LDRB     r1,[r0,#1]
000c86  f0210108          BIC      r1,r1,#8
000c8a  7041              STRB     r1,[r0,#1]
                  |L1.3212|
;;;820         
;;;821    //	if((bps[dev]._av&0x0f==0))
;;;822    //	     {
;;;823    		//SET_REG(avar_stat,0,3+bps,1);
;;;824    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;825    //	     }
;;;826     
;;;827    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000c8c  4650              MOV      r0,r10
000c8e  f7fffffe          BL       lc640_read_int
000c92  fa1ffb80          UXTH     r11,r0
;;;828    	event_ptr_find=event_ptr;
000c96  465c              MOV      r4,r11
                  |L1.3224|
;;;829    	
;;;830    avar_src_hndl_lbl1: 
;;;831    
;;;832    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000c98  eb051044          ADD      r0,r5,r4,LSL #5
000c9c  fa1ffa80          UXTH     r10,r0
;;;833    
;;;834         lc640_read_long_ptr(lc640_adr,data);
000ca0  4669              MOV      r1,sp
000ca2  4650              MOV      r0,r10
000ca4  f7fffffe          BL       lc640_read_long_ptr
;;;835         
;;;836         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000ca8  f89d0000          LDRB     r0,[sp,#0]
000cac  2853              CMP      r0,#0x53
000cae  d107              BNE      |L1.3264|
000cb0  f89d0001          LDRB     r0,[sp,#1]
000cb4  42b0              CMP      r0,r6
000cb6  d103              BNE      |L1.3264|
000cb8  f89d0002          LDRB     r0,[sp,#2]
000cbc  42b8              CMP      r0,r7
000cbe  d009              BEQ      |L1.3284|
                  |L1.3264|
;;;837         	{        
;;;838         	if(event_ptr_find)event_ptr_find--;
000cc0  b11c              CBZ      r4,|L1.3274|
000cc2  f1a40401          SUB      r4,r4,#1
000cc6  b2a4              UXTH     r4,r4
000cc8  e001              B        |L1.3278|
                  |L1.3274|
;;;839         	else event_ptr_find=63;
000cca  f04f043f          MOV      r4,#0x3f
                  |L1.3278|
;;;840         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000cce  455c              CMP      r4,r11
000cd0  d1e2              BNE      |L1.3224|
000cd2  e060              B        |L1.3478|
                  |L1.3284|
;;;841         	else goto avar_src_hndl_lbl1;
;;;842         	}
;;;843         else 
;;;844         	{
;;;845         	lc640_read_long_ptr(lc640_adr+16,data);
000cd4  4669              MOV      r1,sp
000cd6  f10a0010          ADD      r0,r10,#0x10
000cda  f7fffffe          BL       lc640_read_long_ptr
;;;846         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000cde  f89d0000          LDRB     r0,[sp,#0]
000ce2  2841              CMP      r0,#0x41
000ce4  d10b              BNE      |L1.3326|
000ce6  f89d0001          LDRB     r0,[sp,#1]
000cea  2841              CMP      r0,#0x41
000cec  d107              BNE      |L1.3326|
000cee  f89d0002          LDRB     r0,[sp,#2]
000cf2  2841              CMP      r0,#0x41
000cf4  d103              BNE      |L1.3326|
000cf6  f89d0003          LDRB     r0,[sp,#3]
000cfa  2841              CMP      r0,#0x41
000cfc  d009              BEQ      |L1.3346|
                  |L1.3326|
;;;847         		{        
;;;848         		if(event_ptr_find)event_ptr_find--;
000cfe  b11c              CBZ      r4,|L1.3336|
000d00  f1a40401          SUB      r4,r4,#1
000d04  b2a4              UXTH     r4,r4
000d06  e001              B        |L1.3340|
                  |L1.3336|
;;;849             		else event_ptr_find=63;
000d08  f04f043f          MOV      r4,#0x3f
                  |L1.3340|
;;;850             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000d0c  455c              CMP      r4,r11
000d0e  d1c3              BNE      |L1.3224|
000d10  e041              B        |L1.3478|
                  |L1.3346|
;;;851         		else goto avar_src_hndl_lbl1;
;;;852         		}
;;;853    
;;;854         	}	
;;;855    
;;;856    
;;;857    	
;;;858    	data[0]=LPC_RTC->YEAR;
000d12  f8b8003c          LDRH     r0,[r8,#0x3c]
000d16  f88d0000          STRB     r0,[sp,#0]
;;;859    	data[1]=LPC_RTC->MONTH;
000d1a  f8980038          LDRB     r0,[r8,#0x38]
000d1e  f88d0001          STRB     r0,[sp,#1]
;;;860    	data[2]=LPC_RTC->DOM;
000d22  f898002c          LDRB     r0,[r8,#0x2c]
000d26  f88d0002          STRB     r0,[sp,#2]
;;;861    	data[3]=0;
000d2a  f88d9003          STRB     r9,[sp,#3]
;;;862    	lc640_write_long_ptr(lc640_adr+16,data);
000d2e  4669              MOV      r1,sp
000d30  f10a0010          ADD      r0,r10,#0x10
000d34  f7fffffe          BL       lc640_write_long_ptr
;;;863    
;;;864    	data[0]=LPC_RTC->HOUR;
000d38  f8980028          LDRB     r0,[r8,#0x28]
000d3c  f88d0000          STRB     r0,[sp,#0]
;;;865    	data[1]=LPC_RTC->MIN;
000d40  f8980024          LDRB     r0,[r8,#0x24]
000d44  f88d0001          STRB     r0,[sp,#1]
;;;866    	data[2]=LPC_RTC->SEC;
000d48  f8980020          LDRB     r0,[r8,#0x20]
000d4c  f88d0002          STRB     r0,[sp,#2]
;;;867    	data[3]=0;
000d50  f88d9003          STRB     r9,[sp,#3]
;;;868    	lc640_write_long_ptr(lc640_adr+20,data);
000d54  4669              MOV      r1,sp
000d56  f10a0014          ADD      r0,r10,#0x14
000d5a  f7fffffe          BL       lc640_write_long_ptr
;;;869    	
;;;870    	data[0]='B';
000d5e  f04f0442          MOV      r4,#0x42
000d62  f88d4000          STRB     r4,[sp,#0]
;;;871    	data[1]='B';
000d66  f88d4001          STRB     r4,[sp,#1]
;;;872    	data[2]='B';
000d6a  f88d4002          STRB     r4,[sp,#2]
;;;873    	data[3]='B';
000d6e  f88d4003          STRB     r4,[sp,#3]
;;;874    	lc640_write_long_ptr(lc640_adr+24,data);
000d72  4669              MOV      r1,sp
000d74  f10a0018          ADD      r0,r10,#0x18
000d78  f7fffffe          BL       lc640_write_long_ptr
;;;875    	
;;;876    	data[0]='B';
000d7c  f88d4000          STRB     r4,[sp,#0]
;;;877    	data[1]='B';
000d80  f88d4001          STRB     r4,[sp,#1]
;;;878    	data[2]='B';
000d84  f88d4002          STRB     r4,[sp,#2]
;;;879    	data[3]='B';
000d88  f88d4003          STRB     r4,[sp,#3]
;;;880    	lc640_write_long_ptr(lc640_adr+28,data);
000d8c  4669              MOV      r1,sp
000d8e  f10a001c          ADD      r0,r10,#0x1c
000d92  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3478|
;;;881    	
;;;882    	}
;;;883    	
;;;884    avar_src_hndl_end:
;;;885    __nop();		
000d96  bf00              NOP      
                  |L1.3480|
;;;886    }
000d98  e485              B        |L1.1702|
;;;887    
                          ENDP

                  wrk_mem_hndl PROC
;;;888    //-----------------------------------------------
;;;889    void wrk_mem_hndl(char b)
000d9a  e92d41fc          PUSH     {r2-r8,lr}
;;;890    {
000d9e  4606              MOV      r6,r0
;;;891    char data[4];
;;;892    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;893    
;;;894    signed short temp_temp;
;;;895    
;;;896    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000da0  eb060046          ADD      r0,r6,r6,LSL #1
000da4  eb001106          ADD      r1,r0,r6,LSL #4
000da8  4868              LDR      r0,|L1.3916|
000daa  eb000481          ADD      r4,r0,r1,LSL #2
000dae  8be0              LDRH     r0,[r4,#0x1e]
000db0  2805              CMP      r0,#5
000db2  d318              BCC      |L1.3558|
;;;897    
;;;898    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000db4  4866              LDR      r0,|L1.3920|
000db6  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000db8  f1000006          ADD      r0,r0,#6
000dbc  f0000007          AND      r0,r0,#7
000dc0  eb040040          ADD      r0,r4,r0,LSL #1
000dc4  8c00              LDRH     r0,[r0,#0x20]
000dc6  9000              STR      r0,[sp,#0]
;;;899    
;;;900    
;;;901    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000dc8  f44f6760          MOV      r7,#0xe00
000dcc  4638              MOV      r0,r7
000dce  f7fffffe          BL       lc640_read_int
;;;902    event_ptr++;	
000dd2  f1000001          ADD      r0,r0,#1
000dd6  b285              UXTH     r5,r0
;;;903    if(event_ptr>63)event_ptr=0;	
000dd8  2d3f              CMP      r5,#0x3f
000dda  d901              BLS      |L1.3552|
000ddc  f04f0500          MOV      r5,#0
                  |L1.3552|
;;;904    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000de0  b229              SXTH     r1,r5
000de2  4638              MOV      r0,r7
000de4  e0b6              B        |L1.3924|
                  |L1.3558|
000de6  e11d              B        |L1.4132|
                  |L1.3560|
                          DCD      0x40024000
                  |L1.3564|
                          DCD      bps
                  |L1.3568|
000df0  42505320          DCB      "BPS #1 Alarm, overheat",0
000df4  23312041
000df8  6c61726d
000dfc  2c206f76
000e00  65726865
000e04  617400  
000e07  00                DCB      0
                  |L1.3592|
000e08  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000e0c  23312041
000e10  6c61726d
000e14  2c20766f
000e18  6c746167
000e1c  65206973
000e20  20757000
                  |L1.3620|
000e24  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000e28  23312041
000e2c  6c61726d
000e30  2c20766f
000e34  6c746167
000e38  65206973
000e3c  20646f77
000e40  6e00    
000e42  00                DCB      0
000e43  00                DCB      0
                  |L1.3652|
000e44  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000e48  23312041
000e4c  6c61726d
000e50  2c20636f
000e54  6e6e6563
000e58  74206973
000e5c  206c6f73
000e60  7400    
000e62  00                DCB      0
000e63  00                DCB      0
                  |L1.3684|
000e64  42505320          DCB      "BPS #2 Alarm, overheat",0
000e68  23322041
000e6c  6c61726d
000e70  2c206f76
000e74  65726865
000e78  617400  
000e7b  00                DCB      0
                  |L1.3708|
000e7c  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000e80  23322041
000e84  6c61726d
000e88  2c20766f
000e8c  6c746167
000e90  65206973
000e94  20757000
                  |L1.3736|
000e98  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000e9c  23322041
000ea0  6c61726d
000ea4  2c20766f
000ea8  6c746167
000eac  65206973
000eb0  20646f77
000eb4  6e00    
000eb6  00                DCB      0
000eb7  00                DCB      0
                  |L1.3768|
000eb8  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000ebc  23322041
000ec0  6c61726d
000ec4  2c20636f
000ec8  6e6e6563
000ecc  74206973
000ed0  206c6f73
000ed4  7400    
000ed6  00                DCB      0
000ed7  00                DCB      0
                  |L1.3800|
000ed8  42505320          DCB      "BPS #3 Alarm, overheat",0
000edc  23332041
000ee0  6c61726d
000ee4  2c206f76
000ee8  65726865
000eec  617400  
000eef  00                DCB      0
                  |L1.3824|
000ef0  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000ef4  23332041
000ef8  6c61726d
000efc  2c20766f
000f00  6c746167
000f04  65206973
000f08  20757000
                  |L1.3852|
000f0c  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000f10  23332041
000f14  6c61726d
000f18  2c20766f
000f1c  6c746167
000f20  65206973
000f24  20646f77
000f28  6e00    
000f2a  00                DCB      0
000f2b  00                DCB      0
                  |L1.3884|
000f2c  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000f30  23332041
000f34  6c61726d
000f38  2c20636f
000f3c  6e6e6563
000f40  74206973
000f44  206c6f73
000f48  7400    
000f4a  00                DCB      0
000f4b  00                DCB      0
                  |L1.3916|
                          DCD      bat
                  |L1.3920|
                          DCD      bat_u_old_cnt
                  |L1.3924|
000f54  f7fffffe          BL       lc640_write_int
;;;905    	
;;;906    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000f58  f6406802          MOV      r8,#0xe02
000f5c  4640              MOV      r0,r8
000f5e  f7fffffe          BL       lc640_read_int
000f62  b280              UXTH     r0,r0
;;;907    if(event_cnt!=63)event_cnt=event_ptr;
000f64  283f              CMP      r0,#0x3f
000f66  d000              BEQ      |L1.3946|
000f68  4628              MOV      r0,r5
                  |L1.3946|
;;;908    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000f6a  b201              SXTH     r1,r0
000f6c  4640              MOV      r0,r8
000f6e  f7fffffe          BL       lc640_write_int
;;;909    	
;;;910    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000f72  4638              MOV      r0,r7
000f74  f7fffffe          BL       lc640_read_int
000f78  f44f6180          MOV      r1,#0x400
000f7c  eb011040          ADD      r0,r1,r0,LSL #5
000f80  b285              UXTH     r5,r0
;;;911    	
;;;912    data[0]='B';
000f82  f04f0042          MOV      r0,#0x42
000f86  f88d0004          STRB     r0,[sp,#4]
;;;913    data[1]=b; 
000f8a  f88d6005          STRB     r6,[sp,#5]
;;;914    data[2]='W';
000f8e  f04f0057          MOV      r0,#0x57
000f92  f88d0006          STRB     r0,[sp,#6]
;;;915    data[3]=0;
000f96  f04f0600          MOV      r6,#0
000f9a  f88d6007          STRB     r6,[sp,#7]
;;;916    
;;;917    lc640_write_long_ptr(lc640_adr,data);
000f9e  a901              ADD      r1,sp,#4
000fa0  4628              MOV      r0,r5
000fa2  f7fffffe          BL       lc640_write_long_ptr
;;;918    
;;;919    data[0]=*((char*)&bat[b]._Iintegr_);
000fa6  7fa0              LDRB     r0,[r4,#0x1e]
000fa8  f88d0004          STRB     r0,[sp,#4]
;;;920    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000fac  7fe0              LDRB     r0,[r4,#0x1f]
000fae  f88d0005          STRB     r0,[sp,#5]
;;;921    data[2]=*((char*)&temp_temp);
000fb2  f89d0000          LDRB     r0,[sp,#0]
000fb6  f88d0006          STRB     r0,[sp,#6]
;;;922    data[3]=*(((char*)(&temp_temp))+1);
000fba  f89d0001          LDRB     r0,[sp,#1]
000fbe  f88d0007          STRB     r0,[sp,#7]
;;;923    lc640_write_long_ptr(lc640_adr+4,data);
000fc2  a901              ADD      r1,sp,#4
000fc4  1d28              ADDS     r0,r5,#4
000fc6  f7fffffe          BL       lc640_write_long_ptr
;;;924    
;;;925    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000fca  f1040134          ADD      r1,r4,#0x34
000fce  f1050008          ADD      r0,r5,#8
000fd2  f7fffffe          BL       lc640_write_long_ptr
;;;926    	
;;;927    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000fd6  f1040138          ADD      r1,r4,#0x38
000fda  f105000c          ADD      r0,r5,#0xc
000fde  f7fffffe          BL       lc640_write_long_ptr
;;;928    
;;;929    data[0]=LPC_RTC->YEAR;
000fe2  4cff              LDR      r4,|L1.5088|
000fe4  8ba0              LDRH     r0,[r4,#0x1c]
000fe6  f88d0004          STRB     r0,[sp,#4]
;;;930    data[1]=LPC_RTC->MONTH;
000fea  7e20              LDRB     r0,[r4,#0x18]
000fec  f88d0005          STRB     r0,[sp,#5]
;;;931    data[2]=LPC_RTC->DOM;
000ff0  7b20              LDRB     r0,[r4,#0xc]
000ff2  f88d0006          STRB     r0,[sp,#6]
;;;932    data[3]=0;
000ff6  f88d6007          STRB     r6,[sp,#7]
;;;933    lc640_write_long_ptr(lc640_adr+16,data);
000ffa  a901              ADD      r1,sp,#4
000ffc  f1050010          ADD      r0,r5,#0x10
001000  f7fffffe          BL       lc640_write_long_ptr
;;;934    
;;;935    data[0]=LPC_RTC->HOUR;
001004  7a20              LDRB     r0,[r4,#8]
001006  f88d0004          STRB     r0,[sp,#4]
;;;936    data[1]=LPC_RTC->MIN;
00100a  7920              LDRB     r0,[r4,#4]
00100c  f88d0005          STRB     r0,[sp,#5]
;;;937    data[2]=LPC_RTC->SEC;
001010  7820              LDRB     r0,[r4,#0]
001012  f88d0006          STRB     r0,[sp,#6]
;;;938    data[3]=0;
001016  f88d6007          STRB     r6,[sp,#7]
;;;939    lc640_write_long_ptr(lc640_adr+20,data);
00101a  a901              ADD      r1,sp,#4
00101c  f1050014          ADD      r0,r5,#0x14
001020  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4132|
;;;940    	
;;;941    
;;;942    
;;;943    	
;;;944    wrk_mem_hndl_end:	
;;;945    __nop();
001024  bf00              NOP      
;;;946    }  
001026  e8bd81fc          POP      {r2-r8,pc}
;;;947    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;949    //-----------------------------------------------
;;;950    void avar_bat_ips_hndl(char in)
00102a  e92d4ff8          PUSH     {r3-r11,lr}
;;;951    {
00102e  4602              MOV      r2,r0
;;;952    char data[4];
;;;953    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;954    
;;;955    if(in==1)
;;;956    	{
;;;957    	bat_ips._av|=1;
001030  48ec              LDR      r0,|L1.5092|
;;;958        ips_bat_av_stat=1;
001032  4ced              LDR      r4,|L1.5096|
;;;959    	ips_bat_av_vzvod=1;
001034  4bed              LDR      r3,|L1.5100|
;;;960    
;;;961    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;962    	event_ptr++;	
;;;963    	if(event_ptr>63)event_ptr=0;	
;;;964    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;965    	
;;;966    	event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;967    	if(event_cnt!=63)event_cnt=event_ptr;
;;;968    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;969    	
;;;970    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;971    	
;;;972    	data[0]='B';
;;;973    	data[1]=0;
;;;974    	data[2]='C';
;;;975    	data[3]=0;
;;;976    	lc640_write_long_ptr(lc640_adr,data);
;;;977    
;;;978    	data[0]=0;
;;;979    	data[1]=0;
;;;980    	data[2]=0;
;;;981    	data[3]=0;
;;;982    	lc640_write_long_ptr(lc640_adr+4,data);
;;;983    
;;;984    	data[0]=LPC_RTC->YEAR;
001036  f8df83b8          LDR      r8,|L1.5104|
00103a  f890103d          LDRB     r1,[r0,#0x3d]         ;957
00103e  f04f0742          MOV      r7,#0x42              ;972
001042  f44f6560          MOV      r5,#0xe00             ;961
001046  f04f0900          MOV      r9,#0                 ;963
00104a  f44f6a80          MOV      r10,#0x400            ;970
00104e  2a01              CMP      r2,#1                 ;955
001050  d002              BEQ      |L1.4184|
;;;985    	data[1]=LPC_RTC->MONTH;
;;;986    	data[2]=LPC_RTC->DOM;
;;;987    	data[3]=0;
;;;988    	lc640_write_long_ptr(lc640_adr+8,data);
;;;989    
;;;990    	data[0]=LPC_RTC->HOUR;
;;;991    	data[1]=LPC_RTC->MIN;
;;;992    	data[2]=LPC_RTC->SEC;
;;;993    	data[3]=0;
;;;994    	lc640_write_long_ptr(lc640_adr+12,data);
;;;995    	
;;;996    	data[0]='A';
;;;997    	data[1]='A';
;;;998    	data[2]='A';
;;;999    	data[3]='A';
;;;1000   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1001   	
;;;1002   	data[0]='A';
;;;1003   	data[1]='A';
;;;1004   	data[2]='A';
;;;1005   	data[3]='A';
;;;1006   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1007   	
;;;1008   	data[0]='A';
;;;1009   	data[1]='A';
;;;1010   	data[2]='A';
;;;1011   	data[3]='A';
;;;1012   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1013   	
;;;1014   	data[0]='A';
;;;1015   	data[1]='A';
;;;1016   	data[2]='A';
;;;1017   	data[3]='A';
;;;1018   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1019   					
;;;1020   	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;1021   		
;;;1022   	}
;;;1023   
;;;1024   else if(in==0)
001052  2a00              CMP      r2,#0
001054  d07e              BEQ      |L1.4436|
001056  e12f              B        |L1.4792|
                  |L1.4184|
001058  f0410101          ORR      r1,r1,#1              ;957
00105c  f880103d          STRB     r1,[r0,#0x3d]         ;957
001060  f04f0001          MOV      r0,#1                 ;958
001064  7020              STRB     r0,[r4,#0]            ;958
001066  7018              STRB     r0,[r3,#0]            ;959
001068  4628              MOV      r0,r5                 ;961
00106a  f7fffffe          BL       lc640_read_int
00106e  f1000001          ADD      r0,r0,#1              ;962
001072  b284              UXTH     r4,r0                 ;962
001074  2c3f              CMP      r4,#0x3f              ;963
001076  d901              BLS      |L1.4220|
001078  f04f0400          MOV      r4,#0                 ;963
                  |L1.4220|
00107c  b221              SXTH     r1,r4                 ;964
00107e  4628              MOV      r0,r5                 ;964
001080  f7fffffe          BL       lc640_write_int
001084  f6406602          MOV      r6,#0xe02             ;966
001088  4630              MOV      r0,r6                 ;966
00108a  f7fffffe          BL       lc640_read_int
00108e  b281              UXTH     r1,r0                 ;966
001090  293f              CMP      r1,#0x3f              ;967
001092  d000              BEQ      |L1.4246|
001094  4621              MOV      r1,r4                 ;967
                  |L1.4246|
001096  b209              SXTH     r1,r1                 ;968
001098  4630              MOV      r0,r6                 ;968
00109a  f7fffffe          BL       lc640_write_int
00109e  4628              MOV      r0,r5                 ;970
0010a0  f7fffffe          BL       lc640_read_int
0010a4  eb0a1040          ADD      r0,r10,r0,LSL #5      ;970
0010a8  b284              UXTH     r4,r0                 ;970
0010aa  f88d7000          STRB     r7,[sp,#0]            ;972
0010ae  f88d9001          STRB     r9,[sp,#1]            ;973
0010b2  f04f0043          MOV      r0,#0x43              ;974
0010b6  f88d0002          STRB     r0,[sp,#2]            ;974
0010ba  f88d9003          STRB     r9,[sp,#3]            ;975
0010be  4669              MOV      r1,sp                 ;976
0010c0  4620              MOV      r0,r4                 ;976
0010c2  f7fffffe          BL       lc640_write_long_ptr
0010c6  f8cd9000          STR      r9,[sp,#0]            ;981
0010ca  4669              MOV      r1,sp                 ;982
0010cc  1d20              ADDS     r0,r4,#4              ;982
0010ce  f7fffffe          BL       lc640_write_long_ptr
0010d2  f8b8003c          LDRH     r0,[r8,#0x3c]         ;984
0010d6  f88d0000          STRB     r0,[sp,#0]            ;984
0010da  f8980038          LDRB     r0,[r8,#0x38]         ;985
0010de  f88d0001          STRB     r0,[sp,#1]            ;985
0010e2  f898002c          LDRB     r0,[r8,#0x2c]         ;986
0010e6  f88d0002          STRB     r0,[sp,#2]            ;986
0010ea  f88d9003          STRB     r9,[sp,#3]            ;987
0010ee  4669              MOV      r1,sp                 ;988
0010f0  f1040008          ADD      r0,r4,#8              ;988
0010f4  f7fffffe          BL       lc640_write_long_ptr
0010f8  f8980028          LDRB     r0,[r8,#0x28]         ;990
0010fc  f88d0000          STRB     r0,[sp,#0]            ;990
001100  f8980024          LDRB     r0,[r8,#0x24]         ;991
001104  f88d0001          STRB     r0,[sp,#1]            ;991
001108  f8980020          LDRB     r0,[r8,#0x20]         ;992
00110c  f88d0002          STRB     r0,[sp,#2]            ;992
001110  f88d9003          STRB     r9,[sp,#3]            ;993
001114  4669              MOV      r1,sp                 ;994
001116  f104000c          ADD      r0,r4,#0xc            ;994
00111a  f7fffffe          BL       lc640_write_long_ptr
00111e  f04f0541          MOV      r5,#0x41              ;996
001122  f88d5000          STRB     r5,[sp,#0]            ;996
001126  f88d5001          STRB     r5,[sp,#1]            ;997
00112a  f88d5002          STRB     r5,[sp,#2]            ;998
00112e  f88d5003          STRB     r5,[sp,#3]            ;999
001132  4669              MOV      r1,sp                 ;1000
001134  f1040010          ADD      r0,r4,#0x10           ;1000
001138  f7fffffe          BL       lc640_write_long_ptr
00113c  f88d5000          STRB     r5,[sp,#0]            ;1002
001140  f88d5001          STRB     r5,[sp,#1]            ;1003
001144  f88d5002          STRB     r5,[sp,#2]            ;1004
001148  f88d5003          STRB     r5,[sp,#3]            ;1005
00114c  4669              MOV      r1,sp                 ;1006
00114e  f1040014          ADD      r0,r4,#0x14           ;1006
001152  e000              B        |L1.4438|
                  |L1.4436|
001154  e022              B        |L1.4508|
                  |L1.4438|
001156  f7fffffe          BL       lc640_write_long_ptr
00115a  f88d5000          STRB     r5,[sp,#0]            ;1008
00115e  f88d5001          STRB     r5,[sp,#1]            ;1009
001162  f88d5002          STRB     r5,[sp,#2]            ;1010
001166  f88d5003          STRB     r5,[sp,#3]            ;1011
00116a  4669              MOV      r1,sp                 ;1012
00116c  f1040018          ADD      r0,r4,#0x18           ;1012
001170  f7fffffe          BL       lc640_write_long_ptr
001174  f88d5000          STRB     r5,[sp,#0]            ;1014
001178  f88d5001          STRB     r5,[sp,#1]            ;1015
00117c  f88d5002          STRB     r5,[sp,#2]            ;1016
001180  f88d5003          STRB     r5,[sp,#3]            ;1017
001184  4669              MOV      r1,sp                 ;1018
001186  f104001c          ADD      r0,r4,#0x1c           ;1018
00118a  f7fffffe          BL       lc640_write_long_ptr
00118e  2301              MOVS     r3,#1                 ;1020
001190  461a              MOV      r2,r3                 ;1020
001192  2105              MOVS     r1,#5                 ;1020
001194  a097              ADR      r0,|L1.5108|
001196  f7fffffe          BL       snmp_trap_send
00119a  e08d              B        |L1.4792|
                  |L1.4508|
;;;1025   	{
;;;1026   	bat_ips._av&=~1;
00119c  f0210101          BIC      r1,r1,#1
0011a0  f880103d          STRB     r1,[r0,#0x3d]
;;;1027   	ips_bat_av_stat=0;
0011a4  f8849000          STRB     r9,[r4,#0]
;;;1028   	ips_bat_av_vzvod=0;
0011a8  f8839000          STRB     r9,[r3,#0]
;;;1029        
;;;1030   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0011ac  4628              MOV      r0,r5
0011ae  f7fffffe          BL       lc640_read_int
0011b2  b286              UXTH     r6,r0
;;;1031   	event_ptr_find=event_ptr;
0011b4  4634              MOV      r4,r6
                  |L1.4534|
;;;1032   	
;;;1033   avar_bat_ips_hndl_lbl1: 
;;;1034   
;;;1035   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0011b6  eb0a1044          ADD      r0,r10,r4,LSL #5
0011ba  b285              UXTH     r5,r0
;;;1036   
;;;1037        lc640_read_long_ptr(lc640_adr,data);
0011bc  4669              MOV      r1,sp
0011be  4628              MOV      r0,r5
0011c0  f7fffffe          BL       lc640_read_long_ptr
;;;1038        
;;;1039        if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
0011c4  f89d0000          LDRB     r0,[sp,#0]
0011c8  2842              CMP      r0,#0x42
0011ca  d106              BNE      |L1.4570|
0011cc  f89d0001          LDRB     r0,[sp,#1]
0011d0  b918              CBNZ     r0,|L1.4570|
0011d2  f89d0002          LDRB     r0,[sp,#2]
0011d6  2843              CMP      r0,#0x43
0011d8  d009              BEQ      |L1.4590|
                  |L1.4570|
;;;1040        	{        
;;;1041        	if(event_ptr_find)event_ptr_find--;
0011da  b11c              CBZ      r4,|L1.4580|
0011dc  f1a40401          SUB      r4,r4,#1
0011e0  b2a4              UXTH     r4,r4
0011e2  e001              B        |L1.4584|
                  |L1.4580|
;;;1042        	else event_ptr_find=63;
0011e4  f04f043f          MOV      r4,#0x3f
                  |L1.4584|
;;;1043        	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
0011e8  42b4              CMP      r4,r6
0011ea  d1e4              BNE      |L1.4534|
0011ec  e064              B        |L1.4792|
                  |L1.4590|
;;;1044        	else goto avar_bat_ips_hndl_lbl1;
;;;1045        	}
;;;1046        else 
;;;1047        	{
;;;1048        	lc640_read_long_ptr(lc640_adr+16,data);
0011ee  4669              MOV      r1,sp
0011f0  f1050010          ADD      r0,r5,#0x10
0011f4  f7fffffe          BL       lc640_read_long_ptr
;;;1049        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0011f8  f89d0000          LDRB     r0,[sp,#0]
0011fc  2841              CMP      r0,#0x41
0011fe  d10b              BNE      |L1.4632|
001200  f89d0001          LDRB     r0,[sp,#1]
001204  2841              CMP      r0,#0x41
001206  d107              BNE      |L1.4632|
001208  f89d0002          LDRB     r0,[sp,#2]
00120c  2841              CMP      r0,#0x41
00120e  d103              BNE      |L1.4632|
001210  f89d0003          LDRB     r0,[sp,#3]
001214  2841              CMP      r0,#0x41
001216  d009              BEQ      |L1.4652|
                  |L1.4632|
;;;1050        		{        
;;;1051        		if(event_ptr_find)event_ptr_find--;
001218  b11c              CBZ      r4,|L1.4642|
00121a  f1a40401          SUB      r4,r4,#1
00121e  b2a4              UXTH     r4,r4
001220  e001              B        |L1.4646|
                  |L1.4642|
;;;1052            		else event_ptr_find=63;
001222  f04f043f          MOV      r4,#0x3f
                  |L1.4646|
;;;1053            	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001226  42b4              CMP      r4,r6
001228  d1c5              BNE      |L1.4534|
00122a  e045              B        |L1.4792|
                  |L1.4652|
;;;1054        		else goto avar_bat_ips_hndl_lbl1;
;;;1055        		}
;;;1056   
;;;1057        	}
;;;1058        		
;;;1059   	data[0]=LPC_RTC->YEAR;
00122c  f8b8003c          LDRH     r0,[r8,#0x3c]
001230  f88d0000          STRB     r0,[sp,#0]
;;;1060   	data[1]=LPC_RTC->MONTH;
001234  f8980038          LDRB     r0,[r8,#0x38]
001238  f88d0001          STRB     r0,[sp,#1]
;;;1061   	data[2]=LPC_RTC->DOM;
00123c  f898002c          LDRB     r0,[r8,#0x2c]
001240  f88d0002          STRB     r0,[sp,#2]
;;;1062   	data[3]=0;
001244  f88d9003          STRB     r9,[sp,#3]
;;;1063   	lc640_write_long_ptr(lc640_adr+16,data);
001248  4669              MOV      r1,sp
00124a  f1050010          ADD      r0,r5,#0x10
00124e  f7fffffe          BL       lc640_write_long_ptr
;;;1064   
;;;1065   	data[0]=LPC_RTC->HOUR;
001252  f8980028          LDRB     r0,[r8,#0x28]
001256  f88d0000          STRB     r0,[sp,#0]
;;;1066   	data[1]=LPC_RTC->MIN;
00125a  f8980024          LDRB     r0,[r8,#0x24]
00125e  f88d0001          STRB     r0,[sp,#1]
;;;1067   	data[2]=LPC_RTC->SEC;
001262  f8980020          LDRB     r0,[r8,#0x20]
001266  f88d0002          STRB     r0,[sp,#2]
;;;1068   	data[3]=0;
00126a  f88d9003          STRB     r9,[sp,#3]
;;;1069   	lc640_write_long_ptr(lc640_adr+20,data);
00126e  4669              MOV      r1,sp
001270  f1050014          ADD      r0,r5,#0x14
001274  f7fffffe          BL       lc640_write_long_ptr
;;;1070   	
;;;1071   	data[0]='B';
001278  f88d7000          STRB     r7,[sp,#0]
;;;1072   	data[1]='B';
00127c  f88d7001          STRB     r7,[sp,#1]
;;;1073   	data[2]='B';
001280  f88d7002          STRB     r7,[sp,#2]
;;;1074   	data[3]='B';
001284  f88d7003          STRB     r7,[sp,#3]
;;;1075   	lc640_write_long_ptr(lc640_adr+24,data);
001288  4669              MOV      r1,sp
00128a  f1050018          ADD      r0,r5,#0x18
00128e  f7fffffe          BL       lc640_write_long_ptr
;;;1076   	
;;;1077   	data[0]='B';
001292  f88d7000          STRB     r7,[sp,#0]
;;;1078   	data[1]='B';
001296  f88d7001          STRB     r7,[sp,#1]
;;;1079   	data[2]='B';
00129a  f88d7002          STRB     r7,[sp,#2]
;;;1080   	data[3]='B';
00129e  f88d7003          STRB     r7,[sp,#3]
;;;1081   	lc640_write_long_ptr(lc640_adr+28,data);
0012a2  4669              MOV      r1,sp
0012a4  f105001c          ADD      r0,r5,#0x1c
0012a8  f7fffffe          BL       lc640_write_long_ptr
;;;1082   	
;;;1083   	snmp_trap_send("BAT #1 detected",5,1,0);
0012ac  2300              MOVS     r3,#0
0012ae  2201              MOVS     r2,#1
0012b0  2105              MOVS     r1,#5
0012b2  a055              ADR      r0,|L1.5128|
0012b4  f7fffffe          BL       snmp_trap_send
                  |L1.4792|
;;;1084   	
;;;1085   	}
;;;1086   	
;;;1087   avar_bat_ips_hndl_end:
;;;1088   __nop();		
0012b8  bf00              NOP      
                  |L1.4794|
;;;1089   }
0012ba  e56d              B        |L1.3480|
;;;1090   
                          ENDP

                  avar_bat_hndl PROC
;;;1093   //-----------------------------------------------
;;;1094   void avar_bat_hndl(char b, char in)
0012bc  4770              BX       lr
;;;1095   {
;;;1096   char data[4];
;;;1097   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1098   #ifndef UKU_220_IPS_TERMOKOMPENSAT	 //o_10
;;;1099   if(in==1)
;;;1100   	{
;;;1101   	bat[b]._av|=1;
;;;1102       
;;;1103   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1104   	event_ptr++;	
;;;1105   	if(event_ptr>63)event_ptr=0;	
;;;1106   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1107   	
;;;1108        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1109   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1110   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1111   	
;;;1112   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1113   	
;;;1114   	data[0]='B';
;;;1115   	data[1]=b;
;;;1116   	data[2]='C';
;;;1117   	data[3]=0;
;;;1118   	lc640_write_long_ptr(lc640_adr,data);
;;;1119   
;;;1120   	data[0]=0;
;;;1121   	data[1]=0;
;;;1122   	data[2]=0;
;;;1123   	data[3]=0;
;;;1124   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1125   
;;;1126   	data[0]=LPC_RTC->YEAR;
;;;1127   	data[1]=LPC_RTC->MONTH;
;;;1128   	data[2]=LPC_RTC->DOM;
;;;1129   	data[3]=0;
;;;1130   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1131   
;;;1132   	data[0]=LPC_RTC->HOUR;
;;;1133   	data[1]=LPC_RTC->MIN;
;;;1134   	data[2]=LPC_RTC->SEC;
;;;1135   	data[3]=0;
;;;1136   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1137   	
;;;1138   	data[0]='A';
;;;1139   	data[1]='A';
;;;1140   	data[2]='A';
;;;1141   	data[3]='A';
;;;1142   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1143   	
;;;1144   	data[0]='A';
;;;1145   	data[1]='A';
;;;1146   	data[2]='A';
;;;1147   	data[3]='A';
;;;1148   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1149   	
;;;1150   	data[0]='A';
;;;1151   	data[1]='A';
;;;1152   	data[2]='A';
;;;1153   	data[3]='A';
;;;1154   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1155   	
;;;1156   	data[0]='A';
;;;1157   	data[1]='A';
;;;1158   	data[2]='A';
;;;1159   	data[3]='A';
;;;1160   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1161   					
;;;1162   	if(b==0)
;;;1163   		{
;;;1164   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1165   		}
;;;1166   	else if(b==1)
;;;1167   		{
;;;1168   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1169   		} 
;;;1170   			
;;;1171   	}
;;;1172   
;;;1173   else if(in==0)
;;;1174   	{
;;;1175   	bat[b]._av&=~1;
;;;1176   
;;;1177        event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1178   	event_ptr_find=event_ptr;
;;;1179   	
;;;1180   avar_bat_hndl_lbl1: 
;;;1181   
;;;1182   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1183   
;;;1184        lc640_read_long_ptr(lc640_adr,data);
;;;1185        
;;;1186        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
;;;1187        	{        
;;;1188        	if(event_ptr_find)event_ptr_find--;
;;;1189        	else event_ptr_find=63;
;;;1190        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
;;;1191        	else goto avar_bat_hndl_lbl1;
;;;1192        	}
;;;1193        else 
;;;1194        	{
;;;1195        	lc640_read_long_ptr(lc640_adr+16,data);
;;;1196        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1197        		{        
;;;1198        		if(event_ptr_find)event_ptr_find--;
;;;1199            		else event_ptr_find=63;
;;;1200            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
;;;1201        		else goto avar_bat_hndl_lbl1;
;;;1202        		}
;;;1203   
;;;1204        	}
;;;1205        		
;;;1206   	data[0]=LPC_RTC->YEAR;
;;;1207   	data[1]=LPC_RTC->MONTH;
;;;1208   	data[2]=LPC_RTC->DOM;
;;;1209   	data[3]=0;
;;;1210   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1211   
;;;1212   	data[0]=LPC_RTC->HOUR;
;;;1213   	data[1]=LPC_RTC->MIN;
;;;1214   	data[2]=LPC_RTC->SEC;
;;;1215   	data[3]=0;
;;;1216   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1217   	
;;;1218   	data[0]='B';
;;;1219   	data[1]='B';
;;;1220   	data[2]='B';
;;;1221   	data[3]='B';
;;;1222   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1223   	
;;;1224   	data[0]='B';
;;;1225   	data[1]='B';
;;;1226   	data[2]='B';
;;;1227   	data[3]='B';
;;;1228   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1229   	
;;;1230   	if(b==0)
;;;1231   		{
;;;1232   		snmp_trap_send("BAT #1 detected",5,1,0);
;;;1233   		}
;;;1234   	else if(b==1)
;;;1235   		{
;;;1236   		snmp_trap_send("BAT #2 detected",5,2,0);
;;;1237   		}
;;;1238   	
;;;1239   	}
;;;1240   	
;;;1241   avar_bat_hndl_end:
;;;1242   __nop();
;;;1243   #endif    //o_10		
;;;1244   }
;;;1245   
                          ENDP

                  avar_bat_temper_hndl PROC
;;;1246   //-----------------------------------------------
;;;1247   void avar_bat_temper_hndl(char b, char in)
0012be  e92d4ff8          PUSH     {r3-r11,lr}
;;;1248   {
0012c2  4605              MOV      r5,r0
0012c4  460e              MOV      r6,r1
;;;1249   char data[4];
;;;1250   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1251   
;;;1252   if((in==1)||(in==3))
;;;1253   	{
;;;1254   	//bat[b]._av|=1;
;;;1255       
;;;1256   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1257   	event_ptr++;	
;;;1258   	if(event_ptr>63)event_ptr=0;	
;;;1259   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1260   	
;;;1261        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1262   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1263   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1264   	
;;;1265   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1266   	
;;;1267   	data[0]='B';
;;;1268   	data[1]=b;
;;;1269   	data[2]='T';
;;;1270   	data[3]='1';
;;;1271   	if(in==3)data[3]='3';
;;;1272   	lc640_write_long_ptr(lc640_adr,data);
;;;1273   
;;;1274   	data[0]=0;
;;;1275   	data[1]=0;
;;;1276   	data[2]=0;
;;;1277   	data[3]=0;
;;;1278   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1279   
;;;1280   	data[0]=LPC_RTC->YEAR;
0012c6  f8dfa128          LDR      r10,|L1.5104|
0012ca  f44f6060          MOV      r0,#0xe00             ;1256
0012ce  f44f6780          MOV      r7,#0x400             ;1265
0012d2  2e01              CMP      r6,#1                 ;1252
0012d4  d010              BEQ      |L1.4856|
0012d6  2e03              CMP      r6,#3                 ;1252
0012d8  d00e              BEQ      |L1.4856|
;;;1281   	data[1]=LPC_RTC->MONTH;
;;;1282   	data[2]=LPC_RTC->DOM;
;;;1283   	data[3]=0;
;;;1284   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1285   
;;;1286   	data[0]=LPC_RTC->HOUR;
;;;1287   	data[1]=LPC_RTC->MIN;
;;;1288   	data[2]=LPC_RTC->SEC;
;;;1289   	data[3]=0;
;;;1290   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1291   	
;;;1292   	data[0]='A';
;;;1293   	data[1]='A';
;;;1294   	data[2]='A';
;;;1295   	data[3]='A';
;;;1296   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1297   	
;;;1298   	data[0]='A';
;;;1299   	data[1]='A';
;;;1300   	data[2]='A';
;;;1301   	data[3]='A';
;;;1302   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1303   	
;;;1304   	data[0]='A';
;;;1305   	data[1]='A';
;;;1306   	data[2]='A';
;;;1307   	data[3]='A';
;;;1308   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1309   	
;;;1310   	data[0]='A';
;;;1311   	data[1]='A';
;;;1312   	data[2]='A';
;;;1313   	data[3]='A';
;;;1314   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1315   	if(in==1)
;;;1316   		{				
;;;1317   		if(b==0)
;;;1318   			{
;;;1319   			snmp_trap_send("BAT #1 Alarm, is heated",10,1,1);
;;;1320   			}
;;;1321   		else if(b==1)
;;;1322   			{
;;;1323   			snmp_trap_send("BAT #2 Alarm, is heated",10,2,1);
;;;1324   			} 
;;;1325   		}
;;;1326   	if(in==3)
;;;1327   		{				
;;;1328   		if(b==0)
;;;1329   			{
;;;1330   			snmp_trap_send("BAT #1 Alarm, is overheated",11,1,1);
;;;1331   			}
;;;1332   		else if(b==1)
;;;1333   			{
;;;1334   			snmp_trap_send("BAT #2 Alarm, is overheated",11,2,1);
;;;1335   			} 
;;;1336   		}			
;;;1337   	}
;;;1338   
;;;1339   else if((in==0)||(in==2))
0012da  b10e              CBZ      r6,|L1.4832|
0012dc  2e02              CMP      r6,#2
0012de  d17d              BNE      |L1.5084|
                  |L1.4832|
;;;1340   	{
;;;1341   	char i;
;;;1342   
;;;1343   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0012e0  f7fffffe          BL       lc640_read_int
0012e4  fa1ff980          UXTH     r9,r0
;;;1344   	event_ptr_find=event_ptr;
0012e8  464c              MOV      r4,r9
;;;1345   
;;;1346   /*	for (i=0;i<63;i++)
;;;1347   		{
;;;1348   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1349   
;;;1350        	lc640_read_long_ptr(lc640_adr,data);
;;;1351        
;;;1352        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;1353        		{        
;;;1354        		if(event_ptr_find)event_ptr_find--;
;;;1355        		else event_ptr_find=63;
;;;1356        		if(event_ptr_find==event_ptr)
;;;1357   				{
;;;1358   				lc640_adr=0;
;;;1359   				break;
;;;1360   				}
;;;1361        		else continue;
;;;1362        		}
;;;1363        	else 
;;;1364        		{
;;;1365        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1366        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1367        			{        
;;;1368        			if(event_ptr_find)event_ptr_find--;
;;;1369            		else event_ptr_find=63;
;;;1370            		if(event_ptr_find==event_ptr)
;;;1371   					{
;;;1372   					lc640_adr=0;
;;;1373   					break;
;;;1374   					}
;;;1375        			else continue;
;;;1376        			}
;;;1377        		}	
;;;1378   		}*/
;;;1379   	
;;;1380   	for (i=0;i<63;i++)
0012ea  f04f0800          MOV      r8,#0
                  |L1.4846|
;;;1381   		{
;;;1382   		char temp='1';
0012ee  f04f0b31          MOV      r11,#0x31
;;;1383   		if(in==2)temp='3';
0012f2  2e02              CMP      r6,#2
0012f4  d073              BEQ      |L1.5086|
0012f6  e0e3              B        |L1.5312|
                  |L1.4856|
0012f8  4680              MOV      r8,r0                 ;1256
0012fa  f7fffffe          BL       lc640_read_int
0012fe  f1000001          ADD      r0,r0,#1              ;1257
001302  b284              UXTH     r4,r0                 ;1257
001304  2c3f              CMP      r4,#0x3f              ;1258
001306  d901              BLS      |L1.4876|
001308  f04f0400          MOV      r4,#0                 ;1258
                  |L1.4876|
00130c  b221              SXTH     r1,r4                 ;1259
00130e  4640              MOV      r0,r8                 ;1259
001310  f7fffffe          BL       lc640_write_int
001314  f6406902          MOV      r9,#0xe02             ;1261
001318  4648              MOV      r0,r9                 ;1261
00131a  f7fffffe          BL       lc640_read_int
00131e  b280              UXTH     r0,r0                 ;1261
001320  283f              CMP      r0,#0x3f              ;1262
001322  d000              BEQ      |L1.4902|
001324  4620              MOV      r0,r4                 ;1262
                  |L1.4902|
001326  b201              SXTH     r1,r0                 ;1263
001328  4648              MOV      r0,r9                 ;1263
00132a  f7fffffe          BL       lc640_write_int
00132e  4640              MOV      r0,r8                 ;1265
001330  f7fffffe          BL       lc640_read_int
001334  eb071040          ADD      r0,r7,r0,LSL #5       ;1265
001338  b284              UXTH     r4,r0                 ;1265
00133a  f04f0042          MOV      r0,#0x42              ;1267
00133e  f88d0000          STRB     r0,[sp,#0]            ;1267
001342  f88d5001          STRB     r5,[sp,#1]            ;1268
001346  f04f0054          MOV      r0,#0x54              ;1269
00134a  f88d0002          STRB     r0,[sp,#2]            ;1269
00134e  f04f0031          MOV      r0,#0x31              ;1270
001352  f88d0003          STRB     r0,[sp,#3]            ;1270
001356  2e03              CMP      r6,#3                 ;1271
001358  d103              BNE      |L1.4962|
00135a  f04f0033          MOV      r0,#0x33              ;1271
00135e  f88d0003          STRB     r0,[sp,#3]            ;1271
                  |L1.4962|
001362  4669              MOV      r1,sp                 ;1272
001364  4620              MOV      r0,r4                 ;1272
001366  f7fffffe          BL       lc640_write_long_ptr
00136a  f04f0700          MOV      r7,#0                 ;1274
00136e  9700              STR      r7,[sp,#0]            ;1277
001370  4669              MOV      r1,sp                 ;1278
001372  f1040004          ADD      r0,r4,#4              ;1278
001376  f7fffffe          BL       lc640_write_long_ptr
00137a  f8ba003c          LDRH     r0,[r10,#0x3c]        ;1280
00137e  f88d0000          STRB     r0,[sp,#0]            ;1280
001382  f89a0038          LDRB     r0,[r10,#0x38]        ;1281
001386  f88d0001          STRB     r0,[sp,#1]            ;1281
00138a  f89a002c          LDRB     r0,[r10,#0x2c]        ;1282
00138e  f88d0002          STRB     r0,[sp,#2]            ;1282
001392  f88d7003          STRB     r7,[sp,#3]            ;1283
001396  4669              MOV      r1,sp                 ;1284
001398  f1040008          ADD      r0,r4,#8              ;1284
00139c  f7fffffe          BL       lc640_write_long_ptr
0013a0  f89a0028          LDRB     r0,[r10,#0x28]        ;1286
0013a4  f88d0000          STRB     r0,[sp,#0]            ;1286
0013a8  f89a0024          LDRB     r0,[r10,#0x24]        ;1287
0013ac  f88d0001          STRB     r0,[sp,#1]            ;1287
0013b0  f89a0020          LDRB     r0,[r10,#0x20]        ;1288
0013b4  f88d0002          STRB     r0,[sp,#2]            ;1288
0013b8  f88d7003          STRB     r7,[sp,#3]            ;1289
0013bc  4669              MOV      r1,sp                 ;1290
0013be  f104000c          ADD      r0,r4,#0xc            ;1290
0013c2  f7fffffe          BL       lc640_write_long_ptr
0013c6  f04f0741          MOV      r7,#0x41              ;1292
0013ca  f88d7000          STRB     r7,[sp,#0]            ;1292
0013ce  f88d7001          STRB     r7,[sp,#1]            ;1293
0013d2  f88d7002          STRB     r7,[sp,#2]            ;1294
0013d6  f88d7003          STRB     r7,[sp,#3]            ;1295
0013da  e01d              B        |L1.5144|
                  |L1.5084|
0013dc  e066              B        |L1.5292|
                  |L1.5086|
0013de  e06d              B        |L1.5308|
                  |L1.5088|
                          DCD      0x40024020
                  |L1.5092|
                          DCD      bat_ips
                  |L1.5096|
                          DCD      ips_bat_av_stat
                  |L1.5100|
                          DCD      ips_bat_av_vzvod
                  |L1.5104|
                          DCD      0x40024000
                  |L1.5108|
0013f4  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
0013f8  b9312041
0013fc  6c61726d
001400  2c206c6f
001404  737400  
001407  00                DCB      0
                  |L1.5128|
001408  42415420          DCB      "BAT #1 detected",0
00140c  23312064
001410  65746563
001414  74656400
                  |L1.5144|
001418  4669              MOV      r1,sp                 ;1296
00141a  f1040010          ADD      r0,r4,#0x10           ;1296
00141e  f7fffffe          BL       lc640_write_long_ptr
001422  f88d7000          STRB     r7,[sp,#0]            ;1298
001426  f88d7001          STRB     r7,[sp,#1]            ;1299
00142a  f88d7002          STRB     r7,[sp,#2]            ;1300
00142e  f88d7003          STRB     r7,[sp,#3]            ;1301
001432  4669              MOV      r1,sp                 ;1302
001434  f1040014          ADD      r0,r4,#0x14           ;1302
001438  f7fffffe          BL       lc640_write_long_ptr
00143c  f88d7000          STRB     r7,[sp,#0]            ;1304
001440  f88d7001          STRB     r7,[sp,#1]            ;1305
001444  f88d7002          STRB     r7,[sp,#2]            ;1306
001448  f88d7003          STRB     r7,[sp,#3]            ;1307
00144c  4669              MOV      r1,sp                 ;1308
00144e  f1040018          ADD      r0,r4,#0x18           ;1308
001452  f7fffffe          BL       lc640_write_long_ptr
001456  f88d7000          STRB     r7,[sp,#0]            ;1310
00145a  f88d7001          STRB     r7,[sp,#1]            ;1311
00145e  f88d7002          STRB     r7,[sp,#2]            ;1312
001462  f88d7003          STRB     r7,[sp,#3]            ;1313
001466  4669              MOV      r1,sp                 ;1314
001468  f104001c          ADD      r0,r4,#0x1c           ;1314
00146c  f7fffffe          BL       lc640_write_long_ptr
001470  2e01              CMP      r6,#1                 ;1315
001472  d110              BNE      |L1.5270|
001474  b115              CBZ      r5,|L1.5244|
001476  2d01              CMP      r5,#1                 ;1321
001478  d007              BEQ      |L1.5258|
00147a  e00c              B        |L1.5270|
                  |L1.5244|
00147c  2301              MOVS     r3,#1                 ;1319
00147e  461a              MOV      r2,r3                 ;1319
001480  210a              MOVS     r1,#0xa               ;1319
001482  a0f9              ADR      r0,|L1.6248|
001484  f7fffffe          BL       snmp_trap_send
001488  e005              B        |L1.5270|
                  |L1.5258|
00148a  2301              MOVS     r3,#1                 ;1323
00148c  2202              MOVS     r2,#2                 ;1323
00148e  210a              MOVS     r1,#0xa               ;1323
001490  a0fb              ADR      r0,|L1.6272|
001492  f7fffffe          BL       snmp_trap_send
                  |L1.5270|
001496  2e03              CMP      r6,#3                 ;1326
001498  d108              BNE      |L1.5292|
00149a  b145              CBZ      r5,|L1.5294|
00149c  2d01              CMP      r5,#1                 ;1332
00149e  d105              BNE      |L1.5292|
0014a0  2301              MOVS     r3,#1                 ;1334
0014a2  2202              MOVS     r2,#2                 ;1334
0014a4  210b              MOVS     r1,#0xb               ;1334
0014a6  a0fc              ADR      r0,|L1.6296|
0014a8  f7fffffe          BL       snmp_trap_send
                  |L1.5292|
;;;1384   
;;;1385   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1386   
;;;1387        	lc640_read_long_ptr(lc640_adr,data);
;;;1388        
;;;1389        	if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='T')&&(data[3]==temp)))
;;;1390        		{        
;;;1391        		if(event_ptr_find)event_ptr_find--;
;;;1392        		else event_ptr_find=63;
;;;1393        		if(event_ptr_find==event_ptr)				{
;;;1394   				lc640_adr=0;
;;;1395   				break;
;;;1396   				}
;;;1397        		else continue;
;;;1398        		}
;;;1399   	     else 
;;;1400   	     	{
;;;1401   	     	lc640_read_long_ptr(lc640_adr+16,data);
;;;1402   	     	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1403   	     		{        
;;;1404   	     		if(event_ptr_find)event_ptr_find--;
;;;1405   	         	else event_ptr_find=63;
;;;1406   	         	if(event_ptr_find==event_ptr)				{
;;;1407   					lc640_adr=0;
;;;1408   					break;
;;;1409   					}
;;;1410   	     		else continue;
;;;1411   	     		}
;;;1412   	
;;;1413   	     	}
;;;1414   		}
;;;1415        		
;;;1416   	data[0]=LPC_RTC->YEAR;
;;;1417   	data[1]=LPC_RTC->MONTH;
;;;1418   	data[2]=LPC_RTC->DOM;
;;;1419   	data[3]=0;
;;;1420   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1421   
;;;1422   	data[0]=LPC_RTC->HOUR;
;;;1423   	data[1]=LPC_RTC->MIN;
;;;1424   	data[2]=LPC_RTC->SEC;
;;;1425   	data[3]=0;
;;;1426   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1427   	
;;;1428   	data[0]='B';
;;;1429   	data[1]='B';
;;;1430   	data[2]='B';
;;;1431   	data[3]='B';
;;;1432   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1433   	
;;;1434   	data[0]='B';
;;;1435   	data[1]='B';
;;;1436   	data[2]='B';
;;;1437   	data[3]='B';
;;;1438   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1439   	
;;;1440   	if(in==0)
;;;1441   		{				
;;;1442   		if(b==0)
;;;1443   			{
;;;1444   			snmp_trap_send("BAT #1 Alarm, heating eliminated",10,1,0);
;;;1445   			}
;;;1446   		else if(b==1)
;;;1447   			{
;;;1448   			snmp_trap_send("BAT #2 Alarm, heating eliminated",10,2,0);
;;;1449   			} 
;;;1450   		}
;;;1451   	if(in==2)
;;;1452   		{				
;;;1453   		if(b==0)
;;;1454   			{
;;;1455   			snmp_trap_send("BAT #1 Alarm, overheating eliminated",11,1,0);
;;;1456   			}
;;;1457   		else if(b==1)
;;;1458   			{
;;;1459   			snmp_trap_send("BAT #2 Alarm, overheating eliminated",11,2,0);
;;;1460   			} 
;;;1461   		}		
;;;1462   	
;;;1463   	}
;;;1464   	
;;;1465   }
0014ac  e474              B        |L1.3480|
                  |L1.5294|
0014ae  2301              MOVS     r3,#1                 ;1330
0014b0  461a              MOV      r2,r3                 ;1330
0014b2  210b              MOVS     r1,#0xb               ;1330
0014b4  a0ff              ADR      r0,|L1.6324|
0014b6  f7fffffe          BL       snmp_trap_send
0014ba  e46d              B        |L1.3480|
                  |L1.5308|
0014bc  f04f0b33          MOV      r11,#0x33             ;1383
                  |L1.5312|
0014c0  f44f6080          MOV      r0,#0x400             ;1385
0014c4  eb001044          ADD      r0,r0,r4,LSL #5       ;1385
0014c8  b287              UXTH     r7,r0                 ;1385
0014ca  4669              MOV      r1,sp                 ;1387
0014cc  4638              MOV      r0,r7                 ;1387
0014ce  f7fffffe          BL       lc640_read_long_ptr
0014d2  f89d0000          LDRB     r0,[sp,#0]            ;1389
0014d6  2842              CMP      r0,#0x42              ;1389
0014d8  d10b              BNE      |L1.5362|
0014da  f89d0001          LDRB     r0,[sp,#1]            ;1389
0014de  42a8              CMP      r0,r5                 ;1389
0014e0  d107              BNE      |L1.5362|
0014e2  f89d0002          LDRB     r0,[sp,#2]            ;1389
0014e6  2854              CMP      r0,#0x54              ;1389
0014e8  d103              BNE      |L1.5362|
0014ea  f89d0003          LDRB     r0,[sp,#3]            ;1389
0014ee  4558              CMP      r0,r11                ;1389
0014f0  d00b              BEQ      |L1.5386|
                  |L1.5362|
0014f2  b11c              CBZ      r4,|L1.5372|
0014f4  f1a40401          SUB      r4,r4,#1              ;1391
0014f8  b2a4              UXTH     r4,r4                 ;1391
0014fa  e001              B        |L1.5376|
                  |L1.5372|
0014fc  f04f043f          MOV      r4,#0x3f              ;1392
                  |L1.5376|
001500  454c              CMP      r4,r9                 ;1393
001502  d123              BNE      |L1.5452|
001504  f04f0700          MOV      r7,#0                 ;1394
001508  e028              B        |L1.5468|
                  |L1.5386|
00150a  4669              MOV      r1,sp                 ;1401
00150c  f1070010          ADD      r0,r7,#0x10           ;1401
001510  f7fffffe          BL       lc640_read_long_ptr
001514  f89d0000          LDRB     r0,[sp,#0]            ;1402
001518  2841              CMP      r0,#0x41              ;1402
00151a  d10b              BNE      |L1.5428|
00151c  f89d0001          LDRB     r0,[sp,#1]            ;1402
001520  2841              CMP      r0,#0x41              ;1402
001522  d107              BNE      |L1.5428|
001524  f89d0002          LDRB     r0,[sp,#2]            ;1402
001528  2841              CMP      r0,#0x41              ;1402
00152a  d103              BNE      |L1.5428|
00152c  f89d0003          LDRB     r0,[sp,#3]            ;1402
001530  2841              CMP      r0,#0x41              ;1402
001532  d00b              BEQ      |L1.5452|
                  |L1.5428|
001534  b11c              CBZ      r4,|L1.5438|
001536  f1a40401          SUB      r4,r4,#1              ;1404
00153a  b2a4              UXTH     r4,r4                 ;1404
00153c  e001              B        |L1.5442|
                  |L1.5438|
00153e  f04f043f          MOV      r4,#0x3f              ;1405
                  |L1.5442|
001542  454c              CMP      r4,r9                 ;1406
001544  d102              BNE      |L1.5452|
001546  f04f0700          MOV      r7,#0                 ;1407
00154a  e007              B        |L1.5468|
                  |L1.5452|
00154c  f1080801          ADD      r8,r8,#1              ;1380
001550  f00808ff          AND      r8,r8,#0xff           ;1380
001554  f1b80f3f          CMP      r8,#0x3f              ;1380
001558  f4ffaec9          BCC      |L1.4846|
                  |L1.5468|
00155c  f8ba003c          LDRH     r0,[r10,#0x3c]        ;1416
001560  f88d0000          STRB     r0,[sp,#0]            ;1416
001564  f89a0038          LDRB     r0,[r10,#0x38]        ;1417
001568  f88d0001          STRB     r0,[sp,#1]            ;1417
00156c  f89a002c          LDRB     r0,[r10,#0x2c]        ;1418
001570  f88d0002          STRB     r0,[sp,#2]            ;1418
001574  f04f0400          MOV      r4,#0                 ;1419
001578  f88d4003          STRB     r4,[sp,#3]            ;1419
00157c  4669              MOV      r1,sp                 ;1420
00157e  f1070010          ADD      r0,r7,#0x10           ;1420
001582  f7fffffe          BL       lc640_write_long_ptr
001586  f89a0028          LDRB     r0,[r10,#0x28]        ;1422
00158a  f88d0000          STRB     r0,[sp,#0]            ;1422
00158e  f89a0024          LDRB     r0,[r10,#0x24]        ;1423
001592  f88d0001          STRB     r0,[sp,#1]            ;1423
001596  f89a0020          LDRB     r0,[r10,#0x20]        ;1424
00159a  f88d0002          STRB     r0,[sp,#2]            ;1424
00159e  f88d4003          STRB     r4,[sp,#3]            ;1425
0015a2  4669              MOV      r1,sp                 ;1426
0015a4  f1070014          ADD      r0,r7,#0x14           ;1426
0015a8  f7fffffe          BL       lc640_write_long_ptr
0015ac  f04f0442          MOV      r4,#0x42              ;1428
0015b0  f88d4000          STRB     r4,[sp,#0]            ;1428
0015b4  f88d4001          STRB     r4,[sp,#1]            ;1429
0015b8  f88d4002          STRB     r4,[sp,#2]            ;1430
0015bc  f88d4003          STRB     r4,[sp,#3]            ;1431
0015c0  4669              MOV      r1,sp                 ;1432
0015c2  f1070018          ADD      r0,r7,#0x18           ;1432
0015c6  f7fffffe          BL       lc640_write_long_ptr
0015ca  f88d4000          STRB     r4,[sp,#0]            ;1434
0015ce  f88d4001          STRB     r4,[sp,#1]            ;1435
0015d2  f88d4002          STRB     r4,[sp,#2]            ;1436
0015d6  f88d4003          STRB     r4,[sp,#3]            ;1437
0015da  4669              MOV      r1,sp                 ;1438
0015dc  f107001c          ADD      r0,r7,#0x1c           ;1438
0015e0  f7fffffe          BL       lc640_write_long_ptr
0015e4  b986              CBNZ     r6,|L1.5640|
0015e6  b115              CBZ      r5,|L1.5614|
0015e8  2d01              CMP      r5,#1                 ;1446
0015ea  d007              BEQ      |L1.5628|
0015ec  e00c              B        |L1.5640|
                  |L1.5614|
0015ee  2300              MOVS     r3,#0                 ;1444
0015f0  2201              MOVS     r2,#1                 ;1444
0015f2  210a              MOVS     r1,#0xa               ;1444
0015f4  a0b6              ADR      r0,|L1.6352|
0015f6  f7fffffe          BL       snmp_trap_send
0015fa  e005              B        |L1.5640|
                  |L1.5628|
0015fc  2300              MOVS     r3,#0                 ;1448
0015fe  2202              MOVS     r2,#2                 ;1448
001600  210a              MOVS     r1,#0xa               ;1448
001602  a0bc              ADR      r0,|L1.6388|
001604  f7fffffe          BL       snmp_trap_send
                  |L1.5640|
001608  2e02              CMP      r6,#2                 ;1451
                  |L1.5642|
00160a  f47faf4f          BNE      |L1.5292|
00160e  b145              CBZ      r5,|L1.5666|
001610  2d01              CMP      r5,#1                 ;1457
001612  d1fa              BNE      |L1.5642|
001614  2300              MOVS     r3,#0                 ;1459
001616  2202              MOVS     r2,#2                 ;1459
001618  210b              MOVS     r1,#0xb               ;1459
00161a  a0bf              ADR      r0,|L1.6424|
00161c  f7fffffe          BL       snmp_trap_send
                  |L1.5664|
001620  e64b              B        |L1.4794|
                  |L1.5666|
001622  2300              MOVS     r3,#0                 ;1455
001624  2201              MOVS     r2,#1                 ;1455
001626  210b              MOVS     r1,#0xb               ;1455
001628  a0c5              ADR      r0,|L1.6464|
00162a  f7fffffe          BL       snmp_trap_send
00162e  e644              B        |L1.4794|
;;;1466   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1467   //-----------------------------------------------
;;;1468   void avar_bat_as_hndl(char b, char in)
001630  e92d4ff8          PUSH     {r3-r11,lr}
;;;1469   {
001634  4605              MOV      r5,r0
;;;1470   char data[4];
;;;1471   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1472   
;;;1473   if(in==1)
;;;1474   	{
;;;1475   	bat[b]._av|=2;
001636  48cc              LDR      r0,|L1.6504|
001638  eb050245          ADD      r2,r5,r5,LSL #1
;;;1476       
;;;1477   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1478   	event_ptr++;	
;;;1479   	if(event_ptr>63)event_ptr=0;	
;;;1480   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1481   	
;;;1482        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1483   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1484   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1485   	
;;;1486   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1487   	
;;;1488   	data[0]='B';
;;;1489   	data[1]=b;
;;;1490   	data[2]='S';
;;;1491   	data[3]=0;
;;;1492   	lc640_write_long_ptr(lc640_adr,data);
;;;1493   
;;;1494   	data[0]=0;
;;;1495   	data[1]=0;
;;;1496   	data[2]=0;
;;;1497   	data[3]=0;
;;;1498   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1499   
;;;1500   	data[0]=LPC_RTC->YEAR;
00163c  f8df832c          LDR      r8,|L1.6508|
001640  eb021205          ADD      r2,r2,r5,LSL #4       ;1475
001644  f04f0a00          MOV      r10,#0                ;1479
001648  f04f0942          MOV      r9,#0x42              ;1488
00164c  f44f6660          MOV      r6,#0xe00             ;1477
001650  f44f6b80          MOV      r11,#0x400            ;1486
001654  eb000082          ADD      r0,r0,r2,LSL #2       ;1475
001658  2901              CMP      r1,#1                 ;1473
00165a  d002              BEQ      |L1.5730|
;;;1501   	data[1]=LPC_RTC->MONTH;
;;;1502   	data[2]=LPC_RTC->DOM;
;;;1503   	data[3]=0;
;;;1504   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1505   
;;;1506   	data[0]=LPC_RTC->HOUR;
;;;1507   	data[1]=LPC_RTC->MIN;
;;;1508   	data[2]=LPC_RTC->SEC;
;;;1509   	data[3]=0;
;;;1510   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1511   	
;;;1512   	data[0]='A';
;;;1513   	data[1]='A';
;;;1514   	data[2]='A';
;;;1515   	data[3]='A';
;;;1516   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1517   	
;;;1518   	data[0]='A';
;;;1519   	data[1]='A';
;;;1520   	data[2]='A';
;;;1521   	data[3]='A';
;;;1522   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1523   	
;;;1524   	data[0]='A';
;;;1525   	data[1]='A';
;;;1526   	data[2]='A';
;;;1527   	data[3]='A';
;;;1528   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1529   	
;;;1530   	data[0]='A';
;;;1531   	data[1]='A';
;;;1532   	data[2]='A';
;;;1533   	data[3]='A';
;;;1534   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1535   
;;;1536   	if(b==0)
;;;1537   		{
;;;1538   		snmp_trap_send("BAT #1 Alarm, asymmetry",5,1,2);
;;;1539   		}
;;;1540   	else if(b==1)
;;;1541   		{
;;;1542   		snmp_trap_send("BAT #2 Alarm, asymmetry",5,2,2);
;;;1543   		} 
;;;1544   	
;;;1545   	}
;;;1546   
;;;1547   else if(in==0)
00165c  2900              CMP      r1,#0
00165e  d07d              BEQ      |L1.5980|
001660  e1de              B        |L1.6688|
                  |L1.5730|
001662  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1475
001666  f0410102          ORR      r1,r1,#2              ;1475
00166a  7001              STRB     r1,[r0,#0]            ;1475
00166c  4630              MOV      r0,r6                 ;1477
00166e  f7fffffe          BL       lc640_read_int
001672  f1000001          ADD      r0,r0,#1              ;1478
001676  b284              UXTH     r4,r0                 ;1478
001678  2c3f              CMP      r4,#0x3f              ;1479
00167a  d901              BLS      |L1.5760|
00167c  f04f0400          MOV      r4,#0                 ;1479
                  |L1.5760|
001680  b221              SXTH     r1,r4                 ;1480
001682  4630              MOV      r0,r6                 ;1480
001684  f7fffffe          BL       lc640_write_int
001688  f6406702          MOV      r7,#0xe02             ;1482
00168c  4638              MOV      r0,r7                 ;1482
00168e  f7fffffe          BL       lc640_read_int
001692  b280              UXTH     r0,r0                 ;1482
001694  283f              CMP      r0,#0x3f              ;1483
001696  d000              BEQ      |L1.5786|
001698  4620              MOV      r0,r4                 ;1483
                  |L1.5786|
00169a  b201              SXTH     r1,r0                 ;1484
00169c  4638              MOV      r0,r7                 ;1484
00169e  f7fffffe          BL       lc640_write_int
0016a2  4630              MOV      r0,r6                 ;1486
0016a4  f7fffffe          BL       lc640_read_int
0016a8  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1486
0016ac  b284              UXTH     r4,r0                 ;1486
0016ae  f88d9000          STRB     r9,[sp,#0]            ;1488
0016b2  f88d5001          STRB     r5,[sp,#1]            ;1489
0016b6  f04f0053          MOV      r0,#0x53              ;1490
0016ba  f88d0002          STRB     r0,[sp,#2]            ;1490
0016be  f88da003          STRB     r10,[sp,#3]           ;1491
0016c2  4669              MOV      r1,sp                 ;1492
0016c4  4620              MOV      r0,r4                 ;1492
0016c6  f7fffffe          BL       lc640_write_long_ptr
0016ca  f8cda000          STR      r10,[sp,#0]           ;1497
0016ce  4669              MOV      r1,sp                 ;1498
0016d0  1d20              ADDS     r0,r4,#4              ;1498
0016d2  f7fffffe          BL       lc640_write_long_ptr
0016d6  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1500
0016da  f88d0000          STRB     r0,[sp,#0]            ;1500
0016de  f8980038          LDRB     r0,[r8,#0x38]         ;1501
0016e2  f88d0001          STRB     r0,[sp,#1]            ;1501
0016e6  f898002c          LDRB     r0,[r8,#0x2c]         ;1502
0016ea  f88d0002          STRB     r0,[sp,#2]            ;1502
0016ee  f88da003          STRB     r10,[sp,#3]           ;1503
0016f2  4669              MOV      r1,sp                 ;1504
0016f4  f1040008          ADD      r0,r4,#8              ;1504
0016f8  f7fffffe          BL       lc640_write_long_ptr
0016fc  f8980028          LDRB     r0,[r8,#0x28]         ;1506
001700  f88d0000          STRB     r0,[sp,#0]            ;1506
001704  f8980024          LDRB     r0,[r8,#0x24]         ;1507
001708  f88d0001          STRB     r0,[sp,#1]            ;1507
00170c  f8980020          LDRB     r0,[r8,#0x20]         ;1508
001710  f88d0002          STRB     r0,[sp,#2]            ;1508
001714  f88da003          STRB     r10,[sp,#3]           ;1509
001718  4669              MOV      r1,sp                 ;1510
00171a  f104000c          ADD      r0,r4,#0xc            ;1510
00171e  f7fffffe          BL       lc640_write_long_ptr
001722  f04f0641          MOV      r6,#0x41              ;1512
001726  f88d6000          STRB     r6,[sp,#0]            ;1512
00172a  f88d6001          STRB     r6,[sp,#1]            ;1513
00172e  f88d6002          STRB     r6,[sp,#2]            ;1514
001732  f88d6003          STRB     r6,[sp,#3]            ;1515
001736  4669              MOV      r1,sp                 ;1516
001738  f1040010          ADD      r0,r4,#0x10           ;1516
00173c  f7fffffe          BL       lc640_write_long_ptr
001740  f88d6000          STRB     r6,[sp,#0]            ;1518
001744  f88d6001          STRB     r6,[sp,#1]            ;1519
001748  f88d6002          STRB     r6,[sp,#2]            ;1520
00174c  f88d6003          STRB     r6,[sp,#3]            ;1521
001750  4669              MOV      r1,sp                 ;1522
001752  f1040014          ADD      r0,r4,#0x14           ;1522
001756  f7fffffe          BL       lc640_write_long_ptr
00175a  e000              B        |L1.5982|
                  |L1.5980|
00175c  e02b              B        |L1.6070|
                  |L1.5982|
00175e  f88d6000          STRB     r6,[sp,#0]            ;1524
001762  f88d6001          STRB     r6,[sp,#1]            ;1525
001766  f88d6002          STRB     r6,[sp,#2]            ;1526
00176a  f88d6003          STRB     r6,[sp,#3]            ;1527
00176e  4669              MOV      r1,sp                 ;1528
001770  f1040018          ADD      r0,r4,#0x18           ;1528
001774  f7fffffe          BL       lc640_write_long_ptr
001778  f88d6000          STRB     r6,[sp,#0]            ;1530
00177c  f88d6001          STRB     r6,[sp,#1]            ;1531
001780  f88d6002          STRB     r6,[sp,#2]            ;1532
001784  f88d6003          STRB     r6,[sp,#3]            ;1533
001788  4669              MOV      r1,sp                 ;1534
00178a  f104001c          ADD      r0,r4,#0x1c           ;1534
00178e  f7fffffe          BL       lc640_write_long_ptr
001792  b115              CBZ      r5,|L1.6042|
001794  2d01              CMP      r5,#1                 ;1540
001796  d007              BEQ      |L1.6056|
001798  e142              B        |L1.6688|
                  |L1.6042|
00179a  2302              MOVS     r3,#2                 ;1538
00179c  2201              MOVS     r2,#1                 ;1538
00179e  2105              MOVS     r1,#5                 ;1538
0017a0  a073              ADR      r0,|L1.6512|
0017a2  f7fffffe          BL       snmp_trap_send
0017a6  e13b              B        |L1.6688|
                  |L1.6056|
0017a8  2302              MOVS     r3,#2                 ;1542
0017aa  461a              MOV      r2,r3                 ;1542
0017ac  2105              MOVS     r1,#5                 ;1542
0017ae  a076              ADR      r0,|L1.6536|
0017b0  f7fffffe          BL       snmp_trap_send
0017b4  e134              B        |L1.6688|
                  |L1.6070|
;;;1548   	{
;;;1549   	bat[b]._av&=~(1<<1);
0017b6  f8101f3d          LDRB     r1,[r0,#0x3d]!
0017ba  f0210102          BIC      r1,r1,#2
0017be  7001              STRB     r1,[r0,#0]
;;;1550   
;;;1551        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0017c0  4630              MOV      r0,r6
0017c2  f7fffffe          BL       lc640_read_int
0017c6  b287              UXTH     r7,r0
;;;1552   	event_ptr_find=event_ptr;
0017c8  463c              MOV      r4,r7
                  |L1.6090|
;;;1553   	
;;;1554   avar_bat_as_hndl_lbl1: 
;;;1555   
;;;1556   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0017ca  eb0b1044          ADD      r0,r11,r4,LSL #5
0017ce  b286              UXTH     r6,r0
;;;1557   
;;;1558        lc640_read_long_ptr(lc640_adr,data);
0017d0  4669              MOV      r1,sp
0017d2  4630              MOV      r0,r6
0017d4  f7fffffe          BL       lc640_read_long_ptr
;;;1559        
;;;1560        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
0017d8  f89d0000          LDRB     r0,[sp,#0]
0017dc  2842              CMP      r0,#0x42
0017de  d107              BNE      |L1.6128|
0017e0  f89d0001          LDRB     r0,[sp,#1]
0017e4  42a8              CMP      r0,r5
0017e6  d103              BNE      |L1.6128|
0017e8  f89d0002          LDRB     r0,[sp,#2]
0017ec  2843              CMP      r0,#0x43
0017ee  d009              BEQ      |L1.6148|
                  |L1.6128|
;;;1561        	{        
;;;1562        	if(event_ptr_find)event_ptr_find--;
0017f0  b11c              CBZ      r4,|L1.6138|
0017f2  f1a40401          SUB      r4,r4,#1
0017f6  b2a4              UXTH     r4,r4
0017f8  e001              B        |L1.6142|
                  |L1.6138|
;;;1563        	else event_ptr_find=63;
0017fa  f04f043f          MOV      r4,#0x3f
                  |L1.6142|
;;;1564        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
0017fe  42bc              CMP      r4,r7
001800  d1e3              BNE      |L1.6090|
001802  e10d              B        |L1.6688|
                  |L1.6148|
;;;1565        	else goto avar_bat_as_hndl_lbl1;
;;;1566        	}
;;;1567        else 
;;;1568        	{
;;;1569        	lc640_read_long_ptr(lc640_adr+16,data);
001804  4669              MOV      r1,sp
001806  f1060010          ADD      r0,r6,#0x10
00180a  f7fffffe          BL       lc640_read_long_ptr
;;;1570        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00180e  f89d0000          LDRB     r0,[sp,#0]
001812  2841              CMP      r0,#0x41
001814  d10b              BNE      |L1.6190|
001816  f89d0001          LDRB     r0,[sp,#1]
00181a  2841              CMP      r0,#0x41
00181c  d107              BNE      |L1.6190|
00181e  f89d0002          LDRB     r0,[sp,#2]
001822  2841              CMP      r0,#0x41
001824  d103              BNE      |L1.6190|
001826  f89d0003          LDRB     r0,[sp,#3]
00182a  2841              CMP      r0,#0x41
00182c  d009              BEQ      |L1.6210|
                  |L1.6190|
;;;1571        		{        
;;;1572        		if(event_ptr_find)event_ptr_find--;
00182e  b11c              CBZ      r4,|L1.6200|
001830  f1a40401          SUB      r4,r4,#1
001834  b2a4              UXTH     r4,r4
001836  e001              B        |L1.6204|
                  |L1.6200|
;;;1573            		else event_ptr_find=63;
001838  f04f043f          MOV      r4,#0x3f
                  |L1.6204|
;;;1574            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
00183c  42bc              CMP      r4,r7
00183e  d1c4              BNE      |L1.6090|
001840  e0ee              B        |L1.6688|
                  |L1.6210|
;;;1575        		else goto avar_bat_as_hndl_lbl1;
;;;1576        		}
;;;1577   
;;;1578        	}
;;;1579        		
;;;1580   	data[0]=LPC_RTC->YEAR;
001842  f8b8003c          LDRH     r0,[r8,#0x3c]
001846  f88d0000          STRB     r0,[sp,#0]
;;;1581   	data[1]=LPC_RTC->MONTH;
00184a  f8980038          LDRB     r0,[r8,#0x38]
00184e  f88d0001          STRB     r0,[sp,#1]
;;;1582   	data[2]=LPC_RTC->DOM;
001852  f898002c          LDRB     r0,[r8,#0x2c]
001856  f88d0002          STRB     r0,[sp,#2]
;;;1583   	data[3]=0;
00185a  f88da003          STRB     r10,[sp,#3]
;;;1584   	lc640_write_long_ptr(lc640_adr+16,data);
00185e  4669              MOV      r1,sp
001860  f1060010          ADD      r0,r6,#0x10
001864  e09c              B        |L1.6560|
001866  0000              DCW      0x0000
                  |L1.6248|
001868  42415420          DCB      "BAT #1 Alarm, is heated",0
00186c  23312041
001870  6c61726d
001874  2c206973
001878  20686561
00187c  74656400
                  |L1.6272|
001880  42415420          DCB      "BAT #2 Alarm, is heated",0
001884  23322041
001888  6c61726d
00188c  2c206973
001890  20686561
001894  74656400
                  |L1.6296|
001898  42415420          DCB      "BAT #2 Alarm, is overheated",0
00189c  23322041
0018a0  6c61726d
0018a4  2c206973
0018a8  206f7665
0018ac  72686561
0018b0  74656400
                  |L1.6324|
0018b4  42415420          DCB      "BAT #1 Alarm, is overheated",0
0018b8  23312041
0018bc  6c61726d
0018c0  2c206973
0018c4  206f7665
0018c8  72686561
0018cc  74656400
                  |L1.6352|
0018d0  42415420          DCB      "BAT #1 Alarm, heating eliminated",0
0018d4  23312041
0018d8  6c61726d
0018dc  2c206865
0018e0  6174696e
0018e4  6720656c
0018e8  696d696e
0018ec  61746564
0018f0  00      
0018f1  00                DCB      0
0018f2  00                DCB      0
0018f3  00                DCB      0
                  |L1.6388|
0018f4  42415420          DCB      "BAT #2 Alarm, heating eliminated",0
0018f8  23322041
0018fc  6c61726d
001900  2c206865
001904  6174696e
001908  6720656c
00190c  696d696e
001910  61746564
001914  00      
001915  00                DCB      0
001916  00                DCB      0
001917  00                DCB      0
                  |L1.6424|
001918  42415420          DCB      "BAT #2 Alarm, overheating eliminated",0
00191c  23322041
001920  6c61726d
001924  2c206f76
001928  65726865
00192c  6174696e
001930  6720656c
001934  696d696e
001938  61746564
00193c  00      
00193d  00                DCB      0
00193e  00                DCB      0
00193f  00                DCB      0
                  |L1.6464|
001940  42415420          DCB      "BAT #1 Alarm, overheating eliminated",0
001944  23312041
001948  6c61726d
00194c  2c206f76
001950  65726865
001954  6174696e
001958  6720656c
00195c  696d696e
001960  61746564
001964  00      
001965  00                DCB      0
001966  00                DCB      0
001967  00                DCB      0
                  |L1.6504|
                          DCD      bat
                  |L1.6508|
                          DCD      0x40024000
                  |L1.6512|
001970  42415420          DCB      "BAT #1 Alarm, asymmetry",0
001974  23312041
001978  6c61726d
00197c  2c206173
001980  796d6d65
001984  74727900
                  |L1.6536|
001988  42415420          DCB      "BAT #2 Alarm, asymmetry",0
00198c  23322041
001990  6c61726d
001994  2c206173
001998  796d6d65
00199c  74727900
                  |L1.6560|
0019a0  f7fffffe          BL       lc640_write_long_ptr
;;;1585   
;;;1586   	data[0]=LPC_RTC->HOUR;
0019a4  f8980028          LDRB     r0,[r8,#0x28]
0019a8  f88d0000          STRB     r0,[sp,#0]
;;;1587   	data[1]=LPC_RTC->MIN;
0019ac  f8980024          LDRB     r0,[r8,#0x24]
0019b0  f88d0001          STRB     r0,[sp,#1]
;;;1588   	data[2]=LPC_RTC->SEC;
0019b4  f8980020          LDRB     r0,[r8,#0x20]
0019b8  f88d0002          STRB     r0,[sp,#2]
;;;1589   	data[3]=0;
0019bc  f88da003          STRB     r10,[sp,#3]
;;;1590   	lc640_write_long_ptr(lc640_adr+20,data);
0019c0  4669              MOV      r1,sp
0019c2  f1060014          ADD      r0,r6,#0x14
0019c6  f7fffffe          BL       lc640_write_long_ptr
;;;1591   	
;;;1592   	data[0]='B';
0019ca  f88d9000          STRB     r9,[sp,#0]
;;;1593   	data[1]='B';
0019ce  f88d9001          STRB     r9,[sp,#1]
;;;1594   	data[2]='B';
0019d2  f88d9002          STRB     r9,[sp,#2]
;;;1595   	data[3]='B';
0019d6  f88d9003          STRB     r9,[sp,#3]
;;;1596   	lc640_write_long_ptr(lc640_adr+24,data);
0019da  4669              MOV      r1,sp
0019dc  f1060018          ADD      r0,r6,#0x18
0019e0  f7fffffe          BL       lc640_write_long_ptr
;;;1597   	
;;;1598   	data[0]='B';
0019e4  f88d9000          STRB     r9,[sp,#0]
;;;1599   	data[1]='B';
0019e8  f88d9001          STRB     r9,[sp,#1]
;;;1600   	data[2]='B';
0019ec  f88d9002          STRB     r9,[sp,#2]
;;;1601   	data[3]='B';
0019f0  f88d9003          STRB     r9,[sp,#3]
;;;1602   	lc640_write_long_ptr(lc640_adr+28,data);
0019f4  4669              MOV      r1,sp
0019f6  f106001c          ADD      r0,r6,#0x1c
0019fa  f7fffffe          BL       lc640_write_long_ptr
;;;1603   	
;;;1604   	if(b==0)
0019fe  b115              CBZ      r5,|L1.6662|
;;;1605   		{
;;;1606   		snmp_trap_send("BAT #1 Asymmetry alarm clear",5,1,0);
;;;1607   		}
;;;1608   	else if(b==1)
001a00  2d01              CMP      r5,#1
001a02  d007              BEQ      |L1.6676|
001a04  e00c              B        |L1.6688|
                  |L1.6662|
001a06  2300              MOVS     r3,#0                 ;1606
001a08  2201              MOVS     r2,#1                 ;1606
001a0a  2105              MOVS     r1,#5                 ;1606
001a0c  a0f8              ADR      r0,|L1.7664|
001a0e  f7fffffe          BL       snmp_trap_send
001a12  e005              B        |L1.6688|
                  |L1.6676|
;;;1609   		{
;;;1610   		snmp_trap_send("BAT #2 Asymmetry alarm clear",5,2,0);
001a14  2300              MOVS     r3,#0
001a16  2202              MOVS     r2,#2
001a18  2105              MOVS     r1,#5
001a1a  a0fd              ADR      r0,|L1.7696|
001a1c  f7fffffe          BL       snmp_trap_send
                  |L1.6688|
;;;1611   		}
;;;1612   	
;;;1613   	}
;;;1614   	
;;;1615   avar_bat_as_hndl_end:
;;;1616   __nop();		
001a20  bf00              NOP      
                  |L1.6690|
;;;1617   }
001a22  e44a              B        |L1.4794|
;;;1618   
                          ENDP

                  ke_zvu_mem_hndl PROC
;;;1619   //-----------------------------------------------
;;;1620   void ke_zvu_mem_hndl(char b,unsigned short in,unsigned short in1)
001a24  b5f7              PUSH     {r0-r2,r4-r7,lr}
;;;1621   {
001a26  b082              SUB      sp,sp,#8
001a28  4605              MOV      r5,r0
;;;1622   char data[4];
;;;1623   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1624   //unsigned char temp,temp_;
;;;1625   //unsigned int tempUI;
;;;1626   //unsigned long tempUL; 
;;;1627   signed temp_temp;
;;;1628   
;;;1629   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
001a2a  eb050045          ADD      r0,r5,r5,LSL #1
001a2e  eb001005          ADD      r0,r0,r5,LSL #4
001a32  49ff              LDR      r1,|L1.7728|
001a34  eb010180          ADD      r1,r1,r0,LSL #2
001a38  48fe              LDR      r0,|L1.7732|
001a3a  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
001a3e  f1000001          ADD      r0,r0,#1
001a42  eb010040          ADD      r0,r1,r0,LSL #1
001a46  f9b00020          LDRSH    r0,[r0,#0x20]
001a4a  9000              STR      r0,[sp,#0]
;;;1630   
;;;1631   event_ptr=lc640_read_int(PTR_EVENT_LOG);
001a4c  f44f6660          MOV      r6,#0xe00
001a50  4630              MOV      r0,r6
001a52  f7fffffe          BL       lc640_read_int
;;;1632   event_ptr++;	
001a56  f1000001          ADD      r0,r0,#1
001a5a  4604              MOV      r4,r0
;;;1633   if(event_ptr>63)event_ptr=0;	
001a5c  2c3f              CMP      r4,#0x3f
001a5e  d901              BLS      |L1.6756|
001a60  f04f0400          MOV      r4,#0
                  |L1.6756|
;;;1634   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
001a64  b221              SXTH     r1,r4
001a66  4630              MOV      r0,r6
001a68  f7fffffe          BL       lc640_write_int
;;;1635   	
;;;1636   event_cnt=lc640_read_int(CNT_EVENT_LOG);
001a6c  f6406702          MOV      r7,#0xe02
001a70  4638              MOV      r0,r7
001a72  f7fffffe          BL       lc640_read_int
;;;1637   if(event_cnt!=63)event_cnt=event_ptr;
001a76  283f              CMP      r0,#0x3f
001a78  d000              BEQ      |L1.6780|
001a7a  4620              MOV      r0,r4
                  |L1.6780|
;;;1638   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
001a7c  b201              SXTH     r1,r0
001a7e  4638              MOV      r0,r7
001a80  f7fffffe          BL       lc640_write_int
;;;1639   	
;;;1640   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
001a84  4630              MOV      r0,r6
001a86  f7fffffe          BL       lc640_read_int
001a8a  f44f6180          MOV      r1,#0x400
001a8e  eb011440          ADD      r4,r1,r0,LSL #5
;;;1641   	
;;;1642   data[0]='B';
001a92  f04f0042          MOV      r0,#0x42
001a96  f88d0004          STRB     r0,[sp,#4]
;;;1643   data[1]=b; 
001a9a  f88d5005          STRB     r5,[sp,#5]
;;;1644   data[2]='K';
001a9e  f04f004b          MOV      r0,#0x4b
001aa2  f88d0006          STRB     r0,[sp,#6]
;;;1645   data[3]='Z';
001aa6  f04f005a          MOV      r0,#0x5a
001aaa  f88d0007          STRB     r0,[sp,#7]
;;;1646   
;;;1647   lc640_write_long_ptr(lc640_adr,data);
001aae  a901              ADD      r1,sp,#4
001ab0  4620              MOV      r0,r4
001ab2  f7fffffe          BL       lc640_write_long_ptr
;;;1648   
;;;1649   data[0]=*((char*)&in);
001ab6  f89d000c          LDRB     r0,[sp,#0xc]
001aba  f88d0004          STRB     r0,[sp,#4]
;;;1650   data[1]=*(((char*)(&in))+1);
001abe  f89d000d          LDRB     r0,[sp,#0xd]
001ac2  f88d0005          STRB     r0,[sp,#5]
;;;1651   data[2]=*((char*)&temp_temp);
001ac6  f89d0000          LDRB     r0,[sp,#0]
001aca  f88d0006          STRB     r0,[sp,#6]
;;;1652   data[3]=*(((char*)(&temp_temp))+1);
001ace  f89d0001          LDRB     r0,[sp,#1]
001ad2  f88d0007          STRB     r0,[sp,#7]
;;;1653   lc640_write_long_ptr(lc640_adr+4,data);
001ad6  a901              ADD      r1,sp,#4
001ad8  1d20              ADDS     r0,r4,#4
001ada  f7fffffe          BL       lc640_write_long_ptr
;;;1654   
;;;1655   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
001ade  f24020a2          MOV      r0,#0x2a2
001ae2  f7fffffe          BL       lc640_read_long
001ae6  4dd4              LDR      r5,|L1.7736|
001ae8  6028              STR      r0,[r5,#0]  ; ke_date
;;;1656   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
001aea  4629              MOV      r1,r5
001aec  f1040008          ADD      r0,r4,#8
001af0  f7fffffe          BL       lc640_write_long_ptr
;;;1657   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
001af4  f24020a6          MOV      r0,#0x2a6
001af8  f7fffffe          BL       lc640_read_long
001afc  6068              STR      r0,[r5,#4]  ; ke_date
;;;1658   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
001afe  1d29              ADDS     r1,r5,#4
001b00  f104000c          ADD      r0,r4,#0xc
001b04  f7fffffe          BL       lc640_write_long_ptr
;;;1659   
;;;1660   data[0]=LPC_RTC->YEAR;
001b08  4dcc              LDR      r5,|L1.7740|
001b0a  8ba8              LDRH     r0,[r5,#0x1c]
001b0c  f88d0004          STRB     r0,[sp,#4]
;;;1661   data[1]=LPC_RTC->MONTH;
001b10  7e28              LDRB     r0,[r5,#0x18]
001b12  f88d0005          STRB     r0,[sp,#5]
;;;1662   data[2]=LPC_RTC->DOM;
001b16  7b28              LDRB     r0,[r5,#0xc]
001b18  f88d0006          STRB     r0,[sp,#6]
;;;1663   data[3]=*((char*)&in1);
001b1c  f89d0010          LDRB     r0,[sp,#0x10]
001b20  f88d0007          STRB     r0,[sp,#7]
;;;1664   lc640_write_long_ptr(lc640_adr+16,data);
001b24  a901              ADD      r1,sp,#4
001b26  f1040010          ADD      r0,r4,#0x10
001b2a  f7fffffe          BL       lc640_write_long_ptr
;;;1665   
;;;1666   data[0]=LPC_RTC->HOUR;
001b2e  7a28              LDRB     r0,[r5,#8]
001b30  f88d0004          STRB     r0,[sp,#4]
;;;1667   data[1]=LPC_RTC->MIN;
001b34  7928              LDRB     r0,[r5,#4]
001b36  f88d0005          STRB     r0,[sp,#5]
;;;1668   data[2]=LPC_RTC->SEC;
001b3a  7828              LDRB     r0,[r5,#0]
001b3c  f88d0006          STRB     r0,[sp,#6]
;;;1669   data[3]=*(((char*)(&in1))+1);
001b40  f89d0011          LDRB     r0,[sp,#0x11]
001b44  f88d0007          STRB     r0,[sp,#7]
;;;1670   lc640_write_long_ptr(lc640_adr+20,data);
001b48  a901              ADD      r1,sp,#4
001b4a  f1040014          ADD      r0,r4,#0x14
001b4e  f7fffffe          BL       lc640_write_long_ptr
;;;1671    
;;;1672   }
001b52  b005              ADD      sp,sp,#0x14
001b54  bdf0              POP      {r4-r7,pc}
;;;1673   
                          ENDP

                  vz_mem_hndl PROC
;;;1730   //-----------------------------------------------
;;;1731   void vz_mem_hndl(unsigned short in)
001b56  e92d4ff8          PUSH     {r3-r11,lr}
;;;1732   {
;;;1733   char data[4];
;;;1734   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001b5a  f04f0600          MOV      r6,#0
001b5e  4634              MOV      r4,r6
;;;1735   //char avar_simbol;
;;;1736   
;;;1737   if(in==1)
;;;1738   	{
;;;1739   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1740   	event_ptr++;	
;;;1741   	if(event_ptr>63)event_ptr=0;	
;;;1742   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1743   	
;;;1744        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1745   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1746   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1747   	
;;;1748   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1749   	
;;;1750   	data[0]='B';
;;;1751   	data[1]=0; 
;;;1752   	data[2]='Z';
;;;1753   	data[3]=0;
;;;1754   	lc640_write_long_ptr(lc640_adr,data);
;;;1755   
;;;1756   	data[0]=0;
;;;1757   	data[1]=0;
;;;1758   	data[2]=0;
;;;1759   	data[3]=0;
;;;1760   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1761   
;;;1762   	data[0]=LPC_RTC->YEAR;
001b60  f8df82dc          LDR      r8,|L1.7744|
001b64  46a1              MOV      r9,r4                 ;1734
001b66  f04f0742          MOV      r7,#0x42              ;1750
001b6a  f44f6a80          MOV      r10,#0x400            ;1748
001b6e  2801              CMP      r0,#1                 ;1737
001b70  d002              BEQ      |L1.7032|
;;;1763   	data[1]=LPC_RTC->MONTH;
;;;1764   	data[2]=LPC_RTC->DOM;
;;;1765   	data[3]=0;
;;;1766   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1767   
;;;1768   	data[0]=LPC_RTC->HOUR;
;;;1769   	data[1]=LPC_RTC->MIN;
;;;1770   	data[2]=LPC_RTC->SEC;
;;;1771   	data[3]=0;
;;;1772   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1773   	
;;;1774   	data[0]='A';
;;;1775   	data[1]='A';
;;;1776   	data[2]='A';
;;;1777   	data[3]='A';
;;;1778   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1779   	
;;;1780   	data[0]='A';
;;;1781   	data[1]='A';
;;;1782   	data[2]='A';
;;;1783   	data[3]='A';
;;;1784   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1785   	
;;;1786   	data[0]='A';
;;;1787   	data[1]='A';
;;;1788   	data[2]='A';
;;;1789   	data[3]='A';
;;;1790   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1791   	
;;;1792   	data[0]='A';
;;;1793   	data[1]='A';
;;;1794   	data[2]='A';
;;;1795   	data[3]='A';
;;;1796   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1797    	
;;;1798   	}
;;;1799   
;;;1800   else if(in==0)
001b72  2800              CMP      r0,#0
001b74  d07e              BEQ      |L1.7284|
001b76  e108              B        |L1.7562|
                  |L1.7032|
001b78  f44f6560          MOV      r5,#0xe00             ;1739
001b7c  4628              MOV      r0,r5                 ;1739
001b7e  f7fffffe          BL       lc640_read_int
001b82  f1000001          ADD      r0,r0,#1              ;1740
001b86  4604              MOV      r4,r0                 ;1740
001b88  2c3f              CMP      r4,#0x3f              ;1741
001b8a  d901              BLS      |L1.7056|
001b8c  f04f0400          MOV      r4,#0                 ;1741
                  |L1.7056|
001b90  b221              SXTH     r1,r4                 ;1742
001b92  4628              MOV      r0,r5                 ;1742
001b94  f7fffffe          BL       lc640_write_int
001b98  f6406602          MOV      r6,#0xe02             ;1744
001b9c  4630              MOV      r0,r6                 ;1744
001b9e  f7fffffe          BL       lc640_read_int
001ba2  283f              CMP      r0,#0x3f              ;1745
001ba4  d000              BEQ      |L1.7080|
001ba6  4620              MOV      r0,r4                 ;1745
                  |L1.7080|
001ba8  b201              SXTH     r1,r0                 ;1746
001baa  4630              MOV      r0,r6                 ;1746
001bac  f7fffffe          BL       lc640_write_int
001bb0  4628              MOV      r0,r5                 ;1748
001bb2  f7fffffe          BL       lc640_read_int
001bb6  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1748
001bba  f88d7000          STRB     r7,[sp,#0]            ;1750
001bbe  f88d9001          STRB     r9,[sp,#1]            ;1751
001bc2  f04f005a          MOV      r0,#0x5a              ;1752
001bc6  f88d0002          STRB     r0,[sp,#2]            ;1752
001bca  f88d9003          STRB     r9,[sp,#3]            ;1753
001bce  4669              MOV      r1,sp                 ;1754
001bd0  4620              MOV      r0,r4                 ;1754
001bd2  f7fffffe          BL       lc640_write_long_ptr
001bd6  f8cd9000          STR      r9,[sp,#0]            ;1759
001bda  4669              MOV      r1,sp                 ;1760
001bdc  1d20              ADDS     r0,r4,#4              ;1760
001bde  f7fffffe          BL       lc640_write_long_ptr
001be2  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1762
001be6  f88d0000          STRB     r0,[sp,#0]            ;1762
001bea  f8980038          LDRB     r0,[r8,#0x38]         ;1763
001bee  f88d0001          STRB     r0,[sp,#1]            ;1763
001bf2  f898002c          LDRB     r0,[r8,#0x2c]         ;1764
001bf6  f88d0002          STRB     r0,[sp,#2]            ;1764
001bfa  f88d9003          STRB     r9,[sp,#3]            ;1765
001bfe  4669              MOV      r1,sp                 ;1766
001c00  f1040008          ADD      r0,r4,#8              ;1766
001c04  f7fffffe          BL       lc640_write_long_ptr
001c08  f8980028          LDRB     r0,[r8,#0x28]         ;1768
001c0c  f88d0000          STRB     r0,[sp,#0]            ;1768
001c10  f8980024          LDRB     r0,[r8,#0x24]         ;1769
001c14  f88d0001          STRB     r0,[sp,#1]            ;1769
001c18  f8980020          LDRB     r0,[r8,#0x20]         ;1770
001c1c  f88d0002          STRB     r0,[sp,#2]            ;1770
001c20  f88d9003          STRB     r9,[sp,#3]            ;1771
001c24  4669              MOV      r1,sp                 ;1772
001c26  f104000c          ADD      r0,r4,#0xc            ;1772
001c2a  f7fffffe          BL       lc640_write_long_ptr
001c2e  f04f0541          MOV      r5,#0x41              ;1774
001c32  f88d5000          STRB     r5,[sp,#0]            ;1774
001c36  f88d5001          STRB     r5,[sp,#1]            ;1775
001c3a  f88d5002          STRB     r5,[sp,#2]            ;1776
001c3e  f88d5003          STRB     r5,[sp,#3]            ;1777
001c42  4669              MOV      r1,sp                 ;1778
001c44  f1040010          ADD      r0,r4,#0x10           ;1778
001c48  f7fffffe          BL       lc640_write_long_ptr
001c4c  f88d5000          STRB     r5,[sp,#0]            ;1780
001c50  f88d5001          STRB     r5,[sp,#1]            ;1781
001c54  f88d5002          STRB     r5,[sp,#2]            ;1782
001c58  f88d5003          STRB     r5,[sp,#3]            ;1783
001c5c  4669              MOV      r1,sp                 ;1784
001c5e  f1040014          ADD      r0,r4,#0x14           ;1784
001c62  f7fffffe          BL       lc640_write_long_ptr
001c66  f88d5000          STRB     r5,[sp,#0]            ;1786
001c6a  f88d5001          STRB     r5,[sp,#1]            ;1787
001c6e  f88d5002          STRB     r5,[sp,#2]            ;1788
001c72  e000              B        |L1.7286|
                  |L1.7284|
001c74  e014              B        |L1.7328|
                  |L1.7286|
001c76  f88d5003          STRB     r5,[sp,#3]            ;1789
001c7a  4669              MOV      r1,sp                 ;1790
001c7c  f1040018          ADD      r0,r4,#0x18           ;1790
001c80  f7fffffe          BL       lc640_write_long_ptr
001c84  f88d5000          STRB     r5,[sp,#0]            ;1792
001c88  f88d5001          STRB     r5,[sp,#1]            ;1793
001c8c  f88d5002          STRB     r5,[sp,#2]            ;1794
001c90  f88d5003          STRB     r5,[sp,#3]            ;1795
001c94  4669              MOV      r1,sp                 ;1796
001c96  f104001c          ADD      r0,r4,#0x1c           ;1796
001c9a  f7fffffe          BL       lc640_write_long_ptr
001c9e  e074              B        |L1.7562|
                  |L1.7328|
;;;1801   	{      
;;;1802        
;;;1803   vz_mem_hndl_lbl1: 
;;;1804   
;;;1805   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001ca0  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1806   
;;;1807        lc640_read_long_ptr(lc640_adr,data);
001ca4  4669              MOV      r1,sp
001ca6  4628              MOV      r0,r5
001ca8  f7fffffe          BL       lc640_read_long_ptr
;;;1808        
;;;1809        if(!((data[0]=='B')&&(data[2]=='Z')))
001cac  f89d0000          LDRB     r0,[sp,#0]
001cb0  2842              CMP      r0,#0x42
001cb2  d103              BNE      |L1.7356|
001cb4  f89d0002          LDRB     r0,[sp,#2]
001cb8  285a              CMP      r0,#0x5a
001cba  d008              BEQ      |L1.7374|
                  |L1.7356|
;;;1810        	{        
;;;1811        	if(event_ptr_find)event_ptr_find--;
001cbc  b114              CBZ      r4,|L1.7364|
001cbe  f1a40401          SUB      r4,r4,#1
001cc2  e001              B        |L1.7368|
                  |L1.7364|
;;;1812        	else event_ptr_find=63;
001cc4  f04f043f          MOV      r4,#0x3f
                  |L1.7368|
;;;1813        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001cc8  42b4              CMP      r4,r6
001cca  d1e9              BNE      |L1.7328|
001ccc  e05d              B        |L1.7562|
                  |L1.7374|
;;;1814        	else goto vz_mem_hndl_lbl1;
;;;1815        	}
;;;1816        else 
;;;1817        	{
;;;1818        	lc640_read_long_ptr(lc640_adr+16,data);
001cce  4669              MOV      r1,sp
001cd0  f1050010          ADD      r0,r5,#0x10
001cd4  f7fffffe          BL       lc640_read_long_ptr
;;;1819        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001cd8  f89d0000          LDRB     r0,[sp,#0]
001cdc  2841              CMP      r0,#0x41
001cde  d10b              BNE      |L1.7416|
001ce0  f89d0001          LDRB     r0,[sp,#1]
001ce4  2841              CMP      r0,#0x41
001ce6  d107              BNE      |L1.7416|
001ce8  f89d0002          LDRB     r0,[sp,#2]
001cec  2841              CMP      r0,#0x41
001cee  d103              BNE      |L1.7416|
001cf0  f89d0003          LDRB     r0,[sp,#3]
001cf4  2841              CMP      r0,#0x41
001cf6  d008              BEQ      |L1.7434|
                  |L1.7416|
;;;1820        		{        
;;;1821        		if(event_ptr_find)event_ptr_find--;
001cf8  b114              CBZ      r4,|L1.7424|
001cfa  f1a40401          SUB      r4,r4,#1
001cfe  e001              B        |L1.7428|
                  |L1.7424|
;;;1822            		else event_ptr_find=63;
001d00  f04f043f          MOV      r4,#0x3f
                  |L1.7428|
;;;1823            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001d04  42b4              CMP      r4,r6
001d06  d1cb              BNE      |L1.7328|
001d08  e03f              B        |L1.7562|
                  |L1.7434|
;;;1824        		else goto vz_mem_hndl_lbl1;
;;;1825        		}
;;;1826   
;;;1827        	}	
;;;1828   
;;;1829   
;;;1830   	
;;;1831   	data[0]=LPC_RTC->YEAR;
001d0a  f8b8003c          LDRH     r0,[r8,#0x3c]
001d0e  f88d0000          STRB     r0,[sp,#0]
;;;1832   	data[1]=LPC_RTC->MONTH;
001d12  f8980038          LDRB     r0,[r8,#0x38]
001d16  f88d0001          STRB     r0,[sp,#1]
;;;1833   	data[2]=LPC_RTC->DOM;
001d1a  f898002c          LDRB     r0,[r8,#0x2c]
001d1e  f88d0002          STRB     r0,[sp,#2]
;;;1834   	data[3]=0;
001d22  f88d9003          STRB     r9,[sp,#3]
;;;1835   	lc640_write_long_ptr(lc640_adr+16,data);
001d26  4669              MOV      r1,sp
001d28  f1050010          ADD      r0,r5,#0x10
001d2c  f7fffffe          BL       lc640_write_long_ptr
;;;1836   
;;;1837   	data[0]=LPC_RTC->HOUR;
001d30  f8980028          LDRB     r0,[r8,#0x28]
001d34  f88d0000          STRB     r0,[sp,#0]
;;;1838   	data[1]=LPC_RTC->MIN;
001d38  f8980024          LDRB     r0,[r8,#0x24]
001d3c  f88d0001          STRB     r0,[sp,#1]
;;;1839   	data[2]=LPC_RTC->SEC;
001d40  f8980020          LDRB     r0,[r8,#0x20]
001d44  f88d0002          STRB     r0,[sp,#2]
;;;1840   	data[3]=0;
001d48  f88d9003          STRB     r9,[sp,#3]
;;;1841   	lc640_write_long_ptr(lc640_adr+20,data);
001d4c  4669              MOV      r1,sp
001d4e  f1050014          ADD      r0,r5,#0x14
001d52  f7fffffe          BL       lc640_write_long_ptr
;;;1842   	
;;;1843   	data[0]='B';
001d56  f88d7000          STRB     r7,[sp,#0]
;;;1844   	data[1]='B';
001d5a  f88d7001          STRB     r7,[sp,#1]
;;;1845   	data[2]='B';
001d5e  f88d7002          STRB     r7,[sp,#2]
;;;1846   	data[3]='B';
001d62  f88d7003          STRB     r7,[sp,#3]
;;;1847   	lc640_write_long_ptr(lc640_adr+24,data);
001d66  4669              MOV      r1,sp
001d68  f1050018          ADD      r0,r5,#0x18
001d6c  f7fffffe          BL       lc640_write_long_ptr
;;;1848   	
;;;1849   	data[0]='B';
001d70  f88d7000          STRB     r7,[sp,#0]
;;;1850   	data[1]='B';
001d74  f88d7001          STRB     r7,[sp,#1]
;;;1851   	data[2]='B';
001d78  f88d7002          STRB     r7,[sp,#2]
;;;1852   	data[3]='B';
001d7c  f88d7003          STRB     r7,[sp,#3]
;;;1853   	lc640_write_long_ptr(lc640_adr+28,data);
001d80  4669              MOV      r1,sp
001d82  f105001c          ADD      r0,r5,#0x1c
001d86  f7fffffe          BL       lc640_write_long_ptr
                  |L1.7562|
;;;1854   	
;;;1855   	}
;;;1856   
;;;1857   vz_mem_hndl_end:
;;;1858   __nop(); 
001d8a  bf00              NOP      
                  |L1.7564|
;;;1859   
;;;1860   }
001d8c  e448              B        |L1.5664|
;;;1861   
                          ENDP

                  speedz_mem_hndl PROC
;;;1862   //-----------------------------------------------
;;;1863   void speedz_mem_hndl(unsigned short in)	 //    (1-, 5- , 0- , 10- )
001d8e  e92d4ff8          PUSH     {r3-r11,lr}
;;;1864   {
001d92  4605              MOV      r5,r0
;;;1865   char data[4];
;;;1866   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001d94  f04f0600          MOV      r6,#0
001d98  4634              MOV      r4,r6
;;;1867   //char avar_simbol;
;;;1868   
;;;1869   if((in==1)||(in==5)) //  
;;;1870   	{
;;;1871   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1872   	event_ptr++;	
;;;1873   	if(event_ptr>63)event_ptr=0;	
;;;1874   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1875   	
;;;1876       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1877   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1878   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1879   	
;;;1880   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1881   	
;;;1882   	data[0]='s';
;;;1883   	data[1]=0;
;;;1884   	if(in==5)data[1]='a'; 
;;;1885   	data[2]='Z';
;;;1886   	data[3]=0;
;;;1887   	lc640_write_long_ptr(lc640_adr,data);
;;;1888   
;;;1889   	data[0]=0;
;;;1890   	data[1]=0;
;;;1891   	data[2]=0;
;;;1892   	data[3]=0;
;;;1893   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1894   
;;;1895   	data[0]=LPC_RTC->YEAR;
001d9a  f8df80a4          LDR      r8,|L1.7744|
001d9e  46a1              MOV      r9,r4                 ;1866
001da0  f44f6a80          MOV      r10,#0x400            ;1880
001da4  2d01              CMP      r5,#1                 ;1869
001da6  d012              BEQ      |L1.7630|
001da8  2d05              CMP      r5,#5                 ;1869
001daa  d010              BEQ      |L1.7630|
;;;1896   	data[1]=LPC_RTC->MONTH;
;;;1897   	data[2]=LPC_RTC->DOM;
;;;1898   	data[3]=0;
;;;1899   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1900   
;;;1901   	data[0]=LPC_RTC->HOUR;
;;;1902   	data[1]=LPC_RTC->MIN;
;;;1903   	data[2]=LPC_RTC->SEC;
;;;1904   	data[3]=0;
;;;1905   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1906   	
;;;1907   	data[0]='A';
;;;1908   	data[1]='A';
;;;1909   	data[2]='A';
;;;1910   	data[3]='A';
;;;1911   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1912   	
;;;1913   	data[0]='A';
;;;1914   	data[1]='A';
;;;1915   	data[2]='A';
;;;1916   	data[3]='A';
;;;1917   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1918   	
;;;1919   	data[0]='A';
;;;1920   	data[1]='A';
;;;1921   	data[2]='A';
;;;1922   	data[3]='A';
;;;1923   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1924   	
;;;1925   	data[0]='A';
;;;1926   	data[1]='A';
;;;1927   	data[2]='A';
;;;1928   	data[3]='A';
;;;1929   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1930    	
;;;1931   	}
;;;1932   
;;;1933   else if(in==0)	// 
001dac  2d00              CMP      r5,#0
001dae  d07d              BEQ      |L1.7852|
;;;1934   	{      
;;;1935   	char i;     
;;;1936   	event_ptr_find=0;
;;;1937   	for (i=0;i<63;i++)
;;;1938   		{
;;;1939   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1940   
;;;1941        	lc640_read_long_ptr(lc640_adr,data);
;;;1942        
;;;1943        	if(!((data[0]=='s')&&(data[2]=='Z')))
;;;1944        		{        
;;;1945        		if(event_ptr_find)event_ptr_find--;
;;;1946        		else event_ptr_find=63;
;;;1947        		if(event_ptr_find==event_ptr)
;;;1948   				{
;;;1949   				lc640_adr=0;
;;;1950   				break;
;;;1951   				}
;;;1952        		else continue;
;;;1953        		}
;;;1954        	else 
;;;1955        		{
;;;1956        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1957        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1958        			{        
;;;1959        			if(event_ptr_find)event_ptr_find--;
;;;1960            		else event_ptr_find=63;
;;;1961            		if(event_ptr_find==event_ptr)
;;;1962   					{
;;;1963   					lc640_adr=0;
;;;1964   					break;
;;;1965   					}
;;;1966        			else continue;
;;;1967        			}
;;;1968        		}	
;;;1969   		}
;;;1970   	if(lc640_adr!=0)
;;;1971   		{
;;;1972   		data[0]=LPC_RTC->YEAR;
;;;1973   		data[1]=LPC_RTC->MONTH;
;;;1974   		data[2]=LPC_RTC->DOM;
;;;1975   		data[3]=0;
;;;1976   		lc640_write_long_ptr(lc640_adr+16,data);
;;;1977   	
;;;1978   		data[0]=LPC_RTC->HOUR;
;;;1979   		data[1]=LPC_RTC->MIN;
;;;1980   		data[2]=LPC_RTC->SEC;
;;;1981   		data[3]=0;
;;;1982   		lc640_write_long_ptr(lc640_adr+20,data);
;;;1983   		
;;;1984   		data[0]='C';
;;;1985   		data[1]='C';
;;;1986   		data[2]='C';
;;;1987   		data[3]='C';
;;;1988   		lc640_write_long_ptr(lc640_adr+24,data);
;;;1989   		
;;;1990   		data[0]='C';
;;;1991   		data[1]='C';
;;;1992   		data[2]='C';
;;;1993   		data[3]='C';
;;;1994   		lc640_write_long_ptr(lc640_adr+28,data);
;;;1995   		}
;;;1996   	}
;;;1997   else if(in==10) 	//  
001db0  2d0a              CMP      r5,#0xa
001db2  d17c              BNE      |L1.7854|
;;;1998   	{      
;;;1999   	char i;     
;;;2000   
;;;2001   	event_ptr_find=0;
;;;2002   	for (i=0;i<63;i++)
001db4  f04f0700          MOV      r7,#0
                  |L1.7608|
;;;2003   		{
;;;2004   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
001db8  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2005   
;;;2006        	lc640_read_long_ptr(lc640_adr,data);
001dbc  4669              MOV      r1,sp
001dbe  4628              MOV      r0,r5
001dc0  f7fffffe          BL       lc640_read_long_ptr
;;;2007        
;;;2008        	if(!((data[0]=='s')&&(data[2]=='Z')))
001dc4  f89d0000          LDRB     r0,[sp,#0]
001dc8  2873              CMP      r0,#0x73
001dca  d171              BNE      |L1.7856|
001dcc  e14d              B        |L1.8298|
                  |L1.7630|
001dce  f44f6660          MOV      r6,#0xe00             ;1871
001dd2  4630              MOV      r0,r6                 ;1871
001dd4  f7fffffe          BL       lc640_read_int
001dd8  f1000001          ADD      r0,r0,#1              ;1872
001ddc  4604              MOV      r4,r0                 ;1872
001dde  2c3f              CMP      r4,#0x3f              ;1873
001de0  d901              BLS      |L1.7654|
001de2  f04f0400          MOV      r4,#0                 ;1873
                  |L1.7654|
001de6  b221              SXTH     r1,r4                 ;1874
001de8  4630              MOV      r0,r6                 ;1874
001dea  f7fffffe          BL       lc640_write_int
001dee  e029              B        |L1.7748|
                  |L1.7664|
001df0  42415420          DCB      "BAT #1 Asymmetry alarm clear",0
001df4  23312041
001df8  73796d6d
001dfc  65747279
001e00  20616c61
001e04  726d2063
001e08  6c656172
001e0c  00      
001e0d  00                DCB      0
001e0e  00                DCB      0
001e0f  00                DCB      0
                  |L1.7696|
001e10  42415420          DCB      "BAT #2 Asymmetry alarm clear",0
001e14  23322041
001e18  73796d6d
001e1c  65747279
001e20  20616c61
001e24  726d2063
001e28  6c656172
001e2c  00      
001e2d  00                DCB      0
001e2e  00                DCB      0
001e2f  00                DCB      0
                  |L1.7728|
                          DCD      bat
                  |L1.7732|
                          DCD      bat_u_old_cnt
                  |L1.7736|
                          DCD      ke_date
                  |L1.7740|
                          DCD      0x40024020
                  |L1.7744|
                          DCD      0x40024000
                  |L1.7748|
001e44  f6406702          MOV      r7,#0xe02             ;1876
001e48  4638              MOV      r0,r7                 ;1876
001e4a  f7fffffe          BL       lc640_read_int
001e4e  283f              CMP      r0,#0x3f              ;1877
001e50  d000              BEQ      |L1.7764|
001e52  4620              MOV      r0,r4                 ;1877
                  |L1.7764|
001e54  b201              SXTH     r1,r0                 ;1878
001e56  4638              MOV      r0,r7                 ;1878
001e58  f7fffffe          BL       lc640_write_int
001e5c  4630              MOV      r0,r6                 ;1880
001e5e  f7fffffe          BL       lc640_read_int
001e62  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1880
001e66  f04f0073          MOV      r0,#0x73              ;1882
001e6a  f88d0000          STRB     r0,[sp,#0]            ;1882
001e6e  f88d9001          STRB     r9,[sp,#1]            ;1883
001e72  2d05              CMP      r5,#5                 ;1884
001e74  d103              BNE      |L1.7806|
001e76  f04f0061          MOV      r0,#0x61              ;1884
001e7a  f88d0001          STRB     r0,[sp,#1]            ;1884
                  |L1.7806|
001e7e  f04f005a          MOV      r0,#0x5a              ;1885
001e82  f88d0002          STRB     r0,[sp,#2]            ;1885
001e86  f88d9003          STRB     r9,[sp,#3]            ;1886
001e8a  4669              MOV      r1,sp                 ;1887
001e8c  4620              MOV      r0,r4                 ;1887
001e8e  f7fffffe          BL       lc640_write_long_ptr
001e92  f8cd9000          STR      r9,[sp,#0]            ;1892
001e96  4669              MOV      r1,sp                 ;1893
001e98  1d20              ADDS     r0,r4,#4              ;1893
001e9a  f7fffffe          BL       lc640_write_long_ptr
001e9e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1895
001ea2  f88d0000          STRB     r0,[sp,#0]            ;1895
001ea6  f8980038          LDRB     r0,[r8,#0x38]         ;1896
001eaa  e002              B        |L1.7858|
                  |L1.7852|
001eac  e058              B        |L1.8032|
                  |L1.7854|
001eae  e056              B        |L1.8030|
                  |L1.7856|
001eb0  e0df              B        |L1.8306|
                  |L1.7858|
001eb2  f88d0001          STRB     r0,[sp,#1]            ;1896
001eb6  f898002c          LDRB     r0,[r8,#0x2c]         ;1897
001eba  f88d0002          STRB     r0,[sp,#2]            ;1897
001ebe  f88d9003          STRB     r9,[sp,#3]            ;1898
001ec2  4669              MOV      r1,sp                 ;1899
001ec4  f1040008          ADD      r0,r4,#8              ;1899
001ec8  f7fffffe          BL       lc640_write_long_ptr
001ecc  f8980028          LDRB     r0,[r8,#0x28]         ;1901
001ed0  f88d0000          STRB     r0,[sp,#0]            ;1901
001ed4  f8980024          LDRB     r0,[r8,#0x24]         ;1902
001ed8  f88d0001          STRB     r0,[sp,#1]            ;1902
001edc  f8980020          LDRB     r0,[r8,#0x20]         ;1903
001ee0  f88d0002          STRB     r0,[sp,#2]            ;1903
001ee4  f88d9003          STRB     r9,[sp,#3]            ;1904
001ee8  4669              MOV      r1,sp                 ;1905
001eea  f104000c          ADD      r0,r4,#0xc            ;1905
001eee  f7fffffe          BL       lc640_write_long_ptr
001ef2  f04f0541          MOV      r5,#0x41              ;1907
001ef6  f88d5000          STRB     r5,[sp,#0]            ;1907
001efa  f88d5001          STRB     r5,[sp,#1]            ;1908
001efe  f88d5002          STRB     r5,[sp,#2]            ;1909
001f02  f88d5003          STRB     r5,[sp,#3]            ;1910
001f06  4669              MOV      r1,sp                 ;1911
001f08  f1040010          ADD      r0,r4,#0x10           ;1911
001f0c  f7fffffe          BL       lc640_write_long_ptr
001f10  f88d5000          STRB     r5,[sp,#0]            ;1913
001f14  f88d5001          STRB     r5,[sp,#1]            ;1914
001f18  f88d5002          STRB     r5,[sp,#2]            ;1915
001f1c  f88d5003          STRB     r5,[sp,#3]            ;1916
001f20  4669              MOV      r1,sp                 ;1917
001f22  f1040014          ADD      r0,r4,#0x14           ;1917
001f26  f7fffffe          BL       lc640_write_long_ptr
001f2a  f88d5000          STRB     r5,[sp,#0]            ;1919
001f2e  f88d5001          STRB     r5,[sp,#1]            ;1920
001f32  f88d5002          STRB     r5,[sp,#2]            ;1921
001f36  f88d5003          STRB     r5,[sp,#3]            ;1922
001f3a  4669              MOV      r1,sp                 ;1923
001f3c  f1040018          ADD      r0,r4,#0x18           ;1923
001f40  f7fffffe          BL       lc640_write_long_ptr
001f44  f88d5000          STRB     r5,[sp,#0]            ;1925
001f48  f88d5001          STRB     r5,[sp,#1]            ;1926
001f4c  f88d5002          STRB     r5,[sp,#2]            ;1927
001f50  f88d5003          STRB     r5,[sp,#3]            ;1928
001f54  4669              MOV      r1,sp                 ;1929
001f56  f104001c          ADD      r0,r4,#0x1c           ;1929
001f5a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8030|
;;;2009        		{        
;;;2010        		if(event_ptr_find)event_ptr_find--;
;;;2011        		else event_ptr_find=63;
;;;2012        		if(event_ptr_find==event_ptr)
;;;2013   				{
;;;2014   				lc640_adr=0;
;;;2015   				break;
;;;2016   				}
;;;2017        		else continue;
;;;2018        		}
;;;2019        	else 
;;;2020        		{
;;;2021        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2022        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2023        			{        
;;;2024        			if(event_ptr_find)event_ptr_find--;
;;;2025            		else event_ptr_find=63;
;;;2026            		if(event_ptr_find==event_ptr)
;;;2027   					{
;;;2028   					lc640_adr=0;
;;;2029   					break;
;;;2030   					}
;;;2031        			else continue;
;;;2032        			}
;;;2033        		}	
;;;2034   		}
;;;2035   	if(lc640_adr!=0)
;;;2036   		{
;;;2037   		data[0]=LPC_RTC->YEAR;
;;;2038   		data[1]=LPC_RTC->MONTH;
;;;2039   		data[2]=LPC_RTC->DOM;
;;;2040   		data[3]=0;
;;;2041   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2042   	
;;;2043   		data[0]=LPC_RTC->HOUR;
;;;2044   		data[1]=LPC_RTC->MIN;
;;;2045   		data[2]=LPC_RTC->SEC;
;;;2046   		data[3]=0;
;;;2047   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2048   		
;;;2049   		data[0]='B';
;;;2050   		data[1]='B';
;;;2051   		data[2]='B';
;;;2052   		data[3]='B';
;;;2053   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2054   		
;;;2055   		data[0]='B';
;;;2056   		data[1]='B';
;;;2057   		data[2]='B';
;;;2058   		data[3]='B';
;;;2059   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2060   		}
;;;2061   	}
;;;2062   }
001f5e  e560              B        |L1.6690|
                  |L1.8032|
001f60  f04f0700          MOV      r7,#0                 ;1937
                  |L1.8036|
001f64  eb0a1544          ADD      r5,r10,r4,LSL #5      ;1939
001f68  4669              MOV      r1,sp                 ;1941
001f6a  4628              MOV      r0,r5                 ;1941
001f6c  f7fffffe          BL       lc640_read_long_ptr
001f70  f89d0000          LDRB     r0,[sp,#0]            ;1943
001f74  2873              CMP      r0,#0x73              ;1943
001f76  d103              BNE      |L1.8064|
001f78  f89d0002          LDRB     r0,[sp,#2]            ;1943
001f7c  285a              CMP      r0,#0x5a              ;1943
001f7e  d00a              BEQ      |L1.8086|
                  |L1.8064|
001f80  b114              CBZ      r4,|L1.8072|
001f82  f1a40401          SUB      r4,r4,#1              ;1945
001f86  e001              B        |L1.8076|
                  |L1.8072|
001f88  f04f043f          MOV      r4,#0x3f              ;1946
                  |L1.8076|
001f8c  42b4              CMP      r4,r6                 ;1947
001f8e  d122              BNE      |L1.8150|
001f90  f04f0500          MOV      r5,#0                 ;1949
001f94  e024              B        |L1.8160|
                  |L1.8086|
001f96  4669              MOV      r1,sp                 ;1956
001f98  f1050010          ADD      r0,r5,#0x10           ;1956
001f9c  f7fffffe          BL       lc640_read_long_ptr
001fa0  f89d0000          LDRB     r0,[sp,#0]            ;1957
001fa4  2841              CMP      r0,#0x41              ;1957
001fa6  d10b              BNE      |L1.8128|
001fa8  f89d0001          LDRB     r0,[sp,#1]            ;1957
001fac  2841              CMP      r0,#0x41              ;1957
001fae  d107              BNE      |L1.8128|
001fb0  f89d0002          LDRB     r0,[sp,#2]            ;1957
001fb4  2841              CMP      r0,#0x41              ;1957
001fb6  d103              BNE      |L1.8128|
001fb8  f89d0003          LDRB     r0,[sp,#3]            ;1957
001fbc  2841              CMP      r0,#0x41              ;1957
001fbe  d00a              BEQ      |L1.8150|
                  |L1.8128|
001fc0  b114              CBZ      r4,|L1.8136|
001fc2  f1a40401          SUB      r4,r4,#1              ;1959
001fc6  e001              B        |L1.8140|
                  |L1.8136|
001fc8  f04f043f          MOV      r4,#0x3f              ;1960
                  |L1.8140|
001fcc  42b4              CMP      r4,r6                 ;1961
001fce  d102              BNE      |L1.8150|
001fd0  f04f0500          MOV      r5,#0                 ;1963
001fd4  e004              B        |L1.8160|
                  |L1.8150|
001fd6  f1070701          ADD      r7,r7,#1              ;1937
001fda  b2ff              UXTB     r7,r7                 ;1937
001fdc  2f3f              CMP      r7,#0x3f              ;1937
001fde  d3c1              BCC      |L1.8036|
                  |L1.8160|
001fe0  2d00              CMP      r5,#0                 ;1970
001fe2  d0bc              BEQ      |L1.8030|
001fe4  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1972
001fe8  f88d0000          STRB     r0,[sp,#0]            ;1972
001fec  f8980038          LDRB     r0,[r8,#0x38]         ;1973
001ff0  f88d0001          STRB     r0,[sp,#1]            ;1973
001ff4  f898002c          LDRB     r0,[r8,#0x2c]         ;1974
001ff8  f88d0002          STRB     r0,[sp,#2]            ;1974
001ffc  f88d9003          STRB     r9,[sp,#3]            ;1975
002000  4669              MOV      r1,sp                 ;1976
002002  f1050010          ADD      r0,r5,#0x10           ;1976
002006  f7fffffe          BL       lc640_write_long_ptr
00200a  f8980028          LDRB     r0,[r8,#0x28]         ;1978
00200e  f88d0000          STRB     r0,[sp,#0]            ;1978
002012  f8980024          LDRB     r0,[r8,#0x24]         ;1979
002016  f88d0001          STRB     r0,[sp,#1]            ;1979
00201a  f8980020          LDRB     r0,[r8,#0x20]         ;1980
00201e  f88d0002          STRB     r0,[sp,#2]            ;1980
002022  f88d9003          STRB     r9,[sp,#3]            ;1981
002026  4669              MOV      r1,sp                 ;1982
002028  f1050014          ADD      r0,r5,#0x14           ;1982
00202c  f7fffffe          BL       lc640_write_long_ptr
002030  f04f0443          MOV      r4,#0x43              ;1984
002034  f88d4000          STRB     r4,[sp,#0]            ;1984
002038  f88d4001          STRB     r4,[sp,#1]            ;1985
00203c  f88d4002          STRB     r4,[sp,#2]            ;1986
002040  f88d4003          STRB     r4,[sp,#3]            ;1987
002044  4669              MOV      r1,sp                 ;1988
002046  f1050018          ADD      r0,r5,#0x18           ;1988
00204a  f7fffffe          BL       lc640_write_long_ptr
00204e  f88d4000          STRB     r4,[sp,#0]            ;1990
002052  f88d4001          STRB     r4,[sp,#1]            ;1991
002056  f88d4002          STRB     r4,[sp,#2]            ;1992
00205a  f88d4003          STRB     r4,[sp,#3]            ;1993
00205e  4669              MOV      r1,sp                 ;1994
002060  f105001c          ADD      r0,r5,#0x1c           ;1994
002064  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8296|
002068  e4db              B        |L1.6690|
                  |L1.8298|
00206a  f89d0002          LDRB     r0,[sp,#2]            ;2008
00206e  285a              CMP      r0,#0x5a              ;2008
002070  d00a              BEQ      |L1.8328|
                  |L1.8306|
002072  b114              CBZ      r4,|L1.8314|
002074  f1a40401          SUB      r4,r4,#1              ;2010
002078  e001              B        |L1.8318|
                  |L1.8314|
00207a  f04f043f          MOV      r4,#0x3f              ;2011
                  |L1.8318|
00207e  42b4              CMP      r4,r6                 ;2012
002080  d122              BNE      |L1.8392|
002082  f04f0500          MOV      r5,#0                 ;2014
002086  e025              B        |L1.8404|
                  |L1.8328|
002088  4669              MOV      r1,sp                 ;2021
00208a  f1050010          ADD      r0,r5,#0x10           ;2021
00208e  f7fffffe          BL       lc640_read_long_ptr
002092  f89d0000          LDRB     r0,[sp,#0]            ;2022
002096  2841              CMP      r0,#0x41              ;2022
002098  d10b              BNE      |L1.8370|
00209a  f89d0001          LDRB     r0,[sp,#1]            ;2022
00209e  2841              CMP      r0,#0x41              ;2022
0020a0  d107              BNE      |L1.8370|
0020a2  f89d0002          LDRB     r0,[sp,#2]            ;2022
0020a6  2841              CMP      r0,#0x41              ;2022
0020a8  d103              BNE      |L1.8370|
0020aa  f89d0003          LDRB     r0,[sp,#3]            ;2022
0020ae  2841              CMP      r0,#0x41              ;2022
0020b0  d00a              BEQ      |L1.8392|
                  |L1.8370|
0020b2  b114              CBZ      r4,|L1.8378|
0020b4  f1a40401          SUB      r4,r4,#1              ;2024
0020b8  e001              B        |L1.8382|
                  |L1.8378|
0020ba  f04f043f          MOV      r4,#0x3f              ;2025
                  |L1.8382|
0020be  42b4              CMP      r4,r6                 ;2026
0020c0  d102              BNE      |L1.8392|
0020c2  f04f0500          MOV      r5,#0                 ;2028
0020c6  e005              B        |L1.8404|
                  |L1.8392|
0020c8  f1070701          ADD      r7,r7,#1              ;2002
0020cc  b2ff              UXTB     r7,r7                 ;2002
0020ce  2f3f              CMP      r7,#0x3f              ;2002
0020d0  f4ffae72          BCC      |L1.7608|
                  |L1.8404|
0020d4  2d00              CMP      r5,#0                 ;2035
0020d6  d0c7              BEQ      |L1.8296|
0020d8  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2037
0020dc  f88d0000          STRB     r0,[sp,#0]            ;2037
0020e0  f8980038          LDRB     r0,[r8,#0x38]         ;2038
0020e4  f88d0001          STRB     r0,[sp,#1]            ;2038
0020e8  f898002c          LDRB     r0,[r8,#0x2c]         ;2039
0020ec  f88d0002          STRB     r0,[sp,#2]            ;2039
0020f0  f88d9003          STRB     r9,[sp,#3]            ;2040
0020f4  4669              MOV      r1,sp                 ;2041
0020f6  f1050010          ADD      r0,r5,#0x10           ;2041
0020fa  f7fffffe          BL       lc640_write_long_ptr
0020fe  f8980028          LDRB     r0,[r8,#0x28]         ;2043
002102  f88d0000          STRB     r0,[sp,#0]            ;2043
002106  f8980024          LDRB     r0,[r8,#0x24]         ;2044
00210a  f88d0001          STRB     r0,[sp,#1]            ;2044
00210e  f8980020          LDRB     r0,[r8,#0x20]         ;2045
002112  f88d0002          STRB     r0,[sp,#2]            ;2045
002116  f88d9003          STRB     r9,[sp,#3]            ;2046
00211a  4669              MOV      r1,sp                 ;2047
00211c  f1050014          ADD      r0,r5,#0x14           ;2047
002120  f7fffffe          BL       lc640_write_long_ptr
002124  f04f0442          MOV      r4,#0x42              ;2049
002128  f88d4000          STRB     r4,[sp,#0]            ;2049
00212c  f88d4001          STRB     r4,[sp,#1]            ;2050
002130  f88d4002          STRB     r4,[sp,#2]            ;2051
002134  f88d4003          STRB     r4,[sp,#3]            ;2052
002138  4669              MOV      r1,sp                 ;2053
00213a  f1050018          ADD      r0,r5,#0x18           ;2053
00213e  f7fffffe          BL       lc640_write_long_ptr
002142  f88d4000          STRB     r4,[sp,#0]            ;2055
002146  f88d4001          STRB     r4,[sp,#1]            ;2056
00214a  f88d4002          STRB     r4,[sp,#2]            ;2057
00214e  f88d4003          STRB     r4,[sp,#3]            ;2058
002152  4669              MOV      r1,sp                 ;2059
002154  f105001c          ADD      r0,r5,#0x1c           ;2059
002158  f7fffffe          BL       lc640_write_long_ptr
00215c  e461              B        |L1.6690|
;;;2063     
                          ENDP

                  uz_mem_hndl PROC
;;;2065   //-----------------------------------------------
;;;2066   void uz_mem_hndl(unsigned short in)	 //   
00215e  e92d4ff8          PUSH     {r3-r11,lr}
;;;2067   {
;;;2068   char data[4];
;;;2069   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
002162  f04f0600          MOV      r6,#0
002166  4634              MOV      r4,r6
;;;2070   //char avar_simbol;
;;;2071   
;;;2072   if(in==1) //  
;;;2073   	{
;;;2074   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2075   	event_ptr++;	
;;;2076   	if(event_ptr>63)event_ptr=0;	
;;;2077   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2078   	
;;;2079       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2080   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2081   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2082   	
;;;2083   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2084   	
;;;2085   	data[0]='u';
;;;2086   	data[1]=0; 
;;;2087   	data[2]='Z';
;;;2088   	data[3]=0;
;;;2089   	lc640_write_long_ptr(lc640_adr,data);
;;;2090   
;;;2091   	data[0]=0;
;;;2092   	data[1]=0;
;;;2093   	data[2]=0;
;;;2094   	data[3]=0;
;;;2095   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2096   
;;;2097   	data[0]=LPC_RTC->YEAR;
002168  f8df86c4          LDR      r8,|L1.10288|
00216c  46a1              MOV      r9,r4                 ;2069
00216e  f44f6a80          MOV      r10,#0x400            ;2083
002172  2801              CMP      r0,#1                 ;2072
002174  d010              BEQ      |L1.8600|
;;;2098   	data[1]=LPC_RTC->MONTH;
;;;2099   	data[2]=LPC_RTC->DOM;
;;;2100   	data[3]=0;
;;;2101   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2102   
;;;2103   	data[0]=LPC_RTC->HOUR;
;;;2104   	data[1]=LPC_RTC->MIN;
;;;2105   	data[2]=LPC_RTC->SEC;
;;;2106   	data[3]=0;
;;;2107   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2108   	
;;;2109   	data[0]='A';
;;;2110   	data[1]='A';
;;;2111   	data[2]='A';
;;;2112   	data[3]='A';
;;;2113   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2114   	
;;;2115   	data[0]='A';
;;;2116   	data[1]='A';
;;;2117   	data[2]='A';
;;;2118   	data[3]='A';
;;;2119   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2120   	
;;;2121   	data[0]='A';
;;;2122   	data[1]='A';
;;;2123   	data[2]='A';
;;;2124   	data[3]='A';
;;;2125   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2126   	
;;;2127   	data[0]='A';
;;;2128   	data[1]='A';
;;;2129   	data[2]='A';
;;;2130   	data[3]='A';
;;;2131   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2132    	
;;;2133   	}
;;;2134   
;;;2135   else if(in==0)	// 
002176  2800              CMP      r0,#0
002178  d07d              BEQ      |L1.8822|
;;;2136   	{      
;;;2137   	char i;     
;;;2138   	event_ptr_find=0;
;;;2139   	for (i=0;i<63;i++)
;;;2140   		{
;;;2141   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2142   
;;;2143        	lc640_read_long_ptr(lc640_adr,data);
;;;2144        
;;;2145        	if(!((data[0]=='u')&&(data[2]=='Z')))
;;;2146        		{        
;;;2147        		if(event_ptr_find)event_ptr_find--;
;;;2148        		else event_ptr_find=63;
;;;2149        		if(event_ptr_find==event_ptr)
;;;2150   				{
;;;2151   				lc640_adr=0;
;;;2152   				break;
;;;2153   				}
;;;2154        		else continue;
;;;2155        		}
;;;2156        	else 
;;;2157        		{
;;;2158        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2159        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2160        			{        
;;;2161        			if(event_ptr_find)event_ptr_find--;
;;;2162            		else event_ptr_find=63;
;;;2163            		if(event_ptr_find==event_ptr)
;;;2164   					{
;;;2165   					lc640_adr=0;
;;;2166   					break;
;;;2167   					}
;;;2168        			else continue;
;;;2169        			}
;;;2170        		}	
;;;2171   		}
;;;2172   	if(lc640_adr!=0)
;;;2173   		{
;;;2174   		data[0]=LPC_RTC->YEAR;
;;;2175   		data[1]=LPC_RTC->MONTH;
;;;2176   		data[2]=LPC_RTC->DOM;
;;;2177   		data[3]=0;
;;;2178   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2179   	
;;;2180   		data[0]=LPC_RTC->HOUR;
;;;2181   		data[1]=LPC_RTC->MIN;
;;;2182   		data[2]=LPC_RTC->SEC;
;;;2183   		data[3]=0;
;;;2184   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2185   		
;;;2186   		data[0]='C';
;;;2187   		data[1]='C';
;;;2188   		data[2]='C';
;;;2189   		data[3]='C';
;;;2190   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2191   		
;;;2192   		data[0]='C';
;;;2193   		data[1]='C';
;;;2194   		data[2]='C';
;;;2195   		data[3]='C';
;;;2196   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2197   		}
;;;2198   	}
;;;2199   else if(in==10) 	//  
00217a  280a              CMP      r0,#0xa
00217c  d17c              BNE      |L1.8824|
;;;2200   	{      
;;;2201   	char i;     
;;;2202   
;;;2203   	event_ptr_find=0;
;;;2204   	for (i=0;i<63;i++)
00217e  f04f0700          MOV      r7,#0
                  |L1.8578|
;;;2205   		{
;;;2206   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
002182  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2207   
;;;2208        	lc640_read_long_ptr(lc640_adr,data);
002186  4669              MOV      r1,sp
002188  4628              MOV      r0,r5
00218a  f7fffffe          BL       lc640_read_long_ptr
;;;2209        
;;;2210        	if(!((data[0]=='u')&&(data[2]=='Z')))
00218e  f89d0000          LDRB     r0,[sp,#0]
002192  2875              CMP      r0,#0x75
002194  d171              BNE      |L1.8826|
002196  e11c              B        |L1.9170|
                  |L1.8600|
002198  f44f6560          MOV      r5,#0xe00             ;2074
00219c  4628              MOV      r0,r5                 ;2074
00219e  f7fffffe          BL       lc640_read_int
0021a2  f1000001          ADD      r0,r0,#1              ;2075
0021a6  4604              MOV      r4,r0                 ;2075
0021a8  2c3f              CMP      r4,#0x3f              ;2076
0021aa  d901              BLS      |L1.8624|
0021ac  f04f0400          MOV      r4,#0                 ;2076
                  |L1.8624|
0021b0  b221              SXTH     r1,r4                 ;2077
0021b2  4628              MOV      r0,r5                 ;2077
0021b4  f7fffffe          BL       lc640_write_int
0021b8  f6406602          MOV      r6,#0xe02             ;2079
0021bc  4630              MOV      r0,r6                 ;2079
0021be  f7fffffe          BL       lc640_read_int
0021c2  283f              CMP      r0,#0x3f              ;2080
0021c4  d000              BEQ      |L1.8648|
0021c6  4620              MOV      r0,r4                 ;2080
                  |L1.8648|
0021c8  b201              SXTH     r1,r0                 ;2081
0021ca  4630              MOV      r0,r6                 ;2081
0021cc  f7fffffe          BL       lc640_write_int
0021d0  4628              MOV      r0,r5                 ;2083
0021d2  f7fffffe          BL       lc640_read_int
0021d6  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2083
0021da  f04f0075          MOV      r0,#0x75              ;2085
0021de  f88d0000          STRB     r0,[sp,#0]            ;2085
0021e2  f88d9001          STRB     r9,[sp,#1]            ;2086
0021e6  f04f005a          MOV      r0,#0x5a              ;2087
0021ea  f88d0002          STRB     r0,[sp,#2]            ;2087
0021ee  f88d9003          STRB     r9,[sp,#3]            ;2088
0021f2  4669              MOV      r1,sp                 ;2089
0021f4  4620              MOV      r0,r4                 ;2089
0021f6  f7fffffe          BL       lc640_write_long_ptr
0021fa  f8cd9000          STR      r9,[sp,#0]            ;2094
0021fe  4669              MOV      r1,sp                 ;2095
002200  1d20              ADDS     r0,r4,#4              ;2095
002202  f7fffffe          BL       lc640_write_long_ptr
002206  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2097
00220a  f88d0000          STRB     r0,[sp,#0]            ;2097
00220e  f8980038          LDRB     r0,[r8,#0x38]         ;2098
002212  f88d0001          STRB     r0,[sp,#1]            ;2098
002216  f898002c          LDRB     r0,[r8,#0x2c]         ;2099
00221a  f88d0002          STRB     r0,[sp,#2]            ;2099
00221e  f88d9003          STRB     r9,[sp,#3]            ;2100
002222  4669              MOV      r1,sp                 ;2101
002224  f1040008          ADD      r0,r4,#8              ;2101
002228  f7fffffe          BL       lc640_write_long_ptr
00222c  f8980028          LDRB     r0,[r8,#0x28]         ;2103
002230  f88d0000          STRB     r0,[sp,#0]            ;2103
002234  f8980024          LDRB     r0,[r8,#0x24]         ;2104
002238  f88d0001          STRB     r0,[sp,#1]            ;2104
00223c  f8980020          LDRB     r0,[r8,#0x20]         ;2105
002240  f88d0002          STRB     r0,[sp,#2]            ;2105
002244  f88d9003          STRB     r9,[sp,#3]            ;2106
002248  4669              MOV      r1,sp                 ;2107
00224a  f104000c          ADD      r0,r4,#0xc            ;2107
00224e  f7fffffe          BL       lc640_write_long_ptr
002252  f04f0541          MOV      r5,#0x41              ;2109
002256  f88d5000          STRB     r5,[sp,#0]            ;2109
00225a  f88d5001          STRB     r5,[sp,#1]            ;2110
00225e  f88d5002          STRB     r5,[sp,#2]            ;2111
002262  f88d5003          STRB     r5,[sp,#3]            ;2112
002266  4669              MOV      r1,sp                 ;2113
002268  f1040010          ADD      r0,r4,#0x10           ;2113
00226c  f7fffffe          BL       lc640_write_long_ptr
002270  f88d5000          STRB     r5,[sp,#0]            ;2115
002274  e002              B        |L1.8828|
                  |L1.8822|
002276  e027              B        |L1.8904|
                  |L1.8824|
002278  e025              B        |L1.8902|
                  |L1.8826|
00227a  e0ae              B        |L1.9178|
                  |L1.8828|
00227c  f88d5001          STRB     r5,[sp,#1]            ;2116
002280  f88d5002          STRB     r5,[sp,#2]            ;2117
002284  f88d5003          STRB     r5,[sp,#3]            ;2118
002288  4669              MOV      r1,sp                 ;2119
00228a  f1040014          ADD      r0,r4,#0x14           ;2119
00228e  f7fffffe          BL       lc640_write_long_ptr
002292  f88d5000          STRB     r5,[sp,#0]            ;2121
002296  f88d5001          STRB     r5,[sp,#1]            ;2122
00229a  f88d5002          STRB     r5,[sp,#2]            ;2123
00229e  f88d5003          STRB     r5,[sp,#3]            ;2124
0022a2  4669              MOV      r1,sp                 ;2125
0022a4  f1040018          ADD      r0,r4,#0x18           ;2125
0022a8  f7fffffe          BL       lc640_write_long_ptr
0022ac  f88d5000          STRB     r5,[sp,#0]            ;2127
0022b0  f88d5001          STRB     r5,[sp,#1]            ;2128
0022b4  f88d5002          STRB     r5,[sp,#2]            ;2129
0022b8  f88d5003          STRB     r5,[sp,#3]            ;2130
0022bc  4669              MOV      r1,sp                 ;2131
0022be  f104001c          ADD      r0,r4,#0x1c           ;2131
0022c2  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8902|
;;;2211        		{        
;;;2212        		if(event_ptr_find)event_ptr_find--;
;;;2213        		else event_ptr_find=63;
;;;2214        		if(event_ptr_find==event_ptr)
;;;2215   				{
;;;2216   				lc640_adr=0;
;;;2217   				break;
;;;2218   				}
;;;2219        		else continue;
;;;2220        		}
;;;2221        	else 
;;;2222        		{
;;;2223        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2224        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2225        			{        
;;;2226        			if(event_ptr_find)event_ptr_find--;
;;;2227            		else event_ptr_find=63;
;;;2228            		if(event_ptr_find==event_ptr)
;;;2229   					{
;;;2230   					lc640_adr=0;
;;;2231   					break;
;;;2232   					}
;;;2233        			else continue;
;;;2234        			}
;;;2235        		}	
;;;2236   		}
;;;2237   	if(lc640_adr!=0)
;;;2238   		{
;;;2239   		data[0]=LPC_RTC->YEAR;
;;;2240   		data[1]=LPC_RTC->MONTH;
;;;2241   		data[2]=LPC_RTC->DOM;
;;;2242   		data[3]=0;
;;;2243   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2244   	
;;;2245   		data[0]=LPC_RTC->HOUR;
;;;2246   		data[1]=LPC_RTC->MIN;
;;;2247   		data[2]=LPC_RTC->SEC;
;;;2248   		data[3]=0;
;;;2249   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2250   		
;;;2251   		data[0]='B';
;;;2252   		data[1]='B';
;;;2253   		data[2]='B';
;;;2254   		data[3]='B';
;;;2255   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2256   		
;;;2257   		data[0]='B';
;;;2258   		data[1]='B';
;;;2259   		data[2]='B';
;;;2260   		data[3]='B';
;;;2261   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2262   		}
;;;2263   	}
;;;2264   }
0022c6  e561              B        |L1.7564|
                  |L1.8904|
0022c8  f04f0700          MOV      r7,#0                 ;2139
                  |L1.8908|
0022cc  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2141
0022d0  4669              MOV      r1,sp                 ;2143
0022d2  4628              MOV      r0,r5                 ;2143
0022d4  f7fffffe          BL       lc640_read_long_ptr
0022d8  f89d0000          LDRB     r0,[sp,#0]            ;2145
0022dc  2875              CMP      r0,#0x75              ;2145
0022de  d103              BNE      |L1.8936|
0022e0  f89d0002          LDRB     r0,[sp,#2]            ;2145
0022e4  285a              CMP      r0,#0x5a              ;2145
0022e6  d00a              BEQ      |L1.8958|
                  |L1.8936|
0022e8  b114              CBZ      r4,|L1.8944|
0022ea  f1a40401          SUB      r4,r4,#1              ;2147
0022ee  e001              B        |L1.8948|
                  |L1.8944|
0022f0  f04f043f          MOV      r4,#0x3f              ;2148
                  |L1.8948|
0022f4  42b4              CMP      r4,r6                 ;2149
0022f6  d122              BNE      |L1.9022|
0022f8  f04f0500          MOV      r5,#0                 ;2151
0022fc  e024              B        |L1.9032|
                  |L1.8958|
0022fe  4669              MOV      r1,sp                 ;2158
002300  f1050010          ADD      r0,r5,#0x10           ;2158
002304  f7fffffe          BL       lc640_read_long_ptr
002308  f89d0000          LDRB     r0,[sp,#0]            ;2159
00230c  2841              CMP      r0,#0x41              ;2159
00230e  d10b              BNE      |L1.9000|
002310  f89d0001          LDRB     r0,[sp,#1]            ;2159
002314  2841              CMP      r0,#0x41              ;2159
002316  d107              BNE      |L1.9000|
002318  f89d0002          LDRB     r0,[sp,#2]            ;2159
00231c  2841              CMP      r0,#0x41              ;2159
00231e  d103              BNE      |L1.9000|
002320  f89d0003          LDRB     r0,[sp,#3]            ;2159
002324  2841              CMP      r0,#0x41              ;2159
002326  d00a              BEQ      |L1.9022|
                  |L1.9000|
002328  b114              CBZ      r4,|L1.9008|
00232a  f1a40401          SUB      r4,r4,#1              ;2161
00232e  e001              B        |L1.9012|
                  |L1.9008|
002330  f04f043f          MOV      r4,#0x3f              ;2162
                  |L1.9012|
002334  42b4              CMP      r4,r6                 ;2163
002336  d102              BNE      |L1.9022|
002338  f04f0500          MOV      r5,#0                 ;2165
00233c  e004              B        |L1.9032|
                  |L1.9022|
00233e  f1070701          ADD      r7,r7,#1              ;2139
002342  b2ff              UXTB     r7,r7                 ;2139
002344  2f3f              CMP      r7,#0x3f              ;2139
002346  d3c1              BCC      |L1.8908|
                  |L1.9032|
002348  2d00              CMP      r5,#0                 ;2172
00234a  d0bc              BEQ      |L1.8902|
00234c  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2174
002350  f88d0000          STRB     r0,[sp,#0]            ;2174
002354  f8980038          LDRB     r0,[r8,#0x38]         ;2175
002358  f88d0001          STRB     r0,[sp,#1]            ;2175
00235c  f898002c          LDRB     r0,[r8,#0x2c]         ;2176
002360  f88d0002          STRB     r0,[sp,#2]            ;2176
002364  f88d9003          STRB     r9,[sp,#3]            ;2177
002368  4669              MOV      r1,sp                 ;2178
00236a  f1050010          ADD      r0,r5,#0x10           ;2178
00236e  f7fffffe          BL       lc640_write_long_ptr
002372  f8980028          LDRB     r0,[r8,#0x28]         ;2180
002376  f88d0000          STRB     r0,[sp,#0]            ;2180
00237a  f8980024          LDRB     r0,[r8,#0x24]         ;2181
00237e  f88d0001          STRB     r0,[sp,#1]            ;2181
002382  f8980020          LDRB     r0,[r8,#0x20]         ;2182
002386  f88d0002          STRB     r0,[sp,#2]            ;2182
00238a  f88d9003          STRB     r9,[sp,#3]            ;2183
00238e  4669              MOV      r1,sp                 ;2184
002390  f1050014          ADD      r0,r5,#0x14           ;2184
002394  f7fffffe          BL       lc640_write_long_ptr
002398  f04f0443          MOV      r4,#0x43              ;2186
00239c  f88d4000          STRB     r4,[sp,#0]            ;2186
0023a0  f88d4001          STRB     r4,[sp,#1]            ;2187
0023a4  f88d4002          STRB     r4,[sp,#2]            ;2188
0023a8  f88d4003          STRB     r4,[sp,#3]            ;2189
0023ac  4669              MOV      r1,sp                 ;2190
0023ae  f1050018          ADD      r0,r5,#0x18           ;2190
0023b2  f7fffffe          BL       lc640_write_long_ptr
0023b6  f88d4000          STRB     r4,[sp,#0]            ;2192
0023ba  f88d4001          STRB     r4,[sp,#1]            ;2193
0023be  f88d4002          STRB     r4,[sp,#2]            ;2194
0023c2  f88d4003          STRB     r4,[sp,#3]            ;2195
0023c6  4669              MOV      r1,sp                 ;2196
0023c8  f105001c          ADD      r0,r5,#0x1c           ;2196
0023cc  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9168|
0023d0  e4dc              B        |L1.7564|
                  |L1.9170|
0023d2  f89d0002          LDRB     r0,[sp,#2]            ;2210
0023d6  285a              CMP      r0,#0x5a              ;2210
0023d8  d00a              BEQ      |L1.9200|
                  |L1.9178|
0023da  b114              CBZ      r4,|L1.9186|
0023dc  f1a40401          SUB      r4,r4,#1              ;2212
0023e0  e001              B        |L1.9190|
                  |L1.9186|
0023e2  f04f043f          MOV      r4,#0x3f              ;2213
                  |L1.9190|
0023e6  42b4              CMP      r4,r6                 ;2214
0023e8  d122              BNE      |L1.9264|
0023ea  f04f0500          MOV      r5,#0                 ;2216
0023ee  e025              B        |L1.9276|
                  |L1.9200|
0023f0  4669              MOV      r1,sp                 ;2223
0023f2  f1050010          ADD      r0,r5,#0x10           ;2223
0023f6  f7fffffe          BL       lc640_read_long_ptr
0023fa  f89d0000          LDRB     r0,[sp,#0]            ;2224
0023fe  2841              CMP      r0,#0x41              ;2224
002400  d10b              BNE      |L1.9242|
002402  f89d0001          LDRB     r0,[sp,#1]            ;2224
002406  2841              CMP      r0,#0x41              ;2224
002408  d107              BNE      |L1.9242|
00240a  f89d0002          LDRB     r0,[sp,#2]            ;2224
00240e  2841              CMP      r0,#0x41              ;2224
002410  d103              BNE      |L1.9242|
002412  f89d0003          LDRB     r0,[sp,#3]            ;2224
002416  2841              CMP      r0,#0x41              ;2224
002418  d00a              BEQ      |L1.9264|
                  |L1.9242|
00241a  b114              CBZ      r4,|L1.9250|
00241c  f1a40401          SUB      r4,r4,#1              ;2226
002420  e001              B        |L1.9254|
                  |L1.9250|
002422  f04f043f          MOV      r4,#0x3f              ;2227
                  |L1.9254|
002426  42b4              CMP      r4,r6                 ;2228
002428  d102              BNE      |L1.9264|
00242a  f04f0500          MOV      r5,#0                 ;2230
00242e  e005              B        |L1.9276|
                  |L1.9264|
002430  f1070701          ADD      r7,r7,#1              ;2204
002434  b2ff              UXTB     r7,r7                 ;2204
002436  2f3f              CMP      r7,#0x3f              ;2204
002438  f4ffaea3          BCC      |L1.8578|
                  |L1.9276|
00243c  2d00              CMP      r5,#0                 ;2237
00243e  d0c7              BEQ      |L1.9168|
002440  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2239
002444  f88d0000          STRB     r0,[sp,#0]            ;2239
002448  f8980038          LDRB     r0,[r8,#0x38]         ;2240
00244c  f88d0001          STRB     r0,[sp,#1]            ;2240
002450  f898002c          LDRB     r0,[r8,#0x2c]         ;2241
002454  f88d0002          STRB     r0,[sp,#2]            ;2241
002458  f88d9003          STRB     r9,[sp,#3]            ;2242
00245c  4669              MOV      r1,sp                 ;2243
00245e  f1050010          ADD      r0,r5,#0x10           ;2243
002462  f7fffffe          BL       lc640_write_long_ptr
002466  f8980028          LDRB     r0,[r8,#0x28]         ;2245
00246a  f88d0000          STRB     r0,[sp,#0]            ;2245
00246e  f8980024          LDRB     r0,[r8,#0x24]         ;2246
002472  f88d0001          STRB     r0,[sp,#1]            ;2246
002476  f8980020          LDRB     r0,[r8,#0x20]         ;2247
00247a  f88d0002          STRB     r0,[sp,#2]            ;2247
00247e  f88d9003          STRB     r9,[sp,#3]            ;2248
002482  4669              MOV      r1,sp                 ;2249
002484  f1050014          ADD      r0,r5,#0x14           ;2249
002488  f7fffffe          BL       lc640_write_long_ptr
00248c  f04f0442          MOV      r4,#0x42              ;2251
002490  f88d4000          STRB     r4,[sp,#0]            ;2251
002494  f88d4001          STRB     r4,[sp,#1]            ;2252
002498  f88d4002          STRB     r4,[sp,#2]            ;2253
00249c  f88d4003          STRB     r4,[sp,#3]            ;2254
0024a0  4669              MOV      r1,sp                 ;2255
0024a2  f1050018          ADD      r0,r5,#0x18           ;2255
0024a6  f7fffffe          BL       lc640_write_long_ptr
0024aa  f88d4000          STRB     r4,[sp,#0]            ;2257
0024ae  f88d4001          STRB     r4,[sp,#1]            ;2258
0024b2  f88d4002          STRB     r4,[sp,#2]            ;2259
0024b6  f88d4003          STRB     r4,[sp,#3]            ;2260
0024ba  4669              MOV      r1,sp                 ;2261
0024bc  f105001c          ADD      r0,r5,#0x1c           ;2261
0024c0  f7fffffe          BL       lc640_write_long_ptr
0024c4  e462              B        |L1.7564|
;;;2265   
                          ENDP

                  fz_mem_hndl PROC
;;;2266   //-----------------------------------------------
;;;2267   void fz_mem_hndl(unsigned short in)	 //   
0024c6  e92d4ff8          PUSH     {r3-r11,lr}
;;;2268   {
;;;2269   char data[4];
;;;2270   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
0024ca  f04f0600          MOV      r6,#0
0024ce  4634              MOV      r4,r6
;;;2271   //char avar_simbol;
;;;2272   
;;;2273   if(in==1) //  
;;;2274   	{
;;;2275   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2276   	event_ptr++;	
;;;2277   	if(event_ptr>63)event_ptr=0;	
;;;2278   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2279   	
;;;2280       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2281   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2282   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2283   	
;;;2284   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2285   	
;;;2286   	data[0]='f';
;;;2287   	data[1]=0; 
;;;2288   	data[2]='Z';
;;;2289   	data[3]=0;
;;;2290   	lc640_write_long_ptr(lc640_adr,data);
;;;2291   
;;;2292   	data[0]=0;
;;;2293   	data[1]=0;
;;;2294   	data[2]=0;
;;;2295   	data[3]=0;
;;;2296   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2297   
;;;2298   	data[0]=LPC_RTC->YEAR;
0024d0  f8df835c          LDR      r8,|L1.10288|
0024d4  46a1              MOV      r9,r4                 ;2270
0024d6  f44f6a80          MOV      r10,#0x400            ;2284
0024da  2801              CMP      r0,#1                 ;2273
0024dc  d010              BEQ      |L1.9472|
;;;2299   	data[1]=LPC_RTC->MONTH;
;;;2300   	data[2]=LPC_RTC->DOM;
;;;2301   	data[3]=0;
;;;2302   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2303   
;;;2304   	data[0]=LPC_RTC->HOUR;
;;;2305   	data[1]=LPC_RTC->MIN;
;;;2306   	data[2]=LPC_RTC->SEC;
;;;2307   	data[3]=0;
;;;2308   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2309   	
;;;2310   	data[0]='A';
;;;2311   	data[1]='A';
;;;2312   	data[2]='A';
;;;2313   	data[3]='A';
;;;2314   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2315   	
;;;2316   	data[0]='A';
;;;2317   	data[1]='A';
;;;2318   	data[2]='A';
;;;2319   	data[3]='A';
;;;2320   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2321   	
;;;2322   	data[0]='A';
;;;2323   	data[1]='A';
;;;2324   	data[2]='A';
;;;2325   	data[3]='A';
;;;2326   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2327   	
;;;2328   	data[0]='A';
;;;2329   	data[1]='A';
;;;2330   	data[2]='A';
;;;2331   	data[3]='A';
;;;2332   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2333    	
;;;2334   	}
;;;2335   
;;;2336   else if(in==0)	// 
0024de  2800              CMP      r0,#0
0024e0  d07d              BEQ      |L1.9694|
;;;2337   	{      
;;;2338   	char i;     
;;;2339   	event_ptr_find=0;
;;;2340   	for (i=0;i<63;i++)
;;;2341   		{
;;;2342   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2343   
;;;2344        	lc640_read_long_ptr(lc640_adr,data);
;;;2345        
;;;2346        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;2347        		{        
;;;2348        		if(event_ptr_find)event_ptr_find--;
;;;2349        		else event_ptr_find=63;
;;;2350        		if(event_ptr_find==event_ptr)
;;;2351   				{
;;;2352   				lc640_adr=0;
;;;2353   				break;
;;;2354   				}
;;;2355        		else continue;
;;;2356        		}
;;;2357        	else 
;;;2358        		{
;;;2359        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2360        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2361        			{        
;;;2362        			if(event_ptr_find)event_ptr_find--;
;;;2363            		else event_ptr_find=63;
;;;2364            		if(event_ptr_find==event_ptr)
;;;2365   					{
;;;2366   					lc640_adr=0;
;;;2367   					break;
;;;2368   					}
;;;2369        			else continue;
;;;2370        			}
;;;2371        		}	
;;;2372   		}
;;;2373   	if(lc640_adr!=0)
;;;2374   		{
;;;2375   		data[0]=LPC_RTC->YEAR;
;;;2376   		data[1]=LPC_RTC->MONTH;
;;;2377   		data[2]=LPC_RTC->DOM;
;;;2378   		data[3]=0;
;;;2379   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2380   	
;;;2381   		data[0]=LPC_RTC->HOUR;
;;;2382   		data[1]=LPC_RTC->MIN;
;;;2383   		data[2]=LPC_RTC->SEC;
;;;2384   		data[3]=0;
;;;2385   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2386   		
;;;2387   		data[0]='C';
;;;2388   		data[1]='C';
;;;2389   		data[2]='C';
;;;2390   		data[3]='C';
;;;2391   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2392   		
;;;2393   		data[0]='C';
;;;2394   		data[1]='C';
;;;2395   		data[2]='C';
;;;2396   		data[3]='C';
;;;2397   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2398   		}
;;;2399   	}
;;;2400   else if(in==10) 	//  
0024e2  280a              CMP      r0,#0xa
0024e4  d17c              BNE      |L1.9696|
;;;2401   	{      
;;;2402   	char i;     
;;;2403   
;;;2404   	event_ptr_find=0;
;;;2405   	for (i=0;i<63;i++)
0024e6  f04f0700          MOV      r7,#0
                  |L1.9450|
;;;2406   		{
;;;2407   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
0024ea  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2408   
;;;2409        	lc640_read_long_ptr(lc640_adr,data);
0024ee  4669              MOV      r1,sp
0024f0  4628              MOV      r0,r5
0024f2  f7fffffe          BL       lc640_read_long_ptr
;;;2410        
;;;2411        	if(!((data[0]=='f')&&(data[2]=='Z')))
0024f6  f89d0000          LDRB     r0,[sp,#0]
0024fa  2866              CMP      r0,#0x66
0024fc  d171              BNE      |L1.9698|
0024fe  e11c              B        |L1.10042|
                  |L1.9472|
002500  f44f6560          MOV      r5,#0xe00             ;2275
002504  4628              MOV      r0,r5                 ;2275
002506  f7fffffe          BL       lc640_read_int
00250a  f1000001          ADD      r0,r0,#1              ;2276
00250e  4604              MOV      r4,r0                 ;2276
002510  2c3f              CMP      r4,#0x3f              ;2277
002512  d901              BLS      |L1.9496|
002514  f04f0400          MOV      r4,#0                 ;2277
                  |L1.9496|
002518  b221              SXTH     r1,r4                 ;2278
00251a  4628              MOV      r0,r5                 ;2278
00251c  f7fffffe          BL       lc640_write_int
002520  f6406602          MOV      r6,#0xe02             ;2280
002524  4630              MOV      r0,r6                 ;2280
002526  f7fffffe          BL       lc640_read_int
00252a  283f              CMP      r0,#0x3f              ;2281
00252c  d000              BEQ      |L1.9520|
00252e  4620              MOV      r0,r4                 ;2281
                  |L1.9520|
002530  b201              SXTH     r1,r0                 ;2282
002532  4630              MOV      r0,r6                 ;2282
002534  f7fffffe          BL       lc640_write_int
002538  4628              MOV      r0,r5                 ;2284
00253a  f7fffffe          BL       lc640_read_int
00253e  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2284
002542  f04f0066          MOV      r0,#0x66              ;2286
002546  f88d0000          STRB     r0,[sp,#0]            ;2286
00254a  f88d9001          STRB     r9,[sp,#1]            ;2287
00254e  f04f005a          MOV      r0,#0x5a              ;2288
002552  f88d0002          STRB     r0,[sp,#2]            ;2288
002556  f88d9003          STRB     r9,[sp,#3]            ;2289
00255a  4669              MOV      r1,sp                 ;2290
00255c  4620              MOV      r0,r4                 ;2290
00255e  f7fffffe          BL       lc640_write_long_ptr
002562  f8cd9000          STR      r9,[sp,#0]            ;2295
002566  4669              MOV      r1,sp                 ;2296
002568  1d20              ADDS     r0,r4,#4              ;2296
00256a  f7fffffe          BL       lc640_write_long_ptr
00256e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2298
002572  f88d0000          STRB     r0,[sp,#0]            ;2298
002576  f8980038          LDRB     r0,[r8,#0x38]         ;2299
00257a  f88d0001          STRB     r0,[sp,#1]            ;2299
00257e  f898002c          LDRB     r0,[r8,#0x2c]         ;2300
002582  f88d0002          STRB     r0,[sp,#2]            ;2300
002586  f88d9003          STRB     r9,[sp,#3]            ;2301
00258a  4669              MOV      r1,sp                 ;2302
00258c  f1040008          ADD      r0,r4,#8              ;2302
002590  f7fffffe          BL       lc640_write_long_ptr
002594  f8980028          LDRB     r0,[r8,#0x28]         ;2304
002598  f88d0000          STRB     r0,[sp,#0]            ;2304
00259c  f8980024          LDRB     r0,[r8,#0x24]         ;2305
0025a0  f88d0001          STRB     r0,[sp,#1]            ;2305
0025a4  f8980020          LDRB     r0,[r8,#0x20]         ;2306
0025a8  f88d0002          STRB     r0,[sp,#2]            ;2306
0025ac  f88d9003          STRB     r9,[sp,#3]            ;2307
0025b0  4669              MOV      r1,sp                 ;2308
0025b2  f104000c          ADD      r0,r4,#0xc            ;2308
0025b6  f7fffffe          BL       lc640_write_long_ptr
0025ba  f04f0541          MOV      r5,#0x41              ;2310
0025be  f88d5000          STRB     r5,[sp,#0]            ;2310
0025c2  f88d5001          STRB     r5,[sp,#1]            ;2311
0025c6  f88d5002          STRB     r5,[sp,#2]            ;2312
0025ca  f88d5003          STRB     r5,[sp,#3]            ;2313
0025ce  4669              MOV      r1,sp                 ;2314
0025d0  f1040010          ADD      r0,r4,#0x10           ;2314
0025d4  f7fffffe          BL       lc640_write_long_ptr
0025d8  f88d5000          STRB     r5,[sp,#0]            ;2316
0025dc  e002              B        |L1.9700|
                  |L1.9694|
0025de  e027              B        |L1.9776|
                  |L1.9696|
0025e0  e025              B        |L1.9774|
                  |L1.9698|
0025e2  e0ae              B        |L1.10050|
                  |L1.9700|
0025e4  f88d5001          STRB     r5,[sp,#1]            ;2317
0025e8  f88d5002          STRB     r5,[sp,#2]            ;2318
0025ec  f88d5003          STRB     r5,[sp,#3]            ;2319
0025f0  4669              MOV      r1,sp                 ;2320
0025f2  f1040014          ADD      r0,r4,#0x14           ;2320
0025f6  f7fffffe          BL       lc640_write_long_ptr
0025fa  f88d5000          STRB     r5,[sp,#0]            ;2322
0025fe  f88d5001          STRB     r5,[sp,#1]            ;2323
002602  f88d5002          STRB     r5,[sp,#2]            ;2324
002606  f88d5003          STRB     r5,[sp,#3]            ;2325
00260a  4669              MOV      r1,sp                 ;2326
00260c  f1040018          ADD      r0,r4,#0x18           ;2326
002610  f7fffffe          BL       lc640_write_long_ptr
002614  f88d5000          STRB     r5,[sp,#0]            ;2328
002618  f88d5001          STRB     r5,[sp,#1]            ;2329
00261c  f88d5002          STRB     r5,[sp,#2]            ;2330
002620  f88d5003          STRB     r5,[sp,#3]            ;2331
002624  4669              MOV      r1,sp                 ;2332
002626  f104001c          ADD      r0,r4,#0x1c           ;2332
00262a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9774|
;;;2412        		{        
;;;2413        		if(event_ptr_find)event_ptr_find--;
;;;2414        		else event_ptr_find=63;
;;;2415        		if(event_ptr_find==event_ptr)
;;;2416   				{
;;;2417   				lc640_adr=0;
;;;2418   				break;
;;;2419   				}
;;;2420        		else continue;
;;;2421        		}
;;;2422        	else 
;;;2423        		{
;;;2424        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2425        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2426        			{        
;;;2427        			if(event_ptr_find)event_ptr_find--;
;;;2428            		else event_ptr_find=63;
;;;2429            		if(event_ptr_find==event_ptr)
;;;2430   					{
;;;2431   					lc640_adr=0;
;;;2432   					break;
;;;2433   					}
;;;2434        			else continue;
;;;2435        			}
;;;2436        		}	
;;;2437   		}
;;;2438   	if(lc640_adr!=0)
;;;2439   		{
;;;2440   		data[0]=LPC_RTC->YEAR;
;;;2441   		data[1]=LPC_RTC->MONTH;
;;;2442   		data[2]=LPC_RTC->DOM;
;;;2443   		data[3]=0;
;;;2444   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2445   	
;;;2446   		data[0]=LPC_RTC->HOUR;
;;;2447   		data[1]=LPC_RTC->MIN;
;;;2448   		data[2]=LPC_RTC->SEC;
;;;2449   		data[3]=0;
;;;2450   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2451   		
;;;2452   		data[0]='B';
;;;2453   		data[1]='B';
;;;2454   		data[2]='B';
;;;2455   		data[3]='B';
;;;2456   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2457   		
;;;2458   		data[0]='B';
;;;2459   		data[1]='B';
;;;2460   		data[2]='B';
;;;2461   		data[3]='B';
;;;2462   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2463   		}
;;;2464   	}
;;;2465   }
00262e  e496              B        |L1.8030|
                  |L1.9776|
002630  f04f0700          MOV      r7,#0                 ;2340
                  |L1.9780|
002634  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2342
002638  4669              MOV      r1,sp                 ;2344
00263a  4628              MOV      r0,r5                 ;2344
00263c  f7fffffe          BL       lc640_read_long_ptr
002640  f89d0000          LDRB     r0,[sp,#0]            ;2346
002644  2866              CMP      r0,#0x66              ;2346
002646  d103              BNE      |L1.9808|
002648  f89d0002          LDRB     r0,[sp,#2]            ;2346
00264c  285a              CMP      r0,#0x5a              ;2346
00264e  d00a              BEQ      |L1.9830|
                  |L1.9808|
002650  b114              CBZ      r4,|L1.9816|
002652  f1a40401          SUB      r4,r4,#1              ;2348
002656  e001              B        |L1.9820|
                  |L1.9816|
002658  f04f043f          MOV      r4,#0x3f              ;2349
                  |L1.9820|
00265c  42b4              CMP      r4,r6                 ;2350
00265e  d122              BNE      |L1.9894|
002660  f04f0500          MOV      r5,#0                 ;2352
002664  e024              B        |L1.9904|
                  |L1.9830|
002666  4669              MOV      r1,sp                 ;2359
002668  f1050010          ADD      r0,r5,#0x10           ;2359
00266c  f7fffffe          BL       lc640_read_long_ptr
002670  f89d0000          LDRB     r0,[sp,#0]            ;2360
002674  2841              CMP      r0,#0x41              ;2360
002676  d10b              BNE      |L1.9872|
002678  f89d0001          LDRB     r0,[sp,#1]            ;2360
00267c  2841              CMP      r0,#0x41              ;2360
00267e  d107              BNE      |L1.9872|
002680  f89d0002          LDRB     r0,[sp,#2]            ;2360
002684  2841              CMP      r0,#0x41              ;2360
002686  d103              BNE      |L1.9872|
002688  f89d0003          LDRB     r0,[sp,#3]            ;2360
00268c  2841              CMP      r0,#0x41              ;2360
00268e  d00a              BEQ      |L1.9894|
                  |L1.9872|
002690  b114              CBZ      r4,|L1.9880|
002692  f1a40401          SUB      r4,r4,#1              ;2362
002696  e001              B        |L1.9884|
                  |L1.9880|
002698  f04f043f          MOV      r4,#0x3f              ;2363
                  |L1.9884|
00269c  42b4              CMP      r4,r6                 ;2364
00269e  d102              BNE      |L1.9894|
0026a0  f04f0500          MOV      r5,#0                 ;2366
0026a4  e004              B        |L1.9904|
                  |L1.9894|
0026a6  f1070701          ADD      r7,r7,#1              ;2340
0026aa  b2ff              UXTB     r7,r7                 ;2340
0026ac  2f3f              CMP      r7,#0x3f              ;2340
0026ae  d3c1              BCC      |L1.9780|
                  |L1.9904|
0026b0  2d00              CMP      r5,#0                 ;2373
0026b2  d0bc              BEQ      |L1.9774|
0026b4  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2375
0026b8  f88d0000          STRB     r0,[sp,#0]            ;2375
0026bc  f8980038          LDRB     r0,[r8,#0x38]         ;2376
0026c0  f88d0001          STRB     r0,[sp,#1]            ;2376
0026c4  f898002c          LDRB     r0,[r8,#0x2c]         ;2377
0026c8  f88d0002          STRB     r0,[sp,#2]            ;2377
0026cc  f88d9003          STRB     r9,[sp,#3]            ;2378
0026d0  4669              MOV      r1,sp                 ;2379
0026d2  f1050010          ADD      r0,r5,#0x10           ;2379
0026d6  f7fffffe          BL       lc640_write_long_ptr
0026da  f8980028          LDRB     r0,[r8,#0x28]         ;2381
0026de  f88d0000          STRB     r0,[sp,#0]            ;2381
0026e2  f8980024          LDRB     r0,[r8,#0x24]         ;2382
0026e6  f88d0001          STRB     r0,[sp,#1]            ;2382
0026ea  f8980020          LDRB     r0,[r8,#0x20]         ;2383
0026ee  f88d0002          STRB     r0,[sp,#2]            ;2383
0026f2  f88d9003          STRB     r9,[sp,#3]            ;2384
0026f6  4669              MOV      r1,sp                 ;2385
0026f8  f1050014          ADD      r0,r5,#0x14           ;2385
0026fc  f7fffffe          BL       lc640_write_long_ptr
002700  f04f0443          MOV      r4,#0x43              ;2387
002704  f88d4000          STRB     r4,[sp,#0]            ;2387
002708  f88d4001          STRB     r4,[sp,#1]            ;2388
00270c  f88d4002          STRB     r4,[sp,#2]            ;2389
002710  f88d4003          STRB     r4,[sp,#3]            ;2390
002714  4669              MOV      r1,sp                 ;2391
002716  f1050018          ADD      r0,r5,#0x18           ;2391
00271a  f7fffffe          BL       lc640_write_long_ptr
00271e  f88d4000          STRB     r4,[sp,#0]            ;2393
002722  f88d4001          STRB     r4,[sp,#1]            ;2394
002726  f88d4002          STRB     r4,[sp,#2]            ;2395
00272a  f88d4003          STRB     r4,[sp,#3]            ;2396
00272e  4669              MOV      r1,sp                 ;2397
002730  f105001c          ADD      r0,r5,#0x1c           ;2397
002734  f7fffffe          BL       lc640_write_long_ptr
                  |L1.10040|
002738  e411              B        |L1.8030|
                  |L1.10042|
00273a  f89d0002          LDRB     r0,[sp,#2]            ;2411
00273e  285a              CMP      r0,#0x5a              ;2411
002740  d00a              BEQ      |L1.10072|
                  |L1.10050|
002742  b114              CBZ      r4,|L1.10058|
002744  f1a40401          SUB      r4,r4,#1              ;2413
002748  e001              B        |L1.10062|
                  |L1.10058|
00274a  f04f043f          MOV      r4,#0x3f              ;2414
                  |L1.10062|
00274e  42b4              CMP      r4,r6                 ;2415
002750  d122              BNE      |L1.10136|
002752  f04f0500          MOV      r5,#0                 ;2417
002756  e025              B        |L1.10148|
                  |L1.10072|
002758  4669              MOV      r1,sp                 ;2424
00275a  f1050010          ADD      r0,r5,#0x10           ;2424
00275e  f7fffffe          BL       lc640_read_long_ptr
002762  f89d0000          LDRB     r0,[sp,#0]            ;2425
002766  2841              CMP      r0,#0x41              ;2425
002768  d10b              BNE      |L1.10114|
00276a  f89d0001          LDRB     r0,[sp,#1]            ;2425
00276e  2841              CMP      r0,#0x41              ;2425
002770  d107              BNE      |L1.10114|
002772  f89d0002          LDRB     r0,[sp,#2]            ;2425
002776  2841              CMP      r0,#0x41              ;2425
002778  d103              BNE      |L1.10114|
00277a  f89d0003          LDRB     r0,[sp,#3]            ;2425
00277e  2841              CMP      r0,#0x41              ;2425
002780  d00a              BEQ      |L1.10136|
                  |L1.10114|
002782  b114              CBZ      r4,|L1.10122|
002784  f1a40401          SUB      r4,r4,#1              ;2427
002788  e001              B        |L1.10126|
                  |L1.10122|
00278a  f04f043f          MOV      r4,#0x3f              ;2428
                  |L1.10126|
00278e  42b4              CMP      r4,r6                 ;2429
002790  d102              BNE      |L1.10136|
002792  f04f0500          MOV      r5,#0                 ;2431
002796  e005              B        |L1.10148|
                  |L1.10136|
002798  f1070701          ADD      r7,r7,#1              ;2405
00279c  b2ff              UXTB     r7,r7                 ;2405
00279e  2f3f              CMP      r7,#0x3f              ;2405
0027a0  f4ffaea3          BCC      |L1.9450|
                  |L1.10148|
0027a4  2d00              CMP      r5,#0                 ;2438
0027a6  d0c7              BEQ      |L1.10040|
0027a8  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2440
0027ac  f88d0000          STRB     r0,[sp,#0]            ;2440
0027b0  f8980038          LDRB     r0,[r8,#0x38]         ;2441
0027b4  f88d0001          STRB     r0,[sp,#1]            ;2441
0027b8  f898002c          LDRB     r0,[r8,#0x2c]         ;2442
0027bc  f88d0002          STRB     r0,[sp,#2]            ;2442
0027c0  f88d9003          STRB     r9,[sp,#3]            ;2443
0027c4  4669              MOV      r1,sp                 ;2444
0027c6  f1050010          ADD      r0,r5,#0x10           ;2444
0027ca  f7fffffe          BL       lc640_write_long_ptr
0027ce  f8980028          LDRB     r0,[r8,#0x28]         ;2446
0027d2  f88d0000          STRB     r0,[sp,#0]            ;2446
0027d6  f8980024          LDRB     r0,[r8,#0x24]         ;2447
0027da  f88d0001          STRB     r0,[sp,#1]            ;2447
0027de  f8980020          LDRB     r0,[r8,#0x20]         ;2448
0027e2  f88d0002          STRB     r0,[sp,#2]            ;2448
0027e6  f88d9003          STRB     r9,[sp,#3]            ;2449
0027ea  4669              MOV      r1,sp                 ;2450
0027ec  f1050014          ADD      r0,r5,#0x14           ;2450
0027f0  f7fffffe          BL       lc640_write_long_ptr
0027f4  f04f0442          MOV      r4,#0x42              ;2452
0027f8  f88d4000          STRB     r4,[sp,#0]            ;2452
0027fc  f88d4001          STRB     r4,[sp,#1]            ;2453
002800  f88d4002          STRB     r4,[sp,#2]            ;2454
002804  f88d4003          STRB     r4,[sp,#3]            ;2455
002808  4669              MOV      r1,sp                 ;2456
00280a  f1050018          ADD      r0,r5,#0x18           ;2456
00280e  f7fffffe          BL       lc640_write_long_ptr
002812  f88d4000          STRB     r4,[sp,#0]            ;2458
002816  f88d4001          STRB     r4,[sp,#1]            ;2459
00281a  f88d4002          STRB     r4,[sp,#2]            ;2460
00281e  f88d4003          STRB     r4,[sp,#3]            ;2461
002822  4669              MOV      r1,sp                 ;2462
002824  f105001c          ADD      r0,r5,#0x1c           ;2462
002828  f7fffffe          BL       lc640_write_long_ptr
00282c  e41c              B        |L1.8296|
                          ENDP

00282e  0000              DCW      0x0000
                  |L1.10288|
                          DCD      0x40024000

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  ke_mem_hndl PROC
;;;78     //-----------------------------------------------
;;;79     void avar_hndl(void)
000000  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;80     {
;;;81     //static unsigned avar_stat_old;
;;;82     char i;
;;;83     //unsigned avar_stat_new,avar_stat_offed;
;;;84     
;;;85     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  b083              SUB      sp,sp,#0xc
000004  4605              MOV      r5,r0
000006  eb050045          ADD      r0,r5,r5,LSL #1
00000a  4948              LDR      r1,|L2.300|
00000c  eb001005          ADD      r0,r0,r5,LSL #4
000010  eb010180          ADD      r1,r1,r0,LSL #2
;;;86     else	   			SET_REG(avar_stat,0,0,1);
000014  4846              LDR      r0,|L2.304|
000016  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
;;;87     #ifndef UKU_220_IPS_TERMOKOMPENSAT //o_10
;;;88     for(i=0;i<2;i++)
;;;89     	{
;;;90     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
;;;91     	else	   			SET_REG(avar_stat,0,1+i,1);
;;;92     	}
;;;93     #endif //o_10
;;;94     for(i=0;i<18;i++)
00001a  f1000001          ADD      r0,r0,#1
;;;95     	{
;;;96     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00001e  eb010040          ADD      r0,r1,r0,LSL #1
000022  f9b00020          LDRSH    r0,[r0,#0x20]
000026  9001              STR      r0,[sp,#4]
000028  f44f6660          MOV      r6,#0xe00
00002c  4630              MOV      r0,r6
00002e  f7fffffe          BL       lc640_read_int
000032  f1000001          ADD      r0,r0,#1
000036  4604              MOV      r4,r0
000038  2c3f              CMP      r4,#0x3f
00003a  d901              BLS      |L2.64|
00003c  f04f0400          MOV      r4,#0
                  |L2.64|
000040  b221              SXTH     r1,r4
000042  4630              MOV      r0,r6
000044  f7fffffe          BL       lc640_write_int
000048  f6406702          MOV      r7,#0xe02
00004c  4638              MOV      r0,r7
;;;97     	else	   		SET_REG(avar_stat,0,3+i,1);
00004e  f7fffffe          BL       lc640_read_int
000052  283f              CMP      r0,#0x3f
000054  d000              BEQ      |L2.88|
000056  4620              MOV      r0,r4
                  |L2.88|
000058  b201              SXTH     r1,r0
00005a  4638              MOV      r0,r7
00005c  f7fffffe          BL       lc640_write_int
000060  4630              MOV      r0,r6                 ;94
000062  f7fffffe          BL       lc640_read_int
000066  f44f6180          MOV      r1,#0x400             ;94
;;;98     	}
;;;99     
;;;100    /*for(i=0;i<6;i++)
;;;101    	{
;;;102    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
;;;103    	else	   		SET_REG(avar_stat,0,15+i,1);
;;;104    	}*/
;;;105    
;;;106    /*for(i=0;i<4;i++)
;;;107    	{
;;;108    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;109    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;110    	}  */
;;;111    #ifndef UKU_ZVU
;;;112    for(i=0;i<4;i++)
;;;113    	{
;;;114    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
;;;115    	else	   		SET_REG(avar_stat,0,24+i,1);
;;;116    	}
;;;117    #endif //UKU_ZVU
;;;118    #ifndef UKU_FSO
;;;119    for(i=0;i<4;i++)
00006a  eb011440          ADD      r4,r1,r0,LSL #5
;;;120    	{
;;;121    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
00006e  f04f0042          MOV      r0,#0x42
000072  f88d0008          STRB     r0,[sp,#8]
;;;122    	else	   		SET_REG(avar_stat,0,24+i,1);
000076  f88d5009          STRB     r5,[sp,#9]
00007a  f04f004b          MOV      r0,#0x4b
00007e  f88d000a          STRB     r0,[sp,#0xa]
000082  f04f0600          MOV      r6,#0
000086  f88d600b          STRB     r6,[sp,#0xb]          ;119
00008a  a902              ADD      r1,sp,#8              ;119
00008c  4620              MOV      r0,r4                 ;119
;;;123    	}
;;;124    #endif //UKU_FSO
;;;125    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;126    //else	   			SET_REG(avar_stat,0,28,1);
;;;127    
;;;128    
;;;129    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
00008e  f7fffffe          BL       lc640_write_long_ptr
000092  f89d0010          LDRB     r0,[sp,#0x10]
000096  f88d0008          STRB     r0,[sp,#8]
;;;130    
;;;131    avar_ind_stat|=avar_stat_new;
00009a  f89d0011          LDRB     r0,[sp,#0x11]
00009e  f88d0009          STRB     r0,[sp,#9]
;;;132    
;;;133    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
0000a2  f89d0004          LDRB     r0,[sp,#4]
0000a6  f88d000a          STRB     r0,[sp,#0xa]
0000aa  f89d0005          LDRB     r0,[sp,#5]
;;;134    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
0000ae  f88d000b          STRB     r0,[sp,#0xb]
0000b2  a902              ADD      r1,sp,#8
0000b4  1d20              ADDS     r0,r4,#4
0000b6  f7fffffe          BL       lc640_write_long_ptr
;;;135    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
0000ba  f24020a2          MOV      r0,#0x2a2
0000be  f7fffffe          BL       lc640_read_long
0000c2  4d1c              LDR      r5,|L2.308|
;;;136    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
0000c4  6028              STR      r0,[r5,#0]  ; ke_date
0000c6  4629              MOV      r1,r5
0000c8  f1040008          ADD      r0,r4,#8
0000cc  f7fffffe          BL       lc640_write_long_ptr
;;;137    
;;;138    
;;;139    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
0000d0  f24020a6          MOV      r0,#0x2a6
0000d4  f7fffffe          BL       lc640_read_long
0000d8  6068              STR      r0,[r5,#4]  ; ke_date
;;;140    
;;;141    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
0000da  1d29              ADDS     r1,r5,#4
0000dc  f104000c          ADD      r0,r4,#0xc
0000e0  f7fffffe          BL       lc640_write_long_ptr
0000e4  4d14              LDR      r5,|L2.312|
0000e6  8ba8              LDRH     r0,[r5,#0x1c]         ;121
0000e8  f88d0008          STRB     r0,[sp,#8]            ;121
0000ec  7e28              LDRB     r0,[r5,#0x18]         ;121
0000ee  f88d0009          STRB     r0,[sp,#9]            ;121
0000f2  7b28              LDRB     r0,[r5,#0xc]          ;121
0000f4  f88d000a          STRB     r0,[sp,#0xa]          ;121
0000f8  f88d600b          STRB     r6,[sp,#0xb]
0000fc  a902              ADD      r1,sp,#8
0000fe  f1040010          ADD      r0,r4,#0x10
;;;142    
;;;143    avar_ind_stat&=avar_stat_offed; 
000102  f7fffffe          BL       lc640_write_long_ptr
000106  7a28              LDRB     r0,[r5,#8]
000108  f88d0008          STRB     r0,[sp,#8]
;;;144    
;;;145    avar_stat_old=avar_stat;
;;;146    
;;;147    //oleg_start
;;;148    
;;;149    
;;;150    
;;;151    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
00010c  7928              LDRB     r0,[r5,#4]
00010e  f88d0009          STRB     r0,[sp,#9]
000112  7828              LDRB     r0,[r5,#0]
000114  f88d000a          STRB     r0,[sp,#0xa]
000118  f88d600b          STRB     r6,[sp,#0xb]
00011c  a902              ADD      r1,sp,#8
;;;152    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
00011e  f1040014          ADD      r0,r4,#0x14
000122  f7fffffe          BL       lc640_write_long_ptr
;;;153    rki_avar1_ind_stat|=rki_avar1_stat_new;
000126  b005              ADD      sp,sp,#0x14
000128  bdf0              POP      {r4-r7,pc}
;;;154    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
;;;155    rki_avar1_ind_stat&=rki_avar1_stat_offed;
;;;156    rki_avar1_stat_old=rki_avar1_stat;
;;;157    /*
;;;158    rki_avarI1_stat=status_di1;
;;;159    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;160    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;161    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;162    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;163    rki_avarI1_stat_old=rki_avarI1_stat;
;;;164    
;;;165    rki_avarI2_stat=status_di2;
;;;166    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;167    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;168    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;169    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;170    rki_avarI2_stat_old=rki_avarI2_stat;
;;;171    */
;;;172    //oleg_end
;;;173    }
;;;174    
                          ENDP

00012a  0000              DCW      0x0000
                  |L2.300|
                          DCD      bat
                  |L2.304|
                          DCD      bat_u_old_cnt
                  |L2.308|
                          DCD      ke_date
                  |L2.312|
                          DCD      0x40024020

                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  rki_avar1_stat
                          DCD      0x00000000
                  rki_avar1_ind_stat
                          DCD      0x00000000
                  rki_avar1_stat_old
                          DCD      0x00000000
                  rki_avar1_stat_new
                          DCD      0x00000000
                  rki_avar1_stat_offed
                          DCD      0x00000000

                          AREA ||area_number.6||, DATA, ALIGN=0

                          EXPORTAS ||area_number.6||, ||.data||
                  av_inv
                          DCDU     0x00000000
000004  0000              DCB      0x00,0x00
