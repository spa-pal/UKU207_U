; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\avar_hndl.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;56     //-----------------------------------------------
;;;57     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;58     {
;;;59     //static unsigned avar_stat_old;
;;;60     char i;
;;;61     //unsigned avar_stat_new,avar_stat_offed;
;;;62     
;;;63     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48fc              LDR      r0,|L1.1012|
000004  4bfc              LDR      r3,|L1.1016|
000006  7801              LDRB     r1,[r0,#0]  ; net_av
000008  6818              LDR      r0,[r3,#0]
00000a  b119              CBZ      r1,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6018              STR      r0,[r3,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;64     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6018              STR      r0,[r3,#0]  ; avar_stat
                  |L1.26|
;;;65     
;;;66     for(i=0;i<2;i++)
00001a  f04f0000          MOV      r0,#0
;;;67     	{
;;;68     	if(bat[i]._av&1)	SET_REG(avar_stat,1,1+i,1);
00001e  49f7              LDR      r1,|L1.1020|
000020  f04f0401          MOV      r4,#1
                  |L1.36|
000024  eb000240          ADD      r2,r0,r0,LSL #1
000028  eb021200          ADD      r2,r2,r0,LSL #4
00002c  eb010282          ADD      r2,r1,r2,LSL #2
000030  f892203d          LDRB     r2,[r2,#0x3d]
000034  07d2              LSLS     r2,r2,#31
000036  d00a              BEQ      |L1.78|
000038  f1000501          ADD      r5,r0,#1
00003c  fa04f205          LSL      r2,r4,r5
000040  681d              LDR      r5,[r3,#0]  ; avar_stat
000042  ea250502          BIC      r5,r5,r2
000046  ea450502          ORR      r5,r5,r2
00004a  601d              STR      r5,[r3,#0]  ; avar_stat
00004c  e007              B        |L1.94|
                  |L1.78|
;;;69     	else	   		SET_REG(avar_stat,0,1+i,1);
00004e  f1000201          ADD      r2,r0,#1
000052  fa04f502          LSL      r5,r4,r2
000056  681a              LDR      r2,[r3,#0]  ; avar_stat
000058  ea220205          BIC      r2,r2,r5
00005c  601a              STR      r2,[r3,#0]  ; avar_stat
                  |L1.94|
00005e  f1000001          ADD      r0,r0,#1              ;66
000062  b2c0              UXTB     r0,r0                 ;66
000064  2802              CMP      r0,#2                 ;66
000066  d3dd              BCC      |L1.36|
;;;70     	}
;;;71     
;;;72     for(i=0;i<12;i++)
000068  f04f0000          MOV      r0,#0
;;;73     	{
;;;74     	if(bps[i]._av)	SET_REG(avar_stat,1,3+i,1);
00006c  4de4              LDR      r5,|L1.1024|
                  |L1.110|
00006e  ebc002c0          RSB      r2,r0,r0,LSL #3
000072  eb020142          ADD      r1,r2,r2,LSL #1
000076  eb050181          ADD      r1,r5,r1,LSL #2
00007a  7849              LDRB     r1,[r1,#1]
00007c  b151              CBZ      r1,|L1.148|
00007e  f1000203          ADD      r2,r0,#3
000082  fa04f102          LSL      r1,r4,r2
000086  681a              LDR      r2,[r3,#0]  ; avar_stat
000088  ea220201          BIC      r2,r2,r1
00008c  ea420201          ORR      r2,r2,r1
000090  601a              STR      r2,[r3,#0]  ; avar_stat
000092  e007              B        |L1.164|
                  |L1.148|
;;;75     	else	   		SET_REG(avar_stat,0,3+i,1);
000094  f1000103          ADD      r1,r0,#3
000098  fa04f201          LSL      r2,r4,r1
00009c  6819              LDR      r1,[r3,#0]  ; avar_stat
00009e  ea210102          BIC      r1,r1,r2
0000a2  6019              STR      r1,[r3,#0]  ; avar_stat
                  |L1.164|
0000a4  f1000001          ADD      r0,r0,#1              ;72
0000a8  b2c0              UXTB     r0,r0                 ;72
0000aa  280c              CMP      r0,#0xc               ;72
0000ac  d3df              BCC      |L1.110|
;;;76     	}
;;;77     
;;;78     for(i=0;i<6;i++)
0000ae  f04f0000          MOV      r0,#0
;;;79     	{
;;;80     	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
0000b2  4dd1              LDR      r5,|L1.1016|
0000b4  f1050514          ADD      r5,r5,#0x14
                  |L1.184|
0000b8  5c29              LDRB     r1,[r5,r0]
0000ba  b151              CBZ      r1,|L1.210|
0000bc  f100010f          ADD      r1,r0,#0xf
0000c0  fa04f201          LSL      r2,r4,r1
0000c4  6819              LDR      r1,[r3,#0]  ; avar_stat
0000c6  ea210102          BIC      r1,r1,r2
0000ca  ea410102          ORR      r1,r1,r2
0000ce  6019              STR      r1,[r3,#0]  ; avar_stat
0000d0  e007              B        |L1.226|
                  |L1.210|
;;;81     	else	   		SET_REG(avar_stat,0,15+i,1);
0000d2  f100010f          ADD      r1,r0,#0xf
0000d6  681a              LDR      r2,[r3,#0]  ; avar_stat
0000d8  fa04f101          LSL      r1,r4,r1
0000dc  ea220201          BIC      r2,r2,r1
0000e0  601a              STR      r2,[r3,#0]  ; avar_stat
                  |L1.226|
0000e2  f1000001          ADD      r0,r0,#1              ;78
0000e6  b2c0              UXTB     r0,r0                 ;78
0000e8  2806              CMP      r0,#6                 ;78
0000ea  d3e5              BCC      |L1.184|
;;;82     	}
;;;83     
;;;84     /*for(i=0;i<4;i++)
;;;85     	{
;;;86     	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;87     	else	   		SET_REG(avar_stat,0,21+i,1);
;;;88     	}  */
;;;89     for(i=0;i<4;i++)
0000ec  f04f0000          MOV      r0,#0
;;;90     	{
;;;91     	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000f0  49c4              LDR      r1,|L1.1028|
                  |L1.242|
0000f2  5c0a              LDRB     r2,[r1,r0]
0000f4  2a01              CMP      r2,#1
0000f6  d014              BEQ      |L1.290|
;;;92     	else	   		SET_REG(avar_stat,0,24+i,1);
0000f8  f1000218          ADD      r2,r0,#0x18
0000fc  681d              LDR      r5,[r3,#0]  ; avar_stat
0000fe  fa04f202          LSL      r2,r4,r2
000102  ea250502          BIC      r5,r5,r2
000106  601d              STR      r5,[r3,#0]  ; avar_stat
                  |L1.264|
000108  f1000001          ADD      r0,r0,#1              ;89
00010c  b2c0              UXTB     r0,r0                 ;89
00010e  2804              CMP      r0,#4                 ;89
000110  d3ef              BCC      |L1.242|
;;;93     	}
;;;94     
;;;95     if(uout_av)			SET_REG(avar_stat,1,28,1);
000112  48bd              LDR      r0,|L1.1032|
000114  7800              LDRB     r0,[r0,#0]  ; uout_av
000116  b178              CBZ      r0,|L1.312|
000118  6818              LDR      r0,[r3,#0]  ; avar_stat
00011a  f0405080          ORR      r0,r0,#0x10000000
00011e  6018              STR      r0,[r3,#0]  ; avar_stat
000120  e00e              B        |L1.320|
                  |L1.290|
000122  f1000518          ADD      r5,r0,#0x18           ;91
000126  fa04f205          LSL      r2,r4,r5              ;91
00012a  681d              LDR      r5,[r3,#0]            ;91  ; avar_stat
00012c  ea250502          BIC      r5,r5,r2              ;91
000130  ea450502          ORR      r5,r5,r2              ;91
000134  601d              STR      r5,[r3,#0]            ;91  ; avar_stat
000136  e7e7              B        |L1.264|
                  |L1.312|
;;;96     else	   			SET_REG(avar_stat,0,28,1);
000138  6818              LDR      r0,[r3,#0]  ; avar_stat
00013a  f0205080          BIC      r0,r0,#0x10000000
00013e  6018              STR      r0,[r3,#0]  ; avar_stat
                  |L1.320|
;;;97     
;;;98     
;;;99     avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000140  689c              LDR      r4,[r3,#8]  ; avar_stat_old
000142  6818              LDR      r0,[r3,#0]  ; avar_stat
000144  ea200104          BIC      r1,r0,r4
000148  60d9              STR      r1,[r3,#0xc]  ; avar_stat_new
;;;100    
;;;101    avar_ind_stat|=avar_stat_new;
00014a  685a              LDR      r2,[r3,#4]  ; avar_ind_stat
00014c  ea420201          ORR      r2,r2,r1
000150  605a              STR      r2,[r3,#4]  ; avar_ind_stat
;;;102    
;;;103    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000152  49ae              LDR      r1,|L1.1036|
000154  880d              LDRH     r5,[r1,#0]  ; SK_ZVUK_EN
000156  b115              CBZ      r5,|L1.350|
000158  f0227280          BIC      r2,r2,#0x1000000
00015c  605a              STR      r2,[r3,#4]  ; avar_ind_stat
                  |L1.350|
;;;104    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
00015e  884a              LDRH     r2,[r1,#2]  ; SK_ZVUK_EN
000160  b11a              CBZ      r2,|L1.362|
000162  685a              LDR      r2,[r3,#4]  ; avar_ind_stat
000164  f0227200          BIC      r2,r2,#0x2000000
000168  605a              STR      r2,[r3,#4]  ; avar_ind_stat
                  |L1.362|
;;;105    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
00016a  888a              LDRH     r2,[r1,#4]  ; SK_ZVUK_EN
00016c  b11a              CBZ      r2,|L1.374|
00016e  685a              LDR      r2,[r3,#4]  ; avar_ind_stat
000170  f0226280          BIC      r2,r2,#0x4000000
000174  605a              STR      r2,[r3,#4]  ; avar_ind_stat
                  |L1.374|
;;;106    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
000176  88c9              LDRH     r1,[r1,#6]  ; SK_ZVUK_EN
000178  b119              CBZ      r1,|L1.386|
00017a  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
00017c  f0216100          BIC      r1,r1,#0x8000000
000180  6059              STR      r1,[r3,#4]  ; avar_ind_stat
                  |L1.386|
;;;107    
;;;108    
;;;109    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
000182  ea240400          BIC      r4,r4,r0
000186  ea6f0104          MVN      r1,r4
00018a  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
;;;110    
;;;111    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
00018c  4aa0              LDR      r2,|L1.1040|
00018e  8812              LDRH     r2,[r2,#0]  ; AV_OFF_AVT
000190  b91a              CBNZ     r2,|L1.410|
000192  4aa0              LDR      r2,|L1.1044|
000194  ea410102          ORR      r1,r1,r2
000198  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
                  |L1.410|
;;;112    
;;;113    avar_ind_stat&=avar_stat_offed; 
00019a  691a              LDR      r2,[r3,#0x10]  ; avar_stat_offed
00019c  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
00019e  ea010102          AND      r1,r1,r2
0001a2  6059              STR      r1,[r3,#4]  ; avar_ind_stat
;;;114    
;;;115    avar_stat_old=avar_stat;
0001a4  6098              STR      r0,[r3,#8]  ; avar_stat_old
;;;116    }
0001a6  bd30              POP      {r4,r5,pc}
;;;117    
                          ENDP

                  reload_hndl PROC
;;;118    //-----------------------------------------------
;;;119    void reload_hndl(void)
0001a8  b5f8              PUSH     {r3-r7,lr}
;;;120    {
;;;121    char data[4];
;;;122    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;123    
;;;124    event_ptr=lc640_read_int(PTR_EVENT_LOG);
0001aa  f44f6560          MOV      r5,#0xe00
0001ae  4628              MOV      r0,r5
0001b0  f7fffffe          BL       lc640_read_int
;;;125    event_ptr++;	
0001b4  f1000001          ADD      r0,r0,#1
0001b8  4604              MOV      r4,r0
;;;126    if(event_ptr>63)event_ptr=0;	
0001ba  2c3f              CMP      r4,#0x3f
0001bc  d901              BLS      |L1.450|
0001be  f04f0400          MOV      r4,#0
                  |L1.450|
;;;127    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
0001c2  b221              SXTH     r1,r4
0001c4  4628              MOV      r0,r5
0001c6  f7fffffe          BL       lc640_write_int
;;;128    	
;;;129    event_cnt=lc640_read_int(CNT_EVENT_LOG);
0001ca  f6406602          MOV      r6,#0xe02
0001ce  4630              MOV      r0,r6
0001d0  f7fffffe          BL       lc640_read_int
;;;130    if(event_cnt!=63)event_cnt=event_ptr;
0001d4  283f              CMP      r0,#0x3f
0001d6  d000              BEQ      |L1.474|
0001d8  4620              MOV      r0,r4
                  |L1.474|
;;;131    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
0001da  b201              SXTH     r1,r0
0001dc  4630              MOV      r0,r6
0001de  f7fffffe          BL       lc640_write_int
;;;132    	
;;;133    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
0001e2  4628              MOV      r0,r5
0001e4  f7fffffe          BL       lc640_read_int
0001e8  f44f6180          MOV      r1,#0x400
0001ec  eb011440          ADD      r4,r1,r0,LSL #5
;;;134    	
;;;135    data[0]='U';
0001f0  f04f0055          MOV      r0,#0x55
0001f4  f88d0000          STRB     r0,[sp,#0]
;;;136    data[1]=0;
0001f8  f04f0600          MOV      r6,#0
0001fc  f88d6001          STRB     r6,[sp,#1]
;;;137    data[2]='R';
000200  f04f0052          MOV      r0,#0x52
000204  f88d0002          STRB     r0,[sp,#2]
;;;138    data[3]=0;
000208  f88d6003          STRB     r6,[sp,#3]
;;;139    lc640_write_long_ptr(lc640_adr,data);
00020c  4669              MOV      r1,sp
00020e  4620              MOV      r0,r4
000210  f7fffffe          BL       lc640_write_long_ptr
;;;140    
;;;141    data[0]=0;
;;;142    data[1]=0;
;;;143    data[2]=0;
;;;144    data[3]=0;
000214  9600              STR      r6,[sp,#0]
;;;145    lc640_write_long_ptr(lc640_adr+4,data);
000216  4669              MOV      r1,sp
000218  1d20              ADDS     r0,r4,#4
00021a  f7fffffe          BL       lc640_write_long_ptr
;;;146    
;;;147    data[0]=LPC_RTC->YEAR;
00021e  4d7e              LDR      r5,|L1.1048|
000220  8ba8              LDRH     r0,[r5,#0x1c]
000222  f88d0000          STRB     r0,[sp,#0]
;;;148    data[1]=LPC_RTC->MONTH;
000226  7e28              LDRB     r0,[r5,#0x18]
000228  f88d0001          STRB     r0,[sp,#1]
;;;149    data[2]=LPC_RTC->DOM;
00022c  7b28              LDRB     r0,[r5,#0xc]
00022e  f88d0002          STRB     r0,[sp,#2]
;;;150    data[3]=0;
000232  f88d6003          STRB     r6,[sp,#3]
;;;151    lc640_write_long_ptr(lc640_adr+8,data);
000236  4669              MOV      r1,sp
000238  f1040008          ADD      r0,r4,#8
00023c  f7fffffe          BL       lc640_write_long_ptr
;;;152    
;;;153    data[0]=LPC_RTC->HOUR;
000240  7a28              LDRB     r0,[r5,#8]
000242  f88d0000          STRB     r0,[sp,#0]
;;;154    data[1]=LPC_RTC->MIN;
000246  7928              LDRB     r0,[r5,#4]
000248  f88d0001          STRB     r0,[sp,#1]
;;;155    data[2]=LPC_RTC->SEC;
00024c  7828              LDRB     r0,[r5,#0]
00024e  f88d0002          STRB     r0,[sp,#2]
;;;156    data[3]=LPC_SC->RSID;
000252  4872              LDR      r0,|L1.1052|
000254  f8d00180          LDR      r0,[r0,#0x180]
000258  f88d0003          STRB     r0,[sp,#3]
;;;157    
;;;158    lc640_write_long_ptr(lc640_adr+12,data);
00025c  4669              MOV      r1,sp
00025e  f104000c          ADD      r0,r4,#0xc
000262  f7fffffe          BL       lc640_write_long_ptr
;;;159    	
;;;160    data[0]='A';
000266  f04f0541          MOV      r5,#0x41
00026a  f88d5000          STRB     r5,[sp,#0]
;;;161    data[1]='A';
00026e  f88d5001          STRB     r5,[sp,#1]
;;;162    data[2]='A';
000272  f88d5002          STRB     r5,[sp,#2]
;;;163    data[3]='A';
000276  f88d5003          STRB     r5,[sp,#3]
;;;164    lc640_write_long_ptr(lc640_adr+16,data);
00027a  4669              MOV      r1,sp
00027c  f1040010          ADD      r0,r4,#0x10
000280  f7fffffe          BL       lc640_write_long_ptr
;;;165    	
;;;166    data[0]='A';
000284  f88d5000          STRB     r5,[sp,#0]
;;;167    data[1]='A';
000288  f88d5001          STRB     r5,[sp,#1]
;;;168    data[2]='A';
00028c  f88d5002          STRB     r5,[sp,#2]
;;;169    data[3]='A';
000290  f88d5003          STRB     r5,[sp,#3]
;;;170    lc640_write_long_ptr(lc640_adr+20,data);
000294  4669              MOV      r1,sp
000296  f1040014          ADD      r0,r4,#0x14
00029a  f7fffffe          BL       lc640_write_long_ptr
;;;171    	
;;;172    data[0]='A';
00029e  f88d5000          STRB     r5,[sp,#0]
;;;173    data[1]='A';
0002a2  f88d5001          STRB     r5,[sp,#1]
;;;174    data[2]='A';
0002a6  f88d5002          STRB     r5,[sp,#2]
;;;175    data[3]='A';
0002aa  f88d5003          STRB     r5,[sp,#3]
;;;176    lc640_write_long_ptr(lc640_adr+24,data);
0002ae  4669              MOV      r1,sp
0002b0  f1040018          ADD      r0,r4,#0x18
0002b4  f7fffffe          BL       lc640_write_long_ptr
;;;177    	
;;;178    data[0]='A';
0002b8  f88d5000          STRB     r5,[sp,#0]
;;;179    data[1]='A';
0002bc  f88d5001          STRB     r5,[sp,#1]
;;;180    data[2]='A';
0002c0  f88d5002          STRB     r5,[sp,#2]
;;;181    data[3]='A';
0002c4  f88d5003          STRB     r5,[sp,#3]
;;;182    lc640_write_long_ptr(lc640_adr+28,data);				
0002c8  4669              MOV      r1,sp
0002ca  f104001c          ADD      r0,r4,#0x1c
0002ce  f7fffffe          BL       lc640_write_long_ptr
;;;183    	
;;;184    	
;;;185    }
0002d2  bdf8              POP      {r3-r7,pc}
;;;186    
                          ENDP

                  avar_unet_hndl PROC
;;;187    //-----------------------------------------------
;;;188    void avar_unet_hndl(char in)
0002d4  e92d43f8          PUSH     {r3-r9,lr}
;;;189    {
;;;190    
;;;191    char data[4];
;;;192    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;193    
;;;194    
;;;195    if(in==1)
;;;196    	{
;;;197    	net_av=1;
;;;198    
;;;199    	//beep_init(0x01L,'O');
;;;200    	//a.av.bAN=1;
;;;201    
;;;202    
;;;203    	//beep_init(0x33333333,'A');
;;;204    	 
;;;205    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;206    	event_ptr++;	
;;;207    	if(event_ptr>63)event_ptr=0;	
;;;208    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;209    	
;;;210         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;211    	if(event_cnt!=63)event_cnt=event_ptr;
;;;212    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;213    	
;;;214    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;215    	
;;;216    	data[0]='P';
;;;217    	data[1]=0;
;;;218    	data[2]='A';
;;;219    	data[3]=0;
;;;220    	lc640_write_long_ptr(lc640_adr,data);
;;;221    
;;;222    	data[0]=0;//*((char*)&Unet_store);
;;;223    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;224    	data[2]=0;
;;;225    	data[3]=0;
;;;226    	lc640_write_long_ptr(lc640_adr+4,data);
;;;227    
;;;228    	data[0]=LPC_RTC->YEAR;
0002d8  4f4f              LDR      r7,|L1.1048|
0002da  4946              LDR      r1,|L1.1012|
0002dc  3f20              SUBS     r7,r7,#0x20
0002de  f44f6560          MOV      r5,#0xe00             ;205
0002e2  f04f0800          MOV      r8,#0                 ;207
0002e6  f44f6980          MOV      r9,#0x400             ;214
0002ea  2801              CMP      r0,#1                 ;195
0002ec  d002              BEQ      |L1.756|
;;;229    	data[1]=LPC_RTC->MONTH;
;;;230    	data[2]=LPC_RTC->DOM;
;;;231    	data[3]=0;
;;;232    	lc640_write_long_ptr(lc640_adr+8,data);
;;;233    
;;;234    	data[0]=LPC_RTC->HOUR;
;;;235    	data[1]=LPC_RTC->MIN;
;;;236    	data[2]=LPC_RTC->SEC;
;;;237    	data[3]=0;
;;;238    	lc640_write_long_ptr(lc640_adr+12,data);
;;;239    	
;;;240    	data[0]='A';
;;;241    	data[1]='A';
;;;242    	data[2]='A';
;;;243    	data[3]='A';
;;;244    	lc640_write_long_ptr(lc640_adr+16,data);
;;;245    	
;;;246    	data[0]='A';
;;;247    	data[1]='A';
;;;248    	data[2]='A';
;;;249    	data[3]='A';
;;;250    	lc640_write_long_ptr(lc640_adr+20,data);
;;;251    	
;;;252    	data[0]='A';
;;;253    	data[1]='A';
;;;254    	data[2]='A';
;;;255    	data[3]='A';
;;;256    	lc640_write_long_ptr(lc640_adr+24,data);
;;;257    	
;;;258    	data[0]='A';
;;;259    	data[1]='A';
;;;260    	data[2]='A';
;;;261    	data[3]='A';
;;;262    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;263    	
;;;264    /*	memo_out0[0]=0x55;
;;;265         memo_out0[1]=0x00+2;
;;;266         memo_out0[2]=1;
;;;267         memo_out0[3]=0x0b;
;;;268         memo_out0[4]=0x55;
;;;269         memo_out0[5]=0x55; 
;;;270         	
;;;271         memo_out0[6]=crc_87(memo_out0,6);
;;;272    	memo_out0[7]=crc_95(memo_out0,6);
;;;273         usart_out_adr0(memo_out0,8); 
;;;274    	*/
;;;275    	snmp_trap_send("Main power is off",2,1,0);
;;;276    	}
;;;277    
;;;278    else if(in==0)
0002ee  2800              CMP      r0,#0
0002f0  d07e              BEQ      |L1.1008|
0002f2  e13f              B        |L1.1396|
                  |L1.756|
0002f4  f04f0001          MOV      r0,#1                 ;197
0002f8  7008              STRB     r0,[r1,#0]            ;197
0002fa  4628              MOV      r0,r5                 ;205
0002fc  f7fffffe          BL       lc640_read_int
000300  f1000001          ADD      r0,r0,#1              ;206
000304  4604              MOV      r4,r0                 ;206
000306  2c3f              CMP      r4,#0x3f              ;207
000308  d901              BLS      |L1.782|
00030a  f04f0400          MOV      r4,#0                 ;207
                  |L1.782|
00030e  b221              SXTH     r1,r4                 ;208
000310  4628              MOV      r0,r5                 ;208
000312  f7fffffe          BL       lc640_write_int
000316  f6406602          MOV      r6,#0xe02             ;210
00031a  4630              MOV      r0,r6                 ;210
00031c  f7fffffe          BL       lc640_read_int
000320  283f              CMP      r0,#0x3f              ;211
000322  d000              BEQ      |L1.806|
000324  4620              MOV      r0,r4                 ;211
                  |L1.806|
000326  b201              SXTH     r1,r0                 ;212
000328  4630              MOV      r0,r6                 ;212
00032a  f7fffffe          BL       lc640_write_int
00032e  4628              MOV      r0,r5                 ;214
000330  f7fffffe          BL       lc640_read_int
000334  eb091540          ADD      r5,r9,r0,LSL #5       ;214
000338  f04f0050          MOV      r0,#0x50              ;216
00033c  f88d0000          STRB     r0,[sp,#0]            ;216
000340  f88d8001          STRB     r8,[sp,#1]            ;217
000344  f04f0441          MOV      r4,#0x41              ;218
000348  f88d4002          STRB     r4,[sp,#2]            ;218
00034c  f88d8003          STRB     r8,[sp,#3]            ;219
000350  4669              MOV      r1,sp                 ;220
000352  4628              MOV      r0,r5                 ;220
000354  f7fffffe          BL       lc640_write_long_ptr
000358  f8cd8000          STR      r8,[sp,#0]            ;225
00035c  4669              MOV      r1,sp                 ;226
00035e  1d28              ADDS     r0,r5,#4              ;226
000360  f7fffffe          BL       lc640_write_long_ptr
000364  f1070720          ADD      r7,r7,#0x20           ;228
000368  8bb8              LDRH     r0,[r7,#0x1c]         ;228
00036a  f88d0000          STRB     r0,[sp,#0]            ;228
00036e  7e38              LDRB     r0,[r7,#0x18]         ;229
000370  f88d0001          STRB     r0,[sp,#1]            ;229
000374  7b38              LDRB     r0,[r7,#0xc]          ;230
000376  f88d0002          STRB     r0,[sp,#2]            ;230
00037a  f88d8003          STRB     r8,[sp,#3]            ;231
00037e  4669              MOV      r1,sp                 ;232
000380  f1050008          ADD      r0,r5,#8              ;232
000384  f7fffffe          BL       lc640_write_long_ptr
000388  7a38              LDRB     r0,[r7,#8]            ;234
00038a  f88d0000          STRB     r0,[sp,#0]            ;234
00038e  7938              LDRB     r0,[r7,#4]            ;235
000390  f88d0001          STRB     r0,[sp,#1]            ;235
000394  7838              LDRB     r0,[r7,#0]            ;236
000396  f88d0002          STRB     r0,[sp,#2]            ;236
00039a  f88d8003          STRB     r8,[sp,#3]            ;237
00039e  4669              MOV      r1,sp                 ;238
0003a0  f105000c          ADD      r0,r5,#0xc            ;238
0003a4  f7fffffe          BL       lc640_write_long_ptr
0003a8  f88d4000          STRB     r4,[sp,#0]            ;240
0003ac  f88d4001          STRB     r4,[sp,#1]            ;241
0003b0  f88d4002          STRB     r4,[sp,#2]            ;242
0003b4  f88d4003          STRB     r4,[sp,#3]            ;243
0003b8  4669              MOV      r1,sp                 ;244
0003ba  f1050010          ADD      r0,r5,#0x10           ;244
0003be  f7fffffe          BL       lc640_write_long_ptr
0003c2  f88d4000          STRB     r4,[sp,#0]            ;246
0003c6  f88d4001          STRB     r4,[sp,#1]            ;247
0003ca  f88d4002          STRB     r4,[sp,#2]            ;248
0003ce  f88d4003          STRB     r4,[sp,#3]            ;249
0003d2  4669              MOV      r1,sp                 ;250
0003d4  f1050014          ADD      r0,r5,#0x14           ;250
0003d8  f7fffffe          BL       lc640_write_long_ptr
0003dc  f88d4000          STRB     r4,[sp,#0]            ;252
0003e0  f88d4001          STRB     r4,[sp,#1]            ;253
0003e4  f88d4002          STRB     r4,[sp,#2]            ;254
0003e8  f88d4003          STRB     r4,[sp,#3]            ;255
0003ec  4669              MOV      r1,sp                 ;256
0003ee  e017              B        |L1.1056|
                  |L1.1008|
0003f0  e02e              B        |L1.1104|
0003f2  0000              DCW      0x0000
                  |L1.1012|
                          DCD      net_av
                  |L1.1016|
                          DCD      ||.data||
                  |L1.1020|
                          DCD      bat
                  |L1.1024|
                          DCD      bps
                  |L1.1028|
                          DCD      sk_av_stat
                  |L1.1032|
                          DCD      uout_av
                  |L1.1036|
                          DCD      SK_ZVUK_EN
                  |L1.1040|
                          DCD      AV_OFF_AVT
                  |L1.1044|
                          DCD      0xeffffffe
                  |L1.1048|
                          DCD      0x40024020
                  |L1.1052|
                          DCD      0x400fc000
                  |L1.1056|
000420  f1050018          ADD      r0,r5,#0x18           ;256
000424  f7fffffe          BL       lc640_write_long_ptr
000428  f88d4000          STRB     r4,[sp,#0]            ;258
00042c  f88d4001          STRB     r4,[sp,#1]            ;259
000430  f88d4002          STRB     r4,[sp,#2]            ;260
000434  f88d4003          STRB     r4,[sp,#3]            ;261
000438  4669              MOV      r1,sp                 ;262
00043a  f105001c          ADD      r0,r5,#0x1c           ;262
00043e  f7fffffe          BL       lc640_write_long_ptr
000442  2300              MOVS     r3,#0                 ;275
000444  2201              MOVS     r2,#1                 ;275
000446  2102              MOVS     r1,#2                 ;275
000448  a0f9              ADR      r0,|L1.2096|
00044a  f7fffffe          BL       snmp_trap_send
00044e  e091              B        |L1.1396|
                  |L1.1104|
;;;279    	{
;;;280    	net_av=0;
000450  f8818000          STRB     r8,[r1,#0]
;;;281    
;;;282      /*
;;;283    	SET_REG(C2GSR,3,24,8);
;;;284    	C2MOD=0;
;;;285    	bOUT_FREE2=1;*/
;;;286    
;;;287    
;;;288    	//C2MOD=0;
;;;289    
;;;290    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;291    
;;;292         //beep_init(0x02L,'O');
;;;293    	//a_.av.bAN=0;
;;;294    	SET_REG(avar_stat,0,0,1);
000454  48fb              LDR      r0,|L1.2116|
000456  6801              LDR      r1,[r0,#0]  ; avar_stat
000458  f0210101          BIC      r1,r1,#1
00045c  6001              STR      r1,[r0,#0]  ; avar_stat
;;;295    
;;;296    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;297    	
;;;298    	if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
00045e  49fa              LDR      r1,|L1.2120|
000460  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
000462  b119              CBZ      r1,|L1.1132|
000464  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
000466  f0210101          BIC      r1,r1,#1
00046a  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.1132|
;;;299    
;;;300         event_ptr=lc640_read_int(PTR_EVENT_LOG);
00046c  4628              MOV      r0,r5
00046e  f7fffffe          BL       lc640_read_int
000472  4606              MOV      r6,r0
;;;301    	event_ptr_find=event_ptr;
000474  4634              MOV      r4,r6
                  |L1.1142|
;;;302    avar_unet_hndl_lbl1:
;;;303    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000476  eb091544          ADD      r5,r9,r4,LSL #5
;;;304    
;;;305         lc640_read_long_ptr(lc640_adr,data);
00047a  4669              MOV      r1,sp
00047c  4628              MOV      r0,r5
00047e  f7fffffe          BL       lc640_read_long_ptr
;;;306         
;;;307         if(!((data[0]=='P')&&(data[1]==0)&&(data[2]=='A')))
000482  f89d0000          LDRB     r0,[sp,#0]
000486  2850              CMP      r0,#0x50
000488  d106              BNE      |L1.1176|
00048a  f89d0001          LDRB     r0,[sp,#1]
00048e  b918              CBNZ     r0,|L1.1176|
000490  f89d0002          LDRB     r0,[sp,#2]
000494  2841              CMP      r0,#0x41
000496  d008              BEQ      |L1.1194|
                  |L1.1176|
;;;308         	{        
;;;309         	if(event_ptr_find)event_ptr_find--;
000498  b114              CBZ      r4,|L1.1184|
00049a  f1a40401          SUB      r4,r4,#1
00049e  e001              B        |L1.1188|
                  |L1.1184|
;;;310         	else event_ptr_find=63;
0004a0  f04f043f          MOV      r4,#0x3f
                  |L1.1188|
;;;311         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0004a4  42b4              CMP      r4,r6
0004a6  d1e6              BNE      |L1.1142|
0004a8  e064              B        |L1.1396|
                  |L1.1194|
;;;312         	else goto avar_unet_hndl_lbl1;
;;;313         	}
;;;314         else 
;;;315         	{
;;;316         	lc640_read_long_ptr(lc640_adr+16,data);
0004aa  4669              MOV      r1,sp
0004ac  f1050010          ADD      r0,r5,#0x10
0004b0  f7fffffe          BL       lc640_read_long_ptr
;;;317         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0004b4  f89d0000          LDRB     r0,[sp,#0]
0004b8  2841              CMP      r0,#0x41
0004ba  d10b              BNE      |L1.1236|
0004bc  f89d0001          LDRB     r0,[sp,#1]
0004c0  2841              CMP      r0,#0x41
0004c2  d107              BNE      |L1.1236|
0004c4  f89d0002          LDRB     r0,[sp,#2]
0004c8  2841              CMP      r0,#0x41
0004ca  d103              BNE      |L1.1236|
0004cc  f89d0003          LDRB     r0,[sp,#3]
0004d0  2841              CMP      r0,#0x41
0004d2  d008              BEQ      |L1.1254|
                  |L1.1236|
;;;318         		{        
;;;319         		if(event_ptr_find)event_ptr_find--;
0004d4  b114              CBZ      r4,|L1.1244|
0004d6  f1a40401          SUB      r4,r4,#1
0004da  e001              B        |L1.1248|
                  |L1.1244|
;;;320             		else event_ptr_find=63;
0004dc  f04f043f          MOV      r4,#0x3f
                  |L1.1248|
;;;321             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0004e0  42b4              CMP      r4,r6
0004e2  d1c8              BNE      |L1.1142|
0004e4  e046              B        |L1.1396|
                  |L1.1254|
;;;322         		else goto avar_unet_hndl_lbl1;
;;;323         		}
;;;324    
;;;325         	}	
;;;326    	
;;;327    	data[0]=LPC_RTC->YEAR;
0004e6  f1070720          ADD      r7,r7,#0x20
0004ea  8bb8              LDRH     r0,[r7,#0x1c]
0004ec  f88d0000          STRB     r0,[sp,#0]
;;;328    	data[1]=LPC_RTC->MONTH;
0004f0  7e38              LDRB     r0,[r7,#0x18]
0004f2  f88d0001          STRB     r0,[sp,#1]
;;;329    	data[2]=LPC_RTC->DOM;
0004f6  7b38              LDRB     r0,[r7,#0xc]
0004f8  f88d0002          STRB     r0,[sp,#2]
;;;330    	data[3]=0;
0004fc  f88d8003          STRB     r8,[sp,#3]
;;;331    	lc640_write_long_ptr(lc640_adr+16,data);
000500  4669              MOV      r1,sp
000502  f1050010          ADD      r0,r5,#0x10
000506  f7fffffe          BL       lc640_write_long_ptr
;;;332    
;;;333    	data[0]=LPC_RTC->HOUR;
00050a  7a38              LDRB     r0,[r7,#8]
00050c  f88d0000          STRB     r0,[sp,#0]
;;;334    	data[1]=LPC_RTC->MIN;
000510  7938              LDRB     r0,[r7,#4]
000512  f88d0001          STRB     r0,[sp,#1]
;;;335    	data[2]=LPC_RTC->SEC;
000516  7838              LDRB     r0,[r7,#0]
000518  f88d0002          STRB     r0,[sp,#2]
;;;336    	data[3]=0;
00051c  f88d8003          STRB     r8,[sp,#3]
;;;337    	lc640_write_long_ptr(lc640_adr+20,data); 
000520  4669              MOV      r1,sp
000522  f1050014          ADD      r0,r5,#0x14
000526  f7fffffe          BL       lc640_write_long_ptr
;;;338    	
;;;339    	data[0]=*((char*)(&net_Ustore));
00052a  48c8              LDR      r0,|L1.2124|
00052c  7801              LDRB     r1,[r0,#0]  ; net_Ustore
00052e  f88d1000          STRB     r1,[sp,#0]
;;;340    	data[1]=*(((char*)(&net_Ustore))+1);
000532  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000534  f88d0001          STRB     r0,[sp,#1]
;;;341    	data[2]='B';
000538  f04f0442          MOV      r4,#0x42
00053c  f88d4002          STRB     r4,[sp,#2]
;;;342    	data[3]='B';
000540  f88d4003          STRB     r4,[sp,#3]
;;;343    	lc640_write_long_ptr(lc640_adr+24,data);
000544  4669              MOV      r1,sp
000546  f1050018          ADD      r0,r5,#0x18
00054a  f7fffffe          BL       lc640_write_long_ptr
;;;344    	
;;;345    	data[0]='B';
00054e  f88d4000          STRB     r4,[sp,#0]
;;;346    	data[1]='B';
000552  f88d4001          STRB     r4,[sp,#1]
;;;347    	data[2]='B';
000556  f88d4002          STRB     r4,[sp,#2]
;;;348    	data[3]='B';
00055a  f88d4003          STRB     r4,[sp,#3]
;;;349    	lc640_write_long_ptr(lc640_adr+28,data);	
00055e  4669              MOV      r1,sp
000560  f105001c          ADD      r0,r5,#0x1c
000564  f7fffffe          BL       lc640_write_long_ptr
;;;350    	
;;;351    /*	memo_out0[0]=0x55;
;;;352         memo_out0[1]=0x00+2;
;;;353         memo_out0[2]=1;
;;;354         memo_out0[3]=0x0b;
;;;355         memo_out0[4]=0xaa;
;;;356         memo_out0[5]=0xaa; 
;;;357         	
;;;358         memo_out0[6]=crc_87(memo_out0,6);
;;;359    	memo_out0[7]=crc_95(memo_out0,6);
;;;360         usart_out_adr0(memo_out0,8); */
;;;361         snmp_trap_send("Main power is on",2,1,1);	
000568  2301              MOVS     r3,#1
00056a  461a              MOV      r2,r3
00056c  2102              MOVS     r1,#2
00056e  a0b8              ADR      r0,|L1.2128|
000570  f7fffffe          BL       snmp_trap_send
                  |L1.1396|
;;;362    	}
;;;363    avar_unet_hndl_end:
;;;364    	__nop();		
000574  bf00              NOP      
                  |L1.1398|
;;;365    }
000576  e8bd83f8          POP      {r3-r9,pc}
;;;366    
                          ENDP

                  avar_uout_hndl PROC
;;;368    //-----------------------------------------------
;;;369    void avar_uout_hndl(char in)
00057a  e92d43f8          PUSH     {r3-r9,lr}
;;;370    {
;;;371    
;;;372    char data[4];
;;;373    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;374    
;;;375    
;;;376    if(in==1)
;;;377    	{
;;;378    	//net_av=1;
;;;379    
;;;380    	//beep_init(0x01L,'O');
;;;381    	//a.av.bAN=1;
;;;382    
;;;383    
;;;384    	//beep_init(0x33333333,'A');
;;;385    
;;;386    	uout_av=1;
00057e  49b9              LDR      r1,|L1.2148|
;;;387    	 
;;;388    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;389    	event_ptr++;	
;;;390    	if(event_ptr>63)event_ptr=0;	
;;;391    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;392    	
;;;393        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;394    	if(event_cnt!=63)event_cnt=event_ptr;
;;;395    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;396    	
;;;397    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;398    	
;;;399    	data[0]='Q';
;;;400    	data[1]=0;
;;;401    	data[2]='A';
;;;402    	data[3]=0;
;;;403    	lc640_write_long_ptr(lc640_adr,data);
;;;404    
;;;405    	data[0]=0;//*((char*)&Unet_store);
;;;406    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;407    	data[2]=0;
;;;408    	data[3]=0;
;;;409    	lc640_write_long_ptr(lc640_adr+4,data);
;;;410    
;;;411    	data[0]=LPC_RTC->YEAR;
000580  4fb9              LDR      r7,|L1.2152|
000582  f44f6560          MOV      r5,#0xe00             ;388
000586  f04f0800          MOV      r8,#0                 ;390
00058a  f44f6980          MOV      r9,#0x400             ;397
00058e  2801              CMP      r0,#1                 ;376
000590  d002              BEQ      |L1.1432|
;;;412    	data[1]=LPC_RTC->MONTH;
;;;413    	data[2]=LPC_RTC->DOM;
;;;414    	data[3]=0;
;;;415    	lc640_write_long_ptr(lc640_adr+8,data);
;;;416    
;;;417    	data[0]=LPC_RTC->HOUR;
;;;418    	data[1]=LPC_RTC->MIN;
;;;419    	data[2]=LPC_RTC->SEC;
;;;420    	data[3]=0;
;;;421    	lc640_write_long_ptr(lc640_adr+12,data);
;;;422    	
;;;423    	data[0]='A';
;;;424    	data[1]='A';
;;;425    	data[2]='A';
;;;426    	data[3]='A';
;;;427    	lc640_write_long_ptr(lc640_adr+16,data);
;;;428    	
;;;429    	data[0]='A';
;;;430    	data[1]='A';
;;;431    	data[2]='A';
;;;432    	data[3]='A';
;;;433    	lc640_write_long_ptr(lc640_adr+20,data);
;;;434    	
;;;435    	data[0]='A';
;;;436    	data[1]='A';
;;;437    	data[2]='A';
;;;438    	data[3]='A';
;;;439    	lc640_write_long_ptr(lc640_adr+24,data);
;;;440    	
;;;441    	data[0]='A';
;;;442    	data[1]='A';
;;;443    	data[2]='A';
;;;444    	data[3]='A';
;;;445    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;446    	
;;;447    /*	memo_out0[0]=0x55;
;;;448         memo_out0[1]=0x00+2;
;;;449         memo_out0[2]=1;
;;;450         memo_out0[3]=0x0b;
;;;451         memo_out0[4]=0x55;
;;;452         memo_out0[5]=0x55; 
;;;453         	
;;;454         memo_out0[6]=crc_87(memo_out0,6);
;;;455    	memo_out0[7]=crc_95(memo_out0,6);
;;;456         usart_out_adr0(memo_out0,8); 
;;;457    	*/
;;;458    	//snmp_trap_send("Main power is off",2,1,0);
;;;459    	}
;;;460    
;;;461    else if(in==0)
000592  2800              CMP      r0,#0
000594  d07e              BEQ      |L1.1684|
000596  e116              B        |L1.1990|
                  |L1.1432|
000598  f04f0001          MOV      r0,#1                 ;386
00059c  7008              STRB     r0,[r1,#0]            ;386
00059e  4628              MOV      r0,r5                 ;388
0005a0  f7fffffe          BL       lc640_read_int
0005a4  f1000001          ADD      r0,r0,#1              ;389
0005a8  4604              MOV      r4,r0                 ;389
0005aa  2c3f              CMP      r4,#0x3f              ;390
0005ac  d901              BLS      |L1.1458|
0005ae  f04f0400          MOV      r4,#0                 ;390
                  |L1.1458|
0005b2  b221              SXTH     r1,r4                 ;391
0005b4  4628              MOV      r0,r5                 ;391
0005b6  f7fffffe          BL       lc640_write_int
0005ba  f6406602          MOV      r6,#0xe02             ;393
0005be  4630              MOV      r0,r6                 ;393
0005c0  f7fffffe          BL       lc640_read_int
0005c4  283f              CMP      r0,#0x3f              ;394
0005c6  d000              BEQ      |L1.1482|
0005c8  4620              MOV      r0,r4                 ;394
                  |L1.1482|
0005ca  b201              SXTH     r1,r0                 ;395
0005cc  4630              MOV      r0,r6                 ;395
0005ce  f7fffffe          BL       lc640_write_int
0005d2  4628              MOV      r0,r5                 ;397
0005d4  f7fffffe          BL       lc640_read_int
0005d8  eb091540          ADD      r5,r9,r0,LSL #5       ;397
0005dc  f04f0051          MOV      r0,#0x51              ;399
0005e0  f88d0000          STRB     r0,[sp,#0]            ;399
0005e4  f88d8001          STRB     r8,[sp,#1]            ;400
0005e8  f04f0441          MOV      r4,#0x41              ;401
0005ec  f88d4002          STRB     r4,[sp,#2]            ;401
0005f0  f88d8003          STRB     r8,[sp,#3]            ;402
0005f4  4669              MOV      r1,sp                 ;403
0005f6  4628              MOV      r0,r5                 ;403
0005f8  f7fffffe          BL       lc640_write_long_ptr
0005fc  f8cd8000          STR      r8,[sp,#0]            ;408
000600  4669              MOV      r1,sp                 ;409
000602  1d28              ADDS     r0,r5,#4              ;409
000604  f7fffffe          BL       lc640_write_long_ptr
000608  f1070720          ADD      r7,r7,#0x20           ;411
00060c  8bb8              LDRH     r0,[r7,#0x1c]         ;411
00060e  f88d0000          STRB     r0,[sp,#0]            ;411
000612  7e38              LDRB     r0,[r7,#0x18]         ;412
000614  f88d0001          STRB     r0,[sp,#1]            ;412
000618  7b38              LDRB     r0,[r7,#0xc]          ;413
00061a  f88d0002          STRB     r0,[sp,#2]            ;413
00061e  f88d8003          STRB     r8,[sp,#3]            ;414
000622  4669              MOV      r1,sp                 ;415
000624  f1050008          ADD      r0,r5,#8              ;415
000628  f7fffffe          BL       lc640_write_long_ptr
00062c  7a38              LDRB     r0,[r7,#8]            ;417
00062e  f88d0000          STRB     r0,[sp,#0]            ;417
000632  7938              LDRB     r0,[r7,#4]            ;418
000634  f88d0001          STRB     r0,[sp,#1]            ;418
000638  7838              LDRB     r0,[r7,#0]            ;419
00063a  f88d0002          STRB     r0,[sp,#2]            ;419
00063e  f88d8003          STRB     r8,[sp,#3]            ;420
000642  4669              MOV      r1,sp                 ;421
000644  f105000c          ADD      r0,r5,#0xc            ;421
000648  f7fffffe          BL       lc640_write_long_ptr
00064c  f88d4000          STRB     r4,[sp,#0]            ;423
000650  f88d4001          STRB     r4,[sp,#1]            ;424
000654  f88d4002          STRB     r4,[sp,#2]            ;425
000658  f88d4003          STRB     r4,[sp,#3]            ;426
00065c  4669              MOV      r1,sp                 ;427
00065e  f1050010          ADD      r0,r5,#0x10           ;427
000662  f7fffffe          BL       lc640_write_long_ptr
000666  f88d4000          STRB     r4,[sp,#0]            ;429
00066a  f88d4001          STRB     r4,[sp,#1]            ;430
00066e  f88d4002          STRB     r4,[sp,#2]            ;431
000672  f88d4003          STRB     r4,[sp,#3]            ;432
000676  4669              MOV      r1,sp                 ;433
000678  f1050014          ADD      r0,r5,#0x14           ;433
00067c  f7fffffe          BL       lc640_write_long_ptr
000680  f88d4000          STRB     r4,[sp,#0]            ;435
000684  f88d4001          STRB     r4,[sp,#1]            ;436
000688  f88d4002          STRB     r4,[sp,#2]            ;437
00068c  f88d4003          STRB     r4,[sp,#3]            ;438
000690  4669              MOV      r1,sp                 ;439
000692  e000              B        |L1.1686|
                  |L1.1684|
000694  e011              B        |L1.1722|
                  |L1.1686|
000696  f1050018          ADD      r0,r5,#0x18           ;439
00069a  f7fffffe          BL       lc640_write_long_ptr
00069e  f88d4000          STRB     r4,[sp,#0]            ;441
0006a2  f88d4001          STRB     r4,[sp,#1]            ;442
0006a6  f88d4002          STRB     r4,[sp,#2]            ;443
0006aa  f88d4003          STRB     r4,[sp,#3]            ;444
0006ae  4669              MOV      r1,sp                 ;445
0006b0  f105001c          ADD      r0,r5,#0x1c           ;445
0006b4  f7fffffe          BL       lc640_write_long_ptr
0006b8  e085              B        |L1.1990|
                  |L1.1722|
;;;462    	{
;;;463    	uout_av=0;
0006ba  f8818000          STRB     r8,[r1,#0]
;;;464    
;;;465      /*
;;;466    	SET_REG(C2GSR,3,24,8);
;;;467    	C2MOD=0;
;;;468    	bOUT_FREE2=1;*/
;;;469    
;;;470    
;;;471    	//C2MOD=0;
;;;472    
;;;473    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;474    
;;;475         //beep_init(0x02L,'O');
;;;476    	//a_.av.bAN=0;
;;;477    //	SET_REG(avar_stat,0,0,1);
;;;478    
;;;479    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;480    	
;;;481    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;482    
;;;483        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0006be  4628              MOV      r0,r5
0006c0  f7fffffe          BL       lc640_read_int
0006c4  4606              MOV      r6,r0
;;;484    	event_ptr_find=event_ptr;
0006c6  4634              MOV      r4,r6
                  |L1.1736|
;;;485    avar_uout_hndl_lbl1:
;;;486    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0006c8  eb091544          ADD      r5,r9,r4,LSL #5
;;;487    
;;;488         lc640_read_long_ptr(lc640_adr,data);
0006cc  4669              MOV      r1,sp
0006ce  4628              MOV      r0,r5
0006d0  f7fffffe          BL       lc640_read_long_ptr
;;;489         
;;;490         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
0006d4  f89d0000          LDRB     r0,[sp,#0]
0006d8  2851              CMP      r0,#0x51
0006da  d106              BNE      |L1.1770|
0006dc  f89d0001          LDRB     r0,[sp,#1]
0006e0  b918              CBNZ     r0,|L1.1770|
0006e2  f89d0002          LDRB     r0,[sp,#2]
0006e6  2841              CMP      r0,#0x41
0006e8  d008              BEQ      |L1.1788|
                  |L1.1770|
;;;491         	{        
;;;492         	if(event_ptr_find)event_ptr_find--;
0006ea  b114              CBZ      r4,|L1.1778|
0006ec  f1a40401          SUB      r4,r4,#1
0006f0  e001              B        |L1.1782|
                  |L1.1778|
;;;493         	else event_ptr_find=63;
0006f2  f04f043f          MOV      r4,#0x3f
                  |L1.1782|
;;;494         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0006f6  42b4              CMP      r4,r6
0006f8  d1e6              BNE      |L1.1736|
0006fa  e064              B        |L1.1990|
                  |L1.1788|
;;;495         	else goto avar_uout_hndl_lbl1;
;;;496         	}
;;;497         else 
;;;498         	{
;;;499         	lc640_read_long_ptr(lc640_adr+16,data);
0006fc  4669              MOV      r1,sp
0006fe  f1050010          ADD      r0,r5,#0x10
000702  f7fffffe          BL       lc640_read_long_ptr
;;;500         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000706  f89d0000          LDRB     r0,[sp,#0]
00070a  2841              CMP      r0,#0x41
00070c  d10b              BNE      |L1.1830|
00070e  f89d0001          LDRB     r0,[sp,#1]
000712  2841              CMP      r0,#0x41
000714  d107              BNE      |L1.1830|
000716  f89d0002          LDRB     r0,[sp,#2]
00071a  2841              CMP      r0,#0x41
00071c  d103              BNE      |L1.1830|
00071e  f89d0003          LDRB     r0,[sp,#3]
000722  2841              CMP      r0,#0x41
000724  d008              BEQ      |L1.1848|
                  |L1.1830|
;;;501         		{        
;;;502         		if(event_ptr_find)event_ptr_find--;
000726  b114              CBZ      r4,|L1.1838|
000728  f1a40401          SUB      r4,r4,#1
00072c  e001              B        |L1.1842|
                  |L1.1838|
;;;503             		else event_ptr_find=63;
00072e  f04f043f          MOV      r4,#0x3f
                  |L1.1842|
;;;504             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000732  42b4              CMP      r4,r6
000734  d1c8              BNE      |L1.1736|
000736  e046              B        |L1.1990|
                  |L1.1848|
;;;505         		else goto avar_uout_hndl_lbl1;
;;;506         		}
;;;507    
;;;508         	}	
;;;509    	
;;;510    	data[0]=LPC_RTC->YEAR;
000738  f1070720          ADD      r7,r7,#0x20
00073c  8bb8              LDRH     r0,[r7,#0x1c]
00073e  f88d0000          STRB     r0,[sp,#0]
;;;511    	data[1]=LPC_RTC->MONTH;
000742  7e38              LDRB     r0,[r7,#0x18]
000744  f88d0001          STRB     r0,[sp,#1]
;;;512    	data[2]=LPC_RTC->DOM;
000748  7b38              LDRB     r0,[r7,#0xc]
00074a  f88d0002          STRB     r0,[sp,#2]
;;;513    	data[3]=0;
00074e  f88d8003          STRB     r8,[sp,#3]
;;;514    	lc640_write_long_ptr(lc640_adr+16,data);
000752  4669              MOV      r1,sp
000754  f1050010          ADD      r0,r5,#0x10
000758  f7fffffe          BL       lc640_write_long_ptr
;;;515    
;;;516    	data[0]=LPC_RTC->HOUR;
00075c  7a38              LDRB     r0,[r7,#8]
00075e  f88d0000          STRB     r0,[sp,#0]
;;;517    	data[1]=LPC_RTC->MIN;
000762  7938              LDRB     r0,[r7,#4]
000764  f88d0001          STRB     r0,[sp,#1]
;;;518    	data[2]=LPC_RTC->SEC;
000768  7838              LDRB     r0,[r7,#0]
00076a  f88d0002          STRB     r0,[sp,#2]
;;;519    	data[3]=0;
00076e  f88d8003          STRB     r8,[sp,#3]
;;;520    	lc640_write_long_ptr(lc640_adr+20,data); 
000772  4669              MOV      r1,sp
000774  f1050014          ADD      r0,r5,#0x14
000778  f7fffffe          BL       lc640_write_long_ptr
;;;521    	
;;;522    	data[0]=*((char*)(&net_Ustore));
00077c  4833              LDR      r0,|L1.2124|
00077e  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000780  f88d1000          STRB     r1,[sp,#0]
;;;523    	data[1]=*(((char*)(&net_Ustore))+1);
000784  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000786  f88d0001          STRB     r0,[sp,#1]
;;;524    	data[2]='B';
00078a  f04f0442          MOV      r4,#0x42
00078e  f88d4002          STRB     r4,[sp,#2]
;;;525    	data[3]='B';
000792  f88d4003          STRB     r4,[sp,#3]
;;;526    	lc640_write_long_ptr(lc640_adr+24,data);
000796  4669              MOV      r1,sp
000798  f1050018          ADD      r0,r5,#0x18
00079c  f7fffffe          BL       lc640_write_long_ptr
;;;527    	
;;;528    	data[0]='B';
0007a0  f88d4000          STRB     r4,[sp,#0]
;;;529    	data[1]='B';
0007a4  f88d4001          STRB     r4,[sp,#1]
;;;530    	data[2]='B';
0007a8  f88d4002          STRB     r4,[sp,#2]
;;;531    	data[3]='B';
0007ac  f88d4003          STRB     r4,[sp,#3]
;;;532    	lc640_write_long_ptr(lc640_adr+28,data);	
0007b0  4669              MOV      r1,sp
0007b2  f105001c          ADD      r0,r5,#0x1c
0007b6  f7fffffe          BL       lc640_write_long_ptr
;;;533    	
;;;534    /*	memo_out0[0]=0x55;
;;;535         memo_out0[1]=0x00+2;
;;;536         memo_out0[2]=1;
;;;537         memo_out0[3]=0x0b;
;;;538         memo_out0[4]=0xaa;
;;;539         memo_out0[5]=0xaa; 
;;;540         	
;;;541         memo_out0[6]=crc_87(memo_out0,6);
;;;542    	memo_out0[7]=crc_95(memo_out0,6);
;;;543         usart_out_adr0(memo_out0,8); */
;;;544         snmp_trap_send("Main power is on",2,1,1);	
0007ba  2301              MOVS     r3,#1
0007bc  461a              MOV      r2,r3
0007be  2102              MOVS     r1,#2
0007c0  a023              ADR      r0,|L1.2128|
0007c2  f7fffffe          BL       snmp_trap_send
                  |L1.1990|
;;;545    	}
;;;546    avar_unet_hndl_end:
;;;547    	__nop();		
0007c6  bf00              NOP      
;;;548    }
0007c8  e6d5              B        |L1.1398|
;;;549    
                          ENDP

                  avar_bps_hndl PROC
;;;550    //-----------------------------------------------
;;;551    void avar_bps_hndl(char dev, char v, char in)
0007ca  e92d4ff8          PUSH     {r3-r11,lr}
;;;552    {
0007ce  4606              MOV      r6,r0
0007d0  460c              MOV      r4,r1
;;;553    char data[4];
;;;554    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;555    char avar_simbol;
;;;556    
;;;557    avar_simbol='T';
0007d2  f04f0754          MOV      r7,#0x54
;;;558    if(v==0)avar_simbol='T';
0007d6  b174              CBZ      r4,|L1.2038|
;;;559    else if(v==1)avar_simbol='U';
0007d8  2c01              CMP      r4,#1
0007da  d004              BEQ      |L1.2022|
;;;560    else if(v==2)avar_simbol='u';
0007dc  2c02              CMP      r4,#2
0007de  d005              BEQ      |L1.2028|
;;;561    else if(v==3)avar_simbol='L';
0007e0  2c03              CMP      r4,#3
0007e2  d006              BEQ      |L1.2034|
0007e4  e007              B        |L1.2038|
                  |L1.2022|
0007e6  f04f0755          MOV      r7,#0x55              ;559
0007ea  e004              B        |L1.2038|
                  |L1.2028|
0007ec  f04f0775          MOV      r7,#0x75              ;560
0007f0  e001              B        |L1.2038|
                  |L1.2034|
0007f2  f04f074c          MOV      r7,#0x4c
                  |L1.2038|
;;;562    
;;;563    if(in==1)
;;;564    	{
;;;565    	//av_src[bps]=1;
;;;566    
;;;567    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;568    //	SET_REG(avar_stat,1,3+dev,1);
;;;569    	
;;;570    	if(v==0)bps[dev]._av|=(1<<0);
0007f6  491d              LDR      r1,|L1.2156|
0007f8  ebc600c6          RSB      r0,r6,r6,LSL #3
;;;571    	else if(v==1) bps[dev]._av|=(1<<1);
;;;572    	else if(v==2) bps[dev]._av|=(1<<2);
;;;573    	else if(v==3) bps[dev]._av|=(1<<3);
;;;574    
;;;575    	bps[dev]._last_avar=v;
;;;576    
;;;577    	//beep_init(0x33333333,'A');
;;;578    
;;;579    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;580    	event_ptr++;	
;;;581    	if(event_ptr>63)event_ptr=0;	
;;;582    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;583    	
;;;584         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;585    	if(event_cnt!=63)event_cnt=event_ptr;
;;;586    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;587    	
;;;588    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;589    	
;;;590    	data[0]='S';
;;;591    	data[1]=dev; 
;;;592    	data[2]=avar_simbol;
;;;593    	data[3]=0;
;;;594    	lc640_write_long_ptr(lc640_adr,data);
;;;595    
;;;596    	data[0]=0;
;;;597    	data[1]=0;
;;;598    	data[2]=0;
;;;599    	data[3]=0;
;;;600    	lc640_write_long_ptr(lc640_adr+4,data);
;;;601    
;;;602    	data[0]=LPC_RTC->YEAR;
0007fc  f8df8068          LDR      r8,|L1.2152|
000800  eb000040          ADD      r0,r0,r0,LSL #1       ;570
000804  f04f0900          MOV      r9,#0                 ;552
000808  f44f6a60          MOV      r10,#0xe00            ;579
00080c  f44f6580          MOV      r5,#0x400             ;588
000810  eb010080          ADD      r0,r1,r0,LSL #2       ;570
000814  2a01              CMP      r2,#1                 ;563
000816  d002              BEQ      |L1.2078|
;;;603    	data[1]=LPC_RTC->MONTH;
;;;604    	data[2]=LPC_RTC->DOM;
;;;605    	data[3]=0;
;;;606    	lc640_write_long_ptr(lc640_adr+8,data);
;;;607    
;;;608    	data[0]=LPC_RTC->HOUR;
;;;609    	data[1]=LPC_RTC->MIN;
;;;610    	data[2]=LPC_RTC->SEC;
;;;611    	data[3]=0;
;;;612    	lc640_write_long_ptr(lc640_adr+12,data);
;;;613    	
;;;614    	data[0]='A';
;;;615    	data[1]='A';
;;;616    	data[2]='A';
;;;617    	data[3]='A';
;;;618    	lc640_write_long_ptr(lc640_adr+16,data);
;;;619    	
;;;620    	data[0]='A';
;;;621    	data[1]='A';
;;;622    	data[2]='A';
;;;623    	data[3]='A';
;;;624    	lc640_write_long_ptr(lc640_adr+20,data);
;;;625    	
;;;626    	data[0]='A';
;;;627    	data[1]='A';
;;;628    	data[2]='A';
;;;629    	data[3]='A';
;;;630    	lc640_write_long_ptr(lc640_adr+24,data);
;;;631    	
;;;632    	data[0]='A';
;;;633    	data[1]='A';
;;;634    	data[2]='A';
;;;635    	data[3]='A';
;;;636    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;637    
;;;638    
;;;639    	if(dev==0)
;;;640    		{
;;;641    		if(v==0)
;;;642    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;643    		else if(v==1)
;;;644    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;645    		else if(v==2)
;;;646    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;647    		else if(v==3)
;;;648    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;649    		}
;;;650    	else if(dev==1)
;;;651    		{
;;;652    		if(v==0)
;;;653    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;654    		else if(v==1)
;;;655    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;656    		else if(v==2)
;;;657    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;658    		else if(v==3)
;;;659    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;660    		} 
;;;661    	else if(dev==2)
;;;662    		{
;;;663    		if(v==0)
;;;664    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;665    		else if(v==1)
;;;666    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;667    		else if(v==2)
;;;668    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;669    		else if(v==3)
;;;670    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;671    		} 	
;;;672    			
;;;673    	}
;;;674    
;;;675    else if(in==0)
000818  2a00              CMP      r2,#0
00081a  d07d              BEQ      |L1.2328|
00081c  e1e5              B        |L1.3050|
                  |L1.2078|
00081e  b134              CBZ      r4,|L1.2094|
000820  2c01              CMP      r4,#1                 ;571
000822  d02a              BEQ      |L1.2170|
000824  2c02              CMP      r4,#2                 ;572
000826  d02d              BEQ      |L1.2180|
000828  2c03              CMP      r4,#3                 ;573
00082a  d030              BEQ      |L1.2190|
00082c  e033              B        |L1.2198|
                  |L1.2094|
00082e  e01f              B        |L1.2160|
                  |L1.2096|
000830  4d61696e          DCB      "Main power is off",0
000834  20706f77
000838  65722069
00083c  73206f66
000840  6600    
000842  00                DCB      0
000843  00                DCB      0
                  |L1.2116|
                          DCD      ||.data||
                  |L1.2120|
                          DCD      AV_OFF_AVT
                  |L1.2124|
                          DCD      net_Ustore
                  |L1.2128|
000850  4d61696e          DCB      "Main power is on",0
000854  20706f77
000858  65722069
00085c  73206f6e
000860  00      
000861  00                DCB      0
000862  00                DCB      0
000863  00                DCB      0
                  |L1.2148|
                          DCD      uout_av
                  |L1.2152|
                          DCD      0x40024000
                  |L1.2156|
                          DCD      bps
                  |L1.2160|
000870  7841              LDRB     r1,[r0,#1]            ;570
000872  f0410101          ORR      r1,r1,#1              ;570
000876  7041              STRB     r1,[r0,#1]            ;570
000878  e00d              B        |L1.2198|
                  |L1.2170|
00087a  7841              LDRB     r1,[r0,#1]            ;571
00087c  f0410102          ORR      r1,r1,#2              ;571
000880  7041              STRB     r1,[r0,#1]            ;571
000882  e008              B        |L1.2198|
                  |L1.2180|
000884  7841              LDRB     r1,[r0,#1]            ;572
000886  f0410104          ORR      r1,r1,#4              ;572
00088a  7041              STRB     r1,[r0,#1]            ;572
00088c  e003              B        |L1.2198|
                  |L1.2190|
00088e  7841              LDRB     r1,[r0,#1]            ;573
000890  f0410108          ORR      r1,r1,#8              ;573
000894  7041              STRB     r1,[r0,#1]            ;573
                  |L1.2198|
000896  f8804053          STRB     r4,[r0,#0x53]         ;575
00089a  4650              MOV      r0,r10                ;579
00089c  f7fffffe          BL       lc640_read_int
0008a0  f1000001          ADD      r0,r0,#1              ;580
0008a4  fa1ffb80          UXTH     r11,r0                ;580
0008a8  f1bb0f3f          CMP      r11,#0x3f             ;581
0008ac  d901              BLS      |L1.2226|
0008ae  f04f0b00          MOV      r11,#0                ;581
                  |L1.2226|
0008b2  fa0ff18b          SXTH     r1,r11                ;582
0008b6  4650              MOV      r0,r10                ;582
0008b8  f7fffffe          BL       lc640_write_int
0008bc  f6406002          MOV      r0,#0xe02             ;584
0008c0  f7fffffe          BL       lc640_read_int
0008c4  b280              UXTH     r0,r0                 ;584
0008c6  283f              CMP      r0,#0x3f              ;585
0008c8  d000              BEQ      |L1.2252|
0008ca  4658              MOV      r0,r11                ;585
                  |L1.2252|
0008cc  b201              SXTH     r1,r0                 ;586
0008ce  f6406002          MOV      r0,#0xe02             ;586
0008d2  f7fffffe          BL       lc640_write_int
0008d6  4650              MOV      r0,r10                ;588
0008d8  f7fffffe          BL       lc640_read_int
0008dc  eb051040          ADD      r0,r5,r0,LSL #5       ;588
0008e0  b285              UXTH     r5,r0                 ;588
0008e2  f04f0053          MOV      r0,#0x53              ;590
0008e6  f88d0000          STRB     r0,[sp,#0]            ;590
0008ea  f88d6001          STRB     r6,[sp,#1]            ;591
0008ee  f88d7002          STRB     r7,[sp,#2]            ;592
0008f2  f88d9003          STRB     r9,[sp,#3]            ;593
0008f6  4669              MOV      r1,sp                 ;594
0008f8  4628              MOV      r0,r5                 ;594
0008fa  f7fffffe          BL       lc640_write_long_ptr
0008fe  f8cd9000          STR      r9,[sp,#0]            ;599
000902  4669              MOV      r1,sp                 ;600
000904  1d28              ADDS     r0,r5,#4              ;600
000906  f7fffffe          BL       lc640_write_long_ptr
00090a  f8b8003c          LDRH     r0,[r8,#0x3c]         ;602
00090e  f88d0000          STRB     r0,[sp,#0]            ;602
000912  f8980038          LDRB     r0,[r8,#0x38]         ;603
000916  e000              B        |L1.2330|
                  |L1.2328|
000918  e0c7              B        |L1.2730|
                  |L1.2330|
00091a  f88d0001          STRB     r0,[sp,#1]            ;603
00091e  f898002c          LDRB     r0,[r8,#0x2c]         ;604
000922  f88d0002          STRB     r0,[sp,#2]            ;604
000926  f88d9003          STRB     r9,[sp,#3]            ;605
00092a  4669              MOV      r1,sp                 ;606
00092c  f1050008          ADD      r0,r5,#8              ;606
000930  f7fffffe          BL       lc640_write_long_ptr
000934  f8980028          LDRB     r0,[r8,#0x28]         ;608
000938  f88d0000          STRB     r0,[sp,#0]            ;608
00093c  f8980024          LDRB     r0,[r8,#0x24]         ;609
000940  f88d0001          STRB     r0,[sp,#1]            ;609
000944  f8980020          LDRB     r0,[r8,#0x20]         ;610
000948  f88d0002          STRB     r0,[sp,#2]            ;610
00094c  f88d9003          STRB     r9,[sp,#3]            ;611
000950  4669              MOV      r1,sp                 ;612
000952  f105000c          ADD      r0,r5,#0xc            ;612
000956  f7fffffe          BL       lc640_write_long_ptr
00095a  f04f0741          MOV      r7,#0x41              ;614
00095e  f88d7000          STRB     r7,[sp,#0]            ;614
000962  f88d7001          STRB     r7,[sp,#1]            ;615
000966  f88d7002          STRB     r7,[sp,#2]            ;616
00096a  f88d7003          STRB     r7,[sp,#3]            ;617
00096e  4669              MOV      r1,sp                 ;618
000970  f1050010          ADD      r0,r5,#0x10           ;618
000974  f7fffffe          BL       lc640_write_long_ptr
000978  f88d7000          STRB     r7,[sp,#0]            ;620
00097c  f88d7001          STRB     r7,[sp,#1]            ;621
000980  f88d7002          STRB     r7,[sp,#2]            ;622
000984  f88d7003          STRB     r7,[sp,#3]            ;623
000988  4669              MOV      r1,sp                 ;624
00098a  f1050014          ADD      r0,r5,#0x14           ;624
00098e  f7fffffe          BL       lc640_write_long_ptr
000992  f88d7000          STRB     r7,[sp,#0]            ;626
000996  f88d7001          STRB     r7,[sp,#1]            ;627
00099a  f88d7002          STRB     r7,[sp,#2]            ;628
00099e  f88d7003          STRB     r7,[sp,#3]            ;629
0009a2  4669              MOV      r1,sp                 ;630
0009a4  f1050018          ADD      r0,r5,#0x18           ;630
0009a8  f7fffffe          BL       lc640_write_long_ptr
0009ac  f88d7000          STRB     r7,[sp,#0]            ;632
0009b0  f88d7001          STRB     r7,[sp,#1]            ;633
0009b4  f88d7002          STRB     r7,[sp,#2]            ;634
0009b8  f88d7003          STRB     r7,[sp,#3]            ;635
0009bc  4669              MOV      r1,sp                 ;636
0009be  f105001c          ADD      r0,r5,#0x1c           ;636
0009c2  f7fffffe          BL       lc640_write_long_ptr
0009c6  b126              CBZ      r6,|L1.2514|
0009c8  2e01              CMP      r6,#1                 ;650
0009ca  d026              BEQ      |L1.2586|
0009cc  2e02              CMP      r6,#2                 ;661
0009ce  d048              BEQ      |L1.2658|
0009d0  e10b              B        |L1.3050|
                  |L1.2514|
0009d2  b134              CBZ      r4,|L1.2530|
0009d4  2c01              CMP      r4,#1                 ;643
0009d6  d00b              BEQ      |L1.2544|
0009d8  2c02              CMP      r4,#2                 ;645
0009da  d010              BEQ      |L1.2558|
0009dc  2c03              CMP      r4,#3                 ;647
0009de  d015              BEQ      |L1.2572|
0009e0  e103              B        |L1.3050|
                  |L1.2530|
0009e2  2300              MOVS     r3,#0                 ;642
0009e4  2201              MOVS     r2,#1                 ;642
0009e6  2104              MOVS     r1,#4                 ;642
0009e8  a0d7              ADR      r0,|L1.3400|
0009ea  f7fffffe          BL       snmp_trap_send
0009ee  e0fc              B        |L1.3050|
                  |L1.2544|
0009f0  2301              MOVS     r3,#1                 ;644
0009f2  461a              MOV      r2,r3                 ;644
0009f4  2104              MOVS     r1,#4                 ;644
0009f6  a0da              ADR      r0,|L1.3424|
0009f8  f7fffffe          BL       snmp_trap_send
0009fc  e0f5              B        |L1.3050|
                  |L1.2558|
0009fe  2302              MOVS     r3,#2                 ;646
000a00  2201              MOVS     r2,#1                 ;646
000a02  2104              MOVS     r1,#4                 ;646
000a04  a0dd              ADR      r0,|L1.3452|
000a06  f7fffffe          BL       snmp_trap_send
000a0a  e0ee              B        |L1.3050|
                  |L1.2572|
000a0c  2303              MOVS     r3,#3                 ;648
000a0e  2201              MOVS     r2,#1                 ;648
000a10  2104              MOVS     r1,#4                 ;648
000a12  a0e2              ADR      r0,|L1.3484|
000a14  f7fffffe          BL       snmp_trap_send
000a18  e0e7              B        |L1.3050|
                  |L1.2586|
000a1a  b134              CBZ      r4,|L1.2602|
000a1c  2c01              CMP      r4,#1                 ;654
000a1e  d00b              BEQ      |L1.2616|
000a20  2c02              CMP      r4,#2                 ;656
000a22  d010              BEQ      |L1.2630|
000a24  2c03              CMP      r4,#3                 ;658
000a26  d015              BEQ      |L1.2644|
000a28  e0df              B        |L1.3050|
                  |L1.2602|
000a2a  2300              MOVS     r3,#0                 ;653
000a2c  2202              MOVS     r2,#2                 ;653
000a2e  2104              MOVS     r1,#4                 ;653
000a30  a0e2              ADR      r0,|L1.3516|
000a32  f7fffffe          BL       snmp_trap_send
000a36  e0d8              B        |L1.3050|
                  |L1.2616|
000a38  2301              MOVS     r3,#1                 ;655
000a3a  2202              MOVS     r2,#2                 ;655
000a3c  2104              MOVS     r1,#4                 ;655
000a3e  a0e5              ADR      r0,|L1.3540|
000a40  f7fffffe          BL       snmp_trap_send
000a44  e0d1              B        |L1.3050|
                  |L1.2630|
000a46  2302              MOVS     r3,#2                 ;657
000a48  461a              MOV      r2,r3                 ;657
000a4a  2104              MOVS     r1,#4                 ;657
000a4c  a0e8              ADR      r0,|L1.3568|
000a4e  f7fffffe          BL       snmp_trap_send
000a52  e0ca              B        |L1.3050|
                  |L1.2644|
000a54  2303              MOVS     r3,#3                 ;659
000a56  2202              MOVS     r2,#2                 ;659
000a58  2104              MOVS     r1,#4                 ;659
000a5a  a0ed              ADR      r0,|L1.3600|
000a5c  f7fffffe          BL       snmp_trap_send
000a60  e0c3              B        |L1.3050|
                  |L1.2658|
000a62  b134              CBZ      r4,|L1.2674|
000a64  2c01              CMP      r4,#1                 ;665
000a66  d00b              BEQ      |L1.2688|
000a68  2c02              CMP      r4,#2                 ;667
000a6a  d010              BEQ      |L1.2702|
000a6c  2c03              CMP      r4,#3                 ;669
000a6e  d015              BEQ      |L1.2716|
000a70  e0bb              B        |L1.3050|
                  |L1.2674|
000a72  2300              MOVS     r3,#0                 ;664
000a74  2203              MOVS     r2,#3                 ;664
000a76  2104              MOVS     r1,#4                 ;664
000a78  a0ed              ADR      r0,|L1.3632|
000a7a  f7fffffe          BL       snmp_trap_send
000a7e  e0b4              B        |L1.3050|
                  |L1.2688|
000a80  2301              MOVS     r3,#1                 ;666
000a82  2203              MOVS     r2,#3                 ;666
000a84  2104              MOVS     r1,#4                 ;666
000a86  a0f0              ADR      r0,|L1.3656|
000a88  f7fffffe          BL       snmp_trap_send
000a8c  e0ad              B        |L1.3050|
                  |L1.2702|
000a8e  2302              MOVS     r3,#2                 ;668
000a90  2203              MOVS     r2,#3                 ;668
000a92  2104              MOVS     r1,#4                 ;668
000a94  a0f3              ADR      r0,|L1.3684|
000a96  f7fffffe          BL       snmp_trap_send
000a9a  e0a6              B        |L1.3050|
                  |L1.2716|
000a9c  2303              MOVS     r3,#3                 ;670
000a9e  461a              MOV      r2,r3                 ;670
000aa0  2104              MOVS     r1,#4                 ;670
000aa2  a0f8              ADR      r0,|L1.3716|
000aa4  f7fffffe          BL       snmp_trap_send
000aa8  e09f              B        |L1.3050|
                  |L1.2730|
;;;676    	{      
;;;677    //	av_bps[bps]=0;
;;;678    
;;;679    	//SET_REG(avar_stat,0,3+bps,1);
;;;680    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;681    
;;;682         if(v==0) bps[dev]._av&=(~(1<<0));
000aaa  b134              CBZ      r4,|L1.2746|
;;;683         else if(v==1) bps[dev]._av&=(~(1<<1));
000aac  2c01              CMP      r4,#1
000aae  d009              BEQ      |L1.2756|
;;;684    	else if(v==2) bps[dev]._av&=(~(1<<2));
000ab0  2c02              CMP      r4,#2
000ab2  d00c              BEQ      |L1.2766|
;;;685    	else if(v==3) bps[dev]._av&=(~(1<<3));
000ab4  2c03              CMP      r4,#3
000ab6  d00f              BEQ      |L1.2776|
000ab8  e012              B        |L1.2784|
                  |L1.2746|
000aba  7841              LDRB     r1,[r0,#1]            ;682
000abc  f0210101          BIC      r1,r1,#1              ;682
000ac0  7041              STRB     r1,[r0,#1]            ;682
000ac2  e00d              B        |L1.2784|
                  |L1.2756|
000ac4  7841              LDRB     r1,[r0,#1]            ;683
000ac6  f0210102          BIC      r1,r1,#2              ;683
000aca  7041              STRB     r1,[r0,#1]            ;683
000acc  e008              B        |L1.2784|
                  |L1.2766|
000ace  7841              LDRB     r1,[r0,#1]            ;684
000ad0  f0210104          BIC      r1,r1,#4              ;684
000ad4  7041              STRB     r1,[r0,#1]            ;684
000ad6  e003              B        |L1.2784|
                  |L1.2776|
000ad8  7841              LDRB     r1,[r0,#1]
000ada  f0210108          BIC      r1,r1,#8
000ade  7041              STRB     r1,[r0,#1]
                  |L1.2784|
;;;686         
;;;687    //	if((bps[dev]._av&0x0f==0))
;;;688    //	     {
;;;689    		//SET_REG(avar_stat,0,3+bps,1);
;;;690    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;691    //	     }
;;;692     
;;;693    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000ae0  4650              MOV      r0,r10
000ae2  f7fffffe          BL       lc640_read_int
000ae6  fa1ffb80          UXTH     r11,r0
;;;694    	event_ptr_find=event_ptr;
000aea  465c              MOV      r4,r11
                  |L1.2796|
;;;695    	
;;;696    avar_src_hndl_lbl1: 
;;;697    
;;;698    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000aec  eb051044          ADD      r0,r5,r4,LSL #5
000af0  fa1ffa80          UXTH     r10,r0
;;;699    
;;;700         lc640_read_long_ptr(lc640_adr,data);
000af4  4669              MOV      r1,sp
000af6  4650              MOV      r0,r10
000af8  f7fffffe          BL       lc640_read_long_ptr
;;;701         
;;;702         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000afc  f89d0000          LDRB     r0,[sp,#0]
000b00  2853              CMP      r0,#0x53
000b02  d107              BNE      |L1.2836|
000b04  f89d0001          LDRB     r0,[sp,#1]
000b08  42b0              CMP      r0,r6
000b0a  d103              BNE      |L1.2836|
000b0c  f89d0002          LDRB     r0,[sp,#2]
000b10  42b8              CMP      r0,r7
000b12  d009              BEQ      |L1.2856|
                  |L1.2836|
;;;703         	{        
;;;704         	if(event_ptr_find)event_ptr_find--;
000b14  b11c              CBZ      r4,|L1.2846|
000b16  f1a40401          SUB      r4,r4,#1
000b1a  b2a4              UXTH     r4,r4
000b1c  e001              B        |L1.2850|
                  |L1.2846|
;;;705         	else event_ptr_find=63;
000b1e  f04f043f          MOV      r4,#0x3f
                  |L1.2850|
;;;706         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000b22  455c              CMP      r4,r11
000b24  d1e2              BNE      |L1.2796|
000b26  e060              B        |L1.3050|
                  |L1.2856|
;;;707         	else goto avar_src_hndl_lbl1;
;;;708         	}
;;;709         else 
;;;710         	{
;;;711         	lc640_read_long_ptr(lc640_adr+16,data);
000b28  4669              MOV      r1,sp
000b2a  f10a0010          ADD      r0,r10,#0x10
000b2e  f7fffffe          BL       lc640_read_long_ptr
;;;712         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000b32  f89d0000          LDRB     r0,[sp,#0]
000b36  2841              CMP      r0,#0x41
000b38  d10b              BNE      |L1.2898|
000b3a  f89d0001          LDRB     r0,[sp,#1]
000b3e  2841              CMP      r0,#0x41
000b40  d107              BNE      |L1.2898|
000b42  f89d0002          LDRB     r0,[sp,#2]
000b46  2841              CMP      r0,#0x41
000b48  d103              BNE      |L1.2898|
000b4a  f89d0003          LDRB     r0,[sp,#3]
000b4e  2841              CMP      r0,#0x41
000b50  d009              BEQ      |L1.2918|
                  |L1.2898|
;;;713         		{        
;;;714         		if(event_ptr_find)event_ptr_find--;
000b52  b11c              CBZ      r4,|L1.2908|
000b54  f1a40401          SUB      r4,r4,#1
000b58  b2a4              UXTH     r4,r4
000b5a  e001              B        |L1.2912|
                  |L1.2908|
;;;715             		else event_ptr_find=63;
000b5c  f04f043f          MOV      r4,#0x3f
                  |L1.2912|
;;;716             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000b60  455c              CMP      r4,r11
000b62  d1c3              BNE      |L1.2796|
000b64  e041              B        |L1.3050|
                  |L1.2918|
;;;717         		else goto avar_src_hndl_lbl1;
;;;718         		}
;;;719    
;;;720         	}	
;;;721    
;;;722    
;;;723    	
;;;724    	data[0]=LPC_RTC->YEAR;
000b66  f8b8003c          LDRH     r0,[r8,#0x3c]
000b6a  f88d0000          STRB     r0,[sp,#0]
;;;725    	data[1]=LPC_RTC->MONTH;
000b6e  f8980038          LDRB     r0,[r8,#0x38]
000b72  f88d0001          STRB     r0,[sp,#1]
;;;726    	data[2]=LPC_RTC->DOM;
000b76  f898002c          LDRB     r0,[r8,#0x2c]
000b7a  f88d0002          STRB     r0,[sp,#2]
;;;727    	data[3]=0;
000b7e  f88d9003          STRB     r9,[sp,#3]
;;;728    	lc640_write_long_ptr(lc640_adr+16,data);
000b82  4669              MOV      r1,sp
000b84  f10a0010          ADD      r0,r10,#0x10
000b88  f7fffffe          BL       lc640_write_long_ptr
;;;729    
;;;730    	data[0]=LPC_RTC->HOUR;
000b8c  f8980028          LDRB     r0,[r8,#0x28]
000b90  f88d0000          STRB     r0,[sp,#0]
;;;731    	data[1]=LPC_RTC->MIN;
000b94  f8980024          LDRB     r0,[r8,#0x24]
000b98  f88d0001          STRB     r0,[sp,#1]
;;;732    	data[2]=LPC_RTC->SEC;
000b9c  f8980020          LDRB     r0,[r8,#0x20]
000ba0  f88d0002          STRB     r0,[sp,#2]
;;;733    	data[3]=0;
000ba4  f88d9003          STRB     r9,[sp,#3]
;;;734    	lc640_write_long_ptr(lc640_adr+20,data);
000ba8  4669              MOV      r1,sp
000baa  f10a0014          ADD      r0,r10,#0x14
000bae  f7fffffe          BL       lc640_write_long_ptr
;;;735    	
;;;736    	data[0]='B';
000bb2  f04f0442          MOV      r4,#0x42
000bb6  f88d4000          STRB     r4,[sp,#0]
;;;737    	data[1]='B';
000bba  f88d4001          STRB     r4,[sp,#1]
;;;738    	data[2]='B';
000bbe  f88d4002          STRB     r4,[sp,#2]
;;;739    	data[3]='B';
000bc2  f88d4003          STRB     r4,[sp,#3]
;;;740    	lc640_write_long_ptr(lc640_adr+24,data);
000bc6  4669              MOV      r1,sp
000bc8  f10a0018          ADD      r0,r10,#0x18
000bcc  f7fffffe          BL       lc640_write_long_ptr
;;;741    	
;;;742    	data[0]='B';
000bd0  f88d4000          STRB     r4,[sp,#0]
;;;743    	data[1]='B';
000bd4  f88d4001          STRB     r4,[sp,#1]
;;;744    	data[2]='B';
000bd8  f88d4002          STRB     r4,[sp,#2]
;;;745    	data[3]='B';
000bdc  f88d4003          STRB     r4,[sp,#3]
;;;746    	lc640_write_long_ptr(lc640_adr+28,data);
000be0  4669              MOV      r1,sp
000be2  f10a001c          ADD      r0,r10,#0x1c
000be6  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3050|
;;;747    	
;;;748    	}
;;;749    	
;;;750    avar_src_hndl_end:
;;;751    __nop();		
000bea  bf00              NOP      
                  |L1.3052|
;;;752    }
000bec  e8bd8ff8          POP      {r3-r11,pc}
;;;753    
                          ENDP

                  wrk_mem_hndl PROC
;;;754    //-----------------------------------------------
;;;755    void wrk_mem_hndl(char b)
000bf0  e92d41fc          PUSH     {r2-r8,lr}
;;;756    {
000bf4  4606              MOV      r6,r0
;;;757    char data[4];
;;;758    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;759    
;;;760    signed short temp_temp;
;;;761    
;;;762    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000bf6  eb060046          ADD      r0,r6,r6,LSL #1
000bfa  eb001106          ADD      r1,r0,r6,LSL #4
000bfe  48a9              LDR      r0,|L1.3748|
000c00  eb000481          ADD      r4,r0,r1,LSL #2
000c04  8be0              LDRH     r0,[r4,#0x1e]
000c06  2805              CMP      r0,#5
000c08  d37e              BCC      |L1.3336|
;;;763    
;;;764    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000c0a  48a7              LDR      r0,|L1.3752|
000c0c  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000c0e  f1000006          ADD      r0,r0,#6
000c12  f0000007          AND      r0,r0,#7
000c16  eb040040          ADD      r0,r4,r0,LSL #1
000c1a  8c00              LDRH     r0,[r0,#0x20]
000c1c  9000              STR      r0,[sp,#0]
;;;765    
;;;766    
;;;767    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000c1e  f44f6760          MOV      r7,#0xe00
000c22  4638              MOV      r0,r7
000c24  f7fffffe          BL       lc640_read_int
;;;768    event_ptr++;	
000c28  f1000001          ADD      r0,r0,#1
000c2c  b285              UXTH     r5,r0
;;;769    if(event_ptr>63)event_ptr=0;	
000c2e  2d3f              CMP      r5,#0x3f
000c30  d901              BLS      |L1.3126|
000c32  f04f0500          MOV      r5,#0
                  |L1.3126|
;;;770    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000c36  b229              SXTH     r1,r5
000c38  4638              MOV      r0,r7
000c3a  f7fffffe          BL       lc640_write_int
;;;771    	
;;;772    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000c3e  f6406802          MOV      r8,#0xe02
000c42  4640              MOV      r0,r8
000c44  f7fffffe          BL       lc640_read_int
000c48  b280              UXTH     r0,r0
;;;773    if(event_cnt!=63)event_cnt=event_ptr;
000c4a  283f              CMP      r0,#0x3f
000c4c  d000              BEQ      |L1.3152|
000c4e  4628              MOV      r0,r5
                  |L1.3152|
;;;774    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000c50  b201              SXTH     r1,r0
000c52  4640              MOV      r0,r8
000c54  f7fffffe          BL       lc640_write_int
;;;775    	
;;;776    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000c58  4638              MOV      r0,r7
000c5a  f7fffffe          BL       lc640_read_int
000c5e  f44f6180          MOV      r1,#0x400
000c62  eb011040          ADD      r0,r1,r0,LSL #5
000c66  b285              UXTH     r5,r0
;;;777    	
;;;778    data[0]='B';
000c68  f04f0042          MOV      r0,#0x42
000c6c  f88d0004          STRB     r0,[sp,#4]
;;;779    data[1]=b; 
000c70  f88d6005          STRB     r6,[sp,#5]
;;;780    data[2]='W';
000c74  f04f0057          MOV      r0,#0x57
000c78  f88d0006          STRB     r0,[sp,#6]
;;;781    data[3]=0;
000c7c  f04f0600          MOV      r6,#0
000c80  f88d6007          STRB     r6,[sp,#7]
;;;782    
;;;783    lc640_write_long_ptr(lc640_adr,data);
000c84  a901              ADD      r1,sp,#4
000c86  4628              MOV      r0,r5
000c88  f7fffffe          BL       lc640_write_long_ptr
;;;784    
;;;785    data[0]=*((char*)&bat[b]._Iintegr_);
000c8c  7fa0              LDRB     r0,[r4,#0x1e]
000c8e  f88d0004          STRB     r0,[sp,#4]
;;;786    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000c92  7fe0              LDRB     r0,[r4,#0x1f]
000c94  f88d0005          STRB     r0,[sp,#5]
;;;787    data[2]=*((char*)&temp_temp);
000c98  f89d0000          LDRB     r0,[sp,#0]
000c9c  f88d0006          STRB     r0,[sp,#6]
;;;788    data[3]=*(((char*)(&temp_temp))+1);
000ca0  f89d0001          LDRB     r0,[sp,#1]
000ca4  f88d0007          STRB     r0,[sp,#7]
;;;789    lc640_write_long_ptr(lc640_adr+4,data);
000ca8  a901              ADD      r1,sp,#4
000caa  1d28              ADDS     r0,r5,#4
000cac  f7fffffe          BL       lc640_write_long_ptr
;;;790    
;;;791    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000cb0  f1040134          ADD      r1,r4,#0x34
000cb4  f1050008          ADD      r0,r5,#8
000cb8  f7fffffe          BL       lc640_write_long_ptr
;;;792    	
;;;793    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000cbc  f1040138          ADD      r1,r4,#0x38
000cc0  f105000c          ADD      r0,r5,#0xc
000cc4  f7fffffe          BL       lc640_write_long_ptr
;;;794    
;;;795    data[0]=LPC_RTC->YEAR;
000cc8  4c78              LDR      r4,|L1.3756|
000cca  8ba0              LDRH     r0,[r4,#0x1c]
000ccc  f88d0004          STRB     r0,[sp,#4]
;;;796    data[1]=LPC_RTC->MONTH;
000cd0  7e20              LDRB     r0,[r4,#0x18]
000cd2  f88d0005          STRB     r0,[sp,#5]
;;;797    data[2]=LPC_RTC->DOM;
000cd6  7b20              LDRB     r0,[r4,#0xc]
000cd8  f88d0006          STRB     r0,[sp,#6]
;;;798    data[3]=0;
000cdc  f88d6007          STRB     r6,[sp,#7]
;;;799    lc640_write_long_ptr(lc640_adr+16,data);
000ce0  a901              ADD      r1,sp,#4
000ce2  f1050010          ADD      r0,r5,#0x10
000ce6  f7fffffe          BL       lc640_write_long_ptr
;;;800    
;;;801    data[0]=LPC_RTC->HOUR;
000cea  7a20              LDRB     r0,[r4,#8]
000cec  f88d0004          STRB     r0,[sp,#4]
;;;802    data[1]=LPC_RTC->MIN;
000cf0  7920              LDRB     r0,[r4,#4]
000cf2  f88d0005          STRB     r0,[sp,#5]
;;;803    data[2]=LPC_RTC->SEC;
000cf6  7820              LDRB     r0,[r4,#0]
000cf8  f88d0006          STRB     r0,[sp,#6]
;;;804    data[3]=0;
000cfc  f88d6007          STRB     r6,[sp,#7]
;;;805    lc640_write_long_ptr(lc640_adr+20,data);
000d00  a901              ADD      r1,sp,#4
000d02  f1050014          ADD      r0,r5,#0x14
000d06  e000              B        |L1.3338|
                  |L1.3336|
000d08  e001              B        |L1.3342|
                  |L1.3338|
000d0a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3342|
;;;806    	
;;;807    
;;;808    
;;;809    	
;;;810    wrk_mem_hndl_end:	
;;;811    __nop();
000d0e  bf00              NOP      
;;;812    }  
000d10  e8bd81fc          POP      {r2-r8,pc}
;;;813    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;815    //-----------------------------------------------
;;;816    void avar_bat_ips_hndl(char in)
000d14  e92d4ff8          PUSH     {r3-r11,lr}
;;;817    {
000d18  4602              MOV      r2,r0
;;;818    char data[4];
;;;819    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;820    
;;;821    if(in==1)
;;;822    	{
;;;823    	bat_ips._av|=1;
000d1a  4865              LDR      r0,|L1.3760|
;;;824        	ips_bat_av_stat=1;
000d1c  4c65              LDR      r4,|L1.3764|
;;;825    	ips_bat_av_vzvod=1;
000d1e  4b66              LDR      r3,|L1.3768|
;;;826    
;;;827    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;828    	event_ptr++;	
;;;829    	if(event_ptr>63)event_ptr=0;	
;;;830    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;831    	
;;;832         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;833    	if(event_cnt!=63)event_cnt=event_ptr;
;;;834    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;835    	
;;;836    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;837    	
;;;838    	data[0]='B';
;;;839    	data[1]=0;
;;;840    	data[2]='C';
;;;841    	data[3]=0;
;;;842    	lc640_write_long_ptr(lc640_adr,data);
;;;843    
;;;844    	data[0]=0;
;;;845    	data[1]=0;
;;;846    	data[2]=0;
;;;847    	data[3]=0;
;;;848    	lc640_write_long_ptr(lc640_adr+4,data);
;;;849    
;;;850    	data[0]=LPC_RTC->YEAR;
000d20  f8df8198          LDR      r8,|L1.3772|
000d24  f890103d          LDRB     r1,[r0,#0x3d]         ;823
000d28  f04f0742          MOV      r7,#0x42              ;838
000d2c  f44f6560          MOV      r5,#0xe00             ;827
000d30  f04f0900          MOV      r9,#0                 ;829
000d34  f44f6a80          MOV      r10,#0x400            ;836
000d38  2a01              CMP      r2,#1                 ;821
000d3a  d002              BEQ      |L1.3394|
;;;851    	data[1]=LPC_RTC->MONTH;
;;;852    	data[2]=LPC_RTC->DOM;
;;;853    	data[3]=0;
;;;854    	lc640_write_long_ptr(lc640_adr+8,data);
;;;855    
;;;856    	data[0]=LPC_RTC->HOUR;
;;;857    	data[1]=LPC_RTC->MIN;
;;;858    	data[2]=LPC_RTC->SEC;
;;;859    	data[3]=0;
;;;860    	lc640_write_long_ptr(lc640_adr+12,data);
;;;861    	
;;;862    	data[0]='A';
;;;863    	data[1]='A';
;;;864    	data[2]='A';
;;;865    	data[3]='A';
;;;866    	lc640_write_long_ptr(lc640_adr+16,data);
;;;867    	
;;;868    	data[0]='A';
;;;869    	data[1]='A';
;;;870    	data[2]='A';
;;;871    	data[3]='A';
;;;872    	lc640_write_long_ptr(lc640_adr+20,data);
;;;873    	
;;;874    	data[0]='A';
;;;875    	data[1]='A';
;;;876    	data[2]='A';
;;;877    	data[3]='A';
;;;878    	lc640_write_long_ptr(lc640_adr+24,data);
;;;879    	
;;;880    	data[0]='A';
;;;881    	data[1]='A';
;;;882    	data[2]='A';
;;;883    	data[3]='A';
;;;884    	lc640_write_long_ptr(lc640_adr+28,data);
;;;885    					
;;;886    	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;887    		
;;;888    	}
;;;889    
;;;890    else if(in==0)
000d3c  2a00              CMP      r2,#0
000d3e  d001              BEQ      |L1.3396|
000d40  e1e6              B        |L1.4368|
                  |L1.3394|
000d42  e0bd              B        |L1.3776|
                  |L1.3396|
000d44  e15c              B        |L1.4096|
000d46  0000              DCW      0x0000
                  |L1.3400|
000d48  42505320          DCB      "BPS #1 Alarm, overheat",0
000d4c  23312041
000d50  6c61726d
000d54  2c206f76
000d58  65726865
000d5c  617400  
000d5f  00                DCB      0
                  |L1.3424|
000d60  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000d64  23312041
000d68  6c61726d
000d6c  2c20766f
000d70  6c746167
000d74  65206973
000d78  20757000
                  |L1.3452|
000d7c  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000d80  23312041
000d84  6c61726d
000d88  2c20766f
000d8c  6c746167
000d90  65206973
000d94  20646f77
000d98  6e00    
000d9a  00                DCB      0
000d9b  00                DCB      0
                  |L1.3484|
000d9c  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000da0  23312041
000da4  6c61726d
000da8  2c20636f
000dac  6e6e6563
000db0  74206973
000db4  206c6f73
000db8  7400    
000dba  00                DCB      0
000dbb  00                DCB      0
                  |L1.3516|
000dbc  42505320          DCB      "BPS #2 Alarm, overheat",0
000dc0  23322041
000dc4  6c61726d
000dc8  2c206f76
000dcc  65726865
000dd0  617400  
000dd3  00                DCB      0
                  |L1.3540|
000dd4  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000dd8  23322041
000ddc  6c61726d
000de0  2c20766f
000de4  6c746167
000de8  65206973
000dec  20757000
                  |L1.3568|
000df0  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000df4  23322041
000df8  6c61726d
000dfc  2c20766f
000e00  6c746167
000e04  65206973
000e08  20646f77
000e0c  6e00    
000e0e  00                DCB      0
000e0f  00                DCB      0
                  |L1.3600|
000e10  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000e14  23322041
000e18  6c61726d
000e1c  2c20636f
000e20  6e6e6563
000e24  74206973
000e28  206c6f73
000e2c  7400    
000e2e  00                DCB      0
000e2f  00                DCB      0
                  |L1.3632|
000e30  42505320          DCB      "BPS #3 Alarm, overheat",0
000e34  23332041
000e38  6c61726d
000e3c  2c206f76
000e40  65726865
000e44  617400  
000e47  00                DCB      0
                  |L1.3656|
000e48  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000e4c  23332041
000e50  6c61726d
000e54  2c20766f
000e58  6c746167
000e5c  65206973
000e60  20757000
                  |L1.3684|
000e64  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000e68  23332041
000e6c  6c61726d
000e70  2c20766f
000e74  6c746167
000e78  65206973
000e7c  20646f77
000e80  6e00    
000e82  00                DCB      0
000e83  00                DCB      0
                  |L1.3716|
000e84  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000e88  23332041
000e8c  6c61726d
000e90  2c20636f
000e94  6e6e6563
000e98  74206973
000e9c  206c6f73
000ea0  7400    
000ea2  00                DCB      0
000ea3  00                DCB      0
                  |L1.3748|
                          DCD      bat
                  |L1.3752|
                          DCD      bat_u_old_cnt
                  |L1.3756|
                          DCD      0x40024020
                  |L1.3760|
                          DCD      bat_ips
                  |L1.3764|
                          DCD      ips_bat_av_stat
                  |L1.3768|
                          DCD      ips_bat_av_vzvod
                  |L1.3772|
                          DCD      0x40024000
                  |L1.3776|
000ec0  f0410101          ORR      r1,r1,#1              ;823
000ec4  f880103d          STRB     r1,[r0,#0x3d]         ;823
000ec8  f04f0001          MOV      r0,#1                 ;824
000ecc  7020              STRB     r0,[r4,#0]            ;824
000ece  7018              STRB     r0,[r3,#0]            ;825
000ed0  4628              MOV      r0,r5                 ;827
000ed2  f7fffffe          BL       lc640_read_int
000ed6  f1000001          ADD      r0,r0,#1              ;828
000eda  b284              UXTH     r4,r0                 ;828
000edc  2c3f              CMP      r4,#0x3f              ;829
000ede  d901              BLS      |L1.3812|
000ee0  f04f0400          MOV      r4,#0                 ;829
                  |L1.3812|
000ee4  b221              SXTH     r1,r4                 ;830
000ee6  4628              MOV      r0,r5                 ;830
000ee8  f7fffffe          BL       lc640_write_int
000eec  f6406602          MOV      r6,#0xe02             ;832
000ef0  4630              MOV      r0,r6                 ;832
000ef2  f7fffffe          BL       lc640_read_int
000ef6  b281              UXTH     r1,r0                 ;832
000ef8  293f              CMP      r1,#0x3f              ;833
000efa  d000              BEQ      |L1.3838|
000efc  4621              MOV      r1,r4                 ;833
                  |L1.3838|
000efe  b209              SXTH     r1,r1                 ;834
000f00  4630              MOV      r0,r6                 ;834
000f02  f7fffffe          BL       lc640_write_int
000f06  4628              MOV      r0,r5                 ;836
000f08  f7fffffe          BL       lc640_read_int
000f0c  eb0a1040          ADD      r0,r10,r0,LSL #5      ;836
000f10  b284              UXTH     r4,r0                 ;836
000f12  f88d7000          STRB     r7,[sp,#0]            ;838
000f16  f88d9001          STRB     r9,[sp,#1]            ;839
000f1a  f04f0043          MOV      r0,#0x43              ;840
000f1e  f88d0002          STRB     r0,[sp,#2]            ;840
000f22  f88d9003          STRB     r9,[sp,#3]            ;841
000f26  4669              MOV      r1,sp                 ;842
000f28  4620              MOV      r0,r4                 ;842
000f2a  f7fffffe          BL       lc640_write_long_ptr
000f2e  f8cd9000          STR      r9,[sp,#0]            ;847
000f32  4669              MOV      r1,sp                 ;848
000f34  1d20              ADDS     r0,r4,#4              ;848
000f36  f7fffffe          BL       lc640_write_long_ptr
000f3a  f8b8003c          LDRH     r0,[r8,#0x3c]         ;850
000f3e  f88d0000          STRB     r0,[sp,#0]            ;850
000f42  f8980038          LDRB     r0,[r8,#0x38]         ;851
000f46  f88d0001          STRB     r0,[sp,#1]            ;851
000f4a  f898002c          LDRB     r0,[r8,#0x2c]         ;852
000f4e  f88d0002          STRB     r0,[sp,#2]            ;852
000f52  f88d9003          STRB     r9,[sp,#3]            ;853
000f56  4669              MOV      r1,sp                 ;854
000f58  f1040008          ADD      r0,r4,#8              ;854
000f5c  f7fffffe          BL       lc640_write_long_ptr
000f60  f8980028          LDRB     r0,[r8,#0x28]         ;856
000f64  f88d0000          STRB     r0,[sp,#0]            ;856
000f68  f8980024          LDRB     r0,[r8,#0x24]         ;857
000f6c  f88d0001          STRB     r0,[sp,#1]            ;857
000f70  f8980020          LDRB     r0,[r8,#0x20]         ;858
000f74  f88d0002          STRB     r0,[sp,#2]            ;858
000f78  f88d9003          STRB     r9,[sp,#3]            ;859
000f7c  4669              MOV      r1,sp                 ;860
000f7e  f104000c          ADD      r0,r4,#0xc            ;860
000f82  f7fffffe          BL       lc640_write_long_ptr
000f86  f04f0541          MOV      r5,#0x41              ;862
000f8a  f88d5000          STRB     r5,[sp,#0]            ;862
000f8e  f88d5001          STRB     r5,[sp,#1]            ;863
000f92  f88d5002          STRB     r5,[sp,#2]            ;864
000f96  f88d5003          STRB     r5,[sp,#3]            ;865
000f9a  4669              MOV      r1,sp                 ;866
000f9c  f1040010          ADD      r0,r4,#0x10           ;866
000fa0  f7fffffe          BL       lc640_write_long_ptr
000fa4  f88d5000          STRB     r5,[sp,#0]            ;868
000fa8  f88d5001          STRB     r5,[sp,#1]            ;869
000fac  f88d5002          STRB     r5,[sp,#2]            ;870
000fb0  f88d5003          STRB     r5,[sp,#3]            ;871
000fb4  4669              MOV      r1,sp                 ;872
000fb6  f1040014          ADD      r0,r4,#0x14           ;872
000fba  f7fffffe          BL       lc640_write_long_ptr
000fbe  f88d5000          STRB     r5,[sp,#0]            ;874
000fc2  f88d5001          STRB     r5,[sp,#1]            ;875
000fc6  f88d5002          STRB     r5,[sp,#2]            ;876
000fca  f88d5003          STRB     r5,[sp,#3]            ;877
000fce  4669              MOV      r1,sp                 ;878
000fd0  f1040018          ADD      r0,r4,#0x18           ;878
000fd4  f7fffffe          BL       lc640_write_long_ptr
000fd8  f88d5000          STRB     r5,[sp,#0]            ;880
000fdc  f88d5001          STRB     r5,[sp,#1]            ;881
000fe0  f88d5002          STRB     r5,[sp,#2]            ;882
000fe4  f88d5003          STRB     r5,[sp,#3]            ;883
000fe8  4669              MOV      r1,sp                 ;884
000fea  f104001c          ADD      r0,r4,#0x1c           ;884
000fee  f7fffffe          BL       lc640_write_long_ptr
000ff2  2301              MOVS     r3,#1                 ;886
000ff4  461a              MOV      r2,r3                 ;886
000ff6  2105              MOVS     r1,#5                 ;886
000ff8  a0ff              ADR      r0,|L1.5112|
000ffa  f7fffffe          BL       snmp_trap_send
000ffe  e087              B        |L1.4368|
                  |L1.4096|
;;;891    	{
;;;892    	bat_ips._av&=~1;
001000  f0210101          BIC      r1,r1,#1
001004  f880103d          STRB     r1,[r0,#0x3d]
;;;893    	ips_bat_av_stat=0;
001008  f8849000          STRB     r9,[r4,#0]
;;;894    	ips_bat_av_vzvod=0;
00100c  f8839000          STRB     r9,[r3,#0]
;;;895         
;;;896    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
001010  4628              MOV      r0,r5
001012  f7fffffe          BL       lc640_read_int
001016  b286              UXTH     r6,r0
;;;897    	event_ptr_find=event_ptr;
001018  4634              MOV      r4,r6
                  |L1.4122|
;;;898    	
;;;899    avar_bat_ips_hndl_lbl1: 
;;;900    
;;;901    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
00101a  eb0a1044          ADD      r0,r10,r4,LSL #5
00101e  b285              UXTH     r5,r0
;;;902    
;;;903         lc640_read_long_ptr(lc640_adr,data);
001020  4669              MOV      r1,sp
001022  4628              MOV      r0,r5
001024  f7fffffe          BL       lc640_read_long_ptr
;;;904         
;;;905         if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
001028  f89d0000          LDRB     r0,[sp,#0]
00102c  2842              CMP      r0,#0x42
00102e  d106              BNE      |L1.4158|
001030  f89d0001          LDRB     r0,[sp,#1]
001034  b918              CBNZ     r0,|L1.4158|
001036  f89d0002          LDRB     r0,[sp,#2]
00103a  2843              CMP      r0,#0x43
00103c  d009              BEQ      |L1.4178|
                  |L1.4158|
;;;906         	{        
;;;907         	if(event_ptr_find)event_ptr_find--;
00103e  b11c              CBZ      r4,|L1.4168|
001040  f1a40401          SUB      r4,r4,#1
001044  b2a4              UXTH     r4,r4
001046  e001              B        |L1.4172|
                  |L1.4168|
;;;908         	else event_ptr_find=63;
001048  f04f043f          MOV      r4,#0x3f
                  |L1.4172|
;;;909         	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
00104c  42b4              CMP      r4,r6
00104e  d1e4              BNE      |L1.4122|
001050  e05e              B        |L1.4368|
                  |L1.4178|
;;;910         	else goto avar_bat_ips_hndl_lbl1;
;;;911         	}
;;;912         else 
;;;913         	{
;;;914         	lc640_read_long_ptr(lc640_adr+16,data);
001052  4669              MOV      r1,sp
001054  f1050010          ADD      r0,r5,#0x10
001058  f7fffffe          BL       lc640_read_long_ptr
;;;915         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00105c  f89d0000          LDRB     r0,[sp,#0]
001060  2841              CMP      r0,#0x41
001062  d10b              BNE      |L1.4220|
001064  f89d0001          LDRB     r0,[sp,#1]
001068  2841              CMP      r0,#0x41
00106a  d107              BNE      |L1.4220|
00106c  f89d0002          LDRB     r0,[sp,#2]
001070  2841              CMP      r0,#0x41
001072  d103              BNE      |L1.4220|
001074  f89d0003          LDRB     r0,[sp,#3]
001078  2841              CMP      r0,#0x41
00107a  d009              BEQ      |L1.4240|
                  |L1.4220|
;;;916         		{        
;;;917         		if(event_ptr_find)event_ptr_find--;
00107c  b11c              CBZ      r4,|L1.4230|
00107e  f1a40401          SUB      r4,r4,#1
001082  b2a4              UXTH     r4,r4
001084  e001              B        |L1.4234|
                  |L1.4230|
;;;918             		else event_ptr_find=63;
001086  f04f043f          MOV      r4,#0x3f
                  |L1.4234|
;;;919             	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
00108a  42b4              CMP      r4,r6
00108c  d1c5              BNE      |L1.4122|
00108e  e03f              B        |L1.4368|
                  |L1.4240|
;;;920         		else goto avar_bat_ips_hndl_lbl1;
;;;921         		}
;;;922    
;;;923         	}
;;;924         		
;;;925    	data[0]=LPC_RTC->YEAR;
001090  f8b8003c          LDRH     r0,[r8,#0x3c]
001094  f88d0000          STRB     r0,[sp,#0]
;;;926    	data[1]=LPC_RTC->MONTH;
001098  f8980038          LDRB     r0,[r8,#0x38]
00109c  f88d0001          STRB     r0,[sp,#1]
;;;927    	data[2]=LPC_RTC->DOM;
0010a0  f898002c          LDRB     r0,[r8,#0x2c]
0010a4  f88d0002          STRB     r0,[sp,#2]
;;;928    	data[3]=0;
0010a8  f88d9003          STRB     r9,[sp,#3]
;;;929    	lc640_write_long_ptr(lc640_adr+16,data);
0010ac  4669              MOV      r1,sp
0010ae  f1050010          ADD      r0,r5,#0x10
0010b2  f7fffffe          BL       lc640_write_long_ptr
;;;930    
;;;931    	data[0]=LPC_RTC->HOUR;
0010b6  f8980028          LDRB     r0,[r8,#0x28]
0010ba  f88d0000          STRB     r0,[sp,#0]
;;;932    	data[1]=LPC_RTC->MIN;
0010be  f8980024          LDRB     r0,[r8,#0x24]
0010c2  f88d0001          STRB     r0,[sp,#1]
;;;933    	data[2]=LPC_RTC->SEC;
0010c6  f8980020          LDRB     r0,[r8,#0x20]
0010ca  f88d0002          STRB     r0,[sp,#2]
;;;934    	data[3]=0;
0010ce  f88d9003          STRB     r9,[sp,#3]
;;;935    	lc640_write_long_ptr(lc640_adr+20,data);
0010d2  4669              MOV      r1,sp
0010d4  f1050014          ADD      r0,r5,#0x14
0010d8  f7fffffe          BL       lc640_write_long_ptr
;;;936    	
;;;937    	data[0]='B';
0010dc  f88d7000          STRB     r7,[sp,#0]
;;;938    	data[1]='B';
0010e0  f88d7001          STRB     r7,[sp,#1]
;;;939    	data[2]='B';
0010e4  f88d7002          STRB     r7,[sp,#2]
;;;940    	data[3]='B';
0010e8  f88d7003          STRB     r7,[sp,#3]
;;;941    	lc640_write_long_ptr(lc640_adr+24,data);
0010ec  4669              MOV      r1,sp
0010ee  f1050018          ADD      r0,r5,#0x18
0010f2  f7fffffe          BL       lc640_write_long_ptr
;;;942    	
;;;943    	data[0]='B';
0010f6  f88d7000          STRB     r7,[sp,#0]
;;;944    	data[1]='B';
0010fa  f88d7001          STRB     r7,[sp,#1]
;;;945    	data[2]='B';
0010fe  f88d7002          STRB     r7,[sp,#2]
;;;946    	data[3]='B';
001102  f88d7003          STRB     r7,[sp,#3]
;;;947    	lc640_write_long_ptr(lc640_adr+28,data);
001106  4669              MOV      r1,sp
001108  f105001c          ADD      r0,r5,#0x1c
00110c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4368|
;;;948    	
;;;949    
;;;950    	
;;;951    	}
;;;952    	
;;;953    avar_bat_ips_hndl_end:
;;;954    __nop();		
001110  bf00              NOP      
                  |L1.4370|
;;;955    }
001112  e56b              B        |L1.3052|
;;;956    
                          ENDP

                  avar_bat_hndl PROC
;;;959    //-----------------------------------------------
;;;960    void avar_bat_hndl(char b, char in)
001114  e92d4ff8          PUSH     {r3-r11,lr}
;;;961    {
001118  4606              MOV      r6,r0
;;;962    char data[4];
;;;963    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;964    
;;;965    if(in==1)
;;;966    	{
;;;967    	bat[b]._av|=1;
00111a  48bc              LDR      r0,|L1.5132|
00111c  eb060246          ADD      r2,r6,r6,LSL #1
;;;968        
;;;969    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;970    	event_ptr++;	
;;;971    	if(event_ptr>63)event_ptr=0;	
;;;972    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;973    	
;;;974         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;975    	if(event_cnt!=63)event_cnt=event_ptr;
;;;976    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;977    	
;;;978    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;979    	
;;;980    	data[0]='B';
;;;981    	data[1]=b;
;;;982    	data[2]='C';
;;;983    	data[3]=0;
;;;984    	lc640_write_long_ptr(lc640_adr,data);
;;;985    
;;;986    	data[0]=0;
;;;987    	data[1]=0;
;;;988    	data[2]=0;
;;;989    	data[3]=0;
;;;990    	lc640_write_long_ptr(lc640_adr+4,data);
;;;991    
;;;992    	data[0]=LPC_RTC->YEAR;
001120  f8df82ec          LDR      r8,|L1.5136|
001124  eb021206          ADD      r2,r2,r6,LSL #4       ;967
001128  f04f0a00          MOV      r10,#0                ;971
00112c  f04f0942          MOV      r9,#0x42              ;980
001130  f44f6560          MOV      r5,#0xe00             ;969
001134  f44f6b80          MOV      r11,#0x400            ;978
001138  eb000082          ADD      r0,r0,r2,LSL #2       ;967
00113c  2901              CMP      r1,#1                 ;965
00113e  d002              BEQ      |L1.4422|
;;;993    	data[1]=LPC_RTC->MONTH;
;;;994    	data[2]=LPC_RTC->DOM;
;;;995    	data[3]=0;
;;;996    	lc640_write_long_ptr(lc640_adr+8,data);
;;;997    
;;;998    	data[0]=LPC_RTC->HOUR;
;;;999    	data[1]=LPC_RTC->MIN;
;;;1000   	data[2]=LPC_RTC->SEC;
;;;1001   	data[3]=0;
;;;1002   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1003   	
;;;1004   	data[0]='A';
;;;1005   	data[1]='A';
;;;1006   	data[2]='A';
;;;1007   	data[3]='A';
;;;1008   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1009   	
;;;1010   	data[0]='A';
;;;1011   	data[1]='A';
;;;1012   	data[2]='A';
;;;1013   	data[3]='A';
;;;1014   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1015   	
;;;1016   	data[0]='A';
;;;1017   	data[1]='A';
;;;1018   	data[2]='A';
;;;1019   	data[3]='A';
;;;1020   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1021   	
;;;1022   	data[0]='A';
;;;1023   	data[1]='A';
;;;1024   	data[2]='A';
;;;1025   	data[3]='A';
;;;1026   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1027   					
;;;1028   	if(b==0)
;;;1029   		{
;;;1030   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1031   		}
;;;1032   	else if(b==1)
;;;1033   		{
;;;1034   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1035   		} 
;;;1036   			
;;;1037   	}
;;;1038   
;;;1039   else if(in==0)
001140  2900              CMP      r1,#0
001142  d07d              BEQ      |L1.4672|
001144  e12f              B        |L1.5030|
                  |L1.4422|
001146  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;967
00114a  f0410101          ORR      r1,r1,#1              ;967
00114e  7001              STRB     r1,[r0,#0]            ;967
001150  4628              MOV      r0,r5                 ;969
001152  f7fffffe          BL       lc640_read_int
001156  f1000001          ADD      r0,r0,#1              ;970
00115a  b284              UXTH     r4,r0                 ;970
00115c  2c3f              CMP      r4,#0x3f              ;971
00115e  d901              BLS      |L1.4452|
001160  f04f0400          MOV      r4,#0                 ;971
                  |L1.4452|
001164  b221              SXTH     r1,r4                 ;972
001166  4628              MOV      r0,r5                 ;972
001168  f7fffffe          BL       lc640_write_int
00116c  f6406702          MOV      r7,#0xe02             ;974
001170  4638              MOV      r0,r7                 ;974
001172  f7fffffe          BL       lc640_read_int
001176  b280              UXTH     r0,r0                 ;974
001178  283f              CMP      r0,#0x3f              ;975
00117a  d000              BEQ      |L1.4478|
00117c  4620              MOV      r0,r4                 ;975
                  |L1.4478|
00117e  b201              SXTH     r1,r0                 ;976
001180  4638              MOV      r0,r7                 ;976
001182  f7fffffe          BL       lc640_write_int
001186  4628              MOV      r0,r5                 ;978
001188  f7fffffe          BL       lc640_read_int
00118c  eb0b1040          ADD      r0,r11,r0,LSL #5      ;978
001190  b284              UXTH     r4,r0                 ;978
001192  f88d9000          STRB     r9,[sp,#0]            ;980
001196  f88d6001          STRB     r6,[sp,#1]            ;981
00119a  f04f0043          MOV      r0,#0x43              ;982
00119e  f88d0002          STRB     r0,[sp,#2]            ;982
0011a2  f88da003          STRB     r10,[sp,#3]           ;983
0011a6  4669              MOV      r1,sp                 ;984
0011a8  4620              MOV      r0,r4                 ;984
0011aa  f7fffffe          BL       lc640_write_long_ptr
0011ae  f8cda000          STR      r10,[sp,#0]           ;989
0011b2  4669              MOV      r1,sp                 ;990
0011b4  1d20              ADDS     r0,r4,#4              ;990
0011b6  f7fffffe          BL       lc640_write_long_ptr
0011ba  f8b8003c          LDRH     r0,[r8,#0x3c]         ;992
0011be  f88d0000          STRB     r0,[sp,#0]            ;992
0011c2  f8980038          LDRB     r0,[r8,#0x38]         ;993
0011c6  f88d0001          STRB     r0,[sp,#1]            ;993
0011ca  f898002c          LDRB     r0,[r8,#0x2c]         ;994
0011ce  f88d0002          STRB     r0,[sp,#2]            ;994
0011d2  f88da003          STRB     r10,[sp,#3]           ;995
0011d6  4669              MOV      r1,sp                 ;996
0011d8  f1040008          ADD      r0,r4,#8              ;996
0011dc  f7fffffe          BL       lc640_write_long_ptr
0011e0  f8980028          LDRB     r0,[r8,#0x28]         ;998
0011e4  f88d0000          STRB     r0,[sp,#0]            ;998
0011e8  f8980024          LDRB     r0,[r8,#0x24]         ;999
0011ec  f88d0001          STRB     r0,[sp,#1]            ;999
0011f0  f8980020          LDRB     r0,[r8,#0x20]         ;1000
0011f4  f88d0002          STRB     r0,[sp,#2]            ;1000
0011f8  f88da003          STRB     r10,[sp,#3]           ;1001
0011fc  4669              MOV      r1,sp                 ;1002
0011fe  f104000c          ADD      r0,r4,#0xc            ;1002
001202  f7fffffe          BL       lc640_write_long_ptr
001206  f04f0541          MOV      r5,#0x41              ;1004
00120a  f88d5000          STRB     r5,[sp,#0]            ;1004
00120e  f88d5001          STRB     r5,[sp,#1]            ;1005
001212  f88d5002          STRB     r5,[sp,#2]            ;1006
001216  f88d5003          STRB     r5,[sp,#3]            ;1007
00121a  4669              MOV      r1,sp                 ;1008
00121c  f1040010          ADD      r0,r4,#0x10           ;1008
001220  f7fffffe          BL       lc640_write_long_ptr
001224  f88d5000          STRB     r5,[sp,#0]            ;1010
001228  f88d5001          STRB     r5,[sp,#1]            ;1011
00122c  f88d5002          STRB     r5,[sp,#2]            ;1012
001230  f88d5003          STRB     r5,[sp,#3]            ;1013
001234  4669              MOV      r1,sp                 ;1014
001236  f1040014          ADD      r0,r4,#0x14           ;1014
00123a  f7fffffe          BL       lc640_write_long_ptr
00123e  e000              B        |L1.4674|
                  |L1.4672|
001240  e02b              B        |L1.4762|
                  |L1.4674|
001242  f88d5000          STRB     r5,[sp,#0]            ;1016
001246  f88d5001          STRB     r5,[sp,#1]            ;1017
00124a  f88d5002          STRB     r5,[sp,#2]            ;1018
00124e  f88d5003          STRB     r5,[sp,#3]            ;1019
001252  4669              MOV      r1,sp                 ;1020
001254  f1040018          ADD      r0,r4,#0x18           ;1020
001258  f7fffffe          BL       lc640_write_long_ptr
00125c  f88d5000          STRB     r5,[sp,#0]            ;1022
001260  f88d5001          STRB     r5,[sp,#1]            ;1023
001264  f88d5002          STRB     r5,[sp,#2]            ;1024
001268  f88d5003          STRB     r5,[sp,#3]            ;1025
00126c  4669              MOV      r1,sp                 ;1026
00126e  f104001c          ADD      r0,r4,#0x1c           ;1026
001272  f7fffffe          BL       lc640_write_long_ptr
001276  b116              CBZ      r6,|L1.4734|
001278  2e01              CMP      r6,#1                 ;1032
00127a  d007              BEQ      |L1.4748|
00127c  e093              B        |L1.5030|
                  |L1.4734|
00127e  2301              MOVS     r3,#1                 ;1030
001280  461a              MOV      r2,r3                 ;1030
001282  2105              MOVS     r1,#5                 ;1030
001284  a063              ADR      r0,|L1.5140|
001286  f7fffffe          BL       snmp_trap_send
00128a  e08c              B        |L1.5030|
                  |L1.4748|
00128c  2301              MOVS     r3,#1                 ;1034
00128e  2202              MOVS     r2,#2                 ;1034
001290  2105              MOVS     r1,#5                 ;1034
001292  a065              ADR      r0,|L1.5160|
001294  f7fffffe          BL       snmp_trap_send
001298  e085              B        |L1.5030|
                  |L1.4762|
;;;1040   	{
;;;1041   	bat[b]._av&=~1;
00129a  f8101f3d          LDRB     r1,[r0,#0x3d]!
00129e  f0210101          BIC      r1,r1,#1
0012a2  7001              STRB     r1,[r0,#0]
;;;1042   
;;;1043        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0012a4  4628              MOV      r0,r5
0012a6  f7fffffe          BL       lc640_read_int
0012aa  b287              UXTH     r7,r0
;;;1044   	event_ptr_find=event_ptr;
0012ac  463c              MOV      r4,r7
                  |L1.4782|
;;;1045   	
;;;1046   avar_bat_hndl_lbl1: 
;;;1047   
;;;1048   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0012ae  eb0b1044          ADD      r0,r11,r4,LSL #5
0012b2  b285              UXTH     r5,r0
;;;1049   
;;;1050        lc640_read_long_ptr(lc640_adr,data);
0012b4  4669              MOV      r1,sp
0012b6  4628              MOV      r0,r5
0012b8  f7fffffe          BL       lc640_read_long_ptr
;;;1051        
;;;1052        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
0012bc  f89d0000          LDRB     r0,[sp,#0]
0012c0  2842              CMP      r0,#0x42
0012c2  d107              BNE      |L1.4820|
0012c4  f89d0001          LDRB     r0,[sp,#1]
0012c8  42b0              CMP      r0,r6
0012ca  d103              BNE      |L1.4820|
0012cc  f89d0002          LDRB     r0,[sp,#2]
0012d0  2843              CMP      r0,#0x43
0012d2  d009              BEQ      |L1.4840|
                  |L1.4820|
;;;1053        	{        
;;;1054        	if(event_ptr_find)event_ptr_find--;
0012d4  b11c              CBZ      r4,|L1.4830|
0012d6  f1a40401          SUB      r4,r4,#1
0012da  b2a4              UXTH     r4,r4
0012dc  e001              B        |L1.4834|
                  |L1.4830|
;;;1055        	else event_ptr_find=63;
0012de  f04f043f          MOV      r4,#0x3f
                  |L1.4834|
;;;1056        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
0012e2  42bc              CMP      r4,r7
0012e4  d1e3              BNE      |L1.4782|
0012e6  e05e              B        |L1.5030|
                  |L1.4840|
;;;1057        	else goto avar_bat_hndl_lbl1;
;;;1058        	}
;;;1059        else 
;;;1060        	{
;;;1061        	lc640_read_long_ptr(lc640_adr+16,data);
0012e8  4669              MOV      r1,sp
0012ea  f1050010          ADD      r0,r5,#0x10
0012ee  f7fffffe          BL       lc640_read_long_ptr
;;;1062        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0012f2  f89d0000          LDRB     r0,[sp,#0]
0012f6  2841              CMP      r0,#0x41
0012f8  d10b              BNE      |L1.4882|
0012fa  f89d0001          LDRB     r0,[sp,#1]
0012fe  2841              CMP      r0,#0x41
001300  d107              BNE      |L1.4882|
001302  f89d0002          LDRB     r0,[sp,#2]
001306  2841              CMP      r0,#0x41
001308  d103              BNE      |L1.4882|
00130a  f89d0003          LDRB     r0,[sp,#3]
00130e  2841              CMP      r0,#0x41
001310  d009              BEQ      |L1.4902|
                  |L1.4882|
;;;1063        		{        
;;;1064        		if(event_ptr_find)event_ptr_find--;
001312  b11c              CBZ      r4,|L1.4892|
001314  f1a40401          SUB      r4,r4,#1
001318  b2a4              UXTH     r4,r4
00131a  e001              B        |L1.4896|
                  |L1.4892|
;;;1065            		else event_ptr_find=63;
00131c  f04f043f          MOV      r4,#0x3f
                  |L1.4896|
;;;1066            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
001320  42bc              CMP      r4,r7
001322  d1c4              BNE      |L1.4782|
001324  e03f              B        |L1.5030|
                  |L1.4902|
;;;1067        		else goto avar_bat_hndl_lbl1;
;;;1068        		}
;;;1069   
;;;1070        	}
;;;1071        		
;;;1072   	data[0]=LPC_RTC->YEAR;
001326  f8b8003c          LDRH     r0,[r8,#0x3c]
00132a  f88d0000          STRB     r0,[sp,#0]
;;;1073   	data[1]=LPC_RTC->MONTH;
00132e  f8980038          LDRB     r0,[r8,#0x38]
001332  f88d0001          STRB     r0,[sp,#1]
;;;1074   	data[2]=LPC_RTC->DOM;
001336  f898002c          LDRB     r0,[r8,#0x2c]
00133a  f88d0002          STRB     r0,[sp,#2]
;;;1075   	data[3]=0;
00133e  f88da003          STRB     r10,[sp,#3]
;;;1076   	lc640_write_long_ptr(lc640_adr+16,data);
001342  4669              MOV      r1,sp
001344  f1050010          ADD      r0,r5,#0x10
001348  f7fffffe          BL       lc640_write_long_ptr
;;;1077   
;;;1078   	data[0]=LPC_RTC->HOUR;
00134c  f8980028          LDRB     r0,[r8,#0x28]
001350  f88d0000          STRB     r0,[sp,#0]
;;;1079   	data[1]=LPC_RTC->MIN;
001354  f8980024          LDRB     r0,[r8,#0x24]
001358  f88d0001          STRB     r0,[sp,#1]
;;;1080   	data[2]=LPC_RTC->SEC;
00135c  f8980020          LDRB     r0,[r8,#0x20]
001360  f88d0002          STRB     r0,[sp,#2]
;;;1081   	data[3]=0;
001364  f88da003          STRB     r10,[sp,#3]
;;;1082   	lc640_write_long_ptr(lc640_adr+20,data);
001368  4669              MOV      r1,sp
00136a  f1050014          ADD      r0,r5,#0x14
00136e  f7fffffe          BL       lc640_write_long_ptr
;;;1083   	
;;;1084   	data[0]='B';
001372  f88d9000          STRB     r9,[sp,#0]
;;;1085   	data[1]='B';
001376  f88d9001          STRB     r9,[sp,#1]
;;;1086   	data[2]='B';
00137a  f88d9002          STRB     r9,[sp,#2]
;;;1087   	data[3]='B';
00137e  f88d9003          STRB     r9,[sp,#3]
;;;1088   	lc640_write_long_ptr(lc640_adr+24,data);
001382  4669              MOV      r1,sp
001384  f1050018          ADD      r0,r5,#0x18
001388  f7fffffe          BL       lc640_write_long_ptr
;;;1089   	
;;;1090   	data[0]='B';
00138c  f88d9000          STRB     r9,[sp,#0]
;;;1091   	data[1]='B';
001390  f88d9001          STRB     r9,[sp,#1]
;;;1092   	data[2]='B';
001394  f88d9002          STRB     r9,[sp,#2]
;;;1093   	data[3]='B';
001398  f88d9003          STRB     r9,[sp,#3]
;;;1094   	lc640_write_long_ptr(lc640_adr+28,data);
00139c  4669              MOV      r1,sp
00139e  f105001c          ADD      r0,r5,#0x1c
0013a2  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5030|
;;;1095   	
;;;1096   
;;;1097   	
;;;1098   	}
;;;1099   	
;;;1100   avar_bat_hndl_end:
;;;1101   __nop();		
0013a6  bf00              NOP      
                  |L1.5032|
;;;1102   }
0013a8  e420              B        |L1.3052|
;;;1103   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1104   //-----------------------------------------------
;;;1105   void avar_bat_as_hndl(char b, char in)
0013aa  e92d4ff8          PUSH     {r3-r11,lr}
;;;1106   {
0013ae  4606              MOV      r6,r0
;;;1107   char data[4];
;;;1108   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1109   
;;;1110   if(in==1)
;;;1111   	{
;;;1112   	bat[b]._av|=2;
;;;1113       
;;;1114   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1115   	event_ptr++;	
;;;1116   	if(event_ptr>63)event_ptr=0;	
;;;1117   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1118   	
;;;1119        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1120   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1121   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1122   	
;;;1123   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1124   	
;;;1125   	data[0]='B';
;;;1126   	data[1]=b;
;;;1127   	data[2]='S';
;;;1128   	data[3]=0;
;;;1129   	lc640_write_long_ptr(lc640_adr,data);
;;;1130   
;;;1131   	data[0]=0;
;;;1132   	data[1]=0;
;;;1133   	data[2]=0;
;;;1134   	data[3]=0;
;;;1135   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1136   
;;;1137   	data[0]=LPC_RTC->YEAR;
0013b0  f8df805c          LDR      r8,|L1.5136|
0013b4  f04f0a00          MOV      r10,#0                ;1116
0013b8  f04f0942          MOV      r9,#0x42              ;1125
0013bc  f44f6560          MOV      r5,#0xe00             ;1114
0013c0  f44f6b80          MOV      r11,#0x400            ;1123
0013c4  2901              CMP      r1,#1                 ;1110
0013c6  d002              BEQ      |L1.5070|
;;;1138   	data[1]=LPC_RTC->MONTH;
;;;1139   	data[2]=LPC_RTC->DOM;
;;;1140   	data[3]=0;
;;;1141   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1142   
;;;1143   	data[0]=LPC_RTC->HOUR;
;;;1144   	data[1]=LPC_RTC->MIN;
;;;1145   	data[2]=LPC_RTC->SEC;
;;;1146   	data[3]=0;
;;;1147   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1148   	
;;;1149   	data[0]='A';
;;;1150   	data[1]='A';
;;;1151   	data[2]='A';
;;;1152   	data[3]='A';
;;;1153   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1154   	
;;;1155   	data[0]='A';
;;;1156   	data[1]='A';
;;;1157   	data[2]='A';
;;;1158   	data[3]='A';
;;;1159   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1160   	
;;;1161   	data[0]='A';
;;;1162   	data[1]='A';
;;;1163   	data[2]='A';
;;;1164   	data[3]='A';
;;;1165   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1166   	
;;;1167   	data[0]='A';
;;;1168   	data[1]='A';
;;;1169   	data[2]='A';
;;;1170   	data[3]='A';
;;;1171   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1172   
;;;1173   	if(b==0)
;;;1174   		{
;;;1175   		snmp_trap_send("BAT #1 Alarm, assimetry",5,1,2);
;;;1176   		}
;;;1177   	else if(b==1)
;;;1178   		{
;;;1179   		snmp_trap_send("BAT #2 Alarm, assimetry",5,2,2);
;;;1180   		} 
;;;1181   	
;;;1182   	}
;;;1183   
;;;1184   else if(in==0)
0013c8  2900              CMP      r1,#0
0013ca  d07e              BEQ      |L1.5322|
0013cc  e154              B        |L1.5752|
                  |L1.5070|
0013ce  eb060046          ADD      r0,r6,r6,LSL #1       ;1112
0013d2  eb001106          ADD      r1,r0,r6,LSL #4       ;1112
0013d6  480d              LDR      r0,|L1.5132|
0013d8  eb000081          ADD      r0,r0,r1,LSL #2       ;1112
0013dc  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1112
0013e0  f0410102          ORR      r1,r1,#2              ;1112
0013e4  7001              STRB     r1,[r0,#0]            ;1112
0013e6  4628              MOV      r0,r5                 ;1114
0013e8  f7fffffe          BL       lc640_read_int
0013ec  f1000001          ADD      r0,r0,#1              ;1115
0013f0  b284              UXTH     r4,r0                 ;1115
0013f2  2c3f              CMP      r4,#0x3f              ;1116
0013f4  d924              BLS      |L1.5184|
0013f6  e021              B        |L1.5180|
                  |L1.5112|
0013f8  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
0013fc  b9312041
001400  6c61726d
001404  2c206c6f
001408  737400  
00140b  00                DCB      0
                  |L1.5132|
                          DCD      bat
                  |L1.5136|
                          DCD      0x40024000
                  |L1.5140|
001414  42415420          DCB      "BAT #1 Alarm, lost",0
001418  23312041
00141c  6c61726d
001420  2c206c6f
001424  737400  
001427  00                DCB      0
                  |L1.5160|
001428  42415420          DCB      "BAT #2 Alarm, lost",0
00142c  23322041
001430  6c61726d
001434  2c206c6f
001438  737400  
00143b  00                DCB      0
                  |L1.5180|
00143c  f04f0400          MOV      r4,#0                 ;1116
                  |L1.5184|
001440  b221              SXTH     r1,r4                 ;1117
001442  4628              MOV      r0,r5                 ;1117
001444  f7fffffe          BL       lc640_write_int
001448  f6406702          MOV      r7,#0xe02             ;1119
00144c  4638              MOV      r0,r7                 ;1119
00144e  f7fffffe          BL       lc640_read_int
001452  b280              UXTH     r0,r0                 ;1119
001454  283f              CMP      r0,#0x3f              ;1120
001456  d000              BEQ      |L1.5210|
001458  4620              MOV      r0,r4                 ;1120
                  |L1.5210|
00145a  b201              SXTH     r1,r0                 ;1121
00145c  4638              MOV      r0,r7                 ;1121
00145e  f7fffffe          BL       lc640_write_int
001462  4628              MOV      r0,r5                 ;1123
001464  f7fffffe          BL       lc640_read_int
001468  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1123
00146c  b284              UXTH     r4,r0                 ;1123
00146e  f88d9000          STRB     r9,[sp,#0]            ;1125
001472  f88d6001          STRB     r6,[sp,#1]            ;1126
001476  f04f0053          MOV      r0,#0x53              ;1127
00147a  f88d0002          STRB     r0,[sp,#2]            ;1127
00147e  f88da003          STRB     r10,[sp,#3]           ;1128
001482  4669              MOV      r1,sp                 ;1129
001484  4620              MOV      r0,r4                 ;1129
001486  f7fffffe          BL       lc640_write_long_ptr
00148a  f8cda000          STR      r10,[sp,#0]           ;1134
00148e  4669              MOV      r1,sp                 ;1135
001490  1d20              ADDS     r0,r4,#4              ;1135
001492  f7fffffe          BL       lc640_write_long_ptr
001496  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1137
00149a  f88d0000          STRB     r0,[sp,#0]            ;1137
00149e  f8980038          LDRB     r0,[r8,#0x38]         ;1138
0014a2  f88d0001          STRB     r0,[sp,#1]            ;1138
0014a6  f898002c          LDRB     r0,[r8,#0x2c]         ;1139
0014aa  f88d0002          STRB     r0,[sp,#2]            ;1139
0014ae  f88da003          STRB     r10,[sp,#3]           ;1140
0014b2  4669              MOV      r1,sp                 ;1141
0014b4  f1040008          ADD      r0,r4,#8              ;1141
0014b8  f7fffffe          BL       lc640_write_long_ptr
0014bc  f8980028          LDRB     r0,[r8,#0x28]         ;1143
0014c0  f88d0000          STRB     r0,[sp,#0]            ;1143
0014c4  f8980024          LDRB     r0,[r8,#0x24]         ;1144
0014c8  e000              B        |L1.5324|
                  |L1.5322|
0014ca  e054              B        |L1.5494|
                  |L1.5324|
0014cc  f88d0001          STRB     r0,[sp,#1]            ;1144
0014d0  f8980020          LDRB     r0,[r8,#0x20]         ;1145
0014d4  f88d0002          STRB     r0,[sp,#2]            ;1145
0014d8  f88da003          STRB     r10,[sp,#3]           ;1146
0014dc  4669              MOV      r1,sp                 ;1147
0014de  f104000c          ADD      r0,r4,#0xc            ;1147
0014e2  f7fffffe          BL       lc640_write_long_ptr
0014e6  f04f0541          MOV      r5,#0x41              ;1149
0014ea  f88d5000          STRB     r5,[sp,#0]            ;1149
0014ee  f88d5001          STRB     r5,[sp,#1]            ;1150
0014f2  f88d5002          STRB     r5,[sp,#2]            ;1151
0014f6  f88d5003          STRB     r5,[sp,#3]            ;1152
0014fa  4669              MOV      r1,sp                 ;1153
0014fc  f1040010          ADD      r0,r4,#0x10           ;1153
001500  f7fffffe          BL       lc640_write_long_ptr
001504  f88d5000          STRB     r5,[sp,#0]            ;1155
001508  f88d5001          STRB     r5,[sp,#1]            ;1156
00150c  f88d5002          STRB     r5,[sp,#2]            ;1157
001510  f88d5003          STRB     r5,[sp,#3]            ;1158
001514  4669              MOV      r1,sp                 ;1159
001516  f1040014          ADD      r0,r4,#0x14           ;1159
00151a  f7fffffe          BL       lc640_write_long_ptr
00151e  f88d5000          STRB     r5,[sp,#0]            ;1161
001522  f88d5001          STRB     r5,[sp,#1]            ;1162
001526  f88d5002          STRB     r5,[sp,#2]            ;1163
00152a  f88d5003          STRB     r5,[sp,#3]            ;1164
00152e  4669              MOV      r1,sp                 ;1165
001530  f1040018          ADD      r0,r4,#0x18           ;1165
001534  f7fffffe          BL       lc640_write_long_ptr
001538  f88d5000          STRB     r5,[sp,#0]            ;1167
00153c  f88d5001          STRB     r5,[sp,#1]            ;1168
001540  f88d5002          STRB     r5,[sp,#2]            ;1169
001544  f88d5003          STRB     r5,[sp,#3]            ;1170
001548  4669              MOV      r1,sp                 ;1171
00154a  f104001c          ADD      r0,r4,#0x1c           ;1171
00154e  f7fffffe          BL       lc640_write_long_ptr
001552  b116              CBZ      r6,|L1.5466|
001554  2e01              CMP      r6,#1                 ;1177
001556  d007              BEQ      |L1.5480|
001558  e08e              B        |L1.5752|
                  |L1.5466|
00155a  2302              MOVS     r3,#2                 ;1175
00155c  2201              MOVS     r2,#1                 ;1175
00155e  2105              MOVS     r1,#5                 ;1175
001560  a0fb              ADR      r0,|L1.6480|
001562  f7fffffe          BL       snmp_trap_send
001566  e087              B        |L1.5752|
                  |L1.5480|
001568  2302              MOVS     r3,#2                 ;1179
00156a  461a              MOV      r2,r3                 ;1179
00156c  2105              MOVS     r1,#5                 ;1179
00156e  a0fe              ADR      r0,|L1.6504|
001570  f7fffffe          BL       snmp_trap_send
001574  e080              B        |L1.5752|
                  |L1.5494|
;;;1185   	{
;;;1186   	//bat[b]._av=0;
;;;1187   
;;;1188        event_ptr=lc640_read_int(PTR_EVENT_LOG);
001576  4628              MOV      r0,r5
001578  f7fffffe          BL       lc640_read_int
00157c  b287              UXTH     r7,r0
;;;1189   	event_ptr_find=event_ptr;
00157e  463c              MOV      r4,r7
                  |L1.5504|
;;;1190   	
;;;1191   avar_bat_as_hndl_lbl1: 
;;;1192   
;;;1193   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001580  eb0b1044          ADD      r0,r11,r4,LSL #5
001584  b285              UXTH     r5,r0
;;;1194   
;;;1195        lc640_read_long_ptr(lc640_adr,data);
001586  4669              MOV      r1,sp
001588  4628              MOV      r0,r5
00158a  f7fffffe          BL       lc640_read_long_ptr
;;;1196        
;;;1197        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
00158e  f89d0000          LDRB     r0,[sp,#0]
001592  2842              CMP      r0,#0x42
001594  d107              BNE      |L1.5542|
001596  f89d0001          LDRB     r0,[sp,#1]
00159a  42b0              CMP      r0,r6
00159c  d103              BNE      |L1.5542|
00159e  f89d0002          LDRB     r0,[sp,#2]
0015a2  2843              CMP      r0,#0x43
0015a4  d009              BEQ      |L1.5562|
                  |L1.5542|
;;;1198        	{        
;;;1199        	if(event_ptr_find)event_ptr_find--;
0015a6  b11c              CBZ      r4,|L1.5552|
0015a8  f1a40401          SUB      r4,r4,#1
0015ac  b2a4              UXTH     r4,r4
0015ae  e001              B        |L1.5556|
                  |L1.5552|
;;;1200        	else event_ptr_find=63;
0015b0  f04f043f          MOV      r4,#0x3f
                  |L1.5556|
;;;1201        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
0015b4  42bc              CMP      r4,r7
0015b6  d1e3              BNE      |L1.5504|
0015b8  e05e              B        |L1.5752|
                  |L1.5562|
;;;1202        	else goto avar_bat_as_hndl_lbl1;
;;;1203        	}
;;;1204        else 
;;;1205        	{
;;;1206        	lc640_read_long_ptr(lc640_adr+16,data);
0015ba  4669              MOV      r1,sp
0015bc  f1050010          ADD      r0,r5,#0x10
0015c0  f7fffffe          BL       lc640_read_long_ptr
;;;1207        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0015c4  f89d0000          LDRB     r0,[sp,#0]
0015c8  2841              CMP      r0,#0x41
0015ca  d10b              BNE      |L1.5604|
0015cc  f89d0001          LDRB     r0,[sp,#1]
0015d0  2841              CMP      r0,#0x41
0015d2  d107              BNE      |L1.5604|
0015d4  f89d0002          LDRB     r0,[sp,#2]
0015d8  2841              CMP      r0,#0x41
0015da  d103              BNE      |L1.5604|
0015dc  f89d0003          LDRB     r0,[sp,#3]
0015e0  2841              CMP      r0,#0x41
0015e2  d009              BEQ      |L1.5624|
                  |L1.5604|
;;;1208        		{        
;;;1209        		if(event_ptr_find)event_ptr_find--;
0015e4  b11c              CBZ      r4,|L1.5614|
0015e6  f1a40401          SUB      r4,r4,#1
0015ea  b2a4              UXTH     r4,r4
0015ec  e001              B        |L1.5618|
                  |L1.5614|
;;;1210            		else event_ptr_find=63;
0015ee  f04f043f          MOV      r4,#0x3f
                  |L1.5618|
;;;1211            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
0015f2  42bc              CMP      r4,r7
0015f4  d1c4              BNE      |L1.5504|
0015f6  e03f              B        |L1.5752|
                  |L1.5624|
;;;1212        		else goto avar_bat_as_hndl_lbl1;
;;;1213        		}
;;;1214   
;;;1215        	}
;;;1216        		
;;;1217   	data[0]=LPC_RTC->YEAR;
0015f8  f8b8003c          LDRH     r0,[r8,#0x3c]
0015fc  f88d0000          STRB     r0,[sp,#0]
;;;1218   	data[1]=LPC_RTC->MONTH;
001600  f8980038          LDRB     r0,[r8,#0x38]
001604  f88d0001          STRB     r0,[sp,#1]
;;;1219   	data[2]=LPC_RTC->DOM;
001608  f898002c          LDRB     r0,[r8,#0x2c]
00160c  f88d0002          STRB     r0,[sp,#2]
;;;1220   	data[3]=0;
001610  f88da003          STRB     r10,[sp,#3]
;;;1221   	lc640_write_long_ptr(lc640_adr+16,data);
001614  4669              MOV      r1,sp
001616  f1050010          ADD      r0,r5,#0x10
00161a  f7fffffe          BL       lc640_write_long_ptr
;;;1222   
;;;1223   	data[0]=LPC_RTC->HOUR;
00161e  f8980028          LDRB     r0,[r8,#0x28]
001622  f88d0000          STRB     r0,[sp,#0]
;;;1224   	data[1]=LPC_RTC->MIN;
001626  f8980024          LDRB     r0,[r8,#0x24]
00162a  f88d0001          STRB     r0,[sp,#1]
;;;1225   	data[2]=LPC_RTC->SEC;
00162e  f8980020          LDRB     r0,[r8,#0x20]
001632  f88d0002          STRB     r0,[sp,#2]
;;;1226   	data[3]=0;
001636  f88da003          STRB     r10,[sp,#3]
;;;1227   	lc640_write_long_ptr(lc640_adr+20,data);
00163a  4669              MOV      r1,sp
00163c  f1050014          ADD      r0,r5,#0x14
001640  f7fffffe          BL       lc640_write_long_ptr
;;;1228   	
;;;1229   	data[0]='B';
001644  f88d9000          STRB     r9,[sp,#0]
;;;1230   	data[1]='B';
001648  f88d9001          STRB     r9,[sp,#1]
;;;1231   	data[2]='B';
00164c  f88d9002          STRB     r9,[sp,#2]
;;;1232   	data[3]='B';
001650  f88d9003          STRB     r9,[sp,#3]
;;;1233   	lc640_write_long_ptr(lc640_adr+24,data);
001654  4669              MOV      r1,sp
001656  f1050018          ADD      r0,r5,#0x18
00165a  f7fffffe          BL       lc640_write_long_ptr
;;;1234   	
;;;1235   	data[0]='B';
00165e  f88d9000          STRB     r9,[sp,#0]
;;;1236   	data[1]='B';
001662  f88d9001          STRB     r9,[sp,#1]
;;;1237   	data[2]='B';
001666  f88d9002          STRB     r9,[sp,#2]
;;;1238   	data[3]='B';
00166a  f88d9003          STRB     r9,[sp,#3]
;;;1239   	lc640_write_long_ptr(lc640_adr+28,data);
00166e  4669              MOV      r1,sp
001670  f105001c          ADD      r0,r5,#0x1c
001674  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5752|
;;;1240   	
;;;1241   
;;;1242   	
;;;1243   	}
;;;1244   	
;;;1245   avar_bat_as_hndl_end:
;;;1246   __nop();		
001678  bf00              NOP      
;;;1247   }
00167a  e54a              B        |L1.4370|
;;;1248   
                          ENDP

                  ke_mem_hndl PROC
;;;1250   //-----------------------------------------------
;;;1251   void ke_mem_hndl(char b,unsigned short in)
00167c  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;1252   {
00167e  b083              SUB      sp,sp,#0xc
001680  4605              MOV      r5,r0
;;;1253   char data[4];
;;;1254   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1255   //unsigned char temp,temp_;
;;;1256   //unsigned int tempUI;
;;;1257   //unsigned long tempUL; 
;;;1258   signed temp_temp;
;;;1259   
;;;1260   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
001682  eb050045          ADD      r0,r5,r5,LSL #1
001686  49be              LDR      r1,|L1.6528|
001688  eb001005          ADD      r0,r0,r5,LSL #4
00168c  eb010180          ADD      r1,r1,r0,LSL #2
001690  48bc              LDR      r0,|L1.6532|
001692  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
001696  f1000001          ADD      r0,r0,#1
00169a  eb010040          ADD      r0,r1,r0,LSL #1
00169e  f9b00020          LDRSH    r0,[r0,#0x20]
0016a2  9001              STR      r0,[sp,#4]
;;;1261   
;;;1262   event_ptr=lc640_read_int(PTR_EVENT_LOG);
0016a4  f44f6660          MOV      r6,#0xe00
0016a8  4630              MOV      r0,r6
0016aa  f7fffffe          BL       lc640_read_int
;;;1263   event_ptr++;	
0016ae  f1000001          ADD      r0,r0,#1
0016b2  4604              MOV      r4,r0
;;;1264   if(event_ptr>63)event_ptr=0;	
0016b4  2c3f              CMP      r4,#0x3f
0016b6  d901              BLS      |L1.5820|
0016b8  f04f0400          MOV      r4,#0
                  |L1.5820|
;;;1265   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
0016bc  b221              SXTH     r1,r4
0016be  4630              MOV      r0,r6
0016c0  f7fffffe          BL       lc640_write_int
;;;1266   	
;;;1267   event_cnt=lc640_read_int(CNT_EVENT_LOG);
0016c4  f6406702          MOV      r7,#0xe02
0016c8  4638              MOV      r0,r7
0016ca  f7fffffe          BL       lc640_read_int
;;;1268   if(event_cnt!=63)event_cnt=event_ptr;
0016ce  283f              CMP      r0,#0x3f
0016d0  d000              BEQ      |L1.5844|
0016d2  4620              MOV      r0,r4
                  |L1.5844|
;;;1269   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
0016d4  b201              SXTH     r1,r0
0016d6  4638              MOV      r0,r7
0016d8  f7fffffe          BL       lc640_write_int
;;;1270   	
;;;1271   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
0016dc  4630              MOV      r0,r6
0016de  f7fffffe          BL       lc640_read_int
0016e2  f44f6180          MOV      r1,#0x400
0016e6  eb011440          ADD      r4,r1,r0,LSL #5
;;;1272   	
;;;1273   data[0]='B';
0016ea  f04f0042          MOV      r0,#0x42
0016ee  f88d0008          STRB     r0,[sp,#8]
;;;1274   data[1]=b; 
0016f2  f88d5009          STRB     r5,[sp,#9]
;;;1275   data[2]='K';
0016f6  f04f004b          MOV      r0,#0x4b
0016fa  f88d000a          STRB     r0,[sp,#0xa]
;;;1276   data[3]=0;
0016fe  f04f0600          MOV      r6,#0
001702  f88d600b          STRB     r6,[sp,#0xb]
;;;1277   
;;;1278   lc640_write_long_ptr(lc640_adr,data);
001706  a902              ADD      r1,sp,#8
001708  4620              MOV      r0,r4
00170a  f7fffffe          BL       lc640_write_long_ptr
;;;1279   
;;;1280   data[0]=*((char*)&in);
00170e  f89d0010          LDRB     r0,[sp,#0x10]
001712  f88d0008          STRB     r0,[sp,#8]
;;;1281   data[1]=*(((char*)(&in))+1);
001716  f89d0011          LDRB     r0,[sp,#0x11]
00171a  f88d0009          STRB     r0,[sp,#9]
;;;1282   data[2]=*((char*)&temp_temp);
00171e  f89d0004          LDRB     r0,[sp,#4]
001722  f88d000a          STRB     r0,[sp,#0xa]
;;;1283   data[3]=*(((char*)(&temp_temp))+1);
001726  f89d0005          LDRB     r0,[sp,#5]
00172a  f88d000b          STRB     r0,[sp,#0xb]
;;;1284   lc640_write_long_ptr(lc640_adr+4,data);
00172e  a902              ADD      r1,sp,#8
001730  1d20              ADDS     r0,r4,#4
001732  f7fffffe          BL       lc640_write_long_ptr
;;;1285   
;;;1286   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
001736  f44f70fc          MOV      r0,#0x1f8
00173a  f7fffffe          BL       lc640_read_long
00173e  4d92              LDR      r5,|L1.6536|
001740  6028              STR      r0,[r5,#0]  ; ke_date
;;;1287   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
001742  4629              MOV      r1,r5
001744  f1040008          ADD      r0,r4,#8
001748  f7fffffe          BL       lc640_write_long_ptr
;;;1288   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
00174c  f44f70fe          MOV      r0,#0x1fc
001750  f7fffffe          BL       lc640_read_long
001754  6068              STR      r0,[r5,#4]  ; ke_date
;;;1289   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
001756  1d29              ADDS     r1,r5,#4
001758  f104000c          ADD      r0,r4,#0xc
00175c  f7fffffe          BL       lc640_write_long_ptr
;;;1290   
;;;1291   data[0]=LPC_RTC->YEAR;
001760  4d8a              LDR      r5,|L1.6540|
001762  8ba8              LDRH     r0,[r5,#0x1c]
001764  f88d0008          STRB     r0,[sp,#8]
;;;1292   data[1]=LPC_RTC->MONTH;
001768  7e28              LDRB     r0,[r5,#0x18]
00176a  f88d0009          STRB     r0,[sp,#9]
;;;1293   data[2]=LPC_RTC->DOM;
00176e  7b28              LDRB     r0,[r5,#0xc]
001770  f88d000a          STRB     r0,[sp,#0xa]
;;;1294   data[3]=0;
001774  f88d600b          STRB     r6,[sp,#0xb]
;;;1295   lc640_write_long_ptr(lc640_adr+16,data);
001778  a902              ADD      r1,sp,#8
00177a  f1040010          ADD      r0,r4,#0x10
00177e  f7fffffe          BL       lc640_write_long_ptr
;;;1296   
;;;1297   data[0]=LPC_RTC->HOUR;
001782  7a28              LDRB     r0,[r5,#8]
001784  f88d0008          STRB     r0,[sp,#8]
;;;1298   data[1]=LPC_RTC->MIN;
001788  7928              LDRB     r0,[r5,#4]
00178a  f88d0009          STRB     r0,[sp,#9]
;;;1299   data[2]=LPC_RTC->SEC;
00178e  7828              LDRB     r0,[r5,#0]
001790  f88d000a          STRB     r0,[sp,#0xa]
;;;1300   data[3]=0;
001794  f88d600b          STRB     r6,[sp,#0xb]
;;;1301   lc640_write_long_ptr(lc640_adr+20,data);
001798  a902              ADD      r1,sp,#8
00179a  f1040014          ADD      r0,r4,#0x14
00179e  f7fffffe          BL       lc640_write_long_ptr
;;;1302    
;;;1303   }
0017a2  b005              ADD      sp,sp,#0x14
0017a4  bdf0              POP      {r4-r7,pc}
;;;1304   
                          ENDP

                  vz_mem_hndl PROC
;;;1306   //-----------------------------------------------
;;;1307   void vz_mem_hndl(unsigned short in)
0017a6  e92d4ff8          PUSH     {r3-r11,lr}
;;;1308   {
;;;1309   char data[4];
;;;1310   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
0017aa  f04f0600          MOV      r6,#0
0017ae  4634              MOV      r4,r6
;;;1311   //char avar_simbol;
;;;1312   
;;;1313   if(in==1)
;;;1314   	{
;;;1315   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1316   	event_ptr++;	
;;;1317   	if(event_ptr>63)event_ptr=0;	
;;;1318   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1319   	
;;;1320        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1321   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1322   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1323   	
;;;1324   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1325   	
;;;1326   	data[0]='B';
;;;1327   	data[1]=0; 
;;;1328   	data[2]='Z';
;;;1329   	data[3]=0;
;;;1330   	lc640_write_long_ptr(lc640_adr,data);
;;;1331   
;;;1332   	data[0]=0;
;;;1333   	data[1]=0;
;;;1334   	data[2]=0;
;;;1335   	data[3]=0;
;;;1336   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1337   
;;;1338   	data[0]=LPC_RTC->YEAR;
0017b0  f8df81dc          LDR      r8,|L1.6544|
0017b4  46a1              MOV      r9,r4                 ;1310
0017b6  f04f0742          MOV      r7,#0x42              ;1326
0017ba  f44f6a80          MOV      r10,#0x400            ;1324
0017be  2801              CMP      r0,#1                 ;1313
0017c0  d002              BEQ      |L1.6088|
;;;1339   	data[1]=LPC_RTC->MONTH;
;;;1340   	data[2]=LPC_RTC->DOM;
;;;1341   	data[3]=0;
;;;1342   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1343   
;;;1344   	data[0]=LPC_RTC->HOUR;
;;;1345   	data[1]=LPC_RTC->MIN;
;;;1346   	data[2]=LPC_RTC->SEC;
;;;1347   	data[3]=0;
;;;1348   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1349   	
;;;1350   	data[0]='A';
;;;1351   	data[1]='A';
;;;1352   	data[2]='A';
;;;1353   	data[3]='A';
;;;1354   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1355   	
;;;1356   	data[0]='A';
;;;1357   	data[1]='A';
;;;1358   	data[2]='A';
;;;1359   	data[3]='A';
;;;1360   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1361   	
;;;1362   	data[0]='A';
;;;1363   	data[1]='A';
;;;1364   	data[2]='A';
;;;1365   	data[3]='A';
;;;1366   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1367   	
;;;1368   	data[0]='A';
;;;1369   	data[1]='A';
;;;1370   	data[2]='A';
;;;1371   	data[3]='A';
;;;1372   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1373    	
;;;1374   	}
;;;1375   
;;;1376   else if(in==0)
0017c2  2800              CMP      r0,#0
0017c4  d07e              BEQ      |L1.6340|
0017c6  e12a              B        |L1.6686|
                  |L1.6088|
0017c8  f44f6560          MOV      r5,#0xe00             ;1315
0017cc  4628              MOV      r0,r5                 ;1315
0017ce  f7fffffe          BL       lc640_read_int
0017d2  f1000001          ADD      r0,r0,#1              ;1316
0017d6  4604              MOV      r4,r0                 ;1316
0017d8  2c3f              CMP      r4,#0x3f              ;1317
0017da  d901              BLS      |L1.6112|
0017dc  f04f0400          MOV      r4,#0                 ;1317
                  |L1.6112|
0017e0  b221              SXTH     r1,r4                 ;1318
0017e2  4628              MOV      r0,r5                 ;1318
0017e4  f7fffffe          BL       lc640_write_int
0017e8  f6406602          MOV      r6,#0xe02             ;1320
0017ec  4630              MOV      r0,r6                 ;1320
0017ee  f7fffffe          BL       lc640_read_int
0017f2  283f              CMP      r0,#0x3f              ;1321
0017f4  d000              BEQ      |L1.6136|
0017f6  4620              MOV      r0,r4                 ;1321
                  |L1.6136|
0017f8  b201              SXTH     r1,r0                 ;1322
0017fa  4630              MOV      r0,r6                 ;1322
0017fc  f7fffffe          BL       lc640_write_int
001800  4628              MOV      r0,r5                 ;1324
001802  f7fffffe          BL       lc640_read_int
001806  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1324
00180a  f88d7000          STRB     r7,[sp,#0]            ;1326
00180e  f88d9001          STRB     r9,[sp,#1]            ;1327
001812  f04f005a          MOV      r0,#0x5a              ;1328
001816  f88d0002          STRB     r0,[sp,#2]            ;1328
00181a  f88d9003          STRB     r9,[sp,#3]            ;1329
00181e  4669              MOV      r1,sp                 ;1330
001820  4620              MOV      r0,r4                 ;1330
001822  f7fffffe          BL       lc640_write_long_ptr
001826  f8cd9000          STR      r9,[sp,#0]            ;1335
00182a  4669              MOV      r1,sp                 ;1336
00182c  1d20              ADDS     r0,r4,#4              ;1336
00182e  f7fffffe          BL       lc640_write_long_ptr
001832  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1338
001836  f88d0000          STRB     r0,[sp,#0]            ;1338
00183a  f8980038          LDRB     r0,[r8,#0x38]         ;1339
00183e  f88d0001          STRB     r0,[sp,#1]            ;1339
001842  f898002c          LDRB     r0,[r8,#0x2c]         ;1340
001846  f88d0002          STRB     r0,[sp,#2]            ;1340
00184a  f88d9003          STRB     r9,[sp,#3]            ;1341
00184e  4669              MOV      r1,sp                 ;1342
001850  f1040008          ADD      r0,r4,#8              ;1342
001854  f7fffffe          BL       lc640_write_long_ptr
001858  f8980028          LDRB     r0,[r8,#0x28]         ;1344
00185c  f88d0000          STRB     r0,[sp,#0]            ;1344
001860  f8980024          LDRB     r0,[r8,#0x24]         ;1345
001864  f88d0001          STRB     r0,[sp,#1]            ;1345
001868  f8980020          LDRB     r0,[r8,#0x20]         ;1346
00186c  f88d0002          STRB     r0,[sp,#2]            ;1346
001870  f88d9003          STRB     r9,[sp,#3]            ;1347
001874  4669              MOV      r1,sp                 ;1348
001876  f104000c          ADD      r0,r4,#0xc            ;1348
00187a  f7fffffe          BL       lc640_write_long_ptr
00187e  f04f0541          MOV      r5,#0x41              ;1350
001882  f88d5000          STRB     r5,[sp,#0]            ;1350
001886  f88d5001          STRB     r5,[sp,#1]            ;1351
00188a  f88d5002          STRB     r5,[sp,#2]            ;1352
00188e  f88d5003          STRB     r5,[sp,#3]            ;1353
001892  4669              MOV      r1,sp                 ;1354
001894  f1040010          ADD      r0,r4,#0x10           ;1354
001898  f7fffffe          BL       lc640_write_long_ptr
00189c  f88d5000          STRB     r5,[sp,#0]            ;1356
0018a0  f88d5001          STRB     r5,[sp,#1]            ;1357
0018a4  f88d5002          STRB     r5,[sp,#2]            ;1358
0018a8  f88d5003          STRB     r5,[sp,#3]            ;1359
0018ac  4669              MOV      r1,sp                 ;1360
0018ae  f1040014          ADD      r0,r4,#0x14           ;1360
0018b2  f7fffffe          BL       lc640_write_long_ptr
0018b6  f88d5000          STRB     r5,[sp,#0]            ;1362
0018ba  f88d5001          STRB     r5,[sp,#1]            ;1363
0018be  f88d5002          STRB     r5,[sp,#2]            ;1364
0018c2  e000              B        |L1.6342|
                  |L1.6340|
0018c4  e014              B        |L1.6384|
                  |L1.6342|
0018c6  f88d5003          STRB     r5,[sp,#3]            ;1365
0018ca  4669              MOV      r1,sp                 ;1366
0018cc  f1040018          ADD      r0,r4,#0x18           ;1366
0018d0  f7fffffe          BL       lc640_write_long_ptr
0018d4  f88d5000          STRB     r5,[sp,#0]            ;1368
0018d8  f88d5001          STRB     r5,[sp,#1]            ;1369
0018dc  f88d5002          STRB     r5,[sp,#2]            ;1370
0018e0  f88d5003          STRB     r5,[sp,#3]            ;1371
0018e4  4669              MOV      r1,sp                 ;1372
0018e6  f104001c          ADD      r0,r4,#0x1c           ;1372
0018ea  f7fffffe          BL       lc640_write_long_ptr
0018ee  e096              B        |L1.6686|
                  |L1.6384|
;;;1377   	{      
;;;1378        
;;;1379   vz_mem_hndl_lbl1: 
;;;1380   
;;;1381   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0018f0  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1382   
;;;1383        lc640_read_long_ptr(lc640_adr,data);
0018f4  4669              MOV      r1,sp
0018f6  4628              MOV      r0,r5
0018f8  f7fffffe          BL       lc640_read_long_ptr
;;;1384        
;;;1385        if(!((data[0]=='B')&&(data[2]=='Z')))
0018fc  f89d0000          LDRB     r0,[sp,#0]
001900  2842              CMP      r0,#0x42
001902  d103              BNE      |L1.6412|
001904  f89d0002          LDRB     r0,[sp,#2]
001908  285a              CMP      r0,#0x5a
00190a  d008              BEQ      |L1.6430|
                  |L1.6412|
;;;1386        	{        
;;;1387        	if(event_ptr_find)event_ptr_find--;
00190c  b114              CBZ      r4,|L1.6420|
00190e  f1a40401          SUB      r4,r4,#1
001912  e001              B        |L1.6424|
                  |L1.6420|
;;;1388        	else event_ptr_find=63;
001914  f04f043f          MOV      r4,#0x3f
                  |L1.6424|
;;;1389        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001918  42b4              CMP      r4,r6
00191a  d1e9              BNE      |L1.6384|
00191c  e07f              B        |L1.6686|
                  |L1.6430|
;;;1390        	else goto vz_mem_hndl_lbl1;
;;;1391        	}
;;;1392        else 
;;;1393        	{
;;;1394        	lc640_read_long_ptr(lc640_adr+16,data);
00191e  4669              MOV      r1,sp
001920  f1050010          ADD      r0,r5,#0x10
001924  f7fffffe          BL       lc640_read_long_ptr
;;;1395        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001928  f89d0000          LDRB     r0,[sp,#0]
00192c  2841              CMP      r0,#0x41
00192e  d10b              BNE      |L1.6472|
001930  f89d0001          LDRB     r0,[sp,#1]
001934  2841              CMP      r0,#0x41
001936  d107              BNE      |L1.6472|
001938  f89d0002          LDRB     r0,[sp,#2]
00193c  2841              CMP      r0,#0x41
00193e  d103              BNE      |L1.6472|
001940  f89d0003          LDRB     r0,[sp,#3]
001944  2841              CMP      r0,#0x41
001946  d02a              BEQ      |L1.6558|
                  |L1.6472|
;;;1396        		{        
;;;1397        		if(event_ptr_find)event_ptr_find--;
001948  b324              CBZ      r4,|L1.6548|
00194a  f1a40401          SUB      r4,r4,#1
00194e  e023              B        |L1.6552|
                  |L1.6480|
001950  42415420          DCB      "BAT #1 Alarm, assimetry",0
001954  23312041
001958  6c61726d
00195c  2c206173
001960  73696d65
001964  74727900
                  |L1.6504|
001968  42415420          DCB      "BAT #2 Alarm, assimetry",0
00196c  23322041
001970  6c61726d
001974  2c206173
001978  73696d65
00197c  74727900
                  |L1.6528|
                          DCD      bat
                  |L1.6532|
                          DCD      bat_u_old_cnt
                  |L1.6536|
                          DCD      ke_date
                  |L1.6540|
                          DCD      0x40024020
                  |L1.6544|
                          DCD      0x40024000
                  |L1.6548|
;;;1398            		else event_ptr_find=63;
001994  f04f043f          MOV      r4,#0x3f
                  |L1.6552|
;;;1399            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001998  42b4              CMP      r4,r6
00199a  d1a9              BNE      |L1.6384|
00199c  e03f              B        |L1.6686|
                  |L1.6558|
;;;1400        		else goto vz_mem_hndl_lbl1;
;;;1401        		}
;;;1402   
;;;1403        	}	
;;;1404   
;;;1405   
;;;1406   	
;;;1407   	data[0]=LPC_RTC->YEAR;
00199e  f8b8003c          LDRH     r0,[r8,#0x3c]
0019a2  f88d0000          STRB     r0,[sp,#0]
;;;1408   	data[1]=LPC_RTC->MONTH;
0019a6  f8980038          LDRB     r0,[r8,#0x38]
0019aa  f88d0001          STRB     r0,[sp,#1]
;;;1409   	data[2]=LPC_RTC->DOM;
0019ae  f898002c          LDRB     r0,[r8,#0x2c]
0019b2  f88d0002          STRB     r0,[sp,#2]
;;;1410   	data[3]=0;
0019b6  f88d9003          STRB     r9,[sp,#3]
;;;1411   	lc640_write_long_ptr(lc640_adr+16,data);
0019ba  4669              MOV      r1,sp
0019bc  f1050010          ADD      r0,r5,#0x10
0019c0  f7fffffe          BL       lc640_write_long_ptr
;;;1412   
;;;1413   	data[0]=LPC_RTC->HOUR;
0019c4  f8980028          LDRB     r0,[r8,#0x28]
0019c8  f88d0000          STRB     r0,[sp,#0]
;;;1414   	data[1]=LPC_RTC->MIN;
0019cc  f8980024          LDRB     r0,[r8,#0x24]
0019d0  f88d0001          STRB     r0,[sp,#1]
;;;1415   	data[2]=LPC_RTC->SEC;
0019d4  f8980020          LDRB     r0,[r8,#0x20]
0019d8  f88d0002          STRB     r0,[sp,#2]
;;;1416   	data[3]=0;
0019dc  f88d9003          STRB     r9,[sp,#3]
;;;1417   	lc640_write_long_ptr(lc640_adr+20,data);
0019e0  4669              MOV      r1,sp
0019e2  f1050014          ADD      r0,r5,#0x14
0019e6  f7fffffe          BL       lc640_write_long_ptr
;;;1418   	
;;;1419   	data[0]='B';
0019ea  f88d7000          STRB     r7,[sp,#0]
;;;1420   	data[1]='B';
0019ee  f88d7001          STRB     r7,[sp,#1]
;;;1421   	data[2]='B';
0019f2  f88d7002          STRB     r7,[sp,#2]
;;;1422   	data[3]='B';
0019f6  f88d7003          STRB     r7,[sp,#3]
;;;1423   	lc640_write_long_ptr(lc640_adr+24,data);
0019fa  4669              MOV      r1,sp
0019fc  f1050018          ADD      r0,r5,#0x18
001a00  f7fffffe          BL       lc640_write_long_ptr
;;;1424   	
;;;1425   	data[0]='B';
001a04  f88d7000          STRB     r7,[sp,#0]
;;;1426   	data[1]='B';
001a08  f88d7001          STRB     r7,[sp,#1]
;;;1427   	data[2]='B';
001a0c  f88d7002          STRB     r7,[sp,#2]
;;;1428   	data[3]='B';
001a10  f88d7003          STRB     r7,[sp,#3]
;;;1429   	lc640_write_long_ptr(lc640_adr+28,data);
001a14  4669              MOV      r1,sp
001a16  f105001c          ADD      r0,r5,#0x1c
001a1a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.6686|
;;;1430   	
;;;1431   	}
;;;1432   
;;;1433   vz_mem_hndl_end:
;;;1434   __nop(); 
001a1e  bf00              NOP      
;;;1435   
;;;1436   }
001a20  e4c2              B        |L1.5032|
;;;1437     
                          ENDP


                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  av_inv
                          DCD      0x00000000
000018  0000              DCB      0x00,0x00
