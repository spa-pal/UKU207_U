; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\avar_hndl.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DUKU_ZVU --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;77     //-----------------------------------------------
;;;78     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;79     {
;;;80     //static unsigned avar_stat_old;
;;;81     char i;
;;;82     //unsigned avar_stat_new,avar_stat_offed;
;;;83     
;;;84     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48ff              LDR      r0,|L1.1024|
000004  4bff              LDR      r3,|L1.1028|
000006  7801              LDRB     r1,[r0,#0]  ; net_av
000008  6818              LDR      r0,[r3,#0]
00000a  b119              CBZ      r1,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6018              STR      r0,[r3,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;85     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6018              STR      r0,[r3,#0]  ; avar_stat
                  |L1.26|
;;;86     
;;;87     for(i=0;i<2;i++)
00001a  f04f0000          MOV      r0,#0
;;;88     	{
;;;89     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
00001e  4dfa              LDR      r5,|L1.1032|
000020  f04f0401          MOV      r4,#1
                  |L1.36|
000024  eb000140          ADD      r1,r0,r0,LSL #1
000028  eb011100          ADD      r1,r1,r0,LSL #4
00002c  eb050181          ADD      r1,r5,r1,LSL #2
000030  f891103d          LDRB     r1,[r1,#0x3d]
000034  0789              LSLS     r1,r1,#30
000036  d00a              BEQ      |L1.78|
000038  f1000101          ADD      r1,r0,#1
00003c  fa04f201          LSL      r2,r4,r1
000040  6819              LDR      r1,[r3,#0]  ; avar_stat
000042  ea210102          BIC      r1,r1,r2
000046  ea410102          ORR      r1,r1,r2
00004a  6019              STR      r1,[r3,#0]  ; avar_stat
00004c  e007              B        |L1.94|
                  |L1.78|
;;;90     	else	   			SET_REG(avar_stat,0,1+i,1);
00004e  f1000201          ADD      r2,r0,#1
000052  fa04f102          LSL      r1,r4,r2
000056  681a              LDR      r2,[r3,#0]  ; avar_stat
000058  ea220201          BIC      r2,r2,r1
00005c  601a              STR      r2,[r3,#0]  ; avar_stat
                  |L1.94|
00005e  f1000001          ADD      r0,r0,#1              ;87
000062  b2c0              UXTB     r0,r0                 ;87
000064  2802              CMP      r0,#2                 ;87
000066  d3dd              BCC      |L1.36|
;;;91     	}
;;;92     
;;;93     for(i=0;i<12;i++)
000068  f04f0000          MOV      r0,#0
;;;94     	{
;;;95     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00006c  4de7              LDR      r5,|L1.1036|
                  |L1.110|
00006e  eb0001c0          ADD      r1,r0,r0,LSL #3
000072  eb011100          ADD      r1,r1,r0,LSL #4
000076  eb050181          ADD      r1,r5,r1,LSL #2
00007a  7849              LDRB     r1,[r1,#1]
00007c  f0110fef          TST      r1,#0xef
000080  d00a              BEQ      |L1.152|
000082  f1000203          ADD      r2,r0,#3
000086  fa04f102          LSL      r1,r4,r2
00008a  681a              LDR      r2,[r3,#0]  ; avar_stat
00008c  ea220201          BIC      r2,r2,r1
000090  ea420201          ORR      r2,r2,r1
000094  601a              STR      r2,[r3,#0]  ; avar_stat
000096  e007              B        |L1.168|
                  |L1.152|
;;;96     	else	   		SET_REG(avar_stat,0,3+i,1);
000098  f1000103          ADD      r1,r0,#3
00009c  fa04f201          LSL      r2,r4,r1
0000a0  6819              LDR      r1,[r3,#0]  ; avar_stat
0000a2  ea210102          BIC      r1,r1,r2
0000a6  6019              STR      r1,[r3,#0]  ; avar_stat
                  |L1.168|
0000a8  f1000001          ADD      r0,r0,#1              ;93
0000ac  b2c0              UXTB     r0,r0                 ;93
0000ae  280c              CMP      r0,#0xc               ;93
0000b0  d3dd              BCC      |L1.110|
;;;97     	}
;;;98     
;;;99     for(i=0;i<6;i++)
0000b2  f04f0000          MOV      r0,#0
;;;100    	{
;;;101    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
0000b6  4ad3              LDR      r2,|L1.1028|
0000b8  f1020228          ADD      r2,r2,#0x28
                  |L1.188|
0000bc  5c11              LDRB     r1,[r2,r0]
0000be  b151              CBZ      r1,|L1.214|
0000c0  f100050f          ADD      r5,r0,#0xf
0000c4  fa04f105          LSL      r1,r4,r5
0000c8  681d              LDR      r5,[r3,#0]  ; avar_stat
0000ca  ea250501          BIC      r5,r5,r1
0000ce  ea450501          ORR      r5,r5,r1
0000d2  601d              STR      r5,[r3,#0]  ; avar_stat
0000d4  e007              B        |L1.230|
                  |L1.214|
;;;102    	else	   		SET_REG(avar_stat,0,15+i,1);
0000d6  f100010f          ADD      r1,r0,#0xf
0000da  fa04f501          LSL      r5,r4,r1
0000de  6819              LDR      r1,[r3,#0]  ; avar_stat
0000e0  ea210105          BIC      r1,r1,r5
0000e4  6019              STR      r1,[r3,#0]  ; avar_stat
                  |L1.230|
0000e6  f1000001          ADD      r0,r0,#1              ;99
0000ea  b2c0              UXTB     r0,r0                 ;99
0000ec  2806              CMP      r0,#6                 ;99
0000ee  d3e5              BCC      |L1.188|
;;;103    	}
;;;104    
;;;105    /*for(i=0;i<4;i++)
;;;106    	{
;;;107    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;108    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;109    	}  */
;;;110    for(i=0;i<4;i++)
0000f0  f04f0000          MOV      r0,#0
;;;111    	{
;;;112    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000f4  4dc6              LDR      r5,|L1.1040|
                  |L1.246|
0000f6  5c29              LDRB     r1,[r5,r0]
0000f8  2901              CMP      r1,#1
0000fa  d036              BEQ      |L1.362|
;;;113    	else	   		SET_REG(avar_stat,0,24+i,1);
0000fc  f1000118          ADD      r1,r0,#0x18
000100  681a              LDR      r2,[r3,#0]  ; avar_stat
000102  fa04f101          LSL      r1,r4,r1
000106  ea220201          BIC      r2,r2,r1
00010a  601a              STR      r2,[r3,#0]  ; avar_stat
                  |L1.268|
00010c  f1000001          ADD      r0,r0,#1              ;110
000110  b2c0              UXTB     r0,r0                 ;110
000112  2804              CMP      r0,#4                 ;110
000114  d3ef              BCC      |L1.246|
;;;114    	}
;;;115    
;;;116    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;117    //else	   			SET_REG(avar_stat,0,28,1);
;;;118    
;;;119    
;;;120    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000116  689a              LDR      r2,[r3,#8]  ; avar_stat_old
000118  6818              LDR      r0,[r3,#0]  ; avar_stat
00011a  ea200102          BIC      r1,r0,r2
00011e  60d9              STR      r1,[r3,#0xc]  ; avar_stat_new
;;;121    
;;;122    avar_ind_stat|=avar_stat_new;
000120  685c              LDR      r4,[r3,#4]  ; avar_ind_stat
000122  ea440401          ORR      r4,r4,r1
000126  605c              STR      r4,[r3,#4]  ; avar_ind_stat
;;;123    
;;;124    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000128  49ba              LDR      r1,|L1.1044|
00012a  880d              LDRH     r5,[r1,#0]  ; SK_ZVUK_EN
00012c  b115              CBZ      r5,|L1.308|
00012e  f0247480          BIC      r4,r4,#0x1000000
000132  605c              STR      r4,[r3,#4]  ; avar_ind_stat
                  |L1.308|
;;;125    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
000134  884c              LDRH     r4,[r1,#2]  ; SK_ZVUK_EN
000136  b11c              CBZ      r4,|L1.320|
000138  685c              LDR      r4,[r3,#4]  ; avar_ind_stat
00013a  f0247400          BIC      r4,r4,#0x2000000
00013e  605c              STR      r4,[r3,#4]  ; avar_ind_stat
                  |L1.320|
;;;126    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
000140  888c              LDRH     r4,[r1,#4]  ; SK_ZVUK_EN
000142  b11c              CBZ      r4,|L1.332|
000144  685c              LDR      r4,[r3,#4]  ; avar_ind_stat
000146  f0246480          BIC      r4,r4,#0x4000000
00014a  605c              STR      r4,[r3,#4]  ; avar_ind_stat
                  |L1.332|
;;;127    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
00014c  88c9              LDRH     r1,[r1,#6]  ; SK_ZVUK_EN
00014e  b119              CBZ      r1,|L1.344|
000150  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
000152  f0216100          BIC      r1,r1,#0x8000000
000156  6059              STR      r1,[r3,#4]  ; avar_ind_stat
                  |L1.344|
;;;128    
;;;129    
;;;130    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
000158  ea220200          BIC      r2,r2,r0
00015c  ea6f0102          MVN      r1,r2
000160  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
;;;131    
;;;132    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
000162  4aad              LDR      r2,|L1.1048|
000164  8812              LDRH     r2,[r2,#0]  ; AV_OFF_AVT
000166  b15a              CBZ      r2,|L1.384|
000168  e00e              B        |L1.392|
                  |L1.362|
00016a  f1000218          ADD      r2,r0,#0x18           ;112
00016e  fa04f102          LSL      r1,r4,r2              ;112
000172  681a              LDR      r2,[r3,#0]            ;112  ; avar_stat
000174  ea220201          BIC      r2,r2,r1              ;112
000178  ea420201          ORR      r2,r2,r1              ;112
00017c  601a              STR      r2,[r3,#0]            ;112  ; avar_stat
00017e  e7c5              B        |L1.268|
                  |L1.384|
000180  4aa6              LDR      r2,|L1.1052|
000182  ea410102          ORR      r1,r1,r2
000186  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
                  |L1.392|
;;;133    
;;;134    avar_ind_stat&=avar_stat_offed; 
000188  691a              LDR      r2,[r3,#0x10]  ; avar_stat_offed
00018a  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
00018c  ea010102          AND      r1,r1,r2
000190  6059              STR      r1,[r3,#4]  ; avar_ind_stat
;;;135    
;;;136    avar_stat_old=avar_stat;
000192  6098              STR      r0,[r3,#8]  ; avar_stat_old
;;;137    
;;;138    //oleg_start
;;;139    
;;;140    
;;;141    
;;;142    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
000194  48a2              LDR      r0,|L1.1056|
000196  49a3              LDR      r1,|L1.1060|
000198  8800              LDRH     r0,[r0,#0]  ; status_izm_r
00019a  6809              LDR      r1,[r1,#0]  ; sk_alarm
00019c  f000003f          AND      r0,r0,#0x3f
0001a0  ea402001          ORR      r0,r0,r1,LSL #8
0001a4  6158              STR      r0,[r3,#0x14]  ; rki_avar1_stat
;;;143    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
0001a6  69da              LDR      r2,[r3,#0x1c]  ; rki_avar1_stat_old
0001a8  ea200102          BIC      r1,r0,r2
0001ac  6219              STR      r1,[r3,#0x20]  ; rki_avar1_stat_new
;;;144    rki_avar1_ind_stat|=rki_avar1_stat_new;
0001ae  699c              LDR      r4,[r3,#0x18]  ; rki_avar1_ind_stat
0001b0  ea440401          ORR      r4,r4,r1
;;;145    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
0001b4  ea220200          BIC      r2,r2,r0
0001b8  ea6f0102          MVN      r1,r2
0001bc  6259              STR      r1,[r3,#0x24]  ; rki_avar1_stat_offed
;;;146    rki_avar1_ind_stat&=rki_avar1_stat_offed;
0001be  ea040401          AND      r4,r4,r1
0001c2  619c              STR      r4,[r3,#0x18]  ; rki_avar1_ind_stat
;;;147    rki_avar1_stat_old=rki_avar1_stat;
0001c4  61d8              STR      r0,[r3,#0x1c]  ; rki_avar1_stat_old
;;;148    /*
;;;149    rki_avarI1_stat=status_di1;
;;;150    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;151    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;152    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;153    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;154    rki_avarI1_stat_old=rki_avarI1_stat;
;;;155    
;;;156    rki_avarI2_stat=status_di2;
;;;157    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;158    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;159    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;160    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;161    rki_avarI2_stat_old=rki_avarI2_stat;
;;;162    */
;;;163    //oleg_end
;;;164    }
0001c6  bd30              POP      {r4,r5,pc}
;;;165    
                          ENDP

                  reload_hndl PROC
;;;166    //-----------------------------------------------
;;;167    void reload_hndl(void)
0001c8  b5f8              PUSH     {r3-r7,lr}
;;;168    {
;;;169    
;;;170    char data[4];
;;;171    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;172    
;;;173    event_ptr=lc640_read_int(PTR_EVENT_LOG);
0001ca  f44f6560          MOV      r5,#0xe00
0001ce  4628              MOV      r0,r5
0001d0  f7fffffe          BL       lc640_read_int
;;;174    event_ptr++;	
0001d4  f1000001          ADD      r0,r0,#1
0001d8  4604              MOV      r4,r0
;;;175    if(event_ptr>63)event_ptr=0;	
0001da  2c3f              CMP      r4,#0x3f
0001dc  d901              BLS      |L1.482|
0001de  f04f0400          MOV      r4,#0
                  |L1.482|
;;;176    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
0001e2  b221              SXTH     r1,r4
0001e4  4628              MOV      r0,r5
0001e6  f7fffffe          BL       lc640_write_int
;;;177    	
;;;178    event_cnt=lc640_read_int(CNT_EVENT_LOG);
0001ea  f6406602          MOV      r6,#0xe02
0001ee  4630              MOV      r0,r6
0001f0  f7fffffe          BL       lc640_read_int
;;;179    if(event_cnt!=63)event_cnt=event_ptr;
0001f4  283f              CMP      r0,#0x3f
0001f6  d000              BEQ      |L1.506|
0001f8  4620              MOV      r0,r4
                  |L1.506|
;;;180    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
0001fa  b201              SXTH     r1,r0
0001fc  4630              MOV      r0,r6
0001fe  f7fffffe          BL       lc640_write_int
;;;181    	
;;;182    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000202  4628              MOV      r0,r5
000204  f7fffffe          BL       lc640_read_int
000208  f44f6180          MOV      r1,#0x400
00020c  eb011440          ADD      r4,r1,r0,LSL #5
;;;183    	
;;;184    data[0]='U';
000210  f04f0055          MOV      r0,#0x55
000214  f88d0000          STRB     r0,[sp,#0]
;;;185    data[1]=0;
000218  f04f0600          MOV      r6,#0
00021c  f88d6001          STRB     r6,[sp,#1]
;;;186    data[2]='R';
000220  f04f0052          MOV      r0,#0x52
000224  f88d0002          STRB     r0,[sp,#2]
;;;187    data[3]=0;
000228  f88d6003          STRB     r6,[sp,#3]
;;;188    lc640_write_long_ptr(lc640_adr,data);
00022c  4669              MOV      r1,sp
00022e  4620              MOV      r0,r4
000230  f7fffffe          BL       lc640_write_long_ptr
;;;189    
;;;190    data[0]=0;
;;;191    data[1]=0;
;;;192    data[2]=0;
;;;193    data[3]=0;
000234  9600              STR      r6,[sp,#0]
;;;194    lc640_write_long_ptr(lc640_adr+4,data);
000236  4669              MOV      r1,sp
000238  1d20              ADDS     r0,r4,#4
00023a  f7fffffe          BL       lc640_write_long_ptr
;;;195    
;;;196    data[0]=LPC_RTC->YEAR;
00023e  4d7a              LDR      r5,|L1.1064|
000240  8ba8              LDRH     r0,[r5,#0x1c]
000242  f88d0000          STRB     r0,[sp,#0]
;;;197    data[1]=LPC_RTC->MONTH;
000246  7e28              LDRB     r0,[r5,#0x18]
000248  f88d0001          STRB     r0,[sp,#1]
;;;198    data[2]=LPC_RTC->DOM;
00024c  7b28              LDRB     r0,[r5,#0xc]
00024e  f88d0002          STRB     r0,[sp,#2]
;;;199    data[3]=0;
000252  f88d6003          STRB     r6,[sp,#3]
;;;200    lc640_write_long_ptr(lc640_adr+8,data);
000256  4669              MOV      r1,sp
000258  f1040008          ADD      r0,r4,#8
00025c  f7fffffe          BL       lc640_write_long_ptr
;;;201    
;;;202    data[0]=LPC_RTC->HOUR;
000260  7a28              LDRB     r0,[r5,#8]
000262  f88d0000          STRB     r0,[sp,#0]
;;;203    data[1]=LPC_RTC->MIN;
000266  7928              LDRB     r0,[r5,#4]
000268  f88d0001          STRB     r0,[sp,#1]
;;;204    data[2]=LPC_RTC->SEC;
00026c  7828              LDRB     r0,[r5,#0]
00026e  f88d0002          STRB     r0,[sp,#2]
;;;205    data[3]=LPC_SC->RSID;
000272  486e              LDR      r0,|L1.1068|
000274  f8d00180          LDR      r0,[r0,#0x180]
000278  f88d0003          STRB     r0,[sp,#3]
;;;206    
;;;207    lc640_write_long_ptr(lc640_adr+12,data);
00027c  4669              MOV      r1,sp
00027e  f104000c          ADD      r0,r4,#0xc
000282  f7fffffe          BL       lc640_write_long_ptr
;;;208    	
;;;209    data[0]='A';
000286  f04f0541          MOV      r5,#0x41
00028a  f88d5000          STRB     r5,[sp,#0]
;;;210    data[1]='A';
00028e  f88d5001          STRB     r5,[sp,#1]
;;;211    data[2]='A';
000292  f88d5002          STRB     r5,[sp,#2]
;;;212    data[3]='A';
000296  f88d5003          STRB     r5,[sp,#3]
;;;213    lc640_write_long_ptr(lc640_adr+16,data);
00029a  4669              MOV      r1,sp
00029c  f1040010          ADD      r0,r4,#0x10
0002a0  f7fffffe          BL       lc640_write_long_ptr
;;;214    	
;;;215    data[0]='A';
0002a4  f88d5000          STRB     r5,[sp,#0]
;;;216    data[1]='A';
0002a8  f88d5001          STRB     r5,[sp,#1]
;;;217    data[2]='A';
0002ac  f88d5002          STRB     r5,[sp,#2]
;;;218    data[3]='A';
0002b0  f88d5003          STRB     r5,[sp,#3]
;;;219    lc640_write_long_ptr(lc640_adr+20,data);
0002b4  4669              MOV      r1,sp
0002b6  f1040014          ADD      r0,r4,#0x14
0002ba  f7fffffe          BL       lc640_write_long_ptr
;;;220    	
;;;221    data[0]='A';
0002be  f88d5000          STRB     r5,[sp,#0]
;;;222    data[1]='A';
0002c2  f88d5001          STRB     r5,[sp,#1]
;;;223    data[2]='A';
0002c6  f88d5002          STRB     r5,[sp,#2]
;;;224    data[3]='A';
0002ca  f88d5003          STRB     r5,[sp,#3]
;;;225    lc640_write_long_ptr(lc640_adr+24,data);
0002ce  4669              MOV      r1,sp
0002d0  f1040018          ADD      r0,r4,#0x18
0002d4  f7fffffe          BL       lc640_write_long_ptr
;;;226    	
;;;227    data[0]='A';
0002d8  f88d5000          STRB     r5,[sp,#0]
;;;228    data[1]='A';
0002dc  f88d5001          STRB     r5,[sp,#1]
;;;229    data[2]='A';
0002e0  f88d5002          STRB     r5,[sp,#2]
;;;230    data[3]='A';
0002e4  f88d5003          STRB     r5,[sp,#3]
;;;231    lc640_write_long_ptr(lc640_adr+28,data);				
0002e8  4669              MOV      r1,sp
0002ea  f104001c          ADD      r0,r4,#0x1c
0002ee  f7fffffe          BL       lc640_write_long_ptr
;;;232    	
;;;233    	
;;;234    }
0002f2  bdf8              POP      {r3-r7,pc}
;;;235    
                          ENDP

                  avar_unet_hndl PROC
;;;236    //-----------------------------------------------
;;;237    void avar_unet_hndl(char in)
0002f4  e92d4ff8          PUSH     {r3-r11,lr}
;;;238    {
;;;239    
;;;240    char data[4];
;;;241    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;242    
;;;243    
;;;244    if(in==1)
;;;245    	{
;;;246    	net_av=1;
;;;247    	net_av_2min_timer=1200;
;;;248    
;;;249    	//beep_init(0x01L,'O');
;;;250    	//a.av.bAN=1;
;;;251    
;;;252    
;;;253    	//beep_init(0x33333333,'A');
;;;254    	 
;;;255    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;256    	event_ptr++;	
;;;257    	if(event_ptr>63)event_ptr=0;	
;;;258    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;259    	
;;;260         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;261    	if(event_cnt!=63)event_cnt=event_ptr;
;;;262    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;263    	
;;;264    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;265    	
;;;266    	data[0]='P';
;;;267    	data[1]=0;
;;;268    	data[2]='A';
;;;269    	data[3]=0;
;;;270    	lc640_write_long_ptr(lc640_adr,data);
;;;271    
;;;272    	data[0]=0;//*((char*)&Unet_store);
;;;273    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;274    	data[2]=0;
;;;275    	data[3]=0;
;;;276    	lc640_write_long_ptr(lc640_adr+4,data);
;;;277    
;;;278    	data[0]=LPC_RTC->YEAR;
0002f8  4e4b              LDR      r6,|L1.1064|
0002fa  4941              LDR      r1,|L1.1024|
0002fc  2441              MOVS     r4,#0x41              ;268
0002fe  3e20              SUBS     r6,r6,#0x20
000300  2700              MOVS     r7,#0                 ;257
000302  f04f0a50          MOV      r10,#0x50             ;266
000306  f44f6560          MOV      r5,#0xe00             ;255
00030a  f6406b02          MOV      r11,#0xe02            ;260
00030e  f44f6880          MOV      r8,#0x400             ;264
000312  2801              CMP      r0,#1                 ;244
000314  d006              BEQ      |L1.804|
;;;279    	data[1]=LPC_RTC->MONTH;
;;;280    	data[2]=LPC_RTC->DOM;
;;;281    	data[3]=0;
;;;282    	lc640_write_long_ptr(lc640_adr+8,data);
;;;283    
;;;284    	data[0]=LPC_RTC->HOUR;
;;;285    	data[1]=LPC_RTC->MIN;
;;;286    	data[2]=LPC_RTC->SEC;
;;;287    	data[3]=0;
;;;288    	lc640_write_long_ptr(lc640_adr+12,data);
;;;289    	
;;;290    	data[0]='A';
;;;291    	data[1]='A';
;;;292    	data[2]='A';
;;;293    	data[3]='A';
;;;294    	lc640_write_long_ptr(lc640_adr+16,data);
;;;295    	
;;;296    	data[0]='A';
;;;297    	data[1]='A';
;;;298    	data[2]='A';
;;;299    	data[3]='A';
;;;300    	lc640_write_long_ptr(lc640_adr+20,data);
;;;301    	
;;;302    	data[0]='A';
;;;303    	data[1]='A';
;;;304    	data[2]='A';
;;;305    	data[3]='A';
;;;306    	lc640_write_long_ptr(lc640_adr+24,data);
;;;307    	
;;;308    	data[0]='A';
;;;309    	data[1]='A';
;;;310    	data[2]='A';
;;;311    	data[3]='A';
;;;312    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;313    	
;;;314    /*	memo_out0[0]=0x55;
;;;315         memo_out0[1]=0x00+2;
;;;316         memo_out0[2]=1;
;;;317         memo_out0[3]=0x0b;
;;;318         memo_out0[4]=0x55;
;;;319         memo_out0[5]=0x55; 
;;;320         	
;;;321         memo_out0[6]=crc_87(memo_out0,6);
;;;322    	memo_out0[7]=crc_95(memo_out0,6);
;;;323         usart_out_adr0(memo_out0,8); 
;;;324    	*/
;;;325    	snmp_trap_send("Main power alarm, voltage reduced",2,1,0);
;;;326    	}
;;;327    
;;;328    else if(in==2)
;;;329    	{
;;;330    	net_av=2;
;;;331    
;;;332    	//beep_init(0x01L,'O');
;;;333    	//a.av.bAN=1;
;;;334    
;;;335    
;;;336    	//beep_init(0x33333333,'A');
;;;337    	 
;;;338    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;339    	event_ptr++;	
;;;340    	if(event_ptr>63)event_ptr=0;	
;;;341    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;342    	
;;;343         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;344    	if(event_cnt!=63)event_cnt=event_ptr;
;;;345    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;346    	
;;;347    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;348    	
;;;349    	data[0]='P';
;;;350    	data[1]=0;
;;;351    	data[2]='B';
000316  f04f0942          MOV      r9,#0x42
00031a  2802              CMP      r0,#2                 ;328
00031c  d06d              BEQ      |L1.1018|
;;;352    	data[3]=0;
;;;353    	lc640_write_long_ptr(lc640_adr,data);
;;;354    
;;;355    	data[0]=0;//*((char*)&Unet_store);
;;;356    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;357    	data[2]=0;
;;;358    	data[3]=0;
;;;359    	lc640_write_long_ptr(lc640_adr+4,data);
;;;360    
;;;361    	data[0]=LPC_RTC->YEAR;
;;;362    	data[1]=LPC_RTC->MONTH;
;;;363    	data[2]=LPC_RTC->DOM;
;;;364    	data[3]=0;
;;;365    	lc640_write_long_ptr(lc640_adr+8,data);
;;;366    
;;;367    	data[0]=LPC_RTC->HOUR;
;;;368    	data[1]=LPC_RTC->MIN;
;;;369    	data[2]=LPC_RTC->SEC;
;;;370    	data[3]=0;
;;;371    	lc640_write_long_ptr(lc640_adr+12,data);
;;;372    	
;;;373    	data[0]='A';
;;;374    	data[1]='A';
;;;375    	data[2]='A';
;;;376    	data[3]='A';
;;;377    	lc640_write_long_ptr(lc640_adr+16,data);
;;;378    	
;;;379    	data[0]='A';
;;;380    	data[1]='A';
;;;381    	data[2]='A';
;;;382    	data[3]='A';
;;;383    	lc640_write_long_ptr(lc640_adr+20,data);
;;;384    	
;;;385    	data[0]='A';
;;;386    	data[1]='A';
;;;387    	data[2]='A';
;;;388    	data[3]='A';
;;;389    	lc640_write_long_ptr(lc640_adr+24,data);
;;;390    	
;;;391    	data[0]='A';
;;;392    	data[1]='A';
;;;393    	data[2]='A';
;;;394    	data[3]='A';
;;;395    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;396    	
;;;397    	snmp_trap_send("Main power alarm, voltage increased",2,2,0);
;;;398    	}
;;;399    
;;;400    else if(in==0)
00031e  2800              CMP      r0,#0
000320  d06c              BEQ      |L1.1020|
000322  e1d3              B        |L1.1740|
                  |L1.804|
000324  f04f0001          MOV      r0,#1                 ;246
000328  7008              STRB     r0,[r1,#0]            ;246
00032a  4941              LDR      r1,|L1.1072|
00032c  f44f6096          MOV      r0,#0x4b0             ;247
000330  8008              STRH     r0,[r1,#0]            ;247
000332  4628              MOV      r0,r5                 ;255
000334  f7fffffe          BL       lc640_read_int
000338  f1000001          ADD      r0,r0,#1              ;256
00033c  4681              MOV      r9,r0                 ;256
00033e  f1b90f3f          CMP      r9,#0x3f              ;257
000342  d901              BLS      |L1.840|
000344  f04f0900          MOV      r9,#0                 ;257
                  |L1.840|
000348  fa0ff189          SXTH     r1,r9                 ;258
00034c  4628              MOV      r0,r5                 ;258
00034e  f7fffffe          BL       lc640_write_int
000352  4658              MOV      r0,r11                ;260
000354  f7fffffe          BL       lc640_read_int
000358  283f              CMP      r0,#0x3f              ;261
00035a  d000              BEQ      |L1.862|
00035c  4648              MOV      r0,r9                 ;261
                  |L1.862|
00035e  b201              SXTH     r1,r0                 ;262
000360  4658              MOV      r0,r11                ;262
000362  f7fffffe          BL       lc640_write_int
000366  4628              MOV      r0,r5                 ;264
000368  f7fffffe          BL       lc640_read_int
00036c  eb081540          ADD      r5,r8,r0,LSL #5       ;264
000370  f88da000          STRB     r10,[sp,#0]           ;266
000374  f88d7001          STRB     r7,[sp,#1]            ;267
000378  f88d4002          STRB     r4,[sp,#2]            ;268
00037c  f88d7003          STRB     r7,[sp,#3]            ;269
000380  4669              MOV      r1,sp                 ;270
000382  4628              MOV      r0,r5                 ;270
000384  f7fffffe          BL       lc640_write_long_ptr
000388  9700              STR      r7,[sp,#0]            ;275
00038a  4669              MOV      r1,sp                 ;276
00038c  1d28              ADDS     r0,r5,#4              ;276
00038e  f7fffffe          BL       lc640_write_long_ptr
000392  f1060620          ADD      r6,r6,#0x20           ;278
000396  8bb0              LDRH     r0,[r6,#0x1c]         ;278
000398  f88d0000          STRB     r0,[sp,#0]            ;278
00039c  7e30              LDRB     r0,[r6,#0x18]         ;279
00039e  f88d0001          STRB     r0,[sp,#1]            ;279
0003a2  7b30              LDRB     r0,[r6,#0xc]          ;280
0003a4  f88d0002          STRB     r0,[sp,#2]            ;280
0003a8  f88d7003          STRB     r7,[sp,#3]            ;281
0003ac  4669              MOV      r1,sp                 ;282
0003ae  f1050008          ADD      r0,r5,#8              ;282
0003b2  f7fffffe          BL       lc640_write_long_ptr
0003b6  7a30              LDRB     r0,[r6,#8]            ;284
0003b8  f88d0000          STRB     r0,[sp,#0]            ;284
0003bc  7930              LDRB     r0,[r6,#4]            ;285
0003be  f88d0001          STRB     r0,[sp,#1]            ;285
0003c2  7830              LDRB     r0,[r6,#0]            ;286
0003c4  f88d0002          STRB     r0,[sp,#2]            ;286
0003c8  f88d7003          STRB     r7,[sp,#3]            ;287
0003cc  4669              MOV      r1,sp                 ;288
0003ce  f105000c          ADD      r0,r5,#0xc            ;288
0003d2  f7fffffe          BL       lc640_write_long_ptr
0003d6  f88d4000          STRB     r4,[sp,#0]            ;290
0003da  f88d4001          STRB     r4,[sp,#1]            ;291
0003de  f88d4002          STRB     r4,[sp,#2]            ;292
0003e2  f88d4003          STRB     r4,[sp,#3]            ;293
0003e6  4669              MOV      r1,sp                 ;294
0003e8  f1050010          ADD      r0,r5,#0x10           ;294
0003ec  f7fffffe          BL       lc640_write_long_ptr
0003f0  f88d4000          STRB     r4,[sp,#0]            ;296
0003f4  f88d4001          STRB     r4,[sp,#1]            ;297
0003f8  e01c              B        |L1.1076|
                  |L1.1018|
0003fa  e045              B        |L1.1160|
                  |L1.1020|
0003fc  e0d5              B        |L1.1450|
0003fe  0000              DCW      0x0000
                  |L1.1024|
                          DCD      net_av
                  |L1.1028|
                          DCD      ||.data||
                  |L1.1032|
                          DCD      bat
                  |L1.1036|
                          DCD      bps
                  |L1.1040|
                          DCD      sk_av_stat
                  |L1.1044|
                          DCD      SK_ZVUK_EN
                  |L1.1048|
                          DCD      AV_OFF_AVT
                  |L1.1052|
                          DCD      0xeffffffe
                  |L1.1056|
                          DCD      status_izm_r
                  |L1.1060|
                          DCD      sk_alarm
                  |L1.1064|
                          DCD      0x40024020
                  |L1.1068|
                          DCD      0x400fc000
                  |L1.1072|
                          DCD      net_av_2min_timer
                  |L1.1076|
000434  f88d4002          STRB     r4,[sp,#2]            ;298
000438  f88d4003          STRB     r4,[sp,#3]            ;299
00043c  4669              MOV      r1,sp                 ;300
00043e  f1050014          ADD      r0,r5,#0x14           ;300
000442  f7fffffe          BL       lc640_write_long_ptr
000446  f88d4000          STRB     r4,[sp,#0]            ;302
00044a  f88d4001          STRB     r4,[sp,#1]            ;303
00044e  f88d4002          STRB     r4,[sp,#2]            ;304
000452  f88d4003          STRB     r4,[sp,#3]            ;305
000456  4669              MOV      r1,sp                 ;306
000458  f1050018          ADD      r0,r5,#0x18           ;306
00045c  f7fffffe          BL       lc640_write_long_ptr
000460  f88d4000          STRB     r4,[sp,#0]            ;308
000464  f88d4001          STRB     r4,[sp,#1]            ;309
000468  f88d4002          STRB     r4,[sp,#2]            ;310
00046c  f88d4003          STRB     r4,[sp,#3]            ;311
000470  4669              MOV      r1,sp                 ;312
000472  f105001c          ADD      r0,r5,#0x1c           ;312
000476  f7fffffe          BL       lc640_write_long_ptr
00047a  2300              MOVS     r3,#0                 ;325
00047c  2201              MOVS     r2,#1                 ;325
00047e  2102              MOVS     r1,#2                 ;325
000480  a0ff              ADR      r0,|L1.2176|
000482  f7fffffe          BL       snmp_trap_send
000486  e121              B        |L1.1740|
                  |L1.1160|
000488  f04f0002          MOV      r0,#2                 ;330
00048c  7008              STRB     r0,[r1,#0]            ;330
00048e  f44f6060          MOV      r0,#0xe00             ;338
000492  f7fffffe          BL       lc640_read_int
000496  f1000001          ADD      r0,r0,#1              ;339
00049a  4605              MOV      r5,r0                 ;339
00049c  2d3f              CMP      r5,#0x3f              ;340
00049e  d901              BLS      |L1.1188|
0004a0  f04f0500          MOV      r5,#0                 ;340
                  |L1.1188|
0004a4  b229              SXTH     r1,r5                 ;341
0004a6  f44f6060          MOV      r0,#0xe00             ;341
0004aa  f7fffffe          BL       lc640_write_int
0004ae  4658              MOV      r0,r11                ;343
0004b0  f7fffffe          BL       lc640_read_int
0004b4  283f              CMP      r0,#0x3f              ;344
0004b6  d000              BEQ      |L1.1210|
0004b8  4628              MOV      r0,r5                 ;344
                  |L1.1210|
0004ba  b201              SXTH     r1,r0                 ;345
0004bc  4658              MOV      r0,r11                ;345
0004be  f7fffffe          BL       lc640_write_int
0004c2  f44f6060          MOV      r0,#0xe00             ;347
0004c6  f7fffffe          BL       lc640_read_int
0004ca  eb081540          ADD      r5,r8,r0,LSL #5       ;347
0004ce  f88da000          STRB     r10,[sp,#0]           ;349
0004d2  f88d7001          STRB     r7,[sp,#1]            ;350
0004d6  f88d9002          STRB     r9,[sp,#2]            ;351
0004da  f88d7003          STRB     r7,[sp,#3]            ;352
0004de  4669              MOV      r1,sp                 ;353
0004e0  4628              MOV      r0,r5                 ;353
0004e2  f7fffffe          BL       lc640_write_long_ptr
0004e6  9700              STR      r7,[sp,#0]            ;358
0004e8  4669              MOV      r1,sp                 ;359
0004ea  1d28              ADDS     r0,r5,#4              ;359
0004ec  f7fffffe          BL       lc640_write_long_ptr
0004f0  f1060620          ADD      r6,r6,#0x20           ;361
0004f4  8bb0              LDRH     r0,[r6,#0x1c]         ;361
0004f6  f88d0000          STRB     r0,[sp,#0]            ;361
0004fa  7e30              LDRB     r0,[r6,#0x18]         ;362
0004fc  f88d0001          STRB     r0,[sp,#1]            ;362
000500  7b30              LDRB     r0,[r6,#0xc]          ;363
000502  f88d0002          STRB     r0,[sp,#2]            ;363
000506  f88d7003          STRB     r7,[sp,#3]            ;364
00050a  4669              MOV      r1,sp                 ;365
00050c  f1050008          ADD      r0,r5,#8              ;365
000510  f7fffffe          BL       lc640_write_long_ptr
000514  7a30              LDRB     r0,[r6,#8]            ;367
000516  f88d0000          STRB     r0,[sp,#0]            ;367
00051a  7930              LDRB     r0,[r6,#4]            ;368
00051c  f88d0001          STRB     r0,[sp,#1]            ;368
000520  7830              LDRB     r0,[r6,#0]            ;369
000522  f88d0002          STRB     r0,[sp,#2]            ;369
000526  f88d7003          STRB     r7,[sp,#3]            ;370
00052a  4669              MOV      r1,sp                 ;371
00052c  f105000c          ADD      r0,r5,#0xc            ;371
000530  f7fffffe          BL       lc640_write_long_ptr
000534  f88d4000          STRB     r4,[sp,#0]            ;373
000538  f88d4001          STRB     r4,[sp,#1]            ;374
00053c  f88d4002          STRB     r4,[sp,#2]            ;375
000540  f88d4003          STRB     r4,[sp,#3]            ;376
000544  4669              MOV      r1,sp                 ;377
000546  f1050010          ADD      r0,r5,#0x10           ;377
00054a  f7fffffe          BL       lc640_write_long_ptr
00054e  f88d4000          STRB     r4,[sp,#0]            ;379
000552  f88d4001          STRB     r4,[sp,#1]            ;380
000556  f88d4002          STRB     r4,[sp,#2]            ;381
00055a  f88d4003          STRB     r4,[sp,#3]            ;382
00055e  4669              MOV      r1,sp                 ;383
000560  f1050014          ADD      r0,r5,#0x14           ;383
000564  f7fffffe          BL       lc640_write_long_ptr
000568  f88d4000          STRB     r4,[sp,#0]            ;385
00056c  f88d4001          STRB     r4,[sp,#1]            ;386
000570  f88d4002          STRB     r4,[sp,#2]            ;387
000574  f88d4003          STRB     r4,[sp,#3]            ;388
000578  4669              MOV      r1,sp                 ;389
00057a  f1050018          ADD      r0,r5,#0x18           ;389
00057e  f7fffffe          BL       lc640_write_long_ptr
000582  f88d4000          STRB     r4,[sp,#0]            ;391
000586  f88d4001          STRB     r4,[sp,#1]            ;392
00058a  f88d4002          STRB     r4,[sp,#2]            ;393
00058e  f88d4003          STRB     r4,[sp,#3]            ;394
000592  4669              MOV      r1,sp                 ;395
000594  f105001c          ADD      r0,r5,#0x1c           ;395
000598  f7fffffe          BL       lc640_write_long_ptr
00059c  2202              MOVS     r2,#2                 ;397
00059e  2300              MOVS     r3,#0                 ;397
0005a0  4611              MOV      r1,r2                 ;397
0005a2  a0c0              ADR      r0,|L1.2212|
0005a4  f7fffffe          BL       snmp_trap_send
0005a8  e090              B        |L1.1740|
                  |L1.1450|
;;;401    	{
;;;402    	net_av=0;
0005aa  700f              STRB     r7,[r1,#0]
;;;403    
;;;404      /*
;;;405    	SET_REG(C2GSR,3,24,8);
;;;406    	C2MOD=0;
;;;407    	bOUT_FREE2=1;*/
;;;408    
;;;409    
;;;410    	//C2MOD=0;
;;;411    
;;;412    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;413    
;;;414         //beep_init(0x02L,'O');
;;;415    	//a_.av.bAN=0;
;;;416    	SET_REG(avar_stat,0,0,1);
0005ac  48c6              LDR      r0,|L1.2248|
0005ae  6801              LDR      r1,[r0,#0]  ; avar_stat
0005b0  f0210101          BIC      r1,r1,#1
0005b4  6001              STR      r1,[r0,#0]  ; avar_stat
;;;417    
;;;418    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;419    	
;;;420    	if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
0005b6  49c5              LDR      r1,|L1.2252|
0005b8  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
0005ba  b119              CBZ      r1,|L1.1476|
0005bc  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
0005be  f0210101          BIC      r1,r1,#1
0005c2  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.1476|
;;;421    
;;;422         event_ptr=lc640_read_int(PTR_EVENT_LOG);
0005c4  4628              MOV      r0,r5
0005c6  f7fffffe          BL       lc640_read_int
0005ca  4682              MOV      r10,r0
;;;423    	event_ptr_find=event_ptr;
0005cc  4654              MOV      r4,r10
                  |L1.1486|
;;;424    avar_unet_hndl_lbl1:
;;;425    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0005ce  eb081544          ADD      r5,r8,r4,LSL #5
;;;426    
;;;427         lc640_read_long_ptr(lc640_adr,data);
0005d2  4669              MOV      r1,sp
0005d4  4628              MOV      r0,r5
0005d6  f7fffffe          BL       lc640_read_long_ptr
;;;428         
;;;429         if(!((data[0]=='P')&&(data[1]==0)&&((data[2]=='A')||(data[2]=='B'))))
0005da  f89d0000          LDRB     r0,[sp,#0]
0005de  2850              CMP      r0,#0x50
0005e0  d108              BNE      |L1.1524|
0005e2  f89d0001          LDRB     r0,[sp,#1]
0005e6  b928              CBNZ     r0,|L1.1524|
0005e8  f89d0002          LDRB     r0,[sp,#2]
0005ec  2841              CMP      r0,#0x41
0005ee  d00a              BEQ      |L1.1542|
0005f0  2842              CMP      r0,#0x42
0005f2  d008              BEQ      |L1.1542|
                  |L1.1524|
;;;430         	{        
;;;431         	if(event_ptr_find)event_ptr_find--;
0005f4  b114              CBZ      r4,|L1.1532|
0005f6  f1a40401          SUB      r4,r4,#1
0005fa  e001              B        |L1.1536|
                  |L1.1532|
;;;432         	else event_ptr_find=63;
0005fc  f04f043f          MOV      r4,#0x3f
                  |L1.1536|
;;;433         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000600  4554              CMP      r4,r10
000602  d1e4              BNE      |L1.1486|
000604  e062              B        |L1.1740|
                  |L1.1542|
;;;434         	else goto avar_unet_hndl_lbl1;
;;;435         	}
;;;436         else 
;;;437         	{
;;;438         	lc640_read_long_ptr(lc640_adr+16,data);
000606  4669              MOV      r1,sp
000608  f1050010          ADD      r0,r5,#0x10
00060c  f7fffffe          BL       lc640_read_long_ptr
;;;439         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000610  f89d0000          LDRB     r0,[sp,#0]
000614  2841              CMP      r0,#0x41
000616  d10b              BNE      |L1.1584|
000618  f89d0001          LDRB     r0,[sp,#1]
00061c  2841              CMP      r0,#0x41
00061e  d107              BNE      |L1.1584|
000620  f89d0002          LDRB     r0,[sp,#2]
000624  2841              CMP      r0,#0x41
000626  d103              BNE      |L1.1584|
000628  f89d0003          LDRB     r0,[sp,#3]
00062c  2841              CMP      r0,#0x41
00062e  d008              BEQ      |L1.1602|
                  |L1.1584|
;;;440         		{        
;;;441         		if(event_ptr_find)event_ptr_find--;
000630  b114              CBZ      r4,|L1.1592|
000632  f1a40401          SUB      r4,r4,#1
000636  e001              B        |L1.1596|
                  |L1.1592|
;;;442             		else event_ptr_find=63;
000638  f04f043f          MOV      r4,#0x3f
                  |L1.1596|
;;;443             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
00063c  4554              CMP      r4,r10
00063e  d1c6              BNE      |L1.1486|
000640  e044              B        |L1.1740|
                  |L1.1602|
;;;444         		else goto avar_unet_hndl_lbl1;
;;;445         		}
;;;446    
;;;447         	}	
;;;448    	
;;;449    	data[0]=LPC_RTC->YEAR;
000642  f1060620          ADD      r6,r6,#0x20
000646  8bb0              LDRH     r0,[r6,#0x1c]
000648  f88d0000          STRB     r0,[sp,#0]
;;;450    	data[1]=LPC_RTC->MONTH;
00064c  7e30              LDRB     r0,[r6,#0x18]
00064e  f88d0001          STRB     r0,[sp,#1]
;;;451    	data[2]=LPC_RTC->DOM;
000652  7b30              LDRB     r0,[r6,#0xc]
000654  f88d0002          STRB     r0,[sp,#2]
;;;452    	data[3]=0;
000658  f88d7003          STRB     r7,[sp,#3]
;;;453    	lc640_write_long_ptr(lc640_adr+16,data);
00065c  4669              MOV      r1,sp
00065e  f1050010          ADD      r0,r5,#0x10
000662  f7fffffe          BL       lc640_write_long_ptr
;;;454    
;;;455    	data[0]=LPC_RTC->HOUR;
000666  7a30              LDRB     r0,[r6,#8]
000668  f88d0000          STRB     r0,[sp,#0]
;;;456    	data[1]=LPC_RTC->MIN;
00066c  7930              LDRB     r0,[r6,#4]
00066e  f88d0001          STRB     r0,[sp,#1]
;;;457    	data[2]=LPC_RTC->SEC;
000672  7830              LDRB     r0,[r6,#0]
000674  f88d0002          STRB     r0,[sp,#2]
;;;458    	data[3]=0;
000678  f88d7003          STRB     r7,[sp,#3]
;;;459    	lc640_write_long_ptr(lc640_adr+20,data); 
00067c  4669              MOV      r1,sp
00067e  f1050014          ADD      r0,r5,#0x14
000682  f7fffffe          BL       lc640_write_long_ptr
;;;460    	
;;;461    	data[0]=*((char*)(&net_Ustore));
000686  4892              LDR      r0,|L1.2256|
000688  7801              LDRB     r1,[r0,#0]  ; net_Ustore
00068a  f88d1000          STRB     r1,[sp,#0]
;;;462    	data[1]=*(((char*)(&net_Ustore))+1);
00068e  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000690  f88d0001          STRB     r0,[sp,#1]
;;;463    	data[2]='B';
000694  f88d9002          STRB     r9,[sp,#2]
;;;464    	data[3]='B';
000698  f88d9003          STRB     r9,[sp,#3]
;;;465    	lc640_write_long_ptr(lc640_adr+24,data);
00069c  4669              MOV      r1,sp
00069e  f1050018          ADD      r0,r5,#0x18
0006a2  f7fffffe          BL       lc640_write_long_ptr
;;;466    	
;;;467    	data[0]='B';
0006a6  f88d9000          STRB     r9,[sp,#0]
;;;468    	data[1]='B';
0006aa  f88d9001          STRB     r9,[sp,#1]
;;;469    	data[2]='B';
0006ae  f88d9002          STRB     r9,[sp,#2]
;;;470    	data[3]='B';
0006b2  f88d9003          STRB     r9,[sp,#3]
;;;471    	lc640_write_long_ptr(lc640_adr+28,data);	
0006b6  4669              MOV      r1,sp
0006b8  f105001c          ADD      r0,r5,#0x1c
0006bc  f7fffffe          BL       lc640_write_long_ptr
;;;472    	
;;;473    /*	memo_out0[0]=0x55;
;;;474         memo_out0[1]=0x00+2;
;;;475         memo_out0[2]=1;
;;;476         memo_out0[3]=0x0b;
;;;477         memo_out0[4]=0xaa;
;;;478         memo_out0[5]=0xaa; 
;;;479         	
;;;480         memo_out0[6]=crc_87(memo_out0,6);
;;;481    	memo_out0[7]=crc_95(memo_out0,6);
;;;482         usart_out_adr0(memo_out0,8); */
;;;483         snmp_trap_send("Main power alarm  clear",2,1,1);	
0006c0  2301              MOVS     r3,#1
0006c2  461a              MOV      r2,r3
0006c4  2102              MOVS     r1,#2
0006c6  a083              ADR      r0,|L1.2260|
0006c8  f7fffffe          BL       snmp_trap_send
                  |L1.1740|
;;;484    	}
;;;485    avar_unet_hndl_end:
;;;486    	__nop();		
0006cc  bf00              NOP      
                  |L1.1742|
;;;487    }
0006ce  e8bd8ff8          POP      {r3-r11,pc}
;;;488    
                          ENDP

                  avar_uout_hndl PROC
;;;490    //-----------------------------------------------
;;;491    void avar_uout_hndl(char in)
0006d2  e92d4ff8          PUSH     {r3-r11,lr}
;;;492    {
;;;493    
;;;494    char data[4];
;;;495    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;496    char avar_data=0;
;;;497    
;;;498    if(in==1)
;;;499    	{
;;;500    	//net_av=1;
;;;501    
;;;502    	//beep_init(0x01L,'O');
;;;503    	//a.av.bAN=1;
;;;504    
;;;505    
;;;506    	//beep_init(0x33333333,'A');
;;;507    
;;;508    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;509    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;510    	
;;;511    	avar_data=uout_av;
;;;512    		 
;;;513    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;514    	event_ptr++;	
;;;515    	if(event_ptr>63)event_ptr=0;	
;;;516    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;517    	
;;;518        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;519    	if(event_cnt!=63)event_cnt=event_ptr;
;;;520    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;521    	
;;;522    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;523    	
;;;524    	data[0]='Q';
;;;525    	data[1]=0;
;;;526    	data[2]='A';
;;;527    	data[3]=avar_data;
;;;528    	lc640_write_long_ptr(lc640_adr,data);
;;;529    
;;;530    	 //load_U=4321;
;;;531    
;;;532    	data[0]=*((char*)&load_U);
;;;533    	data[1]=*(((char*)&load_U)+1);
;;;534    	data[2]=0;
;;;535    	data[3]=0;
;;;536    	lc640_write_long_ptr(lc640_adr+4,data);
;;;537    
;;;538    	data[0]=LPC_RTC->YEAR;
0006d6  4f85              LDR      r7,|L1.2284|
0006d8  4985              LDR      r1,|L1.2288|
0006da  f44f6560          MOV      r5,#0xe00             ;513
0006de  f04f0800          MOV      r8,#0                 ;496
0006e2  f44f6980          MOV      r9,#0x400             ;522
0006e6  2801              CMP      r0,#1                 ;498
0006e8  d002              BEQ      |L1.1776|
;;;539    	data[1]=LPC_RTC->MONTH;
;;;540    	data[2]=LPC_RTC->DOM;
;;;541    	data[3]=0;
;;;542    	lc640_write_long_ptr(lc640_adr+8,data);
;;;543    
;;;544    	data[0]=LPC_RTC->HOUR;
;;;545    	data[1]=LPC_RTC->MIN;
;;;546    	data[2]=LPC_RTC->SEC;
;;;547    	data[3]=0;
;;;548    	lc640_write_long_ptr(lc640_adr+12,data);
;;;549    	
;;;550    	data[0]='A';
;;;551    	data[1]='A';
;;;552    	data[2]='A';
;;;553    	data[3]='A';
;;;554    	lc640_write_long_ptr(lc640_adr+16,data);
;;;555    	
;;;556    	data[0]='A';
;;;557    	data[1]='A';
;;;558    	data[2]='A';
;;;559    	data[3]='A';
;;;560    	lc640_write_long_ptr(lc640_adr+20,data);
;;;561    	
;;;562    	data[0]='A';
;;;563    	data[1]='A';
;;;564    	data[2]='A';
;;;565    	data[3]='A';
;;;566    	lc640_write_long_ptr(lc640_adr+24,data);
;;;567    	
;;;568    	data[0]='A';
;;;569    	data[1]='A';
;;;570    	data[2]='A';
;;;571    	data[3]='A';
;;;572    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;573    	
;;;574    /*	memo_out0[0]=0x55;
;;;575         memo_out0[1]=0x00+2;
;;;576         memo_out0[2]=1;
;;;577         memo_out0[3]=0x0b;
;;;578         memo_out0[4]=0x55;
;;;579         memo_out0[5]=0x55; 
;;;580         	
;;;581         memo_out0[6]=crc_87(memo_out0,6);
;;;582    	memo_out0[7]=crc_95(memo_out0,6);
;;;583         usart_out_adr0(memo_out0,8); 
;;;584    	*/
;;;585    	//snmp_trap_send("Main power is off",2,1,0);
;;;586    	}
;;;587    
;;;588    else if(in==0)
0006ea  2800              CMP      r0,#0
0006ec  d07d              BEQ      |L1.2026|
0006ee  e174              B        |L1.2522|
                  |L1.1776|
0006f0  f8dfa200          LDR      r10,|L1.2292|
0006f4  4a80              LDR      r2,|L1.2296|
0006f6  f9ba0000          LDRSH    r0,[r10,#0]           ;508  ; load_U
0006fa  f9b22000          LDRSH    r2,[r2,#0]            ;508  ; U_OUT_KONTR_MAX
0006fe  4290              CMP      r0,r2                 ;508
000700  dd02              BLE      |L1.1800|
000702  f04f0201          MOV      r2,#1                 ;508
000706  700a              STRB     r2,[r1,#0]            ;508
                  |L1.1800|
000708  4a7c              LDR      r2,|L1.2300|
00070a  f9b22000          LDRSH    r2,[r2,#0]            ;509  ; U_OUT_KONTR_MIN
00070e  4290              CMP      r0,r2                 ;509
000710  da02              BGE      |L1.1816|
000712  f04f0002          MOV      r0,#2                 ;509
000716  7008              STRB     r0,[r1,#0]            ;509
                  |L1.1816|
000718  780e              LDRB     r6,[r1,#0]            ;511  ; uout_av
00071a  4628              MOV      r0,r5                 ;513
00071c  f7fffffe          BL       lc640_read_int
000720  f1000001          ADD      r0,r0,#1              ;514
000724  4604              MOV      r4,r0                 ;514
000726  2c3f              CMP      r4,#0x3f              ;515
000728  d901              BLS      |L1.1838|
00072a  f04f0400          MOV      r4,#0                 ;515
                  |L1.1838|
00072e  b221              SXTH     r1,r4                 ;516
000730  4628              MOV      r0,r5                 ;516
000732  f7fffffe          BL       lc640_write_int
000736  f6406b02          MOV      r11,#0xe02            ;518
00073a  4658              MOV      r0,r11                ;518
00073c  f7fffffe          BL       lc640_read_int
000740  283f              CMP      r0,#0x3f              ;519
000742  d000              BEQ      |L1.1862|
000744  4620              MOV      r0,r4                 ;519
                  |L1.1862|
000746  b201              SXTH     r1,r0                 ;520
000748  4658              MOV      r0,r11                ;520
00074a  f7fffffe          BL       lc640_write_int
00074e  4628              MOV      r0,r5                 ;522
000750  f7fffffe          BL       lc640_read_int
000754  eb091540          ADD      r5,r9,r0,LSL #5       ;522
000758  f04f0051          MOV      r0,#0x51              ;524
00075c  f88d0000          STRB     r0,[sp,#0]            ;524
000760  f88d8001          STRB     r8,[sp,#1]            ;525
000764  f04f0441          MOV      r4,#0x41              ;526
000768  f88d4002          STRB     r4,[sp,#2]            ;526
00076c  f88d6003          STRB     r6,[sp,#3]            ;527
000770  4669              MOV      r1,sp                 ;528
000772  4628              MOV      r0,r5                 ;528
000774  f7fffffe          BL       lc640_write_long_ptr
000778  f89a0000          LDRB     r0,[r10,#0]           ;532  ; load_U
00077c  f88d0000          STRB     r0,[sp,#0]            ;532
000780  f89a0001          LDRB     r0,[r10,#1]           ;533  ; load_U
000784  f88d0001          STRB     r0,[sp,#1]            ;533
000788  f88d8002          STRB     r8,[sp,#2]            ;534
00078c  f88d8003          STRB     r8,[sp,#3]            ;535
000790  4669              MOV      r1,sp                 ;536
000792  1d28              ADDS     r0,r5,#4              ;536
000794  f7fffffe          BL       lc640_write_long_ptr
000798  f1070720          ADD      r7,r7,#0x20           ;538
00079c  8bb8              LDRH     r0,[r7,#0x1c]         ;538
00079e  f88d0000          STRB     r0,[sp,#0]            ;538
0007a2  7e38              LDRB     r0,[r7,#0x18]         ;539
0007a4  f88d0001          STRB     r0,[sp,#1]            ;539
0007a8  7b38              LDRB     r0,[r7,#0xc]          ;540
0007aa  f88d0002          STRB     r0,[sp,#2]            ;540
0007ae  f88d8003          STRB     r8,[sp,#3]            ;541
0007b2  4669              MOV      r1,sp                 ;542
0007b4  f1050008          ADD      r0,r5,#8              ;542
0007b8  f7fffffe          BL       lc640_write_long_ptr
0007bc  7a38              LDRB     r0,[r7,#8]            ;544
0007be  f88d0000          STRB     r0,[sp,#0]            ;544
0007c2  7938              LDRB     r0,[r7,#4]            ;545
0007c4  f88d0001          STRB     r0,[sp,#1]            ;545
0007c8  7838              LDRB     r0,[r7,#0]            ;546
0007ca  f88d0002          STRB     r0,[sp,#2]            ;546
0007ce  f88d8003          STRB     r8,[sp,#3]            ;547
0007d2  4669              MOV      r1,sp                 ;548
0007d4  f105000c          ADD      r0,r5,#0xc            ;548
0007d8  f7fffffe          BL       lc640_write_long_ptr
0007dc  f88d4000          STRB     r4,[sp,#0]            ;550
0007e0  f88d4001          STRB     r4,[sp,#1]            ;551
0007e4  f88d4002          STRB     r4,[sp,#2]            ;552
0007e8  e000              B        |L1.2028|
                  |L1.2026|
0007ea  e02e              B        |L1.2122|
                  |L1.2028|
0007ec  f88d4003          STRB     r4,[sp,#3]            ;553
0007f0  4669              MOV      r1,sp                 ;554
0007f2  f1050010          ADD      r0,r5,#0x10           ;554
0007f6  f7fffffe          BL       lc640_write_long_ptr
0007fa  f88d4000          STRB     r4,[sp,#0]            ;556
0007fe  f88d4001          STRB     r4,[sp,#1]            ;557
000802  f88d4002          STRB     r4,[sp,#2]            ;558
000806  f88d4003          STRB     r4,[sp,#3]            ;559
00080a  4669              MOV      r1,sp                 ;560
00080c  f1050014          ADD      r0,r5,#0x14           ;560
000810  f7fffffe          BL       lc640_write_long_ptr
000814  f88d4000          STRB     r4,[sp,#0]            ;562
000818  f88d4001          STRB     r4,[sp,#1]            ;563
00081c  f88d4002          STRB     r4,[sp,#2]            ;564
000820  f88d4003          STRB     r4,[sp,#3]            ;565
000824  4669              MOV      r1,sp                 ;566
000826  f1050018          ADD      r0,r5,#0x18           ;566
00082a  f7fffffe          BL       lc640_write_long_ptr
00082e  f88d4000          STRB     r4,[sp,#0]            ;568
000832  f88d4001          STRB     r4,[sp,#1]            ;569
000836  f88d4002          STRB     r4,[sp,#2]            ;570
00083a  f88d4003          STRB     r4,[sp,#3]            ;571
00083e  4669              MOV      r1,sp                 ;572
000840  f105001c          ADD      r0,r5,#0x1c           ;572
000844  f7fffffe          BL       lc640_write_long_ptr
000848  e0c7              B        |L1.2522|
                  |L1.2122|
;;;589    	{
;;;590    	uout_av=0;
00084a  f8818000          STRB     r8,[r1,#0]
;;;591    
;;;592      /*
;;;593    	SET_REG(C2GSR,3,24,8);
;;;594    	C2MOD=0;
;;;595    	bOUT_FREE2=1;*/
;;;596    
;;;597    
;;;598    	//C2MOD=0;
;;;599    
;;;600    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;601    
;;;602         //beep_init(0x02L,'O');
;;;603    	//a_.av.bAN=0;
;;;604    //	SET_REG(avar_stat,0,0,1);
;;;605    
;;;606    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;607    	
;;;608    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;609    
;;;610        event_ptr=lc640_read_int(PTR_EVENT_LOG);
00084e  4628              MOV      r0,r5
000850  f7fffffe          BL       lc640_read_int
000854  4606              MOV      r6,r0
;;;611    	event_ptr_find=event_ptr;
000856  4634              MOV      r4,r6
                  |L1.2136|
;;;612    avar_uout_hndl_lbl1:
;;;613    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000858  eb091544          ADD      r5,r9,r4,LSL #5
;;;614    
;;;615         lc640_read_long_ptr(lc640_adr,data);
00085c  4669              MOV      r1,sp
00085e  4628              MOV      r0,r5
000860  f7fffffe          BL       lc640_read_long_ptr
;;;616         
;;;617         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
000864  f89d0000          LDRB     r0,[sp,#0]
000868  2851              CMP      r0,#0x51
00086a  d106              BNE      |L1.2170|
00086c  f89d0001          LDRB     r0,[sp,#1]
000870  b918              CBNZ     r0,|L1.2170|
000872  f89d0002          LDRB     r0,[sp,#2]
000876  2841              CMP      r0,#0x41
000878  d04a              BEQ      |L1.2320|
                  |L1.2170|
;;;618         	{        
;;;619         	if(event_ptr_find)event_ptr_find--;
00087a  b104              CBZ      r4,|L1.2174|
00087c  e040              B        |L1.2304|
                  |L1.2174|
00087e  e042              B        |L1.2310|
                  |L1.2176|
000880  4d61696e          DCB      "Main power alarm, voltage reduced",0
000884  20706f77
000888  65722061
00088c  6c61726d
000890  2c20766f
000894  6c746167
000898  65207265
00089c  64756365
0008a0  6400    
0008a2  00                DCB      0
0008a3  00                DCB      0
                  |L1.2212|
0008a4  4d61696e          DCB      "Main power alarm, voltage increased",0
0008a8  20706f77
0008ac  65722061
0008b0  6c61726d
0008b4  2c20766f
0008b8  6c746167
0008bc  6520696e
0008c0  63726561
0008c4  73656400
                  |L1.2248|
                          DCD      ||.data||
                  |L1.2252|
                          DCD      AV_OFF_AVT
                  |L1.2256|
                          DCD      net_Ustore
                  |L1.2260|
0008d4  4d61696e          DCB      "Main power alarm  clear",0
0008d8  20706f77
0008dc  65722061
0008e0  6c61726d
0008e4  2020636c
0008e8  65617200
                  |L1.2284|
                          DCD      0x40024000
                  |L1.2288|
                          DCD      uout_av
                  |L1.2292|
                          DCD      load_U
                  |L1.2296|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2300|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2304|
000900  f1a40401          SUB      r4,r4,#1
000904  e001              B        |L1.2314|
                  |L1.2310|
;;;620         	else event_ptr_find=63;
000906  f04f043f          MOV      r4,#0x3f
                  |L1.2314|
;;;621         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
00090a  42b4              CMP      r4,r6
00090c  d1a4              BNE      |L1.2136|
00090e  e064              B        |L1.2522|
                  |L1.2320|
;;;622         	else goto avar_uout_hndl_lbl1;
;;;623         	}
;;;624         else 
;;;625         	{
;;;626         	lc640_read_long_ptr(lc640_adr+16,data);
000910  4669              MOV      r1,sp
000912  f1050010          ADD      r0,r5,#0x10
000916  f7fffffe          BL       lc640_read_long_ptr
;;;627         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00091a  f89d0000          LDRB     r0,[sp,#0]
00091e  2841              CMP      r0,#0x41
000920  d10b              BNE      |L1.2362|
000922  f89d0001          LDRB     r0,[sp,#1]
000926  2841              CMP      r0,#0x41
000928  d107              BNE      |L1.2362|
00092a  f89d0002          LDRB     r0,[sp,#2]
00092e  2841              CMP      r0,#0x41
000930  d103              BNE      |L1.2362|
000932  f89d0003          LDRB     r0,[sp,#3]
000936  2841              CMP      r0,#0x41
000938  d008              BEQ      |L1.2380|
                  |L1.2362|
;;;628         		{        
;;;629         		if(event_ptr_find)event_ptr_find--;
00093a  b114              CBZ      r4,|L1.2370|
00093c  f1a40401          SUB      r4,r4,#1
000940  e001              B        |L1.2374|
                  |L1.2370|
;;;630             		else event_ptr_find=63;
000942  f04f043f          MOV      r4,#0x3f
                  |L1.2374|
;;;631             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000946  42b4              CMP      r4,r6
000948  d186              BNE      |L1.2136|
00094a  e046              B        |L1.2522|
                  |L1.2380|
;;;632         		else goto avar_uout_hndl_lbl1;
;;;633         		}
;;;634    
;;;635         	}	
;;;636    	
;;;637    	data[0]=LPC_RTC->YEAR;
00094c  f1070720          ADD      r7,r7,#0x20
000950  8bb8              LDRH     r0,[r7,#0x1c]
000952  f88d0000          STRB     r0,[sp,#0]
;;;638    	data[1]=LPC_RTC->MONTH;
000956  7e38              LDRB     r0,[r7,#0x18]
000958  f88d0001          STRB     r0,[sp,#1]
;;;639    	data[2]=LPC_RTC->DOM;
00095c  7b38              LDRB     r0,[r7,#0xc]
00095e  f88d0002          STRB     r0,[sp,#2]
;;;640    	data[3]=0;
000962  f88d8003          STRB     r8,[sp,#3]
;;;641    	lc640_write_long_ptr(lc640_adr+16,data);
000966  4669              MOV      r1,sp
000968  f1050010          ADD      r0,r5,#0x10
00096c  f7fffffe          BL       lc640_write_long_ptr
;;;642    
;;;643    	data[0]=LPC_RTC->HOUR;
000970  7a38              LDRB     r0,[r7,#8]
000972  f88d0000          STRB     r0,[sp,#0]
;;;644    	data[1]=LPC_RTC->MIN;
000976  7938              LDRB     r0,[r7,#4]
000978  f88d0001          STRB     r0,[sp,#1]
;;;645    	data[2]=LPC_RTC->SEC;
00097c  7838              LDRB     r0,[r7,#0]
00097e  f88d0002          STRB     r0,[sp,#2]
;;;646    	data[3]=0;
000982  f88d8003          STRB     r8,[sp,#3]
;;;647    	lc640_write_long_ptr(lc640_adr+20,data); 
000986  4669              MOV      r1,sp
000988  f1050014          ADD      r0,r5,#0x14
00098c  f7fffffe          BL       lc640_write_long_ptr
;;;648    	
;;;649    	data[0]=*((char*)(&net_Ustore));
000990  48ff              LDR      r0,|L1.3472|
000992  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000994  f88d1000          STRB     r1,[sp,#0]
;;;650    	data[1]=*(((char*)(&net_Ustore))+1);
000998  7840              LDRB     r0,[r0,#1]  ; net_Ustore
00099a  f88d0001          STRB     r0,[sp,#1]
;;;651    	data[2]='B';
00099e  f04f0442          MOV      r4,#0x42
0009a2  f88d4002          STRB     r4,[sp,#2]
;;;652    	data[3]='B';
0009a6  f88d4003          STRB     r4,[sp,#3]
;;;653    	lc640_write_long_ptr(lc640_adr+24,data);
0009aa  4669              MOV      r1,sp
0009ac  f1050018          ADD      r0,r5,#0x18
0009b0  f7fffffe          BL       lc640_write_long_ptr
;;;654    	
;;;655    	data[0]='B';
0009b4  f88d4000          STRB     r4,[sp,#0]
;;;656    	data[1]='B';
0009b8  f88d4001          STRB     r4,[sp,#1]
;;;657    	data[2]='B';
0009bc  f88d4002          STRB     r4,[sp,#2]
;;;658    	data[3]='B';
0009c0  f88d4003          STRB     r4,[sp,#3]
;;;659    	lc640_write_long_ptr(lc640_adr+28,data);	
0009c4  4669              MOV      r1,sp
0009c6  f105001c          ADD      r0,r5,#0x1c
0009ca  f7fffffe          BL       lc640_write_long_ptr
;;;660    	
;;;661    /*	memo_out0[0]=0x55;
;;;662         memo_out0[1]=0x00+2;
;;;663         memo_out0[2]=1;
;;;664         memo_out0[3]=0x0b;
;;;665         memo_out0[4]=0xaa;
;;;666         memo_out0[5]=0xaa; 
;;;667         	
;;;668         memo_out0[6]=crc_87(memo_out0,6);
;;;669    	memo_out0[7]=crc_95(memo_out0,6);
;;;670         usart_out_adr0(memo_out0,8); */
;;;671         snmp_trap_send("Main power is on",2,1,1);	
0009ce  2301              MOVS     r3,#1
0009d0  461a              MOV      r2,r3
0009d2  2102              MOVS     r1,#2
0009d4  a0ef              ADR      r0,|L1.3476|
0009d6  f7fffffe          BL       snmp_trap_send
                  |L1.2522|
;;;672    	}
;;;673    avar_unet_hndl_end:
;;;674    	__nop();		
0009da  bf00              NOP      
                  |L1.2524|
;;;675    }
0009dc  e677              B        |L1.1742|
;;;676    
                          ENDP

                  avar_bps_hndl PROC
;;;677    //-----------------------------------------------
;;;678    void avar_bps_hndl(char dev, char v, char in)
0009de  e92d4ff8          PUSH     {r3-r11,lr}
;;;679    {
0009e2  4606              MOV      r6,r0
0009e4  460c              MOV      r4,r1
;;;680    char data[4];
;;;681    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;682    char avar_simbol;
;;;683    
;;;684    avar_simbol='T';
0009e6  f04f0754          MOV      r7,#0x54
;;;685    if(v==0)avar_simbol='T';
0009ea  b174              CBZ      r4,|L1.2570|
;;;686    else if(v==1)avar_simbol='U';
0009ec  2c01              CMP      r4,#1
0009ee  d004              BEQ      |L1.2554|
;;;687    else if(v==2)avar_simbol='u';
0009f0  2c02              CMP      r4,#2
0009f2  d005              BEQ      |L1.2560|
;;;688    else if(v==3)avar_simbol='L';
0009f4  2c03              CMP      r4,#3
0009f6  d006              BEQ      |L1.2566|
0009f8  e007              B        |L1.2570|
                  |L1.2554|
0009fa  f04f0755          MOV      r7,#0x55              ;686
0009fe  e004              B        |L1.2570|
                  |L1.2560|
000a00  f04f0775          MOV      r7,#0x75              ;687
000a04  e001              B        |L1.2570|
                  |L1.2566|
000a06  f04f074c          MOV      r7,#0x4c
                  |L1.2570|
;;;689    
;;;690    if(in==1)
;;;691    	{
;;;692    	//av_src[bps]=1;
;;;693    
;;;694    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;695    //	SET_REG(avar_stat,1,3+dev,1);
;;;696    	
;;;697    	if(v==0)bps[dev]._av|=(1<<0);
000a0a  48e8              LDR      r0,|L1.3500|
000a0c  eb0601c6          ADD      r1,r6,r6,LSL #3
;;;698    	else if(v==1) bps[dev]._av|=(1<<1);
;;;699    	else if(v==2) bps[dev]._av|=(1<<2);
;;;700    	else if(v==3) bps[dev]._av|=(1<<3);
;;;701    
;;;702    	bps[dev]._last_avar=v;
;;;703    
;;;704    	//beep_init(0x33333333,'A');
;;;705    
;;;706    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;707    	event_ptr++;	
;;;708    	if(event_ptr>63)event_ptr=0;	
;;;709    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;710    	
;;;711        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;712    	if(event_cnt!=63)event_cnt=event_ptr;
;;;713    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;714    	
;;;715    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;716    	
;;;717    	data[0]='S';
;;;718    	data[1]=dev; 
;;;719    	data[2]=avar_simbol;
;;;720    	data[3]=0;
;;;721    	lc640_write_long_ptr(lc640_adr,data);
;;;722    
;;;723    	data[0]=0;
;;;724    	data[1]=0;
;;;725    	data[2]=0;
;;;726    	data[3]=0;
;;;727    	lc640_write_long_ptr(lc640_adr+4,data);
;;;728    
;;;729    	data[0]=LPC_RTC->YEAR;
000a10  f8df8394          LDR      r8,|L1.3496|
000a14  eb011106          ADD      r1,r1,r6,LSL #4       ;697
000a18  f04f0900          MOV      r9,#0                 ;679
000a1c  f44f6a60          MOV      r10,#0xe00            ;706
000a20  f44f6580          MOV      r5,#0x400             ;715
000a24  eb000081          ADD      r0,r0,r1,LSL #2       ;697
000a28  2a01              CMP      r2,#1                 ;690
000a2a  d002              BEQ      |L1.2610|
;;;730    	data[1]=LPC_RTC->MONTH;
;;;731    	data[2]=LPC_RTC->DOM;
;;;732    	data[3]=0;
;;;733    	lc640_write_long_ptr(lc640_adr+8,data);
;;;734    
;;;735    	data[0]=LPC_RTC->HOUR;
;;;736    	data[1]=LPC_RTC->MIN;
;;;737    	data[2]=LPC_RTC->SEC;
;;;738    	data[3]=0;
;;;739    	lc640_write_long_ptr(lc640_adr+12,data);
;;;740    	
;;;741    	data[0]='A';
;;;742    	data[1]='A';
;;;743    	data[2]='A';
;;;744    	data[3]='A';
;;;745    	lc640_write_long_ptr(lc640_adr+16,data);
;;;746    	
;;;747    	data[0]='A';
;;;748    	data[1]='A';
;;;749    	data[2]='A';
;;;750    	data[3]='A';
;;;751    	lc640_write_long_ptr(lc640_adr+20,data);
;;;752    	
;;;753    	data[0]='A';
;;;754    	data[1]='A';
;;;755    	data[2]='A';
;;;756    	data[3]='A';
;;;757    	lc640_write_long_ptr(lc640_adr+24,data);
;;;758    	
;;;759    	data[0]='A';
;;;760    	data[1]='A';
;;;761    	data[2]='A';
;;;762    	data[3]='A';
;;;763    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;764    
;;;765    
;;;766    	if(dev==0)
;;;767    		{
;;;768    		if(v==0)
;;;769    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;770    		else if(v==1)
;;;771    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;772    		else if(v==2)
;;;773    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;774    		else if(v==3)
;;;775    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;776    		}
;;;777    	else if(dev==1)
;;;778    		{
;;;779    		if(v==0)
;;;780    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;781    		else if(v==1)
;;;782    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;783    		else if(v==2)
;;;784    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;785    		else if(v==3)
;;;786    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;787    		} 
;;;788    	else if(dev==2)
;;;789    		{
;;;790    		if(v==0)
;;;791    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;792    		else if(v==1)
;;;793    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;794    		else if(v==2)
;;;795    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;796    		else if(v==3)
;;;797    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;798    		} 	
;;;799    			
;;;800    	}
;;;801    
;;;802    else if(in==0)
000a2c  2a00              CMP      r2,#0
000a2e  d07e              BEQ      |L1.2862|
000a30  e284              B        |L1.3900|
                  |L1.2610|
000a32  b134              CBZ      r4,|L1.2626|
000a34  2c01              CMP      r4,#1                 ;698
000a36  d009              BEQ      |L1.2636|
000a38  2c02              CMP      r4,#2                 ;699
000a3a  d00c              BEQ      |L1.2646|
000a3c  2c03              CMP      r4,#3                 ;700
000a3e  d00f              BEQ      |L1.2656|
000a40  e012              B        |L1.2664|
                  |L1.2626|
000a42  7841              LDRB     r1,[r0,#1]            ;697
000a44  f0410101          ORR      r1,r1,#1              ;697
000a48  7041              STRB     r1,[r0,#1]            ;697
000a4a  e00d              B        |L1.2664|
                  |L1.2636|
000a4c  7841              LDRB     r1,[r0,#1]            ;698
000a4e  f0410102          ORR      r1,r1,#2              ;698
000a52  7041              STRB     r1,[r0,#1]            ;698
000a54  e008              B        |L1.2664|
                  |L1.2646|
000a56  7841              LDRB     r1,[r0,#1]            ;699
000a58  f0410104          ORR      r1,r1,#4              ;699
000a5c  7041              STRB     r1,[r0,#1]            ;699
000a5e  e003              B        |L1.2664|
                  |L1.2656|
000a60  7841              LDRB     r1,[r0,#1]            ;700
000a62  f0410108          ORR      r1,r1,#8              ;700
000a66  7041              STRB     r1,[r0,#1]            ;700
                  |L1.2664|
000a68  f8804057          STRB     r4,[r0,#0x57]         ;702
000a6c  4650              MOV      r0,r10                ;706
000a6e  f7fffffe          BL       lc640_read_int
000a72  f1000001          ADD      r0,r0,#1              ;707
000a76  fa1ffb80          UXTH     r11,r0                ;707
000a7a  f1bb0f3f          CMP      r11,#0x3f             ;708
000a7e  d901              BLS      |L1.2692|
000a80  f04f0b00          MOV      r11,#0                ;708
                  |L1.2692|
000a84  fa0ff18b          SXTH     r1,r11                ;709
000a88  4650              MOV      r0,r10                ;709
000a8a  f7fffffe          BL       lc640_write_int
000a8e  f6406002          MOV      r0,#0xe02             ;711
000a92  f7fffffe          BL       lc640_read_int
000a96  b280              UXTH     r0,r0                 ;711
000a98  283f              CMP      r0,#0x3f              ;712
000a9a  d000              BEQ      |L1.2718|
000a9c  4658              MOV      r0,r11                ;712
                  |L1.2718|
000a9e  b201              SXTH     r1,r0                 ;713
000aa0  f6406002          MOV      r0,#0xe02             ;713
000aa4  f7fffffe          BL       lc640_write_int
000aa8  4650              MOV      r0,r10                ;715
000aaa  f7fffffe          BL       lc640_read_int
000aae  eb051040          ADD      r0,r5,r0,LSL #5       ;715
000ab2  b285              UXTH     r5,r0                 ;715
000ab4  f04f0053          MOV      r0,#0x53              ;717
000ab8  f88d0000          STRB     r0,[sp,#0]            ;717
000abc  f88d6001          STRB     r6,[sp,#1]            ;718
000ac0  f88d7002          STRB     r7,[sp,#2]            ;719
000ac4  f88d9003          STRB     r9,[sp,#3]            ;720
000ac8  4669              MOV      r1,sp                 ;721
000aca  4628              MOV      r0,r5                 ;721
000acc  f7fffffe          BL       lc640_write_long_ptr
000ad0  f8cd9000          STR      r9,[sp,#0]            ;726
000ad4  4669              MOV      r1,sp                 ;727
000ad6  1d28              ADDS     r0,r5,#4              ;727
000ad8  f7fffffe          BL       lc640_write_long_ptr
000adc  f8b8003c          LDRH     r0,[r8,#0x3c]         ;729
000ae0  f88d0000          STRB     r0,[sp,#0]            ;729
000ae4  f8980038          LDRB     r0,[r8,#0x38]         ;730
000ae8  f88d0001          STRB     r0,[sp,#1]            ;730
000aec  f898002c          LDRB     r0,[r8,#0x2c]         ;731
000af0  f88d0002          STRB     r0,[sp,#2]            ;731
000af4  f88d9003          STRB     r9,[sp,#3]            ;732
000af8  4669              MOV      r1,sp                 ;733
000afa  f1050008          ADD      r0,r5,#8              ;733
000afe  f7fffffe          BL       lc640_write_long_ptr
000b02  f8980028          LDRB     r0,[r8,#0x28]         ;735
000b06  f88d0000          STRB     r0,[sp,#0]            ;735
000b0a  f8980024          LDRB     r0,[r8,#0x24]         ;736
000b0e  f88d0001          STRB     r0,[sp,#1]            ;736
000b12  f8980020          LDRB     r0,[r8,#0x20]         ;737
000b16  f88d0002          STRB     r0,[sp,#2]            ;737
000b1a  f88d9003          STRB     r9,[sp,#3]            ;738
000b1e  4669              MOV      r1,sp                 ;739
000b20  f105000c          ADD      r0,r5,#0xc            ;739
000b24  f7fffffe          BL       lc640_write_long_ptr
000b28  f04f0741          MOV      r7,#0x41              ;741
000b2c  e000              B        |L1.2864|
                  |L1.2862|
000b2e  e0a5              B        |L1.3196|
                  |L1.2864|
000b30  f88d7000          STRB     r7,[sp,#0]            ;741
000b34  f88d7001          STRB     r7,[sp,#1]            ;742
000b38  f88d7002          STRB     r7,[sp,#2]            ;743
000b3c  f88d7003          STRB     r7,[sp,#3]            ;744
000b40  4669              MOV      r1,sp                 ;745
000b42  f1050010          ADD      r0,r5,#0x10           ;745
000b46  f7fffffe          BL       lc640_write_long_ptr
000b4a  f88d7000          STRB     r7,[sp,#0]            ;747
000b4e  f88d7001          STRB     r7,[sp,#1]            ;748
000b52  f88d7002          STRB     r7,[sp,#2]            ;749
000b56  f88d7003          STRB     r7,[sp,#3]            ;750
000b5a  4669              MOV      r1,sp                 ;751
000b5c  f1050014          ADD      r0,r5,#0x14           ;751
000b60  f7fffffe          BL       lc640_write_long_ptr
000b64  f88d7000          STRB     r7,[sp,#0]            ;753
000b68  f88d7001          STRB     r7,[sp,#1]            ;754
000b6c  f88d7002          STRB     r7,[sp,#2]            ;755
000b70  f88d7003          STRB     r7,[sp,#3]            ;756
000b74  4669              MOV      r1,sp                 ;757
000b76  f1050018          ADD      r0,r5,#0x18           ;757
000b7a  f7fffffe          BL       lc640_write_long_ptr
000b7e  f88d7000          STRB     r7,[sp,#0]            ;759
000b82  f88d7001          STRB     r7,[sp,#1]            ;760
000b86  f88d7002          STRB     r7,[sp,#2]            ;761
000b8a  f88d7003          STRB     r7,[sp,#3]            ;762
000b8e  4669              MOV      r1,sp                 ;763
000b90  f105001c          ADD      r0,r5,#0x1c           ;763
000b94  f7fffffe          BL       lc640_write_long_ptr
000b98  b126              CBZ      r6,|L1.2980|
000b9a  2e01              CMP      r6,#1                 ;777
000b9c  d026              BEQ      |L1.3052|
000b9e  2e02              CMP      r6,#2                 ;788
000ba0  d048              BEQ      |L1.3124|
000ba2  e1cb              B        |L1.3900|
                  |L1.2980|
000ba4  b134              CBZ      r4,|L1.2996|
000ba6  2c01              CMP      r4,#1                 ;770
000ba8  d00b              BEQ      |L1.3010|
000baa  2c02              CMP      r4,#2                 ;772
000bac  d010              BEQ      |L1.3024|
000bae  2c03              CMP      r4,#3                 ;774
000bb0  d015              BEQ      |L1.3038|
000bb2  e1c3              B        |L1.3900|
                  |L1.2996|
000bb4  2300              MOVS     r3,#0                 ;769
000bb6  2201              MOVS     r2,#1                 ;769
000bb8  2104              MOVS     r1,#4                 ;769
000bba  a07d              ADR      r0,|L1.3504|
000bbc  f7fffffe          BL       snmp_trap_send
000bc0  e1bc              B        |L1.3900|
                  |L1.3010|
000bc2  2301              MOVS     r3,#1                 ;771
000bc4  461a              MOV      r2,r3                 ;771
000bc6  2104              MOVS     r1,#4                 ;771
000bc8  a07f              ADR      r0,|L1.3528|
000bca  f7fffffe          BL       snmp_trap_send
000bce  e1b5              B        |L1.3900|
                  |L1.3024|
000bd0  2302              MOVS     r3,#2                 ;773
000bd2  2201              MOVS     r2,#1                 ;773
000bd4  2104              MOVS     r1,#4                 ;773
000bd6  a083              ADR      r0,|L1.3556|
000bd8  f7fffffe          BL       snmp_trap_send
000bdc  e1ae              B        |L1.3900|
                  |L1.3038|
000bde  2303              MOVS     r3,#3                 ;775
000be0  2201              MOVS     r2,#1                 ;775
000be2  2104              MOVS     r1,#4                 ;775
000be4  a087              ADR      r0,|L1.3588|
000be6  f7fffffe          BL       snmp_trap_send
000bea  e1a7              B        |L1.3900|
                  |L1.3052|
000bec  b134              CBZ      r4,|L1.3068|
000bee  2c01              CMP      r4,#1                 ;781
000bf0  d00b              BEQ      |L1.3082|
000bf2  2c02              CMP      r4,#2                 ;783
000bf4  d010              BEQ      |L1.3096|
000bf6  2c03              CMP      r4,#3                 ;785
000bf8  d015              BEQ      |L1.3110|
000bfa  e19f              B        |L1.3900|
                  |L1.3068|
000bfc  2300              MOVS     r3,#0                 ;780
000bfe  2202              MOVS     r2,#2                 ;780
000c00  2104              MOVS     r1,#4                 ;780
000c02  a088              ADR      r0,|L1.3620|
000c04  f7fffffe          BL       snmp_trap_send
000c08  e198              B        |L1.3900|
                  |L1.3082|
000c0a  2301              MOVS     r3,#1                 ;782
000c0c  2202              MOVS     r2,#2                 ;782
000c0e  2104              MOVS     r1,#4                 ;782
000c10  a08a              ADR      r0,|L1.3644|
000c12  f7fffffe          BL       snmp_trap_send
000c16  e191              B        |L1.3900|
                  |L1.3096|
000c18  2302              MOVS     r3,#2                 ;784
000c1a  461a              MOV      r2,r3                 ;784
000c1c  2104              MOVS     r1,#4                 ;784
000c1e  a08e              ADR      r0,|L1.3672|
000c20  f7fffffe          BL       snmp_trap_send
000c24  e18a              B        |L1.3900|
                  |L1.3110|
000c26  2303              MOVS     r3,#3                 ;786
000c28  2202              MOVS     r2,#2                 ;786
000c2a  2104              MOVS     r1,#4                 ;786
000c2c  a092              ADR      r0,|L1.3704|
000c2e  f7fffffe          BL       snmp_trap_send
000c32  e183              B        |L1.3900|
                  |L1.3124|
000c34  b134              CBZ      r4,|L1.3140|
000c36  2c01              CMP      r4,#1                 ;792
000c38  d00b              BEQ      |L1.3154|
000c3a  2c02              CMP      r4,#2                 ;794
000c3c  d010              BEQ      |L1.3168|
000c3e  2c03              CMP      r4,#3                 ;796
000c40  d015              BEQ      |L1.3182|
000c42  e17b              B        |L1.3900|
                  |L1.3140|
000c44  2300              MOVS     r3,#0                 ;791
000c46  2203              MOVS     r2,#3                 ;791
000c48  2104              MOVS     r1,#4                 ;791
000c4a  a093              ADR      r0,|L1.3736|
000c4c  f7fffffe          BL       snmp_trap_send
000c50  e174              B        |L1.3900|
                  |L1.3154|
000c52  2301              MOVS     r3,#1                 ;793
000c54  2203              MOVS     r2,#3                 ;793
000c56  2104              MOVS     r1,#4                 ;793
000c58  a095              ADR      r0,|L1.3760|
000c5a  f7fffffe          BL       snmp_trap_send
000c5e  e16d              B        |L1.3900|
                  |L1.3168|
000c60  2302              MOVS     r3,#2                 ;795
000c62  2203              MOVS     r2,#3                 ;795
000c64  2104              MOVS     r1,#4                 ;795
000c66  a099              ADR      r0,|L1.3788|
000c68  f7fffffe          BL       snmp_trap_send
000c6c  e166              B        |L1.3900|
                  |L1.3182|
000c6e  2303              MOVS     r3,#3                 ;797
000c70  461a              MOV      r2,r3                 ;797
000c72  2104              MOVS     r1,#4                 ;797
000c74  a09d              ADR      r0,|L1.3820|
000c76  f7fffffe          BL       snmp_trap_send
000c7a  e15f              B        |L1.3900|
                  |L1.3196|
;;;803    	{      
;;;804    //	av_bps[bps]=0;
;;;805    
;;;806    	//SET_REG(avar_stat,0,3+bps,1);
;;;807    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;808    
;;;809         if(v==0) bps[dev]._av&=(~(1<<0));
000c7c  b134              CBZ      r4,|L1.3212|
;;;810         else if(v==1) bps[dev]._av&=(~(1<<1));
000c7e  2c01              CMP      r4,#1
000c80  d009              BEQ      |L1.3222|
;;;811    	else if(v==2) bps[dev]._av&=(~(1<<2));
000c82  2c02              CMP      r4,#2
000c84  d00c              BEQ      |L1.3232|
;;;812    	else if(v==3) bps[dev]._av&=(~(1<<3));
000c86  2c03              CMP      r4,#3
000c88  d00f              BEQ      |L1.3242|
000c8a  e012              B        |L1.3250|
                  |L1.3212|
000c8c  7841              LDRB     r1,[r0,#1]            ;809
000c8e  f0210101          BIC      r1,r1,#1              ;809
000c92  7041              STRB     r1,[r0,#1]            ;809
000c94  e00d              B        |L1.3250|
                  |L1.3222|
000c96  7841              LDRB     r1,[r0,#1]            ;810
000c98  f0210102          BIC      r1,r1,#2              ;810
000c9c  7041              STRB     r1,[r0,#1]            ;810
000c9e  e008              B        |L1.3250|
                  |L1.3232|
000ca0  7841              LDRB     r1,[r0,#1]            ;811
000ca2  f0210104          BIC      r1,r1,#4              ;811
000ca6  7041              STRB     r1,[r0,#1]            ;811
000ca8  e003              B        |L1.3250|
                  |L1.3242|
000caa  7841              LDRB     r1,[r0,#1]
000cac  f0210108          BIC      r1,r1,#8
000cb0  7041              STRB     r1,[r0,#1]
                  |L1.3250|
;;;813         
;;;814    //	if((bps[dev]._av&0x0f==0))
;;;815    //	     {
;;;816    		//SET_REG(avar_stat,0,3+bps,1);
;;;817    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;818    //	     }
;;;819     
;;;820    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000cb2  4650              MOV      r0,r10
000cb4  f7fffffe          BL       lc640_read_int
000cb8  fa1ffb80          UXTH     r11,r0
;;;821    	event_ptr_find=event_ptr;
000cbc  465c              MOV      r4,r11
                  |L1.3262|
;;;822    	
;;;823    avar_src_hndl_lbl1: 
;;;824    
;;;825    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000cbe  eb051044          ADD      r0,r5,r4,LSL #5
000cc2  fa1ffa80          UXTH     r10,r0
;;;826    
;;;827         lc640_read_long_ptr(lc640_adr,data);
000cc6  4669              MOV      r1,sp
000cc8  4650              MOV      r0,r10
000cca  f7fffffe          BL       lc640_read_long_ptr
;;;828         
;;;829         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000cce  f89d0000          LDRB     r0,[sp,#0]
000cd2  2853              CMP      r0,#0x53
000cd4  d107              BNE      |L1.3302|
000cd6  f89d0001          LDRB     r0,[sp,#1]
000cda  42b0              CMP      r0,r6
000cdc  d103              BNE      |L1.3302|
000cde  f89d0002          LDRB     r0,[sp,#2]
000ce2  42b8              CMP      r0,r7
000ce4  d009              BEQ      |L1.3322|
                  |L1.3302|
;;;830         	{        
;;;831         	if(event_ptr_find)event_ptr_find--;
000ce6  b11c              CBZ      r4,|L1.3312|
000ce8  f1a40401          SUB      r4,r4,#1
000cec  b2a4              UXTH     r4,r4
000cee  e001              B        |L1.3316|
                  |L1.3312|
;;;832         	else event_ptr_find=63;
000cf0  f04f043f          MOV      r4,#0x3f
                  |L1.3316|
;;;833         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000cf4  455c              CMP      r4,r11
000cf6  d1e2              BNE      |L1.3262|
000cf8  e120              B        |L1.3900|
                  |L1.3322|
;;;834         	else goto avar_src_hndl_lbl1;
;;;835         	}
;;;836         else 
;;;837         	{
;;;838         	lc640_read_long_ptr(lc640_adr+16,data);
000cfa  4669              MOV      r1,sp
000cfc  f10a0010          ADD      r0,r10,#0x10
000d00  f7fffffe          BL       lc640_read_long_ptr
;;;839         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000d04  f89d0000          LDRB     r0,[sp,#0]
000d08  2841              CMP      r0,#0x41
000d0a  d10b              BNE      |L1.3364|
000d0c  f89d0001          LDRB     r0,[sp,#1]
000d10  2841              CMP      r0,#0x41
000d12  d107              BNE      |L1.3364|
000d14  f89d0002          LDRB     r0,[sp,#2]
000d18  2841              CMP      r0,#0x41
000d1a  d103              BNE      |L1.3364|
000d1c  f89d0003          LDRB     r0,[sp,#3]
000d20  2841              CMP      r0,#0x41
000d22  d009              BEQ      |L1.3384|
                  |L1.3364|
;;;840         		{        
;;;841         		if(event_ptr_find)event_ptr_find--;
000d24  b11c              CBZ      r4,|L1.3374|
000d26  f1a40401          SUB      r4,r4,#1
000d2a  b2a4              UXTH     r4,r4
000d2c  e001              B        |L1.3378|
                  |L1.3374|
;;;842             		else event_ptr_find=63;
000d2e  f04f043f          MOV      r4,#0x3f
                  |L1.3378|
;;;843             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000d32  455c              CMP      r4,r11
000d34  d1c3              BNE      |L1.3262|
000d36  e101              B        |L1.3900|
                  |L1.3384|
;;;844         		else goto avar_src_hndl_lbl1;
;;;845         		}
;;;846    
;;;847         	}	
;;;848    
;;;849    
;;;850    	
;;;851    	data[0]=LPC_RTC->YEAR;
000d38  f8b8003c          LDRH     r0,[r8,#0x3c]
000d3c  f88d0000          STRB     r0,[sp,#0]
;;;852    	data[1]=LPC_RTC->MONTH;
000d40  f8980038          LDRB     r0,[r8,#0x38]
000d44  f88d0001          STRB     r0,[sp,#1]
;;;853    	data[2]=LPC_RTC->DOM;
000d48  f898002c          LDRB     r0,[r8,#0x2c]
000d4c  f88d0002          STRB     r0,[sp,#2]
;;;854    	data[3]=0;
000d50  f88d9003          STRB     r9,[sp,#3]
;;;855    	lc640_write_long_ptr(lc640_adr+16,data);
000d54  4669              MOV      r1,sp
000d56  f10a0010          ADD      r0,r10,#0x10
000d5a  f7fffffe          BL       lc640_write_long_ptr
;;;856    
;;;857    	data[0]=LPC_RTC->HOUR;
000d5e  f8980028          LDRB     r0,[r8,#0x28]
000d62  f88d0000          STRB     r0,[sp,#0]
;;;858    	data[1]=LPC_RTC->MIN;
000d66  f8980024          LDRB     r0,[r8,#0x24]
000d6a  f88d0001          STRB     r0,[sp,#1]
;;;859    	data[2]=LPC_RTC->SEC;
000d6e  f8980020          LDRB     r0,[r8,#0x20]
000d72  f88d0002          STRB     r0,[sp,#2]
;;;860    	data[3]=0;
000d76  f88d9003          STRB     r9,[sp,#3]
;;;861    	lc640_write_long_ptr(lc640_adr+20,data);
000d7a  4669              MOV      r1,sp
000d7c  f10a0014          ADD      r0,r10,#0x14
000d80  f7fffffe          BL       lc640_write_long_ptr
;;;862    	
;;;863    	data[0]='B';
000d84  f04f0442          MOV      r4,#0x42
000d88  f88d4000          STRB     r4,[sp,#0]
;;;864    	data[1]='B';
000d8c  e0be              B        |L1.3852|
000d8e  0000              DCW      0x0000
                  |L1.3472|
                          DCD      net_Ustore
                  |L1.3476|
000d94  4d61696e          DCB      "Main power is on",0
000d98  20706f77
000d9c  65722069
000da0  73206f6e
000da4  00      
000da5  00                DCB      0
000da6  00                DCB      0
000da7  00                DCB      0
                  |L1.3496|
                          DCD      0x40024000
                  |L1.3500|
                          DCD      bps
                  |L1.3504|
000db0  42505320          DCB      "BPS #1 Alarm, overheat",0
000db4  23312041
000db8  6c61726d
000dbc  2c206f76
000dc0  65726865
000dc4  617400  
000dc7  00                DCB      0
                  |L1.3528|
000dc8  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000dcc  23312041
000dd0  6c61726d
000dd4  2c20766f
000dd8  6c746167
000ddc  65206973
000de0  20757000
                  |L1.3556|
000de4  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000de8  23312041
000dec  6c61726d
000df0  2c20766f
000df4  6c746167
000df8  65206973
000dfc  20646f77
000e00  6e00    
000e02  00                DCB      0
000e03  00                DCB      0
                  |L1.3588|
000e04  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000e08  23312041
000e0c  6c61726d
000e10  2c20636f
000e14  6e6e6563
000e18  74206973
000e1c  206c6f73
000e20  7400    
000e22  00                DCB      0
000e23  00                DCB      0
                  |L1.3620|
000e24  42505320          DCB      "BPS #2 Alarm, overheat",0
000e28  23322041
000e2c  6c61726d
000e30  2c206f76
000e34  65726865
000e38  617400  
000e3b  00                DCB      0
                  |L1.3644|
000e3c  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000e40  23322041
000e44  6c61726d
000e48  2c20766f
000e4c  6c746167
000e50  65206973
000e54  20757000
                  |L1.3672|
000e58  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000e5c  23322041
000e60  6c61726d
000e64  2c20766f
000e68  6c746167
000e6c  65206973
000e70  20646f77
000e74  6e00    
000e76  00                DCB      0
000e77  00                DCB      0
                  |L1.3704|
000e78  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000e7c  23322041
000e80  6c61726d
000e84  2c20636f
000e88  6e6e6563
000e8c  74206973
000e90  206c6f73
000e94  7400    
000e96  00                DCB      0
000e97  00                DCB      0
                  |L1.3736|
000e98  42505320          DCB      "BPS #3 Alarm, overheat",0
000e9c  23332041
000ea0  6c61726d
000ea4  2c206f76
000ea8  65726865
000eac  617400  
000eaf  00                DCB      0
                  |L1.3760|
000eb0  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000eb4  23332041
000eb8  6c61726d
000ebc  2c20766f
000ec0  6c746167
000ec4  65206973
000ec8  20757000
                  |L1.3788|
000ecc  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000ed0  23332041
000ed4  6c61726d
000ed8  2c20766f
000edc  6c746167
000ee0  65206973
000ee4  20646f77
000ee8  6e00    
000eea  00                DCB      0
000eeb  00                DCB      0
                  |L1.3820|
000eec  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000ef0  23332041
000ef4  6c61726d
000ef8  2c20636f
000efc  6e6e6563
000f00  74206973
000f04  206c6f73
000f08  7400    
000f0a  00                DCB      0
000f0b  00                DCB      0
                  |L1.3852|
000f0c  f88d4001          STRB     r4,[sp,#1]
;;;865    	data[2]='B';
000f10  f88d4002          STRB     r4,[sp,#2]
;;;866    	data[3]='B';
000f14  f88d4003          STRB     r4,[sp,#3]
;;;867    	lc640_write_long_ptr(lc640_adr+24,data);
000f18  4669              MOV      r1,sp
000f1a  f10a0018          ADD      r0,r10,#0x18
000f1e  f7fffffe          BL       lc640_write_long_ptr
;;;868    	
;;;869    	data[0]='B';
000f22  f88d4000          STRB     r4,[sp,#0]
;;;870    	data[1]='B';
000f26  f88d4001          STRB     r4,[sp,#1]
;;;871    	data[2]='B';
000f2a  f88d4002          STRB     r4,[sp,#2]
;;;872    	data[3]='B';
000f2e  f88d4003          STRB     r4,[sp,#3]
;;;873    	lc640_write_long_ptr(lc640_adr+28,data);
000f32  4669              MOV      r1,sp
000f34  f10a001c          ADD      r0,r10,#0x1c
000f38  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3900|
;;;874    	
;;;875    	}
;;;876    	
;;;877    avar_src_hndl_end:
;;;878    __nop();		
000f3c  bf00              NOP      
                  |L1.3902|
;;;879    }
000f3e  e54d              B        |L1.2524|
;;;880    
                          ENDP

                  wrk_mem_hndl PROC
;;;881    //-----------------------------------------------
;;;882    void wrk_mem_hndl(char b)
000f40  e92d41fc          PUSH     {r2-r8,lr}
;;;883    {
000f44  4606              MOV      r6,r0
;;;884    char data[4];
;;;885    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;886    
;;;887    signed short temp_temp;
;;;888    
;;;889    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000f46  eb060046          ADD      r0,r6,r6,LSL #1
000f4a  eb001106          ADD      r1,r0,r6,LSL #4
000f4e  48ff              LDR      r0,|L1.4940|
000f50  eb000481          ADD      r4,r0,r1,LSL #2
000f54  8be0              LDRH     r0,[r4,#0x1e]
000f56  2805              CMP      r0,#5
000f58  d37e              BCC      |L1.4184|
;;;890    
;;;891    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000f5a  48fd              LDR      r0,|L1.4944|
000f5c  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000f5e  f1000006          ADD      r0,r0,#6
000f62  f0000007          AND      r0,r0,#7
000f66  eb040040          ADD      r0,r4,r0,LSL #1
000f6a  8c00              LDRH     r0,[r0,#0x20]
000f6c  9000              STR      r0,[sp,#0]
;;;892    
;;;893    
;;;894    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000f6e  f44f6760          MOV      r7,#0xe00
000f72  4638              MOV      r0,r7
000f74  f7fffffe          BL       lc640_read_int
;;;895    event_ptr++;	
000f78  f1000001          ADD      r0,r0,#1
000f7c  b285              UXTH     r5,r0
;;;896    if(event_ptr>63)event_ptr=0;	
000f7e  2d3f              CMP      r5,#0x3f
000f80  d901              BLS      |L1.3974|
000f82  f04f0500          MOV      r5,#0
                  |L1.3974|
;;;897    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000f86  b229              SXTH     r1,r5
000f88  4638              MOV      r0,r7
000f8a  f7fffffe          BL       lc640_write_int
;;;898    	
;;;899    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000f8e  f6406802          MOV      r8,#0xe02
000f92  4640              MOV      r0,r8
000f94  f7fffffe          BL       lc640_read_int
000f98  b280              UXTH     r0,r0
;;;900    if(event_cnt!=63)event_cnt=event_ptr;
000f9a  283f              CMP      r0,#0x3f
000f9c  d000              BEQ      |L1.4000|
000f9e  4628              MOV      r0,r5
                  |L1.4000|
;;;901    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000fa0  b201              SXTH     r1,r0
000fa2  4640              MOV      r0,r8
000fa4  f7fffffe          BL       lc640_write_int
;;;902    	
;;;903    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000fa8  4638              MOV      r0,r7
000faa  f7fffffe          BL       lc640_read_int
000fae  f44f6180          MOV      r1,#0x400
000fb2  eb011040          ADD      r0,r1,r0,LSL #5
000fb6  b285              UXTH     r5,r0
;;;904    	
;;;905    data[0]='B';
000fb8  f04f0042          MOV      r0,#0x42
000fbc  f88d0004          STRB     r0,[sp,#4]
;;;906    data[1]=b; 
000fc0  f88d6005          STRB     r6,[sp,#5]
;;;907    data[2]='W';
000fc4  f04f0057          MOV      r0,#0x57
000fc8  f88d0006          STRB     r0,[sp,#6]
;;;908    data[3]=0;
000fcc  f04f0600          MOV      r6,#0
000fd0  f88d6007          STRB     r6,[sp,#7]
;;;909    
;;;910    lc640_write_long_ptr(lc640_adr,data);
000fd4  a901              ADD      r1,sp,#4
000fd6  4628              MOV      r0,r5
000fd8  f7fffffe          BL       lc640_write_long_ptr
;;;911    
;;;912    data[0]=*((char*)&bat[b]._Iintegr_);
000fdc  7fa0              LDRB     r0,[r4,#0x1e]
000fde  f88d0004          STRB     r0,[sp,#4]
;;;913    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000fe2  7fe0              LDRB     r0,[r4,#0x1f]
000fe4  f88d0005          STRB     r0,[sp,#5]
;;;914    data[2]=*((char*)&temp_temp);
000fe8  f89d0000          LDRB     r0,[sp,#0]
000fec  f88d0006          STRB     r0,[sp,#6]
;;;915    data[3]=*(((char*)(&temp_temp))+1);
000ff0  f89d0001          LDRB     r0,[sp,#1]
000ff4  f88d0007          STRB     r0,[sp,#7]
;;;916    lc640_write_long_ptr(lc640_adr+4,data);
000ff8  a901              ADD      r1,sp,#4
000ffa  1d28              ADDS     r0,r5,#4
000ffc  f7fffffe          BL       lc640_write_long_ptr
;;;917    
;;;918    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
001000  f1040134          ADD      r1,r4,#0x34
001004  f1050008          ADD      r0,r5,#8
001008  f7fffffe          BL       lc640_write_long_ptr
;;;919    	
;;;920    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
00100c  f1040138          ADD      r1,r4,#0x38
001010  f105000c          ADD      r0,r5,#0xc
001014  f7fffffe          BL       lc640_write_long_ptr
;;;921    
;;;922    data[0]=LPC_RTC->YEAR;
001018  4cce              LDR      r4,|L1.4948|
00101a  8ba0              LDRH     r0,[r4,#0x1c]
00101c  f88d0004          STRB     r0,[sp,#4]
;;;923    data[1]=LPC_RTC->MONTH;
001020  7e20              LDRB     r0,[r4,#0x18]
001022  f88d0005          STRB     r0,[sp,#5]
;;;924    data[2]=LPC_RTC->DOM;
001026  7b20              LDRB     r0,[r4,#0xc]
001028  f88d0006          STRB     r0,[sp,#6]
;;;925    data[3]=0;
00102c  f88d6007          STRB     r6,[sp,#7]
;;;926    lc640_write_long_ptr(lc640_adr+16,data);
001030  a901              ADD      r1,sp,#4
001032  f1050010          ADD      r0,r5,#0x10
001036  f7fffffe          BL       lc640_write_long_ptr
;;;927    
;;;928    data[0]=LPC_RTC->HOUR;
00103a  7a20              LDRB     r0,[r4,#8]
00103c  f88d0004          STRB     r0,[sp,#4]
;;;929    data[1]=LPC_RTC->MIN;
001040  7920              LDRB     r0,[r4,#4]
001042  f88d0005          STRB     r0,[sp,#5]
;;;930    data[2]=LPC_RTC->SEC;
001046  7820              LDRB     r0,[r4,#0]
001048  f88d0006          STRB     r0,[sp,#6]
;;;931    data[3]=0;
00104c  f88d6007          STRB     r6,[sp,#7]
;;;932    lc640_write_long_ptr(lc640_adr+20,data);
001050  a901              ADD      r1,sp,#4
001052  f1050014          ADD      r0,r5,#0x14
001056  e000              B        |L1.4186|
                  |L1.4184|
001058  e001              B        |L1.4190|
                  |L1.4186|
00105a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4190|
;;;933    	
;;;934    
;;;935    
;;;936    	
;;;937    wrk_mem_hndl_end:	
;;;938    __nop();
00105e  bf00              NOP      
;;;939    }  
001060  e8bd81fc          POP      {r2-r8,pc}
;;;940    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;942    //-----------------------------------------------
;;;943    void avar_bat_ips_hndl(char in)
001064  e92d4ff8          PUSH     {r3-r11,lr}
;;;944    {
001068  4602              MOV      r2,r0
;;;945    char data[4];
;;;946    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;947    
;;;948    if(in==1)
;;;949    	{
;;;950    	bat_ips._av|=1;
00106a  48bb              LDR      r0,|L1.4952|
;;;951        ips_bat_av_stat=1;
00106c  4cbb              LDR      r4,|L1.4956|
;;;952    	ips_bat_av_vzvod=1;
00106e  4bbc              LDR      r3,|L1.4960|
;;;953    
;;;954    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;955    	event_ptr++;	
;;;956    	if(event_ptr>63)event_ptr=0;	
;;;957    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;958    	
;;;959    	event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;960    	if(event_cnt!=63)event_cnt=event_ptr;
;;;961    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;962    	
;;;963    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;964    	
;;;965    	data[0]='B';
;;;966    	data[1]=0;
;;;967    	data[2]='C';
;;;968    	data[3]=0;
;;;969    	lc640_write_long_ptr(lc640_adr,data);
;;;970    
;;;971    	data[0]=0;
;;;972    	data[1]=0;
;;;973    	data[2]=0;
;;;974    	data[3]=0;
;;;975    	lc640_write_long_ptr(lc640_adr+4,data);
;;;976    
;;;977    	data[0]=LPC_RTC->YEAR;
001070  f8df82f0          LDR      r8,|L1.4964|
001074  f890103d          LDRB     r1,[r0,#0x3d]         ;950
001078  f04f0742          MOV      r7,#0x42              ;965
00107c  f44f6560          MOV      r5,#0xe00             ;954
001080  f04f0900          MOV      r9,#0                 ;956
001084  f44f6a80          MOV      r10,#0x400            ;963
001088  2a01              CMP      r2,#1                 ;948
00108a  d002              BEQ      |L1.4242|
;;;978    	data[1]=LPC_RTC->MONTH;
;;;979    	data[2]=LPC_RTC->DOM;
;;;980    	data[3]=0;
;;;981    	lc640_write_long_ptr(lc640_adr+8,data);
;;;982    
;;;983    	data[0]=LPC_RTC->HOUR;
;;;984    	data[1]=LPC_RTC->MIN;
;;;985    	data[2]=LPC_RTC->SEC;
;;;986    	data[3]=0;
;;;987    	lc640_write_long_ptr(lc640_adr+12,data);
;;;988    	
;;;989    	data[0]='A';
;;;990    	data[1]='A';
;;;991    	data[2]='A';
;;;992    	data[3]='A';
;;;993    	lc640_write_long_ptr(lc640_adr+16,data);
;;;994    	
;;;995    	data[0]='A';
;;;996    	data[1]='A';
;;;997    	data[2]='A';
;;;998    	data[3]='A';
;;;999    	lc640_write_long_ptr(lc640_adr+20,data);
;;;1000   	
;;;1001   	data[0]='A';
;;;1002   	data[1]='A';
;;;1003   	data[2]='A';
;;;1004   	data[3]='A';
;;;1005   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1006   	
;;;1007   	data[0]='A';
;;;1008   	data[1]='A';
;;;1009   	data[2]='A';
;;;1010   	data[3]='A';
;;;1011   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1012   					
;;;1013   	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;1014   		
;;;1015   	}
;;;1016   
;;;1017   else if(in==0)
00108c  2a00              CMP      r2,#0
00108e  d07e              BEQ      |L1.4494|
001090  e12f              B        |L1.4850|
                  |L1.4242|
001092  f0410101          ORR      r1,r1,#1              ;950
001096  f880103d          STRB     r1,[r0,#0x3d]         ;950
00109a  f04f0001          MOV      r0,#1                 ;951
00109e  7020              STRB     r0,[r4,#0]            ;951
0010a0  7018              STRB     r0,[r3,#0]            ;952
0010a2  4628              MOV      r0,r5                 ;954
0010a4  f7fffffe          BL       lc640_read_int
0010a8  f1000001          ADD      r0,r0,#1              ;955
0010ac  b284              UXTH     r4,r0                 ;955
0010ae  2c3f              CMP      r4,#0x3f              ;956
0010b0  d901              BLS      |L1.4278|
0010b2  f04f0400          MOV      r4,#0                 ;956
                  |L1.4278|
0010b6  b221              SXTH     r1,r4                 ;957
0010b8  4628              MOV      r0,r5                 ;957
0010ba  f7fffffe          BL       lc640_write_int
0010be  f6406602          MOV      r6,#0xe02             ;959
0010c2  4630              MOV      r0,r6                 ;959
0010c4  f7fffffe          BL       lc640_read_int
0010c8  b281              UXTH     r1,r0                 ;959
0010ca  293f              CMP      r1,#0x3f              ;960
0010cc  d000              BEQ      |L1.4304|
0010ce  4621              MOV      r1,r4                 ;960
                  |L1.4304|
0010d0  b209              SXTH     r1,r1                 ;961
0010d2  4630              MOV      r0,r6                 ;961
0010d4  f7fffffe          BL       lc640_write_int
0010d8  4628              MOV      r0,r5                 ;963
0010da  f7fffffe          BL       lc640_read_int
0010de  eb0a1040          ADD      r0,r10,r0,LSL #5      ;963
0010e2  b284              UXTH     r4,r0                 ;963
0010e4  f88d7000          STRB     r7,[sp,#0]            ;965
0010e8  f88d9001          STRB     r9,[sp,#1]            ;966
0010ec  f04f0043          MOV      r0,#0x43              ;967
0010f0  f88d0002          STRB     r0,[sp,#2]            ;967
0010f4  f88d9003          STRB     r9,[sp,#3]            ;968
0010f8  4669              MOV      r1,sp                 ;969
0010fa  4620              MOV      r0,r4                 ;969
0010fc  f7fffffe          BL       lc640_write_long_ptr
001100  f8cd9000          STR      r9,[sp,#0]            ;974
001104  4669              MOV      r1,sp                 ;975
001106  1d20              ADDS     r0,r4,#4              ;975
001108  f7fffffe          BL       lc640_write_long_ptr
00110c  f8b8003c          LDRH     r0,[r8,#0x3c]         ;977
001110  f88d0000          STRB     r0,[sp,#0]            ;977
001114  f8980038          LDRB     r0,[r8,#0x38]         ;978
001118  f88d0001          STRB     r0,[sp,#1]            ;978
00111c  f898002c          LDRB     r0,[r8,#0x2c]         ;979
001120  f88d0002          STRB     r0,[sp,#2]            ;979
001124  f88d9003          STRB     r9,[sp,#3]            ;980
001128  4669              MOV      r1,sp                 ;981
00112a  f1040008          ADD      r0,r4,#8              ;981
00112e  f7fffffe          BL       lc640_write_long_ptr
001132  f8980028          LDRB     r0,[r8,#0x28]         ;983
001136  f88d0000          STRB     r0,[sp,#0]            ;983
00113a  f8980024          LDRB     r0,[r8,#0x24]         ;984
00113e  f88d0001          STRB     r0,[sp,#1]            ;984
001142  f8980020          LDRB     r0,[r8,#0x20]         ;985
001146  f88d0002          STRB     r0,[sp,#2]            ;985
00114a  f88d9003          STRB     r9,[sp,#3]            ;986
00114e  4669              MOV      r1,sp                 ;987
001150  f104000c          ADD      r0,r4,#0xc            ;987
001154  f7fffffe          BL       lc640_write_long_ptr
001158  f04f0541          MOV      r5,#0x41              ;989
00115c  f88d5000          STRB     r5,[sp,#0]            ;989
001160  f88d5001          STRB     r5,[sp,#1]            ;990
001164  f88d5002          STRB     r5,[sp,#2]            ;991
001168  f88d5003          STRB     r5,[sp,#3]            ;992
00116c  4669              MOV      r1,sp                 ;993
00116e  f1040010          ADD      r0,r4,#0x10           ;993
001172  f7fffffe          BL       lc640_write_long_ptr
001176  f88d5000          STRB     r5,[sp,#0]            ;995
00117a  f88d5001          STRB     r5,[sp,#1]            ;996
00117e  f88d5002          STRB     r5,[sp,#2]            ;997
001182  f88d5003          STRB     r5,[sp,#3]            ;998
001186  4669              MOV      r1,sp                 ;999
001188  f1040014          ADD      r0,r4,#0x14           ;999
00118c  e000              B        |L1.4496|
                  |L1.4494|
00118e  e022              B        |L1.4566|
                  |L1.4496|
001190  f7fffffe          BL       lc640_write_long_ptr
001194  f88d5000          STRB     r5,[sp,#0]            ;1001
001198  f88d5001          STRB     r5,[sp,#1]            ;1002
00119c  f88d5002          STRB     r5,[sp,#2]            ;1003
0011a0  f88d5003          STRB     r5,[sp,#3]            ;1004
0011a4  4669              MOV      r1,sp                 ;1005
0011a6  f1040018          ADD      r0,r4,#0x18           ;1005
0011aa  f7fffffe          BL       lc640_write_long_ptr
0011ae  f88d5000          STRB     r5,[sp,#0]            ;1007
0011b2  f88d5001          STRB     r5,[sp,#1]            ;1008
0011b6  f88d5002          STRB     r5,[sp,#2]            ;1009
0011ba  f88d5003          STRB     r5,[sp,#3]            ;1010
0011be  4669              MOV      r1,sp                 ;1011
0011c0  f104001c          ADD      r0,r4,#0x1c           ;1011
0011c4  f7fffffe          BL       lc640_write_long_ptr
0011c8  2301              MOVS     r3,#1                 ;1013
0011ca  461a              MOV      r2,r3                 ;1013
0011cc  2105              MOVS     r1,#5                 ;1013
0011ce  a066              ADR      r0,|L1.4968|
0011d0  f7fffffe          BL       snmp_trap_send
0011d4  e08d              B        |L1.4850|
                  |L1.4566|
;;;1018   	{
;;;1019   	bat_ips._av&=~1;
0011d6  f0210101          BIC      r1,r1,#1
0011da  f880103d          STRB     r1,[r0,#0x3d]
;;;1020   	ips_bat_av_stat=0;
0011de  f8849000          STRB     r9,[r4,#0]
;;;1021   	ips_bat_av_vzvod=0;
0011e2  f8839000          STRB     r9,[r3,#0]
;;;1022        
;;;1023   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0011e6  4628              MOV      r0,r5
0011e8  f7fffffe          BL       lc640_read_int
0011ec  b286              UXTH     r6,r0
;;;1024   	event_ptr_find=event_ptr;
0011ee  4634              MOV      r4,r6
                  |L1.4592|
;;;1025   	
;;;1026   avar_bat_ips_hndl_lbl1: 
;;;1027   
;;;1028   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0011f0  eb0a1044          ADD      r0,r10,r4,LSL #5
0011f4  b285              UXTH     r5,r0
;;;1029   
;;;1030        lc640_read_long_ptr(lc640_adr,data);
0011f6  4669              MOV      r1,sp
0011f8  4628              MOV      r0,r5
0011fa  f7fffffe          BL       lc640_read_long_ptr
;;;1031        
;;;1032        if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
0011fe  f89d0000          LDRB     r0,[sp,#0]
001202  2842              CMP      r0,#0x42
001204  d106              BNE      |L1.4628|
001206  f89d0001          LDRB     r0,[sp,#1]
00120a  b918              CBNZ     r0,|L1.4628|
00120c  f89d0002          LDRB     r0,[sp,#2]
001210  2843              CMP      r0,#0x43
001212  d009              BEQ      |L1.4648|
                  |L1.4628|
;;;1033        	{        
;;;1034        	if(event_ptr_find)event_ptr_find--;
001214  b11c              CBZ      r4,|L1.4638|
001216  f1a40401          SUB      r4,r4,#1
00121a  b2a4              UXTH     r4,r4
00121c  e001              B        |L1.4642|
                  |L1.4638|
;;;1035        	else event_ptr_find=63;
00121e  f04f043f          MOV      r4,#0x3f
                  |L1.4642|
;;;1036        	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001222  42b4              CMP      r4,r6
001224  d1e4              BNE      |L1.4592|
001226  e064              B        |L1.4850|
                  |L1.4648|
;;;1037        	else goto avar_bat_ips_hndl_lbl1;
;;;1038        	}
;;;1039        else 
;;;1040        	{
;;;1041        	lc640_read_long_ptr(lc640_adr+16,data);
001228  4669              MOV      r1,sp
00122a  f1050010          ADD      r0,r5,#0x10
00122e  f7fffffe          BL       lc640_read_long_ptr
;;;1042        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001232  f89d0000          LDRB     r0,[sp,#0]
001236  2841              CMP      r0,#0x41
001238  d10b              BNE      |L1.4690|
00123a  f89d0001          LDRB     r0,[sp,#1]
00123e  2841              CMP      r0,#0x41
001240  d107              BNE      |L1.4690|
001242  f89d0002          LDRB     r0,[sp,#2]
001246  2841              CMP      r0,#0x41
001248  d103              BNE      |L1.4690|
00124a  f89d0003          LDRB     r0,[sp,#3]
00124e  2841              CMP      r0,#0x41
001250  d009              BEQ      |L1.4710|
                  |L1.4690|
;;;1043        		{        
;;;1044        		if(event_ptr_find)event_ptr_find--;
001252  b11c              CBZ      r4,|L1.4700|
001254  f1a40401          SUB      r4,r4,#1
001258  b2a4              UXTH     r4,r4
00125a  e001              B        |L1.4704|
                  |L1.4700|
;;;1045            		else event_ptr_find=63;
00125c  f04f043f          MOV      r4,#0x3f
                  |L1.4704|
;;;1046            	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001260  42b4              CMP      r4,r6
001262  d1c5              BNE      |L1.4592|
001264  e045              B        |L1.4850|
                  |L1.4710|
;;;1047        		else goto avar_bat_ips_hndl_lbl1;
;;;1048        		}
;;;1049   
;;;1050        	}
;;;1051        		
;;;1052   	data[0]=LPC_RTC->YEAR;
001266  f8b8003c          LDRH     r0,[r8,#0x3c]
00126a  f88d0000          STRB     r0,[sp,#0]
;;;1053   	data[1]=LPC_RTC->MONTH;
00126e  f8980038          LDRB     r0,[r8,#0x38]
001272  f88d0001          STRB     r0,[sp,#1]
;;;1054   	data[2]=LPC_RTC->DOM;
001276  f898002c          LDRB     r0,[r8,#0x2c]
00127a  f88d0002          STRB     r0,[sp,#2]
;;;1055   	data[3]=0;
00127e  f88d9003          STRB     r9,[sp,#3]
;;;1056   	lc640_write_long_ptr(lc640_adr+16,data);
001282  4669              MOV      r1,sp
001284  f1050010          ADD      r0,r5,#0x10
001288  f7fffffe          BL       lc640_write_long_ptr
;;;1057   
;;;1058   	data[0]=LPC_RTC->HOUR;
00128c  f8980028          LDRB     r0,[r8,#0x28]
001290  f88d0000          STRB     r0,[sp,#0]
;;;1059   	data[1]=LPC_RTC->MIN;
001294  f8980024          LDRB     r0,[r8,#0x24]
001298  f88d0001          STRB     r0,[sp,#1]
;;;1060   	data[2]=LPC_RTC->SEC;
00129c  f8980020          LDRB     r0,[r8,#0x20]
0012a0  f88d0002          STRB     r0,[sp,#2]
;;;1061   	data[3]=0;
0012a4  f88d9003          STRB     r9,[sp,#3]
;;;1062   	lc640_write_long_ptr(lc640_adr+20,data);
0012a8  4669              MOV      r1,sp
0012aa  f1050014          ADD      r0,r5,#0x14
0012ae  f7fffffe          BL       lc640_write_long_ptr
;;;1063   	
;;;1064   	data[0]='B';
0012b2  f88d7000          STRB     r7,[sp,#0]
;;;1065   	data[1]='B';
0012b6  f88d7001          STRB     r7,[sp,#1]
;;;1066   	data[2]='B';
0012ba  f88d7002          STRB     r7,[sp,#2]
;;;1067   	data[3]='B';
0012be  f88d7003          STRB     r7,[sp,#3]
;;;1068   	lc640_write_long_ptr(lc640_adr+24,data);
0012c2  4669              MOV      r1,sp
0012c4  f1050018          ADD      r0,r5,#0x18
0012c8  f7fffffe          BL       lc640_write_long_ptr
;;;1069   	
;;;1070   	data[0]='B';
0012cc  f88d7000          STRB     r7,[sp,#0]
;;;1071   	data[1]='B';
0012d0  f88d7001          STRB     r7,[sp,#1]
;;;1072   	data[2]='B';
0012d4  f88d7002          STRB     r7,[sp,#2]
;;;1073   	data[3]='B';
0012d8  f88d7003          STRB     r7,[sp,#3]
;;;1074   	lc640_write_long_ptr(lc640_adr+28,data);
0012dc  4669              MOV      r1,sp
0012de  f105001c          ADD      r0,r5,#0x1c
0012e2  f7fffffe          BL       lc640_write_long_ptr
;;;1075   	
;;;1076   	snmp_trap_send("BAT #1 detected",5,1,0);
0012e6  2300              MOVS     r3,#0
0012e8  2201              MOVS     r2,#1
0012ea  2105              MOVS     r1,#5
0012ec  a023              ADR      r0,|L1.4988|
0012ee  f7fffffe          BL       snmp_trap_send
                  |L1.4850|
;;;1077   	
;;;1078   	}
;;;1079   	
;;;1080   avar_bat_ips_hndl_end:
;;;1081   __nop();		
0012f2  bf00              NOP      
                  |L1.4852|
;;;1082   }
0012f4  e623              B        |L1.3902|
;;;1083   
                          ENDP

                  avar_bat_hndl PROC
;;;1086   //-----------------------------------------------
;;;1087   void avar_bat_hndl(char b, char in)
0012f6  e92d4ff8          PUSH     {r3-r11,lr}
;;;1088   {
0012fa  4605              MOV      r5,r0
;;;1089   char data[4];
;;;1090   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1091   
;;;1092   if(in==1)
;;;1093   	{
;;;1094   	bat[b]._av|=1;
0012fc  4813              LDR      r0,|L1.4940|
0012fe  eb050245          ADD      r2,r5,r5,LSL #1
;;;1095       
;;;1096   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1097   	event_ptr++;	
;;;1098   	if(event_ptr>63)event_ptr=0;	
;;;1099   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1100   	
;;;1101        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1102   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1103   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1104   	
;;;1105   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1106   	
;;;1107   	data[0]='B';
;;;1108   	data[1]=b;
;;;1109   	data[2]='C';
;;;1110   	data[3]=0;
;;;1111   	lc640_write_long_ptr(lc640_adr,data);
;;;1112   
;;;1113   	data[0]=0;
;;;1114   	data[1]=0;
;;;1115   	data[2]=0;
;;;1116   	data[3]=0;
;;;1117   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1118   
;;;1119   	data[0]=LPC_RTC->YEAR;
001302  f8df8060          LDR      r8,|L1.4964|
001306  eb021205          ADD      r2,r2,r5,LSL #4       ;1094
00130a  f04f0a00          MOV      r10,#0                ;1098
00130e  f04f0942          MOV      r9,#0x42              ;1107
001312  f44f6660          MOV      r6,#0xe00             ;1096
001316  f44f6b80          MOV      r11,#0x400            ;1105
00131a  eb000082          ADD      r0,r0,r2,LSL #2       ;1094
00131e  2901              CMP      r1,#1                 ;1092
001320  d002              BEQ      |L1.4904|
;;;1120   	data[1]=LPC_RTC->MONTH;
;;;1121   	data[2]=LPC_RTC->DOM;
;;;1122   	data[3]=0;
;;;1123   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1124   
;;;1125   	data[0]=LPC_RTC->HOUR;
;;;1126   	data[1]=LPC_RTC->MIN;
;;;1127   	data[2]=LPC_RTC->SEC;
;;;1128   	data[3]=0;
;;;1129   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1130   	
;;;1131   	data[0]='A';
;;;1132   	data[1]='A';
;;;1133   	data[2]='A';
;;;1134   	data[3]='A';
;;;1135   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1136   	
;;;1137   	data[0]='A';
;;;1138   	data[1]='A';
;;;1139   	data[2]='A';
;;;1140   	data[3]='A';
;;;1141   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1142   	
;;;1143   	data[0]='A';
;;;1144   	data[1]='A';
;;;1145   	data[2]='A';
;;;1146   	data[3]='A';
;;;1147   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1148   	
;;;1149   	data[0]='A';
;;;1150   	data[1]='A';
;;;1151   	data[2]='A';
;;;1152   	data[3]='A';
;;;1153   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1154   					
;;;1155   	if(b==0)
;;;1156   		{
;;;1157   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1158   		}
;;;1159   	else if(b==1)
;;;1160   		{
;;;1161   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1162   		} 
;;;1163   			
;;;1164   	}
;;;1165   
;;;1166   else if(in==0)
001322  2900              CMP      r1,#0
001324  d07e              BEQ      |L1.5156|
001326  e162              B        |L1.5614|
                  |L1.4904|
001328  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1094
00132c  f0410101          ORR      r1,r1,#1              ;1094
001330  7001              STRB     r1,[r0,#0]            ;1094
001332  4630              MOV      r0,r6                 ;1096
001334  f7fffffe          BL       lc640_read_int
001338  f1000001          ADD      r0,r0,#1              ;1097
00133c  b284              UXTH     r4,r0                 ;1097
00133e  2c3f              CMP      r4,#0x3f              ;1098
001340  d901              BLS      |L1.4934|
001342  f04f0400          MOV      r4,#0                 ;1098
                  |L1.4934|
001346  b221              SXTH     r1,r4                 ;1099
001348  4630              MOV      r0,r6                 ;1099
00134a  e01f              B        |L1.5004|
                  |L1.4940|
                          DCD      bat
                  |L1.4944|
                          DCD      bat_u_old_cnt
                  |L1.4948|
                          DCD      0x40024020
                  |L1.4952|
                          DCD      bat_ips
                  |L1.4956|
                          DCD      ips_bat_av_stat
                  |L1.4960|
                          DCD      ips_bat_av_vzvod
                  |L1.4964|
                          DCD      0x40024000
                  |L1.4968|
001368  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
00136c  b9312041
001370  6c61726d
001374  2c206c6f
001378  737400  
00137b  00                DCB      0
                  |L1.4988|
00137c  42415420          DCB      "BAT #1 detected",0
001380  23312064
001384  65746563
001388  74656400
                  |L1.5004|
00138c  f7fffffe          BL       lc640_write_int
001390  f6406702          MOV      r7,#0xe02             ;1101
001394  4638              MOV      r0,r7                 ;1101
001396  f7fffffe          BL       lc640_read_int
00139a  b280              UXTH     r0,r0                 ;1101
00139c  283f              CMP      r0,#0x3f              ;1102
00139e  d000              BEQ      |L1.5026|
0013a0  4620              MOV      r0,r4                 ;1102
                  |L1.5026|
0013a2  b201              SXTH     r1,r0                 ;1103
0013a4  4638              MOV      r0,r7                 ;1103
0013a6  f7fffffe          BL       lc640_write_int
0013aa  4630              MOV      r0,r6                 ;1105
0013ac  f7fffffe          BL       lc640_read_int
0013b0  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1105
0013b4  b284              UXTH     r4,r0                 ;1105
0013b6  f88d9000          STRB     r9,[sp,#0]            ;1107
0013ba  f88d5001          STRB     r5,[sp,#1]            ;1108
0013be  f04f0043          MOV      r0,#0x43              ;1109
0013c2  f88d0002          STRB     r0,[sp,#2]            ;1109
0013c6  f88da003          STRB     r10,[sp,#3]           ;1110
0013ca  4669              MOV      r1,sp                 ;1111
0013cc  4620              MOV      r0,r4                 ;1111
0013ce  f7fffffe          BL       lc640_write_long_ptr
0013d2  f8cda000          STR      r10,[sp,#0]           ;1116
0013d6  4669              MOV      r1,sp                 ;1117
0013d8  1d20              ADDS     r0,r4,#4              ;1117
0013da  f7fffffe          BL       lc640_write_long_ptr
0013de  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1119
0013e2  f88d0000          STRB     r0,[sp,#0]            ;1119
0013e6  f8980038          LDRB     r0,[r8,#0x38]         ;1120
0013ea  f88d0001          STRB     r0,[sp,#1]            ;1120
0013ee  f898002c          LDRB     r0,[r8,#0x2c]         ;1121
0013f2  f88d0002          STRB     r0,[sp,#2]            ;1121
0013f6  f88da003          STRB     r10,[sp,#3]           ;1122
0013fa  4669              MOV      r1,sp                 ;1123
0013fc  f1040008          ADD      r0,r4,#8              ;1123
001400  f7fffffe          BL       lc640_write_long_ptr
001404  f8980028          LDRB     r0,[r8,#0x28]         ;1125
001408  f88d0000          STRB     r0,[sp,#0]            ;1125
00140c  f8980024          LDRB     r0,[r8,#0x24]         ;1126
001410  f88d0001          STRB     r0,[sp,#1]            ;1126
001414  f8980020          LDRB     r0,[r8,#0x20]         ;1127
001418  f88d0002          STRB     r0,[sp,#2]            ;1127
00141c  f88da003          STRB     r10,[sp,#3]           ;1128
001420  4669              MOV      r1,sp                 ;1129
001422  e000              B        |L1.5158|
                  |L1.5156|
001424  e04b              B        |L1.5310|
                  |L1.5158|
001426  f104000c          ADD      r0,r4,#0xc            ;1129
00142a  f7fffffe          BL       lc640_write_long_ptr
00142e  f04f0641          MOV      r6,#0x41              ;1131
001432  f88d6000          STRB     r6,[sp,#0]            ;1131
001436  f88d6001          STRB     r6,[sp,#1]            ;1132
00143a  f88d6002          STRB     r6,[sp,#2]            ;1133
00143e  f88d6003          STRB     r6,[sp,#3]            ;1134
001442  4669              MOV      r1,sp                 ;1135
001444  f1040010          ADD      r0,r4,#0x10           ;1135
001448  f7fffffe          BL       lc640_write_long_ptr
00144c  f88d6000          STRB     r6,[sp,#0]            ;1137
001450  f88d6001          STRB     r6,[sp,#1]            ;1138
001454  f88d6002          STRB     r6,[sp,#2]            ;1139
001458  f88d6003          STRB     r6,[sp,#3]            ;1140
00145c  4669              MOV      r1,sp                 ;1141
00145e  f1040014          ADD      r0,r4,#0x14           ;1141
001462  f7fffffe          BL       lc640_write_long_ptr
001466  f88d6000          STRB     r6,[sp,#0]            ;1143
00146a  f88d6001          STRB     r6,[sp,#1]            ;1144
00146e  f88d6002          STRB     r6,[sp,#2]            ;1145
001472  f88d6003          STRB     r6,[sp,#3]            ;1146
001476  4669              MOV      r1,sp                 ;1147
001478  f1040018          ADD      r0,r4,#0x18           ;1147
00147c  f7fffffe          BL       lc640_write_long_ptr
001480  f88d6000          STRB     r6,[sp,#0]            ;1149
001484  f88d6001          STRB     r6,[sp,#1]            ;1150
001488  f88d6002          STRB     r6,[sp,#2]            ;1151
00148c  f88d6003          STRB     r6,[sp,#3]            ;1152
001490  4669              MOV      r1,sp                 ;1153
001492  f104001c          ADD      r0,r4,#0x1c           ;1153
001496  f7fffffe          BL       lc640_write_long_ptr
00149a  b115              CBZ      r5,|L1.5282|
00149c  2d01              CMP      r5,#1                 ;1159
00149e  d007              BEQ      |L1.5296|
0014a0  e0a5              B        |L1.5614|
                  |L1.5282|
0014a2  2301              MOVS     r3,#1                 ;1157
0014a4  461a              MOV      r2,r3                 ;1157
0014a6  2105              MOVS     r1,#5                 ;1157
0014a8  a0fd              ADR      r0,|L1.6304|
0014aa  f7fffffe          BL       snmp_trap_send
0014ae  e09e              B        |L1.5614|
                  |L1.5296|
0014b0  2301              MOVS     r3,#1                 ;1161
0014b2  2202              MOVS     r2,#2                 ;1161
0014b4  2105              MOVS     r1,#5                 ;1161
0014b6  a0ff              ADR      r0,|L1.6324|
0014b8  f7fffffe          BL       snmp_trap_send
0014bc  e097              B        |L1.5614|
                  |L1.5310|
;;;1167   	{
;;;1168   	bat[b]._av&=~1;
0014be  f8101f3d          LDRB     r1,[r0,#0x3d]!
0014c2  f0210101          BIC      r1,r1,#1
0014c6  7001              STRB     r1,[r0,#0]
;;;1169   
;;;1170        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0014c8  4630              MOV      r0,r6
0014ca  f7fffffe          BL       lc640_read_int
0014ce  b287              UXTH     r7,r0
;;;1171   	event_ptr_find=event_ptr;
0014d0  463c              MOV      r4,r7
                  |L1.5330|
;;;1172   	
;;;1173   avar_bat_hndl_lbl1: 
;;;1174   
;;;1175   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0014d2  eb0b1044          ADD      r0,r11,r4,LSL #5
0014d6  b286              UXTH     r6,r0
;;;1176   
;;;1177        lc640_read_long_ptr(lc640_adr,data);
0014d8  4669              MOV      r1,sp
0014da  4630              MOV      r0,r6
0014dc  f7fffffe          BL       lc640_read_long_ptr
;;;1178        
;;;1179        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
0014e0  f89d0000          LDRB     r0,[sp,#0]
0014e4  2842              CMP      r0,#0x42
0014e6  d107              BNE      |L1.5368|
0014e8  f89d0001          LDRB     r0,[sp,#1]
0014ec  42a8              CMP      r0,r5
0014ee  d103              BNE      |L1.5368|
0014f0  f89d0002          LDRB     r0,[sp,#2]
0014f4  2843              CMP      r0,#0x43
0014f6  d009              BEQ      |L1.5388|
                  |L1.5368|
;;;1180        	{        
;;;1181        	if(event_ptr_find)event_ptr_find--;
0014f8  b11c              CBZ      r4,|L1.5378|
0014fa  f1a40401          SUB      r4,r4,#1
0014fe  b2a4              UXTH     r4,r4
001500  e001              B        |L1.5382|
                  |L1.5378|
;;;1182        	else event_ptr_find=63;
001502  f04f043f          MOV      r4,#0x3f
                  |L1.5382|
;;;1183        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
001506  42bc              CMP      r4,r7
001508  d1e3              BNE      |L1.5330|
00150a  e070              B        |L1.5614|
                  |L1.5388|
;;;1184        	else goto avar_bat_hndl_lbl1;
;;;1185        	}
;;;1186        else 
;;;1187        	{
;;;1188        	lc640_read_long_ptr(lc640_adr+16,data);
00150c  4669              MOV      r1,sp
00150e  f1060010          ADD      r0,r6,#0x10
001512  f7fffffe          BL       lc640_read_long_ptr
;;;1189        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001516  f89d0000          LDRB     r0,[sp,#0]
00151a  2841              CMP      r0,#0x41
00151c  d10b              BNE      |L1.5430|
00151e  f89d0001          LDRB     r0,[sp,#1]
001522  2841              CMP      r0,#0x41
001524  d107              BNE      |L1.5430|
001526  f89d0002          LDRB     r0,[sp,#2]
00152a  2841              CMP      r0,#0x41
00152c  d103              BNE      |L1.5430|
00152e  f89d0003          LDRB     r0,[sp,#3]
001532  2841              CMP      r0,#0x41
001534  d009              BEQ      |L1.5450|
                  |L1.5430|
;;;1190        		{        
;;;1191        		if(event_ptr_find)event_ptr_find--;
001536  b11c              CBZ      r4,|L1.5440|
001538  f1a40401          SUB      r4,r4,#1
00153c  b2a4              UXTH     r4,r4
00153e  e001              B        |L1.5444|
                  |L1.5440|
;;;1192            		else event_ptr_find=63;
001540  f04f043f          MOV      r4,#0x3f
                  |L1.5444|
;;;1193            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
001544  42bc              CMP      r4,r7
001546  d1c4              BNE      |L1.5330|
001548  e051              B        |L1.5614|
                  |L1.5450|
;;;1194        		else goto avar_bat_hndl_lbl1;
;;;1195        		}
;;;1196   
;;;1197        	}
;;;1198        		
;;;1199   	data[0]=LPC_RTC->YEAR;
00154a  f8b8003c          LDRH     r0,[r8,#0x3c]
00154e  f88d0000          STRB     r0,[sp,#0]
;;;1200   	data[1]=LPC_RTC->MONTH;
001552  f8980038          LDRB     r0,[r8,#0x38]
001556  f88d0001          STRB     r0,[sp,#1]
;;;1201   	data[2]=LPC_RTC->DOM;
00155a  f898002c          LDRB     r0,[r8,#0x2c]
00155e  f88d0002          STRB     r0,[sp,#2]
;;;1202   	data[3]=0;
001562  f88da003          STRB     r10,[sp,#3]
;;;1203   	lc640_write_long_ptr(lc640_adr+16,data);
001566  4669              MOV      r1,sp
001568  f1060010          ADD      r0,r6,#0x10
00156c  f7fffffe          BL       lc640_write_long_ptr
;;;1204   
;;;1205   	data[0]=LPC_RTC->HOUR;
001570  f8980028          LDRB     r0,[r8,#0x28]
001574  f88d0000          STRB     r0,[sp,#0]
;;;1206   	data[1]=LPC_RTC->MIN;
001578  f8980024          LDRB     r0,[r8,#0x24]
00157c  f88d0001          STRB     r0,[sp,#1]
;;;1207   	data[2]=LPC_RTC->SEC;
001580  f8980020          LDRB     r0,[r8,#0x20]
001584  f88d0002          STRB     r0,[sp,#2]
;;;1208   	data[3]=0;
001588  f88da003          STRB     r10,[sp,#3]
;;;1209   	lc640_write_long_ptr(lc640_adr+20,data);
00158c  4669              MOV      r1,sp
00158e  f1060014          ADD      r0,r6,#0x14
001592  f7fffffe          BL       lc640_write_long_ptr
;;;1210   	
;;;1211   	data[0]='B';
001596  f88d9000          STRB     r9,[sp,#0]
;;;1212   	data[1]='B';
00159a  f88d9001          STRB     r9,[sp,#1]
;;;1213   	data[2]='B';
00159e  f88d9002          STRB     r9,[sp,#2]
;;;1214   	data[3]='B';
0015a2  f88d9003          STRB     r9,[sp,#3]
;;;1215   	lc640_write_long_ptr(lc640_adr+24,data);
0015a6  4669              MOV      r1,sp
0015a8  f1060018          ADD      r0,r6,#0x18
0015ac  f7fffffe          BL       lc640_write_long_ptr
;;;1216   	
;;;1217   	data[0]='B';
0015b0  f88d9000          STRB     r9,[sp,#0]
;;;1218   	data[1]='B';
0015b4  f88d9001          STRB     r9,[sp,#1]
;;;1219   	data[2]='B';
0015b8  f88d9002          STRB     r9,[sp,#2]
;;;1220   	data[3]='B';
0015bc  f88d9003          STRB     r9,[sp,#3]
;;;1221   	lc640_write_long_ptr(lc640_adr+28,data);
0015c0  4669              MOV      r1,sp
0015c2  f106001c          ADD      r0,r6,#0x1c
0015c6  f7fffffe          BL       lc640_write_long_ptr
;;;1222   	
;;;1223   	if(b==0)
0015ca  b115              CBZ      r5,|L1.5586|
;;;1224   		{
;;;1225   		snmp_trap_send("BAT #1 detected",5,1,0);
;;;1226   		}
;;;1227   	else if(b==1)
0015cc  2d01              CMP      r5,#1
0015ce  d008              BEQ      |L1.5602|
0015d0  e00d              B        |L1.5614|
                  |L1.5586|
0015d2  2300              MOVS     r3,#0                 ;1225
0015d4  2201              MOVS     r2,#1                 ;1225
0015d6  2105              MOVS     r1,#5                 ;1225
0015d8  f2af2060          ADR      r0,|L1.4988|
0015dc  f7fffffe          BL       snmp_trap_send
0015e0  e005              B        |L1.5614|
                  |L1.5602|
;;;1228   		{
;;;1229   		snmp_trap_send("BAT #2 detected",5,2,0);
0015e2  2300              MOVS     r3,#0
0015e4  2202              MOVS     r2,#2
0015e6  2105              MOVS     r1,#5
0015e8  a0b7              ADR      r0,|L1.6344|
0015ea  f7fffffe          BL       snmp_trap_send
                  |L1.5614|
;;;1230   		}
;;;1231   	
;;;1232   	}
;;;1233   	
;;;1234   avar_bat_hndl_end:
;;;1235   __nop();		
0015ee  bf00              NOP      
                  |L1.5616|
;;;1236   }
0015f0  e4a5              B        |L1.3902|
;;;1237   
                          ENDP

                  avar_bat_temper_hndl PROC
;;;1238   //-----------------------------------------------
;;;1239   void avar_bat_temper_hndl(char b, char in)
0015f2  e92d4ff8          PUSH     {r3-r11,lr}
;;;1240   {
0015f6  4605              MOV      r5,r0
0015f8  460e              MOV      r6,r1
;;;1241   char data[4];
;;;1242   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1243   
;;;1244   if((in==1)||(in==3))
;;;1245   	{
;;;1246   	//bat[b]._av|=1;
;;;1247       
;;;1248   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1249   	event_ptr++;	
;;;1250   	if(event_ptr>63)event_ptr=0;	
;;;1251   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1252   	
;;;1253        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1254   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1255   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1256   	
;;;1257   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1258   	
;;;1259   	data[0]='B';
;;;1260   	data[1]=b;
;;;1261   	data[2]='T';
;;;1262   	data[3]='1';
;;;1263   	if(in==3)data[3]='3';
;;;1264   	lc640_write_long_ptr(lc640_adr,data);
;;;1265   
;;;1266   	data[0]=0;
;;;1267   	data[1]=0;
;;;1268   	data[2]=0;
;;;1269   	data[3]=0;
;;;1270   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1271   
;;;1272   	data[0]=LPC_RTC->YEAR;
0015fa  f8dfa2dc          LDR      r10,|L1.6360|
0015fe  f44f6060          MOV      r0,#0xe00             ;1248
001602  f44f6780          MOV      r7,#0x400             ;1257
001606  2e01              CMP      r6,#1                 ;1244
001608  d010              BEQ      |L1.5676|
00160a  2e03              CMP      r6,#3                 ;1244
00160c  d00e              BEQ      |L1.5676|
;;;1273   	data[1]=LPC_RTC->MONTH;
;;;1274   	data[2]=LPC_RTC->DOM;
;;;1275   	data[3]=0;
;;;1276   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1277   
;;;1278   	data[0]=LPC_RTC->HOUR;
;;;1279   	data[1]=LPC_RTC->MIN;
;;;1280   	data[2]=LPC_RTC->SEC;
;;;1281   	data[3]=0;
;;;1282   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1283   	
;;;1284   	data[0]='A';
;;;1285   	data[1]='A';
;;;1286   	data[2]='A';
;;;1287   	data[3]='A';
;;;1288   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1289   	
;;;1290   	data[0]='A';
;;;1291   	data[1]='A';
;;;1292   	data[2]='A';
;;;1293   	data[3]='A';
;;;1294   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1295   	
;;;1296   	data[0]='A';
;;;1297   	data[1]='A';
;;;1298   	data[2]='A';
;;;1299   	data[3]='A';
;;;1300   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1301   	
;;;1302   	data[0]='A';
;;;1303   	data[1]='A';
;;;1304   	data[2]='A';
;;;1305   	data[3]='A';
;;;1306   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1307   	if(in==1)
;;;1308   		{				
;;;1309   		if(b==0)
;;;1310   			{
;;;1311   			snmp_trap_send("BAT #1 Alarm, is heated",10,1,1);
;;;1312   			}
;;;1313   		else if(b==1)
;;;1314   			{
;;;1315   			snmp_trap_send("BAT #2 Alarm, is heated",10,2,1);
;;;1316   			} 
;;;1317   		}
;;;1318   	if(in==3)
;;;1319   		{				
;;;1320   		if(b==0)
;;;1321   			{
;;;1322   			snmp_trap_send("BAT #1 Alarm, is overheated",11,1,1);
;;;1323   			}
;;;1324   		else if(b==1)
;;;1325   			{
;;;1326   			snmp_trap_send("BAT #2 Alarm, is overheated",11,2,1);
;;;1327   			} 
;;;1328   		}			
;;;1329   	}
;;;1330   
;;;1331   else if((in==0)||(in==2))
00160e  b10e              CBZ      r6,|L1.5652|
001610  2e02              CMP      r6,#2
001612  d17e              BNE      |L1.5906|
                  |L1.5652|
;;;1332   	{
;;;1333   	char i;
;;;1334   
;;;1335   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
001614  f7fffffe          BL       lc640_read_int
001618  fa1ff980          UXTH     r9,r0
;;;1336   	event_ptr_find=event_ptr;
00161c  464c              MOV      r4,r9
;;;1337   
;;;1338   /*	for (i=0;i<63;i++)
;;;1339   		{
;;;1340   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1341   
;;;1342        	lc640_read_long_ptr(lc640_adr,data);
;;;1343        
;;;1344        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;1345        		{        
;;;1346        		if(event_ptr_find)event_ptr_find--;
;;;1347        		else event_ptr_find=63;
;;;1348        		if(event_ptr_find==event_ptr)
;;;1349   				{
;;;1350   				lc640_adr=0;
;;;1351   				break;
;;;1352   				}
;;;1353        		else continue;
;;;1354        		}
;;;1355        	else 
;;;1356        		{
;;;1357        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1358        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1359        			{        
;;;1360        			if(event_ptr_find)event_ptr_find--;
;;;1361            		else event_ptr_find=63;
;;;1362            		if(event_ptr_find==event_ptr)
;;;1363   					{
;;;1364   					lc640_adr=0;
;;;1365   					break;
;;;1366   					}
;;;1367        			else continue;
;;;1368        			}
;;;1369        		}	
;;;1370   		}*/
;;;1371   	
;;;1372   	for (i=0;i<63;i++)
00161e  f04f0800          MOV      r8,#0
                  |L1.5666|
;;;1373   		{
;;;1374   		char temp='1';
001622  f04f0b31          MOV      r11,#0x31
;;;1375   		if(in==2)temp='3';
001626  2e02              CMP      r6,#2
001628  d074              BEQ      |L1.5908|
00162a  e0c7              B        |L1.6076|
                  |L1.5676|
00162c  4680              MOV      r8,r0                 ;1248
00162e  f7fffffe          BL       lc640_read_int
001632  f1000001          ADD      r0,r0,#1              ;1249
001636  b284              UXTH     r4,r0                 ;1249
001638  2c3f              CMP      r4,#0x3f              ;1250
00163a  d901              BLS      |L1.5696|
00163c  f04f0400          MOV      r4,#0                 ;1250
                  |L1.5696|
001640  b221              SXTH     r1,r4                 ;1251
001642  4640              MOV      r0,r8                 ;1251
001644  f7fffffe          BL       lc640_write_int
001648  f6406902          MOV      r9,#0xe02             ;1253
00164c  4648              MOV      r0,r9                 ;1253
00164e  f7fffffe          BL       lc640_read_int
001652  b280              UXTH     r0,r0                 ;1253
001654  283f              CMP      r0,#0x3f              ;1254
001656  d000              BEQ      |L1.5722|
001658  4620              MOV      r0,r4                 ;1254
                  |L1.5722|
00165a  b201              SXTH     r1,r0                 ;1255
00165c  4648              MOV      r0,r9                 ;1255
00165e  f7fffffe          BL       lc640_write_int
001662  4640              MOV      r0,r8                 ;1257
001664  f7fffffe          BL       lc640_read_int
001668  eb071040          ADD      r0,r7,r0,LSL #5       ;1257
00166c  b284              UXTH     r4,r0                 ;1257
00166e  f04f0042          MOV      r0,#0x42              ;1259
001672  f88d0000          STRB     r0,[sp,#0]            ;1259
001676  f88d5001          STRB     r5,[sp,#1]            ;1260
00167a  f04f0054          MOV      r0,#0x54              ;1261
00167e  f88d0002          STRB     r0,[sp,#2]            ;1261
001682  f04f0031          MOV      r0,#0x31              ;1262
001686  f88d0003          STRB     r0,[sp,#3]            ;1262
00168a  2e03              CMP      r6,#3                 ;1263
00168c  d103              BNE      |L1.5782|
00168e  f04f0033          MOV      r0,#0x33              ;1263
001692  f88d0003          STRB     r0,[sp,#3]            ;1263
                  |L1.5782|
001696  4669              MOV      r1,sp                 ;1264
001698  4620              MOV      r0,r4                 ;1264
00169a  f7fffffe          BL       lc640_write_long_ptr
00169e  f04f0700          MOV      r7,#0                 ;1266
0016a2  9700              STR      r7,[sp,#0]            ;1269
0016a4  4669              MOV      r1,sp                 ;1270
0016a6  f1040004          ADD      r0,r4,#4              ;1270
0016aa  f7fffffe          BL       lc640_write_long_ptr
0016ae  f8ba003c          LDRH     r0,[r10,#0x3c]        ;1272
0016b2  f88d0000          STRB     r0,[sp,#0]            ;1272
0016b6  f89a0038          LDRB     r0,[r10,#0x38]        ;1273
0016ba  f88d0001          STRB     r0,[sp,#1]            ;1273
0016be  f89a002c          LDRB     r0,[r10,#0x2c]        ;1274
0016c2  f88d0002          STRB     r0,[sp,#2]            ;1274
0016c6  f88d7003          STRB     r7,[sp,#3]            ;1275
0016ca  4669              MOV      r1,sp                 ;1276
0016cc  f1040008          ADD      r0,r4,#8              ;1276
0016d0  f7fffffe          BL       lc640_write_long_ptr
0016d4  f89a0028          LDRB     r0,[r10,#0x28]        ;1278
0016d8  f88d0000          STRB     r0,[sp,#0]            ;1278
0016dc  f89a0024          LDRB     r0,[r10,#0x24]        ;1279
0016e0  f88d0001          STRB     r0,[sp,#1]            ;1279
0016e4  f89a0020          LDRB     r0,[r10,#0x20]        ;1280
0016e8  f88d0002          STRB     r0,[sp,#2]            ;1280
0016ec  f88d7003          STRB     r7,[sp,#3]            ;1281
0016f0  4669              MOV      r1,sp                 ;1282
0016f2  f104000c          ADD      r0,r4,#0xc            ;1282
0016f6  f7fffffe          BL       lc640_write_long_ptr
0016fa  f04f0741          MOV      r7,#0x41              ;1284
0016fe  f88d7000          STRB     r7,[sp,#0]            ;1284
001702  f88d7001          STRB     r7,[sp,#1]            ;1285
001706  f88d7002          STRB     r7,[sp,#2]            ;1286
00170a  f88d7003          STRB     r7,[sp,#3]            ;1287
00170e  4669              MOV      r1,sp                 ;1288
001710  e001              B        |L1.5910|
                  |L1.5906|
001712  e049              B        |L1.6056|
                  |L1.5908|
001714  e050              B        |L1.6072|
                  |L1.5910|
001716  f1040010          ADD      r0,r4,#0x10           ;1288
00171a  f7fffffe          BL       lc640_write_long_ptr
00171e  f88d7000          STRB     r7,[sp,#0]            ;1290
001722  f88d7001          STRB     r7,[sp,#1]            ;1291
001726  f88d7002          STRB     r7,[sp,#2]            ;1292
00172a  f88d7003          STRB     r7,[sp,#3]            ;1293
00172e  4669              MOV      r1,sp                 ;1294
001730  f1040014          ADD      r0,r4,#0x14           ;1294
001734  f7fffffe          BL       lc640_write_long_ptr
001738  f88d7000          STRB     r7,[sp,#0]            ;1296
00173c  f88d7001          STRB     r7,[sp,#1]            ;1297
001740  f88d7002          STRB     r7,[sp,#2]            ;1298
001744  f88d7003          STRB     r7,[sp,#3]            ;1299
001748  4669              MOV      r1,sp                 ;1300
00174a  f1040018          ADD      r0,r4,#0x18           ;1300
00174e  f7fffffe          BL       lc640_write_long_ptr
001752  f88d7000          STRB     r7,[sp,#0]            ;1302
001756  f88d7001          STRB     r7,[sp,#1]            ;1303
00175a  f88d7002          STRB     r7,[sp,#2]            ;1304
00175e  f88d7003          STRB     r7,[sp,#3]            ;1305
001762  4669              MOV      r1,sp                 ;1306
001764  f104001c          ADD      r0,r4,#0x1c           ;1306
001768  f7fffffe          BL       lc640_write_long_ptr
00176c  2e01              CMP      r6,#1                 ;1307
00176e  d110              BNE      |L1.6034|
001770  b115              CBZ      r5,|L1.6008|
001772  2d01              CMP      r5,#1                 ;1313
001774  d007              BEQ      |L1.6022|
001776  e00c              B        |L1.6034|
                  |L1.6008|
001778  2301              MOVS     r3,#1                 ;1311
00177a  461a              MOV      r2,r3                 ;1311
00177c  210a              MOVS     r1,#0xa               ;1311
00177e  a057              ADR      r0,|L1.6364|
001780  f7fffffe          BL       snmp_trap_send
001784  e005              B        |L1.6034|
                  |L1.6022|
001786  2301              MOVS     r3,#1                 ;1315
001788  2202              MOVS     r2,#2                 ;1315
00178a  210a              MOVS     r1,#0xa               ;1315
00178c  a059              ADR      r0,|L1.6388|
00178e  f7fffffe          BL       snmp_trap_send
                  |L1.6034|
001792  2e03              CMP      r6,#3                 ;1318
001794  d108              BNE      |L1.6056|
001796  b145              CBZ      r5,|L1.6058|
001798  2d01              CMP      r5,#1                 ;1324
00179a  d105              BNE      |L1.6056|
00179c  2301              MOVS     r3,#1                 ;1326
00179e  2202              MOVS     r2,#2                 ;1326
0017a0  210b              MOVS     r1,#0xb               ;1326
0017a2  a05a              ADR      r0,|L1.6412|
0017a4  f7fffffe          BL       snmp_trap_send
                  |L1.6056|
;;;1376   
;;;1377   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1378   
;;;1379        	lc640_read_long_ptr(lc640_adr,data);
;;;1380        
;;;1381        	if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='T')&&(data[3]==temp)))
;;;1382        		{        
;;;1383        		if(event_ptr_find)event_ptr_find--;
;;;1384        		else event_ptr_find=63;
;;;1385        		if(event_ptr_find==event_ptr)				{
;;;1386   				lc640_adr=0;
;;;1387   				break;
;;;1388   				}
;;;1389        		else continue;
;;;1390        		}
;;;1391   	     else 
;;;1392   	     	{
;;;1393   	     	lc640_read_long_ptr(lc640_adr+16,data);
;;;1394   	     	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1395   	     		{        
;;;1396   	     		if(event_ptr_find)event_ptr_find--;
;;;1397   	         	else event_ptr_find=63;
;;;1398   	         	if(event_ptr_find==event_ptr)				{
;;;1399   					lc640_adr=0;
;;;1400   					break;
;;;1401   					}
;;;1402   	     		else continue;
;;;1403   	     		}
;;;1404   	
;;;1405   	     	}
;;;1406   		}
;;;1407        		
;;;1408   	data[0]=LPC_RTC->YEAR;
;;;1409   	data[1]=LPC_RTC->MONTH;
;;;1410   	data[2]=LPC_RTC->DOM;
;;;1411   	data[3]=0;
;;;1412   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1413   
;;;1414   	data[0]=LPC_RTC->HOUR;
;;;1415   	data[1]=LPC_RTC->MIN;
;;;1416   	data[2]=LPC_RTC->SEC;
;;;1417   	data[3]=0;
;;;1418   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1419   	
;;;1420   	data[0]='B';
;;;1421   	data[1]='B';
;;;1422   	data[2]='B';
;;;1423   	data[3]='B';
;;;1424   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1425   	
;;;1426   	data[0]='B';
;;;1427   	data[1]='B';
;;;1428   	data[2]='B';
;;;1429   	data[3]='B';
;;;1430   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1431   	
;;;1432   	if(in==0)
;;;1433   		{				
;;;1434   		if(b==0)
;;;1435   			{
;;;1436   			snmp_trap_send("BAT #1 Alarm, heating eliminated",10,1,0);
;;;1437   			}
;;;1438   		else if(b==1)
;;;1439   			{
;;;1440   			snmp_trap_send("BAT #2 Alarm, heating eliminated",10,2,0);
;;;1441   			} 
;;;1442   		}
;;;1443   	if(in==2)
;;;1444   		{				
;;;1445   		if(b==0)
;;;1446   			{
;;;1447   			snmp_trap_send("BAT #1 Alarm, overheating eliminated",11,1,0);
;;;1448   			}
;;;1449   		else if(b==1)
;;;1450   			{
;;;1451   			snmp_trap_send("BAT #2 Alarm, overheating eliminated",11,2,0);
;;;1452   			} 
;;;1453   		}		
;;;1454   	
;;;1455   	}
;;;1456   	
;;;1457   }
0017a8  e5a4              B        |L1.4852|
                  |L1.6058|
0017aa  2301              MOVS     r3,#1                 ;1322
0017ac  461a              MOV      r2,r3                 ;1322
0017ae  210b              MOVS     r1,#0xb               ;1322
0017b0  a05d              ADR      r0,|L1.6440|
0017b2  f7fffffe          BL       snmp_trap_send
0017b6  e59d              B        |L1.4852|
                  |L1.6072|
0017b8  f04f0b33          MOV      r11,#0x33             ;1375
                  |L1.6076|
0017bc  f44f6080          MOV      r0,#0x400             ;1377
0017c0  eb001044          ADD      r0,r0,r4,LSL #5       ;1377
0017c4  b287              UXTH     r7,r0                 ;1377
0017c6  4669              MOV      r1,sp                 ;1379
0017c8  4638              MOV      r0,r7                 ;1379
0017ca  f7fffffe          BL       lc640_read_long_ptr
0017ce  f89d0000          LDRB     r0,[sp,#0]            ;1381
0017d2  2842              CMP      r0,#0x42              ;1381
0017d4  d10b              BNE      |L1.6126|
0017d6  f89d0001          LDRB     r0,[sp,#1]            ;1381
0017da  42a8              CMP      r0,r5                 ;1381
0017dc  d107              BNE      |L1.6126|
0017de  f89d0002          LDRB     r0,[sp,#2]            ;1381
0017e2  2854              CMP      r0,#0x54              ;1381
0017e4  d103              BNE      |L1.6126|
0017e6  f89d0003          LDRB     r0,[sp,#3]            ;1381
0017ea  4558              CMP      r0,r11                ;1381
0017ec  d00b              BEQ      |L1.6150|
                  |L1.6126|
0017ee  b11c              CBZ      r4,|L1.6136|
0017f0  f1a40401          SUB      r4,r4,#1              ;1383
0017f4  b2a4              UXTH     r4,r4                 ;1383
0017f6  e001              B        |L1.6140|
                  |L1.6136|
0017f8  f04f043f          MOV      r4,#0x3f              ;1384
                  |L1.6140|
0017fc  454c              CMP      r4,r9                 ;1385
0017fe  d123              BNE      |L1.6216|
001800  f04f0700          MOV      r7,#0                 ;1386
001804  e028              B        |L1.6232|
                  |L1.6150|
001806  4669              MOV      r1,sp                 ;1393
001808  f1070010          ADD      r0,r7,#0x10           ;1393
00180c  f7fffffe          BL       lc640_read_long_ptr
001810  f89d0000          LDRB     r0,[sp,#0]            ;1394
001814  2841              CMP      r0,#0x41              ;1394
001816  d10b              BNE      |L1.6192|
001818  f89d0001          LDRB     r0,[sp,#1]            ;1394
00181c  2841              CMP      r0,#0x41              ;1394
00181e  d107              BNE      |L1.6192|
001820  f89d0002          LDRB     r0,[sp,#2]            ;1394
001824  2841              CMP      r0,#0x41              ;1394
001826  d103              BNE      |L1.6192|
001828  f89d0003          LDRB     r0,[sp,#3]            ;1394
00182c  2841              CMP      r0,#0x41              ;1394
00182e  d00b              BEQ      |L1.6216|
                  |L1.6192|
001830  b11c              CBZ      r4,|L1.6202|
001832  f1a40401          SUB      r4,r4,#1              ;1396
001836  b2a4              UXTH     r4,r4                 ;1396
001838  e001              B        |L1.6206|
                  |L1.6202|
00183a  f04f043f          MOV      r4,#0x3f              ;1397
                  |L1.6206|
00183e  454c              CMP      r4,r9                 ;1398
001840  d102              BNE      |L1.6216|
001842  f04f0700          MOV      r7,#0                 ;1399
001846  e007              B        |L1.6232|
                  |L1.6216|
001848  f1080801          ADD      r8,r8,#1              ;1372
00184c  f00808ff          AND      r8,r8,#0xff           ;1372
001850  f1b80f3f          CMP      r8,#0x3f              ;1372
001854  f4ffaee5          BCC      |L1.5666|
                  |L1.6232|
001858  f8ba003c          LDRH     r0,[r10,#0x3c]        ;1408
00185c  f88d0000          STRB     r0,[sp,#0]            ;1408
001860  f89a0038          LDRB     r0,[r10,#0x38]        ;1409
001864  f88d0001          STRB     r0,[sp,#1]            ;1409
001868  f89a002c          LDRB     r0,[r10,#0x2c]        ;1410
00186c  f88d0002          STRB     r0,[sp,#2]            ;1410
001870  f04f0400          MOV      r4,#0                 ;1411
001874  f88d4003          STRB     r4,[sp,#3]            ;1411
001878  4669              MOV      r1,sp                 ;1412
00187a  f1070010          ADD      r0,r7,#0x10           ;1412
00187e  f7fffffe          BL       lc640_write_long_ptr
001882  f89a0028          LDRB     r0,[r10,#0x28]        ;1414
001886  f88d0000          STRB     r0,[sp,#0]            ;1414
00188a  f89a0024          LDRB     r0,[r10,#0x24]        ;1415
00188e  f88d0001          STRB     r0,[sp,#1]            ;1415
001892  f89a0020          LDRB     r0,[r10,#0x20]        ;1416
001896  f88d0002          STRB     r0,[sp,#2]            ;1416
00189a  f88d4003          STRB     r4,[sp,#3]            ;1417
00189e  e051              B        |L1.6468|
                  |L1.6304|
0018a0  42415420          DCB      "BAT #1 Alarm, lost",0
0018a4  23312041
0018a8  6c61726d
0018ac  2c206c6f
0018b0  737400  
0018b3  00                DCB      0
                  |L1.6324|
0018b4  42415420          DCB      "BAT #2 Alarm, lost",0
0018b8  23322041
0018bc  6c61726d
0018c0  2c206c6f
0018c4  737400  
0018c7  00                DCB      0
                  |L1.6344|
0018c8  42415420          DCB      "BAT #2 detected",0
0018cc  23322064
0018d0  65746563
0018d4  74656400
                  |L1.6360|
                          DCD      0x40024000
                  |L1.6364|
0018dc  42415420          DCB      "BAT #1 Alarm, is heated",0
0018e0  23312041
0018e4  6c61726d
0018e8  2c206973
0018ec  20686561
0018f0  74656400
                  |L1.6388|
0018f4  42415420          DCB      "BAT #2 Alarm, is heated",0
0018f8  23322041
0018fc  6c61726d
001900  2c206973
001904  20686561
001908  74656400
                  |L1.6412|
00190c  42415420          DCB      "BAT #2 Alarm, is overheated",0
001910  23322041
001914  6c61726d
001918  2c206973
00191c  206f7665
001920  72686561
001924  74656400
                  |L1.6440|
001928  42415420          DCB      "BAT #1 Alarm, is overheated",0
00192c  23312041
001930  6c61726d
001934  2c206973
001938  206f7665
00193c  72686561
001940  74656400
                  |L1.6468|
001944  4669              MOV      r1,sp                 ;1418
001946  f1070014          ADD      r0,r7,#0x14           ;1418
00194a  f7fffffe          BL       lc640_write_long_ptr
00194e  f04f0442          MOV      r4,#0x42              ;1420
001952  f88d4000          STRB     r4,[sp,#0]            ;1420
001956  f88d4001          STRB     r4,[sp,#1]            ;1421
00195a  f88d4002          STRB     r4,[sp,#2]            ;1422
00195e  f88d4003          STRB     r4,[sp,#3]            ;1423
001962  4669              MOV      r1,sp                 ;1424
001964  f1070018          ADD      r0,r7,#0x18           ;1424
001968  f7fffffe          BL       lc640_write_long_ptr
00196c  f88d4000          STRB     r4,[sp,#0]            ;1426
001970  f88d4001          STRB     r4,[sp,#1]            ;1427
001974  f88d4002          STRB     r4,[sp,#2]            ;1428
001978  f88d4003          STRB     r4,[sp,#3]            ;1429
00197c  4669              MOV      r1,sp                 ;1430
00197e  f107001c          ADD      r0,r7,#0x1c           ;1430
001982  f7fffffe          BL       lc640_write_long_ptr
001986  b986              CBNZ     r6,|L1.6570|
001988  b115              CBZ      r5,|L1.6544|
00198a  2d01              CMP      r5,#1                 ;1438
00198c  d007              BEQ      |L1.6558|
00198e  e00c              B        |L1.6570|
                  |L1.6544|
001990  2300              MOVS     r3,#0                 ;1436
001992  2201              MOVS     r2,#1                 ;1436
001994  210a              MOVS     r1,#0xa               ;1436
001996  a0ea              ADR      r0,|L1.7488|
001998  f7fffffe          BL       snmp_trap_send
00199c  e005              B        |L1.6570|
                  |L1.6558|
00199e  2300              MOVS     r3,#0                 ;1440
0019a0  2202              MOVS     r2,#2                 ;1440
0019a2  210a              MOVS     r1,#0xa               ;1440
0019a4  a0ef              ADR      r0,|L1.7524|
0019a6  f7fffffe          BL       snmp_trap_send
                  |L1.6570|
0019aa  2e02              CMP      r6,#2                 ;1443
                  |L1.6572|
0019ac  f47faefc          BNE      |L1.6056|
0019b0  b145              CBZ      r5,|L1.6596|
0019b2  2d01              CMP      r5,#1                 ;1449
0019b4  d1fa              BNE      |L1.6572|
0019b6  2300              MOVS     r3,#0                 ;1451
0019b8  2202              MOVS     r2,#2                 ;1451
0019ba  210b              MOVS     r1,#0xb               ;1451
0019bc  a0f2              ADR      r0,|L1.7560|
0019be  f7fffffe          BL       snmp_trap_send
                  |L1.6594|
0019c2  e497              B        |L1.4852|
                  |L1.6596|
0019c4  2300              MOVS     r3,#0                 ;1447
0019c6  2201              MOVS     r2,#1                 ;1447
0019c8  210b              MOVS     r1,#0xb               ;1447
0019ca  a0f9              ADR      r0,|L1.7600|
0019cc  f7fffffe          BL       snmp_trap_send
0019d0  e490              B        |L1.4852|
;;;1458   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1459   //-----------------------------------------------
;;;1460   void avar_bat_as_hndl(char b, char in)
0019d2  e92d4ff8          PUSH     {r3-r11,lr}
;;;1461   {
0019d6  4605              MOV      r5,r0
;;;1462   char data[4];
;;;1463   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1464   
;;;1465   if(in==1)
;;;1466   	{
;;;1467   	bat[b]._av|=2;
0019d8  48ff              LDR      r0,|L1.7640|
0019da  eb050245          ADD      r2,r5,r5,LSL #1
;;;1468       
;;;1469   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1470   	event_ptr++;	
;;;1471   	if(event_ptr>63)event_ptr=0;	
;;;1472   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1473   	
;;;1474        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1475   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1476   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1477   	
;;;1478   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1479   	
;;;1480   	data[0]='B';
;;;1481   	data[1]=b;
;;;1482   	data[2]='S';
;;;1483   	data[3]=0;
;;;1484   	lc640_write_long_ptr(lc640_adr,data);
;;;1485   
;;;1486   	data[0]=0;
;;;1487   	data[1]=0;
;;;1488   	data[2]=0;
;;;1489   	data[3]=0;
;;;1490   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1491   
;;;1492   	data[0]=LPC_RTC->YEAR;
0019de  f8df83fc          LDR      r8,|L1.7644|
0019e2  eb021205          ADD      r2,r2,r5,LSL #4       ;1467
0019e6  f04f0a00          MOV      r10,#0                ;1471
0019ea  f04f0942          MOV      r9,#0x42              ;1480
0019ee  f44f6660          MOV      r6,#0xe00             ;1469
0019f2  f44f6b80          MOV      r11,#0x400            ;1478
0019f6  eb000082          ADD      r0,r0,r2,LSL #2       ;1467
0019fa  2901              CMP      r1,#1                 ;1465
0019fc  d002              BEQ      |L1.6660|
;;;1493   	data[1]=LPC_RTC->MONTH;
;;;1494   	data[2]=LPC_RTC->DOM;
;;;1495   	data[3]=0;
;;;1496   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1497   
;;;1498   	data[0]=LPC_RTC->HOUR;
;;;1499   	data[1]=LPC_RTC->MIN;
;;;1500   	data[2]=LPC_RTC->SEC;
;;;1501   	data[3]=0;
;;;1502   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1503   	
;;;1504   	data[0]='A';
;;;1505   	data[1]='A';
;;;1506   	data[2]='A';
;;;1507   	data[3]='A';
;;;1508   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1509   	
;;;1510   	data[0]='A';
;;;1511   	data[1]='A';
;;;1512   	data[2]='A';
;;;1513   	data[3]='A';
;;;1514   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1515   	
;;;1516   	data[0]='A';
;;;1517   	data[1]='A';
;;;1518   	data[2]='A';
;;;1519   	data[3]='A';
;;;1520   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1521   	
;;;1522   	data[0]='A';
;;;1523   	data[1]='A';
;;;1524   	data[2]='A';
;;;1525   	data[3]='A';
;;;1526   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1527   
;;;1528   	if(b==0)
;;;1529   		{
;;;1530   		snmp_trap_send("BAT #1 Alarm, asymmetry",5,1,2);
;;;1531   		}
;;;1532   	else if(b==1)
;;;1533   		{
;;;1534   		snmp_trap_send("BAT #2 Alarm, asymmetry",5,2,2);
;;;1535   		} 
;;;1536   	
;;;1537   	}
;;;1538   
;;;1539   else if(in==0)
0019fe  2900              CMP      r1,#0
001a00  d07d              BEQ      |L1.6910|
001a02  e140              B        |L1.7302|
                  |L1.6660|
001a04  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1467
001a08  f0410102          ORR      r1,r1,#2              ;1467
001a0c  7001              STRB     r1,[r0,#0]            ;1467
001a0e  4630              MOV      r0,r6                 ;1469
001a10  f7fffffe          BL       lc640_read_int
001a14  f1000001          ADD      r0,r0,#1              ;1470
001a18  b284              UXTH     r4,r0                 ;1470
001a1a  2c3f              CMP      r4,#0x3f              ;1471
001a1c  d901              BLS      |L1.6690|
001a1e  f04f0400          MOV      r4,#0                 ;1471
                  |L1.6690|
001a22  b221              SXTH     r1,r4                 ;1472
001a24  4630              MOV      r0,r6                 ;1472
001a26  f7fffffe          BL       lc640_write_int
001a2a  f6406702          MOV      r7,#0xe02             ;1474
001a2e  4638              MOV      r0,r7                 ;1474
001a30  f7fffffe          BL       lc640_read_int
001a34  b280              UXTH     r0,r0                 ;1474
001a36  283f              CMP      r0,#0x3f              ;1475
001a38  d000              BEQ      |L1.6716|
001a3a  4620              MOV      r0,r4                 ;1475
                  |L1.6716|
001a3c  b201              SXTH     r1,r0                 ;1476
001a3e  4638              MOV      r0,r7                 ;1476
001a40  f7fffffe          BL       lc640_write_int
001a44  4630              MOV      r0,r6                 ;1478
001a46  f7fffffe          BL       lc640_read_int
001a4a  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1478
001a4e  b284              UXTH     r4,r0                 ;1478
001a50  f88d9000          STRB     r9,[sp,#0]            ;1480
001a54  f88d5001          STRB     r5,[sp,#1]            ;1481
001a58  f04f0053          MOV      r0,#0x53              ;1482
001a5c  f88d0002          STRB     r0,[sp,#2]            ;1482
001a60  f88da003          STRB     r10,[sp,#3]           ;1483
001a64  4669              MOV      r1,sp                 ;1484
001a66  4620              MOV      r0,r4                 ;1484
001a68  f7fffffe          BL       lc640_write_long_ptr
001a6c  f8cda000          STR      r10,[sp,#0]           ;1489
001a70  4669              MOV      r1,sp                 ;1490
001a72  1d20              ADDS     r0,r4,#4              ;1490
001a74  f7fffffe          BL       lc640_write_long_ptr
001a78  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1492
001a7c  f88d0000          STRB     r0,[sp,#0]            ;1492
001a80  f8980038          LDRB     r0,[r8,#0x38]         ;1493
001a84  f88d0001          STRB     r0,[sp,#1]            ;1493
001a88  f898002c          LDRB     r0,[r8,#0x2c]         ;1494
001a8c  f88d0002          STRB     r0,[sp,#2]            ;1494
001a90  f88da003          STRB     r10,[sp,#3]           ;1495
001a94  4669              MOV      r1,sp                 ;1496
001a96  f1040008          ADD      r0,r4,#8              ;1496
001a9a  f7fffffe          BL       lc640_write_long_ptr
001a9e  f8980028          LDRB     r0,[r8,#0x28]         ;1498
001aa2  f88d0000          STRB     r0,[sp,#0]            ;1498
001aa6  f8980024          LDRB     r0,[r8,#0x24]         ;1499
001aaa  f88d0001          STRB     r0,[sp,#1]            ;1499
001aae  f8980020          LDRB     r0,[r8,#0x20]         ;1500
001ab2  f88d0002          STRB     r0,[sp,#2]            ;1500
001ab6  f88da003          STRB     r10,[sp,#3]           ;1501
001aba  4669              MOV      r1,sp                 ;1502
001abc  f104000c          ADD      r0,r4,#0xc            ;1502
001ac0  f7fffffe          BL       lc640_write_long_ptr
001ac4  f04f0641          MOV      r6,#0x41              ;1504
001ac8  f88d6000          STRB     r6,[sp,#0]            ;1504
001acc  f88d6001          STRB     r6,[sp,#1]            ;1505
001ad0  f88d6002          STRB     r6,[sp,#2]            ;1506
001ad4  f88d6003          STRB     r6,[sp,#3]            ;1507
001ad8  4669              MOV      r1,sp                 ;1508
001ada  f1040010          ADD      r0,r4,#0x10           ;1508
001ade  f7fffffe          BL       lc640_write_long_ptr
001ae2  f88d6000          STRB     r6,[sp,#0]            ;1510
001ae6  f88d6001          STRB     r6,[sp,#1]            ;1511
001aea  f88d6002          STRB     r6,[sp,#2]            ;1512
001aee  f88d6003          STRB     r6,[sp,#3]            ;1513
001af2  4669              MOV      r1,sp                 ;1514
001af4  f1040014          ADD      r0,r4,#0x14           ;1514
001af8  f7fffffe          BL       lc640_write_long_ptr
001afc  e000              B        |L1.6912|
                  |L1.6910|
001afe  e02b              B        |L1.7000|
                  |L1.6912|
001b00  f88d6000          STRB     r6,[sp,#0]            ;1516
001b04  f88d6001          STRB     r6,[sp,#1]            ;1517
001b08  f88d6002          STRB     r6,[sp,#2]            ;1518
001b0c  f88d6003          STRB     r6,[sp,#3]            ;1519
001b10  4669              MOV      r1,sp                 ;1520
001b12  f1040018          ADD      r0,r4,#0x18           ;1520
001b16  f7fffffe          BL       lc640_write_long_ptr
001b1a  f88d6000          STRB     r6,[sp,#0]            ;1522
001b1e  f88d6001          STRB     r6,[sp,#1]            ;1523
001b22  f88d6002          STRB     r6,[sp,#2]            ;1524
001b26  f88d6003          STRB     r6,[sp,#3]            ;1525
001b2a  4669              MOV      r1,sp                 ;1526
001b2c  f104001c          ADD      r0,r4,#0x1c           ;1526
001b30  f7fffffe          BL       lc640_write_long_ptr
001b34  b115              CBZ      r5,|L1.6972|
001b36  2d01              CMP      r5,#1                 ;1532
001b38  d007              BEQ      |L1.6986|
001b3a  e0a4              B        |L1.7302|
                  |L1.6972|
001b3c  2302              MOVS     r3,#2                 ;1530
001b3e  2201              MOVS     r2,#1                 ;1530
001b40  2105              MOVS     r1,#5                 ;1530
001b42  a0a7              ADR      r0,|L1.7648|
001b44  f7fffffe          BL       snmp_trap_send
001b48  e09d              B        |L1.7302|
                  |L1.6986|
001b4a  2302              MOVS     r3,#2                 ;1534
001b4c  461a              MOV      r2,r3                 ;1534
001b4e  2105              MOVS     r1,#5                 ;1534
001b50  a0a9              ADR      r0,|L1.7672|
001b52  f7fffffe          BL       snmp_trap_send
001b56  e096              B        |L1.7302|
                  |L1.7000|
;;;1540   	{
;;;1541   	bat[b]._av&=~(1<<1);
001b58  f8101f3d          LDRB     r1,[r0,#0x3d]!
001b5c  f0210102          BIC      r1,r1,#2
001b60  7001              STRB     r1,[r0,#0]
;;;1542   
;;;1543        event_ptr=lc640_read_int(PTR_EVENT_LOG);
001b62  4630              MOV      r0,r6
001b64  f7fffffe          BL       lc640_read_int
001b68  b287              UXTH     r7,r0
;;;1544   	event_ptr_find=event_ptr;
001b6a  463c              MOV      r4,r7
                  |L1.7020|
;;;1545   	
;;;1546   avar_bat_as_hndl_lbl1: 
;;;1547   
;;;1548   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001b6c  eb0b1044          ADD      r0,r11,r4,LSL #5
001b70  b286              UXTH     r6,r0
;;;1549   
;;;1550        lc640_read_long_ptr(lc640_adr,data);
001b72  4669              MOV      r1,sp
001b74  4630              MOV      r0,r6
001b76  f7fffffe          BL       lc640_read_long_ptr
;;;1551        
;;;1552        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
001b7a  f89d0000          LDRB     r0,[sp,#0]
001b7e  2842              CMP      r0,#0x42
001b80  d107              BNE      |L1.7058|
001b82  f89d0001          LDRB     r0,[sp,#1]
001b86  42a8              CMP      r0,r5
001b88  d103              BNE      |L1.7058|
001b8a  f89d0002          LDRB     r0,[sp,#2]
001b8e  2843              CMP      r0,#0x43
001b90  d009              BEQ      |L1.7078|
                  |L1.7058|
;;;1553        	{        
;;;1554        	if(event_ptr_find)event_ptr_find--;
001b92  b11c              CBZ      r4,|L1.7068|
001b94  f1a40401          SUB      r4,r4,#1
001b98  b2a4              UXTH     r4,r4
001b9a  e001              B        |L1.7072|
                  |L1.7068|
;;;1555        	else event_ptr_find=63;
001b9c  f04f043f          MOV      r4,#0x3f
                  |L1.7072|
;;;1556        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001ba0  42bc              CMP      r4,r7
001ba2  d1e3              BNE      |L1.7020|
001ba4  e06f              B        |L1.7302|
                  |L1.7078|
;;;1557        	else goto avar_bat_as_hndl_lbl1;
;;;1558        	}
;;;1559        else 
;;;1560        	{
;;;1561        	lc640_read_long_ptr(lc640_adr+16,data);
001ba6  4669              MOV      r1,sp
001ba8  f1060010          ADD      r0,r6,#0x10
001bac  f7fffffe          BL       lc640_read_long_ptr
;;;1562        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001bb0  f89d0000          LDRB     r0,[sp,#0]
001bb4  2841              CMP      r0,#0x41
001bb6  d10b              BNE      |L1.7120|
001bb8  f89d0001          LDRB     r0,[sp,#1]
001bbc  2841              CMP      r0,#0x41
001bbe  d107              BNE      |L1.7120|
001bc0  f89d0002          LDRB     r0,[sp,#2]
001bc4  2841              CMP      r0,#0x41
001bc6  d103              BNE      |L1.7120|
001bc8  f89d0003          LDRB     r0,[sp,#3]
001bcc  2841              CMP      r0,#0x41
001bce  d009              BEQ      |L1.7140|
                  |L1.7120|
;;;1563        		{        
;;;1564        		if(event_ptr_find)event_ptr_find--;
001bd0  b11c              CBZ      r4,|L1.7130|
001bd2  f1a40401          SUB      r4,r4,#1
001bd6  b2a4              UXTH     r4,r4
001bd8  e001              B        |L1.7134|
                  |L1.7130|
;;;1565            		else event_ptr_find=63;
001bda  f04f043f          MOV      r4,#0x3f
                  |L1.7134|
;;;1566            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001bde  42bc              CMP      r4,r7
001be0  d1c4              BNE      |L1.7020|
001be2  e050              B        |L1.7302|
                  |L1.7140|
;;;1567        		else goto avar_bat_as_hndl_lbl1;
;;;1568        		}
;;;1569   
;;;1570        	}
;;;1571        		
;;;1572   	data[0]=LPC_RTC->YEAR;
001be4  f8b8003c          LDRH     r0,[r8,#0x3c]
001be8  f88d0000          STRB     r0,[sp,#0]
;;;1573   	data[1]=LPC_RTC->MONTH;
001bec  f8980038          LDRB     r0,[r8,#0x38]
001bf0  f88d0001          STRB     r0,[sp,#1]
;;;1574   	data[2]=LPC_RTC->DOM;
001bf4  f898002c          LDRB     r0,[r8,#0x2c]
001bf8  f88d0002          STRB     r0,[sp,#2]
;;;1575   	data[3]=0;
001bfc  f88da003          STRB     r10,[sp,#3]
;;;1576   	lc640_write_long_ptr(lc640_adr+16,data);
001c00  4669              MOV      r1,sp
001c02  f1060010          ADD      r0,r6,#0x10
001c06  f7fffffe          BL       lc640_write_long_ptr
;;;1577   
;;;1578   	data[0]=LPC_RTC->HOUR;
001c0a  f8980028          LDRB     r0,[r8,#0x28]
001c0e  f88d0000          STRB     r0,[sp,#0]
;;;1579   	data[1]=LPC_RTC->MIN;
001c12  f8980024          LDRB     r0,[r8,#0x24]
001c16  f88d0001          STRB     r0,[sp,#1]
;;;1580   	data[2]=LPC_RTC->SEC;
001c1a  f8980020          LDRB     r0,[r8,#0x20]
001c1e  f88d0002          STRB     r0,[sp,#2]
;;;1581   	data[3]=0;
001c22  f88da003          STRB     r10,[sp,#3]
;;;1582   	lc640_write_long_ptr(lc640_adr+20,data);
001c26  4669              MOV      r1,sp
001c28  f1060014          ADD      r0,r6,#0x14
001c2c  f7fffffe          BL       lc640_write_long_ptr
;;;1583   	
;;;1584   	data[0]='B';
001c30  f88d9000          STRB     r9,[sp,#0]
;;;1585   	data[1]='B';
001c34  f88d9001          STRB     r9,[sp,#1]
;;;1586   	data[2]='B';
001c38  f88d9002          STRB     r9,[sp,#2]
;;;1587   	data[3]='B';
001c3c  f88d9003          STRB     r9,[sp,#3]
;;;1588   	lc640_write_long_ptr(lc640_adr+24,data);
001c40  4669              MOV      r1,sp
001c42  f1060018          ADD      r0,r6,#0x18
001c46  f7fffffe          BL       lc640_write_long_ptr
;;;1589   	
;;;1590   	data[0]='B';
001c4a  f88d9000          STRB     r9,[sp,#0]
;;;1591   	data[1]='B';
001c4e  f88d9001          STRB     r9,[sp,#1]
;;;1592   	data[2]='B';
001c52  f88d9002          STRB     r9,[sp,#2]
;;;1593   	data[3]='B';
001c56  f88d9003          STRB     r9,[sp,#3]
;;;1594   	lc640_write_long_ptr(lc640_adr+28,data);
001c5a  4669              MOV      r1,sp
001c5c  f106001c          ADD      r0,r6,#0x1c
001c60  f7fffffe          BL       lc640_write_long_ptr
;;;1595   	
;;;1596   	if(b==0)
001c64  b115              CBZ      r5,|L1.7276|
;;;1597   		{
;;;1598   		snmp_trap_send("BAT #1 Asymmetry alarm clear",5,1,0);
;;;1599   		}
;;;1600   	else if(b==1)
001c66  2d01              CMP      r5,#1
001c68  d007              BEQ      |L1.7290|
001c6a  e00c              B        |L1.7302|
                  |L1.7276|
001c6c  2300              MOVS     r3,#0                 ;1598
001c6e  2201              MOVS     r2,#1                 ;1598
001c70  2105              MOVS     r1,#5                 ;1598
001c72  a067              ADR      r0,|L1.7696|
001c74  f7fffffe          BL       snmp_trap_send
001c78  e005              B        |L1.7302|
                  |L1.7290|
;;;1601   		{
;;;1602   		snmp_trap_send("BAT #2 Asymmetry alarm clear",5,2,0);
001c7a  2300              MOVS     r3,#0
001c7c  2202              MOVS     r2,#2
001c7e  2105              MOVS     r1,#5
001c80  a06b              ADR      r0,|L1.7728|
001c82  f7fffffe          BL       snmp_trap_send
                  |L1.7302|
;;;1603   		}
;;;1604   	
;;;1605   	}
;;;1606   	
;;;1607   avar_bat_as_hndl_end:
;;;1608   __nop();		
001c86  bf00              NOP      
                  |L1.7304|
;;;1609   }
001c88  e4b2              B        |L1.5616|
;;;1610   
                          ENDP

                  ke_zvu_mem_hndl PROC
;;;1611   //-----------------------------------------------
;;;1612   void ke_zvu_mem_hndl(char b,unsigned short in,unsigned short in1)
001c8a  b5f7              PUSH     {r0-r2,r4-r7,lr}
;;;1613   {
001c8c  b082              SUB      sp,sp,#8
001c8e  4605              MOV      r5,r0
;;;1614   char data[4];
;;;1615   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1616   //unsigned char temp,temp_;
;;;1617   //unsigned int tempUI;
;;;1618   //unsigned long tempUL; 
;;;1619   signed temp_temp;
;;;1620   
;;;1621   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
001c90  eb050045          ADD      r0,r5,r5,LSL #1
001c94  4950              LDR      r1,|L1.7640|
001c96  eb001005          ADD      r0,r0,r5,LSL #4
001c9a  eb010180          ADD      r1,r1,r0,LSL #2
001c9e  486c              LDR      r0,|L1.7760|
001ca0  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
001ca4  f1000001          ADD      r0,r0,#1
001ca8  eb010040          ADD      r0,r1,r0,LSL #1
001cac  f9b00020          LDRSH    r0,[r0,#0x20]
001cb0  9000              STR      r0,[sp,#0]
;;;1622   
;;;1623   event_ptr=lc640_read_int(PTR_EVENT_LOG);
001cb2  f44f6660          MOV      r6,#0xe00
001cb6  4630              MOV      r0,r6
001cb8  f7fffffe          BL       lc640_read_int
;;;1624   event_ptr++;	
001cbc  f1000001          ADD      r0,r0,#1
001cc0  4604              MOV      r4,r0
;;;1625   if(event_ptr>63)event_ptr=0;	
001cc2  2c3f              CMP      r4,#0x3f
001cc4  d901              BLS      |L1.7370|
001cc6  f04f0400          MOV      r4,#0
                  |L1.7370|
;;;1626   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
001cca  b221              SXTH     r1,r4
001ccc  4630              MOV      r0,r6
001cce  f7fffffe          BL       lc640_write_int
;;;1627   	
;;;1628   event_cnt=lc640_read_int(CNT_EVENT_LOG);
001cd2  f6406702          MOV      r7,#0xe02
001cd6  4638              MOV      r0,r7
001cd8  f7fffffe          BL       lc640_read_int
;;;1629   if(event_cnt!=63)event_cnt=event_ptr;
001cdc  283f              CMP      r0,#0x3f
001cde  d000              BEQ      |L1.7394|
001ce0  4620              MOV      r0,r4
                  |L1.7394|
;;;1630   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
001ce2  b201              SXTH     r1,r0
001ce4  4638              MOV      r0,r7
001ce6  f7fffffe          BL       lc640_write_int
;;;1631   	
;;;1632   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
001cea  4630              MOV      r0,r6
001cec  f7fffffe          BL       lc640_read_int
001cf0  f44f6180          MOV      r1,#0x400
001cf4  eb011440          ADD      r4,r1,r0,LSL #5
;;;1633   	
;;;1634   data[0]='B';
001cf8  f04f0042          MOV      r0,#0x42
001cfc  f88d0004          STRB     r0,[sp,#4]
;;;1635   data[1]=b; 
001d00  f88d5005          STRB     r5,[sp,#5]
;;;1636   data[2]='K';
001d04  f04f004b          MOV      r0,#0x4b
001d08  f88d0006          STRB     r0,[sp,#6]
;;;1637   data[3]='Z';
001d0c  f04f005a          MOV      r0,#0x5a
001d10  f88d0007          STRB     r0,[sp,#7]
;;;1638   
;;;1639   lc640_write_long_ptr(lc640_adr,data);
001d14  a901              ADD      r1,sp,#4
001d16  4620              MOV      r0,r4
001d18  f7fffffe          BL       lc640_write_long_ptr
;;;1640   
;;;1641   data[0]=*((char*)&in);
001d1c  f89d000c          LDRB     r0,[sp,#0xc]
001d20  f88d0004          STRB     r0,[sp,#4]
;;;1642   data[1]=*(((char*)(&in))+1);
001d24  f89d000d          LDRB     r0,[sp,#0xd]
001d28  f88d0005          STRB     r0,[sp,#5]
;;;1643   data[2]=*((char*)&temp_temp);
001d2c  f89d0000          LDRB     r0,[sp,#0]
001d30  f88d0006          STRB     r0,[sp,#6]
;;;1644   data[3]=*(((char*)(&temp_temp))+1);
001d34  f89d0001          LDRB     r0,[sp,#1]
001d38  f88d0007          STRB     r0,[sp,#7]
;;;1645   lc640_write_long_ptr(lc640_adr+4,data);
001d3c  a901              ADD      r1,sp,#4
001d3e  e089              B        |L1.7764|
                  |L1.7488|
001d40  42415420          DCB      "BAT #1 Alarm, heating eliminated",0
001d44  23312041
001d48  6c61726d
001d4c  2c206865
001d50  6174696e
001d54  6720656c
001d58  696d696e
001d5c  61746564
001d60  00      
001d61  00                DCB      0
001d62  00                DCB      0
001d63  00                DCB      0
                  |L1.7524|
001d64  42415420          DCB      "BAT #2 Alarm, heating eliminated",0
001d68  23322041
001d6c  6c61726d
001d70  2c206865
001d74  6174696e
001d78  6720656c
001d7c  696d696e
001d80  61746564
001d84  00      
001d85  00                DCB      0
001d86  00                DCB      0
001d87  00                DCB      0
                  |L1.7560|
001d88  42415420          DCB      "BAT #2 Alarm, overheating eliminated",0
001d8c  23322041
001d90  6c61726d
001d94  2c206f76
001d98  65726865
001d9c  6174696e
001da0  6720656c
001da4  696d696e
001da8  61746564
001dac  00      
001dad  00                DCB      0
001dae  00                DCB      0
001daf  00                DCB      0
                  |L1.7600|
001db0  42415420          DCB      "BAT #1 Alarm, overheating eliminated",0
001db4  23312041
001db8  6c61726d
001dbc  2c206f76
001dc0  65726865
001dc4  6174696e
001dc8  6720656c
001dcc  696d696e
001dd0  61746564
001dd4  00      
001dd5  00                DCB      0
001dd6  00                DCB      0
001dd7  00                DCB      0
                  |L1.7640|
                          DCD      bat
                  |L1.7644|
                          DCD      0x40024000
                  |L1.7648|
001de0  42415420          DCB      "BAT #1 Alarm, asymmetry",0
001de4  23312041
001de8  6c61726d
001dec  2c206173
001df0  796d6d65
001df4  74727900
                  |L1.7672|
001df8  42415420          DCB      "BAT #2 Alarm, asymmetry",0
001dfc  23322041
001e00  6c61726d
001e04  2c206173
001e08  796d6d65
001e0c  74727900
                  |L1.7696|
001e10  42415420          DCB      "BAT #1 Asymmetry alarm clear",0
001e14  23312041
001e18  73796d6d
001e1c  65747279
001e20  20616c61
001e24  726d2063
001e28  6c656172
001e2c  00      
001e2d  00                DCB      0
001e2e  00                DCB      0
001e2f  00                DCB      0
                  |L1.7728|
001e30  42415420          DCB      "BAT #2 Asymmetry alarm clear",0
001e34  23322041
001e38  73796d6d
001e3c  65747279
001e40  20616c61
001e44  726d2063
001e48  6c656172
001e4c  00      
001e4d  00                DCB      0
001e4e  00                DCB      0
001e4f  00                DCB      0
                  |L1.7760|
                          DCD      bat_u_old_cnt
                  |L1.7764|
001e54  1d20              ADDS     r0,r4,#4
001e56  f7fffffe          BL       lc640_write_long_ptr
;;;1646   
;;;1647   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
001e5a  f24020a2          MOV      r0,#0x2a2
001e5e  f7fffffe          BL       lc640_read_long
001e62  4dff              LDR      r5,|L1.8800|
001e64  6028              STR      r0,[r5,#0]  ; ke_date
;;;1648   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
001e66  4629              MOV      r1,r5
001e68  f1040008          ADD      r0,r4,#8
001e6c  f7fffffe          BL       lc640_write_long_ptr
;;;1649   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
001e70  f24020a6          MOV      r0,#0x2a6
001e74  f7fffffe          BL       lc640_read_long
001e78  6068              STR      r0,[r5,#4]  ; ke_date
;;;1650   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
001e7a  1d29              ADDS     r1,r5,#4
001e7c  f104000c          ADD      r0,r4,#0xc
001e80  f7fffffe          BL       lc640_write_long_ptr
;;;1651   
;;;1652   data[0]=LPC_RTC->YEAR;
001e84  4df7              LDR      r5,|L1.8804|
001e86  8ba8              LDRH     r0,[r5,#0x1c]
001e88  f88d0004          STRB     r0,[sp,#4]
;;;1653   data[1]=LPC_RTC->MONTH;
001e8c  7e28              LDRB     r0,[r5,#0x18]
001e8e  f88d0005          STRB     r0,[sp,#5]
;;;1654   data[2]=LPC_RTC->DOM;
001e92  7b28              LDRB     r0,[r5,#0xc]
001e94  f88d0006          STRB     r0,[sp,#6]
;;;1655   data[3]=*((char*)&in1);
001e98  f89d0010          LDRB     r0,[sp,#0x10]
001e9c  f88d0007          STRB     r0,[sp,#7]
;;;1656   lc640_write_long_ptr(lc640_adr+16,data);
001ea0  a901              ADD      r1,sp,#4
001ea2  f1040010          ADD      r0,r4,#0x10
001ea6  f7fffffe          BL       lc640_write_long_ptr
;;;1657   
;;;1658   data[0]=LPC_RTC->HOUR;
001eaa  7a28              LDRB     r0,[r5,#8]
001eac  f88d0004          STRB     r0,[sp,#4]
;;;1659   data[1]=LPC_RTC->MIN;
001eb0  7928              LDRB     r0,[r5,#4]
001eb2  f88d0005          STRB     r0,[sp,#5]
;;;1660   data[2]=LPC_RTC->SEC;
001eb6  7828              LDRB     r0,[r5,#0]
001eb8  f88d0006          STRB     r0,[sp,#6]
;;;1661   data[3]=*(((char*)(&in1))+1);
001ebc  f89d0011          LDRB     r0,[sp,#0x11]
001ec0  f88d0007          STRB     r0,[sp,#7]
;;;1662   lc640_write_long_ptr(lc640_adr+20,data);
001ec4  a901              ADD      r1,sp,#4
001ec6  f1040014          ADD      r0,r4,#0x14
001eca  f7fffffe          BL       lc640_write_long_ptr
;;;1663    
;;;1664   }
001ece  b005              ADD      sp,sp,#0x14
001ed0  bdf0              POP      {r4-r7,pc}
;;;1665   
                          ENDP

                  vz_mem_hndl PROC
;;;1722   //-----------------------------------------------
;;;1723   void vz_mem_hndl(unsigned short in)
001ed2  e92d4ff8          PUSH     {r3-r11,lr}
;;;1724   {
;;;1725   char data[4];
;;;1726   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001ed6  f04f0600          MOV      r6,#0
001eda  4634              MOV      r4,r6
;;;1727   //char avar_simbol;
;;;1728   
;;;1729   if(in==1)
;;;1730   	{
;;;1731   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1732   	event_ptr++;	
;;;1733   	if(event_ptr>63)event_ptr=0;	
;;;1734   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1735   	
;;;1736        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1737   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1738   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1739   	
;;;1740   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1741   	
;;;1742   	data[0]='B';
;;;1743   	data[1]=0; 
;;;1744   	data[2]='Z';
;;;1745   	data[3]=0;
;;;1746   	lc640_write_long_ptr(lc640_adr,data);
;;;1747   
;;;1748   	data[0]=0;
;;;1749   	data[1]=0;
;;;1750   	data[2]=0;
;;;1751   	data[3]=0;
;;;1752   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1753   
;;;1754   	data[0]=LPC_RTC->YEAR;
001edc  f8df8388          LDR      r8,|L1.8808|
001ee0  46a1              MOV      r9,r4                 ;1726
001ee2  f04f0742          MOV      r7,#0x42              ;1742
001ee6  f44f6a80          MOV      r10,#0x400            ;1740
001eea  2801              CMP      r0,#1                 ;1729
001eec  d002              BEQ      |L1.7924|
;;;1755   	data[1]=LPC_RTC->MONTH;
;;;1756   	data[2]=LPC_RTC->DOM;
;;;1757   	data[3]=0;
;;;1758   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1759   
;;;1760   	data[0]=LPC_RTC->HOUR;
;;;1761   	data[1]=LPC_RTC->MIN;
;;;1762   	data[2]=LPC_RTC->SEC;
;;;1763   	data[3]=0;
;;;1764   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1765   	
;;;1766   	data[0]='A';
;;;1767   	data[1]='A';
;;;1768   	data[2]='A';
;;;1769   	data[3]='A';
;;;1770   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1771   	
;;;1772   	data[0]='A';
;;;1773   	data[1]='A';
;;;1774   	data[2]='A';
;;;1775   	data[3]='A';
;;;1776   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1777   	
;;;1778   	data[0]='A';
;;;1779   	data[1]='A';
;;;1780   	data[2]='A';
;;;1781   	data[3]='A';
;;;1782   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1783   	
;;;1784   	data[0]='A';
;;;1785   	data[1]='A';
;;;1786   	data[2]='A';
;;;1787   	data[3]='A';
;;;1788   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1789    	
;;;1790   	}
;;;1791   
;;;1792   else if(in==0)
001eee  2800              CMP      r0,#0
001ef0  d07e              BEQ      |L1.8176|
001ef2  e108              B        |L1.8454|
                  |L1.7924|
001ef4  f44f6560          MOV      r5,#0xe00             ;1731
001ef8  4628              MOV      r0,r5                 ;1731
001efa  f7fffffe          BL       lc640_read_int
001efe  f1000001          ADD      r0,r0,#1              ;1732
001f02  4604              MOV      r4,r0                 ;1732
001f04  2c3f              CMP      r4,#0x3f              ;1733
001f06  d901              BLS      |L1.7948|
001f08  f04f0400          MOV      r4,#0                 ;1733
                  |L1.7948|
001f0c  b221              SXTH     r1,r4                 ;1734
001f0e  4628              MOV      r0,r5                 ;1734
001f10  f7fffffe          BL       lc640_write_int
001f14  f6406602          MOV      r6,#0xe02             ;1736
001f18  4630              MOV      r0,r6                 ;1736
001f1a  f7fffffe          BL       lc640_read_int
001f1e  283f              CMP      r0,#0x3f              ;1737
001f20  d000              BEQ      |L1.7972|
001f22  4620              MOV      r0,r4                 ;1737
                  |L1.7972|
001f24  b201              SXTH     r1,r0                 ;1738
001f26  4630              MOV      r0,r6                 ;1738
001f28  f7fffffe          BL       lc640_write_int
001f2c  4628              MOV      r0,r5                 ;1740
001f2e  f7fffffe          BL       lc640_read_int
001f32  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1740
001f36  f88d7000          STRB     r7,[sp,#0]            ;1742
001f3a  f88d9001          STRB     r9,[sp,#1]            ;1743
001f3e  f04f005a          MOV      r0,#0x5a              ;1744
001f42  f88d0002          STRB     r0,[sp,#2]            ;1744
001f46  f88d9003          STRB     r9,[sp,#3]            ;1745
001f4a  4669              MOV      r1,sp                 ;1746
001f4c  4620              MOV      r0,r4                 ;1746
001f4e  f7fffffe          BL       lc640_write_long_ptr
001f52  f8cd9000          STR      r9,[sp,#0]            ;1751
001f56  4669              MOV      r1,sp                 ;1752
001f58  1d20              ADDS     r0,r4,#4              ;1752
001f5a  f7fffffe          BL       lc640_write_long_ptr
001f5e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1754
001f62  f88d0000          STRB     r0,[sp,#0]            ;1754
001f66  f8980038          LDRB     r0,[r8,#0x38]         ;1755
001f6a  f88d0001          STRB     r0,[sp,#1]            ;1755
001f6e  f898002c          LDRB     r0,[r8,#0x2c]         ;1756
001f72  f88d0002          STRB     r0,[sp,#2]            ;1756
001f76  f88d9003          STRB     r9,[sp,#3]            ;1757
001f7a  4669              MOV      r1,sp                 ;1758
001f7c  f1040008          ADD      r0,r4,#8              ;1758
001f80  f7fffffe          BL       lc640_write_long_ptr
001f84  f8980028          LDRB     r0,[r8,#0x28]         ;1760
001f88  f88d0000          STRB     r0,[sp,#0]            ;1760
001f8c  f8980024          LDRB     r0,[r8,#0x24]         ;1761
001f90  f88d0001          STRB     r0,[sp,#1]            ;1761
001f94  f8980020          LDRB     r0,[r8,#0x20]         ;1762
001f98  f88d0002          STRB     r0,[sp,#2]            ;1762
001f9c  f88d9003          STRB     r9,[sp,#3]            ;1763
001fa0  4669              MOV      r1,sp                 ;1764
001fa2  f104000c          ADD      r0,r4,#0xc            ;1764
001fa6  f7fffffe          BL       lc640_write_long_ptr
001faa  f04f0541          MOV      r5,#0x41              ;1766
001fae  f88d5000          STRB     r5,[sp,#0]            ;1766
001fb2  f88d5001          STRB     r5,[sp,#1]            ;1767
001fb6  f88d5002          STRB     r5,[sp,#2]            ;1768
001fba  f88d5003          STRB     r5,[sp,#3]            ;1769
001fbe  4669              MOV      r1,sp                 ;1770
001fc0  f1040010          ADD      r0,r4,#0x10           ;1770
001fc4  f7fffffe          BL       lc640_write_long_ptr
001fc8  f88d5000          STRB     r5,[sp,#0]            ;1772
001fcc  f88d5001          STRB     r5,[sp,#1]            ;1773
001fd0  f88d5002          STRB     r5,[sp,#2]            ;1774
001fd4  f88d5003          STRB     r5,[sp,#3]            ;1775
001fd8  4669              MOV      r1,sp                 ;1776
001fda  f1040014          ADD      r0,r4,#0x14           ;1776
001fde  f7fffffe          BL       lc640_write_long_ptr
001fe2  f88d5000          STRB     r5,[sp,#0]            ;1778
001fe6  f88d5001          STRB     r5,[sp,#1]            ;1779
001fea  f88d5002          STRB     r5,[sp,#2]            ;1780
001fee  e000              B        |L1.8178|
                  |L1.8176|
001ff0  e014              B        |L1.8220|
                  |L1.8178|
001ff2  f88d5003          STRB     r5,[sp,#3]            ;1781
001ff6  4669              MOV      r1,sp                 ;1782
001ff8  f1040018          ADD      r0,r4,#0x18           ;1782
001ffc  f7fffffe          BL       lc640_write_long_ptr
002000  f88d5000          STRB     r5,[sp,#0]            ;1784
002004  f88d5001          STRB     r5,[sp,#1]            ;1785
002008  f88d5002          STRB     r5,[sp,#2]            ;1786
00200c  f88d5003          STRB     r5,[sp,#3]            ;1787
002010  4669              MOV      r1,sp                 ;1788
002012  f104001c          ADD      r0,r4,#0x1c           ;1788
002016  f7fffffe          BL       lc640_write_long_ptr
00201a  e074              B        |L1.8454|
                  |L1.8220|
;;;1793   	{      
;;;1794        
;;;1795   vz_mem_hndl_lbl1: 
;;;1796   
;;;1797   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
00201c  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1798   
;;;1799        lc640_read_long_ptr(lc640_adr,data);
002020  4669              MOV      r1,sp
002022  4628              MOV      r0,r5
002024  f7fffffe          BL       lc640_read_long_ptr
;;;1800        
;;;1801        if(!((data[0]=='B')&&(data[2]=='Z')))
002028  f89d0000          LDRB     r0,[sp,#0]
00202c  2842              CMP      r0,#0x42
00202e  d103              BNE      |L1.8248|
002030  f89d0002          LDRB     r0,[sp,#2]
002034  285a              CMP      r0,#0x5a
002036  d008              BEQ      |L1.8266|
                  |L1.8248|
;;;1802        	{        
;;;1803        	if(event_ptr_find)event_ptr_find--;
002038  b114              CBZ      r4,|L1.8256|
00203a  f1a40401          SUB      r4,r4,#1
00203e  e001              B        |L1.8260|
                  |L1.8256|
;;;1804        	else event_ptr_find=63;
002040  f04f043f          MOV      r4,#0x3f
                  |L1.8260|
;;;1805        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
002044  42b4              CMP      r4,r6
002046  d1e9              BNE      |L1.8220|
002048  e05d              B        |L1.8454|
                  |L1.8266|
;;;1806        	else goto vz_mem_hndl_lbl1;
;;;1807        	}
;;;1808        else 
;;;1809        	{
;;;1810        	lc640_read_long_ptr(lc640_adr+16,data);
00204a  4669              MOV      r1,sp
00204c  f1050010          ADD      r0,r5,#0x10
002050  f7fffffe          BL       lc640_read_long_ptr
;;;1811        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
002054  f89d0000          LDRB     r0,[sp,#0]
002058  2841              CMP      r0,#0x41
00205a  d10b              BNE      |L1.8308|
00205c  f89d0001          LDRB     r0,[sp,#1]
002060  2841              CMP      r0,#0x41
002062  d107              BNE      |L1.8308|
002064  f89d0002          LDRB     r0,[sp,#2]
002068  2841              CMP      r0,#0x41
00206a  d103              BNE      |L1.8308|
00206c  f89d0003          LDRB     r0,[sp,#3]
002070  2841              CMP      r0,#0x41
002072  d008              BEQ      |L1.8326|
                  |L1.8308|
;;;1812        		{        
;;;1813        		if(event_ptr_find)event_ptr_find--;
002074  b114              CBZ      r4,|L1.8316|
002076  f1a40401          SUB      r4,r4,#1
00207a  e001              B        |L1.8320|
                  |L1.8316|
;;;1814            		else event_ptr_find=63;
00207c  f04f043f          MOV      r4,#0x3f
                  |L1.8320|
;;;1815            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
002080  42b4              CMP      r4,r6
002082  d1cb              BNE      |L1.8220|
002084  e03f              B        |L1.8454|
                  |L1.8326|
;;;1816        		else goto vz_mem_hndl_lbl1;
;;;1817        		}
;;;1818   
;;;1819        	}	
;;;1820   
;;;1821   
;;;1822   	
;;;1823   	data[0]=LPC_RTC->YEAR;
002086  f8b8003c          LDRH     r0,[r8,#0x3c]
00208a  f88d0000          STRB     r0,[sp,#0]
;;;1824   	data[1]=LPC_RTC->MONTH;
00208e  f8980038          LDRB     r0,[r8,#0x38]
002092  f88d0001          STRB     r0,[sp,#1]
;;;1825   	data[2]=LPC_RTC->DOM;
002096  f898002c          LDRB     r0,[r8,#0x2c]
00209a  f88d0002          STRB     r0,[sp,#2]
;;;1826   	data[3]=0;
00209e  f88d9003          STRB     r9,[sp,#3]
;;;1827   	lc640_write_long_ptr(lc640_adr+16,data);
0020a2  4669              MOV      r1,sp
0020a4  f1050010          ADD      r0,r5,#0x10
0020a8  f7fffffe          BL       lc640_write_long_ptr
;;;1828   
;;;1829   	data[0]=LPC_RTC->HOUR;
0020ac  f8980028          LDRB     r0,[r8,#0x28]
0020b0  f88d0000          STRB     r0,[sp,#0]
;;;1830   	data[1]=LPC_RTC->MIN;
0020b4  f8980024          LDRB     r0,[r8,#0x24]
0020b8  f88d0001          STRB     r0,[sp,#1]
;;;1831   	data[2]=LPC_RTC->SEC;
0020bc  f8980020          LDRB     r0,[r8,#0x20]
0020c0  f88d0002          STRB     r0,[sp,#2]
;;;1832   	data[3]=0;
0020c4  f88d9003          STRB     r9,[sp,#3]
;;;1833   	lc640_write_long_ptr(lc640_adr+20,data);
0020c8  4669              MOV      r1,sp
0020ca  f1050014          ADD      r0,r5,#0x14
0020ce  f7fffffe          BL       lc640_write_long_ptr
;;;1834   	
;;;1835   	data[0]='B';
0020d2  f88d7000          STRB     r7,[sp,#0]
;;;1836   	data[1]='B';
0020d6  f88d7001          STRB     r7,[sp,#1]
;;;1837   	data[2]='B';
0020da  f88d7002          STRB     r7,[sp,#2]
;;;1838   	data[3]='B';
0020de  f88d7003          STRB     r7,[sp,#3]
;;;1839   	lc640_write_long_ptr(lc640_adr+24,data);
0020e2  4669              MOV      r1,sp
0020e4  f1050018          ADD      r0,r5,#0x18
0020e8  f7fffffe          BL       lc640_write_long_ptr
;;;1840   	
;;;1841   	data[0]='B';
0020ec  f88d7000          STRB     r7,[sp,#0]
;;;1842   	data[1]='B';
0020f0  f88d7001          STRB     r7,[sp,#1]
;;;1843   	data[2]='B';
0020f4  f88d7002          STRB     r7,[sp,#2]
;;;1844   	data[3]='B';
0020f8  f88d7003          STRB     r7,[sp,#3]
;;;1845   	lc640_write_long_ptr(lc640_adr+28,data);
0020fc  4669              MOV      r1,sp
0020fe  f105001c          ADD      r0,r5,#0x1c
002102  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8454|
;;;1846   	
;;;1847   	}
;;;1848   
;;;1849   vz_mem_hndl_end:
;;;1850   __nop(); 
002106  bf00              NOP      
                  |L1.8456|
;;;1851   
;;;1852   }
002108  e45b              B        |L1.6594|
;;;1853   
                          ENDP

                  speedz_mem_hndl PROC
;;;1854   //-----------------------------------------------
;;;1855   void speedz_mem_hndl(unsigned short in)	 //    (1-, 5- , 0- , 10- )
00210a  e92d4ff8          PUSH     {r3-r11,lr}
;;;1856   {
00210e  4605              MOV      r5,r0
;;;1857   char data[4];
;;;1858   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
002110  f04f0600          MOV      r6,#0
002114  4634              MOV      r4,r6
;;;1859   //char avar_simbol;
;;;1860   
;;;1861   if((in==1)||(in==5)) //  
;;;1862   	{
;;;1863   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1864   	event_ptr++;	
;;;1865   	if(event_ptr>63)event_ptr=0;	
;;;1866   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1867   	
;;;1868       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1869   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1870   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1871   	
;;;1872   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1873   	
;;;1874   	data[0]='s';
;;;1875   	data[1]=0;
;;;1876   	if(in==5)data[1]='a'; 
;;;1877   	data[2]='Z';
;;;1878   	data[3]=0;
;;;1879   	lc640_write_long_ptr(lc640_adr,data);
;;;1880   
;;;1881   	data[0]=0;
;;;1882   	data[1]=0;
;;;1883   	data[2]=0;
;;;1884   	data[3]=0;
;;;1885   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1886   
;;;1887   	data[0]=LPC_RTC->YEAR;
002116  f8df8150          LDR      r8,|L1.8808|
00211a  46a1              MOV      r9,r4                 ;1858
00211c  f44f6a80          MOV      r10,#0x400            ;1872
002120  2d01              CMP      r5,#1                 ;1861
002122  d012              BEQ      |L1.8522|
002124  2d05              CMP      r5,#5                 ;1861
002126  d010              BEQ      |L1.8522|
;;;1888   	data[1]=LPC_RTC->MONTH;
;;;1889   	data[2]=LPC_RTC->DOM;
;;;1890   	data[3]=0;
;;;1891   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1892   
;;;1893   	data[0]=LPC_RTC->HOUR;
;;;1894   	data[1]=LPC_RTC->MIN;
;;;1895   	data[2]=LPC_RTC->SEC;
;;;1896   	data[3]=0;
;;;1897   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1898   	
;;;1899   	data[0]='A';
;;;1900   	data[1]='A';
;;;1901   	data[2]='A';
;;;1902   	data[3]='A';
;;;1903   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1904   	
;;;1905   	data[0]='A';
;;;1906   	data[1]='A';
;;;1907   	data[2]='A';
;;;1908   	data[3]='A';
;;;1909   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1910   	
;;;1911   	data[0]='A';
;;;1912   	data[1]='A';
;;;1913   	data[2]='A';
;;;1914   	data[3]='A';
;;;1915   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1916   	
;;;1917   	data[0]='A';
;;;1918   	data[1]='A';
;;;1919   	data[2]='A';
;;;1920   	data[3]='A';
;;;1921   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1922    	
;;;1923   	}
;;;1924   
;;;1925   else if(in==0)	// 
002128  2d00              CMP      r5,#0
00212a  d07d              BEQ      |L1.8744|
;;;1926   	{      
;;;1927   	char i;     
;;;1928   	event_ptr_find=0;
;;;1929   	for (i=0;i<63;i++)
;;;1930   		{
;;;1931   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1932   
;;;1933        	lc640_read_long_ptr(lc640_adr,data);
;;;1934        
;;;1935        	if(!((data[0]=='s')&&(data[2]=='Z')))
;;;1936        		{        
;;;1937        		if(event_ptr_find)event_ptr_find--;
;;;1938        		else event_ptr_find=63;
;;;1939        		if(event_ptr_find==event_ptr)
;;;1940   				{
;;;1941   				lc640_adr=0;
;;;1942   				break;
;;;1943   				}
;;;1944        		else continue;
;;;1945        		}
;;;1946        	else 
;;;1947        		{
;;;1948        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1949        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1950        			{        
;;;1951        			if(event_ptr_find)event_ptr_find--;
;;;1952            		else event_ptr_find=63;
;;;1953            		if(event_ptr_find==event_ptr)
;;;1954   					{
;;;1955   					lc640_adr=0;
;;;1956   					break;
;;;1957   					}
;;;1958        			else continue;
;;;1959        			}
;;;1960        		}	
;;;1961   		}
;;;1962   	if(lc640_adr!=0)
;;;1963   		{
;;;1964   		data[0]=LPC_RTC->YEAR;
;;;1965   		data[1]=LPC_RTC->MONTH;
;;;1966   		data[2]=LPC_RTC->DOM;
;;;1967   		data[3]=0;
;;;1968   		lc640_write_long_ptr(lc640_adr+16,data);
;;;1969   	
;;;1970   		data[0]=LPC_RTC->HOUR;
;;;1971   		data[1]=LPC_RTC->MIN;
;;;1972   		data[2]=LPC_RTC->SEC;
;;;1973   		data[3]=0;
;;;1974   		lc640_write_long_ptr(lc640_adr+20,data);
;;;1975   		
;;;1976   		data[0]='C';
;;;1977   		data[1]='C';
;;;1978   		data[2]='C';
;;;1979   		data[3]='C';
;;;1980   		lc640_write_long_ptr(lc640_adr+24,data);
;;;1981   		
;;;1982   		data[0]='C';
;;;1983   		data[1]='C';
;;;1984   		data[2]='C';
;;;1985   		data[3]='C';
;;;1986   		lc640_write_long_ptr(lc640_adr+28,data);
;;;1987   		}
;;;1988   	}
;;;1989   else if(in==10) 	//  
00212c  2d0a              CMP      r5,#0xa
00212e  d17c              BNE      |L1.8746|
;;;1990   	{      
;;;1991   	char i;     
;;;1992   
;;;1993   	event_ptr_find=0;
;;;1994   	for (i=0;i<63;i++)
002130  f04f0700          MOV      r7,#0
                  |L1.8500|
;;;1995   		{
;;;1996   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
002134  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1997   
;;;1998        	lc640_read_long_ptr(lc640_adr,data);
002138  4669              MOV      r1,sp
00213a  4628              MOV      r0,r5
00213c  f7fffffe          BL       lc640_read_long_ptr
;;;1999        
;;;2000        	if(!((data[0]=='s')&&(data[2]=='Z')))
002140  f89d0000          LDRB     r0,[sp,#0]
002144  2873              CMP      r0,#0x73
002146  d171              BNE      |L1.8748|
002148  e12a              B        |L1.9120|
                  |L1.8522|
00214a  f44f6660          MOV      r6,#0xe00             ;1863
00214e  4630              MOV      r0,r6                 ;1863
002150  f7fffffe          BL       lc640_read_int
002154  f1000001          ADD      r0,r0,#1              ;1864
002158  4604              MOV      r4,r0                 ;1864
00215a  2c3f              CMP      r4,#0x3f              ;1865
00215c  d901              BLS      |L1.8546|
00215e  f04f0400          MOV      r4,#0                 ;1865
                  |L1.8546|
002162  b221              SXTH     r1,r4                 ;1866
002164  4630              MOV      r0,r6                 ;1866
002166  f7fffffe          BL       lc640_write_int
00216a  f6406702          MOV      r7,#0xe02             ;1868
00216e  4638              MOV      r0,r7                 ;1868
002170  f7fffffe          BL       lc640_read_int
002174  283f              CMP      r0,#0x3f              ;1869
002176  d000              BEQ      |L1.8570|
002178  4620              MOV      r0,r4                 ;1869
                  |L1.8570|
00217a  b201              SXTH     r1,r0                 ;1870
00217c  4638              MOV      r0,r7                 ;1870
00217e  f7fffffe          BL       lc640_write_int
002182  4630              MOV      r0,r6                 ;1872
002184  f7fffffe          BL       lc640_read_int
002188  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1872
00218c  f04f0073          MOV      r0,#0x73              ;1874
002190  f88d0000          STRB     r0,[sp,#0]            ;1874
002194  f88d9001          STRB     r9,[sp,#1]            ;1875
002198  2d05              CMP      r5,#5                 ;1876
00219a  d103              BNE      |L1.8612|
00219c  f04f0061          MOV      r0,#0x61              ;1876
0021a0  f88d0001          STRB     r0,[sp,#1]            ;1876
                  |L1.8612|
0021a4  f04f005a          MOV      r0,#0x5a              ;1877
0021a8  f88d0002          STRB     r0,[sp,#2]            ;1877
0021ac  f88d9003          STRB     r9,[sp,#3]            ;1878
0021b0  4669              MOV      r1,sp                 ;1879
0021b2  4620              MOV      r0,r4                 ;1879
0021b4  f7fffffe          BL       lc640_write_long_ptr
0021b8  f8cd9000          STR      r9,[sp,#0]            ;1884
0021bc  4669              MOV      r1,sp                 ;1885
0021be  1d20              ADDS     r0,r4,#4              ;1885
0021c0  f7fffffe          BL       lc640_write_long_ptr
0021c4  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1887
0021c8  f88d0000          STRB     r0,[sp,#0]            ;1887
0021cc  f8980038          LDRB     r0,[r8,#0x38]         ;1888
0021d0  f88d0001          STRB     r0,[sp,#1]            ;1888
0021d4  f898002c          LDRB     r0,[r8,#0x2c]         ;1889
0021d8  f88d0002          STRB     r0,[sp,#2]            ;1889
0021dc  f88d9003          STRB     r9,[sp,#3]            ;1890
0021e0  4669              MOV      r1,sp                 ;1891
0021e2  f1040008          ADD      r0,r4,#8              ;1891
0021e6  f7fffffe          BL       lc640_write_long_ptr
0021ea  f8980028          LDRB     r0,[r8,#0x28]         ;1893
0021ee  f88d0000          STRB     r0,[sp,#0]            ;1893
0021f2  f8980024          LDRB     r0,[r8,#0x24]         ;1894
0021f6  f88d0001          STRB     r0,[sp,#1]            ;1894
0021fa  f8980020          LDRB     r0,[r8,#0x20]         ;1895
0021fe  f88d0002          STRB     r0,[sp,#2]            ;1895
002202  f88d9003          STRB     r9,[sp,#3]            ;1896
002206  4669              MOV      r1,sp                 ;1897
002208  f104000c          ADD      r0,r4,#0xc            ;1897
00220c  f7fffffe          BL       lc640_write_long_ptr
002210  f04f0541          MOV      r5,#0x41              ;1899
002214  f88d5000          STRB     r5,[sp,#0]            ;1899
002218  f88d5001          STRB     r5,[sp,#1]            ;1900
00221c  f88d5002          STRB     r5,[sp,#2]            ;1901
002220  f88d5003          STRB     r5,[sp,#3]            ;1902
002224  4669              MOV      r1,sp                 ;1903
002226  e002              B        |L1.8750|
                  |L1.8744|
002228  e035              B        |L1.8854|
                  |L1.8746|
00222a  e033              B        |L1.8852|
                  |L1.8748|
00222c  e0bc              B        |L1.9128|
                  |L1.8750|
00222e  f1040010          ADD      r0,r4,#0x10           ;1903
002232  f7fffffe          BL       lc640_write_long_ptr
002236  f88d5000          STRB     r5,[sp,#0]            ;1905
00223a  f88d5001          STRB     r5,[sp,#1]            ;1906
00223e  f88d5002          STRB     r5,[sp,#2]            ;1907
002242  f88d5003          STRB     r5,[sp,#3]            ;1908
002246  4669              MOV      r1,sp                 ;1909
002248  f1040014          ADD      r0,r4,#0x14           ;1909
00224c  f7fffffe          BL       lc640_write_long_ptr
002250  f88d5000          STRB     r5,[sp,#0]            ;1911
002254  f88d5001          STRB     r5,[sp,#1]            ;1912
002258  f88d5002          STRB     r5,[sp,#2]            ;1913
00225c  e006              B        |L1.8812|
00225e  0000              DCW      0x0000
                  |L1.8800|
                          DCD      ke_date
                  |L1.8804|
                          DCD      0x40024020
                  |L1.8808|
                          DCD      0x40024000
                  |L1.8812|
00226c  f88d5003          STRB     r5,[sp,#3]            ;1914
002270  4669              MOV      r1,sp                 ;1915
002272  f1040018          ADD      r0,r4,#0x18           ;1915
002276  f7fffffe          BL       lc640_write_long_ptr
00227a  f88d5000          STRB     r5,[sp,#0]            ;1917
00227e  f88d5001          STRB     r5,[sp,#1]            ;1918
002282  f88d5002          STRB     r5,[sp,#2]            ;1919
002286  f88d5003          STRB     r5,[sp,#3]            ;1920
00228a  4669              MOV      r1,sp                 ;1921
00228c  f104001c          ADD      r0,r4,#0x1c           ;1921
002290  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8852|
;;;2001        		{        
;;;2002        		if(event_ptr_find)event_ptr_find--;
;;;2003        		else event_ptr_find=63;
;;;2004        		if(event_ptr_find==event_ptr)
;;;2005   				{
;;;2006   				lc640_adr=0;
;;;2007   				break;
;;;2008   				}
;;;2009        		else continue;
;;;2010        		}
;;;2011        	else 
;;;2012        		{
;;;2013        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2014        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2015        			{        
;;;2016        			if(event_ptr_find)event_ptr_find--;
;;;2017            		else event_ptr_find=63;
;;;2018            		if(event_ptr_find==event_ptr)
;;;2019   					{
;;;2020   					lc640_adr=0;
;;;2021   					break;
;;;2022   					}
;;;2023        			else continue;
;;;2024        			}
;;;2025        		}	
;;;2026   		}
;;;2027   	if(lc640_adr!=0)
;;;2028   		{
;;;2029   		data[0]=LPC_RTC->YEAR;
;;;2030   		data[1]=LPC_RTC->MONTH;
;;;2031   		data[2]=LPC_RTC->DOM;
;;;2032   		data[3]=0;
;;;2033   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2034   	
;;;2035   		data[0]=LPC_RTC->HOUR;
;;;2036   		data[1]=LPC_RTC->MIN;
;;;2037   		data[2]=LPC_RTC->SEC;
;;;2038   		data[3]=0;
;;;2039   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2040   		
;;;2041   		data[0]='B';
;;;2042   		data[1]='B';
;;;2043   		data[2]='B';
;;;2044   		data[3]='B';
;;;2045   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2046   		
;;;2047   		data[0]='B';
;;;2048   		data[1]='B';
;;;2049   		data[2]='B';
;;;2050   		data[3]='B';
;;;2051   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2052   		}
;;;2053   	}
;;;2054   }
002294  e4f8              B        |L1.7304|
                  |L1.8854|
002296  f04f0700          MOV      r7,#0                 ;1929
                  |L1.8858|
00229a  eb0a1544          ADD      r5,r10,r4,LSL #5      ;1931
00229e  4669              MOV      r1,sp                 ;1933
0022a0  4628              MOV      r0,r5                 ;1933
0022a2  f7fffffe          BL       lc640_read_long_ptr
0022a6  f89d0000          LDRB     r0,[sp,#0]            ;1935
0022aa  2873              CMP      r0,#0x73              ;1935
0022ac  d103              BNE      |L1.8886|
0022ae  f89d0002          LDRB     r0,[sp,#2]            ;1935
0022b2  285a              CMP      r0,#0x5a              ;1935
0022b4  d00a              BEQ      |L1.8908|
                  |L1.8886|
0022b6  b114              CBZ      r4,|L1.8894|
0022b8  f1a40401          SUB      r4,r4,#1              ;1937
0022bc  e001              B        |L1.8898|
                  |L1.8894|
0022be  f04f043f          MOV      r4,#0x3f              ;1938
                  |L1.8898|
0022c2  42b4              CMP      r4,r6                 ;1939
0022c4  d122              BNE      |L1.8972|
0022c6  f04f0500          MOV      r5,#0                 ;1941
0022ca  e024              B        |L1.8982|
                  |L1.8908|
0022cc  4669              MOV      r1,sp                 ;1948
0022ce  f1050010          ADD      r0,r5,#0x10           ;1948
0022d2  f7fffffe          BL       lc640_read_long_ptr
0022d6  f89d0000          LDRB     r0,[sp,#0]            ;1949
0022da  2841              CMP      r0,#0x41              ;1949
0022dc  d10b              BNE      |L1.8950|
0022de  f89d0001          LDRB     r0,[sp,#1]            ;1949
0022e2  2841              CMP      r0,#0x41              ;1949
0022e4  d107              BNE      |L1.8950|
0022e6  f89d0002          LDRB     r0,[sp,#2]            ;1949
0022ea  2841              CMP      r0,#0x41              ;1949
0022ec  d103              BNE      |L1.8950|
0022ee  f89d0003          LDRB     r0,[sp,#3]            ;1949
0022f2  2841              CMP      r0,#0x41              ;1949
0022f4  d00a              BEQ      |L1.8972|
                  |L1.8950|
0022f6  b114              CBZ      r4,|L1.8958|
0022f8  f1a40401          SUB      r4,r4,#1              ;1951
0022fc  e001              B        |L1.8962|
                  |L1.8958|
0022fe  f04f043f          MOV      r4,#0x3f              ;1952
                  |L1.8962|
002302  42b4              CMP      r4,r6                 ;1953
002304  d102              BNE      |L1.8972|
002306  f04f0500          MOV      r5,#0                 ;1955
00230a  e004              B        |L1.8982|
                  |L1.8972|
00230c  f1070701          ADD      r7,r7,#1              ;1929
002310  b2ff              UXTB     r7,r7                 ;1929
002312  2f3f              CMP      r7,#0x3f              ;1929
002314  d3c1              BCC      |L1.8858|
                  |L1.8982|
002316  2d00              CMP      r5,#0                 ;1962
002318  d0bc              BEQ      |L1.8852|
00231a  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1964
00231e  f88d0000          STRB     r0,[sp,#0]            ;1964
002322  f8980038          LDRB     r0,[r8,#0x38]         ;1965
002326  f88d0001          STRB     r0,[sp,#1]            ;1965
00232a  f898002c          LDRB     r0,[r8,#0x2c]         ;1966
00232e  f88d0002          STRB     r0,[sp,#2]            ;1966
002332  f88d9003          STRB     r9,[sp,#3]            ;1967
002336  4669              MOV      r1,sp                 ;1968
002338  f1050010          ADD      r0,r5,#0x10           ;1968
00233c  f7fffffe          BL       lc640_write_long_ptr
002340  f8980028          LDRB     r0,[r8,#0x28]         ;1970
002344  f88d0000          STRB     r0,[sp,#0]            ;1970
002348  f8980024          LDRB     r0,[r8,#0x24]         ;1971
00234c  f88d0001          STRB     r0,[sp,#1]            ;1971
002350  f8980020          LDRB     r0,[r8,#0x20]         ;1972
002354  f88d0002          STRB     r0,[sp,#2]            ;1972
002358  f88d9003          STRB     r9,[sp,#3]            ;1973
00235c  4669              MOV      r1,sp                 ;1974
00235e  f1050014          ADD      r0,r5,#0x14           ;1974
002362  f7fffffe          BL       lc640_write_long_ptr
002366  f04f0443          MOV      r4,#0x43              ;1976
00236a  f88d4000          STRB     r4,[sp,#0]            ;1976
00236e  f88d4001          STRB     r4,[sp,#1]            ;1977
002372  f88d4002          STRB     r4,[sp,#2]            ;1978
002376  f88d4003          STRB     r4,[sp,#3]            ;1979
00237a  4669              MOV      r1,sp                 ;1980
00237c  f1050018          ADD      r0,r5,#0x18           ;1980
002380  f7fffffe          BL       lc640_write_long_ptr
002384  f88d4000          STRB     r4,[sp,#0]            ;1982
002388  f88d4001          STRB     r4,[sp,#1]            ;1983
00238c  f88d4002          STRB     r4,[sp,#2]            ;1984
002390  f88d4003          STRB     r4,[sp,#3]            ;1985
002394  4669              MOV      r1,sp                 ;1986
002396  f105001c          ADD      r0,r5,#0x1c           ;1986
00239a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9118|
00239e  e473              B        |L1.7304|
                  |L1.9120|
0023a0  f89d0002          LDRB     r0,[sp,#2]            ;2000
0023a4  285a              CMP      r0,#0x5a              ;2000
0023a6  d00a              BEQ      |L1.9150|
                  |L1.9128|
0023a8  b114              CBZ      r4,|L1.9136|
0023aa  f1a40401          SUB      r4,r4,#1              ;2002
0023ae  e001              B        |L1.9140|
                  |L1.9136|
0023b0  f04f043f          MOV      r4,#0x3f              ;2003
                  |L1.9140|
0023b4  42b4              CMP      r4,r6                 ;2004
0023b6  d122              BNE      |L1.9214|
0023b8  f04f0500          MOV      r5,#0                 ;2006
0023bc  e025              B        |L1.9226|
                  |L1.9150|
0023be  4669              MOV      r1,sp                 ;2013
0023c0  f1050010          ADD      r0,r5,#0x10           ;2013
0023c4  f7fffffe          BL       lc640_read_long_ptr
0023c8  f89d0000          LDRB     r0,[sp,#0]            ;2014
0023cc  2841              CMP      r0,#0x41              ;2014
0023ce  d10b              BNE      |L1.9192|
0023d0  f89d0001          LDRB     r0,[sp,#1]            ;2014
0023d4  2841              CMP      r0,#0x41              ;2014
0023d6  d107              BNE      |L1.9192|
0023d8  f89d0002          LDRB     r0,[sp,#2]            ;2014
0023dc  2841              CMP      r0,#0x41              ;2014
0023de  d103              BNE      |L1.9192|
0023e0  f89d0003          LDRB     r0,[sp,#3]            ;2014
0023e4  2841              CMP      r0,#0x41              ;2014
0023e6  d00a              BEQ      |L1.9214|
                  |L1.9192|
0023e8  b114              CBZ      r4,|L1.9200|
0023ea  f1a40401          SUB      r4,r4,#1              ;2016
0023ee  e001              B        |L1.9204|
                  |L1.9200|
0023f0  f04f043f          MOV      r4,#0x3f              ;2017
                  |L1.9204|
0023f4  42b4              CMP      r4,r6                 ;2018
0023f6  d102              BNE      |L1.9214|
0023f8  f04f0500          MOV      r5,#0                 ;2020
0023fc  e005              B        |L1.9226|
                  |L1.9214|
0023fe  f1070701          ADD      r7,r7,#1              ;1994
002402  b2ff              UXTB     r7,r7                 ;1994
002404  2f3f              CMP      r7,#0x3f              ;1994
002406  f4ffae95          BCC      |L1.8500|
                  |L1.9226|
00240a  2d00              CMP      r5,#0                 ;2027
00240c  d0c7              BEQ      |L1.9118|
00240e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2029
002412  f88d0000          STRB     r0,[sp,#0]            ;2029
002416  f8980038          LDRB     r0,[r8,#0x38]         ;2030
00241a  f88d0001          STRB     r0,[sp,#1]            ;2030
00241e  f898002c          LDRB     r0,[r8,#0x2c]         ;2031
002422  f88d0002          STRB     r0,[sp,#2]            ;2031
002426  f88d9003          STRB     r9,[sp,#3]            ;2032
00242a  4669              MOV      r1,sp                 ;2033
00242c  f1050010          ADD      r0,r5,#0x10           ;2033
002430  f7fffffe          BL       lc640_write_long_ptr
002434  f8980028          LDRB     r0,[r8,#0x28]         ;2035
002438  f88d0000          STRB     r0,[sp,#0]            ;2035
00243c  f8980024          LDRB     r0,[r8,#0x24]         ;2036
002440  f88d0001          STRB     r0,[sp,#1]            ;2036
002444  f8980020          LDRB     r0,[r8,#0x20]         ;2037
002448  f88d0002          STRB     r0,[sp,#2]            ;2037
00244c  f88d9003          STRB     r9,[sp,#3]            ;2038
002450  4669              MOV      r1,sp                 ;2039
002452  f1050014          ADD      r0,r5,#0x14           ;2039
002456  f7fffffe          BL       lc640_write_long_ptr
00245a  f04f0442          MOV      r4,#0x42              ;2041
00245e  f88d4000          STRB     r4,[sp,#0]            ;2041
002462  f88d4001          STRB     r4,[sp,#1]            ;2042
002466  f88d4002          STRB     r4,[sp,#2]            ;2043
00246a  f88d4003          STRB     r4,[sp,#3]            ;2044
00246e  4669              MOV      r1,sp                 ;2045
002470  f1050018          ADD      r0,r5,#0x18           ;2045
002474  f7fffffe          BL       lc640_write_long_ptr
002478  f88d4000          STRB     r4,[sp,#0]            ;2047
00247c  f88d4001          STRB     r4,[sp,#1]            ;2048
002480  f88d4002          STRB     r4,[sp,#2]            ;2049
002484  f88d4003          STRB     r4,[sp,#3]            ;2050
002488  4669              MOV      r1,sp                 ;2051
00248a  f105001c          ADD      r0,r5,#0x1c           ;2051
00248e  f7fffffe          BL       lc640_write_long_ptr
002492  e639              B        |L1.8456|
;;;2055     
                          ENDP

                  uz_mem_hndl PROC
;;;2057   //-----------------------------------------------
;;;2058   void uz_mem_hndl(unsigned short in)	 //   
002494  e92d4ff8          PUSH     {r3-r11,lr}
;;;2059   {
;;;2060   char data[4];
;;;2061   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
002498  f04f0600          MOV      r6,#0
00249c  4634              MOV      r4,r6
;;;2062   //char avar_simbol;
;;;2063   
;;;2064   if(in==1) //  
;;;2065   	{
;;;2066   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2067   	event_ptr++;	
;;;2068   	if(event_ptr>63)event_ptr=0;	
;;;2069   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2070   	
;;;2071       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2072   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2073   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2074   	
;;;2075   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2076   	
;;;2077   	data[0]='u';
;;;2078   	data[1]=0; 
;;;2079   	data[2]='Z';
;;;2080   	data[3]=0;
;;;2081   	lc640_write_long_ptr(lc640_adr,data);
;;;2082   
;;;2083   	data[0]=0;
;;;2084   	data[1]=0;
;;;2085   	data[2]=0;
;;;2086   	data[3]=0;
;;;2087   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2088   
;;;2089   	data[0]=LPC_RTC->YEAR;
00249e  f8df86c4          LDR      r8,|L1.11108|
0024a2  46a1              MOV      r9,r4                 ;2061
0024a4  f44f6a80          MOV      r10,#0x400            ;2075
0024a8  2801              CMP      r0,#1                 ;2064
0024aa  d010              BEQ      |L1.9422|
;;;2090   	data[1]=LPC_RTC->MONTH;
;;;2091   	data[2]=LPC_RTC->DOM;
;;;2092   	data[3]=0;
;;;2093   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2094   
;;;2095   	data[0]=LPC_RTC->HOUR;
;;;2096   	data[1]=LPC_RTC->MIN;
;;;2097   	data[2]=LPC_RTC->SEC;
;;;2098   	data[3]=0;
;;;2099   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2100   	
;;;2101   	data[0]='A';
;;;2102   	data[1]='A';
;;;2103   	data[2]='A';
;;;2104   	data[3]='A';
;;;2105   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2106   	
;;;2107   	data[0]='A';
;;;2108   	data[1]='A';
;;;2109   	data[2]='A';
;;;2110   	data[3]='A';
;;;2111   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2112   	
;;;2113   	data[0]='A';
;;;2114   	data[1]='A';
;;;2115   	data[2]='A';
;;;2116   	data[3]='A';
;;;2117   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2118   	
;;;2119   	data[0]='A';
;;;2120   	data[1]='A';
;;;2121   	data[2]='A';
;;;2122   	data[3]='A';
;;;2123   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2124    	
;;;2125   	}
;;;2126   
;;;2127   else if(in==0)	// 
0024ac  2800              CMP      r0,#0
0024ae  d07d              BEQ      |L1.9644|
;;;2128   	{      
;;;2129   	char i;     
;;;2130   	event_ptr_find=0;
;;;2131   	for (i=0;i<63;i++)
;;;2132   		{
;;;2133   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2134   
;;;2135        	lc640_read_long_ptr(lc640_adr,data);
;;;2136        
;;;2137        	if(!((data[0]=='u')&&(data[2]=='Z')))
;;;2138        		{        
;;;2139        		if(event_ptr_find)event_ptr_find--;
;;;2140        		else event_ptr_find=63;
;;;2141        		if(event_ptr_find==event_ptr)
;;;2142   				{
;;;2143   				lc640_adr=0;
;;;2144   				break;
;;;2145   				}
;;;2146        		else continue;
;;;2147        		}
;;;2148        	else 
;;;2149        		{
;;;2150        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2151        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2152        			{        
;;;2153        			if(event_ptr_find)event_ptr_find--;
;;;2154            		else event_ptr_find=63;
;;;2155            		if(event_ptr_find==event_ptr)
;;;2156   					{
;;;2157   					lc640_adr=0;
;;;2158   					break;
;;;2159   					}
;;;2160        			else continue;
;;;2161        			}
;;;2162        		}	
;;;2163   		}
;;;2164   	if(lc640_adr!=0)
;;;2165   		{
;;;2166   		data[0]=LPC_RTC->YEAR;
;;;2167   		data[1]=LPC_RTC->MONTH;
;;;2168   		data[2]=LPC_RTC->DOM;
;;;2169   		data[3]=0;
;;;2170   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2171   	
;;;2172   		data[0]=LPC_RTC->HOUR;
;;;2173   		data[1]=LPC_RTC->MIN;
;;;2174   		data[2]=LPC_RTC->SEC;
;;;2175   		data[3]=0;
;;;2176   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2177   		
;;;2178   		data[0]='C';
;;;2179   		data[1]='C';
;;;2180   		data[2]='C';
;;;2181   		data[3]='C';
;;;2182   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2183   		
;;;2184   		data[0]='C';
;;;2185   		data[1]='C';
;;;2186   		data[2]='C';
;;;2187   		data[3]='C';
;;;2188   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2189   		}
;;;2190   	}
;;;2191   else if(in==10) 	//  
0024b0  280a              CMP      r0,#0xa
0024b2  d17c              BNE      |L1.9646|
;;;2192   	{      
;;;2193   	char i;     
;;;2194   
;;;2195   	event_ptr_find=0;
;;;2196   	for (i=0;i<63;i++)
0024b4  f04f0700          MOV      r7,#0
                  |L1.9400|
;;;2197   		{
;;;2198   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
0024b8  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2199   
;;;2200        	lc640_read_long_ptr(lc640_adr,data);
0024bc  4669              MOV      r1,sp
0024be  4628              MOV      r0,r5
0024c0  f7fffffe          BL       lc640_read_long_ptr
;;;2201        
;;;2202        	if(!((data[0]=='u')&&(data[2]=='Z')))
0024c4  f89d0000          LDRB     r0,[sp,#0]
0024c8  2875              CMP      r0,#0x75
0024ca  d171              BNE      |L1.9648|
0024cc  e11c              B        |L1.9992|
                  |L1.9422|
0024ce  f44f6560          MOV      r5,#0xe00             ;2066
0024d2  4628              MOV      r0,r5                 ;2066
0024d4  f7fffffe          BL       lc640_read_int
0024d8  f1000001          ADD      r0,r0,#1              ;2067
0024dc  4604              MOV      r4,r0                 ;2067
0024de  2c3f              CMP      r4,#0x3f              ;2068
0024e0  d901              BLS      |L1.9446|
0024e2  f04f0400          MOV      r4,#0                 ;2068
                  |L1.9446|
0024e6  b221              SXTH     r1,r4                 ;2069
0024e8  4628              MOV      r0,r5                 ;2069
0024ea  f7fffffe          BL       lc640_write_int
0024ee  f6406602          MOV      r6,#0xe02             ;2071
0024f2  4630              MOV      r0,r6                 ;2071
0024f4  f7fffffe          BL       lc640_read_int
0024f8  283f              CMP      r0,#0x3f              ;2072
0024fa  d000              BEQ      |L1.9470|
0024fc  4620              MOV      r0,r4                 ;2072
                  |L1.9470|
0024fe  b201              SXTH     r1,r0                 ;2073
002500  4630              MOV      r0,r6                 ;2073
002502  f7fffffe          BL       lc640_write_int
002506  4628              MOV      r0,r5                 ;2075
002508  f7fffffe          BL       lc640_read_int
00250c  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2075
002510  f04f0075          MOV      r0,#0x75              ;2077
002514  f88d0000          STRB     r0,[sp,#0]            ;2077
002518  f88d9001          STRB     r9,[sp,#1]            ;2078
00251c  f04f005a          MOV      r0,#0x5a              ;2079
002520  f88d0002          STRB     r0,[sp,#2]            ;2079
002524  f88d9003          STRB     r9,[sp,#3]            ;2080
002528  4669              MOV      r1,sp                 ;2081
00252a  4620              MOV      r0,r4                 ;2081
00252c  f7fffffe          BL       lc640_write_long_ptr
002530  f8cd9000          STR      r9,[sp,#0]            ;2086
002534  4669              MOV      r1,sp                 ;2087
002536  1d20              ADDS     r0,r4,#4              ;2087
002538  f7fffffe          BL       lc640_write_long_ptr
00253c  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2089
002540  f88d0000          STRB     r0,[sp,#0]            ;2089
002544  f8980038          LDRB     r0,[r8,#0x38]         ;2090
002548  f88d0001          STRB     r0,[sp,#1]            ;2090
00254c  f898002c          LDRB     r0,[r8,#0x2c]         ;2091
002550  f88d0002          STRB     r0,[sp,#2]            ;2091
002554  f88d9003          STRB     r9,[sp,#3]            ;2092
002558  4669              MOV      r1,sp                 ;2093
00255a  f1040008          ADD      r0,r4,#8              ;2093
00255e  f7fffffe          BL       lc640_write_long_ptr
002562  f8980028          LDRB     r0,[r8,#0x28]         ;2095
002566  f88d0000          STRB     r0,[sp,#0]            ;2095
00256a  f8980024          LDRB     r0,[r8,#0x24]         ;2096
00256e  f88d0001          STRB     r0,[sp,#1]            ;2096
002572  f8980020          LDRB     r0,[r8,#0x20]         ;2097
002576  f88d0002          STRB     r0,[sp,#2]            ;2097
00257a  f88d9003          STRB     r9,[sp,#3]            ;2098
00257e  4669              MOV      r1,sp                 ;2099
002580  f104000c          ADD      r0,r4,#0xc            ;2099
002584  f7fffffe          BL       lc640_write_long_ptr
002588  f04f0541          MOV      r5,#0x41              ;2101
00258c  f88d5000          STRB     r5,[sp,#0]            ;2101
002590  f88d5001          STRB     r5,[sp,#1]            ;2102
002594  f88d5002          STRB     r5,[sp,#2]            ;2103
002598  f88d5003          STRB     r5,[sp,#3]            ;2104
00259c  4669              MOV      r1,sp                 ;2105
00259e  f1040010          ADD      r0,r4,#0x10           ;2105
0025a2  f7fffffe          BL       lc640_write_long_ptr
0025a6  f88d5000          STRB     r5,[sp,#0]            ;2107
0025aa  e002              B        |L1.9650|
                  |L1.9644|
0025ac  e027              B        |L1.9726|
                  |L1.9646|
0025ae  e025              B        |L1.9724|
                  |L1.9648|
0025b0  e0ae              B        |L1.10000|
                  |L1.9650|
0025b2  f88d5001          STRB     r5,[sp,#1]            ;2108
0025b6  f88d5002          STRB     r5,[sp,#2]            ;2109
0025ba  f88d5003          STRB     r5,[sp,#3]            ;2110
0025be  4669              MOV      r1,sp                 ;2111
0025c0  f1040014          ADD      r0,r4,#0x14           ;2111
0025c4  f7fffffe          BL       lc640_write_long_ptr
0025c8  f88d5000          STRB     r5,[sp,#0]            ;2113
0025cc  f88d5001          STRB     r5,[sp,#1]            ;2114
0025d0  f88d5002          STRB     r5,[sp,#2]            ;2115
0025d4  f88d5003          STRB     r5,[sp,#3]            ;2116
0025d8  4669              MOV      r1,sp                 ;2117
0025da  f1040018          ADD      r0,r4,#0x18           ;2117
0025de  f7fffffe          BL       lc640_write_long_ptr
0025e2  f88d5000          STRB     r5,[sp,#0]            ;2119
0025e6  f88d5001          STRB     r5,[sp,#1]            ;2120
0025ea  f88d5002          STRB     r5,[sp,#2]            ;2121
0025ee  f88d5003          STRB     r5,[sp,#3]            ;2122
0025f2  4669              MOV      r1,sp                 ;2123
0025f4  f104001c          ADD      r0,r4,#0x1c           ;2123
0025f8  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9724|
;;;2203        		{        
;;;2204        		if(event_ptr_find)event_ptr_find--;
;;;2205        		else event_ptr_find=63;
;;;2206        		if(event_ptr_find==event_ptr)
;;;2207   				{
;;;2208   				lc640_adr=0;
;;;2209   				break;
;;;2210   				}
;;;2211        		else continue;
;;;2212        		}
;;;2213        	else 
;;;2214        		{
;;;2215        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2216        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2217        			{        
;;;2218        			if(event_ptr_find)event_ptr_find--;
;;;2219            		else event_ptr_find=63;
;;;2220            		if(event_ptr_find==event_ptr)
;;;2221   					{
;;;2222   					lc640_adr=0;
;;;2223   					break;
;;;2224   					}
;;;2225        			else continue;
;;;2226        			}
;;;2227        		}	
;;;2228   		}
;;;2229   	if(lc640_adr!=0)
;;;2230   		{
;;;2231   		data[0]=LPC_RTC->YEAR;
;;;2232   		data[1]=LPC_RTC->MONTH;
;;;2233   		data[2]=LPC_RTC->DOM;
;;;2234   		data[3]=0;
;;;2235   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2236   	
;;;2237   		data[0]=LPC_RTC->HOUR;
;;;2238   		data[1]=LPC_RTC->MIN;
;;;2239   		data[2]=LPC_RTC->SEC;
;;;2240   		data[3]=0;
;;;2241   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2242   		
;;;2243   		data[0]='B';
;;;2244   		data[1]='B';
;;;2245   		data[2]='B';
;;;2246   		data[3]='B';
;;;2247   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2248   		
;;;2249   		data[0]='B';
;;;2250   		data[1]='B';
;;;2251   		data[2]='B';
;;;2252   		data[3]='B';
;;;2253   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2254   		}
;;;2255   	}
;;;2256   }
0025fc  e584              B        |L1.8456|
                  |L1.9726|
0025fe  f04f0700          MOV      r7,#0                 ;2131
                  |L1.9730|
002602  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2133
002606  4669              MOV      r1,sp                 ;2135
002608  4628              MOV      r0,r5                 ;2135
00260a  f7fffffe          BL       lc640_read_long_ptr
00260e  f89d0000          LDRB     r0,[sp,#0]            ;2137
002612  2875              CMP      r0,#0x75              ;2137
002614  d103              BNE      |L1.9758|
002616  f89d0002          LDRB     r0,[sp,#2]            ;2137
00261a  285a              CMP      r0,#0x5a              ;2137
00261c  d00a              BEQ      |L1.9780|
                  |L1.9758|
00261e  b114              CBZ      r4,|L1.9766|
002620  f1a40401          SUB      r4,r4,#1              ;2139
002624  e001              B        |L1.9770|
                  |L1.9766|
002626  f04f043f          MOV      r4,#0x3f              ;2140
                  |L1.9770|
00262a  42b4              CMP      r4,r6                 ;2141
00262c  d122              BNE      |L1.9844|
00262e  f04f0500          MOV      r5,#0                 ;2143
002632  e024              B        |L1.9854|
                  |L1.9780|
002634  4669              MOV      r1,sp                 ;2150
002636  f1050010          ADD      r0,r5,#0x10           ;2150
00263a  f7fffffe          BL       lc640_read_long_ptr
00263e  f89d0000          LDRB     r0,[sp,#0]            ;2151
002642  2841              CMP      r0,#0x41              ;2151
002644  d10b              BNE      |L1.9822|
002646  f89d0001          LDRB     r0,[sp,#1]            ;2151
00264a  2841              CMP      r0,#0x41              ;2151
00264c  d107              BNE      |L1.9822|
00264e  f89d0002          LDRB     r0,[sp,#2]            ;2151
002652  2841              CMP      r0,#0x41              ;2151
002654  d103              BNE      |L1.9822|
002656  f89d0003          LDRB     r0,[sp,#3]            ;2151
00265a  2841              CMP      r0,#0x41              ;2151
00265c  d00a              BEQ      |L1.9844|
                  |L1.9822|
00265e  b114              CBZ      r4,|L1.9830|
002660  f1a40401          SUB      r4,r4,#1              ;2153
002664  e001              B        |L1.9834|
                  |L1.9830|
002666  f04f043f          MOV      r4,#0x3f              ;2154
                  |L1.9834|
00266a  42b4              CMP      r4,r6                 ;2155
00266c  d102              BNE      |L1.9844|
00266e  f04f0500          MOV      r5,#0                 ;2157
002672  e004              B        |L1.9854|
                  |L1.9844|
002674  f1070701          ADD      r7,r7,#1              ;2131
002678  b2ff              UXTB     r7,r7                 ;2131
00267a  2f3f              CMP      r7,#0x3f              ;2131
00267c  d3c1              BCC      |L1.9730|
                  |L1.9854|
00267e  2d00              CMP      r5,#0                 ;2164
002680  d0bc              BEQ      |L1.9724|
002682  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2166
002686  f88d0000          STRB     r0,[sp,#0]            ;2166
00268a  f8980038          LDRB     r0,[r8,#0x38]         ;2167
00268e  f88d0001          STRB     r0,[sp,#1]            ;2167
002692  f898002c          LDRB     r0,[r8,#0x2c]         ;2168
002696  f88d0002          STRB     r0,[sp,#2]            ;2168
00269a  f88d9003          STRB     r9,[sp,#3]            ;2169
00269e  4669              MOV      r1,sp                 ;2170
0026a0  f1050010          ADD      r0,r5,#0x10           ;2170
0026a4  f7fffffe          BL       lc640_write_long_ptr
0026a8  f8980028          LDRB     r0,[r8,#0x28]         ;2172
0026ac  f88d0000          STRB     r0,[sp,#0]            ;2172
0026b0  f8980024          LDRB     r0,[r8,#0x24]         ;2173
0026b4  f88d0001          STRB     r0,[sp,#1]            ;2173
0026b8  f8980020          LDRB     r0,[r8,#0x20]         ;2174
0026bc  f88d0002          STRB     r0,[sp,#2]            ;2174
0026c0  f88d9003          STRB     r9,[sp,#3]            ;2175
0026c4  4669              MOV      r1,sp                 ;2176
0026c6  f1050014          ADD      r0,r5,#0x14           ;2176
0026ca  f7fffffe          BL       lc640_write_long_ptr
0026ce  f04f0443          MOV      r4,#0x43              ;2178
0026d2  f88d4000          STRB     r4,[sp,#0]            ;2178
0026d6  f88d4001          STRB     r4,[sp,#1]            ;2179
0026da  f88d4002          STRB     r4,[sp,#2]            ;2180
0026de  f88d4003          STRB     r4,[sp,#3]            ;2181
0026e2  4669              MOV      r1,sp                 ;2182
0026e4  f1050018          ADD      r0,r5,#0x18           ;2182
0026e8  f7fffffe          BL       lc640_write_long_ptr
0026ec  f88d4000          STRB     r4,[sp,#0]            ;2184
0026f0  f88d4001          STRB     r4,[sp,#1]            ;2185
0026f4  f88d4002          STRB     r4,[sp,#2]            ;2186
0026f8  f88d4003          STRB     r4,[sp,#3]            ;2187
0026fc  4669              MOV      r1,sp                 ;2188
0026fe  f105001c          ADD      r0,r5,#0x1c           ;2188
002702  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9990|
002706  e4ff              B        |L1.8456|
                  |L1.9992|
002708  f89d0002          LDRB     r0,[sp,#2]            ;2202
00270c  285a              CMP      r0,#0x5a              ;2202
00270e  d00a              BEQ      |L1.10022|
                  |L1.10000|
002710  b114              CBZ      r4,|L1.10008|
002712  f1a40401          SUB      r4,r4,#1              ;2204
002716  e001              B        |L1.10012|
                  |L1.10008|
002718  f04f043f          MOV      r4,#0x3f              ;2205
                  |L1.10012|
00271c  42b4              CMP      r4,r6                 ;2206
00271e  d122              BNE      |L1.10086|
002720  f04f0500          MOV      r5,#0                 ;2208
002724  e025              B        |L1.10098|
                  |L1.10022|
002726  4669              MOV      r1,sp                 ;2215
002728  f1050010          ADD      r0,r5,#0x10           ;2215
00272c  f7fffffe          BL       lc640_read_long_ptr
002730  f89d0000          LDRB     r0,[sp,#0]            ;2216
002734  2841              CMP      r0,#0x41              ;2216
002736  d10b              BNE      |L1.10064|
002738  f89d0001          LDRB     r0,[sp,#1]            ;2216
00273c  2841              CMP      r0,#0x41              ;2216
00273e  d107              BNE      |L1.10064|
002740  f89d0002          LDRB     r0,[sp,#2]            ;2216
002744  2841              CMP      r0,#0x41              ;2216
002746  d103              BNE      |L1.10064|
002748  f89d0003          LDRB     r0,[sp,#3]            ;2216
00274c  2841              CMP      r0,#0x41              ;2216
00274e  d00a              BEQ      |L1.10086|
                  |L1.10064|
002750  b114              CBZ      r4,|L1.10072|
002752  f1a40401          SUB      r4,r4,#1              ;2218
002756  e001              B        |L1.10076|
                  |L1.10072|
002758  f04f043f          MOV      r4,#0x3f              ;2219
                  |L1.10076|
00275c  42b4              CMP      r4,r6                 ;2220
00275e  d102              BNE      |L1.10086|
002760  f04f0500          MOV      r5,#0                 ;2222
002764  e005              B        |L1.10098|
                  |L1.10086|
002766  f1070701          ADD      r7,r7,#1              ;2196
00276a  b2ff              UXTB     r7,r7                 ;2196
00276c  2f3f              CMP      r7,#0x3f              ;2196
00276e  f4ffaea3          BCC      |L1.9400|
                  |L1.10098|
002772  2d00              CMP      r5,#0                 ;2229
002774  d0c7              BEQ      |L1.9990|
002776  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2231
00277a  f88d0000          STRB     r0,[sp,#0]            ;2231
00277e  f8980038          LDRB     r0,[r8,#0x38]         ;2232
002782  f88d0001          STRB     r0,[sp,#1]            ;2232
002786  f898002c          LDRB     r0,[r8,#0x2c]         ;2233
00278a  f88d0002          STRB     r0,[sp,#2]            ;2233
00278e  f88d9003          STRB     r9,[sp,#3]            ;2234
002792  4669              MOV      r1,sp                 ;2235
002794  f1050010          ADD      r0,r5,#0x10           ;2235
002798  f7fffffe          BL       lc640_write_long_ptr
00279c  f8980028          LDRB     r0,[r8,#0x28]         ;2237
0027a0  f88d0000          STRB     r0,[sp,#0]            ;2237
0027a4  f8980024          LDRB     r0,[r8,#0x24]         ;2238
0027a8  f88d0001          STRB     r0,[sp,#1]            ;2238
0027ac  f8980020          LDRB     r0,[r8,#0x20]         ;2239
0027b0  f88d0002          STRB     r0,[sp,#2]            ;2239
0027b4  f88d9003          STRB     r9,[sp,#3]            ;2240
0027b8  4669              MOV      r1,sp                 ;2241
0027ba  f1050014          ADD      r0,r5,#0x14           ;2241
0027be  f7fffffe          BL       lc640_write_long_ptr
0027c2  f04f0442          MOV      r4,#0x42              ;2243
0027c6  f88d4000          STRB     r4,[sp,#0]            ;2243
0027ca  f88d4001          STRB     r4,[sp,#1]            ;2244
0027ce  f88d4002          STRB     r4,[sp,#2]            ;2245
0027d2  f88d4003          STRB     r4,[sp,#3]            ;2246
0027d6  4669              MOV      r1,sp                 ;2247
0027d8  f1050018          ADD      r0,r5,#0x18           ;2247
0027dc  f7fffffe          BL       lc640_write_long_ptr
0027e0  f88d4000          STRB     r4,[sp,#0]            ;2249
0027e4  f88d4001          STRB     r4,[sp,#1]            ;2250
0027e8  f88d4002          STRB     r4,[sp,#2]            ;2251
0027ec  f88d4003          STRB     r4,[sp,#3]            ;2252
0027f0  4669              MOV      r1,sp                 ;2253
0027f2  f105001c          ADD      r0,r5,#0x1c           ;2253
0027f6  f7fffffe          BL       lc640_write_long_ptr
0027fa  e485              B        |L1.8456|
;;;2257   
                          ENDP

                  fz_mem_hndl PROC
;;;2258   //-----------------------------------------------
;;;2259   void fz_mem_hndl(unsigned short in)	 //   
0027fc  e92d4ff8          PUSH     {r3-r11,lr}
;;;2260   {
;;;2261   char data[4];
;;;2262   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
002800  f04f0600          MOV      r6,#0
002804  4634              MOV      r4,r6
;;;2263   //char avar_simbol;
;;;2264   
;;;2265   if(in==1) //  
;;;2266   	{
;;;2267   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2268   	event_ptr++;	
;;;2269   	if(event_ptr>63)event_ptr=0;	
;;;2270   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2271   	
;;;2272       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2273   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2274   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2275   	
;;;2276   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2277   	
;;;2278   	data[0]='f';
;;;2279   	data[1]=0; 
;;;2280   	data[2]='Z';
;;;2281   	data[3]=0;
;;;2282   	lc640_write_long_ptr(lc640_adr,data);
;;;2283   
;;;2284   	data[0]=0;
;;;2285   	data[1]=0;
;;;2286   	data[2]=0;
;;;2287   	data[3]=0;
;;;2288   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2289   
;;;2290   	data[0]=LPC_RTC->YEAR;
002806  f8df835c          LDR      r8,|L1.11108|
00280a  46a1              MOV      r9,r4                 ;2262
00280c  f44f6a80          MOV      r10,#0x400            ;2276
002810  2801              CMP      r0,#1                 ;2265
002812  d010              BEQ      |L1.10294|
;;;2291   	data[1]=LPC_RTC->MONTH;
;;;2292   	data[2]=LPC_RTC->DOM;
;;;2293   	data[3]=0;
;;;2294   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2295   
;;;2296   	data[0]=LPC_RTC->HOUR;
;;;2297   	data[1]=LPC_RTC->MIN;
;;;2298   	data[2]=LPC_RTC->SEC;
;;;2299   	data[3]=0;
;;;2300   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2301   	
;;;2302   	data[0]='A';
;;;2303   	data[1]='A';
;;;2304   	data[2]='A';
;;;2305   	data[3]='A';
;;;2306   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2307   	
;;;2308   	data[0]='A';
;;;2309   	data[1]='A';
;;;2310   	data[2]='A';
;;;2311   	data[3]='A';
;;;2312   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2313   	
;;;2314   	data[0]='A';
;;;2315   	data[1]='A';
;;;2316   	data[2]='A';
;;;2317   	data[3]='A';
;;;2318   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2319   	
;;;2320   	data[0]='A';
;;;2321   	data[1]='A';
;;;2322   	data[2]='A';
;;;2323   	data[3]='A';
;;;2324   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2325    	
;;;2326   	}
;;;2327   
;;;2328   else if(in==0)	// 
002814  2800              CMP      r0,#0
002816  d07d              BEQ      |L1.10516|
;;;2329   	{      
;;;2330   	char i;     
;;;2331   	event_ptr_find=0;
;;;2332   	for (i=0;i<63;i++)
;;;2333   		{
;;;2334   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2335   
;;;2336        	lc640_read_long_ptr(lc640_adr,data);
;;;2337        
;;;2338        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;2339        		{        
;;;2340        		if(event_ptr_find)event_ptr_find--;
;;;2341        		else event_ptr_find=63;
;;;2342        		if(event_ptr_find==event_ptr)
;;;2343   				{
;;;2344   				lc640_adr=0;
;;;2345   				break;
;;;2346   				}
;;;2347        		else continue;
;;;2348        		}
;;;2349        	else 
;;;2350        		{
;;;2351        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2352        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2353        			{        
;;;2354        			if(event_ptr_find)event_ptr_find--;
;;;2355            		else event_ptr_find=63;
;;;2356            		if(event_ptr_find==event_ptr)
;;;2357   					{
;;;2358   					lc640_adr=0;
;;;2359   					break;
;;;2360   					}
;;;2361        			else continue;
;;;2362        			}
;;;2363        		}	
;;;2364   		}
;;;2365   	if(lc640_adr!=0)
;;;2366   		{
;;;2367   		data[0]=LPC_RTC->YEAR;
;;;2368   		data[1]=LPC_RTC->MONTH;
;;;2369   		data[2]=LPC_RTC->DOM;
;;;2370   		data[3]=0;
;;;2371   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2372   	
;;;2373   		data[0]=LPC_RTC->HOUR;
;;;2374   		data[1]=LPC_RTC->MIN;
;;;2375   		data[2]=LPC_RTC->SEC;
;;;2376   		data[3]=0;
;;;2377   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2378   		
;;;2379   		data[0]='C';
;;;2380   		data[1]='C';
;;;2381   		data[2]='C';
;;;2382   		data[3]='C';
;;;2383   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2384   		
;;;2385   		data[0]='C';
;;;2386   		data[1]='C';
;;;2387   		data[2]='C';
;;;2388   		data[3]='C';
;;;2389   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2390   		}
;;;2391   	}
;;;2392   else if(in==10) 	//  
002818  280a              CMP      r0,#0xa
00281a  d17c              BNE      |L1.10518|
;;;2393   	{      
;;;2394   	char i;     
;;;2395   
;;;2396   	event_ptr_find=0;
;;;2397   	for (i=0;i<63;i++)
00281c  f04f0700          MOV      r7,#0
                  |L1.10272|
;;;2398   		{
;;;2399   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
002820  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2400   
;;;2401        	lc640_read_long_ptr(lc640_adr,data);
002824  4669              MOV      r1,sp
002826  4628              MOV      r0,r5
002828  f7fffffe          BL       lc640_read_long_ptr
;;;2402        
;;;2403        	if(!((data[0]=='f')&&(data[2]=='Z')))
00282c  f89d0000          LDRB     r0,[sp,#0]
002830  2866              CMP      r0,#0x66
002832  d171              BNE      |L1.10520|
002834  e11c              B        |L1.10864|
                  |L1.10294|
002836  f44f6560          MOV      r5,#0xe00             ;2267
00283a  4628              MOV      r0,r5                 ;2267
00283c  f7fffffe          BL       lc640_read_int
002840  f1000001          ADD      r0,r0,#1              ;2268
002844  4604              MOV      r4,r0                 ;2268
002846  2c3f              CMP      r4,#0x3f              ;2269
002848  d901              BLS      |L1.10318|
00284a  f04f0400          MOV      r4,#0                 ;2269
                  |L1.10318|
00284e  b221              SXTH     r1,r4                 ;2270
002850  4628              MOV      r0,r5                 ;2270
002852  f7fffffe          BL       lc640_write_int
002856  f6406602          MOV      r6,#0xe02             ;2272
00285a  4630              MOV      r0,r6                 ;2272
00285c  f7fffffe          BL       lc640_read_int
002860  283f              CMP      r0,#0x3f              ;2273
002862  d000              BEQ      |L1.10342|
002864  4620              MOV      r0,r4                 ;2273
                  |L1.10342|
002866  b201              SXTH     r1,r0                 ;2274
002868  4630              MOV      r0,r6                 ;2274
00286a  f7fffffe          BL       lc640_write_int
00286e  4628              MOV      r0,r5                 ;2276
002870  f7fffffe          BL       lc640_read_int
002874  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2276
002878  f04f0066          MOV      r0,#0x66              ;2278
00287c  f88d0000          STRB     r0,[sp,#0]            ;2278
002880  f88d9001          STRB     r9,[sp,#1]            ;2279
002884  f04f005a          MOV      r0,#0x5a              ;2280
002888  f88d0002          STRB     r0,[sp,#2]            ;2280
00288c  f88d9003          STRB     r9,[sp,#3]            ;2281
002890  4669              MOV      r1,sp                 ;2282
002892  4620              MOV      r0,r4                 ;2282
002894  f7fffffe          BL       lc640_write_long_ptr
002898  f8cd9000          STR      r9,[sp,#0]            ;2287
00289c  4669              MOV      r1,sp                 ;2288
00289e  1d20              ADDS     r0,r4,#4              ;2288
0028a0  f7fffffe          BL       lc640_write_long_ptr
0028a4  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2290
0028a8  f88d0000          STRB     r0,[sp,#0]            ;2290
0028ac  f8980038          LDRB     r0,[r8,#0x38]         ;2291
0028b0  f88d0001          STRB     r0,[sp,#1]            ;2291
0028b4  f898002c          LDRB     r0,[r8,#0x2c]         ;2292
0028b8  f88d0002          STRB     r0,[sp,#2]            ;2292
0028bc  f88d9003          STRB     r9,[sp,#3]            ;2293
0028c0  4669              MOV      r1,sp                 ;2294
0028c2  f1040008          ADD      r0,r4,#8              ;2294
0028c6  f7fffffe          BL       lc640_write_long_ptr
0028ca  f8980028          LDRB     r0,[r8,#0x28]         ;2296
0028ce  f88d0000          STRB     r0,[sp,#0]            ;2296
0028d2  f8980024          LDRB     r0,[r8,#0x24]         ;2297
0028d6  f88d0001          STRB     r0,[sp,#1]            ;2297
0028da  f8980020          LDRB     r0,[r8,#0x20]         ;2298
0028de  f88d0002          STRB     r0,[sp,#2]            ;2298
0028e2  f88d9003          STRB     r9,[sp,#3]            ;2299
0028e6  4669              MOV      r1,sp                 ;2300
0028e8  f104000c          ADD      r0,r4,#0xc            ;2300
0028ec  f7fffffe          BL       lc640_write_long_ptr
0028f0  f04f0541          MOV      r5,#0x41              ;2302
0028f4  f88d5000          STRB     r5,[sp,#0]            ;2302
0028f8  f88d5001          STRB     r5,[sp,#1]            ;2303
0028fc  f88d5002          STRB     r5,[sp,#2]            ;2304
002900  f88d5003          STRB     r5,[sp,#3]            ;2305
002904  4669              MOV      r1,sp                 ;2306
002906  f1040010          ADD      r0,r4,#0x10           ;2306
00290a  f7fffffe          BL       lc640_write_long_ptr
00290e  f88d5000          STRB     r5,[sp,#0]            ;2308
002912  e002              B        |L1.10522|
                  |L1.10516|
002914  e027              B        |L1.10598|
                  |L1.10518|
002916  e025              B        |L1.10596|
                  |L1.10520|
002918  e0ae              B        |L1.10872|
                  |L1.10522|
00291a  f88d5001          STRB     r5,[sp,#1]            ;2309
00291e  f88d5002          STRB     r5,[sp,#2]            ;2310
002922  f88d5003          STRB     r5,[sp,#3]            ;2311
002926  4669              MOV      r1,sp                 ;2312
002928  f1040014          ADD      r0,r4,#0x14           ;2312
00292c  f7fffffe          BL       lc640_write_long_ptr
002930  f88d5000          STRB     r5,[sp,#0]            ;2314
002934  f88d5001          STRB     r5,[sp,#1]            ;2315
002938  f88d5002          STRB     r5,[sp,#2]            ;2316
00293c  f88d5003          STRB     r5,[sp,#3]            ;2317
002940  4669              MOV      r1,sp                 ;2318
002942  f1040018          ADD      r0,r4,#0x18           ;2318
002946  f7fffffe          BL       lc640_write_long_ptr
00294a  f88d5000          STRB     r5,[sp,#0]            ;2320
00294e  f88d5001          STRB     r5,[sp,#1]            ;2321
002952  f88d5002          STRB     r5,[sp,#2]            ;2322
002956  f88d5003          STRB     r5,[sp,#3]            ;2323
00295a  4669              MOV      r1,sp                 ;2324
00295c  f104001c          ADD      r0,r4,#0x1c           ;2324
002960  f7fffffe          BL       lc640_write_long_ptr
                  |L1.10596|
;;;2404        		{        
;;;2405        		if(event_ptr_find)event_ptr_find--;
;;;2406        		else event_ptr_find=63;
;;;2407        		if(event_ptr_find==event_ptr)
;;;2408   				{
;;;2409   				lc640_adr=0;
;;;2410   				break;
;;;2411   				}
;;;2412        		else continue;
;;;2413        		}
;;;2414        	else 
;;;2415        		{
;;;2416        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2417        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2418        			{        
;;;2419        			if(event_ptr_find)event_ptr_find--;
;;;2420            		else event_ptr_find=63;
;;;2421            		if(event_ptr_find==event_ptr)
;;;2422   					{
;;;2423   					lc640_adr=0;
;;;2424   					break;
;;;2425   					}
;;;2426        			else continue;
;;;2427        			}
;;;2428        		}	
;;;2429   		}
;;;2430   	if(lc640_adr!=0)
;;;2431   		{
;;;2432   		data[0]=LPC_RTC->YEAR;
;;;2433   		data[1]=LPC_RTC->MONTH;
;;;2434   		data[2]=LPC_RTC->DOM;
;;;2435   		data[3]=0;
;;;2436   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2437   	
;;;2438   		data[0]=LPC_RTC->HOUR;
;;;2439   		data[1]=LPC_RTC->MIN;
;;;2440   		data[2]=LPC_RTC->SEC;
;;;2441   		data[3]=0;
;;;2442   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2443   		
;;;2444   		data[0]='B';
;;;2445   		data[1]='B';
;;;2446   		data[2]='B';
;;;2447   		data[3]='B';
;;;2448   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2449   		
;;;2450   		data[0]='B';
;;;2451   		data[1]='B';
;;;2452   		data[2]='B';
;;;2453   		data[3]='B';
;;;2454   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2455   		}
;;;2456   	}
;;;2457   }
002964  e496              B        |L1.8852|
                  |L1.10598|
002966  f04f0700          MOV      r7,#0                 ;2332
                  |L1.10602|
00296a  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2334
00296e  4669              MOV      r1,sp                 ;2336
002970  4628              MOV      r0,r5                 ;2336
002972  f7fffffe          BL       lc640_read_long_ptr
002976  f89d0000          LDRB     r0,[sp,#0]            ;2338
00297a  2866              CMP      r0,#0x66              ;2338
00297c  d103              BNE      |L1.10630|
00297e  f89d0002          LDRB     r0,[sp,#2]            ;2338
002982  285a              CMP      r0,#0x5a              ;2338
002984  d00a              BEQ      |L1.10652|
                  |L1.10630|
002986  b114              CBZ      r4,|L1.10638|
002988  f1a40401          SUB      r4,r4,#1              ;2340
00298c  e001              B        |L1.10642|
                  |L1.10638|
00298e  f04f043f          MOV      r4,#0x3f              ;2341
                  |L1.10642|
002992  42b4              CMP      r4,r6                 ;2342
002994  d122              BNE      |L1.10716|
002996  f04f0500          MOV      r5,#0                 ;2344
00299a  e024              B        |L1.10726|
                  |L1.10652|
00299c  4669              MOV      r1,sp                 ;2351
00299e  f1050010          ADD      r0,r5,#0x10           ;2351
0029a2  f7fffffe          BL       lc640_read_long_ptr
0029a6  f89d0000          LDRB     r0,[sp,#0]            ;2352
0029aa  2841              CMP      r0,#0x41              ;2352
0029ac  d10b              BNE      |L1.10694|
0029ae  f89d0001          LDRB     r0,[sp,#1]            ;2352
0029b2  2841              CMP      r0,#0x41              ;2352
0029b4  d107              BNE      |L1.10694|
0029b6  f89d0002          LDRB     r0,[sp,#2]            ;2352
0029ba  2841              CMP      r0,#0x41              ;2352
0029bc  d103              BNE      |L1.10694|
0029be  f89d0003          LDRB     r0,[sp,#3]            ;2352
0029c2  2841              CMP      r0,#0x41              ;2352
0029c4  d00a              BEQ      |L1.10716|
                  |L1.10694|
0029c6  b114              CBZ      r4,|L1.10702|
0029c8  f1a40401          SUB      r4,r4,#1              ;2354
0029cc  e001              B        |L1.10706|
                  |L1.10702|
0029ce  f04f043f          MOV      r4,#0x3f              ;2355
                  |L1.10706|
0029d2  42b4              CMP      r4,r6                 ;2356
0029d4  d102              BNE      |L1.10716|
0029d6  f04f0500          MOV      r5,#0                 ;2358
0029da  e004              B        |L1.10726|
                  |L1.10716|
0029dc  f1070701          ADD      r7,r7,#1              ;2332
0029e0  b2ff              UXTB     r7,r7                 ;2332
0029e2  2f3f              CMP      r7,#0x3f              ;2332
0029e4  d3c1              BCC      |L1.10602|
                  |L1.10726|
0029e6  2d00              CMP      r5,#0                 ;2365
0029e8  d0bc              BEQ      |L1.10596|
0029ea  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2367
0029ee  f88d0000          STRB     r0,[sp,#0]            ;2367
0029f2  f8980038          LDRB     r0,[r8,#0x38]         ;2368
0029f6  f88d0001          STRB     r0,[sp,#1]            ;2368
0029fa  f898002c          LDRB     r0,[r8,#0x2c]         ;2369
0029fe  f88d0002          STRB     r0,[sp,#2]            ;2369
002a02  f88d9003          STRB     r9,[sp,#3]            ;2370
002a06  4669              MOV      r1,sp                 ;2371
002a08  f1050010          ADD      r0,r5,#0x10           ;2371
002a0c  f7fffffe          BL       lc640_write_long_ptr
002a10  f8980028          LDRB     r0,[r8,#0x28]         ;2373
002a14  f88d0000          STRB     r0,[sp,#0]            ;2373
002a18  f8980024          LDRB     r0,[r8,#0x24]         ;2374
002a1c  f88d0001          STRB     r0,[sp,#1]            ;2374
002a20  f8980020          LDRB     r0,[r8,#0x20]         ;2375
002a24  f88d0002          STRB     r0,[sp,#2]            ;2375
002a28  f88d9003          STRB     r9,[sp,#3]            ;2376
002a2c  4669              MOV      r1,sp                 ;2377
002a2e  f1050014          ADD      r0,r5,#0x14           ;2377
002a32  f7fffffe          BL       lc640_write_long_ptr
002a36  f04f0443          MOV      r4,#0x43              ;2379
002a3a  f88d4000          STRB     r4,[sp,#0]            ;2379
002a3e  f88d4001          STRB     r4,[sp,#1]            ;2380
002a42  f88d4002          STRB     r4,[sp,#2]            ;2381
002a46  f88d4003          STRB     r4,[sp,#3]            ;2382
002a4a  4669              MOV      r1,sp                 ;2383
002a4c  f1050018          ADD      r0,r5,#0x18           ;2383
002a50  f7fffffe          BL       lc640_write_long_ptr
002a54  f88d4000          STRB     r4,[sp,#0]            ;2385
002a58  f88d4001          STRB     r4,[sp,#1]            ;2386
002a5c  f88d4002          STRB     r4,[sp,#2]            ;2387
002a60  f88d4003          STRB     r4,[sp,#3]            ;2388
002a64  4669              MOV      r1,sp                 ;2389
002a66  f105001c          ADD      r0,r5,#0x1c           ;2389
002a6a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.10862|
002a6e  e411              B        |L1.8852|
                  |L1.10864|
002a70  f89d0002          LDRB     r0,[sp,#2]            ;2403
002a74  285a              CMP      r0,#0x5a              ;2403
002a76  d00a              BEQ      |L1.10894|
                  |L1.10872|
002a78  b114              CBZ      r4,|L1.10880|
002a7a  f1a40401          SUB      r4,r4,#1              ;2405
002a7e  e001              B        |L1.10884|
                  |L1.10880|
002a80  f04f043f          MOV      r4,#0x3f              ;2406
                  |L1.10884|
002a84  42b4              CMP      r4,r6                 ;2407
002a86  d122              BNE      |L1.10958|
002a88  f04f0500          MOV      r5,#0                 ;2409
002a8c  e025              B        |L1.10970|
                  |L1.10894|
002a8e  4669              MOV      r1,sp                 ;2416
002a90  f1050010          ADD      r0,r5,#0x10           ;2416
002a94  f7fffffe          BL       lc640_read_long_ptr
002a98  f89d0000          LDRB     r0,[sp,#0]            ;2417
002a9c  2841              CMP      r0,#0x41              ;2417
002a9e  d10b              BNE      |L1.10936|
002aa0  f89d0001          LDRB     r0,[sp,#1]            ;2417
002aa4  2841              CMP      r0,#0x41              ;2417
002aa6  d107              BNE      |L1.10936|
002aa8  f89d0002          LDRB     r0,[sp,#2]            ;2417
002aac  2841              CMP      r0,#0x41              ;2417
002aae  d103              BNE      |L1.10936|
002ab0  f89d0003          LDRB     r0,[sp,#3]            ;2417
002ab4  2841              CMP      r0,#0x41              ;2417
002ab6  d00a              BEQ      |L1.10958|
                  |L1.10936|
002ab8  b114              CBZ      r4,|L1.10944|
002aba  f1a40401          SUB      r4,r4,#1              ;2419
002abe  e001              B        |L1.10948|
                  |L1.10944|
002ac0  f04f043f          MOV      r4,#0x3f              ;2420
                  |L1.10948|
002ac4  42b4              CMP      r4,r6                 ;2421
002ac6  d102              BNE      |L1.10958|
002ac8  f04f0500          MOV      r5,#0                 ;2423
002acc  e005              B        |L1.10970|
                  |L1.10958|
002ace  f1070701          ADD      r7,r7,#1              ;2397
002ad2  b2ff              UXTB     r7,r7                 ;2397
002ad4  2f3f              CMP      r7,#0x3f              ;2397
002ad6  f4ffaea3          BCC      |L1.10272|
                  |L1.10970|
002ada  2d00              CMP      r5,#0                 ;2430
002adc  d0c7              BEQ      |L1.10862|
002ade  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2432
002ae2  f88d0000          STRB     r0,[sp,#0]            ;2432
002ae6  f8980038          LDRB     r0,[r8,#0x38]         ;2433
002aea  f88d0001          STRB     r0,[sp,#1]            ;2433
002aee  f898002c          LDRB     r0,[r8,#0x2c]         ;2434
002af2  f88d0002          STRB     r0,[sp,#2]            ;2434
002af6  f88d9003          STRB     r9,[sp,#3]            ;2435
002afa  4669              MOV      r1,sp                 ;2436
002afc  f1050010          ADD      r0,r5,#0x10           ;2436
002b00  f7fffffe          BL       lc640_write_long_ptr
002b04  f8980028          LDRB     r0,[r8,#0x28]         ;2438
002b08  f88d0000          STRB     r0,[sp,#0]            ;2438
002b0c  f8980024          LDRB     r0,[r8,#0x24]         ;2439
002b10  f88d0001          STRB     r0,[sp,#1]            ;2439
002b14  f8980020          LDRB     r0,[r8,#0x20]         ;2440
002b18  f88d0002          STRB     r0,[sp,#2]            ;2440
002b1c  f88d9003          STRB     r9,[sp,#3]            ;2441
002b20  4669              MOV      r1,sp                 ;2442
002b22  f1050014          ADD      r0,r5,#0x14           ;2442
002b26  f7fffffe          BL       lc640_write_long_ptr
002b2a  f04f0442          MOV      r4,#0x42              ;2444
002b2e  f88d4000          STRB     r4,[sp,#0]            ;2444
002b32  f88d4001          STRB     r4,[sp,#1]            ;2445
002b36  f88d4002          STRB     r4,[sp,#2]            ;2446
002b3a  f88d4003          STRB     r4,[sp,#3]            ;2447
002b3e  4669              MOV      r1,sp                 ;2448
002b40  f1050018          ADD      r0,r5,#0x18           ;2448
002b44  f7fffffe          BL       lc640_write_long_ptr
002b48  f88d4000          STRB     r4,[sp,#0]            ;2450
002b4c  f88d4001          STRB     r4,[sp,#1]            ;2451
002b50  f88d4002          STRB     r4,[sp,#2]            ;2452
002b54  f88d4003          STRB     r4,[sp,#3]            ;2453
002b58  4669              MOV      r1,sp                 ;2454
002b5a  f105001c          ADD      r0,r5,#0x1c           ;2454
002b5e  f7fffffe          BL       lc640_write_long_ptr
002b62  e41c              B        |L1.9118|
                          ENDP

                  |L1.11108|
                          DCD      0x40024000

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  ke_mem_hndl PROC
;;;77     //-----------------------------------------------
;;;78     void avar_hndl(void)
000000  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;79     {
;;;80     //static unsigned avar_stat_old;
;;;81     char i;
;;;82     //unsigned avar_stat_new,avar_stat_offed;
;;;83     
;;;84     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  b083              SUB      sp,sp,#0xc
000004  4605              MOV      r5,r0
000006  eb050045          ADD      r0,r5,r5,LSL #1
00000a  4948              LDR      r1,|L2.300|
00000c  eb001005          ADD      r0,r0,r5,LSL #4
000010  eb010180          ADD      r1,r1,r0,LSL #2
;;;85     else	   			SET_REG(avar_stat,0,0,1);
000014  4846              LDR      r0,|L2.304|
000016  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
;;;86     
;;;87     for(i=0;i<2;i++)
00001a  f1000001          ADD      r0,r0,#1
;;;88     	{
;;;89     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
00001e  eb010040          ADD      r0,r1,r0,LSL #1
000022  f9b00020          LDRSH    r0,[r0,#0x20]
000026  9001              STR      r0,[sp,#4]
000028  f44f6660          MOV      r6,#0xe00
00002c  4630              MOV      r0,r6
00002e  f7fffffe          BL       lc640_read_int
000032  f1000001          ADD      r0,r0,#1
000036  4604              MOV      r4,r0
000038  2c3f              CMP      r4,#0x3f
00003a  d901              BLS      |L2.64|
00003c  f04f0400          MOV      r4,#0
                  |L2.64|
000040  b221              SXTH     r1,r4
000042  4630              MOV      r0,r6
000044  f7fffffe          BL       lc640_write_int
000048  f6406702          MOV      r7,#0xe02
00004c  4638              MOV      r0,r7
;;;90     	else	   			SET_REG(avar_stat,0,1+i,1);
00004e  f7fffffe          BL       lc640_read_int
000052  283f              CMP      r0,#0x3f
000054  d000              BEQ      |L2.88|
000056  4620              MOV      r0,r4
                  |L2.88|
000058  b201              SXTH     r1,r0
00005a  4638              MOV      r0,r7
00005c  f7fffffe          BL       lc640_write_int
000060  4630              MOV      r0,r6                 ;87
000062  f7fffffe          BL       lc640_read_int
000066  f44f6180          MOV      r1,#0x400             ;87
;;;91     	}
;;;92     
;;;93     for(i=0;i<12;i++)
00006a  eb011440          ADD      r4,r1,r0,LSL #5
;;;94     	{
;;;95     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00006e  f04f0042          MOV      r0,#0x42
000072  f88d0008          STRB     r0,[sp,#8]
000076  f88d5009          STRB     r5,[sp,#9]
00007a  f04f004b          MOV      r0,#0x4b
00007e  f88d000a          STRB     r0,[sp,#0xa]
000082  f04f0600          MOV      r6,#0
000086  f88d600b          STRB     r6,[sp,#0xb]
00008a  a902              ADD      r1,sp,#8
00008c  4620              MOV      r0,r4
00008e  f7fffffe          BL       lc640_write_long_ptr
000092  f89d0010          LDRB     r0,[sp,#0x10]
000096  f88d0008          STRB     r0,[sp,#8]
;;;96     	else	   		SET_REG(avar_stat,0,3+i,1);
00009a  f89d0011          LDRB     r0,[sp,#0x11]
00009e  f88d0009          STRB     r0,[sp,#9]
0000a2  f89d0004          LDRB     r0,[sp,#4]
0000a6  f88d000a          STRB     r0,[sp,#0xa]
0000aa  f89d0005          LDRB     r0,[sp,#5]            ;93
0000ae  f88d000b          STRB     r0,[sp,#0xb]          ;93
;;;97     	}
;;;98     
;;;99     for(i=0;i<6;i++)
0000b2  a902              ADD      r1,sp,#8
0000b4  1d20              ADDS     r0,r4,#4
;;;100    	{
;;;101    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
0000b6  f7fffffe          BL       lc640_write_long_ptr
0000ba  f24020a2          MOV      r0,#0x2a2
0000be  f7fffffe          BL       lc640_read_long
0000c2  4d1c              LDR      r5,|L2.308|
0000c4  6028              STR      r0,[r5,#0]  ; ke_date
0000c6  4629              MOV      r1,r5
0000c8  f1040008          ADD      r0,r4,#8
0000cc  f7fffffe          BL       lc640_write_long_ptr
0000d0  f24020a6          MOV      r0,#0x2a6
0000d4  f7fffffe          BL       lc640_read_long
;;;102    	else	   		SET_REG(avar_stat,0,15+i,1);
0000d8  6068              STR      r0,[r5,#4]  ; ke_date
0000da  1d29              ADDS     r1,r5,#4
0000dc  f104000c          ADD      r0,r4,#0xc
0000e0  f7fffffe          BL       lc640_write_long_ptr
0000e4  4d14              LDR      r5,|L2.312|
0000e6  8ba8              LDRH     r0,[r5,#0x1c]         ;99
0000e8  f88d0008          STRB     r0,[sp,#8]            ;99
0000ec  7e28              LDRB     r0,[r5,#0x18]         ;99
0000ee  f88d0009          STRB     r0,[sp,#9]            ;99
;;;103    	}
;;;104    
;;;105    /*for(i=0;i<4;i++)
;;;106    	{
;;;107    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;108    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;109    	}  */
;;;110    for(i=0;i<4;i++)
0000f2  7b28              LDRB     r0,[r5,#0xc]
;;;111    	{
;;;112    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000f4  f88d000a          STRB     r0,[sp,#0xa]
0000f8  f88d600b          STRB     r6,[sp,#0xb]
;;;113    	else	   		SET_REG(avar_stat,0,24+i,1);
0000fc  a902              ADD      r1,sp,#8
0000fe  f1040010          ADD      r0,r4,#0x10
000102  f7fffffe          BL       lc640_write_long_ptr
000106  7a28              LDRB     r0,[r5,#8]
000108  f88d0008          STRB     r0,[sp,#8]
00010c  7928              LDRB     r0,[r5,#4]            ;110
00010e  f88d0009          STRB     r0,[sp,#9]            ;110
000112  7828              LDRB     r0,[r5,#0]            ;110
000114  f88d000a          STRB     r0,[sp,#0xa]          ;110
;;;114    	}
;;;115    
;;;116    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;117    //else	   			SET_REG(avar_stat,0,28,1);
;;;118    
;;;119    
;;;120    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000118  f88d600b          STRB     r6,[sp,#0xb]
00011c  a902              ADD      r1,sp,#8
00011e  f1040014          ADD      r0,r4,#0x14
;;;121    
;;;122    avar_ind_stat|=avar_stat_new;
000122  f7fffffe          BL       lc640_write_long_ptr
000126  b005              ADD      sp,sp,#0x14
;;;123    
;;;124    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000128  bdf0              POP      {r4-r7,pc}
;;;125    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
;;;126    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
;;;127    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
;;;128    
;;;129    
;;;130    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
;;;131    
;;;132    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
;;;133    
;;;134    avar_ind_stat&=avar_stat_offed; 
;;;135    
;;;136    avar_stat_old=avar_stat;
;;;137    
;;;138    //oleg_start
;;;139    
;;;140    
;;;141    
;;;142    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
;;;143    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
;;;144    rki_avar1_ind_stat|=rki_avar1_stat_new;
;;;145    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
;;;146    rki_avar1_ind_stat&=rki_avar1_stat_offed;
;;;147    rki_avar1_stat_old=rki_avar1_stat;
;;;148    /*
;;;149    rki_avarI1_stat=status_di1;
;;;150    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;151    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;152    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;153    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;154    rki_avarI1_stat_old=rki_avarI1_stat;
;;;155    
;;;156    rki_avarI2_stat=status_di2;
;;;157    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;158    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;159    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;160    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;161    rki_avarI2_stat_old=rki_avarI2_stat;
;;;162    */
;;;163    //oleg_end
;;;164    }
;;;165    
                          ENDP

00012a  0000              DCW      0x0000
                  |L2.300|
                          DCD      bat
                  |L2.304|
                          DCD      bat_u_old_cnt
                  |L2.308|
                          DCD      ke_date
                  |L2.312|
                          DCD      0x40024020

                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  rki_avar1_stat
                          DCD      0x00000000
                  rki_avar1_ind_stat
                          DCD      0x00000000
                  rki_avar1_stat_old
                          DCD      0x00000000
                  rki_avar1_stat_new
                          DCD      0x00000000
                  rki_avar1_stat_offed
                          DCD      0x00000000
                  av_inv
                          DCD      0x00000000
00002c  0000              DCB      0x00,0x00
