; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\avar_hndl.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DUKU_ZVU --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;77     //-----------------------------------------------
;;;78     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;79     {
;;;80     //static unsigned avar_stat_old;
;;;81     char i;
;;;82     //unsigned avar_stat_new,avar_stat_offed;
;;;83     
;;;84     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48ff              LDR      r0,|L1.1024|
000004  4bff              LDR      r3,|L1.1028|
000006  7801              LDRB     r1,[r0,#0]  ; net_av
000008  6818              LDR      r0,[r3,#0]
00000a  b119              CBZ      r1,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6018              STR      r0,[r3,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;85     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6018              STR      r0,[r3,#0]  ; avar_stat
                  |L1.26|
;;;86     
;;;87     for(i=0;i<2;i++)
00001a  f04f0000          MOV      r0,#0
;;;88     	{
;;;89     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
00001e  4dfa              LDR      r5,|L1.1032|
000020  f04f0401          MOV      r4,#1
                  |L1.36|
000024  eb000140          ADD      r1,r0,r0,LSL #1
000028  eb011100          ADD      r1,r1,r0,LSL #4
00002c  eb050181          ADD      r1,r5,r1,LSL #2
000030  f891103d          LDRB     r1,[r1,#0x3d]
000034  0789              LSLS     r1,r1,#30
000036  d00a              BEQ      |L1.78|
000038  f1000101          ADD      r1,r0,#1
00003c  fa04f201          LSL      r2,r4,r1
000040  6819              LDR      r1,[r3,#0]  ; avar_stat
000042  ea210102          BIC      r1,r1,r2
000046  ea410102          ORR      r1,r1,r2
00004a  6019              STR      r1,[r3,#0]  ; avar_stat
00004c  e007              B        |L1.94|
                  |L1.78|
;;;90     	else	   			SET_REG(avar_stat,0,1+i,1);
00004e  f1000201          ADD      r2,r0,#1
000052  fa04f102          LSL      r1,r4,r2
000056  681a              LDR      r2,[r3,#0]  ; avar_stat
000058  ea220201          BIC      r2,r2,r1
00005c  601a              STR      r2,[r3,#0]  ; avar_stat
                  |L1.94|
00005e  f1000001          ADD      r0,r0,#1              ;87
000062  b2c0              UXTB     r0,r0                 ;87
000064  2802              CMP      r0,#2                 ;87
000066  d3dd              BCC      |L1.36|
;;;91     	}
;;;92     
;;;93     for(i=0;i<12;i++)
000068  f04f0000          MOV      r0,#0
;;;94     	{
;;;95     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00006c  4de7              LDR      r5,|L1.1036|
                  |L1.110|
00006e  ebc001c0          RSB      r1,r0,r0,LSL #3
000072  eb011100          ADD      r1,r1,r0,LSL #4
000076  eb050181          ADD      r1,r5,r1,LSL #2
00007a  7849              LDRB     r1,[r1,#1]
00007c  f0110fef          TST      r1,#0xef
000080  d00a              BEQ      |L1.152|
000082  f1000203          ADD      r2,r0,#3
000086  fa04f102          LSL      r1,r4,r2
00008a  681a              LDR      r2,[r3,#0]  ; avar_stat
00008c  ea220201          BIC      r2,r2,r1
000090  ea420201          ORR      r2,r2,r1
000094  601a              STR      r2,[r3,#0]  ; avar_stat
000096  e007              B        |L1.168|
                  |L1.152|
;;;96     	else	   		SET_REG(avar_stat,0,3+i,1);
000098  f1000103          ADD      r1,r0,#3
00009c  fa04f201          LSL      r2,r4,r1
0000a0  6819              LDR      r1,[r3,#0]  ; avar_stat
0000a2  ea210102          BIC      r1,r1,r2
0000a6  6019              STR      r1,[r3,#0]  ; avar_stat
                  |L1.168|
0000a8  f1000001          ADD      r0,r0,#1              ;93
0000ac  b2c0              UXTB     r0,r0                 ;93
0000ae  280c              CMP      r0,#0xc               ;93
0000b0  d3dd              BCC      |L1.110|
;;;97     	}
;;;98     
;;;99     for(i=0;i<6;i++)
0000b2  f04f0000          MOV      r0,#0
;;;100    	{
;;;101    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
0000b6  4ad3              LDR      r2,|L1.1028|
0000b8  f1020228          ADD      r2,r2,#0x28
                  |L1.188|
0000bc  5c11              LDRB     r1,[r2,r0]
0000be  b151              CBZ      r1,|L1.214|
0000c0  f100050f          ADD      r5,r0,#0xf
0000c4  fa04f105          LSL      r1,r4,r5
0000c8  681d              LDR      r5,[r3,#0]  ; avar_stat
0000ca  ea250501          BIC      r5,r5,r1
0000ce  ea450501          ORR      r5,r5,r1
0000d2  601d              STR      r5,[r3,#0]  ; avar_stat
0000d4  e007              B        |L1.230|
                  |L1.214|
;;;102    	else	   		SET_REG(avar_stat,0,15+i,1);
0000d6  f100010f          ADD      r1,r0,#0xf
0000da  fa04f501          LSL      r5,r4,r1
0000de  6819              LDR      r1,[r3,#0]  ; avar_stat
0000e0  ea210105          BIC      r1,r1,r5
0000e4  6019              STR      r1,[r3,#0]  ; avar_stat
                  |L1.230|
0000e6  f1000001          ADD      r0,r0,#1              ;99
0000ea  b2c0              UXTB     r0,r0                 ;99
0000ec  2806              CMP      r0,#6                 ;99
0000ee  d3e5              BCC      |L1.188|
;;;103    	}
;;;104    
;;;105    /*for(i=0;i<4;i++)
;;;106    	{
;;;107    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;108    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;109    	}  */
;;;110    for(i=0;i<4;i++)
0000f0  f04f0000          MOV      r0,#0
;;;111    	{
;;;112    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000f4  4dc6              LDR      r5,|L1.1040|
                  |L1.246|
0000f6  5c29              LDRB     r1,[r5,r0]
0000f8  2901              CMP      r1,#1
0000fa  d036              BEQ      |L1.362|
;;;113    	else	   		SET_REG(avar_stat,0,24+i,1);
0000fc  f1000118          ADD      r1,r0,#0x18
000100  681a              LDR      r2,[r3,#0]  ; avar_stat
000102  fa04f101          LSL      r1,r4,r1
000106  ea220201          BIC      r2,r2,r1
00010a  601a              STR      r2,[r3,#0]  ; avar_stat
                  |L1.268|
00010c  f1000001          ADD      r0,r0,#1              ;110
000110  b2c0              UXTB     r0,r0                 ;110
000112  2804              CMP      r0,#4                 ;110
000114  d3ef              BCC      |L1.246|
;;;114    	}
;;;115    
;;;116    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;117    //else	   			SET_REG(avar_stat,0,28,1);
;;;118    
;;;119    
;;;120    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000116  689a              LDR      r2,[r3,#8]  ; avar_stat_old
000118  6818              LDR      r0,[r3,#0]  ; avar_stat
00011a  ea200102          BIC      r1,r0,r2
00011e  60d9              STR      r1,[r3,#0xc]  ; avar_stat_new
;;;121    
;;;122    avar_ind_stat|=avar_stat_new;
000120  685c              LDR      r4,[r3,#4]  ; avar_ind_stat
000122  ea440401          ORR      r4,r4,r1
000126  605c              STR      r4,[r3,#4]  ; avar_ind_stat
;;;123    
;;;124    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000128  49ba              LDR      r1,|L1.1044|
00012a  880d              LDRH     r5,[r1,#0]  ; SK_ZVUK_EN
00012c  b115              CBZ      r5,|L1.308|
00012e  f0247480          BIC      r4,r4,#0x1000000
000132  605c              STR      r4,[r3,#4]  ; avar_ind_stat
                  |L1.308|
;;;125    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
000134  884c              LDRH     r4,[r1,#2]  ; SK_ZVUK_EN
000136  b11c              CBZ      r4,|L1.320|
000138  685c              LDR      r4,[r3,#4]  ; avar_ind_stat
00013a  f0247400          BIC      r4,r4,#0x2000000
00013e  605c              STR      r4,[r3,#4]  ; avar_ind_stat
                  |L1.320|
;;;126    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
000140  888c              LDRH     r4,[r1,#4]  ; SK_ZVUK_EN
000142  b11c              CBZ      r4,|L1.332|
000144  685c              LDR      r4,[r3,#4]  ; avar_ind_stat
000146  f0246480          BIC      r4,r4,#0x4000000
00014a  605c              STR      r4,[r3,#4]  ; avar_ind_stat
                  |L1.332|
;;;127    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
00014c  88c9              LDRH     r1,[r1,#6]  ; SK_ZVUK_EN
00014e  b119              CBZ      r1,|L1.344|
000150  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
000152  f0216100          BIC      r1,r1,#0x8000000
000156  6059              STR      r1,[r3,#4]  ; avar_ind_stat
                  |L1.344|
;;;128    
;;;129    
;;;130    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
000158  ea220200          BIC      r2,r2,r0
00015c  ea6f0102          MVN      r1,r2
000160  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
;;;131    
;;;132    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
000162  4aad              LDR      r2,|L1.1048|
000164  8812              LDRH     r2,[r2,#0]  ; AV_OFF_AVT
000166  b15a              CBZ      r2,|L1.384|
000168  e00e              B        |L1.392|
                  |L1.362|
00016a  f1000218          ADD      r2,r0,#0x18           ;112
00016e  fa04f102          LSL      r1,r4,r2              ;112
000172  681a              LDR      r2,[r3,#0]            ;112  ; avar_stat
000174  ea220201          BIC      r2,r2,r1              ;112
000178  ea420201          ORR      r2,r2,r1              ;112
00017c  601a              STR      r2,[r3,#0]            ;112  ; avar_stat
00017e  e7c5              B        |L1.268|
                  |L1.384|
000180  4aa6              LDR      r2,|L1.1052|
000182  ea410102          ORR      r1,r1,r2
000186  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
                  |L1.392|
;;;133    
;;;134    avar_ind_stat&=avar_stat_offed; 
000188  691a              LDR      r2,[r3,#0x10]  ; avar_stat_offed
00018a  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
00018c  ea010102          AND      r1,r1,r2
000190  6059              STR      r1,[r3,#4]  ; avar_ind_stat
;;;135    
;;;136    avar_stat_old=avar_stat;
000192  6098              STR      r0,[r3,#8]  ; avar_stat_old
;;;137    
;;;138    //oleg_start
;;;139    
;;;140    
;;;141    
;;;142    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
000194  48a2              LDR      r0,|L1.1056|
000196  49a3              LDR      r1,|L1.1060|
000198  8800              LDRH     r0,[r0,#0]  ; status_izm_r
00019a  6809              LDR      r1,[r1,#0]  ; sk_alarm
00019c  f000003f          AND      r0,r0,#0x3f
0001a0  ea402001          ORR      r0,r0,r1,LSL #8
0001a4  6158              STR      r0,[r3,#0x14]  ; rki_avar1_stat
;;;143    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
0001a6  69da              LDR      r2,[r3,#0x1c]  ; rki_avar1_stat_old
0001a8  ea200102          BIC      r1,r0,r2
0001ac  6219              STR      r1,[r3,#0x20]  ; rki_avar1_stat_new
;;;144    rki_avar1_ind_stat|=rki_avar1_stat_new;
0001ae  699c              LDR      r4,[r3,#0x18]  ; rki_avar1_ind_stat
0001b0  ea440401          ORR      r4,r4,r1
;;;145    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
0001b4  ea220200          BIC      r2,r2,r0
0001b8  ea6f0102          MVN      r1,r2
0001bc  6259              STR      r1,[r3,#0x24]  ; rki_avar1_stat_offed
;;;146    rki_avar1_ind_stat&=rki_avar1_stat_offed;
0001be  ea040401          AND      r4,r4,r1
0001c2  619c              STR      r4,[r3,#0x18]  ; rki_avar1_ind_stat
;;;147    rki_avar1_stat_old=rki_avar1_stat;
0001c4  61d8              STR      r0,[r3,#0x1c]  ; rki_avar1_stat_old
;;;148    /*
;;;149    rki_avarI1_stat=status_di1;
;;;150    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;151    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;152    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;153    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;154    rki_avarI1_stat_old=rki_avarI1_stat;
;;;155    
;;;156    rki_avarI2_stat=status_di2;
;;;157    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;158    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;159    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;160    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;161    rki_avarI2_stat_old=rki_avarI2_stat;
;;;162    */
;;;163    //oleg_end
;;;164    }
0001c6  bd30              POP      {r4,r5,pc}
;;;165    
                          ENDP

                  reload_hndl PROC
;;;166    //-----------------------------------------------
;;;167    void reload_hndl(void)
0001c8  b5f8              PUSH     {r3-r7,lr}
;;;168    {
;;;169    
;;;170    char data[4];
;;;171    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;172    
;;;173    event_ptr=lc640_read_int(PTR_EVENT_LOG);
0001ca  f44f6560          MOV      r5,#0xe00
0001ce  4628              MOV      r0,r5
0001d0  f7fffffe          BL       lc640_read_int
;;;174    event_ptr++;	
0001d4  f1000001          ADD      r0,r0,#1
0001d8  4604              MOV      r4,r0
;;;175    if(event_ptr>63)event_ptr=0;	
0001da  2c3f              CMP      r4,#0x3f
0001dc  d901              BLS      |L1.482|
0001de  f04f0400          MOV      r4,#0
                  |L1.482|
;;;176    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
0001e2  b221              SXTH     r1,r4
0001e4  4628              MOV      r0,r5
0001e6  f7fffffe          BL       lc640_write_int
;;;177    	
;;;178    event_cnt=lc640_read_int(CNT_EVENT_LOG);
0001ea  f6406602          MOV      r6,#0xe02
0001ee  4630              MOV      r0,r6
0001f0  f7fffffe          BL       lc640_read_int
;;;179    if(event_cnt!=63)event_cnt=event_ptr;
0001f4  283f              CMP      r0,#0x3f
0001f6  d000              BEQ      |L1.506|
0001f8  4620              MOV      r0,r4
                  |L1.506|
;;;180    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
0001fa  b201              SXTH     r1,r0
0001fc  4630              MOV      r0,r6
0001fe  f7fffffe          BL       lc640_write_int
;;;181    	
;;;182    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000202  4628              MOV      r0,r5
000204  f7fffffe          BL       lc640_read_int
000208  f44f6180          MOV      r1,#0x400
00020c  eb011440          ADD      r4,r1,r0,LSL #5
;;;183    	
;;;184    data[0]='U';
000210  f04f0055          MOV      r0,#0x55
000214  f88d0000          STRB     r0,[sp,#0]
;;;185    data[1]=0;
000218  f04f0600          MOV      r6,#0
00021c  f88d6001          STRB     r6,[sp,#1]
;;;186    data[2]='R';
000220  f04f0052          MOV      r0,#0x52
000224  f88d0002          STRB     r0,[sp,#2]
;;;187    data[3]=0;
000228  f88d6003          STRB     r6,[sp,#3]
;;;188    lc640_write_long_ptr(lc640_adr,data);
00022c  4669              MOV      r1,sp
00022e  4620              MOV      r0,r4
000230  f7fffffe          BL       lc640_write_long_ptr
;;;189    
;;;190    data[0]=0;
;;;191    data[1]=0;
;;;192    data[2]=0;
;;;193    data[3]=0;
000234  9600              STR      r6,[sp,#0]
;;;194    lc640_write_long_ptr(lc640_adr+4,data);
000236  4669              MOV      r1,sp
000238  1d20              ADDS     r0,r4,#4
00023a  f7fffffe          BL       lc640_write_long_ptr
;;;195    
;;;196    data[0]=LPC_RTC->YEAR;
00023e  4d7a              LDR      r5,|L1.1064|
000240  8ba8              LDRH     r0,[r5,#0x1c]
000242  f88d0000          STRB     r0,[sp,#0]
;;;197    data[1]=LPC_RTC->MONTH;
000246  7e28              LDRB     r0,[r5,#0x18]
000248  f88d0001          STRB     r0,[sp,#1]
;;;198    data[2]=LPC_RTC->DOM;
00024c  7b28              LDRB     r0,[r5,#0xc]
00024e  f88d0002          STRB     r0,[sp,#2]
;;;199    data[3]=0;
000252  f88d6003          STRB     r6,[sp,#3]
;;;200    lc640_write_long_ptr(lc640_adr+8,data);
000256  4669              MOV      r1,sp
000258  f1040008          ADD      r0,r4,#8
00025c  f7fffffe          BL       lc640_write_long_ptr
;;;201    
;;;202    data[0]=LPC_RTC->HOUR;
000260  7a28              LDRB     r0,[r5,#8]
000262  f88d0000          STRB     r0,[sp,#0]
;;;203    data[1]=LPC_RTC->MIN;
000266  7928              LDRB     r0,[r5,#4]
000268  f88d0001          STRB     r0,[sp,#1]
;;;204    data[2]=LPC_RTC->SEC;
00026c  7828              LDRB     r0,[r5,#0]
00026e  f88d0002          STRB     r0,[sp,#2]
;;;205    data[3]=LPC_SC->RSID;
000272  486e              LDR      r0,|L1.1068|
000274  f8d00180          LDR      r0,[r0,#0x180]
000278  f88d0003          STRB     r0,[sp,#3]
;;;206    
;;;207    lc640_write_long_ptr(lc640_adr+12,data);
00027c  4669              MOV      r1,sp
00027e  f104000c          ADD      r0,r4,#0xc
000282  f7fffffe          BL       lc640_write_long_ptr
;;;208    	
;;;209    data[0]='A';
000286  f04f0541          MOV      r5,#0x41
00028a  f88d5000          STRB     r5,[sp,#0]
;;;210    data[1]='A';
00028e  f88d5001          STRB     r5,[sp,#1]
;;;211    data[2]='A';
000292  f88d5002          STRB     r5,[sp,#2]
;;;212    data[3]='A';
000296  f88d5003          STRB     r5,[sp,#3]
;;;213    lc640_write_long_ptr(lc640_adr+16,data);
00029a  4669              MOV      r1,sp
00029c  f1040010          ADD      r0,r4,#0x10
0002a0  f7fffffe          BL       lc640_write_long_ptr
;;;214    	
;;;215    data[0]='A';
0002a4  f88d5000          STRB     r5,[sp,#0]
;;;216    data[1]='A';
0002a8  f88d5001          STRB     r5,[sp,#1]
;;;217    data[2]='A';
0002ac  f88d5002          STRB     r5,[sp,#2]
;;;218    data[3]='A';
0002b0  f88d5003          STRB     r5,[sp,#3]
;;;219    lc640_write_long_ptr(lc640_adr+20,data);
0002b4  4669              MOV      r1,sp
0002b6  f1040014          ADD      r0,r4,#0x14
0002ba  f7fffffe          BL       lc640_write_long_ptr
;;;220    	
;;;221    data[0]='A';
0002be  f88d5000          STRB     r5,[sp,#0]
;;;222    data[1]='A';
0002c2  f88d5001          STRB     r5,[sp,#1]
;;;223    data[2]='A';
0002c6  f88d5002          STRB     r5,[sp,#2]
;;;224    data[3]='A';
0002ca  f88d5003          STRB     r5,[sp,#3]
;;;225    lc640_write_long_ptr(lc640_adr+24,data);
0002ce  4669              MOV      r1,sp
0002d0  f1040018          ADD      r0,r4,#0x18
0002d4  f7fffffe          BL       lc640_write_long_ptr
;;;226    	
;;;227    data[0]='A';
0002d8  f88d5000          STRB     r5,[sp,#0]
;;;228    data[1]='A';
0002dc  f88d5001          STRB     r5,[sp,#1]
;;;229    data[2]='A';
0002e0  f88d5002          STRB     r5,[sp,#2]
;;;230    data[3]='A';
0002e4  f88d5003          STRB     r5,[sp,#3]
;;;231    lc640_write_long_ptr(lc640_adr+28,data);				
0002e8  4669              MOV      r1,sp
0002ea  f104001c          ADD      r0,r4,#0x1c
0002ee  f7fffffe          BL       lc640_write_long_ptr
;;;232    	
;;;233    	
;;;234    }
0002f2  bdf8              POP      {r3-r7,pc}
;;;235    
                          ENDP

                  avar_unet_hndl PROC
;;;236    //-----------------------------------------------
;;;237    void avar_unet_hndl(char in)
0002f4  e92d43f8          PUSH     {r3-r9,lr}
;;;238    {
;;;239    
;;;240    char data[4];
;;;241    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;242    
;;;243    
;;;244    if(in==1)
;;;245    	{
;;;246    	net_av=1;
;;;247    
;;;248    	//beep_init(0x01L,'O');
;;;249    	//a.av.bAN=1;
;;;250    
;;;251    
;;;252    	//beep_init(0x33333333,'A');
;;;253    	 
;;;254    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;255    	event_ptr++;	
;;;256    	if(event_ptr>63)event_ptr=0;	
;;;257    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;258    	
;;;259         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;260    	if(event_cnt!=63)event_cnt=event_ptr;
;;;261    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;262    	
;;;263    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;264    	
;;;265    	data[0]='P';
;;;266    	data[1]=0;
;;;267    	data[2]='A';
;;;268    	data[3]=0;
;;;269    	lc640_write_long_ptr(lc640_adr,data);
;;;270    
;;;271    	data[0]=0;//*((char*)&Unet_store);
;;;272    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;273    	data[2]=0;
;;;274    	data[3]=0;
;;;275    	lc640_write_long_ptr(lc640_adr+4,data);
;;;276    
;;;277    	data[0]=LPC_RTC->YEAR;
0002f8  4f4b              LDR      r7,|L1.1064|
0002fa  4941              LDR      r1,|L1.1024|
0002fc  3f20              SUBS     r7,r7,#0x20
0002fe  f44f6560          MOV      r5,#0xe00             ;254
000302  f04f0800          MOV      r8,#0                 ;256
000306  f44f6980          MOV      r9,#0x400             ;263
00030a  2801              CMP      r0,#1                 ;244
00030c  d002              BEQ      |L1.788|
;;;278    	data[1]=LPC_RTC->MONTH;
;;;279    	data[2]=LPC_RTC->DOM;
;;;280    	data[3]=0;
;;;281    	lc640_write_long_ptr(lc640_adr+8,data);
;;;282    
;;;283    	data[0]=LPC_RTC->HOUR;
;;;284    	data[1]=LPC_RTC->MIN;
;;;285    	data[2]=LPC_RTC->SEC;
;;;286    	data[3]=0;
;;;287    	lc640_write_long_ptr(lc640_adr+12,data);
;;;288    	
;;;289    	data[0]='A';
;;;290    	data[1]='A';
;;;291    	data[2]='A';
;;;292    	data[3]='A';
;;;293    	lc640_write_long_ptr(lc640_adr+16,data);
;;;294    	
;;;295    	data[0]='A';
;;;296    	data[1]='A';
;;;297    	data[2]='A';
;;;298    	data[3]='A';
;;;299    	lc640_write_long_ptr(lc640_adr+20,data);
;;;300    	
;;;301    	data[0]='A';
;;;302    	data[1]='A';
;;;303    	data[2]='A';
;;;304    	data[3]='A';
;;;305    	lc640_write_long_ptr(lc640_adr+24,data);
;;;306    	
;;;307    	data[0]='A';
;;;308    	data[1]='A';
;;;309    	data[2]='A';
;;;310    	data[3]='A';
;;;311    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;312    	
;;;313    /*	memo_out0[0]=0x55;
;;;314         memo_out0[1]=0x00+2;
;;;315         memo_out0[2]=1;
;;;316         memo_out0[3]=0x0b;
;;;317         memo_out0[4]=0x55;
;;;318         memo_out0[5]=0x55; 
;;;319         	
;;;320         memo_out0[6]=crc_87(memo_out0,6);
;;;321    	memo_out0[7]=crc_95(memo_out0,6);
;;;322         usart_out_adr0(memo_out0,8); 
;;;323    	*/
;;;324    	snmp_trap_send("Main power alarm",2,1,0);
;;;325    	}
;;;326    
;;;327    else if(in==0)
00030e  2800              CMP      r0,#0
000310  d075              BEQ      |L1.1022|
000312  e140              B        |L1.1430|
                  |L1.788|
000314  f04f0001          MOV      r0,#1                 ;246
000318  7008              STRB     r0,[r1,#0]            ;246
00031a  4628              MOV      r0,r5                 ;254
00031c  f7fffffe          BL       lc640_read_int
000320  f1000001          ADD      r0,r0,#1              ;255
000324  4604              MOV      r4,r0                 ;255
000326  2c3f              CMP      r4,#0x3f              ;256
000328  d901              BLS      |L1.814|
00032a  f04f0400          MOV      r4,#0                 ;256
                  |L1.814|
00032e  b221              SXTH     r1,r4                 ;257
000330  4628              MOV      r0,r5                 ;257
000332  f7fffffe          BL       lc640_write_int
000336  f6406602          MOV      r6,#0xe02             ;259
00033a  4630              MOV      r0,r6                 ;259
00033c  f7fffffe          BL       lc640_read_int
000340  283f              CMP      r0,#0x3f              ;260
000342  d000              BEQ      |L1.838|
000344  4620              MOV      r0,r4                 ;260
                  |L1.838|
000346  b201              SXTH     r1,r0                 ;261
000348  4630              MOV      r0,r6                 ;261
00034a  f7fffffe          BL       lc640_write_int
00034e  4628              MOV      r0,r5                 ;263
000350  f7fffffe          BL       lc640_read_int
000354  eb091540          ADD      r5,r9,r0,LSL #5       ;263
000358  f04f0050          MOV      r0,#0x50              ;265
00035c  f88d0000          STRB     r0,[sp,#0]            ;265
000360  f88d8001          STRB     r8,[sp,#1]            ;266
000364  f04f0441          MOV      r4,#0x41              ;267
000368  f88d4002          STRB     r4,[sp,#2]            ;267
00036c  f88d8003          STRB     r8,[sp,#3]            ;268
000370  4669              MOV      r1,sp                 ;269
000372  4628              MOV      r0,r5                 ;269
000374  f7fffffe          BL       lc640_write_long_ptr
000378  f8cd8000          STR      r8,[sp,#0]            ;274
00037c  4669              MOV      r1,sp                 ;275
00037e  1d28              ADDS     r0,r5,#4              ;275
000380  f7fffffe          BL       lc640_write_long_ptr
000384  f1070720          ADD      r7,r7,#0x20           ;277
000388  8bb8              LDRH     r0,[r7,#0x1c]         ;277
00038a  f88d0000          STRB     r0,[sp,#0]            ;277
00038e  7e38              LDRB     r0,[r7,#0x18]         ;278
000390  f88d0001          STRB     r0,[sp,#1]            ;278
000394  7b38              LDRB     r0,[r7,#0xc]          ;279
000396  f88d0002          STRB     r0,[sp,#2]            ;279
00039a  f88d8003          STRB     r8,[sp,#3]            ;280
00039e  4669              MOV      r1,sp                 ;281
0003a0  f1050008          ADD      r0,r5,#8              ;281
0003a4  f7fffffe          BL       lc640_write_long_ptr
0003a8  7a38              LDRB     r0,[r7,#8]            ;283
0003aa  f88d0000          STRB     r0,[sp,#0]            ;283
0003ae  7938              LDRB     r0,[r7,#4]            ;284
0003b0  f88d0001          STRB     r0,[sp,#1]            ;284
0003b4  7838              LDRB     r0,[r7,#0]            ;285
0003b6  f88d0002          STRB     r0,[sp,#2]            ;285
0003ba  f88d8003          STRB     r8,[sp,#3]            ;286
0003be  4669              MOV      r1,sp                 ;287
0003c0  f105000c          ADD      r0,r5,#0xc            ;287
0003c4  f7fffffe          BL       lc640_write_long_ptr
0003c8  f88d4000          STRB     r4,[sp,#0]            ;289
0003cc  f88d4001          STRB     r4,[sp,#1]            ;290
0003d0  f88d4002          STRB     r4,[sp,#2]            ;291
0003d4  f88d4003          STRB     r4,[sp,#3]            ;292
0003d8  4669              MOV      r1,sp                 ;293
0003da  f1050010          ADD      r0,r5,#0x10           ;293
0003de  f7fffffe          BL       lc640_write_long_ptr
0003e2  f88d4000          STRB     r4,[sp,#0]            ;295
0003e6  f88d4001          STRB     r4,[sp,#1]            ;296
0003ea  f88d4002          STRB     r4,[sp,#2]            ;297
0003ee  f88d4003          STRB     r4,[sp,#3]            ;298
0003f2  4669              MOV      r1,sp                 ;299
0003f4  f1050014          ADD      r0,r5,#0x14           ;299
0003f8  f7fffffe          BL       lc640_write_long_ptr
0003fc  e018              B        |L1.1072|
                  |L1.1022|
0003fe  e038              B        |L1.1138|
                  |L1.1024|
                          DCD      net_av
                  |L1.1028|
                          DCD      ||.data||
                  |L1.1032|
                          DCD      bat
                  |L1.1036|
                          DCD      bps
                  |L1.1040|
                          DCD      sk_av_stat
                  |L1.1044|
                          DCD      SK_ZVUK_EN
                  |L1.1048|
                          DCD      AV_OFF_AVT
                  |L1.1052|
                          DCD      0xeffffffe
                  |L1.1056|
                          DCD      status_izm_r
                  |L1.1060|
                          DCD      sk_alarm
                  |L1.1064|
                          DCD      0x40024020
                  |L1.1068|
                          DCD      0x400fc000
                  |L1.1072|
000430  f88d4000          STRB     r4,[sp,#0]            ;301
000434  f88d4001          STRB     r4,[sp,#1]            ;302
000438  f88d4002          STRB     r4,[sp,#2]            ;303
00043c  f88d4003          STRB     r4,[sp,#3]            ;304
000440  4669              MOV      r1,sp                 ;305
000442  f1050018          ADD      r0,r5,#0x18           ;305
000446  f7fffffe          BL       lc640_write_long_ptr
00044a  f88d4000          STRB     r4,[sp,#0]            ;307
00044e  f88d4001          STRB     r4,[sp,#1]            ;308
000452  f88d4002          STRB     r4,[sp,#2]            ;309
000456  f88d4003          STRB     r4,[sp,#3]            ;310
00045a  4669              MOV      r1,sp                 ;311
00045c  f105001c          ADD      r0,r5,#0x1c           ;311
000460  f7fffffe          BL       lc640_write_long_ptr
000464  2300              MOVS     r3,#0                 ;324
000466  2201              MOVS     r2,#1                 ;324
000468  2102              MOVS     r1,#2                 ;324
00046a  a0f6              ADR      r0,|L1.2116|
00046c  f7fffffe          BL       snmp_trap_send
000470  e091              B        |L1.1430|
                  |L1.1138|
;;;328    	{
;;;329    	net_av=0;
000472  f8818000          STRB     r8,[r1,#0]
;;;330    
;;;331      /*
;;;332    	SET_REG(C2GSR,3,24,8);
;;;333    	C2MOD=0;
;;;334    	bOUT_FREE2=1;*/
;;;335    
;;;336    
;;;337    	//C2MOD=0;
;;;338    
;;;339    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;340    
;;;341         //beep_init(0x02L,'O');
;;;342    	//a_.av.bAN=0;
;;;343    	SET_REG(avar_stat,0,0,1);
000476  48f8              LDR      r0,|L1.2136|
000478  6801              LDR      r1,[r0,#0]  ; avar_stat
00047a  f0210101          BIC      r1,r1,#1
00047e  6001              STR      r1,[r0,#0]  ; avar_stat
;;;344    
;;;345    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;346    	
;;;347    	if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
000480  49f6              LDR      r1,|L1.2140|
000482  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
000484  b119              CBZ      r1,|L1.1166|
000486  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
000488  f0210101          BIC      r1,r1,#1
00048c  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.1166|
;;;348    
;;;349         event_ptr=lc640_read_int(PTR_EVENT_LOG);
00048e  4628              MOV      r0,r5
000490  f7fffffe          BL       lc640_read_int
000494  4606              MOV      r6,r0
;;;350    	event_ptr_find=event_ptr;
000496  4634              MOV      r4,r6
                  |L1.1176|
;;;351    avar_unet_hndl_lbl1:
;;;352    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000498  eb091544          ADD      r5,r9,r4,LSL #5
;;;353    
;;;354         lc640_read_long_ptr(lc640_adr,data);
00049c  4669              MOV      r1,sp
00049e  4628              MOV      r0,r5
0004a0  f7fffffe          BL       lc640_read_long_ptr
;;;355         
;;;356         if(!((data[0]=='P')&&(data[1]==0)&&(data[2]=='A')))
0004a4  f89d0000          LDRB     r0,[sp,#0]
0004a8  2850              CMP      r0,#0x50
0004aa  d106              BNE      |L1.1210|
0004ac  f89d0001          LDRB     r0,[sp,#1]
0004b0  b918              CBNZ     r0,|L1.1210|
0004b2  f89d0002          LDRB     r0,[sp,#2]
0004b6  2841              CMP      r0,#0x41
0004b8  d008              BEQ      |L1.1228|
                  |L1.1210|
;;;357         	{        
;;;358         	if(event_ptr_find)event_ptr_find--;
0004ba  b114              CBZ      r4,|L1.1218|
0004bc  f1a40401          SUB      r4,r4,#1
0004c0  e001              B        |L1.1222|
                  |L1.1218|
;;;359         	else event_ptr_find=63;
0004c2  f04f043f          MOV      r4,#0x3f
                  |L1.1222|
;;;360         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0004c6  42b4              CMP      r4,r6
0004c8  d1e6              BNE      |L1.1176|
0004ca  e064              B        |L1.1430|
                  |L1.1228|
;;;361         	else goto avar_unet_hndl_lbl1;
;;;362         	}
;;;363         else 
;;;364         	{
;;;365         	lc640_read_long_ptr(lc640_adr+16,data);
0004cc  4669              MOV      r1,sp
0004ce  f1050010          ADD      r0,r5,#0x10
0004d2  f7fffffe          BL       lc640_read_long_ptr
;;;366         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0004d6  f89d0000          LDRB     r0,[sp,#0]
0004da  2841              CMP      r0,#0x41
0004dc  d10b              BNE      |L1.1270|
0004de  f89d0001          LDRB     r0,[sp,#1]
0004e2  2841              CMP      r0,#0x41
0004e4  d107              BNE      |L1.1270|
0004e6  f89d0002          LDRB     r0,[sp,#2]
0004ea  2841              CMP      r0,#0x41
0004ec  d103              BNE      |L1.1270|
0004ee  f89d0003          LDRB     r0,[sp,#3]
0004f2  2841              CMP      r0,#0x41
0004f4  d008              BEQ      |L1.1288|
                  |L1.1270|
;;;367         		{        
;;;368         		if(event_ptr_find)event_ptr_find--;
0004f6  b114              CBZ      r4,|L1.1278|
0004f8  f1a40401          SUB      r4,r4,#1
0004fc  e001              B        |L1.1282|
                  |L1.1278|
;;;369             		else event_ptr_find=63;
0004fe  f04f043f          MOV      r4,#0x3f
                  |L1.1282|
;;;370             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000502  42b4              CMP      r4,r6
000504  d1c8              BNE      |L1.1176|
000506  e046              B        |L1.1430|
                  |L1.1288|
;;;371         		else goto avar_unet_hndl_lbl1;
;;;372         		}
;;;373    
;;;374         	}	
;;;375    	
;;;376    	data[0]=LPC_RTC->YEAR;
000508  f1070720          ADD      r7,r7,#0x20
00050c  8bb8              LDRH     r0,[r7,#0x1c]
00050e  f88d0000          STRB     r0,[sp,#0]
;;;377    	data[1]=LPC_RTC->MONTH;
000512  7e38              LDRB     r0,[r7,#0x18]
000514  f88d0001          STRB     r0,[sp,#1]
;;;378    	data[2]=LPC_RTC->DOM;
000518  7b38              LDRB     r0,[r7,#0xc]
00051a  f88d0002          STRB     r0,[sp,#2]
;;;379    	data[3]=0;
00051e  f88d8003          STRB     r8,[sp,#3]
;;;380    	lc640_write_long_ptr(lc640_adr+16,data);
000522  4669              MOV      r1,sp
000524  f1050010          ADD      r0,r5,#0x10
000528  f7fffffe          BL       lc640_write_long_ptr
;;;381    
;;;382    	data[0]=LPC_RTC->HOUR;
00052c  7a38              LDRB     r0,[r7,#8]
00052e  f88d0000          STRB     r0,[sp,#0]
;;;383    	data[1]=LPC_RTC->MIN;
000532  7938              LDRB     r0,[r7,#4]
000534  f88d0001          STRB     r0,[sp,#1]
;;;384    	data[2]=LPC_RTC->SEC;
000538  7838              LDRB     r0,[r7,#0]
00053a  f88d0002          STRB     r0,[sp,#2]
;;;385    	data[3]=0;
00053e  f88d8003          STRB     r8,[sp,#3]
;;;386    	lc640_write_long_ptr(lc640_adr+20,data); 
000542  4669              MOV      r1,sp
000544  f1050014          ADD      r0,r5,#0x14
000548  f7fffffe          BL       lc640_write_long_ptr
;;;387    	
;;;388    	data[0]=*((char*)(&net_Ustore));
00054c  48c4              LDR      r0,|L1.2144|
00054e  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000550  f88d1000          STRB     r1,[sp,#0]
;;;389    	data[1]=*(((char*)(&net_Ustore))+1);
000554  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000556  f88d0001          STRB     r0,[sp,#1]
;;;390    	data[2]='B';
00055a  f04f0442          MOV      r4,#0x42
00055e  f88d4002          STRB     r4,[sp,#2]
;;;391    	data[3]='B';
000562  f88d4003          STRB     r4,[sp,#3]
;;;392    	lc640_write_long_ptr(lc640_adr+24,data);
000566  4669              MOV      r1,sp
000568  f1050018          ADD      r0,r5,#0x18
00056c  f7fffffe          BL       lc640_write_long_ptr
;;;393    	
;;;394    	data[0]='B';
000570  f88d4000          STRB     r4,[sp,#0]
;;;395    	data[1]='B';
000574  f88d4001          STRB     r4,[sp,#1]
;;;396    	data[2]='B';
000578  f88d4002          STRB     r4,[sp,#2]
;;;397    	data[3]='B';
00057c  f88d4003          STRB     r4,[sp,#3]
;;;398    	lc640_write_long_ptr(lc640_adr+28,data);	
000580  4669              MOV      r1,sp
000582  f105001c          ADD      r0,r5,#0x1c
000586  f7fffffe          BL       lc640_write_long_ptr
;;;399    	
;;;400    /*	memo_out0[0]=0x55;
;;;401         memo_out0[1]=0x00+2;
;;;402         memo_out0[2]=1;
;;;403         memo_out0[3]=0x0b;
;;;404         memo_out0[4]=0xaa;
;;;405         memo_out0[5]=0xaa; 
;;;406         	
;;;407         memo_out0[6]=crc_87(memo_out0,6);
;;;408    	memo_out0[7]=crc_95(memo_out0,6);
;;;409         usart_out_adr0(memo_out0,8); */
;;;410         snmp_trap_send("Main power alarm  clear",2,1,1);	
00058a  2301              MOVS     r3,#1
00058c  461a              MOV      r2,r3
00058e  2102              MOVS     r1,#2
000590  a0b4              ADR      r0,|L1.2148|
000592  f7fffffe          BL       snmp_trap_send
                  |L1.1430|
;;;411    	}
;;;412    avar_unet_hndl_end:
;;;413    	__nop();		
000596  bf00              NOP      
;;;414    }
000598  e8bd83f8          POP      {r3-r9,pc}
;;;415    
                          ENDP

                  avar_uout_hndl PROC
;;;417    //-----------------------------------------------
;;;418    void avar_uout_hndl(char in)
00059c  e92d4ff8          PUSH     {r3-r11,lr}
;;;419    {
;;;420    
;;;421    char data[4];
;;;422    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;423    char avar_data=0;
;;;424    
;;;425    if(in==1)
;;;426    	{
;;;427    	//net_av=1;
;;;428    
;;;429    	//beep_init(0x01L,'O');
;;;430    	//a.av.bAN=1;
;;;431    
;;;432    
;;;433    	//beep_init(0x33333333,'A');
;;;434    
;;;435    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;436    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;437    	
;;;438    	avar_data=uout_av;
;;;439    		 
;;;440    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;441    	event_ptr++;	
;;;442    	if(event_ptr>63)event_ptr=0;	
;;;443    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;444    	
;;;445        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;446    	if(event_cnt!=63)event_cnt=event_ptr;
;;;447    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;448    	
;;;449    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;450    	
;;;451    	data[0]='Q';
;;;452    	data[1]=0;
;;;453    	data[2]='A';
;;;454    	data[3]=avar_data;
;;;455    	lc640_write_long_ptr(lc640_adr,data);
;;;456    
;;;457    	 //load_U=4321;
;;;458    
;;;459    	data[0]=*((char*)&load_U);
;;;460    	data[1]=*(((char*)&load_U)+1);
;;;461    	data[2]=0;
;;;462    	data[3]=0;
;;;463    	lc640_write_long_ptr(lc640_adr+4,data);
;;;464    
;;;465    	data[0]=LPC_RTC->YEAR;
0005a0  4fb6              LDR      r7,|L1.2172|
0005a2  49b7              LDR      r1,|L1.2176|
0005a4  f44f6560          MOV      r5,#0xe00             ;440
0005a8  f04f0800          MOV      r8,#0                 ;423
0005ac  f44f6980          MOV      r9,#0x400             ;449
0005b0  2801              CMP      r0,#1                 ;425
0005b2  d002              BEQ      |L1.1466|
;;;466    	data[1]=LPC_RTC->MONTH;
;;;467    	data[2]=LPC_RTC->DOM;
;;;468    	data[3]=0;
;;;469    	lc640_write_long_ptr(lc640_adr+8,data);
;;;470    
;;;471    	data[0]=LPC_RTC->HOUR;
;;;472    	data[1]=LPC_RTC->MIN;
;;;473    	data[2]=LPC_RTC->SEC;
;;;474    	data[3]=0;
;;;475    	lc640_write_long_ptr(lc640_adr+12,data);
;;;476    	
;;;477    	data[0]='A';
;;;478    	data[1]='A';
;;;479    	data[2]='A';
;;;480    	data[3]='A';
;;;481    	lc640_write_long_ptr(lc640_adr+16,data);
;;;482    	
;;;483    	data[0]='A';
;;;484    	data[1]='A';
;;;485    	data[2]='A';
;;;486    	data[3]='A';
;;;487    	lc640_write_long_ptr(lc640_adr+20,data);
;;;488    	
;;;489    	data[0]='A';
;;;490    	data[1]='A';
;;;491    	data[2]='A';
;;;492    	data[3]='A';
;;;493    	lc640_write_long_ptr(lc640_adr+24,data);
;;;494    	
;;;495    	data[0]='A';
;;;496    	data[1]='A';
;;;497    	data[2]='A';
;;;498    	data[3]='A';
;;;499    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;500    	
;;;501    /*	memo_out0[0]=0x55;
;;;502         memo_out0[1]=0x00+2;
;;;503         memo_out0[2]=1;
;;;504         memo_out0[3]=0x0b;
;;;505         memo_out0[4]=0x55;
;;;506         memo_out0[5]=0x55; 
;;;507         	
;;;508         memo_out0[6]=crc_87(memo_out0,6);
;;;509    	memo_out0[7]=crc_95(memo_out0,6);
;;;510         usart_out_adr0(memo_out0,8); 
;;;511    	*/
;;;512    	//snmp_trap_send("Main power is off",2,1,0);
;;;513    	}
;;;514    
;;;515    else if(in==0)
0005b4  2800              CMP      r0,#0
0005b6  d07d              BEQ      |L1.1716|
0005b8  e132              B        |L1.2080|
                  |L1.1466|
0005ba  f8dfa2c8          LDR      r10,|L1.2180|
0005be  4ab2              LDR      r2,|L1.2184|
0005c0  f9ba0000          LDRSH    r0,[r10,#0]           ;435  ; load_U
0005c4  f9b22000          LDRSH    r2,[r2,#0]            ;435  ; U_OUT_KONTR_MAX
0005c8  4290              CMP      r0,r2                 ;435
0005ca  dd02              BLE      |L1.1490|
0005cc  f04f0201          MOV      r2,#1                 ;435
0005d0  700a              STRB     r2,[r1,#0]            ;435
                  |L1.1490|
0005d2  4aae              LDR      r2,|L1.2188|
0005d4  f9b22000          LDRSH    r2,[r2,#0]            ;436  ; U_OUT_KONTR_MIN
0005d8  4290              CMP      r0,r2                 ;436
0005da  da02              BGE      |L1.1506|
0005dc  f04f0002          MOV      r0,#2                 ;436
0005e0  7008              STRB     r0,[r1,#0]            ;436
                  |L1.1506|
0005e2  780e              LDRB     r6,[r1,#0]            ;438  ; uout_av
0005e4  4628              MOV      r0,r5                 ;440
0005e6  f7fffffe          BL       lc640_read_int
0005ea  f1000001          ADD      r0,r0,#1              ;441
0005ee  4604              MOV      r4,r0                 ;441
0005f0  2c3f              CMP      r4,#0x3f              ;442
0005f2  d901              BLS      |L1.1528|
0005f4  f04f0400          MOV      r4,#0                 ;442
                  |L1.1528|
0005f8  b221              SXTH     r1,r4                 ;443
0005fa  4628              MOV      r0,r5                 ;443
0005fc  f7fffffe          BL       lc640_write_int
000600  f6406b02          MOV      r11,#0xe02            ;445
000604  4658              MOV      r0,r11                ;445
000606  f7fffffe          BL       lc640_read_int
00060a  283f              CMP      r0,#0x3f              ;446
00060c  d000              BEQ      |L1.1552|
00060e  4620              MOV      r0,r4                 ;446
                  |L1.1552|
000610  b201              SXTH     r1,r0                 ;447
000612  4658              MOV      r0,r11                ;447
000614  f7fffffe          BL       lc640_write_int
000618  4628              MOV      r0,r5                 ;449
00061a  f7fffffe          BL       lc640_read_int
00061e  eb091540          ADD      r5,r9,r0,LSL #5       ;449
000622  f04f0051          MOV      r0,#0x51              ;451
000626  f88d0000          STRB     r0,[sp,#0]            ;451
00062a  f88d8001          STRB     r8,[sp,#1]            ;452
00062e  f04f0441          MOV      r4,#0x41              ;453
000632  f88d4002          STRB     r4,[sp,#2]            ;453
000636  f88d6003          STRB     r6,[sp,#3]            ;454
00063a  4669              MOV      r1,sp                 ;455
00063c  4628              MOV      r0,r5                 ;455
00063e  f7fffffe          BL       lc640_write_long_ptr
000642  f89a0000          LDRB     r0,[r10,#0]           ;459  ; load_U
000646  f88d0000          STRB     r0,[sp,#0]            ;459
00064a  f89a0001          LDRB     r0,[r10,#1]           ;460  ; load_U
00064e  f88d0001          STRB     r0,[sp,#1]            ;460
000652  f88d8002          STRB     r8,[sp,#2]            ;461
000656  f88d8003          STRB     r8,[sp,#3]            ;462
00065a  4669              MOV      r1,sp                 ;463
00065c  1d28              ADDS     r0,r5,#4              ;463
00065e  f7fffffe          BL       lc640_write_long_ptr
000662  f1070720          ADD      r7,r7,#0x20           ;465
000666  8bb8              LDRH     r0,[r7,#0x1c]         ;465
000668  f88d0000          STRB     r0,[sp,#0]            ;465
00066c  7e38              LDRB     r0,[r7,#0x18]         ;466
00066e  f88d0001          STRB     r0,[sp,#1]            ;466
000672  7b38              LDRB     r0,[r7,#0xc]          ;467
000674  f88d0002          STRB     r0,[sp,#2]            ;467
000678  f88d8003          STRB     r8,[sp,#3]            ;468
00067c  4669              MOV      r1,sp                 ;469
00067e  f1050008          ADD      r0,r5,#8              ;469
000682  f7fffffe          BL       lc640_write_long_ptr
000686  7a38              LDRB     r0,[r7,#8]            ;471
000688  f88d0000          STRB     r0,[sp,#0]            ;471
00068c  7938              LDRB     r0,[r7,#4]            ;472
00068e  f88d0001          STRB     r0,[sp,#1]            ;472
000692  7838              LDRB     r0,[r7,#0]            ;473
000694  f88d0002          STRB     r0,[sp,#2]            ;473
000698  f88d8003          STRB     r8,[sp,#3]            ;474
00069c  4669              MOV      r1,sp                 ;475
00069e  f105000c          ADD      r0,r5,#0xc            ;475
0006a2  f7fffffe          BL       lc640_write_long_ptr
0006a6  f88d4000          STRB     r4,[sp,#0]            ;477
0006aa  f88d4001          STRB     r4,[sp,#1]            ;478
0006ae  f88d4002          STRB     r4,[sp,#2]            ;479
0006b2  e000              B        |L1.1718|
                  |L1.1716|
0006b4  e02e              B        |L1.1812|
                  |L1.1718|
0006b6  f88d4003          STRB     r4,[sp,#3]            ;480
0006ba  4669              MOV      r1,sp                 ;481
0006bc  f1050010          ADD      r0,r5,#0x10           ;481
0006c0  f7fffffe          BL       lc640_write_long_ptr
0006c4  f88d4000          STRB     r4,[sp,#0]            ;483
0006c8  f88d4001          STRB     r4,[sp,#1]            ;484
0006cc  f88d4002          STRB     r4,[sp,#2]            ;485
0006d0  f88d4003          STRB     r4,[sp,#3]            ;486
0006d4  4669              MOV      r1,sp                 ;487
0006d6  f1050014          ADD      r0,r5,#0x14           ;487
0006da  f7fffffe          BL       lc640_write_long_ptr
0006de  f88d4000          STRB     r4,[sp,#0]            ;489
0006e2  f88d4001          STRB     r4,[sp,#1]            ;490
0006e6  f88d4002          STRB     r4,[sp,#2]            ;491
0006ea  f88d4003          STRB     r4,[sp,#3]            ;492
0006ee  4669              MOV      r1,sp                 ;493
0006f0  f1050018          ADD      r0,r5,#0x18           ;493
0006f4  f7fffffe          BL       lc640_write_long_ptr
0006f8  f88d4000          STRB     r4,[sp,#0]            ;495
0006fc  f88d4001          STRB     r4,[sp,#1]            ;496
000700  f88d4002          STRB     r4,[sp,#2]            ;497
000704  f88d4003          STRB     r4,[sp,#3]            ;498
000708  4669              MOV      r1,sp                 ;499
00070a  f105001c          ADD      r0,r5,#0x1c           ;499
00070e  f7fffffe          BL       lc640_write_long_ptr
000712  e085              B        |L1.2080|
                  |L1.1812|
;;;516    	{
;;;517    	uout_av=0;
000714  f8818000          STRB     r8,[r1,#0]
;;;518    
;;;519      /*
;;;520    	SET_REG(C2GSR,3,24,8);
;;;521    	C2MOD=0;
;;;522    	bOUT_FREE2=1;*/
;;;523    
;;;524    
;;;525    	//C2MOD=0;
;;;526    
;;;527    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;528    
;;;529         //beep_init(0x02L,'O');
;;;530    	//a_.av.bAN=0;
;;;531    //	SET_REG(avar_stat,0,0,1);
;;;532    
;;;533    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;534    	
;;;535    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;536    
;;;537        event_ptr=lc640_read_int(PTR_EVENT_LOG);
000718  4628              MOV      r0,r5
00071a  f7fffffe          BL       lc640_read_int
00071e  4606              MOV      r6,r0
;;;538    	event_ptr_find=event_ptr;
000720  4634              MOV      r4,r6
                  |L1.1826|
;;;539    avar_uout_hndl_lbl1:
;;;540    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000722  eb091544          ADD      r5,r9,r4,LSL #5
;;;541    
;;;542         lc640_read_long_ptr(lc640_adr,data);
000726  4669              MOV      r1,sp
000728  4628              MOV      r0,r5
00072a  f7fffffe          BL       lc640_read_long_ptr
;;;543         
;;;544         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
00072e  f89d0000          LDRB     r0,[sp,#0]
000732  2851              CMP      r0,#0x51
000734  d106              BNE      |L1.1860|
000736  f89d0001          LDRB     r0,[sp,#1]
00073a  b918              CBNZ     r0,|L1.1860|
00073c  f89d0002          LDRB     r0,[sp,#2]
000740  2841              CMP      r0,#0x41
000742  d008              BEQ      |L1.1878|
                  |L1.1860|
;;;545         	{        
;;;546         	if(event_ptr_find)event_ptr_find--;
000744  b114              CBZ      r4,|L1.1868|
000746  f1a40401          SUB      r4,r4,#1
00074a  e001              B        |L1.1872|
                  |L1.1868|
;;;547         	else event_ptr_find=63;
00074c  f04f043f          MOV      r4,#0x3f
                  |L1.1872|
;;;548         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000750  42b4              CMP      r4,r6
000752  d1e6              BNE      |L1.1826|
000754  e064              B        |L1.2080|
                  |L1.1878|
;;;549         	else goto avar_uout_hndl_lbl1;
;;;550         	}
;;;551         else 
;;;552         	{
;;;553         	lc640_read_long_ptr(lc640_adr+16,data);
000756  4669              MOV      r1,sp
000758  f1050010          ADD      r0,r5,#0x10
00075c  f7fffffe          BL       lc640_read_long_ptr
;;;554         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000760  f89d0000          LDRB     r0,[sp,#0]
000764  2841              CMP      r0,#0x41
000766  d10b              BNE      |L1.1920|
000768  f89d0001          LDRB     r0,[sp,#1]
00076c  2841              CMP      r0,#0x41
00076e  d107              BNE      |L1.1920|
000770  f89d0002          LDRB     r0,[sp,#2]
000774  2841              CMP      r0,#0x41
000776  d103              BNE      |L1.1920|
000778  f89d0003          LDRB     r0,[sp,#3]
00077c  2841              CMP      r0,#0x41
00077e  d008              BEQ      |L1.1938|
                  |L1.1920|
;;;555         		{        
;;;556         		if(event_ptr_find)event_ptr_find--;
000780  b114              CBZ      r4,|L1.1928|
000782  f1a40401          SUB      r4,r4,#1
000786  e001              B        |L1.1932|
                  |L1.1928|
;;;557             		else event_ptr_find=63;
000788  f04f043f          MOV      r4,#0x3f
                  |L1.1932|
;;;558             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
00078c  42b4              CMP      r4,r6
00078e  d1c8              BNE      |L1.1826|
000790  e046              B        |L1.2080|
                  |L1.1938|
;;;559         		else goto avar_uout_hndl_lbl1;
;;;560         		}
;;;561    
;;;562         	}	
;;;563    	
;;;564    	data[0]=LPC_RTC->YEAR;
000792  f1070720          ADD      r7,r7,#0x20
000796  8bb8              LDRH     r0,[r7,#0x1c]
000798  f88d0000          STRB     r0,[sp,#0]
;;;565    	data[1]=LPC_RTC->MONTH;
00079c  7e38              LDRB     r0,[r7,#0x18]
00079e  f88d0001          STRB     r0,[sp,#1]
;;;566    	data[2]=LPC_RTC->DOM;
0007a2  7b38              LDRB     r0,[r7,#0xc]
0007a4  f88d0002          STRB     r0,[sp,#2]
;;;567    	data[3]=0;
0007a8  f88d8003          STRB     r8,[sp,#3]
;;;568    	lc640_write_long_ptr(lc640_adr+16,data);
0007ac  4669              MOV      r1,sp
0007ae  f1050010          ADD      r0,r5,#0x10
0007b2  f7fffffe          BL       lc640_write_long_ptr
;;;569    
;;;570    	data[0]=LPC_RTC->HOUR;
0007b6  7a38              LDRB     r0,[r7,#8]
0007b8  f88d0000          STRB     r0,[sp,#0]
;;;571    	data[1]=LPC_RTC->MIN;
0007bc  7938              LDRB     r0,[r7,#4]
0007be  f88d0001          STRB     r0,[sp,#1]
;;;572    	data[2]=LPC_RTC->SEC;
0007c2  7838              LDRB     r0,[r7,#0]
0007c4  f88d0002          STRB     r0,[sp,#2]
;;;573    	data[3]=0;
0007c8  f88d8003          STRB     r8,[sp,#3]
;;;574    	lc640_write_long_ptr(lc640_adr+20,data); 
0007cc  4669              MOV      r1,sp
0007ce  f1050014          ADD      r0,r5,#0x14
0007d2  f7fffffe          BL       lc640_write_long_ptr
;;;575    	
;;;576    	data[0]=*((char*)(&net_Ustore));
0007d6  4822              LDR      r0,|L1.2144|
0007d8  7801              LDRB     r1,[r0,#0]  ; net_Ustore
0007da  f88d1000          STRB     r1,[sp,#0]
;;;577    	data[1]=*(((char*)(&net_Ustore))+1);
0007de  7840              LDRB     r0,[r0,#1]  ; net_Ustore
0007e0  f88d0001          STRB     r0,[sp,#1]
;;;578    	data[2]='B';
0007e4  f04f0442          MOV      r4,#0x42
0007e8  f88d4002          STRB     r4,[sp,#2]
;;;579    	data[3]='B';
0007ec  f88d4003          STRB     r4,[sp,#3]
;;;580    	lc640_write_long_ptr(lc640_adr+24,data);
0007f0  4669              MOV      r1,sp
0007f2  f1050018          ADD      r0,r5,#0x18
0007f6  f7fffffe          BL       lc640_write_long_ptr
;;;581    	
;;;582    	data[0]='B';
0007fa  f88d4000          STRB     r4,[sp,#0]
;;;583    	data[1]='B';
0007fe  f88d4001          STRB     r4,[sp,#1]
;;;584    	data[2]='B';
000802  f88d4002          STRB     r4,[sp,#2]
;;;585    	data[3]='B';
000806  f88d4003          STRB     r4,[sp,#3]
;;;586    	lc640_write_long_ptr(lc640_adr+28,data);	
00080a  4669              MOV      r1,sp
00080c  f105001c          ADD      r0,r5,#0x1c
000810  f7fffffe          BL       lc640_write_long_ptr
;;;587    	
;;;588    /*	memo_out0[0]=0x55;
;;;589         memo_out0[1]=0x00+2;
;;;590         memo_out0[2]=1;
;;;591         memo_out0[3]=0x0b;
;;;592         memo_out0[4]=0xaa;
;;;593         memo_out0[5]=0xaa; 
;;;594         	
;;;595         memo_out0[6]=crc_87(memo_out0,6);
;;;596    	memo_out0[7]=crc_95(memo_out0,6);
;;;597         usart_out_adr0(memo_out0,8); */
;;;598         snmp_trap_send("Main power is on",2,1,1);	
000814  2301              MOVS     r3,#1
000816  461a              MOV      r2,r3
000818  2102              MOVS     r1,#2
00081a  a01d              ADR      r0,|L1.2192|
00081c  f7fffffe          BL       snmp_trap_send
                  |L1.2080|
;;;599    	}
;;;600    avar_unet_hndl_end:
;;;601    	__nop();		
000820  bf00              NOP      
                  |L1.2082|
;;;602    }
000822  e8bd8ff8          POP      {r3-r11,pc}
;;;603    
                          ENDP

                  avar_bps_hndl PROC
;;;604    //-----------------------------------------------
;;;605    void avar_bps_hndl(char dev, char v, char in)
000826  e92d4ff8          PUSH     {r3-r11,lr}
;;;606    {
00082a  4606              MOV      r6,r0
00082c  460c              MOV      r4,r1
;;;607    char data[4];
;;;608    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;609    char avar_simbol;
;;;610    
;;;611    avar_simbol='T';
00082e  f04f0754          MOV      r7,#0x54
;;;612    if(v==0)avar_simbol='T';
000832  b134              CBZ      r4,|L1.2114|
;;;613    else if(v==1)avar_simbol='U';
000834  2c01              CMP      r4,#1
000836  d035              BEQ      |L1.2212|
;;;614    else if(v==2)avar_simbol='u';
000838  2c02              CMP      r4,#2
00083a  d036              BEQ      |L1.2218|
;;;615    else if(v==3)avar_simbol='L';
00083c  2c03              CMP      r4,#3
00083e  d037              BEQ      |L1.2224|
000840  e038              B        |L1.2228|
                  |L1.2114|
000842  e037              B        |L1.2228|
                  |L1.2116|
000844  4d61696e          DCB      "Main power alarm",0
000848  20706f77
00084c  65722061
000850  6c61726d
000854  00      
000855  00                DCB      0
000856  00                DCB      0
000857  00                DCB      0
                  |L1.2136|
                          DCD      ||.data||
                  |L1.2140|
                          DCD      AV_OFF_AVT
                  |L1.2144|
                          DCD      net_Ustore
                  |L1.2148|
000864  4d61696e          DCB      "Main power alarm  clear",0
000868  20706f77
00086c  65722061
000870  6c61726d
000874  2020636c
000878  65617200
                  |L1.2172|
                          DCD      0x40024000
                  |L1.2176|
                          DCD      uout_av
                  |L1.2180|
                          DCD      load_U
                  |L1.2184|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2188|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2192|
000890  4d61696e          DCB      "Main power is on",0
000894  20706f77
000898  65722069
00089c  73206f6e
0008a0  00      
0008a1  00                DCB      0
0008a2  00                DCB      0
0008a3  00                DCB      0
                  |L1.2212|
0008a4  f04f0755          MOV      r7,#0x55              ;613
0008a8  e004              B        |L1.2228|
                  |L1.2218|
0008aa  f04f0775          MOV      r7,#0x75              ;614
0008ae  e001              B        |L1.2228|
                  |L1.2224|
0008b0  f04f074c          MOV      r7,#0x4c
                  |L1.2228|
;;;616    
;;;617    if(in==1)
;;;618    	{
;;;619    	//av_src[bps]=1;
;;;620    
;;;621    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;622    //	SET_REG(avar_stat,1,3+dev,1);
;;;623    	
;;;624    	if(v==0)bps[dev]._av|=(1<<0);
;;;625    	else if(v==1) bps[dev]._av|=(1<<1);
;;;626    	else if(v==2) bps[dev]._av|=(1<<2);
;;;627    	else if(v==3) bps[dev]._av|=(1<<3);
;;;628    
;;;629    	bps[dev]._last_avar=v;
;;;630    
;;;631    	//beep_init(0x33333333,'A');
;;;632    
;;;633    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;634    	event_ptr++;	
;;;635    	if(event_ptr>63)event_ptr=0;	
;;;636    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;637    	
;;;638        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;639    	if(event_cnt!=63)event_cnt=event_ptr;
;;;640    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;641    	
;;;642    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;643    	
;;;644    	data[0]='S';
;;;645    	data[1]=dev; 
;;;646    	data[2]=avar_simbol;
;;;647    	data[3]=0;
;;;648    	lc640_write_long_ptr(lc640_adr,data);
;;;649    
;;;650    	data[0]=0;
;;;651    	data[1]=0;
;;;652    	data[2]=0;
;;;653    	data[3]=0;
;;;654    	lc640_write_long_ptr(lc640_adr+4,data);
;;;655    
;;;656    	data[0]=LPC_RTC->YEAR;
0008b4  f8df8400          LDR      r8,|L1.3256|
0008b8  f04f0900          MOV      r9,#0                 ;606
0008bc  48ff              LDR      r0,|L1.3260|
0008be  ebc601c6          RSB      r1,r6,r6,LSL #3       ;624
0008c2  eb011106          ADD      r1,r1,r6,LSL #4       ;624
0008c6  f44f6a60          MOV      r10,#0xe00            ;633
0008ca  f44f6580          MOV      r5,#0x400             ;642
0008ce  eb000081          ADD      r0,r0,r1,LSL #2       ;624
0008d2  2a01              CMP      r2,#1                 ;617
0008d4  d002              BEQ      |L1.2268|
;;;657    	data[1]=LPC_RTC->MONTH;
;;;658    	data[2]=LPC_RTC->DOM;
;;;659    	data[3]=0;
;;;660    	lc640_write_long_ptr(lc640_adr+8,data);
;;;661    
;;;662    	data[0]=LPC_RTC->HOUR;
;;;663    	data[1]=LPC_RTC->MIN;
;;;664    	data[2]=LPC_RTC->SEC;
;;;665    	data[3]=0;
;;;666    	lc640_write_long_ptr(lc640_adr+12,data);
;;;667    	
;;;668    	data[0]='A';
;;;669    	data[1]='A';
;;;670    	data[2]='A';
;;;671    	data[3]='A';
;;;672    	lc640_write_long_ptr(lc640_adr+16,data);
;;;673    	
;;;674    	data[0]='A';
;;;675    	data[1]='A';
;;;676    	data[2]='A';
;;;677    	data[3]='A';
;;;678    	lc640_write_long_ptr(lc640_adr+20,data);
;;;679    	
;;;680    	data[0]='A';
;;;681    	data[1]='A';
;;;682    	data[2]='A';
;;;683    	data[3]='A';
;;;684    	lc640_write_long_ptr(lc640_adr+24,data);
;;;685    	
;;;686    	data[0]='A';
;;;687    	data[1]='A';
;;;688    	data[2]='A';
;;;689    	data[3]='A';
;;;690    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;691    
;;;692    
;;;693    	if(dev==0)
;;;694    		{
;;;695    		if(v==0)
;;;696    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;697    		else if(v==1)
;;;698    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;699    		else if(v==2)
;;;700    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;701    		else if(v==3)
;;;702    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;703    		}
;;;704    	else if(dev==1)
;;;705    		{
;;;706    		if(v==0)
;;;707    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;708    		else if(v==1)
;;;709    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;710    		else if(v==2)
;;;711    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;712    		else if(v==3)
;;;713    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;714    		} 
;;;715    	else if(dev==2)
;;;716    		{
;;;717    		if(v==0)
;;;718    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;719    		else if(v==1)
;;;720    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;721    		else if(v==2)
;;;722    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;723    		else if(v==3)
;;;724    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;725    		} 	
;;;726    			
;;;727    	}
;;;728    
;;;729    else if(in==0)
0008d6  2a00              CMP      r2,#0
0008d8  d07e              BEQ      |L1.2520|
0008da  e1c4              B        |L1.3174|
                  |L1.2268|
0008dc  b134              CBZ      r4,|L1.2284|
0008de  2c01              CMP      r4,#1                 ;625
0008e0  d009              BEQ      |L1.2294|
0008e2  2c02              CMP      r4,#2                 ;626
0008e4  d00c              BEQ      |L1.2304|
0008e6  2c03              CMP      r4,#3                 ;627
0008e8  d00f              BEQ      |L1.2314|
0008ea  e012              B        |L1.2322|
                  |L1.2284|
0008ec  7841              LDRB     r1,[r0,#1]            ;624
0008ee  f0410101          ORR      r1,r1,#1              ;624
0008f2  7041              STRB     r1,[r0,#1]            ;624
0008f4  e00d              B        |L1.2322|
                  |L1.2294|
0008f6  7841              LDRB     r1,[r0,#1]            ;625
0008f8  f0410102          ORR      r1,r1,#2              ;625
0008fc  7041              STRB     r1,[r0,#1]            ;625
0008fe  e008              B        |L1.2322|
                  |L1.2304|
000900  7841              LDRB     r1,[r0,#1]            ;626
000902  f0410104          ORR      r1,r1,#4              ;626
000906  7041              STRB     r1,[r0,#1]            ;626
000908  e003              B        |L1.2322|
                  |L1.2314|
00090a  7841              LDRB     r1,[r0,#1]            ;627
00090c  f0410108          ORR      r1,r1,#8              ;627
000910  7041              STRB     r1,[r0,#1]            ;627
                  |L1.2322|
000912  f8804053          STRB     r4,[r0,#0x53]         ;629
000916  4650              MOV      r0,r10                ;633
000918  f7fffffe          BL       lc640_read_int
00091c  f1000001          ADD      r0,r0,#1              ;634
000920  fa1ffb80          UXTH     r11,r0                ;634
000924  f1bb0f3f          CMP      r11,#0x3f             ;635
000928  d901              BLS      |L1.2350|
00092a  f04f0b00          MOV      r11,#0                ;635
                  |L1.2350|
00092e  fa0ff18b          SXTH     r1,r11                ;636
000932  4650              MOV      r0,r10                ;636
000934  f7fffffe          BL       lc640_write_int
000938  f6406002          MOV      r0,#0xe02             ;638
00093c  f7fffffe          BL       lc640_read_int
000940  b280              UXTH     r0,r0                 ;638
000942  283f              CMP      r0,#0x3f              ;639
000944  d000              BEQ      |L1.2376|
000946  4658              MOV      r0,r11                ;639
                  |L1.2376|
000948  b201              SXTH     r1,r0                 ;640
00094a  f6406002          MOV      r0,#0xe02             ;640
00094e  f7fffffe          BL       lc640_write_int
000952  4650              MOV      r0,r10                ;642
000954  f7fffffe          BL       lc640_read_int
000958  eb051040          ADD      r0,r5,r0,LSL #5       ;642
00095c  b285              UXTH     r5,r0                 ;642
00095e  f04f0053          MOV      r0,#0x53              ;644
000962  f88d0000          STRB     r0,[sp,#0]            ;644
000966  f88d6001          STRB     r6,[sp,#1]            ;645
00096a  f88d7002          STRB     r7,[sp,#2]            ;646
00096e  f88d9003          STRB     r9,[sp,#3]            ;647
000972  4669              MOV      r1,sp                 ;648
000974  4628              MOV      r0,r5                 ;648
000976  f7fffffe          BL       lc640_write_long_ptr
00097a  f8cd9000          STR      r9,[sp,#0]            ;653
00097e  4669              MOV      r1,sp                 ;654
000980  1d28              ADDS     r0,r5,#4              ;654
000982  f7fffffe          BL       lc640_write_long_ptr
000986  f8b8003c          LDRH     r0,[r8,#0x3c]         ;656
00098a  f88d0000          STRB     r0,[sp,#0]            ;656
00098e  f8980038          LDRB     r0,[r8,#0x38]         ;657
000992  f88d0001          STRB     r0,[sp,#1]            ;657
000996  f898002c          LDRB     r0,[r8,#0x2c]         ;658
00099a  f88d0002          STRB     r0,[sp,#2]            ;658
00099e  f88d9003          STRB     r9,[sp,#3]            ;659
0009a2  4669              MOV      r1,sp                 ;660
0009a4  f1050008          ADD      r0,r5,#8              ;660
0009a8  f7fffffe          BL       lc640_write_long_ptr
0009ac  f8980028          LDRB     r0,[r8,#0x28]         ;662
0009b0  f88d0000          STRB     r0,[sp,#0]            ;662
0009b4  f8980024          LDRB     r0,[r8,#0x24]         ;663
0009b8  f88d0001          STRB     r0,[sp,#1]            ;663
0009bc  f8980020          LDRB     r0,[r8,#0x20]         ;664
0009c0  f88d0002          STRB     r0,[sp,#2]            ;664
0009c4  f88d9003          STRB     r9,[sp,#3]            ;665
0009c8  4669              MOV      r1,sp                 ;666
0009ca  f105000c          ADD      r0,r5,#0xc            ;666
0009ce  f7fffffe          BL       lc640_write_long_ptr
0009d2  f04f0741          MOV      r7,#0x41              ;668
0009d6  e000              B        |L1.2522|
                  |L1.2520|
0009d8  e0a5              B        |L1.2854|
                  |L1.2522|
0009da  f88d7000          STRB     r7,[sp,#0]            ;668
0009de  f88d7001          STRB     r7,[sp,#1]            ;669
0009e2  f88d7002          STRB     r7,[sp,#2]            ;670
0009e6  f88d7003          STRB     r7,[sp,#3]            ;671
0009ea  4669              MOV      r1,sp                 ;672
0009ec  f1050010          ADD      r0,r5,#0x10           ;672
0009f0  f7fffffe          BL       lc640_write_long_ptr
0009f4  f88d7000          STRB     r7,[sp,#0]            ;674
0009f8  f88d7001          STRB     r7,[sp,#1]            ;675
0009fc  f88d7002          STRB     r7,[sp,#2]            ;676
000a00  f88d7003          STRB     r7,[sp,#3]            ;677
000a04  4669              MOV      r1,sp                 ;678
000a06  f1050014          ADD      r0,r5,#0x14           ;678
000a0a  f7fffffe          BL       lc640_write_long_ptr
000a0e  f88d7000          STRB     r7,[sp,#0]            ;680
000a12  f88d7001          STRB     r7,[sp,#1]            ;681
000a16  f88d7002          STRB     r7,[sp,#2]            ;682
000a1a  f88d7003          STRB     r7,[sp,#3]            ;683
000a1e  4669              MOV      r1,sp                 ;684
000a20  f1050018          ADD      r0,r5,#0x18           ;684
000a24  f7fffffe          BL       lc640_write_long_ptr
000a28  f88d7000          STRB     r7,[sp,#0]            ;686
000a2c  f88d7001          STRB     r7,[sp,#1]            ;687
000a30  f88d7002          STRB     r7,[sp,#2]            ;688
000a34  f88d7003          STRB     r7,[sp,#3]            ;689
000a38  4669              MOV      r1,sp                 ;690
000a3a  f105001c          ADD      r0,r5,#0x1c           ;690
000a3e  f7fffffe          BL       lc640_write_long_ptr
000a42  b126              CBZ      r6,|L1.2638|
000a44  2e01              CMP      r6,#1                 ;704
000a46  d026              BEQ      |L1.2710|
000a48  2e02              CMP      r6,#2                 ;715
000a4a  d048              BEQ      |L1.2782|
000a4c  e10b              B        |L1.3174|
                  |L1.2638|
000a4e  b134              CBZ      r4,|L1.2654|
000a50  2c01              CMP      r4,#1                 ;697
000a52  d00b              BEQ      |L1.2668|
000a54  2c02              CMP      r4,#2                 ;699
000a56  d010              BEQ      |L1.2682|
000a58  2c03              CMP      r4,#3                 ;701
000a5a  d015              BEQ      |L1.2696|
000a5c  e103              B        |L1.3174|
                  |L1.2654|
000a5e  2300              MOVS     r3,#0                 ;696
000a60  2201              MOVS     r2,#1                 ;696
000a62  2104              MOVS     r1,#4                 ;696
000a64  a096              ADR      r0,|L1.3264|
000a66  f7fffffe          BL       snmp_trap_send
000a6a  e0fc              B        |L1.3174|
                  |L1.2668|
000a6c  2301              MOVS     r3,#1                 ;698
000a6e  461a              MOV      r2,r3                 ;698
000a70  2104              MOVS     r1,#4                 ;698
000a72  a099              ADR      r0,|L1.3288|
000a74  f7fffffe          BL       snmp_trap_send
000a78  e0f5              B        |L1.3174|
                  |L1.2682|
000a7a  2302              MOVS     r3,#2                 ;700
000a7c  2201              MOVS     r2,#1                 ;700
000a7e  2104              MOVS     r1,#4                 ;700
000a80  a09c              ADR      r0,|L1.3316|
000a82  f7fffffe          BL       snmp_trap_send
000a86  e0ee              B        |L1.3174|
                  |L1.2696|
000a88  2303              MOVS     r3,#3                 ;702
000a8a  2201              MOVS     r2,#1                 ;702
000a8c  2104              MOVS     r1,#4                 ;702
000a8e  a0a1              ADR      r0,|L1.3348|
000a90  f7fffffe          BL       snmp_trap_send
000a94  e0e7              B        |L1.3174|
                  |L1.2710|
000a96  b134              CBZ      r4,|L1.2726|
000a98  2c01              CMP      r4,#1                 ;708
000a9a  d00b              BEQ      |L1.2740|
000a9c  2c02              CMP      r4,#2                 ;710
000a9e  d010              BEQ      |L1.2754|
000aa0  2c03              CMP      r4,#3                 ;712
000aa2  d015              BEQ      |L1.2768|
000aa4  e0df              B        |L1.3174|
                  |L1.2726|
000aa6  2300              MOVS     r3,#0                 ;707
000aa8  2202              MOVS     r2,#2                 ;707
000aaa  2104              MOVS     r1,#4                 ;707
000aac  a0a1              ADR      r0,|L1.3380|
000aae  f7fffffe          BL       snmp_trap_send
000ab2  e0d8              B        |L1.3174|
                  |L1.2740|
000ab4  2301              MOVS     r3,#1                 ;709
000ab6  2202              MOVS     r2,#2                 ;709
000ab8  2104              MOVS     r1,#4                 ;709
000aba  a0a4              ADR      r0,|L1.3404|
000abc  f7fffffe          BL       snmp_trap_send
000ac0  e0d1              B        |L1.3174|
                  |L1.2754|
000ac2  2302              MOVS     r3,#2                 ;711
000ac4  461a              MOV      r2,r3                 ;711
000ac6  2104              MOVS     r1,#4                 ;711
000ac8  a0a7              ADR      r0,|L1.3432|
000aca  f7fffffe          BL       snmp_trap_send
000ace  e0ca              B        |L1.3174|
                  |L1.2768|
000ad0  2303              MOVS     r3,#3                 ;713
000ad2  2202              MOVS     r2,#2                 ;713
000ad4  2104              MOVS     r1,#4                 ;713
000ad6  a0ac              ADR      r0,|L1.3464|
000ad8  f7fffffe          BL       snmp_trap_send
000adc  e0c3              B        |L1.3174|
                  |L1.2782|
000ade  b134              CBZ      r4,|L1.2798|
000ae0  2c01              CMP      r4,#1                 ;719
000ae2  d00b              BEQ      |L1.2812|
000ae4  2c02              CMP      r4,#2                 ;721
000ae6  d010              BEQ      |L1.2826|
000ae8  2c03              CMP      r4,#3                 ;723
000aea  d015              BEQ      |L1.2840|
000aec  e0bb              B        |L1.3174|
                  |L1.2798|
000aee  2300              MOVS     r3,#0                 ;718
000af0  2203              MOVS     r2,#3                 ;718
000af2  2104              MOVS     r1,#4                 ;718
000af4  a0ac              ADR      r0,|L1.3496|
000af6  f7fffffe          BL       snmp_trap_send
000afa  e0b4              B        |L1.3174|
                  |L1.2812|
000afc  2301              MOVS     r3,#1                 ;720
000afe  2203              MOVS     r2,#3                 ;720
000b00  2104              MOVS     r1,#4                 ;720
000b02  a0af              ADR      r0,|L1.3520|
000b04  f7fffffe          BL       snmp_trap_send
000b08  e0ad              B        |L1.3174|
                  |L1.2826|
000b0a  2302              MOVS     r3,#2                 ;722
000b0c  2203              MOVS     r2,#3                 ;722
000b0e  2104              MOVS     r1,#4                 ;722
000b10  a0b2              ADR      r0,|L1.3548|
000b12  f7fffffe          BL       snmp_trap_send
000b16  e0a6              B        |L1.3174|
                  |L1.2840|
000b18  2303              MOVS     r3,#3                 ;724
000b1a  461a              MOV      r2,r3                 ;724
000b1c  2104              MOVS     r1,#4                 ;724
000b1e  a0b7              ADR      r0,|L1.3580|
000b20  f7fffffe          BL       snmp_trap_send
000b24  e09f              B        |L1.3174|
                  |L1.2854|
;;;730    	{      
;;;731    //	av_bps[bps]=0;
;;;732    
;;;733    	//SET_REG(avar_stat,0,3+bps,1);
;;;734    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;735    
;;;736         if(v==0) bps[dev]._av&=(~(1<<0));
000b26  b134              CBZ      r4,|L1.2870|
;;;737         else if(v==1) bps[dev]._av&=(~(1<<1));
000b28  2c01              CMP      r4,#1
000b2a  d009              BEQ      |L1.2880|
;;;738    	else if(v==2) bps[dev]._av&=(~(1<<2));
000b2c  2c02              CMP      r4,#2
000b2e  d00c              BEQ      |L1.2890|
;;;739    	else if(v==3) bps[dev]._av&=(~(1<<3));
000b30  2c03              CMP      r4,#3
000b32  d00f              BEQ      |L1.2900|
000b34  e012              B        |L1.2908|
                  |L1.2870|
000b36  7841              LDRB     r1,[r0,#1]            ;736
000b38  f0210101          BIC      r1,r1,#1              ;736
000b3c  7041              STRB     r1,[r0,#1]            ;736
000b3e  e00d              B        |L1.2908|
                  |L1.2880|
000b40  7841              LDRB     r1,[r0,#1]            ;737
000b42  f0210102          BIC      r1,r1,#2              ;737
000b46  7041              STRB     r1,[r0,#1]            ;737
000b48  e008              B        |L1.2908|
                  |L1.2890|
000b4a  7841              LDRB     r1,[r0,#1]            ;738
000b4c  f0210104          BIC      r1,r1,#4              ;738
000b50  7041              STRB     r1,[r0,#1]            ;738
000b52  e003              B        |L1.2908|
                  |L1.2900|
000b54  7841              LDRB     r1,[r0,#1]
000b56  f0210108          BIC      r1,r1,#8
000b5a  7041              STRB     r1,[r0,#1]
                  |L1.2908|
;;;740         
;;;741    //	if((bps[dev]._av&0x0f==0))
;;;742    //	     {
;;;743    		//SET_REG(avar_stat,0,3+bps,1);
;;;744    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;745    //	     }
;;;746     
;;;747    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000b5c  4650              MOV      r0,r10
000b5e  f7fffffe          BL       lc640_read_int
000b62  fa1ffb80          UXTH     r11,r0
;;;748    	event_ptr_find=event_ptr;
000b66  465c              MOV      r4,r11
                  |L1.2920|
;;;749    	
;;;750    avar_src_hndl_lbl1: 
;;;751    
;;;752    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000b68  eb051044          ADD      r0,r5,r4,LSL #5
000b6c  fa1ffa80          UXTH     r10,r0
;;;753    
;;;754         lc640_read_long_ptr(lc640_adr,data);
000b70  4669              MOV      r1,sp
000b72  4650              MOV      r0,r10
000b74  f7fffffe          BL       lc640_read_long_ptr
;;;755         
;;;756         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000b78  f89d0000          LDRB     r0,[sp,#0]
000b7c  2853              CMP      r0,#0x53
000b7e  d107              BNE      |L1.2960|
000b80  f89d0001          LDRB     r0,[sp,#1]
000b84  42b0              CMP      r0,r6
000b86  d103              BNE      |L1.2960|
000b88  f89d0002          LDRB     r0,[sp,#2]
000b8c  42b8              CMP      r0,r7
000b8e  d009              BEQ      |L1.2980|
                  |L1.2960|
;;;757         	{        
;;;758         	if(event_ptr_find)event_ptr_find--;
000b90  b11c              CBZ      r4,|L1.2970|
000b92  f1a40401          SUB      r4,r4,#1
000b96  b2a4              UXTH     r4,r4
000b98  e001              B        |L1.2974|
                  |L1.2970|
;;;759         	else event_ptr_find=63;
000b9a  f04f043f          MOV      r4,#0x3f
                  |L1.2974|
;;;760         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000b9e  455c              CMP      r4,r11
000ba0  d1e2              BNE      |L1.2920|
000ba2  e060              B        |L1.3174|
                  |L1.2980|
;;;761         	else goto avar_src_hndl_lbl1;
;;;762         	}
;;;763         else 
;;;764         	{
;;;765         	lc640_read_long_ptr(lc640_adr+16,data);
000ba4  4669              MOV      r1,sp
000ba6  f10a0010          ADD      r0,r10,#0x10
000baa  f7fffffe          BL       lc640_read_long_ptr
;;;766         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000bae  f89d0000          LDRB     r0,[sp,#0]
000bb2  2841              CMP      r0,#0x41
000bb4  d10b              BNE      |L1.3022|
000bb6  f89d0001          LDRB     r0,[sp,#1]
000bba  2841              CMP      r0,#0x41
000bbc  d107              BNE      |L1.3022|
000bbe  f89d0002          LDRB     r0,[sp,#2]
000bc2  2841              CMP      r0,#0x41
000bc4  d103              BNE      |L1.3022|
000bc6  f89d0003          LDRB     r0,[sp,#3]
000bca  2841              CMP      r0,#0x41
000bcc  d009              BEQ      |L1.3042|
                  |L1.3022|
;;;767         		{        
;;;768         		if(event_ptr_find)event_ptr_find--;
000bce  b11c              CBZ      r4,|L1.3032|
000bd0  f1a40401          SUB      r4,r4,#1
000bd4  b2a4              UXTH     r4,r4
000bd6  e001              B        |L1.3036|
                  |L1.3032|
;;;769             		else event_ptr_find=63;
000bd8  f04f043f          MOV      r4,#0x3f
                  |L1.3036|
;;;770             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000bdc  455c              CMP      r4,r11
000bde  d1c3              BNE      |L1.2920|
000be0  e041              B        |L1.3174|
                  |L1.3042|
;;;771         		else goto avar_src_hndl_lbl1;
;;;772         		}
;;;773    
;;;774         	}	
;;;775    
;;;776    
;;;777    	
;;;778    	data[0]=LPC_RTC->YEAR;
000be2  f8b8003c          LDRH     r0,[r8,#0x3c]
000be6  f88d0000          STRB     r0,[sp,#0]
;;;779    	data[1]=LPC_RTC->MONTH;
000bea  f8980038          LDRB     r0,[r8,#0x38]
000bee  f88d0001          STRB     r0,[sp,#1]
;;;780    	data[2]=LPC_RTC->DOM;
000bf2  f898002c          LDRB     r0,[r8,#0x2c]
000bf6  f88d0002          STRB     r0,[sp,#2]
;;;781    	data[3]=0;
000bfa  f88d9003          STRB     r9,[sp,#3]
;;;782    	lc640_write_long_ptr(lc640_adr+16,data);
000bfe  4669              MOV      r1,sp
000c00  f10a0010          ADD      r0,r10,#0x10
000c04  f7fffffe          BL       lc640_write_long_ptr
;;;783    
;;;784    	data[0]=LPC_RTC->HOUR;
000c08  f8980028          LDRB     r0,[r8,#0x28]
000c0c  f88d0000          STRB     r0,[sp,#0]
;;;785    	data[1]=LPC_RTC->MIN;
000c10  f8980024          LDRB     r0,[r8,#0x24]
000c14  f88d0001          STRB     r0,[sp,#1]
;;;786    	data[2]=LPC_RTC->SEC;
000c18  f8980020          LDRB     r0,[r8,#0x20]
000c1c  f88d0002          STRB     r0,[sp,#2]
;;;787    	data[3]=0;
000c20  f88d9003          STRB     r9,[sp,#3]
;;;788    	lc640_write_long_ptr(lc640_adr+20,data);
000c24  4669              MOV      r1,sp
000c26  f10a0014          ADD      r0,r10,#0x14
000c2a  f7fffffe          BL       lc640_write_long_ptr
;;;789    	
;;;790    	data[0]='B';
000c2e  f04f0442          MOV      r4,#0x42
000c32  f88d4000          STRB     r4,[sp,#0]
;;;791    	data[1]='B';
000c36  f88d4001          STRB     r4,[sp,#1]
;;;792    	data[2]='B';
000c3a  f88d4002          STRB     r4,[sp,#2]
;;;793    	data[3]='B';
000c3e  f88d4003          STRB     r4,[sp,#3]
;;;794    	lc640_write_long_ptr(lc640_adr+24,data);
000c42  4669              MOV      r1,sp
000c44  f10a0018          ADD      r0,r10,#0x18
000c48  f7fffffe          BL       lc640_write_long_ptr
;;;795    	
;;;796    	data[0]='B';
000c4c  f88d4000          STRB     r4,[sp,#0]
;;;797    	data[1]='B';
000c50  f88d4001          STRB     r4,[sp,#1]
;;;798    	data[2]='B';
000c54  f88d4002          STRB     r4,[sp,#2]
;;;799    	data[3]='B';
000c58  f88d4003          STRB     r4,[sp,#3]
;;;800    	lc640_write_long_ptr(lc640_adr+28,data);
000c5c  4669              MOV      r1,sp
000c5e  f10a001c          ADD      r0,r10,#0x1c
000c62  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3174|
;;;801    	
;;;802    	}
;;;803    	
;;;804    avar_src_hndl_end:
;;;805    __nop();		
000c66  bf00              NOP      
                  |L1.3176|
;;;806    }
000c68  e5db              B        |L1.2082|
;;;807    
                          ENDP

                  wrk_mem_hndl PROC
;;;808    //-----------------------------------------------
;;;809    void wrk_mem_hndl(char b)
000c6a  e92d41fc          PUSH     {r2-r8,lr}
;;;810    {
000c6e  4606              MOV      r6,r0
;;;811    char data[4];
;;;812    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;813    
;;;814    signed short temp_temp;
;;;815    
;;;816    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000c70  eb060046          ADD      r0,r6,r6,LSL #1
000c74  eb001106          ADD      r1,r0,r6,LSL #4
000c78  4868              LDR      r0,|L1.3612|
000c7a  eb000481          ADD      r4,r0,r1,LSL #2
000c7e  8be0              LDRH     r0,[r4,#0x1e]
000c80  2805              CMP      r0,#5
000c82  d318              BCC      |L1.3254|
;;;817    
;;;818    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000c84  4866              LDR      r0,|L1.3616|
000c86  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000c88  f1000006          ADD      r0,r0,#6
000c8c  f0000007          AND      r0,r0,#7
000c90  eb040040          ADD      r0,r4,r0,LSL #1
000c94  8c00              LDRH     r0,[r0,#0x20]
000c96  9000              STR      r0,[sp,#0]
;;;819    
;;;820    
;;;821    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000c98  f44f6760          MOV      r7,#0xe00
000c9c  4638              MOV      r0,r7
000c9e  f7fffffe          BL       lc640_read_int
;;;822    event_ptr++;	
000ca2  f1000001          ADD      r0,r0,#1
000ca6  b285              UXTH     r5,r0
;;;823    if(event_ptr>63)event_ptr=0;	
000ca8  2d3f              CMP      r5,#0x3f
000caa  d901              BLS      |L1.3248|
000cac  f04f0500          MOV      r5,#0
                  |L1.3248|
;;;824    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000cb0  b229              SXTH     r1,r5
000cb2  4638              MOV      r0,r7
000cb4  e0b6              B        |L1.3620|
                  |L1.3254|
000cb6  e11d              B        |L1.3828|
                  |L1.3256|
                          DCD      0x40024000
                  |L1.3260|
                          DCD      bps
                  |L1.3264|
000cc0  42505320          DCB      "BPS #1 Alarm, overheat",0
000cc4  23312041
000cc8  6c61726d
000ccc  2c206f76
000cd0  65726865
000cd4  617400  
000cd7  00                DCB      0
                  |L1.3288|
000cd8  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000cdc  23312041
000ce0  6c61726d
000ce4  2c20766f
000ce8  6c746167
000cec  65206973
000cf0  20757000
                  |L1.3316|
000cf4  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000cf8  23312041
000cfc  6c61726d
000d00  2c20766f
000d04  6c746167
000d08  65206973
000d0c  20646f77
000d10  6e00    
000d12  00                DCB      0
000d13  00                DCB      0
                  |L1.3348|
000d14  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000d18  23312041
000d1c  6c61726d
000d20  2c20636f
000d24  6e6e6563
000d28  74206973
000d2c  206c6f73
000d30  7400    
000d32  00                DCB      0
000d33  00                DCB      0
                  |L1.3380|
000d34  42505320          DCB      "BPS #2 Alarm, overheat",0
000d38  23322041
000d3c  6c61726d
000d40  2c206f76
000d44  65726865
000d48  617400  
000d4b  00                DCB      0
                  |L1.3404|
000d4c  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000d50  23322041
000d54  6c61726d
000d58  2c20766f
000d5c  6c746167
000d60  65206973
000d64  20757000
                  |L1.3432|
000d68  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000d6c  23322041
000d70  6c61726d
000d74  2c20766f
000d78  6c746167
000d7c  65206973
000d80  20646f77
000d84  6e00    
000d86  00                DCB      0
000d87  00                DCB      0
                  |L1.3464|
000d88  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000d8c  23322041
000d90  6c61726d
000d94  2c20636f
000d98  6e6e6563
000d9c  74206973
000da0  206c6f73
000da4  7400    
000da6  00                DCB      0
000da7  00                DCB      0
                  |L1.3496|
000da8  42505320          DCB      "BPS #3 Alarm, overheat",0
000dac  23332041
000db0  6c61726d
000db4  2c206f76
000db8  65726865
000dbc  617400  
000dbf  00                DCB      0
                  |L1.3520|
000dc0  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000dc4  23332041
000dc8  6c61726d
000dcc  2c20766f
000dd0  6c746167
000dd4  65206973
000dd8  20757000
                  |L1.3548|
000ddc  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000de0  23332041
000de4  6c61726d
000de8  2c20766f
000dec  6c746167
000df0  65206973
000df4  20646f77
000df8  6e00    
000dfa  00                DCB      0
000dfb  00                DCB      0
                  |L1.3580|
000dfc  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000e00  23332041
000e04  6c61726d
000e08  2c20636f
000e0c  6e6e6563
000e10  74206973
000e14  206c6f73
000e18  7400    
000e1a  00                DCB      0
000e1b  00                DCB      0
                  |L1.3612|
                          DCD      bat
                  |L1.3616|
                          DCD      bat_u_old_cnt
                  |L1.3620|
000e24  f7fffffe          BL       lc640_write_int
;;;825    	
;;;826    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000e28  f6406802          MOV      r8,#0xe02
000e2c  4640              MOV      r0,r8
000e2e  f7fffffe          BL       lc640_read_int
000e32  b280              UXTH     r0,r0
;;;827    if(event_cnt!=63)event_cnt=event_ptr;
000e34  283f              CMP      r0,#0x3f
000e36  d000              BEQ      |L1.3642|
000e38  4628              MOV      r0,r5
                  |L1.3642|
;;;828    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000e3a  b201              SXTH     r1,r0
000e3c  4640              MOV      r0,r8
000e3e  f7fffffe          BL       lc640_write_int
;;;829    	
;;;830    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000e42  4638              MOV      r0,r7
000e44  f7fffffe          BL       lc640_read_int
000e48  f44f6180          MOV      r1,#0x400
000e4c  eb011040          ADD      r0,r1,r0,LSL #5
000e50  b285              UXTH     r5,r0
;;;831    	
;;;832    data[0]='B';
000e52  f04f0042          MOV      r0,#0x42
000e56  f88d0004          STRB     r0,[sp,#4]
;;;833    data[1]=b; 
000e5a  f88d6005          STRB     r6,[sp,#5]
;;;834    data[2]='W';
000e5e  f04f0057          MOV      r0,#0x57
000e62  f88d0006          STRB     r0,[sp,#6]
;;;835    data[3]=0;
000e66  f04f0600          MOV      r6,#0
000e6a  f88d6007          STRB     r6,[sp,#7]
;;;836    
;;;837    lc640_write_long_ptr(lc640_adr,data);
000e6e  a901              ADD      r1,sp,#4
000e70  4628              MOV      r0,r5
000e72  f7fffffe          BL       lc640_write_long_ptr
;;;838    
;;;839    data[0]=*((char*)&bat[b]._Iintegr_);
000e76  7fa0              LDRB     r0,[r4,#0x1e]
000e78  f88d0004          STRB     r0,[sp,#4]
;;;840    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000e7c  7fe0              LDRB     r0,[r4,#0x1f]
000e7e  f88d0005          STRB     r0,[sp,#5]
;;;841    data[2]=*((char*)&temp_temp);
000e82  f89d0000          LDRB     r0,[sp,#0]
000e86  f88d0006          STRB     r0,[sp,#6]
;;;842    data[3]=*(((char*)(&temp_temp))+1);
000e8a  f89d0001          LDRB     r0,[sp,#1]
000e8e  f88d0007          STRB     r0,[sp,#7]
;;;843    lc640_write_long_ptr(lc640_adr+4,data);
000e92  a901              ADD      r1,sp,#4
000e94  1d28              ADDS     r0,r5,#4
000e96  f7fffffe          BL       lc640_write_long_ptr
;;;844    
;;;845    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000e9a  f1040134          ADD      r1,r4,#0x34
000e9e  f1050008          ADD      r0,r5,#8
000ea2  f7fffffe          BL       lc640_write_long_ptr
;;;846    	
;;;847    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000ea6  f1040138          ADD      r1,r4,#0x38
000eaa  f105000c          ADD      r0,r5,#0xc
000eae  f7fffffe          BL       lc640_write_long_ptr
;;;848    
;;;849    data[0]=LPC_RTC->YEAR;
000eb2  4cff              LDR      r4,|L1.4784|
000eb4  8ba0              LDRH     r0,[r4,#0x1c]
000eb6  f88d0004          STRB     r0,[sp,#4]
;;;850    data[1]=LPC_RTC->MONTH;
000eba  7e20              LDRB     r0,[r4,#0x18]
000ebc  f88d0005          STRB     r0,[sp,#5]
;;;851    data[2]=LPC_RTC->DOM;
000ec0  7b20              LDRB     r0,[r4,#0xc]
000ec2  f88d0006          STRB     r0,[sp,#6]
;;;852    data[3]=0;
000ec6  f88d6007          STRB     r6,[sp,#7]
;;;853    lc640_write_long_ptr(lc640_adr+16,data);
000eca  a901              ADD      r1,sp,#4
000ecc  f1050010          ADD      r0,r5,#0x10
000ed0  f7fffffe          BL       lc640_write_long_ptr
;;;854    
;;;855    data[0]=LPC_RTC->HOUR;
000ed4  7a20              LDRB     r0,[r4,#8]
000ed6  f88d0004          STRB     r0,[sp,#4]
;;;856    data[1]=LPC_RTC->MIN;
000eda  7920              LDRB     r0,[r4,#4]
000edc  f88d0005          STRB     r0,[sp,#5]
;;;857    data[2]=LPC_RTC->SEC;
000ee0  7820              LDRB     r0,[r4,#0]
000ee2  f88d0006          STRB     r0,[sp,#6]
;;;858    data[3]=0;
000ee6  f88d6007          STRB     r6,[sp,#7]
;;;859    lc640_write_long_ptr(lc640_adr+20,data);
000eea  a901              ADD      r1,sp,#4
000eec  f1050014          ADD      r0,r5,#0x14
000ef0  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3828|
;;;860    	
;;;861    
;;;862    
;;;863    	
;;;864    wrk_mem_hndl_end:	
;;;865    __nop();
000ef4  bf00              NOP      
;;;866    }  
000ef6  e8bd81fc          POP      {r2-r8,pc}
;;;867    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;869    //-----------------------------------------------
;;;870    void avar_bat_ips_hndl(char in)
000efa  e92d4ff8          PUSH     {r3-r11,lr}
;;;871    {
000efe  4602              MOV      r2,r0
;;;872    char data[4];
;;;873    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;874    
;;;875    if(in==1)
;;;876    	{
;;;877    	bat_ips._av|=1;
000f00  48ec              LDR      r0,|L1.4788|
;;;878        ips_bat_av_stat=1;
000f02  4ced              LDR      r4,|L1.4792|
;;;879    	ips_bat_av_vzvod=1;
000f04  4bed              LDR      r3,|L1.4796|
;;;880    
;;;881    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;882    	event_ptr++;	
;;;883    	if(event_ptr>63)event_ptr=0;	
;;;884    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;885    	
;;;886    	event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;887    	if(event_cnt!=63)event_cnt=event_ptr;
;;;888    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;889    	
;;;890    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;891    	
;;;892    	data[0]='B';
;;;893    	data[1]=0;
;;;894    	data[2]='C';
;;;895    	data[3]=0;
;;;896    	lc640_write_long_ptr(lc640_adr,data);
;;;897    
;;;898    	data[0]=0;
;;;899    	data[1]=0;
;;;900    	data[2]=0;
;;;901    	data[3]=0;
;;;902    	lc640_write_long_ptr(lc640_adr+4,data);
;;;903    
;;;904    	data[0]=LPC_RTC->YEAR;
000f06  f8df83b8          LDR      r8,|L1.4800|
000f0a  f890103d          LDRB     r1,[r0,#0x3d]         ;877
000f0e  f04f0742          MOV      r7,#0x42              ;892
000f12  f44f6560          MOV      r5,#0xe00             ;881
000f16  f04f0900          MOV      r9,#0                 ;883
000f1a  f44f6a80          MOV      r10,#0x400            ;890
000f1e  2a01              CMP      r2,#1                 ;875
000f20  d002              BEQ      |L1.3880|
;;;905    	data[1]=LPC_RTC->MONTH;
;;;906    	data[2]=LPC_RTC->DOM;
;;;907    	data[3]=0;
;;;908    	lc640_write_long_ptr(lc640_adr+8,data);
;;;909    
;;;910    	data[0]=LPC_RTC->HOUR;
;;;911    	data[1]=LPC_RTC->MIN;
;;;912    	data[2]=LPC_RTC->SEC;
;;;913    	data[3]=0;
;;;914    	lc640_write_long_ptr(lc640_adr+12,data);
;;;915    	
;;;916    	data[0]='A';
;;;917    	data[1]='A';
;;;918    	data[2]='A';
;;;919    	data[3]='A';
;;;920    	lc640_write_long_ptr(lc640_adr+16,data);
;;;921    	
;;;922    	data[0]='A';
;;;923    	data[1]='A';
;;;924    	data[2]='A';
;;;925    	data[3]='A';
;;;926    	lc640_write_long_ptr(lc640_adr+20,data);
;;;927    	
;;;928    	data[0]='A';
;;;929    	data[1]='A';
;;;930    	data[2]='A';
;;;931    	data[3]='A';
;;;932    	lc640_write_long_ptr(lc640_adr+24,data);
;;;933    	
;;;934    	data[0]='A';
;;;935    	data[1]='A';
;;;936    	data[2]='A';
;;;937    	data[3]='A';
;;;938    	lc640_write_long_ptr(lc640_adr+28,data);
;;;939    					
;;;940    	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;941    		
;;;942    	}
;;;943    
;;;944    else if(in==0)
000f22  2a00              CMP      r2,#0
000f24  d07e              BEQ      |L1.4132|
000f26  e129              B        |L1.4476|
                  |L1.3880|
000f28  f0410101          ORR      r1,r1,#1              ;877
000f2c  f880103d          STRB     r1,[r0,#0x3d]         ;877
000f30  f04f0001          MOV      r0,#1                 ;878
000f34  7020              STRB     r0,[r4,#0]            ;878
000f36  7018              STRB     r0,[r3,#0]            ;879
000f38  4628              MOV      r0,r5                 ;881
000f3a  f7fffffe          BL       lc640_read_int
000f3e  f1000001          ADD      r0,r0,#1              ;882
000f42  b284              UXTH     r4,r0                 ;882
000f44  2c3f              CMP      r4,#0x3f              ;883
000f46  d901              BLS      |L1.3916|
000f48  f04f0400          MOV      r4,#0                 ;883
                  |L1.3916|
000f4c  b221              SXTH     r1,r4                 ;884
000f4e  4628              MOV      r0,r5                 ;884
000f50  f7fffffe          BL       lc640_write_int
000f54  f6406602          MOV      r6,#0xe02             ;886
000f58  4630              MOV      r0,r6                 ;886
000f5a  f7fffffe          BL       lc640_read_int
000f5e  b281              UXTH     r1,r0                 ;886
000f60  293f              CMP      r1,#0x3f              ;887
000f62  d000              BEQ      |L1.3942|
000f64  4621              MOV      r1,r4                 ;887
                  |L1.3942|
000f66  b209              SXTH     r1,r1                 ;888
000f68  4630              MOV      r0,r6                 ;888
000f6a  f7fffffe          BL       lc640_write_int
000f6e  4628              MOV      r0,r5                 ;890
000f70  f7fffffe          BL       lc640_read_int
000f74  eb0a1040          ADD      r0,r10,r0,LSL #5      ;890
000f78  b284              UXTH     r4,r0                 ;890
000f7a  f88d7000          STRB     r7,[sp,#0]            ;892
000f7e  f88d9001          STRB     r9,[sp,#1]            ;893
000f82  f04f0043          MOV      r0,#0x43              ;894
000f86  f88d0002          STRB     r0,[sp,#2]            ;894
000f8a  f88d9003          STRB     r9,[sp,#3]            ;895
000f8e  4669              MOV      r1,sp                 ;896
000f90  4620              MOV      r0,r4                 ;896
000f92  f7fffffe          BL       lc640_write_long_ptr
000f96  f8cd9000          STR      r9,[sp,#0]            ;901
000f9a  4669              MOV      r1,sp                 ;902
000f9c  1d20              ADDS     r0,r4,#4              ;902
000f9e  f7fffffe          BL       lc640_write_long_ptr
000fa2  f8b8003c          LDRH     r0,[r8,#0x3c]         ;904
000fa6  f88d0000          STRB     r0,[sp,#0]            ;904
000faa  f8980038          LDRB     r0,[r8,#0x38]         ;905
000fae  f88d0001          STRB     r0,[sp,#1]            ;905
000fb2  f898002c          LDRB     r0,[r8,#0x2c]         ;906
000fb6  f88d0002          STRB     r0,[sp,#2]            ;906
000fba  f88d9003          STRB     r9,[sp,#3]            ;907
000fbe  4669              MOV      r1,sp                 ;908
000fc0  f1040008          ADD      r0,r4,#8              ;908
000fc4  f7fffffe          BL       lc640_write_long_ptr
000fc8  f8980028          LDRB     r0,[r8,#0x28]         ;910
000fcc  f88d0000          STRB     r0,[sp,#0]            ;910
000fd0  f8980024          LDRB     r0,[r8,#0x24]         ;911
000fd4  f88d0001          STRB     r0,[sp,#1]            ;911
000fd8  f8980020          LDRB     r0,[r8,#0x20]         ;912
000fdc  f88d0002          STRB     r0,[sp,#2]            ;912
000fe0  f88d9003          STRB     r9,[sp,#3]            ;913
000fe4  4669              MOV      r1,sp                 ;914
000fe6  f104000c          ADD      r0,r4,#0xc            ;914
000fea  f7fffffe          BL       lc640_write_long_ptr
000fee  f04f0541          MOV      r5,#0x41              ;916
000ff2  f88d5000          STRB     r5,[sp,#0]            ;916
000ff6  f88d5001          STRB     r5,[sp,#1]            ;917
000ffa  f88d5002          STRB     r5,[sp,#2]            ;918
000ffe  f88d5003          STRB     r5,[sp,#3]            ;919
001002  4669              MOV      r1,sp                 ;920
001004  f1040010          ADD      r0,r4,#0x10           ;920
001008  f7fffffe          BL       lc640_write_long_ptr
00100c  f88d5000          STRB     r5,[sp,#0]            ;922
001010  f88d5001          STRB     r5,[sp,#1]            ;923
001014  f88d5002          STRB     r5,[sp,#2]            ;924
001018  f88d5003          STRB     r5,[sp,#3]            ;925
00101c  4669              MOV      r1,sp                 ;926
00101e  f1040014          ADD      r0,r4,#0x14           ;926
001022  e000              B        |L1.4134|
                  |L1.4132|
001024  e022              B        |L1.4204|
                  |L1.4134|
001026  f7fffffe          BL       lc640_write_long_ptr
00102a  f88d5000          STRB     r5,[sp,#0]            ;928
00102e  f88d5001          STRB     r5,[sp,#1]            ;929
001032  f88d5002          STRB     r5,[sp,#2]            ;930
001036  f88d5003          STRB     r5,[sp,#3]            ;931
00103a  4669              MOV      r1,sp                 ;932
00103c  f1040018          ADD      r0,r4,#0x18           ;932
001040  f7fffffe          BL       lc640_write_long_ptr
001044  f88d5000          STRB     r5,[sp,#0]            ;934
001048  f88d5001          STRB     r5,[sp,#1]            ;935
00104c  f88d5002          STRB     r5,[sp,#2]            ;936
001050  f88d5003          STRB     r5,[sp,#3]            ;937
001054  4669              MOV      r1,sp                 ;938
001056  f104001c          ADD      r0,r4,#0x1c           ;938
00105a  f7fffffe          BL       lc640_write_long_ptr
00105e  2301              MOVS     r3,#1                 ;940
001060  461a              MOV      r2,r3                 ;940
001062  2105              MOVS     r1,#5                 ;940
001064  a097              ADR      r0,|L1.4804|
001066  f7fffffe          BL       snmp_trap_send
00106a  e087              B        |L1.4476|
                  |L1.4204|
;;;945    	{
;;;946    	bat_ips._av&=~1;
00106c  f0210101          BIC      r1,r1,#1
001070  f880103d          STRB     r1,[r0,#0x3d]
;;;947    	ips_bat_av_stat=0;
001074  f8849000          STRB     r9,[r4,#0]
;;;948    	ips_bat_av_vzvod=0;
001078  f8839000          STRB     r9,[r3,#0]
;;;949         
;;;950    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
00107c  4628              MOV      r0,r5
00107e  f7fffffe          BL       lc640_read_int
001082  b286              UXTH     r6,r0
;;;951    	event_ptr_find=event_ptr;
001084  4634              MOV      r4,r6
                  |L1.4230|
;;;952    	
;;;953    avar_bat_ips_hndl_lbl1: 
;;;954    
;;;955    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001086  eb0a1044          ADD      r0,r10,r4,LSL #5
00108a  b285              UXTH     r5,r0
;;;956    
;;;957         lc640_read_long_ptr(lc640_adr,data);
00108c  4669              MOV      r1,sp
00108e  4628              MOV      r0,r5
001090  f7fffffe          BL       lc640_read_long_ptr
;;;958         
;;;959         if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
001094  f89d0000          LDRB     r0,[sp,#0]
001098  2842              CMP      r0,#0x42
00109a  d106              BNE      |L1.4266|
00109c  f89d0001          LDRB     r0,[sp,#1]
0010a0  b918              CBNZ     r0,|L1.4266|
0010a2  f89d0002          LDRB     r0,[sp,#2]
0010a6  2843              CMP      r0,#0x43
0010a8  d009              BEQ      |L1.4286|
                  |L1.4266|
;;;960         	{        
;;;961         	if(event_ptr_find)event_ptr_find--;
0010aa  b11c              CBZ      r4,|L1.4276|
0010ac  f1a40401          SUB      r4,r4,#1
0010b0  b2a4              UXTH     r4,r4
0010b2  e001              B        |L1.4280|
                  |L1.4276|
;;;962         	else event_ptr_find=63;
0010b4  f04f043f          MOV      r4,#0x3f
                  |L1.4280|
;;;963         	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
0010b8  42b4              CMP      r4,r6
0010ba  d1e4              BNE      |L1.4230|
0010bc  e05e              B        |L1.4476|
                  |L1.4286|
;;;964         	else goto avar_bat_ips_hndl_lbl1;
;;;965         	}
;;;966         else 
;;;967         	{
;;;968         	lc640_read_long_ptr(lc640_adr+16,data);
0010be  4669              MOV      r1,sp
0010c0  f1050010          ADD      r0,r5,#0x10
0010c4  f7fffffe          BL       lc640_read_long_ptr
;;;969         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0010c8  f89d0000          LDRB     r0,[sp,#0]
0010cc  2841              CMP      r0,#0x41
0010ce  d10b              BNE      |L1.4328|
0010d0  f89d0001          LDRB     r0,[sp,#1]
0010d4  2841              CMP      r0,#0x41
0010d6  d107              BNE      |L1.4328|
0010d8  f89d0002          LDRB     r0,[sp,#2]
0010dc  2841              CMP      r0,#0x41
0010de  d103              BNE      |L1.4328|
0010e0  f89d0003          LDRB     r0,[sp,#3]
0010e4  2841              CMP      r0,#0x41
0010e6  d009              BEQ      |L1.4348|
                  |L1.4328|
;;;970         		{        
;;;971         		if(event_ptr_find)event_ptr_find--;
0010e8  b11c              CBZ      r4,|L1.4338|
0010ea  f1a40401          SUB      r4,r4,#1
0010ee  b2a4              UXTH     r4,r4
0010f0  e001              B        |L1.4342|
                  |L1.4338|
;;;972             		else event_ptr_find=63;
0010f2  f04f043f          MOV      r4,#0x3f
                  |L1.4342|
;;;973             	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
0010f6  42b4              CMP      r4,r6
0010f8  d1c5              BNE      |L1.4230|
0010fa  e03f              B        |L1.4476|
                  |L1.4348|
;;;974         		else goto avar_bat_ips_hndl_lbl1;
;;;975         		}
;;;976    
;;;977         	}
;;;978         		
;;;979    	data[0]=LPC_RTC->YEAR;
0010fc  f8b8003c          LDRH     r0,[r8,#0x3c]
001100  f88d0000          STRB     r0,[sp,#0]
;;;980    	data[1]=LPC_RTC->MONTH;
001104  f8980038          LDRB     r0,[r8,#0x38]
001108  f88d0001          STRB     r0,[sp,#1]
;;;981    	data[2]=LPC_RTC->DOM;
00110c  f898002c          LDRB     r0,[r8,#0x2c]
001110  f88d0002          STRB     r0,[sp,#2]
;;;982    	data[3]=0;
001114  f88d9003          STRB     r9,[sp,#3]
;;;983    	lc640_write_long_ptr(lc640_adr+16,data);
001118  4669              MOV      r1,sp
00111a  f1050010          ADD      r0,r5,#0x10
00111e  f7fffffe          BL       lc640_write_long_ptr
;;;984    
;;;985    	data[0]=LPC_RTC->HOUR;
001122  f8980028          LDRB     r0,[r8,#0x28]
001126  f88d0000          STRB     r0,[sp,#0]
;;;986    	data[1]=LPC_RTC->MIN;
00112a  f8980024          LDRB     r0,[r8,#0x24]
00112e  f88d0001          STRB     r0,[sp,#1]
;;;987    	data[2]=LPC_RTC->SEC;
001132  f8980020          LDRB     r0,[r8,#0x20]
001136  f88d0002          STRB     r0,[sp,#2]
;;;988    	data[3]=0;
00113a  f88d9003          STRB     r9,[sp,#3]
;;;989    	lc640_write_long_ptr(lc640_adr+20,data);
00113e  4669              MOV      r1,sp
001140  f1050014          ADD      r0,r5,#0x14
001144  f7fffffe          BL       lc640_write_long_ptr
;;;990    	
;;;991    	data[0]='B';
001148  f88d7000          STRB     r7,[sp,#0]
;;;992    	data[1]='B';
00114c  f88d7001          STRB     r7,[sp,#1]
;;;993    	data[2]='B';
001150  f88d7002          STRB     r7,[sp,#2]
;;;994    	data[3]='B';
001154  f88d7003          STRB     r7,[sp,#3]
;;;995    	lc640_write_long_ptr(lc640_adr+24,data);
001158  4669              MOV      r1,sp
00115a  f1050018          ADD      r0,r5,#0x18
00115e  f7fffffe          BL       lc640_write_long_ptr
;;;996    	
;;;997    	data[0]='B';
001162  f88d7000          STRB     r7,[sp,#0]
;;;998    	data[1]='B';
001166  f88d7001          STRB     r7,[sp,#1]
;;;999    	data[2]='B';
00116a  f88d7002          STRB     r7,[sp,#2]
;;;1000   	data[3]='B';
00116e  f88d7003          STRB     r7,[sp,#3]
;;;1001   	lc640_write_long_ptr(lc640_adr+28,data);
001172  4669              MOV      r1,sp
001174  f105001c          ADD      r0,r5,#0x1c
001178  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4476|
;;;1002   	
;;;1003   
;;;1004   	
;;;1005   	}
;;;1006   	
;;;1007   avar_bat_ips_hndl_end:
;;;1008   __nop();		
00117c  bf00              NOP      
                  |L1.4478|
;;;1009   }
00117e  e573              B        |L1.3176|
;;;1010   
                          ENDP

                  avar_bat_hndl PROC
;;;1013   //-----------------------------------------------
;;;1014   void avar_bat_hndl(char b, char in)
001180  e92d4ff8          PUSH     {r3-r11,lr}
;;;1015   {
001184  4606              MOV      r6,r0
;;;1016   char data[4];
;;;1017   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1018   
;;;1019   if(in==1)
;;;1020   	{
;;;1021   	bat[b]._av|=1;
001186  4854              LDR      r0,|L1.4824|
001188  eb060246          ADD      r2,r6,r6,LSL #1
;;;1022       
;;;1023   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1024   	event_ptr++;	
;;;1025   	if(event_ptr>63)event_ptr=0;	
;;;1026   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1027   	
;;;1028        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1029   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1030   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1031   	
;;;1032   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1033   	
;;;1034   	data[0]='B';
;;;1035   	data[1]=b;
;;;1036   	data[2]='C';
;;;1037   	data[3]=0;
;;;1038   	lc640_write_long_ptr(lc640_adr,data);
;;;1039   
;;;1040   	data[0]=0;
;;;1041   	data[1]=0;
;;;1042   	data[2]=0;
;;;1043   	data[3]=0;
;;;1044   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1045   
;;;1046   	data[0]=LPC_RTC->YEAR;
00118c  f8df8130          LDR      r8,|L1.4800|
001190  eb021206          ADD      r2,r2,r6,LSL #4       ;1021
001194  f04f0a00          MOV      r10,#0                ;1025
001198  f04f0942          MOV      r9,#0x42              ;1034
00119c  f44f6560          MOV      r5,#0xe00             ;1023
0011a0  f44f6b80          MOV      r11,#0x400            ;1032
0011a4  eb000082          ADD      r0,r0,r2,LSL #2       ;1021
0011a8  2901              CMP      r1,#1                 ;1019
0011aa  d002              BEQ      |L1.4530|
;;;1047   	data[1]=LPC_RTC->MONTH;
;;;1048   	data[2]=LPC_RTC->DOM;
;;;1049   	data[3]=0;
;;;1050   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1051   
;;;1052   	data[0]=LPC_RTC->HOUR;
;;;1053   	data[1]=LPC_RTC->MIN;
;;;1054   	data[2]=LPC_RTC->SEC;
;;;1055   	data[3]=0;
;;;1056   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1057   	
;;;1058   	data[0]='A';
;;;1059   	data[1]='A';
;;;1060   	data[2]='A';
;;;1061   	data[3]='A';
;;;1062   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1063   	
;;;1064   	data[0]='A';
;;;1065   	data[1]='A';
;;;1066   	data[2]='A';
;;;1067   	data[3]='A';
;;;1068   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1069   	
;;;1070   	data[0]='A';
;;;1071   	data[1]='A';
;;;1072   	data[2]='A';
;;;1073   	data[3]='A';
;;;1074   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1075   	
;;;1076   	data[0]='A';
;;;1077   	data[1]='A';
;;;1078   	data[2]='A';
;;;1079   	data[3]='A';
;;;1080   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1081   					
;;;1082   	if(b==0)
;;;1083   		{
;;;1084   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1085   		}
;;;1086   	else if(b==1)
;;;1087   		{
;;;1088   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1089   		} 
;;;1090   			
;;;1091   	}
;;;1092   
;;;1093   else if(in==0)
0011ac  2900              CMP      r1,#0
0011ae  d07d              BEQ      |L1.4780|
0011b0  e146              B        |L1.5184|
                  |L1.4530|
0011b2  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1021
0011b6  f0410101          ORR      r1,r1,#1              ;1021
0011ba  7001              STRB     r1,[r0,#0]            ;1021
0011bc  4628              MOV      r0,r5                 ;1023
0011be  f7fffffe          BL       lc640_read_int
0011c2  f1000001          ADD      r0,r0,#1              ;1024
0011c6  b284              UXTH     r4,r0                 ;1024
0011c8  2c3f              CMP      r4,#0x3f              ;1025
0011ca  d901              BLS      |L1.4560|
0011cc  f04f0400          MOV      r4,#0                 ;1025
                  |L1.4560|
0011d0  b221              SXTH     r1,r4                 ;1026
0011d2  4628              MOV      r0,r5                 ;1026
0011d4  f7fffffe          BL       lc640_write_int
0011d8  f6406702          MOV      r7,#0xe02             ;1028
0011dc  4638              MOV      r0,r7                 ;1028
0011de  f7fffffe          BL       lc640_read_int
0011e2  b280              UXTH     r0,r0                 ;1028
0011e4  283f              CMP      r0,#0x3f              ;1029
0011e6  d000              BEQ      |L1.4586|
0011e8  4620              MOV      r0,r4                 ;1029
                  |L1.4586|
0011ea  b201              SXTH     r1,r0                 ;1030
0011ec  4638              MOV      r0,r7                 ;1030
0011ee  f7fffffe          BL       lc640_write_int
0011f2  4628              MOV      r0,r5                 ;1032
0011f4  f7fffffe          BL       lc640_read_int
0011f8  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1032
0011fc  b284              UXTH     r4,r0                 ;1032
0011fe  f88d9000          STRB     r9,[sp,#0]            ;1034
001202  f88d6001          STRB     r6,[sp,#1]            ;1035
001206  f04f0043          MOV      r0,#0x43              ;1036
00120a  f88d0002          STRB     r0,[sp,#2]            ;1036
00120e  f88da003          STRB     r10,[sp,#3]           ;1037
001212  4669              MOV      r1,sp                 ;1038
001214  4620              MOV      r0,r4                 ;1038
001216  f7fffffe          BL       lc640_write_long_ptr
00121a  f8cda000          STR      r10,[sp,#0]           ;1043
00121e  4669              MOV      r1,sp                 ;1044
001220  1d20              ADDS     r0,r4,#4              ;1044
001222  f7fffffe          BL       lc640_write_long_ptr
001226  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1046
00122a  f88d0000          STRB     r0,[sp,#0]            ;1046
00122e  f8980038          LDRB     r0,[r8,#0x38]         ;1047
001232  f88d0001          STRB     r0,[sp,#1]            ;1047
001236  f898002c          LDRB     r0,[r8,#0x2c]         ;1048
00123a  f88d0002          STRB     r0,[sp,#2]            ;1048
00123e  f88da003          STRB     r10,[sp,#3]           ;1049
001242  4669              MOV      r1,sp                 ;1050
001244  f1040008          ADD      r0,r4,#8              ;1050
001248  f7fffffe          BL       lc640_write_long_ptr
00124c  f8980028          LDRB     r0,[r8,#0x28]         ;1052
001250  f88d0000          STRB     r0,[sp,#0]            ;1052
001254  f8980024          LDRB     r0,[r8,#0x24]         ;1053
001258  f88d0001          STRB     r0,[sp,#1]            ;1053
00125c  f8980020          LDRB     r0,[r8,#0x20]         ;1054
001260  f88d0002          STRB     r0,[sp,#2]            ;1054
001264  f88da003          STRB     r10,[sp,#3]           ;1055
001268  4669              MOV      r1,sp                 ;1056
00126a  f104000c          ADD      r0,r4,#0xc            ;1056
00126e  f7fffffe          BL       lc640_write_long_ptr
001272  f04f0541          MOV      r5,#0x41              ;1058
001276  f88d5000          STRB     r5,[sp,#0]            ;1058
00127a  f88d5001          STRB     r5,[sp,#1]            ;1059
00127e  f88d5002          STRB     r5,[sp,#2]            ;1060
001282  f88d5003          STRB     r5,[sp,#3]            ;1061
001286  4669              MOV      r1,sp                 ;1062
001288  f1040010          ADD      r0,r4,#0x10           ;1062
00128c  f7fffffe          BL       lc640_write_long_ptr
001290  f88d5000          STRB     r5,[sp,#0]            ;1064
001294  f88d5001          STRB     r5,[sp,#1]            ;1065
001298  f88d5002          STRB     r5,[sp,#2]            ;1066
00129c  f88d5003          STRB     r5,[sp,#3]            ;1067
0012a0  4669              MOV      r1,sp                 ;1068
0012a2  f1040014          ADD      r0,r4,#0x14           ;1068
0012a6  f7fffffe          BL       lc640_write_long_ptr
0012aa  e017              B        |L1.4828|
                  |L1.4780|
0012ac  e042              B        |L1.4916|
0012ae  0000              DCW      0x0000
                  |L1.4784|
                          DCD      0x40024020
                  |L1.4788|
                          DCD      bat_ips
                  |L1.4792|
                          DCD      ips_bat_av_stat
                  |L1.4796|
                          DCD      ips_bat_av_vzvod
                  |L1.4800|
                          DCD      0x40024000
                  |L1.4804|
0012c4  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
0012c8  b9312041
0012cc  6c61726d
0012d0  2c206c6f
0012d4  737400  
0012d7  00                DCB      0
                  |L1.4824|
                          DCD      bat
                  |L1.4828|
0012dc  f88d5000          STRB     r5,[sp,#0]            ;1070
0012e0  f88d5001          STRB     r5,[sp,#1]            ;1071
0012e4  f88d5002          STRB     r5,[sp,#2]            ;1072
0012e8  f88d5003          STRB     r5,[sp,#3]            ;1073
0012ec  4669              MOV      r1,sp                 ;1074
0012ee  f1040018          ADD      r0,r4,#0x18           ;1074
0012f2  f7fffffe          BL       lc640_write_long_ptr
0012f6  f88d5000          STRB     r5,[sp,#0]            ;1076
0012fa  f88d5001          STRB     r5,[sp,#1]            ;1077
0012fe  f88d5002          STRB     r5,[sp,#2]            ;1078
001302  f88d5003          STRB     r5,[sp,#3]            ;1079
001306  4669              MOV      r1,sp                 ;1080
001308  f104001c          ADD      r0,r4,#0x1c           ;1080
00130c  f7fffffe          BL       lc640_write_long_ptr
001310  b116              CBZ      r6,|L1.4888|
001312  2e01              CMP      r6,#1                 ;1086
001314  d007              BEQ      |L1.4902|
001316  e093              B        |L1.5184|
                  |L1.4888|
001318  2301              MOVS     r3,#1                 ;1084
00131a  461a              MOV      r2,r3                 ;1084
00131c  2105              MOVS     r1,#5                 ;1084
00131e  a0fe              ADR      r0,|L1.5912|
001320  f7fffffe          BL       snmp_trap_send
001324  e08c              B        |L1.5184|
                  |L1.4902|
001326  2301              MOVS     r3,#1                 ;1088
001328  2202              MOVS     r2,#2                 ;1088
00132a  2105              MOVS     r1,#5                 ;1088
00132c  a0ff              ADR      r0,|L1.5932|
00132e  f7fffffe          BL       snmp_trap_send
001332  e085              B        |L1.5184|
                  |L1.4916|
;;;1094   	{
;;;1095   	bat[b]._av&=~1;
001334  f8101f3d          LDRB     r1,[r0,#0x3d]!
001338  f0210101          BIC      r1,r1,#1
00133c  7001              STRB     r1,[r0,#0]
;;;1096   
;;;1097        event_ptr=lc640_read_int(PTR_EVENT_LOG);
00133e  4628              MOV      r0,r5
001340  f7fffffe          BL       lc640_read_int
001344  b287              UXTH     r7,r0
;;;1098   	event_ptr_find=event_ptr;
001346  463c              MOV      r4,r7
                  |L1.4936|
;;;1099   	
;;;1100   avar_bat_hndl_lbl1: 
;;;1101   
;;;1102   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001348  eb0b1044          ADD      r0,r11,r4,LSL #5
00134c  b285              UXTH     r5,r0
;;;1103   
;;;1104        lc640_read_long_ptr(lc640_adr,data);
00134e  4669              MOV      r1,sp
001350  4628              MOV      r0,r5
001352  f7fffffe          BL       lc640_read_long_ptr
;;;1105        
;;;1106        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
001356  f89d0000          LDRB     r0,[sp,#0]
00135a  2842              CMP      r0,#0x42
00135c  d107              BNE      |L1.4974|
00135e  f89d0001          LDRB     r0,[sp,#1]
001362  42b0              CMP      r0,r6
001364  d103              BNE      |L1.4974|
001366  f89d0002          LDRB     r0,[sp,#2]
00136a  2843              CMP      r0,#0x43
00136c  d009              BEQ      |L1.4994|
                  |L1.4974|
;;;1107        	{        
;;;1108        	if(event_ptr_find)event_ptr_find--;
00136e  b11c              CBZ      r4,|L1.4984|
001370  f1a40401          SUB      r4,r4,#1
001374  b2a4              UXTH     r4,r4
001376  e001              B        |L1.4988|
                  |L1.4984|
;;;1109        	else event_ptr_find=63;
001378  f04f043f          MOV      r4,#0x3f
                  |L1.4988|
;;;1110        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
00137c  42bc              CMP      r4,r7
00137e  d1e3              BNE      |L1.4936|
001380  e05e              B        |L1.5184|
                  |L1.4994|
;;;1111        	else goto avar_bat_hndl_lbl1;
;;;1112        	}
;;;1113        else 
;;;1114        	{
;;;1115        	lc640_read_long_ptr(lc640_adr+16,data);
001382  4669              MOV      r1,sp
001384  f1050010          ADD      r0,r5,#0x10
001388  f7fffffe          BL       lc640_read_long_ptr
;;;1116        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00138c  f89d0000          LDRB     r0,[sp,#0]
001390  2841              CMP      r0,#0x41
001392  d10b              BNE      |L1.5036|
001394  f89d0001          LDRB     r0,[sp,#1]
001398  2841              CMP      r0,#0x41
00139a  d107              BNE      |L1.5036|
00139c  f89d0002          LDRB     r0,[sp,#2]
0013a0  2841              CMP      r0,#0x41
0013a2  d103              BNE      |L1.5036|
0013a4  f89d0003          LDRB     r0,[sp,#3]
0013a8  2841              CMP      r0,#0x41
0013aa  d009              BEQ      |L1.5056|
                  |L1.5036|
;;;1117        		{        
;;;1118        		if(event_ptr_find)event_ptr_find--;
0013ac  b11c              CBZ      r4,|L1.5046|
0013ae  f1a40401          SUB      r4,r4,#1
0013b2  b2a4              UXTH     r4,r4
0013b4  e001              B        |L1.5050|
                  |L1.5046|
;;;1119            		else event_ptr_find=63;
0013b6  f04f043f          MOV      r4,#0x3f
                  |L1.5050|
;;;1120            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
0013ba  42bc              CMP      r4,r7
0013bc  d1c4              BNE      |L1.4936|
0013be  e03f              B        |L1.5184|
                  |L1.5056|
;;;1121        		else goto avar_bat_hndl_lbl1;
;;;1122        		}
;;;1123   
;;;1124        	}
;;;1125        		
;;;1126   	data[0]=LPC_RTC->YEAR;
0013c0  f8b8003c          LDRH     r0,[r8,#0x3c]
0013c4  f88d0000          STRB     r0,[sp,#0]
;;;1127   	data[1]=LPC_RTC->MONTH;
0013c8  f8980038          LDRB     r0,[r8,#0x38]
0013cc  f88d0001          STRB     r0,[sp,#1]
;;;1128   	data[2]=LPC_RTC->DOM;
0013d0  f898002c          LDRB     r0,[r8,#0x2c]
0013d4  f88d0002          STRB     r0,[sp,#2]
;;;1129   	data[3]=0;
0013d8  f88da003          STRB     r10,[sp,#3]
;;;1130   	lc640_write_long_ptr(lc640_adr+16,data);
0013dc  4669              MOV      r1,sp
0013de  f1050010          ADD      r0,r5,#0x10
0013e2  f7fffffe          BL       lc640_write_long_ptr
;;;1131   
;;;1132   	data[0]=LPC_RTC->HOUR;
0013e6  f8980028          LDRB     r0,[r8,#0x28]
0013ea  f88d0000          STRB     r0,[sp,#0]
;;;1133   	data[1]=LPC_RTC->MIN;
0013ee  f8980024          LDRB     r0,[r8,#0x24]
0013f2  f88d0001          STRB     r0,[sp,#1]
;;;1134   	data[2]=LPC_RTC->SEC;
0013f6  f8980020          LDRB     r0,[r8,#0x20]
0013fa  f88d0002          STRB     r0,[sp,#2]
;;;1135   	data[3]=0;
0013fe  f88da003          STRB     r10,[sp,#3]
;;;1136   	lc640_write_long_ptr(lc640_adr+20,data);
001402  4669              MOV      r1,sp
001404  f1050014          ADD      r0,r5,#0x14
001408  f7fffffe          BL       lc640_write_long_ptr
;;;1137   	
;;;1138   	data[0]='B';
00140c  f88d9000          STRB     r9,[sp,#0]
;;;1139   	data[1]='B';
001410  f88d9001          STRB     r9,[sp,#1]
;;;1140   	data[2]='B';
001414  f88d9002          STRB     r9,[sp,#2]
;;;1141   	data[3]='B';
001418  f88d9003          STRB     r9,[sp,#3]
;;;1142   	lc640_write_long_ptr(lc640_adr+24,data);
00141c  4669              MOV      r1,sp
00141e  f1050018          ADD      r0,r5,#0x18
001422  f7fffffe          BL       lc640_write_long_ptr
;;;1143   	
;;;1144   	data[0]='B';
001426  f88d9000          STRB     r9,[sp,#0]
;;;1145   	data[1]='B';
00142a  f88d9001          STRB     r9,[sp,#1]
;;;1146   	data[2]='B';
00142e  f88d9002          STRB     r9,[sp,#2]
;;;1147   	data[3]='B';
001432  f88d9003          STRB     r9,[sp,#3]
;;;1148   	lc640_write_long_ptr(lc640_adr+28,data);
001436  4669              MOV      r1,sp
001438  f105001c          ADD      r0,r5,#0x1c
00143c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5184|
;;;1149   	
;;;1150   
;;;1151   	
;;;1152   	}
;;;1153   	
;;;1154   avar_bat_hndl_end:
;;;1155   __nop();		
001440  bf00              NOP      
                  |L1.5186|
;;;1156   }
001442  e411              B        |L1.3176|
;;;1157   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1158   //-----------------------------------------------
;;;1159   void avar_bat_as_hndl(char b, char in)
001444  e92d4ff8          PUSH     {r3-r11,lr}
;;;1160   {
001448  4606              MOV      r6,r0
;;;1161   char data[4];
;;;1162   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1163   
;;;1164   if(in==1)
;;;1165   	{
;;;1166   	bat[b]._av|=2;
00144a  48bd              LDR      r0,|L1.5952|
00144c  eb060246          ADD      r2,r6,r6,LSL #1
;;;1167       
;;;1168   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1169   	event_ptr++;	
;;;1170   	if(event_ptr>63)event_ptr=0;	
;;;1171   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1172   	
;;;1173        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1174   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1175   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1176   	
;;;1177   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1178   	
;;;1179   	data[0]='B';
;;;1180   	data[1]=b;
;;;1181   	data[2]='S';
;;;1182   	data[3]=0;
;;;1183   	lc640_write_long_ptr(lc640_adr,data);
;;;1184   
;;;1185   	data[0]=0;
;;;1186   	data[1]=0;
;;;1187   	data[2]=0;
;;;1188   	data[3]=0;
;;;1189   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1190   
;;;1191   	data[0]=LPC_RTC->YEAR;
001450  f8df82f0          LDR      r8,|L1.5956|
001454  eb021206          ADD      r2,r2,r6,LSL #4       ;1166
001458  f04f0a00          MOV      r10,#0                ;1170
00145c  f04f0942          MOV      r9,#0x42              ;1179
001460  f44f6560          MOV      r5,#0xe00             ;1168
001464  f44f6b80          MOV      r11,#0x400            ;1177
001468  eb000082          ADD      r0,r0,r2,LSL #2       ;1166
00146c  2901              CMP      r1,#1                 ;1164
00146e  d002              BEQ      |L1.5238|
;;;1192   	data[1]=LPC_RTC->MONTH;
;;;1193   	data[2]=LPC_RTC->DOM;
;;;1194   	data[3]=0;
;;;1195   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1196   
;;;1197   	data[0]=LPC_RTC->HOUR;
;;;1198   	data[1]=LPC_RTC->MIN;
;;;1199   	data[2]=LPC_RTC->SEC;
;;;1200   	data[3]=0;
;;;1201   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1202   	
;;;1203   	data[0]='A';
;;;1204   	data[1]='A';
;;;1205   	data[2]='A';
;;;1206   	data[3]='A';
;;;1207   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1208   	
;;;1209   	data[0]='A';
;;;1210   	data[1]='A';
;;;1211   	data[2]='A';
;;;1212   	data[3]='A';
;;;1213   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1214   	
;;;1215   	data[0]='A';
;;;1216   	data[1]='A';
;;;1217   	data[2]='A';
;;;1218   	data[3]='A';
;;;1219   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1220   	
;;;1221   	data[0]='A';
;;;1222   	data[1]='A';
;;;1223   	data[2]='A';
;;;1224   	data[3]='A';
;;;1225   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1226   
;;;1227   	if(b==0)
;;;1228   		{
;;;1229   		snmp_trap_send("BAT #1 Alarm, assimetry",5,1,2);
;;;1230   		}
;;;1231   	else if(b==1)
;;;1232   		{
;;;1233   		snmp_trap_send("BAT #2 Alarm, assimetry",5,2,2);
;;;1234   		} 
;;;1235   	
;;;1236   	}
;;;1237   
;;;1238   else if(in==0)
001470  2900              CMP      r1,#0
001472  d07d              BEQ      |L1.5488|
001474  e12f              B        |L1.5846|
                  |L1.5238|
001476  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1166
00147a  f0410102          ORR      r1,r1,#2              ;1166
00147e  7001              STRB     r1,[r0,#0]            ;1166
001480  4628              MOV      r0,r5                 ;1168
001482  f7fffffe          BL       lc640_read_int
001486  f1000001          ADD      r0,r0,#1              ;1169
00148a  b284              UXTH     r4,r0                 ;1169
00148c  2c3f              CMP      r4,#0x3f              ;1170
00148e  d901              BLS      |L1.5268|
001490  f04f0400          MOV      r4,#0                 ;1170
                  |L1.5268|
001494  b221              SXTH     r1,r4                 ;1171
001496  4628              MOV      r0,r5                 ;1171
001498  f7fffffe          BL       lc640_write_int
00149c  f6406702          MOV      r7,#0xe02             ;1173
0014a0  4638              MOV      r0,r7                 ;1173
0014a2  f7fffffe          BL       lc640_read_int
0014a6  b280              UXTH     r0,r0                 ;1173
0014a8  283f              CMP      r0,#0x3f              ;1174
0014aa  d000              BEQ      |L1.5294|
0014ac  4620              MOV      r0,r4                 ;1174
                  |L1.5294|
0014ae  b201              SXTH     r1,r0                 ;1175
0014b0  4638              MOV      r0,r7                 ;1175
0014b2  f7fffffe          BL       lc640_write_int
0014b6  4628              MOV      r0,r5                 ;1177
0014b8  f7fffffe          BL       lc640_read_int
0014bc  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1177
0014c0  b284              UXTH     r4,r0                 ;1177
0014c2  f88d9000          STRB     r9,[sp,#0]            ;1179
0014c6  f88d6001          STRB     r6,[sp,#1]            ;1180
0014ca  f04f0053          MOV      r0,#0x53              ;1181
0014ce  f88d0002          STRB     r0,[sp,#2]            ;1181
0014d2  f88da003          STRB     r10,[sp,#3]           ;1182
0014d6  4669              MOV      r1,sp                 ;1183
0014d8  4620              MOV      r0,r4                 ;1183
0014da  f7fffffe          BL       lc640_write_long_ptr
0014de  f8cda000          STR      r10,[sp,#0]           ;1188
0014e2  4669              MOV      r1,sp                 ;1189
0014e4  1d20              ADDS     r0,r4,#4              ;1189
0014e6  f7fffffe          BL       lc640_write_long_ptr
0014ea  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1191
0014ee  f88d0000          STRB     r0,[sp,#0]            ;1191
0014f2  f8980038          LDRB     r0,[r8,#0x38]         ;1192
0014f6  f88d0001          STRB     r0,[sp,#1]            ;1192
0014fa  f898002c          LDRB     r0,[r8,#0x2c]         ;1193
0014fe  f88d0002          STRB     r0,[sp,#2]            ;1193
001502  f88da003          STRB     r10,[sp,#3]           ;1194
001506  4669              MOV      r1,sp                 ;1195
001508  f1040008          ADD      r0,r4,#8              ;1195
00150c  f7fffffe          BL       lc640_write_long_ptr
001510  f8980028          LDRB     r0,[r8,#0x28]         ;1197
001514  f88d0000          STRB     r0,[sp,#0]            ;1197
001518  f8980024          LDRB     r0,[r8,#0x24]         ;1198
00151c  f88d0001          STRB     r0,[sp,#1]            ;1198
001520  f8980020          LDRB     r0,[r8,#0x20]         ;1199
001524  f88d0002          STRB     r0,[sp,#2]            ;1199
001528  f88da003          STRB     r10,[sp,#3]           ;1200
00152c  4669              MOV      r1,sp                 ;1201
00152e  f104000c          ADD      r0,r4,#0xc            ;1201
001532  f7fffffe          BL       lc640_write_long_ptr
001536  f04f0541          MOV      r5,#0x41              ;1203
00153a  f88d5000          STRB     r5,[sp,#0]            ;1203
00153e  f88d5001          STRB     r5,[sp,#1]            ;1204
001542  f88d5002          STRB     r5,[sp,#2]            ;1205
001546  f88d5003          STRB     r5,[sp,#3]            ;1206
00154a  4669              MOV      r1,sp                 ;1207
00154c  f1040010          ADD      r0,r4,#0x10           ;1207
001550  f7fffffe          BL       lc640_write_long_ptr
001554  f88d5000          STRB     r5,[sp,#0]            ;1209
001558  f88d5001          STRB     r5,[sp,#1]            ;1210
00155c  f88d5002          STRB     r5,[sp,#2]            ;1211
001560  f88d5003          STRB     r5,[sp,#3]            ;1212
001564  4669              MOV      r1,sp                 ;1213
001566  f1040014          ADD      r0,r4,#0x14           ;1213
00156a  f7fffffe          BL       lc640_write_long_ptr
00156e  e000              B        |L1.5490|
                  |L1.5488|
001570  e02b              B        |L1.5578|
                  |L1.5490|
001572  f88d5000          STRB     r5,[sp,#0]            ;1215
001576  f88d5001          STRB     r5,[sp,#1]            ;1216
00157a  f88d5002          STRB     r5,[sp,#2]            ;1217
00157e  f88d5003          STRB     r5,[sp,#3]            ;1218
001582  4669              MOV      r1,sp                 ;1219
001584  f1040018          ADD      r0,r4,#0x18           ;1219
001588  f7fffffe          BL       lc640_write_long_ptr
00158c  f88d5000          STRB     r5,[sp,#0]            ;1221
001590  f88d5001          STRB     r5,[sp,#1]            ;1222
001594  f88d5002          STRB     r5,[sp,#2]            ;1223
001598  f88d5003          STRB     r5,[sp,#3]            ;1224
00159c  4669              MOV      r1,sp                 ;1225
00159e  f104001c          ADD      r0,r4,#0x1c           ;1225
0015a2  f7fffffe          BL       lc640_write_long_ptr
0015a6  b116              CBZ      r6,|L1.5550|
0015a8  2e01              CMP      r6,#1                 ;1231
0015aa  d007              BEQ      |L1.5564|
0015ac  e093              B        |L1.5846|
                  |L1.5550|
0015ae  2302              MOVS     r3,#2                 ;1229
0015b0  2201              MOVS     r2,#1                 ;1229
0015b2  2105              MOVS     r1,#5                 ;1229
0015b4  a064              ADR      r0,|L1.5960|
0015b6  f7fffffe          BL       snmp_trap_send
0015ba  e08c              B        |L1.5846|
                  |L1.5564|
0015bc  2302              MOVS     r3,#2                 ;1233
0015be  461a              MOV      r2,r3                 ;1233
0015c0  2105              MOVS     r1,#5                 ;1233
0015c2  a067              ADR      r0,|L1.5984|
0015c4  f7fffffe          BL       snmp_trap_send
0015c8  e085              B        |L1.5846|
                  |L1.5578|
;;;1239   	{
;;;1240   	bat[b]._av&=~(1<<1);
0015ca  f8101f3d          LDRB     r1,[r0,#0x3d]!
0015ce  f0210102          BIC      r1,r1,#2
0015d2  7001              STRB     r1,[r0,#0]
;;;1241   
;;;1242        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0015d4  4628              MOV      r0,r5
0015d6  f7fffffe          BL       lc640_read_int
0015da  b287              UXTH     r7,r0
;;;1243   	event_ptr_find=event_ptr;
0015dc  463c              MOV      r4,r7
                  |L1.5598|
;;;1244   	
;;;1245   avar_bat_as_hndl_lbl1: 
;;;1246   
;;;1247   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0015de  eb0b1044          ADD      r0,r11,r4,LSL #5
0015e2  b285              UXTH     r5,r0
;;;1248   
;;;1249        lc640_read_long_ptr(lc640_adr,data);
0015e4  4669              MOV      r1,sp
0015e6  4628              MOV      r0,r5
0015e8  f7fffffe          BL       lc640_read_long_ptr
;;;1250        
;;;1251        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
0015ec  f89d0000          LDRB     r0,[sp,#0]
0015f0  2842              CMP      r0,#0x42
0015f2  d107              BNE      |L1.5636|
0015f4  f89d0001          LDRB     r0,[sp,#1]
0015f8  42b0              CMP      r0,r6
0015fa  d103              BNE      |L1.5636|
0015fc  f89d0002          LDRB     r0,[sp,#2]
001600  2843              CMP      r0,#0x43
001602  d009              BEQ      |L1.5656|
                  |L1.5636|
;;;1252        	{        
;;;1253        	if(event_ptr_find)event_ptr_find--;
001604  b11c              CBZ      r4,|L1.5646|
001606  f1a40401          SUB      r4,r4,#1
00160a  b2a4              UXTH     r4,r4
00160c  e001              B        |L1.5650|
                  |L1.5646|
;;;1254        	else event_ptr_find=63;
00160e  f04f043f          MOV      r4,#0x3f
                  |L1.5650|
;;;1255        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001612  42bc              CMP      r4,r7
001614  d1e3              BNE      |L1.5598|
001616  e05e              B        |L1.5846|
                  |L1.5656|
;;;1256        	else goto avar_bat_as_hndl_lbl1;
;;;1257        	}
;;;1258        else 
;;;1259        	{
;;;1260        	lc640_read_long_ptr(lc640_adr+16,data);
001618  4669              MOV      r1,sp
00161a  f1050010          ADD      r0,r5,#0x10
00161e  f7fffffe          BL       lc640_read_long_ptr
;;;1261        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001622  f89d0000          LDRB     r0,[sp,#0]
001626  2841              CMP      r0,#0x41
001628  d10b              BNE      |L1.5698|
00162a  f89d0001          LDRB     r0,[sp,#1]
00162e  2841              CMP      r0,#0x41
001630  d107              BNE      |L1.5698|
001632  f89d0002          LDRB     r0,[sp,#2]
001636  2841              CMP      r0,#0x41
001638  d103              BNE      |L1.5698|
00163a  f89d0003          LDRB     r0,[sp,#3]
00163e  2841              CMP      r0,#0x41
001640  d009              BEQ      |L1.5718|
                  |L1.5698|
;;;1262        		{        
;;;1263        		if(event_ptr_find)event_ptr_find--;
001642  b11c              CBZ      r4,|L1.5708|
001644  f1a40401          SUB      r4,r4,#1
001648  b2a4              UXTH     r4,r4
00164a  e001              B        |L1.5712|
                  |L1.5708|
;;;1264            		else event_ptr_find=63;
00164c  f04f043f          MOV      r4,#0x3f
                  |L1.5712|
;;;1265            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001650  42bc              CMP      r4,r7
001652  d1c4              BNE      |L1.5598|
001654  e03f              B        |L1.5846|
                  |L1.5718|
;;;1266        		else goto avar_bat_as_hndl_lbl1;
;;;1267        		}
;;;1268   
;;;1269        	}
;;;1270        		
;;;1271   	data[0]=LPC_RTC->YEAR;
001656  f8b8003c          LDRH     r0,[r8,#0x3c]
00165a  f88d0000          STRB     r0,[sp,#0]
;;;1272   	data[1]=LPC_RTC->MONTH;
00165e  f8980038          LDRB     r0,[r8,#0x38]
001662  f88d0001          STRB     r0,[sp,#1]
;;;1273   	data[2]=LPC_RTC->DOM;
001666  f898002c          LDRB     r0,[r8,#0x2c]
00166a  f88d0002          STRB     r0,[sp,#2]
;;;1274   	data[3]=0;
00166e  f88da003          STRB     r10,[sp,#3]
;;;1275   	lc640_write_long_ptr(lc640_adr+16,data);
001672  4669              MOV      r1,sp
001674  f1050010          ADD      r0,r5,#0x10
001678  f7fffffe          BL       lc640_write_long_ptr
;;;1276   
;;;1277   	data[0]=LPC_RTC->HOUR;
00167c  f8980028          LDRB     r0,[r8,#0x28]
001680  f88d0000          STRB     r0,[sp,#0]
;;;1278   	data[1]=LPC_RTC->MIN;
001684  f8980024          LDRB     r0,[r8,#0x24]
001688  f88d0001          STRB     r0,[sp,#1]
;;;1279   	data[2]=LPC_RTC->SEC;
00168c  f8980020          LDRB     r0,[r8,#0x20]
001690  f88d0002          STRB     r0,[sp,#2]
;;;1280   	data[3]=0;
001694  f88da003          STRB     r10,[sp,#3]
;;;1281   	lc640_write_long_ptr(lc640_adr+20,data);
001698  4669              MOV      r1,sp
00169a  f1050014          ADD      r0,r5,#0x14
00169e  f7fffffe          BL       lc640_write_long_ptr
;;;1282   	
;;;1283   	data[0]='B';
0016a2  f88d9000          STRB     r9,[sp,#0]
;;;1284   	data[1]='B';
0016a6  f88d9001          STRB     r9,[sp,#1]
;;;1285   	data[2]='B';
0016aa  f88d9002          STRB     r9,[sp,#2]
;;;1286   	data[3]='B';
0016ae  f88d9003          STRB     r9,[sp,#3]
;;;1287   	lc640_write_long_ptr(lc640_adr+24,data);
0016b2  4669              MOV      r1,sp
0016b4  f1050018          ADD      r0,r5,#0x18
0016b8  f7fffffe          BL       lc640_write_long_ptr
;;;1288   	
;;;1289   	data[0]='B';
0016bc  f88d9000          STRB     r9,[sp,#0]
;;;1290   	data[1]='B';
0016c0  f88d9001          STRB     r9,[sp,#1]
;;;1291   	data[2]='B';
0016c4  f88d9002          STRB     r9,[sp,#2]
;;;1292   	data[3]='B';
0016c8  f88d9003          STRB     r9,[sp,#3]
;;;1293   	lc640_write_long_ptr(lc640_adr+28,data);
0016cc  4669              MOV      r1,sp
0016ce  f105001c          ADD      r0,r5,#0x1c
0016d2  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5846|
;;;1294   	
;;;1295   
;;;1296   	
;;;1297   	}
;;;1298   	
;;;1299   avar_bat_as_hndl_end:
;;;1300   __nop();		
0016d6  bf00              NOP      
                  |L1.5848|
;;;1301   }
0016d8  e551              B        |L1.4478|
;;;1302   
                          ENDP

                  ke_zvu_mem_hndl PROC
;;;1303   //-----------------------------------------------
;;;1304   void ke_zvu_mem_hndl(char b,unsigned short in,unsigned short in1)
0016da  b5f7              PUSH     {r0-r2,r4-r7,lr}
;;;1305   {
0016dc  b082              SUB      sp,sp,#8
0016de  4605              MOV      r5,r0
;;;1306   char data[4];
;;;1307   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1308   //unsigned char temp,temp_;
;;;1309   //unsigned int tempUI;
;;;1310   //unsigned long tempUL; 
;;;1311   signed temp_temp;
;;;1312   
;;;1313   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
0016e0  eb050045          ADD      r0,r5,r5,LSL #1
0016e4  4916              LDR      r1,|L1.5952|
0016e6  eb001005          ADD      r0,r0,r5,LSL #4
0016ea  eb010180          ADD      r1,r1,r0,LSL #2
0016ee  4822              LDR      r0,|L1.6008|
0016f0  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
0016f4  f1000001          ADD      r0,r0,#1
0016f8  eb010040          ADD      r0,r1,r0,LSL #1
0016fc  f9b00020          LDRSH    r0,[r0,#0x20]
001700  9000              STR      r0,[sp,#0]
;;;1314   
;;;1315   event_ptr=lc640_read_int(PTR_EVENT_LOG);
001702  f44f6660          MOV      r6,#0xe00
001706  4630              MOV      r0,r6
001708  f7fffffe          BL       lc640_read_int
;;;1316   event_ptr++;	
00170c  f1000001          ADD      r0,r0,#1
001710  4604              MOV      r4,r0
;;;1317   if(event_ptr>63)event_ptr=0;	
001712  2c3f              CMP      r4,#0x3f
001714  d934              BLS      |L1.6016|
001716  e031              B        |L1.6012|
                  |L1.5912|
001718  42415420          DCB      "BAT #1 Alarm, lost",0
00171c  23312041
001720  6c61726d
001724  2c206c6f
001728  737400  
00172b  00                DCB      0
                  |L1.5932|
00172c  42415420          DCB      "BAT #2 Alarm, lost",0
001730  23322041
001734  6c61726d
001738  2c206c6f
00173c  737400  
00173f  00                DCB      0
                  |L1.5952|
                          DCD      bat
                  |L1.5956|
                          DCD      0x40024000
                  |L1.5960|
001748  42415420          DCB      "BAT #1 Alarm, assimetry",0
00174c  23312041
001750  6c61726d
001754  2c206173
001758  73696d65
00175c  74727900
                  |L1.5984|
001760  42415420          DCB      "BAT #2 Alarm, assimetry",0
001764  23322041
001768  6c61726d
00176c  2c206173
001770  73696d65
001774  74727900
                  |L1.6008|
                          DCD      bat_u_old_cnt
                  |L1.6012|
00177c  f04f0400          MOV      r4,#0
                  |L1.6016|
;;;1318   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
001780  b221              SXTH     r1,r4
001782  4630              MOV      r0,r6
001784  f7fffffe          BL       lc640_write_int
;;;1319   	
;;;1320   event_cnt=lc640_read_int(CNT_EVENT_LOG);
001788  f6406702          MOV      r7,#0xe02
00178c  4638              MOV      r0,r7
00178e  f7fffffe          BL       lc640_read_int
;;;1321   if(event_cnt!=63)event_cnt=event_ptr;
001792  283f              CMP      r0,#0x3f
001794  d000              BEQ      |L1.6040|
001796  4620              MOV      r0,r4
                  |L1.6040|
;;;1322   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
001798  b201              SXTH     r1,r0
00179a  4638              MOV      r0,r7
00179c  f7fffffe          BL       lc640_write_int
;;;1323   	
;;;1324   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
0017a0  4630              MOV      r0,r6
0017a2  f7fffffe          BL       lc640_read_int
0017a6  f44f6180          MOV      r1,#0x400
0017aa  eb011440          ADD      r4,r1,r0,LSL #5
;;;1325   	
;;;1326   data[0]='B';
0017ae  f04f0042          MOV      r0,#0x42
0017b2  f88d0004          STRB     r0,[sp,#4]
;;;1327   data[1]=b; 
0017b6  f88d5005          STRB     r5,[sp,#5]
;;;1328   data[2]='K';
0017ba  f04f004b          MOV      r0,#0x4b
0017be  f88d0006          STRB     r0,[sp,#6]
;;;1329   data[3]='Z';
0017c2  f04f005a          MOV      r0,#0x5a
0017c6  f88d0007          STRB     r0,[sp,#7]
;;;1330   
;;;1331   lc640_write_long_ptr(lc640_adr,data);
0017ca  a901              ADD      r1,sp,#4
0017cc  4620              MOV      r0,r4
0017ce  f7fffffe          BL       lc640_write_long_ptr
;;;1332   
;;;1333   data[0]=*((char*)&in);
0017d2  f89d000c          LDRB     r0,[sp,#0xc]
0017d6  f88d0004          STRB     r0,[sp,#4]
;;;1334   data[1]=*(((char*)(&in))+1);
0017da  f89d000d          LDRB     r0,[sp,#0xd]
0017de  f88d0005          STRB     r0,[sp,#5]
;;;1335   data[2]=*((char*)&temp_temp);
0017e2  f89d0000          LDRB     r0,[sp,#0]
0017e6  f88d0006          STRB     r0,[sp,#6]
;;;1336   data[3]=*(((char*)(&temp_temp))+1);
0017ea  f89d0001          LDRB     r0,[sp,#1]
0017ee  f88d0007          STRB     r0,[sp,#7]
;;;1337   lc640_write_long_ptr(lc640_adr+4,data);
0017f2  a901              ADD      r1,sp,#4
0017f4  1d20              ADDS     r0,r4,#4
0017f6  f7fffffe          BL       lc640_write_long_ptr
;;;1338   
;;;1339   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
0017fa  f24020a2          MOV      r0,#0x2a2
0017fe  f7fffffe          BL       lc640_read_long
001802  4dff              LDR      r5,|L1.7168|
001804  6028              STR      r0,[r5,#0]  ; ke_date
;;;1340   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
001806  4629              MOV      r1,r5
001808  f1040008          ADD      r0,r4,#8
00180c  f7fffffe          BL       lc640_write_long_ptr
;;;1341   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
001810  f24020a6          MOV      r0,#0x2a6
001814  f7fffffe          BL       lc640_read_long
001818  6068              STR      r0,[r5,#4]  ; ke_date
;;;1342   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
00181a  1d29              ADDS     r1,r5,#4
00181c  f104000c          ADD      r0,r4,#0xc
001820  f7fffffe          BL       lc640_write_long_ptr
;;;1343   
;;;1344   data[0]=LPC_RTC->YEAR;
001824  4df7              LDR      r5,|L1.7172|
001826  8ba8              LDRH     r0,[r5,#0x1c]
001828  f88d0004          STRB     r0,[sp,#4]
;;;1345   data[1]=LPC_RTC->MONTH;
00182c  7e28              LDRB     r0,[r5,#0x18]
00182e  f88d0005          STRB     r0,[sp,#5]
;;;1346   data[2]=LPC_RTC->DOM;
001832  7b28              LDRB     r0,[r5,#0xc]
001834  f88d0006          STRB     r0,[sp,#6]
;;;1347   data[3]=*((char*)&in1);
001838  f89d0010          LDRB     r0,[sp,#0x10]
00183c  f88d0007          STRB     r0,[sp,#7]
;;;1348   lc640_write_long_ptr(lc640_adr+16,data);
001840  a901              ADD      r1,sp,#4
001842  f1040010          ADD      r0,r4,#0x10
001846  f7fffffe          BL       lc640_write_long_ptr
;;;1349   
;;;1350   data[0]=LPC_RTC->HOUR;
00184a  7a28              LDRB     r0,[r5,#8]
00184c  f88d0004          STRB     r0,[sp,#4]
;;;1351   data[1]=LPC_RTC->MIN;
001850  7928              LDRB     r0,[r5,#4]
001852  f88d0005          STRB     r0,[sp,#5]
;;;1352   data[2]=LPC_RTC->SEC;
001856  7828              LDRB     r0,[r5,#0]
001858  f88d0006          STRB     r0,[sp,#6]
;;;1353   data[3]=*(((char*)(&in1))+1);
00185c  f89d0011          LDRB     r0,[sp,#0x11]
001860  f88d0007          STRB     r0,[sp,#7]
;;;1354   lc640_write_long_ptr(lc640_adr+20,data);
001864  a901              ADD      r1,sp,#4
001866  f1040014          ADD      r0,r4,#0x14
00186a  f7fffffe          BL       lc640_write_long_ptr
;;;1355    
;;;1356   }
00186e  b005              ADD      sp,sp,#0x14
001870  bdf0              POP      {r4-r7,pc}
;;;1357   
                          ENDP

                  vz_mem_hndl PROC
;;;1414   //-----------------------------------------------
;;;1415   void vz_mem_hndl(unsigned short in)
001872  e92d4ff8          PUSH     {r3-r11,lr}
;;;1416   {
;;;1417   char data[4];
;;;1418   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001876  f04f0600          MOV      r6,#0
00187a  4634              MOV      r4,r6
;;;1419   //char avar_simbol;
;;;1420   
;;;1421   if(in==1)
;;;1422   	{
;;;1423   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1424   	event_ptr++;	
;;;1425   	if(event_ptr>63)event_ptr=0;	
;;;1426   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1427   	
;;;1428        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1429   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1430   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1431   	
;;;1432   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1433   	
;;;1434   	data[0]='B';
;;;1435   	data[1]=0; 
;;;1436   	data[2]='Z';
;;;1437   	data[3]=0;
;;;1438   	lc640_write_long_ptr(lc640_adr,data);
;;;1439   
;;;1440   	data[0]=0;
;;;1441   	data[1]=0;
;;;1442   	data[2]=0;
;;;1443   	data[3]=0;
;;;1444   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1445   
;;;1446   	data[0]=LPC_RTC->YEAR;
00187c  f8df8388          LDR      r8,|L1.7176|
001880  46a1              MOV      r9,r4                 ;1418
001882  f04f0742          MOV      r7,#0x42              ;1434
001886  f44f6a80          MOV      r10,#0x400            ;1432
00188a  2801              CMP      r0,#1                 ;1421
00188c  d002              BEQ      |L1.6292|
;;;1447   	data[1]=LPC_RTC->MONTH;
;;;1448   	data[2]=LPC_RTC->DOM;
;;;1449   	data[3]=0;
;;;1450   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1451   
;;;1452   	data[0]=LPC_RTC->HOUR;
;;;1453   	data[1]=LPC_RTC->MIN;
;;;1454   	data[2]=LPC_RTC->SEC;
;;;1455   	data[3]=0;
;;;1456   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1457   	
;;;1458   	data[0]='A';
;;;1459   	data[1]='A';
;;;1460   	data[2]='A';
;;;1461   	data[3]='A';
;;;1462   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1463   	
;;;1464   	data[0]='A';
;;;1465   	data[1]='A';
;;;1466   	data[2]='A';
;;;1467   	data[3]='A';
;;;1468   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1469   	
;;;1470   	data[0]='A';
;;;1471   	data[1]='A';
;;;1472   	data[2]='A';
;;;1473   	data[3]='A';
;;;1474   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1475   	
;;;1476   	data[0]='A';
;;;1477   	data[1]='A';
;;;1478   	data[2]='A';
;;;1479   	data[3]='A';
;;;1480   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1481    	
;;;1482   	}
;;;1483   
;;;1484   else if(in==0)
00188e  2800              CMP      r0,#0
001890  d07e              BEQ      |L1.6544|
001892  e108              B        |L1.6822|
                  |L1.6292|
001894  f44f6560          MOV      r5,#0xe00             ;1423
001898  4628              MOV      r0,r5                 ;1423
00189a  f7fffffe          BL       lc640_read_int
00189e  f1000001          ADD      r0,r0,#1              ;1424
0018a2  4604              MOV      r4,r0                 ;1424
0018a4  2c3f              CMP      r4,#0x3f              ;1425
0018a6  d901              BLS      |L1.6316|
0018a8  f04f0400          MOV      r4,#0                 ;1425
                  |L1.6316|
0018ac  b221              SXTH     r1,r4                 ;1426
0018ae  4628              MOV      r0,r5                 ;1426
0018b0  f7fffffe          BL       lc640_write_int
0018b4  f6406602          MOV      r6,#0xe02             ;1428
0018b8  4630              MOV      r0,r6                 ;1428
0018ba  f7fffffe          BL       lc640_read_int
0018be  283f              CMP      r0,#0x3f              ;1429
0018c0  d000              BEQ      |L1.6340|
0018c2  4620              MOV      r0,r4                 ;1429
                  |L1.6340|
0018c4  b201              SXTH     r1,r0                 ;1430
0018c6  4630              MOV      r0,r6                 ;1430
0018c8  f7fffffe          BL       lc640_write_int
0018cc  4628              MOV      r0,r5                 ;1432
0018ce  f7fffffe          BL       lc640_read_int
0018d2  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1432
0018d6  f88d7000          STRB     r7,[sp,#0]            ;1434
0018da  f88d9001          STRB     r9,[sp,#1]            ;1435
0018de  f04f005a          MOV      r0,#0x5a              ;1436
0018e2  f88d0002          STRB     r0,[sp,#2]            ;1436
0018e6  f88d9003          STRB     r9,[sp,#3]            ;1437
0018ea  4669              MOV      r1,sp                 ;1438
0018ec  4620              MOV      r0,r4                 ;1438
0018ee  f7fffffe          BL       lc640_write_long_ptr
0018f2  f8cd9000          STR      r9,[sp,#0]            ;1443
0018f6  4669              MOV      r1,sp                 ;1444
0018f8  1d20              ADDS     r0,r4,#4              ;1444
0018fa  f7fffffe          BL       lc640_write_long_ptr
0018fe  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1446
001902  f88d0000          STRB     r0,[sp,#0]            ;1446
001906  f8980038          LDRB     r0,[r8,#0x38]         ;1447
00190a  f88d0001          STRB     r0,[sp,#1]            ;1447
00190e  f898002c          LDRB     r0,[r8,#0x2c]         ;1448
001912  f88d0002          STRB     r0,[sp,#2]            ;1448
001916  f88d9003          STRB     r9,[sp,#3]            ;1449
00191a  4669              MOV      r1,sp                 ;1450
00191c  f1040008          ADD      r0,r4,#8              ;1450
001920  f7fffffe          BL       lc640_write_long_ptr
001924  f8980028          LDRB     r0,[r8,#0x28]         ;1452
001928  f88d0000          STRB     r0,[sp,#0]            ;1452
00192c  f8980024          LDRB     r0,[r8,#0x24]         ;1453
001930  f88d0001          STRB     r0,[sp,#1]            ;1453
001934  f8980020          LDRB     r0,[r8,#0x20]         ;1454
001938  f88d0002          STRB     r0,[sp,#2]            ;1454
00193c  f88d9003          STRB     r9,[sp,#3]            ;1455
001940  4669              MOV      r1,sp                 ;1456
001942  f104000c          ADD      r0,r4,#0xc            ;1456
001946  f7fffffe          BL       lc640_write_long_ptr
00194a  f04f0541          MOV      r5,#0x41              ;1458
00194e  f88d5000          STRB     r5,[sp,#0]            ;1458
001952  f88d5001          STRB     r5,[sp,#1]            ;1459
001956  f88d5002          STRB     r5,[sp,#2]            ;1460
00195a  f88d5003          STRB     r5,[sp,#3]            ;1461
00195e  4669              MOV      r1,sp                 ;1462
001960  f1040010          ADD      r0,r4,#0x10           ;1462
001964  f7fffffe          BL       lc640_write_long_ptr
001968  f88d5000          STRB     r5,[sp,#0]            ;1464
00196c  f88d5001          STRB     r5,[sp,#1]            ;1465
001970  f88d5002          STRB     r5,[sp,#2]            ;1466
001974  f88d5003          STRB     r5,[sp,#3]            ;1467
001978  4669              MOV      r1,sp                 ;1468
00197a  f1040014          ADD      r0,r4,#0x14           ;1468
00197e  f7fffffe          BL       lc640_write_long_ptr
001982  f88d5000          STRB     r5,[sp,#0]            ;1470
001986  f88d5001          STRB     r5,[sp,#1]            ;1471
00198a  f88d5002          STRB     r5,[sp,#2]            ;1472
00198e  e000              B        |L1.6546|
                  |L1.6544|
001990  e014              B        |L1.6588|
                  |L1.6546|
001992  f88d5003          STRB     r5,[sp,#3]            ;1473
001996  4669              MOV      r1,sp                 ;1474
001998  f1040018          ADD      r0,r4,#0x18           ;1474
00199c  f7fffffe          BL       lc640_write_long_ptr
0019a0  f88d5000          STRB     r5,[sp,#0]            ;1476
0019a4  f88d5001          STRB     r5,[sp,#1]            ;1477
0019a8  f88d5002          STRB     r5,[sp,#2]            ;1478
0019ac  f88d5003          STRB     r5,[sp,#3]            ;1479
0019b0  4669              MOV      r1,sp                 ;1480
0019b2  f104001c          ADD      r0,r4,#0x1c           ;1480
0019b6  f7fffffe          BL       lc640_write_long_ptr
0019ba  e074              B        |L1.6822|
                  |L1.6588|
;;;1485   	{      
;;;1486        
;;;1487   vz_mem_hndl_lbl1: 
;;;1488   
;;;1489   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0019bc  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1490   
;;;1491        lc640_read_long_ptr(lc640_adr,data);
0019c0  4669              MOV      r1,sp
0019c2  4628              MOV      r0,r5
0019c4  f7fffffe          BL       lc640_read_long_ptr
;;;1492        
;;;1493        if(!((data[0]=='B')&&(data[2]=='Z')))
0019c8  f89d0000          LDRB     r0,[sp,#0]
0019cc  2842              CMP      r0,#0x42
0019ce  d103              BNE      |L1.6616|
0019d0  f89d0002          LDRB     r0,[sp,#2]
0019d4  285a              CMP      r0,#0x5a
0019d6  d008              BEQ      |L1.6634|
                  |L1.6616|
;;;1494        	{        
;;;1495        	if(event_ptr_find)event_ptr_find--;
0019d8  b114              CBZ      r4,|L1.6624|
0019da  f1a40401          SUB      r4,r4,#1
0019de  e001              B        |L1.6628|
                  |L1.6624|
;;;1496        	else event_ptr_find=63;
0019e0  f04f043f          MOV      r4,#0x3f
                  |L1.6628|
;;;1497        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
0019e4  42b4              CMP      r4,r6
0019e6  d1e9              BNE      |L1.6588|
0019e8  e05d              B        |L1.6822|
                  |L1.6634|
;;;1498        	else goto vz_mem_hndl_lbl1;
;;;1499        	}
;;;1500        else 
;;;1501        	{
;;;1502        	lc640_read_long_ptr(lc640_adr+16,data);
0019ea  4669              MOV      r1,sp
0019ec  f1050010          ADD      r0,r5,#0x10
0019f0  f7fffffe          BL       lc640_read_long_ptr
;;;1503        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0019f4  f89d0000          LDRB     r0,[sp,#0]
0019f8  2841              CMP      r0,#0x41
0019fa  d10b              BNE      |L1.6676|
0019fc  f89d0001          LDRB     r0,[sp,#1]
001a00  2841              CMP      r0,#0x41
001a02  d107              BNE      |L1.6676|
001a04  f89d0002          LDRB     r0,[sp,#2]
001a08  2841              CMP      r0,#0x41
001a0a  d103              BNE      |L1.6676|
001a0c  f89d0003          LDRB     r0,[sp,#3]
001a10  2841              CMP      r0,#0x41
001a12  d008              BEQ      |L1.6694|
                  |L1.6676|
;;;1504        		{        
;;;1505        		if(event_ptr_find)event_ptr_find--;
001a14  b114              CBZ      r4,|L1.6684|
001a16  f1a40401          SUB      r4,r4,#1
001a1a  e001              B        |L1.6688|
                  |L1.6684|
;;;1506            		else event_ptr_find=63;
001a1c  f04f043f          MOV      r4,#0x3f
                  |L1.6688|
;;;1507            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001a20  42b4              CMP      r4,r6
001a22  d1cb              BNE      |L1.6588|
001a24  e03f              B        |L1.6822|
                  |L1.6694|
;;;1508        		else goto vz_mem_hndl_lbl1;
;;;1509        		}
;;;1510   
;;;1511        	}	
;;;1512   
;;;1513   
;;;1514   	
;;;1515   	data[0]=LPC_RTC->YEAR;
001a26  f8b8003c          LDRH     r0,[r8,#0x3c]
001a2a  f88d0000          STRB     r0,[sp,#0]
;;;1516   	data[1]=LPC_RTC->MONTH;
001a2e  f8980038          LDRB     r0,[r8,#0x38]
001a32  f88d0001          STRB     r0,[sp,#1]
;;;1517   	data[2]=LPC_RTC->DOM;
001a36  f898002c          LDRB     r0,[r8,#0x2c]
001a3a  f88d0002          STRB     r0,[sp,#2]
;;;1518   	data[3]=0;
001a3e  f88d9003          STRB     r9,[sp,#3]
;;;1519   	lc640_write_long_ptr(lc640_adr+16,data);
001a42  4669              MOV      r1,sp
001a44  f1050010          ADD      r0,r5,#0x10
001a48  f7fffffe          BL       lc640_write_long_ptr
;;;1520   
;;;1521   	data[0]=LPC_RTC->HOUR;
001a4c  f8980028          LDRB     r0,[r8,#0x28]
001a50  f88d0000          STRB     r0,[sp,#0]
;;;1522   	data[1]=LPC_RTC->MIN;
001a54  f8980024          LDRB     r0,[r8,#0x24]
001a58  f88d0001          STRB     r0,[sp,#1]
;;;1523   	data[2]=LPC_RTC->SEC;
001a5c  f8980020          LDRB     r0,[r8,#0x20]
001a60  f88d0002          STRB     r0,[sp,#2]
;;;1524   	data[3]=0;
001a64  f88d9003          STRB     r9,[sp,#3]
;;;1525   	lc640_write_long_ptr(lc640_adr+20,data);
001a68  4669              MOV      r1,sp
001a6a  f1050014          ADD      r0,r5,#0x14
001a6e  f7fffffe          BL       lc640_write_long_ptr
;;;1526   	
;;;1527   	data[0]='B';
001a72  f88d7000          STRB     r7,[sp,#0]
;;;1528   	data[1]='B';
001a76  f88d7001          STRB     r7,[sp,#1]
;;;1529   	data[2]='B';
001a7a  f88d7002          STRB     r7,[sp,#2]
;;;1530   	data[3]='B';
001a7e  f88d7003          STRB     r7,[sp,#3]
;;;1531   	lc640_write_long_ptr(lc640_adr+24,data);
001a82  4669              MOV      r1,sp
001a84  f1050018          ADD      r0,r5,#0x18
001a88  f7fffffe          BL       lc640_write_long_ptr
;;;1532   	
;;;1533   	data[0]='B';
001a8c  f88d7000          STRB     r7,[sp,#0]
;;;1534   	data[1]='B';
001a90  f88d7001          STRB     r7,[sp,#1]
;;;1535   	data[2]='B';
001a94  f88d7002          STRB     r7,[sp,#2]
;;;1536   	data[3]='B';
001a98  f88d7003          STRB     r7,[sp,#3]
;;;1537   	lc640_write_long_ptr(lc640_adr+28,data);
001a9c  4669              MOV      r1,sp
001a9e  f105001c          ADD      r0,r5,#0x1c
001aa2  f7fffffe          BL       lc640_write_long_ptr
                  |L1.6822|
;;;1538   	
;;;1539   	}
;;;1540   
;;;1541   vz_mem_hndl_end:
;;;1542   __nop(); 
001aa6  bf00              NOP      
                  |L1.6824|
;;;1543   
;;;1544   }
001aa8  e4cb              B        |L1.5186|
;;;1545   
                          ENDP

                  speedz_mem_hndl PROC
;;;1546   //-----------------------------------------------
;;;1547   void speedz_mem_hndl(unsigned short in)	 //    (1-, 5- , 0- , 10- )
001aaa  e92d4ff8          PUSH     {r3-r11,lr}
;;;1548   {
001aae  4605              MOV      r5,r0
;;;1549   char data[4];
;;;1550   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001ab0  f04f0600          MOV      r6,#0
001ab4  4634              MOV      r4,r6
;;;1551   //char avar_simbol;
;;;1552   
;;;1553   if((in==1)||(in==5)) //  
;;;1554   	{
;;;1555   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1556   	event_ptr++;	
;;;1557   	if(event_ptr>63)event_ptr=0;	
;;;1558   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1559   	
;;;1560       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1561   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1562   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1563   	
;;;1564   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1565   	
;;;1566   	data[0]='s';
;;;1567   	data[1]=0;
;;;1568   	if(in==5)data[1]='a'; 
;;;1569   	data[2]='Z';
;;;1570   	data[3]=0;
;;;1571   	lc640_write_long_ptr(lc640_adr,data);
;;;1572   
;;;1573   	data[0]=0;
;;;1574   	data[1]=0;
;;;1575   	data[2]=0;
;;;1576   	data[3]=0;
;;;1577   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1578   
;;;1579   	data[0]=LPC_RTC->YEAR;
001ab6  f8df8150          LDR      r8,|L1.7176|
001aba  46a1              MOV      r9,r4                 ;1550
001abc  f44f6a80          MOV      r10,#0x400            ;1564
001ac0  2d01              CMP      r5,#1                 ;1553
001ac2  d012              BEQ      |L1.6890|
001ac4  2d05              CMP      r5,#5                 ;1553
001ac6  d010              BEQ      |L1.6890|
;;;1580   	data[1]=LPC_RTC->MONTH;
;;;1581   	data[2]=LPC_RTC->DOM;
;;;1582   	data[3]=0;
;;;1583   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1584   
;;;1585   	data[0]=LPC_RTC->HOUR;
;;;1586   	data[1]=LPC_RTC->MIN;
;;;1587   	data[2]=LPC_RTC->SEC;
;;;1588   	data[3]=0;
;;;1589   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1590   	
;;;1591   	data[0]='A';
;;;1592   	data[1]='A';
;;;1593   	data[2]='A';
;;;1594   	data[3]='A';
;;;1595   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1596   	
;;;1597   	data[0]='A';
;;;1598   	data[1]='A';
;;;1599   	data[2]='A';
;;;1600   	data[3]='A';
;;;1601   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1602   	
;;;1603   	data[0]='A';
;;;1604   	data[1]='A';
;;;1605   	data[2]='A';
;;;1606   	data[3]='A';
;;;1607   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1608   	
;;;1609   	data[0]='A';
;;;1610   	data[1]='A';
;;;1611   	data[2]='A';
;;;1612   	data[3]='A';
;;;1613   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1614    	
;;;1615   	}
;;;1616   
;;;1617   else if(in==0)	// 
001ac8  2d00              CMP      r5,#0
001aca  d07d              BEQ      |L1.7112|
;;;1618   	{      
;;;1619   	char i;     
;;;1620   	event_ptr_find=0;
;;;1621   	for (i=0;i<63;i++)
;;;1622   		{
;;;1623   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1624   
;;;1625        	lc640_read_long_ptr(lc640_adr,data);
;;;1626        
;;;1627        	if(!((data[0]=='s')&&(data[2]=='Z')))
;;;1628        		{        
;;;1629        		if(event_ptr_find)event_ptr_find--;
;;;1630        		else event_ptr_find=63;
;;;1631        		if(event_ptr_find==event_ptr)
;;;1632   				{
;;;1633   				lc640_adr=0;
;;;1634   				break;
;;;1635   				}
;;;1636        		else continue;
;;;1637        		}
;;;1638        	else 
;;;1639        		{
;;;1640        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1641        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1642        			{        
;;;1643        			if(event_ptr_find)event_ptr_find--;
;;;1644            		else event_ptr_find=63;
;;;1645            		if(event_ptr_find==event_ptr)
;;;1646   					{
;;;1647   					lc640_adr=0;
;;;1648   					break;
;;;1649   					}
;;;1650        			else continue;
;;;1651        			}
;;;1652        		}	
;;;1653   		}
;;;1654   	if(lc640_adr!=0)
;;;1655   		{
;;;1656   		data[0]=LPC_RTC->YEAR;
;;;1657   		data[1]=LPC_RTC->MONTH;
;;;1658   		data[2]=LPC_RTC->DOM;
;;;1659   		data[3]=0;
;;;1660   		lc640_write_long_ptr(lc640_adr+16,data);
;;;1661   	
;;;1662   		data[0]=LPC_RTC->HOUR;
;;;1663   		data[1]=LPC_RTC->MIN;
;;;1664   		data[2]=LPC_RTC->SEC;
;;;1665   		data[3]=0;
;;;1666   		lc640_write_long_ptr(lc640_adr+20,data);
;;;1667   		
;;;1668   		data[0]='C';
;;;1669   		data[1]='C';
;;;1670   		data[2]='C';
;;;1671   		data[3]='C';
;;;1672   		lc640_write_long_ptr(lc640_adr+24,data);
;;;1673   		
;;;1674   		data[0]='C';
;;;1675   		data[1]='C';
;;;1676   		data[2]='C';
;;;1677   		data[3]='C';
;;;1678   		lc640_write_long_ptr(lc640_adr+28,data);
;;;1679   		}
;;;1680   	}
;;;1681   else if(in==10) 	//  
001acc  2d0a              CMP      r5,#0xa
001ace  d17c              BNE      |L1.7114|
;;;1682   	{      
;;;1683   	char i;     
;;;1684   
;;;1685   	event_ptr_find=0;
;;;1686   	for (i=0;i<63;i++)
001ad0  f04f0700          MOV      r7,#0
                  |L1.6868|
;;;1687   		{
;;;1688   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
001ad4  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1689   
;;;1690        	lc640_read_long_ptr(lc640_adr,data);
001ad8  4669              MOV      r1,sp
001ada  4628              MOV      r0,r5
001adc  f7fffffe          BL       lc640_read_long_ptr
;;;1691        
;;;1692        	if(!((data[0]=='s')&&(data[2]=='Z')))
001ae0  f89d0000          LDRB     r0,[sp,#0]
001ae4  2873              CMP      r0,#0x73
001ae6  d171              BNE      |L1.7116|
001ae8  e12a              B        |L1.7488|
                  |L1.6890|
001aea  f44f6660          MOV      r6,#0xe00             ;1555
001aee  4630              MOV      r0,r6                 ;1555
001af0  f7fffffe          BL       lc640_read_int
001af4  f1000001          ADD      r0,r0,#1              ;1556
001af8  4604              MOV      r4,r0                 ;1556
001afa  2c3f              CMP      r4,#0x3f              ;1557
001afc  d901              BLS      |L1.6914|
001afe  f04f0400          MOV      r4,#0                 ;1557
                  |L1.6914|
001b02  b221              SXTH     r1,r4                 ;1558
001b04  4630              MOV      r0,r6                 ;1558
001b06  f7fffffe          BL       lc640_write_int
001b0a  f6406702          MOV      r7,#0xe02             ;1560
001b0e  4638              MOV      r0,r7                 ;1560
001b10  f7fffffe          BL       lc640_read_int
001b14  283f              CMP      r0,#0x3f              ;1561
001b16  d000              BEQ      |L1.6938|
001b18  4620              MOV      r0,r4                 ;1561
                  |L1.6938|
001b1a  b201              SXTH     r1,r0                 ;1562
001b1c  4638              MOV      r0,r7                 ;1562
001b1e  f7fffffe          BL       lc640_write_int
001b22  4630              MOV      r0,r6                 ;1564
001b24  f7fffffe          BL       lc640_read_int
001b28  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1564
001b2c  f04f0073          MOV      r0,#0x73              ;1566
001b30  f88d0000          STRB     r0,[sp,#0]            ;1566
001b34  f88d9001          STRB     r9,[sp,#1]            ;1567
001b38  2d05              CMP      r5,#5                 ;1568
001b3a  d103              BNE      |L1.6980|
001b3c  f04f0061          MOV      r0,#0x61              ;1568
001b40  f88d0001          STRB     r0,[sp,#1]            ;1568
                  |L1.6980|
001b44  f04f005a          MOV      r0,#0x5a              ;1569
001b48  f88d0002          STRB     r0,[sp,#2]            ;1569
001b4c  f88d9003          STRB     r9,[sp,#3]            ;1570
001b50  4669              MOV      r1,sp                 ;1571
001b52  4620              MOV      r0,r4                 ;1571
001b54  f7fffffe          BL       lc640_write_long_ptr
001b58  f8cd9000          STR      r9,[sp,#0]            ;1576
001b5c  4669              MOV      r1,sp                 ;1577
001b5e  1d20              ADDS     r0,r4,#4              ;1577
001b60  f7fffffe          BL       lc640_write_long_ptr
001b64  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1579
001b68  f88d0000          STRB     r0,[sp,#0]            ;1579
001b6c  f8980038          LDRB     r0,[r8,#0x38]         ;1580
001b70  f88d0001          STRB     r0,[sp,#1]            ;1580
001b74  f898002c          LDRB     r0,[r8,#0x2c]         ;1581
001b78  f88d0002          STRB     r0,[sp,#2]            ;1581
001b7c  f88d9003          STRB     r9,[sp,#3]            ;1582
001b80  4669              MOV      r1,sp                 ;1583
001b82  f1040008          ADD      r0,r4,#8              ;1583
001b86  f7fffffe          BL       lc640_write_long_ptr
001b8a  f8980028          LDRB     r0,[r8,#0x28]         ;1585
001b8e  f88d0000          STRB     r0,[sp,#0]            ;1585
001b92  f8980024          LDRB     r0,[r8,#0x24]         ;1586
001b96  f88d0001          STRB     r0,[sp,#1]            ;1586
001b9a  f8980020          LDRB     r0,[r8,#0x20]         ;1587
001b9e  f88d0002          STRB     r0,[sp,#2]            ;1587
001ba2  f88d9003          STRB     r9,[sp,#3]            ;1588
001ba6  4669              MOV      r1,sp                 ;1589
001ba8  f104000c          ADD      r0,r4,#0xc            ;1589
001bac  f7fffffe          BL       lc640_write_long_ptr
001bb0  f04f0541          MOV      r5,#0x41              ;1591
001bb4  f88d5000          STRB     r5,[sp,#0]            ;1591
001bb8  f88d5001          STRB     r5,[sp,#1]            ;1592
001bbc  f88d5002          STRB     r5,[sp,#2]            ;1593
001bc0  f88d5003          STRB     r5,[sp,#3]            ;1594
001bc4  4669              MOV      r1,sp                 ;1595
001bc6  e002              B        |L1.7118|
                  |L1.7112|
001bc8  e035              B        |L1.7222|
                  |L1.7114|
001bca  e033              B        |L1.7220|
                  |L1.7116|
001bcc  e0bc              B        |L1.7496|
                  |L1.7118|
001bce  f1040010          ADD      r0,r4,#0x10           ;1595
001bd2  f7fffffe          BL       lc640_write_long_ptr
001bd6  f88d5000          STRB     r5,[sp,#0]            ;1597
001bda  f88d5001          STRB     r5,[sp,#1]            ;1598
001bde  f88d5002          STRB     r5,[sp,#2]            ;1599
001be2  f88d5003          STRB     r5,[sp,#3]            ;1600
001be6  4669              MOV      r1,sp                 ;1601
001be8  f1040014          ADD      r0,r4,#0x14           ;1601
001bec  f7fffffe          BL       lc640_write_long_ptr
001bf0  f88d5000          STRB     r5,[sp,#0]            ;1603
001bf4  f88d5001          STRB     r5,[sp,#1]            ;1604
001bf8  f88d5002          STRB     r5,[sp,#2]            ;1605
001bfc  e006              B        |L1.7180|
001bfe  0000              DCW      0x0000
                  |L1.7168|
                          DCD      ke_date
                  |L1.7172|
                          DCD      0x40024020
                  |L1.7176|
                          DCD      0x40024000
                  |L1.7180|
001c0c  f88d5003          STRB     r5,[sp,#3]            ;1606
001c10  4669              MOV      r1,sp                 ;1607
001c12  f1040018          ADD      r0,r4,#0x18           ;1607
001c16  f7fffffe          BL       lc640_write_long_ptr
001c1a  f88d5000          STRB     r5,[sp,#0]            ;1609
001c1e  f88d5001          STRB     r5,[sp,#1]            ;1610
001c22  f88d5002          STRB     r5,[sp,#2]            ;1611
001c26  f88d5003          STRB     r5,[sp,#3]            ;1612
001c2a  4669              MOV      r1,sp                 ;1613
001c2c  f104001c          ADD      r0,r4,#0x1c           ;1613
001c30  f7fffffe          BL       lc640_write_long_ptr
                  |L1.7220|
;;;1693        		{        
;;;1694        		if(event_ptr_find)event_ptr_find--;
;;;1695        		else event_ptr_find=63;
;;;1696        		if(event_ptr_find==event_ptr)
;;;1697   				{
;;;1698   				lc640_adr=0;
;;;1699   				break;
;;;1700   				}
;;;1701        		else continue;
;;;1702        		}
;;;1703        	else 
;;;1704        		{
;;;1705        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1706        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1707        			{        
;;;1708        			if(event_ptr_find)event_ptr_find--;
;;;1709            		else event_ptr_find=63;
;;;1710            		if(event_ptr_find==event_ptr)
;;;1711   					{
;;;1712   					lc640_adr=0;
;;;1713   					break;
;;;1714   					}
;;;1715        			else continue;
;;;1716        			}
;;;1717        		}	
;;;1718   		}
;;;1719   	if(lc640_adr!=0)
;;;1720   		{
;;;1721   		data[0]=LPC_RTC->YEAR;
;;;1722   		data[1]=LPC_RTC->MONTH;
;;;1723   		data[2]=LPC_RTC->DOM;
;;;1724   		data[3]=0;
;;;1725   		lc640_write_long_ptr(lc640_adr+16,data);
;;;1726   	
;;;1727   		data[0]=LPC_RTC->HOUR;
;;;1728   		data[1]=LPC_RTC->MIN;
;;;1729   		data[2]=LPC_RTC->SEC;
;;;1730   		data[3]=0;
;;;1731   		lc640_write_long_ptr(lc640_adr+20,data);
;;;1732   		
;;;1733   		data[0]='B';
;;;1734   		data[1]='B';
;;;1735   		data[2]='B';
;;;1736   		data[3]='B';
;;;1737   		lc640_write_long_ptr(lc640_adr+24,data);
;;;1738   		
;;;1739   		data[0]='B';
;;;1740   		data[1]='B';
;;;1741   		data[2]='B';
;;;1742   		data[3]='B';
;;;1743   		lc640_write_long_ptr(lc640_adr+28,data);
;;;1744   		}
;;;1745   	}
;;;1746   }
001c34  e405              B        |L1.5186|
                  |L1.7222|
001c36  f04f0700          MOV      r7,#0                 ;1621
                  |L1.7226|
001c3a  eb0a1544          ADD      r5,r10,r4,LSL #5      ;1623
001c3e  4669              MOV      r1,sp                 ;1625
001c40  4628              MOV      r0,r5                 ;1625
001c42  f7fffffe          BL       lc640_read_long_ptr
001c46  f89d0000          LDRB     r0,[sp,#0]            ;1627
001c4a  2873              CMP      r0,#0x73              ;1627
001c4c  d103              BNE      |L1.7254|
001c4e  f89d0002          LDRB     r0,[sp,#2]            ;1627
001c52  285a              CMP      r0,#0x5a              ;1627
001c54  d00a              BEQ      |L1.7276|
                  |L1.7254|
001c56  b114              CBZ      r4,|L1.7262|
001c58  f1a40401          SUB      r4,r4,#1              ;1629
001c5c  e001              B        |L1.7266|
                  |L1.7262|
001c5e  f04f043f          MOV      r4,#0x3f              ;1630
                  |L1.7266|
001c62  42b4              CMP      r4,r6                 ;1631
001c64  d122              BNE      |L1.7340|
001c66  f04f0500          MOV      r5,#0                 ;1633
001c6a  e024              B        |L1.7350|
                  |L1.7276|
001c6c  4669              MOV      r1,sp                 ;1640
001c6e  f1050010          ADD      r0,r5,#0x10           ;1640
001c72  f7fffffe          BL       lc640_read_long_ptr
001c76  f89d0000          LDRB     r0,[sp,#0]            ;1641
001c7a  2841              CMP      r0,#0x41              ;1641
001c7c  d10b              BNE      |L1.7318|
001c7e  f89d0001          LDRB     r0,[sp,#1]            ;1641
001c82  2841              CMP      r0,#0x41              ;1641
001c84  d107              BNE      |L1.7318|
001c86  f89d0002          LDRB     r0,[sp,#2]            ;1641
001c8a  2841              CMP      r0,#0x41              ;1641
001c8c  d103              BNE      |L1.7318|
001c8e  f89d0003          LDRB     r0,[sp,#3]            ;1641
001c92  2841              CMP      r0,#0x41              ;1641
001c94  d00a              BEQ      |L1.7340|
                  |L1.7318|
001c96  b114              CBZ      r4,|L1.7326|
001c98  f1a40401          SUB      r4,r4,#1              ;1643
001c9c  e001              B        |L1.7330|
                  |L1.7326|
001c9e  f04f043f          MOV      r4,#0x3f              ;1644
                  |L1.7330|
001ca2  42b4              CMP      r4,r6                 ;1645
001ca4  d102              BNE      |L1.7340|
001ca6  f04f0500          MOV      r5,#0                 ;1647
001caa  e004              B        |L1.7350|
                  |L1.7340|
001cac  f1070701          ADD      r7,r7,#1              ;1621
001cb0  b2ff              UXTB     r7,r7                 ;1621
001cb2  2f3f              CMP      r7,#0x3f              ;1621
001cb4  d3c1              BCC      |L1.7226|
                  |L1.7350|
001cb6  2d00              CMP      r5,#0                 ;1654
001cb8  d0bc              BEQ      |L1.7220|
001cba  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1656
001cbe  f88d0000          STRB     r0,[sp,#0]            ;1656
001cc2  f8980038          LDRB     r0,[r8,#0x38]         ;1657
001cc6  f88d0001          STRB     r0,[sp,#1]            ;1657
001cca  f898002c          LDRB     r0,[r8,#0x2c]         ;1658
001cce  f88d0002          STRB     r0,[sp,#2]            ;1658
001cd2  f88d9003          STRB     r9,[sp,#3]            ;1659
001cd6  4669              MOV      r1,sp                 ;1660
001cd8  f1050010          ADD      r0,r5,#0x10           ;1660
001cdc  f7fffffe          BL       lc640_write_long_ptr
001ce0  f8980028          LDRB     r0,[r8,#0x28]         ;1662
001ce4  f88d0000          STRB     r0,[sp,#0]            ;1662
001ce8  f8980024          LDRB     r0,[r8,#0x24]         ;1663
001cec  f88d0001          STRB     r0,[sp,#1]            ;1663
001cf0  f8980020          LDRB     r0,[r8,#0x20]         ;1664
001cf4  f88d0002          STRB     r0,[sp,#2]            ;1664
001cf8  f88d9003          STRB     r9,[sp,#3]            ;1665
001cfc  4669              MOV      r1,sp                 ;1666
001cfe  f1050014          ADD      r0,r5,#0x14           ;1666
001d02  f7fffffe          BL       lc640_write_long_ptr
001d06  f04f0443          MOV      r4,#0x43              ;1668
001d0a  f88d4000          STRB     r4,[sp,#0]            ;1668
001d0e  f88d4001          STRB     r4,[sp,#1]            ;1669
001d12  f88d4002          STRB     r4,[sp,#2]            ;1670
001d16  f88d4003          STRB     r4,[sp,#3]            ;1671
001d1a  4669              MOV      r1,sp                 ;1672
001d1c  f1050018          ADD      r0,r5,#0x18           ;1672
001d20  f7fffffe          BL       lc640_write_long_ptr
001d24  f88d4000          STRB     r4,[sp,#0]            ;1674
001d28  f88d4001          STRB     r4,[sp,#1]            ;1675
001d2c  f88d4002          STRB     r4,[sp,#2]            ;1676
001d30  f88d4003          STRB     r4,[sp,#3]            ;1677
001d34  4669              MOV      r1,sp                 ;1678
001d36  f105001c          ADD      r0,r5,#0x1c           ;1678
001d3a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.7486|
001d3e  e4cb              B        |L1.5848|
                  |L1.7488|
001d40  f89d0002          LDRB     r0,[sp,#2]            ;1692
001d44  285a              CMP      r0,#0x5a              ;1692
001d46  d00a              BEQ      |L1.7518|
                  |L1.7496|
001d48  b114              CBZ      r4,|L1.7504|
001d4a  f1a40401          SUB      r4,r4,#1              ;1694
001d4e  e001              B        |L1.7508|
                  |L1.7504|
001d50  f04f043f          MOV      r4,#0x3f              ;1695
                  |L1.7508|
001d54  42b4              CMP      r4,r6                 ;1696
001d56  d122              BNE      |L1.7582|
001d58  f04f0500          MOV      r5,#0                 ;1698
001d5c  e025              B        |L1.7594|
                  |L1.7518|
001d5e  4669              MOV      r1,sp                 ;1705
001d60  f1050010          ADD      r0,r5,#0x10           ;1705
001d64  f7fffffe          BL       lc640_read_long_ptr
001d68  f89d0000          LDRB     r0,[sp,#0]            ;1706
001d6c  2841              CMP      r0,#0x41              ;1706
001d6e  d10b              BNE      |L1.7560|
001d70  f89d0001          LDRB     r0,[sp,#1]            ;1706
001d74  2841              CMP      r0,#0x41              ;1706
001d76  d107              BNE      |L1.7560|
001d78  f89d0002          LDRB     r0,[sp,#2]            ;1706
001d7c  2841              CMP      r0,#0x41              ;1706
001d7e  d103              BNE      |L1.7560|
001d80  f89d0003          LDRB     r0,[sp,#3]            ;1706
001d84  2841              CMP      r0,#0x41              ;1706
001d86  d00a              BEQ      |L1.7582|
                  |L1.7560|
001d88  b114              CBZ      r4,|L1.7568|
001d8a  f1a40401          SUB      r4,r4,#1              ;1708
001d8e  e001              B        |L1.7572|
                  |L1.7568|
001d90  f04f043f          MOV      r4,#0x3f              ;1709
                  |L1.7572|
001d94  42b4              CMP      r4,r6                 ;1710
001d96  d102              BNE      |L1.7582|
001d98  f04f0500          MOV      r5,#0                 ;1712
001d9c  e005              B        |L1.7594|
                  |L1.7582|
001d9e  f1070701          ADD      r7,r7,#1              ;1686
001da2  b2ff              UXTB     r7,r7                 ;1686
001da4  2f3f              CMP      r7,#0x3f              ;1686
001da6  f4ffae95          BCC      |L1.6868|
                  |L1.7594|
001daa  2d00              CMP      r5,#0                 ;1719
001dac  d0c7              BEQ      |L1.7486|
001dae  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1721
001db2  f88d0000          STRB     r0,[sp,#0]            ;1721
001db6  f8980038          LDRB     r0,[r8,#0x38]         ;1722
001dba  f88d0001          STRB     r0,[sp,#1]            ;1722
001dbe  f898002c          LDRB     r0,[r8,#0x2c]         ;1723
001dc2  f88d0002          STRB     r0,[sp,#2]            ;1723
001dc6  f88d9003          STRB     r9,[sp,#3]            ;1724
001dca  4669              MOV      r1,sp                 ;1725
001dcc  f1050010          ADD      r0,r5,#0x10           ;1725
001dd0  f7fffffe          BL       lc640_write_long_ptr
001dd4  f8980028          LDRB     r0,[r8,#0x28]         ;1727
001dd8  f88d0000          STRB     r0,[sp,#0]            ;1727
001ddc  f8980024          LDRB     r0,[r8,#0x24]         ;1728
001de0  f88d0001          STRB     r0,[sp,#1]            ;1728
001de4  f8980020          LDRB     r0,[r8,#0x20]         ;1729
001de8  f88d0002          STRB     r0,[sp,#2]            ;1729
001dec  f88d9003          STRB     r9,[sp,#3]            ;1730
001df0  4669              MOV      r1,sp                 ;1731
001df2  f1050014          ADD      r0,r5,#0x14           ;1731
001df6  f7fffffe          BL       lc640_write_long_ptr
001dfa  f04f0442          MOV      r4,#0x42              ;1733
001dfe  f88d4000          STRB     r4,[sp,#0]            ;1733
001e02  f88d4001          STRB     r4,[sp,#1]            ;1734
001e06  f88d4002          STRB     r4,[sp,#2]            ;1735
001e0a  f88d4003          STRB     r4,[sp,#3]            ;1736
001e0e  4669              MOV      r1,sp                 ;1737
001e10  f1050018          ADD      r0,r5,#0x18           ;1737
001e14  f7fffffe          BL       lc640_write_long_ptr
001e18  f88d4000          STRB     r4,[sp,#0]            ;1739
001e1c  f88d4001          STRB     r4,[sp,#1]            ;1740
001e20  f88d4002          STRB     r4,[sp,#2]            ;1741
001e24  f88d4003          STRB     r4,[sp,#3]            ;1742
001e28  4669              MOV      r1,sp                 ;1743
001e2a  f105001c          ADD      r0,r5,#0x1c           ;1743
001e2e  f7fffffe          BL       lc640_write_long_ptr
001e32  e451              B        |L1.5848|
;;;1747     
                          ENDP

                  uz_mem_hndl PROC
;;;1749   //-----------------------------------------------
;;;1750   void uz_mem_hndl(unsigned short in)	 //   
001e34  e92d4ff8          PUSH     {r3-r11,lr}
;;;1751   {
;;;1752   char data[4];
;;;1753   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001e38  f04f0600          MOV      r6,#0
001e3c  4634              MOV      r4,r6
;;;1754   //char avar_simbol;
;;;1755   
;;;1756   if(in==1) //  
;;;1757   	{
;;;1758   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1759   	event_ptr++;	
;;;1760   	if(event_ptr>63)event_ptr=0;	
;;;1761   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1762   	
;;;1763       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1764   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1765   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1766   	
;;;1767   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1768   	
;;;1769   	data[0]='u';
;;;1770   	data[1]=0; 
;;;1771   	data[2]='Z';
;;;1772   	data[3]=0;
;;;1773   	lc640_write_long_ptr(lc640_adr,data);
;;;1774   
;;;1775   	data[0]=0;
;;;1776   	data[1]=0;
;;;1777   	data[2]=0;
;;;1778   	data[3]=0;
;;;1779   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1780   
;;;1781   	data[0]=LPC_RTC->YEAR;
001e3e  f8df86c4          LDR      r8,|L1.9476|
001e42  46a1              MOV      r9,r4                 ;1753
001e44  f44f6a80          MOV      r10,#0x400            ;1767
001e48  2801              CMP      r0,#1                 ;1756
001e4a  d010              BEQ      |L1.7790|
;;;1782   	data[1]=LPC_RTC->MONTH;
;;;1783   	data[2]=LPC_RTC->DOM;
;;;1784   	data[3]=0;
;;;1785   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1786   
;;;1787   	data[0]=LPC_RTC->HOUR;
;;;1788   	data[1]=LPC_RTC->MIN;
;;;1789   	data[2]=LPC_RTC->SEC;
;;;1790   	data[3]=0;
;;;1791   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1792   	
;;;1793   	data[0]='A';
;;;1794   	data[1]='A';
;;;1795   	data[2]='A';
;;;1796   	data[3]='A';
;;;1797   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1798   	
;;;1799   	data[0]='A';
;;;1800   	data[1]='A';
;;;1801   	data[2]='A';
;;;1802   	data[3]='A';
;;;1803   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1804   	
;;;1805   	data[0]='A';
;;;1806   	data[1]='A';
;;;1807   	data[2]='A';
;;;1808   	data[3]='A';
;;;1809   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1810   	
;;;1811   	data[0]='A';
;;;1812   	data[1]='A';
;;;1813   	data[2]='A';
;;;1814   	data[3]='A';
;;;1815   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1816    	
;;;1817   	}
;;;1818   
;;;1819   else if(in==0)	// 
001e4c  2800              CMP      r0,#0
001e4e  d07d              BEQ      |L1.8012|
;;;1820   	{      
;;;1821   	char i;     
;;;1822   	event_ptr_find=0;
;;;1823   	for (i=0;i<63;i++)
;;;1824   		{
;;;1825   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1826   
;;;1827        	lc640_read_long_ptr(lc640_adr,data);
;;;1828        
;;;1829        	if(!((data[0]=='u')&&(data[2]=='Z')))
;;;1830        		{        
;;;1831        		if(event_ptr_find)event_ptr_find--;
;;;1832        		else event_ptr_find=63;
;;;1833        		if(event_ptr_find==event_ptr)
;;;1834   				{
;;;1835   				lc640_adr=0;
;;;1836   				break;
;;;1837   				}
;;;1838        		else continue;
;;;1839        		}
;;;1840        	else 
;;;1841        		{
;;;1842        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1843        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1844        			{        
;;;1845        			if(event_ptr_find)event_ptr_find--;
;;;1846            		else event_ptr_find=63;
;;;1847            		if(event_ptr_find==event_ptr)
;;;1848   					{
;;;1849   					lc640_adr=0;
;;;1850   					break;
;;;1851   					}
;;;1852        			else continue;
;;;1853        			}
;;;1854        		}	
;;;1855   		}
;;;1856   	if(lc640_adr!=0)
;;;1857   		{
;;;1858   		data[0]=LPC_RTC->YEAR;
;;;1859   		data[1]=LPC_RTC->MONTH;
;;;1860   		data[2]=LPC_RTC->DOM;
;;;1861   		data[3]=0;
;;;1862   		lc640_write_long_ptr(lc640_adr+16,data);
;;;1863   	
;;;1864   		data[0]=LPC_RTC->HOUR;
;;;1865   		data[1]=LPC_RTC->MIN;
;;;1866   		data[2]=LPC_RTC->SEC;
;;;1867   		data[3]=0;
;;;1868   		lc640_write_long_ptr(lc640_adr+20,data);
;;;1869   		
;;;1870   		data[0]='C';
;;;1871   		data[1]='C';
;;;1872   		data[2]='C';
;;;1873   		data[3]='C';
;;;1874   		lc640_write_long_ptr(lc640_adr+24,data);
;;;1875   		
;;;1876   		data[0]='C';
;;;1877   		data[1]='C';
;;;1878   		data[2]='C';
;;;1879   		data[3]='C';
;;;1880   		lc640_write_long_ptr(lc640_adr+28,data);
;;;1881   		}
;;;1882   	}
;;;1883   else if(in==10) 	//  
001e50  280a              CMP      r0,#0xa
001e52  d17c              BNE      |L1.8014|
;;;1884   	{      
;;;1885   	char i;     
;;;1886   
;;;1887   	event_ptr_find=0;
;;;1888   	for (i=0;i<63;i++)
001e54  f04f0700          MOV      r7,#0
                  |L1.7768|
;;;1889   		{
;;;1890   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
001e58  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1891   
;;;1892        	lc640_read_long_ptr(lc640_adr,data);
001e5c  4669              MOV      r1,sp
001e5e  4628              MOV      r0,r5
001e60  f7fffffe          BL       lc640_read_long_ptr
;;;1893        
;;;1894        	if(!((data[0]=='u')&&(data[2]=='Z')))
001e64  f89d0000          LDRB     r0,[sp,#0]
001e68  2875              CMP      r0,#0x75
001e6a  d171              BNE      |L1.8016|
001e6c  e11c              B        |L1.8360|
                  |L1.7790|
001e6e  f44f6560          MOV      r5,#0xe00             ;1758
001e72  4628              MOV      r0,r5                 ;1758
001e74  f7fffffe          BL       lc640_read_int
001e78  f1000001          ADD      r0,r0,#1              ;1759
001e7c  4604              MOV      r4,r0                 ;1759
001e7e  2c3f              CMP      r4,#0x3f              ;1760
001e80  d901              BLS      |L1.7814|
001e82  f04f0400          MOV      r4,#0                 ;1760
                  |L1.7814|
001e86  b221              SXTH     r1,r4                 ;1761
001e88  4628              MOV      r0,r5                 ;1761
001e8a  f7fffffe          BL       lc640_write_int
001e8e  f6406602          MOV      r6,#0xe02             ;1763
001e92  4630              MOV      r0,r6                 ;1763
001e94  f7fffffe          BL       lc640_read_int
001e98  283f              CMP      r0,#0x3f              ;1764
001e9a  d000              BEQ      |L1.7838|
001e9c  4620              MOV      r0,r4                 ;1764
                  |L1.7838|
001e9e  b201              SXTH     r1,r0                 ;1765
001ea0  4630              MOV      r0,r6                 ;1765
001ea2  f7fffffe          BL       lc640_write_int
001ea6  4628              MOV      r0,r5                 ;1767
001ea8  f7fffffe          BL       lc640_read_int
001eac  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1767
001eb0  f04f0075          MOV      r0,#0x75              ;1769
001eb4  f88d0000          STRB     r0,[sp,#0]            ;1769
001eb8  f88d9001          STRB     r9,[sp,#1]            ;1770
001ebc  f04f005a          MOV      r0,#0x5a              ;1771
001ec0  f88d0002          STRB     r0,[sp,#2]            ;1771
001ec4  f88d9003          STRB     r9,[sp,#3]            ;1772
001ec8  4669              MOV      r1,sp                 ;1773
001eca  4620              MOV      r0,r4                 ;1773
001ecc  f7fffffe          BL       lc640_write_long_ptr
001ed0  f8cd9000          STR      r9,[sp,#0]            ;1778
001ed4  4669              MOV      r1,sp                 ;1779
001ed6  1d20              ADDS     r0,r4,#4              ;1779
001ed8  f7fffffe          BL       lc640_write_long_ptr
001edc  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1781
001ee0  f88d0000          STRB     r0,[sp,#0]            ;1781
001ee4  f8980038          LDRB     r0,[r8,#0x38]         ;1782
001ee8  f88d0001          STRB     r0,[sp,#1]            ;1782
001eec  f898002c          LDRB     r0,[r8,#0x2c]         ;1783
001ef0  f88d0002          STRB     r0,[sp,#2]            ;1783
001ef4  f88d9003          STRB     r9,[sp,#3]            ;1784
001ef8  4669              MOV      r1,sp                 ;1785
001efa  f1040008          ADD      r0,r4,#8              ;1785
001efe  f7fffffe          BL       lc640_write_long_ptr
001f02  f8980028          LDRB     r0,[r8,#0x28]         ;1787
001f06  f88d0000          STRB     r0,[sp,#0]            ;1787
001f0a  f8980024          LDRB     r0,[r8,#0x24]         ;1788
001f0e  f88d0001          STRB     r0,[sp,#1]            ;1788
001f12  f8980020          LDRB     r0,[r8,#0x20]         ;1789
001f16  f88d0002          STRB     r0,[sp,#2]            ;1789
001f1a  f88d9003          STRB     r9,[sp,#3]            ;1790
001f1e  4669              MOV      r1,sp                 ;1791
001f20  f104000c          ADD      r0,r4,#0xc            ;1791
001f24  f7fffffe          BL       lc640_write_long_ptr
001f28  f04f0541          MOV      r5,#0x41              ;1793
001f2c  f88d5000          STRB     r5,[sp,#0]            ;1793
001f30  f88d5001          STRB     r5,[sp,#1]            ;1794
001f34  f88d5002          STRB     r5,[sp,#2]            ;1795
001f38  f88d5003          STRB     r5,[sp,#3]            ;1796
001f3c  4669              MOV      r1,sp                 ;1797
001f3e  f1040010          ADD      r0,r4,#0x10           ;1797
001f42  f7fffffe          BL       lc640_write_long_ptr
001f46  f88d5000          STRB     r5,[sp,#0]            ;1799
001f4a  e002              B        |L1.8018|
                  |L1.8012|
001f4c  e027              B        |L1.8094|
                  |L1.8014|
001f4e  e025              B        |L1.8092|
                  |L1.8016|
001f50  e0ae              B        |L1.8368|
                  |L1.8018|
001f52  f88d5001          STRB     r5,[sp,#1]            ;1800
001f56  f88d5002          STRB     r5,[sp,#2]            ;1801
001f5a  f88d5003          STRB     r5,[sp,#3]            ;1802
001f5e  4669              MOV      r1,sp                 ;1803
001f60  f1040014          ADD      r0,r4,#0x14           ;1803
001f64  f7fffffe          BL       lc640_write_long_ptr
001f68  f88d5000          STRB     r5,[sp,#0]            ;1805
001f6c  f88d5001          STRB     r5,[sp,#1]            ;1806
001f70  f88d5002          STRB     r5,[sp,#2]            ;1807
001f74  f88d5003          STRB     r5,[sp,#3]            ;1808
001f78  4669              MOV      r1,sp                 ;1809
001f7a  f1040018          ADD      r0,r4,#0x18           ;1809
001f7e  f7fffffe          BL       lc640_write_long_ptr
001f82  f88d5000          STRB     r5,[sp,#0]            ;1811
001f86  f88d5001          STRB     r5,[sp,#1]            ;1812
001f8a  f88d5002          STRB     r5,[sp,#2]            ;1813
001f8e  f88d5003          STRB     r5,[sp,#3]            ;1814
001f92  4669              MOV      r1,sp                 ;1815
001f94  f104001c          ADD      r0,r4,#0x1c           ;1815
001f98  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8092|
;;;1895        		{        
;;;1896        		if(event_ptr_find)event_ptr_find--;
;;;1897        		else event_ptr_find=63;
;;;1898        		if(event_ptr_find==event_ptr)
;;;1899   				{
;;;1900   				lc640_adr=0;
;;;1901   				break;
;;;1902   				}
;;;1903        		else continue;
;;;1904        		}
;;;1905        	else 
;;;1906        		{
;;;1907        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1908        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1909        			{        
;;;1910        			if(event_ptr_find)event_ptr_find--;
;;;1911            		else event_ptr_find=63;
;;;1912            		if(event_ptr_find==event_ptr)
;;;1913   					{
;;;1914   					lc640_adr=0;
;;;1915   					break;
;;;1916   					}
;;;1917        			else continue;
;;;1918        			}
;;;1919        		}	
;;;1920   		}
;;;1921   	if(lc640_adr!=0)
;;;1922   		{
;;;1923   		data[0]=LPC_RTC->YEAR;
;;;1924   		data[1]=LPC_RTC->MONTH;
;;;1925   		data[2]=LPC_RTC->DOM;
;;;1926   		data[3]=0;
;;;1927   		lc640_write_long_ptr(lc640_adr+16,data);
;;;1928   	
;;;1929   		data[0]=LPC_RTC->HOUR;
;;;1930   		data[1]=LPC_RTC->MIN;
;;;1931   		data[2]=LPC_RTC->SEC;
;;;1932   		data[3]=0;
;;;1933   		lc640_write_long_ptr(lc640_adr+20,data);
;;;1934   		
;;;1935   		data[0]='B';
;;;1936   		data[1]='B';
;;;1937   		data[2]='B';
;;;1938   		data[3]='B';
;;;1939   		lc640_write_long_ptr(lc640_adr+24,data);
;;;1940   		
;;;1941   		data[0]='B';
;;;1942   		data[1]='B';
;;;1943   		data[2]='B';
;;;1944   		data[3]='B';
;;;1945   		lc640_write_long_ptr(lc640_adr+28,data);
;;;1946   		}
;;;1947   	}
;;;1948   }
001f9c  e584              B        |L1.6824|
                  |L1.8094|
001f9e  f04f0700          MOV      r7,#0                 ;1823
                  |L1.8098|
001fa2  eb0a1544          ADD      r5,r10,r4,LSL #5      ;1825
001fa6  4669              MOV      r1,sp                 ;1827
001fa8  4628              MOV      r0,r5                 ;1827
001faa  f7fffffe          BL       lc640_read_long_ptr
001fae  f89d0000          LDRB     r0,[sp,#0]            ;1829
001fb2  2875              CMP      r0,#0x75              ;1829
001fb4  d103              BNE      |L1.8126|
001fb6  f89d0002          LDRB     r0,[sp,#2]            ;1829
001fba  285a              CMP      r0,#0x5a              ;1829
001fbc  d00a              BEQ      |L1.8148|
                  |L1.8126|
001fbe  b114              CBZ      r4,|L1.8134|
001fc0  f1a40401          SUB      r4,r4,#1              ;1831
001fc4  e001              B        |L1.8138|
                  |L1.8134|
001fc6  f04f043f          MOV      r4,#0x3f              ;1832
                  |L1.8138|
001fca  42b4              CMP      r4,r6                 ;1833
001fcc  d122              BNE      |L1.8212|
001fce  f04f0500          MOV      r5,#0                 ;1835
001fd2  e024              B        |L1.8222|
                  |L1.8148|
001fd4  4669              MOV      r1,sp                 ;1842
001fd6  f1050010          ADD      r0,r5,#0x10           ;1842
001fda  f7fffffe          BL       lc640_read_long_ptr
001fde  f89d0000          LDRB     r0,[sp,#0]            ;1843
001fe2  2841              CMP      r0,#0x41              ;1843
001fe4  d10b              BNE      |L1.8190|
001fe6  f89d0001          LDRB     r0,[sp,#1]            ;1843
001fea  2841              CMP      r0,#0x41              ;1843
001fec  d107              BNE      |L1.8190|
001fee  f89d0002          LDRB     r0,[sp,#2]            ;1843
001ff2  2841              CMP      r0,#0x41              ;1843
001ff4  d103              BNE      |L1.8190|
001ff6  f89d0003          LDRB     r0,[sp,#3]            ;1843
001ffa  2841              CMP      r0,#0x41              ;1843
001ffc  d00a              BEQ      |L1.8212|
                  |L1.8190|
001ffe  b114              CBZ      r4,|L1.8198|
002000  f1a40401          SUB      r4,r4,#1              ;1845
002004  e001              B        |L1.8202|
                  |L1.8198|
002006  f04f043f          MOV      r4,#0x3f              ;1846
                  |L1.8202|
00200a  42b4              CMP      r4,r6                 ;1847
00200c  d102              BNE      |L1.8212|
00200e  f04f0500          MOV      r5,#0                 ;1849
002012  e004              B        |L1.8222|
                  |L1.8212|
002014  f1070701          ADD      r7,r7,#1              ;1823
002018  b2ff              UXTB     r7,r7                 ;1823
00201a  2f3f              CMP      r7,#0x3f              ;1823
00201c  d3c1              BCC      |L1.8098|
                  |L1.8222|
00201e  2d00              CMP      r5,#0                 ;1856
002020  d0bc              BEQ      |L1.8092|
002022  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1858
002026  f88d0000          STRB     r0,[sp,#0]            ;1858
00202a  f8980038          LDRB     r0,[r8,#0x38]         ;1859
00202e  f88d0001          STRB     r0,[sp,#1]            ;1859
002032  f898002c          LDRB     r0,[r8,#0x2c]         ;1860
002036  f88d0002          STRB     r0,[sp,#2]            ;1860
00203a  f88d9003          STRB     r9,[sp,#3]            ;1861
00203e  4669              MOV      r1,sp                 ;1862
002040  f1050010          ADD      r0,r5,#0x10           ;1862
002044  f7fffffe          BL       lc640_write_long_ptr
002048  f8980028          LDRB     r0,[r8,#0x28]         ;1864
00204c  f88d0000          STRB     r0,[sp,#0]            ;1864
002050  f8980024          LDRB     r0,[r8,#0x24]         ;1865
002054  f88d0001          STRB     r0,[sp,#1]            ;1865
002058  f8980020          LDRB     r0,[r8,#0x20]         ;1866
00205c  f88d0002          STRB     r0,[sp,#2]            ;1866
002060  f88d9003          STRB     r9,[sp,#3]            ;1867
002064  4669              MOV      r1,sp                 ;1868
002066  f1050014          ADD      r0,r5,#0x14           ;1868
00206a  f7fffffe          BL       lc640_write_long_ptr
00206e  f04f0443          MOV      r4,#0x43              ;1870
002072  f88d4000          STRB     r4,[sp,#0]            ;1870
002076  f88d4001          STRB     r4,[sp,#1]            ;1871
00207a  f88d4002          STRB     r4,[sp,#2]            ;1872
00207e  f88d4003          STRB     r4,[sp,#3]            ;1873
002082  4669              MOV      r1,sp                 ;1874
002084  f1050018          ADD      r0,r5,#0x18           ;1874
002088  f7fffffe          BL       lc640_write_long_ptr
00208c  f88d4000          STRB     r4,[sp,#0]            ;1876
002090  f88d4001          STRB     r4,[sp,#1]            ;1877
002094  f88d4002          STRB     r4,[sp,#2]            ;1878
002098  f88d4003          STRB     r4,[sp,#3]            ;1879
00209c  4669              MOV      r1,sp                 ;1880
00209e  f105001c          ADD      r0,r5,#0x1c           ;1880
0020a2  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8358|
0020a6  e4ff              B        |L1.6824|
                  |L1.8360|
0020a8  f89d0002          LDRB     r0,[sp,#2]            ;1894
0020ac  285a              CMP      r0,#0x5a              ;1894
0020ae  d00a              BEQ      |L1.8390|
                  |L1.8368|
0020b0  b114              CBZ      r4,|L1.8376|
0020b2  f1a40401          SUB      r4,r4,#1              ;1896
0020b6  e001              B        |L1.8380|
                  |L1.8376|
0020b8  f04f043f          MOV      r4,#0x3f              ;1897
                  |L1.8380|
0020bc  42b4              CMP      r4,r6                 ;1898
0020be  d122              BNE      |L1.8454|
0020c0  f04f0500          MOV      r5,#0                 ;1900
0020c4  e025              B        |L1.8466|
                  |L1.8390|
0020c6  4669              MOV      r1,sp                 ;1907
0020c8  f1050010          ADD      r0,r5,#0x10           ;1907
0020cc  f7fffffe          BL       lc640_read_long_ptr
0020d0  f89d0000          LDRB     r0,[sp,#0]            ;1908
0020d4  2841              CMP      r0,#0x41              ;1908
0020d6  d10b              BNE      |L1.8432|
0020d8  f89d0001          LDRB     r0,[sp,#1]            ;1908
0020dc  2841              CMP      r0,#0x41              ;1908
0020de  d107              BNE      |L1.8432|
0020e0  f89d0002          LDRB     r0,[sp,#2]            ;1908
0020e4  2841              CMP      r0,#0x41              ;1908
0020e6  d103              BNE      |L1.8432|
0020e8  f89d0003          LDRB     r0,[sp,#3]            ;1908
0020ec  2841              CMP      r0,#0x41              ;1908
0020ee  d00a              BEQ      |L1.8454|
                  |L1.8432|
0020f0  b114              CBZ      r4,|L1.8440|
0020f2  f1a40401          SUB      r4,r4,#1              ;1910
0020f6  e001              B        |L1.8444|
                  |L1.8440|
0020f8  f04f043f          MOV      r4,#0x3f              ;1911
                  |L1.8444|
0020fc  42b4              CMP      r4,r6                 ;1912
0020fe  d102              BNE      |L1.8454|
002100  f04f0500          MOV      r5,#0                 ;1914
002104  e005              B        |L1.8466|
                  |L1.8454|
002106  f1070701          ADD      r7,r7,#1              ;1888
00210a  b2ff              UXTB     r7,r7                 ;1888
00210c  2f3f              CMP      r7,#0x3f              ;1888
00210e  f4ffaea3          BCC      |L1.7768|
                  |L1.8466|
002112  2d00              CMP      r5,#0                 ;1921
002114  d0c7              BEQ      |L1.8358|
002116  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1923
00211a  f88d0000          STRB     r0,[sp,#0]            ;1923
00211e  f8980038          LDRB     r0,[r8,#0x38]         ;1924
002122  f88d0001          STRB     r0,[sp,#1]            ;1924
002126  f898002c          LDRB     r0,[r8,#0x2c]         ;1925
00212a  f88d0002          STRB     r0,[sp,#2]            ;1925
00212e  f88d9003          STRB     r9,[sp,#3]            ;1926
002132  4669              MOV      r1,sp                 ;1927
002134  f1050010          ADD      r0,r5,#0x10           ;1927
002138  f7fffffe          BL       lc640_write_long_ptr
00213c  f8980028          LDRB     r0,[r8,#0x28]         ;1929
002140  f88d0000          STRB     r0,[sp,#0]            ;1929
002144  f8980024          LDRB     r0,[r8,#0x24]         ;1930
002148  f88d0001          STRB     r0,[sp,#1]            ;1930
00214c  f8980020          LDRB     r0,[r8,#0x20]         ;1931
002150  f88d0002          STRB     r0,[sp,#2]            ;1931
002154  f88d9003          STRB     r9,[sp,#3]            ;1932
002158  4669              MOV      r1,sp                 ;1933
00215a  f1050014          ADD      r0,r5,#0x14           ;1933
00215e  f7fffffe          BL       lc640_write_long_ptr
002162  f04f0442          MOV      r4,#0x42              ;1935
002166  f88d4000          STRB     r4,[sp,#0]            ;1935
00216a  f88d4001          STRB     r4,[sp,#1]            ;1936
00216e  f88d4002          STRB     r4,[sp,#2]            ;1937
002172  f88d4003          STRB     r4,[sp,#3]            ;1938
002176  4669              MOV      r1,sp                 ;1939
002178  f1050018          ADD      r0,r5,#0x18           ;1939
00217c  f7fffffe          BL       lc640_write_long_ptr
002180  f88d4000          STRB     r4,[sp,#0]            ;1941
002184  f88d4001          STRB     r4,[sp,#1]            ;1942
002188  f88d4002          STRB     r4,[sp,#2]            ;1943
00218c  f88d4003          STRB     r4,[sp,#3]            ;1944
002190  4669              MOV      r1,sp                 ;1945
002192  f105001c          ADD      r0,r5,#0x1c           ;1945
002196  f7fffffe          BL       lc640_write_long_ptr
00219a  e485              B        |L1.6824|
;;;1949   
                          ENDP

                  fz_mem_hndl PROC
;;;1950   //-----------------------------------------------
;;;1951   void fz_mem_hndl(unsigned short in)	 //   
00219c  e92d4ff8          PUSH     {r3-r11,lr}
;;;1952   {
;;;1953   char data[4];
;;;1954   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
0021a0  f04f0600          MOV      r6,#0
0021a4  4634              MOV      r4,r6
;;;1955   //char avar_simbol;
;;;1956   
;;;1957   if(in==1) //  
;;;1958   	{
;;;1959   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1960   	event_ptr++;	
;;;1961   	if(event_ptr>63)event_ptr=0;	
;;;1962   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1963   	
;;;1964       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1965   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1966   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1967   	
;;;1968   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1969   	
;;;1970   	data[0]='f';
;;;1971   	data[1]=0; 
;;;1972   	data[2]='Z';
;;;1973   	data[3]=0;
;;;1974   	lc640_write_long_ptr(lc640_adr,data);
;;;1975   
;;;1976   	data[0]=0;
;;;1977   	data[1]=0;
;;;1978   	data[2]=0;
;;;1979   	data[3]=0;
;;;1980   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1981   
;;;1982   	data[0]=LPC_RTC->YEAR;
0021a6  f8df835c          LDR      r8,|L1.9476|
0021aa  46a1              MOV      r9,r4                 ;1954
0021ac  f44f6a80          MOV      r10,#0x400            ;1968
0021b0  2801              CMP      r0,#1                 ;1957
0021b2  d010              BEQ      |L1.8662|
;;;1983   	data[1]=LPC_RTC->MONTH;
;;;1984   	data[2]=LPC_RTC->DOM;
;;;1985   	data[3]=0;
;;;1986   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1987   
;;;1988   	data[0]=LPC_RTC->HOUR;
;;;1989   	data[1]=LPC_RTC->MIN;
;;;1990   	data[2]=LPC_RTC->SEC;
;;;1991   	data[3]=0;
;;;1992   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1993   	
;;;1994   	data[0]='A';
;;;1995   	data[1]='A';
;;;1996   	data[2]='A';
;;;1997   	data[3]='A';
;;;1998   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1999   	
;;;2000   	data[0]='A';
;;;2001   	data[1]='A';
;;;2002   	data[2]='A';
;;;2003   	data[3]='A';
;;;2004   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2005   	
;;;2006   	data[0]='A';
;;;2007   	data[1]='A';
;;;2008   	data[2]='A';
;;;2009   	data[3]='A';
;;;2010   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2011   	
;;;2012   	data[0]='A';
;;;2013   	data[1]='A';
;;;2014   	data[2]='A';
;;;2015   	data[3]='A';
;;;2016   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2017    	
;;;2018   	}
;;;2019   
;;;2020   else if(in==0)	// 
0021b4  2800              CMP      r0,#0
0021b6  d07d              BEQ      |L1.8884|
;;;2021   	{      
;;;2022   	char i;     
;;;2023   	event_ptr_find=0;
;;;2024   	for (i=0;i<63;i++)
;;;2025   		{
;;;2026   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2027   
;;;2028        	lc640_read_long_ptr(lc640_adr,data);
;;;2029        
;;;2030        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;2031        		{        
;;;2032        		if(event_ptr_find)event_ptr_find--;
;;;2033        		else event_ptr_find=63;
;;;2034        		if(event_ptr_find==event_ptr)
;;;2035   				{
;;;2036   				lc640_adr=0;
;;;2037   				break;
;;;2038   				}
;;;2039        		else continue;
;;;2040        		}
;;;2041        	else 
;;;2042        		{
;;;2043        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2044        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2045        			{        
;;;2046        			if(event_ptr_find)event_ptr_find--;
;;;2047            		else event_ptr_find=63;
;;;2048            		if(event_ptr_find==event_ptr)
;;;2049   					{
;;;2050   					lc640_adr=0;
;;;2051   					break;
;;;2052   					}
;;;2053        			else continue;
;;;2054        			}
;;;2055        		}	
;;;2056   		}
;;;2057   	if(lc640_adr!=0)
;;;2058   		{
;;;2059   		data[0]=LPC_RTC->YEAR;
;;;2060   		data[1]=LPC_RTC->MONTH;
;;;2061   		data[2]=LPC_RTC->DOM;
;;;2062   		data[3]=0;
;;;2063   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2064   	
;;;2065   		data[0]=LPC_RTC->HOUR;
;;;2066   		data[1]=LPC_RTC->MIN;
;;;2067   		data[2]=LPC_RTC->SEC;
;;;2068   		data[3]=0;
;;;2069   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2070   		
;;;2071   		data[0]='C';
;;;2072   		data[1]='C';
;;;2073   		data[2]='C';
;;;2074   		data[3]='C';
;;;2075   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2076   		
;;;2077   		data[0]='C';
;;;2078   		data[1]='C';
;;;2079   		data[2]='C';
;;;2080   		data[3]='C';
;;;2081   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2082   		}
;;;2083   	}
;;;2084   else if(in==10) 	//  
0021b8  280a              CMP      r0,#0xa
0021ba  d17c              BNE      |L1.8886|
;;;2085   	{      
;;;2086   	char i;     
;;;2087   
;;;2088   	event_ptr_find=0;
;;;2089   	for (i=0;i<63;i++)
0021bc  f04f0700          MOV      r7,#0
                  |L1.8640|
;;;2090   		{
;;;2091   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
0021c0  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2092   
;;;2093        	lc640_read_long_ptr(lc640_adr,data);
0021c4  4669              MOV      r1,sp
0021c6  4628              MOV      r0,r5
0021c8  f7fffffe          BL       lc640_read_long_ptr
;;;2094        
;;;2095        	if(!((data[0]=='f')&&(data[2]=='Z')))
0021cc  f89d0000          LDRB     r0,[sp,#0]
0021d0  2866              CMP      r0,#0x66
0021d2  d171              BNE      |L1.8888|
0021d4  e11c              B        |L1.9232|
                  |L1.8662|
0021d6  f44f6560          MOV      r5,#0xe00             ;1959
0021da  4628              MOV      r0,r5                 ;1959
0021dc  f7fffffe          BL       lc640_read_int
0021e0  f1000001          ADD      r0,r0,#1              ;1960
0021e4  4604              MOV      r4,r0                 ;1960
0021e6  2c3f              CMP      r4,#0x3f              ;1961
0021e8  d901              BLS      |L1.8686|
0021ea  f04f0400          MOV      r4,#0                 ;1961
                  |L1.8686|
0021ee  b221              SXTH     r1,r4                 ;1962
0021f0  4628              MOV      r0,r5                 ;1962
0021f2  f7fffffe          BL       lc640_write_int
0021f6  f6406602          MOV      r6,#0xe02             ;1964
0021fa  4630              MOV      r0,r6                 ;1964
0021fc  f7fffffe          BL       lc640_read_int
002200  283f              CMP      r0,#0x3f              ;1965
002202  d000              BEQ      |L1.8710|
002204  4620              MOV      r0,r4                 ;1965
                  |L1.8710|
002206  b201              SXTH     r1,r0                 ;1966
002208  4630              MOV      r0,r6                 ;1966
00220a  f7fffffe          BL       lc640_write_int
00220e  4628              MOV      r0,r5                 ;1968
002210  f7fffffe          BL       lc640_read_int
002214  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1968
002218  f04f0066          MOV      r0,#0x66              ;1970
00221c  f88d0000          STRB     r0,[sp,#0]            ;1970
002220  f88d9001          STRB     r9,[sp,#1]            ;1971
002224  f04f005a          MOV      r0,#0x5a              ;1972
002228  f88d0002          STRB     r0,[sp,#2]            ;1972
00222c  f88d9003          STRB     r9,[sp,#3]            ;1973
002230  4669              MOV      r1,sp                 ;1974
002232  4620              MOV      r0,r4                 ;1974
002234  f7fffffe          BL       lc640_write_long_ptr
002238  f8cd9000          STR      r9,[sp,#0]            ;1979
00223c  4669              MOV      r1,sp                 ;1980
00223e  1d20              ADDS     r0,r4,#4              ;1980
002240  f7fffffe          BL       lc640_write_long_ptr
002244  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1982
002248  f88d0000          STRB     r0,[sp,#0]            ;1982
00224c  f8980038          LDRB     r0,[r8,#0x38]         ;1983
002250  f88d0001          STRB     r0,[sp,#1]            ;1983
002254  f898002c          LDRB     r0,[r8,#0x2c]         ;1984
002258  f88d0002          STRB     r0,[sp,#2]            ;1984
00225c  f88d9003          STRB     r9,[sp,#3]            ;1985
002260  4669              MOV      r1,sp                 ;1986
002262  f1040008          ADD      r0,r4,#8              ;1986
002266  f7fffffe          BL       lc640_write_long_ptr
00226a  f8980028          LDRB     r0,[r8,#0x28]         ;1988
00226e  f88d0000          STRB     r0,[sp,#0]            ;1988
002272  f8980024          LDRB     r0,[r8,#0x24]         ;1989
002276  f88d0001          STRB     r0,[sp,#1]            ;1989
00227a  f8980020          LDRB     r0,[r8,#0x20]         ;1990
00227e  f88d0002          STRB     r0,[sp,#2]            ;1990
002282  f88d9003          STRB     r9,[sp,#3]            ;1991
002286  4669              MOV      r1,sp                 ;1992
002288  f104000c          ADD      r0,r4,#0xc            ;1992
00228c  f7fffffe          BL       lc640_write_long_ptr
002290  f04f0541          MOV      r5,#0x41              ;1994
002294  f88d5000          STRB     r5,[sp,#0]            ;1994
002298  f88d5001          STRB     r5,[sp,#1]            ;1995
00229c  f88d5002          STRB     r5,[sp,#2]            ;1996
0022a0  f88d5003          STRB     r5,[sp,#3]            ;1997
0022a4  4669              MOV      r1,sp                 ;1998
0022a6  f1040010          ADD      r0,r4,#0x10           ;1998
0022aa  f7fffffe          BL       lc640_write_long_ptr
0022ae  f88d5000          STRB     r5,[sp,#0]            ;2000
0022b2  e002              B        |L1.8890|
                  |L1.8884|
0022b4  e027              B        |L1.8966|
                  |L1.8886|
0022b6  e025              B        |L1.8964|
                  |L1.8888|
0022b8  e0ae              B        |L1.9240|
                  |L1.8890|
0022ba  f88d5001          STRB     r5,[sp,#1]            ;2001
0022be  f88d5002          STRB     r5,[sp,#2]            ;2002
0022c2  f88d5003          STRB     r5,[sp,#3]            ;2003
0022c6  4669              MOV      r1,sp                 ;2004
0022c8  f1040014          ADD      r0,r4,#0x14           ;2004
0022cc  f7fffffe          BL       lc640_write_long_ptr
0022d0  f88d5000          STRB     r5,[sp,#0]            ;2006
0022d4  f88d5001          STRB     r5,[sp,#1]            ;2007
0022d8  f88d5002          STRB     r5,[sp,#2]            ;2008
0022dc  f88d5003          STRB     r5,[sp,#3]            ;2009
0022e0  4669              MOV      r1,sp                 ;2010
0022e2  f1040018          ADD      r0,r4,#0x18           ;2010
0022e6  f7fffffe          BL       lc640_write_long_ptr
0022ea  f88d5000          STRB     r5,[sp,#0]            ;2012
0022ee  f88d5001          STRB     r5,[sp,#1]            ;2013
0022f2  f88d5002          STRB     r5,[sp,#2]            ;2014
0022f6  f88d5003          STRB     r5,[sp,#3]            ;2015
0022fa  4669              MOV      r1,sp                 ;2016
0022fc  f104001c          ADD      r0,r4,#0x1c           ;2016
002300  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8964|
;;;2096        		{        
;;;2097        		if(event_ptr_find)event_ptr_find--;
;;;2098        		else event_ptr_find=63;
;;;2099        		if(event_ptr_find==event_ptr)
;;;2100   				{
;;;2101   				lc640_adr=0;
;;;2102   				break;
;;;2103   				}
;;;2104        		else continue;
;;;2105        		}
;;;2106        	else 
;;;2107        		{
;;;2108        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2109        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2110        			{        
;;;2111        			if(event_ptr_find)event_ptr_find--;
;;;2112            		else event_ptr_find=63;
;;;2113            		if(event_ptr_find==event_ptr)
;;;2114   					{
;;;2115   					lc640_adr=0;
;;;2116   					break;
;;;2117   					}
;;;2118        			else continue;
;;;2119        			}
;;;2120        		}	
;;;2121   		}
;;;2122   	if(lc640_adr!=0)
;;;2123   		{
;;;2124   		data[0]=LPC_RTC->YEAR;
;;;2125   		data[1]=LPC_RTC->MONTH;
;;;2126   		data[2]=LPC_RTC->DOM;
;;;2127   		data[3]=0;
;;;2128   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2129   	
;;;2130   		data[0]=LPC_RTC->HOUR;
;;;2131   		data[1]=LPC_RTC->MIN;
;;;2132   		data[2]=LPC_RTC->SEC;
;;;2133   		data[3]=0;
;;;2134   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2135   		
;;;2136   		data[0]='B';
;;;2137   		data[1]='B';
;;;2138   		data[2]='B';
;;;2139   		data[3]='B';
;;;2140   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2141   		
;;;2142   		data[0]='B';
;;;2143   		data[1]='B';
;;;2144   		data[2]='B';
;;;2145   		data[3]='B';
;;;2146   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2147   		}
;;;2148   	}
;;;2149   }
002304  e496              B        |L1.7220|
                  |L1.8966|
002306  f04f0700          MOV      r7,#0                 ;2024
                  |L1.8970|
00230a  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2026
00230e  4669              MOV      r1,sp                 ;2028
002310  4628              MOV      r0,r5                 ;2028
002312  f7fffffe          BL       lc640_read_long_ptr
002316  f89d0000          LDRB     r0,[sp,#0]            ;2030
00231a  2866              CMP      r0,#0x66              ;2030
00231c  d103              BNE      |L1.8998|
00231e  f89d0002          LDRB     r0,[sp,#2]            ;2030
002322  285a              CMP      r0,#0x5a              ;2030
002324  d00a              BEQ      |L1.9020|
                  |L1.8998|
002326  b114              CBZ      r4,|L1.9006|
002328  f1a40401          SUB      r4,r4,#1              ;2032
00232c  e001              B        |L1.9010|
                  |L1.9006|
00232e  f04f043f          MOV      r4,#0x3f              ;2033
                  |L1.9010|
002332  42b4              CMP      r4,r6                 ;2034
002334  d122              BNE      |L1.9084|
002336  f04f0500          MOV      r5,#0                 ;2036
00233a  e024              B        |L1.9094|
                  |L1.9020|
00233c  4669              MOV      r1,sp                 ;2043
00233e  f1050010          ADD      r0,r5,#0x10           ;2043
002342  f7fffffe          BL       lc640_read_long_ptr
002346  f89d0000          LDRB     r0,[sp,#0]            ;2044
00234a  2841              CMP      r0,#0x41              ;2044
00234c  d10b              BNE      |L1.9062|
00234e  f89d0001          LDRB     r0,[sp,#1]            ;2044
002352  2841              CMP      r0,#0x41              ;2044
002354  d107              BNE      |L1.9062|
002356  f89d0002          LDRB     r0,[sp,#2]            ;2044
00235a  2841              CMP      r0,#0x41              ;2044
00235c  d103              BNE      |L1.9062|
00235e  f89d0003          LDRB     r0,[sp,#3]            ;2044
002362  2841              CMP      r0,#0x41              ;2044
002364  d00a              BEQ      |L1.9084|
                  |L1.9062|
002366  b114              CBZ      r4,|L1.9070|
002368  f1a40401          SUB      r4,r4,#1              ;2046
00236c  e001              B        |L1.9074|
                  |L1.9070|
00236e  f04f043f          MOV      r4,#0x3f              ;2047
                  |L1.9074|
002372  42b4              CMP      r4,r6                 ;2048
002374  d102              BNE      |L1.9084|
002376  f04f0500          MOV      r5,#0                 ;2050
00237a  e004              B        |L1.9094|
                  |L1.9084|
00237c  f1070701          ADD      r7,r7,#1              ;2024
002380  b2ff              UXTB     r7,r7                 ;2024
002382  2f3f              CMP      r7,#0x3f              ;2024
002384  d3c1              BCC      |L1.8970|
                  |L1.9094|
002386  2d00              CMP      r5,#0                 ;2057
002388  d0bc              BEQ      |L1.8964|
00238a  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2059
00238e  f88d0000          STRB     r0,[sp,#0]            ;2059
002392  f8980038          LDRB     r0,[r8,#0x38]         ;2060
002396  f88d0001          STRB     r0,[sp,#1]            ;2060
00239a  f898002c          LDRB     r0,[r8,#0x2c]         ;2061
00239e  f88d0002          STRB     r0,[sp,#2]            ;2061
0023a2  f88d9003          STRB     r9,[sp,#3]            ;2062
0023a6  4669              MOV      r1,sp                 ;2063
0023a8  f1050010          ADD      r0,r5,#0x10           ;2063
0023ac  f7fffffe          BL       lc640_write_long_ptr
0023b0  f8980028          LDRB     r0,[r8,#0x28]         ;2065
0023b4  f88d0000          STRB     r0,[sp,#0]            ;2065
0023b8  f8980024          LDRB     r0,[r8,#0x24]         ;2066
0023bc  f88d0001          STRB     r0,[sp,#1]            ;2066
0023c0  f8980020          LDRB     r0,[r8,#0x20]         ;2067
0023c4  f88d0002          STRB     r0,[sp,#2]            ;2067
0023c8  f88d9003          STRB     r9,[sp,#3]            ;2068
0023cc  4669              MOV      r1,sp                 ;2069
0023ce  f1050014          ADD      r0,r5,#0x14           ;2069
0023d2  f7fffffe          BL       lc640_write_long_ptr
0023d6  f04f0443          MOV      r4,#0x43              ;2071
0023da  f88d4000          STRB     r4,[sp,#0]            ;2071
0023de  f88d4001          STRB     r4,[sp,#1]            ;2072
0023e2  f88d4002          STRB     r4,[sp,#2]            ;2073
0023e6  f88d4003          STRB     r4,[sp,#3]            ;2074
0023ea  4669              MOV      r1,sp                 ;2075
0023ec  f1050018          ADD      r0,r5,#0x18           ;2075
0023f0  f7fffffe          BL       lc640_write_long_ptr
0023f4  f88d4000          STRB     r4,[sp,#0]            ;2077
0023f8  f88d4001          STRB     r4,[sp,#1]            ;2078
0023fc  f88d4002          STRB     r4,[sp,#2]            ;2079
002400  f88d4003          STRB     r4,[sp,#3]            ;2080
002404  4669              MOV      r1,sp                 ;2081
002406  f105001c          ADD      r0,r5,#0x1c           ;2081
00240a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9230|
00240e  e411              B        |L1.7220|
                  |L1.9232|
002410  f89d0002          LDRB     r0,[sp,#2]            ;2095
002414  285a              CMP      r0,#0x5a              ;2095
002416  d00a              BEQ      |L1.9262|
                  |L1.9240|
002418  b114              CBZ      r4,|L1.9248|
00241a  f1a40401          SUB      r4,r4,#1              ;2097
00241e  e001              B        |L1.9252|
                  |L1.9248|
002420  f04f043f          MOV      r4,#0x3f              ;2098
                  |L1.9252|
002424  42b4              CMP      r4,r6                 ;2099
002426  d122              BNE      |L1.9326|
002428  f04f0500          MOV      r5,#0                 ;2101
00242c  e025              B        |L1.9338|
                  |L1.9262|
00242e  4669              MOV      r1,sp                 ;2108
002430  f1050010          ADD      r0,r5,#0x10           ;2108
002434  f7fffffe          BL       lc640_read_long_ptr
002438  f89d0000          LDRB     r0,[sp,#0]            ;2109
00243c  2841              CMP      r0,#0x41              ;2109
00243e  d10b              BNE      |L1.9304|
002440  f89d0001          LDRB     r0,[sp,#1]            ;2109
002444  2841              CMP      r0,#0x41              ;2109
002446  d107              BNE      |L1.9304|
002448  f89d0002          LDRB     r0,[sp,#2]            ;2109
00244c  2841              CMP      r0,#0x41              ;2109
00244e  d103              BNE      |L1.9304|
002450  f89d0003          LDRB     r0,[sp,#3]            ;2109
002454  2841              CMP      r0,#0x41              ;2109
002456  d00a              BEQ      |L1.9326|
                  |L1.9304|
002458  b114              CBZ      r4,|L1.9312|
00245a  f1a40401          SUB      r4,r4,#1              ;2111
00245e  e001              B        |L1.9316|
                  |L1.9312|
002460  f04f043f          MOV      r4,#0x3f              ;2112
                  |L1.9316|
002464  42b4              CMP      r4,r6                 ;2113
002466  d102              BNE      |L1.9326|
002468  f04f0500          MOV      r5,#0                 ;2115
00246c  e005              B        |L1.9338|
                  |L1.9326|
00246e  f1070701          ADD      r7,r7,#1              ;2089
002472  b2ff              UXTB     r7,r7                 ;2089
002474  2f3f              CMP      r7,#0x3f              ;2089
002476  f4ffaea3          BCC      |L1.8640|
                  |L1.9338|
00247a  2d00              CMP      r5,#0                 ;2122
00247c  d0c7              BEQ      |L1.9230|
00247e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2124
002482  f88d0000          STRB     r0,[sp,#0]            ;2124
002486  f8980038          LDRB     r0,[r8,#0x38]         ;2125
00248a  f88d0001          STRB     r0,[sp,#1]            ;2125
00248e  f898002c          LDRB     r0,[r8,#0x2c]         ;2126
002492  f88d0002          STRB     r0,[sp,#2]            ;2126
002496  f88d9003          STRB     r9,[sp,#3]            ;2127
00249a  4669              MOV      r1,sp                 ;2128
00249c  f1050010          ADD      r0,r5,#0x10           ;2128
0024a0  f7fffffe          BL       lc640_write_long_ptr
0024a4  f8980028          LDRB     r0,[r8,#0x28]         ;2130
0024a8  f88d0000          STRB     r0,[sp,#0]            ;2130
0024ac  f8980024          LDRB     r0,[r8,#0x24]         ;2131
0024b0  f88d0001          STRB     r0,[sp,#1]            ;2131
0024b4  f8980020          LDRB     r0,[r8,#0x20]         ;2132
0024b8  f88d0002          STRB     r0,[sp,#2]            ;2132
0024bc  f88d9003          STRB     r9,[sp,#3]            ;2133
0024c0  4669              MOV      r1,sp                 ;2134
0024c2  f1050014          ADD      r0,r5,#0x14           ;2134
0024c6  f7fffffe          BL       lc640_write_long_ptr
0024ca  f04f0442          MOV      r4,#0x42              ;2136
0024ce  f88d4000          STRB     r4,[sp,#0]            ;2136
0024d2  f88d4001          STRB     r4,[sp,#1]            ;2137
0024d6  f88d4002          STRB     r4,[sp,#2]            ;2138
0024da  f88d4003          STRB     r4,[sp,#3]            ;2139
0024de  4669              MOV      r1,sp                 ;2140
0024e0  f1050018          ADD      r0,r5,#0x18           ;2140
0024e4  f7fffffe          BL       lc640_write_long_ptr
0024e8  f88d4000          STRB     r4,[sp,#0]            ;2142
0024ec  f88d4001          STRB     r4,[sp,#1]            ;2143
0024f0  f88d4002          STRB     r4,[sp,#2]            ;2144
0024f4  f88d4003          STRB     r4,[sp,#3]            ;2145
0024f8  4669              MOV      r1,sp                 ;2146
0024fa  f105001c          ADD      r0,r5,#0x1c           ;2146
0024fe  f7fffffe          BL       lc640_write_long_ptr
002502  e41c              B        |L1.7486|
                          ENDP

                  |L1.9476|
                          DCD      0x40024000

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  ke_mem_hndl PROC
;;;77     //-----------------------------------------------
;;;78     void avar_hndl(void)
000000  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;79     {
;;;80     //static unsigned avar_stat_old;
;;;81     char i;
;;;82     //unsigned avar_stat_new,avar_stat_offed;
;;;83     
;;;84     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  b083              SUB      sp,sp,#0xc
000004  4605              MOV      r5,r0
000006  eb050045          ADD      r0,r5,r5,LSL #1
00000a  4948              LDR      r1,|L2.300|
00000c  eb001005          ADD      r0,r0,r5,LSL #4
000010  eb010180          ADD      r1,r1,r0,LSL #2
;;;85     else	   			SET_REG(avar_stat,0,0,1);
000014  4846              LDR      r0,|L2.304|
000016  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
;;;86     
;;;87     for(i=0;i<2;i++)
00001a  f1000001          ADD      r0,r0,#1
;;;88     	{
;;;89     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
00001e  eb010040          ADD      r0,r1,r0,LSL #1
000022  f9b00020          LDRSH    r0,[r0,#0x20]
000026  9001              STR      r0,[sp,#4]
000028  f44f6660          MOV      r6,#0xe00
00002c  4630              MOV      r0,r6
00002e  f7fffffe          BL       lc640_read_int
000032  f1000001          ADD      r0,r0,#1
000036  4604              MOV      r4,r0
000038  2c3f              CMP      r4,#0x3f
00003a  d901              BLS      |L2.64|
00003c  f04f0400          MOV      r4,#0
                  |L2.64|
000040  b221              SXTH     r1,r4
000042  4630              MOV      r0,r6
000044  f7fffffe          BL       lc640_write_int
000048  f6406702          MOV      r7,#0xe02
00004c  4638              MOV      r0,r7
;;;90     	else	   			SET_REG(avar_stat,0,1+i,1);
00004e  f7fffffe          BL       lc640_read_int
000052  283f              CMP      r0,#0x3f
000054  d000              BEQ      |L2.88|
000056  4620              MOV      r0,r4
                  |L2.88|
000058  b201              SXTH     r1,r0
00005a  4638              MOV      r0,r7
00005c  f7fffffe          BL       lc640_write_int
000060  4630              MOV      r0,r6                 ;87
000062  f7fffffe          BL       lc640_read_int
000066  f44f6180          MOV      r1,#0x400             ;87
;;;91     	}
;;;92     
;;;93     for(i=0;i<12;i++)
00006a  eb011440          ADD      r4,r1,r0,LSL #5
;;;94     	{
;;;95     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00006e  f04f0042          MOV      r0,#0x42
000072  f88d0008          STRB     r0,[sp,#8]
000076  f88d5009          STRB     r5,[sp,#9]
00007a  f04f004b          MOV      r0,#0x4b
00007e  f88d000a          STRB     r0,[sp,#0xa]
000082  f04f0600          MOV      r6,#0
000086  f88d600b          STRB     r6,[sp,#0xb]
00008a  a902              ADD      r1,sp,#8
00008c  4620              MOV      r0,r4
00008e  f7fffffe          BL       lc640_write_long_ptr
000092  f89d0010          LDRB     r0,[sp,#0x10]
000096  f88d0008          STRB     r0,[sp,#8]
;;;96     	else	   		SET_REG(avar_stat,0,3+i,1);
00009a  f89d0011          LDRB     r0,[sp,#0x11]
00009e  f88d0009          STRB     r0,[sp,#9]
0000a2  f89d0004          LDRB     r0,[sp,#4]
0000a6  f88d000a          STRB     r0,[sp,#0xa]
0000aa  f89d0005          LDRB     r0,[sp,#5]            ;93
0000ae  f88d000b          STRB     r0,[sp,#0xb]          ;93
;;;97     	}
;;;98     
;;;99     for(i=0;i<6;i++)
0000b2  a902              ADD      r1,sp,#8
0000b4  1d20              ADDS     r0,r4,#4
;;;100    	{
;;;101    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
0000b6  f7fffffe          BL       lc640_write_long_ptr
0000ba  f24020a2          MOV      r0,#0x2a2
0000be  f7fffffe          BL       lc640_read_long
0000c2  4d1c              LDR      r5,|L2.308|
0000c4  6028              STR      r0,[r5,#0]  ; ke_date
0000c6  4629              MOV      r1,r5
0000c8  f1040008          ADD      r0,r4,#8
0000cc  f7fffffe          BL       lc640_write_long_ptr
0000d0  f24020a6          MOV      r0,#0x2a6
0000d4  f7fffffe          BL       lc640_read_long
;;;102    	else	   		SET_REG(avar_stat,0,15+i,1);
0000d8  6068              STR      r0,[r5,#4]  ; ke_date
0000da  1d29              ADDS     r1,r5,#4
0000dc  f104000c          ADD      r0,r4,#0xc
0000e0  f7fffffe          BL       lc640_write_long_ptr
0000e4  4d14              LDR      r5,|L2.312|
0000e6  8ba8              LDRH     r0,[r5,#0x1c]         ;99
0000e8  f88d0008          STRB     r0,[sp,#8]            ;99
0000ec  7e28              LDRB     r0,[r5,#0x18]         ;99
0000ee  f88d0009          STRB     r0,[sp,#9]            ;99
;;;103    	}
;;;104    
;;;105    /*for(i=0;i<4;i++)
;;;106    	{
;;;107    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;108    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;109    	}  */
;;;110    for(i=0;i<4;i++)
0000f2  7b28              LDRB     r0,[r5,#0xc]
;;;111    	{
;;;112    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000f4  f88d000a          STRB     r0,[sp,#0xa]
0000f8  f88d600b          STRB     r6,[sp,#0xb]
;;;113    	else	   		SET_REG(avar_stat,0,24+i,1);
0000fc  a902              ADD      r1,sp,#8
0000fe  f1040010          ADD      r0,r4,#0x10
000102  f7fffffe          BL       lc640_write_long_ptr
000106  7a28              LDRB     r0,[r5,#8]
000108  f88d0008          STRB     r0,[sp,#8]
00010c  7928              LDRB     r0,[r5,#4]            ;110
00010e  f88d0009          STRB     r0,[sp,#9]            ;110
000112  7828              LDRB     r0,[r5,#0]            ;110
000114  f88d000a          STRB     r0,[sp,#0xa]          ;110
;;;114    	}
;;;115    
;;;116    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;117    //else	   			SET_REG(avar_stat,0,28,1);
;;;118    
;;;119    
;;;120    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000118  f88d600b          STRB     r6,[sp,#0xb]
00011c  a902              ADD      r1,sp,#8
00011e  f1040014          ADD      r0,r4,#0x14
;;;121    
;;;122    avar_ind_stat|=avar_stat_new;
000122  f7fffffe          BL       lc640_write_long_ptr
000126  b005              ADD      sp,sp,#0x14
;;;123    
;;;124    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000128  bdf0              POP      {r4-r7,pc}
;;;125    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
;;;126    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
;;;127    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
;;;128    
;;;129    
;;;130    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
;;;131    
;;;132    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
;;;133    
;;;134    avar_ind_stat&=avar_stat_offed; 
;;;135    
;;;136    avar_stat_old=avar_stat;
;;;137    
;;;138    //oleg_start
;;;139    
;;;140    
;;;141    
;;;142    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
;;;143    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
;;;144    rki_avar1_ind_stat|=rki_avar1_stat_new;
;;;145    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
;;;146    rki_avar1_ind_stat&=rki_avar1_stat_offed;
;;;147    rki_avar1_stat_old=rki_avar1_stat;
;;;148    /*
;;;149    rki_avarI1_stat=status_di1;
;;;150    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;151    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;152    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;153    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;154    rki_avarI1_stat_old=rki_avarI1_stat;
;;;155    
;;;156    rki_avarI2_stat=status_di2;
;;;157    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;158    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;159    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;160    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;161    rki_avarI2_stat_old=rki_avarI2_stat;
;;;162    */
;;;163    //oleg_end
;;;164    }
;;;165    
                          ENDP

00012a  0000              DCW      0x0000
                  |L2.300|
                          DCD      bat
                  |L2.304|
                          DCD      bat_u_old_cnt
                  |L2.308|
                          DCD      ke_date
                  |L2.312|
                          DCD      0x40024020

                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  rki_avar1_stat
                          DCD      0x00000000
                  rki_avar1_ind_stat
                          DCD      0x00000000
                  rki_avar1_stat_old
                          DCD      0x00000000
                  rki_avar1_stat_new
                          DCD      0x00000000
                  rki_avar1_stat_offed
                          DCD      0x00000000
                  av_inv
                          DCD      0x00000000
00002c  0000              DCB      0x00,0x00
