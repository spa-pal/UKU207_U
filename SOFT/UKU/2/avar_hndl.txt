; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\avar_hndl.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DUKU_ZVU --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;77     //-----------------------------------------------
;;;78     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;79     {
;;;80     //static unsigned avar_stat_old;
;;;81     char i;
;;;82     //unsigned avar_stat_new,avar_stat_offed;
;;;83     
;;;84     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48ff              LDR      r0,|L1.1024|
000004  4bff              LDR      r3,|L1.1028|
000006  7801              LDRB     r1,[r0,#0]  ; net_av
000008  6818              LDR      r0,[r3,#0]
00000a  b119              CBZ      r1,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6018              STR      r0,[r3,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;85     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6018              STR      r0,[r3,#0]  ; avar_stat
                  |L1.26|
;;;86     
;;;87     for(i=0;i<2;i++)
00001a  f04f0000          MOV      r0,#0
;;;88     	{
;;;89     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
00001e  4dfa              LDR      r5,|L1.1032|
000020  f04f0401          MOV      r4,#1
                  |L1.36|
000024  eb000140          ADD      r1,r0,r0,LSL #1
000028  eb011100          ADD      r1,r1,r0,LSL #4
00002c  eb050181          ADD      r1,r5,r1,LSL #2
000030  f891103d          LDRB     r1,[r1,#0x3d]
000034  0789              LSLS     r1,r1,#30
000036  d00a              BEQ      |L1.78|
000038  f1000101          ADD      r1,r0,#1
00003c  fa04f201          LSL      r2,r4,r1
000040  6819              LDR      r1,[r3,#0]  ; avar_stat
000042  ea210102          BIC      r1,r1,r2
000046  ea410102          ORR      r1,r1,r2
00004a  6019              STR      r1,[r3,#0]  ; avar_stat
00004c  e007              B        |L1.94|
                  |L1.78|
;;;90     	else	   			SET_REG(avar_stat,0,1+i,1);
00004e  f1000201          ADD      r2,r0,#1
000052  fa04f102          LSL      r1,r4,r2
000056  681a              LDR      r2,[r3,#0]  ; avar_stat
000058  ea220201          BIC      r2,r2,r1
00005c  601a              STR      r2,[r3,#0]  ; avar_stat
                  |L1.94|
00005e  f1000001          ADD      r0,r0,#1              ;87
000062  b2c0              UXTB     r0,r0                 ;87
000064  2802              CMP      r0,#2                 ;87
000066  d3dd              BCC      |L1.36|
;;;91     	}
;;;92     
;;;93     for(i=0;i<12;i++)
000068  f04f0000          MOV      r0,#0
;;;94     	{
;;;95     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00006c  4de7              LDR      r5,|L1.1036|
                  |L1.110|
00006e  eb0001c0          ADD      r1,r0,r0,LSL #3
000072  eb011100          ADD      r1,r1,r0,LSL #4
000076  eb050181          ADD      r1,r5,r1,LSL #2
00007a  7849              LDRB     r1,[r1,#1]
00007c  f0110fef          TST      r1,#0xef
000080  d00a              BEQ      |L1.152|
000082  f1000203          ADD      r2,r0,#3
000086  fa04f102          LSL      r1,r4,r2
00008a  681a              LDR      r2,[r3,#0]  ; avar_stat
00008c  ea220201          BIC      r2,r2,r1
000090  ea420201          ORR      r2,r2,r1
000094  601a              STR      r2,[r3,#0]  ; avar_stat
000096  e007              B        |L1.168|
                  |L1.152|
;;;96     	else	   		SET_REG(avar_stat,0,3+i,1);
000098  f1000103          ADD      r1,r0,#3
00009c  fa04f201          LSL      r2,r4,r1
0000a0  6819              LDR      r1,[r3,#0]  ; avar_stat
0000a2  ea210102          BIC      r1,r1,r2
0000a6  6019              STR      r1,[r3,#0]  ; avar_stat
                  |L1.168|
0000a8  f1000001          ADD      r0,r0,#1              ;93
0000ac  b2c0              UXTB     r0,r0                 ;93
0000ae  280c              CMP      r0,#0xc               ;93
0000b0  d3dd              BCC      |L1.110|
;;;97     	}
;;;98     
;;;99     for(i=0;i<6;i++)
0000b2  f04f0000          MOV      r0,#0
;;;100    	{
;;;101    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
0000b6  4ad3              LDR      r2,|L1.1028|
0000b8  f1020228          ADD      r2,r2,#0x28
                  |L1.188|
0000bc  5c11              LDRB     r1,[r2,r0]
0000be  b151              CBZ      r1,|L1.214|
0000c0  f100050f          ADD      r5,r0,#0xf
0000c4  fa04f105          LSL      r1,r4,r5
0000c8  681d              LDR      r5,[r3,#0]  ; avar_stat
0000ca  ea250501          BIC      r5,r5,r1
0000ce  ea450501          ORR      r5,r5,r1
0000d2  601d              STR      r5,[r3,#0]  ; avar_stat
0000d4  e007              B        |L1.230|
                  |L1.214|
;;;102    	else	   		SET_REG(avar_stat,0,15+i,1);
0000d6  f100010f          ADD      r1,r0,#0xf
0000da  fa04f501          LSL      r5,r4,r1
0000de  6819              LDR      r1,[r3,#0]  ; avar_stat
0000e0  ea210105          BIC      r1,r1,r5
0000e4  6019              STR      r1,[r3,#0]  ; avar_stat
                  |L1.230|
0000e6  f1000001          ADD      r0,r0,#1              ;99
0000ea  b2c0              UXTB     r0,r0                 ;99
0000ec  2806              CMP      r0,#6                 ;99
0000ee  d3e5              BCC      |L1.188|
;;;103    	}
;;;104    
;;;105    /*for(i=0;i<4;i++)
;;;106    	{
;;;107    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;108    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;109    	}  */
;;;110    for(i=0;i<4;i++)
0000f0  f04f0000          MOV      r0,#0
;;;111    	{
;;;112    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000f4  4dc6              LDR      r5,|L1.1040|
                  |L1.246|
0000f6  5c29              LDRB     r1,[r5,r0]
0000f8  2901              CMP      r1,#1
0000fa  d036              BEQ      |L1.362|
;;;113    	else	   		SET_REG(avar_stat,0,24+i,1);
0000fc  f1000118          ADD      r1,r0,#0x18
000100  681a              LDR      r2,[r3,#0]  ; avar_stat
000102  fa04f101          LSL      r1,r4,r1
000106  ea220201          BIC      r2,r2,r1
00010a  601a              STR      r2,[r3,#0]  ; avar_stat
                  |L1.268|
00010c  f1000001          ADD      r0,r0,#1              ;110
000110  b2c0              UXTB     r0,r0                 ;110
000112  2804              CMP      r0,#4                 ;110
000114  d3ef              BCC      |L1.246|
;;;114    	}
;;;115    
;;;116    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;117    //else	   			SET_REG(avar_stat,0,28,1);
;;;118    
;;;119    
;;;120    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000116  689a              LDR      r2,[r3,#8]  ; avar_stat_old
000118  6818              LDR      r0,[r3,#0]  ; avar_stat
00011a  ea200102          BIC      r1,r0,r2
00011e  60d9              STR      r1,[r3,#0xc]  ; avar_stat_new
;;;121    
;;;122    avar_ind_stat|=avar_stat_new;
000120  685c              LDR      r4,[r3,#4]  ; avar_ind_stat
000122  ea440401          ORR      r4,r4,r1
000126  605c              STR      r4,[r3,#4]  ; avar_ind_stat
;;;123    
;;;124    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000128  49ba              LDR      r1,|L1.1044|
00012a  880d              LDRH     r5,[r1,#0]  ; SK_ZVUK_EN
00012c  b115              CBZ      r5,|L1.308|
00012e  f0247480          BIC      r4,r4,#0x1000000
000132  605c              STR      r4,[r3,#4]  ; avar_ind_stat
                  |L1.308|
;;;125    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
000134  884c              LDRH     r4,[r1,#2]  ; SK_ZVUK_EN
000136  b11c              CBZ      r4,|L1.320|
000138  685c              LDR      r4,[r3,#4]  ; avar_ind_stat
00013a  f0247400          BIC      r4,r4,#0x2000000
00013e  605c              STR      r4,[r3,#4]  ; avar_ind_stat
                  |L1.320|
;;;126    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
000140  888c              LDRH     r4,[r1,#4]  ; SK_ZVUK_EN
000142  b11c              CBZ      r4,|L1.332|
000144  685c              LDR      r4,[r3,#4]  ; avar_ind_stat
000146  f0246480          BIC      r4,r4,#0x4000000
00014a  605c              STR      r4,[r3,#4]  ; avar_ind_stat
                  |L1.332|
;;;127    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
00014c  88c9              LDRH     r1,[r1,#6]  ; SK_ZVUK_EN
00014e  b119              CBZ      r1,|L1.344|
000150  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
000152  f0216100          BIC      r1,r1,#0x8000000
000156  6059              STR      r1,[r3,#4]  ; avar_ind_stat
                  |L1.344|
;;;128    
;;;129    
;;;130    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
000158  ea220200          BIC      r2,r2,r0
00015c  ea6f0102          MVN      r1,r2
000160  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
;;;131    
;;;132    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
000162  4aad              LDR      r2,|L1.1048|
000164  8812              LDRH     r2,[r2,#0]  ; AV_OFF_AVT
000166  b15a              CBZ      r2,|L1.384|
000168  e00e              B        |L1.392|
                  |L1.362|
00016a  f1000218          ADD      r2,r0,#0x18           ;112
00016e  fa04f102          LSL      r1,r4,r2              ;112
000172  681a              LDR      r2,[r3,#0]            ;112  ; avar_stat
000174  ea220201          BIC      r2,r2,r1              ;112
000178  ea420201          ORR      r2,r2,r1              ;112
00017c  601a              STR      r2,[r3,#0]            ;112  ; avar_stat
00017e  e7c5              B        |L1.268|
                  |L1.384|
000180  4aa6              LDR      r2,|L1.1052|
000182  ea410102          ORR      r1,r1,r2
000186  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
                  |L1.392|
;;;133    
;;;134    avar_ind_stat&=avar_stat_offed; 
000188  691a              LDR      r2,[r3,#0x10]  ; avar_stat_offed
00018a  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
00018c  ea010102          AND      r1,r1,r2
000190  6059              STR      r1,[r3,#4]  ; avar_ind_stat
;;;135    
;;;136    avar_stat_old=avar_stat;
000192  6098              STR      r0,[r3,#8]  ; avar_stat_old
;;;137    
;;;138    //oleg_start
;;;139    
;;;140    
;;;141    
;;;142    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
000194  48a2              LDR      r0,|L1.1056|
000196  49a3              LDR      r1,|L1.1060|
000198  8800              LDRH     r0,[r0,#0]  ; status_izm_r
00019a  6809              LDR      r1,[r1,#0]  ; sk_alarm
00019c  f000003f          AND      r0,r0,#0x3f
0001a0  ea402001          ORR      r0,r0,r1,LSL #8
0001a4  6158              STR      r0,[r3,#0x14]  ; rki_avar1_stat
;;;143    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
0001a6  69da              LDR      r2,[r3,#0x1c]  ; rki_avar1_stat_old
0001a8  ea200102          BIC      r1,r0,r2
0001ac  6219              STR      r1,[r3,#0x20]  ; rki_avar1_stat_new
;;;144    rki_avar1_ind_stat|=rki_avar1_stat_new;
0001ae  699c              LDR      r4,[r3,#0x18]  ; rki_avar1_ind_stat
0001b0  ea440401          ORR      r4,r4,r1
;;;145    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
0001b4  ea220200          BIC      r2,r2,r0
0001b8  ea6f0102          MVN      r1,r2
0001bc  6259              STR      r1,[r3,#0x24]  ; rki_avar1_stat_offed
;;;146    rki_avar1_ind_stat&=rki_avar1_stat_offed;
0001be  ea040401          AND      r4,r4,r1
0001c2  619c              STR      r4,[r3,#0x18]  ; rki_avar1_ind_stat
;;;147    rki_avar1_stat_old=rki_avar1_stat;
0001c4  61d8              STR      r0,[r3,#0x1c]  ; rki_avar1_stat_old
;;;148    /*
;;;149    rki_avarI1_stat=status_di1;
;;;150    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;151    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;152    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;153    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;154    rki_avarI1_stat_old=rki_avarI1_stat;
;;;155    
;;;156    rki_avarI2_stat=status_di2;
;;;157    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;158    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;159    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;160    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;161    rki_avarI2_stat_old=rki_avarI2_stat;
;;;162    */
;;;163    //oleg_end
;;;164    }
0001c6  bd30              POP      {r4,r5,pc}
;;;165    
                          ENDP

                  reload_hndl PROC
;;;166    //-----------------------------------------------
;;;167    void reload_hndl(void)
0001c8  b5f8              PUSH     {r3-r7,lr}
;;;168    {
;;;169    
;;;170    char data[4];
;;;171    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;172    
;;;173    event_ptr=lc640_read_int(PTR_EVENT_LOG);
0001ca  f44f6560          MOV      r5,#0xe00
0001ce  4628              MOV      r0,r5
0001d0  f7fffffe          BL       lc640_read_int
;;;174    event_ptr++;	
0001d4  f1000001          ADD      r0,r0,#1
0001d8  4604              MOV      r4,r0
;;;175    if(event_ptr>63)event_ptr=0;	
0001da  2c3f              CMP      r4,#0x3f
0001dc  d901              BLS      |L1.482|
0001de  f04f0400          MOV      r4,#0
                  |L1.482|
;;;176    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
0001e2  b221              SXTH     r1,r4
0001e4  4628              MOV      r0,r5
0001e6  f7fffffe          BL       lc640_write_int
;;;177    	
;;;178    event_cnt=lc640_read_int(CNT_EVENT_LOG);
0001ea  f6406602          MOV      r6,#0xe02
0001ee  4630              MOV      r0,r6
0001f0  f7fffffe          BL       lc640_read_int
;;;179    if(event_cnt!=63)event_cnt=event_ptr;
0001f4  283f              CMP      r0,#0x3f
0001f6  d000              BEQ      |L1.506|
0001f8  4620              MOV      r0,r4
                  |L1.506|
;;;180    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
0001fa  b201              SXTH     r1,r0
0001fc  4630              MOV      r0,r6
0001fe  f7fffffe          BL       lc640_write_int
;;;181    	
;;;182    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000202  4628              MOV      r0,r5
000204  f7fffffe          BL       lc640_read_int
000208  f44f6180          MOV      r1,#0x400
00020c  eb011440          ADD      r4,r1,r0,LSL #5
;;;183    	
;;;184    data[0]='U';
000210  f04f0055          MOV      r0,#0x55
000214  f88d0000          STRB     r0,[sp,#0]
;;;185    data[1]=0;
000218  f04f0600          MOV      r6,#0
00021c  f88d6001          STRB     r6,[sp,#1]
;;;186    data[2]='R';
000220  f04f0052          MOV      r0,#0x52
000224  f88d0002          STRB     r0,[sp,#2]
;;;187    data[3]=0;
000228  f88d6003          STRB     r6,[sp,#3]
;;;188    lc640_write_long_ptr(lc640_adr,data);
00022c  4669              MOV      r1,sp
00022e  4620              MOV      r0,r4
000230  f7fffffe          BL       lc640_write_long_ptr
;;;189    
;;;190    data[0]=0;
;;;191    data[1]=0;
;;;192    data[2]=0;
;;;193    data[3]=0;
000234  9600              STR      r6,[sp,#0]
;;;194    lc640_write_long_ptr(lc640_adr+4,data);
000236  4669              MOV      r1,sp
000238  1d20              ADDS     r0,r4,#4
00023a  f7fffffe          BL       lc640_write_long_ptr
;;;195    
;;;196    data[0]=LPC_RTC->YEAR;
00023e  4d7a              LDR      r5,|L1.1064|
000240  8ba8              LDRH     r0,[r5,#0x1c]
000242  f88d0000          STRB     r0,[sp,#0]
;;;197    data[1]=LPC_RTC->MONTH;
000246  7e28              LDRB     r0,[r5,#0x18]
000248  f88d0001          STRB     r0,[sp,#1]
;;;198    data[2]=LPC_RTC->DOM;
00024c  7b28              LDRB     r0,[r5,#0xc]
00024e  f88d0002          STRB     r0,[sp,#2]
;;;199    data[3]=0;
000252  f88d6003          STRB     r6,[sp,#3]
;;;200    lc640_write_long_ptr(lc640_adr+8,data);
000256  4669              MOV      r1,sp
000258  f1040008          ADD      r0,r4,#8
00025c  f7fffffe          BL       lc640_write_long_ptr
;;;201    
;;;202    data[0]=LPC_RTC->HOUR;
000260  7a28              LDRB     r0,[r5,#8]
000262  f88d0000          STRB     r0,[sp,#0]
;;;203    data[1]=LPC_RTC->MIN;
000266  7928              LDRB     r0,[r5,#4]
000268  f88d0001          STRB     r0,[sp,#1]
;;;204    data[2]=LPC_RTC->SEC;
00026c  7828              LDRB     r0,[r5,#0]
00026e  f88d0002          STRB     r0,[sp,#2]
;;;205    data[3]=LPC_SC->RSID;
000272  486e              LDR      r0,|L1.1068|
000274  f8d00180          LDR      r0,[r0,#0x180]
000278  f88d0003          STRB     r0,[sp,#3]
;;;206    
;;;207    lc640_write_long_ptr(lc640_adr+12,data);
00027c  4669              MOV      r1,sp
00027e  f104000c          ADD      r0,r4,#0xc
000282  f7fffffe          BL       lc640_write_long_ptr
;;;208    	
;;;209    data[0]='A';
000286  f04f0541          MOV      r5,#0x41
00028a  f88d5000          STRB     r5,[sp,#0]
;;;210    data[1]='A';
00028e  f88d5001          STRB     r5,[sp,#1]
;;;211    data[2]='A';
000292  f88d5002          STRB     r5,[sp,#2]
;;;212    data[3]='A';
000296  f88d5003          STRB     r5,[sp,#3]
;;;213    lc640_write_long_ptr(lc640_adr+16,data);
00029a  4669              MOV      r1,sp
00029c  f1040010          ADD      r0,r4,#0x10
0002a0  f7fffffe          BL       lc640_write_long_ptr
;;;214    	
;;;215    data[0]='A';
0002a4  f88d5000          STRB     r5,[sp,#0]
;;;216    data[1]='A';
0002a8  f88d5001          STRB     r5,[sp,#1]
;;;217    data[2]='A';
0002ac  f88d5002          STRB     r5,[sp,#2]
;;;218    data[3]='A';
0002b0  f88d5003          STRB     r5,[sp,#3]
;;;219    lc640_write_long_ptr(lc640_adr+20,data);
0002b4  4669              MOV      r1,sp
0002b6  f1040014          ADD      r0,r4,#0x14
0002ba  f7fffffe          BL       lc640_write_long_ptr
;;;220    	
;;;221    data[0]='A';
0002be  f88d5000          STRB     r5,[sp,#0]
;;;222    data[1]='A';
0002c2  f88d5001          STRB     r5,[sp,#1]
;;;223    data[2]='A';
0002c6  f88d5002          STRB     r5,[sp,#2]
;;;224    data[3]='A';
0002ca  f88d5003          STRB     r5,[sp,#3]
;;;225    lc640_write_long_ptr(lc640_adr+24,data);
0002ce  4669              MOV      r1,sp
0002d0  f1040018          ADD      r0,r4,#0x18
0002d4  f7fffffe          BL       lc640_write_long_ptr
;;;226    	
;;;227    data[0]='A';
0002d8  f88d5000          STRB     r5,[sp,#0]
;;;228    data[1]='A';
0002dc  f88d5001          STRB     r5,[sp,#1]
;;;229    data[2]='A';
0002e0  f88d5002          STRB     r5,[sp,#2]
;;;230    data[3]='A';
0002e4  f88d5003          STRB     r5,[sp,#3]
;;;231    lc640_write_long_ptr(lc640_adr+28,data);				
0002e8  4669              MOV      r1,sp
0002ea  f104001c          ADD      r0,r4,#0x1c
0002ee  f7fffffe          BL       lc640_write_long_ptr
;;;232    	
;;;233    	
;;;234    }
0002f2  bdf8              POP      {r3-r7,pc}
;;;235    
                          ENDP

                  avar_unet_hndl PROC
;;;236    //-----------------------------------------------
;;;237    void avar_unet_hndl(char in)
0002f4  e92d4ff8          PUSH     {r3-r11,lr}
;;;238    {
;;;239    
;;;240    char data[4];
;;;241    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;242    
;;;243    
;;;244    if(in==1)
;;;245    	{
;;;246    	net_av=1;
;;;247    
;;;248    	//beep_init(0x01L,'O');
;;;249    	//a.av.bAN=1;
;;;250    
;;;251    
;;;252    	//beep_init(0x33333333,'A');
;;;253    	 
;;;254    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;255    	event_ptr++;	
;;;256    	if(event_ptr>63)event_ptr=0;	
;;;257    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;258    	
;;;259         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;260    	if(event_cnt!=63)event_cnt=event_ptr;
;;;261    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;262    	
;;;263    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;264    	
;;;265    	data[0]='P';
;;;266    	data[1]=0;
;;;267    	data[2]='A';
;;;268    	data[3]=0;
;;;269    	lc640_write_long_ptr(lc640_adr,data);
;;;270    
;;;271    	data[0]=0;//*((char*)&Unet_store);
;;;272    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;273    	data[2]=0;
;;;274    	data[3]=0;
;;;275    	lc640_write_long_ptr(lc640_adr+4,data);
;;;276    
;;;277    	data[0]=LPC_RTC->YEAR;
0002f8  4e4b              LDR      r6,|L1.1064|
0002fa  4941              LDR      r1,|L1.1024|
0002fc  2441              MOVS     r4,#0x41              ;267
0002fe  3e20              SUBS     r6,r6,#0x20
000300  2700              MOVS     r7,#0                 ;256
000302  f04f0a50          MOV      r10,#0x50             ;265
000306  f44f6560          MOV      r5,#0xe00             ;254
00030a  f6406b02          MOV      r11,#0xe02            ;259
00030e  f44f6880          MOV      r8,#0x400             ;263
000312  2801              CMP      r0,#1                 ;244
000314  d006              BEQ      |L1.804|
;;;278    	data[1]=LPC_RTC->MONTH;
;;;279    	data[2]=LPC_RTC->DOM;
;;;280    	data[3]=0;
;;;281    	lc640_write_long_ptr(lc640_adr+8,data);
;;;282    
;;;283    	data[0]=LPC_RTC->HOUR;
;;;284    	data[1]=LPC_RTC->MIN;
;;;285    	data[2]=LPC_RTC->SEC;
;;;286    	data[3]=0;
;;;287    	lc640_write_long_ptr(lc640_adr+12,data);
;;;288    	
;;;289    	data[0]='A';
;;;290    	data[1]='A';
;;;291    	data[2]='A';
;;;292    	data[3]='A';
;;;293    	lc640_write_long_ptr(lc640_adr+16,data);
;;;294    	
;;;295    	data[0]='A';
;;;296    	data[1]='A';
;;;297    	data[2]='A';
;;;298    	data[3]='A';
;;;299    	lc640_write_long_ptr(lc640_adr+20,data);
;;;300    	
;;;301    	data[0]='A';
;;;302    	data[1]='A';
;;;303    	data[2]='A';
;;;304    	data[3]='A';
;;;305    	lc640_write_long_ptr(lc640_adr+24,data);
;;;306    	
;;;307    	data[0]='A';
;;;308    	data[1]='A';
;;;309    	data[2]='A';
;;;310    	data[3]='A';
;;;311    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;312    	
;;;313    /*	memo_out0[0]=0x55;
;;;314         memo_out0[1]=0x00+2;
;;;315         memo_out0[2]=1;
;;;316         memo_out0[3]=0x0b;
;;;317         memo_out0[4]=0x55;
;;;318         memo_out0[5]=0x55; 
;;;319         	
;;;320         memo_out0[6]=crc_87(memo_out0,6);
;;;321    	memo_out0[7]=crc_95(memo_out0,6);
;;;322         usart_out_adr0(memo_out0,8); 
;;;323    	*/
;;;324    	snmp_trap_send("Main power alarm, voltage reduced",2,1,0);
;;;325    	}
;;;326    
;;;327    else if(in==2)
;;;328    	{
;;;329    	net_av=2;
;;;330    
;;;331    	//beep_init(0x01L,'O');
;;;332    	//a.av.bAN=1;
;;;333    
;;;334    
;;;335    	//beep_init(0x33333333,'A');
;;;336    	 
;;;337    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;338    	event_ptr++;	
;;;339    	if(event_ptr>63)event_ptr=0;	
;;;340    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;341    	
;;;342         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;343    	if(event_cnt!=63)event_cnt=event_ptr;
;;;344    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;345    	
;;;346    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;347    	
;;;348    	data[0]='P';
;;;349    	data[1]=0;
;;;350    	data[2]='B';
000316  f04f0942          MOV      r9,#0x42
00031a  2802              CMP      r0,#2                 ;327
00031c  d06e              BEQ      |L1.1020|
;;;351    	data[3]=0;
;;;352    	lc640_write_long_ptr(lc640_adr,data);
;;;353    
;;;354    	data[0]=0;//*((char*)&Unet_store);
;;;355    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;356    	data[2]=0;
;;;357    	data[3]=0;
;;;358    	lc640_write_long_ptr(lc640_adr+4,data);
;;;359    
;;;360    	data[0]=LPC_RTC->YEAR;
;;;361    	data[1]=LPC_RTC->MONTH;
;;;362    	data[2]=LPC_RTC->DOM;
;;;363    	data[3]=0;
;;;364    	lc640_write_long_ptr(lc640_adr+8,data);
;;;365    
;;;366    	data[0]=LPC_RTC->HOUR;
;;;367    	data[1]=LPC_RTC->MIN;
;;;368    	data[2]=LPC_RTC->SEC;
;;;369    	data[3]=0;
;;;370    	lc640_write_long_ptr(lc640_adr+12,data);
;;;371    	
;;;372    	data[0]='A';
;;;373    	data[1]='A';
;;;374    	data[2]='A';
;;;375    	data[3]='A';
;;;376    	lc640_write_long_ptr(lc640_adr+16,data);
;;;377    	
;;;378    	data[0]='A';
;;;379    	data[1]='A';
;;;380    	data[2]='A';
;;;381    	data[3]='A';
;;;382    	lc640_write_long_ptr(lc640_adr+20,data);
;;;383    	
;;;384    	data[0]='A';
;;;385    	data[1]='A';
;;;386    	data[2]='A';
;;;387    	data[3]='A';
;;;388    	lc640_write_long_ptr(lc640_adr+24,data);
;;;389    	
;;;390    	data[0]='A';
;;;391    	data[1]='A';
;;;392    	data[2]='A';
;;;393    	data[3]='A';
;;;394    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;395    	
;;;396    	snmp_trap_send("Main power alarm, voltage increased",2,2,0);
;;;397    	}
;;;398    
;;;399    else if(in==0)
00031e  2800              CMP      r0,#0
000320  d06d              BEQ      |L1.1022|
000322  e1cc              B        |L1.1726|
                  |L1.804|
000324  f04f0001          MOV      r0,#1                 ;246
000328  7008              STRB     r0,[r1,#0]            ;246
00032a  4628              MOV      r0,r5                 ;254
00032c  f7fffffe          BL       lc640_read_int
000330  f1000001          ADD      r0,r0,#1              ;255
000334  4681              MOV      r9,r0                 ;255
000336  f1b90f3f          CMP      r9,#0x3f              ;256
00033a  d901              BLS      |L1.832|
00033c  f04f0900          MOV      r9,#0                 ;256
                  |L1.832|
000340  fa0ff189          SXTH     r1,r9                 ;257
000344  4628              MOV      r0,r5                 ;257
000346  f7fffffe          BL       lc640_write_int
00034a  4658              MOV      r0,r11                ;259
00034c  f7fffffe          BL       lc640_read_int
000350  283f              CMP      r0,#0x3f              ;260
000352  d000              BEQ      |L1.854|
000354  4648              MOV      r0,r9                 ;260
                  |L1.854|
000356  b201              SXTH     r1,r0                 ;261
000358  4658              MOV      r0,r11                ;261
00035a  f7fffffe          BL       lc640_write_int
00035e  4628              MOV      r0,r5                 ;263
000360  f7fffffe          BL       lc640_read_int
000364  eb081540          ADD      r5,r8,r0,LSL #5       ;263
000368  f88da000          STRB     r10,[sp,#0]           ;265
00036c  f88d7001          STRB     r7,[sp,#1]            ;266
000370  f88d4002          STRB     r4,[sp,#2]            ;267
000374  f88d7003          STRB     r7,[sp,#3]            ;268
000378  4669              MOV      r1,sp                 ;269
00037a  4628              MOV      r0,r5                 ;269
00037c  f7fffffe          BL       lc640_write_long_ptr
000380  9700              STR      r7,[sp,#0]            ;274
000382  4669              MOV      r1,sp                 ;275
000384  1d28              ADDS     r0,r5,#4              ;275
000386  f7fffffe          BL       lc640_write_long_ptr
00038a  f1060620          ADD      r6,r6,#0x20           ;277
00038e  8bb0              LDRH     r0,[r6,#0x1c]         ;277
000390  f88d0000          STRB     r0,[sp,#0]            ;277
000394  7e30              LDRB     r0,[r6,#0x18]         ;278
000396  f88d0001          STRB     r0,[sp,#1]            ;278
00039a  7b30              LDRB     r0,[r6,#0xc]          ;279
00039c  f88d0002          STRB     r0,[sp,#2]            ;279
0003a0  f88d7003          STRB     r7,[sp,#3]            ;280
0003a4  4669              MOV      r1,sp                 ;281
0003a6  f1050008          ADD      r0,r5,#8              ;281
0003aa  f7fffffe          BL       lc640_write_long_ptr
0003ae  7a30              LDRB     r0,[r6,#8]            ;283
0003b0  f88d0000          STRB     r0,[sp,#0]            ;283
0003b4  7930              LDRB     r0,[r6,#4]            ;284
0003b6  f88d0001          STRB     r0,[sp,#1]            ;284
0003ba  7830              LDRB     r0,[r6,#0]            ;285
0003bc  f88d0002          STRB     r0,[sp,#2]            ;285
0003c0  f88d7003          STRB     r7,[sp,#3]            ;286
0003c4  4669              MOV      r1,sp                 ;287
0003c6  f105000c          ADD      r0,r5,#0xc            ;287
0003ca  f7fffffe          BL       lc640_write_long_ptr
0003ce  f88d4000          STRB     r4,[sp,#0]            ;289
0003d2  f88d4001          STRB     r4,[sp,#1]            ;290
0003d6  f88d4002          STRB     r4,[sp,#2]            ;291
0003da  f88d4003          STRB     r4,[sp,#3]            ;292
0003de  4669              MOV      r1,sp                 ;293
0003e0  f1050010          ADD      r0,r5,#0x10           ;293
0003e4  f7fffffe          BL       lc640_write_long_ptr
0003e8  f88d4000          STRB     r4,[sp,#0]            ;295
0003ec  f88d4001          STRB     r4,[sp,#1]            ;296
0003f0  f88d4002          STRB     r4,[sp,#2]            ;297
0003f4  f88d4003          STRB     r4,[sp,#3]            ;298
0003f8  4669              MOV      r1,sp                 ;299
0003fa  e019              B        |L1.1072|
                  |L1.1020|
0003fc  e03d              B        |L1.1146|
                  |L1.1022|
0003fe  e0cd              B        |L1.1436|
                  |L1.1024|
                          DCD      net_av
                  |L1.1028|
                          DCD      ||.data||
                  |L1.1032|
                          DCD      bat
                  |L1.1036|
                          DCD      bps
                  |L1.1040|
                          DCD      sk_av_stat
                  |L1.1044|
                          DCD      SK_ZVUK_EN
                  |L1.1048|
                          DCD      AV_OFF_AVT
                  |L1.1052|
                          DCD      0xeffffffe
                  |L1.1056|
                          DCD      status_izm_r
                  |L1.1060|
                          DCD      sk_alarm
                  |L1.1064|
                          DCD      0x40024020
                  |L1.1068|
                          DCD      0x400fc000
                  |L1.1072|
000430  f1050014          ADD      r0,r5,#0x14           ;299
000434  f7fffffe          BL       lc640_write_long_ptr
000438  f88d4000          STRB     r4,[sp,#0]            ;301
00043c  f88d4001          STRB     r4,[sp,#1]            ;302
000440  f88d4002          STRB     r4,[sp,#2]            ;303
000444  f88d4003          STRB     r4,[sp,#3]            ;304
000448  4669              MOV      r1,sp                 ;305
00044a  f1050018          ADD      r0,r5,#0x18           ;305
00044e  f7fffffe          BL       lc640_write_long_ptr
000452  f88d4000          STRB     r4,[sp,#0]            ;307
000456  f88d4001          STRB     r4,[sp,#1]            ;308
00045a  f88d4002          STRB     r4,[sp,#2]            ;309
00045e  f88d4003          STRB     r4,[sp,#3]            ;310
000462  4669              MOV      r1,sp                 ;311
000464  f105001c          ADD      r0,r5,#0x1c           ;311
000468  f7fffffe          BL       lc640_write_long_ptr
00046c  2300              MOVS     r3,#0                 ;324
00046e  2201              MOVS     r2,#1                 ;324
000470  2102              MOVS     r1,#2                 ;324
000472  a0ff              ADR      r0,|L1.2160|
000474  f7fffffe          BL       snmp_trap_send
000478  e121              B        |L1.1726|
                  |L1.1146|
00047a  f04f0002          MOV      r0,#2                 ;329
00047e  7008              STRB     r0,[r1,#0]            ;329
000480  f44f6060          MOV      r0,#0xe00             ;337
000484  f7fffffe          BL       lc640_read_int
000488  f1000001          ADD      r0,r0,#1              ;338
00048c  4605              MOV      r5,r0                 ;338
00048e  2d3f              CMP      r5,#0x3f              ;339
000490  d901              BLS      |L1.1174|
000492  f04f0500          MOV      r5,#0                 ;339
                  |L1.1174|
000496  b229              SXTH     r1,r5                 ;340
000498  f44f6060          MOV      r0,#0xe00             ;340
00049c  f7fffffe          BL       lc640_write_int
0004a0  4658              MOV      r0,r11                ;342
0004a2  f7fffffe          BL       lc640_read_int
0004a6  283f              CMP      r0,#0x3f              ;343
0004a8  d000              BEQ      |L1.1196|
0004aa  4628              MOV      r0,r5                 ;343
                  |L1.1196|
0004ac  b201              SXTH     r1,r0                 ;344
0004ae  4658              MOV      r0,r11                ;344
0004b0  f7fffffe          BL       lc640_write_int
0004b4  f44f6060          MOV      r0,#0xe00             ;346
0004b8  f7fffffe          BL       lc640_read_int
0004bc  eb081540          ADD      r5,r8,r0,LSL #5       ;346
0004c0  f88da000          STRB     r10,[sp,#0]           ;348
0004c4  f88d7001          STRB     r7,[sp,#1]            ;349
0004c8  f88d9002          STRB     r9,[sp,#2]            ;350
0004cc  f88d7003          STRB     r7,[sp,#3]            ;351
0004d0  4669              MOV      r1,sp                 ;352
0004d2  4628              MOV      r0,r5                 ;352
0004d4  f7fffffe          BL       lc640_write_long_ptr
0004d8  9700              STR      r7,[sp,#0]            ;357
0004da  4669              MOV      r1,sp                 ;358
0004dc  1d28              ADDS     r0,r5,#4              ;358
0004de  f7fffffe          BL       lc640_write_long_ptr
0004e2  f1060620          ADD      r6,r6,#0x20           ;360
0004e6  8bb0              LDRH     r0,[r6,#0x1c]         ;360
0004e8  f88d0000          STRB     r0,[sp,#0]            ;360
0004ec  7e30              LDRB     r0,[r6,#0x18]         ;361
0004ee  f88d0001          STRB     r0,[sp,#1]            ;361
0004f2  7b30              LDRB     r0,[r6,#0xc]          ;362
0004f4  f88d0002          STRB     r0,[sp,#2]            ;362
0004f8  f88d7003          STRB     r7,[sp,#3]            ;363
0004fc  4669              MOV      r1,sp                 ;364
0004fe  f1050008          ADD      r0,r5,#8              ;364
000502  f7fffffe          BL       lc640_write_long_ptr
000506  7a30              LDRB     r0,[r6,#8]            ;366
000508  f88d0000          STRB     r0,[sp,#0]            ;366
00050c  7930              LDRB     r0,[r6,#4]            ;367
00050e  f88d0001          STRB     r0,[sp,#1]            ;367
000512  7830              LDRB     r0,[r6,#0]            ;368
000514  f88d0002          STRB     r0,[sp,#2]            ;368
000518  f88d7003          STRB     r7,[sp,#3]            ;369
00051c  4669              MOV      r1,sp                 ;370
00051e  f105000c          ADD      r0,r5,#0xc            ;370
000522  f7fffffe          BL       lc640_write_long_ptr
000526  f88d4000          STRB     r4,[sp,#0]            ;372
00052a  f88d4001          STRB     r4,[sp,#1]            ;373
00052e  f88d4002          STRB     r4,[sp,#2]            ;374
000532  f88d4003          STRB     r4,[sp,#3]            ;375
000536  4669              MOV      r1,sp                 ;376
000538  f1050010          ADD      r0,r5,#0x10           ;376
00053c  f7fffffe          BL       lc640_write_long_ptr
000540  f88d4000          STRB     r4,[sp,#0]            ;378
000544  f88d4001          STRB     r4,[sp,#1]            ;379
000548  f88d4002          STRB     r4,[sp,#2]            ;380
00054c  f88d4003          STRB     r4,[sp,#3]            ;381
000550  4669              MOV      r1,sp                 ;382
000552  f1050014          ADD      r0,r5,#0x14           ;382
000556  f7fffffe          BL       lc640_write_long_ptr
00055a  f88d4000          STRB     r4,[sp,#0]            ;384
00055e  f88d4001          STRB     r4,[sp,#1]            ;385
000562  f88d4002          STRB     r4,[sp,#2]            ;386
000566  f88d4003          STRB     r4,[sp,#3]            ;387
00056a  4669              MOV      r1,sp                 ;388
00056c  f1050018          ADD      r0,r5,#0x18           ;388
000570  f7fffffe          BL       lc640_write_long_ptr
000574  f88d4000          STRB     r4,[sp,#0]            ;390
000578  f88d4001          STRB     r4,[sp,#1]            ;391
00057c  f88d4002          STRB     r4,[sp,#2]            ;392
000580  f88d4003          STRB     r4,[sp,#3]            ;393
000584  4669              MOV      r1,sp                 ;394
000586  f105001c          ADD      r0,r5,#0x1c           ;394
00058a  f7fffffe          BL       lc640_write_long_ptr
00058e  2202              MOVS     r2,#2                 ;396
000590  2300              MOVS     r3,#0                 ;396
000592  4611              MOV      r1,r2                 ;396
000594  a0bf              ADR      r0,|L1.2196|
000596  f7fffffe          BL       snmp_trap_send
00059a  e090              B        |L1.1726|
                  |L1.1436|
;;;400    	{
;;;401    	net_av=0;
00059c  700f              STRB     r7,[r1,#0]
;;;402    
;;;403      /*
;;;404    	SET_REG(C2GSR,3,24,8);
;;;405    	C2MOD=0;
;;;406    	bOUT_FREE2=1;*/
;;;407    
;;;408    
;;;409    	//C2MOD=0;
;;;410    
;;;411    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;412    
;;;413         //beep_init(0x02L,'O');
;;;414    	//a_.av.bAN=0;
;;;415    	SET_REG(avar_stat,0,0,1);
00059e  48c6              LDR      r0,|L1.2232|
0005a0  6801              LDR      r1,[r0,#0]  ; avar_stat
0005a2  f0210101          BIC      r1,r1,#1
0005a6  6001              STR      r1,[r0,#0]  ; avar_stat
;;;416    
;;;417    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;418    	
;;;419    	if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
0005a8  49c4              LDR      r1,|L1.2236|
0005aa  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
0005ac  b119              CBZ      r1,|L1.1462|
0005ae  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
0005b0  f0210101          BIC      r1,r1,#1
0005b4  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.1462|
;;;420    
;;;421         event_ptr=lc640_read_int(PTR_EVENT_LOG);
0005b6  4628              MOV      r0,r5
0005b8  f7fffffe          BL       lc640_read_int
0005bc  4682              MOV      r10,r0
;;;422    	event_ptr_find=event_ptr;
0005be  4654              MOV      r4,r10
                  |L1.1472|
;;;423    avar_unet_hndl_lbl1:
;;;424    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0005c0  eb081544          ADD      r5,r8,r4,LSL #5
;;;425    
;;;426         lc640_read_long_ptr(lc640_adr,data);
0005c4  4669              MOV      r1,sp
0005c6  4628              MOV      r0,r5
0005c8  f7fffffe          BL       lc640_read_long_ptr
;;;427         
;;;428         if(!((data[0]=='P')&&(data[1]==0)&&((data[2]=='A')||(data[2]=='B'))))
0005cc  f89d0000          LDRB     r0,[sp,#0]
0005d0  2850              CMP      r0,#0x50
0005d2  d108              BNE      |L1.1510|
0005d4  f89d0001          LDRB     r0,[sp,#1]
0005d8  b928              CBNZ     r0,|L1.1510|
0005da  f89d0002          LDRB     r0,[sp,#2]
0005de  2841              CMP      r0,#0x41
0005e0  d00a              BEQ      |L1.1528|
0005e2  2842              CMP      r0,#0x42
0005e4  d008              BEQ      |L1.1528|
                  |L1.1510|
;;;429         	{        
;;;430         	if(event_ptr_find)event_ptr_find--;
0005e6  b114              CBZ      r4,|L1.1518|
0005e8  f1a40401          SUB      r4,r4,#1
0005ec  e001              B        |L1.1522|
                  |L1.1518|
;;;431         	else event_ptr_find=63;
0005ee  f04f043f          MOV      r4,#0x3f
                  |L1.1522|
;;;432         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0005f2  4554              CMP      r4,r10
0005f4  d1e4              BNE      |L1.1472|
0005f6  e062              B        |L1.1726|
                  |L1.1528|
;;;433         	else goto avar_unet_hndl_lbl1;
;;;434         	}
;;;435         else 
;;;436         	{
;;;437         	lc640_read_long_ptr(lc640_adr+16,data);
0005f8  4669              MOV      r1,sp
0005fa  f1050010          ADD      r0,r5,#0x10
0005fe  f7fffffe          BL       lc640_read_long_ptr
;;;438         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000602  f89d0000          LDRB     r0,[sp,#0]
000606  2841              CMP      r0,#0x41
000608  d10b              BNE      |L1.1570|
00060a  f89d0001          LDRB     r0,[sp,#1]
00060e  2841              CMP      r0,#0x41
000610  d107              BNE      |L1.1570|
000612  f89d0002          LDRB     r0,[sp,#2]
000616  2841              CMP      r0,#0x41
000618  d103              BNE      |L1.1570|
00061a  f89d0003          LDRB     r0,[sp,#3]
00061e  2841              CMP      r0,#0x41
000620  d008              BEQ      |L1.1588|
                  |L1.1570|
;;;439         		{        
;;;440         		if(event_ptr_find)event_ptr_find--;
000622  b114              CBZ      r4,|L1.1578|
000624  f1a40401          SUB      r4,r4,#1
000628  e001              B        |L1.1582|
                  |L1.1578|
;;;441             		else event_ptr_find=63;
00062a  f04f043f          MOV      r4,#0x3f
                  |L1.1582|
;;;442             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
00062e  4554              CMP      r4,r10
000630  d1c6              BNE      |L1.1472|
000632  e044              B        |L1.1726|
                  |L1.1588|
;;;443         		else goto avar_unet_hndl_lbl1;
;;;444         		}
;;;445    
;;;446         	}	
;;;447    	
;;;448    	data[0]=LPC_RTC->YEAR;
000634  f1060620          ADD      r6,r6,#0x20
000638  8bb0              LDRH     r0,[r6,#0x1c]
00063a  f88d0000          STRB     r0,[sp,#0]
;;;449    	data[1]=LPC_RTC->MONTH;
00063e  7e30              LDRB     r0,[r6,#0x18]
000640  f88d0001          STRB     r0,[sp,#1]
;;;450    	data[2]=LPC_RTC->DOM;
000644  7b30              LDRB     r0,[r6,#0xc]
000646  f88d0002          STRB     r0,[sp,#2]
;;;451    	data[3]=0;
00064a  f88d7003          STRB     r7,[sp,#3]
;;;452    	lc640_write_long_ptr(lc640_adr+16,data);
00064e  4669              MOV      r1,sp
000650  f1050010          ADD      r0,r5,#0x10
000654  f7fffffe          BL       lc640_write_long_ptr
;;;453    
;;;454    	data[0]=LPC_RTC->HOUR;
000658  7a30              LDRB     r0,[r6,#8]
00065a  f88d0000          STRB     r0,[sp,#0]
;;;455    	data[1]=LPC_RTC->MIN;
00065e  7930              LDRB     r0,[r6,#4]
000660  f88d0001          STRB     r0,[sp,#1]
;;;456    	data[2]=LPC_RTC->SEC;
000664  7830              LDRB     r0,[r6,#0]
000666  f88d0002          STRB     r0,[sp,#2]
;;;457    	data[3]=0;
00066a  f88d7003          STRB     r7,[sp,#3]
;;;458    	lc640_write_long_ptr(lc640_adr+20,data); 
00066e  4669              MOV      r1,sp
000670  f1050014          ADD      r0,r5,#0x14
000674  f7fffffe          BL       lc640_write_long_ptr
;;;459    	
;;;460    	data[0]=*((char*)(&net_Ustore));
000678  4891              LDR      r0,|L1.2240|
00067a  7801              LDRB     r1,[r0,#0]  ; net_Ustore
00067c  f88d1000          STRB     r1,[sp,#0]
;;;461    	data[1]=*(((char*)(&net_Ustore))+1);
000680  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000682  f88d0001          STRB     r0,[sp,#1]
;;;462    	data[2]='B';
000686  f88d9002          STRB     r9,[sp,#2]
;;;463    	data[3]='B';
00068a  f88d9003          STRB     r9,[sp,#3]
;;;464    	lc640_write_long_ptr(lc640_adr+24,data);
00068e  4669              MOV      r1,sp
000690  f1050018          ADD      r0,r5,#0x18
000694  f7fffffe          BL       lc640_write_long_ptr
;;;465    	
;;;466    	data[0]='B';
000698  f88d9000          STRB     r9,[sp,#0]
;;;467    	data[1]='B';
00069c  f88d9001          STRB     r9,[sp,#1]
;;;468    	data[2]='B';
0006a0  f88d9002          STRB     r9,[sp,#2]
;;;469    	data[3]='B';
0006a4  f88d9003          STRB     r9,[sp,#3]
;;;470    	lc640_write_long_ptr(lc640_adr+28,data);	
0006a8  4669              MOV      r1,sp
0006aa  f105001c          ADD      r0,r5,#0x1c
0006ae  f7fffffe          BL       lc640_write_long_ptr
;;;471    	
;;;472    /*	memo_out0[0]=0x55;
;;;473         memo_out0[1]=0x00+2;
;;;474         memo_out0[2]=1;
;;;475         memo_out0[3]=0x0b;
;;;476         memo_out0[4]=0xaa;
;;;477         memo_out0[5]=0xaa; 
;;;478         	
;;;479         memo_out0[6]=crc_87(memo_out0,6);
;;;480    	memo_out0[7]=crc_95(memo_out0,6);
;;;481         usart_out_adr0(memo_out0,8); */
;;;482         snmp_trap_send("Main power alarm  clear",2,1,1);	
0006b2  2301              MOVS     r3,#1
0006b4  461a              MOV      r2,r3
0006b6  2102              MOVS     r1,#2
0006b8  a082              ADR      r0,|L1.2244|
0006ba  f7fffffe          BL       snmp_trap_send
                  |L1.1726|
;;;483    	}
;;;484    avar_unet_hndl_end:
;;;485    	__nop();		
0006be  bf00              NOP      
                  |L1.1728|
;;;486    }
0006c0  e8bd8ff8          POP      {r3-r11,pc}
;;;487    
                          ENDP

                  avar_uout_hndl PROC
;;;489    //-----------------------------------------------
;;;490    void avar_uout_hndl(char in)
0006c4  e92d4ff8          PUSH     {r3-r11,lr}
;;;491    {
;;;492    
;;;493    char data[4];
;;;494    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;495    char avar_data=0;
;;;496    
;;;497    if(in==1)
;;;498    	{
;;;499    	//net_av=1;
;;;500    
;;;501    	//beep_init(0x01L,'O');
;;;502    	//a.av.bAN=1;
;;;503    
;;;504    
;;;505    	//beep_init(0x33333333,'A');
;;;506    
;;;507    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;508    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;509    	
;;;510    	avar_data=uout_av;
;;;511    		 
;;;512    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;513    	event_ptr++;	
;;;514    	if(event_ptr>63)event_ptr=0;	
;;;515    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;516    	
;;;517        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;518    	if(event_cnt!=63)event_cnt=event_ptr;
;;;519    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;520    	
;;;521    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;522    	
;;;523    	data[0]='Q';
;;;524    	data[1]=0;
;;;525    	data[2]='A';
;;;526    	data[3]=avar_data;
;;;527    	lc640_write_long_ptr(lc640_adr,data);
;;;528    
;;;529    	 //load_U=4321;
;;;530    
;;;531    	data[0]=*((char*)&load_U);
;;;532    	data[1]=*(((char*)&load_U)+1);
;;;533    	data[2]=0;
;;;534    	data[3]=0;
;;;535    	lc640_write_long_ptr(lc640_adr+4,data);
;;;536    
;;;537    	data[0]=LPC_RTC->YEAR;
0006c8  4f84              LDR      r7,|L1.2268|
0006ca  4985              LDR      r1,|L1.2272|
0006cc  f44f6560          MOV      r5,#0xe00             ;512
0006d0  f04f0800          MOV      r8,#0                 ;495
0006d4  f44f6980          MOV      r9,#0x400             ;521
0006d8  2801              CMP      r0,#1                 ;497
0006da  d002              BEQ      |L1.1762|
;;;538    	data[1]=LPC_RTC->MONTH;
;;;539    	data[2]=LPC_RTC->DOM;
;;;540    	data[3]=0;
;;;541    	lc640_write_long_ptr(lc640_adr+8,data);
;;;542    
;;;543    	data[0]=LPC_RTC->HOUR;
;;;544    	data[1]=LPC_RTC->MIN;
;;;545    	data[2]=LPC_RTC->SEC;
;;;546    	data[3]=0;
;;;547    	lc640_write_long_ptr(lc640_adr+12,data);
;;;548    	
;;;549    	data[0]='A';
;;;550    	data[1]='A';
;;;551    	data[2]='A';
;;;552    	data[3]='A';
;;;553    	lc640_write_long_ptr(lc640_adr+16,data);
;;;554    	
;;;555    	data[0]='A';
;;;556    	data[1]='A';
;;;557    	data[2]='A';
;;;558    	data[3]='A';
;;;559    	lc640_write_long_ptr(lc640_adr+20,data);
;;;560    	
;;;561    	data[0]='A';
;;;562    	data[1]='A';
;;;563    	data[2]='A';
;;;564    	data[3]='A';
;;;565    	lc640_write_long_ptr(lc640_adr+24,data);
;;;566    	
;;;567    	data[0]='A';
;;;568    	data[1]='A';
;;;569    	data[2]='A';
;;;570    	data[3]='A';
;;;571    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;572    	
;;;573    /*	memo_out0[0]=0x55;
;;;574         memo_out0[1]=0x00+2;
;;;575         memo_out0[2]=1;
;;;576         memo_out0[3]=0x0b;
;;;577         memo_out0[4]=0x55;
;;;578         memo_out0[5]=0x55; 
;;;579         	
;;;580         memo_out0[6]=crc_87(memo_out0,6);
;;;581    	memo_out0[7]=crc_95(memo_out0,6);
;;;582         usart_out_adr0(memo_out0,8); 
;;;583    	*/
;;;584    	//snmp_trap_send("Main power is off",2,1,0);
;;;585    	}
;;;586    
;;;587    else if(in==0)
0006dc  2800              CMP      r0,#0
0006de  d07d              BEQ      |L1.2012|
0006e0  e174              B        |L1.2508|
                  |L1.1762|
0006e2  f8dfa200          LDR      r10,|L1.2276|
0006e6  4a80              LDR      r2,|L1.2280|
0006e8  f9ba0000          LDRSH    r0,[r10,#0]           ;507  ; load_U
0006ec  f9b22000          LDRSH    r2,[r2,#0]            ;507  ; U_OUT_KONTR_MAX
0006f0  4290              CMP      r0,r2                 ;507
0006f2  dd02              BLE      |L1.1786|
0006f4  f04f0201          MOV      r2,#1                 ;507
0006f8  700a              STRB     r2,[r1,#0]            ;507
                  |L1.1786|
0006fa  4a7c              LDR      r2,|L1.2284|
0006fc  f9b22000          LDRSH    r2,[r2,#0]            ;508  ; U_OUT_KONTR_MIN
000700  4290              CMP      r0,r2                 ;508
000702  da02              BGE      |L1.1802|
000704  f04f0002          MOV      r0,#2                 ;508
000708  7008              STRB     r0,[r1,#0]            ;508
                  |L1.1802|
00070a  780e              LDRB     r6,[r1,#0]            ;510  ; uout_av
00070c  4628              MOV      r0,r5                 ;512
00070e  f7fffffe          BL       lc640_read_int
000712  f1000001          ADD      r0,r0,#1              ;513
000716  4604              MOV      r4,r0                 ;513
000718  2c3f              CMP      r4,#0x3f              ;514
00071a  d901              BLS      |L1.1824|
00071c  f04f0400          MOV      r4,#0                 ;514
                  |L1.1824|
000720  b221              SXTH     r1,r4                 ;515
000722  4628              MOV      r0,r5                 ;515
000724  f7fffffe          BL       lc640_write_int
000728  f6406b02          MOV      r11,#0xe02            ;517
00072c  4658              MOV      r0,r11                ;517
00072e  f7fffffe          BL       lc640_read_int
000732  283f              CMP      r0,#0x3f              ;518
000734  d000              BEQ      |L1.1848|
000736  4620              MOV      r0,r4                 ;518
                  |L1.1848|
000738  b201              SXTH     r1,r0                 ;519
00073a  4658              MOV      r0,r11                ;519
00073c  f7fffffe          BL       lc640_write_int
000740  4628              MOV      r0,r5                 ;521
000742  f7fffffe          BL       lc640_read_int
000746  eb091540          ADD      r5,r9,r0,LSL #5       ;521
00074a  f04f0051          MOV      r0,#0x51              ;523
00074e  f88d0000          STRB     r0,[sp,#0]            ;523
000752  f88d8001          STRB     r8,[sp,#1]            ;524
000756  f04f0441          MOV      r4,#0x41              ;525
00075a  f88d4002          STRB     r4,[sp,#2]            ;525
00075e  f88d6003          STRB     r6,[sp,#3]            ;526
000762  4669              MOV      r1,sp                 ;527
000764  4628              MOV      r0,r5                 ;527
000766  f7fffffe          BL       lc640_write_long_ptr
00076a  f89a0000          LDRB     r0,[r10,#0]           ;531  ; load_U
00076e  f88d0000          STRB     r0,[sp,#0]            ;531
000772  f89a0001          LDRB     r0,[r10,#1]           ;532  ; load_U
000776  f88d0001          STRB     r0,[sp,#1]            ;532
00077a  f88d8002          STRB     r8,[sp,#2]            ;533
00077e  f88d8003          STRB     r8,[sp,#3]            ;534
000782  4669              MOV      r1,sp                 ;535
000784  1d28              ADDS     r0,r5,#4              ;535
000786  f7fffffe          BL       lc640_write_long_ptr
00078a  f1070720          ADD      r7,r7,#0x20           ;537
00078e  8bb8              LDRH     r0,[r7,#0x1c]         ;537
000790  f88d0000          STRB     r0,[sp,#0]            ;537
000794  7e38              LDRB     r0,[r7,#0x18]         ;538
000796  f88d0001          STRB     r0,[sp,#1]            ;538
00079a  7b38              LDRB     r0,[r7,#0xc]          ;539
00079c  f88d0002          STRB     r0,[sp,#2]            ;539
0007a0  f88d8003          STRB     r8,[sp,#3]            ;540
0007a4  4669              MOV      r1,sp                 ;541
0007a6  f1050008          ADD      r0,r5,#8              ;541
0007aa  f7fffffe          BL       lc640_write_long_ptr
0007ae  7a38              LDRB     r0,[r7,#8]            ;543
0007b0  f88d0000          STRB     r0,[sp,#0]            ;543
0007b4  7938              LDRB     r0,[r7,#4]            ;544
0007b6  f88d0001          STRB     r0,[sp,#1]            ;544
0007ba  7838              LDRB     r0,[r7,#0]            ;545
0007bc  f88d0002          STRB     r0,[sp,#2]            ;545
0007c0  f88d8003          STRB     r8,[sp,#3]            ;546
0007c4  4669              MOV      r1,sp                 ;547
0007c6  f105000c          ADD      r0,r5,#0xc            ;547
0007ca  f7fffffe          BL       lc640_write_long_ptr
0007ce  f88d4000          STRB     r4,[sp,#0]            ;549
0007d2  f88d4001          STRB     r4,[sp,#1]            ;550
0007d6  f88d4002          STRB     r4,[sp,#2]            ;551
0007da  e000              B        |L1.2014|
                  |L1.2012|
0007dc  e02e              B        |L1.2108|
                  |L1.2014|
0007de  f88d4003          STRB     r4,[sp,#3]            ;552
0007e2  4669              MOV      r1,sp                 ;553
0007e4  f1050010          ADD      r0,r5,#0x10           ;553
0007e8  f7fffffe          BL       lc640_write_long_ptr
0007ec  f88d4000          STRB     r4,[sp,#0]            ;555
0007f0  f88d4001          STRB     r4,[sp,#1]            ;556
0007f4  f88d4002          STRB     r4,[sp,#2]            ;557
0007f8  f88d4003          STRB     r4,[sp,#3]            ;558
0007fc  4669              MOV      r1,sp                 ;559
0007fe  f1050014          ADD      r0,r5,#0x14           ;559
000802  f7fffffe          BL       lc640_write_long_ptr
000806  f88d4000          STRB     r4,[sp,#0]            ;561
00080a  f88d4001          STRB     r4,[sp,#1]            ;562
00080e  f88d4002          STRB     r4,[sp,#2]            ;563
000812  f88d4003          STRB     r4,[sp,#3]            ;564
000816  4669              MOV      r1,sp                 ;565
000818  f1050018          ADD      r0,r5,#0x18           ;565
00081c  f7fffffe          BL       lc640_write_long_ptr
000820  f88d4000          STRB     r4,[sp,#0]            ;567
000824  f88d4001          STRB     r4,[sp,#1]            ;568
000828  f88d4002          STRB     r4,[sp,#2]            ;569
00082c  f88d4003          STRB     r4,[sp,#3]            ;570
000830  4669              MOV      r1,sp                 ;571
000832  f105001c          ADD      r0,r5,#0x1c           ;571
000836  f7fffffe          BL       lc640_write_long_ptr
00083a  e0c7              B        |L1.2508|
                  |L1.2108|
;;;588    	{
;;;589    	uout_av=0;
00083c  f8818000          STRB     r8,[r1,#0]
;;;590    
;;;591      /*
;;;592    	SET_REG(C2GSR,3,24,8);
;;;593    	C2MOD=0;
;;;594    	bOUT_FREE2=1;*/
;;;595    
;;;596    
;;;597    	//C2MOD=0;
;;;598    
;;;599    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;600    
;;;601         //beep_init(0x02L,'O');
;;;602    	//a_.av.bAN=0;
;;;603    //	SET_REG(avar_stat,0,0,1);
;;;604    
;;;605    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;606    	
;;;607    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;608    
;;;609        event_ptr=lc640_read_int(PTR_EVENT_LOG);
000840  4628              MOV      r0,r5
000842  f7fffffe          BL       lc640_read_int
000846  4606              MOV      r6,r0
;;;610    	event_ptr_find=event_ptr;
000848  4634              MOV      r4,r6
                  |L1.2122|
;;;611    avar_uout_hndl_lbl1:
;;;612    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
00084a  eb091544          ADD      r5,r9,r4,LSL #5
;;;613    
;;;614         lc640_read_long_ptr(lc640_adr,data);
00084e  4669              MOV      r1,sp
000850  4628              MOV      r0,r5
000852  f7fffffe          BL       lc640_read_long_ptr
;;;615         
;;;616         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
000856  f89d0000          LDRB     r0,[sp,#0]
00085a  2851              CMP      r0,#0x51
00085c  d106              BNE      |L1.2156|
00085e  f89d0001          LDRB     r0,[sp,#1]
000862  b918              CBNZ     r0,|L1.2156|
000864  f89d0002          LDRB     r0,[sp,#2]
000868  2841              CMP      r0,#0x41
00086a  d04a              BEQ      |L1.2306|
                  |L1.2156|
;;;617         	{        
;;;618         	if(event_ptr_find)event_ptr_find--;
00086c  e040              B        |L1.2288|
00086e  0000              DCW      0x0000
                  |L1.2160|
000870  4d61696e          DCB      "Main power alarm, voltage reduced",0
000874  20706f77
000878  65722061
00087c  6c61726d
000880  2c20766f
000884  6c746167
000888  65207265
00088c  64756365
000890  6400    
000892  00                DCB      0
000893  00                DCB      0
                  |L1.2196|
000894  4d61696e          DCB      "Main power alarm, voltage increased",0
000898  20706f77
00089c  65722061
0008a0  6c61726d
0008a4  2c20766f
0008a8  6c746167
0008ac  6520696e
0008b0  63726561
0008b4  73656400
                  |L1.2232|
                          DCD      ||.data||
                  |L1.2236|
                          DCD      AV_OFF_AVT
                  |L1.2240|
                          DCD      net_Ustore
                  |L1.2244|
0008c4  4d61696e          DCB      "Main power alarm  clear",0
0008c8  20706f77
0008cc  65722061
0008d0  6c61726d
0008d4  2020636c
0008d8  65617200
                  |L1.2268|
                          DCD      0x40024000
                  |L1.2272|
                          DCD      uout_av
                  |L1.2276|
                          DCD      load_U
                  |L1.2280|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2284|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2288|
0008f0  b114              CBZ      r4,|L1.2296|
0008f2  f1a40401          SUB      r4,r4,#1
0008f6  e001              B        |L1.2300|
                  |L1.2296|
;;;619         	else event_ptr_find=63;
0008f8  f04f043f          MOV      r4,#0x3f
                  |L1.2300|
;;;620         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0008fc  42b4              CMP      r4,r6
0008fe  d1a4              BNE      |L1.2122|
000900  e064              B        |L1.2508|
                  |L1.2306|
;;;621         	else goto avar_uout_hndl_lbl1;
;;;622         	}
;;;623         else 
;;;624         	{
;;;625         	lc640_read_long_ptr(lc640_adr+16,data);
000902  4669              MOV      r1,sp
000904  f1050010          ADD      r0,r5,#0x10
000908  f7fffffe          BL       lc640_read_long_ptr
;;;626         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00090c  f89d0000          LDRB     r0,[sp,#0]
000910  2841              CMP      r0,#0x41
000912  d10b              BNE      |L1.2348|
000914  f89d0001          LDRB     r0,[sp,#1]
000918  2841              CMP      r0,#0x41
00091a  d107              BNE      |L1.2348|
00091c  f89d0002          LDRB     r0,[sp,#2]
000920  2841              CMP      r0,#0x41
000922  d103              BNE      |L1.2348|
000924  f89d0003          LDRB     r0,[sp,#3]
000928  2841              CMP      r0,#0x41
00092a  d008              BEQ      |L1.2366|
                  |L1.2348|
;;;627         		{        
;;;628         		if(event_ptr_find)event_ptr_find--;
00092c  b114              CBZ      r4,|L1.2356|
00092e  f1a40401          SUB      r4,r4,#1
000932  e001              B        |L1.2360|
                  |L1.2356|
;;;629             		else event_ptr_find=63;
000934  f04f043f          MOV      r4,#0x3f
                  |L1.2360|
;;;630             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000938  42b4              CMP      r4,r6
00093a  d186              BNE      |L1.2122|
00093c  e046              B        |L1.2508|
                  |L1.2366|
;;;631         		else goto avar_uout_hndl_lbl1;
;;;632         		}
;;;633    
;;;634         	}	
;;;635    	
;;;636    	data[0]=LPC_RTC->YEAR;
00093e  f1070720          ADD      r7,r7,#0x20
000942  8bb8              LDRH     r0,[r7,#0x1c]
000944  f88d0000          STRB     r0,[sp,#0]
;;;637    	data[1]=LPC_RTC->MONTH;
000948  7e38              LDRB     r0,[r7,#0x18]
00094a  f88d0001          STRB     r0,[sp,#1]
;;;638    	data[2]=LPC_RTC->DOM;
00094e  7b38              LDRB     r0,[r7,#0xc]
000950  f88d0002          STRB     r0,[sp,#2]
;;;639    	data[3]=0;
000954  f88d8003          STRB     r8,[sp,#3]
;;;640    	lc640_write_long_ptr(lc640_adr+16,data);
000958  4669              MOV      r1,sp
00095a  f1050010          ADD      r0,r5,#0x10
00095e  f7fffffe          BL       lc640_write_long_ptr
;;;641    
;;;642    	data[0]=LPC_RTC->HOUR;
000962  7a38              LDRB     r0,[r7,#8]
000964  f88d0000          STRB     r0,[sp,#0]
;;;643    	data[1]=LPC_RTC->MIN;
000968  7938              LDRB     r0,[r7,#4]
00096a  f88d0001          STRB     r0,[sp,#1]
;;;644    	data[2]=LPC_RTC->SEC;
00096e  7838              LDRB     r0,[r7,#0]
000970  f88d0002          STRB     r0,[sp,#2]
;;;645    	data[3]=0;
000974  f88d8003          STRB     r8,[sp,#3]
;;;646    	lc640_write_long_ptr(lc640_adr+20,data); 
000978  4669              MOV      r1,sp
00097a  f1050014          ADD      r0,r5,#0x14
00097e  f7fffffe          BL       lc640_write_long_ptr
;;;647    	
;;;648    	data[0]=*((char*)(&net_Ustore));
000982  48ff              LDR      r0,|L1.3456|
000984  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000986  f88d1000          STRB     r1,[sp,#0]
;;;649    	data[1]=*(((char*)(&net_Ustore))+1);
00098a  7840              LDRB     r0,[r0,#1]  ; net_Ustore
00098c  f88d0001          STRB     r0,[sp,#1]
;;;650    	data[2]='B';
000990  f04f0442          MOV      r4,#0x42
000994  f88d4002          STRB     r4,[sp,#2]
;;;651    	data[3]='B';
000998  f88d4003          STRB     r4,[sp,#3]
;;;652    	lc640_write_long_ptr(lc640_adr+24,data);
00099c  4669              MOV      r1,sp
00099e  f1050018          ADD      r0,r5,#0x18
0009a2  f7fffffe          BL       lc640_write_long_ptr
;;;653    	
;;;654    	data[0]='B';
0009a6  f88d4000          STRB     r4,[sp,#0]
;;;655    	data[1]='B';
0009aa  f88d4001          STRB     r4,[sp,#1]
;;;656    	data[2]='B';
0009ae  f88d4002          STRB     r4,[sp,#2]
;;;657    	data[3]='B';
0009b2  f88d4003          STRB     r4,[sp,#3]
;;;658    	lc640_write_long_ptr(lc640_adr+28,data);	
0009b6  4669              MOV      r1,sp
0009b8  f105001c          ADD      r0,r5,#0x1c
0009bc  f7fffffe          BL       lc640_write_long_ptr
;;;659    	
;;;660    /*	memo_out0[0]=0x55;
;;;661         memo_out0[1]=0x00+2;
;;;662         memo_out0[2]=1;
;;;663         memo_out0[3]=0x0b;
;;;664         memo_out0[4]=0xaa;
;;;665         memo_out0[5]=0xaa; 
;;;666         	
;;;667         memo_out0[6]=crc_87(memo_out0,6);
;;;668    	memo_out0[7]=crc_95(memo_out0,6);
;;;669         usart_out_adr0(memo_out0,8); */
;;;670         snmp_trap_send("Main power is on",2,1,1);	
0009c0  2301              MOVS     r3,#1
0009c2  461a              MOV      r2,r3
0009c4  2102              MOVS     r1,#2
0009c6  a0ef              ADR      r0,|L1.3460|
0009c8  f7fffffe          BL       snmp_trap_send
                  |L1.2508|
;;;671    	}
;;;672    avar_unet_hndl_end:
;;;673    	__nop();		
0009cc  bf00              NOP      
                  |L1.2510|
;;;674    }
0009ce  e677              B        |L1.1728|
;;;675    
                          ENDP

                  avar_bps_hndl PROC
;;;676    //-----------------------------------------------
;;;677    void avar_bps_hndl(char dev, char v, char in)
0009d0  e92d4ff8          PUSH     {r3-r11,lr}
;;;678    {
0009d4  4606              MOV      r6,r0
0009d6  460c              MOV      r4,r1
;;;679    char data[4];
;;;680    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;681    char avar_simbol;
;;;682    
;;;683    avar_simbol='T';
0009d8  f04f0754          MOV      r7,#0x54
;;;684    if(v==0)avar_simbol='T';
0009dc  b174              CBZ      r4,|L1.2556|
;;;685    else if(v==1)avar_simbol='U';
0009de  2c01              CMP      r4,#1
0009e0  d004              BEQ      |L1.2540|
;;;686    else if(v==2)avar_simbol='u';
0009e2  2c02              CMP      r4,#2
0009e4  d005              BEQ      |L1.2546|
;;;687    else if(v==3)avar_simbol='L';
0009e6  2c03              CMP      r4,#3
0009e8  d006              BEQ      |L1.2552|
0009ea  e007              B        |L1.2556|
                  |L1.2540|
0009ec  f04f0755          MOV      r7,#0x55              ;685
0009f0  e004              B        |L1.2556|
                  |L1.2546|
0009f2  f04f0775          MOV      r7,#0x75              ;686
0009f6  e001              B        |L1.2556|
                  |L1.2552|
0009f8  f04f074c          MOV      r7,#0x4c
                  |L1.2556|
;;;688    
;;;689    if(in==1)
;;;690    	{
;;;691    	//av_src[bps]=1;
;;;692    
;;;693    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;694    //	SET_REG(avar_stat,1,3+dev,1);
;;;695    	
;;;696    	if(v==0)bps[dev]._av|=(1<<0);
0009fc  48e7              LDR      r0,|L1.3484|
0009fe  eb0601c6          ADD      r1,r6,r6,LSL #3
;;;697    	else if(v==1) bps[dev]._av|=(1<<1);
;;;698    	else if(v==2) bps[dev]._av|=(1<<2);
;;;699    	else if(v==3) bps[dev]._av|=(1<<3);
;;;700    
;;;701    	bps[dev]._last_avar=v;
;;;702    
;;;703    	//beep_init(0x33333333,'A');
;;;704    
;;;705    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;706    	event_ptr++;	
;;;707    	if(event_ptr>63)event_ptr=0;	
;;;708    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;709    	
;;;710        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;711    	if(event_cnt!=63)event_cnt=event_ptr;
;;;712    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;713    	
;;;714    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;715    	
;;;716    	data[0]='S';
;;;717    	data[1]=dev; 
;;;718    	data[2]=avar_simbol;
;;;719    	data[3]=0;
;;;720    	lc640_write_long_ptr(lc640_adr,data);
;;;721    
;;;722    	data[0]=0;
;;;723    	data[1]=0;
;;;724    	data[2]=0;
;;;725    	data[3]=0;
;;;726    	lc640_write_long_ptr(lc640_adr+4,data);
;;;727    
;;;728    	data[0]=LPC_RTC->YEAR;
000a02  f8df8394          LDR      r8,|L1.3480|
000a06  eb011106          ADD      r1,r1,r6,LSL #4       ;696
000a0a  f04f0900          MOV      r9,#0                 ;678
000a0e  f44f6a60          MOV      r10,#0xe00            ;705
000a12  f44f6580          MOV      r5,#0x400             ;714
000a16  eb000081          ADD      r0,r0,r1,LSL #2       ;696
000a1a  2a01              CMP      r2,#1                 ;689
000a1c  d002              BEQ      |L1.2596|
;;;729    	data[1]=LPC_RTC->MONTH;
;;;730    	data[2]=LPC_RTC->DOM;
;;;731    	data[3]=0;
;;;732    	lc640_write_long_ptr(lc640_adr+8,data);
;;;733    
;;;734    	data[0]=LPC_RTC->HOUR;
;;;735    	data[1]=LPC_RTC->MIN;
;;;736    	data[2]=LPC_RTC->SEC;
;;;737    	data[3]=0;
;;;738    	lc640_write_long_ptr(lc640_adr+12,data);
;;;739    	
;;;740    	data[0]='A';
;;;741    	data[1]='A';
;;;742    	data[2]='A';
;;;743    	data[3]='A';
;;;744    	lc640_write_long_ptr(lc640_adr+16,data);
;;;745    	
;;;746    	data[0]='A';
;;;747    	data[1]='A';
;;;748    	data[2]='A';
;;;749    	data[3]='A';
;;;750    	lc640_write_long_ptr(lc640_adr+20,data);
;;;751    	
;;;752    	data[0]='A';
;;;753    	data[1]='A';
;;;754    	data[2]='A';
;;;755    	data[3]='A';
;;;756    	lc640_write_long_ptr(lc640_adr+24,data);
;;;757    	
;;;758    	data[0]='A';
;;;759    	data[1]='A';
;;;760    	data[2]='A';
;;;761    	data[3]='A';
;;;762    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;763    
;;;764    
;;;765    	if(dev==0)
;;;766    		{
;;;767    		if(v==0)
;;;768    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;769    		else if(v==1)
;;;770    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;771    		else if(v==2)
;;;772    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;773    		else if(v==3)
;;;774    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;775    		}
;;;776    	else if(dev==1)
;;;777    		{
;;;778    		if(v==0)
;;;779    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;780    		else if(v==1)
;;;781    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;782    		else if(v==2)
;;;783    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;784    		else if(v==3)
;;;785    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;786    		} 
;;;787    	else if(dev==2)
;;;788    		{
;;;789    		if(v==0)
;;;790    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;791    		else if(v==1)
;;;792    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;793    		else if(v==2)
;;;794    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;795    		else if(v==3)
;;;796    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;797    		} 	
;;;798    			
;;;799    	}
;;;800    
;;;801    else if(in==0)
000a1e  2a00              CMP      r2,#0
000a20  d07e              BEQ      |L1.2848|
000a22  e283              B        |L1.3884|
                  |L1.2596|
000a24  b134              CBZ      r4,|L1.2612|
000a26  2c01              CMP      r4,#1                 ;697
000a28  d009              BEQ      |L1.2622|
000a2a  2c02              CMP      r4,#2                 ;698
000a2c  d00c              BEQ      |L1.2632|
000a2e  2c03              CMP      r4,#3                 ;699
000a30  d00f              BEQ      |L1.2642|
000a32  e012              B        |L1.2650|
                  |L1.2612|
000a34  7841              LDRB     r1,[r0,#1]            ;696
000a36  f0410101          ORR      r1,r1,#1              ;696
000a3a  7041              STRB     r1,[r0,#1]            ;696
000a3c  e00d              B        |L1.2650|
                  |L1.2622|
000a3e  7841              LDRB     r1,[r0,#1]            ;697
000a40  f0410102          ORR      r1,r1,#2              ;697
000a44  7041              STRB     r1,[r0,#1]            ;697
000a46  e008              B        |L1.2650|
                  |L1.2632|
000a48  7841              LDRB     r1,[r0,#1]            ;698
000a4a  f0410104          ORR      r1,r1,#4              ;698
000a4e  7041              STRB     r1,[r0,#1]            ;698
000a50  e003              B        |L1.2650|
                  |L1.2642|
000a52  7841              LDRB     r1,[r0,#1]            ;699
000a54  f0410108          ORR      r1,r1,#8              ;699
000a58  7041              STRB     r1,[r0,#1]            ;699
                  |L1.2650|
000a5a  f8804057          STRB     r4,[r0,#0x57]         ;701
000a5e  4650              MOV      r0,r10                ;705
000a60  f7fffffe          BL       lc640_read_int
000a64  f1000001          ADD      r0,r0,#1              ;706
000a68  fa1ffb80          UXTH     r11,r0                ;706
000a6c  f1bb0f3f          CMP      r11,#0x3f             ;707
000a70  d901              BLS      |L1.2678|
000a72  f04f0b00          MOV      r11,#0                ;707
                  |L1.2678|
000a76  fa0ff18b          SXTH     r1,r11                ;708
000a7a  4650              MOV      r0,r10                ;708
000a7c  f7fffffe          BL       lc640_write_int
000a80  f6406002          MOV      r0,#0xe02             ;710
000a84  f7fffffe          BL       lc640_read_int
000a88  b280              UXTH     r0,r0                 ;710
000a8a  283f              CMP      r0,#0x3f              ;711
000a8c  d000              BEQ      |L1.2704|
000a8e  4658              MOV      r0,r11                ;711
                  |L1.2704|
000a90  b201              SXTH     r1,r0                 ;712
000a92  f6406002          MOV      r0,#0xe02             ;712
000a96  f7fffffe          BL       lc640_write_int
000a9a  4650              MOV      r0,r10                ;714
000a9c  f7fffffe          BL       lc640_read_int
000aa0  eb051040          ADD      r0,r5,r0,LSL #5       ;714
000aa4  b285              UXTH     r5,r0                 ;714
000aa6  f04f0053          MOV      r0,#0x53              ;716
000aaa  f88d0000          STRB     r0,[sp,#0]            ;716
000aae  f88d6001          STRB     r6,[sp,#1]            ;717
000ab2  f88d7002          STRB     r7,[sp,#2]            ;718
000ab6  f88d9003          STRB     r9,[sp,#3]            ;719
000aba  4669              MOV      r1,sp                 ;720
000abc  4628              MOV      r0,r5                 ;720
000abe  f7fffffe          BL       lc640_write_long_ptr
000ac2  f8cd9000          STR      r9,[sp,#0]            ;725
000ac6  4669              MOV      r1,sp                 ;726
000ac8  1d28              ADDS     r0,r5,#4              ;726
000aca  f7fffffe          BL       lc640_write_long_ptr
000ace  f8b8003c          LDRH     r0,[r8,#0x3c]         ;728
000ad2  f88d0000          STRB     r0,[sp,#0]            ;728
000ad6  f8980038          LDRB     r0,[r8,#0x38]         ;729
000ada  f88d0001          STRB     r0,[sp,#1]            ;729
000ade  f898002c          LDRB     r0,[r8,#0x2c]         ;730
000ae2  f88d0002          STRB     r0,[sp,#2]            ;730
000ae6  f88d9003          STRB     r9,[sp,#3]            ;731
000aea  4669              MOV      r1,sp                 ;732
000aec  f1050008          ADD      r0,r5,#8              ;732
000af0  f7fffffe          BL       lc640_write_long_ptr
000af4  f8980028          LDRB     r0,[r8,#0x28]         ;734
000af8  f88d0000          STRB     r0,[sp,#0]            ;734
000afc  f8980024          LDRB     r0,[r8,#0x24]         ;735
000b00  f88d0001          STRB     r0,[sp,#1]            ;735
000b04  f8980020          LDRB     r0,[r8,#0x20]         ;736
000b08  f88d0002          STRB     r0,[sp,#2]            ;736
000b0c  f88d9003          STRB     r9,[sp,#3]            ;737
000b10  4669              MOV      r1,sp                 ;738
000b12  f105000c          ADD      r0,r5,#0xc            ;738
000b16  f7fffffe          BL       lc640_write_long_ptr
000b1a  f04f0741          MOV      r7,#0x41              ;740
000b1e  e000              B        |L1.2850|
                  |L1.2848|
000b20  e0a5              B        |L1.3182|
                  |L1.2850|
000b22  f88d7000          STRB     r7,[sp,#0]            ;740
000b26  f88d7001          STRB     r7,[sp,#1]            ;741
000b2a  f88d7002          STRB     r7,[sp,#2]            ;742
000b2e  f88d7003          STRB     r7,[sp,#3]            ;743
000b32  4669              MOV      r1,sp                 ;744
000b34  f1050010          ADD      r0,r5,#0x10           ;744
000b38  f7fffffe          BL       lc640_write_long_ptr
000b3c  f88d7000          STRB     r7,[sp,#0]            ;746
000b40  f88d7001          STRB     r7,[sp,#1]            ;747
000b44  f88d7002          STRB     r7,[sp,#2]            ;748
000b48  f88d7003          STRB     r7,[sp,#3]            ;749
000b4c  4669              MOV      r1,sp                 ;750
000b4e  f1050014          ADD      r0,r5,#0x14           ;750
000b52  f7fffffe          BL       lc640_write_long_ptr
000b56  f88d7000          STRB     r7,[sp,#0]            ;752
000b5a  f88d7001          STRB     r7,[sp,#1]            ;753
000b5e  f88d7002          STRB     r7,[sp,#2]            ;754
000b62  f88d7003          STRB     r7,[sp,#3]            ;755
000b66  4669              MOV      r1,sp                 ;756
000b68  f1050018          ADD      r0,r5,#0x18           ;756
000b6c  f7fffffe          BL       lc640_write_long_ptr
000b70  f88d7000          STRB     r7,[sp,#0]            ;758
000b74  f88d7001          STRB     r7,[sp,#1]            ;759
000b78  f88d7002          STRB     r7,[sp,#2]            ;760
000b7c  f88d7003          STRB     r7,[sp,#3]            ;761
000b80  4669              MOV      r1,sp                 ;762
000b82  f105001c          ADD      r0,r5,#0x1c           ;762
000b86  f7fffffe          BL       lc640_write_long_ptr
000b8a  b126              CBZ      r6,|L1.2966|
000b8c  2e01              CMP      r6,#1                 ;776
000b8e  d026              BEQ      |L1.3038|
000b90  2e02              CMP      r6,#2                 ;787
000b92  d048              BEQ      |L1.3110|
000b94  e1ca              B        |L1.3884|
                  |L1.2966|
000b96  b134              CBZ      r4,|L1.2982|
000b98  2c01              CMP      r4,#1                 ;769
000b9a  d00b              BEQ      |L1.2996|
000b9c  2c02              CMP      r4,#2                 ;771
000b9e  d010              BEQ      |L1.3010|
000ba0  2c03              CMP      r4,#3                 ;773
000ba2  d015              BEQ      |L1.3024|
000ba4  e1c2              B        |L1.3884|
                  |L1.2982|
000ba6  2300              MOVS     r3,#0                 ;768
000ba8  2201              MOVS     r2,#1                 ;768
000baa  2104              MOVS     r1,#4                 ;768
000bac  a07c              ADR      r0,|L1.3488|
000bae  f7fffffe          BL       snmp_trap_send
000bb2  e1bb              B        |L1.3884|
                  |L1.2996|
000bb4  2301              MOVS     r3,#1                 ;770
000bb6  461a              MOV      r2,r3                 ;770
000bb8  2104              MOVS     r1,#4                 ;770
000bba  a07f              ADR      r0,|L1.3512|
000bbc  f7fffffe          BL       snmp_trap_send
000bc0  e1b4              B        |L1.3884|
                  |L1.3010|
000bc2  2302              MOVS     r3,#2                 ;772
000bc4  2201              MOVS     r2,#1                 ;772
000bc6  2104              MOVS     r1,#4                 ;772
000bc8  a082              ADR      r0,|L1.3540|
000bca  f7fffffe          BL       snmp_trap_send
000bce  e1ad              B        |L1.3884|
                  |L1.3024|
000bd0  2303              MOVS     r3,#3                 ;774
000bd2  2201              MOVS     r2,#1                 ;774
000bd4  2104              MOVS     r1,#4                 ;774
000bd6  a087              ADR      r0,|L1.3572|
000bd8  f7fffffe          BL       snmp_trap_send
000bdc  e1a6              B        |L1.3884|
                  |L1.3038|
000bde  b134              CBZ      r4,|L1.3054|
000be0  2c01              CMP      r4,#1                 ;780
000be2  d00b              BEQ      |L1.3068|
000be4  2c02              CMP      r4,#2                 ;782
000be6  d010              BEQ      |L1.3082|
000be8  2c03              CMP      r4,#3                 ;784
000bea  d015              BEQ      |L1.3096|
000bec  e19e              B        |L1.3884|
                  |L1.3054|
000bee  2300              MOVS     r3,#0                 ;779
000bf0  2202              MOVS     r2,#2                 ;779
000bf2  2104              MOVS     r1,#4                 ;779
000bf4  a087              ADR      r0,|L1.3604|
000bf6  f7fffffe          BL       snmp_trap_send
000bfa  e197              B        |L1.3884|
                  |L1.3068|
000bfc  2301              MOVS     r3,#1                 ;781
000bfe  2202              MOVS     r2,#2                 ;781
000c00  2104              MOVS     r1,#4                 ;781
000c02  a08a              ADR      r0,|L1.3628|
000c04  f7fffffe          BL       snmp_trap_send
000c08  e190              B        |L1.3884|
                  |L1.3082|
000c0a  2302              MOVS     r3,#2                 ;783
000c0c  461a              MOV      r2,r3                 ;783
000c0e  2104              MOVS     r1,#4                 ;783
000c10  a08d              ADR      r0,|L1.3656|
000c12  f7fffffe          BL       snmp_trap_send
000c16  e189              B        |L1.3884|
                  |L1.3096|
000c18  2303              MOVS     r3,#3                 ;785
000c1a  2202              MOVS     r2,#2                 ;785
000c1c  2104              MOVS     r1,#4                 ;785
000c1e  a092              ADR      r0,|L1.3688|
000c20  f7fffffe          BL       snmp_trap_send
000c24  e182              B        |L1.3884|
                  |L1.3110|
000c26  b134              CBZ      r4,|L1.3126|
000c28  2c01              CMP      r4,#1                 ;791
000c2a  d00b              BEQ      |L1.3140|
000c2c  2c02              CMP      r4,#2                 ;793
000c2e  d010              BEQ      |L1.3154|
000c30  2c03              CMP      r4,#3                 ;795
000c32  d015              BEQ      |L1.3168|
000c34  e17a              B        |L1.3884|
                  |L1.3126|
000c36  2300              MOVS     r3,#0                 ;790
000c38  2203              MOVS     r2,#3                 ;790
000c3a  2104              MOVS     r1,#4                 ;790
000c3c  a092              ADR      r0,|L1.3720|
000c3e  f7fffffe          BL       snmp_trap_send
000c42  e173              B        |L1.3884|
                  |L1.3140|
000c44  2301              MOVS     r3,#1                 ;792
000c46  2203              MOVS     r2,#3                 ;792
000c48  2104              MOVS     r1,#4                 ;792
000c4a  a095              ADR      r0,|L1.3744|
000c4c  f7fffffe          BL       snmp_trap_send
000c50  e16c              B        |L1.3884|
                  |L1.3154|
000c52  2302              MOVS     r3,#2                 ;794
000c54  2203              MOVS     r2,#3                 ;794
000c56  2104              MOVS     r1,#4                 ;794
000c58  a098              ADR      r0,|L1.3772|
000c5a  f7fffffe          BL       snmp_trap_send
000c5e  e165              B        |L1.3884|
                  |L1.3168|
000c60  2303              MOVS     r3,#3                 ;796
000c62  461a              MOV      r2,r3                 ;796
000c64  2104              MOVS     r1,#4                 ;796
000c66  a09d              ADR      r0,|L1.3804|
000c68  f7fffffe          BL       snmp_trap_send
000c6c  e15e              B        |L1.3884|
                  |L1.3182|
;;;802    	{      
;;;803    //	av_bps[bps]=0;
;;;804    
;;;805    	//SET_REG(avar_stat,0,3+bps,1);
;;;806    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;807    
;;;808         if(v==0) bps[dev]._av&=(~(1<<0));
000c6e  b134              CBZ      r4,|L1.3198|
;;;809         else if(v==1) bps[dev]._av&=(~(1<<1));
000c70  2c01              CMP      r4,#1
000c72  d009              BEQ      |L1.3208|
;;;810    	else if(v==2) bps[dev]._av&=(~(1<<2));
000c74  2c02              CMP      r4,#2
000c76  d00c              BEQ      |L1.3218|
;;;811    	else if(v==3) bps[dev]._av&=(~(1<<3));
000c78  2c03              CMP      r4,#3
000c7a  d00f              BEQ      |L1.3228|
000c7c  e012              B        |L1.3236|
                  |L1.3198|
000c7e  7841              LDRB     r1,[r0,#1]            ;808
000c80  f0210101          BIC      r1,r1,#1              ;808
000c84  7041              STRB     r1,[r0,#1]            ;808
000c86  e00d              B        |L1.3236|
                  |L1.3208|
000c88  7841              LDRB     r1,[r0,#1]            ;809
000c8a  f0210102          BIC      r1,r1,#2              ;809
000c8e  7041              STRB     r1,[r0,#1]            ;809
000c90  e008              B        |L1.3236|
                  |L1.3218|
000c92  7841              LDRB     r1,[r0,#1]            ;810
000c94  f0210104          BIC      r1,r1,#4              ;810
000c98  7041              STRB     r1,[r0,#1]            ;810
000c9a  e003              B        |L1.3236|
                  |L1.3228|
000c9c  7841              LDRB     r1,[r0,#1]
000c9e  f0210108          BIC      r1,r1,#8
000ca2  7041              STRB     r1,[r0,#1]
                  |L1.3236|
;;;812         
;;;813    //	if((bps[dev]._av&0x0f==0))
;;;814    //	     {
;;;815    		//SET_REG(avar_stat,0,3+bps,1);
;;;816    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;817    //	     }
;;;818     
;;;819    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000ca4  4650              MOV      r0,r10
000ca6  f7fffffe          BL       lc640_read_int
000caa  fa1ffb80          UXTH     r11,r0
;;;820    	event_ptr_find=event_ptr;
000cae  465c              MOV      r4,r11
                  |L1.3248|
;;;821    	
;;;822    avar_src_hndl_lbl1: 
;;;823    
;;;824    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000cb0  eb051044          ADD      r0,r5,r4,LSL #5
000cb4  fa1ffa80          UXTH     r10,r0
;;;825    
;;;826         lc640_read_long_ptr(lc640_adr,data);
000cb8  4669              MOV      r1,sp
000cba  4650              MOV      r0,r10
000cbc  f7fffffe          BL       lc640_read_long_ptr
;;;827         
;;;828         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000cc0  f89d0000          LDRB     r0,[sp,#0]
000cc4  2853              CMP      r0,#0x53
000cc6  d107              BNE      |L1.3288|
000cc8  f89d0001          LDRB     r0,[sp,#1]
000ccc  42b0              CMP      r0,r6
000cce  d103              BNE      |L1.3288|
000cd0  f89d0002          LDRB     r0,[sp,#2]
000cd4  42b8              CMP      r0,r7
000cd6  d009              BEQ      |L1.3308|
                  |L1.3288|
;;;829         	{        
;;;830         	if(event_ptr_find)event_ptr_find--;
000cd8  b11c              CBZ      r4,|L1.3298|
000cda  f1a40401          SUB      r4,r4,#1
000cde  b2a4              UXTH     r4,r4
000ce0  e001              B        |L1.3302|
                  |L1.3298|
;;;831         	else event_ptr_find=63;
000ce2  f04f043f          MOV      r4,#0x3f
                  |L1.3302|
;;;832         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000ce6  455c              CMP      r4,r11
000ce8  d1e2              BNE      |L1.3248|
000cea  e11f              B        |L1.3884|
                  |L1.3308|
;;;833         	else goto avar_src_hndl_lbl1;
;;;834         	}
;;;835         else 
;;;836         	{
;;;837         	lc640_read_long_ptr(lc640_adr+16,data);
000cec  4669              MOV      r1,sp
000cee  f10a0010          ADD      r0,r10,#0x10
000cf2  f7fffffe          BL       lc640_read_long_ptr
;;;838         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000cf6  f89d0000          LDRB     r0,[sp,#0]
000cfa  2841              CMP      r0,#0x41
000cfc  d10b              BNE      |L1.3350|
000cfe  f89d0001          LDRB     r0,[sp,#1]
000d02  2841              CMP      r0,#0x41
000d04  d107              BNE      |L1.3350|
000d06  f89d0002          LDRB     r0,[sp,#2]
000d0a  2841              CMP      r0,#0x41
000d0c  d103              BNE      |L1.3350|
000d0e  f89d0003          LDRB     r0,[sp,#3]
000d12  2841              CMP      r0,#0x41
000d14  d009              BEQ      |L1.3370|
                  |L1.3350|
;;;839         		{        
;;;840         		if(event_ptr_find)event_ptr_find--;
000d16  b11c              CBZ      r4,|L1.3360|
000d18  f1a40401          SUB      r4,r4,#1
000d1c  b2a4              UXTH     r4,r4
000d1e  e001              B        |L1.3364|
                  |L1.3360|
;;;841             		else event_ptr_find=63;
000d20  f04f043f          MOV      r4,#0x3f
                  |L1.3364|
;;;842             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000d24  455c              CMP      r4,r11
000d26  d1c3              BNE      |L1.3248|
000d28  e100              B        |L1.3884|
                  |L1.3370|
;;;843         		else goto avar_src_hndl_lbl1;
;;;844         		}
;;;845    
;;;846         	}	
;;;847    
;;;848    
;;;849    	
;;;850    	data[0]=LPC_RTC->YEAR;
000d2a  f8b8003c          LDRH     r0,[r8,#0x3c]
000d2e  f88d0000          STRB     r0,[sp,#0]
;;;851    	data[1]=LPC_RTC->MONTH;
000d32  f8980038          LDRB     r0,[r8,#0x38]
000d36  f88d0001          STRB     r0,[sp,#1]
;;;852    	data[2]=LPC_RTC->DOM;
000d3a  f898002c          LDRB     r0,[r8,#0x2c]
000d3e  f88d0002          STRB     r0,[sp,#2]
;;;853    	data[3]=0;
000d42  f88d9003          STRB     r9,[sp,#3]
;;;854    	lc640_write_long_ptr(lc640_adr+16,data);
000d46  4669              MOV      r1,sp
000d48  f10a0010          ADD      r0,r10,#0x10
000d4c  f7fffffe          BL       lc640_write_long_ptr
;;;855    
;;;856    	data[0]=LPC_RTC->HOUR;
000d50  f8980028          LDRB     r0,[r8,#0x28]
000d54  f88d0000          STRB     r0,[sp,#0]
;;;857    	data[1]=LPC_RTC->MIN;
000d58  f8980024          LDRB     r0,[r8,#0x24]
000d5c  f88d0001          STRB     r0,[sp,#1]
;;;858    	data[2]=LPC_RTC->SEC;
000d60  f8980020          LDRB     r0,[r8,#0x20]
000d64  f88d0002          STRB     r0,[sp,#2]
;;;859    	data[3]=0;
000d68  f88d9003          STRB     r9,[sp,#3]
;;;860    	lc640_write_long_ptr(lc640_adr+20,data);
000d6c  4669              MOV      r1,sp
000d6e  f10a0014          ADD      r0,r10,#0x14
000d72  f7fffffe          BL       lc640_write_long_ptr
;;;861    	
;;;862    	data[0]='B';
000d76  f04f0442          MOV      r4,#0x42
000d7a  f88d4000          STRB     r4,[sp,#0]
;;;863    	data[1]='B';
000d7e  e0bd              B        |L1.3836|
                  |L1.3456|
                          DCD      net_Ustore
                  |L1.3460|
000d84  4d61696e          DCB      "Main power is on",0
000d88  20706f77
000d8c  65722069
000d90  73206f6e
000d94  00      
000d95  00                DCB      0
000d96  00                DCB      0
000d97  00                DCB      0
                  |L1.3480|
                          DCD      0x40024000
                  |L1.3484|
                          DCD      bps
                  |L1.3488|
000da0  42505320          DCB      "BPS #1 Alarm, overheat",0
000da4  23312041
000da8  6c61726d
000dac  2c206f76
000db0  65726865
000db4  617400  
000db7  00                DCB      0
                  |L1.3512|
000db8  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000dbc  23312041
000dc0  6c61726d
000dc4  2c20766f
000dc8  6c746167
000dcc  65206973
000dd0  20757000
                  |L1.3540|
000dd4  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000dd8  23312041
000ddc  6c61726d
000de0  2c20766f
000de4  6c746167
000de8  65206973
000dec  20646f77
000df0  6e00    
000df2  00                DCB      0
000df3  00                DCB      0
                  |L1.3572|
000df4  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000df8  23312041
000dfc  6c61726d
000e00  2c20636f
000e04  6e6e6563
000e08  74206973
000e0c  206c6f73
000e10  7400    
000e12  00                DCB      0
000e13  00                DCB      0
                  |L1.3604|
000e14  42505320          DCB      "BPS #2 Alarm, overheat",0
000e18  23322041
000e1c  6c61726d
000e20  2c206f76
000e24  65726865
000e28  617400  
000e2b  00                DCB      0
                  |L1.3628|
000e2c  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000e30  23322041
000e34  6c61726d
000e38  2c20766f
000e3c  6c746167
000e40  65206973
000e44  20757000
                  |L1.3656|
000e48  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000e4c  23322041
000e50  6c61726d
000e54  2c20766f
000e58  6c746167
000e5c  65206973
000e60  20646f77
000e64  6e00    
000e66  00                DCB      0
000e67  00                DCB      0
                  |L1.3688|
000e68  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000e6c  23322041
000e70  6c61726d
000e74  2c20636f
000e78  6e6e6563
000e7c  74206973
000e80  206c6f73
000e84  7400    
000e86  00                DCB      0
000e87  00                DCB      0
                  |L1.3720|
000e88  42505320          DCB      "BPS #3 Alarm, overheat",0
000e8c  23332041
000e90  6c61726d
000e94  2c206f76
000e98  65726865
000e9c  617400  
000e9f  00                DCB      0
                  |L1.3744|
000ea0  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000ea4  23332041
000ea8  6c61726d
000eac  2c20766f
000eb0  6c746167
000eb4  65206973
000eb8  20757000
                  |L1.3772|
000ebc  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000ec0  23332041
000ec4  6c61726d
000ec8  2c20766f
000ecc  6c746167
000ed0  65206973
000ed4  20646f77
000ed8  6e00    
000eda  00                DCB      0
000edb  00                DCB      0
                  |L1.3804|
000edc  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000ee0  23332041
000ee4  6c61726d
000ee8  2c20636f
000eec  6e6e6563
000ef0  74206973
000ef4  206c6f73
000ef8  7400    
000efa  00                DCB      0
000efb  00                DCB      0
                  |L1.3836|
000efc  f88d4001          STRB     r4,[sp,#1]
;;;864    	data[2]='B';
000f00  f88d4002          STRB     r4,[sp,#2]
;;;865    	data[3]='B';
000f04  f88d4003          STRB     r4,[sp,#3]
;;;866    	lc640_write_long_ptr(lc640_adr+24,data);
000f08  4669              MOV      r1,sp
000f0a  f10a0018          ADD      r0,r10,#0x18
000f0e  f7fffffe          BL       lc640_write_long_ptr
;;;867    	
;;;868    	data[0]='B';
000f12  f88d4000          STRB     r4,[sp,#0]
;;;869    	data[1]='B';
000f16  f88d4001          STRB     r4,[sp,#1]
;;;870    	data[2]='B';
000f1a  f88d4002          STRB     r4,[sp,#2]
;;;871    	data[3]='B';
000f1e  f88d4003          STRB     r4,[sp,#3]
;;;872    	lc640_write_long_ptr(lc640_adr+28,data);
000f22  4669              MOV      r1,sp
000f24  f10a001c          ADD      r0,r10,#0x1c
000f28  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3884|
;;;873    	
;;;874    	}
;;;875    	
;;;876    avar_src_hndl_end:
;;;877    __nop();		
000f2c  bf00              NOP      
                  |L1.3886|
;;;878    }
000f2e  e54e              B        |L1.2510|
;;;879    
                          ENDP

                  wrk_mem_hndl PROC
;;;880    //-----------------------------------------------
;;;881    void wrk_mem_hndl(char b)
000f30  e92d41fc          PUSH     {r2-r8,lr}
;;;882    {
000f34  4606              MOV      r6,r0
;;;883    char data[4];
;;;884    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;885    
;;;886    signed short temp_temp;
;;;887    
;;;888    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000f36  eb060046          ADD      r0,r6,r6,LSL #1
000f3a  eb001106          ADD      r1,r0,r6,LSL #4
000f3e  48ff              LDR      r0,|L1.4924|
000f40  eb000481          ADD      r4,r0,r1,LSL #2
000f44  8be0              LDRH     r0,[r4,#0x1e]
000f46  2805              CMP      r0,#5
000f48  d37e              BCC      |L1.4168|
;;;889    
;;;890    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000f4a  48fd              LDR      r0,|L1.4928|
000f4c  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000f4e  f1000006          ADD      r0,r0,#6
000f52  f0000007          AND      r0,r0,#7
000f56  eb040040          ADD      r0,r4,r0,LSL #1
000f5a  8c00              LDRH     r0,[r0,#0x20]
000f5c  9000              STR      r0,[sp,#0]
;;;891    
;;;892    
;;;893    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000f5e  f44f6760          MOV      r7,#0xe00
000f62  4638              MOV      r0,r7
000f64  f7fffffe          BL       lc640_read_int
;;;894    event_ptr++;	
000f68  f1000001          ADD      r0,r0,#1
000f6c  b285              UXTH     r5,r0
;;;895    if(event_ptr>63)event_ptr=0;	
000f6e  2d3f              CMP      r5,#0x3f
000f70  d901              BLS      |L1.3958|
000f72  f04f0500          MOV      r5,#0
                  |L1.3958|
;;;896    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000f76  b229              SXTH     r1,r5
000f78  4638              MOV      r0,r7
000f7a  f7fffffe          BL       lc640_write_int
;;;897    	
;;;898    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000f7e  f6406802          MOV      r8,#0xe02
000f82  4640              MOV      r0,r8
000f84  f7fffffe          BL       lc640_read_int
000f88  b280              UXTH     r0,r0
;;;899    if(event_cnt!=63)event_cnt=event_ptr;
000f8a  283f              CMP      r0,#0x3f
000f8c  d000              BEQ      |L1.3984|
000f8e  4628              MOV      r0,r5
                  |L1.3984|
;;;900    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000f90  b201              SXTH     r1,r0
000f92  4640              MOV      r0,r8
000f94  f7fffffe          BL       lc640_write_int
;;;901    	
;;;902    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000f98  4638              MOV      r0,r7
000f9a  f7fffffe          BL       lc640_read_int
000f9e  f44f6180          MOV      r1,#0x400
000fa2  eb011040          ADD      r0,r1,r0,LSL #5
000fa6  b285              UXTH     r5,r0
;;;903    	
;;;904    data[0]='B';
000fa8  f04f0042          MOV      r0,#0x42
000fac  f88d0004          STRB     r0,[sp,#4]
;;;905    data[1]=b; 
000fb0  f88d6005          STRB     r6,[sp,#5]
;;;906    data[2]='W';
000fb4  f04f0057          MOV      r0,#0x57
000fb8  f88d0006          STRB     r0,[sp,#6]
;;;907    data[3]=0;
000fbc  f04f0600          MOV      r6,#0
000fc0  f88d6007          STRB     r6,[sp,#7]
;;;908    
;;;909    lc640_write_long_ptr(lc640_adr,data);
000fc4  a901              ADD      r1,sp,#4
000fc6  4628              MOV      r0,r5
000fc8  f7fffffe          BL       lc640_write_long_ptr
;;;910    
;;;911    data[0]=*((char*)&bat[b]._Iintegr_);
000fcc  7fa0              LDRB     r0,[r4,#0x1e]
000fce  f88d0004          STRB     r0,[sp,#4]
;;;912    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000fd2  7fe0              LDRB     r0,[r4,#0x1f]
000fd4  f88d0005          STRB     r0,[sp,#5]
;;;913    data[2]=*((char*)&temp_temp);
000fd8  f89d0000          LDRB     r0,[sp,#0]
000fdc  f88d0006          STRB     r0,[sp,#6]
;;;914    data[3]=*(((char*)(&temp_temp))+1);
000fe0  f89d0001          LDRB     r0,[sp,#1]
000fe4  f88d0007          STRB     r0,[sp,#7]
;;;915    lc640_write_long_ptr(lc640_adr+4,data);
000fe8  a901              ADD      r1,sp,#4
000fea  1d28              ADDS     r0,r5,#4
000fec  f7fffffe          BL       lc640_write_long_ptr
;;;916    
;;;917    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000ff0  f1040134          ADD      r1,r4,#0x34
000ff4  f1050008          ADD      r0,r5,#8
000ff8  f7fffffe          BL       lc640_write_long_ptr
;;;918    	
;;;919    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000ffc  f1040138          ADD      r1,r4,#0x38
001000  f105000c          ADD      r0,r5,#0xc
001004  f7fffffe          BL       lc640_write_long_ptr
;;;920    
;;;921    data[0]=LPC_RTC->YEAR;
001008  4cce              LDR      r4,|L1.4932|
00100a  8ba0              LDRH     r0,[r4,#0x1c]
00100c  f88d0004          STRB     r0,[sp,#4]
;;;922    data[1]=LPC_RTC->MONTH;
001010  7e20              LDRB     r0,[r4,#0x18]
001012  f88d0005          STRB     r0,[sp,#5]
;;;923    data[2]=LPC_RTC->DOM;
001016  7b20              LDRB     r0,[r4,#0xc]
001018  f88d0006          STRB     r0,[sp,#6]
;;;924    data[3]=0;
00101c  f88d6007          STRB     r6,[sp,#7]
;;;925    lc640_write_long_ptr(lc640_adr+16,data);
001020  a901              ADD      r1,sp,#4
001022  f1050010          ADD      r0,r5,#0x10
001026  f7fffffe          BL       lc640_write_long_ptr
;;;926    
;;;927    data[0]=LPC_RTC->HOUR;
00102a  7a20              LDRB     r0,[r4,#8]
00102c  f88d0004          STRB     r0,[sp,#4]
;;;928    data[1]=LPC_RTC->MIN;
001030  7920              LDRB     r0,[r4,#4]
001032  f88d0005          STRB     r0,[sp,#5]
;;;929    data[2]=LPC_RTC->SEC;
001036  7820              LDRB     r0,[r4,#0]
001038  f88d0006          STRB     r0,[sp,#6]
;;;930    data[3]=0;
00103c  f88d6007          STRB     r6,[sp,#7]
;;;931    lc640_write_long_ptr(lc640_adr+20,data);
001040  a901              ADD      r1,sp,#4
001042  f1050014          ADD      r0,r5,#0x14
001046  e000              B        |L1.4170|
                  |L1.4168|
001048  e001              B        |L1.4174|
                  |L1.4170|
00104a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4174|
;;;932    	
;;;933    
;;;934    
;;;935    	
;;;936    wrk_mem_hndl_end:	
;;;937    __nop();
00104e  bf00              NOP      
;;;938    }  
001050  e8bd81fc          POP      {r2-r8,pc}
;;;939    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;941    //-----------------------------------------------
;;;942    void avar_bat_ips_hndl(char in)
001054  e92d4ff8          PUSH     {r3-r11,lr}
;;;943    {
001058  4602              MOV      r2,r0
;;;944    char data[4];
;;;945    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;946    
;;;947    if(in==1)
;;;948    	{
;;;949    	bat_ips._av|=1;
00105a  48bb              LDR      r0,|L1.4936|
;;;950        ips_bat_av_stat=1;
00105c  4cbb              LDR      r4,|L1.4940|
;;;951    	ips_bat_av_vzvod=1;
00105e  4bbc              LDR      r3,|L1.4944|
;;;952    
;;;953    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;954    	event_ptr++;	
;;;955    	if(event_ptr>63)event_ptr=0;	
;;;956    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;957    	
;;;958    	event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;959    	if(event_cnt!=63)event_cnt=event_ptr;
;;;960    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;961    	
;;;962    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;963    	
;;;964    	data[0]='B';
;;;965    	data[1]=0;
;;;966    	data[2]='C';
;;;967    	data[3]=0;
;;;968    	lc640_write_long_ptr(lc640_adr,data);
;;;969    
;;;970    	data[0]=0;
;;;971    	data[1]=0;
;;;972    	data[2]=0;
;;;973    	data[3]=0;
;;;974    	lc640_write_long_ptr(lc640_adr+4,data);
;;;975    
;;;976    	data[0]=LPC_RTC->YEAR;
001060  f8df82f0          LDR      r8,|L1.4948|
001064  f890103d          LDRB     r1,[r0,#0x3d]         ;949
001068  f04f0742          MOV      r7,#0x42              ;964
00106c  f44f6560          MOV      r5,#0xe00             ;953
001070  f04f0900          MOV      r9,#0                 ;955
001074  f44f6a80          MOV      r10,#0x400            ;962
001078  2a01              CMP      r2,#1                 ;947
00107a  d002              BEQ      |L1.4226|
;;;977    	data[1]=LPC_RTC->MONTH;
;;;978    	data[2]=LPC_RTC->DOM;
;;;979    	data[3]=0;
;;;980    	lc640_write_long_ptr(lc640_adr+8,data);
;;;981    
;;;982    	data[0]=LPC_RTC->HOUR;
;;;983    	data[1]=LPC_RTC->MIN;
;;;984    	data[2]=LPC_RTC->SEC;
;;;985    	data[3]=0;
;;;986    	lc640_write_long_ptr(lc640_adr+12,data);
;;;987    	
;;;988    	data[0]='A';
;;;989    	data[1]='A';
;;;990    	data[2]='A';
;;;991    	data[3]='A';
;;;992    	lc640_write_long_ptr(lc640_adr+16,data);
;;;993    	
;;;994    	data[0]='A';
;;;995    	data[1]='A';
;;;996    	data[2]='A';
;;;997    	data[3]='A';
;;;998    	lc640_write_long_ptr(lc640_adr+20,data);
;;;999    	
;;;1000   	data[0]='A';
;;;1001   	data[1]='A';
;;;1002   	data[2]='A';
;;;1003   	data[3]='A';
;;;1004   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1005   	
;;;1006   	data[0]='A';
;;;1007   	data[1]='A';
;;;1008   	data[2]='A';
;;;1009   	data[3]='A';
;;;1010   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1011   					
;;;1012   	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;1013   		
;;;1014   	}
;;;1015   
;;;1016   else if(in==0)
00107c  2a00              CMP      r2,#0
00107e  d07e              BEQ      |L1.4478|
001080  e129              B        |L1.4822|
                  |L1.4226|
001082  f0410101          ORR      r1,r1,#1              ;949
001086  f880103d          STRB     r1,[r0,#0x3d]         ;949
00108a  f04f0001          MOV      r0,#1                 ;950
00108e  7020              STRB     r0,[r4,#0]            ;950
001090  7018              STRB     r0,[r3,#0]            ;951
001092  4628              MOV      r0,r5                 ;953
001094  f7fffffe          BL       lc640_read_int
001098  f1000001          ADD      r0,r0,#1              ;954
00109c  b284              UXTH     r4,r0                 ;954
00109e  2c3f              CMP      r4,#0x3f              ;955
0010a0  d901              BLS      |L1.4262|
0010a2  f04f0400          MOV      r4,#0                 ;955
                  |L1.4262|
0010a6  b221              SXTH     r1,r4                 ;956
0010a8  4628              MOV      r0,r5                 ;956
0010aa  f7fffffe          BL       lc640_write_int
0010ae  f6406602          MOV      r6,#0xe02             ;958
0010b2  4630              MOV      r0,r6                 ;958
0010b4  f7fffffe          BL       lc640_read_int
0010b8  b281              UXTH     r1,r0                 ;958
0010ba  293f              CMP      r1,#0x3f              ;959
0010bc  d000              BEQ      |L1.4288|
0010be  4621              MOV      r1,r4                 ;959
                  |L1.4288|
0010c0  b209              SXTH     r1,r1                 ;960
0010c2  4630              MOV      r0,r6                 ;960
0010c4  f7fffffe          BL       lc640_write_int
0010c8  4628              MOV      r0,r5                 ;962
0010ca  f7fffffe          BL       lc640_read_int
0010ce  eb0a1040          ADD      r0,r10,r0,LSL #5      ;962
0010d2  b284              UXTH     r4,r0                 ;962
0010d4  f88d7000          STRB     r7,[sp,#0]            ;964
0010d8  f88d9001          STRB     r9,[sp,#1]            ;965
0010dc  f04f0043          MOV      r0,#0x43              ;966
0010e0  f88d0002          STRB     r0,[sp,#2]            ;966
0010e4  f88d9003          STRB     r9,[sp,#3]            ;967
0010e8  4669              MOV      r1,sp                 ;968
0010ea  4620              MOV      r0,r4                 ;968
0010ec  f7fffffe          BL       lc640_write_long_ptr
0010f0  f8cd9000          STR      r9,[sp,#0]            ;973
0010f4  4669              MOV      r1,sp                 ;974
0010f6  1d20              ADDS     r0,r4,#4              ;974
0010f8  f7fffffe          BL       lc640_write_long_ptr
0010fc  f8b8003c          LDRH     r0,[r8,#0x3c]         ;976
001100  f88d0000          STRB     r0,[sp,#0]            ;976
001104  f8980038          LDRB     r0,[r8,#0x38]         ;977
001108  f88d0001          STRB     r0,[sp,#1]            ;977
00110c  f898002c          LDRB     r0,[r8,#0x2c]         ;978
001110  f88d0002          STRB     r0,[sp,#2]            ;978
001114  f88d9003          STRB     r9,[sp,#3]            ;979
001118  4669              MOV      r1,sp                 ;980
00111a  f1040008          ADD      r0,r4,#8              ;980
00111e  f7fffffe          BL       lc640_write_long_ptr
001122  f8980028          LDRB     r0,[r8,#0x28]         ;982
001126  f88d0000          STRB     r0,[sp,#0]            ;982
00112a  f8980024          LDRB     r0,[r8,#0x24]         ;983
00112e  f88d0001          STRB     r0,[sp,#1]            ;983
001132  f8980020          LDRB     r0,[r8,#0x20]         ;984
001136  f88d0002          STRB     r0,[sp,#2]            ;984
00113a  f88d9003          STRB     r9,[sp,#3]            ;985
00113e  4669              MOV      r1,sp                 ;986
001140  f104000c          ADD      r0,r4,#0xc            ;986
001144  f7fffffe          BL       lc640_write_long_ptr
001148  f04f0541          MOV      r5,#0x41              ;988
00114c  f88d5000          STRB     r5,[sp,#0]            ;988
001150  f88d5001          STRB     r5,[sp,#1]            ;989
001154  f88d5002          STRB     r5,[sp,#2]            ;990
001158  f88d5003          STRB     r5,[sp,#3]            ;991
00115c  4669              MOV      r1,sp                 ;992
00115e  f1040010          ADD      r0,r4,#0x10           ;992
001162  f7fffffe          BL       lc640_write_long_ptr
001166  f88d5000          STRB     r5,[sp,#0]            ;994
00116a  f88d5001          STRB     r5,[sp,#1]            ;995
00116e  f88d5002          STRB     r5,[sp,#2]            ;996
001172  f88d5003          STRB     r5,[sp,#3]            ;997
001176  4669              MOV      r1,sp                 ;998
001178  f1040014          ADD      r0,r4,#0x14           ;998
00117c  e000              B        |L1.4480|
                  |L1.4478|
00117e  e022              B        |L1.4550|
                  |L1.4480|
001180  f7fffffe          BL       lc640_write_long_ptr
001184  f88d5000          STRB     r5,[sp,#0]            ;1000
001188  f88d5001          STRB     r5,[sp,#1]            ;1001
00118c  f88d5002          STRB     r5,[sp,#2]            ;1002
001190  f88d5003          STRB     r5,[sp,#3]            ;1003
001194  4669              MOV      r1,sp                 ;1004
001196  f1040018          ADD      r0,r4,#0x18           ;1004
00119a  f7fffffe          BL       lc640_write_long_ptr
00119e  f88d5000          STRB     r5,[sp,#0]            ;1006
0011a2  f88d5001          STRB     r5,[sp,#1]            ;1007
0011a6  f88d5002          STRB     r5,[sp,#2]            ;1008
0011aa  f88d5003          STRB     r5,[sp,#3]            ;1009
0011ae  4669              MOV      r1,sp                 ;1010
0011b0  f104001c          ADD      r0,r4,#0x1c           ;1010
0011b4  f7fffffe          BL       lc640_write_long_ptr
0011b8  2301              MOVS     r3,#1                 ;1012
0011ba  461a              MOV      r2,r3                 ;1012
0011bc  2105              MOVS     r1,#5                 ;1012
0011be  a066              ADR      r0,|L1.4952|
0011c0  f7fffffe          BL       snmp_trap_send
0011c4  e087              B        |L1.4822|
                  |L1.4550|
;;;1017   	{
;;;1018   	bat_ips._av&=~1;
0011c6  f0210101          BIC      r1,r1,#1
0011ca  f880103d          STRB     r1,[r0,#0x3d]
;;;1019   	ips_bat_av_stat=0;
0011ce  f8849000          STRB     r9,[r4,#0]
;;;1020   	ips_bat_av_vzvod=0;
0011d2  f8839000          STRB     r9,[r3,#0]
;;;1021        
;;;1022   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0011d6  4628              MOV      r0,r5
0011d8  f7fffffe          BL       lc640_read_int
0011dc  b286              UXTH     r6,r0
;;;1023   	event_ptr_find=event_ptr;
0011de  4634              MOV      r4,r6
                  |L1.4576|
;;;1024   	
;;;1025   avar_bat_ips_hndl_lbl1: 
;;;1026   
;;;1027   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0011e0  eb0a1044          ADD      r0,r10,r4,LSL #5
0011e4  b285              UXTH     r5,r0
;;;1028   
;;;1029        lc640_read_long_ptr(lc640_adr,data);
0011e6  4669              MOV      r1,sp
0011e8  4628              MOV      r0,r5
0011ea  f7fffffe          BL       lc640_read_long_ptr
;;;1030        
;;;1031        if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
0011ee  f89d0000          LDRB     r0,[sp,#0]
0011f2  2842              CMP      r0,#0x42
0011f4  d106              BNE      |L1.4612|
0011f6  f89d0001          LDRB     r0,[sp,#1]
0011fa  b918              CBNZ     r0,|L1.4612|
0011fc  f89d0002          LDRB     r0,[sp,#2]
001200  2843              CMP      r0,#0x43
001202  d009              BEQ      |L1.4632|
                  |L1.4612|
;;;1032        	{        
;;;1033        	if(event_ptr_find)event_ptr_find--;
001204  b11c              CBZ      r4,|L1.4622|
001206  f1a40401          SUB      r4,r4,#1
00120a  b2a4              UXTH     r4,r4
00120c  e001              B        |L1.4626|
                  |L1.4622|
;;;1034        	else event_ptr_find=63;
00120e  f04f043f          MOV      r4,#0x3f
                  |L1.4626|
;;;1035        	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001212  42b4              CMP      r4,r6
001214  d1e4              BNE      |L1.4576|
001216  e05e              B        |L1.4822|
                  |L1.4632|
;;;1036        	else goto avar_bat_ips_hndl_lbl1;
;;;1037        	}
;;;1038        else 
;;;1039        	{
;;;1040        	lc640_read_long_ptr(lc640_adr+16,data);
001218  4669              MOV      r1,sp
00121a  f1050010          ADD      r0,r5,#0x10
00121e  f7fffffe          BL       lc640_read_long_ptr
;;;1041        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001222  f89d0000          LDRB     r0,[sp,#0]
001226  2841              CMP      r0,#0x41
001228  d10b              BNE      |L1.4674|
00122a  f89d0001          LDRB     r0,[sp,#1]
00122e  2841              CMP      r0,#0x41
001230  d107              BNE      |L1.4674|
001232  f89d0002          LDRB     r0,[sp,#2]
001236  2841              CMP      r0,#0x41
001238  d103              BNE      |L1.4674|
00123a  f89d0003          LDRB     r0,[sp,#3]
00123e  2841              CMP      r0,#0x41
001240  d009              BEQ      |L1.4694|
                  |L1.4674|
;;;1042        		{        
;;;1043        		if(event_ptr_find)event_ptr_find--;
001242  b11c              CBZ      r4,|L1.4684|
001244  f1a40401          SUB      r4,r4,#1
001248  b2a4              UXTH     r4,r4
00124a  e001              B        |L1.4688|
                  |L1.4684|
;;;1044            		else event_ptr_find=63;
00124c  f04f043f          MOV      r4,#0x3f
                  |L1.4688|
;;;1045            	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001250  42b4              CMP      r4,r6
001252  d1c5              BNE      |L1.4576|
001254  e03f              B        |L1.4822|
                  |L1.4694|
;;;1046        		else goto avar_bat_ips_hndl_lbl1;
;;;1047        		}
;;;1048   
;;;1049        	}
;;;1050        		
;;;1051   	data[0]=LPC_RTC->YEAR;
001256  f8b8003c          LDRH     r0,[r8,#0x3c]
00125a  f88d0000          STRB     r0,[sp,#0]
;;;1052   	data[1]=LPC_RTC->MONTH;
00125e  f8980038          LDRB     r0,[r8,#0x38]
001262  f88d0001          STRB     r0,[sp,#1]
;;;1053   	data[2]=LPC_RTC->DOM;
001266  f898002c          LDRB     r0,[r8,#0x2c]
00126a  f88d0002          STRB     r0,[sp,#2]
;;;1054   	data[3]=0;
00126e  f88d9003          STRB     r9,[sp,#3]
;;;1055   	lc640_write_long_ptr(lc640_adr+16,data);
001272  4669              MOV      r1,sp
001274  f1050010          ADD      r0,r5,#0x10
001278  f7fffffe          BL       lc640_write_long_ptr
;;;1056   
;;;1057   	data[0]=LPC_RTC->HOUR;
00127c  f8980028          LDRB     r0,[r8,#0x28]
001280  f88d0000          STRB     r0,[sp,#0]
;;;1058   	data[1]=LPC_RTC->MIN;
001284  f8980024          LDRB     r0,[r8,#0x24]
001288  f88d0001          STRB     r0,[sp,#1]
;;;1059   	data[2]=LPC_RTC->SEC;
00128c  f8980020          LDRB     r0,[r8,#0x20]
001290  f88d0002          STRB     r0,[sp,#2]
;;;1060   	data[3]=0;
001294  f88d9003          STRB     r9,[sp,#3]
;;;1061   	lc640_write_long_ptr(lc640_adr+20,data);
001298  4669              MOV      r1,sp
00129a  f1050014          ADD      r0,r5,#0x14
00129e  f7fffffe          BL       lc640_write_long_ptr
;;;1062   	
;;;1063   	data[0]='B';
0012a2  f88d7000          STRB     r7,[sp,#0]
;;;1064   	data[1]='B';
0012a6  f88d7001          STRB     r7,[sp,#1]
;;;1065   	data[2]='B';
0012aa  f88d7002          STRB     r7,[sp,#2]
;;;1066   	data[3]='B';
0012ae  f88d7003          STRB     r7,[sp,#3]
;;;1067   	lc640_write_long_ptr(lc640_adr+24,data);
0012b2  4669              MOV      r1,sp
0012b4  f1050018          ADD      r0,r5,#0x18
0012b8  f7fffffe          BL       lc640_write_long_ptr
;;;1068   	
;;;1069   	data[0]='B';
0012bc  f88d7000          STRB     r7,[sp,#0]
;;;1070   	data[1]='B';
0012c0  f88d7001          STRB     r7,[sp,#1]
;;;1071   	data[2]='B';
0012c4  f88d7002          STRB     r7,[sp,#2]
;;;1072   	data[3]='B';
0012c8  f88d7003          STRB     r7,[sp,#3]
;;;1073   	lc640_write_long_ptr(lc640_adr+28,data);
0012cc  4669              MOV      r1,sp
0012ce  f105001c          ADD      r0,r5,#0x1c
0012d2  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4822|
;;;1074   	
;;;1075   
;;;1076   	
;;;1077   	}
;;;1078   	
;;;1079   avar_bat_ips_hndl_end:
;;;1080   __nop();		
0012d6  bf00              NOP      
                  |L1.4824|
;;;1081   }
0012d8  e629              B        |L1.3886|
;;;1082   
                          ENDP

                  avar_bat_hndl PROC
;;;1085   //-----------------------------------------------
;;;1086   void avar_bat_hndl(char b, char in)
0012da  e92d4ff8          PUSH     {r3-r11,lr}
;;;1087   {
0012de  4606              MOV      r6,r0
;;;1088   char data[4];
;;;1089   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1090   
;;;1091   if(in==1)
;;;1092   	{
;;;1093   	bat[b]._av|=1;
0012e0  4816              LDR      r0,|L1.4924|
0012e2  eb060246          ADD      r2,r6,r6,LSL #1
;;;1094       
;;;1095   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1096   	event_ptr++;	
;;;1097   	if(event_ptr>63)event_ptr=0;	
;;;1098   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1099   	
;;;1100        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1101   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1102   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1103   	
;;;1104   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1105   	
;;;1106   	data[0]='B';
;;;1107   	data[1]=b;
;;;1108   	data[2]='C';
;;;1109   	data[3]=0;
;;;1110   	lc640_write_long_ptr(lc640_adr,data);
;;;1111   
;;;1112   	data[0]=0;
;;;1113   	data[1]=0;
;;;1114   	data[2]=0;
;;;1115   	data[3]=0;
;;;1116   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1117   
;;;1118   	data[0]=LPC_RTC->YEAR;
0012e6  f8df806c          LDR      r8,|L1.4948|
0012ea  eb021206          ADD      r2,r2,r6,LSL #4       ;1093
0012ee  f04f0a00          MOV      r10,#0                ;1097
0012f2  f04f0942          MOV      r9,#0x42              ;1106
0012f6  f44f6560          MOV      r5,#0xe00             ;1095
0012fa  f44f6b80          MOV      r11,#0x400            ;1104
0012fe  eb000082          ADD      r0,r0,r2,LSL #2       ;1093
001302  2901              CMP      r1,#1                 ;1091
001304  d002              BEQ      |L1.4876|
;;;1119   	data[1]=LPC_RTC->MONTH;
;;;1120   	data[2]=LPC_RTC->DOM;
;;;1121   	data[3]=0;
;;;1122   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1123   
;;;1124   	data[0]=LPC_RTC->HOUR;
;;;1125   	data[1]=LPC_RTC->MIN;
;;;1126   	data[2]=LPC_RTC->SEC;
;;;1127   	data[3]=0;
;;;1128   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1129   	
;;;1130   	data[0]='A';
;;;1131   	data[1]='A';
;;;1132   	data[2]='A';
;;;1133   	data[3]='A';
;;;1134   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1135   	
;;;1136   	data[0]='A';
;;;1137   	data[1]='A';
;;;1138   	data[2]='A';
;;;1139   	data[3]='A';
;;;1140   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1141   	
;;;1142   	data[0]='A';
;;;1143   	data[1]='A';
;;;1144   	data[2]='A';
;;;1145   	data[3]='A';
;;;1146   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1147   	
;;;1148   	data[0]='A';
;;;1149   	data[1]='A';
;;;1150   	data[2]='A';
;;;1151   	data[3]='A';
;;;1152   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1153   					
;;;1154   	if(b==0)
;;;1155   		{
;;;1156   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1157   		}
;;;1158   	else if(b==1)
;;;1159   		{
;;;1160   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1161   		} 
;;;1162   			
;;;1163   	}
;;;1164   
;;;1165   else if(in==0)
001306  2900              CMP      r1,#0
001308  d07d              BEQ      |L1.5126|
00130a  e149              B        |L1.5536|
                  |L1.4876|
00130c  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1093
001310  f0410101          ORR      r1,r1,#1              ;1093
001314  7001              STRB     r1,[r0,#0]            ;1093
001316  4628              MOV      r0,r5                 ;1095
001318  f7fffffe          BL       lc640_read_int
00131c  f1000001          ADD      r0,r0,#1              ;1096
001320  b284              UXTH     r4,r0                 ;1096
001322  2c3f              CMP      r4,#0x3f              ;1097
001324  d901              BLS      |L1.4906|
001326  f04f0400          MOV      r4,#0                 ;1097
                  |L1.4906|
00132a  b221              SXTH     r1,r4                 ;1098
00132c  4628              MOV      r0,r5                 ;1098
00132e  f7fffffe          BL       lc640_write_int
001332  f6406702          MOV      r7,#0xe02             ;1100
001336  4638              MOV      r0,r7                 ;1100
001338  e018              B        |L1.4972|
00133a  0000              DCW      0x0000
                  |L1.4924|
                          DCD      bat
                  |L1.4928|
                          DCD      bat_u_old_cnt
                  |L1.4932|
                          DCD      0x40024020
                  |L1.4936|
                          DCD      bat_ips
                  |L1.4940|
                          DCD      ips_bat_av_stat
                  |L1.4944|
                          DCD      ips_bat_av_vzvod
                  |L1.4948|
                          DCD      0x40024000
                  |L1.4952|
001358  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
00135c  b9312041
001360  6c61726d
001364  2c206c6f
001368  737400  
00136b  00                DCB      0
                  |L1.4972|
00136c  f7fffffe          BL       lc640_read_int
001370  b280              UXTH     r0,r0                 ;1100
001372  283f              CMP      r0,#0x3f              ;1101
001374  d000              BEQ      |L1.4984|
001376  4620              MOV      r0,r4                 ;1101
                  |L1.4984|
001378  b201              SXTH     r1,r0                 ;1102
00137a  4638              MOV      r0,r7                 ;1102
00137c  f7fffffe          BL       lc640_write_int
001380  4628              MOV      r0,r5                 ;1104
001382  f7fffffe          BL       lc640_read_int
001386  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1104
00138a  b284              UXTH     r4,r0                 ;1104
00138c  f88d9000          STRB     r9,[sp,#0]            ;1106
001390  f88d6001          STRB     r6,[sp,#1]            ;1107
001394  f04f0043          MOV      r0,#0x43              ;1108
001398  f88d0002          STRB     r0,[sp,#2]            ;1108
00139c  f88da003          STRB     r10,[sp,#3]           ;1109
0013a0  4669              MOV      r1,sp                 ;1110
0013a2  4620              MOV      r0,r4                 ;1110
0013a4  f7fffffe          BL       lc640_write_long_ptr
0013a8  f8cda000          STR      r10,[sp,#0]           ;1115
0013ac  4669              MOV      r1,sp                 ;1116
0013ae  1d20              ADDS     r0,r4,#4              ;1116
0013b0  f7fffffe          BL       lc640_write_long_ptr
0013b4  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1118
0013b8  f88d0000          STRB     r0,[sp,#0]            ;1118
0013bc  f8980038          LDRB     r0,[r8,#0x38]         ;1119
0013c0  f88d0001          STRB     r0,[sp,#1]            ;1119
0013c4  f898002c          LDRB     r0,[r8,#0x2c]         ;1120
0013c8  f88d0002          STRB     r0,[sp,#2]            ;1120
0013cc  f88da003          STRB     r10,[sp,#3]           ;1121
0013d0  4669              MOV      r1,sp                 ;1122
0013d2  f1040008          ADD      r0,r4,#8              ;1122
0013d6  f7fffffe          BL       lc640_write_long_ptr
0013da  f8980028          LDRB     r0,[r8,#0x28]         ;1124
0013de  f88d0000          STRB     r0,[sp,#0]            ;1124
0013e2  f8980024          LDRB     r0,[r8,#0x24]         ;1125
0013e6  f88d0001          STRB     r0,[sp,#1]            ;1125
0013ea  f8980020          LDRB     r0,[r8,#0x20]         ;1126
0013ee  f88d0002          STRB     r0,[sp,#2]            ;1126
0013f2  f88da003          STRB     r10,[sp,#3]           ;1127
0013f6  4669              MOV      r1,sp                 ;1128
0013f8  f104000c          ADD      r0,r4,#0xc            ;1128
0013fc  f7fffffe          BL       lc640_write_long_ptr
001400  f04f0541          MOV      r5,#0x41              ;1130
001404  e000              B        |L1.5128|
                  |L1.5126|
001406  e045              B        |L1.5268|
                  |L1.5128|
001408  f88d5000          STRB     r5,[sp,#0]            ;1130
00140c  f88d5001          STRB     r5,[sp,#1]            ;1131
001410  f88d5002          STRB     r5,[sp,#2]            ;1132
001414  f88d5003          STRB     r5,[sp,#3]            ;1133
001418  4669              MOV      r1,sp                 ;1134
00141a  f1040010          ADD      r0,r4,#0x10           ;1134
00141e  f7fffffe          BL       lc640_write_long_ptr
001422  f88d5000          STRB     r5,[sp,#0]            ;1136
001426  f88d5001          STRB     r5,[sp,#1]            ;1137
00142a  f88d5002          STRB     r5,[sp,#2]            ;1138
00142e  f88d5003          STRB     r5,[sp,#3]            ;1139
001432  4669              MOV      r1,sp                 ;1140
001434  f1040014          ADD      r0,r4,#0x14           ;1140
001438  f7fffffe          BL       lc640_write_long_ptr
00143c  f88d5000          STRB     r5,[sp,#0]            ;1142
001440  f88d5001          STRB     r5,[sp,#1]            ;1143
001444  f88d5002          STRB     r5,[sp,#2]            ;1144
001448  f88d5003          STRB     r5,[sp,#3]            ;1145
00144c  4669              MOV      r1,sp                 ;1146
00144e  f1040018          ADD      r0,r4,#0x18           ;1146
001452  f7fffffe          BL       lc640_write_long_ptr
001456  f88d5000          STRB     r5,[sp,#0]            ;1148
00145a  f88d5001          STRB     r5,[sp,#1]            ;1149
00145e  f88d5002          STRB     r5,[sp,#2]            ;1150
001462  f88d5003          STRB     r5,[sp,#3]            ;1151
001466  4669              MOV      r1,sp                 ;1152
001468  f104001c          ADD      r0,r4,#0x1c           ;1152
00146c  f7fffffe          BL       lc640_write_long_ptr
001470  b116              CBZ      r6,|L1.5240|
001472  2e01              CMP      r6,#1                 ;1158
001474  d007              BEQ      |L1.5254|
001476  e093              B        |L1.5536|
                  |L1.5240|
001478  2301              MOVS     r3,#1                 ;1156
00147a  461a              MOV      r2,r3                 ;1156
00147c  2105              MOVS     r1,#5                 ;1156
00147e  a0fe              ADR      r0,|L1.6264|
001480  f7fffffe          BL       snmp_trap_send
001484  e08c              B        |L1.5536|
                  |L1.5254|
001486  2301              MOVS     r3,#1                 ;1160
001488  2202              MOVS     r2,#2                 ;1160
00148a  2105              MOVS     r1,#5                 ;1160
00148c  a0ff              ADR      r0,|L1.6284|
00148e  f7fffffe          BL       snmp_trap_send
001492  e085              B        |L1.5536|
                  |L1.5268|
;;;1166   	{
;;;1167   	bat[b]._av&=~1;
001494  f8101f3d          LDRB     r1,[r0,#0x3d]!
001498  f0210101          BIC      r1,r1,#1
00149c  7001              STRB     r1,[r0,#0]
;;;1168   
;;;1169        event_ptr=lc640_read_int(PTR_EVENT_LOG);
00149e  4628              MOV      r0,r5
0014a0  f7fffffe          BL       lc640_read_int
0014a4  b287              UXTH     r7,r0
;;;1170   	event_ptr_find=event_ptr;
0014a6  463c              MOV      r4,r7
                  |L1.5288|
;;;1171   	
;;;1172   avar_bat_hndl_lbl1: 
;;;1173   
;;;1174   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0014a8  eb0b1044          ADD      r0,r11,r4,LSL #5
0014ac  b285              UXTH     r5,r0
;;;1175   
;;;1176        lc640_read_long_ptr(lc640_adr,data);
0014ae  4669              MOV      r1,sp
0014b0  4628              MOV      r0,r5
0014b2  f7fffffe          BL       lc640_read_long_ptr
;;;1177        
;;;1178        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
0014b6  f89d0000          LDRB     r0,[sp,#0]
0014ba  2842              CMP      r0,#0x42
0014bc  d107              BNE      |L1.5326|
0014be  f89d0001          LDRB     r0,[sp,#1]
0014c2  42b0              CMP      r0,r6
0014c4  d103              BNE      |L1.5326|
0014c6  f89d0002          LDRB     r0,[sp,#2]
0014ca  2843              CMP      r0,#0x43
0014cc  d009              BEQ      |L1.5346|
                  |L1.5326|
;;;1179        	{        
;;;1180        	if(event_ptr_find)event_ptr_find--;
0014ce  b11c              CBZ      r4,|L1.5336|
0014d0  f1a40401          SUB      r4,r4,#1
0014d4  b2a4              UXTH     r4,r4
0014d6  e001              B        |L1.5340|
                  |L1.5336|
;;;1181        	else event_ptr_find=63;
0014d8  f04f043f          MOV      r4,#0x3f
                  |L1.5340|
;;;1182        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
0014dc  42bc              CMP      r4,r7
0014de  d1e3              BNE      |L1.5288|
0014e0  e05e              B        |L1.5536|
                  |L1.5346|
;;;1183        	else goto avar_bat_hndl_lbl1;
;;;1184        	}
;;;1185        else 
;;;1186        	{
;;;1187        	lc640_read_long_ptr(lc640_adr+16,data);
0014e2  4669              MOV      r1,sp
0014e4  f1050010          ADD      r0,r5,#0x10
0014e8  f7fffffe          BL       lc640_read_long_ptr
;;;1188        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0014ec  f89d0000          LDRB     r0,[sp,#0]
0014f0  2841              CMP      r0,#0x41
0014f2  d10b              BNE      |L1.5388|
0014f4  f89d0001          LDRB     r0,[sp,#1]
0014f8  2841              CMP      r0,#0x41
0014fa  d107              BNE      |L1.5388|
0014fc  f89d0002          LDRB     r0,[sp,#2]
001500  2841              CMP      r0,#0x41
001502  d103              BNE      |L1.5388|
001504  f89d0003          LDRB     r0,[sp,#3]
001508  2841              CMP      r0,#0x41
00150a  d009              BEQ      |L1.5408|
                  |L1.5388|
;;;1189        		{        
;;;1190        		if(event_ptr_find)event_ptr_find--;
00150c  b11c              CBZ      r4,|L1.5398|
00150e  f1a40401          SUB      r4,r4,#1
001512  b2a4              UXTH     r4,r4
001514  e001              B        |L1.5402|
                  |L1.5398|
;;;1191            		else event_ptr_find=63;
001516  f04f043f          MOV      r4,#0x3f
                  |L1.5402|
;;;1192            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
00151a  42bc              CMP      r4,r7
00151c  d1c4              BNE      |L1.5288|
00151e  e03f              B        |L1.5536|
                  |L1.5408|
;;;1193        		else goto avar_bat_hndl_lbl1;
;;;1194        		}
;;;1195   
;;;1196        	}
;;;1197        		
;;;1198   	data[0]=LPC_RTC->YEAR;
001520  f8b8003c          LDRH     r0,[r8,#0x3c]
001524  f88d0000          STRB     r0,[sp,#0]
;;;1199   	data[1]=LPC_RTC->MONTH;
001528  f8980038          LDRB     r0,[r8,#0x38]
00152c  f88d0001          STRB     r0,[sp,#1]
;;;1200   	data[2]=LPC_RTC->DOM;
001530  f898002c          LDRB     r0,[r8,#0x2c]
001534  f88d0002          STRB     r0,[sp,#2]
;;;1201   	data[3]=0;
001538  f88da003          STRB     r10,[sp,#3]
;;;1202   	lc640_write_long_ptr(lc640_adr+16,data);
00153c  4669              MOV      r1,sp
00153e  f1050010          ADD      r0,r5,#0x10
001542  f7fffffe          BL       lc640_write_long_ptr
;;;1203   
;;;1204   	data[0]=LPC_RTC->HOUR;
001546  f8980028          LDRB     r0,[r8,#0x28]
00154a  f88d0000          STRB     r0,[sp,#0]
;;;1205   	data[1]=LPC_RTC->MIN;
00154e  f8980024          LDRB     r0,[r8,#0x24]
001552  f88d0001          STRB     r0,[sp,#1]
;;;1206   	data[2]=LPC_RTC->SEC;
001556  f8980020          LDRB     r0,[r8,#0x20]
00155a  f88d0002          STRB     r0,[sp,#2]
;;;1207   	data[3]=0;
00155e  f88da003          STRB     r10,[sp,#3]
;;;1208   	lc640_write_long_ptr(lc640_adr+20,data);
001562  4669              MOV      r1,sp
001564  f1050014          ADD      r0,r5,#0x14
001568  f7fffffe          BL       lc640_write_long_ptr
;;;1209   	
;;;1210   	data[0]='B';
00156c  f88d9000          STRB     r9,[sp,#0]
;;;1211   	data[1]='B';
001570  f88d9001          STRB     r9,[sp,#1]
;;;1212   	data[2]='B';
001574  f88d9002          STRB     r9,[sp,#2]
;;;1213   	data[3]='B';
001578  f88d9003          STRB     r9,[sp,#3]
;;;1214   	lc640_write_long_ptr(lc640_adr+24,data);
00157c  4669              MOV      r1,sp
00157e  f1050018          ADD      r0,r5,#0x18
001582  f7fffffe          BL       lc640_write_long_ptr
;;;1215   	
;;;1216   	data[0]='B';
001586  f88d9000          STRB     r9,[sp,#0]
;;;1217   	data[1]='B';
00158a  f88d9001          STRB     r9,[sp,#1]
;;;1218   	data[2]='B';
00158e  f88d9002          STRB     r9,[sp,#2]
;;;1219   	data[3]='B';
001592  f88d9003          STRB     r9,[sp,#3]
;;;1220   	lc640_write_long_ptr(lc640_adr+28,data);
001596  4669              MOV      r1,sp
001598  f105001c          ADD      r0,r5,#0x1c
00159c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5536|
;;;1221   	
;;;1222   
;;;1223   	
;;;1224   	}
;;;1225   	
;;;1226   avar_bat_hndl_end:
;;;1227   __nop();		
0015a0  bf00              NOP      
                  |L1.5538|
;;;1228   }
0015a2  e4c4              B        |L1.3886|
;;;1229   
                          ENDP

                  avar_bat_temper_hndl PROC
;;;1230   //-----------------------------------------------
;;;1231   void avar_bat_temper_hndl(char b, char in)
0015a4  e92d4ff8          PUSH     {r3-r11,lr}
;;;1232   {
0015a8  4605              MOV      r5,r0
0015aa  460e              MOV      r6,r1
;;;1233   char data[4];
;;;1234   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1235   
;;;1236   if((in==1)||(in==3))
;;;1237   	{
;;;1238   	//bat[b]._av|=1;
;;;1239       
;;;1240   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1241   	event_ptr++;	
;;;1242   	if(event_ptr>63)event_ptr=0;	
;;;1243   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1244   	
;;;1245        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1246   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1247   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1248   	
;;;1249   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1250   	
;;;1251   	data[0]='B';
;;;1252   	data[1]=b;
;;;1253   	data[2]='T';
;;;1254   	data[3]='1';
;;;1255   	if(in==3)data[3]='3';
;;;1256   	lc640_write_long_ptr(lc640_adr,data);
;;;1257   
;;;1258   	data[0]=0;
;;;1259   	data[1]=0;
;;;1260   	data[2]=0;
;;;1261   	data[3]=0;
;;;1262   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1263   
;;;1264   	data[0]=LPC_RTC->YEAR;
0015ac  f8dfa2f0          LDR      r10,|L1.6304|
0015b0  f44f6060          MOV      r0,#0xe00             ;1240
0015b4  f44f6780          MOV      r7,#0x400             ;1249
0015b8  2e01              CMP      r6,#1                 ;1236
0015ba  d010              BEQ      |L1.5598|
0015bc  2e03              CMP      r6,#3                 ;1236
0015be  d00e              BEQ      |L1.5598|
;;;1265   	data[1]=LPC_RTC->MONTH;
;;;1266   	data[2]=LPC_RTC->DOM;
;;;1267   	data[3]=0;
;;;1268   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1269   
;;;1270   	data[0]=LPC_RTC->HOUR;
;;;1271   	data[1]=LPC_RTC->MIN;
;;;1272   	data[2]=LPC_RTC->SEC;
;;;1273   	data[3]=0;
;;;1274   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1275   	
;;;1276   	data[0]='A';
;;;1277   	data[1]='A';
;;;1278   	data[2]='A';
;;;1279   	data[3]='A';
;;;1280   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1281   	
;;;1282   	data[0]='A';
;;;1283   	data[1]='A';
;;;1284   	data[2]='A';
;;;1285   	data[3]='A';
;;;1286   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1287   	
;;;1288   	data[0]='A';
;;;1289   	data[1]='A';
;;;1290   	data[2]='A';
;;;1291   	data[3]='A';
;;;1292   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1293   	
;;;1294   	data[0]='A';
;;;1295   	data[1]='A';
;;;1296   	data[2]='A';
;;;1297   	data[3]='A';
;;;1298   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1299   	if(in==1)
;;;1300   		{				
;;;1301   		if(b==0)
;;;1302   			{
;;;1303   			snmp_trap_send("BAT #1 Alarm, is heated",10,1,1);
;;;1304   			}
;;;1305   		else if(b==1)
;;;1306   			{
;;;1307   			snmp_trap_send("BAT #2 Alarm, is heated",10,2,1);
;;;1308   			} 
;;;1309   		}
;;;1310   	if(in==3)
;;;1311   		{				
;;;1312   		if(b==0)
;;;1313   			{
;;;1314   			snmp_trap_send("BAT #1 Alarm, is overheated",11,1,1);
;;;1315   			}
;;;1316   		else if(b==1)
;;;1317   			{
;;;1318   			snmp_trap_send("BAT #2 Alarm, is overheated",11,2,1);
;;;1319   			} 
;;;1320   		}			
;;;1321   	}
;;;1322   
;;;1323   else if((in==0)||(in==2))
0015c0  b10e              CBZ      r6,|L1.5574|
0015c2  2e02              CMP      r6,#2
0015c4  d17e              BNE      |L1.5828|
                  |L1.5574|
;;;1324   	{
;;;1325   	char i;
;;;1326   
;;;1327   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0015c6  f7fffffe          BL       lc640_read_int
0015ca  fa1ff980          UXTH     r9,r0
;;;1328   	event_ptr_find=event_ptr;
0015ce  464c              MOV      r4,r9
;;;1329   
;;;1330   /*	for (i=0;i<63;i++)
;;;1331   		{
;;;1332   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1333   
;;;1334        	lc640_read_long_ptr(lc640_adr,data);
;;;1335        
;;;1336        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;1337        		{        
;;;1338        		if(event_ptr_find)event_ptr_find--;
;;;1339        		else event_ptr_find=63;
;;;1340        		if(event_ptr_find==event_ptr)
;;;1341   				{
;;;1342   				lc640_adr=0;
;;;1343   				break;
;;;1344   				}
;;;1345        		else continue;
;;;1346        		}
;;;1347        	else 
;;;1348        		{
;;;1349        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1350        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1351        			{        
;;;1352        			if(event_ptr_find)event_ptr_find--;
;;;1353            		else event_ptr_find=63;
;;;1354            		if(event_ptr_find==event_ptr)
;;;1355   					{
;;;1356   					lc640_adr=0;
;;;1357   					break;
;;;1358   					}
;;;1359        			else continue;
;;;1360        			}
;;;1361        		}	
;;;1362   		}*/
;;;1363   	
;;;1364   	for (i=0;i<63;i++)
0015d0  f04f0800          MOV      r8,#0
                  |L1.5588|
;;;1365   		{
;;;1366   		char temp='1';
0015d4  f04f0b31          MOV      r11,#0x31
;;;1367   		if(in==2)temp='3';
0015d8  2e02              CMP      r6,#2
0015da  d074              BEQ      |L1.5830|
0015dc  e0c7              B        |L1.5998|
                  |L1.5598|
0015de  4680              MOV      r8,r0                 ;1240
0015e0  f7fffffe          BL       lc640_read_int
0015e4  f1000001          ADD      r0,r0,#1              ;1241
0015e8  b284              UXTH     r4,r0                 ;1241
0015ea  2c3f              CMP      r4,#0x3f              ;1242
0015ec  d901              BLS      |L1.5618|
0015ee  f04f0400          MOV      r4,#0                 ;1242
                  |L1.5618|
0015f2  b221              SXTH     r1,r4                 ;1243
0015f4  4640              MOV      r0,r8                 ;1243
0015f6  f7fffffe          BL       lc640_write_int
0015fa  f6406902          MOV      r9,#0xe02             ;1245
0015fe  4648              MOV      r0,r9                 ;1245
001600  f7fffffe          BL       lc640_read_int
001604  b280              UXTH     r0,r0                 ;1245
001606  283f              CMP      r0,#0x3f              ;1246
001608  d000              BEQ      |L1.5644|
00160a  4620              MOV      r0,r4                 ;1246
                  |L1.5644|
00160c  b201              SXTH     r1,r0                 ;1247
00160e  4648              MOV      r0,r9                 ;1247
001610  f7fffffe          BL       lc640_write_int
001614  4640              MOV      r0,r8                 ;1249
001616  f7fffffe          BL       lc640_read_int
00161a  eb071040          ADD      r0,r7,r0,LSL #5       ;1249
00161e  b284              UXTH     r4,r0                 ;1249
001620  f04f0042          MOV      r0,#0x42              ;1251
001624  f88d0000          STRB     r0,[sp,#0]            ;1251
001628  f88d5001          STRB     r5,[sp,#1]            ;1252
00162c  f04f0054          MOV      r0,#0x54              ;1253
001630  f88d0002          STRB     r0,[sp,#2]            ;1253
001634  f04f0031          MOV      r0,#0x31              ;1254
001638  f88d0003          STRB     r0,[sp,#3]            ;1254
00163c  2e03              CMP      r6,#3                 ;1255
00163e  d103              BNE      |L1.5704|
001640  f04f0033          MOV      r0,#0x33              ;1255
001644  f88d0003          STRB     r0,[sp,#3]            ;1255
                  |L1.5704|
001648  4669              MOV      r1,sp                 ;1256
00164a  4620              MOV      r0,r4                 ;1256
00164c  f7fffffe          BL       lc640_write_long_ptr
001650  f04f0700          MOV      r7,#0                 ;1258
001654  9700              STR      r7,[sp,#0]            ;1261
001656  4669              MOV      r1,sp                 ;1262
001658  f1040004          ADD      r0,r4,#4              ;1262
00165c  f7fffffe          BL       lc640_write_long_ptr
001660  f8ba003c          LDRH     r0,[r10,#0x3c]        ;1264
001664  f88d0000          STRB     r0,[sp,#0]            ;1264
001668  f89a0038          LDRB     r0,[r10,#0x38]        ;1265
00166c  f88d0001          STRB     r0,[sp,#1]            ;1265
001670  f89a002c          LDRB     r0,[r10,#0x2c]        ;1266
001674  f88d0002          STRB     r0,[sp,#2]            ;1266
001678  f88d7003          STRB     r7,[sp,#3]            ;1267
00167c  4669              MOV      r1,sp                 ;1268
00167e  f1040008          ADD      r0,r4,#8              ;1268
001682  f7fffffe          BL       lc640_write_long_ptr
001686  f89a0028          LDRB     r0,[r10,#0x28]        ;1270
00168a  f88d0000          STRB     r0,[sp,#0]            ;1270
00168e  f89a0024          LDRB     r0,[r10,#0x24]        ;1271
001692  f88d0001          STRB     r0,[sp,#1]            ;1271
001696  f89a0020          LDRB     r0,[r10,#0x20]        ;1272
00169a  f88d0002          STRB     r0,[sp,#2]            ;1272
00169e  f88d7003          STRB     r7,[sp,#3]            ;1273
0016a2  4669              MOV      r1,sp                 ;1274
0016a4  f104000c          ADD      r0,r4,#0xc            ;1274
0016a8  f7fffffe          BL       lc640_write_long_ptr
0016ac  f04f0741          MOV      r7,#0x41              ;1276
0016b0  f88d7000          STRB     r7,[sp,#0]            ;1276
0016b4  f88d7001          STRB     r7,[sp,#1]            ;1277
0016b8  f88d7002          STRB     r7,[sp,#2]            ;1278
0016bc  f88d7003          STRB     r7,[sp,#3]            ;1279
0016c0  4669              MOV      r1,sp                 ;1280
0016c2  e001              B        |L1.5832|
                  |L1.5828|
0016c4  e049              B        |L1.5978|
                  |L1.5830|
0016c6  e050              B        |L1.5994|
                  |L1.5832|
0016c8  f1040010          ADD      r0,r4,#0x10           ;1280
0016cc  f7fffffe          BL       lc640_write_long_ptr
0016d0  f88d7000          STRB     r7,[sp,#0]            ;1282
0016d4  f88d7001          STRB     r7,[sp,#1]            ;1283
0016d8  f88d7002          STRB     r7,[sp,#2]            ;1284
0016dc  f88d7003          STRB     r7,[sp,#3]            ;1285
0016e0  4669              MOV      r1,sp                 ;1286
0016e2  f1040014          ADD      r0,r4,#0x14           ;1286
0016e6  f7fffffe          BL       lc640_write_long_ptr
0016ea  f88d7000          STRB     r7,[sp,#0]            ;1288
0016ee  f88d7001          STRB     r7,[sp,#1]            ;1289
0016f2  f88d7002          STRB     r7,[sp,#2]            ;1290
0016f6  f88d7003          STRB     r7,[sp,#3]            ;1291
0016fa  4669              MOV      r1,sp                 ;1292
0016fc  f1040018          ADD      r0,r4,#0x18           ;1292
001700  f7fffffe          BL       lc640_write_long_ptr
001704  f88d7000          STRB     r7,[sp,#0]            ;1294
001708  f88d7001          STRB     r7,[sp,#1]            ;1295
00170c  f88d7002          STRB     r7,[sp,#2]            ;1296
001710  f88d7003          STRB     r7,[sp,#3]            ;1297
001714  4669              MOV      r1,sp                 ;1298
001716  f104001c          ADD      r0,r4,#0x1c           ;1298
00171a  f7fffffe          BL       lc640_write_long_ptr
00171e  2e01              CMP      r6,#1                 ;1299
001720  d110              BNE      |L1.5956|
001722  b115              CBZ      r5,|L1.5930|
001724  2d01              CMP      r5,#1                 ;1305
001726  d007              BEQ      |L1.5944|
001728  e00c              B        |L1.5956|
                  |L1.5930|
00172a  2301              MOVS     r3,#1                 ;1303
00172c  461a              MOV      r2,r3                 ;1303
00172e  210a              MOVS     r1,#0xa               ;1303
001730  a05c              ADR      r0,|L1.6308|
001732  f7fffffe          BL       snmp_trap_send
001736  e005              B        |L1.5956|
                  |L1.5944|
001738  2301              MOVS     r3,#1                 ;1307
00173a  2202              MOVS     r2,#2                 ;1307
00173c  210a              MOVS     r1,#0xa               ;1307
00173e  a05f              ADR      r0,|L1.6332|
001740  f7fffffe          BL       snmp_trap_send
                  |L1.5956|
001744  2e03              CMP      r6,#3                 ;1310
001746  d108              BNE      |L1.5978|
001748  b145              CBZ      r5,|L1.5980|
00174a  2d01              CMP      r5,#1                 ;1316
00174c  d105              BNE      |L1.5978|
00174e  2301              MOVS     r3,#1                 ;1318
001750  2202              MOVS     r2,#2                 ;1318
001752  210b              MOVS     r1,#0xb               ;1318
001754  a05f              ADR      r0,|L1.6356|
001756  f7fffffe          BL       snmp_trap_send
                  |L1.5978|
;;;1368   
;;;1369   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1370   
;;;1371        	lc640_read_long_ptr(lc640_adr,data);
;;;1372        
;;;1373        	if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='T')&&(data[3]==temp)))
;;;1374        		{        
;;;1375        		if(event_ptr_find)event_ptr_find--;
;;;1376        		else event_ptr_find=63;
;;;1377        		if(event_ptr_find==event_ptr)				{
;;;1378   				lc640_adr=0;
;;;1379   				break;
;;;1380   				}
;;;1381        		else continue;
;;;1382        		}
;;;1383   	     else 
;;;1384   	     	{
;;;1385   	     	lc640_read_long_ptr(lc640_adr+16,data);
;;;1386   	     	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1387   	     		{        
;;;1388   	     		if(event_ptr_find)event_ptr_find--;
;;;1389   	         	else event_ptr_find=63;
;;;1390   	         	if(event_ptr_find==event_ptr)				{
;;;1391   					lc640_adr=0;
;;;1392   					break;
;;;1393   					}
;;;1394   	     		else continue;
;;;1395   	     		}
;;;1396   	
;;;1397   	     	}
;;;1398   		}
;;;1399        		
;;;1400   	data[0]=LPC_RTC->YEAR;
;;;1401   	data[1]=LPC_RTC->MONTH;
;;;1402   	data[2]=LPC_RTC->DOM;
;;;1403   	data[3]=0;
;;;1404   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1405   
;;;1406   	data[0]=LPC_RTC->HOUR;
;;;1407   	data[1]=LPC_RTC->MIN;
;;;1408   	data[2]=LPC_RTC->SEC;
;;;1409   	data[3]=0;
;;;1410   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1411   	
;;;1412   	data[0]='B';
;;;1413   	data[1]='B';
;;;1414   	data[2]='B';
;;;1415   	data[3]='B';
;;;1416   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1417   	
;;;1418   	data[0]='B';
;;;1419   	data[1]='B';
;;;1420   	data[2]='B';
;;;1421   	data[3]='B';
;;;1422   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1423   	
;;;1424   	if(in==1)
;;;1425   		{				
;;;1426   		if(b==0)
;;;1427   			{
;;;1428   			snmp_trap_send("BAT #1 Alarm, heating eliminated",10,1,0);
;;;1429   			}
;;;1430   		else if(b==1)
;;;1431   			{
;;;1432   			snmp_trap_send("BAT #2 Alarm, heating eliminated",10,2,0);
;;;1433   			} 
;;;1434   		}
;;;1435   	if(in==3)
;;;1436   		{				
;;;1437   		if(b==0)
;;;1438   			{
;;;1439   			snmp_trap_send("BAT #1 Alarm, overheating eliminated",11,1,0);
;;;1440   			}
;;;1441   		else if(b==1)
;;;1442   			{
;;;1443   			snmp_trap_send("BAT #2 Alarm, overheating eliminated",11,2,0);
;;;1444   			} 
;;;1445   		}		
;;;1446   	
;;;1447   	}
;;;1448   	
;;;1449   }
00175a  e5bd              B        |L1.4824|
                  |L1.5980|
00175c  2301              MOVS     r3,#1                 ;1314
00175e  461a              MOV      r2,r3                 ;1314
001760  210b              MOVS     r1,#0xb               ;1314
001762  a063              ADR      r0,|L1.6384|
001764  f7fffffe          BL       snmp_trap_send
001768  e5b6              B        |L1.4824|
                  |L1.5994|
00176a  f04f0b33          MOV      r11,#0x33             ;1367
                  |L1.5998|
00176e  f44f6080          MOV      r0,#0x400             ;1369
001772  eb001044          ADD      r0,r0,r4,LSL #5       ;1369
001776  b287              UXTH     r7,r0                 ;1369
001778  4669              MOV      r1,sp                 ;1371
00177a  4638              MOV      r0,r7                 ;1371
00177c  f7fffffe          BL       lc640_read_long_ptr
001780  f89d0000          LDRB     r0,[sp,#0]            ;1373
001784  2842              CMP      r0,#0x42              ;1373
001786  d10b              BNE      |L1.6048|
001788  f89d0001          LDRB     r0,[sp,#1]            ;1373
00178c  42a8              CMP      r0,r5                 ;1373
00178e  d107              BNE      |L1.6048|
001790  f89d0002          LDRB     r0,[sp,#2]            ;1373
001794  2854              CMP      r0,#0x54              ;1373
001796  d103              BNE      |L1.6048|
001798  f89d0003          LDRB     r0,[sp,#3]            ;1373
00179c  4558              CMP      r0,r11                ;1373
00179e  d00b              BEQ      |L1.6072|
                  |L1.6048|
0017a0  b11c              CBZ      r4,|L1.6058|
0017a2  f1a40401          SUB      r4,r4,#1              ;1375
0017a6  b2a4              UXTH     r4,r4                 ;1375
0017a8  e001              B        |L1.6062|
                  |L1.6058|
0017aa  f04f043f          MOV      r4,#0x3f              ;1376
                  |L1.6062|
0017ae  454c              CMP      r4,r9                 ;1377
0017b0  d123              BNE      |L1.6138|
0017b2  f04f0700          MOV      r7,#0                 ;1378
0017b6  e028              B        |L1.6154|
                  |L1.6072|
0017b8  4669              MOV      r1,sp                 ;1385
0017ba  f1070010          ADD      r0,r7,#0x10           ;1385
0017be  f7fffffe          BL       lc640_read_long_ptr
0017c2  f89d0000          LDRB     r0,[sp,#0]            ;1386
0017c6  2841              CMP      r0,#0x41              ;1386
0017c8  d10b              BNE      |L1.6114|
0017ca  f89d0001          LDRB     r0,[sp,#1]            ;1386
0017ce  2841              CMP      r0,#0x41              ;1386
0017d0  d107              BNE      |L1.6114|
0017d2  f89d0002          LDRB     r0,[sp,#2]            ;1386
0017d6  2841              CMP      r0,#0x41              ;1386
0017d8  d103              BNE      |L1.6114|
0017da  f89d0003          LDRB     r0,[sp,#3]            ;1386
0017de  2841              CMP      r0,#0x41              ;1386
0017e0  d00b              BEQ      |L1.6138|
                  |L1.6114|
0017e2  b11c              CBZ      r4,|L1.6124|
0017e4  f1a40401          SUB      r4,r4,#1              ;1388
0017e8  b2a4              UXTH     r4,r4                 ;1388
0017ea  e001              B        |L1.6128|
                  |L1.6124|
0017ec  f04f043f          MOV      r4,#0x3f              ;1389
                  |L1.6128|
0017f0  454c              CMP      r4,r9                 ;1390
0017f2  d102              BNE      |L1.6138|
0017f4  f04f0700          MOV      r7,#0                 ;1391
0017f8  e007              B        |L1.6154|
                  |L1.6138|
0017fa  f1080801          ADD      r8,r8,#1              ;1364
0017fe  f00808ff          AND      r8,r8,#0xff           ;1364
001802  f1b80f3f          CMP      r8,#0x3f              ;1364
001806  f4ffaee5          BCC      |L1.5588|
                  |L1.6154|
00180a  f8ba003c          LDRH     r0,[r10,#0x3c]        ;1400
00180e  f88d0000          STRB     r0,[sp,#0]            ;1400
001812  f89a0038          LDRB     r0,[r10,#0x38]        ;1401
001816  f88d0001          STRB     r0,[sp,#1]            ;1401
00181a  f89a002c          LDRB     r0,[r10,#0x2c]        ;1402
00181e  f88d0002          STRB     r0,[sp,#2]            ;1402
001822  f04f0400          MOV      r4,#0                 ;1403
001826  f88d4003          STRB     r4,[sp,#3]            ;1403
00182a  4669              MOV      r1,sp                 ;1404
00182c  f1070010          ADD      r0,r7,#0x10           ;1404
001830  f7fffffe          BL       lc640_write_long_ptr
001834  f89a0028          LDRB     r0,[r10,#0x28]        ;1406
001838  f88d0000          STRB     r0,[sp,#0]            ;1406
00183c  f89a0024          LDRB     r0,[r10,#0x24]        ;1407
001840  f88d0001          STRB     r0,[sp,#1]            ;1407
001844  f89a0020          LDRB     r0,[r10,#0x20]        ;1408
001848  f88d0002          STRB     r0,[sp,#2]            ;1408
00184c  f88d4003          STRB     r4,[sp,#3]            ;1409
001850  4669              MOV      r1,sp                 ;1410
001852  f1070014          ADD      r0,r7,#0x14           ;1410
001856  f7fffffe          BL       lc640_write_long_ptr
00185a  f04f0442          MOV      r4,#0x42              ;1412
00185e  f88d4000          STRB     r4,[sp,#0]            ;1412
001862  f88d4001          STRB     r4,[sp,#1]            ;1413
001866  f88d4002          STRB     r4,[sp,#2]            ;1414
00186a  f88d4003          STRB     r4,[sp,#3]            ;1415
00186e  4669              MOV      r1,sp                 ;1416
001870  f1070018          ADD      r0,r7,#0x18           ;1416
001874  e04a              B        |L1.6412|
001876  0000              DCW      0x0000
                  |L1.6264|
001878  42415420          DCB      "BAT #1 Alarm, lost",0
00187c  23312041
001880  6c61726d
001884  2c206c6f
001888  737400  
00188b  00                DCB      0
                  |L1.6284|
00188c  42415420          DCB      "BAT #2 Alarm, lost",0
001890  23322041
001894  6c61726d
001898  2c206c6f
00189c  737400  
00189f  00                DCB      0
                  |L1.6304|
                          DCD      0x40024000
                  |L1.6308|
0018a4  42415420          DCB      "BAT #1 Alarm, is heated",0
0018a8  23312041
0018ac  6c61726d
0018b0  2c206973
0018b4  20686561
0018b8  74656400
                  |L1.6332|
0018bc  42415420          DCB      "BAT #2 Alarm, is heated",0
0018c0  23322041
0018c4  6c61726d
0018c8  2c206973
0018cc  20686561
0018d0  74656400
                  |L1.6356|
0018d4  42415420          DCB      "BAT #2 Alarm, is overheated",0
0018d8  23322041
0018dc  6c61726d
0018e0  2c206973
0018e4  206f7665
0018e8  72686561
0018ec  74656400
                  |L1.6384|
0018f0  42415420          DCB      "BAT #1 Alarm, is overheated",0
0018f4  23312041
0018f8  6c61726d
0018fc  2c206973
001900  206f7665
001904  72686561
001908  74656400
                  |L1.6412|
00190c  f7fffffe          BL       lc640_write_long_ptr
001910  f88d4000          STRB     r4,[sp,#0]            ;1418
001914  f88d4001          STRB     r4,[sp,#1]            ;1419
001918  f88d4002          STRB     r4,[sp,#2]            ;1420
00191c  f88d4003          STRB     r4,[sp,#3]            ;1421
001920  4669              MOV      r1,sp                 ;1422
001922  f107001c          ADD      r0,r7,#0x1c           ;1422
001926  f7fffffe          BL       lc640_write_long_ptr
00192a  2e01              CMP      r6,#1                 ;1424
00192c  d110              BNE      |L1.6480|
00192e  b115              CBZ      r5,|L1.6454|
001930  2d01              CMP      r5,#1                 ;1430
001932  d007              BEQ      |L1.6468|
001934  e00c              B        |L1.6480|
                  |L1.6454|
001936  2300              MOVS     r3,#0                 ;1428
001938  2201              MOVS     r2,#1                 ;1428
00193a  210a              MOVS     r1,#0xa               ;1428
00193c  a0e9              ADR      r0,|L1.7396|
00193e  f7fffffe          BL       snmp_trap_send
001942  e005              B        |L1.6480|
                  |L1.6468|
001944  2300              MOVS     r3,#0                 ;1432
001946  2202              MOVS     r2,#2                 ;1432
001948  210a              MOVS     r1,#0xa               ;1432
00194a  a0ef              ADR      r0,|L1.7432|
00194c  f7fffffe          BL       snmp_trap_send
                  |L1.6480|
001950  2e03              CMP      r6,#3                 ;1435
                  |L1.6482|
001952  f47faf02          BNE      |L1.5978|
001956  b145              CBZ      r5,|L1.6506|
001958  2d01              CMP      r5,#1                 ;1441
00195a  d1fa              BNE      |L1.6482|
00195c  2300              MOVS     r3,#0                 ;1443
00195e  2202              MOVS     r2,#2                 ;1443
001960  210b              MOVS     r1,#0xb               ;1443
001962  a0f2              ADR      r0,|L1.7468|
001964  f7fffffe          BL       snmp_trap_send
                  |L1.6504|
001968  e4b6              B        |L1.4824|
                  |L1.6506|
00196a  2300              MOVS     r3,#0                 ;1439
00196c  2201              MOVS     r2,#1                 ;1439
00196e  210b              MOVS     r1,#0xb               ;1439
001970  a0f8              ADR      r0,|L1.7508|
001972  f7fffffe          BL       snmp_trap_send
001976  e4af              B        |L1.4824|
;;;1450   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1451   //-----------------------------------------------
;;;1452   void avar_bat_as_hndl(char b, char in)
001978  e92d4ff8          PUSH     {r3-r11,lr}
;;;1453   {
00197c  4606              MOV      r6,r0
;;;1454   char data[4];
;;;1455   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1456   
;;;1457   if(in==1)
;;;1458   	{
;;;1459   	bat[b]._av|=2;
00197e  48ff              LDR      r0,|L1.7548|
001980  eb060246          ADD      r2,r6,r6,LSL #1
;;;1460       
;;;1461   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1462   	event_ptr++;	
;;;1463   	if(event_ptr>63)event_ptr=0;	
;;;1464   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1465   	
;;;1466        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1467   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1468   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1469   	
;;;1470   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1471   	
;;;1472   	data[0]='B';
;;;1473   	data[1]=b;
;;;1474   	data[2]='S';
;;;1475   	data[3]=0;
;;;1476   	lc640_write_long_ptr(lc640_adr,data);
;;;1477   
;;;1478   	data[0]=0;
;;;1479   	data[1]=0;
;;;1480   	data[2]=0;
;;;1481   	data[3]=0;
;;;1482   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1483   
;;;1484   	data[0]=LPC_RTC->YEAR;
001984  f8df83f8          LDR      r8,|L1.7552|
001988  eb021206          ADD      r2,r2,r6,LSL #4       ;1459
00198c  f04f0a00          MOV      r10,#0                ;1463
001990  f04f0942          MOV      r9,#0x42              ;1472
001994  f44f6560          MOV      r5,#0xe00             ;1461
001998  f44f6b80          MOV      r11,#0x400            ;1470
00199c  eb000082          ADD      r0,r0,r2,LSL #2       ;1459
0019a0  2901              CMP      r1,#1                 ;1457
0019a2  d002              BEQ      |L1.6570|
;;;1485   	data[1]=LPC_RTC->MONTH;
;;;1486   	data[2]=LPC_RTC->DOM;
;;;1487   	data[3]=0;
;;;1488   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1489   
;;;1490   	data[0]=LPC_RTC->HOUR;
;;;1491   	data[1]=LPC_RTC->MIN;
;;;1492   	data[2]=LPC_RTC->SEC;
;;;1493   	data[3]=0;
;;;1494   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1495   	
;;;1496   	data[0]='A';
;;;1497   	data[1]='A';
;;;1498   	data[2]='A';
;;;1499   	data[3]='A';
;;;1500   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1501   	
;;;1502   	data[0]='A';
;;;1503   	data[1]='A';
;;;1504   	data[2]='A';
;;;1505   	data[3]='A';
;;;1506   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1507   	
;;;1508   	data[0]='A';
;;;1509   	data[1]='A';
;;;1510   	data[2]='A';
;;;1511   	data[3]='A';
;;;1512   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1513   	
;;;1514   	data[0]='A';
;;;1515   	data[1]='A';
;;;1516   	data[2]='A';
;;;1517   	data[3]='A';
;;;1518   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1519   
;;;1520   	if(b==0)
;;;1521   		{
;;;1522   		snmp_trap_send("BAT #1 Alarm, assimetry",5,1,2);
;;;1523   		}
;;;1524   	else if(b==1)
;;;1525   		{
;;;1526   		snmp_trap_send("BAT #2 Alarm, assimetry",5,2,2);
;;;1527   		} 
;;;1528   	
;;;1529   	}
;;;1530   
;;;1531   else if(in==0)
0019a4  2900              CMP      r1,#0
0019a6  d07d              BEQ      |L1.6820|
0019a8  e12f              B        |L1.7178|
                  |L1.6570|
0019aa  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1459
0019ae  f0410102          ORR      r1,r1,#2              ;1459
0019b2  7001              STRB     r1,[r0,#0]            ;1459
0019b4  4628              MOV      r0,r5                 ;1461
0019b6  f7fffffe          BL       lc640_read_int
0019ba  f1000001          ADD      r0,r0,#1              ;1462
0019be  b284              UXTH     r4,r0                 ;1462
0019c0  2c3f              CMP      r4,#0x3f              ;1463
0019c2  d901              BLS      |L1.6600|
0019c4  f04f0400          MOV      r4,#0                 ;1463
                  |L1.6600|
0019c8  b221              SXTH     r1,r4                 ;1464
0019ca  4628              MOV      r0,r5                 ;1464
0019cc  f7fffffe          BL       lc640_write_int
0019d0  f6406702          MOV      r7,#0xe02             ;1466
0019d4  4638              MOV      r0,r7                 ;1466
0019d6  f7fffffe          BL       lc640_read_int
0019da  b280              UXTH     r0,r0                 ;1466
0019dc  283f              CMP      r0,#0x3f              ;1467
0019de  d000              BEQ      |L1.6626|
0019e0  4620              MOV      r0,r4                 ;1467
                  |L1.6626|
0019e2  b201              SXTH     r1,r0                 ;1468
0019e4  4638              MOV      r0,r7                 ;1468
0019e6  f7fffffe          BL       lc640_write_int
0019ea  4628              MOV      r0,r5                 ;1470
0019ec  f7fffffe          BL       lc640_read_int
0019f0  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1470
0019f4  b284              UXTH     r4,r0                 ;1470
0019f6  f88d9000          STRB     r9,[sp,#0]            ;1472
0019fa  f88d6001          STRB     r6,[sp,#1]            ;1473
0019fe  f04f0053          MOV      r0,#0x53              ;1474
001a02  f88d0002          STRB     r0,[sp,#2]            ;1474
001a06  f88da003          STRB     r10,[sp,#3]           ;1475
001a0a  4669              MOV      r1,sp                 ;1476
001a0c  4620              MOV      r0,r4                 ;1476
001a0e  f7fffffe          BL       lc640_write_long_ptr
001a12  f8cda000          STR      r10,[sp,#0]           ;1481
001a16  4669              MOV      r1,sp                 ;1482
001a18  1d20              ADDS     r0,r4,#4              ;1482
001a1a  f7fffffe          BL       lc640_write_long_ptr
001a1e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1484
001a22  f88d0000          STRB     r0,[sp,#0]            ;1484
001a26  f8980038          LDRB     r0,[r8,#0x38]         ;1485
001a2a  f88d0001          STRB     r0,[sp,#1]            ;1485
001a2e  f898002c          LDRB     r0,[r8,#0x2c]         ;1486
001a32  f88d0002          STRB     r0,[sp,#2]            ;1486
001a36  f88da003          STRB     r10,[sp,#3]           ;1487
001a3a  4669              MOV      r1,sp                 ;1488
001a3c  f1040008          ADD      r0,r4,#8              ;1488
001a40  f7fffffe          BL       lc640_write_long_ptr
001a44  f8980028          LDRB     r0,[r8,#0x28]         ;1490
001a48  f88d0000          STRB     r0,[sp,#0]            ;1490
001a4c  f8980024          LDRB     r0,[r8,#0x24]         ;1491
001a50  f88d0001          STRB     r0,[sp,#1]            ;1491
001a54  f8980020          LDRB     r0,[r8,#0x20]         ;1492
001a58  f88d0002          STRB     r0,[sp,#2]            ;1492
001a5c  f88da003          STRB     r10,[sp,#3]           ;1493
001a60  4669              MOV      r1,sp                 ;1494
001a62  f104000c          ADD      r0,r4,#0xc            ;1494
001a66  f7fffffe          BL       lc640_write_long_ptr
001a6a  f04f0541          MOV      r5,#0x41              ;1496
001a6e  f88d5000          STRB     r5,[sp,#0]            ;1496
001a72  f88d5001          STRB     r5,[sp,#1]            ;1497
001a76  f88d5002          STRB     r5,[sp,#2]            ;1498
001a7a  f88d5003          STRB     r5,[sp,#3]            ;1499
001a7e  4669              MOV      r1,sp                 ;1500
001a80  f1040010          ADD      r0,r4,#0x10           ;1500
001a84  f7fffffe          BL       lc640_write_long_ptr
001a88  f88d5000          STRB     r5,[sp,#0]            ;1502
001a8c  f88d5001          STRB     r5,[sp,#1]            ;1503
001a90  f88d5002          STRB     r5,[sp,#2]            ;1504
001a94  f88d5003          STRB     r5,[sp,#3]            ;1505
001a98  4669              MOV      r1,sp                 ;1506
001a9a  f1040014          ADD      r0,r4,#0x14           ;1506
001a9e  f7fffffe          BL       lc640_write_long_ptr
001aa2  e000              B        |L1.6822|
                  |L1.6820|
001aa4  e02b              B        |L1.6910|
                  |L1.6822|
001aa6  f88d5000          STRB     r5,[sp,#0]            ;1508
001aaa  f88d5001          STRB     r5,[sp,#1]            ;1509
001aae  f88d5002          STRB     r5,[sp,#2]            ;1510
001ab2  f88d5003          STRB     r5,[sp,#3]            ;1511
001ab6  4669              MOV      r1,sp                 ;1512
001ab8  f1040018          ADD      r0,r4,#0x18           ;1512
001abc  f7fffffe          BL       lc640_write_long_ptr
001ac0  f88d5000          STRB     r5,[sp,#0]            ;1514
001ac4  f88d5001          STRB     r5,[sp,#1]            ;1515
001ac8  f88d5002          STRB     r5,[sp,#2]            ;1516
001acc  f88d5003          STRB     r5,[sp,#3]            ;1517
001ad0  4669              MOV      r1,sp                 ;1518
001ad2  f104001c          ADD      r0,r4,#0x1c           ;1518
001ad6  f7fffffe          BL       lc640_write_long_ptr
001ada  b116              CBZ      r6,|L1.6882|
001adc  2e01              CMP      r6,#1                 ;1524
001ade  d007              BEQ      |L1.6896|
001ae0  e093              B        |L1.7178|
                  |L1.6882|
001ae2  2302              MOVS     r3,#2                 ;1522
001ae4  2201              MOVS     r2,#1                 ;1522
001ae6  2105              MOVS     r1,#5                 ;1522
001ae8  a0a6              ADR      r0,|L1.7556|
001aea  f7fffffe          BL       snmp_trap_send
001aee  e08c              B        |L1.7178|
                  |L1.6896|
001af0  2302              MOVS     r3,#2                 ;1526
001af2  461a              MOV      r2,r3                 ;1526
001af4  2105              MOVS     r1,#5                 ;1526
001af6  a0a9              ADR      r0,|L1.7580|
001af8  f7fffffe          BL       snmp_trap_send
001afc  e085              B        |L1.7178|
                  |L1.6910|
;;;1532   	{
;;;1533   	bat[b]._av&=~(1<<1);
001afe  f8101f3d          LDRB     r1,[r0,#0x3d]!
001b02  f0210102          BIC      r1,r1,#2
001b06  7001              STRB     r1,[r0,#0]
;;;1534   
;;;1535        event_ptr=lc640_read_int(PTR_EVENT_LOG);
001b08  4628              MOV      r0,r5
001b0a  f7fffffe          BL       lc640_read_int
001b0e  b287              UXTH     r7,r0
;;;1536   	event_ptr_find=event_ptr;
001b10  463c              MOV      r4,r7
                  |L1.6930|
;;;1537   	
;;;1538   avar_bat_as_hndl_lbl1: 
;;;1539   
;;;1540   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001b12  eb0b1044          ADD      r0,r11,r4,LSL #5
001b16  b285              UXTH     r5,r0
;;;1541   
;;;1542        lc640_read_long_ptr(lc640_adr,data);
001b18  4669              MOV      r1,sp
001b1a  4628              MOV      r0,r5
001b1c  f7fffffe          BL       lc640_read_long_ptr
;;;1543        
;;;1544        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
001b20  f89d0000          LDRB     r0,[sp,#0]
001b24  2842              CMP      r0,#0x42
001b26  d107              BNE      |L1.6968|
001b28  f89d0001          LDRB     r0,[sp,#1]
001b2c  42b0              CMP      r0,r6
001b2e  d103              BNE      |L1.6968|
001b30  f89d0002          LDRB     r0,[sp,#2]
001b34  2843              CMP      r0,#0x43
001b36  d009              BEQ      |L1.6988|
                  |L1.6968|
;;;1545        	{        
;;;1546        	if(event_ptr_find)event_ptr_find--;
001b38  b11c              CBZ      r4,|L1.6978|
001b3a  f1a40401          SUB      r4,r4,#1
001b3e  b2a4              UXTH     r4,r4
001b40  e001              B        |L1.6982|
                  |L1.6978|
;;;1547        	else event_ptr_find=63;
001b42  f04f043f          MOV      r4,#0x3f
                  |L1.6982|
;;;1548        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001b46  42bc              CMP      r4,r7
001b48  d1e3              BNE      |L1.6930|
001b4a  e05e              B        |L1.7178|
                  |L1.6988|
;;;1549        	else goto avar_bat_as_hndl_lbl1;
;;;1550        	}
;;;1551        else 
;;;1552        	{
;;;1553        	lc640_read_long_ptr(lc640_adr+16,data);
001b4c  4669              MOV      r1,sp
001b4e  f1050010          ADD      r0,r5,#0x10
001b52  f7fffffe          BL       lc640_read_long_ptr
;;;1554        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001b56  f89d0000          LDRB     r0,[sp,#0]
001b5a  2841              CMP      r0,#0x41
001b5c  d10b              BNE      |L1.7030|
001b5e  f89d0001          LDRB     r0,[sp,#1]
001b62  2841              CMP      r0,#0x41
001b64  d107              BNE      |L1.7030|
001b66  f89d0002          LDRB     r0,[sp,#2]
001b6a  2841              CMP      r0,#0x41
001b6c  d103              BNE      |L1.7030|
001b6e  f89d0003          LDRB     r0,[sp,#3]
001b72  2841              CMP      r0,#0x41
001b74  d009              BEQ      |L1.7050|
                  |L1.7030|
;;;1555        		{        
;;;1556        		if(event_ptr_find)event_ptr_find--;
001b76  b11c              CBZ      r4,|L1.7040|
001b78  f1a40401          SUB      r4,r4,#1
001b7c  b2a4              UXTH     r4,r4
001b7e  e001              B        |L1.7044|
                  |L1.7040|
;;;1557            		else event_ptr_find=63;
001b80  f04f043f          MOV      r4,#0x3f
                  |L1.7044|
;;;1558            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001b84  42bc              CMP      r4,r7
001b86  d1c4              BNE      |L1.6930|
001b88  e03f              B        |L1.7178|
                  |L1.7050|
;;;1559        		else goto avar_bat_as_hndl_lbl1;
;;;1560        		}
;;;1561   
;;;1562        	}
;;;1563        		
;;;1564   	data[0]=LPC_RTC->YEAR;
001b8a  f8b8003c          LDRH     r0,[r8,#0x3c]
001b8e  f88d0000          STRB     r0,[sp,#0]
;;;1565   	data[1]=LPC_RTC->MONTH;
001b92  f8980038          LDRB     r0,[r8,#0x38]
001b96  f88d0001          STRB     r0,[sp,#1]
;;;1566   	data[2]=LPC_RTC->DOM;
001b9a  f898002c          LDRB     r0,[r8,#0x2c]
001b9e  f88d0002          STRB     r0,[sp,#2]
;;;1567   	data[3]=0;
001ba2  f88da003          STRB     r10,[sp,#3]
;;;1568   	lc640_write_long_ptr(lc640_adr+16,data);
001ba6  4669              MOV      r1,sp
001ba8  f1050010          ADD      r0,r5,#0x10
001bac  f7fffffe          BL       lc640_write_long_ptr
;;;1569   
;;;1570   	data[0]=LPC_RTC->HOUR;
001bb0  f8980028          LDRB     r0,[r8,#0x28]
001bb4  f88d0000          STRB     r0,[sp,#0]
;;;1571   	data[1]=LPC_RTC->MIN;
001bb8  f8980024          LDRB     r0,[r8,#0x24]
001bbc  f88d0001          STRB     r0,[sp,#1]
;;;1572   	data[2]=LPC_RTC->SEC;
001bc0  f8980020          LDRB     r0,[r8,#0x20]
001bc4  f88d0002          STRB     r0,[sp,#2]
;;;1573   	data[3]=0;
001bc8  f88da003          STRB     r10,[sp,#3]
;;;1574   	lc640_write_long_ptr(lc640_adr+20,data);
001bcc  4669              MOV      r1,sp
001bce  f1050014          ADD      r0,r5,#0x14
001bd2  f7fffffe          BL       lc640_write_long_ptr
;;;1575   	
;;;1576   	data[0]='B';
001bd6  f88d9000          STRB     r9,[sp,#0]
;;;1577   	data[1]='B';
001bda  f88d9001          STRB     r9,[sp,#1]
;;;1578   	data[2]='B';
001bde  f88d9002          STRB     r9,[sp,#2]
;;;1579   	data[3]='B';
001be2  f88d9003          STRB     r9,[sp,#3]
;;;1580   	lc640_write_long_ptr(lc640_adr+24,data);
001be6  4669              MOV      r1,sp
001be8  f1050018          ADD      r0,r5,#0x18
001bec  f7fffffe          BL       lc640_write_long_ptr
;;;1581   	
;;;1582   	data[0]='B';
001bf0  f88d9000          STRB     r9,[sp,#0]
;;;1583   	data[1]='B';
001bf4  f88d9001          STRB     r9,[sp,#1]
;;;1584   	data[2]='B';
001bf8  f88d9002          STRB     r9,[sp,#2]
;;;1585   	data[3]='B';
001bfc  f88d9003          STRB     r9,[sp,#3]
;;;1586   	lc640_write_long_ptr(lc640_adr+28,data);
001c00  4669              MOV      r1,sp
001c02  f105001c          ADD      r0,r5,#0x1c
001c06  f7fffffe          BL       lc640_write_long_ptr
                  |L1.7178|
;;;1587   	
;;;1588   
;;;1589   	
;;;1590   	}
;;;1591   	
;;;1592   avar_bat_as_hndl_end:
;;;1593   __nop();		
001c0a  bf00              NOP      
                  |L1.7180|
;;;1594   }
001c0c  e4c9              B        |L1.5538|
;;;1595   
                          ENDP

                  ke_zvu_mem_hndl PROC
;;;1596   //-----------------------------------------------
;;;1597   void ke_zvu_mem_hndl(char b,unsigned short in,unsigned short in1)
001c0e  b5f7              PUSH     {r0-r2,r4-r7,lr}
;;;1598   {
001c10  b082              SUB      sp,sp,#8
001c12  4605              MOV      r5,r0
;;;1599   char data[4];
;;;1600   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1601   //unsigned char temp,temp_;
;;;1602   //unsigned int tempUI;
;;;1603   //unsigned long tempUL; 
;;;1604   signed temp_temp;
;;;1605   
;;;1606   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
001c14  eb050045          ADD      r0,r5,r5,LSL #1
001c18  4958              LDR      r1,|L1.7548|
001c1a  eb001005          ADD      r0,r0,r5,LSL #4
001c1e  eb010180          ADD      r1,r1,r0,LSL #2
001c22  4864              LDR      r0,|L1.7604|
001c24  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
001c28  f1000001          ADD      r0,r0,#1
001c2c  eb010040          ADD      r0,r1,r0,LSL #1
001c30  f9b00020          LDRSH    r0,[r0,#0x20]
001c34  9000              STR      r0,[sp,#0]
;;;1607   
;;;1608   event_ptr=lc640_read_int(PTR_EVENT_LOG);
001c36  f44f6660          MOV      r6,#0xe00
001c3a  4630              MOV      r0,r6
001c3c  f7fffffe          BL       lc640_read_int
;;;1609   event_ptr++;	
001c40  f1000001          ADD      r0,r0,#1
001c44  4604              MOV      r4,r0
;;;1610   if(event_ptr>63)event_ptr=0;	
001c46  2c3f              CMP      r4,#0x3f
001c48  d901              BLS      |L1.7246|
001c4a  f04f0400          MOV      r4,#0
                  |L1.7246|
;;;1611   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
001c4e  b221              SXTH     r1,r4
001c50  4630              MOV      r0,r6
001c52  f7fffffe          BL       lc640_write_int
;;;1612   	
;;;1613   event_cnt=lc640_read_int(CNT_EVENT_LOG);
001c56  f6406702          MOV      r7,#0xe02
001c5a  4638              MOV      r0,r7
001c5c  f7fffffe          BL       lc640_read_int
;;;1614   if(event_cnt!=63)event_cnt=event_ptr;
001c60  283f              CMP      r0,#0x3f
001c62  d000              BEQ      |L1.7270|
001c64  4620              MOV      r0,r4
                  |L1.7270|
;;;1615   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
001c66  b201              SXTH     r1,r0
001c68  4638              MOV      r0,r7
001c6a  f7fffffe          BL       lc640_write_int
;;;1616   	
;;;1617   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
001c6e  4630              MOV      r0,r6
001c70  f7fffffe          BL       lc640_read_int
001c74  f44f6180          MOV      r1,#0x400
001c78  eb011440          ADD      r4,r1,r0,LSL #5
;;;1618   	
;;;1619   data[0]='B';
001c7c  f04f0042          MOV      r0,#0x42
001c80  f88d0004          STRB     r0,[sp,#4]
;;;1620   data[1]=b; 
001c84  f88d5005          STRB     r5,[sp,#5]
;;;1621   data[2]='K';
001c88  f04f004b          MOV      r0,#0x4b
001c8c  f88d0006          STRB     r0,[sp,#6]
;;;1622   data[3]='Z';
001c90  f04f005a          MOV      r0,#0x5a
001c94  f88d0007          STRB     r0,[sp,#7]
;;;1623   
;;;1624   lc640_write_long_ptr(lc640_adr,data);
001c98  a901              ADD      r1,sp,#4
001c9a  4620              MOV      r0,r4
001c9c  f7fffffe          BL       lc640_write_long_ptr
;;;1625   
;;;1626   data[0]=*((char*)&in);
001ca0  f89d000c          LDRB     r0,[sp,#0xc]
001ca4  f88d0004          STRB     r0,[sp,#4]
;;;1627   data[1]=*(((char*)(&in))+1);
001ca8  f89d000d          LDRB     r0,[sp,#0xd]
001cac  f88d0005          STRB     r0,[sp,#5]
;;;1628   data[2]=*((char*)&temp_temp);
001cb0  f89d0000          LDRB     r0,[sp,#0]
001cb4  f88d0006          STRB     r0,[sp,#6]
;;;1629   data[3]=*(((char*)(&temp_temp))+1);
001cb8  f89d0001          LDRB     r0,[sp,#1]
001cbc  f88d0007          STRB     r0,[sp,#7]
;;;1630   lc640_write_long_ptr(lc640_adr+4,data);
001cc0  a901              ADD      r1,sp,#4
001cc2  1d20              ADDS     r0,r4,#4
001cc4  f7fffffe          BL       lc640_write_long_ptr
;;;1631   
;;;1632   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
001cc8  f24020a2          MOV      r0,#0x2a2
001ccc  f7fffffe          BL       lc640_read_long
001cd0  4d39              LDR      r5,|L1.7608|
001cd2  6028              STR      r0,[r5,#0]  ; ke_date
;;;1633   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
001cd4  4629              MOV      r1,r5
001cd6  f1040008          ADD      r0,r4,#8
001cda  f7fffffe          BL       lc640_write_long_ptr
;;;1634   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
001cde  f24020a6          MOV      r0,#0x2a6
001ce2  e06b              B        |L1.7612|
                  |L1.7396|
001ce4  42415420          DCB      "BAT #1 Alarm, heating eliminated",0
001ce8  23312041
001cec  6c61726d
001cf0  2c206865
001cf4  6174696e
001cf8  6720656c
001cfc  696d696e
001d00  61746564
001d04  00      
001d05  00                DCB      0
001d06  00                DCB      0
001d07  00                DCB      0
                  |L1.7432|
001d08  42415420          DCB      "BAT #2 Alarm, heating eliminated",0
001d0c  23322041
001d10  6c61726d
001d14  2c206865
001d18  6174696e
001d1c  6720656c
001d20  696d696e
001d24  61746564
001d28  00      
001d29  00                DCB      0
001d2a  00                DCB      0
001d2b  00                DCB      0
                  |L1.7468|
001d2c  42415420          DCB      "BAT #2 Alarm, overheating eliminated",0
001d30  23322041
001d34  6c61726d
001d38  2c206f76
001d3c  65726865
001d40  6174696e
001d44  6720656c
001d48  696d696e
001d4c  61746564
001d50  00      
001d51  00                DCB      0
001d52  00                DCB      0
001d53  00                DCB      0
                  |L1.7508|
001d54  42415420          DCB      "BAT #1 Alarm, overheating eliminated",0
001d58  23312041
001d5c  6c61726d
001d60  2c206f76
001d64  65726865
001d68  6174696e
001d6c  6720656c
001d70  696d696e
001d74  61746564
001d78  00      
001d79  00                DCB      0
001d7a  00                DCB      0
001d7b  00                DCB      0
                  |L1.7548|
                          DCD      bat
                  |L1.7552|
                          DCD      0x40024000
                  |L1.7556|
001d84  42415420          DCB      "BAT #1 Alarm, assimetry",0
001d88  23312041
001d8c  6c61726d
001d90  2c206173
001d94  73696d65
001d98  74727900
                  |L1.7580|
001d9c  42415420          DCB      "BAT #2 Alarm, assimetry",0
001da0  23322041
001da4  6c61726d
001da8  2c206173
001dac  73696d65
001db0  74727900
                  |L1.7604|
                          DCD      bat_u_old_cnt
                  |L1.7608|
                          DCD      ke_date
                  |L1.7612|
001dbc  f7fffffe          BL       lc640_read_long
001dc0  6068              STR      r0,[r5,#4]  ; ke_date
;;;1635   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
001dc2  1d29              ADDS     r1,r5,#4
001dc4  f104000c          ADD      r0,r4,#0xc
001dc8  f7fffffe          BL       lc640_write_long_ptr
;;;1636   
;;;1637   data[0]=LPC_RTC->YEAR;
001dcc  4dff              LDR      r5,|L1.8652|
001dce  8ba8              LDRH     r0,[r5,#0x1c]
001dd0  f88d0004          STRB     r0,[sp,#4]
;;;1638   data[1]=LPC_RTC->MONTH;
001dd4  7e28              LDRB     r0,[r5,#0x18]
001dd6  f88d0005          STRB     r0,[sp,#5]
;;;1639   data[2]=LPC_RTC->DOM;
001dda  7b28              LDRB     r0,[r5,#0xc]
001ddc  f88d0006          STRB     r0,[sp,#6]
;;;1640   data[3]=*((char*)&in1);
001de0  f89d0010          LDRB     r0,[sp,#0x10]
001de4  f88d0007          STRB     r0,[sp,#7]
;;;1641   lc640_write_long_ptr(lc640_adr+16,data);
001de8  a901              ADD      r1,sp,#4
001dea  f1040010          ADD      r0,r4,#0x10
001dee  f7fffffe          BL       lc640_write_long_ptr
;;;1642   
;;;1643   data[0]=LPC_RTC->HOUR;
001df2  7a28              LDRB     r0,[r5,#8]
001df4  f88d0004          STRB     r0,[sp,#4]
;;;1644   data[1]=LPC_RTC->MIN;
001df8  7928              LDRB     r0,[r5,#4]
001dfa  f88d0005          STRB     r0,[sp,#5]
;;;1645   data[2]=LPC_RTC->SEC;
001dfe  7828              LDRB     r0,[r5,#0]
001e00  f88d0006          STRB     r0,[sp,#6]
;;;1646   data[3]=*(((char*)(&in1))+1);
001e04  f89d0011          LDRB     r0,[sp,#0x11]
001e08  f88d0007          STRB     r0,[sp,#7]
;;;1647   lc640_write_long_ptr(lc640_adr+20,data);
001e0c  a901              ADD      r1,sp,#4
001e0e  f1040014          ADD      r0,r4,#0x14
001e12  f7fffffe          BL       lc640_write_long_ptr
;;;1648    
;;;1649   }
001e16  b005              ADD      sp,sp,#0x14
001e18  bdf0              POP      {r4-r7,pc}
;;;1650   
                          ENDP

                  vz_mem_hndl PROC
;;;1707   //-----------------------------------------------
;;;1708   void vz_mem_hndl(unsigned short in)
001e1a  e92d4ff8          PUSH     {r3-r11,lr}
;;;1709   {
;;;1710   char data[4];
;;;1711   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001e1e  f04f0600          MOV      r6,#0
001e22  4634              MOV      r4,r6
;;;1712   //char avar_simbol;
;;;1713   
;;;1714   if(in==1)
;;;1715   	{
;;;1716   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1717   	event_ptr++;	
;;;1718   	if(event_ptr>63)event_ptr=0;	
;;;1719   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1720   	
;;;1721        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1722   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1723   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1724   	
;;;1725   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1726   	
;;;1727   	data[0]='B';
;;;1728   	data[1]=0; 
;;;1729   	data[2]='Z';
;;;1730   	data[3]=0;
;;;1731   	lc640_write_long_ptr(lc640_adr,data);
;;;1732   
;;;1733   	data[0]=0;
;;;1734   	data[1]=0;
;;;1735   	data[2]=0;
;;;1736   	data[3]=0;
;;;1737   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1738   
;;;1739   	data[0]=LPC_RTC->YEAR;
001e24  f8df83a8          LDR      r8,|L1.8656|
001e28  46a1              MOV      r9,r4                 ;1711
001e2a  f04f0742          MOV      r7,#0x42              ;1727
001e2e  f44f6a80          MOV      r10,#0x400            ;1725
001e32  2801              CMP      r0,#1                 ;1714
001e34  d002              BEQ      |L1.7740|
;;;1740   	data[1]=LPC_RTC->MONTH;
;;;1741   	data[2]=LPC_RTC->DOM;
;;;1742   	data[3]=0;
;;;1743   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1744   
;;;1745   	data[0]=LPC_RTC->HOUR;
;;;1746   	data[1]=LPC_RTC->MIN;
;;;1747   	data[2]=LPC_RTC->SEC;
;;;1748   	data[3]=0;
;;;1749   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1750   	
;;;1751   	data[0]='A';
;;;1752   	data[1]='A';
;;;1753   	data[2]='A';
;;;1754   	data[3]='A';
;;;1755   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1756   	
;;;1757   	data[0]='A';
;;;1758   	data[1]='A';
;;;1759   	data[2]='A';
;;;1760   	data[3]='A';
;;;1761   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1762   	
;;;1763   	data[0]='A';
;;;1764   	data[1]='A';
;;;1765   	data[2]='A';
;;;1766   	data[3]='A';
;;;1767   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1768   	
;;;1769   	data[0]='A';
;;;1770   	data[1]='A';
;;;1771   	data[2]='A';
;;;1772   	data[3]='A';
;;;1773   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1774    	
;;;1775   	}
;;;1776   
;;;1777   else if(in==0)
001e36  2800              CMP      r0,#0
001e38  d07e              BEQ      |L1.7992|
001e3a  e108              B        |L1.8270|
                  |L1.7740|
001e3c  f44f6560          MOV      r5,#0xe00             ;1716
001e40  4628              MOV      r0,r5                 ;1716
001e42  f7fffffe          BL       lc640_read_int
001e46  f1000001          ADD      r0,r0,#1              ;1717
001e4a  4604              MOV      r4,r0                 ;1717
001e4c  2c3f              CMP      r4,#0x3f              ;1718
001e4e  d901              BLS      |L1.7764|
001e50  f04f0400          MOV      r4,#0                 ;1718
                  |L1.7764|
001e54  b221              SXTH     r1,r4                 ;1719
001e56  4628              MOV      r0,r5                 ;1719
001e58  f7fffffe          BL       lc640_write_int
001e5c  f6406602          MOV      r6,#0xe02             ;1721
001e60  4630              MOV      r0,r6                 ;1721
001e62  f7fffffe          BL       lc640_read_int
001e66  283f              CMP      r0,#0x3f              ;1722
001e68  d000              BEQ      |L1.7788|
001e6a  4620              MOV      r0,r4                 ;1722
                  |L1.7788|
001e6c  b201              SXTH     r1,r0                 ;1723
001e6e  4630              MOV      r0,r6                 ;1723
001e70  f7fffffe          BL       lc640_write_int
001e74  4628              MOV      r0,r5                 ;1725
001e76  f7fffffe          BL       lc640_read_int
001e7a  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1725
001e7e  f88d7000          STRB     r7,[sp,#0]            ;1727
001e82  f88d9001          STRB     r9,[sp,#1]            ;1728
001e86  f04f005a          MOV      r0,#0x5a              ;1729
001e8a  f88d0002          STRB     r0,[sp,#2]            ;1729
001e8e  f88d9003          STRB     r9,[sp,#3]            ;1730
001e92  4669              MOV      r1,sp                 ;1731
001e94  4620              MOV      r0,r4                 ;1731
001e96  f7fffffe          BL       lc640_write_long_ptr
001e9a  f8cd9000          STR      r9,[sp,#0]            ;1736
001e9e  4669              MOV      r1,sp                 ;1737
001ea0  1d20              ADDS     r0,r4,#4              ;1737
001ea2  f7fffffe          BL       lc640_write_long_ptr
001ea6  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1739
001eaa  f88d0000          STRB     r0,[sp,#0]            ;1739
001eae  f8980038          LDRB     r0,[r8,#0x38]         ;1740
001eb2  f88d0001          STRB     r0,[sp,#1]            ;1740
001eb6  f898002c          LDRB     r0,[r8,#0x2c]         ;1741
001eba  f88d0002          STRB     r0,[sp,#2]            ;1741
001ebe  f88d9003          STRB     r9,[sp,#3]            ;1742
001ec2  4669              MOV      r1,sp                 ;1743
001ec4  f1040008          ADD      r0,r4,#8              ;1743
001ec8  f7fffffe          BL       lc640_write_long_ptr
001ecc  f8980028          LDRB     r0,[r8,#0x28]         ;1745
001ed0  f88d0000          STRB     r0,[sp,#0]            ;1745
001ed4  f8980024          LDRB     r0,[r8,#0x24]         ;1746
001ed8  f88d0001          STRB     r0,[sp,#1]            ;1746
001edc  f8980020          LDRB     r0,[r8,#0x20]         ;1747
001ee0  f88d0002          STRB     r0,[sp,#2]            ;1747
001ee4  f88d9003          STRB     r9,[sp,#3]            ;1748
001ee8  4669              MOV      r1,sp                 ;1749
001eea  f104000c          ADD      r0,r4,#0xc            ;1749
001eee  f7fffffe          BL       lc640_write_long_ptr
001ef2  f04f0541          MOV      r5,#0x41              ;1751
001ef6  f88d5000          STRB     r5,[sp,#0]            ;1751
001efa  f88d5001          STRB     r5,[sp,#1]            ;1752
001efe  f88d5002          STRB     r5,[sp,#2]            ;1753
001f02  f88d5003          STRB     r5,[sp,#3]            ;1754
001f06  4669              MOV      r1,sp                 ;1755
001f08  f1040010          ADD      r0,r4,#0x10           ;1755
001f0c  f7fffffe          BL       lc640_write_long_ptr
001f10  f88d5000          STRB     r5,[sp,#0]            ;1757
001f14  f88d5001          STRB     r5,[sp,#1]            ;1758
001f18  f88d5002          STRB     r5,[sp,#2]            ;1759
001f1c  f88d5003          STRB     r5,[sp,#3]            ;1760
001f20  4669              MOV      r1,sp                 ;1761
001f22  f1040014          ADD      r0,r4,#0x14           ;1761
001f26  f7fffffe          BL       lc640_write_long_ptr
001f2a  f88d5000          STRB     r5,[sp,#0]            ;1763
001f2e  f88d5001          STRB     r5,[sp,#1]            ;1764
001f32  f88d5002          STRB     r5,[sp,#2]            ;1765
001f36  e000              B        |L1.7994|
                  |L1.7992|
001f38  e014              B        |L1.8036|
                  |L1.7994|
001f3a  f88d5003          STRB     r5,[sp,#3]            ;1766
001f3e  4669              MOV      r1,sp                 ;1767
001f40  f1040018          ADD      r0,r4,#0x18           ;1767
001f44  f7fffffe          BL       lc640_write_long_ptr
001f48  f88d5000          STRB     r5,[sp,#0]            ;1769
001f4c  f88d5001          STRB     r5,[sp,#1]            ;1770
001f50  f88d5002          STRB     r5,[sp,#2]            ;1771
001f54  f88d5003          STRB     r5,[sp,#3]            ;1772
001f58  4669              MOV      r1,sp                 ;1773
001f5a  f104001c          ADD      r0,r4,#0x1c           ;1773
001f5e  f7fffffe          BL       lc640_write_long_ptr
001f62  e074              B        |L1.8270|
                  |L1.8036|
;;;1778   	{      
;;;1779        
;;;1780   vz_mem_hndl_lbl1: 
;;;1781   
;;;1782   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001f64  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1783   
;;;1784        lc640_read_long_ptr(lc640_adr,data);
001f68  4669              MOV      r1,sp
001f6a  4628              MOV      r0,r5
001f6c  f7fffffe          BL       lc640_read_long_ptr
;;;1785        
;;;1786        if(!((data[0]=='B')&&(data[2]=='Z')))
001f70  f89d0000          LDRB     r0,[sp,#0]
001f74  2842              CMP      r0,#0x42
001f76  d103              BNE      |L1.8064|
001f78  f89d0002          LDRB     r0,[sp,#2]
001f7c  285a              CMP      r0,#0x5a
001f7e  d008              BEQ      |L1.8082|
                  |L1.8064|
;;;1787        	{        
;;;1788        	if(event_ptr_find)event_ptr_find--;
001f80  b114              CBZ      r4,|L1.8072|
001f82  f1a40401          SUB      r4,r4,#1
001f86  e001              B        |L1.8076|
                  |L1.8072|
;;;1789        	else event_ptr_find=63;
001f88  f04f043f          MOV      r4,#0x3f
                  |L1.8076|
;;;1790        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001f8c  42b4              CMP      r4,r6
001f8e  d1e9              BNE      |L1.8036|
001f90  e05d              B        |L1.8270|
                  |L1.8082|
;;;1791        	else goto vz_mem_hndl_lbl1;
;;;1792        	}
;;;1793        else 
;;;1794        	{
;;;1795        	lc640_read_long_ptr(lc640_adr+16,data);
001f92  4669              MOV      r1,sp
001f94  f1050010          ADD      r0,r5,#0x10
001f98  f7fffffe          BL       lc640_read_long_ptr
;;;1796        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001f9c  f89d0000          LDRB     r0,[sp,#0]
001fa0  2841              CMP      r0,#0x41
001fa2  d10b              BNE      |L1.8124|
001fa4  f89d0001          LDRB     r0,[sp,#1]
001fa8  2841              CMP      r0,#0x41
001faa  d107              BNE      |L1.8124|
001fac  f89d0002          LDRB     r0,[sp,#2]
001fb0  2841              CMP      r0,#0x41
001fb2  d103              BNE      |L1.8124|
001fb4  f89d0003          LDRB     r0,[sp,#3]
001fb8  2841              CMP      r0,#0x41
001fba  d008              BEQ      |L1.8142|
                  |L1.8124|
;;;1797        		{        
;;;1798        		if(event_ptr_find)event_ptr_find--;
001fbc  b114              CBZ      r4,|L1.8132|
001fbe  f1a40401          SUB      r4,r4,#1
001fc2  e001              B        |L1.8136|
                  |L1.8132|
;;;1799            		else event_ptr_find=63;
001fc4  f04f043f          MOV      r4,#0x3f
                  |L1.8136|
;;;1800            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001fc8  42b4              CMP      r4,r6
001fca  d1cb              BNE      |L1.8036|
001fcc  e03f              B        |L1.8270|
                  |L1.8142|
;;;1801        		else goto vz_mem_hndl_lbl1;
;;;1802        		}
;;;1803   
;;;1804        	}	
;;;1805   
;;;1806   
;;;1807   	
;;;1808   	data[0]=LPC_RTC->YEAR;
001fce  f8b8003c          LDRH     r0,[r8,#0x3c]
001fd2  f88d0000          STRB     r0,[sp,#0]
;;;1809   	data[1]=LPC_RTC->MONTH;
001fd6  f8980038          LDRB     r0,[r8,#0x38]
001fda  f88d0001          STRB     r0,[sp,#1]
;;;1810   	data[2]=LPC_RTC->DOM;
001fde  f898002c          LDRB     r0,[r8,#0x2c]
001fe2  f88d0002          STRB     r0,[sp,#2]
;;;1811   	data[3]=0;
001fe6  f88d9003          STRB     r9,[sp,#3]
;;;1812   	lc640_write_long_ptr(lc640_adr+16,data);
001fea  4669              MOV      r1,sp
001fec  f1050010          ADD      r0,r5,#0x10
001ff0  f7fffffe          BL       lc640_write_long_ptr
;;;1813   
;;;1814   	data[0]=LPC_RTC->HOUR;
001ff4  f8980028          LDRB     r0,[r8,#0x28]
001ff8  f88d0000          STRB     r0,[sp,#0]
;;;1815   	data[1]=LPC_RTC->MIN;
001ffc  f8980024          LDRB     r0,[r8,#0x24]
002000  f88d0001          STRB     r0,[sp,#1]
;;;1816   	data[2]=LPC_RTC->SEC;
002004  f8980020          LDRB     r0,[r8,#0x20]
002008  f88d0002          STRB     r0,[sp,#2]
;;;1817   	data[3]=0;
00200c  f88d9003          STRB     r9,[sp,#3]
;;;1818   	lc640_write_long_ptr(lc640_adr+20,data);
002010  4669              MOV      r1,sp
002012  f1050014          ADD      r0,r5,#0x14
002016  f7fffffe          BL       lc640_write_long_ptr
;;;1819   	
;;;1820   	data[0]='B';
00201a  f88d7000          STRB     r7,[sp,#0]
;;;1821   	data[1]='B';
00201e  f88d7001          STRB     r7,[sp,#1]
;;;1822   	data[2]='B';
002022  f88d7002          STRB     r7,[sp,#2]
;;;1823   	data[3]='B';
002026  f88d7003          STRB     r7,[sp,#3]
;;;1824   	lc640_write_long_ptr(lc640_adr+24,data);
00202a  4669              MOV      r1,sp
00202c  f1050018          ADD      r0,r5,#0x18
002030  f7fffffe          BL       lc640_write_long_ptr
;;;1825   	
;;;1826   	data[0]='B';
002034  f88d7000          STRB     r7,[sp,#0]
;;;1827   	data[1]='B';
002038  f88d7001          STRB     r7,[sp,#1]
;;;1828   	data[2]='B';
00203c  f88d7002          STRB     r7,[sp,#2]
;;;1829   	data[3]='B';
002040  f88d7003          STRB     r7,[sp,#3]
;;;1830   	lc640_write_long_ptr(lc640_adr+28,data);
002044  4669              MOV      r1,sp
002046  f105001c          ADD      r0,r5,#0x1c
00204a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8270|
;;;1831   	
;;;1832   	}
;;;1833   
;;;1834   vz_mem_hndl_end:
;;;1835   __nop(); 
00204e  bf00              NOP      
                  |L1.8272|
;;;1836   
;;;1837   }
002050  e48a              B        |L1.6504|
;;;1838   
                          ENDP

                  speedz_mem_hndl PROC
;;;1839   //-----------------------------------------------
;;;1840   void speedz_mem_hndl(unsigned short in)	 //    (1-, 5- , 0- , 10- )
002052  e92d4ff8          PUSH     {r3-r11,lr}
;;;1841   {
002056  4605              MOV      r5,r0
;;;1842   char data[4];
;;;1843   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
002058  f04f0600          MOV      r6,#0
00205c  4634              MOV      r4,r6
;;;1844   //char avar_simbol;
;;;1845   
;;;1846   if((in==1)||(in==5)) //  
;;;1847   	{
;;;1848   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1849   	event_ptr++;	
;;;1850   	if(event_ptr>63)event_ptr=0;	
;;;1851   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1852   	
;;;1853       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1854   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1855   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1856   	
;;;1857   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1858   	
;;;1859   	data[0]='s';
;;;1860   	data[1]=0;
;;;1861   	if(in==5)data[1]='a'; 
;;;1862   	data[2]='Z';
;;;1863   	data[3]=0;
;;;1864   	lc640_write_long_ptr(lc640_adr,data);
;;;1865   
;;;1866   	data[0]=0;
;;;1867   	data[1]=0;
;;;1868   	data[2]=0;
;;;1869   	data[3]=0;
;;;1870   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1871   
;;;1872   	data[0]=LPC_RTC->YEAR;
00205e  f8df8170          LDR      r8,|L1.8656|
002062  46a1              MOV      r9,r4                 ;1843
002064  f44f6a80          MOV      r10,#0x400            ;1857
002068  2d01              CMP      r5,#1                 ;1846
00206a  d012              BEQ      |L1.8338|
00206c  2d05              CMP      r5,#5                 ;1846
00206e  d010              BEQ      |L1.8338|
;;;1873   	data[1]=LPC_RTC->MONTH;
;;;1874   	data[2]=LPC_RTC->DOM;
;;;1875   	data[3]=0;
;;;1876   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1877   
;;;1878   	data[0]=LPC_RTC->HOUR;
;;;1879   	data[1]=LPC_RTC->MIN;
;;;1880   	data[2]=LPC_RTC->SEC;
;;;1881   	data[3]=0;
;;;1882   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1883   	
;;;1884   	data[0]='A';
;;;1885   	data[1]='A';
;;;1886   	data[2]='A';
;;;1887   	data[3]='A';
;;;1888   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1889   	
;;;1890   	data[0]='A';
;;;1891   	data[1]='A';
;;;1892   	data[2]='A';
;;;1893   	data[3]='A';
;;;1894   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1895   	
;;;1896   	data[0]='A';
;;;1897   	data[1]='A';
;;;1898   	data[2]='A';
;;;1899   	data[3]='A';
;;;1900   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1901   	
;;;1902   	data[0]='A';
;;;1903   	data[1]='A';
;;;1904   	data[2]='A';
;;;1905   	data[3]='A';
;;;1906   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1907    	
;;;1908   	}
;;;1909   
;;;1910   else if(in==0)	// 
002070  2d00              CMP      r5,#0
002072  d07d              BEQ      |L1.8560|
;;;1911   	{      
;;;1912   	char i;     
;;;1913   	event_ptr_find=0;
;;;1914   	for (i=0;i<63;i++)
;;;1915   		{
;;;1916   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1917   
;;;1918        	lc640_read_long_ptr(lc640_adr,data);
;;;1919        
;;;1920        	if(!((data[0]=='s')&&(data[2]=='Z')))
;;;1921        		{        
;;;1922        		if(event_ptr_find)event_ptr_find--;
;;;1923        		else event_ptr_find=63;
;;;1924        		if(event_ptr_find==event_ptr)
;;;1925   				{
;;;1926   				lc640_adr=0;
;;;1927   				break;
;;;1928   				}
;;;1929        		else continue;
;;;1930        		}
;;;1931        	else 
;;;1932        		{
;;;1933        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1934        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1935        			{        
;;;1936        			if(event_ptr_find)event_ptr_find--;
;;;1937            		else event_ptr_find=63;
;;;1938            		if(event_ptr_find==event_ptr)
;;;1939   					{
;;;1940   					lc640_adr=0;
;;;1941   					break;
;;;1942   					}
;;;1943        			else continue;
;;;1944        			}
;;;1945        		}	
;;;1946   		}
;;;1947   	if(lc640_adr!=0)
;;;1948   		{
;;;1949   		data[0]=LPC_RTC->YEAR;
;;;1950   		data[1]=LPC_RTC->MONTH;
;;;1951   		data[2]=LPC_RTC->DOM;
;;;1952   		data[3]=0;
;;;1953   		lc640_write_long_ptr(lc640_adr+16,data);
;;;1954   	
;;;1955   		data[0]=LPC_RTC->HOUR;
;;;1956   		data[1]=LPC_RTC->MIN;
;;;1957   		data[2]=LPC_RTC->SEC;
;;;1958   		data[3]=0;
;;;1959   		lc640_write_long_ptr(lc640_adr+20,data);
;;;1960   		
;;;1961   		data[0]='C';
;;;1962   		data[1]='C';
;;;1963   		data[2]='C';
;;;1964   		data[3]='C';
;;;1965   		lc640_write_long_ptr(lc640_adr+24,data);
;;;1966   		
;;;1967   		data[0]='C';
;;;1968   		data[1]='C';
;;;1969   		data[2]='C';
;;;1970   		data[3]='C';
;;;1971   		lc640_write_long_ptr(lc640_adr+28,data);
;;;1972   		}
;;;1973   	}
;;;1974   else if(in==10) 	//  
002074  2d0a              CMP      r5,#0xa
002076  d17c              BNE      |L1.8562|
;;;1975   	{      
;;;1976   	char i;     
;;;1977   
;;;1978   	event_ptr_find=0;
;;;1979   	for (i=0;i<63;i++)
002078  f04f0700          MOV      r7,#0
                  |L1.8316|
;;;1980   		{
;;;1981   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
00207c  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1982   
;;;1983        	lc640_read_long_ptr(lc640_adr,data);
002080  4669              MOV      r1,sp
002082  4628              MOV      r0,r5
002084  f7fffffe          BL       lc640_read_long_ptr
;;;1984        
;;;1985        	if(!((data[0]=='s')&&(data[2]=='Z')))
002088  f89d0000          LDRB     r0,[sp,#0]
00208c  2873              CMP      r0,#0x73
00208e  d171              BNE      |L1.8564|
002090  e128              B        |L1.8932|
                  |L1.8338|
002092  f44f6660          MOV      r6,#0xe00             ;1848
002096  4630              MOV      r0,r6                 ;1848
002098  f7fffffe          BL       lc640_read_int
00209c  f1000001          ADD      r0,r0,#1              ;1849
0020a0  4604              MOV      r4,r0                 ;1849
0020a2  2c3f              CMP      r4,#0x3f              ;1850
0020a4  d901              BLS      |L1.8362|
0020a6  f04f0400          MOV      r4,#0                 ;1850
                  |L1.8362|
0020aa  b221              SXTH     r1,r4                 ;1851
0020ac  4630              MOV      r0,r6                 ;1851
0020ae  f7fffffe          BL       lc640_write_int
0020b2  f6406702          MOV      r7,#0xe02             ;1853
0020b6  4638              MOV      r0,r7                 ;1853
0020b8  f7fffffe          BL       lc640_read_int
0020bc  283f              CMP      r0,#0x3f              ;1854
0020be  d000              BEQ      |L1.8386|
0020c0  4620              MOV      r0,r4                 ;1854
                  |L1.8386|
0020c2  b201              SXTH     r1,r0                 ;1855
0020c4  4638              MOV      r0,r7                 ;1855
0020c6  f7fffffe          BL       lc640_write_int
0020ca  4630              MOV      r0,r6                 ;1857
0020cc  f7fffffe          BL       lc640_read_int
0020d0  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1857
0020d4  f04f0073          MOV      r0,#0x73              ;1859
0020d8  f88d0000          STRB     r0,[sp,#0]            ;1859
0020dc  f88d9001          STRB     r9,[sp,#1]            ;1860
0020e0  2d05              CMP      r5,#5                 ;1861
0020e2  d103              BNE      |L1.8428|
0020e4  f04f0061          MOV      r0,#0x61              ;1861
0020e8  f88d0001          STRB     r0,[sp,#1]            ;1861
                  |L1.8428|
0020ec  f04f005a          MOV      r0,#0x5a              ;1862
0020f0  f88d0002          STRB     r0,[sp,#2]            ;1862
0020f4  f88d9003          STRB     r9,[sp,#3]            ;1863
0020f8  4669              MOV      r1,sp                 ;1864
0020fa  4620              MOV      r0,r4                 ;1864
0020fc  f7fffffe          BL       lc640_write_long_ptr
002100  f8cd9000          STR      r9,[sp,#0]            ;1869
002104  4669              MOV      r1,sp                 ;1870
002106  1d20              ADDS     r0,r4,#4              ;1870
002108  f7fffffe          BL       lc640_write_long_ptr
00210c  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1872
002110  f88d0000          STRB     r0,[sp,#0]            ;1872
002114  f8980038          LDRB     r0,[r8,#0x38]         ;1873
002118  f88d0001          STRB     r0,[sp,#1]            ;1873
00211c  f898002c          LDRB     r0,[r8,#0x2c]         ;1874
002120  f88d0002          STRB     r0,[sp,#2]            ;1874
002124  f88d9003          STRB     r9,[sp,#3]            ;1875
002128  4669              MOV      r1,sp                 ;1876
00212a  f1040008          ADD      r0,r4,#8              ;1876
00212e  f7fffffe          BL       lc640_write_long_ptr
002132  f8980028          LDRB     r0,[r8,#0x28]         ;1878
002136  f88d0000          STRB     r0,[sp,#0]            ;1878
00213a  f8980024          LDRB     r0,[r8,#0x24]         ;1879
00213e  f88d0001          STRB     r0,[sp,#1]            ;1879
002142  f8980020          LDRB     r0,[r8,#0x20]         ;1880
002146  f88d0002          STRB     r0,[sp,#2]            ;1880
00214a  f88d9003          STRB     r9,[sp,#3]            ;1881
00214e  4669              MOV      r1,sp                 ;1882
002150  f104000c          ADD      r0,r4,#0xc            ;1882
002154  f7fffffe          BL       lc640_write_long_ptr
002158  f04f0541          MOV      r5,#0x41              ;1884
00215c  f88d5000          STRB     r5,[sp,#0]            ;1884
002160  f88d5001          STRB     r5,[sp,#1]            ;1885
002164  f88d5002          STRB     r5,[sp,#2]            ;1886
002168  f88d5003          STRB     r5,[sp,#3]            ;1887
00216c  4669              MOV      r1,sp                 ;1888
00216e  e002              B        |L1.8566|
                  |L1.8560|
002170  e033              B        |L1.8666|
                  |L1.8562|
002172  e031              B        |L1.8664|
                  |L1.8564|
002174  e0ba              B        |L1.8940|
                  |L1.8566|
002176  f1040010          ADD      r0,r4,#0x10           ;1888
00217a  f7fffffe          BL       lc640_write_long_ptr
00217e  f88d5000          STRB     r5,[sp,#0]            ;1890
002182  f88d5001          STRB     r5,[sp,#1]            ;1891
002186  f88d5002          STRB     r5,[sp,#2]            ;1892
00218a  f88d5003          STRB     r5,[sp,#3]            ;1893
00218e  4669              MOV      r1,sp                 ;1894
002190  f1040014          ADD      r0,r4,#0x14           ;1894
002194  f7fffffe          BL       lc640_write_long_ptr
002198  f88d5000          STRB     r5,[sp,#0]            ;1896
00219c  f88d5001          STRB     r5,[sp,#1]            ;1897
0021a0  f88d5002          STRB     r5,[sp,#2]            ;1898
0021a4  f88d5003          STRB     r5,[sp,#3]            ;1899
0021a8  4669              MOV      r1,sp                 ;1900
0021aa  f1040018          ADD      r0,r4,#0x18           ;1900
0021ae  f7fffffe          BL       lc640_write_long_ptr
0021b2  f88d5000          STRB     r5,[sp,#0]            ;1902
0021b6  f88d5001          STRB     r5,[sp,#1]            ;1903
0021ba  f88d5002          STRB     r5,[sp,#2]            ;1904
0021be  f88d5003          STRB     r5,[sp,#3]            ;1905
0021c2  4669              MOV      r1,sp                 ;1906
0021c4  f104001c          ADD      r0,r4,#0x1c           ;1906
0021c8  e004              B        |L1.8660|
0021ca  0000              DCW      0x0000
                  |L1.8652|
                          DCD      0x40024020
                  |L1.8656|
                          DCD      0x40024000
                  |L1.8660|
0021d4  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8664|
;;;1986        		{        
;;;1987        		if(event_ptr_find)event_ptr_find--;
;;;1988        		else event_ptr_find=63;
;;;1989        		if(event_ptr_find==event_ptr)
;;;1990   				{
;;;1991   				lc640_adr=0;
;;;1992   				break;
;;;1993   				}
;;;1994        		else continue;
;;;1995        		}
;;;1996        	else 
;;;1997        		{
;;;1998        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1999        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2000        			{        
;;;2001        			if(event_ptr_find)event_ptr_find--;
;;;2002            		else event_ptr_find=63;
;;;2003            		if(event_ptr_find==event_ptr)
;;;2004   					{
;;;2005   					lc640_adr=0;
;;;2006   					break;
;;;2007   					}
;;;2008        			else continue;
;;;2009        			}
;;;2010        		}	
;;;2011   		}
;;;2012   	if(lc640_adr!=0)
;;;2013   		{
;;;2014   		data[0]=LPC_RTC->YEAR;
;;;2015   		data[1]=LPC_RTC->MONTH;
;;;2016   		data[2]=LPC_RTC->DOM;
;;;2017   		data[3]=0;
;;;2018   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2019   	
;;;2020   		data[0]=LPC_RTC->HOUR;
;;;2021   		data[1]=LPC_RTC->MIN;
;;;2022   		data[2]=LPC_RTC->SEC;
;;;2023   		data[3]=0;
;;;2024   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2025   		
;;;2026   		data[0]='B';
;;;2027   		data[1]='B';
;;;2028   		data[2]='B';
;;;2029   		data[3]='B';
;;;2030   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2031   		
;;;2032   		data[0]='B';
;;;2033   		data[1]='B';
;;;2034   		data[2]='B';
;;;2035   		data[3]='B';
;;;2036   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2037   		}
;;;2038   	}
;;;2039   }
0021d8  e518              B        |L1.7180|
                  |L1.8666|
0021da  f04f0700          MOV      r7,#0                 ;1914
                  |L1.8670|
0021de  eb0a1544          ADD      r5,r10,r4,LSL #5      ;1916
0021e2  4669              MOV      r1,sp                 ;1918
0021e4  4628              MOV      r0,r5                 ;1918
0021e6  f7fffffe          BL       lc640_read_long_ptr
0021ea  f89d0000          LDRB     r0,[sp,#0]            ;1920
0021ee  2873              CMP      r0,#0x73              ;1920
0021f0  d103              BNE      |L1.8698|
0021f2  f89d0002          LDRB     r0,[sp,#2]            ;1920
0021f6  285a              CMP      r0,#0x5a              ;1920
0021f8  d00a              BEQ      |L1.8720|
                  |L1.8698|
0021fa  b114              CBZ      r4,|L1.8706|
0021fc  f1a40401          SUB      r4,r4,#1              ;1922
002200  e001              B        |L1.8710|
                  |L1.8706|
002202  f04f043f          MOV      r4,#0x3f              ;1923
                  |L1.8710|
002206  42b4              CMP      r4,r6                 ;1924
002208  d122              BNE      |L1.8784|
00220a  f04f0500          MOV      r5,#0                 ;1926
00220e  e024              B        |L1.8794|
                  |L1.8720|
002210  4669              MOV      r1,sp                 ;1933
002212  f1050010          ADD      r0,r5,#0x10           ;1933
002216  f7fffffe          BL       lc640_read_long_ptr
00221a  f89d0000          LDRB     r0,[sp,#0]            ;1934
00221e  2841              CMP      r0,#0x41              ;1934
002220  d10b              BNE      |L1.8762|
002222  f89d0001          LDRB     r0,[sp,#1]            ;1934
002226  2841              CMP      r0,#0x41              ;1934
002228  d107              BNE      |L1.8762|
00222a  f89d0002          LDRB     r0,[sp,#2]            ;1934
00222e  2841              CMP      r0,#0x41              ;1934
002230  d103              BNE      |L1.8762|
002232  f89d0003          LDRB     r0,[sp,#3]            ;1934
002236  2841              CMP      r0,#0x41              ;1934
002238  d00a              BEQ      |L1.8784|
                  |L1.8762|
00223a  b114              CBZ      r4,|L1.8770|
00223c  f1a40401          SUB      r4,r4,#1              ;1936
002240  e001              B        |L1.8774|
                  |L1.8770|
002242  f04f043f          MOV      r4,#0x3f              ;1937
                  |L1.8774|
002246  42b4              CMP      r4,r6                 ;1938
002248  d102              BNE      |L1.8784|
00224a  f04f0500          MOV      r5,#0                 ;1940
00224e  e004              B        |L1.8794|
                  |L1.8784|
002250  f1070701          ADD      r7,r7,#1              ;1914
002254  b2ff              UXTB     r7,r7                 ;1914
002256  2f3f              CMP      r7,#0x3f              ;1914
002258  d3c1              BCC      |L1.8670|
                  |L1.8794|
00225a  2d00              CMP      r5,#0                 ;1947
00225c  d0bc              BEQ      |L1.8664|
00225e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1949
002262  f88d0000          STRB     r0,[sp,#0]            ;1949
002266  f8980038          LDRB     r0,[r8,#0x38]         ;1950
00226a  f88d0001          STRB     r0,[sp,#1]            ;1950
00226e  f898002c          LDRB     r0,[r8,#0x2c]         ;1951
002272  f88d0002          STRB     r0,[sp,#2]            ;1951
002276  f88d9003          STRB     r9,[sp,#3]            ;1952
00227a  4669              MOV      r1,sp                 ;1953
00227c  f1050010          ADD      r0,r5,#0x10           ;1953
002280  f7fffffe          BL       lc640_write_long_ptr
002284  f8980028          LDRB     r0,[r8,#0x28]         ;1955
002288  f88d0000          STRB     r0,[sp,#0]            ;1955
00228c  f8980024          LDRB     r0,[r8,#0x24]         ;1956
002290  f88d0001          STRB     r0,[sp,#1]            ;1956
002294  f8980020          LDRB     r0,[r8,#0x20]         ;1957
002298  f88d0002          STRB     r0,[sp,#2]            ;1957
00229c  f88d9003          STRB     r9,[sp,#3]            ;1958
0022a0  4669              MOV      r1,sp                 ;1959
0022a2  f1050014          ADD      r0,r5,#0x14           ;1959
0022a6  f7fffffe          BL       lc640_write_long_ptr
0022aa  f04f0443          MOV      r4,#0x43              ;1961
0022ae  f88d4000          STRB     r4,[sp,#0]            ;1961
0022b2  f88d4001          STRB     r4,[sp,#1]            ;1962
0022b6  f88d4002          STRB     r4,[sp,#2]            ;1963
0022ba  f88d4003          STRB     r4,[sp,#3]            ;1964
0022be  4669              MOV      r1,sp                 ;1965
0022c0  f1050018          ADD      r0,r5,#0x18           ;1965
0022c4  f7fffffe          BL       lc640_write_long_ptr
0022c8  f88d4000          STRB     r4,[sp,#0]            ;1967
0022cc  f88d4001          STRB     r4,[sp,#1]            ;1968
0022d0  f88d4002          STRB     r4,[sp,#2]            ;1969
0022d4  f88d4003          STRB     r4,[sp,#3]            ;1970
0022d8  4669              MOV      r1,sp                 ;1971
0022da  f105001c          ADD      r0,r5,#0x1c           ;1971
0022de  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8930|
0022e2  e493              B        |L1.7180|
                  |L1.8932|
0022e4  f89d0002          LDRB     r0,[sp,#2]            ;1985
0022e8  285a              CMP      r0,#0x5a              ;1985
0022ea  d00a              BEQ      |L1.8962|
                  |L1.8940|
0022ec  b114              CBZ      r4,|L1.8948|
0022ee  f1a40401          SUB      r4,r4,#1              ;1987
0022f2  e001              B        |L1.8952|
                  |L1.8948|
0022f4  f04f043f          MOV      r4,#0x3f              ;1988
                  |L1.8952|
0022f8  42b4              CMP      r4,r6                 ;1989
0022fa  d122              BNE      |L1.9026|
0022fc  f04f0500          MOV      r5,#0                 ;1991
002300  e025              B        |L1.9038|
                  |L1.8962|
002302  4669              MOV      r1,sp                 ;1998
002304  f1050010          ADD      r0,r5,#0x10           ;1998
002308  f7fffffe          BL       lc640_read_long_ptr
00230c  f89d0000          LDRB     r0,[sp,#0]            ;1999
002310  2841              CMP      r0,#0x41              ;1999
002312  d10b              BNE      |L1.9004|
002314  f89d0001          LDRB     r0,[sp,#1]            ;1999
002318  2841              CMP      r0,#0x41              ;1999
00231a  d107              BNE      |L1.9004|
00231c  f89d0002          LDRB     r0,[sp,#2]            ;1999
002320  2841              CMP      r0,#0x41              ;1999
002322  d103              BNE      |L1.9004|
002324  f89d0003          LDRB     r0,[sp,#3]            ;1999
002328  2841              CMP      r0,#0x41              ;1999
00232a  d00a              BEQ      |L1.9026|
                  |L1.9004|
00232c  b114              CBZ      r4,|L1.9012|
00232e  f1a40401          SUB      r4,r4,#1              ;2001
002332  e001              B        |L1.9016|
                  |L1.9012|
002334  f04f043f          MOV      r4,#0x3f              ;2002
                  |L1.9016|
002338  42b4              CMP      r4,r6                 ;2003
00233a  d102              BNE      |L1.9026|
00233c  f04f0500          MOV      r5,#0                 ;2005
002340  e005              B        |L1.9038|
                  |L1.9026|
002342  f1070701          ADD      r7,r7,#1              ;1979
002346  b2ff              UXTB     r7,r7                 ;1979
002348  2f3f              CMP      r7,#0x3f              ;1979
00234a  f4ffae97          BCC      |L1.8316|
                  |L1.9038|
00234e  2d00              CMP      r5,#0                 ;2012
002350  d0c7              BEQ      |L1.8930|
002352  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2014
002356  f88d0000          STRB     r0,[sp,#0]            ;2014
00235a  f8980038          LDRB     r0,[r8,#0x38]         ;2015
00235e  f88d0001          STRB     r0,[sp,#1]            ;2015
002362  f898002c          LDRB     r0,[r8,#0x2c]         ;2016
002366  f88d0002          STRB     r0,[sp,#2]            ;2016
00236a  f88d9003          STRB     r9,[sp,#3]            ;2017
00236e  4669              MOV      r1,sp                 ;2018
002370  f1050010          ADD      r0,r5,#0x10           ;2018
002374  f7fffffe          BL       lc640_write_long_ptr
002378  f8980028          LDRB     r0,[r8,#0x28]         ;2020
00237c  f88d0000          STRB     r0,[sp,#0]            ;2020
002380  f8980024          LDRB     r0,[r8,#0x24]         ;2021
002384  f88d0001          STRB     r0,[sp,#1]            ;2021
002388  f8980020          LDRB     r0,[r8,#0x20]         ;2022
00238c  f88d0002          STRB     r0,[sp,#2]            ;2022
002390  f88d9003          STRB     r9,[sp,#3]            ;2023
002394  4669              MOV      r1,sp                 ;2024
002396  f1050014          ADD      r0,r5,#0x14           ;2024
00239a  f7fffffe          BL       lc640_write_long_ptr
00239e  f04f0442          MOV      r4,#0x42              ;2026
0023a2  f88d4000          STRB     r4,[sp,#0]            ;2026
0023a6  f88d4001          STRB     r4,[sp,#1]            ;2027
0023aa  f88d4002          STRB     r4,[sp,#2]            ;2028
0023ae  f88d4003          STRB     r4,[sp,#3]            ;2029
0023b2  4669              MOV      r1,sp                 ;2030
0023b4  f1050018          ADD      r0,r5,#0x18           ;2030
0023b8  f7fffffe          BL       lc640_write_long_ptr
0023bc  f88d4000          STRB     r4,[sp,#0]            ;2032
0023c0  f88d4001          STRB     r4,[sp,#1]            ;2033
0023c4  f88d4002          STRB     r4,[sp,#2]            ;2034
0023c8  f88d4003          STRB     r4,[sp,#3]            ;2035
0023cc  4669              MOV      r1,sp                 ;2036
0023ce  f105001c          ADD      r0,r5,#0x1c           ;2036
0023d2  f7fffffe          BL       lc640_write_long_ptr
0023d6  e419              B        |L1.7180|
;;;2040     
                          ENDP

                  uz_mem_hndl PROC
;;;2042   //-----------------------------------------------
;;;2043   void uz_mem_hndl(unsigned short in)	 //   
0023d8  e92d4ff8          PUSH     {r3-r11,lr}
;;;2044   {
;;;2045   char data[4];
;;;2046   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
0023dc  f04f0600          MOV      r6,#0
0023e0  4634              MOV      r4,r6
;;;2047   //char avar_simbol;
;;;2048   
;;;2049   if(in==1) //  
;;;2050   	{
;;;2051   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2052   	event_ptr++;	
;;;2053   	if(event_ptr>63)event_ptr=0;	
;;;2054   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2055   	
;;;2056       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2057   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2058   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2059   	
;;;2060   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2061   	
;;;2062   	data[0]='u';
;;;2063   	data[1]=0; 
;;;2064   	data[2]='Z';
;;;2065   	data[3]=0;
;;;2066   	lc640_write_long_ptr(lc640_adr,data);
;;;2067   
;;;2068   	data[0]=0;
;;;2069   	data[1]=0;
;;;2070   	data[2]=0;
;;;2071   	data[3]=0;
;;;2072   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2073   
;;;2074   	data[0]=LPC_RTC->YEAR;
0023e2  f8df86c4          LDR      r8,|L1.10920|
0023e6  46a1              MOV      r9,r4                 ;2046
0023e8  f44f6a80          MOV      r10,#0x400            ;2060
0023ec  2801              CMP      r0,#1                 ;2049
0023ee  d010              BEQ      |L1.9234|
;;;2075   	data[1]=LPC_RTC->MONTH;
;;;2076   	data[2]=LPC_RTC->DOM;
;;;2077   	data[3]=0;
;;;2078   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2079   
;;;2080   	data[0]=LPC_RTC->HOUR;
;;;2081   	data[1]=LPC_RTC->MIN;
;;;2082   	data[2]=LPC_RTC->SEC;
;;;2083   	data[3]=0;
;;;2084   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2085   	
;;;2086   	data[0]='A';
;;;2087   	data[1]='A';
;;;2088   	data[2]='A';
;;;2089   	data[3]='A';
;;;2090   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2091   	
;;;2092   	data[0]='A';
;;;2093   	data[1]='A';
;;;2094   	data[2]='A';
;;;2095   	data[3]='A';
;;;2096   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2097   	
;;;2098   	data[0]='A';
;;;2099   	data[1]='A';
;;;2100   	data[2]='A';
;;;2101   	data[3]='A';
;;;2102   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2103   	
;;;2104   	data[0]='A';
;;;2105   	data[1]='A';
;;;2106   	data[2]='A';
;;;2107   	data[3]='A';
;;;2108   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2109    	
;;;2110   	}
;;;2111   
;;;2112   else if(in==0)	// 
0023f0  2800              CMP      r0,#0
0023f2  d07d              BEQ      |L1.9456|
;;;2113   	{      
;;;2114   	char i;     
;;;2115   	event_ptr_find=0;
;;;2116   	for (i=0;i<63;i++)
;;;2117   		{
;;;2118   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2119   
;;;2120        	lc640_read_long_ptr(lc640_adr,data);
;;;2121        
;;;2122        	if(!((data[0]=='u')&&(data[2]=='Z')))
;;;2123        		{        
;;;2124        		if(event_ptr_find)event_ptr_find--;
;;;2125        		else event_ptr_find=63;
;;;2126        		if(event_ptr_find==event_ptr)
;;;2127   				{
;;;2128   				lc640_adr=0;
;;;2129   				break;
;;;2130   				}
;;;2131        		else continue;
;;;2132        		}
;;;2133        	else 
;;;2134        		{
;;;2135        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2136        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2137        			{        
;;;2138        			if(event_ptr_find)event_ptr_find--;
;;;2139            		else event_ptr_find=63;
;;;2140            		if(event_ptr_find==event_ptr)
;;;2141   					{
;;;2142   					lc640_adr=0;
;;;2143   					break;
;;;2144   					}
;;;2145        			else continue;
;;;2146        			}
;;;2147        		}	
;;;2148   		}
;;;2149   	if(lc640_adr!=0)
;;;2150   		{
;;;2151   		data[0]=LPC_RTC->YEAR;
;;;2152   		data[1]=LPC_RTC->MONTH;
;;;2153   		data[2]=LPC_RTC->DOM;
;;;2154   		data[3]=0;
;;;2155   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2156   	
;;;2157   		data[0]=LPC_RTC->HOUR;
;;;2158   		data[1]=LPC_RTC->MIN;
;;;2159   		data[2]=LPC_RTC->SEC;
;;;2160   		data[3]=0;
;;;2161   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2162   		
;;;2163   		data[0]='C';
;;;2164   		data[1]='C';
;;;2165   		data[2]='C';
;;;2166   		data[3]='C';
;;;2167   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2168   		
;;;2169   		data[0]='C';
;;;2170   		data[1]='C';
;;;2171   		data[2]='C';
;;;2172   		data[3]='C';
;;;2173   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2174   		}
;;;2175   	}
;;;2176   else if(in==10) 	//  
0023f4  280a              CMP      r0,#0xa
0023f6  d17c              BNE      |L1.9458|
;;;2177   	{      
;;;2178   	char i;     
;;;2179   
;;;2180   	event_ptr_find=0;
;;;2181   	for (i=0;i<63;i++)
0023f8  f04f0700          MOV      r7,#0
                  |L1.9212|
;;;2182   		{
;;;2183   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
0023fc  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2184   
;;;2185        	lc640_read_long_ptr(lc640_adr,data);
002400  4669              MOV      r1,sp
002402  4628              MOV      r0,r5
002404  f7fffffe          BL       lc640_read_long_ptr
;;;2186        
;;;2187        	if(!((data[0]=='u')&&(data[2]=='Z')))
002408  f89d0000          LDRB     r0,[sp,#0]
00240c  2875              CMP      r0,#0x75
00240e  d171              BNE      |L1.9460|
002410  e11c              B        |L1.9804|
                  |L1.9234|
002412  f44f6560          MOV      r5,#0xe00             ;2051
002416  4628              MOV      r0,r5                 ;2051
002418  f7fffffe          BL       lc640_read_int
00241c  f1000001          ADD      r0,r0,#1              ;2052
002420  4604              MOV      r4,r0                 ;2052
002422  2c3f              CMP      r4,#0x3f              ;2053
002424  d901              BLS      |L1.9258|
002426  f04f0400          MOV      r4,#0                 ;2053
                  |L1.9258|
00242a  b221              SXTH     r1,r4                 ;2054
00242c  4628              MOV      r0,r5                 ;2054
00242e  f7fffffe          BL       lc640_write_int
002432  f6406602          MOV      r6,#0xe02             ;2056
002436  4630              MOV      r0,r6                 ;2056
002438  f7fffffe          BL       lc640_read_int
00243c  283f              CMP      r0,#0x3f              ;2057
00243e  d000              BEQ      |L1.9282|
002440  4620              MOV      r0,r4                 ;2057
                  |L1.9282|
002442  b201              SXTH     r1,r0                 ;2058
002444  4630              MOV      r0,r6                 ;2058
002446  f7fffffe          BL       lc640_write_int
00244a  4628              MOV      r0,r5                 ;2060
00244c  f7fffffe          BL       lc640_read_int
002450  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2060
002454  f04f0075          MOV      r0,#0x75              ;2062
002458  f88d0000          STRB     r0,[sp,#0]            ;2062
00245c  f88d9001          STRB     r9,[sp,#1]            ;2063
002460  f04f005a          MOV      r0,#0x5a              ;2064
002464  f88d0002          STRB     r0,[sp,#2]            ;2064
002468  f88d9003          STRB     r9,[sp,#3]            ;2065
00246c  4669              MOV      r1,sp                 ;2066
00246e  4620              MOV      r0,r4                 ;2066
002470  f7fffffe          BL       lc640_write_long_ptr
002474  f8cd9000          STR      r9,[sp,#0]            ;2071
002478  4669              MOV      r1,sp                 ;2072
00247a  1d20              ADDS     r0,r4,#4              ;2072
00247c  f7fffffe          BL       lc640_write_long_ptr
002480  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2074
002484  f88d0000          STRB     r0,[sp,#0]            ;2074
002488  f8980038          LDRB     r0,[r8,#0x38]         ;2075
00248c  f88d0001          STRB     r0,[sp,#1]            ;2075
002490  f898002c          LDRB     r0,[r8,#0x2c]         ;2076
002494  f88d0002          STRB     r0,[sp,#2]            ;2076
002498  f88d9003          STRB     r9,[sp,#3]            ;2077
00249c  4669              MOV      r1,sp                 ;2078
00249e  f1040008          ADD      r0,r4,#8              ;2078
0024a2  f7fffffe          BL       lc640_write_long_ptr
0024a6  f8980028          LDRB     r0,[r8,#0x28]         ;2080
0024aa  f88d0000          STRB     r0,[sp,#0]            ;2080
0024ae  f8980024          LDRB     r0,[r8,#0x24]         ;2081
0024b2  f88d0001          STRB     r0,[sp,#1]            ;2081
0024b6  f8980020          LDRB     r0,[r8,#0x20]         ;2082
0024ba  f88d0002          STRB     r0,[sp,#2]            ;2082
0024be  f88d9003          STRB     r9,[sp,#3]            ;2083
0024c2  4669              MOV      r1,sp                 ;2084
0024c4  f104000c          ADD      r0,r4,#0xc            ;2084
0024c8  f7fffffe          BL       lc640_write_long_ptr
0024cc  f04f0541          MOV      r5,#0x41              ;2086
0024d0  f88d5000          STRB     r5,[sp,#0]            ;2086
0024d4  f88d5001          STRB     r5,[sp,#1]            ;2087
0024d8  f88d5002          STRB     r5,[sp,#2]            ;2088
0024dc  f88d5003          STRB     r5,[sp,#3]            ;2089
0024e0  4669              MOV      r1,sp                 ;2090
0024e2  f1040010          ADD      r0,r4,#0x10           ;2090
0024e6  f7fffffe          BL       lc640_write_long_ptr
0024ea  f88d5000          STRB     r5,[sp,#0]            ;2092
0024ee  e002              B        |L1.9462|
                  |L1.9456|
0024f0  e027              B        |L1.9538|
                  |L1.9458|
0024f2  e025              B        |L1.9536|
                  |L1.9460|
0024f4  e0ae              B        |L1.9812|
                  |L1.9462|
0024f6  f88d5001          STRB     r5,[sp,#1]            ;2093
0024fa  f88d5002          STRB     r5,[sp,#2]            ;2094
0024fe  f88d5003          STRB     r5,[sp,#3]            ;2095
002502  4669              MOV      r1,sp                 ;2096
002504  f1040014          ADD      r0,r4,#0x14           ;2096
002508  f7fffffe          BL       lc640_write_long_ptr
00250c  f88d5000          STRB     r5,[sp,#0]            ;2098
002510  f88d5001          STRB     r5,[sp,#1]            ;2099
002514  f88d5002          STRB     r5,[sp,#2]            ;2100
002518  f88d5003          STRB     r5,[sp,#3]            ;2101
00251c  4669              MOV      r1,sp                 ;2102
00251e  f1040018          ADD      r0,r4,#0x18           ;2102
002522  f7fffffe          BL       lc640_write_long_ptr
002526  f88d5000          STRB     r5,[sp,#0]            ;2104
00252a  f88d5001          STRB     r5,[sp,#1]            ;2105
00252e  f88d5002          STRB     r5,[sp,#2]            ;2106
002532  f88d5003          STRB     r5,[sp,#3]            ;2107
002536  4669              MOV      r1,sp                 ;2108
002538  f104001c          ADD      r0,r4,#0x1c           ;2108
00253c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9536|
;;;2188        		{        
;;;2189        		if(event_ptr_find)event_ptr_find--;
;;;2190        		else event_ptr_find=63;
;;;2191        		if(event_ptr_find==event_ptr)
;;;2192   				{
;;;2193   				lc640_adr=0;
;;;2194   				break;
;;;2195   				}
;;;2196        		else continue;
;;;2197        		}
;;;2198        	else 
;;;2199        		{
;;;2200        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2201        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2202        			{        
;;;2203        			if(event_ptr_find)event_ptr_find--;
;;;2204            		else event_ptr_find=63;
;;;2205            		if(event_ptr_find==event_ptr)
;;;2206   					{
;;;2207   					lc640_adr=0;
;;;2208   					break;
;;;2209   					}
;;;2210        			else continue;
;;;2211        			}
;;;2212        		}	
;;;2213   		}
;;;2214   	if(lc640_adr!=0)
;;;2215   		{
;;;2216   		data[0]=LPC_RTC->YEAR;
;;;2217   		data[1]=LPC_RTC->MONTH;
;;;2218   		data[2]=LPC_RTC->DOM;
;;;2219   		data[3]=0;
;;;2220   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2221   	
;;;2222   		data[0]=LPC_RTC->HOUR;
;;;2223   		data[1]=LPC_RTC->MIN;
;;;2224   		data[2]=LPC_RTC->SEC;
;;;2225   		data[3]=0;
;;;2226   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2227   		
;;;2228   		data[0]='B';
;;;2229   		data[1]='B';
;;;2230   		data[2]='B';
;;;2231   		data[3]='B';
;;;2232   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2233   		
;;;2234   		data[0]='B';
;;;2235   		data[1]='B';
;;;2236   		data[2]='B';
;;;2237   		data[3]='B';
;;;2238   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2239   		}
;;;2240   	}
;;;2241   }
002540  e586              B        |L1.8272|
                  |L1.9538|
002542  f04f0700          MOV      r7,#0                 ;2116
                  |L1.9542|
002546  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2118
00254a  4669              MOV      r1,sp                 ;2120
00254c  4628              MOV      r0,r5                 ;2120
00254e  f7fffffe          BL       lc640_read_long_ptr
002552  f89d0000          LDRB     r0,[sp,#0]            ;2122
002556  2875              CMP      r0,#0x75              ;2122
002558  d103              BNE      |L1.9570|
00255a  f89d0002          LDRB     r0,[sp,#2]            ;2122
00255e  285a              CMP      r0,#0x5a              ;2122
002560  d00a              BEQ      |L1.9592|
                  |L1.9570|
002562  b114              CBZ      r4,|L1.9578|
002564  f1a40401          SUB      r4,r4,#1              ;2124
002568  e001              B        |L1.9582|
                  |L1.9578|
00256a  f04f043f          MOV      r4,#0x3f              ;2125
                  |L1.9582|
00256e  42b4              CMP      r4,r6                 ;2126
002570  d122              BNE      |L1.9656|
002572  f04f0500          MOV      r5,#0                 ;2128
002576  e024              B        |L1.9666|
                  |L1.9592|
002578  4669              MOV      r1,sp                 ;2135
00257a  f1050010          ADD      r0,r5,#0x10           ;2135
00257e  f7fffffe          BL       lc640_read_long_ptr
002582  f89d0000          LDRB     r0,[sp,#0]            ;2136
002586  2841              CMP      r0,#0x41              ;2136
002588  d10b              BNE      |L1.9634|
00258a  f89d0001          LDRB     r0,[sp,#1]            ;2136
00258e  2841              CMP      r0,#0x41              ;2136
002590  d107              BNE      |L1.9634|
002592  f89d0002          LDRB     r0,[sp,#2]            ;2136
002596  2841              CMP      r0,#0x41              ;2136
002598  d103              BNE      |L1.9634|
00259a  f89d0003          LDRB     r0,[sp,#3]            ;2136
00259e  2841              CMP      r0,#0x41              ;2136
0025a0  d00a              BEQ      |L1.9656|
                  |L1.9634|
0025a2  b114              CBZ      r4,|L1.9642|
0025a4  f1a40401          SUB      r4,r4,#1              ;2138
0025a8  e001              B        |L1.9646|
                  |L1.9642|
0025aa  f04f043f          MOV      r4,#0x3f              ;2139
                  |L1.9646|
0025ae  42b4              CMP      r4,r6                 ;2140
0025b0  d102              BNE      |L1.9656|
0025b2  f04f0500          MOV      r5,#0                 ;2142
0025b6  e004              B        |L1.9666|
                  |L1.9656|
0025b8  f1070701          ADD      r7,r7,#1              ;2116
0025bc  b2ff              UXTB     r7,r7                 ;2116
0025be  2f3f              CMP      r7,#0x3f              ;2116
0025c0  d3c1              BCC      |L1.9542|
                  |L1.9666|
0025c2  2d00              CMP      r5,#0                 ;2149
0025c4  d0bc              BEQ      |L1.9536|
0025c6  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2151
0025ca  f88d0000          STRB     r0,[sp,#0]            ;2151
0025ce  f8980038          LDRB     r0,[r8,#0x38]         ;2152
0025d2  f88d0001          STRB     r0,[sp,#1]            ;2152
0025d6  f898002c          LDRB     r0,[r8,#0x2c]         ;2153
0025da  f88d0002          STRB     r0,[sp,#2]            ;2153
0025de  f88d9003          STRB     r9,[sp,#3]            ;2154
0025e2  4669              MOV      r1,sp                 ;2155
0025e4  f1050010          ADD      r0,r5,#0x10           ;2155
0025e8  f7fffffe          BL       lc640_write_long_ptr
0025ec  f8980028          LDRB     r0,[r8,#0x28]         ;2157
0025f0  f88d0000          STRB     r0,[sp,#0]            ;2157
0025f4  f8980024          LDRB     r0,[r8,#0x24]         ;2158
0025f8  f88d0001          STRB     r0,[sp,#1]            ;2158
0025fc  f8980020          LDRB     r0,[r8,#0x20]         ;2159
002600  f88d0002          STRB     r0,[sp,#2]            ;2159
002604  f88d9003          STRB     r9,[sp,#3]            ;2160
002608  4669              MOV      r1,sp                 ;2161
00260a  f1050014          ADD      r0,r5,#0x14           ;2161
00260e  f7fffffe          BL       lc640_write_long_ptr
002612  f04f0443          MOV      r4,#0x43              ;2163
002616  f88d4000          STRB     r4,[sp,#0]            ;2163
00261a  f88d4001          STRB     r4,[sp,#1]            ;2164
00261e  f88d4002          STRB     r4,[sp,#2]            ;2165
002622  f88d4003          STRB     r4,[sp,#3]            ;2166
002626  4669              MOV      r1,sp                 ;2167
002628  f1050018          ADD      r0,r5,#0x18           ;2167
00262c  f7fffffe          BL       lc640_write_long_ptr
002630  f88d4000          STRB     r4,[sp,#0]            ;2169
002634  f88d4001          STRB     r4,[sp,#1]            ;2170
002638  f88d4002          STRB     r4,[sp,#2]            ;2171
00263c  f88d4003          STRB     r4,[sp,#3]            ;2172
002640  4669              MOV      r1,sp                 ;2173
002642  f105001c          ADD      r0,r5,#0x1c           ;2173
002646  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9802|
00264a  e501              B        |L1.8272|
                  |L1.9804|
00264c  f89d0002          LDRB     r0,[sp,#2]            ;2187
002650  285a              CMP      r0,#0x5a              ;2187
002652  d00a              BEQ      |L1.9834|
                  |L1.9812|
002654  b114              CBZ      r4,|L1.9820|
002656  f1a40401          SUB      r4,r4,#1              ;2189
00265a  e001              B        |L1.9824|
                  |L1.9820|
00265c  f04f043f          MOV      r4,#0x3f              ;2190
                  |L1.9824|
002660  42b4              CMP      r4,r6                 ;2191
002662  d122              BNE      |L1.9898|
002664  f04f0500          MOV      r5,#0                 ;2193
002668  e025              B        |L1.9910|
                  |L1.9834|
00266a  4669              MOV      r1,sp                 ;2200
00266c  f1050010          ADD      r0,r5,#0x10           ;2200
002670  f7fffffe          BL       lc640_read_long_ptr
002674  f89d0000          LDRB     r0,[sp,#0]            ;2201
002678  2841              CMP      r0,#0x41              ;2201
00267a  d10b              BNE      |L1.9876|
00267c  f89d0001          LDRB     r0,[sp,#1]            ;2201
002680  2841              CMP      r0,#0x41              ;2201
002682  d107              BNE      |L1.9876|
002684  f89d0002          LDRB     r0,[sp,#2]            ;2201
002688  2841              CMP      r0,#0x41              ;2201
00268a  d103              BNE      |L1.9876|
00268c  f89d0003          LDRB     r0,[sp,#3]            ;2201
002690  2841              CMP      r0,#0x41              ;2201
002692  d00a              BEQ      |L1.9898|
                  |L1.9876|
002694  b114              CBZ      r4,|L1.9884|
002696  f1a40401          SUB      r4,r4,#1              ;2203
00269a  e001              B        |L1.9888|
                  |L1.9884|
00269c  f04f043f          MOV      r4,#0x3f              ;2204
                  |L1.9888|
0026a0  42b4              CMP      r4,r6                 ;2205
0026a2  d102              BNE      |L1.9898|
0026a4  f04f0500          MOV      r5,#0                 ;2207
0026a8  e005              B        |L1.9910|
                  |L1.9898|
0026aa  f1070701          ADD      r7,r7,#1              ;2181
0026ae  b2ff              UXTB     r7,r7                 ;2181
0026b0  2f3f              CMP      r7,#0x3f              ;2181
0026b2  f4ffaea3          BCC      |L1.9212|
                  |L1.9910|
0026b6  2d00              CMP      r5,#0                 ;2214
0026b8  d0c7              BEQ      |L1.9802|
0026ba  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2216
0026be  f88d0000          STRB     r0,[sp,#0]            ;2216
0026c2  f8980038          LDRB     r0,[r8,#0x38]         ;2217
0026c6  f88d0001          STRB     r0,[sp,#1]            ;2217
0026ca  f898002c          LDRB     r0,[r8,#0x2c]         ;2218
0026ce  f88d0002          STRB     r0,[sp,#2]            ;2218
0026d2  f88d9003          STRB     r9,[sp,#3]            ;2219
0026d6  4669              MOV      r1,sp                 ;2220
0026d8  f1050010          ADD      r0,r5,#0x10           ;2220
0026dc  f7fffffe          BL       lc640_write_long_ptr
0026e0  f8980028          LDRB     r0,[r8,#0x28]         ;2222
0026e4  f88d0000          STRB     r0,[sp,#0]            ;2222
0026e8  f8980024          LDRB     r0,[r8,#0x24]         ;2223
0026ec  f88d0001          STRB     r0,[sp,#1]            ;2223
0026f0  f8980020          LDRB     r0,[r8,#0x20]         ;2224
0026f4  f88d0002          STRB     r0,[sp,#2]            ;2224
0026f8  f88d9003          STRB     r9,[sp,#3]            ;2225
0026fc  4669              MOV      r1,sp                 ;2226
0026fe  f1050014          ADD      r0,r5,#0x14           ;2226
002702  f7fffffe          BL       lc640_write_long_ptr
002706  f04f0442          MOV      r4,#0x42              ;2228
00270a  f88d4000          STRB     r4,[sp,#0]            ;2228
00270e  f88d4001          STRB     r4,[sp,#1]            ;2229
002712  f88d4002          STRB     r4,[sp,#2]            ;2230
002716  f88d4003          STRB     r4,[sp,#3]            ;2231
00271a  4669              MOV      r1,sp                 ;2232
00271c  f1050018          ADD      r0,r5,#0x18           ;2232
002720  f7fffffe          BL       lc640_write_long_ptr
002724  f88d4000          STRB     r4,[sp,#0]            ;2234
002728  f88d4001          STRB     r4,[sp,#1]            ;2235
00272c  f88d4002          STRB     r4,[sp,#2]            ;2236
002730  f88d4003          STRB     r4,[sp,#3]            ;2237
002734  4669              MOV      r1,sp                 ;2238
002736  f105001c          ADD      r0,r5,#0x1c           ;2238
00273a  f7fffffe          BL       lc640_write_long_ptr
00273e  e487              B        |L1.8272|
;;;2242   
                          ENDP

                  fz_mem_hndl PROC
;;;2243   //-----------------------------------------------
;;;2244   void fz_mem_hndl(unsigned short in)	 //   
002740  e92d4ff8          PUSH     {r3-r11,lr}
;;;2245   {
;;;2246   char data[4];
;;;2247   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
002744  f04f0600          MOV      r6,#0
002748  4634              MOV      r4,r6
;;;2248   //char avar_simbol;
;;;2249   
;;;2250   if(in==1) //  
;;;2251   	{
;;;2252   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2253   	event_ptr++;	
;;;2254   	if(event_ptr>63)event_ptr=0;	
;;;2255   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2256   	
;;;2257       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2258   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2259   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2260   	
;;;2261   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2262   	
;;;2263   	data[0]='f';
;;;2264   	data[1]=0; 
;;;2265   	data[2]='Z';
;;;2266   	data[3]=0;
;;;2267   	lc640_write_long_ptr(lc640_adr,data);
;;;2268   
;;;2269   	data[0]=0;
;;;2270   	data[1]=0;
;;;2271   	data[2]=0;
;;;2272   	data[3]=0;
;;;2273   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2274   
;;;2275   	data[0]=LPC_RTC->YEAR;
00274a  f8df835c          LDR      r8,|L1.10920|
00274e  46a1              MOV      r9,r4                 ;2247
002750  f44f6a80          MOV      r10,#0x400            ;2261
002754  2801              CMP      r0,#1                 ;2250
002756  d010              BEQ      |L1.10106|
;;;2276   	data[1]=LPC_RTC->MONTH;
;;;2277   	data[2]=LPC_RTC->DOM;
;;;2278   	data[3]=0;
;;;2279   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2280   
;;;2281   	data[0]=LPC_RTC->HOUR;
;;;2282   	data[1]=LPC_RTC->MIN;
;;;2283   	data[2]=LPC_RTC->SEC;
;;;2284   	data[3]=0;
;;;2285   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2286   	
;;;2287   	data[0]='A';
;;;2288   	data[1]='A';
;;;2289   	data[2]='A';
;;;2290   	data[3]='A';
;;;2291   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2292   	
;;;2293   	data[0]='A';
;;;2294   	data[1]='A';
;;;2295   	data[2]='A';
;;;2296   	data[3]='A';
;;;2297   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2298   	
;;;2299   	data[0]='A';
;;;2300   	data[1]='A';
;;;2301   	data[2]='A';
;;;2302   	data[3]='A';
;;;2303   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2304   	
;;;2305   	data[0]='A';
;;;2306   	data[1]='A';
;;;2307   	data[2]='A';
;;;2308   	data[3]='A';
;;;2309   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2310    	
;;;2311   	}
;;;2312   
;;;2313   else if(in==0)	// 
002758  2800              CMP      r0,#0
00275a  d07d              BEQ      |L1.10328|
;;;2314   	{      
;;;2315   	char i;     
;;;2316   	event_ptr_find=0;
;;;2317   	for (i=0;i<63;i++)
;;;2318   		{
;;;2319   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2320   
;;;2321        	lc640_read_long_ptr(lc640_adr,data);
;;;2322        
;;;2323        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;2324        		{        
;;;2325        		if(event_ptr_find)event_ptr_find--;
;;;2326        		else event_ptr_find=63;
;;;2327        		if(event_ptr_find==event_ptr)
;;;2328   				{
;;;2329   				lc640_adr=0;
;;;2330   				break;
;;;2331   				}
;;;2332        		else continue;
;;;2333        		}
;;;2334        	else 
;;;2335        		{
;;;2336        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2337        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2338        			{        
;;;2339        			if(event_ptr_find)event_ptr_find--;
;;;2340            		else event_ptr_find=63;
;;;2341            		if(event_ptr_find==event_ptr)
;;;2342   					{
;;;2343   					lc640_adr=0;
;;;2344   					break;
;;;2345   					}
;;;2346        			else continue;
;;;2347        			}
;;;2348        		}	
;;;2349   		}
;;;2350   	if(lc640_adr!=0)
;;;2351   		{
;;;2352   		data[0]=LPC_RTC->YEAR;
;;;2353   		data[1]=LPC_RTC->MONTH;
;;;2354   		data[2]=LPC_RTC->DOM;
;;;2355   		data[3]=0;
;;;2356   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2357   	
;;;2358   		data[0]=LPC_RTC->HOUR;
;;;2359   		data[1]=LPC_RTC->MIN;
;;;2360   		data[2]=LPC_RTC->SEC;
;;;2361   		data[3]=0;
;;;2362   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2363   		
;;;2364   		data[0]='C';
;;;2365   		data[1]='C';
;;;2366   		data[2]='C';
;;;2367   		data[3]='C';
;;;2368   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2369   		
;;;2370   		data[0]='C';
;;;2371   		data[1]='C';
;;;2372   		data[2]='C';
;;;2373   		data[3]='C';
;;;2374   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2375   		}
;;;2376   	}
;;;2377   else if(in==10) 	//  
00275c  280a              CMP      r0,#0xa
00275e  d17c              BNE      |L1.10330|
;;;2378   	{      
;;;2379   	char i;     
;;;2380   
;;;2381   	event_ptr_find=0;
;;;2382   	for (i=0;i<63;i++)
002760  f04f0700          MOV      r7,#0
                  |L1.10084|
;;;2383   		{
;;;2384   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
002764  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2385   
;;;2386        	lc640_read_long_ptr(lc640_adr,data);
002768  4669              MOV      r1,sp
00276a  4628              MOV      r0,r5
00276c  f7fffffe          BL       lc640_read_long_ptr
;;;2387        
;;;2388        	if(!((data[0]=='f')&&(data[2]=='Z')))
002770  f89d0000          LDRB     r0,[sp,#0]
002774  2866              CMP      r0,#0x66
002776  d171              BNE      |L1.10332|
002778  e11c              B        |L1.10676|
                  |L1.10106|
00277a  f44f6560          MOV      r5,#0xe00             ;2252
00277e  4628              MOV      r0,r5                 ;2252
002780  f7fffffe          BL       lc640_read_int
002784  f1000001          ADD      r0,r0,#1              ;2253
002788  4604              MOV      r4,r0                 ;2253
00278a  2c3f              CMP      r4,#0x3f              ;2254
00278c  d901              BLS      |L1.10130|
00278e  f04f0400          MOV      r4,#0                 ;2254
                  |L1.10130|
002792  b221              SXTH     r1,r4                 ;2255
002794  4628              MOV      r0,r5                 ;2255
002796  f7fffffe          BL       lc640_write_int
00279a  f6406602          MOV      r6,#0xe02             ;2257
00279e  4630              MOV      r0,r6                 ;2257
0027a0  f7fffffe          BL       lc640_read_int
0027a4  283f              CMP      r0,#0x3f              ;2258
0027a6  d000              BEQ      |L1.10154|
0027a8  4620              MOV      r0,r4                 ;2258
                  |L1.10154|
0027aa  b201              SXTH     r1,r0                 ;2259
0027ac  4630              MOV      r0,r6                 ;2259
0027ae  f7fffffe          BL       lc640_write_int
0027b2  4628              MOV      r0,r5                 ;2261
0027b4  f7fffffe          BL       lc640_read_int
0027b8  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2261
0027bc  f04f0066          MOV      r0,#0x66              ;2263
0027c0  f88d0000          STRB     r0,[sp,#0]            ;2263
0027c4  f88d9001          STRB     r9,[sp,#1]            ;2264
0027c8  f04f005a          MOV      r0,#0x5a              ;2265
0027cc  f88d0002          STRB     r0,[sp,#2]            ;2265
0027d0  f88d9003          STRB     r9,[sp,#3]            ;2266
0027d4  4669              MOV      r1,sp                 ;2267
0027d6  4620              MOV      r0,r4                 ;2267
0027d8  f7fffffe          BL       lc640_write_long_ptr
0027dc  f8cd9000          STR      r9,[sp,#0]            ;2272
0027e0  4669              MOV      r1,sp                 ;2273
0027e2  1d20              ADDS     r0,r4,#4              ;2273
0027e4  f7fffffe          BL       lc640_write_long_ptr
0027e8  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2275
0027ec  f88d0000          STRB     r0,[sp,#0]            ;2275
0027f0  f8980038          LDRB     r0,[r8,#0x38]         ;2276
0027f4  f88d0001          STRB     r0,[sp,#1]            ;2276
0027f8  f898002c          LDRB     r0,[r8,#0x2c]         ;2277
0027fc  f88d0002          STRB     r0,[sp,#2]            ;2277
002800  f88d9003          STRB     r9,[sp,#3]            ;2278
002804  4669              MOV      r1,sp                 ;2279
002806  f1040008          ADD      r0,r4,#8              ;2279
00280a  f7fffffe          BL       lc640_write_long_ptr
00280e  f8980028          LDRB     r0,[r8,#0x28]         ;2281
002812  f88d0000          STRB     r0,[sp,#0]            ;2281
002816  f8980024          LDRB     r0,[r8,#0x24]         ;2282
00281a  f88d0001          STRB     r0,[sp,#1]            ;2282
00281e  f8980020          LDRB     r0,[r8,#0x20]         ;2283
002822  f88d0002          STRB     r0,[sp,#2]            ;2283
002826  f88d9003          STRB     r9,[sp,#3]            ;2284
00282a  4669              MOV      r1,sp                 ;2285
00282c  f104000c          ADD      r0,r4,#0xc            ;2285
002830  f7fffffe          BL       lc640_write_long_ptr
002834  f04f0541          MOV      r5,#0x41              ;2287
002838  f88d5000          STRB     r5,[sp,#0]            ;2287
00283c  f88d5001          STRB     r5,[sp,#1]            ;2288
002840  f88d5002          STRB     r5,[sp,#2]            ;2289
002844  f88d5003          STRB     r5,[sp,#3]            ;2290
002848  4669              MOV      r1,sp                 ;2291
00284a  f1040010          ADD      r0,r4,#0x10           ;2291
00284e  f7fffffe          BL       lc640_write_long_ptr
002852  f88d5000          STRB     r5,[sp,#0]            ;2293
002856  e002              B        |L1.10334|
                  |L1.10328|
002858  e027              B        |L1.10410|
                  |L1.10330|
00285a  e025              B        |L1.10408|
                  |L1.10332|
00285c  e0ae              B        |L1.10684|
                  |L1.10334|
00285e  f88d5001          STRB     r5,[sp,#1]            ;2294
002862  f88d5002          STRB     r5,[sp,#2]            ;2295
002866  f88d5003          STRB     r5,[sp,#3]            ;2296
00286a  4669              MOV      r1,sp                 ;2297
00286c  f1040014          ADD      r0,r4,#0x14           ;2297
002870  f7fffffe          BL       lc640_write_long_ptr
002874  f88d5000          STRB     r5,[sp,#0]            ;2299
002878  f88d5001          STRB     r5,[sp,#1]            ;2300
00287c  f88d5002          STRB     r5,[sp,#2]            ;2301
002880  f88d5003          STRB     r5,[sp,#3]            ;2302
002884  4669              MOV      r1,sp                 ;2303
002886  f1040018          ADD      r0,r4,#0x18           ;2303
00288a  f7fffffe          BL       lc640_write_long_ptr
00288e  f88d5000          STRB     r5,[sp,#0]            ;2305
002892  f88d5001          STRB     r5,[sp,#1]            ;2306
002896  f88d5002          STRB     r5,[sp,#2]            ;2307
00289a  f88d5003          STRB     r5,[sp,#3]            ;2308
00289e  4669              MOV      r1,sp                 ;2309
0028a0  f104001c          ADD      r0,r4,#0x1c           ;2309
0028a4  f7fffffe          BL       lc640_write_long_ptr
                  |L1.10408|
;;;2389        		{        
;;;2390        		if(event_ptr_find)event_ptr_find--;
;;;2391        		else event_ptr_find=63;
;;;2392        		if(event_ptr_find==event_ptr)
;;;2393   				{
;;;2394   				lc640_adr=0;
;;;2395   				break;
;;;2396   				}
;;;2397        		else continue;
;;;2398        		}
;;;2399        	else 
;;;2400        		{
;;;2401        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2402        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2403        			{        
;;;2404        			if(event_ptr_find)event_ptr_find--;
;;;2405            		else event_ptr_find=63;
;;;2406            		if(event_ptr_find==event_ptr)
;;;2407   					{
;;;2408   					lc640_adr=0;
;;;2409   					break;
;;;2410   					}
;;;2411        			else continue;
;;;2412        			}
;;;2413        		}	
;;;2414   		}
;;;2415   	if(lc640_adr!=0)
;;;2416   		{
;;;2417   		data[0]=LPC_RTC->YEAR;
;;;2418   		data[1]=LPC_RTC->MONTH;
;;;2419   		data[2]=LPC_RTC->DOM;
;;;2420   		data[3]=0;
;;;2421   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2422   	
;;;2423   		data[0]=LPC_RTC->HOUR;
;;;2424   		data[1]=LPC_RTC->MIN;
;;;2425   		data[2]=LPC_RTC->SEC;
;;;2426   		data[3]=0;
;;;2427   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2428   		
;;;2429   		data[0]='B';
;;;2430   		data[1]='B';
;;;2431   		data[2]='B';
;;;2432   		data[3]='B';
;;;2433   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2434   		
;;;2435   		data[0]='B';
;;;2436   		data[1]='B';
;;;2437   		data[2]='B';
;;;2438   		data[3]='B';
;;;2439   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2440   		}
;;;2441   	}
;;;2442   }
0028a8  e496              B        |L1.8664|
                  |L1.10410|
0028aa  f04f0700          MOV      r7,#0                 ;2317
                  |L1.10414|
0028ae  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2319
0028b2  4669              MOV      r1,sp                 ;2321
0028b4  4628              MOV      r0,r5                 ;2321
0028b6  f7fffffe          BL       lc640_read_long_ptr
0028ba  f89d0000          LDRB     r0,[sp,#0]            ;2323
0028be  2866              CMP      r0,#0x66              ;2323
0028c0  d103              BNE      |L1.10442|
0028c2  f89d0002          LDRB     r0,[sp,#2]            ;2323
0028c6  285a              CMP      r0,#0x5a              ;2323
0028c8  d00a              BEQ      |L1.10464|
                  |L1.10442|
0028ca  b114              CBZ      r4,|L1.10450|
0028cc  f1a40401          SUB      r4,r4,#1              ;2325
0028d0  e001              B        |L1.10454|
                  |L1.10450|
0028d2  f04f043f          MOV      r4,#0x3f              ;2326
                  |L1.10454|
0028d6  42b4              CMP      r4,r6                 ;2327
0028d8  d122              BNE      |L1.10528|
0028da  f04f0500          MOV      r5,#0                 ;2329
0028de  e024              B        |L1.10538|
                  |L1.10464|
0028e0  4669              MOV      r1,sp                 ;2336
0028e2  f1050010          ADD      r0,r5,#0x10           ;2336
0028e6  f7fffffe          BL       lc640_read_long_ptr
0028ea  f89d0000          LDRB     r0,[sp,#0]            ;2337
0028ee  2841              CMP      r0,#0x41              ;2337
0028f0  d10b              BNE      |L1.10506|
0028f2  f89d0001          LDRB     r0,[sp,#1]            ;2337
0028f6  2841              CMP      r0,#0x41              ;2337
0028f8  d107              BNE      |L1.10506|
0028fa  f89d0002          LDRB     r0,[sp,#2]            ;2337
0028fe  2841              CMP      r0,#0x41              ;2337
002900  d103              BNE      |L1.10506|
002902  f89d0003          LDRB     r0,[sp,#3]            ;2337
002906  2841              CMP      r0,#0x41              ;2337
002908  d00a              BEQ      |L1.10528|
                  |L1.10506|
00290a  b114              CBZ      r4,|L1.10514|
00290c  f1a40401          SUB      r4,r4,#1              ;2339
002910  e001              B        |L1.10518|
                  |L1.10514|
002912  f04f043f          MOV      r4,#0x3f              ;2340
                  |L1.10518|
002916  42b4              CMP      r4,r6                 ;2341
002918  d102              BNE      |L1.10528|
00291a  f04f0500          MOV      r5,#0                 ;2343
00291e  e004              B        |L1.10538|
                  |L1.10528|
002920  f1070701          ADD      r7,r7,#1              ;2317
002924  b2ff              UXTB     r7,r7                 ;2317
002926  2f3f              CMP      r7,#0x3f              ;2317
002928  d3c1              BCC      |L1.10414|
                  |L1.10538|
00292a  2d00              CMP      r5,#0                 ;2350
00292c  d0bc              BEQ      |L1.10408|
00292e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2352
002932  f88d0000          STRB     r0,[sp,#0]            ;2352
002936  f8980038          LDRB     r0,[r8,#0x38]         ;2353
00293a  f88d0001          STRB     r0,[sp,#1]            ;2353
00293e  f898002c          LDRB     r0,[r8,#0x2c]         ;2354
002942  f88d0002          STRB     r0,[sp,#2]            ;2354
002946  f88d9003          STRB     r9,[sp,#3]            ;2355
00294a  4669              MOV      r1,sp                 ;2356
00294c  f1050010          ADD      r0,r5,#0x10           ;2356
002950  f7fffffe          BL       lc640_write_long_ptr
002954  f8980028          LDRB     r0,[r8,#0x28]         ;2358
002958  f88d0000          STRB     r0,[sp,#0]            ;2358
00295c  f8980024          LDRB     r0,[r8,#0x24]         ;2359
002960  f88d0001          STRB     r0,[sp,#1]            ;2359
002964  f8980020          LDRB     r0,[r8,#0x20]         ;2360
002968  f88d0002          STRB     r0,[sp,#2]            ;2360
00296c  f88d9003          STRB     r9,[sp,#3]            ;2361
002970  4669              MOV      r1,sp                 ;2362
002972  f1050014          ADD      r0,r5,#0x14           ;2362
002976  f7fffffe          BL       lc640_write_long_ptr
00297a  f04f0443          MOV      r4,#0x43              ;2364
00297e  f88d4000          STRB     r4,[sp,#0]            ;2364
002982  f88d4001          STRB     r4,[sp,#1]            ;2365
002986  f88d4002          STRB     r4,[sp,#2]            ;2366
00298a  f88d4003          STRB     r4,[sp,#3]            ;2367
00298e  4669              MOV      r1,sp                 ;2368
002990  f1050018          ADD      r0,r5,#0x18           ;2368
002994  f7fffffe          BL       lc640_write_long_ptr
002998  f88d4000          STRB     r4,[sp,#0]            ;2370
00299c  f88d4001          STRB     r4,[sp,#1]            ;2371
0029a0  f88d4002          STRB     r4,[sp,#2]            ;2372
0029a4  f88d4003          STRB     r4,[sp,#3]            ;2373
0029a8  4669              MOV      r1,sp                 ;2374
0029aa  f105001c          ADD      r0,r5,#0x1c           ;2374
0029ae  f7fffffe          BL       lc640_write_long_ptr
                  |L1.10674|
0029b2  e411              B        |L1.8664|
                  |L1.10676|
0029b4  f89d0002          LDRB     r0,[sp,#2]            ;2388
0029b8  285a              CMP      r0,#0x5a              ;2388
0029ba  d00a              BEQ      |L1.10706|
                  |L1.10684|
0029bc  b114              CBZ      r4,|L1.10692|
0029be  f1a40401          SUB      r4,r4,#1              ;2390
0029c2  e001              B        |L1.10696|
                  |L1.10692|
0029c4  f04f043f          MOV      r4,#0x3f              ;2391
                  |L1.10696|
0029c8  42b4              CMP      r4,r6                 ;2392
0029ca  d122              BNE      |L1.10770|
0029cc  f04f0500          MOV      r5,#0                 ;2394
0029d0  e025              B        |L1.10782|
                  |L1.10706|
0029d2  4669              MOV      r1,sp                 ;2401
0029d4  f1050010          ADD      r0,r5,#0x10           ;2401
0029d8  f7fffffe          BL       lc640_read_long_ptr
0029dc  f89d0000          LDRB     r0,[sp,#0]            ;2402
0029e0  2841              CMP      r0,#0x41              ;2402
0029e2  d10b              BNE      |L1.10748|
0029e4  f89d0001          LDRB     r0,[sp,#1]            ;2402
0029e8  2841              CMP      r0,#0x41              ;2402
0029ea  d107              BNE      |L1.10748|
0029ec  f89d0002          LDRB     r0,[sp,#2]            ;2402
0029f0  2841              CMP      r0,#0x41              ;2402
0029f2  d103              BNE      |L1.10748|
0029f4  f89d0003          LDRB     r0,[sp,#3]            ;2402
0029f8  2841              CMP      r0,#0x41              ;2402
0029fa  d00a              BEQ      |L1.10770|
                  |L1.10748|
0029fc  b114              CBZ      r4,|L1.10756|
0029fe  f1a40401          SUB      r4,r4,#1              ;2404
002a02  e001              B        |L1.10760|
                  |L1.10756|
002a04  f04f043f          MOV      r4,#0x3f              ;2405
                  |L1.10760|
002a08  42b4              CMP      r4,r6                 ;2406
002a0a  d102              BNE      |L1.10770|
002a0c  f04f0500          MOV      r5,#0                 ;2408
002a10  e005              B        |L1.10782|
                  |L1.10770|
002a12  f1070701          ADD      r7,r7,#1              ;2382
002a16  b2ff              UXTB     r7,r7                 ;2382
002a18  2f3f              CMP      r7,#0x3f              ;2382
002a1a  f4ffaea3          BCC      |L1.10084|
                  |L1.10782|
002a1e  2d00              CMP      r5,#0                 ;2415
002a20  d0c7              BEQ      |L1.10674|
002a22  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2417
002a26  f88d0000          STRB     r0,[sp,#0]            ;2417
002a2a  f8980038          LDRB     r0,[r8,#0x38]         ;2418
002a2e  f88d0001          STRB     r0,[sp,#1]            ;2418
002a32  f898002c          LDRB     r0,[r8,#0x2c]         ;2419
002a36  f88d0002          STRB     r0,[sp,#2]            ;2419
002a3a  f88d9003          STRB     r9,[sp,#3]            ;2420
002a3e  4669              MOV      r1,sp                 ;2421
002a40  f1050010          ADD      r0,r5,#0x10           ;2421
002a44  f7fffffe          BL       lc640_write_long_ptr
002a48  f8980028          LDRB     r0,[r8,#0x28]         ;2423
002a4c  f88d0000          STRB     r0,[sp,#0]            ;2423
002a50  f8980024          LDRB     r0,[r8,#0x24]         ;2424
002a54  f88d0001          STRB     r0,[sp,#1]            ;2424
002a58  f8980020          LDRB     r0,[r8,#0x20]         ;2425
002a5c  f88d0002          STRB     r0,[sp,#2]            ;2425
002a60  f88d9003          STRB     r9,[sp,#3]            ;2426
002a64  4669              MOV      r1,sp                 ;2427
002a66  f1050014          ADD      r0,r5,#0x14           ;2427
002a6a  f7fffffe          BL       lc640_write_long_ptr
002a6e  f04f0442          MOV      r4,#0x42              ;2429
002a72  f88d4000          STRB     r4,[sp,#0]            ;2429
002a76  f88d4001          STRB     r4,[sp,#1]            ;2430
002a7a  f88d4002          STRB     r4,[sp,#2]            ;2431
002a7e  f88d4003          STRB     r4,[sp,#3]            ;2432
002a82  4669              MOV      r1,sp                 ;2433
002a84  f1050018          ADD      r0,r5,#0x18           ;2433
002a88  f7fffffe          BL       lc640_write_long_ptr
002a8c  f88d4000          STRB     r4,[sp,#0]            ;2435
002a90  f88d4001          STRB     r4,[sp,#1]            ;2436
002a94  f88d4002          STRB     r4,[sp,#2]            ;2437
002a98  f88d4003          STRB     r4,[sp,#3]            ;2438
002a9c  4669              MOV      r1,sp                 ;2439
002a9e  f105001c          ADD      r0,r5,#0x1c           ;2439
002aa2  f7fffffe          BL       lc640_write_long_ptr
002aa6  e41c              B        |L1.8930|
                          ENDP

                  |L1.10920|
                          DCD      0x40024000

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  ke_mem_hndl PROC
;;;77     //-----------------------------------------------
;;;78     void avar_hndl(void)
000000  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;79     {
;;;80     //static unsigned avar_stat_old;
;;;81     char i;
;;;82     //unsigned avar_stat_new,avar_stat_offed;
;;;83     
;;;84     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  b083              SUB      sp,sp,#0xc
000004  4605              MOV      r5,r0
000006  eb050045          ADD      r0,r5,r5,LSL #1
00000a  4948              LDR      r1,|L2.300|
00000c  eb001005          ADD      r0,r0,r5,LSL #4
000010  eb010180          ADD      r1,r1,r0,LSL #2
;;;85     else	   			SET_REG(avar_stat,0,0,1);
000014  4846              LDR      r0,|L2.304|
000016  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
;;;86     
;;;87     for(i=0;i<2;i++)
00001a  f1000001          ADD      r0,r0,#1
;;;88     	{
;;;89     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
00001e  eb010040          ADD      r0,r1,r0,LSL #1
000022  f9b00020          LDRSH    r0,[r0,#0x20]
000026  9001              STR      r0,[sp,#4]
000028  f44f6660          MOV      r6,#0xe00
00002c  4630              MOV      r0,r6
00002e  f7fffffe          BL       lc640_read_int
000032  f1000001          ADD      r0,r0,#1
000036  4604              MOV      r4,r0
000038  2c3f              CMP      r4,#0x3f
00003a  d901              BLS      |L2.64|
00003c  f04f0400          MOV      r4,#0
                  |L2.64|
000040  b221              SXTH     r1,r4
000042  4630              MOV      r0,r6
000044  f7fffffe          BL       lc640_write_int
000048  f6406702          MOV      r7,#0xe02
00004c  4638              MOV      r0,r7
;;;90     	else	   			SET_REG(avar_stat,0,1+i,1);
00004e  f7fffffe          BL       lc640_read_int
000052  283f              CMP      r0,#0x3f
000054  d000              BEQ      |L2.88|
000056  4620              MOV      r0,r4
                  |L2.88|
000058  b201              SXTH     r1,r0
00005a  4638              MOV      r0,r7
00005c  f7fffffe          BL       lc640_write_int
000060  4630              MOV      r0,r6                 ;87
000062  f7fffffe          BL       lc640_read_int
000066  f44f6180          MOV      r1,#0x400             ;87
;;;91     	}
;;;92     
;;;93     for(i=0;i<12;i++)
00006a  eb011440          ADD      r4,r1,r0,LSL #5
;;;94     	{
;;;95     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00006e  f04f0042          MOV      r0,#0x42
000072  f88d0008          STRB     r0,[sp,#8]
000076  f88d5009          STRB     r5,[sp,#9]
00007a  f04f004b          MOV      r0,#0x4b
00007e  f88d000a          STRB     r0,[sp,#0xa]
000082  f04f0600          MOV      r6,#0
000086  f88d600b          STRB     r6,[sp,#0xb]
00008a  a902              ADD      r1,sp,#8
00008c  4620              MOV      r0,r4
00008e  f7fffffe          BL       lc640_write_long_ptr
000092  f89d0010          LDRB     r0,[sp,#0x10]
000096  f88d0008          STRB     r0,[sp,#8]
;;;96     	else	   		SET_REG(avar_stat,0,3+i,1);
00009a  f89d0011          LDRB     r0,[sp,#0x11]
00009e  f88d0009          STRB     r0,[sp,#9]
0000a2  f89d0004          LDRB     r0,[sp,#4]
0000a6  f88d000a          STRB     r0,[sp,#0xa]
0000aa  f89d0005          LDRB     r0,[sp,#5]            ;93
0000ae  f88d000b          STRB     r0,[sp,#0xb]          ;93
;;;97     	}
;;;98     
;;;99     for(i=0;i<6;i++)
0000b2  a902              ADD      r1,sp,#8
0000b4  1d20              ADDS     r0,r4,#4
;;;100    	{
;;;101    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
0000b6  f7fffffe          BL       lc640_write_long_ptr
0000ba  f24020a2          MOV      r0,#0x2a2
0000be  f7fffffe          BL       lc640_read_long
0000c2  4d1c              LDR      r5,|L2.308|
0000c4  6028              STR      r0,[r5,#0]  ; ke_date
0000c6  4629              MOV      r1,r5
0000c8  f1040008          ADD      r0,r4,#8
0000cc  f7fffffe          BL       lc640_write_long_ptr
0000d0  f24020a6          MOV      r0,#0x2a6
0000d4  f7fffffe          BL       lc640_read_long
;;;102    	else	   		SET_REG(avar_stat,0,15+i,1);
0000d8  6068              STR      r0,[r5,#4]  ; ke_date
0000da  1d29              ADDS     r1,r5,#4
0000dc  f104000c          ADD      r0,r4,#0xc
0000e0  f7fffffe          BL       lc640_write_long_ptr
0000e4  4d14              LDR      r5,|L2.312|
0000e6  8ba8              LDRH     r0,[r5,#0x1c]         ;99
0000e8  f88d0008          STRB     r0,[sp,#8]            ;99
0000ec  7e28              LDRB     r0,[r5,#0x18]         ;99
0000ee  f88d0009          STRB     r0,[sp,#9]            ;99
;;;103    	}
;;;104    
;;;105    /*for(i=0;i<4;i++)
;;;106    	{
;;;107    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;108    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;109    	}  */
;;;110    for(i=0;i<4;i++)
0000f2  7b28              LDRB     r0,[r5,#0xc]
;;;111    	{
;;;112    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000f4  f88d000a          STRB     r0,[sp,#0xa]
0000f8  f88d600b          STRB     r6,[sp,#0xb]
;;;113    	else	   		SET_REG(avar_stat,0,24+i,1);
0000fc  a902              ADD      r1,sp,#8
0000fe  f1040010          ADD      r0,r4,#0x10
000102  f7fffffe          BL       lc640_write_long_ptr
000106  7a28              LDRB     r0,[r5,#8]
000108  f88d0008          STRB     r0,[sp,#8]
00010c  7928              LDRB     r0,[r5,#4]            ;110
00010e  f88d0009          STRB     r0,[sp,#9]            ;110
000112  7828              LDRB     r0,[r5,#0]            ;110
000114  f88d000a          STRB     r0,[sp,#0xa]          ;110
;;;114    	}
;;;115    
;;;116    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;117    //else	   			SET_REG(avar_stat,0,28,1);
;;;118    
;;;119    
;;;120    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000118  f88d600b          STRB     r6,[sp,#0xb]
00011c  a902              ADD      r1,sp,#8
00011e  f1040014          ADD      r0,r4,#0x14
;;;121    
;;;122    avar_ind_stat|=avar_stat_new;
000122  f7fffffe          BL       lc640_write_long_ptr
000126  b005              ADD      sp,sp,#0x14
;;;123    
;;;124    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000128  bdf0              POP      {r4-r7,pc}
;;;125    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
;;;126    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
;;;127    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
;;;128    
;;;129    
;;;130    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
;;;131    
;;;132    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
;;;133    
;;;134    avar_ind_stat&=avar_stat_offed; 
;;;135    
;;;136    avar_stat_old=avar_stat;
;;;137    
;;;138    //oleg_start
;;;139    
;;;140    
;;;141    
;;;142    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
;;;143    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
;;;144    rki_avar1_ind_stat|=rki_avar1_stat_new;
;;;145    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
;;;146    rki_avar1_ind_stat&=rki_avar1_stat_offed;
;;;147    rki_avar1_stat_old=rki_avar1_stat;
;;;148    /*
;;;149    rki_avarI1_stat=status_di1;
;;;150    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;151    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;152    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;153    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;154    rki_avarI1_stat_old=rki_avarI1_stat;
;;;155    
;;;156    rki_avarI2_stat=status_di2;
;;;157    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;158    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;159    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;160    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;161    rki_avarI2_stat_old=rki_avarI2_stat;
;;;162    */
;;;163    //oleg_end
;;;164    }
;;;165    
                          ENDP

00012a  0000              DCW      0x0000
                  |L2.300|
                          DCD      bat
                  |L2.304|
                          DCD      bat_u_old_cnt
                  |L2.308|
                          DCD      ke_date
                  |L2.312|
                          DCD      0x40024020

                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  rki_avar1_stat
                          DCD      0x00000000
                  rki_avar1_ind_stat
                          DCD      0x00000000
                  rki_avar1_stat_old
                          DCD      0x00000000
                  rki_avar1_stat_new
                          DCD      0x00000000
                  rki_avar1_stat_offed
                          DCD      0x00000000
                  av_inv
                          DCD      0x00000000
00002c  0000              DCB      0x00,0x00
