; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\avar_hndl.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DUKU_ZVU --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;78     //-----------------------------------------------
;;;79     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;80     {
;;;81     //static unsigned avar_stat_old;
;;;82     char i;
;;;83     //unsigned avar_stat_new,avar_stat_offed;
;;;84     
;;;85     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48ff              LDR      r0,|L1.1024|
000004  4aff              LDR      r2,|L1.1028|
000006  7801              LDRB     r1,[r0,#0]  ; net_av
000008  6810              LDR      r0,[r2,#0]
00000a  b119              CBZ      r1,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6010              STR      r0,[r2,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;86     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6010              STR      r0,[r2,#0]  ; avar_stat
                  |L1.26|
;;;87     #ifndef UKU_220_IPS_TERMOKOMPENSAT //o_10
;;;88     for(i=0;i<2;i++)
;;;89     	{
;;;90     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
;;;91     	else	   			SET_REG(avar_stat,0,1+i,1);
;;;92     	}
;;;93     #endif //o_10
;;;94     for(i=0;i<18;i++)
00001a  f04f0000          MOV      r0,#0
;;;95     	{
;;;96     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00001e  4dfa              LDR      r5,|L1.1032|
000020  f04f0301          MOV      r3,#1
                  |L1.36|
000024  eb0001c0          ADD      r1,r0,r0,LSL #3
000028  eb011100          ADD      r1,r1,r0,LSL #4
00002c  eb050181          ADD      r1,r5,r1,LSL #2
000030  7849              LDRB     r1,[r1,#1]
000032  f0110fef          TST      r1,#0xef
000036  d00a              BEQ      |L1.78|
000038  f1000403          ADD      r4,r0,#3
00003c  fa03f104          LSL      r1,r3,r4
000040  6814              LDR      r4,[r2,#0]  ; avar_stat
000042  ea240401          BIC      r4,r4,r1
000046  ea440401          ORR      r4,r4,r1
00004a  6014              STR      r4,[r2,#0]  ; avar_stat
00004c  e007              B        |L1.94|
                  |L1.78|
;;;97     	else	   		SET_REG(avar_stat,0,3+i,1);
00004e  f1000103          ADD      r1,r0,#3
000052  6814              LDR      r4,[r2,#0]  ; avar_stat
000054  fa03f101          LSL      r1,r3,r1
000058  ea240401          BIC      r4,r4,r1
00005c  6014              STR      r4,[r2,#0]  ; avar_stat
                  |L1.94|
00005e  f1000001          ADD      r0,r0,#1              ;94
000062  b2c0              UXTB     r0,r0                 ;94
000064  2812              CMP      r0,#0x12              ;94
000066  d3dd              BCC      |L1.36|
;;;98     	}
;;;99     
;;;100    /*for(i=0;i<6;i++)
;;;101    	{
;;;102    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
;;;103    	else	   		SET_REG(avar_stat,0,15+i,1);
;;;104    	}*/
;;;105    
;;;106    /*for(i=0;i<4;i++)
;;;107    	{
;;;108    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;109    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;110    	}  */
;;;111    #ifndef UKU_FSO
;;;112    for(i=0;i<4;i++)
000068  f04f0000          MOV      r0,#0
;;;113    	{
;;;114    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
00006c  4de7              LDR      r5,|L1.1036|
                  |L1.110|
00006e  5c29              LDRB     r1,[r5,r0]
000070  2901              CMP      r1,#1
000072  d036              BEQ      |L1.226|
;;;115    	else	   		SET_REG(avar_stat,0,24+i,1);
000074  f1000118          ADD      r1,r0,#0x18
000078  fa03f401          LSL      r4,r3,r1
00007c  6811              LDR      r1,[r2,#0]  ; avar_stat
00007e  ea210104          BIC      r1,r1,r4
000082  6011              STR      r1,[r2,#0]  ; avar_stat
                  |L1.132|
000084  f1000001          ADD      r0,r0,#1              ;112
000088  b2c0              UXTB     r0,r0                 ;112
00008a  2804              CMP      r0,#4                 ;112
00008c  d3ef              BCC      |L1.110|
;;;116    	}
;;;117    #endif //UKU_FSO
;;;118    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;119    //else	   			SET_REG(avar_stat,0,28,1);
;;;120    
;;;121    
;;;122    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
00008e  6893              LDR      r3,[r2,#8]  ; avar_stat_old
000090  6810              LDR      r0,[r2,#0]  ; avar_stat
000092  ea200103          BIC      r1,r0,r3
000096  60d1              STR      r1,[r2,#0xc]  ; avar_stat_new
;;;123    
;;;124    avar_ind_stat|=avar_stat_new;
000098  6854              LDR      r4,[r2,#4]  ; avar_ind_stat
00009a  ea440401          ORR      r4,r4,r1
00009e  6054              STR      r4,[r2,#4]  ; avar_ind_stat
;;;125    
;;;126    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
0000a0  49db              LDR      r1,|L1.1040|
0000a2  880d              LDRH     r5,[r1,#0]  ; SK_ZVUK_EN
0000a4  b115              CBZ      r5,|L1.172|
0000a6  f0247480          BIC      r4,r4,#0x1000000
0000aa  6054              STR      r4,[r2,#4]  ; avar_ind_stat
                  |L1.172|
;;;127    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
0000ac  884c              LDRH     r4,[r1,#2]  ; SK_ZVUK_EN
0000ae  b11c              CBZ      r4,|L1.184|
0000b0  6854              LDR      r4,[r2,#4]  ; avar_ind_stat
0000b2  f0247400          BIC      r4,r4,#0x2000000
0000b6  6054              STR      r4,[r2,#4]  ; avar_ind_stat
                  |L1.184|
;;;128    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
0000b8  888c              LDRH     r4,[r1,#4]  ; SK_ZVUK_EN
0000ba  b11c              CBZ      r4,|L1.196|
0000bc  6854              LDR      r4,[r2,#4]  ; avar_ind_stat
0000be  f0246480          BIC      r4,r4,#0x4000000
0000c2  6054              STR      r4,[r2,#4]  ; avar_ind_stat
                  |L1.196|
;;;129    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
0000c4  88c9              LDRH     r1,[r1,#6]  ; SK_ZVUK_EN
0000c6  b119              CBZ      r1,|L1.208|
0000c8  6851              LDR      r1,[r2,#4]  ; avar_ind_stat
0000ca  f0216100          BIC      r1,r1,#0x8000000
0000ce  6051              STR      r1,[r2,#4]  ; avar_ind_stat
                  |L1.208|
;;;130    
;;;131    
;;;132    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
0000d0  ea230300          BIC      r3,r3,r0
0000d4  ea6f0103          MVN      r1,r3
0000d8  6111              STR      r1,[r2,#0x10]  ; avar_stat_offed
;;;133    
;;;134    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
0000da  4bce              LDR      r3,|L1.1044|
0000dc  881b              LDRH     r3,[r3,#0]  ; AV_OFF_AVT
0000de  b15b              CBZ      r3,|L1.248|
0000e0  e00e              B        |L1.256|
                  |L1.226|
0000e2  f1000418          ADD      r4,r0,#0x18           ;114
0000e6  fa03f104          LSL      r1,r3,r4              ;114
0000ea  6814              LDR      r4,[r2,#0]            ;114  ; avar_stat
0000ec  ea240401          BIC      r4,r4,r1              ;114
0000f0  ea440401          ORR      r4,r4,r1              ;114
0000f4  6014              STR      r4,[r2,#0]            ;114  ; avar_stat
0000f6  e7c5              B        |L1.132|
                  |L1.248|
0000f8  4bc7              LDR      r3,|L1.1048|
0000fa  ea410103          ORR      r1,r1,r3
0000fe  6111              STR      r1,[r2,#0x10]  ; avar_stat_offed
                  |L1.256|
;;;135    
;;;136    avar_ind_stat&=avar_stat_offed; 
000100  6913              LDR      r3,[r2,#0x10]  ; avar_stat_offed
000102  6851              LDR      r1,[r2,#4]  ; avar_ind_stat
000104  ea010103          AND      r1,r1,r3
000108  6051              STR      r1,[r2,#4]  ; avar_ind_stat
;;;137    
;;;138    avar_stat_old=avar_stat;
00010a  6090              STR      r0,[r2,#8]  ; avar_stat_old
;;;139    
;;;140    //oleg_start
;;;141    
;;;142    
;;;143    
;;;144    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
00010c  48c3              LDR      r0,|L1.1052|
00010e  49c4              LDR      r1,|L1.1056|
000110  8800              LDRH     r0,[r0,#0]  ; status_izm_r
000112  6809              LDR      r1,[r1,#0]  ; sk_alarm
000114  f000003f          AND      r0,r0,#0x3f
000118  ea402001          ORR      r0,r0,r1,LSL #8
00011c  6150              STR      r0,[r2,#0x14]  ; rki_avar1_stat
;;;145    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
00011e  69d3              LDR      r3,[r2,#0x1c]  ; rki_avar1_stat_old
000120  ea200103          BIC      r1,r0,r3
000124  6211              STR      r1,[r2,#0x20]  ; rki_avar1_stat_new
;;;146    rki_avar1_ind_stat|=rki_avar1_stat_new;
000126  6994              LDR      r4,[r2,#0x18]  ; rki_avar1_ind_stat
000128  ea440401          ORR      r4,r4,r1
;;;147    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
00012c  ea230300          BIC      r3,r3,r0
000130  ea6f0103          MVN      r1,r3
000134  6251              STR      r1,[r2,#0x24]  ; rki_avar1_stat_offed
;;;148    rki_avar1_ind_stat&=rki_avar1_stat_offed;
000136  ea040401          AND      r4,r4,r1
00013a  6194              STR      r4,[r2,#0x18]  ; rki_avar1_ind_stat
;;;149    rki_avar1_stat_old=rki_avar1_stat;
00013c  61d0              STR      r0,[r2,#0x1c]  ; rki_avar1_stat_old
;;;150    /*
;;;151    rki_avarI1_stat=status_di1;
;;;152    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;153    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;154    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;155    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;156    rki_avarI1_stat_old=rki_avarI1_stat;
;;;157    
;;;158    rki_avarI2_stat=status_di2;
;;;159    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;160    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;161    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;162    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;163    rki_avarI2_stat_old=rki_avarI2_stat;
;;;164    */
;;;165    //oleg_end
;;;166    }
00013e  bd30              POP      {r4,r5,pc}
;;;167    
                          ENDP

                  reload_hndl PROC
;;;168    //-----------------------------------------------
;;;169    void reload_hndl(void)
000140  b5f8              PUSH     {r3-r7,lr}
;;;170    {
;;;171    
;;;172    char data[4];
;;;173    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;174    
;;;175    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000142  f44f6560          MOV      r5,#0xe00
000146  4628              MOV      r0,r5
000148  f7fffffe          BL       lc640_read_int
;;;176    event_ptr++;	
00014c  f1000001          ADD      r0,r0,#1
000150  4604              MOV      r4,r0
;;;177    if(event_ptr>63)event_ptr=0;	
000152  2c3f              CMP      r4,#0x3f
000154  d901              BLS      |L1.346|
000156  f04f0400          MOV      r4,#0
                  |L1.346|
;;;178    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
00015a  b221              SXTH     r1,r4
00015c  4628              MOV      r0,r5
00015e  f7fffffe          BL       lc640_write_int
;;;179    	
;;;180    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000162  f6406602          MOV      r6,#0xe02
000166  4630              MOV      r0,r6
000168  f7fffffe          BL       lc640_read_int
;;;181    if(event_cnt!=63)event_cnt=event_ptr;
00016c  283f              CMP      r0,#0x3f
00016e  d000              BEQ      |L1.370|
000170  4620              MOV      r0,r4
                  |L1.370|
;;;182    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000172  b201              SXTH     r1,r0
000174  4630              MOV      r0,r6
000176  f7fffffe          BL       lc640_write_int
;;;183    	
;;;184    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
00017a  4628              MOV      r0,r5
00017c  f7fffffe          BL       lc640_read_int
000180  f44f6180          MOV      r1,#0x400
000184  eb011440          ADD      r4,r1,r0,LSL #5
;;;185    	
;;;186    data[0]='U';
000188  f04f0055          MOV      r0,#0x55
00018c  f88d0000          STRB     r0,[sp,#0]
;;;187    data[1]=0;
000190  f04f0600          MOV      r6,#0
000194  f88d6001          STRB     r6,[sp,#1]
;;;188    data[2]='R';
000198  f04f0052          MOV      r0,#0x52
00019c  f88d0002          STRB     r0,[sp,#2]
;;;189    data[3]=0;
0001a0  f88d6003          STRB     r6,[sp,#3]
;;;190    lc640_write_long_ptr(lc640_adr,data);
0001a4  4669              MOV      r1,sp
0001a6  4620              MOV      r0,r4
0001a8  f7fffffe          BL       lc640_write_long_ptr
;;;191    
;;;192    data[0]=0;
;;;193    data[1]=0;
;;;194    data[2]=0;
;;;195    data[3]=0;
0001ac  9600              STR      r6,[sp,#0]
;;;196    lc640_write_long_ptr(lc640_adr+4,data);
0001ae  4669              MOV      r1,sp
0001b0  1d20              ADDS     r0,r4,#4
0001b2  f7fffffe          BL       lc640_write_long_ptr
;;;197    
;;;198    data[0]=LPC_RTC->YEAR;
0001b6  4d9b              LDR      r5,|L1.1060|
0001b8  8ba8              LDRH     r0,[r5,#0x1c]
0001ba  f88d0000          STRB     r0,[sp,#0]
;;;199    data[1]=LPC_RTC->MONTH;
0001be  7e28              LDRB     r0,[r5,#0x18]
0001c0  f88d0001          STRB     r0,[sp,#1]
;;;200    data[2]=LPC_RTC->DOM;
0001c4  7b28              LDRB     r0,[r5,#0xc]
0001c6  f88d0002          STRB     r0,[sp,#2]
;;;201    data[3]=0;
0001ca  f88d6003          STRB     r6,[sp,#3]
;;;202    lc640_write_long_ptr(lc640_adr+8,data);
0001ce  4669              MOV      r1,sp
0001d0  f1040008          ADD      r0,r4,#8
0001d4  f7fffffe          BL       lc640_write_long_ptr
;;;203    
;;;204    data[0]=LPC_RTC->HOUR;
0001d8  7a28              LDRB     r0,[r5,#8]
0001da  f88d0000          STRB     r0,[sp,#0]
;;;205    data[1]=LPC_RTC->MIN;
0001de  7928              LDRB     r0,[r5,#4]
0001e0  f88d0001          STRB     r0,[sp,#1]
;;;206    data[2]=LPC_RTC->SEC;
0001e4  7828              LDRB     r0,[r5,#0]
0001e6  f88d0002          STRB     r0,[sp,#2]
;;;207    data[3]=LPC_SC->RSID;
0001ea  488f              LDR      r0,|L1.1064|
0001ec  f8d00180          LDR      r0,[r0,#0x180]
0001f0  f88d0003          STRB     r0,[sp,#3]
;;;208    
;;;209    lc640_write_long_ptr(lc640_adr+12,data);
0001f4  4669              MOV      r1,sp
0001f6  f104000c          ADD      r0,r4,#0xc
0001fa  f7fffffe          BL       lc640_write_long_ptr
;;;210    	
;;;211    data[0]='A';
0001fe  f04f0541          MOV      r5,#0x41
000202  f88d5000          STRB     r5,[sp,#0]
;;;212    data[1]='A';
000206  f88d5001          STRB     r5,[sp,#1]
;;;213    data[2]='A';
00020a  f88d5002          STRB     r5,[sp,#2]
;;;214    data[3]='A';
00020e  f88d5003          STRB     r5,[sp,#3]
;;;215    lc640_write_long_ptr(lc640_adr+16,data);
000212  4669              MOV      r1,sp
000214  f1040010          ADD      r0,r4,#0x10
000218  f7fffffe          BL       lc640_write_long_ptr
;;;216    	
;;;217    data[0]='A';
00021c  f88d5000          STRB     r5,[sp,#0]
;;;218    data[1]='A';
000220  f88d5001          STRB     r5,[sp,#1]
;;;219    data[2]='A';
000224  f88d5002          STRB     r5,[sp,#2]
;;;220    data[3]='A';
000228  f88d5003          STRB     r5,[sp,#3]
;;;221    lc640_write_long_ptr(lc640_adr+20,data);
00022c  4669              MOV      r1,sp
00022e  f1040014          ADD      r0,r4,#0x14
000232  f7fffffe          BL       lc640_write_long_ptr
;;;222    	
;;;223    data[0]='A';
000236  f88d5000          STRB     r5,[sp,#0]
;;;224    data[1]='A';
00023a  f88d5001          STRB     r5,[sp,#1]
;;;225    data[2]='A';
00023e  f88d5002          STRB     r5,[sp,#2]
;;;226    data[3]='A';
000242  f88d5003          STRB     r5,[sp,#3]
;;;227    lc640_write_long_ptr(lc640_adr+24,data);
000246  4669              MOV      r1,sp
000248  f1040018          ADD      r0,r4,#0x18
00024c  f7fffffe          BL       lc640_write_long_ptr
;;;228    	
;;;229    data[0]='A';
000250  f88d5000          STRB     r5,[sp,#0]
;;;230    data[1]='A';
000254  f88d5001          STRB     r5,[sp,#1]
;;;231    data[2]='A';
000258  f88d5002          STRB     r5,[sp,#2]
;;;232    data[3]='A';
00025c  f88d5003          STRB     r5,[sp,#3]
;;;233    lc640_write_long_ptr(lc640_adr+28,data);				
000260  4669              MOV      r1,sp
000262  f104001c          ADD      r0,r4,#0x1c
000266  f7fffffe          BL       lc640_write_long_ptr
;;;234    	
;;;235    	
;;;236    }
00026a  bdf8              POP      {r3-r7,pc}
;;;237    
                          ENDP

                  avar_unet_hndl PROC
;;;238    //-----------------------------------------------
;;;239    void avar_unet_hndl(char in)
00026c  e92d4ff8          PUSH     {r3-r11,lr}
;;;240    {
000270  4604              MOV      r4,r0
;;;241    
;;;242    char data[4];
;;;243    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;244    
;;;245    
;;;246    if(in==1)
;;;247    	{
;;;248    	net_av|=1; //o_10
000272  4963              LDR      r1,|L1.1024|
;;;249    	net_av_2min_timer=1200;
;;;250    
;;;251    	//beep_init(0x01L,'O');
;;;252    	//a.av.bAN=1;
;;;253    
;;;254    
;;;255    	//beep_init(0x33333333,'A');
;;;256    	 
;;;257    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;258    	event_ptr++;	
;;;259    	if(event_ptr>63)event_ptr=0;	
;;;260    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;261    	
;;;262         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;263    	if(event_cnt!=63)event_cnt=event_ptr;
;;;264    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;265    	
;;;266    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;267    	
;;;268    	data[0]='P';
;;;269    	data[1]=0;
;;;270    	data[2]='A';
;;;271    	data[3]=0;
;;;272    	lc640_write_long_ptr(lc640_adr,data);
;;;273    
;;;274    	data[0]=0;//*((char*)&Unet_store);
;;;275    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;276    	data[2]=0;
;;;277    	data[3]=0;
;;;278    	lc640_write_long_ptr(lc640_adr+4,data);
;;;279    
;;;280    	data[0]=LPC_RTC->YEAR;
000274  4d6d              LDR      r5,|L1.1068|
000276  f04f0600          MOV      r6,#0                 ;259
00027a  7808              LDRB     r0,[r1,#0]            ;248
00027c  f04f0b50          MOV      r11,#0x50             ;268
000280  f04f0841          MOV      r8,#0x41              ;270
000284  f44f6260          MOV      r2,#0xe00             ;257
000288  f6406a02          MOV      r10,#0xe02            ;262
00028c  f44f6780          MOV      r7,#0x400             ;266
000290  2c01              CMP      r4,#1                 ;246
000292  d008              BEQ      |L1.678|
;;;281    	data[1]=LPC_RTC->MONTH;
;;;282    	data[2]=LPC_RTC->DOM;
;;;283    	data[3]=0;
;;;284    	lc640_write_long_ptr(lc640_adr+8,data);
;;;285    
;;;286    	data[0]=LPC_RTC->HOUR;
;;;287    	data[1]=LPC_RTC->MIN;
;;;288    	data[2]=LPC_RTC->SEC;
;;;289    	data[3]=0;
;;;290    	lc640_write_long_ptr(lc640_adr+12,data);
;;;291    	
;;;292    	data[0]='A';
;;;293    	data[1]='A';
;;;294    	data[2]='A';
;;;295    	data[3]='A';
;;;296    	lc640_write_long_ptr(lc640_adr+16,data);
;;;297    	
;;;298    	data[0]='A';
;;;299    	data[1]='A';
;;;300    	data[2]='A';
;;;301    	data[3]='A';
;;;302    	lc640_write_long_ptr(lc640_adr+20,data);
;;;303    	
;;;304    	data[0]='A';
;;;305    	data[1]='A';
;;;306    	data[2]='A';
;;;307    	data[3]='A';
;;;308    	lc640_write_long_ptr(lc640_adr+24,data);
;;;309    	
;;;310    	data[0]='A';
;;;311    	data[1]='A';
;;;312    	data[2]='A';
;;;313    	data[3]='A';
;;;314    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;315    	
;;;316    /*	memo_out0[0]=0x55;
;;;317         memo_out0[1]=0x00+2;
;;;318         memo_out0[2]=1;
;;;319         memo_out0[3]=0x0b;
;;;320         memo_out0[4]=0x55;
;;;321         memo_out0[5]=0x55; 
;;;322         	
;;;323         memo_out0[6]=crc_87(memo_out0,6);
;;;324    	memo_out0[7]=crc_95(memo_out0,6);
;;;325         usart_out_adr0(memo_out0,8); 
;;;326    	*/
;;;327    	snmp_trap_send("Main power alarm, voltage reduced",2,1,0);
;;;328    	}
;;;329    
;;;330    else if(in==2)
;;;331    	{
;;;332    	net_av|=2;	  //o_10
;;;333    
;;;334    	//beep_init(0x01L,'O');
;;;335    	//a.av.bAN=1;
;;;336    
;;;337    
;;;338    	//beep_init(0x33333333,'A');
;;;339    	 
;;;340    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;341    	event_ptr++;	
;;;342    	if(event_ptr>63)event_ptr=0;	
;;;343    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;344    	
;;;345         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;346    	if(event_cnt!=63)event_cnt=event_ptr;
;;;347    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;348    	
;;;349    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;350    	
;;;351    	data[0]='P';
;;;352    	data[1]=0;
;;;353    	data[2]='B';
000294  f04f0942          MOV      r9,#0x42
000298  2c02              CMP      r4,#2                 ;330
00029a  d07d              BEQ      |L1.920|
;;;354    	data[3]=0;
;;;355    	lc640_write_long_ptr(lc640_adr,data);
;;;356    
;;;357    	data[0]=0;//*((char*)&Unet_store);
;;;358    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;359    	data[2]=0;
;;;360    	data[3]=0;
;;;361    	lc640_write_long_ptr(lc640_adr+4,data);
;;;362    
;;;363    	data[0]=LPC_RTC->YEAR;
;;;364    	data[1]=LPC_RTC->MONTH;
;;;365    	data[2]=LPC_RTC->DOM;
;;;366    	data[3]=0;
;;;367    	lc640_write_long_ptr(lc640_adr+8,data);
;;;368    
;;;369    	data[0]=LPC_RTC->HOUR;
;;;370    	data[1]=LPC_RTC->MIN;
;;;371    	data[2]=LPC_RTC->SEC;
;;;372    	data[3]=0;
;;;373    	lc640_write_long_ptr(lc640_adr+12,data);
;;;374    	
;;;375    	data[0]='A';
;;;376    	data[1]='A';
;;;377    	data[2]='A';
;;;378    	data[3]='A';
;;;379    	lc640_write_long_ptr(lc640_adr+16,data);
;;;380    	
;;;381    	data[0]='A';
;;;382    	data[1]='A';
;;;383    	data[2]='A';
;;;384    	data[3]='A';
;;;385    	lc640_write_long_ptr(lc640_adr+20,data);
;;;386    	
;;;387    	data[0]='A';
;;;388    	data[1]='A';
;;;389    	data[2]='A';
;;;390    	data[3]='A';
;;;391    	lc640_write_long_ptr(lc640_adr+24,data);
;;;392    	
;;;393    	data[0]='A';
;;;394    	data[1]='A';
;;;395    	data[2]='A';
;;;396    	data[3]='A';
;;;397    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;398    	
;;;399    	snmp_trap_send("Main power alarm, voltage increased",2,2,0);
;;;400    	}
;;;401    //o_10_s
;;;402    else if(in==0 || in==4)	
00029c  2c00              CMP      r4,#0
                  |L1.670|
00029e  d07c              BEQ      |L1.922|
0002a0  2c04              CMP      r4,#4
0002a2  d0fc              BEQ      |L1.670|
0002a4  e1fe              B        |L1.1700|
                  |L1.678|
0002a6  f0400001          ORR      r0,r0,#1              ;248
0002aa  7008              STRB     r0,[r1,#0]            ;248
0002ac  4860              LDR      r0,|L1.1072|
0002ae  f44f6196          MOV      r1,#0x4b0             ;249
0002b2  8001              STRH     r1,[r0,#0]            ;249
0002b4  4614              MOV      r4,r2                 ;257
0002b6  4620              MOV      r0,r4                 ;257
0002b8  f7fffffe          BL       lc640_read_int
0002bc  f1000001          ADD      r0,r0,#1              ;258
0002c0  4681              MOV      r9,r0                 ;258
0002c2  f1b90f3f          CMP      r9,#0x3f              ;259
0002c6  d901              BLS      |L1.716|
0002c8  f04f0900          MOV      r9,#0                 ;259
                  |L1.716|
0002cc  fa0ff189          SXTH     r1,r9                 ;260
0002d0  4620              MOV      r0,r4                 ;260
0002d2  f7fffffe          BL       lc640_write_int
0002d6  4650              MOV      r0,r10                ;262
0002d8  f7fffffe          BL       lc640_read_int
0002dc  283f              CMP      r0,#0x3f              ;263
0002de  d000              BEQ      |L1.738|
0002e0  4648              MOV      r0,r9                 ;263
                  |L1.738|
0002e2  b201              SXTH     r1,r0                 ;264
0002e4  4650              MOV      r0,r10                ;264
0002e6  f7fffffe          BL       lc640_write_int
0002ea  4620              MOV      r0,r4                 ;266
0002ec  f7fffffe          BL       lc640_read_int
0002f0  eb071440          ADD      r4,r7,r0,LSL #5       ;266
0002f4  f88db000          STRB     r11,[sp,#0]           ;268
0002f8  f88d6001          STRB     r6,[sp,#1]            ;269
0002fc  f88d8002          STRB     r8,[sp,#2]            ;270
000300  f88d6003          STRB     r6,[sp,#3]            ;271
000304  4669              MOV      r1,sp                 ;272
000306  4620              MOV      r0,r4                 ;272
000308  f7fffffe          BL       lc640_write_long_ptr
00030c  9600              STR      r6,[sp,#0]            ;277
00030e  4669              MOV      r1,sp                 ;278
000310  1d20              ADDS     r0,r4,#4              ;278
000312  f7fffffe          BL       lc640_write_long_ptr
000316  f1050520          ADD      r5,r5,#0x20           ;280
00031a  8ba8              LDRH     r0,[r5,#0x1c]         ;280
00031c  f88d0000          STRB     r0,[sp,#0]            ;280
000320  7e28              LDRB     r0,[r5,#0x18]         ;281
000322  f88d0001          STRB     r0,[sp,#1]            ;281
000326  7b28              LDRB     r0,[r5,#0xc]          ;282
000328  f88d0002          STRB     r0,[sp,#2]            ;282
00032c  f88d6003          STRB     r6,[sp,#3]            ;283
000330  4669              MOV      r1,sp                 ;284
000332  f1040008          ADD      r0,r4,#8              ;284
000336  f7fffffe          BL       lc640_write_long_ptr
00033a  7a28              LDRB     r0,[r5,#8]            ;286
00033c  f88d0000          STRB     r0,[sp,#0]            ;286
000340  7928              LDRB     r0,[r5,#4]            ;287
000342  f88d0001          STRB     r0,[sp,#1]            ;287
000346  7828              LDRB     r0,[r5,#0]            ;288
000348  f88d0002          STRB     r0,[sp,#2]            ;288
00034c  f88d6003          STRB     r6,[sp,#3]            ;289
000350  4669              MOV      r1,sp                 ;290
000352  f104000c          ADD      r0,r4,#0xc            ;290
000356  f7fffffe          BL       lc640_write_long_ptr
00035a  f88d8000          STRB     r8,[sp,#0]            ;292
00035e  f88d8001          STRB     r8,[sp,#1]            ;293
000362  f88d8002          STRB     r8,[sp,#2]            ;294
000366  f88d8003          STRB     r8,[sp,#3]            ;295
00036a  4669              MOV      r1,sp                 ;296
00036c  f1040010          ADD      r0,r4,#0x10           ;296
000370  f7fffffe          BL       lc640_write_long_ptr
000374  f88d8000          STRB     r8,[sp,#0]            ;298
000378  f88d8001          STRB     r8,[sp,#1]            ;299
00037c  f88d8002          STRB     r8,[sp,#2]            ;300
000380  f88d8003          STRB     r8,[sp,#3]            ;301
000384  4669              MOV      r1,sp                 ;302
000386  f1040014          ADD      r0,r4,#0x14           ;302
00038a  f7fffffe          BL       lc640_write_long_ptr
00038e  f88d8000          STRB     r8,[sp,#0]            ;304
000392  f88d8001          STRB     r8,[sp,#1]            ;305
000396  e001              B        |L1.924|
                  |L1.920|
000398  e01d              B        |L1.982|
                  |L1.922|
00039a  e0da              B        |L1.1362|
                  |L1.924|
00039c  f88d8002          STRB     r8,[sp,#2]            ;306
0003a0  f88d8003          STRB     r8,[sp,#3]            ;307
0003a4  4669              MOV      r1,sp                 ;308
0003a6  f1040018          ADD      r0,r4,#0x18           ;308
0003aa  f7fffffe          BL       lc640_write_long_ptr
0003ae  f88d8000          STRB     r8,[sp,#0]            ;310
0003b2  f88d8001          STRB     r8,[sp,#1]            ;311
0003b6  f88d8002          STRB     r8,[sp,#2]            ;312
0003ba  f88d8003          STRB     r8,[sp,#3]            ;313
0003be  4669              MOV      r1,sp                 ;314
0003c0  f104001c          ADD      r0,r4,#0x1c           ;314
0003c4  f7fffffe          BL       lc640_write_long_ptr
0003c8  2300              MOVS     r3,#0                 ;327
0003ca  2201              MOVS     r2,#1                 ;327
0003cc  2102              MOVS     r1,#2                 ;327
0003ce  a019              ADR      r0,|L1.1076|
0003d0  f7fffffe          BL       snmp_trap_send
0003d4  e166              B        |L1.1700|
                  |L1.982|
0003d6  f0400002          ORR      r0,r0,#2              ;332
0003da  7008              STRB     r0,[r1,#0]            ;332
0003dc  f44f6060          MOV      r0,#0xe00             ;340
0003e0  f7fffffe          BL       lc640_read_int
0003e4  f1000001          ADD      r0,r0,#1              ;341
0003e8  4604              MOV      r4,r0                 ;341
0003ea  2c3f              CMP      r4,#0x3f              ;342
0003ec  d901              BLS      |L1.1010|
0003ee  f04f0400          MOV      r4,#0                 ;342
                  |L1.1010|
0003f2  b221              SXTH     r1,r4                 ;343
0003f4  f44f6060          MOV      r0,#0xe00             ;343
0003f8  f7fffffe          BL       lc640_write_int
0003fc  4650              MOV      r0,r10                ;345
0003fe  e02b              B        |L1.1112|
                  |L1.1024|
                          DCD      net_av
                  |L1.1028|
                          DCD      ||.data||
                  |L1.1032|
                          DCD      bps
                  |L1.1036|
                          DCD      sk_av_stat
                  |L1.1040|
                          DCD      SK_ZVUK_EN
                  |L1.1044|
                          DCD      AV_OFF_AVT
                  |L1.1048|
                          DCD      0xeffffffe
                  |L1.1052|
                          DCD      status_izm_r
                  |L1.1056|
                          DCD      sk_alarm
                  |L1.1060|
                          DCD      0x40024020
                  |L1.1064|
                          DCD      0x400fc000
                  |L1.1068|
                          DCD      0x40024000
                  |L1.1072|
                          DCD      net_av_2min_timer
                  |L1.1076|
000434  4d61696e          DCB      "Main power alarm, voltage reduced",0
000438  20706f77
00043c  65722061
000440  6c61726d
000444  2c20766f
000448  6c746167
00044c  65207265
000450  64756365
000454  6400    
000456  00                DCB      0
000457  00                DCB      0
                  |L1.1112|
000458  f7fffffe          BL       lc640_read_int
00045c  283f              CMP      r0,#0x3f              ;346
00045e  d000              BEQ      |L1.1122|
000460  4620              MOV      r0,r4                 ;346
                  |L1.1122|
000462  b201              SXTH     r1,r0                 ;347
000464  4650              MOV      r0,r10                ;347
000466  f7fffffe          BL       lc640_write_int
00046a  f44f6060          MOV      r0,#0xe00             ;349
00046e  f7fffffe          BL       lc640_read_int
000472  eb071440          ADD      r4,r7,r0,LSL #5       ;349
000476  f88db000          STRB     r11,[sp,#0]           ;351
00047a  f88d6001          STRB     r6,[sp,#1]            ;352
00047e  f88d9002          STRB     r9,[sp,#2]            ;353
000482  f88d6003          STRB     r6,[sp,#3]            ;354
000486  4669              MOV      r1,sp                 ;355
000488  4620              MOV      r0,r4                 ;355
00048a  f7fffffe          BL       lc640_write_long_ptr
00048e  9600              STR      r6,[sp,#0]            ;360
000490  4669              MOV      r1,sp                 ;361
000492  1d20              ADDS     r0,r4,#4              ;361
000494  f7fffffe          BL       lc640_write_long_ptr
000498  f1050520          ADD      r5,r5,#0x20           ;363
00049c  8ba8              LDRH     r0,[r5,#0x1c]         ;363
00049e  f88d0000          STRB     r0,[sp,#0]            ;363
0004a2  7e28              LDRB     r0,[r5,#0x18]         ;364
0004a4  f88d0001          STRB     r0,[sp,#1]            ;364
0004a8  7b28              LDRB     r0,[r5,#0xc]          ;365
0004aa  f88d0002          STRB     r0,[sp,#2]            ;365
0004ae  f88d6003          STRB     r6,[sp,#3]            ;366
0004b2  4669              MOV      r1,sp                 ;367
0004b4  f1040008          ADD      r0,r4,#8              ;367
0004b8  f7fffffe          BL       lc640_write_long_ptr
0004bc  7a28              LDRB     r0,[r5,#8]            ;369
0004be  f88d0000          STRB     r0,[sp,#0]            ;369
0004c2  7928              LDRB     r0,[r5,#4]            ;370
0004c4  f88d0001          STRB     r0,[sp,#1]            ;370
0004c8  7828              LDRB     r0,[r5,#0]            ;371
0004ca  f88d0002          STRB     r0,[sp,#2]            ;371
0004ce  f88d6003          STRB     r6,[sp,#3]            ;372
0004d2  4669              MOV      r1,sp                 ;373
0004d4  f104000c          ADD      r0,r4,#0xc            ;373
0004d8  f7fffffe          BL       lc640_write_long_ptr
0004dc  f88d8000          STRB     r8,[sp,#0]            ;375
0004e0  f88d8001          STRB     r8,[sp,#1]            ;376
0004e4  f88d8002          STRB     r8,[sp,#2]            ;377
0004e8  f88d8003          STRB     r8,[sp,#3]            ;378
0004ec  4669              MOV      r1,sp                 ;379
0004ee  f1040010          ADD      r0,r4,#0x10           ;379
0004f2  f7fffffe          BL       lc640_write_long_ptr
0004f6  f88d8000          STRB     r8,[sp,#0]            ;381
0004fa  f88d8001          STRB     r8,[sp,#1]            ;382
0004fe  f88d8002          STRB     r8,[sp,#2]            ;383
000502  f88d8003          STRB     r8,[sp,#3]            ;384
000506  4669              MOV      r1,sp                 ;385
000508  f1040014          ADD      r0,r4,#0x14           ;385
00050c  f7fffffe          BL       lc640_write_long_ptr
000510  f88d8000          STRB     r8,[sp,#0]            ;387
000514  f88d8001          STRB     r8,[sp,#1]            ;388
000518  f88d8002          STRB     r8,[sp,#2]            ;389
00051c  f88d8003          STRB     r8,[sp,#3]            ;390
000520  4669              MOV      r1,sp                 ;391
000522  f1040018          ADD      r0,r4,#0x18           ;391
000526  f7fffffe          BL       lc640_write_long_ptr
00052a  f88d8000          STRB     r8,[sp,#0]            ;393
00052e  f88d8001          STRB     r8,[sp,#1]            ;394
000532  f88d8002          STRB     r8,[sp,#2]            ;395
000536  f88d8003          STRB     r8,[sp,#3]            ;396
00053a  4669              MOV      r1,sp                 ;397
00053c  f104001c          ADD      r0,r4,#0x1c           ;397
000540  f7fffffe          BL       lc640_write_long_ptr
000544  2202              MOVS     r2,#2                 ;399
000546  2300              MOVS     r3,#0                 ;399
000548  4611              MOV      r1,r2                 ;399
00054a  a0fe              ADR      r0,|L1.2372|
00054c  f7fffffe          BL       snmp_trap_send
000550  e0a8              B        |L1.1700|
                  |L1.1362|
;;;403    	{
;;;404    //	if( (in==0 && (net_av&2)==0) || (in==4 && (net_av&1)==0) )  {
;;;405    		if(in==0) net_av&=~1;
000552  b914              CBNZ     r4,|L1.1370|
000554  f0200001          BIC      r0,r0,#1
000558  7008              STRB     r0,[r1,#0]
                  |L1.1370|
;;;406    		if(in==4) net_av&=~2;	 
00055a  2c04              CMP      r4,#4
00055c  d103              BNE      |L1.1382|
00055e  7808              LDRB     r0,[r1,#0]  ; net_av
000560  f0200002          BIC      r0,r0,#2
000564  7008              STRB     r0,[r1,#0]
                  |L1.1382|
;;;407    		if(net_av==0) if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
000566  7809              LDRB     r1,[r1,#0]  ; net_av
000568  48ff              LDR      r0,|L1.2408|
00056a  b931              CBNZ     r1,|L1.1402|
00056c  49ff              LDR      r1,|L1.2412|
00056e  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
000570  b119              CBZ      r1,|L1.1402|
000572  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
000574  f0210101          BIC      r1,r1,#1
000578  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.1402|
;;;408    
;;;409    	SET_REG(avar_stat,0,0,1);
00057a  6801              LDR      r1,[r0,#0]  ; avar_stat
00057c  f0210101          BIC      r1,r1,#1
000580  6001              STR      r1,[r0,#0]  ; avar_stat
;;;410    	
;;;411    	
;;;412    //}
;;;413    //o_10_e
;;;414    
;;;415         event_ptr=lc640_read_int(PTR_EVENT_LOG);
000582  4610              MOV      r0,r2
000584  f7fffffe          BL       lc640_read_int
000588  4683              MOV      r11,r0
;;;416    	event_ptr_find=event_ptr;
00058a  46d8              MOV      r8,r11
                  |L1.1420|
;;;417    avar_unet_hndl_lbl1:
;;;418    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
00058c  eb071a48          ADD      r10,r7,r8,LSL #5
;;;419    
;;;420         lc640_read_long_ptr(lc640_adr,data);
000590  4669              MOV      r1,sp
000592  4650              MOV      r0,r10
000594  f7fffffe          BL       lc640_read_long_ptr
;;;421         
;;;422         if( !( (data[0]=='P')&&(data[1]==0)&&( (in==0 && data[2]=='A' )||(in==4 && data[2]=='B') ) ) )	//o_10
000598  f89d0000          LDRB     r0,[sp,#0]
00059c  2850              CMP      r0,#0x50
00059e  d10f              BNE      |L1.1472|
0005a0  f89d0001          LDRB     r0,[sp,#1]
0005a4  b960              CBNZ     r0,|L1.1472|
0005a6  b114              CBZ      r4,|L1.1454|
0005a8  2c04              CMP      r4,#4
0005aa  d109              BNE      |L1.1472|
0005ac  e004              B        |L1.1464|
                  |L1.1454|
0005ae  f89d0002          LDRB     r0,[sp,#2]
0005b2  2841              CMP      r0,#0x41
0005b4  d104              BNE      |L1.1472|
0005b6  e00e              B        |L1.1494|
                  |L1.1464|
0005b8  f89d0002          LDRB     r0,[sp,#2]
0005bc  2842              CMP      r0,#0x42
0005be  d00a              BEQ      |L1.1494|
                  |L1.1472|
;;;423         	{        
;;;424         	if(event_ptr_find)event_ptr_find--;
0005c0  f1b80f00          CMP      r8,#0
0005c4  d002              BEQ      |L1.1484|
0005c6  f1a80801          SUB      r8,r8,#1
0005ca  e001              B        |L1.1488|
                  |L1.1484|
;;;425         	else event_ptr_find=63;
0005cc  f04f083f          MOV      r8,#0x3f
                  |L1.1488|
;;;426         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0005d0  45d8              CMP      r8,r11
0005d2  d1db              BNE      |L1.1420|
0005d4  e066              B        |L1.1700|
                  |L1.1494|
;;;427         	else goto avar_unet_hndl_lbl1;
;;;428         	}
;;;429         else 
;;;430         	{
;;;431         	lc640_read_long_ptr(lc640_adr+16,data);
0005d6  4669              MOV      r1,sp
0005d8  f10a0010          ADD      r0,r10,#0x10
0005dc  f7fffffe          BL       lc640_read_long_ptr
;;;432         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0005e0  f89d0000          LDRB     r0,[sp,#0]
0005e4  2841              CMP      r0,#0x41
0005e6  d10b              BNE      |L1.1536|
0005e8  f89d0001          LDRB     r0,[sp,#1]
0005ec  2841              CMP      r0,#0x41
0005ee  d107              BNE      |L1.1536|
0005f0  f89d0002          LDRB     r0,[sp,#2]
0005f4  2841              CMP      r0,#0x41
0005f6  d103              BNE      |L1.1536|
0005f8  f89d0003          LDRB     r0,[sp,#3]
0005fc  2841              CMP      r0,#0x41
0005fe  d00a              BEQ      |L1.1558|
                  |L1.1536|
;;;433         		{        
;;;434         		if(event_ptr_find)event_ptr_find--;
000600  f1b80f00          CMP      r8,#0
000604  d002              BEQ      |L1.1548|
000606  f1a80801          SUB      r8,r8,#1
00060a  e001              B        |L1.1552|
                  |L1.1548|
;;;435             		else event_ptr_find=63;
00060c  f04f083f          MOV      r8,#0x3f
                  |L1.1552|
;;;436             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000610  45d8              CMP      r8,r11
000612  d1bb              BNE      |L1.1420|
000614  e046              B        |L1.1700|
                  |L1.1558|
;;;437         		else goto avar_unet_hndl_lbl1;
;;;438         		}
;;;439    
;;;440         	}	
;;;441    	
;;;442    	data[0]=LPC_RTC->YEAR;
000616  f1050520          ADD      r5,r5,#0x20
00061a  8ba8              LDRH     r0,[r5,#0x1c]
00061c  f88d0000          STRB     r0,[sp,#0]
;;;443    	data[1]=LPC_RTC->MONTH;
000620  7e28              LDRB     r0,[r5,#0x18]
000622  f88d0001          STRB     r0,[sp,#1]
;;;444    	data[2]=LPC_RTC->DOM;
000626  7b28              LDRB     r0,[r5,#0xc]
000628  f88d0002          STRB     r0,[sp,#2]
;;;445    	data[3]=0;
00062c  f88d6003          STRB     r6,[sp,#3]
;;;446    	lc640_write_long_ptr(lc640_adr+16,data);
000630  4669              MOV      r1,sp
000632  f10a0010          ADD      r0,r10,#0x10
000636  f7fffffe          BL       lc640_write_long_ptr
;;;447    
;;;448    	data[0]=LPC_RTC->HOUR;
00063a  7a28              LDRB     r0,[r5,#8]
00063c  f88d0000          STRB     r0,[sp,#0]
;;;449    	data[1]=LPC_RTC->MIN;
000640  7928              LDRB     r0,[r5,#4]
000642  f88d0001          STRB     r0,[sp,#1]
;;;450    	data[2]=LPC_RTC->SEC;
000646  7828              LDRB     r0,[r5,#0]
000648  f88d0002          STRB     r0,[sp,#2]
;;;451    	data[3]=0;
00064c  f88d6003          STRB     r6,[sp,#3]
;;;452    	lc640_write_long_ptr(lc640_adr+20,data); 
000650  4669              MOV      r1,sp
000652  f10a0014          ADD      r0,r10,#0x14
000656  f7fffffe          BL       lc640_write_long_ptr
;;;453    	
;;;454    	//o_10_s
;;;455    	if(in==4) {
00065a  2c04              CMP      r4,#4
00065c  d025              BEQ      |L1.1706|
;;;456    	   	data[0]=*((char*)(&net_Ustore_max));
;;;457    		data[1]=*(((char*)(&net_Ustore_max))+1);
;;;458    	}else{
;;;459    		data[0]=*((char*)(&net_Ustore));
00065e  48c4              LDR      r0,|L1.2416|
000660  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000662  f88d1000          STRB     r1,[sp,#0]
;;;460    		data[1]=*(((char*)(&net_Ustore))+1);
000666  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000668  f88d0001          STRB     r0,[sp,#1]
                  |L1.1644|
;;;461    	}
;;;462    	//o_10_e
;;;463    	data[2]='B';
00066c  f88d9002          STRB     r9,[sp,#2]
;;;464    	data[3]='B';
000670  f88d9003          STRB     r9,[sp,#3]
;;;465    	lc640_write_long_ptr(lc640_adr+24,data);
000674  4669              MOV      r1,sp
000676  f10a0018          ADD      r0,r10,#0x18
00067a  f7fffffe          BL       lc640_write_long_ptr
;;;466    	
;;;467    	data[0]='B';
00067e  f88d9000          STRB     r9,[sp,#0]
;;;468    	data[1]='B';
000682  f88d9001          STRB     r9,[sp,#1]
;;;469    	data[2]='B';
000686  f88d9002          STRB     r9,[sp,#2]
;;;470    	data[3]='B';
00068a  f88d9003          STRB     r9,[sp,#3]
;;;471    	lc640_write_long_ptr(lc640_adr+28,data);	
00068e  4669              MOV      r1,sp
000690  f10a001c          ADD      r0,r10,#0x1c
000694  f7fffffe          BL       lc640_write_long_ptr
;;;472    	
;;;473    /*	memo_out0[0]=0x55;
;;;474         memo_out0[1]=0x00+2;
;;;475         memo_out0[2]=1;
;;;476         memo_out0[3]=0x0b;
;;;477         memo_out0[4]=0xaa;
;;;478         memo_out0[5]=0xaa; 
;;;479         	
;;;480         memo_out0[6]=crc_87(memo_out0,6);
;;;481    	memo_out0[7]=crc_95(memo_out0,6);
;;;482         usart_out_adr0(memo_out0,8); */
;;;483         snmp_trap_send("Main power alarm  clear",2,1,1);	
000698  2301              MOVS     r3,#1
00069a  461a              MOV      r2,r3
00069c  2102              MOVS     r1,#2
00069e  a0b5              ADR      r0,|L1.2420|
0006a0  f7fffffe          BL       snmp_trap_send
                  |L1.1700|
;;;484    	}
;;;485    avar_unet_hndl_end:
;;;486    	__nop();		
0006a4  bf00              NOP      
                  |L1.1702|
;;;487    }
0006a6  e8bd8ff8          POP      {r3-r11,pc}
                  |L1.1706|
0006aa  48b8              LDR      r0,|L1.2444|
0006ac  7801              LDRB     r1,[r0,#0]            ;456  ; net_Ustore_max
0006ae  f88d1000          STRB     r1,[sp,#0]            ;456
0006b2  7840              LDRB     r0,[r0,#1]            ;457  ; net_Ustore_max
0006b4  f88d0001          STRB     r0,[sp,#1]            ;457
0006b8  e7d8              B        |L1.1644|
;;;488    
                          ENDP

                  avar_uout_hndl PROC
;;;490    //-----------------------------------------------
;;;491    void avar_uout_hndl(char in)
0006ba  e92d4ff8          PUSH     {r3-r11,lr}
;;;492    {
;;;493    
;;;494    char data[4];
;;;495    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;496    char avar_data=0;
;;;497    
;;;498    if(in==1)
;;;499    	{
;;;500    	//net_av=1;
;;;501    
;;;502    	//beep_init(0x01L,'O');
;;;503    	//a.av.bAN=1;
;;;504    
;;;505    
;;;506    	//beep_init(0x33333333,'A');
;;;507    
;;;508    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;509    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;510    	
;;;511    	avar_data=uout_av;
;;;512    		 
;;;513    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;514    	event_ptr++;	
;;;515    	if(event_ptr>63)event_ptr=0;	
;;;516    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;517    	
;;;518        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;519    	if(event_cnt!=63)event_cnt=event_ptr;
;;;520    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;521    	
;;;522    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;523    	
;;;524    	data[0]='Q';
;;;525    	data[1]=0;
;;;526    	data[2]='A';
;;;527    	data[3]=avar_data;
;;;528    	lc640_write_long_ptr(lc640_adr,data);
;;;529    
;;;530    	 //load_U=4321;
;;;531    
;;;532    	data[0]=*((char*)&load_U);
;;;533    	data[1]=*(((char*)&load_U)+1);
;;;534    	data[2]=0;
;;;535    	data[3]=0;
;;;536    	lc640_write_long_ptr(lc640_adr+4,data);
;;;537    
;;;538    	data[0]=LPC_RTC->YEAR;
0006be  4fb4              LDR      r7,|L1.2448|
0006c0  49b4              LDR      r1,|L1.2452|
0006c2  f44f6560          MOV      r5,#0xe00             ;513
0006c6  f04f0800          MOV      r8,#0                 ;496
0006ca  f44f6980          MOV      r9,#0x400             ;522
0006ce  2801              CMP      r0,#1                 ;498
0006d0  d002              BEQ      |L1.1752|
;;;539    	data[1]=LPC_RTC->MONTH;
;;;540    	data[2]=LPC_RTC->DOM;
;;;541    	data[3]=0;
;;;542    	lc640_write_long_ptr(lc640_adr+8,data);
;;;543    
;;;544    	data[0]=LPC_RTC->HOUR;
;;;545    	data[1]=LPC_RTC->MIN;
;;;546    	data[2]=LPC_RTC->SEC;
;;;547    	data[3]=0;
;;;548    	lc640_write_long_ptr(lc640_adr+12,data);
;;;549    	
;;;550    	data[0]='A';
;;;551    	data[1]='A';
;;;552    	data[2]='A';
;;;553    	data[3]='A';
;;;554    	lc640_write_long_ptr(lc640_adr+16,data);
;;;555    	
;;;556    	data[0]='A';
;;;557    	data[1]='A';
;;;558    	data[2]='A';
;;;559    	data[3]='A';
;;;560    	lc640_write_long_ptr(lc640_adr+20,data);
;;;561    	
;;;562    	data[0]='A';
;;;563    	data[1]='A';
;;;564    	data[2]='A';
;;;565    	data[3]='A';
;;;566    	lc640_write_long_ptr(lc640_adr+24,data);
;;;567    	
;;;568    	data[0]='A';
;;;569    	data[1]='A';
;;;570    	data[2]='A';
;;;571    	data[3]='A';
;;;572    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;573    	
;;;574    /*	memo_out0[0]=0x55;
;;;575         memo_out0[1]=0x00+2;
;;;576         memo_out0[2]=1;
;;;577         memo_out0[3]=0x0b;
;;;578         memo_out0[4]=0x55;
;;;579         memo_out0[5]=0x55; 
;;;580         	
;;;581         memo_out0[6]=crc_87(memo_out0,6);
;;;582    	memo_out0[7]=crc_95(memo_out0,6);
;;;583         usart_out_adr0(memo_out0,8); 
;;;584    	*/
;;;585    	//snmp_trap_send("Main power is off",2,1,0);
;;;586    	}
;;;587    
;;;588    else if(in==0)
0006d2  2800              CMP      r0,#0
0006d4  d07d              BEQ      |L1.2002|
0006d6  e132              B        |L1.2366|
                  |L1.1752|
0006d8  f8dfa2bc          LDR      r10,|L1.2456|
0006dc  4aaf              LDR      r2,|L1.2460|
0006de  f9ba0000          LDRSH    r0,[r10,#0]           ;508  ; load_U
0006e2  f9b22000          LDRSH    r2,[r2,#0]            ;508  ; U_OUT_KONTR_MAX
0006e6  4290              CMP      r0,r2                 ;508
0006e8  dd02              BLE      |L1.1776|
0006ea  f04f0201          MOV      r2,#1                 ;508
0006ee  700a              STRB     r2,[r1,#0]            ;508
                  |L1.1776|
0006f0  4aab              LDR      r2,|L1.2464|
0006f2  f9b22000          LDRSH    r2,[r2,#0]            ;509  ; U_OUT_KONTR_MIN
0006f6  4290              CMP      r0,r2                 ;509
0006f8  da02              BGE      |L1.1792|
0006fa  f04f0002          MOV      r0,#2                 ;509
0006fe  7008              STRB     r0,[r1,#0]            ;509
                  |L1.1792|
000700  780e              LDRB     r6,[r1,#0]            ;511  ; uout_av
000702  4628              MOV      r0,r5                 ;513
000704  f7fffffe          BL       lc640_read_int
000708  f1000001          ADD      r0,r0,#1              ;514
00070c  4604              MOV      r4,r0                 ;514
00070e  2c3f              CMP      r4,#0x3f              ;515
000710  d901              BLS      |L1.1814|
000712  f04f0400          MOV      r4,#0                 ;515
                  |L1.1814|
000716  b221              SXTH     r1,r4                 ;516
000718  4628              MOV      r0,r5                 ;516
00071a  f7fffffe          BL       lc640_write_int
00071e  f6406b02          MOV      r11,#0xe02            ;518
000722  4658              MOV      r0,r11                ;518
000724  f7fffffe          BL       lc640_read_int
000728  283f              CMP      r0,#0x3f              ;519
00072a  d000              BEQ      |L1.1838|
00072c  4620              MOV      r0,r4                 ;519
                  |L1.1838|
00072e  b201              SXTH     r1,r0                 ;520
000730  4658              MOV      r0,r11                ;520
000732  f7fffffe          BL       lc640_write_int
000736  4628              MOV      r0,r5                 ;522
000738  f7fffffe          BL       lc640_read_int
00073c  eb091540          ADD      r5,r9,r0,LSL #5       ;522
000740  f04f0051          MOV      r0,#0x51              ;524
000744  f88d0000          STRB     r0,[sp,#0]            ;524
000748  f88d8001          STRB     r8,[sp,#1]            ;525
00074c  f04f0441          MOV      r4,#0x41              ;526
000750  f88d4002          STRB     r4,[sp,#2]            ;526
000754  f88d6003          STRB     r6,[sp,#3]            ;527
000758  4669              MOV      r1,sp                 ;528
00075a  4628              MOV      r0,r5                 ;528
00075c  f7fffffe          BL       lc640_write_long_ptr
000760  f89a0000          LDRB     r0,[r10,#0]           ;532  ; load_U
000764  f88d0000          STRB     r0,[sp,#0]            ;532
000768  f89a0001          LDRB     r0,[r10,#1]           ;533  ; load_U
00076c  f88d0001          STRB     r0,[sp,#1]            ;533
000770  f88d8002          STRB     r8,[sp,#2]            ;534
000774  f88d8003          STRB     r8,[sp,#3]            ;535
000778  4669              MOV      r1,sp                 ;536
00077a  1d28              ADDS     r0,r5,#4              ;536
00077c  f7fffffe          BL       lc640_write_long_ptr
000780  f1070720          ADD      r7,r7,#0x20           ;538
000784  8bb8              LDRH     r0,[r7,#0x1c]         ;538
000786  f88d0000          STRB     r0,[sp,#0]            ;538
00078a  7e38              LDRB     r0,[r7,#0x18]         ;539
00078c  f88d0001          STRB     r0,[sp,#1]            ;539
000790  7b38              LDRB     r0,[r7,#0xc]          ;540
000792  f88d0002          STRB     r0,[sp,#2]            ;540
000796  f88d8003          STRB     r8,[sp,#3]            ;541
00079a  4669              MOV      r1,sp                 ;542
00079c  f1050008          ADD      r0,r5,#8              ;542
0007a0  f7fffffe          BL       lc640_write_long_ptr
0007a4  7a38              LDRB     r0,[r7,#8]            ;544
0007a6  f88d0000          STRB     r0,[sp,#0]            ;544
0007aa  7938              LDRB     r0,[r7,#4]            ;545
0007ac  f88d0001          STRB     r0,[sp,#1]            ;545
0007b0  7838              LDRB     r0,[r7,#0]            ;546
0007b2  f88d0002          STRB     r0,[sp,#2]            ;546
0007b6  f88d8003          STRB     r8,[sp,#3]            ;547
0007ba  4669              MOV      r1,sp                 ;548
0007bc  f105000c          ADD      r0,r5,#0xc            ;548
0007c0  f7fffffe          BL       lc640_write_long_ptr
0007c4  f88d4000          STRB     r4,[sp,#0]            ;550
0007c8  f88d4001          STRB     r4,[sp,#1]            ;551
0007cc  f88d4002          STRB     r4,[sp,#2]            ;552
0007d0  e000              B        |L1.2004|
                  |L1.2002|
0007d2  e02e              B        |L1.2098|
                  |L1.2004|
0007d4  f88d4003          STRB     r4,[sp,#3]            ;553
0007d8  4669              MOV      r1,sp                 ;554
0007da  f1050010          ADD      r0,r5,#0x10           ;554
0007de  f7fffffe          BL       lc640_write_long_ptr
0007e2  f88d4000          STRB     r4,[sp,#0]            ;556
0007e6  f88d4001          STRB     r4,[sp,#1]            ;557
0007ea  f88d4002          STRB     r4,[sp,#2]            ;558
0007ee  f88d4003          STRB     r4,[sp,#3]            ;559
0007f2  4669              MOV      r1,sp                 ;560
0007f4  f1050014          ADD      r0,r5,#0x14           ;560
0007f8  f7fffffe          BL       lc640_write_long_ptr
0007fc  f88d4000          STRB     r4,[sp,#0]            ;562
000800  f88d4001          STRB     r4,[sp,#1]            ;563
000804  f88d4002          STRB     r4,[sp,#2]            ;564
000808  f88d4003          STRB     r4,[sp,#3]            ;565
00080c  4669              MOV      r1,sp                 ;566
00080e  f1050018          ADD      r0,r5,#0x18           ;566
000812  f7fffffe          BL       lc640_write_long_ptr
000816  f88d4000          STRB     r4,[sp,#0]            ;568
00081a  f88d4001          STRB     r4,[sp,#1]            ;569
00081e  f88d4002          STRB     r4,[sp,#2]            ;570
000822  f88d4003          STRB     r4,[sp,#3]            ;571
000826  4669              MOV      r1,sp                 ;572
000828  f105001c          ADD      r0,r5,#0x1c           ;572
00082c  f7fffffe          BL       lc640_write_long_ptr
000830  e085              B        |L1.2366|
                  |L1.2098|
;;;589    	{
;;;590    	uout_av=0;
000832  f8818000          STRB     r8,[r1,#0]
;;;591    
;;;592      /*
;;;593    	SET_REG(C2GSR,3,24,8);
;;;594    	C2MOD=0;
;;;595    	bOUT_FREE2=1;*/
;;;596    
;;;597    
;;;598    	//C2MOD=0;
;;;599    
;;;600    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;601    
;;;602         //beep_init(0x02L,'O');
;;;603    	//a_.av.bAN=0;
;;;604    //	SET_REG(avar_stat,0,0,1);
;;;605    
;;;606    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;607    	
;;;608    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;609    
;;;610        event_ptr=lc640_read_int(PTR_EVENT_LOG);
000836  4628              MOV      r0,r5
000838  f7fffffe          BL       lc640_read_int
00083c  4606              MOV      r6,r0
;;;611    	event_ptr_find=event_ptr;
00083e  4634              MOV      r4,r6
                  |L1.2112|
;;;612    avar_uout_hndl_lbl1:
;;;613    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000840  eb091544          ADD      r5,r9,r4,LSL #5
;;;614    
;;;615         lc640_read_long_ptr(lc640_adr,data);
000844  4669              MOV      r1,sp
000846  4628              MOV      r0,r5
000848  f7fffffe          BL       lc640_read_long_ptr
;;;616         
;;;617         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
00084c  f89d0000          LDRB     r0,[sp,#0]
000850  2851              CMP      r0,#0x51
000852  d106              BNE      |L1.2146|
000854  f89d0001          LDRB     r0,[sp,#1]
000858  b918              CBNZ     r0,|L1.2146|
00085a  f89d0002          LDRB     r0,[sp,#2]
00085e  2841              CMP      r0,#0x41
000860  d008              BEQ      |L1.2164|
                  |L1.2146|
;;;618         	{        
;;;619         	if(event_ptr_find)event_ptr_find--;
000862  b114              CBZ      r4,|L1.2154|
000864  f1a40401          SUB      r4,r4,#1
000868  e001              B        |L1.2158|
                  |L1.2154|
;;;620         	else event_ptr_find=63;
00086a  f04f043f          MOV      r4,#0x3f
                  |L1.2158|
;;;621         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
00086e  42b4              CMP      r4,r6
000870  d1e6              BNE      |L1.2112|
000872  e064              B        |L1.2366|
                  |L1.2164|
;;;622         	else goto avar_uout_hndl_lbl1;
;;;623         	}
;;;624         else 
;;;625         	{
;;;626         	lc640_read_long_ptr(lc640_adr+16,data);
000874  4669              MOV      r1,sp
000876  f1050010          ADD      r0,r5,#0x10
00087a  f7fffffe          BL       lc640_read_long_ptr
;;;627         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00087e  f89d0000          LDRB     r0,[sp,#0]
000882  2841              CMP      r0,#0x41
000884  d10b              BNE      |L1.2206|
000886  f89d0001          LDRB     r0,[sp,#1]
00088a  2841              CMP      r0,#0x41
00088c  d107              BNE      |L1.2206|
00088e  f89d0002          LDRB     r0,[sp,#2]
000892  2841              CMP      r0,#0x41
000894  d103              BNE      |L1.2206|
000896  f89d0003          LDRB     r0,[sp,#3]
00089a  2841              CMP      r0,#0x41
00089c  d008              BEQ      |L1.2224|
                  |L1.2206|
;;;628         		{        
;;;629         		if(event_ptr_find)event_ptr_find--;
00089e  b114              CBZ      r4,|L1.2214|
0008a0  f1a40401          SUB      r4,r4,#1
0008a4  e001              B        |L1.2218|
                  |L1.2214|
;;;630             		else event_ptr_find=63;
0008a6  f04f043f          MOV      r4,#0x3f
                  |L1.2218|
;;;631             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0008aa  42b4              CMP      r4,r6
0008ac  d1c8              BNE      |L1.2112|
0008ae  e046              B        |L1.2366|
                  |L1.2224|
;;;632         		else goto avar_uout_hndl_lbl1;
;;;633         		}
;;;634    
;;;635         	}	
;;;636    	
;;;637    	data[0]=LPC_RTC->YEAR;
0008b0  f1070720          ADD      r7,r7,#0x20
0008b4  8bb8              LDRH     r0,[r7,#0x1c]
0008b6  f88d0000          STRB     r0,[sp,#0]
;;;638    	data[1]=LPC_RTC->MONTH;
0008ba  7e38              LDRB     r0,[r7,#0x18]
0008bc  f88d0001          STRB     r0,[sp,#1]
;;;639    	data[2]=LPC_RTC->DOM;
0008c0  7b38              LDRB     r0,[r7,#0xc]
0008c2  f88d0002          STRB     r0,[sp,#2]
;;;640    	data[3]=0;
0008c6  f88d8003          STRB     r8,[sp,#3]
;;;641    	lc640_write_long_ptr(lc640_adr+16,data);
0008ca  4669              MOV      r1,sp
0008cc  f1050010          ADD      r0,r5,#0x10
0008d0  f7fffffe          BL       lc640_write_long_ptr
;;;642    
;;;643    	data[0]=LPC_RTC->HOUR;
0008d4  7a38              LDRB     r0,[r7,#8]
0008d6  f88d0000          STRB     r0,[sp,#0]
;;;644    	data[1]=LPC_RTC->MIN;
0008da  7938              LDRB     r0,[r7,#4]
0008dc  f88d0001          STRB     r0,[sp,#1]
;;;645    	data[2]=LPC_RTC->SEC;
0008e0  7838              LDRB     r0,[r7,#0]
0008e2  f88d0002          STRB     r0,[sp,#2]
;;;646    	data[3]=0;
0008e6  f88d8003          STRB     r8,[sp,#3]
;;;647    	lc640_write_long_ptr(lc640_adr+20,data); 
0008ea  4669              MOV      r1,sp
0008ec  f1050014          ADD      r0,r5,#0x14
0008f0  f7fffffe          BL       lc640_write_long_ptr
;;;648    	
;;;649    	data[0]=*((char*)(&net_Ustore));
0008f4  481e              LDR      r0,|L1.2416|
0008f6  7801              LDRB     r1,[r0,#0]  ; net_Ustore
0008f8  f88d1000          STRB     r1,[sp,#0]
;;;650    	data[1]=*(((char*)(&net_Ustore))+1);
0008fc  7840              LDRB     r0,[r0,#1]  ; net_Ustore
0008fe  f88d0001          STRB     r0,[sp,#1]
;;;651    	data[2]='B';
000902  f04f0442          MOV      r4,#0x42
000906  f88d4002          STRB     r4,[sp,#2]
;;;652    	data[3]='B';
00090a  f88d4003          STRB     r4,[sp,#3]
;;;653    	lc640_write_long_ptr(lc640_adr+24,data);
00090e  4669              MOV      r1,sp
000910  f1050018          ADD      r0,r5,#0x18
000914  f7fffffe          BL       lc640_write_long_ptr
;;;654    	
;;;655    	data[0]='B';
000918  f88d4000          STRB     r4,[sp,#0]
;;;656    	data[1]='B';
00091c  f88d4001          STRB     r4,[sp,#1]
;;;657    	data[2]='B';
000920  f88d4002          STRB     r4,[sp,#2]
;;;658    	data[3]='B';
000924  f88d4003          STRB     r4,[sp,#3]
;;;659    	lc640_write_long_ptr(lc640_adr+28,data);	
000928  4669              MOV      r1,sp
00092a  f105001c          ADD      r0,r5,#0x1c
00092e  f7fffffe          BL       lc640_write_long_ptr
;;;660    	
;;;661    /*	memo_out0[0]=0x55;
;;;662         memo_out0[1]=0x00+2;
;;;663         memo_out0[2]=1;
;;;664         memo_out0[3]=0x0b;
;;;665         memo_out0[4]=0xaa;
;;;666         memo_out0[5]=0xaa; 
;;;667         	
;;;668         memo_out0[6]=crc_87(memo_out0,6);
;;;669    	memo_out0[7]=crc_95(memo_out0,6);
;;;670         usart_out_adr0(memo_out0,8); */
;;;671         snmp_trap_send("Main power is on",2,1,1);	
000932  2301              MOVS     r3,#1
000934  461a              MOV      r2,r3
000936  2102              MOVS     r1,#2
000938  a01a              ADR      r0,|L1.2468|
00093a  f7fffffe          BL       snmp_trap_send
                  |L1.2366|
;;;672    	}
;;;673    avar_unet_hndl_end:
;;;674    	__nop();		
00093e  bf00              NOP      
;;;675    }
000940  e6b1              B        |L1.1702|
000942  0000              DCW      0x0000
                  |L1.2372|
000944  4d61696e          DCB      "Main power alarm, voltage increased",0
000948  20706f77
00094c  65722061
000950  6c61726d
000954  2c20766f
000958  6c746167
00095c  6520696e
000960  63726561
000964  73656400
                  |L1.2408|
                          DCD      ||.data||
                  |L1.2412|
                          DCD      AV_OFF_AVT
                  |L1.2416|
                          DCD      net_Ustore
                  |L1.2420|
000974  4d61696e          DCB      "Main power alarm  clear",0
000978  20706f77
00097c  65722061
000980  6c61726d
000984  2020636c
000988  65617200
                  |L1.2444|
                          DCD      net_Ustore_max
                  |L1.2448|
                          DCD      0x40024000
                  |L1.2452|
                          DCD      uout_av
                  |L1.2456|
                          DCD      load_U
                  |L1.2460|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2464|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2468|
0009a4  4d61696e          DCB      "Main power is on",0
0009a8  20706f77
0009ac  65722069
0009b0  73206f6e
0009b4  00      
0009b5  00                DCB      0
0009b6  00                DCB      0
0009b7  00                DCB      0
                          ENDP

                  avar_bps_hndl PROC
;;;677    //-----------------------------------------------
;;;678    void avar_bps_hndl(char dev, char v, char in)
0009b8  e92d4ff8          PUSH     {r3-r11,lr}
;;;679    {
0009bc  4606              MOV      r6,r0
0009be  460c              MOV      r4,r1
;;;680    char data[4];
;;;681    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;682    char avar_simbol;
;;;683    
;;;684    avar_simbol='T';
0009c0  f04f0754          MOV      r7,#0x54
;;;685    if(v==0)avar_simbol='T';
0009c4  b174              CBZ      r4,|L1.2532|
;;;686    else if(v==1)avar_simbol='U';
0009c6  2c01              CMP      r4,#1
0009c8  d004              BEQ      |L1.2516|
;;;687    else if(v==2)avar_simbol='u';
0009ca  2c02              CMP      r4,#2
0009cc  d005              BEQ      |L1.2522|
;;;688    else if(v==3)avar_simbol='L';
0009ce  2c03              CMP      r4,#3
0009d0  d006              BEQ      |L1.2528|
0009d2  e007              B        |L1.2532|
                  |L1.2516|
0009d4  f04f0755          MOV      r7,#0x55              ;686
0009d8  e004              B        |L1.2532|
                  |L1.2522|
0009da  f04f0775          MOV      r7,#0x75              ;687
0009de  e001              B        |L1.2532|
                  |L1.2528|
0009e0  f04f074c          MOV      r7,#0x4c
                  |L1.2532|
;;;689    
;;;690    if(in==1)
;;;691    	{
;;;692    	//av_src[bps]=1;
;;;693    
;;;694    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;695    //	SET_REG(avar_stat,1,3+dev,1);
;;;696    	
;;;697    	if(v==0)bps[dev]._av|=(1<<0);
;;;698    	else if(v==1) bps[dev]._av|=(1<<1);
;;;699    	else if(v==2) bps[dev]._av|=(1<<2);
;;;700    	else if(v==3) bps[dev]._av|=(1<<3);
;;;701    
;;;702    	bps[dev]._last_avar=v;
;;;703    
;;;704    	//beep_init(0x33333333,'A');
;;;705    
;;;706    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;707    	event_ptr++;	
;;;708    	if(event_ptr>63)event_ptr=0;	
;;;709    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;710    	
;;;711        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;712    	if(event_cnt!=63)event_cnt=event_ptr;
;;;713    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;714    	
;;;715    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;716    	
;;;717    	data[0]='S';
;;;718    	data[1]=dev; 
;;;719    	data[2]=avar_simbol;
;;;720    	data[3]=0;
;;;721    	lc640_write_long_ptr(lc640_adr,data);
;;;722    
;;;723    	data[0]=0;
;;;724    	data[1]=0;
;;;725    	data[2]=0;
;;;726    	data[3]=0;
;;;727    	lc640_write_long_ptr(lc640_adr+4,data);
;;;728    
;;;729    	data[0]=LPC_RTC->YEAR;
0009e4  f8df8400          LDR      r8,|L1.3560|
0009e8  f04f0900          MOV      r9,#0                 ;679
0009ec  48ff              LDR      r0,|L1.3564|
0009ee  eb0601c6          ADD      r1,r6,r6,LSL #3       ;697
0009f2  eb011106          ADD      r1,r1,r6,LSL #4       ;697
0009f6  f44f6a60          MOV      r10,#0xe00            ;706
0009fa  f44f6580          MOV      r5,#0x400             ;715
0009fe  eb000081          ADD      r0,r0,r1,LSL #2       ;697
000a02  2a01              CMP      r2,#1                 ;690
000a04  d002              BEQ      |L1.2572|
;;;730    	data[1]=LPC_RTC->MONTH;
;;;731    	data[2]=LPC_RTC->DOM;
;;;732    	data[3]=0;
;;;733    	lc640_write_long_ptr(lc640_adr+8,data);
;;;734    
;;;735    	data[0]=LPC_RTC->HOUR;
;;;736    	data[1]=LPC_RTC->MIN;
;;;737    	data[2]=LPC_RTC->SEC;
;;;738    	data[3]=0;
;;;739    	lc640_write_long_ptr(lc640_adr+12,data);
;;;740    	
;;;741    	data[0]='A';
;;;742    	data[1]='A';
;;;743    	data[2]='A';
;;;744    	data[3]='A';
;;;745    	lc640_write_long_ptr(lc640_adr+16,data);
;;;746    	
;;;747    	data[0]='A';
;;;748    	data[1]='A';
;;;749    	data[2]='A';
;;;750    	data[3]='A';
;;;751    	lc640_write_long_ptr(lc640_adr+20,data);
;;;752    	
;;;753    	data[0]='A';
;;;754    	data[1]='A';
;;;755    	data[2]='A';
;;;756    	data[3]='A';
;;;757    	lc640_write_long_ptr(lc640_adr+24,data);
;;;758    	
;;;759    	data[0]='A';
;;;760    	data[1]='A';
;;;761    	data[2]='A';
;;;762    	data[3]='A';
;;;763    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;764    
;;;765    
;;;766    	if(dev==0)
;;;767    		{
;;;768    		if(v==0)
;;;769    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;770    		else if(v==1)
;;;771    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;772    		else if(v==2)
;;;773    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;774    		else if(v==3)
;;;775    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;776    		}
;;;777    	else if(dev==1)
;;;778    		{
;;;779    		if(v==0)
;;;780    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;781    		else if(v==1)
;;;782    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;783    		else if(v==2)
;;;784    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;785    		else if(v==3)
;;;786    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;787    		} 
;;;788    	else if(dev==2)
;;;789    		{
;;;790    		if(v==0)
;;;791    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;792    		else if(v==1)
;;;793    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;794    		else if(v==2)
;;;795    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;796    		else if(v==3)
;;;797    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;798    		} 	
;;;799    			
;;;800    	}
;;;801    
;;;802    else if(in==0)
000a06  2a00              CMP      r2,#0
000a08  d07e              BEQ      |L1.2824|
000a0a  e1c4              B        |L1.3478|
                  |L1.2572|
000a0c  b134              CBZ      r4,|L1.2588|
000a0e  2c01              CMP      r4,#1                 ;698
000a10  d009              BEQ      |L1.2598|
000a12  2c02              CMP      r4,#2                 ;699
000a14  d00c              BEQ      |L1.2608|
000a16  2c03              CMP      r4,#3                 ;700
000a18  d00f              BEQ      |L1.2618|
000a1a  e012              B        |L1.2626|
                  |L1.2588|
000a1c  7841              LDRB     r1,[r0,#1]            ;697
000a1e  f0410101          ORR      r1,r1,#1              ;697
000a22  7041              STRB     r1,[r0,#1]            ;697
000a24  e00d              B        |L1.2626|
                  |L1.2598|
000a26  7841              LDRB     r1,[r0,#1]            ;698
000a28  f0410102          ORR      r1,r1,#2              ;698
000a2c  7041              STRB     r1,[r0,#1]            ;698
000a2e  e008              B        |L1.2626|
                  |L1.2608|
000a30  7841              LDRB     r1,[r0,#1]            ;699
000a32  f0410104          ORR      r1,r1,#4              ;699
000a36  7041              STRB     r1,[r0,#1]            ;699
000a38  e003              B        |L1.2626|
                  |L1.2618|
000a3a  7841              LDRB     r1,[r0,#1]            ;700
000a3c  f0410108          ORR      r1,r1,#8              ;700
000a40  7041              STRB     r1,[r0,#1]            ;700
                  |L1.2626|
000a42  f8804057          STRB     r4,[r0,#0x57]         ;702
000a46  4650              MOV      r0,r10                ;706
000a48  f7fffffe          BL       lc640_read_int
000a4c  f1000001          ADD      r0,r0,#1              ;707
000a50  fa1ffb80          UXTH     r11,r0                ;707
000a54  f1bb0f3f          CMP      r11,#0x3f             ;708
000a58  d901              BLS      |L1.2654|
000a5a  f04f0b00          MOV      r11,#0                ;708
                  |L1.2654|
000a5e  fa0ff18b          SXTH     r1,r11                ;709
000a62  4650              MOV      r0,r10                ;709
000a64  f7fffffe          BL       lc640_write_int
000a68  f6406002          MOV      r0,#0xe02             ;711
000a6c  f7fffffe          BL       lc640_read_int
000a70  b280              UXTH     r0,r0                 ;711
000a72  283f              CMP      r0,#0x3f              ;712
000a74  d000              BEQ      |L1.2680|
000a76  4658              MOV      r0,r11                ;712
                  |L1.2680|
000a78  b201              SXTH     r1,r0                 ;713
000a7a  f6406002          MOV      r0,#0xe02             ;713
000a7e  f7fffffe          BL       lc640_write_int
000a82  4650              MOV      r0,r10                ;715
000a84  f7fffffe          BL       lc640_read_int
000a88  eb051040          ADD      r0,r5,r0,LSL #5       ;715
000a8c  b285              UXTH     r5,r0                 ;715
000a8e  f04f0053          MOV      r0,#0x53              ;717
000a92  f88d0000          STRB     r0,[sp,#0]            ;717
000a96  f88d6001          STRB     r6,[sp,#1]            ;718
000a9a  f88d7002          STRB     r7,[sp,#2]            ;719
000a9e  f88d9003          STRB     r9,[sp,#3]            ;720
000aa2  4669              MOV      r1,sp                 ;721
000aa4  4628              MOV      r0,r5                 ;721
000aa6  f7fffffe          BL       lc640_write_long_ptr
000aaa  f8cd9000          STR      r9,[sp,#0]            ;726
000aae  4669              MOV      r1,sp                 ;727
000ab0  1d28              ADDS     r0,r5,#4              ;727
000ab2  f7fffffe          BL       lc640_write_long_ptr
000ab6  f8b8003c          LDRH     r0,[r8,#0x3c]         ;729
000aba  f88d0000          STRB     r0,[sp,#0]            ;729
000abe  f8980038          LDRB     r0,[r8,#0x38]         ;730
000ac2  f88d0001          STRB     r0,[sp,#1]            ;730
000ac6  f898002c          LDRB     r0,[r8,#0x2c]         ;731
000aca  f88d0002          STRB     r0,[sp,#2]            ;731
000ace  f88d9003          STRB     r9,[sp,#3]            ;732
000ad2  4669              MOV      r1,sp                 ;733
000ad4  f1050008          ADD      r0,r5,#8              ;733
000ad8  f7fffffe          BL       lc640_write_long_ptr
000adc  f8980028          LDRB     r0,[r8,#0x28]         ;735
000ae0  f88d0000          STRB     r0,[sp,#0]            ;735
000ae4  f8980024          LDRB     r0,[r8,#0x24]         ;736
000ae8  f88d0001          STRB     r0,[sp,#1]            ;736
000aec  f8980020          LDRB     r0,[r8,#0x20]         ;737
000af0  f88d0002          STRB     r0,[sp,#2]            ;737
000af4  f88d9003          STRB     r9,[sp,#3]            ;738
000af8  4669              MOV      r1,sp                 ;739
000afa  f105000c          ADD      r0,r5,#0xc            ;739
000afe  f7fffffe          BL       lc640_write_long_ptr
000b02  f04f0741          MOV      r7,#0x41              ;741
000b06  e000              B        |L1.2826|
                  |L1.2824|
000b08  e0a5              B        |L1.3158|
                  |L1.2826|
000b0a  f88d7000          STRB     r7,[sp,#0]            ;741
000b0e  f88d7001          STRB     r7,[sp,#1]            ;742
000b12  f88d7002          STRB     r7,[sp,#2]            ;743
000b16  f88d7003          STRB     r7,[sp,#3]            ;744
000b1a  4669              MOV      r1,sp                 ;745
000b1c  f1050010          ADD      r0,r5,#0x10           ;745
000b20  f7fffffe          BL       lc640_write_long_ptr
000b24  f88d7000          STRB     r7,[sp,#0]            ;747
000b28  f88d7001          STRB     r7,[sp,#1]            ;748
000b2c  f88d7002          STRB     r7,[sp,#2]            ;749
000b30  f88d7003          STRB     r7,[sp,#3]            ;750
000b34  4669              MOV      r1,sp                 ;751
000b36  f1050014          ADD      r0,r5,#0x14           ;751
000b3a  f7fffffe          BL       lc640_write_long_ptr
000b3e  f88d7000          STRB     r7,[sp,#0]            ;753
000b42  f88d7001          STRB     r7,[sp,#1]            ;754
000b46  f88d7002          STRB     r7,[sp,#2]            ;755
000b4a  f88d7003          STRB     r7,[sp,#3]            ;756
000b4e  4669              MOV      r1,sp                 ;757
000b50  f1050018          ADD      r0,r5,#0x18           ;757
000b54  f7fffffe          BL       lc640_write_long_ptr
000b58  f88d7000          STRB     r7,[sp,#0]            ;759
000b5c  f88d7001          STRB     r7,[sp,#1]            ;760
000b60  f88d7002          STRB     r7,[sp,#2]            ;761
000b64  f88d7003          STRB     r7,[sp,#3]            ;762
000b68  4669              MOV      r1,sp                 ;763
000b6a  f105001c          ADD      r0,r5,#0x1c           ;763
000b6e  f7fffffe          BL       lc640_write_long_ptr
000b72  b126              CBZ      r6,|L1.2942|
000b74  2e01              CMP      r6,#1                 ;777
000b76  d026              BEQ      |L1.3014|
000b78  2e02              CMP      r6,#2                 ;788
000b7a  d048              BEQ      |L1.3086|
000b7c  e10b              B        |L1.3478|
                  |L1.2942|
000b7e  b134              CBZ      r4,|L1.2958|
000b80  2c01              CMP      r4,#1                 ;770
000b82  d00b              BEQ      |L1.2972|
000b84  2c02              CMP      r4,#2                 ;772
000b86  d010              BEQ      |L1.2986|
000b88  2c03              CMP      r4,#3                 ;774
000b8a  d015              BEQ      |L1.3000|
000b8c  e103              B        |L1.3478|
                  |L1.2958|
000b8e  2300              MOVS     r3,#0                 ;769
000b90  2201              MOVS     r2,#1                 ;769
000b92  2104              MOVS     r1,#4                 ;769
000b94  a096              ADR      r0,|L1.3568|
000b96  f7fffffe          BL       snmp_trap_send
000b9a  e0fc              B        |L1.3478|
                  |L1.2972|
000b9c  2301              MOVS     r3,#1                 ;771
000b9e  461a              MOV      r2,r3                 ;771
000ba0  2104              MOVS     r1,#4                 ;771
000ba2  a099              ADR      r0,|L1.3592|
000ba4  f7fffffe          BL       snmp_trap_send
000ba8  e0f5              B        |L1.3478|
                  |L1.2986|
000baa  2302              MOVS     r3,#2                 ;773
000bac  2201              MOVS     r2,#1                 ;773
000bae  2104              MOVS     r1,#4                 ;773
000bb0  a09c              ADR      r0,|L1.3620|
000bb2  f7fffffe          BL       snmp_trap_send
000bb6  e0ee              B        |L1.3478|
                  |L1.3000|
000bb8  2303              MOVS     r3,#3                 ;775
000bba  2201              MOVS     r2,#1                 ;775
000bbc  2104              MOVS     r1,#4                 ;775
000bbe  a0a1              ADR      r0,|L1.3652|
000bc0  f7fffffe          BL       snmp_trap_send
000bc4  e0e7              B        |L1.3478|
                  |L1.3014|
000bc6  b134              CBZ      r4,|L1.3030|
000bc8  2c01              CMP      r4,#1                 ;781
000bca  d00b              BEQ      |L1.3044|
000bcc  2c02              CMP      r4,#2                 ;783
000bce  d010              BEQ      |L1.3058|
000bd0  2c03              CMP      r4,#3                 ;785
000bd2  d015              BEQ      |L1.3072|
000bd4  e0df              B        |L1.3478|
                  |L1.3030|
000bd6  2300              MOVS     r3,#0                 ;780
000bd8  2202              MOVS     r2,#2                 ;780
000bda  2104              MOVS     r1,#4                 ;780
000bdc  a0a1              ADR      r0,|L1.3684|
000bde  f7fffffe          BL       snmp_trap_send
000be2  e0d8              B        |L1.3478|
                  |L1.3044|
000be4  2301              MOVS     r3,#1                 ;782
000be6  2202              MOVS     r2,#2                 ;782
000be8  2104              MOVS     r1,#4                 ;782
000bea  a0a4              ADR      r0,|L1.3708|
000bec  f7fffffe          BL       snmp_trap_send
000bf0  e0d1              B        |L1.3478|
                  |L1.3058|
000bf2  2302              MOVS     r3,#2                 ;784
000bf4  461a              MOV      r2,r3                 ;784
000bf6  2104              MOVS     r1,#4                 ;784
000bf8  a0a7              ADR      r0,|L1.3736|
000bfa  f7fffffe          BL       snmp_trap_send
000bfe  e0ca              B        |L1.3478|
                  |L1.3072|
000c00  2303              MOVS     r3,#3                 ;786
000c02  2202              MOVS     r2,#2                 ;786
000c04  2104              MOVS     r1,#4                 ;786
000c06  a0ac              ADR      r0,|L1.3768|
000c08  f7fffffe          BL       snmp_trap_send
000c0c  e0c3              B        |L1.3478|
                  |L1.3086|
000c0e  b134              CBZ      r4,|L1.3102|
000c10  2c01              CMP      r4,#1                 ;792
000c12  d00b              BEQ      |L1.3116|
000c14  2c02              CMP      r4,#2                 ;794
000c16  d010              BEQ      |L1.3130|
000c18  2c03              CMP      r4,#3                 ;796
000c1a  d015              BEQ      |L1.3144|
000c1c  e0bb              B        |L1.3478|
                  |L1.3102|
000c1e  2300              MOVS     r3,#0                 ;791
000c20  2203              MOVS     r2,#3                 ;791
000c22  2104              MOVS     r1,#4                 ;791
000c24  a0ac              ADR      r0,|L1.3800|
000c26  f7fffffe          BL       snmp_trap_send
000c2a  e0b4              B        |L1.3478|
                  |L1.3116|
000c2c  2301              MOVS     r3,#1                 ;793
000c2e  2203              MOVS     r2,#3                 ;793
000c30  2104              MOVS     r1,#4                 ;793
000c32  a0af              ADR      r0,|L1.3824|
000c34  f7fffffe          BL       snmp_trap_send
000c38  e0ad              B        |L1.3478|
                  |L1.3130|
000c3a  2302              MOVS     r3,#2                 ;795
000c3c  2203              MOVS     r2,#3                 ;795
000c3e  2104              MOVS     r1,#4                 ;795
000c40  a0b2              ADR      r0,|L1.3852|
000c42  f7fffffe          BL       snmp_trap_send
000c46  e0a6              B        |L1.3478|
                  |L1.3144|
000c48  2303              MOVS     r3,#3                 ;797
000c4a  461a              MOV      r2,r3                 ;797
000c4c  2104              MOVS     r1,#4                 ;797
000c4e  a0b7              ADR      r0,|L1.3884|
000c50  f7fffffe          BL       snmp_trap_send
000c54  e09f              B        |L1.3478|
                  |L1.3158|
;;;803    	{      
;;;804    //	av_bps[bps]=0;
;;;805    
;;;806    	//SET_REG(avar_stat,0,3+bps,1);
;;;807    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;808    
;;;809         if(v==0) bps[dev]._av&=(~(1<<0));
000c56  b134              CBZ      r4,|L1.3174|
;;;810         else if(v==1) bps[dev]._av&=(~(1<<1));
000c58  2c01              CMP      r4,#1
000c5a  d009              BEQ      |L1.3184|
;;;811    	else if(v==2) bps[dev]._av&=(~(1<<2));
000c5c  2c02              CMP      r4,#2
000c5e  d00c              BEQ      |L1.3194|
;;;812    	else if(v==3) bps[dev]._av&=(~(1<<3));
000c60  2c03              CMP      r4,#3
000c62  d00f              BEQ      |L1.3204|
000c64  e012              B        |L1.3212|
                  |L1.3174|
000c66  7841              LDRB     r1,[r0,#1]            ;809
000c68  f0210101          BIC      r1,r1,#1              ;809
000c6c  7041              STRB     r1,[r0,#1]            ;809
000c6e  e00d              B        |L1.3212|
                  |L1.3184|
000c70  7841              LDRB     r1,[r0,#1]            ;810
000c72  f0210102          BIC      r1,r1,#2              ;810
000c76  7041              STRB     r1,[r0,#1]            ;810
000c78  e008              B        |L1.3212|
                  |L1.3194|
000c7a  7841              LDRB     r1,[r0,#1]            ;811
000c7c  f0210104          BIC      r1,r1,#4              ;811
000c80  7041              STRB     r1,[r0,#1]            ;811
000c82  e003              B        |L1.3212|
                  |L1.3204|
000c84  7841              LDRB     r1,[r0,#1]
000c86  f0210108          BIC      r1,r1,#8
000c8a  7041              STRB     r1,[r0,#1]
                  |L1.3212|
;;;813         
;;;814    //	if((bps[dev]._av&0x0f==0))
;;;815    //	     {
;;;816    		//SET_REG(avar_stat,0,3+bps,1);
;;;817    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;818    //	     }
;;;819     
;;;820    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000c8c  4650              MOV      r0,r10
000c8e  f7fffffe          BL       lc640_read_int
000c92  fa1ffb80          UXTH     r11,r0
;;;821    	event_ptr_find=event_ptr;
000c96  465c              MOV      r4,r11
                  |L1.3224|
;;;822    	
;;;823    avar_src_hndl_lbl1: 
;;;824    
;;;825    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000c98  eb051044          ADD      r0,r5,r4,LSL #5
000c9c  fa1ffa80          UXTH     r10,r0
;;;826    
;;;827         lc640_read_long_ptr(lc640_adr,data);
000ca0  4669              MOV      r1,sp
000ca2  4650              MOV      r0,r10
000ca4  f7fffffe          BL       lc640_read_long_ptr
;;;828         
;;;829         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000ca8  f89d0000          LDRB     r0,[sp,#0]
000cac  2853              CMP      r0,#0x53
000cae  d107              BNE      |L1.3264|
000cb0  f89d0001          LDRB     r0,[sp,#1]
000cb4  42b0              CMP      r0,r6
000cb6  d103              BNE      |L1.3264|
000cb8  f89d0002          LDRB     r0,[sp,#2]
000cbc  42b8              CMP      r0,r7
000cbe  d009              BEQ      |L1.3284|
                  |L1.3264|
;;;830         	{        
;;;831         	if(event_ptr_find)event_ptr_find--;
000cc0  b11c              CBZ      r4,|L1.3274|
000cc2  f1a40401          SUB      r4,r4,#1
000cc6  b2a4              UXTH     r4,r4
000cc8  e001              B        |L1.3278|
                  |L1.3274|
;;;832         	else event_ptr_find=63;
000cca  f04f043f          MOV      r4,#0x3f
                  |L1.3278|
;;;833         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000cce  455c              CMP      r4,r11
000cd0  d1e2              BNE      |L1.3224|
000cd2  e060              B        |L1.3478|
                  |L1.3284|
;;;834         	else goto avar_src_hndl_lbl1;
;;;835         	}
;;;836         else 
;;;837         	{
;;;838         	lc640_read_long_ptr(lc640_adr+16,data);
000cd4  4669              MOV      r1,sp
000cd6  f10a0010          ADD      r0,r10,#0x10
000cda  f7fffffe          BL       lc640_read_long_ptr
;;;839         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000cde  f89d0000          LDRB     r0,[sp,#0]
000ce2  2841              CMP      r0,#0x41
000ce4  d10b              BNE      |L1.3326|
000ce6  f89d0001          LDRB     r0,[sp,#1]
000cea  2841              CMP      r0,#0x41
000cec  d107              BNE      |L1.3326|
000cee  f89d0002          LDRB     r0,[sp,#2]
000cf2  2841              CMP      r0,#0x41
000cf4  d103              BNE      |L1.3326|
000cf6  f89d0003          LDRB     r0,[sp,#3]
000cfa  2841              CMP      r0,#0x41
000cfc  d009              BEQ      |L1.3346|
                  |L1.3326|
;;;840         		{        
;;;841         		if(event_ptr_find)event_ptr_find--;
000cfe  b11c              CBZ      r4,|L1.3336|
000d00  f1a40401          SUB      r4,r4,#1
000d04  b2a4              UXTH     r4,r4
000d06  e001              B        |L1.3340|
                  |L1.3336|
;;;842             		else event_ptr_find=63;
000d08  f04f043f          MOV      r4,#0x3f
                  |L1.3340|
;;;843             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000d0c  455c              CMP      r4,r11
000d0e  d1c3              BNE      |L1.3224|
000d10  e041              B        |L1.3478|
                  |L1.3346|
;;;844         		else goto avar_src_hndl_lbl1;
;;;845         		}
;;;846    
;;;847         	}	
;;;848    
;;;849    
;;;850    	
;;;851    	data[0]=LPC_RTC->YEAR;
000d12  f8b8003c          LDRH     r0,[r8,#0x3c]
000d16  f88d0000          STRB     r0,[sp,#0]
;;;852    	data[1]=LPC_RTC->MONTH;
000d1a  f8980038          LDRB     r0,[r8,#0x38]
000d1e  f88d0001          STRB     r0,[sp,#1]
;;;853    	data[2]=LPC_RTC->DOM;
000d22  f898002c          LDRB     r0,[r8,#0x2c]
000d26  f88d0002          STRB     r0,[sp,#2]
;;;854    	data[3]=0;
000d2a  f88d9003          STRB     r9,[sp,#3]
;;;855    	lc640_write_long_ptr(lc640_adr+16,data);
000d2e  4669              MOV      r1,sp
000d30  f10a0010          ADD      r0,r10,#0x10
000d34  f7fffffe          BL       lc640_write_long_ptr
;;;856    
;;;857    	data[0]=LPC_RTC->HOUR;
000d38  f8980028          LDRB     r0,[r8,#0x28]
000d3c  f88d0000          STRB     r0,[sp,#0]
;;;858    	data[1]=LPC_RTC->MIN;
000d40  f8980024          LDRB     r0,[r8,#0x24]
000d44  f88d0001          STRB     r0,[sp,#1]
;;;859    	data[2]=LPC_RTC->SEC;
000d48  f8980020          LDRB     r0,[r8,#0x20]
000d4c  f88d0002          STRB     r0,[sp,#2]
;;;860    	data[3]=0;
000d50  f88d9003          STRB     r9,[sp,#3]
;;;861    	lc640_write_long_ptr(lc640_adr+20,data);
000d54  4669              MOV      r1,sp
000d56  f10a0014          ADD      r0,r10,#0x14
000d5a  f7fffffe          BL       lc640_write_long_ptr
;;;862    	
;;;863    	data[0]='B';
000d5e  f04f0442          MOV      r4,#0x42
000d62  f88d4000          STRB     r4,[sp,#0]
;;;864    	data[1]='B';
000d66  f88d4001          STRB     r4,[sp,#1]
;;;865    	data[2]='B';
000d6a  f88d4002          STRB     r4,[sp,#2]
;;;866    	data[3]='B';
000d6e  f88d4003          STRB     r4,[sp,#3]
;;;867    	lc640_write_long_ptr(lc640_adr+24,data);
000d72  4669              MOV      r1,sp
000d74  f10a0018          ADD      r0,r10,#0x18
000d78  f7fffffe          BL       lc640_write_long_ptr
;;;868    	
;;;869    	data[0]='B';
000d7c  f88d4000          STRB     r4,[sp,#0]
;;;870    	data[1]='B';
000d80  f88d4001          STRB     r4,[sp,#1]
;;;871    	data[2]='B';
000d84  f88d4002          STRB     r4,[sp,#2]
;;;872    	data[3]='B';
000d88  f88d4003          STRB     r4,[sp,#3]
;;;873    	lc640_write_long_ptr(lc640_adr+28,data);
000d8c  4669              MOV      r1,sp
000d8e  f10a001c          ADD      r0,r10,#0x1c
000d92  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3478|
;;;874    	
;;;875    	}
;;;876    	
;;;877    avar_src_hndl_end:
;;;878    __nop();		
000d96  bf00              NOP      
                  |L1.3480|
;;;879    }
000d98  e485              B        |L1.1702|
;;;880    
                          ENDP

                  wrk_mem_hndl PROC
;;;881    //-----------------------------------------------
;;;882    void wrk_mem_hndl(char b)
000d9a  e92d41fc          PUSH     {r2-r8,lr}
;;;883    {
000d9e  4606              MOV      r6,r0
;;;884    char data[4];
;;;885    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;886    
;;;887    signed short temp_temp;
;;;888    
;;;889    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000da0  eb060046          ADD      r0,r6,r6,LSL #1
000da4  eb001106          ADD      r1,r0,r6,LSL #4
000da8  4868              LDR      r0,|L1.3916|
000daa  eb000481          ADD      r4,r0,r1,LSL #2
000dae  8be0              LDRH     r0,[r4,#0x1e]
000db0  2805              CMP      r0,#5
000db2  d318              BCC      |L1.3558|
;;;890    
;;;891    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000db4  4866              LDR      r0,|L1.3920|
000db6  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000db8  f1000006          ADD      r0,r0,#6
000dbc  f0000007          AND      r0,r0,#7
000dc0  eb040040          ADD      r0,r4,r0,LSL #1
000dc4  8c00              LDRH     r0,[r0,#0x20]
000dc6  9000              STR      r0,[sp,#0]
;;;892    
;;;893    
;;;894    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000dc8  f44f6760          MOV      r7,#0xe00
000dcc  4638              MOV      r0,r7
000dce  f7fffffe          BL       lc640_read_int
;;;895    event_ptr++;	
000dd2  f1000001          ADD      r0,r0,#1
000dd6  b285              UXTH     r5,r0
;;;896    if(event_ptr>63)event_ptr=0;	
000dd8  2d3f              CMP      r5,#0x3f
000dda  d901              BLS      |L1.3552|
000ddc  f04f0500          MOV      r5,#0
                  |L1.3552|
;;;897    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000de0  b229              SXTH     r1,r5
000de2  4638              MOV      r0,r7
000de4  e0b6              B        |L1.3924|
                  |L1.3558|
000de6  e11d              B        |L1.4132|
                  |L1.3560|
                          DCD      0x40024000
                  |L1.3564|
                          DCD      bps
                  |L1.3568|
000df0  42505320          DCB      "BPS #1 Alarm, overheat",0
000df4  23312041
000df8  6c61726d
000dfc  2c206f76
000e00  65726865
000e04  617400  
000e07  00                DCB      0
                  |L1.3592|
000e08  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000e0c  23312041
000e10  6c61726d
000e14  2c20766f
000e18  6c746167
000e1c  65206973
000e20  20757000
                  |L1.3620|
000e24  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000e28  23312041
000e2c  6c61726d
000e30  2c20766f
000e34  6c746167
000e38  65206973
000e3c  20646f77
000e40  6e00    
000e42  00                DCB      0
000e43  00                DCB      0
                  |L1.3652|
000e44  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000e48  23312041
000e4c  6c61726d
000e50  2c20636f
000e54  6e6e6563
000e58  74206973
000e5c  206c6f73
000e60  7400    
000e62  00                DCB      0
000e63  00                DCB      0
                  |L1.3684|
000e64  42505320          DCB      "BPS #2 Alarm, overheat",0
000e68  23322041
000e6c  6c61726d
000e70  2c206f76
000e74  65726865
000e78  617400  
000e7b  00                DCB      0
                  |L1.3708|
000e7c  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000e80  23322041
000e84  6c61726d
000e88  2c20766f
000e8c  6c746167
000e90  65206973
000e94  20757000
                  |L1.3736|
000e98  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000e9c  23322041
000ea0  6c61726d
000ea4  2c20766f
000ea8  6c746167
000eac  65206973
000eb0  20646f77
000eb4  6e00    
000eb6  00                DCB      0
000eb7  00                DCB      0
                  |L1.3768|
000eb8  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000ebc  23322041
000ec0  6c61726d
000ec4  2c20636f
000ec8  6e6e6563
000ecc  74206973
000ed0  206c6f73
000ed4  7400    
000ed6  00                DCB      0
000ed7  00                DCB      0
                  |L1.3800|
000ed8  42505320          DCB      "BPS #3 Alarm, overheat",0
000edc  23332041
000ee0  6c61726d
000ee4  2c206f76
000ee8  65726865
000eec  617400  
000eef  00                DCB      0
                  |L1.3824|
000ef0  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000ef4  23332041
000ef8  6c61726d
000efc  2c20766f
000f00  6c746167
000f04  65206973
000f08  20757000
                  |L1.3852|
000f0c  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000f10  23332041
000f14  6c61726d
000f18  2c20766f
000f1c  6c746167
000f20  65206973
000f24  20646f77
000f28  6e00    
000f2a  00                DCB      0
000f2b  00                DCB      0
                  |L1.3884|
000f2c  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000f30  23332041
000f34  6c61726d
000f38  2c20636f
000f3c  6e6e6563
000f40  74206973
000f44  206c6f73
000f48  7400    
000f4a  00                DCB      0
000f4b  00                DCB      0
                  |L1.3916|
                          DCD      bat
                  |L1.3920|
                          DCD      bat_u_old_cnt
                  |L1.3924|
000f54  f7fffffe          BL       lc640_write_int
;;;898    	
;;;899    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000f58  f6406802          MOV      r8,#0xe02
000f5c  4640              MOV      r0,r8
000f5e  f7fffffe          BL       lc640_read_int
000f62  b280              UXTH     r0,r0
;;;900    if(event_cnt!=63)event_cnt=event_ptr;
000f64  283f              CMP      r0,#0x3f
000f66  d000              BEQ      |L1.3946|
000f68  4628              MOV      r0,r5
                  |L1.3946|
;;;901    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000f6a  b201              SXTH     r1,r0
000f6c  4640              MOV      r0,r8
000f6e  f7fffffe          BL       lc640_write_int
;;;902    	
;;;903    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000f72  4638              MOV      r0,r7
000f74  f7fffffe          BL       lc640_read_int
000f78  f44f6180          MOV      r1,#0x400
000f7c  eb011040          ADD      r0,r1,r0,LSL #5
000f80  b285              UXTH     r5,r0
;;;904    	
;;;905    data[0]='B';
000f82  f04f0042          MOV      r0,#0x42
000f86  f88d0004          STRB     r0,[sp,#4]
;;;906    data[1]=b; 
000f8a  f88d6005          STRB     r6,[sp,#5]
;;;907    data[2]='W';
000f8e  f04f0057          MOV      r0,#0x57
000f92  f88d0006          STRB     r0,[sp,#6]
;;;908    data[3]=0;
000f96  f04f0600          MOV      r6,#0
000f9a  f88d6007          STRB     r6,[sp,#7]
;;;909    
;;;910    lc640_write_long_ptr(lc640_adr,data);
000f9e  a901              ADD      r1,sp,#4
000fa0  4628              MOV      r0,r5
000fa2  f7fffffe          BL       lc640_write_long_ptr
;;;911    
;;;912    data[0]=*((char*)&bat[b]._Iintegr_);
000fa6  7fa0              LDRB     r0,[r4,#0x1e]
000fa8  f88d0004          STRB     r0,[sp,#4]
;;;913    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000fac  7fe0              LDRB     r0,[r4,#0x1f]
000fae  f88d0005          STRB     r0,[sp,#5]
;;;914    data[2]=*((char*)&temp_temp);
000fb2  f89d0000          LDRB     r0,[sp,#0]
000fb6  f88d0006          STRB     r0,[sp,#6]
;;;915    data[3]=*(((char*)(&temp_temp))+1);
000fba  f89d0001          LDRB     r0,[sp,#1]
000fbe  f88d0007          STRB     r0,[sp,#7]
;;;916    lc640_write_long_ptr(lc640_adr+4,data);
000fc2  a901              ADD      r1,sp,#4
000fc4  1d28              ADDS     r0,r5,#4
000fc6  f7fffffe          BL       lc640_write_long_ptr
;;;917    
;;;918    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000fca  f1040134          ADD      r1,r4,#0x34
000fce  f1050008          ADD      r0,r5,#8
000fd2  f7fffffe          BL       lc640_write_long_ptr
;;;919    	
;;;920    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000fd6  f1040138          ADD      r1,r4,#0x38
000fda  f105000c          ADD      r0,r5,#0xc
000fde  f7fffffe          BL       lc640_write_long_ptr
;;;921    
;;;922    data[0]=LPC_RTC->YEAR;
000fe2  4cff              LDR      r4,|L1.5088|
000fe4  8ba0              LDRH     r0,[r4,#0x1c]
000fe6  f88d0004          STRB     r0,[sp,#4]
;;;923    data[1]=LPC_RTC->MONTH;
000fea  7e20              LDRB     r0,[r4,#0x18]
000fec  f88d0005          STRB     r0,[sp,#5]
;;;924    data[2]=LPC_RTC->DOM;
000ff0  7b20              LDRB     r0,[r4,#0xc]
000ff2  f88d0006          STRB     r0,[sp,#6]
;;;925    data[3]=0;
000ff6  f88d6007          STRB     r6,[sp,#7]
;;;926    lc640_write_long_ptr(lc640_adr+16,data);
000ffa  a901              ADD      r1,sp,#4
000ffc  f1050010          ADD      r0,r5,#0x10
001000  f7fffffe          BL       lc640_write_long_ptr
;;;927    
;;;928    data[0]=LPC_RTC->HOUR;
001004  7a20              LDRB     r0,[r4,#8]
001006  f88d0004          STRB     r0,[sp,#4]
;;;929    data[1]=LPC_RTC->MIN;
00100a  7920              LDRB     r0,[r4,#4]
00100c  f88d0005          STRB     r0,[sp,#5]
;;;930    data[2]=LPC_RTC->SEC;
001010  7820              LDRB     r0,[r4,#0]
001012  f88d0006          STRB     r0,[sp,#6]
;;;931    data[3]=0;
001016  f88d6007          STRB     r6,[sp,#7]
;;;932    lc640_write_long_ptr(lc640_adr+20,data);
00101a  a901              ADD      r1,sp,#4
00101c  f1050014          ADD      r0,r5,#0x14
001020  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4132|
;;;933    	
;;;934    
;;;935    
;;;936    	
;;;937    wrk_mem_hndl_end:	
;;;938    __nop();
001024  bf00              NOP      
;;;939    }  
001026  e8bd81fc          POP      {r2-r8,pc}
;;;940    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;942    //-----------------------------------------------
;;;943    void avar_bat_ips_hndl(char in)
00102a  e92d4ff8          PUSH     {r3-r11,lr}
;;;944    {
00102e  4602              MOV      r2,r0
;;;945    char data[4];
;;;946    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;947    
;;;948    if(in==1)
;;;949    	{
;;;950    	bat_ips._av|=1;
001030  48ec              LDR      r0,|L1.5092|
;;;951        ips_bat_av_stat=1;
001032  4ced              LDR      r4,|L1.5096|
;;;952    	ips_bat_av_vzvod=1;
001034  4bed              LDR      r3,|L1.5100|
;;;953    
;;;954    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;955    	event_ptr++;	
;;;956    	if(event_ptr>63)event_ptr=0;	
;;;957    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;958    	
;;;959    	event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;960    	if(event_cnt!=63)event_cnt=event_ptr;
;;;961    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;962    	
;;;963    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;964    	
;;;965    	data[0]='B';
;;;966    	data[1]=0;
;;;967    	data[2]='C';
;;;968    	data[3]=0;
;;;969    	lc640_write_long_ptr(lc640_adr,data);
;;;970    
;;;971    	data[0]=0;
;;;972    	data[1]=0;
;;;973    	data[2]=0;
;;;974    	data[3]=0;
;;;975    	lc640_write_long_ptr(lc640_adr+4,data);
;;;976    
;;;977    	data[0]=LPC_RTC->YEAR;
001036  f8df83b8          LDR      r8,|L1.5104|
00103a  f890103d          LDRB     r1,[r0,#0x3d]         ;950
00103e  f04f0742          MOV      r7,#0x42              ;965
001042  f44f6560          MOV      r5,#0xe00             ;954
001046  f04f0900          MOV      r9,#0                 ;956
00104a  f44f6a80          MOV      r10,#0x400            ;963
00104e  2a01              CMP      r2,#1                 ;948
001050  d002              BEQ      |L1.4184|
;;;978    	data[1]=LPC_RTC->MONTH;
;;;979    	data[2]=LPC_RTC->DOM;
;;;980    	data[3]=0;
;;;981    	lc640_write_long_ptr(lc640_adr+8,data);
;;;982    
;;;983    	data[0]=LPC_RTC->HOUR;
;;;984    	data[1]=LPC_RTC->MIN;
;;;985    	data[2]=LPC_RTC->SEC;
;;;986    	data[3]=0;
;;;987    	lc640_write_long_ptr(lc640_adr+12,data);
;;;988    	
;;;989    	data[0]='A';
;;;990    	data[1]='A';
;;;991    	data[2]='A';
;;;992    	data[3]='A';
;;;993    	lc640_write_long_ptr(lc640_adr+16,data);
;;;994    	
;;;995    	data[0]='A';
;;;996    	data[1]='A';
;;;997    	data[2]='A';
;;;998    	data[3]='A';
;;;999    	lc640_write_long_ptr(lc640_adr+20,data);
;;;1000   	
;;;1001   	data[0]='A';
;;;1002   	data[1]='A';
;;;1003   	data[2]='A';
;;;1004   	data[3]='A';
;;;1005   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1006   	
;;;1007   	data[0]='A';
;;;1008   	data[1]='A';
;;;1009   	data[2]='A';
;;;1010   	data[3]='A';
;;;1011   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1012   					
;;;1013   	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;1014   		
;;;1015   	}
;;;1016   
;;;1017   else if(in==0)
001052  2a00              CMP      r2,#0
001054  d07e              BEQ      |L1.4436|
001056  e12f              B        |L1.4792|
                  |L1.4184|
001058  f0410101          ORR      r1,r1,#1              ;950
00105c  f880103d          STRB     r1,[r0,#0x3d]         ;950
001060  f04f0001          MOV      r0,#1                 ;951
001064  7020              STRB     r0,[r4,#0]            ;951
001066  7018              STRB     r0,[r3,#0]            ;952
001068  4628              MOV      r0,r5                 ;954
00106a  f7fffffe          BL       lc640_read_int
00106e  f1000001          ADD      r0,r0,#1              ;955
001072  b284              UXTH     r4,r0                 ;955
001074  2c3f              CMP      r4,#0x3f              ;956
001076  d901              BLS      |L1.4220|
001078  f04f0400          MOV      r4,#0                 ;956
                  |L1.4220|
00107c  b221              SXTH     r1,r4                 ;957
00107e  4628              MOV      r0,r5                 ;957
001080  f7fffffe          BL       lc640_write_int
001084  f6406602          MOV      r6,#0xe02             ;959
001088  4630              MOV      r0,r6                 ;959
00108a  f7fffffe          BL       lc640_read_int
00108e  b281              UXTH     r1,r0                 ;959
001090  293f              CMP      r1,#0x3f              ;960
001092  d000              BEQ      |L1.4246|
001094  4621              MOV      r1,r4                 ;960
                  |L1.4246|
001096  b209              SXTH     r1,r1                 ;961
001098  4630              MOV      r0,r6                 ;961
00109a  f7fffffe          BL       lc640_write_int
00109e  4628              MOV      r0,r5                 ;963
0010a0  f7fffffe          BL       lc640_read_int
0010a4  eb0a1040          ADD      r0,r10,r0,LSL #5      ;963
0010a8  b284              UXTH     r4,r0                 ;963
0010aa  f88d7000          STRB     r7,[sp,#0]            ;965
0010ae  f88d9001          STRB     r9,[sp,#1]            ;966
0010b2  f04f0043          MOV      r0,#0x43              ;967
0010b6  f88d0002          STRB     r0,[sp,#2]            ;967
0010ba  f88d9003          STRB     r9,[sp,#3]            ;968
0010be  4669              MOV      r1,sp                 ;969
0010c0  4620              MOV      r0,r4                 ;969
0010c2  f7fffffe          BL       lc640_write_long_ptr
0010c6  f8cd9000          STR      r9,[sp,#0]            ;974
0010ca  4669              MOV      r1,sp                 ;975
0010cc  1d20              ADDS     r0,r4,#4              ;975
0010ce  f7fffffe          BL       lc640_write_long_ptr
0010d2  f8b8003c          LDRH     r0,[r8,#0x3c]         ;977
0010d6  f88d0000          STRB     r0,[sp,#0]            ;977
0010da  f8980038          LDRB     r0,[r8,#0x38]         ;978
0010de  f88d0001          STRB     r0,[sp,#1]            ;978
0010e2  f898002c          LDRB     r0,[r8,#0x2c]         ;979
0010e6  f88d0002          STRB     r0,[sp,#2]            ;979
0010ea  f88d9003          STRB     r9,[sp,#3]            ;980
0010ee  4669              MOV      r1,sp                 ;981
0010f0  f1040008          ADD      r0,r4,#8              ;981
0010f4  f7fffffe          BL       lc640_write_long_ptr
0010f8  f8980028          LDRB     r0,[r8,#0x28]         ;983
0010fc  f88d0000          STRB     r0,[sp,#0]            ;983
001100  f8980024          LDRB     r0,[r8,#0x24]         ;984
001104  f88d0001          STRB     r0,[sp,#1]            ;984
001108  f8980020          LDRB     r0,[r8,#0x20]         ;985
00110c  f88d0002          STRB     r0,[sp,#2]            ;985
001110  f88d9003          STRB     r9,[sp,#3]            ;986
001114  4669              MOV      r1,sp                 ;987
001116  f104000c          ADD      r0,r4,#0xc            ;987
00111a  f7fffffe          BL       lc640_write_long_ptr
00111e  f04f0541          MOV      r5,#0x41              ;989
001122  f88d5000          STRB     r5,[sp,#0]            ;989
001126  f88d5001          STRB     r5,[sp,#1]            ;990
00112a  f88d5002          STRB     r5,[sp,#2]            ;991
00112e  f88d5003          STRB     r5,[sp,#3]            ;992
001132  4669              MOV      r1,sp                 ;993
001134  f1040010          ADD      r0,r4,#0x10           ;993
001138  f7fffffe          BL       lc640_write_long_ptr
00113c  f88d5000          STRB     r5,[sp,#0]            ;995
001140  f88d5001          STRB     r5,[sp,#1]            ;996
001144  f88d5002          STRB     r5,[sp,#2]            ;997
001148  f88d5003          STRB     r5,[sp,#3]            ;998
00114c  4669              MOV      r1,sp                 ;999
00114e  f1040014          ADD      r0,r4,#0x14           ;999
001152  e000              B        |L1.4438|
                  |L1.4436|
001154  e022              B        |L1.4508|
                  |L1.4438|
001156  f7fffffe          BL       lc640_write_long_ptr
00115a  f88d5000          STRB     r5,[sp,#0]            ;1001
00115e  f88d5001          STRB     r5,[sp,#1]            ;1002
001162  f88d5002          STRB     r5,[sp,#2]            ;1003
001166  f88d5003          STRB     r5,[sp,#3]            ;1004
00116a  4669              MOV      r1,sp                 ;1005
00116c  f1040018          ADD      r0,r4,#0x18           ;1005
001170  f7fffffe          BL       lc640_write_long_ptr
001174  f88d5000          STRB     r5,[sp,#0]            ;1007
001178  f88d5001          STRB     r5,[sp,#1]            ;1008
00117c  f88d5002          STRB     r5,[sp,#2]            ;1009
001180  f88d5003          STRB     r5,[sp,#3]            ;1010
001184  4669              MOV      r1,sp                 ;1011
001186  f104001c          ADD      r0,r4,#0x1c           ;1011
00118a  f7fffffe          BL       lc640_write_long_ptr
00118e  2301              MOVS     r3,#1                 ;1013
001190  461a              MOV      r2,r3                 ;1013
001192  2105              MOVS     r1,#5                 ;1013
001194  a097              ADR      r0,|L1.5108|
001196  f7fffffe          BL       snmp_trap_send
00119a  e08d              B        |L1.4792|
                  |L1.4508|
;;;1018   	{
;;;1019   	bat_ips._av&=~1;
00119c  f0210101          BIC      r1,r1,#1
0011a0  f880103d          STRB     r1,[r0,#0x3d]
;;;1020   	ips_bat_av_stat=0;
0011a4  f8849000          STRB     r9,[r4,#0]
;;;1021   	ips_bat_av_vzvod=0;
0011a8  f8839000          STRB     r9,[r3,#0]
;;;1022        
;;;1023   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0011ac  4628              MOV      r0,r5
0011ae  f7fffffe          BL       lc640_read_int
0011b2  b286              UXTH     r6,r0
;;;1024   	event_ptr_find=event_ptr;
0011b4  4634              MOV      r4,r6
                  |L1.4534|
;;;1025   	
;;;1026   avar_bat_ips_hndl_lbl1: 
;;;1027   
;;;1028   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0011b6  eb0a1044          ADD      r0,r10,r4,LSL #5
0011ba  b285              UXTH     r5,r0
;;;1029   
;;;1030        lc640_read_long_ptr(lc640_adr,data);
0011bc  4669              MOV      r1,sp
0011be  4628              MOV      r0,r5
0011c0  f7fffffe          BL       lc640_read_long_ptr
;;;1031        
;;;1032        if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
0011c4  f89d0000          LDRB     r0,[sp,#0]
0011c8  2842              CMP      r0,#0x42
0011ca  d106              BNE      |L1.4570|
0011cc  f89d0001          LDRB     r0,[sp,#1]
0011d0  b918              CBNZ     r0,|L1.4570|
0011d2  f89d0002          LDRB     r0,[sp,#2]
0011d6  2843              CMP      r0,#0x43
0011d8  d009              BEQ      |L1.4590|
                  |L1.4570|
;;;1033        	{        
;;;1034        	if(event_ptr_find)event_ptr_find--;
0011da  b11c              CBZ      r4,|L1.4580|
0011dc  f1a40401          SUB      r4,r4,#1
0011e0  b2a4              UXTH     r4,r4
0011e2  e001              B        |L1.4584|
                  |L1.4580|
;;;1035        	else event_ptr_find=63;
0011e4  f04f043f          MOV      r4,#0x3f
                  |L1.4584|
;;;1036        	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
0011e8  42b4              CMP      r4,r6
0011ea  d1e4              BNE      |L1.4534|
0011ec  e064              B        |L1.4792|
                  |L1.4590|
;;;1037        	else goto avar_bat_ips_hndl_lbl1;
;;;1038        	}
;;;1039        else 
;;;1040        	{
;;;1041        	lc640_read_long_ptr(lc640_adr+16,data);
0011ee  4669              MOV      r1,sp
0011f0  f1050010          ADD      r0,r5,#0x10
0011f4  f7fffffe          BL       lc640_read_long_ptr
;;;1042        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0011f8  f89d0000          LDRB     r0,[sp,#0]
0011fc  2841              CMP      r0,#0x41
0011fe  d10b              BNE      |L1.4632|
001200  f89d0001          LDRB     r0,[sp,#1]
001204  2841              CMP      r0,#0x41
001206  d107              BNE      |L1.4632|
001208  f89d0002          LDRB     r0,[sp,#2]
00120c  2841              CMP      r0,#0x41
00120e  d103              BNE      |L1.4632|
001210  f89d0003          LDRB     r0,[sp,#3]
001214  2841              CMP      r0,#0x41
001216  d009              BEQ      |L1.4652|
                  |L1.4632|
;;;1043        		{        
;;;1044        		if(event_ptr_find)event_ptr_find--;
001218  b11c              CBZ      r4,|L1.4642|
00121a  f1a40401          SUB      r4,r4,#1
00121e  b2a4              UXTH     r4,r4
001220  e001              B        |L1.4646|
                  |L1.4642|
;;;1045            		else event_ptr_find=63;
001222  f04f043f          MOV      r4,#0x3f
                  |L1.4646|
;;;1046            	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001226  42b4              CMP      r4,r6
001228  d1c5              BNE      |L1.4534|
00122a  e045              B        |L1.4792|
                  |L1.4652|
;;;1047        		else goto avar_bat_ips_hndl_lbl1;
;;;1048        		}
;;;1049   
;;;1050        	}
;;;1051        		
;;;1052   	data[0]=LPC_RTC->YEAR;
00122c  f8b8003c          LDRH     r0,[r8,#0x3c]
001230  f88d0000          STRB     r0,[sp,#0]
;;;1053   	data[1]=LPC_RTC->MONTH;
001234  f8980038          LDRB     r0,[r8,#0x38]
001238  f88d0001          STRB     r0,[sp,#1]
;;;1054   	data[2]=LPC_RTC->DOM;
00123c  f898002c          LDRB     r0,[r8,#0x2c]
001240  f88d0002          STRB     r0,[sp,#2]
;;;1055   	data[3]=0;
001244  f88d9003          STRB     r9,[sp,#3]
;;;1056   	lc640_write_long_ptr(lc640_adr+16,data);
001248  4669              MOV      r1,sp
00124a  f1050010          ADD      r0,r5,#0x10
00124e  f7fffffe          BL       lc640_write_long_ptr
;;;1057   
;;;1058   	data[0]=LPC_RTC->HOUR;
001252  f8980028          LDRB     r0,[r8,#0x28]
001256  f88d0000          STRB     r0,[sp,#0]
;;;1059   	data[1]=LPC_RTC->MIN;
00125a  f8980024          LDRB     r0,[r8,#0x24]
00125e  f88d0001          STRB     r0,[sp,#1]
;;;1060   	data[2]=LPC_RTC->SEC;
001262  f8980020          LDRB     r0,[r8,#0x20]
001266  f88d0002          STRB     r0,[sp,#2]
;;;1061   	data[3]=0;
00126a  f88d9003          STRB     r9,[sp,#3]
;;;1062   	lc640_write_long_ptr(lc640_adr+20,data);
00126e  4669              MOV      r1,sp
001270  f1050014          ADD      r0,r5,#0x14
001274  f7fffffe          BL       lc640_write_long_ptr
;;;1063   	
;;;1064   	data[0]='B';
001278  f88d7000          STRB     r7,[sp,#0]
;;;1065   	data[1]='B';
00127c  f88d7001          STRB     r7,[sp,#1]
;;;1066   	data[2]='B';
001280  f88d7002          STRB     r7,[sp,#2]
;;;1067   	data[3]='B';
001284  f88d7003          STRB     r7,[sp,#3]
;;;1068   	lc640_write_long_ptr(lc640_adr+24,data);
001288  4669              MOV      r1,sp
00128a  f1050018          ADD      r0,r5,#0x18
00128e  f7fffffe          BL       lc640_write_long_ptr
;;;1069   	
;;;1070   	data[0]='B';
001292  f88d7000          STRB     r7,[sp,#0]
;;;1071   	data[1]='B';
001296  f88d7001          STRB     r7,[sp,#1]
;;;1072   	data[2]='B';
00129a  f88d7002          STRB     r7,[sp,#2]
;;;1073   	data[3]='B';
00129e  f88d7003          STRB     r7,[sp,#3]
;;;1074   	lc640_write_long_ptr(lc640_adr+28,data);
0012a2  4669              MOV      r1,sp
0012a4  f105001c          ADD      r0,r5,#0x1c
0012a8  f7fffffe          BL       lc640_write_long_ptr
;;;1075   	
;;;1076   	snmp_trap_send("BAT #1 detected",5,1,0);
0012ac  2300              MOVS     r3,#0
0012ae  2201              MOVS     r2,#1
0012b0  2105              MOVS     r1,#5
0012b2  a055              ADR      r0,|L1.5128|
0012b4  f7fffffe          BL       snmp_trap_send
                  |L1.4792|
;;;1077   	
;;;1078   	}
;;;1079   	
;;;1080   avar_bat_ips_hndl_end:
;;;1081   __nop();		
0012b8  bf00              NOP      
                  |L1.4794|
;;;1082   }
0012ba  e56d              B        |L1.3480|
;;;1083   
                          ENDP

                  avar_bat_hndl PROC
;;;1086   //-----------------------------------------------
;;;1087   void avar_bat_hndl(char b, char in)
0012bc  4770              BX       lr
;;;1088   {
;;;1089   char data[4];
;;;1090   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1091   #ifndef UKU_220_IPS_TERMOKOMPENSAT	 //o_10
;;;1092   if(in==1)
;;;1093   	{
;;;1094   	bat[b]._av|=1;
;;;1095       
;;;1096   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1097   	event_ptr++;	
;;;1098   	if(event_ptr>63)event_ptr=0;	
;;;1099   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1100   	
;;;1101        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1102   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1103   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1104   	
;;;1105   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1106   	
;;;1107   	data[0]='B';
;;;1108   	data[1]=b;
;;;1109   	data[2]='C';
;;;1110   	data[3]=0;
;;;1111   	lc640_write_long_ptr(lc640_adr,data);
;;;1112   
;;;1113   	data[0]=0;
;;;1114   	data[1]=0;
;;;1115   	data[2]=0;
;;;1116   	data[3]=0;
;;;1117   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1118   
;;;1119   	data[0]=LPC_RTC->YEAR;
;;;1120   	data[1]=LPC_RTC->MONTH;
;;;1121   	data[2]=LPC_RTC->DOM;
;;;1122   	data[3]=0;
;;;1123   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1124   
;;;1125   	data[0]=LPC_RTC->HOUR;
;;;1126   	data[1]=LPC_RTC->MIN;
;;;1127   	data[2]=LPC_RTC->SEC;
;;;1128   	data[3]=0;
;;;1129   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1130   	
;;;1131   	data[0]='A';
;;;1132   	data[1]='A';
;;;1133   	data[2]='A';
;;;1134   	data[3]='A';
;;;1135   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1136   	
;;;1137   	data[0]='A';
;;;1138   	data[1]='A';
;;;1139   	data[2]='A';
;;;1140   	data[3]='A';
;;;1141   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1142   	
;;;1143   	data[0]='A';
;;;1144   	data[1]='A';
;;;1145   	data[2]='A';
;;;1146   	data[3]='A';
;;;1147   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1148   	
;;;1149   	data[0]='A';
;;;1150   	data[1]='A';
;;;1151   	data[2]='A';
;;;1152   	data[3]='A';
;;;1153   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1154   					
;;;1155   	if(b==0)
;;;1156   		{
;;;1157   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1158   		}
;;;1159   	else if(b==1)
;;;1160   		{
;;;1161   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1162   		} 
;;;1163   			
;;;1164   	}
;;;1165   
;;;1166   else if(in==0)
;;;1167   	{
;;;1168   	bat[b]._av&=~1;
;;;1169   
;;;1170        event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1171   	event_ptr_find=event_ptr;
;;;1172   	
;;;1173   avar_bat_hndl_lbl1: 
;;;1174   
;;;1175   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1176   
;;;1177        lc640_read_long_ptr(lc640_adr,data);
;;;1178        
;;;1179        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
;;;1180        	{        
;;;1181        	if(event_ptr_find)event_ptr_find--;
;;;1182        	else event_ptr_find=63;
;;;1183        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
;;;1184        	else goto avar_bat_hndl_lbl1;
;;;1185        	}
;;;1186        else 
;;;1187        	{
;;;1188        	lc640_read_long_ptr(lc640_adr+16,data);
;;;1189        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1190        		{        
;;;1191        		if(event_ptr_find)event_ptr_find--;
;;;1192            		else event_ptr_find=63;
;;;1193            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
;;;1194        		else goto avar_bat_hndl_lbl1;
;;;1195        		}
;;;1196   
;;;1197        	}
;;;1198        		
;;;1199   	data[0]=LPC_RTC->YEAR;
;;;1200   	data[1]=LPC_RTC->MONTH;
;;;1201   	data[2]=LPC_RTC->DOM;
;;;1202   	data[3]=0;
;;;1203   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1204   
;;;1205   	data[0]=LPC_RTC->HOUR;
;;;1206   	data[1]=LPC_RTC->MIN;
;;;1207   	data[2]=LPC_RTC->SEC;
;;;1208   	data[3]=0;
;;;1209   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1210   	
;;;1211   	data[0]='B';
;;;1212   	data[1]='B';
;;;1213   	data[2]='B';
;;;1214   	data[3]='B';
;;;1215   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1216   	
;;;1217   	data[0]='B';
;;;1218   	data[1]='B';
;;;1219   	data[2]='B';
;;;1220   	data[3]='B';
;;;1221   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1222   	
;;;1223   	if(b==0)
;;;1224   		{
;;;1225   		snmp_trap_send("BAT #1 detected",5,1,0);
;;;1226   		}
;;;1227   	else if(b==1)
;;;1228   		{
;;;1229   		snmp_trap_send("BAT #2 detected",5,2,0);
;;;1230   		}
;;;1231   	
;;;1232   	}
;;;1233   	
;;;1234   avar_bat_hndl_end:
;;;1235   __nop();
;;;1236   #endif    //o_10		
;;;1237   }
;;;1238   
                          ENDP

                  avar_bat_temper_hndl PROC
;;;1239   //-----------------------------------------------
;;;1240   void avar_bat_temper_hndl(char b, char in)
0012be  e92d4ff8          PUSH     {r3-r11,lr}
;;;1241   {
0012c2  4605              MOV      r5,r0
0012c4  460e              MOV      r6,r1
;;;1242   char data[4];
;;;1243   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1244   
;;;1245   if((in==1)||(in==3))
;;;1246   	{
;;;1247   	//bat[b]._av|=1;
;;;1248       
;;;1249   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1250   	event_ptr++;	
;;;1251   	if(event_ptr>63)event_ptr=0;	
;;;1252   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1253   	
;;;1254        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1255   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1256   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1257   	
;;;1258   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1259   	
;;;1260   	data[0]='B';
;;;1261   	data[1]=b;
;;;1262   	data[2]='T';
;;;1263   	data[3]='1';
;;;1264   	if(in==3)data[3]='3';
;;;1265   	lc640_write_long_ptr(lc640_adr,data);
;;;1266   
;;;1267   	data[0]=0;
;;;1268   	data[1]=0;
;;;1269   	data[2]=0;
;;;1270   	data[3]=0;
;;;1271   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1272   
;;;1273   	data[0]=LPC_RTC->YEAR;
0012c6  f8dfa128          LDR      r10,|L1.5104|
0012ca  f44f6060          MOV      r0,#0xe00             ;1249
0012ce  f44f6780          MOV      r7,#0x400             ;1258
0012d2  2e01              CMP      r6,#1                 ;1245
0012d4  d010              BEQ      |L1.4856|
0012d6  2e03              CMP      r6,#3                 ;1245
0012d8  d00e              BEQ      |L1.4856|
;;;1274   	data[1]=LPC_RTC->MONTH;
;;;1275   	data[2]=LPC_RTC->DOM;
;;;1276   	data[3]=0;
;;;1277   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1278   
;;;1279   	data[0]=LPC_RTC->HOUR;
;;;1280   	data[1]=LPC_RTC->MIN;
;;;1281   	data[2]=LPC_RTC->SEC;
;;;1282   	data[3]=0;
;;;1283   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1284   	
;;;1285   	data[0]='A';
;;;1286   	data[1]='A';
;;;1287   	data[2]='A';
;;;1288   	data[3]='A';
;;;1289   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1290   	
;;;1291   	data[0]='A';
;;;1292   	data[1]='A';
;;;1293   	data[2]='A';
;;;1294   	data[3]='A';
;;;1295   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1296   	
;;;1297   	data[0]='A';
;;;1298   	data[1]='A';
;;;1299   	data[2]='A';
;;;1300   	data[3]='A';
;;;1301   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1302   	
;;;1303   	data[0]='A';
;;;1304   	data[1]='A';
;;;1305   	data[2]='A';
;;;1306   	data[3]='A';
;;;1307   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1308   	if(in==1)
;;;1309   		{				
;;;1310   		if(b==0)
;;;1311   			{
;;;1312   			snmp_trap_send("BAT #1 Alarm, is heated",10,1,1);
;;;1313   			}
;;;1314   		else if(b==1)
;;;1315   			{
;;;1316   			snmp_trap_send("BAT #2 Alarm, is heated",10,2,1);
;;;1317   			} 
;;;1318   		}
;;;1319   	if(in==3)
;;;1320   		{				
;;;1321   		if(b==0)
;;;1322   			{
;;;1323   			snmp_trap_send("BAT #1 Alarm, is overheated",11,1,1);
;;;1324   			}
;;;1325   		else if(b==1)
;;;1326   			{
;;;1327   			snmp_trap_send("BAT #2 Alarm, is overheated",11,2,1);
;;;1328   			} 
;;;1329   		}			
;;;1330   	}
;;;1331   
;;;1332   else if((in==0)||(in==2))
0012da  b10e              CBZ      r6,|L1.4832|
0012dc  2e02              CMP      r6,#2
0012de  d17d              BNE      |L1.5084|
                  |L1.4832|
;;;1333   	{
;;;1334   	char i;
;;;1335   
;;;1336   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0012e0  f7fffffe          BL       lc640_read_int
0012e4  fa1ff980          UXTH     r9,r0
;;;1337   	event_ptr_find=event_ptr;
0012e8  464c              MOV      r4,r9
;;;1338   
;;;1339   /*	for (i=0;i<63;i++)
;;;1340   		{
;;;1341   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1342   
;;;1343        	lc640_read_long_ptr(lc640_adr,data);
;;;1344        
;;;1345        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;1346        		{        
;;;1347        		if(event_ptr_find)event_ptr_find--;
;;;1348        		else event_ptr_find=63;
;;;1349        		if(event_ptr_find==event_ptr)
;;;1350   				{
;;;1351   				lc640_adr=0;
;;;1352   				break;
;;;1353   				}
;;;1354        		else continue;
;;;1355        		}
;;;1356        	else 
;;;1357        		{
;;;1358        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1359        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1360        			{        
;;;1361        			if(event_ptr_find)event_ptr_find--;
;;;1362            		else event_ptr_find=63;
;;;1363            		if(event_ptr_find==event_ptr)
;;;1364   					{
;;;1365   					lc640_adr=0;
;;;1366   					break;
;;;1367   					}
;;;1368        			else continue;
;;;1369        			}
;;;1370        		}	
;;;1371   		}*/
;;;1372   	
;;;1373   	for (i=0;i<63;i++)
0012ea  f04f0800          MOV      r8,#0
                  |L1.4846|
;;;1374   		{
;;;1375   		char temp='1';
0012ee  f04f0b31          MOV      r11,#0x31
;;;1376   		if(in==2)temp='3';
0012f2  2e02              CMP      r6,#2
0012f4  d073              BEQ      |L1.5086|
0012f6  e0e3              B        |L1.5312|
                  |L1.4856|
0012f8  4680              MOV      r8,r0                 ;1249
0012fa  f7fffffe          BL       lc640_read_int
0012fe  f1000001          ADD      r0,r0,#1              ;1250
001302  b284              UXTH     r4,r0                 ;1250
001304  2c3f              CMP      r4,#0x3f              ;1251
001306  d901              BLS      |L1.4876|
001308  f04f0400          MOV      r4,#0                 ;1251
                  |L1.4876|
00130c  b221              SXTH     r1,r4                 ;1252
00130e  4640              MOV      r0,r8                 ;1252
001310  f7fffffe          BL       lc640_write_int
001314  f6406902          MOV      r9,#0xe02             ;1254
001318  4648              MOV      r0,r9                 ;1254
00131a  f7fffffe          BL       lc640_read_int
00131e  b280              UXTH     r0,r0                 ;1254
001320  283f              CMP      r0,#0x3f              ;1255
001322  d000              BEQ      |L1.4902|
001324  4620              MOV      r0,r4                 ;1255
                  |L1.4902|
001326  b201              SXTH     r1,r0                 ;1256
001328  4648              MOV      r0,r9                 ;1256
00132a  f7fffffe          BL       lc640_write_int
00132e  4640              MOV      r0,r8                 ;1258
001330  f7fffffe          BL       lc640_read_int
001334  eb071040          ADD      r0,r7,r0,LSL #5       ;1258
001338  b284              UXTH     r4,r0                 ;1258
00133a  f04f0042          MOV      r0,#0x42              ;1260
00133e  f88d0000          STRB     r0,[sp,#0]            ;1260
001342  f88d5001          STRB     r5,[sp,#1]            ;1261
001346  f04f0054          MOV      r0,#0x54              ;1262
00134a  f88d0002          STRB     r0,[sp,#2]            ;1262
00134e  f04f0031          MOV      r0,#0x31              ;1263
001352  f88d0003          STRB     r0,[sp,#3]            ;1263
001356  2e03              CMP      r6,#3                 ;1264
001358  d103              BNE      |L1.4962|
00135a  f04f0033          MOV      r0,#0x33              ;1264
00135e  f88d0003          STRB     r0,[sp,#3]            ;1264
                  |L1.4962|
001362  4669              MOV      r1,sp                 ;1265
001364  4620              MOV      r0,r4                 ;1265
001366  f7fffffe          BL       lc640_write_long_ptr
00136a  f04f0700          MOV      r7,#0                 ;1267
00136e  9700              STR      r7,[sp,#0]            ;1270
001370  4669              MOV      r1,sp                 ;1271
001372  f1040004          ADD      r0,r4,#4              ;1271
001376  f7fffffe          BL       lc640_write_long_ptr
00137a  f8ba003c          LDRH     r0,[r10,#0x3c]        ;1273
00137e  f88d0000          STRB     r0,[sp,#0]            ;1273
001382  f89a0038          LDRB     r0,[r10,#0x38]        ;1274
001386  f88d0001          STRB     r0,[sp,#1]            ;1274
00138a  f89a002c          LDRB     r0,[r10,#0x2c]        ;1275
00138e  f88d0002          STRB     r0,[sp,#2]            ;1275
001392  f88d7003          STRB     r7,[sp,#3]            ;1276
001396  4669              MOV      r1,sp                 ;1277
001398  f1040008          ADD      r0,r4,#8              ;1277
00139c  f7fffffe          BL       lc640_write_long_ptr
0013a0  f89a0028          LDRB     r0,[r10,#0x28]        ;1279
0013a4  f88d0000          STRB     r0,[sp,#0]            ;1279
0013a8  f89a0024          LDRB     r0,[r10,#0x24]        ;1280
0013ac  f88d0001          STRB     r0,[sp,#1]            ;1280
0013b0  f89a0020          LDRB     r0,[r10,#0x20]        ;1281
0013b4  f88d0002          STRB     r0,[sp,#2]            ;1281
0013b8  f88d7003          STRB     r7,[sp,#3]            ;1282
0013bc  4669              MOV      r1,sp                 ;1283
0013be  f104000c          ADD      r0,r4,#0xc            ;1283
0013c2  f7fffffe          BL       lc640_write_long_ptr
0013c6  f04f0741          MOV      r7,#0x41              ;1285
0013ca  f88d7000          STRB     r7,[sp,#0]            ;1285
0013ce  f88d7001          STRB     r7,[sp,#1]            ;1286
0013d2  f88d7002          STRB     r7,[sp,#2]            ;1287
0013d6  f88d7003          STRB     r7,[sp,#3]            ;1288
0013da  e01d              B        |L1.5144|
                  |L1.5084|
0013dc  e066              B        |L1.5292|
                  |L1.5086|
0013de  e06d              B        |L1.5308|
                  |L1.5088|
                          DCD      0x40024020
                  |L1.5092|
                          DCD      bat_ips
                  |L1.5096|
                          DCD      ips_bat_av_stat
                  |L1.5100|
                          DCD      ips_bat_av_vzvod
                  |L1.5104|
                          DCD      0x40024000
                  |L1.5108|
0013f4  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
0013f8  b9312041
0013fc  6c61726d
001400  2c206c6f
001404  737400  
001407  00                DCB      0
                  |L1.5128|
001408  42415420          DCB      "BAT #1 detected",0
00140c  23312064
001410  65746563
001414  74656400
                  |L1.5144|
001418  4669              MOV      r1,sp                 ;1289
00141a  f1040010          ADD      r0,r4,#0x10           ;1289
00141e  f7fffffe          BL       lc640_write_long_ptr
001422  f88d7000          STRB     r7,[sp,#0]            ;1291
001426  f88d7001          STRB     r7,[sp,#1]            ;1292
00142a  f88d7002          STRB     r7,[sp,#2]            ;1293
00142e  f88d7003          STRB     r7,[sp,#3]            ;1294
001432  4669              MOV      r1,sp                 ;1295
001434  f1040014          ADD      r0,r4,#0x14           ;1295
001438  f7fffffe          BL       lc640_write_long_ptr
00143c  f88d7000          STRB     r7,[sp,#0]            ;1297
001440  f88d7001          STRB     r7,[sp,#1]            ;1298
001444  f88d7002          STRB     r7,[sp,#2]            ;1299
001448  f88d7003          STRB     r7,[sp,#3]            ;1300
00144c  4669              MOV      r1,sp                 ;1301
00144e  f1040018          ADD      r0,r4,#0x18           ;1301
001452  f7fffffe          BL       lc640_write_long_ptr
001456  f88d7000          STRB     r7,[sp,#0]            ;1303
00145a  f88d7001          STRB     r7,[sp,#1]            ;1304
00145e  f88d7002          STRB     r7,[sp,#2]            ;1305
001462  f88d7003          STRB     r7,[sp,#3]            ;1306
001466  4669              MOV      r1,sp                 ;1307
001468  f104001c          ADD      r0,r4,#0x1c           ;1307
00146c  f7fffffe          BL       lc640_write_long_ptr
001470  2e01              CMP      r6,#1                 ;1308
001472  d110              BNE      |L1.5270|
001474  b115              CBZ      r5,|L1.5244|
001476  2d01              CMP      r5,#1                 ;1314
001478  d007              BEQ      |L1.5258|
00147a  e00c              B        |L1.5270|
                  |L1.5244|
00147c  2301              MOVS     r3,#1                 ;1312
00147e  461a              MOV      r2,r3                 ;1312
001480  210a              MOVS     r1,#0xa               ;1312
001482  a0f9              ADR      r0,|L1.6248|
001484  f7fffffe          BL       snmp_trap_send
001488  e005              B        |L1.5270|
                  |L1.5258|
00148a  2301              MOVS     r3,#1                 ;1316
00148c  2202              MOVS     r2,#2                 ;1316
00148e  210a              MOVS     r1,#0xa               ;1316
001490  a0fb              ADR      r0,|L1.6272|
001492  f7fffffe          BL       snmp_trap_send
                  |L1.5270|
001496  2e03              CMP      r6,#3                 ;1319
001498  d108              BNE      |L1.5292|
00149a  b145              CBZ      r5,|L1.5294|
00149c  2d01              CMP      r5,#1                 ;1325
00149e  d105              BNE      |L1.5292|
0014a0  2301              MOVS     r3,#1                 ;1327
0014a2  2202              MOVS     r2,#2                 ;1327
0014a4  210b              MOVS     r1,#0xb               ;1327
0014a6  a0fc              ADR      r0,|L1.6296|
0014a8  f7fffffe          BL       snmp_trap_send
                  |L1.5292|
;;;1377   
;;;1378   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1379   
;;;1380        	lc640_read_long_ptr(lc640_adr,data);
;;;1381        
;;;1382        	if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='T')&&(data[3]==temp)))
;;;1383        		{        
;;;1384        		if(event_ptr_find)event_ptr_find--;
;;;1385        		else event_ptr_find=63;
;;;1386        		if(event_ptr_find==event_ptr)				{
;;;1387   				lc640_adr=0;
;;;1388   				break;
;;;1389   				}
;;;1390        		else continue;
;;;1391        		}
;;;1392   	     else 
;;;1393   	     	{
;;;1394   	     	lc640_read_long_ptr(lc640_adr+16,data);
;;;1395   	     	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1396   	     		{        
;;;1397   	     		if(event_ptr_find)event_ptr_find--;
;;;1398   	         	else event_ptr_find=63;
;;;1399   	         	if(event_ptr_find==event_ptr)				{
;;;1400   					lc640_adr=0;
;;;1401   					break;
;;;1402   					}
;;;1403   	     		else continue;
;;;1404   	     		}
;;;1405   	
;;;1406   	     	}
;;;1407   		}
;;;1408        		
;;;1409   	data[0]=LPC_RTC->YEAR;
;;;1410   	data[1]=LPC_RTC->MONTH;
;;;1411   	data[2]=LPC_RTC->DOM;
;;;1412   	data[3]=0;
;;;1413   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1414   
;;;1415   	data[0]=LPC_RTC->HOUR;
;;;1416   	data[1]=LPC_RTC->MIN;
;;;1417   	data[2]=LPC_RTC->SEC;
;;;1418   	data[3]=0;
;;;1419   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1420   	
;;;1421   	data[0]='B';
;;;1422   	data[1]='B';
;;;1423   	data[2]='B';
;;;1424   	data[3]='B';
;;;1425   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1426   	
;;;1427   	data[0]='B';
;;;1428   	data[1]='B';
;;;1429   	data[2]='B';
;;;1430   	data[3]='B';
;;;1431   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1432   	
;;;1433   	if(in==0)
;;;1434   		{				
;;;1435   		if(b==0)
;;;1436   			{
;;;1437   			snmp_trap_send("BAT #1 Alarm, heating eliminated",10,1,0);
;;;1438   			}
;;;1439   		else if(b==1)
;;;1440   			{
;;;1441   			snmp_trap_send("BAT #2 Alarm, heating eliminated",10,2,0);
;;;1442   			} 
;;;1443   		}
;;;1444   	if(in==2)
;;;1445   		{				
;;;1446   		if(b==0)
;;;1447   			{
;;;1448   			snmp_trap_send("BAT #1 Alarm, overheating eliminated",11,1,0);
;;;1449   			}
;;;1450   		else if(b==1)
;;;1451   			{
;;;1452   			snmp_trap_send("BAT #2 Alarm, overheating eliminated",11,2,0);
;;;1453   			} 
;;;1454   		}		
;;;1455   	
;;;1456   	}
;;;1457   	
;;;1458   }
0014ac  e474              B        |L1.3480|
                  |L1.5294|
0014ae  2301              MOVS     r3,#1                 ;1323
0014b0  461a              MOV      r2,r3                 ;1323
0014b2  210b              MOVS     r1,#0xb               ;1323
0014b4  a0ff              ADR      r0,|L1.6324|
0014b6  f7fffffe          BL       snmp_trap_send
0014ba  e46d              B        |L1.3480|
                  |L1.5308|
0014bc  f04f0b33          MOV      r11,#0x33             ;1376
                  |L1.5312|
0014c0  f44f6080          MOV      r0,#0x400             ;1378
0014c4  eb001044          ADD      r0,r0,r4,LSL #5       ;1378
0014c8  b287              UXTH     r7,r0                 ;1378
0014ca  4669              MOV      r1,sp                 ;1380
0014cc  4638              MOV      r0,r7                 ;1380
0014ce  f7fffffe          BL       lc640_read_long_ptr
0014d2  f89d0000          LDRB     r0,[sp,#0]            ;1382
0014d6  2842              CMP      r0,#0x42              ;1382
0014d8  d10b              BNE      |L1.5362|
0014da  f89d0001          LDRB     r0,[sp,#1]            ;1382
0014de  42a8              CMP      r0,r5                 ;1382
0014e0  d107              BNE      |L1.5362|
0014e2  f89d0002          LDRB     r0,[sp,#2]            ;1382
0014e6  2854              CMP      r0,#0x54              ;1382
0014e8  d103              BNE      |L1.5362|
0014ea  f89d0003          LDRB     r0,[sp,#3]            ;1382
0014ee  4558              CMP      r0,r11                ;1382
0014f0  d00b              BEQ      |L1.5386|
                  |L1.5362|
0014f2  b11c              CBZ      r4,|L1.5372|
0014f4  f1a40401          SUB      r4,r4,#1              ;1384
0014f8  b2a4              UXTH     r4,r4                 ;1384
0014fa  e001              B        |L1.5376|
                  |L1.5372|
0014fc  f04f043f          MOV      r4,#0x3f              ;1385
                  |L1.5376|
001500  454c              CMP      r4,r9                 ;1386
001502  d123              BNE      |L1.5452|
001504  f04f0700          MOV      r7,#0                 ;1387
001508  e028              B        |L1.5468|
                  |L1.5386|
00150a  4669              MOV      r1,sp                 ;1394
00150c  f1070010          ADD      r0,r7,#0x10           ;1394
001510  f7fffffe          BL       lc640_read_long_ptr
001514  f89d0000          LDRB     r0,[sp,#0]            ;1395
001518  2841              CMP      r0,#0x41              ;1395
00151a  d10b              BNE      |L1.5428|
00151c  f89d0001          LDRB     r0,[sp,#1]            ;1395
001520  2841              CMP      r0,#0x41              ;1395
001522  d107              BNE      |L1.5428|
001524  f89d0002          LDRB     r0,[sp,#2]            ;1395
001528  2841              CMP      r0,#0x41              ;1395
00152a  d103              BNE      |L1.5428|
00152c  f89d0003          LDRB     r0,[sp,#3]            ;1395
001530  2841              CMP      r0,#0x41              ;1395
001532  d00b              BEQ      |L1.5452|
                  |L1.5428|
001534  b11c              CBZ      r4,|L1.5438|
001536  f1a40401          SUB      r4,r4,#1              ;1397
00153a  b2a4              UXTH     r4,r4                 ;1397
00153c  e001              B        |L1.5442|
                  |L1.5438|
00153e  f04f043f          MOV      r4,#0x3f              ;1398
                  |L1.5442|
001542  454c              CMP      r4,r9                 ;1399
001544  d102              BNE      |L1.5452|
001546  f04f0700          MOV      r7,#0                 ;1400
00154a  e007              B        |L1.5468|
                  |L1.5452|
00154c  f1080801          ADD      r8,r8,#1              ;1373
001550  f00808ff          AND      r8,r8,#0xff           ;1373
001554  f1b80f3f          CMP      r8,#0x3f              ;1373
001558  f4ffaec9          BCC      |L1.4846|
                  |L1.5468|
00155c  f8ba003c          LDRH     r0,[r10,#0x3c]        ;1409
001560  f88d0000          STRB     r0,[sp,#0]            ;1409
001564  f89a0038          LDRB     r0,[r10,#0x38]        ;1410
001568  f88d0001          STRB     r0,[sp,#1]            ;1410
00156c  f89a002c          LDRB     r0,[r10,#0x2c]        ;1411
001570  f88d0002          STRB     r0,[sp,#2]            ;1411
001574  f04f0400          MOV      r4,#0                 ;1412
001578  f88d4003          STRB     r4,[sp,#3]            ;1412
00157c  4669              MOV      r1,sp                 ;1413
00157e  f1070010          ADD      r0,r7,#0x10           ;1413
001582  f7fffffe          BL       lc640_write_long_ptr
001586  f89a0028          LDRB     r0,[r10,#0x28]        ;1415
00158a  f88d0000          STRB     r0,[sp,#0]            ;1415
00158e  f89a0024          LDRB     r0,[r10,#0x24]        ;1416
001592  f88d0001          STRB     r0,[sp,#1]            ;1416
001596  f89a0020          LDRB     r0,[r10,#0x20]        ;1417
00159a  f88d0002          STRB     r0,[sp,#2]            ;1417
00159e  f88d4003          STRB     r4,[sp,#3]            ;1418
0015a2  4669              MOV      r1,sp                 ;1419
0015a4  f1070014          ADD      r0,r7,#0x14           ;1419
0015a8  f7fffffe          BL       lc640_write_long_ptr
0015ac  f04f0442          MOV      r4,#0x42              ;1421
0015b0  f88d4000          STRB     r4,[sp,#0]            ;1421
0015b4  f88d4001          STRB     r4,[sp,#1]            ;1422
0015b8  f88d4002          STRB     r4,[sp,#2]            ;1423
0015bc  f88d4003          STRB     r4,[sp,#3]            ;1424
0015c0  4669              MOV      r1,sp                 ;1425
0015c2  f1070018          ADD      r0,r7,#0x18           ;1425
0015c6  f7fffffe          BL       lc640_write_long_ptr
0015ca  f88d4000          STRB     r4,[sp,#0]            ;1427
0015ce  f88d4001          STRB     r4,[sp,#1]            ;1428
0015d2  f88d4002          STRB     r4,[sp,#2]            ;1429
0015d6  f88d4003          STRB     r4,[sp,#3]            ;1430
0015da  4669              MOV      r1,sp                 ;1431
0015dc  f107001c          ADD      r0,r7,#0x1c           ;1431
0015e0  f7fffffe          BL       lc640_write_long_ptr
0015e4  b986              CBNZ     r6,|L1.5640|
0015e6  b115              CBZ      r5,|L1.5614|
0015e8  2d01              CMP      r5,#1                 ;1439
0015ea  d007              BEQ      |L1.5628|
0015ec  e00c              B        |L1.5640|
                  |L1.5614|
0015ee  2300              MOVS     r3,#0                 ;1437
0015f0  2201              MOVS     r2,#1                 ;1437
0015f2  210a              MOVS     r1,#0xa               ;1437
0015f4  a0b6              ADR      r0,|L1.6352|
0015f6  f7fffffe          BL       snmp_trap_send
0015fa  e005              B        |L1.5640|
                  |L1.5628|
0015fc  2300              MOVS     r3,#0                 ;1441
0015fe  2202              MOVS     r2,#2                 ;1441
001600  210a              MOVS     r1,#0xa               ;1441
001602  a0bc              ADR      r0,|L1.6388|
001604  f7fffffe          BL       snmp_trap_send
                  |L1.5640|
001608  2e02              CMP      r6,#2                 ;1444
                  |L1.5642|
00160a  f47faf4f          BNE      |L1.5292|
00160e  b145              CBZ      r5,|L1.5666|
001610  2d01              CMP      r5,#1                 ;1450
001612  d1fa              BNE      |L1.5642|
001614  2300              MOVS     r3,#0                 ;1452
001616  2202              MOVS     r2,#2                 ;1452
001618  210b              MOVS     r1,#0xb               ;1452
00161a  a0bf              ADR      r0,|L1.6424|
00161c  f7fffffe          BL       snmp_trap_send
                  |L1.5664|
001620  e64b              B        |L1.4794|
                  |L1.5666|
001622  2300              MOVS     r3,#0                 ;1448
001624  2201              MOVS     r2,#1                 ;1448
001626  210b              MOVS     r1,#0xb               ;1448
001628  a0c5              ADR      r0,|L1.6464|
00162a  f7fffffe          BL       snmp_trap_send
00162e  e644              B        |L1.4794|
;;;1459   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1460   //-----------------------------------------------
;;;1461   void avar_bat_as_hndl(char b, char in)
001630  e92d4ff8          PUSH     {r3-r11,lr}
;;;1462   {
001634  4605              MOV      r5,r0
;;;1463   char data[4];
;;;1464   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1465   
;;;1466   if(in==1)
;;;1467   	{
;;;1468   	bat[b]._av|=2;
001636  48cc              LDR      r0,|L1.6504|
001638  eb050245          ADD      r2,r5,r5,LSL #1
;;;1469       
;;;1470   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1471   	event_ptr++;	
;;;1472   	if(event_ptr>63)event_ptr=0;	
;;;1473   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1474   	
;;;1475        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1476   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1477   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1478   	
;;;1479   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1480   	
;;;1481   	data[0]='B';
;;;1482   	data[1]=b;
;;;1483   	data[2]='S';
;;;1484   	data[3]=0;
;;;1485   	lc640_write_long_ptr(lc640_adr,data);
;;;1486   
;;;1487   	data[0]=0;
;;;1488   	data[1]=0;
;;;1489   	data[2]=0;
;;;1490   	data[3]=0;
;;;1491   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1492   
;;;1493   	data[0]=LPC_RTC->YEAR;
00163c  f8df832c          LDR      r8,|L1.6508|
001640  eb021205          ADD      r2,r2,r5,LSL #4       ;1468
001644  f04f0a00          MOV      r10,#0                ;1472
001648  f04f0942          MOV      r9,#0x42              ;1481
00164c  f44f6660          MOV      r6,#0xe00             ;1470
001650  f44f6b80          MOV      r11,#0x400            ;1479
001654  eb000082          ADD      r0,r0,r2,LSL #2       ;1468
001658  2901              CMP      r1,#1                 ;1466
00165a  d002              BEQ      |L1.5730|
;;;1494   	data[1]=LPC_RTC->MONTH;
;;;1495   	data[2]=LPC_RTC->DOM;
;;;1496   	data[3]=0;
;;;1497   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1498   
;;;1499   	data[0]=LPC_RTC->HOUR;
;;;1500   	data[1]=LPC_RTC->MIN;
;;;1501   	data[2]=LPC_RTC->SEC;
;;;1502   	data[3]=0;
;;;1503   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1504   	
;;;1505   	data[0]='A';
;;;1506   	data[1]='A';
;;;1507   	data[2]='A';
;;;1508   	data[3]='A';
;;;1509   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1510   	
;;;1511   	data[0]='A';
;;;1512   	data[1]='A';
;;;1513   	data[2]='A';
;;;1514   	data[3]='A';
;;;1515   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1516   	
;;;1517   	data[0]='A';
;;;1518   	data[1]='A';
;;;1519   	data[2]='A';
;;;1520   	data[3]='A';
;;;1521   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1522   	
;;;1523   	data[0]='A';
;;;1524   	data[1]='A';
;;;1525   	data[2]='A';
;;;1526   	data[3]='A';
;;;1527   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1528   
;;;1529   	if(b==0)
;;;1530   		{
;;;1531   		snmp_trap_send("BAT #1 Alarm, asymmetry",5,1,2);
;;;1532   		}
;;;1533   	else if(b==1)
;;;1534   		{
;;;1535   		snmp_trap_send("BAT #2 Alarm, asymmetry",5,2,2);
;;;1536   		} 
;;;1537   	
;;;1538   	}
;;;1539   
;;;1540   else if(in==0)
00165c  2900              CMP      r1,#0
00165e  d07d              BEQ      |L1.5980|
001660  e1de              B        |L1.6688|
                  |L1.5730|
001662  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1468
001666  f0410102          ORR      r1,r1,#2              ;1468
00166a  7001              STRB     r1,[r0,#0]            ;1468
00166c  4630              MOV      r0,r6                 ;1470
00166e  f7fffffe          BL       lc640_read_int
001672  f1000001          ADD      r0,r0,#1              ;1471
001676  b284              UXTH     r4,r0                 ;1471
001678  2c3f              CMP      r4,#0x3f              ;1472
00167a  d901              BLS      |L1.5760|
00167c  f04f0400          MOV      r4,#0                 ;1472
                  |L1.5760|
001680  b221              SXTH     r1,r4                 ;1473
001682  4630              MOV      r0,r6                 ;1473
001684  f7fffffe          BL       lc640_write_int
001688  f6406702          MOV      r7,#0xe02             ;1475
00168c  4638              MOV      r0,r7                 ;1475
00168e  f7fffffe          BL       lc640_read_int
001692  b280              UXTH     r0,r0                 ;1475
001694  283f              CMP      r0,#0x3f              ;1476
001696  d000              BEQ      |L1.5786|
001698  4620              MOV      r0,r4                 ;1476
                  |L1.5786|
00169a  b201              SXTH     r1,r0                 ;1477
00169c  4638              MOV      r0,r7                 ;1477
00169e  f7fffffe          BL       lc640_write_int
0016a2  4630              MOV      r0,r6                 ;1479
0016a4  f7fffffe          BL       lc640_read_int
0016a8  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1479
0016ac  b284              UXTH     r4,r0                 ;1479
0016ae  f88d9000          STRB     r9,[sp,#0]            ;1481
0016b2  f88d5001          STRB     r5,[sp,#1]            ;1482
0016b6  f04f0053          MOV      r0,#0x53              ;1483
0016ba  f88d0002          STRB     r0,[sp,#2]            ;1483
0016be  f88da003          STRB     r10,[sp,#3]           ;1484
0016c2  4669              MOV      r1,sp                 ;1485
0016c4  4620              MOV      r0,r4                 ;1485
0016c6  f7fffffe          BL       lc640_write_long_ptr
0016ca  f8cda000          STR      r10,[sp,#0]           ;1490
0016ce  4669              MOV      r1,sp                 ;1491
0016d0  1d20              ADDS     r0,r4,#4              ;1491
0016d2  f7fffffe          BL       lc640_write_long_ptr
0016d6  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1493
0016da  f88d0000          STRB     r0,[sp,#0]            ;1493
0016de  f8980038          LDRB     r0,[r8,#0x38]         ;1494
0016e2  f88d0001          STRB     r0,[sp,#1]            ;1494
0016e6  f898002c          LDRB     r0,[r8,#0x2c]         ;1495
0016ea  f88d0002          STRB     r0,[sp,#2]            ;1495
0016ee  f88da003          STRB     r10,[sp,#3]           ;1496
0016f2  4669              MOV      r1,sp                 ;1497
0016f4  f1040008          ADD      r0,r4,#8              ;1497
0016f8  f7fffffe          BL       lc640_write_long_ptr
0016fc  f8980028          LDRB     r0,[r8,#0x28]         ;1499
001700  f88d0000          STRB     r0,[sp,#0]            ;1499
001704  f8980024          LDRB     r0,[r8,#0x24]         ;1500
001708  f88d0001          STRB     r0,[sp,#1]            ;1500
00170c  f8980020          LDRB     r0,[r8,#0x20]         ;1501
001710  f88d0002          STRB     r0,[sp,#2]            ;1501
001714  f88da003          STRB     r10,[sp,#3]           ;1502
001718  4669              MOV      r1,sp                 ;1503
00171a  f104000c          ADD      r0,r4,#0xc            ;1503
00171e  f7fffffe          BL       lc640_write_long_ptr
001722  f04f0641          MOV      r6,#0x41              ;1505
001726  f88d6000          STRB     r6,[sp,#0]            ;1505
00172a  f88d6001          STRB     r6,[sp,#1]            ;1506
00172e  f88d6002          STRB     r6,[sp,#2]            ;1507
001732  f88d6003          STRB     r6,[sp,#3]            ;1508
001736  4669              MOV      r1,sp                 ;1509
001738  f1040010          ADD      r0,r4,#0x10           ;1509
00173c  f7fffffe          BL       lc640_write_long_ptr
001740  f88d6000          STRB     r6,[sp,#0]            ;1511
001744  f88d6001          STRB     r6,[sp,#1]            ;1512
001748  f88d6002          STRB     r6,[sp,#2]            ;1513
00174c  f88d6003          STRB     r6,[sp,#3]            ;1514
001750  4669              MOV      r1,sp                 ;1515
001752  f1040014          ADD      r0,r4,#0x14           ;1515
001756  f7fffffe          BL       lc640_write_long_ptr
00175a  e000              B        |L1.5982|
                  |L1.5980|
00175c  e02b              B        |L1.6070|
                  |L1.5982|
00175e  f88d6000          STRB     r6,[sp,#0]            ;1517
001762  f88d6001          STRB     r6,[sp,#1]            ;1518
001766  f88d6002          STRB     r6,[sp,#2]            ;1519
00176a  f88d6003          STRB     r6,[sp,#3]            ;1520
00176e  4669              MOV      r1,sp                 ;1521
001770  f1040018          ADD      r0,r4,#0x18           ;1521
001774  f7fffffe          BL       lc640_write_long_ptr
001778  f88d6000          STRB     r6,[sp,#0]            ;1523
00177c  f88d6001          STRB     r6,[sp,#1]            ;1524
001780  f88d6002          STRB     r6,[sp,#2]            ;1525
001784  f88d6003          STRB     r6,[sp,#3]            ;1526
001788  4669              MOV      r1,sp                 ;1527
00178a  f104001c          ADD      r0,r4,#0x1c           ;1527
00178e  f7fffffe          BL       lc640_write_long_ptr
001792  b115              CBZ      r5,|L1.6042|
001794  2d01              CMP      r5,#1                 ;1533
001796  d007              BEQ      |L1.6056|
001798  e142              B        |L1.6688|
                  |L1.6042|
00179a  2302              MOVS     r3,#2                 ;1531
00179c  2201              MOVS     r2,#1                 ;1531
00179e  2105              MOVS     r1,#5                 ;1531
0017a0  a073              ADR      r0,|L1.6512|
0017a2  f7fffffe          BL       snmp_trap_send
0017a6  e13b              B        |L1.6688|
                  |L1.6056|
0017a8  2302              MOVS     r3,#2                 ;1535
0017aa  461a              MOV      r2,r3                 ;1535
0017ac  2105              MOVS     r1,#5                 ;1535
0017ae  a076              ADR      r0,|L1.6536|
0017b0  f7fffffe          BL       snmp_trap_send
0017b4  e134              B        |L1.6688|
                  |L1.6070|
;;;1541   	{
;;;1542   	bat[b]._av&=~(1<<1);
0017b6  f8101f3d          LDRB     r1,[r0,#0x3d]!
0017ba  f0210102          BIC      r1,r1,#2
0017be  7001              STRB     r1,[r0,#0]
;;;1543   
;;;1544        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0017c0  4630              MOV      r0,r6
0017c2  f7fffffe          BL       lc640_read_int
0017c6  b287              UXTH     r7,r0
;;;1545   	event_ptr_find=event_ptr;
0017c8  463c              MOV      r4,r7
                  |L1.6090|
;;;1546   	
;;;1547   avar_bat_as_hndl_lbl1: 
;;;1548   
;;;1549   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0017ca  eb0b1044          ADD      r0,r11,r4,LSL #5
0017ce  b286              UXTH     r6,r0
;;;1550   
;;;1551        lc640_read_long_ptr(lc640_adr,data);
0017d0  4669              MOV      r1,sp
0017d2  4630              MOV      r0,r6
0017d4  f7fffffe          BL       lc640_read_long_ptr
;;;1552        
;;;1553        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
0017d8  f89d0000          LDRB     r0,[sp,#0]
0017dc  2842              CMP      r0,#0x42
0017de  d107              BNE      |L1.6128|
0017e0  f89d0001          LDRB     r0,[sp,#1]
0017e4  42a8              CMP      r0,r5
0017e6  d103              BNE      |L1.6128|
0017e8  f89d0002          LDRB     r0,[sp,#2]
0017ec  2843              CMP      r0,#0x43
0017ee  d009              BEQ      |L1.6148|
                  |L1.6128|
;;;1554        	{        
;;;1555        	if(event_ptr_find)event_ptr_find--;
0017f0  b11c              CBZ      r4,|L1.6138|
0017f2  f1a40401          SUB      r4,r4,#1
0017f6  b2a4              UXTH     r4,r4
0017f8  e001              B        |L1.6142|
                  |L1.6138|
;;;1556        	else event_ptr_find=63;
0017fa  f04f043f          MOV      r4,#0x3f
                  |L1.6142|
;;;1557        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
0017fe  42bc              CMP      r4,r7
001800  d1e3              BNE      |L1.6090|
001802  e10d              B        |L1.6688|
                  |L1.6148|
;;;1558        	else goto avar_bat_as_hndl_lbl1;
;;;1559        	}
;;;1560        else 
;;;1561        	{
;;;1562        	lc640_read_long_ptr(lc640_adr+16,data);
001804  4669              MOV      r1,sp
001806  f1060010          ADD      r0,r6,#0x10
00180a  f7fffffe          BL       lc640_read_long_ptr
;;;1563        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00180e  f89d0000          LDRB     r0,[sp,#0]
001812  2841              CMP      r0,#0x41
001814  d10b              BNE      |L1.6190|
001816  f89d0001          LDRB     r0,[sp,#1]
00181a  2841              CMP      r0,#0x41
00181c  d107              BNE      |L1.6190|
00181e  f89d0002          LDRB     r0,[sp,#2]
001822  2841              CMP      r0,#0x41
001824  d103              BNE      |L1.6190|
001826  f89d0003          LDRB     r0,[sp,#3]
00182a  2841              CMP      r0,#0x41
00182c  d009              BEQ      |L1.6210|
                  |L1.6190|
;;;1564        		{        
;;;1565        		if(event_ptr_find)event_ptr_find--;
00182e  b11c              CBZ      r4,|L1.6200|
001830  f1a40401          SUB      r4,r4,#1
001834  b2a4              UXTH     r4,r4
001836  e001              B        |L1.6204|
                  |L1.6200|
;;;1566            		else event_ptr_find=63;
001838  f04f043f          MOV      r4,#0x3f
                  |L1.6204|
;;;1567            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
00183c  42bc              CMP      r4,r7
00183e  d1c4              BNE      |L1.6090|
001840  e0ee              B        |L1.6688|
                  |L1.6210|
;;;1568        		else goto avar_bat_as_hndl_lbl1;
;;;1569        		}
;;;1570   
;;;1571        	}
;;;1572        		
;;;1573   	data[0]=LPC_RTC->YEAR;
001842  f8b8003c          LDRH     r0,[r8,#0x3c]
001846  f88d0000          STRB     r0,[sp,#0]
;;;1574   	data[1]=LPC_RTC->MONTH;
00184a  f8980038          LDRB     r0,[r8,#0x38]
00184e  f88d0001          STRB     r0,[sp,#1]
;;;1575   	data[2]=LPC_RTC->DOM;
001852  f898002c          LDRB     r0,[r8,#0x2c]
001856  f88d0002          STRB     r0,[sp,#2]
;;;1576   	data[3]=0;
00185a  f88da003          STRB     r10,[sp,#3]
;;;1577   	lc640_write_long_ptr(lc640_adr+16,data);
00185e  4669              MOV      r1,sp
001860  f1060010          ADD      r0,r6,#0x10
001864  e09c              B        |L1.6560|
001866  0000              DCW      0x0000
                  |L1.6248|
001868  42415420          DCB      "BAT #1 Alarm, is heated",0
00186c  23312041
001870  6c61726d
001874  2c206973
001878  20686561
00187c  74656400
                  |L1.6272|
001880  42415420          DCB      "BAT #2 Alarm, is heated",0
001884  23322041
001888  6c61726d
00188c  2c206973
001890  20686561
001894  74656400
                  |L1.6296|
001898  42415420          DCB      "BAT #2 Alarm, is overheated",0
00189c  23322041
0018a0  6c61726d
0018a4  2c206973
0018a8  206f7665
0018ac  72686561
0018b0  74656400
                  |L1.6324|
0018b4  42415420          DCB      "BAT #1 Alarm, is overheated",0
0018b8  23312041
0018bc  6c61726d
0018c0  2c206973
0018c4  206f7665
0018c8  72686561
0018cc  74656400
                  |L1.6352|
0018d0  42415420          DCB      "BAT #1 Alarm, heating eliminated",0
0018d4  23312041
0018d8  6c61726d
0018dc  2c206865
0018e0  6174696e
0018e4  6720656c
0018e8  696d696e
0018ec  61746564
0018f0  00      
0018f1  00                DCB      0
0018f2  00                DCB      0
0018f3  00                DCB      0
                  |L1.6388|
0018f4  42415420          DCB      "BAT #2 Alarm, heating eliminated",0
0018f8  23322041
0018fc  6c61726d
001900  2c206865
001904  6174696e
001908  6720656c
00190c  696d696e
001910  61746564
001914  00      
001915  00                DCB      0
001916  00                DCB      0
001917  00                DCB      0
                  |L1.6424|
001918  42415420          DCB      "BAT #2 Alarm, overheating eliminated",0
00191c  23322041
001920  6c61726d
001924  2c206f76
001928  65726865
00192c  6174696e
001930  6720656c
001934  696d696e
001938  61746564
00193c  00      
00193d  00                DCB      0
00193e  00                DCB      0
00193f  00                DCB      0
                  |L1.6464|
001940  42415420          DCB      "BAT #1 Alarm, overheating eliminated",0
001944  23312041
001948  6c61726d
00194c  2c206f76
001950  65726865
001954  6174696e
001958  6720656c
00195c  696d696e
001960  61746564
001964  00      
001965  00                DCB      0
001966  00                DCB      0
001967  00                DCB      0
                  |L1.6504|
                          DCD      bat
                  |L1.6508|
                          DCD      0x40024000
                  |L1.6512|
001970  42415420          DCB      "BAT #1 Alarm, asymmetry",0
001974  23312041
001978  6c61726d
00197c  2c206173
001980  796d6d65
001984  74727900
                  |L1.6536|
001988  42415420          DCB      "BAT #2 Alarm, asymmetry",0
00198c  23322041
001990  6c61726d
001994  2c206173
001998  796d6d65
00199c  74727900
                  |L1.6560|
0019a0  f7fffffe          BL       lc640_write_long_ptr
;;;1578   
;;;1579   	data[0]=LPC_RTC->HOUR;
0019a4  f8980028          LDRB     r0,[r8,#0x28]
0019a8  f88d0000          STRB     r0,[sp,#0]
;;;1580   	data[1]=LPC_RTC->MIN;
0019ac  f8980024          LDRB     r0,[r8,#0x24]
0019b0  f88d0001          STRB     r0,[sp,#1]
;;;1581   	data[2]=LPC_RTC->SEC;
0019b4  f8980020          LDRB     r0,[r8,#0x20]
0019b8  f88d0002          STRB     r0,[sp,#2]
;;;1582   	data[3]=0;
0019bc  f88da003          STRB     r10,[sp,#3]
;;;1583   	lc640_write_long_ptr(lc640_adr+20,data);
0019c0  4669              MOV      r1,sp
0019c2  f1060014          ADD      r0,r6,#0x14
0019c6  f7fffffe          BL       lc640_write_long_ptr
;;;1584   	
;;;1585   	data[0]='B';
0019ca  f88d9000          STRB     r9,[sp,#0]
;;;1586   	data[1]='B';
0019ce  f88d9001          STRB     r9,[sp,#1]
;;;1587   	data[2]='B';
0019d2  f88d9002          STRB     r9,[sp,#2]
;;;1588   	data[3]='B';
0019d6  f88d9003          STRB     r9,[sp,#3]
;;;1589   	lc640_write_long_ptr(lc640_adr+24,data);
0019da  4669              MOV      r1,sp
0019dc  f1060018          ADD      r0,r6,#0x18
0019e0  f7fffffe          BL       lc640_write_long_ptr
;;;1590   	
;;;1591   	data[0]='B';
0019e4  f88d9000          STRB     r9,[sp,#0]
;;;1592   	data[1]='B';
0019e8  f88d9001          STRB     r9,[sp,#1]
;;;1593   	data[2]='B';
0019ec  f88d9002          STRB     r9,[sp,#2]
;;;1594   	data[3]='B';
0019f0  f88d9003          STRB     r9,[sp,#3]
;;;1595   	lc640_write_long_ptr(lc640_adr+28,data);
0019f4  4669              MOV      r1,sp
0019f6  f106001c          ADD      r0,r6,#0x1c
0019fa  f7fffffe          BL       lc640_write_long_ptr
;;;1596   	
;;;1597   	if(b==0)
0019fe  b115              CBZ      r5,|L1.6662|
;;;1598   		{
;;;1599   		snmp_trap_send("BAT #1 Asymmetry alarm clear",5,1,0);
;;;1600   		}
;;;1601   	else if(b==1)
001a00  2d01              CMP      r5,#1
001a02  d007              BEQ      |L1.6676|
001a04  e00c              B        |L1.6688|
                  |L1.6662|
001a06  2300              MOVS     r3,#0                 ;1599
001a08  2201              MOVS     r2,#1                 ;1599
001a0a  2105              MOVS     r1,#5                 ;1599
001a0c  a0f8              ADR      r0,|L1.7664|
001a0e  f7fffffe          BL       snmp_trap_send
001a12  e005              B        |L1.6688|
                  |L1.6676|
;;;1602   		{
;;;1603   		snmp_trap_send("BAT #2 Asymmetry alarm clear",5,2,0);
001a14  2300              MOVS     r3,#0
001a16  2202              MOVS     r2,#2
001a18  2105              MOVS     r1,#5
001a1a  a0fd              ADR      r0,|L1.7696|
001a1c  f7fffffe          BL       snmp_trap_send
                  |L1.6688|
;;;1604   		}
;;;1605   	
;;;1606   	}
;;;1607   	
;;;1608   avar_bat_as_hndl_end:
;;;1609   __nop();		
001a20  bf00              NOP      
                  |L1.6690|
;;;1610   }
001a22  e44a              B        |L1.4794|
;;;1611   
                          ENDP

                  ke_zvu_mem_hndl PROC
;;;1612   //-----------------------------------------------
;;;1613   void ke_zvu_mem_hndl(char b,unsigned short in,unsigned short in1)
001a24  b5f7              PUSH     {r0-r2,r4-r7,lr}
;;;1614   {
001a26  b082              SUB      sp,sp,#8
001a28  4605              MOV      r5,r0
;;;1615   char data[4];
;;;1616   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1617   //unsigned char temp,temp_;
;;;1618   //unsigned int tempUI;
;;;1619   //unsigned long tempUL; 
;;;1620   signed temp_temp;
;;;1621   
;;;1622   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
001a2a  eb050045          ADD      r0,r5,r5,LSL #1
001a2e  eb001005          ADD      r0,r0,r5,LSL #4
001a32  49ff              LDR      r1,|L1.7728|
001a34  eb010180          ADD      r1,r1,r0,LSL #2
001a38  48fe              LDR      r0,|L1.7732|
001a3a  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
001a3e  f1000001          ADD      r0,r0,#1
001a42  eb010040          ADD      r0,r1,r0,LSL #1
001a46  f9b00020          LDRSH    r0,[r0,#0x20]
001a4a  9000              STR      r0,[sp,#0]
;;;1623   
;;;1624   event_ptr=lc640_read_int(PTR_EVENT_LOG);
001a4c  f44f6660          MOV      r6,#0xe00
001a50  4630              MOV      r0,r6
001a52  f7fffffe          BL       lc640_read_int
;;;1625   event_ptr++;	
001a56  f1000001          ADD      r0,r0,#1
001a5a  4604              MOV      r4,r0
;;;1626   if(event_ptr>63)event_ptr=0;	
001a5c  2c3f              CMP      r4,#0x3f
001a5e  d901              BLS      |L1.6756|
001a60  f04f0400          MOV      r4,#0
                  |L1.6756|
;;;1627   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
001a64  b221              SXTH     r1,r4
001a66  4630              MOV      r0,r6
001a68  f7fffffe          BL       lc640_write_int
;;;1628   	
;;;1629   event_cnt=lc640_read_int(CNT_EVENT_LOG);
001a6c  f6406702          MOV      r7,#0xe02
001a70  4638              MOV      r0,r7
001a72  f7fffffe          BL       lc640_read_int
;;;1630   if(event_cnt!=63)event_cnt=event_ptr;
001a76  283f              CMP      r0,#0x3f
001a78  d000              BEQ      |L1.6780|
001a7a  4620              MOV      r0,r4
                  |L1.6780|
;;;1631   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
001a7c  b201              SXTH     r1,r0
001a7e  4638              MOV      r0,r7
001a80  f7fffffe          BL       lc640_write_int
;;;1632   	
;;;1633   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
001a84  4630              MOV      r0,r6
001a86  f7fffffe          BL       lc640_read_int
001a8a  f44f6180          MOV      r1,#0x400
001a8e  eb011440          ADD      r4,r1,r0,LSL #5
;;;1634   	
;;;1635   data[0]='B';
001a92  f04f0042          MOV      r0,#0x42
001a96  f88d0004          STRB     r0,[sp,#4]
;;;1636   data[1]=b; 
001a9a  f88d5005          STRB     r5,[sp,#5]
;;;1637   data[2]='K';
001a9e  f04f004b          MOV      r0,#0x4b
001aa2  f88d0006          STRB     r0,[sp,#6]
;;;1638   data[3]='Z';
001aa6  f04f005a          MOV      r0,#0x5a
001aaa  f88d0007          STRB     r0,[sp,#7]
;;;1639   
;;;1640   lc640_write_long_ptr(lc640_adr,data);
001aae  a901              ADD      r1,sp,#4
001ab0  4620              MOV      r0,r4
001ab2  f7fffffe          BL       lc640_write_long_ptr
;;;1641   
;;;1642   data[0]=*((char*)&in);
001ab6  f89d000c          LDRB     r0,[sp,#0xc]
001aba  f88d0004          STRB     r0,[sp,#4]
;;;1643   data[1]=*(((char*)(&in))+1);
001abe  f89d000d          LDRB     r0,[sp,#0xd]
001ac2  f88d0005          STRB     r0,[sp,#5]
;;;1644   data[2]=*((char*)&temp_temp);
001ac6  f89d0000          LDRB     r0,[sp,#0]
001aca  f88d0006          STRB     r0,[sp,#6]
;;;1645   data[3]=*(((char*)(&temp_temp))+1);
001ace  f89d0001          LDRB     r0,[sp,#1]
001ad2  f88d0007          STRB     r0,[sp,#7]
;;;1646   lc640_write_long_ptr(lc640_adr+4,data);
001ad6  a901              ADD      r1,sp,#4
001ad8  1d20              ADDS     r0,r4,#4
001ada  f7fffffe          BL       lc640_write_long_ptr
;;;1647   
;;;1648   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
001ade  f24020a2          MOV      r0,#0x2a2
001ae2  f7fffffe          BL       lc640_read_long
001ae6  4dd4              LDR      r5,|L1.7736|
001ae8  6028              STR      r0,[r5,#0]  ; ke_date
;;;1649   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
001aea  4629              MOV      r1,r5
001aec  f1040008          ADD      r0,r4,#8
001af0  f7fffffe          BL       lc640_write_long_ptr
;;;1650   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
001af4  f24020a6          MOV      r0,#0x2a6
001af8  f7fffffe          BL       lc640_read_long
001afc  6068              STR      r0,[r5,#4]  ; ke_date
;;;1651   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
001afe  1d29              ADDS     r1,r5,#4
001b00  f104000c          ADD      r0,r4,#0xc
001b04  f7fffffe          BL       lc640_write_long_ptr
;;;1652   
;;;1653   data[0]=LPC_RTC->YEAR;
001b08  4dcc              LDR      r5,|L1.7740|
001b0a  8ba8              LDRH     r0,[r5,#0x1c]
001b0c  f88d0004          STRB     r0,[sp,#4]
;;;1654   data[1]=LPC_RTC->MONTH;
001b10  7e28              LDRB     r0,[r5,#0x18]
001b12  f88d0005          STRB     r0,[sp,#5]
;;;1655   data[2]=LPC_RTC->DOM;
001b16  7b28              LDRB     r0,[r5,#0xc]
001b18  f88d0006          STRB     r0,[sp,#6]
;;;1656   data[3]=*((char*)&in1);
001b1c  f89d0010          LDRB     r0,[sp,#0x10]
001b20  f88d0007          STRB     r0,[sp,#7]
;;;1657   lc640_write_long_ptr(lc640_adr+16,data);
001b24  a901              ADD      r1,sp,#4
001b26  f1040010          ADD      r0,r4,#0x10
001b2a  f7fffffe          BL       lc640_write_long_ptr
;;;1658   
;;;1659   data[0]=LPC_RTC->HOUR;
001b2e  7a28              LDRB     r0,[r5,#8]
001b30  f88d0004          STRB     r0,[sp,#4]
;;;1660   data[1]=LPC_RTC->MIN;
001b34  7928              LDRB     r0,[r5,#4]
001b36  f88d0005          STRB     r0,[sp,#5]
;;;1661   data[2]=LPC_RTC->SEC;
001b3a  7828              LDRB     r0,[r5,#0]
001b3c  f88d0006          STRB     r0,[sp,#6]
;;;1662   data[3]=*(((char*)(&in1))+1);
001b40  f89d0011          LDRB     r0,[sp,#0x11]
001b44  f88d0007          STRB     r0,[sp,#7]
;;;1663   lc640_write_long_ptr(lc640_adr+20,data);
001b48  a901              ADD      r1,sp,#4
001b4a  f1040014          ADD      r0,r4,#0x14
001b4e  f7fffffe          BL       lc640_write_long_ptr
;;;1664    
;;;1665   }
001b52  b005              ADD      sp,sp,#0x14
001b54  bdf0              POP      {r4-r7,pc}
;;;1666   
                          ENDP

                  vz_mem_hndl PROC
;;;1723   //-----------------------------------------------
;;;1724   void vz_mem_hndl(unsigned short in)
001b56  e92d4ff8          PUSH     {r3-r11,lr}
;;;1725   {
;;;1726   char data[4];
;;;1727   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001b5a  f04f0600          MOV      r6,#0
001b5e  4634              MOV      r4,r6
;;;1728   //char avar_simbol;
;;;1729   
;;;1730   if(in==1)
;;;1731   	{
;;;1732   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1733   	event_ptr++;	
;;;1734   	if(event_ptr>63)event_ptr=0;	
;;;1735   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1736   	
;;;1737        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1738   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1739   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1740   	
;;;1741   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1742   	
;;;1743   	data[0]='B';
;;;1744   	data[1]=0; 
;;;1745   	data[2]='Z';
;;;1746   	data[3]=0;
;;;1747   	lc640_write_long_ptr(lc640_adr,data);
;;;1748   
;;;1749   	data[0]=0;
;;;1750   	data[1]=0;
;;;1751   	data[2]=0;
;;;1752   	data[3]=0;
;;;1753   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1754   
;;;1755   	data[0]=LPC_RTC->YEAR;
001b60  f8df82dc          LDR      r8,|L1.7744|
001b64  46a1              MOV      r9,r4                 ;1727
001b66  f04f0742          MOV      r7,#0x42              ;1743
001b6a  f44f6a80          MOV      r10,#0x400            ;1741
001b6e  2801              CMP      r0,#1                 ;1730
001b70  d002              BEQ      |L1.7032|
;;;1756   	data[1]=LPC_RTC->MONTH;
;;;1757   	data[2]=LPC_RTC->DOM;
;;;1758   	data[3]=0;
;;;1759   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1760   
;;;1761   	data[0]=LPC_RTC->HOUR;
;;;1762   	data[1]=LPC_RTC->MIN;
;;;1763   	data[2]=LPC_RTC->SEC;
;;;1764   	data[3]=0;
;;;1765   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1766   	
;;;1767   	data[0]='A';
;;;1768   	data[1]='A';
;;;1769   	data[2]='A';
;;;1770   	data[3]='A';
;;;1771   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1772   	
;;;1773   	data[0]='A';
;;;1774   	data[1]='A';
;;;1775   	data[2]='A';
;;;1776   	data[3]='A';
;;;1777   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1778   	
;;;1779   	data[0]='A';
;;;1780   	data[1]='A';
;;;1781   	data[2]='A';
;;;1782   	data[3]='A';
;;;1783   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1784   	
;;;1785   	data[0]='A';
;;;1786   	data[1]='A';
;;;1787   	data[2]='A';
;;;1788   	data[3]='A';
;;;1789   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1790    	
;;;1791   	}
;;;1792   
;;;1793   else if(in==0)
001b72  2800              CMP      r0,#0
001b74  d07e              BEQ      |L1.7284|
001b76  e108              B        |L1.7562|
                  |L1.7032|
001b78  f44f6560          MOV      r5,#0xe00             ;1732
001b7c  4628              MOV      r0,r5                 ;1732
001b7e  f7fffffe          BL       lc640_read_int
001b82  f1000001          ADD      r0,r0,#1              ;1733
001b86  4604              MOV      r4,r0                 ;1733
001b88  2c3f              CMP      r4,#0x3f              ;1734
001b8a  d901              BLS      |L1.7056|
001b8c  f04f0400          MOV      r4,#0                 ;1734
                  |L1.7056|
001b90  b221              SXTH     r1,r4                 ;1735
001b92  4628              MOV      r0,r5                 ;1735
001b94  f7fffffe          BL       lc640_write_int
001b98  f6406602          MOV      r6,#0xe02             ;1737
001b9c  4630              MOV      r0,r6                 ;1737
001b9e  f7fffffe          BL       lc640_read_int
001ba2  283f              CMP      r0,#0x3f              ;1738
001ba4  d000              BEQ      |L1.7080|
001ba6  4620              MOV      r0,r4                 ;1738
                  |L1.7080|
001ba8  b201              SXTH     r1,r0                 ;1739
001baa  4630              MOV      r0,r6                 ;1739
001bac  f7fffffe          BL       lc640_write_int
001bb0  4628              MOV      r0,r5                 ;1741
001bb2  f7fffffe          BL       lc640_read_int
001bb6  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1741
001bba  f88d7000          STRB     r7,[sp,#0]            ;1743
001bbe  f88d9001          STRB     r9,[sp,#1]            ;1744
001bc2  f04f005a          MOV      r0,#0x5a              ;1745
001bc6  f88d0002          STRB     r0,[sp,#2]            ;1745
001bca  f88d9003          STRB     r9,[sp,#3]            ;1746
001bce  4669              MOV      r1,sp                 ;1747
001bd0  4620              MOV      r0,r4                 ;1747
001bd2  f7fffffe          BL       lc640_write_long_ptr
001bd6  f8cd9000          STR      r9,[sp,#0]            ;1752
001bda  4669              MOV      r1,sp                 ;1753
001bdc  1d20              ADDS     r0,r4,#4              ;1753
001bde  f7fffffe          BL       lc640_write_long_ptr
001be2  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1755
001be6  f88d0000          STRB     r0,[sp,#0]            ;1755
001bea  f8980038          LDRB     r0,[r8,#0x38]         ;1756
001bee  f88d0001          STRB     r0,[sp,#1]            ;1756
001bf2  f898002c          LDRB     r0,[r8,#0x2c]         ;1757
001bf6  f88d0002          STRB     r0,[sp,#2]            ;1757
001bfa  f88d9003          STRB     r9,[sp,#3]            ;1758
001bfe  4669              MOV      r1,sp                 ;1759
001c00  f1040008          ADD      r0,r4,#8              ;1759
001c04  f7fffffe          BL       lc640_write_long_ptr
001c08  f8980028          LDRB     r0,[r8,#0x28]         ;1761
001c0c  f88d0000          STRB     r0,[sp,#0]            ;1761
001c10  f8980024          LDRB     r0,[r8,#0x24]         ;1762
001c14  f88d0001          STRB     r0,[sp,#1]            ;1762
001c18  f8980020          LDRB     r0,[r8,#0x20]         ;1763
001c1c  f88d0002          STRB     r0,[sp,#2]            ;1763
001c20  f88d9003          STRB     r9,[sp,#3]            ;1764
001c24  4669              MOV      r1,sp                 ;1765
001c26  f104000c          ADD      r0,r4,#0xc            ;1765
001c2a  f7fffffe          BL       lc640_write_long_ptr
001c2e  f04f0541          MOV      r5,#0x41              ;1767
001c32  f88d5000          STRB     r5,[sp,#0]            ;1767
001c36  f88d5001          STRB     r5,[sp,#1]            ;1768
001c3a  f88d5002          STRB     r5,[sp,#2]            ;1769
001c3e  f88d5003          STRB     r5,[sp,#3]            ;1770
001c42  4669              MOV      r1,sp                 ;1771
001c44  f1040010          ADD      r0,r4,#0x10           ;1771
001c48  f7fffffe          BL       lc640_write_long_ptr
001c4c  f88d5000          STRB     r5,[sp,#0]            ;1773
001c50  f88d5001          STRB     r5,[sp,#1]            ;1774
001c54  f88d5002          STRB     r5,[sp,#2]            ;1775
001c58  f88d5003          STRB     r5,[sp,#3]            ;1776
001c5c  4669              MOV      r1,sp                 ;1777
001c5e  f1040014          ADD      r0,r4,#0x14           ;1777
001c62  f7fffffe          BL       lc640_write_long_ptr
001c66  f88d5000          STRB     r5,[sp,#0]            ;1779
001c6a  f88d5001          STRB     r5,[sp,#1]            ;1780
001c6e  f88d5002          STRB     r5,[sp,#2]            ;1781
001c72  e000              B        |L1.7286|
                  |L1.7284|
001c74  e014              B        |L1.7328|
                  |L1.7286|
001c76  f88d5003          STRB     r5,[sp,#3]            ;1782
001c7a  4669              MOV      r1,sp                 ;1783
001c7c  f1040018          ADD      r0,r4,#0x18           ;1783
001c80  f7fffffe          BL       lc640_write_long_ptr
001c84  f88d5000          STRB     r5,[sp,#0]            ;1785
001c88  f88d5001          STRB     r5,[sp,#1]            ;1786
001c8c  f88d5002          STRB     r5,[sp,#2]            ;1787
001c90  f88d5003          STRB     r5,[sp,#3]            ;1788
001c94  4669              MOV      r1,sp                 ;1789
001c96  f104001c          ADD      r0,r4,#0x1c           ;1789
001c9a  f7fffffe          BL       lc640_write_long_ptr
001c9e  e074              B        |L1.7562|
                  |L1.7328|
;;;1794   	{      
;;;1795        
;;;1796   vz_mem_hndl_lbl1: 
;;;1797   
;;;1798   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001ca0  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1799   
;;;1800        lc640_read_long_ptr(lc640_adr,data);
001ca4  4669              MOV      r1,sp
001ca6  4628              MOV      r0,r5
001ca8  f7fffffe          BL       lc640_read_long_ptr
;;;1801        
;;;1802        if(!((data[0]=='B')&&(data[2]=='Z')))
001cac  f89d0000          LDRB     r0,[sp,#0]
001cb0  2842              CMP      r0,#0x42
001cb2  d103              BNE      |L1.7356|
001cb4  f89d0002          LDRB     r0,[sp,#2]
001cb8  285a              CMP      r0,#0x5a
001cba  d008              BEQ      |L1.7374|
                  |L1.7356|
;;;1803        	{        
;;;1804        	if(event_ptr_find)event_ptr_find--;
001cbc  b114              CBZ      r4,|L1.7364|
001cbe  f1a40401          SUB      r4,r4,#1
001cc2  e001              B        |L1.7368|
                  |L1.7364|
;;;1805        	else event_ptr_find=63;
001cc4  f04f043f          MOV      r4,#0x3f
                  |L1.7368|
;;;1806        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001cc8  42b4              CMP      r4,r6
001cca  d1e9              BNE      |L1.7328|
001ccc  e05d              B        |L1.7562|
                  |L1.7374|
;;;1807        	else goto vz_mem_hndl_lbl1;
;;;1808        	}
;;;1809        else 
;;;1810        	{
;;;1811        	lc640_read_long_ptr(lc640_adr+16,data);
001cce  4669              MOV      r1,sp
001cd0  f1050010          ADD      r0,r5,#0x10
001cd4  f7fffffe          BL       lc640_read_long_ptr
;;;1812        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001cd8  f89d0000          LDRB     r0,[sp,#0]
001cdc  2841              CMP      r0,#0x41
001cde  d10b              BNE      |L1.7416|
001ce0  f89d0001          LDRB     r0,[sp,#1]
001ce4  2841              CMP      r0,#0x41
001ce6  d107              BNE      |L1.7416|
001ce8  f89d0002          LDRB     r0,[sp,#2]
001cec  2841              CMP      r0,#0x41
001cee  d103              BNE      |L1.7416|
001cf0  f89d0003          LDRB     r0,[sp,#3]
001cf4  2841              CMP      r0,#0x41
001cf6  d008              BEQ      |L1.7434|
                  |L1.7416|
;;;1813        		{        
;;;1814        		if(event_ptr_find)event_ptr_find--;
001cf8  b114              CBZ      r4,|L1.7424|
001cfa  f1a40401          SUB      r4,r4,#1
001cfe  e001              B        |L1.7428|
                  |L1.7424|
;;;1815            		else event_ptr_find=63;
001d00  f04f043f          MOV      r4,#0x3f
                  |L1.7428|
;;;1816            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001d04  42b4              CMP      r4,r6
001d06  d1cb              BNE      |L1.7328|
001d08  e03f              B        |L1.7562|
                  |L1.7434|
;;;1817        		else goto vz_mem_hndl_lbl1;
;;;1818        		}
;;;1819   
;;;1820        	}	
;;;1821   
;;;1822   
;;;1823   	
;;;1824   	data[0]=LPC_RTC->YEAR;
001d0a  f8b8003c          LDRH     r0,[r8,#0x3c]
001d0e  f88d0000          STRB     r0,[sp,#0]
;;;1825   	data[1]=LPC_RTC->MONTH;
001d12  f8980038          LDRB     r0,[r8,#0x38]
001d16  f88d0001          STRB     r0,[sp,#1]
;;;1826   	data[2]=LPC_RTC->DOM;
001d1a  f898002c          LDRB     r0,[r8,#0x2c]
001d1e  f88d0002          STRB     r0,[sp,#2]
;;;1827   	data[3]=0;
001d22  f88d9003          STRB     r9,[sp,#3]
;;;1828   	lc640_write_long_ptr(lc640_adr+16,data);
001d26  4669              MOV      r1,sp
001d28  f1050010          ADD      r0,r5,#0x10
001d2c  f7fffffe          BL       lc640_write_long_ptr
;;;1829   
;;;1830   	data[0]=LPC_RTC->HOUR;
001d30  f8980028          LDRB     r0,[r8,#0x28]
001d34  f88d0000          STRB     r0,[sp,#0]
;;;1831   	data[1]=LPC_RTC->MIN;
001d38  f8980024          LDRB     r0,[r8,#0x24]
001d3c  f88d0001          STRB     r0,[sp,#1]
;;;1832   	data[2]=LPC_RTC->SEC;
001d40  f8980020          LDRB     r0,[r8,#0x20]
001d44  f88d0002          STRB     r0,[sp,#2]
;;;1833   	data[3]=0;
001d48  f88d9003          STRB     r9,[sp,#3]
;;;1834   	lc640_write_long_ptr(lc640_adr+20,data);
001d4c  4669              MOV      r1,sp
001d4e  f1050014          ADD      r0,r5,#0x14
001d52  f7fffffe          BL       lc640_write_long_ptr
;;;1835   	
;;;1836   	data[0]='B';
001d56  f88d7000          STRB     r7,[sp,#0]
;;;1837   	data[1]='B';
001d5a  f88d7001          STRB     r7,[sp,#1]
;;;1838   	data[2]='B';
001d5e  f88d7002          STRB     r7,[sp,#2]
;;;1839   	data[3]='B';
001d62  f88d7003          STRB     r7,[sp,#3]
;;;1840   	lc640_write_long_ptr(lc640_adr+24,data);
001d66  4669              MOV      r1,sp
001d68  f1050018          ADD      r0,r5,#0x18
001d6c  f7fffffe          BL       lc640_write_long_ptr
;;;1841   	
;;;1842   	data[0]='B';
001d70  f88d7000          STRB     r7,[sp,#0]
;;;1843   	data[1]='B';
001d74  f88d7001          STRB     r7,[sp,#1]
;;;1844   	data[2]='B';
001d78  f88d7002          STRB     r7,[sp,#2]
;;;1845   	data[3]='B';
001d7c  f88d7003          STRB     r7,[sp,#3]
;;;1846   	lc640_write_long_ptr(lc640_adr+28,data);
001d80  4669              MOV      r1,sp
001d82  f105001c          ADD      r0,r5,#0x1c
001d86  f7fffffe          BL       lc640_write_long_ptr
                  |L1.7562|
;;;1847   	
;;;1848   	}
;;;1849   
;;;1850   vz_mem_hndl_end:
;;;1851   __nop(); 
001d8a  bf00              NOP      
                  |L1.7564|
;;;1852   
;;;1853   }
001d8c  e448              B        |L1.5664|
;;;1854   
                          ENDP

                  speedz_mem_hndl PROC
;;;1855   //-----------------------------------------------
;;;1856   void speedz_mem_hndl(unsigned short in)	 //    (1-, 5- , 0- , 10- )
001d8e  e92d4ff8          PUSH     {r3-r11,lr}
;;;1857   {
001d92  4605              MOV      r5,r0
;;;1858   char data[4];
;;;1859   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001d94  f04f0600          MOV      r6,#0
001d98  4634              MOV      r4,r6
;;;1860   //char avar_simbol;
;;;1861   
;;;1862   if((in==1)||(in==5)) //  
;;;1863   	{
;;;1864   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1865   	event_ptr++;	
;;;1866   	if(event_ptr>63)event_ptr=0;	
;;;1867   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1868   	
;;;1869       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1870   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1871   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1872   	
;;;1873   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1874   	
;;;1875   	data[0]='s';
;;;1876   	data[1]=0;
;;;1877   	if(in==5)data[1]='a'; 
;;;1878   	data[2]='Z';
;;;1879   	data[3]=0;
;;;1880   	lc640_write_long_ptr(lc640_adr,data);
;;;1881   
;;;1882   	data[0]=0;
;;;1883   	data[1]=0;
;;;1884   	data[2]=0;
;;;1885   	data[3]=0;
;;;1886   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1887   
;;;1888   	data[0]=LPC_RTC->YEAR;
001d9a  f8df80a4          LDR      r8,|L1.7744|
001d9e  46a1              MOV      r9,r4                 ;1859
001da0  f44f6a80          MOV      r10,#0x400            ;1873
001da4  2d01              CMP      r5,#1                 ;1862
001da6  d012              BEQ      |L1.7630|
001da8  2d05              CMP      r5,#5                 ;1862
001daa  d010              BEQ      |L1.7630|
;;;1889   	data[1]=LPC_RTC->MONTH;
;;;1890   	data[2]=LPC_RTC->DOM;
;;;1891   	data[3]=0;
;;;1892   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1893   
;;;1894   	data[0]=LPC_RTC->HOUR;
;;;1895   	data[1]=LPC_RTC->MIN;
;;;1896   	data[2]=LPC_RTC->SEC;
;;;1897   	data[3]=0;
;;;1898   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1899   	
;;;1900   	data[0]='A';
;;;1901   	data[1]='A';
;;;1902   	data[2]='A';
;;;1903   	data[3]='A';
;;;1904   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1905   	
;;;1906   	data[0]='A';
;;;1907   	data[1]='A';
;;;1908   	data[2]='A';
;;;1909   	data[3]='A';
;;;1910   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1911   	
;;;1912   	data[0]='A';
;;;1913   	data[1]='A';
;;;1914   	data[2]='A';
;;;1915   	data[3]='A';
;;;1916   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1917   	
;;;1918   	data[0]='A';
;;;1919   	data[1]='A';
;;;1920   	data[2]='A';
;;;1921   	data[3]='A';
;;;1922   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1923    	
;;;1924   	}
;;;1925   
;;;1926   else if(in==0)	// 
001dac  2d00              CMP      r5,#0
001dae  d07d              BEQ      |L1.7852|
;;;1927   	{      
;;;1928   	char i;     
;;;1929   	event_ptr_find=0;
;;;1930   	for (i=0;i<63;i++)
;;;1931   		{
;;;1932   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1933   
;;;1934        	lc640_read_long_ptr(lc640_adr,data);
;;;1935        
;;;1936        	if(!((data[0]=='s')&&(data[2]=='Z')))
;;;1937        		{        
;;;1938        		if(event_ptr_find)event_ptr_find--;
;;;1939        		else event_ptr_find=63;
;;;1940        		if(event_ptr_find==event_ptr)
;;;1941   				{
;;;1942   				lc640_adr=0;
;;;1943   				break;
;;;1944   				}
;;;1945        		else continue;
;;;1946        		}
;;;1947        	else 
;;;1948        		{
;;;1949        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1950        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1951        			{        
;;;1952        			if(event_ptr_find)event_ptr_find--;
;;;1953            		else event_ptr_find=63;
;;;1954            		if(event_ptr_find==event_ptr)
;;;1955   					{
;;;1956   					lc640_adr=0;
;;;1957   					break;
;;;1958   					}
;;;1959        			else continue;
;;;1960        			}
;;;1961        		}	
;;;1962   		}
;;;1963   	if(lc640_adr!=0)
;;;1964   		{
;;;1965   		data[0]=LPC_RTC->YEAR;
;;;1966   		data[1]=LPC_RTC->MONTH;
;;;1967   		data[2]=LPC_RTC->DOM;
;;;1968   		data[3]=0;
;;;1969   		lc640_write_long_ptr(lc640_adr+16,data);
;;;1970   	
;;;1971   		data[0]=LPC_RTC->HOUR;
;;;1972   		data[1]=LPC_RTC->MIN;
;;;1973   		data[2]=LPC_RTC->SEC;
;;;1974   		data[3]=0;
;;;1975   		lc640_write_long_ptr(lc640_adr+20,data);
;;;1976   		
;;;1977   		data[0]='C';
;;;1978   		data[1]='C';
;;;1979   		data[2]='C';
;;;1980   		data[3]='C';
;;;1981   		lc640_write_long_ptr(lc640_adr+24,data);
;;;1982   		
;;;1983   		data[0]='C';
;;;1984   		data[1]='C';
;;;1985   		data[2]='C';
;;;1986   		data[3]='C';
;;;1987   		lc640_write_long_ptr(lc640_adr+28,data);
;;;1988   		}
;;;1989   	}
;;;1990   else if(in==10) 	//  
001db0  2d0a              CMP      r5,#0xa
001db2  d17c              BNE      |L1.7854|
;;;1991   	{      
;;;1992   	char i;     
;;;1993   
;;;1994   	event_ptr_find=0;
;;;1995   	for (i=0;i<63;i++)
001db4  f04f0700          MOV      r7,#0
                  |L1.7608|
;;;1996   		{
;;;1997   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
001db8  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1998   
;;;1999        	lc640_read_long_ptr(lc640_adr,data);
001dbc  4669              MOV      r1,sp
001dbe  4628              MOV      r0,r5
001dc0  f7fffffe          BL       lc640_read_long_ptr
;;;2000        
;;;2001        	if(!((data[0]=='s')&&(data[2]=='Z')))
001dc4  f89d0000          LDRB     r0,[sp,#0]
001dc8  2873              CMP      r0,#0x73
001dca  d171              BNE      |L1.7856|
001dcc  e14d              B        |L1.8298|
                  |L1.7630|
001dce  f44f6660          MOV      r6,#0xe00             ;1864
001dd2  4630              MOV      r0,r6                 ;1864
001dd4  f7fffffe          BL       lc640_read_int
001dd8  f1000001          ADD      r0,r0,#1              ;1865
001ddc  4604              MOV      r4,r0                 ;1865
001dde  2c3f              CMP      r4,#0x3f              ;1866
001de0  d901              BLS      |L1.7654|
001de2  f04f0400          MOV      r4,#0                 ;1866
                  |L1.7654|
001de6  b221              SXTH     r1,r4                 ;1867
001de8  4630              MOV      r0,r6                 ;1867
001dea  f7fffffe          BL       lc640_write_int
001dee  e029              B        |L1.7748|
                  |L1.7664|
001df0  42415420          DCB      "BAT #1 Asymmetry alarm clear",0
001df4  23312041
001df8  73796d6d
001dfc  65747279
001e00  20616c61
001e04  726d2063
001e08  6c656172
001e0c  00      
001e0d  00                DCB      0
001e0e  00                DCB      0
001e0f  00                DCB      0
                  |L1.7696|
001e10  42415420          DCB      "BAT #2 Asymmetry alarm clear",0
001e14  23322041
001e18  73796d6d
001e1c  65747279
001e20  20616c61
001e24  726d2063
001e28  6c656172
001e2c  00      
001e2d  00                DCB      0
001e2e  00                DCB      0
001e2f  00                DCB      0
                  |L1.7728|
                          DCD      bat
                  |L1.7732|
                          DCD      bat_u_old_cnt
                  |L1.7736|
                          DCD      ke_date
                  |L1.7740|
                          DCD      0x40024020
                  |L1.7744|
                          DCD      0x40024000
                  |L1.7748|
001e44  f6406702          MOV      r7,#0xe02             ;1869
001e48  4638              MOV      r0,r7                 ;1869
001e4a  f7fffffe          BL       lc640_read_int
001e4e  283f              CMP      r0,#0x3f              ;1870
001e50  d000              BEQ      |L1.7764|
001e52  4620              MOV      r0,r4                 ;1870
                  |L1.7764|
001e54  b201              SXTH     r1,r0                 ;1871
001e56  4638              MOV      r0,r7                 ;1871
001e58  f7fffffe          BL       lc640_write_int
001e5c  4630              MOV      r0,r6                 ;1873
001e5e  f7fffffe          BL       lc640_read_int
001e62  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1873
001e66  f04f0073          MOV      r0,#0x73              ;1875
001e6a  f88d0000          STRB     r0,[sp,#0]            ;1875
001e6e  f88d9001          STRB     r9,[sp,#1]            ;1876
001e72  2d05              CMP      r5,#5                 ;1877
001e74  d103              BNE      |L1.7806|
001e76  f04f0061          MOV      r0,#0x61              ;1877
001e7a  f88d0001          STRB     r0,[sp,#1]            ;1877
                  |L1.7806|
001e7e  f04f005a          MOV      r0,#0x5a              ;1878
001e82  f88d0002          STRB     r0,[sp,#2]            ;1878
001e86  f88d9003          STRB     r9,[sp,#3]            ;1879
001e8a  4669              MOV      r1,sp                 ;1880
001e8c  4620              MOV      r0,r4                 ;1880
001e8e  f7fffffe          BL       lc640_write_long_ptr
001e92  f8cd9000          STR      r9,[sp,#0]            ;1885
001e96  4669              MOV      r1,sp                 ;1886
001e98  1d20              ADDS     r0,r4,#4              ;1886
001e9a  f7fffffe          BL       lc640_write_long_ptr
001e9e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1888
001ea2  f88d0000          STRB     r0,[sp,#0]            ;1888
001ea6  f8980038          LDRB     r0,[r8,#0x38]         ;1889
001eaa  e002              B        |L1.7858|
                  |L1.7852|
001eac  e058              B        |L1.8032|
                  |L1.7854|
001eae  e056              B        |L1.8030|
                  |L1.7856|
001eb0  e0df              B        |L1.8306|
                  |L1.7858|
001eb2  f88d0001          STRB     r0,[sp,#1]            ;1889
001eb6  f898002c          LDRB     r0,[r8,#0x2c]         ;1890
001eba  f88d0002          STRB     r0,[sp,#2]            ;1890
001ebe  f88d9003          STRB     r9,[sp,#3]            ;1891
001ec2  4669              MOV      r1,sp                 ;1892
001ec4  f1040008          ADD      r0,r4,#8              ;1892
001ec8  f7fffffe          BL       lc640_write_long_ptr
001ecc  f8980028          LDRB     r0,[r8,#0x28]         ;1894
001ed0  f88d0000          STRB     r0,[sp,#0]            ;1894
001ed4  f8980024          LDRB     r0,[r8,#0x24]         ;1895
001ed8  f88d0001          STRB     r0,[sp,#1]            ;1895
001edc  f8980020          LDRB     r0,[r8,#0x20]         ;1896
001ee0  f88d0002          STRB     r0,[sp,#2]            ;1896
001ee4  f88d9003          STRB     r9,[sp,#3]            ;1897
001ee8  4669              MOV      r1,sp                 ;1898
001eea  f104000c          ADD      r0,r4,#0xc            ;1898
001eee  f7fffffe          BL       lc640_write_long_ptr
001ef2  f04f0541          MOV      r5,#0x41              ;1900
001ef6  f88d5000          STRB     r5,[sp,#0]            ;1900
001efa  f88d5001          STRB     r5,[sp,#1]            ;1901
001efe  f88d5002          STRB     r5,[sp,#2]            ;1902
001f02  f88d5003          STRB     r5,[sp,#3]            ;1903
001f06  4669              MOV      r1,sp                 ;1904
001f08  f1040010          ADD      r0,r4,#0x10           ;1904
001f0c  f7fffffe          BL       lc640_write_long_ptr
001f10  f88d5000          STRB     r5,[sp,#0]            ;1906
001f14  f88d5001          STRB     r5,[sp,#1]            ;1907
001f18  f88d5002          STRB     r5,[sp,#2]            ;1908
001f1c  f88d5003          STRB     r5,[sp,#3]            ;1909
001f20  4669              MOV      r1,sp                 ;1910
001f22  f1040014          ADD      r0,r4,#0x14           ;1910
001f26  f7fffffe          BL       lc640_write_long_ptr
001f2a  f88d5000          STRB     r5,[sp,#0]            ;1912
001f2e  f88d5001          STRB     r5,[sp,#1]            ;1913
001f32  f88d5002          STRB     r5,[sp,#2]            ;1914
001f36  f88d5003          STRB     r5,[sp,#3]            ;1915
001f3a  4669              MOV      r1,sp                 ;1916
001f3c  f1040018          ADD      r0,r4,#0x18           ;1916
001f40  f7fffffe          BL       lc640_write_long_ptr
001f44  f88d5000          STRB     r5,[sp,#0]            ;1918
001f48  f88d5001          STRB     r5,[sp,#1]            ;1919
001f4c  f88d5002          STRB     r5,[sp,#2]            ;1920
001f50  f88d5003          STRB     r5,[sp,#3]            ;1921
001f54  4669              MOV      r1,sp                 ;1922
001f56  f104001c          ADD      r0,r4,#0x1c           ;1922
001f5a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8030|
;;;2002        		{        
;;;2003        		if(event_ptr_find)event_ptr_find--;
;;;2004        		else event_ptr_find=63;
;;;2005        		if(event_ptr_find==event_ptr)
;;;2006   				{
;;;2007   				lc640_adr=0;
;;;2008   				break;
;;;2009   				}
;;;2010        		else continue;
;;;2011        		}
;;;2012        	else 
;;;2013        		{
;;;2014        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2015        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2016        			{        
;;;2017        			if(event_ptr_find)event_ptr_find--;
;;;2018            		else event_ptr_find=63;
;;;2019            		if(event_ptr_find==event_ptr)
;;;2020   					{
;;;2021   					lc640_adr=0;
;;;2022   					break;
;;;2023   					}
;;;2024        			else continue;
;;;2025        			}
;;;2026        		}	
;;;2027   		}
;;;2028   	if(lc640_adr!=0)
;;;2029   		{
;;;2030   		data[0]=LPC_RTC->YEAR;
;;;2031   		data[1]=LPC_RTC->MONTH;
;;;2032   		data[2]=LPC_RTC->DOM;
;;;2033   		data[3]=0;
;;;2034   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2035   	
;;;2036   		data[0]=LPC_RTC->HOUR;
;;;2037   		data[1]=LPC_RTC->MIN;
;;;2038   		data[2]=LPC_RTC->SEC;
;;;2039   		data[3]=0;
;;;2040   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2041   		
;;;2042   		data[0]='B';
;;;2043   		data[1]='B';
;;;2044   		data[2]='B';
;;;2045   		data[3]='B';
;;;2046   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2047   		
;;;2048   		data[0]='B';
;;;2049   		data[1]='B';
;;;2050   		data[2]='B';
;;;2051   		data[3]='B';
;;;2052   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2053   		}
;;;2054   	}
;;;2055   }
001f5e  e560              B        |L1.6690|
                  |L1.8032|
001f60  f04f0700          MOV      r7,#0                 ;1930
                  |L1.8036|
001f64  eb0a1544          ADD      r5,r10,r4,LSL #5      ;1932
001f68  4669              MOV      r1,sp                 ;1934
001f6a  4628              MOV      r0,r5                 ;1934
001f6c  f7fffffe          BL       lc640_read_long_ptr
001f70  f89d0000          LDRB     r0,[sp,#0]            ;1936
001f74  2873              CMP      r0,#0x73              ;1936
001f76  d103              BNE      |L1.8064|
001f78  f89d0002          LDRB     r0,[sp,#2]            ;1936
001f7c  285a              CMP      r0,#0x5a              ;1936
001f7e  d00a              BEQ      |L1.8086|
                  |L1.8064|
001f80  b114              CBZ      r4,|L1.8072|
001f82  f1a40401          SUB      r4,r4,#1              ;1938
001f86  e001              B        |L1.8076|
                  |L1.8072|
001f88  f04f043f          MOV      r4,#0x3f              ;1939
                  |L1.8076|
001f8c  42b4              CMP      r4,r6                 ;1940
001f8e  d122              BNE      |L1.8150|
001f90  f04f0500          MOV      r5,#0                 ;1942
001f94  e024              B        |L1.8160|
                  |L1.8086|
001f96  4669              MOV      r1,sp                 ;1949
001f98  f1050010          ADD      r0,r5,#0x10           ;1949
001f9c  f7fffffe          BL       lc640_read_long_ptr
001fa0  f89d0000          LDRB     r0,[sp,#0]            ;1950
001fa4  2841              CMP      r0,#0x41              ;1950
001fa6  d10b              BNE      |L1.8128|
001fa8  f89d0001          LDRB     r0,[sp,#1]            ;1950
001fac  2841              CMP      r0,#0x41              ;1950
001fae  d107              BNE      |L1.8128|
001fb0  f89d0002          LDRB     r0,[sp,#2]            ;1950
001fb4  2841              CMP      r0,#0x41              ;1950
001fb6  d103              BNE      |L1.8128|
001fb8  f89d0003          LDRB     r0,[sp,#3]            ;1950
001fbc  2841              CMP      r0,#0x41              ;1950
001fbe  d00a              BEQ      |L1.8150|
                  |L1.8128|
001fc0  b114              CBZ      r4,|L1.8136|
001fc2  f1a40401          SUB      r4,r4,#1              ;1952
001fc6  e001              B        |L1.8140|
                  |L1.8136|
001fc8  f04f043f          MOV      r4,#0x3f              ;1953
                  |L1.8140|
001fcc  42b4              CMP      r4,r6                 ;1954
001fce  d102              BNE      |L1.8150|
001fd0  f04f0500          MOV      r5,#0                 ;1956
001fd4  e004              B        |L1.8160|
                  |L1.8150|
001fd6  f1070701          ADD      r7,r7,#1              ;1930
001fda  b2ff              UXTB     r7,r7                 ;1930
001fdc  2f3f              CMP      r7,#0x3f              ;1930
001fde  d3c1              BCC      |L1.8036|
                  |L1.8160|
001fe0  2d00              CMP      r5,#0                 ;1963
001fe2  d0bc              BEQ      |L1.8030|
001fe4  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1965
001fe8  f88d0000          STRB     r0,[sp,#0]            ;1965
001fec  f8980038          LDRB     r0,[r8,#0x38]         ;1966
001ff0  f88d0001          STRB     r0,[sp,#1]            ;1966
001ff4  f898002c          LDRB     r0,[r8,#0x2c]         ;1967
001ff8  f88d0002          STRB     r0,[sp,#2]            ;1967
001ffc  f88d9003          STRB     r9,[sp,#3]            ;1968
002000  4669              MOV      r1,sp                 ;1969
002002  f1050010          ADD      r0,r5,#0x10           ;1969
002006  f7fffffe          BL       lc640_write_long_ptr
00200a  f8980028          LDRB     r0,[r8,#0x28]         ;1971
00200e  f88d0000          STRB     r0,[sp,#0]            ;1971
002012  f8980024          LDRB     r0,[r8,#0x24]         ;1972
002016  f88d0001          STRB     r0,[sp,#1]            ;1972
00201a  f8980020          LDRB     r0,[r8,#0x20]         ;1973
00201e  f88d0002          STRB     r0,[sp,#2]            ;1973
002022  f88d9003          STRB     r9,[sp,#3]            ;1974
002026  4669              MOV      r1,sp                 ;1975
002028  f1050014          ADD      r0,r5,#0x14           ;1975
00202c  f7fffffe          BL       lc640_write_long_ptr
002030  f04f0443          MOV      r4,#0x43              ;1977
002034  f88d4000          STRB     r4,[sp,#0]            ;1977
002038  f88d4001          STRB     r4,[sp,#1]            ;1978
00203c  f88d4002          STRB     r4,[sp,#2]            ;1979
002040  f88d4003          STRB     r4,[sp,#3]            ;1980
002044  4669              MOV      r1,sp                 ;1981
002046  f1050018          ADD      r0,r5,#0x18           ;1981
00204a  f7fffffe          BL       lc640_write_long_ptr
00204e  f88d4000          STRB     r4,[sp,#0]            ;1983
002052  f88d4001          STRB     r4,[sp,#1]            ;1984
002056  f88d4002          STRB     r4,[sp,#2]            ;1985
00205a  f88d4003          STRB     r4,[sp,#3]            ;1986
00205e  4669              MOV      r1,sp                 ;1987
002060  f105001c          ADD      r0,r5,#0x1c           ;1987
002064  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8296|
002068  e4db              B        |L1.6690|
                  |L1.8298|
00206a  f89d0002          LDRB     r0,[sp,#2]            ;2001
00206e  285a              CMP      r0,#0x5a              ;2001
002070  d00a              BEQ      |L1.8328|
                  |L1.8306|
002072  b114              CBZ      r4,|L1.8314|
002074  f1a40401          SUB      r4,r4,#1              ;2003
002078  e001              B        |L1.8318|
                  |L1.8314|
00207a  f04f043f          MOV      r4,#0x3f              ;2004
                  |L1.8318|
00207e  42b4              CMP      r4,r6                 ;2005
002080  d122              BNE      |L1.8392|
002082  f04f0500          MOV      r5,#0                 ;2007
002086  e025              B        |L1.8404|
                  |L1.8328|
002088  4669              MOV      r1,sp                 ;2014
00208a  f1050010          ADD      r0,r5,#0x10           ;2014
00208e  f7fffffe          BL       lc640_read_long_ptr
002092  f89d0000          LDRB     r0,[sp,#0]            ;2015
002096  2841              CMP      r0,#0x41              ;2015
002098  d10b              BNE      |L1.8370|
00209a  f89d0001          LDRB     r0,[sp,#1]            ;2015
00209e  2841              CMP      r0,#0x41              ;2015
0020a0  d107              BNE      |L1.8370|
0020a2  f89d0002          LDRB     r0,[sp,#2]            ;2015
0020a6  2841              CMP      r0,#0x41              ;2015
0020a8  d103              BNE      |L1.8370|
0020aa  f89d0003          LDRB     r0,[sp,#3]            ;2015
0020ae  2841              CMP      r0,#0x41              ;2015
0020b0  d00a              BEQ      |L1.8392|
                  |L1.8370|
0020b2  b114              CBZ      r4,|L1.8378|
0020b4  f1a40401          SUB      r4,r4,#1              ;2017
0020b8  e001              B        |L1.8382|
                  |L1.8378|
0020ba  f04f043f          MOV      r4,#0x3f              ;2018
                  |L1.8382|
0020be  42b4              CMP      r4,r6                 ;2019
0020c0  d102              BNE      |L1.8392|
0020c2  f04f0500          MOV      r5,#0                 ;2021
0020c6  e005              B        |L1.8404|
                  |L1.8392|
0020c8  f1070701          ADD      r7,r7,#1              ;1995
0020cc  b2ff              UXTB     r7,r7                 ;1995
0020ce  2f3f              CMP      r7,#0x3f              ;1995
0020d0  f4ffae72          BCC      |L1.7608|
                  |L1.8404|
0020d4  2d00              CMP      r5,#0                 ;2028
0020d6  d0c7              BEQ      |L1.8296|
0020d8  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2030
0020dc  f88d0000          STRB     r0,[sp,#0]            ;2030
0020e0  f8980038          LDRB     r0,[r8,#0x38]         ;2031
0020e4  f88d0001          STRB     r0,[sp,#1]            ;2031
0020e8  f898002c          LDRB     r0,[r8,#0x2c]         ;2032
0020ec  f88d0002          STRB     r0,[sp,#2]            ;2032
0020f0  f88d9003          STRB     r9,[sp,#3]            ;2033
0020f4  4669              MOV      r1,sp                 ;2034
0020f6  f1050010          ADD      r0,r5,#0x10           ;2034
0020fa  f7fffffe          BL       lc640_write_long_ptr
0020fe  f8980028          LDRB     r0,[r8,#0x28]         ;2036
002102  f88d0000          STRB     r0,[sp,#0]            ;2036
002106  f8980024          LDRB     r0,[r8,#0x24]         ;2037
00210a  f88d0001          STRB     r0,[sp,#1]            ;2037
00210e  f8980020          LDRB     r0,[r8,#0x20]         ;2038
002112  f88d0002          STRB     r0,[sp,#2]            ;2038
002116  f88d9003          STRB     r9,[sp,#3]            ;2039
00211a  4669              MOV      r1,sp                 ;2040
00211c  f1050014          ADD      r0,r5,#0x14           ;2040
002120  f7fffffe          BL       lc640_write_long_ptr
002124  f04f0442          MOV      r4,#0x42              ;2042
002128  f88d4000          STRB     r4,[sp,#0]            ;2042
00212c  f88d4001          STRB     r4,[sp,#1]            ;2043
002130  f88d4002          STRB     r4,[sp,#2]            ;2044
002134  f88d4003          STRB     r4,[sp,#3]            ;2045
002138  4669              MOV      r1,sp                 ;2046
00213a  f1050018          ADD      r0,r5,#0x18           ;2046
00213e  f7fffffe          BL       lc640_write_long_ptr
002142  f88d4000          STRB     r4,[sp,#0]            ;2048
002146  f88d4001          STRB     r4,[sp,#1]            ;2049
00214a  f88d4002          STRB     r4,[sp,#2]            ;2050
00214e  f88d4003          STRB     r4,[sp,#3]            ;2051
002152  4669              MOV      r1,sp                 ;2052
002154  f105001c          ADD      r0,r5,#0x1c           ;2052
002158  f7fffffe          BL       lc640_write_long_ptr
00215c  e461              B        |L1.6690|
;;;2056     
                          ENDP

                  uz_mem_hndl PROC
;;;2058   //-----------------------------------------------
;;;2059   void uz_mem_hndl(unsigned short in)	 //   
00215e  e92d4ff8          PUSH     {r3-r11,lr}
;;;2060   {
;;;2061   char data[4];
;;;2062   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
002162  f04f0600          MOV      r6,#0
002166  4634              MOV      r4,r6
;;;2063   //char avar_simbol;
;;;2064   
;;;2065   if(in==1) //  
;;;2066   	{
;;;2067   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2068   	event_ptr++;	
;;;2069   	if(event_ptr>63)event_ptr=0;	
;;;2070   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2071   	
;;;2072       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2073   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2074   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2075   	
;;;2076   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2077   	
;;;2078   	data[0]='u';
;;;2079   	data[1]=0; 
;;;2080   	data[2]='Z';
;;;2081   	data[3]=0;
;;;2082   	lc640_write_long_ptr(lc640_adr,data);
;;;2083   
;;;2084   	data[0]=0;
;;;2085   	data[1]=0;
;;;2086   	data[2]=0;
;;;2087   	data[3]=0;
;;;2088   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2089   
;;;2090   	data[0]=LPC_RTC->YEAR;
002168  f8df86c4          LDR      r8,|L1.10288|
00216c  46a1              MOV      r9,r4                 ;2062
00216e  f44f6a80          MOV      r10,#0x400            ;2076
002172  2801              CMP      r0,#1                 ;2065
002174  d010              BEQ      |L1.8600|
;;;2091   	data[1]=LPC_RTC->MONTH;
;;;2092   	data[2]=LPC_RTC->DOM;
;;;2093   	data[3]=0;
;;;2094   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2095   
;;;2096   	data[0]=LPC_RTC->HOUR;
;;;2097   	data[1]=LPC_RTC->MIN;
;;;2098   	data[2]=LPC_RTC->SEC;
;;;2099   	data[3]=0;
;;;2100   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2101   	
;;;2102   	data[0]='A';
;;;2103   	data[1]='A';
;;;2104   	data[2]='A';
;;;2105   	data[3]='A';
;;;2106   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2107   	
;;;2108   	data[0]='A';
;;;2109   	data[1]='A';
;;;2110   	data[2]='A';
;;;2111   	data[3]='A';
;;;2112   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2113   	
;;;2114   	data[0]='A';
;;;2115   	data[1]='A';
;;;2116   	data[2]='A';
;;;2117   	data[3]='A';
;;;2118   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2119   	
;;;2120   	data[0]='A';
;;;2121   	data[1]='A';
;;;2122   	data[2]='A';
;;;2123   	data[3]='A';
;;;2124   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2125    	
;;;2126   	}
;;;2127   
;;;2128   else if(in==0)	// 
002176  2800              CMP      r0,#0
002178  d07d              BEQ      |L1.8822|
;;;2129   	{      
;;;2130   	char i;     
;;;2131   	event_ptr_find=0;
;;;2132   	for (i=0;i<63;i++)
;;;2133   		{
;;;2134   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2135   
;;;2136        	lc640_read_long_ptr(lc640_adr,data);
;;;2137        
;;;2138        	if(!((data[0]=='u')&&(data[2]=='Z')))
;;;2139        		{        
;;;2140        		if(event_ptr_find)event_ptr_find--;
;;;2141        		else event_ptr_find=63;
;;;2142        		if(event_ptr_find==event_ptr)
;;;2143   				{
;;;2144   				lc640_adr=0;
;;;2145   				break;
;;;2146   				}
;;;2147        		else continue;
;;;2148        		}
;;;2149        	else 
;;;2150        		{
;;;2151        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2152        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2153        			{        
;;;2154        			if(event_ptr_find)event_ptr_find--;
;;;2155            		else event_ptr_find=63;
;;;2156            		if(event_ptr_find==event_ptr)
;;;2157   					{
;;;2158   					lc640_adr=0;
;;;2159   					break;
;;;2160   					}
;;;2161        			else continue;
;;;2162        			}
;;;2163        		}	
;;;2164   		}
;;;2165   	if(lc640_adr!=0)
;;;2166   		{
;;;2167   		data[0]=LPC_RTC->YEAR;
;;;2168   		data[1]=LPC_RTC->MONTH;
;;;2169   		data[2]=LPC_RTC->DOM;
;;;2170   		data[3]=0;
;;;2171   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2172   	
;;;2173   		data[0]=LPC_RTC->HOUR;
;;;2174   		data[1]=LPC_RTC->MIN;
;;;2175   		data[2]=LPC_RTC->SEC;
;;;2176   		data[3]=0;
;;;2177   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2178   		
;;;2179   		data[0]='C';
;;;2180   		data[1]='C';
;;;2181   		data[2]='C';
;;;2182   		data[3]='C';
;;;2183   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2184   		
;;;2185   		data[0]='C';
;;;2186   		data[1]='C';
;;;2187   		data[2]='C';
;;;2188   		data[3]='C';
;;;2189   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2190   		}
;;;2191   	}
;;;2192   else if(in==10) 	//  
00217a  280a              CMP      r0,#0xa
00217c  d17c              BNE      |L1.8824|
;;;2193   	{      
;;;2194   	char i;     
;;;2195   
;;;2196   	event_ptr_find=0;
;;;2197   	for (i=0;i<63;i++)
00217e  f04f0700          MOV      r7,#0
                  |L1.8578|
;;;2198   		{
;;;2199   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
002182  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2200   
;;;2201        	lc640_read_long_ptr(lc640_adr,data);
002186  4669              MOV      r1,sp
002188  4628              MOV      r0,r5
00218a  f7fffffe          BL       lc640_read_long_ptr
;;;2202        
;;;2203        	if(!((data[0]=='u')&&(data[2]=='Z')))
00218e  f89d0000          LDRB     r0,[sp,#0]
002192  2875              CMP      r0,#0x75
002194  d171              BNE      |L1.8826|
002196  e11c              B        |L1.9170|
                  |L1.8600|
002198  f44f6560          MOV      r5,#0xe00             ;2067
00219c  4628              MOV      r0,r5                 ;2067
00219e  f7fffffe          BL       lc640_read_int
0021a2  f1000001          ADD      r0,r0,#1              ;2068
0021a6  4604              MOV      r4,r0                 ;2068
0021a8  2c3f              CMP      r4,#0x3f              ;2069
0021aa  d901              BLS      |L1.8624|
0021ac  f04f0400          MOV      r4,#0                 ;2069
                  |L1.8624|
0021b0  b221              SXTH     r1,r4                 ;2070
0021b2  4628              MOV      r0,r5                 ;2070
0021b4  f7fffffe          BL       lc640_write_int
0021b8  f6406602          MOV      r6,#0xe02             ;2072
0021bc  4630              MOV      r0,r6                 ;2072
0021be  f7fffffe          BL       lc640_read_int
0021c2  283f              CMP      r0,#0x3f              ;2073
0021c4  d000              BEQ      |L1.8648|
0021c6  4620              MOV      r0,r4                 ;2073
                  |L1.8648|
0021c8  b201              SXTH     r1,r0                 ;2074
0021ca  4630              MOV      r0,r6                 ;2074
0021cc  f7fffffe          BL       lc640_write_int
0021d0  4628              MOV      r0,r5                 ;2076
0021d2  f7fffffe          BL       lc640_read_int
0021d6  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2076
0021da  f04f0075          MOV      r0,#0x75              ;2078
0021de  f88d0000          STRB     r0,[sp,#0]            ;2078
0021e2  f88d9001          STRB     r9,[sp,#1]            ;2079
0021e6  f04f005a          MOV      r0,#0x5a              ;2080
0021ea  f88d0002          STRB     r0,[sp,#2]            ;2080
0021ee  f88d9003          STRB     r9,[sp,#3]            ;2081
0021f2  4669              MOV      r1,sp                 ;2082
0021f4  4620              MOV      r0,r4                 ;2082
0021f6  f7fffffe          BL       lc640_write_long_ptr
0021fa  f8cd9000          STR      r9,[sp,#0]            ;2087
0021fe  4669              MOV      r1,sp                 ;2088
002200  1d20              ADDS     r0,r4,#4              ;2088
002202  f7fffffe          BL       lc640_write_long_ptr
002206  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2090
00220a  f88d0000          STRB     r0,[sp,#0]            ;2090
00220e  f8980038          LDRB     r0,[r8,#0x38]         ;2091
002212  f88d0001          STRB     r0,[sp,#1]            ;2091
002216  f898002c          LDRB     r0,[r8,#0x2c]         ;2092
00221a  f88d0002          STRB     r0,[sp,#2]            ;2092
00221e  f88d9003          STRB     r9,[sp,#3]            ;2093
002222  4669              MOV      r1,sp                 ;2094
002224  f1040008          ADD      r0,r4,#8              ;2094
002228  f7fffffe          BL       lc640_write_long_ptr
00222c  f8980028          LDRB     r0,[r8,#0x28]         ;2096
002230  f88d0000          STRB     r0,[sp,#0]            ;2096
002234  f8980024          LDRB     r0,[r8,#0x24]         ;2097
002238  f88d0001          STRB     r0,[sp,#1]            ;2097
00223c  f8980020          LDRB     r0,[r8,#0x20]         ;2098
002240  f88d0002          STRB     r0,[sp,#2]            ;2098
002244  f88d9003          STRB     r9,[sp,#3]            ;2099
002248  4669              MOV      r1,sp                 ;2100
00224a  f104000c          ADD      r0,r4,#0xc            ;2100
00224e  f7fffffe          BL       lc640_write_long_ptr
002252  f04f0541          MOV      r5,#0x41              ;2102
002256  f88d5000          STRB     r5,[sp,#0]            ;2102
00225a  f88d5001          STRB     r5,[sp,#1]            ;2103
00225e  f88d5002          STRB     r5,[sp,#2]            ;2104
002262  f88d5003          STRB     r5,[sp,#3]            ;2105
002266  4669              MOV      r1,sp                 ;2106
002268  f1040010          ADD      r0,r4,#0x10           ;2106
00226c  f7fffffe          BL       lc640_write_long_ptr
002270  f88d5000          STRB     r5,[sp,#0]            ;2108
002274  e002              B        |L1.8828|
                  |L1.8822|
002276  e027              B        |L1.8904|
                  |L1.8824|
002278  e025              B        |L1.8902|
                  |L1.8826|
00227a  e0ae              B        |L1.9178|
                  |L1.8828|
00227c  f88d5001          STRB     r5,[sp,#1]            ;2109
002280  f88d5002          STRB     r5,[sp,#2]            ;2110
002284  f88d5003          STRB     r5,[sp,#3]            ;2111
002288  4669              MOV      r1,sp                 ;2112
00228a  f1040014          ADD      r0,r4,#0x14           ;2112
00228e  f7fffffe          BL       lc640_write_long_ptr
002292  f88d5000          STRB     r5,[sp,#0]            ;2114
002296  f88d5001          STRB     r5,[sp,#1]            ;2115
00229a  f88d5002          STRB     r5,[sp,#2]            ;2116
00229e  f88d5003          STRB     r5,[sp,#3]            ;2117
0022a2  4669              MOV      r1,sp                 ;2118
0022a4  f1040018          ADD      r0,r4,#0x18           ;2118
0022a8  f7fffffe          BL       lc640_write_long_ptr
0022ac  f88d5000          STRB     r5,[sp,#0]            ;2120
0022b0  f88d5001          STRB     r5,[sp,#1]            ;2121
0022b4  f88d5002          STRB     r5,[sp,#2]            ;2122
0022b8  f88d5003          STRB     r5,[sp,#3]            ;2123
0022bc  4669              MOV      r1,sp                 ;2124
0022be  f104001c          ADD      r0,r4,#0x1c           ;2124
0022c2  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8902|
;;;2204        		{        
;;;2205        		if(event_ptr_find)event_ptr_find--;
;;;2206        		else event_ptr_find=63;
;;;2207        		if(event_ptr_find==event_ptr)
;;;2208   				{
;;;2209   				lc640_adr=0;
;;;2210   				break;
;;;2211   				}
;;;2212        		else continue;
;;;2213        		}
;;;2214        	else 
;;;2215        		{
;;;2216        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2217        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2218        			{        
;;;2219        			if(event_ptr_find)event_ptr_find--;
;;;2220            		else event_ptr_find=63;
;;;2221            		if(event_ptr_find==event_ptr)
;;;2222   					{
;;;2223   					lc640_adr=0;
;;;2224   					break;
;;;2225   					}
;;;2226        			else continue;
;;;2227        			}
;;;2228        		}	
;;;2229   		}
;;;2230   	if(lc640_adr!=0)
;;;2231   		{
;;;2232   		data[0]=LPC_RTC->YEAR;
;;;2233   		data[1]=LPC_RTC->MONTH;
;;;2234   		data[2]=LPC_RTC->DOM;
;;;2235   		data[3]=0;
;;;2236   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2237   	
;;;2238   		data[0]=LPC_RTC->HOUR;
;;;2239   		data[1]=LPC_RTC->MIN;
;;;2240   		data[2]=LPC_RTC->SEC;
;;;2241   		data[3]=0;
;;;2242   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2243   		
;;;2244   		data[0]='B';
;;;2245   		data[1]='B';
;;;2246   		data[2]='B';
;;;2247   		data[3]='B';
;;;2248   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2249   		
;;;2250   		data[0]='B';
;;;2251   		data[1]='B';
;;;2252   		data[2]='B';
;;;2253   		data[3]='B';
;;;2254   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2255   		}
;;;2256   	}
;;;2257   }
0022c6  e561              B        |L1.7564|
                  |L1.8904|
0022c8  f04f0700          MOV      r7,#0                 ;2132
                  |L1.8908|
0022cc  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2134
0022d0  4669              MOV      r1,sp                 ;2136
0022d2  4628              MOV      r0,r5                 ;2136
0022d4  f7fffffe          BL       lc640_read_long_ptr
0022d8  f89d0000          LDRB     r0,[sp,#0]            ;2138
0022dc  2875              CMP      r0,#0x75              ;2138
0022de  d103              BNE      |L1.8936|
0022e0  f89d0002          LDRB     r0,[sp,#2]            ;2138
0022e4  285a              CMP      r0,#0x5a              ;2138
0022e6  d00a              BEQ      |L1.8958|
                  |L1.8936|
0022e8  b114              CBZ      r4,|L1.8944|
0022ea  f1a40401          SUB      r4,r4,#1              ;2140
0022ee  e001              B        |L1.8948|
                  |L1.8944|
0022f0  f04f043f          MOV      r4,#0x3f              ;2141
                  |L1.8948|
0022f4  42b4              CMP      r4,r6                 ;2142
0022f6  d122              BNE      |L1.9022|
0022f8  f04f0500          MOV      r5,#0                 ;2144
0022fc  e024              B        |L1.9032|
                  |L1.8958|
0022fe  4669              MOV      r1,sp                 ;2151
002300  f1050010          ADD      r0,r5,#0x10           ;2151
002304  f7fffffe          BL       lc640_read_long_ptr
002308  f89d0000          LDRB     r0,[sp,#0]            ;2152
00230c  2841              CMP      r0,#0x41              ;2152
00230e  d10b              BNE      |L1.9000|
002310  f89d0001          LDRB     r0,[sp,#1]            ;2152
002314  2841              CMP      r0,#0x41              ;2152
002316  d107              BNE      |L1.9000|
002318  f89d0002          LDRB     r0,[sp,#2]            ;2152
00231c  2841              CMP      r0,#0x41              ;2152
00231e  d103              BNE      |L1.9000|
002320  f89d0003          LDRB     r0,[sp,#3]            ;2152
002324  2841              CMP      r0,#0x41              ;2152
002326  d00a              BEQ      |L1.9022|
                  |L1.9000|
002328  b114              CBZ      r4,|L1.9008|
00232a  f1a40401          SUB      r4,r4,#1              ;2154
00232e  e001              B        |L1.9012|
                  |L1.9008|
002330  f04f043f          MOV      r4,#0x3f              ;2155
                  |L1.9012|
002334  42b4              CMP      r4,r6                 ;2156
002336  d102              BNE      |L1.9022|
002338  f04f0500          MOV      r5,#0                 ;2158
00233c  e004              B        |L1.9032|
                  |L1.9022|
00233e  f1070701          ADD      r7,r7,#1              ;2132
002342  b2ff              UXTB     r7,r7                 ;2132
002344  2f3f              CMP      r7,#0x3f              ;2132
002346  d3c1              BCC      |L1.8908|
                  |L1.9032|
002348  2d00              CMP      r5,#0                 ;2165
00234a  d0bc              BEQ      |L1.8902|
00234c  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2167
002350  f88d0000          STRB     r0,[sp,#0]            ;2167
002354  f8980038          LDRB     r0,[r8,#0x38]         ;2168
002358  f88d0001          STRB     r0,[sp,#1]            ;2168
00235c  f898002c          LDRB     r0,[r8,#0x2c]         ;2169
002360  f88d0002          STRB     r0,[sp,#2]            ;2169
002364  f88d9003          STRB     r9,[sp,#3]            ;2170
002368  4669              MOV      r1,sp                 ;2171
00236a  f1050010          ADD      r0,r5,#0x10           ;2171
00236e  f7fffffe          BL       lc640_write_long_ptr
002372  f8980028          LDRB     r0,[r8,#0x28]         ;2173
002376  f88d0000          STRB     r0,[sp,#0]            ;2173
00237a  f8980024          LDRB     r0,[r8,#0x24]         ;2174
00237e  f88d0001          STRB     r0,[sp,#1]            ;2174
002382  f8980020          LDRB     r0,[r8,#0x20]         ;2175
002386  f88d0002          STRB     r0,[sp,#2]            ;2175
00238a  f88d9003          STRB     r9,[sp,#3]            ;2176
00238e  4669              MOV      r1,sp                 ;2177
002390  f1050014          ADD      r0,r5,#0x14           ;2177
002394  f7fffffe          BL       lc640_write_long_ptr
002398  f04f0443          MOV      r4,#0x43              ;2179
00239c  f88d4000          STRB     r4,[sp,#0]            ;2179
0023a0  f88d4001          STRB     r4,[sp,#1]            ;2180
0023a4  f88d4002          STRB     r4,[sp,#2]            ;2181
0023a8  f88d4003          STRB     r4,[sp,#3]            ;2182
0023ac  4669              MOV      r1,sp                 ;2183
0023ae  f1050018          ADD      r0,r5,#0x18           ;2183
0023b2  f7fffffe          BL       lc640_write_long_ptr
0023b6  f88d4000          STRB     r4,[sp,#0]            ;2185
0023ba  f88d4001          STRB     r4,[sp,#1]            ;2186
0023be  f88d4002          STRB     r4,[sp,#2]            ;2187
0023c2  f88d4003          STRB     r4,[sp,#3]            ;2188
0023c6  4669              MOV      r1,sp                 ;2189
0023c8  f105001c          ADD      r0,r5,#0x1c           ;2189
0023cc  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9168|
0023d0  e4dc              B        |L1.7564|
                  |L1.9170|
0023d2  f89d0002          LDRB     r0,[sp,#2]            ;2203
0023d6  285a              CMP      r0,#0x5a              ;2203
0023d8  d00a              BEQ      |L1.9200|
                  |L1.9178|
0023da  b114              CBZ      r4,|L1.9186|
0023dc  f1a40401          SUB      r4,r4,#1              ;2205
0023e0  e001              B        |L1.9190|
                  |L1.9186|
0023e2  f04f043f          MOV      r4,#0x3f              ;2206
                  |L1.9190|
0023e6  42b4              CMP      r4,r6                 ;2207
0023e8  d122              BNE      |L1.9264|
0023ea  f04f0500          MOV      r5,#0                 ;2209
0023ee  e025              B        |L1.9276|
                  |L1.9200|
0023f0  4669              MOV      r1,sp                 ;2216
0023f2  f1050010          ADD      r0,r5,#0x10           ;2216
0023f6  f7fffffe          BL       lc640_read_long_ptr
0023fa  f89d0000          LDRB     r0,[sp,#0]            ;2217
0023fe  2841              CMP      r0,#0x41              ;2217
002400  d10b              BNE      |L1.9242|
002402  f89d0001          LDRB     r0,[sp,#1]            ;2217
002406  2841              CMP      r0,#0x41              ;2217
002408  d107              BNE      |L1.9242|
00240a  f89d0002          LDRB     r0,[sp,#2]            ;2217
00240e  2841              CMP      r0,#0x41              ;2217
002410  d103              BNE      |L1.9242|
002412  f89d0003          LDRB     r0,[sp,#3]            ;2217
002416  2841              CMP      r0,#0x41              ;2217
002418  d00a              BEQ      |L1.9264|
                  |L1.9242|
00241a  b114              CBZ      r4,|L1.9250|
00241c  f1a40401          SUB      r4,r4,#1              ;2219
002420  e001              B        |L1.9254|
                  |L1.9250|
002422  f04f043f          MOV      r4,#0x3f              ;2220
                  |L1.9254|
002426  42b4              CMP      r4,r6                 ;2221
002428  d102              BNE      |L1.9264|
00242a  f04f0500          MOV      r5,#0                 ;2223
00242e  e005              B        |L1.9276|
                  |L1.9264|
002430  f1070701          ADD      r7,r7,#1              ;2197
002434  b2ff              UXTB     r7,r7                 ;2197
002436  2f3f              CMP      r7,#0x3f              ;2197
002438  f4ffaea3          BCC      |L1.8578|
                  |L1.9276|
00243c  2d00              CMP      r5,#0                 ;2230
00243e  d0c7              BEQ      |L1.9168|
002440  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2232
002444  f88d0000          STRB     r0,[sp,#0]            ;2232
002448  f8980038          LDRB     r0,[r8,#0x38]         ;2233
00244c  f88d0001          STRB     r0,[sp,#1]            ;2233
002450  f898002c          LDRB     r0,[r8,#0x2c]         ;2234
002454  f88d0002          STRB     r0,[sp,#2]            ;2234
002458  f88d9003          STRB     r9,[sp,#3]            ;2235
00245c  4669              MOV      r1,sp                 ;2236
00245e  f1050010          ADD      r0,r5,#0x10           ;2236
002462  f7fffffe          BL       lc640_write_long_ptr
002466  f8980028          LDRB     r0,[r8,#0x28]         ;2238
00246a  f88d0000          STRB     r0,[sp,#0]            ;2238
00246e  f8980024          LDRB     r0,[r8,#0x24]         ;2239
002472  f88d0001          STRB     r0,[sp,#1]            ;2239
002476  f8980020          LDRB     r0,[r8,#0x20]         ;2240
00247a  f88d0002          STRB     r0,[sp,#2]            ;2240
00247e  f88d9003          STRB     r9,[sp,#3]            ;2241
002482  4669              MOV      r1,sp                 ;2242
002484  f1050014          ADD      r0,r5,#0x14           ;2242
002488  f7fffffe          BL       lc640_write_long_ptr
00248c  f04f0442          MOV      r4,#0x42              ;2244
002490  f88d4000          STRB     r4,[sp,#0]            ;2244
002494  f88d4001          STRB     r4,[sp,#1]            ;2245
002498  f88d4002          STRB     r4,[sp,#2]            ;2246
00249c  f88d4003          STRB     r4,[sp,#3]            ;2247
0024a0  4669              MOV      r1,sp                 ;2248
0024a2  f1050018          ADD      r0,r5,#0x18           ;2248
0024a6  f7fffffe          BL       lc640_write_long_ptr
0024aa  f88d4000          STRB     r4,[sp,#0]            ;2250
0024ae  f88d4001          STRB     r4,[sp,#1]            ;2251
0024b2  f88d4002          STRB     r4,[sp,#2]            ;2252
0024b6  f88d4003          STRB     r4,[sp,#3]            ;2253
0024ba  4669              MOV      r1,sp                 ;2254
0024bc  f105001c          ADD      r0,r5,#0x1c           ;2254
0024c0  f7fffffe          BL       lc640_write_long_ptr
0024c4  e462              B        |L1.7564|
;;;2258   
                          ENDP

                  fz_mem_hndl PROC
;;;2259   //-----------------------------------------------
;;;2260   void fz_mem_hndl(unsigned short in)	 //   
0024c6  e92d4ff8          PUSH     {r3-r11,lr}
;;;2261   {
;;;2262   char data[4];
;;;2263   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
0024ca  f04f0600          MOV      r6,#0
0024ce  4634              MOV      r4,r6
;;;2264   //char avar_simbol;
;;;2265   
;;;2266   if(in==1) //  
;;;2267   	{
;;;2268   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2269   	event_ptr++;	
;;;2270   	if(event_ptr>63)event_ptr=0;	
;;;2271   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2272   	
;;;2273       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2274   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2275   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2276   	
;;;2277   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2278   	
;;;2279   	data[0]='f';
;;;2280   	data[1]=0; 
;;;2281   	data[2]='Z';
;;;2282   	data[3]=0;
;;;2283   	lc640_write_long_ptr(lc640_adr,data);
;;;2284   
;;;2285   	data[0]=0;
;;;2286   	data[1]=0;
;;;2287   	data[2]=0;
;;;2288   	data[3]=0;
;;;2289   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2290   
;;;2291   	data[0]=LPC_RTC->YEAR;
0024d0  f8df835c          LDR      r8,|L1.10288|
0024d4  46a1              MOV      r9,r4                 ;2263
0024d6  f44f6a80          MOV      r10,#0x400            ;2277
0024da  2801              CMP      r0,#1                 ;2266
0024dc  d010              BEQ      |L1.9472|
;;;2292   	data[1]=LPC_RTC->MONTH;
;;;2293   	data[2]=LPC_RTC->DOM;
;;;2294   	data[3]=0;
;;;2295   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2296   
;;;2297   	data[0]=LPC_RTC->HOUR;
;;;2298   	data[1]=LPC_RTC->MIN;
;;;2299   	data[2]=LPC_RTC->SEC;
;;;2300   	data[3]=0;
;;;2301   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2302   	
;;;2303   	data[0]='A';
;;;2304   	data[1]='A';
;;;2305   	data[2]='A';
;;;2306   	data[3]='A';
;;;2307   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2308   	
;;;2309   	data[0]='A';
;;;2310   	data[1]='A';
;;;2311   	data[2]='A';
;;;2312   	data[3]='A';
;;;2313   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2314   	
;;;2315   	data[0]='A';
;;;2316   	data[1]='A';
;;;2317   	data[2]='A';
;;;2318   	data[3]='A';
;;;2319   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2320   	
;;;2321   	data[0]='A';
;;;2322   	data[1]='A';
;;;2323   	data[2]='A';
;;;2324   	data[3]='A';
;;;2325   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2326    	
;;;2327   	}
;;;2328   
;;;2329   else if(in==0)	// 
0024de  2800              CMP      r0,#0
0024e0  d07d              BEQ      |L1.9694|
;;;2330   	{      
;;;2331   	char i;     
;;;2332   	event_ptr_find=0;
;;;2333   	for (i=0;i<63;i++)
;;;2334   		{
;;;2335   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2336   
;;;2337        	lc640_read_long_ptr(lc640_adr,data);
;;;2338        
;;;2339        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;2340        		{        
;;;2341        		if(event_ptr_find)event_ptr_find--;
;;;2342        		else event_ptr_find=63;
;;;2343        		if(event_ptr_find==event_ptr)
;;;2344   				{
;;;2345   				lc640_adr=0;
;;;2346   				break;
;;;2347   				}
;;;2348        		else continue;
;;;2349        		}
;;;2350        	else 
;;;2351        		{
;;;2352        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2353        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2354        			{        
;;;2355        			if(event_ptr_find)event_ptr_find--;
;;;2356            		else event_ptr_find=63;
;;;2357            		if(event_ptr_find==event_ptr)
;;;2358   					{
;;;2359   					lc640_adr=0;
;;;2360   					break;
;;;2361   					}
;;;2362        			else continue;
;;;2363        			}
;;;2364        		}	
;;;2365   		}
;;;2366   	if(lc640_adr!=0)
;;;2367   		{
;;;2368   		data[0]=LPC_RTC->YEAR;
;;;2369   		data[1]=LPC_RTC->MONTH;
;;;2370   		data[2]=LPC_RTC->DOM;
;;;2371   		data[3]=0;
;;;2372   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2373   	
;;;2374   		data[0]=LPC_RTC->HOUR;
;;;2375   		data[1]=LPC_RTC->MIN;
;;;2376   		data[2]=LPC_RTC->SEC;
;;;2377   		data[3]=0;
;;;2378   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2379   		
;;;2380   		data[0]='C';
;;;2381   		data[1]='C';
;;;2382   		data[2]='C';
;;;2383   		data[3]='C';
;;;2384   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2385   		
;;;2386   		data[0]='C';
;;;2387   		data[1]='C';
;;;2388   		data[2]='C';
;;;2389   		data[3]='C';
;;;2390   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2391   		}
;;;2392   	}
;;;2393   else if(in==10) 	//  
0024e2  280a              CMP      r0,#0xa
0024e4  d17c              BNE      |L1.9696|
;;;2394   	{      
;;;2395   	char i;     
;;;2396   
;;;2397   	event_ptr_find=0;
;;;2398   	for (i=0;i<63;i++)
0024e6  f04f0700          MOV      r7,#0
                  |L1.9450|
;;;2399   		{
;;;2400   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
0024ea  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2401   
;;;2402        	lc640_read_long_ptr(lc640_adr,data);
0024ee  4669              MOV      r1,sp
0024f0  4628              MOV      r0,r5
0024f2  f7fffffe          BL       lc640_read_long_ptr
;;;2403        
;;;2404        	if(!((data[0]=='f')&&(data[2]=='Z')))
0024f6  f89d0000          LDRB     r0,[sp,#0]
0024fa  2866              CMP      r0,#0x66
0024fc  d171              BNE      |L1.9698|
0024fe  e11c              B        |L1.10042|
                  |L1.9472|
002500  f44f6560          MOV      r5,#0xe00             ;2268
002504  4628              MOV      r0,r5                 ;2268
002506  f7fffffe          BL       lc640_read_int
00250a  f1000001          ADD      r0,r0,#1              ;2269
00250e  4604              MOV      r4,r0                 ;2269
002510  2c3f              CMP      r4,#0x3f              ;2270
002512  d901              BLS      |L1.9496|
002514  f04f0400          MOV      r4,#0                 ;2270
                  |L1.9496|
002518  b221              SXTH     r1,r4                 ;2271
00251a  4628              MOV      r0,r5                 ;2271
00251c  f7fffffe          BL       lc640_write_int
002520  f6406602          MOV      r6,#0xe02             ;2273
002524  4630              MOV      r0,r6                 ;2273
002526  f7fffffe          BL       lc640_read_int
00252a  283f              CMP      r0,#0x3f              ;2274
00252c  d000              BEQ      |L1.9520|
00252e  4620              MOV      r0,r4                 ;2274
                  |L1.9520|
002530  b201              SXTH     r1,r0                 ;2275
002532  4630              MOV      r0,r6                 ;2275
002534  f7fffffe          BL       lc640_write_int
002538  4628              MOV      r0,r5                 ;2277
00253a  f7fffffe          BL       lc640_read_int
00253e  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2277
002542  f04f0066          MOV      r0,#0x66              ;2279
002546  f88d0000          STRB     r0,[sp,#0]            ;2279
00254a  f88d9001          STRB     r9,[sp,#1]            ;2280
00254e  f04f005a          MOV      r0,#0x5a              ;2281
002552  f88d0002          STRB     r0,[sp,#2]            ;2281
002556  f88d9003          STRB     r9,[sp,#3]            ;2282
00255a  4669              MOV      r1,sp                 ;2283
00255c  4620              MOV      r0,r4                 ;2283
00255e  f7fffffe          BL       lc640_write_long_ptr
002562  f8cd9000          STR      r9,[sp,#0]            ;2288
002566  4669              MOV      r1,sp                 ;2289
002568  1d20              ADDS     r0,r4,#4              ;2289
00256a  f7fffffe          BL       lc640_write_long_ptr
00256e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2291
002572  f88d0000          STRB     r0,[sp,#0]            ;2291
002576  f8980038          LDRB     r0,[r8,#0x38]         ;2292
00257a  f88d0001          STRB     r0,[sp,#1]            ;2292
00257e  f898002c          LDRB     r0,[r8,#0x2c]         ;2293
002582  f88d0002          STRB     r0,[sp,#2]            ;2293
002586  f88d9003          STRB     r9,[sp,#3]            ;2294
00258a  4669              MOV      r1,sp                 ;2295
00258c  f1040008          ADD      r0,r4,#8              ;2295
002590  f7fffffe          BL       lc640_write_long_ptr
002594  f8980028          LDRB     r0,[r8,#0x28]         ;2297
002598  f88d0000          STRB     r0,[sp,#0]            ;2297
00259c  f8980024          LDRB     r0,[r8,#0x24]         ;2298
0025a0  f88d0001          STRB     r0,[sp,#1]            ;2298
0025a4  f8980020          LDRB     r0,[r8,#0x20]         ;2299
0025a8  f88d0002          STRB     r0,[sp,#2]            ;2299
0025ac  f88d9003          STRB     r9,[sp,#3]            ;2300
0025b0  4669              MOV      r1,sp                 ;2301
0025b2  f104000c          ADD      r0,r4,#0xc            ;2301
0025b6  f7fffffe          BL       lc640_write_long_ptr
0025ba  f04f0541          MOV      r5,#0x41              ;2303
0025be  f88d5000          STRB     r5,[sp,#0]            ;2303
0025c2  f88d5001          STRB     r5,[sp,#1]            ;2304
0025c6  f88d5002          STRB     r5,[sp,#2]            ;2305
0025ca  f88d5003          STRB     r5,[sp,#3]            ;2306
0025ce  4669              MOV      r1,sp                 ;2307
0025d0  f1040010          ADD      r0,r4,#0x10           ;2307
0025d4  f7fffffe          BL       lc640_write_long_ptr
0025d8  f88d5000          STRB     r5,[sp,#0]            ;2309
0025dc  e002              B        |L1.9700|
                  |L1.9694|
0025de  e027              B        |L1.9776|
                  |L1.9696|
0025e0  e025              B        |L1.9774|
                  |L1.9698|
0025e2  e0ae              B        |L1.10050|
                  |L1.9700|
0025e4  f88d5001          STRB     r5,[sp,#1]            ;2310
0025e8  f88d5002          STRB     r5,[sp,#2]            ;2311
0025ec  f88d5003          STRB     r5,[sp,#3]            ;2312
0025f0  4669              MOV      r1,sp                 ;2313
0025f2  f1040014          ADD      r0,r4,#0x14           ;2313
0025f6  f7fffffe          BL       lc640_write_long_ptr
0025fa  f88d5000          STRB     r5,[sp,#0]            ;2315
0025fe  f88d5001          STRB     r5,[sp,#1]            ;2316
002602  f88d5002          STRB     r5,[sp,#2]            ;2317
002606  f88d5003          STRB     r5,[sp,#3]            ;2318
00260a  4669              MOV      r1,sp                 ;2319
00260c  f1040018          ADD      r0,r4,#0x18           ;2319
002610  f7fffffe          BL       lc640_write_long_ptr
002614  f88d5000          STRB     r5,[sp,#0]            ;2321
002618  f88d5001          STRB     r5,[sp,#1]            ;2322
00261c  f88d5002          STRB     r5,[sp,#2]            ;2323
002620  f88d5003          STRB     r5,[sp,#3]            ;2324
002624  4669              MOV      r1,sp                 ;2325
002626  f104001c          ADD      r0,r4,#0x1c           ;2325
00262a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9774|
;;;2405        		{        
;;;2406        		if(event_ptr_find)event_ptr_find--;
;;;2407        		else event_ptr_find=63;
;;;2408        		if(event_ptr_find==event_ptr)
;;;2409   				{
;;;2410   				lc640_adr=0;
;;;2411   				break;
;;;2412   				}
;;;2413        		else continue;
;;;2414        		}
;;;2415        	else 
;;;2416        		{
;;;2417        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2418        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2419        			{        
;;;2420        			if(event_ptr_find)event_ptr_find--;
;;;2421            		else event_ptr_find=63;
;;;2422            		if(event_ptr_find==event_ptr)
;;;2423   					{
;;;2424   					lc640_adr=0;
;;;2425   					break;
;;;2426   					}
;;;2427        			else continue;
;;;2428        			}
;;;2429        		}	
;;;2430   		}
;;;2431   	if(lc640_adr!=0)
;;;2432   		{
;;;2433   		data[0]=LPC_RTC->YEAR;
;;;2434   		data[1]=LPC_RTC->MONTH;
;;;2435   		data[2]=LPC_RTC->DOM;
;;;2436   		data[3]=0;
;;;2437   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2438   	
;;;2439   		data[0]=LPC_RTC->HOUR;
;;;2440   		data[1]=LPC_RTC->MIN;
;;;2441   		data[2]=LPC_RTC->SEC;
;;;2442   		data[3]=0;
;;;2443   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2444   		
;;;2445   		data[0]='B';
;;;2446   		data[1]='B';
;;;2447   		data[2]='B';
;;;2448   		data[3]='B';
;;;2449   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2450   		
;;;2451   		data[0]='B';
;;;2452   		data[1]='B';
;;;2453   		data[2]='B';
;;;2454   		data[3]='B';
;;;2455   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2456   		}
;;;2457   	}
;;;2458   }
00262e  e496              B        |L1.8030|
                  |L1.9776|
002630  f04f0700          MOV      r7,#0                 ;2333
                  |L1.9780|
002634  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2335
002638  4669              MOV      r1,sp                 ;2337
00263a  4628              MOV      r0,r5                 ;2337
00263c  f7fffffe          BL       lc640_read_long_ptr
002640  f89d0000          LDRB     r0,[sp,#0]            ;2339
002644  2866              CMP      r0,#0x66              ;2339
002646  d103              BNE      |L1.9808|
002648  f89d0002          LDRB     r0,[sp,#2]            ;2339
00264c  285a              CMP      r0,#0x5a              ;2339
00264e  d00a              BEQ      |L1.9830|
                  |L1.9808|
002650  b114              CBZ      r4,|L1.9816|
002652  f1a40401          SUB      r4,r4,#1              ;2341
002656  e001              B        |L1.9820|
                  |L1.9816|
002658  f04f043f          MOV      r4,#0x3f              ;2342
                  |L1.9820|
00265c  42b4              CMP      r4,r6                 ;2343
00265e  d122              BNE      |L1.9894|
002660  f04f0500          MOV      r5,#0                 ;2345
002664  e024              B        |L1.9904|
                  |L1.9830|
002666  4669              MOV      r1,sp                 ;2352
002668  f1050010          ADD      r0,r5,#0x10           ;2352
00266c  f7fffffe          BL       lc640_read_long_ptr
002670  f89d0000          LDRB     r0,[sp,#0]            ;2353
002674  2841              CMP      r0,#0x41              ;2353
002676  d10b              BNE      |L1.9872|
002678  f89d0001          LDRB     r0,[sp,#1]            ;2353
00267c  2841              CMP      r0,#0x41              ;2353
00267e  d107              BNE      |L1.9872|
002680  f89d0002          LDRB     r0,[sp,#2]            ;2353
002684  2841              CMP      r0,#0x41              ;2353
002686  d103              BNE      |L1.9872|
002688  f89d0003          LDRB     r0,[sp,#3]            ;2353
00268c  2841              CMP      r0,#0x41              ;2353
00268e  d00a              BEQ      |L1.9894|
                  |L1.9872|
002690  b114              CBZ      r4,|L1.9880|
002692  f1a40401          SUB      r4,r4,#1              ;2355
002696  e001              B        |L1.9884|
                  |L1.9880|
002698  f04f043f          MOV      r4,#0x3f              ;2356
                  |L1.9884|
00269c  42b4              CMP      r4,r6                 ;2357
00269e  d102              BNE      |L1.9894|
0026a0  f04f0500          MOV      r5,#0                 ;2359
0026a4  e004              B        |L1.9904|
                  |L1.9894|
0026a6  f1070701          ADD      r7,r7,#1              ;2333
0026aa  b2ff              UXTB     r7,r7                 ;2333
0026ac  2f3f              CMP      r7,#0x3f              ;2333
0026ae  d3c1              BCC      |L1.9780|
                  |L1.9904|
0026b0  2d00              CMP      r5,#0                 ;2366
0026b2  d0bc              BEQ      |L1.9774|
0026b4  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2368
0026b8  f88d0000          STRB     r0,[sp,#0]            ;2368
0026bc  f8980038          LDRB     r0,[r8,#0x38]         ;2369
0026c0  f88d0001          STRB     r0,[sp,#1]            ;2369
0026c4  f898002c          LDRB     r0,[r8,#0x2c]         ;2370
0026c8  f88d0002          STRB     r0,[sp,#2]            ;2370
0026cc  f88d9003          STRB     r9,[sp,#3]            ;2371
0026d0  4669              MOV      r1,sp                 ;2372
0026d2  f1050010          ADD      r0,r5,#0x10           ;2372
0026d6  f7fffffe          BL       lc640_write_long_ptr
0026da  f8980028          LDRB     r0,[r8,#0x28]         ;2374
0026de  f88d0000          STRB     r0,[sp,#0]            ;2374
0026e2  f8980024          LDRB     r0,[r8,#0x24]         ;2375
0026e6  f88d0001          STRB     r0,[sp,#1]            ;2375
0026ea  f8980020          LDRB     r0,[r8,#0x20]         ;2376
0026ee  f88d0002          STRB     r0,[sp,#2]            ;2376
0026f2  f88d9003          STRB     r9,[sp,#3]            ;2377
0026f6  4669              MOV      r1,sp                 ;2378
0026f8  f1050014          ADD      r0,r5,#0x14           ;2378
0026fc  f7fffffe          BL       lc640_write_long_ptr
002700  f04f0443          MOV      r4,#0x43              ;2380
002704  f88d4000          STRB     r4,[sp,#0]            ;2380
002708  f88d4001          STRB     r4,[sp,#1]            ;2381
00270c  f88d4002          STRB     r4,[sp,#2]            ;2382
002710  f88d4003          STRB     r4,[sp,#3]            ;2383
002714  4669              MOV      r1,sp                 ;2384
002716  f1050018          ADD      r0,r5,#0x18           ;2384
00271a  f7fffffe          BL       lc640_write_long_ptr
00271e  f88d4000          STRB     r4,[sp,#0]            ;2386
002722  f88d4001          STRB     r4,[sp,#1]            ;2387
002726  f88d4002          STRB     r4,[sp,#2]            ;2388
00272a  f88d4003          STRB     r4,[sp,#3]            ;2389
00272e  4669              MOV      r1,sp                 ;2390
002730  f105001c          ADD      r0,r5,#0x1c           ;2390
002734  f7fffffe          BL       lc640_write_long_ptr
                  |L1.10040|
002738  e411              B        |L1.8030|
                  |L1.10042|
00273a  f89d0002          LDRB     r0,[sp,#2]            ;2404
00273e  285a              CMP      r0,#0x5a              ;2404
002740  d00a              BEQ      |L1.10072|
                  |L1.10050|
002742  b114              CBZ      r4,|L1.10058|
002744  f1a40401          SUB      r4,r4,#1              ;2406
002748  e001              B        |L1.10062|
                  |L1.10058|
00274a  f04f043f          MOV      r4,#0x3f              ;2407
                  |L1.10062|
00274e  42b4              CMP      r4,r6                 ;2408
002750  d122              BNE      |L1.10136|
002752  f04f0500          MOV      r5,#0                 ;2410
002756  e025              B        |L1.10148|
                  |L1.10072|
002758  4669              MOV      r1,sp                 ;2417
00275a  f1050010          ADD      r0,r5,#0x10           ;2417
00275e  f7fffffe          BL       lc640_read_long_ptr
002762  f89d0000          LDRB     r0,[sp,#0]            ;2418
002766  2841              CMP      r0,#0x41              ;2418
002768  d10b              BNE      |L1.10114|
00276a  f89d0001          LDRB     r0,[sp,#1]            ;2418
00276e  2841              CMP      r0,#0x41              ;2418
002770  d107              BNE      |L1.10114|
002772  f89d0002          LDRB     r0,[sp,#2]            ;2418
002776  2841              CMP      r0,#0x41              ;2418
002778  d103              BNE      |L1.10114|
00277a  f89d0003          LDRB     r0,[sp,#3]            ;2418
00277e  2841              CMP      r0,#0x41              ;2418
002780  d00a              BEQ      |L1.10136|
                  |L1.10114|
002782  b114              CBZ      r4,|L1.10122|
002784  f1a40401          SUB      r4,r4,#1              ;2420
002788  e001              B        |L1.10126|
                  |L1.10122|
00278a  f04f043f          MOV      r4,#0x3f              ;2421
                  |L1.10126|
00278e  42b4              CMP      r4,r6                 ;2422
002790  d102              BNE      |L1.10136|
002792  f04f0500          MOV      r5,#0                 ;2424
002796  e005              B        |L1.10148|
                  |L1.10136|
002798  f1070701          ADD      r7,r7,#1              ;2398
00279c  b2ff              UXTB     r7,r7                 ;2398
00279e  2f3f              CMP      r7,#0x3f              ;2398
0027a0  f4ffaea3          BCC      |L1.9450|
                  |L1.10148|
0027a4  2d00              CMP      r5,#0                 ;2431
0027a6  d0c7              BEQ      |L1.10040|
0027a8  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2433
0027ac  f88d0000          STRB     r0,[sp,#0]            ;2433
0027b0  f8980038          LDRB     r0,[r8,#0x38]         ;2434
0027b4  f88d0001          STRB     r0,[sp,#1]            ;2434
0027b8  f898002c          LDRB     r0,[r8,#0x2c]         ;2435
0027bc  f88d0002          STRB     r0,[sp,#2]            ;2435
0027c0  f88d9003          STRB     r9,[sp,#3]            ;2436
0027c4  4669              MOV      r1,sp                 ;2437
0027c6  f1050010          ADD      r0,r5,#0x10           ;2437
0027ca  f7fffffe          BL       lc640_write_long_ptr
0027ce  f8980028          LDRB     r0,[r8,#0x28]         ;2439
0027d2  f88d0000          STRB     r0,[sp,#0]            ;2439
0027d6  f8980024          LDRB     r0,[r8,#0x24]         ;2440
0027da  f88d0001          STRB     r0,[sp,#1]            ;2440
0027de  f8980020          LDRB     r0,[r8,#0x20]         ;2441
0027e2  f88d0002          STRB     r0,[sp,#2]            ;2441
0027e6  f88d9003          STRB     r9,[sp,#3]            ;2442
0027ea  4669              MOV      r1,sp                 ;2443
0027ec  f1050014          ADD      r0,r5,#0x14           ;2443
0027f0  f7fffffe          BL       lc640_write_long_ptr
0027f4  f04f0442          MOV      r4,#0x42              ;2445
0027f8  f88d4000          STRB     r4,[sp,#0]            ;2445
0027fc  f88d4001          STRB     r4,[sp,#1]            ;2446
002800  f88d4002          STRB     r4,[sp,#2]            ;2447
002804  f88d4003          STRB     r4,[sp,#3]            ;2448
002808  4669              MOV      r1,sp                 ;2449
00280a  f1050018          ADD      r0,r5,#0x18           ;2449
00280e  f7fffffe          BL       lc640_write_long_ptr
002812  f88d4000          STRB     r4,[sp,#0]            ;2451
002816  f88d4001          STRB     r4,[sp,#1]            ;2452
00281a  f88d4002          STRB     r4,[sp,#2]            ;2453
00281e  f88d4003          STRB     r4,[sp,#3]            ;2454
002822  4669              MOV      r1,sp                 ;2455
002824  f105001c          ADD      r0,r5,#0x1c           ;2455
002828  f7fffffe          BL       lc640_write_long_ptr
00282c  e41c              B        |L1.8296|
                          ENDP

00282e  0000              DCW      0x0000
                  |L1.10288|
                          DCD      0x40024000

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  ke_mem_hndl PROC
;;;78     //-----------------------------------------------
;;;79     void avar_hndl(void)
000000  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;80     {
;;;81     //static unsigned avar_stat_old;
;;;82     char i;
;;;83     //unsigned avar_stat_new,avar_stat_offed;
;;;84     
;;;85     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  b083              SUB      sp,sp,#0xc
000004  4605              MOV      r5,r0
000006  eb050045          ADD      r0,r5,r5,LSL #1
00000a  4948              LDR      r1,|L2.300|
00000c  eb001005          ADD      r0,r0,r5,LSL #4
000010  eb010180          ADD      r1,r1,r0,LSL #2
;;;86     else	   			SET_REG(avar_stat,0,0,1);
000014  4846              LDR      r0,|L2.304|
000016  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
;;;87     #ifndef UKU_220_IPS_TERMOKOMPENSAT //o_10
;;;88     for(i=0;i<2;i++)
;;;89     	{
;;;90     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
;;;91     	else	   			SET_REG(avar_stat,0,1+i,1);
;;;92     	}
;;;93     #endif //o_10
;;;94     for(i=0;i<18;i++)
00001a  f1000001          ADD      r0,r0,#1
;;;95     	{
;;;96     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00001e  eb010040          ADD      r0,r1,r0,LSL #1
000022  f9b00020          LDRSH    r0,[r0,#0x20]
000026  9001              STR      r0,[sp,#4]
000028  f44f6660          MOV      r6,#0xe00
00002c  4630              MOV      r0,r6
00002e  f7fffffe          BL       lc640_read_int
000032  f1000001          ADD      r0,r0,#1
000036  4604              MOV      r4,r0
000038  2c3f              CMP      r4,#0x3f
00003a  d901              BLS      |L2.64|
00003c  f04f0400          MOV      r4,#0
                  |L2.64|
000040  b221              SXTH     r1,r4
000042  4630              MOV      r0,r6
000044  f7fffffe          BL       lc640_write_int
000048  f6406702          MOV      r7,#0xe02
00004c  4638              MOV      r0,r7
;;;97     	else	   		SET_REG(avar_stat,0,3+i,1);
00004e  f7fffffe          BL       lc640_read_int
000052  283f              CMP      r0,#0x3f
000054  d000              BEQ      |L2.88|
000056  4620              MOV      r0,r4
                  |L2.88|
000058  b201              SXTH     r1,r0
00005a  4638              MOV      r0,r7
00005c  f7fffffe          BL       lc640_write_int
000060  4630              MOV      r0,r6                 ;94
000062  f7fffffe          BL       lc640_read_int
000066  f44f6180          MOV      r1,#0x400             ;94
;;;98     	}
;;;99     
;;;100    /*for(i=0;i<6;i++)
;;;101    	{
;;;102    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
;;;103    	else	   		SET_REG(avar_stat,0,15+i,1);
;;;104    	}*/
;;;105    
;;;106    /*for(i=0;i<4;i++)
;;;107    	{
;;;108    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;109    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;110    	}  */
;;;111    #ifndef UKU_FSO
;;;112    for(i=0;i<4;i++)
00006a  eb011440          ADD      r4,r1,r0,LSL #5
;;;113    	{
;;;114    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
00006e  f04f0042          MOV      r0,#0x42
000072  f88d0008          STRB     r0,[sp,#8]
;;;115    	else	   		SET_REG(avar_stat,0,24+i,1);
000076  f88d5009          STRB     r5,[sp,#9]
00007a  f04f004b          MOV      r0,#0x4b
00007e  f88d000a          STRB     r0,[sp,#0xa]
000082  f04f0600          MOV      r6,#0
000086  f88d600b          STRB     r6,[sp,#0xb]          ;112
00008a  a902              ADD      r1,sp,#8              ;112
00008c  4620              MOV      r0,r4                 ;112
;;;116    	}
;;;117    #endif //UKU_FSO
;;;118    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;119    //else	   			SET_REG(avar_stat,0,28,1);
;;;120    
;;;121    
;;;122    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
00008e  f7fffffe          BL       lc640_write_long_ptr
000092  f89d0010          LDRB     r0,[sp,#0x10]
000096  f88d0008          STRB     r0,[sp,#8]
;;;123    
;;;124    avar_ind_stat|=avar_stat_new;
00009a  f89d0011          LDRB     r0,[sp,#0x11]
00009e  f88d0009          STRB     r0,[sp,#9]
;;;125    
;;;126    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
0000a2  f89d0004          LDRB     r0,[sp,#4]
0000a6  f88d000a          STRB     r0,[sp,#0xa]
0000aa  f89d0005          LDRB     r0,[sp,#5]
;;;127    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
0000ae  f88d000b          STRB     r0,[sp,#0xb]
0000b2  a902              ADD      r1,sp,#8
0000b4  1d20              ADDS     r0,r4,#4
0000b6  f7fffffe          BL       lc640_write_long_ptr
;;;128    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
0000ba  f24020a2          MOV      r0,#0x2a2
0000be  f7fffffe          BL       lc640_read_long
0000c2  4d1c              LDR      r5,|L2.308|
;;;129    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
0000c4  6028              STR      r0,[r5,#0]  ; ke_date
0000c6  4629              MOV      r1,r5
0000c8  f1040008          ADD      r0,r4,#8
0000cc  f7fffffe          BL       lc640_write_long_ptr
;;;130    
;;;131    
;;;132    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
0000d0  f24020a6          MOV      r0,#0x2a6
0000d4  f7fffffe          BL       lc640_read_long
0000d8  6068              STR      r0,[r5,#4]  ; ke_date
;;;133    
;;;134    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
0000da  1d29              ADDS     r1,r5,#4
0000dc  f104000c          ADD      r0,r4,#0xc
0000e0  f7fffffe          BL       lc640_write_long_ptr
0000e4  4d14              LDR      r5,|L2.312|
0000e6  8ba8              LDRH     r0,[r5,#0x1c]         ;114
0000e8  f88d0008          STRB     r0,[sp,#8]            ;114
0000ec  7e28              LDRB     r0,[r5,#0x18]         ;114
0000ee  f88d0009          STRB     r0,[sp,#9]            ;114
0000f2  7b28              LDRB     r0,[r5,#0xc]          ;114
0000f4  f88d000a          STRB     r0,[sp,#0xa]          ;114
0000f8  f88d600b          STRB     r6,[sp,#0xb]
0000fc  a902              ADD      r1,sp,#8
0000fe  f1040010          ADD      r0,r4,#0x10
;;;135    
;;;136    avar_ind_stat&=avar_stat_offed; 
000102  f7fffffe          BL       lc640_write_long_ptr
000106  7a28              LDRB     r0,[r5,#8]
000108  f88d0008          STRB     r0,[sp,#8]
;;;137    
;;;138    avar_stat_old=avar_stat;
;;;139    
;;;140    //oleg_start
;;;141    
;;;142    
;;;143    
;;;144    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
00010c  7928              LDRB     r0,[r5,#4]
00010e  f88d0009          STRB     r0,[sp,#9]
000112  7828              LDRB     r0,[r5,#0]
000114  f88d000a          STRB     r0,[sp,#0xa]
000118  f88d600b          STRB     r6,[sp,#0xb]
00011c  a902              ADD      r1,sp,#8
;;;145    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
00011e  f1040014          ADD      r0,r4,#0x14
000122  f7fffffe          BL       lc640_write_long_ptr
;;;146    rki_avar1_ind_stat|=rki_avar1_stat_new;
000126  b005              ADD      sp,sp,#0x14
000128  bdf0              POP      {r4-r7,pc}
;;;147    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
;;;148    rki_avar1_ind_stat&=rki_avar1_stat_offed;
;;;149    rki_avar1_stat_old=rki_avar1_stat;
;;;150    /*
;;;151    rki_avarI1_stat=status_di1;
;;;152    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;153    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;154    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;155    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;156    rki_avarI1_stat_old=rki_avarI1_stat;
;;;157    
;;;158    rki_avarI2_stat=status_di2;
;;;159    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;160    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;161    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;162    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;163    rki_avarI2_stat_old=rki_avarI2_stat;
;;;164    */
;;;165    //oleg_end
;;;166    }
;;;167    
                          ENDP

00012a  0000              DCW      0x0000
                  |L2.300|
                          DCD      bat
                  |L2.304|
                          DCD      bat_u_old_cnt
                  |L2.308|
                          DCD      ke_date
                  |L2.312|
                          DCD      0x40024020

                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  rki_avar1_stat
                          DCD      0x00000000
                  rki_avar1_ind_stat
                          DCD      0x00000000
                  rki_avar1_stat_old
                          DCD      0x00000000
                  rki_avar1_stat_new
                          DCD      0x00000000
                  rki_avar1_stat_offed
                          DCD      0x00000000

                          AREA ||area_number.6||, DATA, ALIGN=0

                          EXPORTAS ||area_number.6||, ||.data||
                  av_inv
                          DCDU     0x00000000
000004  0000              DCB      0x00,0x00
