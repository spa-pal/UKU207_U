; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\avar_hndl.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DUKU_ZVU --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;77     //-----------------------------------------------
;;;78     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;79     {
;;;80     //static unsigned avar_stat_old;
;;;81     char i;
;;;82     //unsigned avar_stat_new,avar_stat_offed;
;;;83     
;;;84     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48ff              LDR      r0,|L1.1024|
000004  4bff              LDR      r3,|L1.1028|
000006  7801              LDRB     r1,[r0,#0]  ; net_av
000008  6818              LDR      r0,[r3,#0]
00000a  b119              CBZ      r1,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6018              STR      r0,[r3,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;85     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6018              STR      r0,[r3,#0]  ; avar_stat
                  |L1.26|
;;;86     
;;;87     for(i=0;i<2;i++)
00001a  f04f0000          MOV      r0,#0
;;;88     	{
;;;89     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
00001e  4dfa              LDR      r5,|L1.1032|
000020  f04f0401          MOV      r4,#1
                  |L1.36|
000024  eb000140          ADD      r1,r0,r0,LSL #1
000028  eb011100          ADD      r1,r1,r0,LSL #4
00002c  eb050181          ADD      r1,r5,r1,LSL #2
000030  f891103d          LDRB     r1,[r1,#0x3d]
000034  0789              LSLS     r1,r1,#30
000036  d00a              BEQ      |L1.78|
000038  f1000101          ADD      r1,r0,#1
00003c  fa04f201          LSL      r2,r4,r1
000040  6819              LDR      r1,[r3,#0]  ; avar_stat
000042  ea210102          BIC      r1,r1,r2
000046  ea410102          ORR      r1,r1,r2
00004a  6019              STR      r1,[r3,#0]  ; avar_stat
00004c  e007              B        |L1.94|
                  |L1.78|
;;;90     	else	   			SET_REG(avar_stat,0,1+i,1);
00004e  f1000201          ADD      r2,r0,#1
000052  fa04f102          LSL      r1,r4,r2
000056  681a              LDR      r2,[r3,#0]  ; avar_stat
000058  ea220201          BIC      r2,r2,r1
00005c  601a              STR      r2,[r3,#0]  ; avar_stat
                  |L1.94|
00005e  f1000001          ADD      r0,r0,#1              ;87
000062  b2c0              UXTB     r0,r0                 ;87
000064  2802              CMP      r0,#2                 ;87
000066  d3dd              BCC      |L1.36|
;;;91     	}
;;;92     
;;;93     for(i=0;i<12;i++)
000068  f04f0000          MOV      r0,#0
;;;94     	{
;;;95     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00006c  4de7              LDR      r5,|L1.1036|
                  |L1.110|
00006e  ebc001c0          RSB      r1,r0,r0,LSL #3
000072  eb011100          ADD      r1,r1,r0,LSL #4
000076  eb050181          ADD      r1,r5,r1,LSL #2
00007a  7849              LDRB     r1,[r1,#1]
00007c  f0110fef          TST      r1,#0xef
000080  d00a              BEQ      |L1.152|
000082  f1000203          ADD      r2,r0,#3
000086  fa04f102          LSL      r1,r4,r2
00008a  681a              LDR      r2,[r3,#0]  ; avar_stat
00008c  ea220201          BIC      r2,r2,r1
000090  ea420201          ORR      r2,r2,r1
000094  601a              STR      r2,[r3,#0]  ; avar_stat
000096  e007              B        |L1.168|
                  |L1.152|
;;;96     	else	   		SET_REG(avar_stat,0,3+i,1);
000098  f1000103          ADD      r1,r0,#3
00009c  fa04f201          LSL      r2,r4,r1
0000a0  6819              LDR      r1,[r3,#0]  ; avar_stat
0000a2  ea210102          BIC      r1,r1,r2
0000a6  6019              STR      r1,[r3,#0]  ; avar_stat
                  |L1.168|
0000a8  f1000001          ADD      r0,r0,#1              ;93
0000ac  b2c0              UXTB     r0,r0                 ;93
0000ae  280c              CMP      r0,#0xc               ;93
0000b0  d3dd              BCC      |L1.110|
;;;97     	}
;;;98     
;;;99     for(i=0;i<6;i++)
0000b2  f04f0000          MOV      r0,#0
;;;100    	{
;;;101    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
0000b6  4ad3              LDR      r2,|L1.1028|
0000b8  f1020228          ADD      r2,r2,#0x28
                  |L1.188|
0000bc  5c11              LDRB     r1,[r2,r0]
0000be  b151              CBZ      r1,|L1.214|
0000c0  f100050f          ADD      r5,r0,#0xf
0000c4  fa04f105          LSL      r1,r4,r5
0000c8  681d              LDR      r5,[r3,#0]  ; avar_stat
0000ca  ea250501          BIC      r5,r5,r1
0000ce  ea450501          ORR      r5,r5,r1
0000d2  601d              STR      r5,[r3,#0]  ; avar_stat
0000d4  e007              B        |L1.230|
                  |L1.214|
;;;102    	else	   		SET_REG(avar_stat,0,15+i,1);
0000d6  f100010f          ADD      r1,r0,#0xf
0000da  fa04f501          LSL      r5,r4,r1
0000de  6819              LDR      r1,[r3,#0]  ; avar_stat
0000e0  ea210105          BIC      r1,r1,r5
0000e4  6019              STR      r1,[r3,#0]  ; avar_stat
                  |L1.230|
0000e6  f1000001          ADD      r0,r0,#1              ;99
0000ea  b2c0              UXTB     r0,r0                 ;99
0000ec  2806              CMP      r0,#6                 ;99
0000ee  d3e5              BCC      |L1.188|
;;;103    	}
;;;104    
;;;105    /*for(i=0;i<4;i++)
;;;106    	{
;;;107    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;108    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;109    	}  */
;;;110    for(i=0;i<4;i++)
0000f0  f04f0000          MOV      r0,#0
;;;111    	{
;;;112    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000f4  4dc6              LDR      r5,|L1.1040|
                  |L1.246|
0000f6  5c29              LDRB     r1,[r5,r0]
0000f8  2901              CMP      r1,#1
0000fa  d036              BEQ      |L1.362|
;;;113    	else	   		SET_REG(avar_stat,0,24+i,1);
0000fc  f1000118          ADD      r1,r0,#0x18
000100  681a              LDR      r2,[r3,#0]  ; avar_stat
000102  fa04f101          LSL      r1,r4,r1
000106  ea220201          BIC      r2,r2,r1
00010a  601a              STR      r2,[r3,#0]  ; avar_stat
                  |L1.268|
00010c  f1000001          ADD      r0,r0,#1              ;110
000110  b2c0              UXTB     r0,r0                 ;110
000112  2804              CMP      r0,#4                 ;110
000114  d3ef              BCC      |L1.246|
;;;114    	}
;;;115    
;;;116    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;117    //else	   			SET_REG(avar_stat,0,28,1);
;;;118    
;;;119    
;;;120    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000116  689a              LDR      r2,[r3,#8]  ; avar_stat_old
000118  6818              LDR      r0,[r3,#0]  ; avar_stat
00011a  ea200102          BIC      r1,r0,r2
00011e  60d9              STR      r1,[r3,#0xc]  ; avar_stat_new
;;;121    
;;;122    avar_ind_stat|=avar_stat_new;
000120  685c              LDR      r4,[r3,#4]  ; avar_ind_stat
000122  ea440401          ORR      r4,r4,r1
000126  605c              STR      r4,[r3,#4]  ; avar_ind_stat
;;;123    
;;;124    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000128  49ba              LDR      r1,|L1.1044|
00012a  880d              LDRH     r5,[r1,#0]  ; SK_ZVUK_EN
00012c  b115              CBZ      r5,|L1.308|
00012e  f0247480          BIC      r4,r4,#0x1000000
000132  605c              STR      r4,[r3,#4]  ; avar_ind_stat
                  |L1.308|
;;;125    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
000134  884c              LDRH     r4,[r1,#2]  ; SK_ZVUK_EN
000136  b11c              CBZ      r4,|L1.320|
000138  685c              LDR      r4,[r3,#4]  ; avar_ind_stat
00013a  f0247400          BIC      r4,r4,#0x2000000
00013e  605c              STR      r4,[r3,#4]  ; avar_ind_stat
                  |L1.320|
;;;126    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
000140  888c              LDRH     r4,[r1,#4]  ; SK_ZVUK_EN
000142  b11c              CBZ      r4,|L1.332|
000144  685c              LDR      r4,[r3,#4]  ; avar_ind_stat
000146  f0246480          BIC      r4,r4,#0x4000000
00014a  605c              STR      r4,[r3,#4]  ; avar_ind_stat
                  |L1.332|
;;;127    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
00014c  88c9              LDRH     r1,[r1,#6]  ; SK_ZVUK_EN
00014e  b119              CBZ      r1,|L1.344|
000150  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
000152  f0216100          BIC      r1,r1,#0x8000000
000156  6059              STR      r1,[r3,#4]  ; avar_ind_stat
                  |L1.344|
;;;128    
;;;129    
;;;130    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
000158  ea220200          BIC      r2,r2,r0
00015c  ea6f0102          MVN      r1,r2
000160  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
;;;131    
;;;132    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
000162  4aad              LDR      r2,|L1.1048|
000164  8812              LDRH     r2,[r2,#0]  ; AV_OFF_AVT
000166  b15a              CBZ      r2,|L1.384|
000168  e00e              B        |L1.392|
                  |L1.362|
00016a  f1000218          ADD      r2,r0,#0x18           ;112
00016e  fa04f102          LSL      r1,r4,r2              ;112
000172  681a              LDR      r2,[r3,#0]            ;112  ; avar_stat
000174  ea220201          BIC      r2,r2,r1              ;112
000178  ea420201          ORR      r2,r2,r1              ;112
00017c  601a              STR      r2,[r3,#0]            ;112  ; avar_stat
00017e  e7c5              B        |L1.268|
                  |L1.384|
000180  4aa6              LDR      r2,|L1.1052|
000182  ea410102          ORR      r1,r1,r2
000186  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
                  |L1.392|
;;;133    
;;;134    avar_ind_stat&=avar_stat_offed; 
000188  691a              LDR      r2,[r3,#0x10]  ; avar_stat_offed
00018a  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
00018c  ea010102          AND      r1,r1,r2
000190  6059              STR      r1,[r3,#4]  ; avar_ind_stat
;;;135    
;;;136    avar_stat_old=avar_stat;
000192  6098              STR      r0,[r3,#8]  ; avar_stat_old
;;;137    
;;;138    //oleg_start
;;;139    
;;;140    
;;;141    
;;;142    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
000194  48a2              LDR      r0,|L1.1056|
000196  49a3              LDR      r1,|L1.1060|
000198  8800              LDRH     r0,[r0,#0]  ; status_izm_r
00019a  6809              LDR      r1,[r1,#0]  ; sk_alarm
00019c  f000003f          AND      r0,r0,#0x3f
0001a0  ea402001          ORR      r0,r0,r1,LSL #8
0001a4  6158              STR      r0,[r3,#0x14]  ; rki_avar1_stat
;;;143    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
0001a6  69da              LDR      r2,[r3,#0x1c]  ; rki_avar1_stat_old
0001a8  ea200102          BIC      r1,r0,r2
0001ac  6219              STR      r1,[r3,#0x20]  ; rki_avar1_stat_new
;;;144    rki_avar1_ind_stat|=rki_avar1_stat_new;
0001ae  699c              LDR      r4,[r3,#0x18]  ; rki_avar1_ind_stat
0001b0  ea440401          ORR      r4,r4,r1
;;;145    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
0001b4  ea220200          BIC      r2,r2,r0
0001b8  ea6f0102          MVN      r1,r2
0001bc  6259              STR      r1,[r3,#0x24]  ; rki_avar1_stat_offed
;;;146    rki_avar1_ind_stat&=rki_avar1_stat_offed;
0001be  ea040401          AND      r4,r4,r1
0001c2  619c              STR      r4,[r3,#0x18]  ; rki_avar1_ind_stat
;;;147    rki_avar1_stat_old=rki_avar1_stat;
0001c4  61d8              STR      r0,[r3,#0x1c]  ; rki_avar1_stat_old
;;;148    /*
;;;149    rki_avarI1_stat=status_di1;
;;;150    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;151    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;152    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;153    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;154    rki_avarI1_stat_old=rki_avarI1_stat;
;;;155    
;;;156    rki_avarI2_stat=status_di2;
;;;157    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;158    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;159    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;160    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;161    rki_avarI2_stat_old=rki_avarI2_stat;
;;;162    */
;;;163    //oleg_end
;;;164    }
0001c6  bd30              POP      {r4,r5,pc}
;;;165    
                          ENDP

                  reload_hndl PROC
;;;166    //-----------------------------------------------
;;;167    void reload_hndl(void)
0001c8  b5f8              PUSH     {r3-r7,lr}
;;;168    {
;;;169    
;;;170    char data[4];
;;;171    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;172    
;;;173    event_ptr=lc640_read_int(PTR_EVENT_LOG);
0001ca  f44f6560          MOV      r5,#0xe00
0001ce  4628              MOV      r0,r5
0001d0  f7fffffe          BL       lc640_read_int
;;;174    event_ptr++;	
0001d4  f1000001          ADD      r0,r0,#1
0001d8  4604              MOV      r4,r0
;;;175    if(event_ptr>63)event_ptr=0;	
0001da  2c3f              CMP      r4,#0x3f
0001dc  d901              BLS      |L1.482|
0001de  f04f0400          MOV      r4,#0
                  |L1.482|
;;;176    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
0001e2  b221              SXTH     r1,r4
0001e4  4628              MOV      r0,r5
0001e6  f7fffffe          BL       lc640_write_int
;;;177    	
;;;178    event_cnt=lc640_read_int(CNT_EVENT_LOG);
0001ea  f6406602          MOV      r6,#0xe02
0001ee  4630              MOV      r0,r6
0001f0  f7fffffe          BL       lc640_read_int
;;;179    if(event_cnt!=63)event_cnt=event_ptr;
0001f4  283f              CMP      r0,#0x3f
0001f6  d000              BEQ      |L1.506|
0001f8  4620              MOV      r0,r4
                  |L1.506|
;;;180    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
0001fa  b201              SXTH     r1,r0
0001fc  4630              MOV      r0,r6
0001fe  f7fffffe          BL       lc640_write_int
;;;181    	
;;;182    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000202  4628              MOV      r0,r5
000204  f7fffffe          BL       lc640_read_int
000208  f44f6180          MOV      r1,#0x400
00020c  eb011440          ADD      r4,r1,r0,LSL #5
;;;183    	
;;;184    data[0]='U';
000210  f04f0055          MOV      r0,#0x55
000214  f88d0000          STRB     r0,[sp,#0]
;;;185    data[1]=0;
000218  f04f0600          MOV      r6,#0
00021c  f88d6001          STRB     r6,[sp,#1]
;;;186    data[2]='R';
000220  f04f0052          MOV      r0,#0x52
000224  f88d0002          STRB     r0,[sp,#2]
;;;187    data[3]=0;
000228  f88d6003          STRB     r6,[sp,#3]
;;;188    lc640_write_long_ptr(lc640_adr,data);
00022c  4669              MOV      r1,sp
00022e  4620              MOV      r0,r4
000230  f7fffffe          BL       lc640_write_long_ptr
;;;189    
;;;190    data[0]=0;
;;;191    data[1]=0;
;;;192    data[2]=0;
;;;193    data[3]=0;
000234  9600              STR      r6,[sp,#0]
;;;194    lc640_write_long_ptr(lc640_adr+4,data);
000236  4669              MOV      r1,sp
000238  1d20              ADDS     r0,r4,#4
00023a  f7fffffe          BL       lc640_write_long_ptr
;;;195    
;;;196    data[0]=LPC_RTC->YEAR;
00023e  4d7a              LDR      r5,|L1.1064|
000240  8ba8              LDRH     r0,[r5,#0x1c]
000242  f88d0000          STRB     r0,[sp,#0]
;;;197    data[1]=LPC_RTC->MONTH;
000246  7e28              LDRB     r0,[r5,#0x18]
000248  f88d0001          STRB     r0,[sp,#1]
;;;198    data[2]=LPC_RTC->DOM;
00024c  7b28              LDRB     r0,[r5,#0xc]
00024e  f88d0002          STRB     r0,[sp,#2]
;;;199    data[3]=0;
000252  f88d6003          STRB     r6,[sp,#3]
;;;200    lc640_write_long_ptr(lc640_adr+8,data);
000256  4669              MOV      r1,sp
000258  f1040008          ADD      r0,r4,#8
00025c  f7fffffe          BL       lc640_write_long_ptr
;;;201    
;;;202    data[0]=LPC_RTC->HOUR;
000260  7a28              LDRB     r0,[r5,#8]
000262  f88d0000          STRB     r0,[sp,#0]
;;;203    data[1]=LPC_RTC->MIN;
000266  7928              LDRB     r0,[r5,#4]
000268  f88d0001          STRB     r0,[sp,#1]
;;;204    data[2]=LPC_RTC->SEC;
00026c  7828              LDRB     r0,[r5,#0]
00026e  f88d0002          STRB     r0,[sp,#2]
;;;205    data[3]=LPC_SC->RSID;
000272  486e              LDR      r0,|L1.1068|
000274  f8d00180          LDR      r0,[r0,#0x180]
000278  f88d0003          STRB     r0,[sp,#3]
;;;206    
;;;207    lc640_write_long_ptr(lc640_adr+12,data);
00027c  4669              MOV      r1,sp
00027e  f104000c          ADD      r0,r4,#0xc
000282  f7fffffe          BL       lc640_write_long_ptr
;;;208    	
;;;209    data[0]='A';
000286  f04f0541          MOV      r5,#0x41
00028a  f88d5000          STRB     r5,[sp,#0]
;;;210    data[1]='A';
00028e  f88d5001          STRB     r5,[sp,#1]
;;;211    data[2]='A';
000292  f88d5002          STRB     r5,[sp,#2]
;;;212    data[3]='A';
000296  f88d5003          STRB     r5,[sp,#3]
;;;213    lc640_write_long_ptr(lc640_adr+16,data);
00029a  4669              MOV      r1,sp
00029c  f1040010          ADD      r0,r4,#0x10
0002a0  f7fffffe          BL       lc640_write_long_ptr
;;;214    	
;;;215    data[0]='A';
0002a4  f88d5000          STRB     r5,[sp,#0]
;;;216    data[1]='A';
0002a8  f88d5001          STRB     r5,[sp,#1]
;;;217    data[2]='A';
0002ac  f88d5002          STRB     r5,[sp,#2]
;;;218    data[3]='A';
0002b0  f88d5003          STRB     r5,[sp,#3]
;;;219    lc640_write_long_ptr(lc640_adr+20,data);
0002b4  4669              MOV      r1,sp
0002b6  f1040014          ADD      r0,r4,#0x14
0002ba  f7fffffe          BL       lc640_write_long_ptr
;;;220    	
;;;221    data[0]='A';
0002be  f88d5000          STRB     r5,[sp,#0]
;;;222    data[1]='A';
0002c2  f88d5001          STRB     r5,[sp,#1]
;;;223    data[2]='A';
0002c6  f88d5002          STRB     r5,[sp,#2]
;;;224    data[3]='A';
0002ca  f88d5003          STRB     r5,[sp,#3]
;;;225    lc640_write_long_ptr(lc640_adr+24,data);
0002ce  4669              MOV      r1,sp
0002d0  f1040018          ADD      r0,r4,#0x18
0002d4  f7fffffe          BL       lc640_write_long_ptr
;;;226    	
;;;227    data[0]='A';
0002d8  f88d5000          STRB     r5,[sp,#0]
;;;228    data[1]='A';
0002dc  f88d5001          STRB     r5,[sp,#1]
;;;229    data[2]='A';
0002e0  f88d5002          STRB     r5,[sp,#2]
;;;230    data[3]='A';
0002e4  f88d5003          STRB     r5,[sp,#3]
;;;231    lc640_write_long_ptr(lc640_adr+28,data);				
0002e8  4669              MOV      r1,sp
0002ea  f104001c          ADD      r0,r4,#0x1c
0002ee  f7fffffe          BL       lc640_write_long_ptr
;;;232    	
;;;233    	
;;;234    }
0002f2  bdf8              POP      {r3-r7,pc}
;;;235    
                          ENDP

                  avar_unet_hndl PROC
;;;236    //-----------------------------------------------
;;;237    void avar_unet_hndl(char in)
0002f4  e92d4ff8          PUSH     {r3-r11,lr}
;;;238    {
;;;239    
;;;240    char data[4];
;;;241    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;242    
;;;243    
;;;244    if(in==1)
;;;245    	{
;;;246    	net_av=1;
;;;247    
;;;248    	//beep_init(0x01L,'O');
;;;249    	//a.av.bAN=1;
;;;250    
;;;251    
;;;252    	//beep_init(0x33333333,'A');
;;;253    	 
;;;254    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;255    	event_ptr++;	
;;;256    	if(event_ptr>63)event_ptr=0;	
;;;257    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;258    	
;;;259         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;260    	if(event_cnt!=63)event_cnt=event_ptr;
;;;261    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;262    	
;;;263    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;264    	
;;;265    	data[0]='P';
;;;266    	data[1]=0;
;;;267    	data[2]='A';
;;;268    	data[3]=0;
;;;269    	lc640_write_long_ptr(lc640_adr,data);
;;;270    
;;;271    	data[0]=0;//*((char*)&Unet_store);
;;;272    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;273    	data[2]=0;
;;;274    	data[3]=0;
;;;275    	lc640_write_long_ptr(lc640_adr+4,data);
;;;276    
;;;277    	data[0]=LPC_RTC->YEAR;
0002f8  4e4b              LDR      r6,|L1.1064|
0002fa  4941              LDR      r1,|L1.1024|
0002fc  2441              MOVS     r4,#0x41              ;267
0002fe  3e20              SUBS     r6,r6,#0x20
000300  2700              MOVS     r7,#0                 ;256
000302  f04f0a50          MOV      r10,#0x50             ;265
000306  f44f6560          MOV      r5,#0xe00             ;254
00030a  f6406b02          MOV      r11,#0xe02            ;259
00030e  f44f6880          MOV      r8,#0x400             ;263
000312  2801              CMP      r0,#1                 ;244
000314  d006              BEQ      |L1.804|
;;;278    	data[1]=LPC_RTC->MONTH;
;;;279    	data[2]=LPC_RTC->DOM;
;;;280    	data[3]=0;
;;;281    	lc640_write_long_ptr(lc640_adr+8,data);
;;;282    
;;;283    	data[0]=LPC_RTC->HOUR;
;;;284    	data[1]=LPC_RTC->MIN;
;;;285    	data[2]=LPC_RTC->SEC;
;;;286    	data[3]=0;
;;;287    	lc640_write_long_ptr(lc640_adr+12,data);
;;;288    	
;;;289    	data[0]='A';
;;;290    	data[1]='A';
;;;291    	data[2]='A';
;;;292    	data[3]='A';
;;;293    	lc640_write_long_ptr(lc640_adr+16,data);
;;;294    	
;;;295    	data[0]='A';
;;;296    	data[1]='A';
;;;297    	data[2]='A';
;;;298    	data[3]='A';
;;;299    	lc640_write_long_ptr(lc640_adr+20,data);
;;;300    	
;;;301    	data[0]='A';
;;;302    	data[1]='A';
;;;303    	data[2]='A';
;;;304    	data[3]='A';
;;;305    	lc640_write_long_ptr(lc640_adr+24,data);
;;;306    	
;;;307    	data[0]='A';
;;;308    	data[1]='A';
;;;309    	data[2]='A';
;;;310    	data[3]='A';
;;;311    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;312    	
;;;313    /*	memo_out0[0]=0x55;
;;;314         memo_out0[1]=0x00+2;
;;;315         memo_out0[2]=1;
;;;316         memo_out0[3]=0x0b;
;;;317         memo_out0[4]=0x55;
;;;318         memo_out0[5]=0x55; 
;;;319         	
;;;320         memo_out0[6]=crc_87(memo_out0,6);
;;;321    	memo_out0[7]=crc_95(memo_out0,6);
;;;322         usart_out_adr0(memo_out0,8); 
;;;323    	*/
;;;324    	snmp_trap_send("Main power alarm",2,1,0);
;;;325    	}
;;;326    
;;;327    else if(in==2)
;;;328    	{
;;;329    	net_av=2;
;;;330    
;;;331    	//beep_init(0x01L,'O');
;;;332    	//a.av.bAN=1;
;;;333    
;;;334    
;;;335    	//beep_init(0x33333333,'A');
;;;336    	 
;;;337    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;338    	event_ptr++;	
;;;339    	if(event_ptr>63)event_ptr=0;	
;;;340    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;341    	
;;;342         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;343    	if(event_cnt!=63)event_cnt=event_ptr;
;;;344    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;345    	
;;;346    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;347    	
;;;348    	data[0]='P';
;;;349    	data[1]=0;
;;;350    	data[2]='B';
000316  f04f0942          MOV      r9,#0x42
00031a  2802              CMP      r0,#2                 ;327
00031c  d06e              BEQ      |L1.1020|
;;;351    	data[3]=0;
;;;352    	lc640_write_long_ptr(lc640_adr,data);
;;;353    
;;;354    	data[0]=0;//*((char*)&Unet_store);
;;;355    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;356    	data[2]=0;
;;;357    	data[3]=0;
;;;358    	lc640_write_long_ptr(lc640_adr+4,data);
;;;359    
;;;360    	data[0]=LPC_RTC->YEAR;
;;;361    	data[1]=LPC_RTC->MONTH;
;;;362    	data[2]=LPC_RTC->DOM;
;;;363    	data[3]=0;
;;;364    	lc640_write_long_ptr(lc640_adr+8,data);
;;;365    
;;;366    	data[0]=LPC_RTC->HOUR;
;;;367    	data[1]=LPC_RTC->MIN;
;;;368    	data[2]=LPC_RTC->SEC;
;;;369    	data[3]=0;
;;;370    	lc640_write_long_ptr(lc640_adr+12,data);
;;;371    	
;;;372    	data[0]='A';
;;;373    	data[1]='A';
;;;374    	data[2]='A';
;;;375    	data[3]='A';
;;;376    	lc640_write_long_ptr(lc640_adr+16,data);
;;;377    	
;;;378    	data[0]='A';
;;;379    	data[1]='A';
;;;380    	data[2]='A';
;;;381    	data[3]='A';
;;;382    	lc640_write_long_ptr(lc640_adr+20,data);
;;;383    	
;;;384    	data[0]='A';
;;;385    	data[1]='A';
;;;386    	data[2]='A';
;;;387    	data[3]='A';
;;;388    	lc640_write_long_ptr(lc640_adr+24,data);
;;;389    	
;;;390    	data[0]='A';
;;;391    	data[1]='A';
;;;392    	data[2]='A';
;;;393    	data[3]='A';
;;;394    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;395    	
;;;396    	snmp_trap_send("Main power alarm",2,1,0);
;;;397    	}
;;;398    
;;;399    else if(in==0)
00031e  2800              CMP      r0,#0
000320  d06d              BEQ      |L1.1022|
000322  e1cc              B        |L1.1726|
                  |L1.804|
000324  f04f0001          MOV      r0,#1                 ;246
000328  7008              STRB     r0,[r1,#0]            ;246
00032a  4628              MOV      r0,r5                 ;254
00032c  f7fffffe          BL       lc640_read_int
000330  f1000001          ADD      r0,r0,#1              ;255
000334  4681              MOV      r9,r0                 ;255
000336  f1b90f3f          CMP      r9,#0x3f              ;256
00033a  d901              BLS      |L1.832|
00033c  f04f0900          MOV      r9,#0                 ;256
                  |L1.832|
000340  fa0ff189          SXTH     r1,r9                 ;257
000344  4628              MOV      r0,r5                 ;257
000346  f7fffffe          BL       lc640_write_int
00034a  4658              MOV      r0,r11                ;259
00034c  f7fffffe          BL       lc640_read_int
000350  283f              CMP      r0,#0x3f              ;260
000352  d000              BEQ      |L1.854|
000354  4648              MOV      r0,r9                 ;260
                  |L1.854|
000356  b201              SXTH     r1,r0                 ;261
000358  4658              MOV      r0,r11                ;261
00035a  f7fffffe          BL       lc640_write_int
00035e  4628              MOV      r0,r5                 ;263
000360  f7fffffe          BL       lc640_read_int
000364  eb081540          ADD      r5,r8,r0,LSL #5       ;263
000368  f88da000          STRB     r10,[sp,#0]           ;265
00036c  f88d7001          STRB     r7,[sp,#1]            ;266
000370  f88d4002          STRB     r4,[sp,#2]            ;267
000374  f88d7003          STRB     r7,[sp,#3]            ;268
000378  4669              MOV      r1,sp                 ;269
00037a  4628              MOV      r0,r5                 ;269
00037c  f7fffffe          BL       lc640_write_long_ptr
000380  9700              STR      r7,[sp,#0]            ;274
000382  4669              MOV      r1,sp                 ;275
000384  1d28              ADDS     r0,r5,#4              ;275
000386  f7fffffe          BL       lc640_write_long_ptr
00038a  f1060620          ADD      r6,r6,#0x20           ;277
00038e  8bb0              LDRH     r0,[r6,#0x1c]         ;277
000390  f88d0000          STRB     r0,[sp,#0]            ;277
000394  7e30              LDRB     r0,[r6,#0x18]         ;278
000396  f88d0001          STRB     r0,[sp,#1]            ;278
00039a  7b30              LDRB     r0,[r6,#0xc]          ;279
00039c  f88d0002          STRB     r0,[sp,#2]            ;279
0003a0  f88d7003          STRB     r7,[sp,#3]            ;280
0003a4  4669              MOV      r1,sp                 ;281
0003a6  f1050008          ADD      r0,r5,#8              ;281
0003aa  f7fffffe          BL       lc640_write_long_ptr
0003ae  7a30              LDRB     r0,[r6,#8]            ;283
0003b0  f88d0000          STRB     r0,[sp,#0]            ;283
0003b4  7930              LDRB     r0,[r6,#4]            ;284
0003b6  f88d0001          STRB     r0,[sp,#1]            ;284
0003ba  7830              LDRB     r0,[r6,#0]            ;285
0003bc  f88d0002          STRB     r0,[sp,#2]            ;285
0003c0  f88d7003          STRB     r7,[sp,#3]            ;286
0003c4  4669              MOV      r1,sp                 ;287
0003c6  f105000c          ADD      r0,r5,#0xc            ;287
0003ca  f7fffffe          BL       lc640_write_long_ptr
0003ce  f88d4000          STRB     r4,[sp,#0]            ;289
0003d2  f88d4001          STRB     r4,[sp,#1]            ;290
0003d6  f88d4002          STRB     r4,[sp,#2]            ;291
0003da  f88d4003          STRB     r4,[sp,#3]            ;292
0003de  4669              MOV      r1,sp                 ;293
0003e0  f1050010          ADD      r0,r5,#0x10           ;293
0003e4  f7fffffe          BL       lc640_write_long_ptr
0003e8  f88d4000          STRB     r4,[sp,#0]            ;295
0003ec  f88d4001          STRB     r4,[sp,#1]            ;296
0003f0  f88d4002          STRB     r4,[sp,#2]            ;297
0003f4  f88d4003          STRB     r4,[sp,#3]            ;298
0003f8  4669              MOV      r1,sp                 ;299
0003fa  e019              B        |L1.1072|
                  |L1.1020|
0003fc  e03d              B        |L1.1146|
                  |L1.1022|
0003fe  e0cd              B        |L1.1436|
                  |L1.1024|
                          DCD      net_av
                  |L1.1028|
                          DCD      ||.data||
                  |L1.1032|
                          DCD      bat
                  |L1.1036|
                          DCD      bps
                  |L1.1040|
                          DCD      sk_av_stat
                  |L1.1044|
                          DCD      SK_ZVUK_EN
                  |L1.1048|
                          DCD      AV_OFF_AVT
                  |L1.1052|
                          DCD      0xeffffffe
                  |L1.1056|
                          DCD      status_izm_r
                  |L1.1060|
                          DCD      sk_alarm
                  |L1.1064|
                          DCD      0x40024020
                  |L1.1068|
                          DCD      0x400fc000
                  |L1.1072|
000430  f1050014          ADD      r0,r5,#0x14           ;299
000434  f7fffffe          BL       lc640_write_long_ptr
000438  f88d4000          STRB     r4,[sp,#0]            ;301
00043c  f88d4001          STRB     r4,[sp,#1]            ;302
000440  f88d4002          STRB     r4,[sp,#2]            ;303
000444  f88d4003          STRB     r4,[sp,#3]            ;304
000448  4669              MOV      r1,sp                 ;305
00044a  f1050018          ADD      r0,r5,#0x18           ;305
00044e  f7fffffe          BL       lc640_write_long_ptr
000452  f88d4000          STRB     r4,[sp,#0]            ;307
000456  f88d4001          STRB     r4,[sp,#1]            ;308
00045a  f88d4002          STRB     r4,[sp,#2]            ;309
00045e  f88d4003          STRB     r4,[sp,#3]            ;310
000462  4669              MOV      r1,sp                 ;311
000464  f105001c          ADD      r0,r5,#0x1c           ;311
000468  f7fffffe          BL       lc640_write_long_ptr
00046c  2300              MOVS     r3,#0                 ;324
00046e  2201              MOVS     r2,#1                 ;324
000470  2102              MOVS     r1,#2                 ;324
000472  a0ff              ADR      r0,|L1.2160|
000474  f7fffffe          BL       snmp_trap_send
000478  e121              B        |L1.1726|
                  |L1.1146|
00047a  f04f0002          MOV      r0,#2                 ;329
00047e  7008              STRB     r0,[r1,#0]            ;329
000480  f44f6060          MOV      r0,#0xe00             ;337
000484  f7fffffe          BL       lc640_read_int
000488  f1000001          ADD      r0,r0,#1              ;338
00048c  4605              MOV      r5,r0                 ;338
00048e  2d3f              CMP      r5,#0x3f              ;339
000490  d901              BLS      |L1.1174|
000492  f04f0500          MOV      r5,#0                 ;339
                  |L1.1174|
000496  b229              SXTH     r1,r5                 ;340
000498  f44f6060          MOV      r0,#0xe00             ;340
00049c  f7fffffe          BL       lc640_write_int
0004a0  4658              MOV      r0,r11                ;342
0004a2  f7fffffe          BL       lc640_read_int
0004a6  283f              CMP      r0,#0x3f              ;343
0004a8  d000              BEQ      |L1.1196|
0004aa  4628              MOV      r0,r5                 ;343
                  |L1.1196|
0004ac  b201              SXTH     r1,r0                 ;344
0004ae  4658              MOV      r0,r11                ;344
0004b0  f7fffffe          BL       lc640_write_int
0004b4  f44f6060          MOV      r0,#0xe00             ;346
0004b8  f7fffffe          BL       lc640_read_int
0004bc  eb081540          ADD      r5,r8,r0,LSL #5       ;346
0004c0  f88da000          STRB     r10,[sp,#0]           ;348
0004c4  f88d7001          STRB     r7,[sp,#1]            ;349
0004c8  f88d9002          STRB     r9,[sp,#2]            ;350
0004cc  f88d7003          STRB     r7,[sp,#3]            ;351
0004d0  4669              MOV      r1,sp                 ;352
0004d2  4628              MOV      r0,r5                 ;352
0004d4  f7fffffe          BL       lc640_write_long_ptr
0004d8  9700              STR      r7,[sp,#0]            ;357
0004da  4669              MOV      r1,sp                 ;358
0004dc  1d28              ADDS     r0,r5,#4              ;358
0004de  f7fffffe          BL       lc640_write_long_ptr
0004e2  f1060620          ADD      r6,r6,#0x20           ;360
0004e6  8bb0              LDRH     r0,[r6,#0x1c]         ;360
0004e8  f88d0000          STRB     r0,[sp,#0]            ;360
0004ec  7e30              LDRB     r0,[r6,#0x18]         ;361
0004ee  f88d0001          STRB     r0,[sp,#1]            ;361
0004f2  7b30              LDRB     r0,[r6,#0xc]          ;362
0004f4  f88d0002          STRB     r0,[sp,#2]            ;362
0004f8  f88d7003          STRB     r7,[sp,#3]            ;363
0004fc  4669              MOV      r1,sp                 ;364
0004fe  f1050008          ADD      r0,r5,#8              ;364
000502  f7fffffe          BL       lc640_write_long_ptr
000506  7a30              LDRB     r0,[r6,#8]            ;366
000508  f88d0000          STRB     r0,[sp,#0]            ;366
00050c  7930              LDRB     r0,[r6,#4]            ;367
00050e  f88d0001          STRB     r0,[sp,#1]            ;367
000512  7830              LDRB     r0,[r6,#0]            ;368
000514  f88d0002          STRB     r0,[sp,#2]            ;368
000518  f88d7003          STRB     r7,[sp,#3]            ;369
00051c  4669              MOV      r1,sp                 ;370
00051e  f105000c          ADD      r0,r5,#0xc            ;370
000522  f7fffffe          BL       lc640_write_long_ptr
000526  f88d4000          STRB     r4,[sp,#0]            ;372
00052a  f88d4001          STRB     r4,[sp,#1]            ;373
00052e  f88d4002          STRB     r4,[sp,#2]            ;374
000532  f88d4003          STRB     r4,[sp,#3]            ;375
000536  4669              MOV      r1,sp                 ;376
000538  f1050010          ADD      r0,r5,#0x10           ;376
00053c  f7fffffe          BL       lc640_write_long_ptr
000540  f88d4000          STRB     r4,[sp,#0]            ;378
000544  f88d4001          STRB     r4,[sp,#1]            ;379
000548  f88d4002          STRB     r4,[sp,#2]            ;380
00054c  f88d4003          STRB     r4,[sp,#3]            ;381
000550  4669              MOV      r1,sp                 ;382
000552  f1050014          ADD      r0,r5,#0x14           ;382
000556  f7fffffe          BL       lc640_write_long_ptr
00055a  f88d4000          STRB     r4,[sp,#0]            ;384
00055e  f88d4001          STRB     r4,[sp,#1]            ;385
000562  f88d4002          STRB     r4,[sp,#2]            ;386
000566  f88d4003          STRB     r4,[sp,#3]            ;387
00056a  4669              MOV      r1,sp                 ;388
00056c  f1050018          ADD      r0,r5,#0x18           ;388
000570  f7fffffe          BL       lc640_write_long_ptr
000574  f88d4000          STRB     r4,[sp,#0]            ;390
000578  f88d4001          STRB     r4,[sp,#1]            ;391
00057c  f88d4002          STRB     r4,[sp,#2]            ;392
000580  f88d4003          STRB     r4,[sp,#3]            ;393
000584  4669              MOV      r1,sp                 ;394
000586  f105001c          ADD      r0,r5,#0x1c           ;394
00058a  f7fffffe          BL       lc640_write_long_ptr
00058e  2300              MOVS     r3,#0                 ;396
000590  2201              MOVS     r2,#1                 ;396
000592  2102              MOVS     r1,#2                 ;396
000594  a0b6              ADR      r0,|L1.2160|
000596  f7fffffe          BL       snmp_trap_send
00059a  e090              B        |L1.1726|
                  |L1.1436|
;;;400    	{
;;;401    	net_av=0;
00059c  700f              STRB     r7,[r1,#0]
;;;402    
;;;403      /*
;;;404    	SET_REG(C2GSR,3,24,8);
;;;405    	C2MOD=0;
;;;406    	bOUT_FREE2=1;*/
;;;407    
;;;408    
;;;409    	//C2MOD=0;
;;;410    
;;;411    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;412    
;;;413         //beep_init(0x02L,'O');
;;;414    	//a_.av.bAN=0;
;;;415    	SET_REG(avar_stat,0,0,1);
00059e  48b9              LDR      r0,|L1.2180|
0005a0  6801              LDR      r1,[r0,#0]  ; avar_stat
0005a2  f0210101          BIC      r1,r1,#1
0005a6  6001              STR      r1,[r0,#0]  ; avar_stat
;;;416    
;;;417    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;418    	
;;;419    	if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
0005a8  49b7              LDR      r1,|L1.2184|
0005aa  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
0005ac  b119              CBZ      r1,|L1.1462|
0005ae  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
0005b0  f0210101          BIC      r1,r1,#1
0005b4  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.1462|
;;;420    
;;;421         event_ptr=lc640_read_int(PTR_EVENT_LOG);
0005b6  4628              MOV      r0,r5
0005b8  f7fffffe          BL       lc640_read_int
0005bc  4682              MOV      r10,r0
;;;422    	event_ptr_find=event_ptr;
0005be  4654              MOV      r4,r10
                  |L1.1472|
;;;423    avar_unet_hndl_lbl1:
;;;424    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0005c0  eb081544          ADD      r5,r8,r4,LSL #5
;;;425    
;;;426         lc640_read_long_ptr(lc640_adr,data);
0005c4  4669              MOV      r1,sp
0005c6  4628              MOV      r0,r5
0005c8  f7fffffe          BL       lc640_read_long_ptr
;;;427         
;;;428         if(!((data[0]=='P')&&(data[1]==0)&&((data[2]=='A')||(data[2]=='B'))))
0005cc  f89d0000          LDRB     r0,[sp,#0]
0005d0  2850              CMP      r0,#0x50
0005d2  d108              BNE      |L1.1510|
0005d4  f89d0001          LDRB     r0,[sp,#1]
0005d8  b928              CBNZ     r0,|L1.1510|
0005da  f89d0002          LDRB     r0,[sp,#2]
0005de  2841              CMP      r0,#0x41
0005e0  d00a              BEQ      |L1.1528|
0005e2  2842              CMP      r0,#0x42
0005e4  d008              BEQ      |L1.1528|
                  |L1.1510|
;;;429         	{        
;;;430         	if(event_ptr_find)event_ptr_find--;
0005e6  b114              CBZ      r4,|L1.1518|
0005e8  f1a40401          SUB      r4,r4,#1
0005ec  e001              B        |L1.1522|
                  |L1.1518|
;;;431         	else event_ptr_find=63;
0005ee  f04f043f          MOV      r4,#0x3f
                  |L1.1522|
;;;432         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0005f2  4554              CMP      r4,r10
0005f4  d1e4              BNE      |L1.1472|
0005f6  e062              B        |L1.1726|
                  |L1.1528|
;;;433         	else goto avar_unet_hndl_lbl1;
;;;434         	}
;;;435         else 
;;;436         	{
;;;437         	lc640_read_long_ptr(lc640_adr+16,data);
0005f8  4669              MOV      r1,sp
0005fa  f1050010          ADD      r0,r5,#0x10
0005fe  f7fffffe          BL       lc640_read_long_ptr
;;;438         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000602  f89d0000          LDRB     r0,[sp,#0]
000606  2841              CMP      r0,#0x41
000608  d10b              BNE      |L1.1570|
00060a  f89d0001          LDRB     r0,[sp,#1]
00060e  2841              CMP      r0,#0x41
000610  d107              BNE      |L1.1570|
000612  f89d0002          LDRB     r0,[sp,#2]
000616  2841              CMP      r0,#0x41
000618  d103              BNE      |L1.1570|
00061a  f89d0003          LDRB     r0,[sp,#3]
00061e  2841              CMP      r0,#0x41
000620  d008              BEQ      |L1.1588|
                  |L1.1570|
;;;439         		{        
;;;440         		if(event_ptr_find)event_ptr_find--;
000622  b114              CBZ      r4,|L1.1578|
000624  f1a40401          SUB      r4,r4,#1
000628  e001              B        |L1.1582|
                  |L1.1578|
;;;441             		else event_ptr_find=63;
00062a  f04f043f          MOV      r4,#0x3f
                  |L1.1582|
;;;442             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
00062e  4554              CMP      r4,r10
000630  d1c6              BNE      |L1.1472|
000632  e044              B        |L1.1726|
                  |L1.1588|
;;;443         		else goto avar_unet_hndl_lbl1;
;;;444         		}
;;;445    
;;;446         	}	
;;;447    	
;;;448    	data[0]=LPC_RTC->YEAR;
000634  f1060620          ADD      r6,r6,#0x20
000638  8bb0              LDRH     r0,[r6,#0x1c]
00063a  f88d0000          STRB     r0,[sp,#0]
;;;449    	data[1]=LPC_RTC->MONTH;
00063e  7e30              LDRB     r0,[r6,#0x18]
000640  f88d0001          STRB     r0,[sp,#1]
;;;450    	data[2]=LPC_RTC->DOM;
000644  7b30              LDRB     r0,[r6,#0xc]
000646  f88d0002          STRB     r0,[sp,#2]
;;;451    	data[3]=0;
00064a  f88d7003          STRB     r7,[sp,#3]
;;;452    	lc640_write_long_ptr(lc640_adr+16,data);
00064e  4669              MOV      r1,sp
000650  f1050010          ADD      r0,r5,#0x10
000654  f7fffffe          BL       lc640_write_long_ptr
;;;453    
;;;454    	data[0]=LPC_RTC->HOUR;
000658  7a30              LDRB     r0,[r6,#8]
00065a  f88d0000          STRB     r0,[sp,#0]
;;;455    	data[1]=LPC_RTC->MIN;
00065e  7930              LDRB     r0,[r6,#4]
000660  f88d0001          STRB     r0,[sp,#1]
;;;456    	data[2]=LPC_RTC->SEC;
000664  7830              LDRB     r0,[r6,#0]
000666  f88d0002          STRB     r0,[sp,#2]
;;;457    	data[3]=0;
00066a  f88d7003          STRB     r7,[sp,#3]
;;;458    	lc640_write_long_ptr(lc640_adr+20,data); 
00066e  4669              MOV      r1,sp
000670  f1050014          ADD      r0,r5,#0x14
000674  f7fffffe          BL       lc640_write_long_ptr
;;;459    	
;;;460    	data[0]=*((char*)(&net_Ustore));
000678  4884              LDR      r0,|L1.2188|
00067a  7801              LDRB     r1,[r0,#0]  ; net_Ustore
00067c  f88d1000          STRB     r1,[sp,#0]
;;;461    	data[1]=*(((char*)(&net_Ustore))+1);
000680  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000682  f88d0001          STRB     r0,[sp,#1]
;;;462    	data[2]='B';
000686  f88d9002          STRB     r9,[sp,#2]
;;;463    	data[3]='B';
00068a  f88d9003          STRB     r9,[sp,#3]
;;;464    	lc640_write_long_ptr(lc640_adr+24,data);
00068e  4669              MOV      r1,sp
000690  f1050018          ADD      r0,r5,#0x18
000694  f7fffffe          BL       lc640_write_long_ptr
;;;465    	
;;;466    	data[0]='B';
000698  f88d9000          STRB     r9,[sp,#0]
;;;467    	data[1]='B';
00069c  f88d9001          STRB     r9,[sp,#1]
;;;468    	data[2]='B';
0006a0  f88d9002          STRB     r9,[sp,#2]
;;;469    	data[3]='B';
0006a4  f88d9003          STRB     r9,[sp,#3]
;;;470    	lc640_write_long_ptr(lc640_adr+28,data);	
0006a8  4669              MOV      r1,sp
0006aa  f105001c          ADD      r0,r5,#0x1c
0006ae  f7fffffe          BL       lc640_write_long_ptr
;;;471    	
;;;472    /*	memo_out0[0]=0x55;
;;;473         memo_out0[1]=0x00+2;
;;;474         memo_out0[2]=1;
;;;475         memo_out0[3]=0x0b;
;;;476         memo_out0[4]=0xaa;
;;;477         memo_out0[5]=0xaa; 
;;;478         	
;;;479         memo_out0[6]=crc_87(memo_out0,6);
;;;480    	memo_out0[7]=crc_95(memo_out0,6);
;;;481         usart_out_adr0(memo_out0,8); */
;;;482         snmp_trap_send("Main power alarm  clear",2,1,1);	
0006b2  2301              MOVS     r3,#1
0006b4  461a              MOV      r2,r3
0006b6  2102              MOVS     r1,#2
0006b8  a075              ADR      r0,|L1.2192|
0006ba  f7fffffe          BL       snmp_trap_send
                  |L1.1726|
;;;483    	}
;;;484    avar_unet_hndl_end:
;;;485    	__nop();		
0006be  bf00              NOP      
                  |L1.1728|
;;;486    }
0006c0  e8bd8ff8          POP      {r3-r11,pc}
;;;487    
                          ENDP

                  avar_uout_hndl PROC
;;;489    //-----------------------------------------------
;;;490    void avar_uout_hndl(char in)
0006c4  e92d4ff8          PUSH     {r3-r11,lr}
;;;491    {
;;;492    
;;;493    char data[4];
;;;494    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;495    char avar_data=0;
;;;496    
;;;497    if(in==1)
;;;498    	{
;;;499    	//net_av=1;
;;;500    
;;;501    	//beep_init(0x01L,'O');
;;;502    	//a.av.bAN=1;
;;;503    
;;;504    
;;;505    	//beep_init(0x33333333,'A');
;;;506    
;;;507    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;508    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;509    	
;;;510    	avar_data=uout_av;
;;;511    		 
;;;512    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;513    	event_ptr++;	
;;;514    	if(event_ptr>63)event_ptr=0;	
;;;515    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;516    	
;;;517        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;518    	if(event_cnt!=63)event_cnt=event_ptr;
;;;519    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;520    	
;;;521    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;522    	
;;;523    	data[0]='Q';
;;;524    	data[1]=0;
;;;525    	data[2]='A';
;;;526    	data[3]=avar_data;
;;;527    	lc640_write_long_ptr(lc640_adr,data);
;;;528    
;;;529    	 //load_U=4321;
;;;530    
;;;531    	data[0]=*((char*)&load_U);
;;;532    	data[1]=*(((char*)&load_U)+1);
;;;533    	data[2]=0;
;;;534    	data[3]=0;
;;;535    	lc640_write_long_ptr(lc640_adr+4,data);
;;;536    
;;;537    	data[0]=LPC_RTC->YEAR;
0006c8  4f77              LDR      r7,|L1.2216|
0006ca  4978              LDR      r1,|L1.2220|
0006cc  f44f6560          MOV      r5,#0xe00             ;512
0006d0  f04f0800          MOV      r8,#0                 ;495
0006d4  f44f6980          MOV      r9,#0x400             ;521
0006d8  2801              CMP      r0,#1                 ;497
0006da  d002              BEQ      |L1.1762|
;;;538    	data[1]=LPC_RTC->MONTH;
;;;539    	data[2]=LPC_RTC->DOM;
;;;540    	data[3]=0;
;;;541    	lc640_write_long_ptr(lc640_adr+8,data);
;;;542    
;;;543    	data[0]=LPC_RTC->HOUR;
;;;544    	data[1]=LPC_RTC->MIN;
;;;545    	data[2]=LPC_RTC->SEC;
;;;546    	data[3]=0;
;;;547    	lc640_write_long_ptr(lc640_adr+12,data);
;;;548    	
;;;549    	data[0]='A';
;;;550    	data[1]='A';
;;;551    	data[2]='A';
;;;552    	data[3]='A';
;;;553    	lc640_write_long_ptr(lc640_adr+16,data);
;;;554    	
;;;555    	data[0]='A';
;;;556    	data[1]='A';
;;;557    	data[2]='A';
;;;558    	data[3]='A';
;;;559    	lc640_write_long_ptr(lc640_adr+20,data);
;;;560    	
;;;561    	data[0]='A';
;;;562    	data[1]='A';
;;;563    	data[2]='A';
;;;564    	data[3]='A';
;;;565    	lc640_write_long_ptr(lc640_adr+24,data);
;;;566    	
;;;567    	data[0]='A';
;;;568    	data[1]='A';
;;;569    	data[2]='A';
;;;570    	data[3]='A';
;;;571    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;572    	
;;;573    /*	memo_out0[0]=0x55;
;;;574         memo_out0[1]=0x00+2;
;;;575         memo_out0[2]=1;
;;;576         memo_out0[3]=0x0b;
;;;577         memo_out0[4]=0x55;
;;;578         memo_out0[5]=0x55; 
;;;579         	
;;;580         memo_out0[6]=crc_87(memo_out0,6);
;;;581    	memo_out0[7]=crc_95(memo_out0,6);
;;;582         usart_out_adr0(memo_out0,8); 
;;;583    	*/
;;;584    	//snmp_trap_send("Main power is off",2,1,0);
;;;585    	}
;;;586    
;;;587    else if(in==0)
0006dc  2800              CMP      r0,#0
0006de  d07d              BEQ      |L1.2012|
0006e0  e15a              B        |L1.2456|
                  |L1.1762|
0006e2  f8dfa1cc          LDR      r10,|L1.2224|
0006e6  4a73              LDR      r2,|L1.2228|
0006e8  f9ba0000          LDRSH    r0,[r10,#0]           ;507  ; load_U
0006ec  f9b22000          LDRSH    r2,[r2,#0]            ;507  ; U_OUT_KONTR_MAX
0006f0  4290              CMP      r0,r2                 ;507
0006f2  dd02              BLE      |L1.1786|
0006f4  f04f0201          MOV      r2,#1                 ;507
0006f8  700a              STRB     r2,[r1,#0]            ;507
                  |L1.1786|
0006fa  4a6f              LDR      r2,|L1.2232|
0006fc  f9b22000          LDRSH    r2,[r2,#0]            ;508  ; U_OUT_KONTR_MIN
000700  4290              CMP      r0,r2                 ;508
000702  da02              BGE      |L1.1802|
000704  f04f0002          MOV      r0,#2                 ;508
000708  7008              STRB     r0,[r1,#0]            ;508
                  |L1.1802|
00070a  780e              LDRB     r6,[r1,#0]            ;510  ; uout_av
00070c  4628              MOV      r0,r5                 ;512
00070e  f7fffffe          BL       lc640_read_int
000712  f1000001          ADD      r0,r0,#1              ;513
000716  4604              MOV      r4,r0                 ;513
000718  2c3f              CMP      r4,#0x3f              ;514
00071a  d901              BLS      |L1.1824|
00071c  f04f0400          MOV      r4,#0                 ;514
                  |L1.1824|
000720  b221              SXTH     r1,r4                 ;515
000722  4628              MOV      r0,r5                 ;515
000724  f7fffffe          BL       lc640_write_int
000728  f6406b02          MOV      r11,#0xe02            ;517
00072c  4658              MOV      r0,r11                ;517
00072e  f7fffffe          BL       lc640_read_int
000732  283f              CMP      r0,#0x3f              ;518
000734  d000              BEQ      |L1.1848|
000736  4620              MOV      r0,r4                 ;518
                  |L1.1848|
000738  b201              SXTH     r1,r0                 ;519
00073a  4658              MOV      r0,r11                ;519
00073c  f7fffffe          BL       lc640_write_int
000740  4628              MOV      r0,r5                 ;521
000742  f7fffffe          BL       lc640_read_int
000746  eb091540          ADD      r5,r9,r0,LSL #5       ;521
00074a  f04f0051          MOV      r0,#0x51              ;523
00074e  f88d0000          STRB     r0,[sp,#0]            ;523
000752  f88d8001          STRB     r8,[sp,#1]            ;524
000756  f04f0441          MOV      r4,#0x41              ;525
00075a  f88d4002          STRB     r4,[sp,#2]            ;525
00075e  f88d6003          STRB     r6,[sp,#3]            ;526
000762  4669              MOV      r1,sp                 ;527
000764  4628              MOV      r0,r5                 ;527
000766  f7fffffe          BL       lc640_write_long_ptr
00076a  f89a0000          LDRB     r0,[r10,#0]           ;531  ; load_U
00076e  f88d0000          STRB     r0,[sp,#0]            ;531
000772  f89a0001          LDRB     r0,[r10,#1]           ;532  ; load_U
000776  f88d0001          STRB     r0,[sp,#1]            ;532
00077a  f88d8002          STRB     r8,[sp,#2]            ;533
00077e  f88d8003          STRB     r8,[sp,#3]            ;534
000782  4669              MOV      r1,sp                 ;535
000784  1d28              ADDS     r0,r5,#4              ;535
000786  f7fffffe          BL       lc640_write_long_ptr
00078a  f1070720          ADD      r7,r7,#0x20           ;537
00078e  8bb8              LDRH     r0,[r7,#0x1c]         ;537
000790  f88d0000          STRB     r0,[sp,#0]            ;537
000794  7e38              LDRB     r0,[r7,#0x18]         ;538
000796  f88d0001          STRB     r0,[sp,#1]            ;538
00079a  7b38              LDRB     r0,[r7,#0xc]          ;539
00079c  f88d0002          STRB     r0,[sp,#2]            ;539
0007a0  f88d8003          STRB     r8,[sp,#3]            ;540
0007a4  4669              MOV      r1,sp                 ;541
0007a6  f1050008          ADD      r0,r5,#8              ;541
0007aa  f7fffffe          BL       lc640_write_long_ptr
0007ae  7a38              LDRB     r0,[r7,#8]            ;543
0007b0  f88d0000          STRB     r0,[sp,#0]            ;543
0007b4  7938              LDRB     r0,[r7,#4]            ;544
0007b6  f88d0001          STRB     r0,[sp,#1]            ;544
0007ba  7838              LDRB     r0,[r7,#0]            ;545
0007bc  f88d0002          STRB     r0,[sp,#2]            ;545
0007c0  f88d8003          STRB     r8,[sp,#3]            ;546
0007c4  4669              MOV      r1,sp                 ;547
0007c6  f105000c          ADD      r0,r5,#0xc            ;547
0007ca  f7fffffe          BL       lc640_write_long_ptr
0007ce  f88d4000          STRB     r4,[sp,#0]            ;549
0007d2  f88d4001          STRB     r4,[sp,#1]            ;550
0007d6  f88d4002          STRB     r4,[sp,#2]            ;551
0007da  e000              B        |L1.2014|
                  |L1.2012|
0007dc  e02e              B        |L1.2108|
                  |L1.2014|
0007de  f88d4003          STRB     r4,[sp,#3]            ;552
0007e2  4669              MOV      r1,sp                 ;553
0007e4  f1050010          ADD      r0,r5,#0x10           ;553
0007e8  f7fffffe          BL       lc640_write_long_ptr
0007ec  f88d4000          STRB     r4,[sp,#0]            ;555
0007f0  f88d4001          STRB     r4,[sp,#1]            ;556
0007f4  f88d4002          STRB     r4,[sp,#2]            ;557
0007f8  f88d4003          STRB     r4,[sp,#3]            ;558
0007fc  4669              MOV      r1,sp                 ;559
0007fe  f1050014          ADD      r0,r5,#0x14           ;559
000802  f7fffffe          BL       lc640_write_long_ptr
000806  f88d4000          STRB     r4,[sp,#0]            ;561
00080a  f88d4001          STRB     r4,[sp,#1]            ;562
00080e  f88d4002          STRB     r4,[sp,#2]            ;563
000812  f88d4003          STRB     r4,[sp,#3]            ;564
000816  4669              MOV      r1,sp                 ;565
000818  f1050018          ADD      r0,r5,#0x18           ;565
00081c  f7fffffe          BL       lc640_write_long_ptr
000820  f88d4000          STRB     r4,[sp,#0]            ;567
000824  f88d4001          STRB     r4,[sp,#1]            ;568
000828  f88d4002          STRB     r4,[sp,#2]            ;569
00082c  f88d4003          STRB     r4,[sp,#3]            ;570
000830  4669              MOV      r1,sp                 ;571
000832  f105001c          ADD      r0,r5,#0x1c           ;571
000836  f7fffffe          BL       lc640_write_long_ptr
00083a  e0ad              B        |L1.2456|
                  |L1.2108|
;;;588    	{
;;;589    	uout_av=0;
00083c  f8818000          STRB     r8,[r1,#0]
;;;590    
;;;591      /*
;;;592    	SET_REG(C2GSR,3,24,8);
;;;593    	C2MOD=0;
;;;594    	bOUT_FREE2=1;*/
;;;595    
;;;596    
;;;597    	//C2MOD=0;
;;;598    
;;;599    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;600    
;;;601         //beep_init(0x02L,'O');
;;;602    	//a_.av.bAN=0;
;;;603    //	SET_REG(avar_stat,0,0,1);
;;;604    
;;;605    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;606    	
;;;607    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;608    
;;;609        event_ptr=lc640_read_int(PTR_EVENT_LOG);
000840  4628              MOV      r0,r5
000842  f7fffffe          BL       lc640_read_int
000846  4606              MOV      r6,r0
;;;610    	event_ptr_find=event_ptr;
000848  4634              MOV      r4,r6
                  |L1.2122|
;;;611    avar_uout_hndl_lbl1:
;;;612    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
00084a  eb091544          ADD      r5,r9,r4,LSL #5
;;;613    
;;;614         lc640_read_long_ptr(lc640_adr,data);
00084e  4669              MOV      r1,sp
000850  4628              MOV      r0,r5
000852  f7fffffe          BL       lc640_read_long_ptr
;;;615         
;;;616         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
000856  f89d0000          LDRB     r0,[sp,#0]
00085a  2851              CMP      r0,#0x51
00085c  d106              BNE      |L1.2156|
00085e  f89d0001          LDRB     r0,[sp,#1]
000862  b918              CBNZ     r0,|L1.2156|
000864  f89d0002          LDRB     r0,[sp,#2]
000868  2841              CMP      r0,#0x41
00086a  d030              BEQ      |L1.2254|
                  |L1.2156|
;;;617         	{        
;;;618         	if(event_ptr_find)event_ptr_find--;
00086c  b334              CBZ      r4,|L1.2236|
00086e  e026              B        |L1.2238|
                  |L1.2160|
000870  4d61696e          DCB      "Main power alarm",0
000874  20706f77
000878  65722061
00087c  6c61726d
000880  00      
000881  00                DCB      0
000882  00                DCB      0
000883  00                DCB      0
                  |L1.2180|
                          DCD      ||.data||
                  |L1.2184|
                          DCD      AV_OFF_AVT
                  |L1.2188|
                          DCD      net_Ustore
                  |L1.2192|
000890  4d61696e          DCB      "Main power alarm  clear",0
000894  20706f77
000898  65722061
00089c  6c61726d
0008a0  2020636c
0008a4  65617200
                  |L1.2216|
                          DCD      0x40024000
                  |L1.2220|
                          DCD      uout_av
                  |L1.2224|
                          DCD      load_U
                  |L1.2228|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2232|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2236|
0008bc  e002              B        |L1.2244|
                  |L1.2238|
0008be  f1a40401          SUB      r4,r4,#1
0008c2  e001              B        |L1.2248|
                  |L1.2244|
;;;619         	else event_ptr_find=63;
0008c4  f04f043f          MOV      r4,#0x3f
                  |L1.2248|
;;;620         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0008c8  42b4              CMP      r4,r6
0008ca  d1be              BNE      |L1.2122|
0008cc  e064              B        |L1.2456|
                  |L1.2254|
;;;621         	else goto avar_uout_hndl_lbl1;
;;;622         	}
;;;623         else 
;;;624         	{
;;;625         	lc640_read_long_ptr(lc640_adr+16,data);
0008ce  4669              MOV      r1,sp
0008d0  f1050010          ADD      r0,r5,#0x10
0008d4  f7fffffe          BL       lc640_read_long_ptr
;;;626         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0008d8  f89d0000          LDRB     r0,[sp,#0]
0008dc  2841              CMP      r0,#0x41
0008de  d10b              BNE      |L1.2296|
0008e0  f89d0001          LDRB     r0,[sp,#1]
0008e4  2841              CMP      r0,#0x41
0008e6  d107              BNE      |L1.2296|
0008e8  f89d0002          LDRB     r0,[sp,#2]
0008ec  2841              CMP      r0,#0x41
0008ee  d103              BNE      |L1.2296|
0008f0  f89d0003          LDRB     r0,[sp,#3]
0008f4  2841              CMP      r0,#0x41
0008f6  d008              BEQ      |L1.2314|
                  |L1.2296|
;;;627         		{        
;;;628         		if(event_ptr_find)event_ptr_find--;
0008f8  b114              CBZ      r4,|L1.2304|
0008fa  f1a40401          SUB      r4,r4,#1
0008fe  e001              B        |L1.2308|
                  |L1.2304|
;;;629             		else event_ptr_find=63;
000900  f04f043f          MOV      r4,#0x3f
                  |L1.2308|
;;;630             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000904  42b4              CMP      r4,r6
000906  d1a0              BNE      |L1.2122|
000908  e046              B        |L1.2456|
                  |L1.2314|
;;;631         		else goto avar_uout_hndl_lbl1;
;;;632         		}
;;;633    
;;;634         	}	
;;;635    	
;;;636    	data[0]=LPC_RTC->YEAR;
00090a  f1070720          ADD      r7,r7,#0x20
00090e  8bb8              LDRH     r0,[r7,#0x1c]
000910  f88d0000          STRB     r0,[sp,#0]
;;;637    	data[1]=LPC_RTC->MONTH;
000914  7e38              LDRB     r0,[r7,#0x18]
000916  f88d0001          STRB     r0,[sp,#1]
;;;638    	data[2]=LPC_RTC->DOM;
00091a  7b38              LDRB     r0,[r7,#0xc]
00091c  f88d0002          STRB     r0,[sp,#2]
;;;639    	data[3]=0;
000920  f88d8003          STRB     r8,[sp,#3]
;;;640    	lc640_write_long_ptr(lc640_adr+16,data);
000924  4669              MOV      r1,sp
000926  f1050010          ADD      r0,r5,#0x10
00092a  f7fffffe          BL       lc640_write_long_ptr
;;;641    
;;;642    	data[0]=LPC_RTC->HOUR;
00092e  7a38              LDRB     r0,[r7,#8]
000930  f88d0000          STRB     r0,[sp,#0]
;;;643    	data[1]=LPC_RTC->MIN;
000934  7938              LDRB     r0,[r7,#4]
000936  f88d0001          STRB     r0,[sp,#1]
;;;644    	data[2]=LPC_RTC->SEC;
00093a  7838              LDRB     r0,[r7,#0]
00093c  f88d0002          STRB     r0,[sp,#2]
;;;645    	data[3]=0;
000940  f88d8003          STRB     r8,[sp,#3]
;;;646    	lc640_write_long_ptr(lc640_adr+20,data); 
000944  4669              MOV      r1,sp
000946  f1050014          ADD      r0,r5,#0x14
00094a  f7fffffe          BL       lc640_write_long_ptr
;;;647    	
;;;648    	data[0]=*((char*)(&net_Ustore));
00094e  48ff              LDR      r0,|L1.3404|
000950  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000952  f88d1000          STRB     r1,[sp,#0]
;;;649    	data[1]=*(((char*)(&net_Ustore))+1);
000956  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000958  f88d0001          STRB     r0,[sp,#1]
;;;650    	data[2]='B';
00095c  f04f0442          MOV      r4,#0x42
000960  f88d4002          STRB     r4,[sp,#2]
;;;651    	data[3]='B';
000964  f88d4003          STRB     r4,[sp,#3]
;;;652    	lc640_write_long_ptr(lc640_adr+24,data);
000968  4669              MOV      r1,sp
00096a  f1050018          ADD      r0,r5,#0x18
00096e  f7fffffe          BL       lc640_write_long_ptr
;;;653    	
;;;654    	data[0]='B';
000972  f88d4000          STRB     r4,[sp,#0]
;;;655    	data[1]='B';
000976  f88d4001          STRB     r4,[sp,#1]
;;;656    	data[2]='B';
00097a  f88d4002          STRB     r4,[sp,#2]
;;;657    	data[3]='B';
00097e  f88d4003          STRB     r4,[sp,#3]
;;;658    	lc640_write_long_ptr(lc640_adr+28,data);	
000982  4669              MOV      r1,sp
000984  f105001c          ADD      r0,r5,#0x1c
000988  f7fffffe          BL       lc640_write_long_ptr
;;;659    	
;;;660    /*	memo_out0[0]=0x55;
;;;661         memo_out0[1]=0x00+2;
;;;662         memo_out0[2]=1;
;;;663         memo_out0[3]=0x0b;
;;;664         memo_out0[4]=0xaa;
;;;665         memo_out0[5]=0xaa; 
;;;666         	
;;;667         memo_out0[6]=crc_87(memo_out0,6);
;;;668    	memo_out0[7]=crc_95(memo_out0,6);
;;;669         usart_out_adr0(memo_out0,8); */
;;;670         snmp_trap_send("Main power is on",2,1,1);	
00098c  2301              MOVS     r3,#1
00098e  461a              MOV      r2,r3
000990  2102              MOVS     r1,#2
000992  a0ef              ADR      r0,|L1.3408|
000994  f7fffffe          BL       snmp_trap_send
                  |L1.2456|
;;;671    	}
;;;672    avar_unet_hndl_end:
;;;673    	__nop();		
000998  bf00              NOP      
                  |L1.2458|
;;;674    }
00099a  e691              B        |L1.1728|
;;;675    
                          ENDP

                  avar_bps_hndl PROC
;;;676    //-----------------------------------------------
;;;677    void avar_bps_hndl(char dev, char v, char in)
00099c  e92d4ff8          PUSH     {r3-r11,lr}
;;;678    {
0009a0  4606              MOV      r6,r0
0009a2  460c              MOV      r4,r1
;;;679    char data[4];
;;;680    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;681    char avar_simbol;
;;;682    
;;;683    avar_simbol='T';
0009a4  f04f0754          MOV      r7,#0x54
;;;684    if(v==0)avar_simbol='T';
0009a8  b174              CBZ      r4,|L1.2504|
;;;685    else if(v==1)avar_simbol='U';
0009aa  2c01              CMP      r4,#1
0009ac  d004              BEQ      |L1.2488|
;;;686    else if(v==2)avar_simbol='u';
0009ae  2c02              CMP      r4,#2
0009b0  d005              BEQ      |L1.2494|
;;;687    else if(v==3)avar_simbol='L';
0009b2  2c03              CMP      r4,#3
0009b4  d006              BEQ      |L1.2500|
0009b6  e007              B        |L1.2504|
                  |L1.2488|
0009b8  f04f0755          MOV      r7,#0x55              ;685
0009bc  e004              B        |L1.2504|
                  |L1.2494|
0009be  f04f0775          MOV      r7,#0x75              ;686
0009c2  e001              B        |L1.2504|
                  |L1.2500|
0009c4  f04f074c          MOV      r7,#0x4c
                  |L1.2504|
;;;688    
;;;689    if(in==1)
;;;690    	{
;;;691    	//av_src[bps]=1;
;;;692    
;;;693    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;694    //	SET_REG(avar_stat,1,3+dev,1);
;;;695    	
;;;696    	if(v==0)bps[dev]._av|=(1<<0);
0009c8  48e7              LDR      r0,|L1.3432|
0009ca  ebc601c6          RSB      r1,r6,r6,LSL #3
;;;697    	else if(v==1) bps[dev]._av|=(1<<1);
;;;698    	else if(v==2) bps[dev]._av|=(1<<2);
;;;699    	else if(v==3) bps[dev]._av|=(1<<3);
;;;700    
;;;701    	bps[dev]._last_avar=v;
;;;702    
;;;703    	//beep_init(0x33333333,'A');
;;;704    
;;;705    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;706    	event_ptr++;	
;;;707    	if(event_ptr>63)event_ptr=0;	
;;;708    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;709    	
;;;710        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;711    	if(event_cnt!=63)event_cnt=event_ptr;
;;;712    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;713    	
;;;714    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;715    	
;;;716    	data[0]='S';
;;;717    	data[1]=dev; 
;;;718    	data[2]=avar_simbol;
;;;719    	data[3]=0;
;;;720    	lc640_write_long_ptr(lc640_adr,data);
;;;721    
;;;722    	data[0]=0;
;;;723    	data[1]=0;
;;;724    	data[2]=0;
;;;725    	data[3]=0;
;;;726    	lc640_write_long_ptr(lc640_adr+4,data);
;;;727    
;;;728    	data[0]=LPC_RTC->YEAR;
0009ce  f8df8394          LDR      r8,|L1.3428|
0009d2  eb011106          ADD      r1,r1,r6,LSL #4       ;696
0009d6  f04f0900          MOV      r9,#0                 ;678
0009da  f44f6a60          MOV      r10,#0xe00            ;705
0009de  f44f6580          MOV      r5,#0x400             ;714
0009e2  eb000081          ADD      r0,r0,r1,LSL #2       ;696
0009e6  2a01              CMP      r2,#1                 ;689
0009e8  d002              BEQ      |L1.2544|
;;;729    	data[1]=LPC_RTC->MONTH;
;;;730    	data[2]=LPC_RTC->DOM;
;;;731    	data[3]=0;
;;;732    	lc640_write_long_ptr(lc640_adr+8,data);
;;;733    
;;;734    	data[0]=LPC_RTC->HOUR;
;;;735    	data[1]=LPC_RTC->MIN;
;;;736    	data[2]=LPC_RTC->SEC;
;;;737    	data[3]=0;
;;;738    	lc640_write_long_ptr(lc640_adr+12,data);
;;;739    	
;;;740    	data[0]='A';
;;;741    	data[1]='A';
;;;742    	data[2]='A';
;;;743    	data[3]='A';
;;;744    	lc640_write_long_ptr(lc640_adr+16,data);
;;;745    	
;;;746    	data[0]='A';
;;;747    	data[1]='A';
;;;748    	data[2]='A';
;;;749    	data[3]='A';
;;;750    	lc640_write_long_ptr(lc640_adr+20,data);
;;;751    	
;;;752    	data[0]='A';
;;;753    	data[1]='A';
;;;754    	data[2]='A';
;;;755    	data[3]='A';
;;;756    	lc640_write_long_ptr(lc640_adr+24,data);
;;;757    	
;;;758    	data[0]='A';
;;;759    	data[1]='A';
;;;760    	data[2]='A';
;;;761    	data[3]='A';
;;;762    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;763    
;;;764    
;;;765    	if(dev==0)
;;;766    		{
;;;767    		if(v==0)
;;;768    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;769    		else if(v==1)
;;;770    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;771    		else if(v==2)
;;;772    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;773    		else if(v==3)
;;;774    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;775    		}
;;;776    	else if(dev==1)
;;;777    		{
;;;778    		if(v==0)
;;;779    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;780    		else if(v==1)
;;;781    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;782    		else if(v==2)
;;;783    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;784    		else if(v==3)
;;;785    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;786    		} 
;;;787    	else if(dev==2)
;;;788    		{
;;;789    		if(v==0)
;;;790    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;791    		else if(v==1)
;;;792    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;793    		else if(v==2)
;;;794    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;795    		else if(v==3)
;;;796    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;797    		} 	
;;;798    			
;;;799    	}
;;;800    
;;;801    else if(in==0)
0009ea  2a00              CMP      r2,#0
0009ec  d07e              BEQ      |L1.2796|
0009ee  e283              B        |L1.3832|
                  |L1.2544|
0009f0  b134              CBZ      r4,|L1.2560|
0009f2  2c01              CMP      r4,#1                 ;697
0009f4  d009              BEQ      |L1.2570|
0009f6  2c02              CMP      r4,#2                 ;698
0009f8  d00c              BEQ      |L1.2580|
0009fa  2c03              CMP      r4,#3                 ;699
0009fc  d00f              BEQ      |L1.2590|
0009fe  e012              B        |L1.2598|
                  |L1.2560|
000a00  7841              LDRB     r1,[r0,#1]            ;696
000a02  f0410101          ORR      r1,r1,#1              ;696
000a06  7041              STRB     r1,[r0,#1]            ;696
000a08  e00d              B        |L1.2598|
                  |L1.2570|
000a0a  7841              LDRB     r1,[r0,#1]            ;697
000a0c  f0410102          ORR      r1,r1,#2              ;697
000a10  7041              STRB     r1,[r0,#1]            ;697
000a12  e008              B        |L1.2598|
                  |L1.2580|
000a14  7841              LDRB     r1,[r0,#1]            ;698
000a16  f0410104          ORR      r1,r1,#4              ;698
000a1a  7041              STRB     r1,[r0,#1]            ;698
000a1c  e003              B        |L1.2598|
                  |L1.2590|
000a1e  7841              LDRB     r1,[r0,#1]            ;699
000a20  f0410108          ORR      r1,r1,#8              ;699
000a24  7041              STRB     r1,[r0,#1]            ;699
                  |L1.2598|
000a26  f8804053          STRB     r4,[r0,#0x53]         ;701
000a2a  4650              MOV      r0,r10                ;705
000a2c  f7fffffe          BL       lc640_read_int
000a30  f1000001          ADD      r0,r0,#1              ;706
000a34  fa1ffb80          UXTH     r11,r0                ;706
000a38  f1bb0f3f          CMP      r11,#0x3f             ;707
000a3c  d901              BLS      |L1.2626|
000a3e  f04f0b00          MOV      r11,#0                ;707
                  |L1.2626|
000a42  fa0ff18b          SXTH     r1,r11                ;708
000a46  4650              MOV      r0,r10                ;708
000a48  f7fffffe          BL       lc640_write_int
000a4c  f6406002          MOV      r0,#0xe02             ;710
000a50  f7fffffe          BL       lc640_read_int
000a54  b280              UXTH     r0,r0                 ;710
000a56  283f              CMP      r0,#0x3f              ;711
000a58  d000              BEQ      |L1.2652|
000a5a  4658              MOV      r0,r11                ;711
                  |L1.2652|
000a5c  b201              SXTH     r1,r0                 ;712
000a5e  f6406002          MOV      r0,#0xe02             ;712
000a62  f7fffffe          BL       lc640_write_int
000a66  4650              MOV      r0,r10                ;714
000a68  f7fffffe          BL       lc640_read_int
000a6c  eb051040          ADD      r0,r5,r0,LSL #5       ;714
000a70  b285              UXTH     r5,r0                 ;714
000a72  f04f0053          MOV      r0,#0x53              ;716
000a76  f88d0000          STRB     r0,[sp,#0]            ;716
000a7a  f88d6001          STRB     r6,[sp,#1]            ;717
000a7e  f88d7002          STRB     r7,[sp,#2]            ;718
000a82  f88d9003          STRB     r9,[sp,#3]            ;719
000a86  4669              MOV      r1,sp                 ;720
000a88  4628              MOV      r0,r5                 ;720
000a8a  f7fffffe          BL       lc640_write_long_ptr
000a8e  f8cd9000          STR      r9,[sp,#0]            ;725
000a92  4669              MOV      r1,sp                 ;726
000a94  1d28              ADDS     r0,r5,#4              ;726
000a96  f7fffffe          BL       lc640_write_long_ptr
000a9a  f8b8003c          LDRH     r0,[r8,#0x3c]         ;728
000a9e  f88d0000          STRB     r0,[sp,#0]            ;728
000aa2  f8980038          LDRB     r0,[r8,#0x38]         ;729
000aa6  f88d0001          STRB     r0,[sp,#1]            ;729
000aaa  f898002c          LDRB     r0,[r8,#0x2c]         ;730
000aae  f88d0002          STRB     r0,[sp,#2]            ;730
000ab2  f88d9003          STRB     r9,[sp,#3]            ;731
000ab6  4669              MOV      r1,sp                 ;732
000ab8  f1050008          ADD      r0,r5,#8              ;732
000abc  f7fffffe          BL       lc640_write_long_ptr
000ac0  f8980028          LDRB     r0,[r8,#0x28]         ;734
000ac4  f88d0000          STRB     r0,[sp,#0]            ;734
000ac8  f8980024          LDRB     r0,[r8,#0x24]         ;735
000acc  f88d0001          STRB     r0,[sp,#1]            ;735
000ad0  f8980020          LDRB     r0,[r8,#0x20]         ;736
000ad4  f88d0002          STRB     r0,[sp,#2]            ;736
000ad8  f88d9003          STRB     r9,[sp,#3]            ;737
000adc  4669              MOV      r1,sp                 ;738
000ade  f105000c          ADD      r0,r5,#0xc            ;738
000ae2  f7fffffe          BL       lc640_write_long_ptr
000ae6  f04f0741          MOV      r7,#0x41              ;740
000aea  e000              B        |L1.2798|
                  |L1.2796|
000aec  e0a5              B        |L1.3130|
                  |L1.2798|
000aee  f88d7000          STRB     r7,[sp,#0]            ;740
000af2  f88d7001          STRB     r7,[sp,#1]            ;741
000af6  f88d7002          STRB     r7,[sp,#2]            ;742
000afa  f88d7003          STRB     r7,[sp,#3]            ;743
000afe  4669              MOV      r1,sp                 ;744
000b00  f1050010          ADD      r0,r5,#0x10           ;744
000b04  f7fffffe          BL       lc640_write_long_ptr
000b08  f88d7000          STRB     r7,[sp,#0]            ;746
000b0c  f88d7001          STRB     r7,[sp,#1]            ;747
000b10  f88d7002          STRB     r7,[sp,#2]            ;748
000b14  f88d7003          STRB     r7,[sp,#3]            ;749
000b18  4669              MOV      r1,sp                 ;750
000b1a  f1050014          ADD      r0,r5,#0x14           ;750
000b1e  f7fffffe          BL       lc640_write_long_ptr
000b22  f88d7000          STRB     r7,[sp,#0]            ;752
000b26  f88d7001          STRB     r7,[sp,#1]            ;753
000b2a  f88d7002          STRB     r7,[sp,#2]            ;754
000b2e  f88d7003          STRB     r7,[sp,#3]            ;755
000b32  4669              MOV      r1,sp                 ;756
000b34  f1050018          ADD      r0,r5,#0x18           ;756
000b38  f7fffffe          BL       lc640_write_long_ptr
000b3c  f88d7000          STRB     r7,[sp,#0]            ;758
000b40  f88d7001          STRB     r7,[sp,#1]            ;759
000b44  f88d7002          STRB     r7,[sp,#2]            ;760
000b48  f88d7003          STRB     r7,[sp,#3]            ;761
000b4c  4669              MOV      r1,sp                 ;762
000b4e  f105001c          ADD      r0,r5,#0x1c           ;762
000b52  f7fffffe          BL       lc640_write_long_ptr
000b56  b126              CBZ      r6,|L1.2914|
000b58  2e01              CMP      r6,#1                 ;776
000b5a  d026              BEQ      |L1.2986|
000b5c  2e02              CMP      r6,#2                 ;787
000b5e  d048              BEQ      |L1.3058|
000b60  e1ca              B        |L1.3832|
                  |L1.2914|
000b62  b134              CBZ      r4,|L1.2930|
000b64  2c01              CMP      r4,#1                 ;769
000b66  d00b              BEQ      |L1.2944|
000b68  2c02              CMP      r4,#2                 ;771
000b6a  d010              BEQ      |L1.2958|
000b6c  2c03              CMP      r4,#3                 ;773
000b6e  d015              BEQ      |L1.2972|
000b70  e1c2              B        |L1.3832|
                  |L1.2930|
000b72  2300              MOVS     r3,#0                 ;768
000b74  2201              MOVS     r2,#1                 ;768
000b76  2104              MOVS     r1,#4                 ;768
000b78  a07c              ADR      r0,|L1.3436|
000b7a  f7fffffe          BL       snmp_trap_send
000b7e  e1bb              B        |L1.3832|
                  |L1.2944|
000b80  2301              MOVS     r3,#1                 ;770
000b82  461a              MOV      r2,r3                 ;770
000b84  2104              MOVS     r1,#4                 ;770
000b86  a07f              ADR      r0,|L1.3460|
000b88  f7fffffe          BL       snmp_trap_send
000b8c  e1b4              B        |L1.3832|
                  |L1.2958|
000b8e  2302              MOVS     r3,#2                 ;772
000b90  2201              MOVS     r2,#1                 ;772
000b92  2104              MOVS     r1,#4                 ;772
000b94  a082              ADR      r0,|L1.3488|
000b96  f7fffffe          BL       snmp_trap_send
000b9a  e1ad              B        |L1.3832|
                  |L1.2972|
000b9c  2303              MOVS     r3,#3                 ;774
000b9e  2201              MOVS     r2,#1                 ;774
000ba0  2104              MOVS     r1,#4                 ;774
000ba2  a087              ADR      r0,|L1.3520|
000ba4  f7fffffe          BL       snmp_trap_send
000ba8  e1a6              B        |L1.3832|
                  |L1.2986|
000baa  b134              CBZ      r4,|L1.3002|
000bac  2c01              CMP      r4,#1                 ;780
000bae  d00b              BEQ      |L1.3016|
000bb0  2c02              CMP      r4,#2                 ;782
000bb2  d010              BEQ      |L1.3030|
000bb4  2c03              CMP      r4,#3                 ;784
000bb6  d015              BEQ      |L1.3044|
000bb8  e19e              B        |L1.3832|
                  |L1.3002|
000bba  2300              MOVS     r3,#0                 ;779
000bbc  2202              MOVS     r2,#2                 ;779
000bbe  2104              MOVS     r1,#4                 ;779
000bc0  a087              ADR      r0,|L1.3552|
000bc2  f7fffffe          BL       snmp_trap_send
000bc6  e197              B        |L1.3832|
                  |L1.3016|
000bc8  2301              MOVS     r3,#1                 ;781
000bca  2202              MOVS     r2,#2                 ;781
000bcc  2104              MOVS     r1,#4                 ;781
000bce  a08a              ADR      r0,|L1.3576|
000bd0  f7fffffe          BL       snmp_trap_send
000bd4  e190              B        |L1.3832|
                  |L1.3030|
000bd6  2302              MOVS     r3,#2                 ;783
000bd8  461a              MOV      r2,r3                 ;783
000bda  2104              MOVS     r1,#4                 ;783
000bdc  a08d              ADR      r0,|L1.3604|
000bde  f7fffffe          BL       snmp_trap_send
000be2  e189              B        |L1.3832|
                  |L1.3044|
000be4  2303              MOVS     r3,#3                 ;785
000be6  2202              MOVS     r2,#2                 ;785
000be8  2104              MOVS     r1,#4                 ;785
000bea  a092              ADR      r0,|L1.3636|
000bec  f7fffffe          BL       snmp_trap_send
000bf0  e182              B        |L1.3832|
                  |L1.3058|
000bf2  b134              CBZ      r4,|L1.3074|
000bf4  2c01              CMP      r4,#1                 ;791
000bf6  d00b              BEQ      |L1.3088|
000bf8  2c02              CMP      r4,#2                 ;793
000bfa  d010              BEQ      |L1.3102|
000bfc  2c03              CMP      r4,#3                 ;795
000bfe  d015              BEQ      |L1.3116|
000c00  e17a              B        |L1.3832|
                  |L1.3074|
000c02  2300              MOVS     r3,#0                 ;790
000c04  2203              MOVS     r2,#3                 ;790
000c06  2104              MOVS     r1,#4                 ;790
000c08  a092              ADR      r0,|L1.3668|
000c0a  f7fffffe          BL       snmp_trap_send
000c0e  e173              B        |L1.3832|
                  |L1.3088|
000c10  2301              MOVS     r3,#1                 ;792
000c12  2203              MOVS     r2,#3                 ;792
000c14  2104              MOVS     r1,#4                 ;792
000c16  a095              ADR      r0,|L1.3692|
000c18  f7fffffe          BL       snmp_trap_send
000c1c  e16c              B        |L1.3832|
                  |L1.3102|
000c1e  2302              MOVS     r3,#2                 ;794
000c20  2203              MOVS     r2,#3                 ;794
000c22  2104              MOVS     r1,#4                 ;794
000c24  a098              ADR      r0,|L1.3720|
000c26  f7fffffe          BL       snmp_trap_send
000c2a  e165              B        |L1.3832|
                  |L1.3116|
000c2c  2303              MOVS     r3,#3                 ;796
000c2e  461a              MOV      r2,r3                 ;796
000c30  2104              MOVS     r1,#4                 ;796
000c32  a09d              ADR      r0,|L1.3752|
000c34  f7fffffe          BL       snmp_trap_send
000c38  e15e              B        |L1.3832|
                  |L1.3130|
;;;802    	{      
;;;803    //	av_bps[bps]=0;
;;;804    
;;;805    	//SET_REG(avar_stat,0,3+bps,1);
;;;806    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;807    
;;;808         if(v==0) bps[dev]._av&=(~(1<<0));
000c3a  b134              CBZ      r4,|L1.3146|
;;;809         else if(v==1) bps[dev]._av&=(~(1<<1));
000c3c  2c01              CMP      r4,#1
000c3e  d009              BEQ      |L1.3156|
;;;810    	else if(v==2) bps[dev]._av&=(~(1<<2));
000c40  2c02              CMP      r4,#2
000c42  d00c              BEQ      |L1.3166|
;;;811    	else if(v==3) bps[dev]._av&=(~(1<<3));
000c44  2c03              CMP      r4,#3
000c46  d00f              BEQ      |L1.3176|
000c48  e012              B        |L1.3184|
                  |L1.3146|
000c4a  7841              LDRB     r1,[r0,#1]            ;808
000c4c  f0210101          BIC      r1,r1,#1              ;808
000c50  7041              STRB     r1,[r0,#1]            ;808
000c52  e00d              B        |L1.3184|
                  |L1.3156|
000c54  7841              LDRB     r1,[r0,#1]            ;809
000c56  f0210102          BIC      r1,r1,#2              ;809
000c5a  7041              STRB     r1,[r0,#1]            ;809
000c5c  e008              B        |L1.3184|
                  |L1.3166|
000c5e  7841              LDRB     r1,[r0,#1]            ;810
000c60  f0210104          BIC      r1,r1,#4              ;810
000c64  7041              STRB     r1,[r0,#1]            ;810
000c66  e003              B        |L1.3184|
                  |L1.3176|
000c68  7841              LDRB     r1,[r0,#1]
000c6a  f0210108          BIC      r1,r1,#8
000c6e  7041              STRB     r1,[r0,#1]
                  |L1.3184|
;;;812         
;;;813    //	if((bps[dev]._av&0x0f==0))
;;;814    //	     {
;;;815    		//SET_REG(avar_stat,0,3+bps,1);
;;;816    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;817    //	     }
;;;818     
;;;819    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000c70  4650              MOV      r0,r10
000c72  f7fffffe          BL       lc640_read_int
000c76  fa1ffb80          UXTH     r11,r0
;;;820    	event_ptr_find=event_ptr;
000c7a  465c              MOV      r4,r11
                  |L1.3196|
;;;821    	
;;;822    avar_src_hndl_lbl1: 
;;;823    
;;;824    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000c7c  eb051044          ADD      r0,r5,r4,LSL #5
000c80  fa1ffa80          UXTH     r10,r0
;;;825    
;;;826         lc640_read_long_ptr(lc640_adr,data);
000c84  4669              MOV      r1,sp
000c86  4650              MOV      r0,r10
000c88  f7fffffe          BL       lc640_read_long_ptr
;;;827         
;;;828         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000c8c  f89d0000          LDRB     r0,[sp,#0]
000c90  2853              CMP      r0,#0x53
000c92  d107              BNE      |L1.3236|
000c94  f89d0001          LDRB     r0,[sp,#1]
000c98  42b0              CMP      r0,r6
000c9a  d103              BNE      |L1.3236|
000c9c  f89d0002          LDRB     r0,[sp,#2]
000ca0  42b8              CMP      r0,r7
000ca2  d009              BEQ      |L1.3256|
                  |L1.3236|
;;;829         	{        
;;;830         	if(event_ptr_find)event_ptr_find--;
000ca4  b11c              CBZ      r4,|L1.3246|
000ca6  f1a40401          SUB      r4,r4,#1
000caa  b2a4              UXTH     r4,r4
000cac  e001              B        |L1.3250|
                  |L1.3246|
;;;831         	else event_ptr_find=63;
000cae  f04f043f          MOV      r4,#0x3f
                  |L1.3250|
;;;832         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000cb2  455c              CMP      r4,r11
000cb4  d1e2              BNE      |L1.3196|
000cb6  e11f              B        |L1.3832|
                  |L1.3256|
;;;833         	else goto avar_src_hndl_lbl1;
;;;834         	}
;;;835         else 
;;;836         	{
;;;837         	lc640_read_long_ptr(lc640_adr+16,data);
000cb8  4669              MOV      r1,sp
000cba  f10a0010          ADD      r0,r10,#0x10
000cbe  f7fffffe          BL       lc640_read_long_ptr
;;;838         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000cc2  f89d0000          LDRB     r0,[sp,#0]
000cc6  2841              CMP      r0,#0x41
000cc8  d10b              BNE      |L1.3298|
000cca  f89d0001          LDRB     r0,[sp,#1]
000cce  2841              CMP      r0,#0x41
000cd0  d107              BNE      |L1.3298|
000cd2  f89d0002          LDRB     r0,[sp,#2]
000cd6  2841              CMP      r0,#0x41
000cd8  d103              BNE      |L1.3298|
000cda  f89d0003          LDRB     r0,[sp,#3]
000cde  2841              CMP      r0,#0x41
000ce0  d009              BEQ      |L1.3318|
                  |L1.3298|
;;;839         		{        
;;;840         		if(event_ptr_find)event_ptr_find--;
000ce2  b11c              CBZ      r4,|L1.3308|
000ce4  f1a40401          SUB      r4,r4,#1
000ce8  b2a4              UXTH     r4,r4
000cea  e001              B        |L1.3312|
                  |L1.3308|
;;;841             		else event_ptr_find=63;
000cec  f04f043f          MOV      r4,#0x3f
                  |L1.3312|
;;;842             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000cf0  455c              CMP      r4,r11
000cf2  d1c3              BNE      |L1.3196|
000cf4  e100              B        |L1.3832|
                  |L1.3318|
;;;843         		else goto avar_src_hndl_lbl1;
;;;844         		}
;;;845    
;;;846         	}	
;;;847    
;;;848    
;;;849    	
;;;850    	data[0]=LPC_RTC->YEAR;
000cf6  f8b8003c          LDRH     r0,[r8,#0x3c]
000cfa  f88d0000          STRB     r0,[sp,#0]
;;;851    	data[1]=LPC_RTC->MONTH;
000cfe  f8980038          LDRB     r0,[r8,#0x38]
000d02  f88d0001          STRB     r0,[sp,#1]
;;;852    	data[2]=LPC_RTC->DOM;
000d06  f898002c          LDRB     r0,[r8,#0x2c]
000d0a  f88d0002          STRB     r0,[sp,#2]
;;;853    	data[3]=0;
000d0e  f88d9003          STRB     r9,[sp,#3]
;;;854    	lc640_write_long_ptr(lc640_adr+16,data);
000d12  4669              MOV      r1,sp
000d14  f10a0010          ADD      r0,r10,#0x10
000d18  f7fffffe          BL       lc640_write_long_ptr
;;;855    
;;;856    	data[0]=LPC_RTC->HOUR;
000d1c  f8980028          LDRB     r0,[r8,#0x28]
000d20  f88d0000          STRB     r0,[sp,#0]
;;;857    	data[1]=LPC_RTC->MIN;
000d24  f8980024          LDRB     r0,[r8,#0x24]
000d28  f88d0001          STRB     r0,[sp,#1]
;;;858    	data[2]=LPC_RTC->SEC;
000d2c  f8980020          LDRB     r0,[r8,#0x20]
000d30  f88d0002          STRB     r0,[sp,#2]
;;;859    	data[3]=0;
000d34  f88d9003          STRB     r9,[sp,#3]
;;;860    	lc640_write_long_ptr(lc640_adr+20,data);
000d38  4669              MOV      r1,sp
000d3a  f10a0014          ADD      r0,r10,#0x14
000d3e  f7fffffe          BL       lc640_write_long_ptr
;;;861    	
;;;862    	data[0]='B';
000d42  f04f0442          MOV      r4,#0x42
000d46  f88d4000          STRB     r4,[sp,#0]
;;;863    	data[1]='B';
000d4a  e0bd              B        |L1.3784|
                  |L1.3404|
                          DCD      net_Ustore
                  |L1.3408|
000d50  4d61696e          DCB      "Main power is on",0
000d54  20706f77
000d58  65722069
000d5c  73206f6e
000d60  00      
000d61  00                DCB      0
000d62  00                DCB      0
000d63  00                DCB      0
                  |L1.3428|
                          DCD      0x40024000
                  |L1.3432|
                          DCD      bps
                  |L1.3436|
000d6c  42505320          DCB      "BPS #1 Alarm, overheat",0
000d70  23312041
000d74  6c61726d
000d78  2c206f76
000d7c  65726865
000d80  617400  
000d83  00                DCB      0
                  |L1.3460|
000d84  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000d88  23312041
000d8c  6c61726d
000d90  2c20766f
000d94  6c746167
000d98  65206973
000d9c  20757000
                  |L1.3488|
000da0  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000da4  23312041
000da8  6c61726d
000dac  2c20766f
000db0  6c746167
000db4  65206973
000db8  20646f77
000dbc  6e00    
000dbe  00                DCB      0
000dbf  00                DCB      0
                  |L1.3520|
000dc0  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000dc4  23312041
000dc8  6c61726d
000dcc  2c20636f
000dd0  6e6e6563
000dd4  74206973
000dd8  206c6f73
000ddc  7400    
000dde  00                DCB      0
000ddf  00                DCB      0
                  |L1.3552|
000de0  42505320          DCB      "BPS #2 Alarm, overheat",0
000de4  23322041
000de8  6c61726d
000dec  2c206f76
000df0  65726865
000df4  617400  
000df7  00                DCB      0
                  |L1.3576|
000df8  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000dfc  23322041
000e00  6c61726d
000e04  2c20766f
000e08  6c746167
000e0c  65206973
000e10  20757000
                  |L1.3604|
000e14  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000e18  23322041
000e1c  6c61726d
000e20  2c20766f
000e24  6c746167
000e28  65206973
000e2c  20646f77
000e30  6e00    
000e32  00                DCB      0
000e33  00                DCB      0
                  |L1.3636|
000e34  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000e38  23322041
000e3c  6c61726d
000e40  2c20636f
000e44  6e6e6563
000e48  74206973
000e4c  206c6f73
000e50  7400    
000e52  00                DCB      0
000e53  00                DCB      0
                  |L1.3668|
000e54  42505320          DCB      "BPS #3 Alarm, overheat",0
000e58  23332041
000e5c  6c61726d
000e60  2c206f76
000e64  65726865
000e68  617400  
000e6b  00                DCB      0
                  |L1.3692|
000e6c  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000e70  23332041
000e74  6c61726d
000e78  2c20766f
000e7c  6c746167
000e80  65206973
000e84  20757000
                  |L1.3720|
000e88  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000e8c  23332041
000e90  6c61726d
000e94  2c20766f
000e98  6c746167
000e9c  65206973
000ea0  20646f77
000ea4  6e00    
000ea6  00                DCB      0
000ea7  00                DCB      0
                  |L1.3752|
000ea8  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000eac  23332041
000eb0  6c61726d
000eb4  2c20636f
000eb8  6e6e6563
000ebc  74206973
000ec0  206c6f73
000ec4  7400    
000ec6  00                DCB      0
000ec7  00                DCB      0
                  |L1.3784|
000ec8  f88d4001          STRB     r4,[sp,#1]
;;;864    	data[2]='B';
000ecc  f88d4002          STRB     r4,[sp,#2]
;;;865    	data[3]='B';
000ed0  f88d4003          STRB     r4,[sp,#3]
;;;866    	lc640_write_long_ptr(lc640_adr+24,data);
000ed4  4669              MOV      r1,sp
000ed6  f10a0018          ADD      r0,r10,#0x18
000eda  f7fffffe          BL       lc640_write_long_ptr
;;;867    	
;;;868    	data[0]='B';
000ede  f88d4000          STRB     r4,[sp,#0]
;;;869    	data[1]='B';
000ee2  f88d4001          STRB     r4,[sp,#1]
;;;870    	data[2]='B';
000ee6  f88d4002          STRB     r4,[sp,#2]
;;;871    	data[3]='B';
000eea  f88d4003          STRB     r4,[sp,#3]
;;;872    	lc640_write_long_ptr(lc640_adr+28,data);
000eee  4669              MOV      r1,sp
000ef0  f10a001c          ADD      r0,r10,#0x1c
000ef4  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3832|
;;;873    	
;;;874    	}
;;;875    	
;;;876    avar_src_hndl_end:
;;;877    __nop();		
000ef8  bf00              NOP      
                  |L1.3834|
;;;878    }
000efa  e54e              B        |L1.2458|
;;;879    
                          ENDP

                  wrk_mem_hndl PROC
;;;880    //-----------------------------------------------
;;;881    void wrk_mem_hndl(char b)
000efc  e92d41fc          PUSH     {r2-r8,lr}
;;;882    {
000f00  4606              MOV      r6,r0
;;;883    char data[4];
;;;884    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;885    
;;;886    signed short temp_temp;
;;;887    
;;;888    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000f02  eb060046          ADD      r0,r6,r6,LSL #1
000f06  eb001106          ADD      r1,r0,r6,LSL #4
000f0a  48ff              LDR      r0,|L1.4872|
000f0c  eb000481          ADD      r4,r0,r1,LSL #2
000f10  8be0              LDRH     r0,[r4,#0x1e]
000f12  2805              CMP      r0,#5
000f14  d37e              BCC      |L1.4116|
;;;889    
;;;890    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000f16  48fd              LDR      r0,|L1.4876|
000f18  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000f1a  f1000006          ADD      r0,r0,#6
000f1e  f0000007          AND      r0,r0,#7
000f22  eb040040          ADD      r0,r4,r0,LSL #1
000f26  8c00              LDRH     r0,[r0,#0x20]
000f28  9000              STR      r0,[sp,#0]
;;;891    
;;;892    
;;;893    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000f2a  f44f6760          MOV      r7,#0xe00
000f2e  4638              MOV      r0,r7
000f30  f7fffffe          BL       lc640_read_int
;;;894    event_ptr++;	
000f34  f1000001          ADD      r0,r0,#1
000f38  b285              UXTH     r5,r0
;;;895    if(event_ptr>63)event_ptr=0;	
000f3a  2d3f              CMP      r5,#0x3f
000f3c  d901              BLS      |L1.3906|
000f3e  f04f0500          MOV      r5,#0
                  |L1.3906|
;;;896    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000f42  b229              SXTH     r1,r5
000f44  4638              MOV      r0,r7
000f46  f7fffffe          BL       lc640_write_int
;;;897    	
;;;898    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000f4a  f6406802          MOV      r8,#0xe02
000f4e  4640              MOV      r0,r8
000f50  f7fffffe          BL       lc640_read_int
000f54  b280              UXTH     r0,r0
;;;899    if(event_cnt!=63)event_cnt=event_ptr;
000f56  283f              CMP      r0,#0x3f
000f58  d000              BEQ      |L1.3932|
000f5a  4628              MOV      r0,r5
                  |L1.3932|
;;;900    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000f5c  b201              SXTH     r1,r0
000f5e  4640              MOV      r0,r8
000f60  f7fffffe          BL       lc640_write_int
;;;901    	
;;;902    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000f64  4638              MOV      r0,r7
000f66  f7fffffe          BL       lc640_read_int
000f6a  f44f6180          MOV      r1,#0x400
000f6e  eb011040          ADD      r0,r1,r0,LSL #5
000f72  b285              UXTH     r5,r0
;;;903    	
;;;904    data[0]='B';
000f74  f04f0042          MOV      r0,#0x42
000f78  f88d0004          STRB     r0,[sp,#4]
;;;905    data[1]=b; 
000f7c  f88d6005          STRB     r6,[sp,#5]
;;;906    data[2]='W';
000f80  f04f0057          MOV      r0,#0x57
000f84  f88d0006          STRB     r0,[sp,#6]
;;;907    data[3]=0;
000f88  f04f0600          MOV      r6,#0
000f8c  f88d6007          STRB     r6,[sp,#7]
;;;908    
;;;909    lc640_write_long_ptr(lc640_adr,data);
000f90  a901              ADD      r1,sp,#4
000f92  4628              MOV      r0,r5
000f94  f7fffffe          BL       lc640_write_long_ptr
;;;910    
;;;911    data[0]=*((char*)&bat[b]._Iintegr_);
000f98  7fa0              LDRB     r0,[r4,#0x1e]
000f9a  f88d0004          STRB     r0,[sp,#4]
;;;912    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000f9e  7fe0              LDRB     r0,[r4,#0x1f]
000fa0  f88d0005          STRB     r0,[sp,#5]
;;;913    data[2]=*((char*)&temp_temp);
000fa4  f89d0000          LDRB     r0,[sp,#0]
000fa8  f88d0006          STRB     r0,[sp,#6]
;;;914    data[3]=*(((char*)(&temp_temp))+1);
000fac  f89d0001          LDRB     r0,[sp,#1]
000fb0  f88d0007          STRB     r0,[sp,#7]
;;;915    lc640_write_long_ptr(lc640_adr+4,data);
000fb4  a901              ADD      r1,sp,#4
000fb6  1d28              ADDS     r0,r5,#4
000fb8  f7fffffe          BL       lc640_write_long_ptr
;;;916    
;;;917    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000fbc  f1040134          ADD      r1,r4,#0x34
000fc0  f1050008          ADD      r0,r5,#8
000fc4  f7fffffe          BL       lc640_write_long_ptr
;;;918    	
;;;919    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000fc8  f1040138          ADD      r1,r4,#0x38
000fcc  f105000c          ADD      r0,r5,#0xc
000fd0  f7fffffe          BL       lc640_write_long_ptr
;;;920    
;;;921    data[0]=LPC_RTC->YEAR;
000fd4  4cce              LDR      r4,|L1.4880|
000fd6  8ba0              LDRH     r0,[r4,#0x1c]
000fd8  f88d0004          STRB     r0,[sp,#4]
;;;922    data[1]=LPC_RTC->MONTH;
000fdc  7e20              LDRB     r0,[r4,#0x18]
000fde  f88d0005          STRB     r0,[sp,#5]
;;;923    data[2]=LPC_RTC->DOM;
000fe2  7b20              LDRB     r0,[r4,#0xc]
000fe4  f88d0006          STRB     r0,[sp,#6]
;;;924    data[3]=0;
000fe8  f88d6007          STRB     r6,[sp,#7]
;;;925    lc640_write_long_ptr(lc640_adr+16,data);
000fec  a901              ADD      r1,sp,#4
000fee  f1050010          ADD      r0,r5,#0x10
000ff2  f7fffffe          BL       lc640_write_long_ptr
;;;926    
;;;927    data[0]=LPC_RTC->HOUR;
000ff6  7a20              LDRB     r0,[r4,#8]
000ff8  f88d0004          STRB     r0,[sp,#4]
;;;928    data[1]=LPC_RTC->MIN;
000ffc  7920              LDRB     r0,[r4,#4]
000ffe  f88d0005          STRB     r0,[sp,#5]
;;;929    data[2]=LPC_RTC->SEC;
001002  7820              LDRB     r0,[r4,#0]
001004  f88d0006          STRB     r0,[sp,#6]
;;;930    data[3]=0;
001008  f88d6007          STRB     r6,[sp,#7]
;;;931    lc640_write_long_ptr(lc640_adr+20,data);
00100c  a901              ADD      r1,sp,#4
00100e  f1050014          ADD      r0,r5,#0x14
001012  e000              B        |L1.4118|
                  |L1.4116|
001014  e001              B        |L1.4122|
                  |L1.4118|
001016  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4122|
;;;932    	
;;;933    
;;;934    
;;;935    	
;;;936    wrk_mem_hndl_end:	
;;;937    __nop();
00101a  bf00              NOP      
;;;938    }  
00101c  e8bd81fc          POP      {r2-r8,pc}
;;;939    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;941    //-----------------------------------------------
;;;942    void avar_bat_ips_hndl(char in)
001020  e92d4ff8          PUSH     {r3-r11,lr}
;;;943    {
001024  4602              MOV      r2,r0
;;;944    char data[4];
;;;945    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;946    
;;;947    if(in==1)
;;;948    	{
;;;949    	bat_ips._av|=1;
001026  48bb              LDR      r0,|L1.4884|
;;;950        ips_bat_av_stat=1;
001028  4cbb              LDR      r4,|L1.4888|
;;;951    	ips_bat_av_vzvod=1;
00102a  4bbc              LDR      r3,|L1.4892|
;;;952    
;;;953    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;954    	event_ptr++;	
;;;955    	if(event_ptr>63)event_ptr=0;	
;;;956    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;957    	
;;;958    	event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;959    	if(event_cnt!=63)event_cnt=event_ptr;
;;;960    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;961    	
;;;962    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;963    	
;;;964    	data[0]='B';
;;;965    	data[1]=0;
;;;966    	data[2]='C';
;;;967    	data[3]=0;
;;;968    	lc640_write_long_ptr(lc640_adr,data);
;;;969    
;;;970    	data[0]=0;
;;;971    	data[1]=0;
;;;972    	data[2]=0;
;;;973    	data[3]=0;
;;;974    	lc640_write_long_ptr(lc640_adr+4,data);
;;;975    
;;;976    	data[0]=LPC_RTC->YEAR;
00102c  f8df82f0          LDR      r8,|L1.4896|
001030  f890103d          LDRB     r1,[r0,#0x3d]         ;949
001034  f04f0742          MOV      r7,#0x42              ;964
001038  f44f6560          MOV      r5,#0xe00             ;953
00103c  f04f0900          MOV      r9,#0                 ;955
001040  f44f6a80          MOV      r10,#0x400            ;962
001044  2a01              CMP      r2,#1                 ;947
001046  d002              BEQ      |L1.4174|
;;;977    	data[1]=LPC_RTC->MONTH;
;;;978    	data[2]=LPC_RTC->DOM;
;;;979    	data[3]=0;
;;;980    	lc640_write_long_ptr(lc640_adr+8,data);
;;;981    
;;;982    	data[0]=LPC_RTC->HOUR;
;;;983    	data[1]=LPC_RTC->MIN;
;;;984    	data[2]=LPC_RTC->SEC;
;;;985    	data[3]=0;
;;;986    	lc640_write_long_ptr(lc640_adr+12,data);
;;;987    	
;;;988    	data[0]='A';
;;;989    	data[1]='A';
;;;990    	data[2]='A';
;;;991    	data[3]='A';
;;;992    	lc640_write_long_ptr(lc640_adr+16,data);
;;;993    	
;;;994    	data[0]='A';
;;;995    	data[1]='A';
;;;996    	data[2]='A';
;;;997    	data[3]='A';
;;;998    	lc640_write_long_ptr(lc640_adr+20,data);
;;;999    	
;;;1000   	data[0]='A';
;;;1001   	data[1]='A';
;;;1002   	data[2]='A';
;;;1003   	data[3]='A';
;;;1004   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1005   	
;;;1006   	data[0]='A';
;;;1007   	data[1]='A';
;;;1008   	data[2]='A';
;;;1009   	data[3]='A';
;;;1010   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1011   					
;;;1012   	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;1013   		
;;;1014   	}
;;;1015   
;;;1016   else if(in==0)
001048  2a00              CMP      r2,#0
00104a  d07e              BEQ      |L1.4426|
00104c  e129              B        |L1.4770|
                  |L1.4174|
00104e  f0410101          ORR      r1,r1,#1              ;949
001052  f880103d          STRB     r1,[r0,#0x3d]         ;949
001056  f04f0001          MOV      r0,#1                 ;950
00105a  7020              STRB     r0,[r4,#0]            ;950
00105c  7018              STRB     r0,[r3,#0]            ;951
00105e  4628              MOV      r0,r5                 ;953
001060  f7fffffe          BL       lc640_read_int
001064  f1000001          ADD      r0,r0,#1              ;954
001068  b284              UXTH     r4,r0                 ;954
00106a  2c3f              CMP      r4,#0x3f              ;955
00106c  d901              BLS      |L1.4210|
00106e  f04f0400          MOV      r4,#0                 ;955
                  |L1.4210|
001072  b221              SXTH     r1,r4                 ;956
001074  4628              MOV      r0,r5                 ;956
001076  f7fffffe          BL       lc640_write_int
00107a  f6406602          MOV      r6,#0xe02             ;958
00107e  4630              MOV      r0,r6                 ;958
001080  f7fffffe          BL       lc640_read_int
001084  b281              UXTH     r1,r0                 ;958
001086  293f              CMP      r1,#0x3f              ;959
001088  d000              BEQ      |L1.4236|
00108a  4621              MOV      r1,r4                 ;959
                  |L1.4236|
00108c  b209              SXTH     r1,r1                 ;960
00108e  4630              MOV      r0,r6                 ;960
001090  f7fffffe          BL       lc640_write_int
001094  4628              MOV      r0,r5                 ;962
001096  f7fffffe          BL       lc640_read_int
00109a  eb0a1040          ADD      r0,r10,r0,LSL #5      ;962
00109e  b284              UXTH     r4,r0                 ;962
0010a0  f88d7000          STRB     r7,[sp,#0]            ;964
0010a4  f88d9001          STRB     r9,[sp,#1]            ;965
0010a8  f04f0043          MOV      r0,#0x43              ;966
0010ac  f88d0002          STRB     r0,[sp,#2]            ;966
0010b0  f88d9003          STRB     r9,[sp,#3]            ;967
0010b4  4669              MOV      r1,sp                 ;968
0010b6  4620              MOV      r0,r4                 ;968
0010b8  f7fffffe          BL       lc640_write_long_ptr
0010bc  f8cd9000          STR      r9,[sp,#0]            ;973
0010c0  4669              MOV      r1,sp                 ;974
0010c2  1d20              ADDS     r0,r4,#4              ;974
0010c4  f7fffffe          BL       lc640_write_long_ptr
0010c8  f8b8003c          LDRH     r0,[r8,#0x3c]         ;976
0010cc  f88d0000          STRB     r0,[sp,#0]            ;976
0010d0  f8980038          LDRB     r0,[r8,#0x38]         ;977
0010d4  f88d0001          STRB     r0,[sp,#1]            ;977
0010d8  f898002c          LDRB     r0,[r8,#0x2c]         ;978
0010dc  f88d0002          STRB     r0,[sp,#2]            ;978
0010e0  f88d9003          STRB     r9,[sp,#3]            ;979
0010e4  4669              MOV      r1,sp                 ;980
0010e6  f1040008          ADD      r0,r4,#8              ;980
0010ea  f7fffffe          BL       lc640_write_long_ptr
0010ee  f8980028          LDRB     r0,[r8,#0x28]         ;982
0010f2  f88d0000          STRB     r0,[sp,#0]            ;982
0010f6  f8980024          LDRB     r0,[r8,#0x24]         ;983
0010fa  f88d0001          STRB     r0,[sp,#1]            ;983
0010fe  f8980020          LDRB     r0,[r8,#0x20]         ;984
001102  f88d0002          STRB     r0,[sp,#2]            ;984
001106  f88d9003          STRB     r9,[sp,#3]            ;985
00110a  4669              MOV      r1,sp                 ;986
00110c  f104000c          ADD      r0,r4,#0xc            ;986
001110  f7fffffe          BL       lc640_write_long_ptr
001114  f04f0541          MOV      r5,#0x41              ;988
001118  f88d5000          STRB     r5,[sp,#0]            ;988
00111c  f88d5001          STRB     r5,[sp,#1]            ;989
001120  f88d5002          STRB     r5,[sp,#2]            ;990
001124  f88d5003          STRB     r5,[sp,#3]            ;991
001128  4669              MOV      r1,sp                 ;992
00112a  f1040010          ADD      r0,r4,#0x10           ;992
00112e  f7fffffe          BL       lc640_write_long_ptr
001132  f88d5000          STRB     r5,[sp,#0]            ;994
001136  f88d5001          STRB     r5,[sp,#1]            ;995
00113a  f88d5002          STRB     r5,[sp,#2]            ;996
00113e  f88d5003          STRB     r5,[sp,#3]            ;997
001142  4669              MOV      r1,sp                 ;998
001144  f1040014          ADD      r0,r4,#0x14           ;998
001148  e000              B        |L1.4428|
                  |L1.4426|
00114a  e022              B        |L1.4498|
                  |L1.4428|
00114c  f7fffffe          BL       lc640_write_long_ptr
001150  f88d5000          STRB     r5,[sp,#0]            ;1000
001154  f88d5001          STRB     r5,[sp,#1]            ;1001
001158  f88d5002          STRB     r5,[sp,#2]            ;1002
00115c  f88d5003          STRB     r5,[sp,#3]            ;1003
001160  4669              MOV      r1,sp                 ;1004
001162  f1040018          ADD      r0,r4,#0x18           ;1004
001166  f7fffffe          BL       lc640_write_long_ptr
00116a  f88d5000          STRB     r5,[sp,#0]            ;1006
00116e  f88d5001          STRB     r5,[sp,#1]            ;1007
001172  f88d5002          STRB     r5,[sp,#2]            ;1008
001176  f88d5003          STRB     r5,[sp,#3]            ;1009
00117a  4669              MOV      r1,sp                 ;1010
00117c  f104001c          ADD      r0,r4,#0x1c           ;1010
001180  f7fffffe          BL       lc640_write_long_ptr
001184  2301              MOVS     r3,#1                 ;1012
001186  461a              MOV      r2,r3                 ;1012
001188  2105              MOVS     r1,#5                 ;1012
00118a  a066              ADR      r0,|L1.4900|
00118c  f7fffffe          BL       snmp_trap_send
001190  e087              B        |L1.4770|
                  |L1.4498|
;;;1017   	{
;;;1018   	bat_ips._av&=~1;
001192  f0210101          BIC      r1,r1,#1
001196  f880103d          STRB     r1,[r0,#0x3d]
;;;1019   	ips_bat_av_stat=0;
00119a  f8849000          STRB     r9,[r4,#0]
;;;1020   	ips_bat_av_vzvod=0;
00119e  f8839000          STRB     r9,[r3,#0]
;;;1021        
;;;1022   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0011a2  4628              MOV      r0,r5
0011a4  f7fffffe          BL       lc640_read_int
0011a8  b286              UXTH     r6,r0
;;;1023   	event_ptr_find=event_ptr;
0011aa  4634              MOV      r4,r6
                  |L1.4524|
;;;1024   	
;;;1025   avar_bat_ips_hndl_lbl1: 
;;;1026   
;;;1027   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0011ac  eb0a1044          ADD      r0,r10,r4,LSL #5
0011b0  b285              UXTH     r5,r0
;;;1028   
;;;1029        lc640_read_long_ptr(lc640_adr,data);
0011b2  4669              MOV      r1,sp
0011b4  4628              MOV      r0,r5
0011b6  f7fffffe          BL       lc640_read_long_ptr
;;;1030        
;;;1031        if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
0011ba  f89d0000          LDRB     r0,[sp,#0]
0011be  2842              CMP      r0,#0x42
0011c0  d106              BNE      |L1.4560|
0011c2  f89d0001          LDRB     r0,[sp,#1]
0011c6  b918              CBNZ     r0,|L1.4560|
0011c8  f89d0002          LDRB     r0,[sp,#2]
0011cc  2843              CMP      r0,#0x43
0011ce  d009              BEQ      |L1.4580|
                  |L1.4560|
;;;1032        	{        
;;;1033        	if(event_ptr_find)event_ptr_find--;
0011d0  b11c              CBZ      r4,|L1.4570|
0011d2  f1a40401          SUB      r4,r4,#1
0011d6  b2a4              UXTH     r4,r4
0011d8  e001              B        |L1.4574|
                  |L1.4570|
;;;1034        	else event_ptr_find=63;
0011da  f04f043f          MOV      r4,#0x3f
                  |L1.4574|
;;;1035        	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
0011de  42b4              CMP      r4,r6
0011e0  d1e4              BNE      |L1.4524|
0011e2  e05e              B        |L1.4770|
                  |L1.4580|
;;;1036        	else goto avar_bat_ips_hndl_lbl1;
;;;1037        	}
;;;1038        else 
;;;1039        	{
;;;1040        	lc640_read_long_ptr(lc640_adr+16,data);
0011e4  4669              MOV      r1,sp
0011e6  f1050010          ADD      r0,r5,#0x10
0011ea  f7fffffe          BL       lc640_read_long_ptr
;;;1041        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0011ee  f89d0000          LDRB     r0,[sp,#0]
0011f2  2841              CMP      r0,#0x41
0011f4  d10b              BNE      |L1.4622|
0011f6  f89d0001          LDRB     r0,[sp,#1]
0011fa  2841              CMP      r0,#0x41
0011fc  d107              BNE      |L1.4622|
0011fe  f89d0002          LDRB     r0,[sp,#2]
001202  2841              CMP      r0,#0x41
001204  d103              BNE      |L1.4622|
001206  f89d0003          LDRB     r0,[sp,#3]
00120a  2841              CMP      r0,#0x41
00120c  d009              BEQ      |L1.4642|
                  |L1.4622|
;;;1042        		{        
;;;1043        		if(event_ptr_find)event_ptr_find--;
00120e  b11c              CBZ      r4,|L1.4632|
001210  f1a40401          SUB      r4,r4,#1
001214  b2a4              UXTH     r4,r4
001216  e001              B        |L1.4636|
                  |L1.4632|
;;;1044            		else event_ptr_find=63;
001218  f04f043f          MOV      r4,#0x3f
                  |L1.4636|
;;;1045            	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
00121c  42b4              CMP      r4,r6
00121e  d1c5              BNE      |L1.4524|
001220  e03f              B        |L1.4770|
                  |L1.4642|
;;;1046        		else goto avar_bat_ips_hndl_lbl1;
;;;1047        		}
;;;1048   
;;;1049        	}
;;;1050        		
;;;1051   	data[0]=LPC_RTC->YEAR;
001222  f8b8003c          LDRH     r0,[r8,#0x3c]
001226  f88d0000          STRB     r0,[sp,#0]
;;;1052   	data[1]=LPC_RTC->MONTH;
00122a  f8980038          LDRB     r0,[r8,#0x38]
00122e  f88d0001          STRB     r0,[sp,#1]
;;;1053   	data[2]=LPC_RTC->DOM;
001232  f898002c          LDRB     r0,[r8,#0x2c]
001236  f88d0002          STRB     r0,[sp,#2]
;;;1054   	data[3]=0;
00123a  f88d9003          STRB     r9,[sp,#3]
;;;1055   	lc640_write_long_ptr(lc640_adr+16,data);
00123e  4669              MOV      r1,sp
001240  f1050010          ADD      r0,r5,#0x10
001244  f7fffffe          BL       lc640_write_long_ptr
;;;1056   
;;;1057   	data[0]=LPC_RTC->HOUR;
001248  f8980028          LDRB     r0,[r8,#0x28]
00124c  f88d0000          STRB     r0,[sp,#0]
;;;1058   	data[1]=LPC_RTC->MIN;
001250  f8980024          LDRB     r0,[r8,#0x24]
001254  f88d0001          STRB     r0,[sp,#1]
;;;1059   	data[2]=LPC_RTC->SEC;
001258  f8980020          LDRB     r0,[r8,#0x20]
00125c  f88d0002          STRB     r0,[sp,#2]
;;;1060   	data[3]=0;
001260  f88d9003          STRB     r9,[sp,#3]
;;;1061   	lc640_write_long_ptr(lc640_adr+20,data);
001264  4669              MOV      r1,sp
001266  f1050014          ADD      r0,r5,#0x14
00126a  f7fffffe          BL       lc640_write_long_ptr
;;;1062   	
;;;1063   	data[0]='B';
00126e  f88d7000          STRB     r7,[sp,#0]
;;;1064   	data[1]='B';
001272  f88d7001          STRB     r7,[sp,#1]
;;;1065   	data[2]='B';
001276  f88d7002          STRB     r7,[sp,#2]
;;;1066   	data[3]='B';
00127a  f88d7003          STRB     r7,[sp,#3]
;;;1067   	lc640_write_long_ptr(lc640_adr+24,data);
00127e  4669              MOV      r1,sp
001280  f1050018          ADD      r0,r5,#0x18
001284  f7fffffe          BL       lc640_write_long_ptr
;;;1068   	
;;;1069   	data[0]='B';
001288  f88d7000          STRB     r7,[sp,#0]
;;;1070   	data[1]='B';
00128c  f88d7001          STRB     r7,[sp,#1]
;;;1071   	data[2]='B';
001290  f88d7002          STRB     r7,[sp,#2]
;;;1072   	data[3]='B';
001294  f88d7003          STRB     r7,[sp,#3]
;;;1073   	lc640_write_long_ptr(lc640_adr+28,data);
001298  4669              MOV      r1,sp
00129a  f105001c          ADD      r0,r5,#0x1c
00129e  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4770|
;;;1074   	
;;;1075   
;;;1076   	
;;;1077   	}
;;;1078   	
;;;1079   avar_bat_ips_hndl_end:
;;;1080   __nop();		
0012a2  bf00              NOP      
                  |L1.4772|
;;;1081   }
0012a4  e629              B        |L1.3834|
;;;1082   
                          ENDP

                  avar_bat_hndl PROC
;;;1085   //-----------------------------------------------
;;;1086   void avar_bat_hndl(char b, char in)
0012a6  e92d4ff8          PUSH     {r3-r11,lr}
;;;1087   {
0012aa  4606              MOV      r6,r0
;;;1088   char data[4];
;;;1089   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1090   
;;;1091   if(in==1)
;;;1092   	{
;;;1093   	bat[b]._av|=1;
0012ac  4816              LDR      r0,|L1.4872|
0012ae  eb060246          ADD      r2,r6,r6,LSL #1
;;;1094       
;;;1095   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1096   	event_ptr++;	
;;;1097   	if(event_ptr>63)event_ptr=0;	
;;;1098   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1099   	
;;;1100        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1101   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1102   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1103   	
;;;1104   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1105   	
;;;1106   	data[0]='B';
;;;1107   	data[1]=b;
;;;1108   	data[2]='C';
;;;1109   	data[3]=0;
;;;1110   	lc640_write_long_ptr(lc640_adr,data);
;;;1111   
;;;1112   	data[0]=0;
;;;1113   	data[1]=0;
;;;1114   	data[2]=0;
;;;1115   	data[3]=0;
;;;1116   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1117   
;;;1118   	data[0]=LPC_RTC->YEAR;
0012b2  f8df806c          LDR      r8,|L1.4896|
0012b6  eb021206          ADD      r2,r2,r6,LSL #4       ;1093
0012ba  f04f0a00          MOV      r10,#0                ;1097
0012be  f04f0942          MOV      r9,#0x42              ;1106
0012c2  f44f6560          MOV      r5,#0xe00             ;1095
0012c6  f44f6b80          MOV      r11,#0x400            ;1104
0012ca  eb000082          ADD      r0,r0,r2,LSL #2       ;1093
0012ce  2901              CMP      r1,#1                 ;1091
0012d0  d002              BEQ      |L1.4824|
;;;1119   	data[1]=LPC_RTC->MONTH;
;;;1120   	data[2]=LPC_RTC->DOM;
;;;1121   	data[3]=0;
;;;1122   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1123   
;;;1124   	data[0]=LPC_RTC->HOUR;
;;;1125   	data[1]=LPC_RTC->MIN;
;;;1126   	data[2]=LPC_RTC->SEC;
;;;1127   	data[3]=0;
;;;1128   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1129   	
;;;1130   	data[0]='A';
;;;1131   	data[1]='A';
;;;1132   	data[2]='A';
;;;1133   	data[3]='A';
;;;1134   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1135   	
;;;1136   	data[0]='A';
;;;1137   	data[1]='A';
;;;1138   	data[2]='A';
;;;1139   	data[3]='A';
;;;1140   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1141   	
;;;1142   	data[0]='A';
;;;1143   	data[1]='A';
;;;1144   	data[2]='A';
;;;1145   	data[3]='A';
;;;1146   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1147   	
;;;1148   	data[0]='A';
;;;1149   	data[1]='A';
;;;1150   	data[2]='A';
;;;1151   	data[3]='A';
;;;1152   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1153   					
;;;1154   	if(b==0)
;;;1155   		{
;;;1156   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1157   		}
;;;1158   	else if(b==1)
;;;1159   		{
;;;1160   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1161   		} 
;;;1162   			
;;;1163   	}
;;;1164   
;;;1165   else if(in==0)
0012d2  2900              CMP      r1,#0
0012d4  d07d              BEQ      |L1.5074|
0012d6  e149              B        |L1.5484|
                  |L1.4824|
0012d8  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1093
0012dc  f0410101          ORR      r1,r1,#1              ;1093
0012e0  7001              STRB     r1,[r0,#0]            ;1093
0012e2  4628              MOV      r0,r5                 ;1095
0012e4  f7fffffe          BL       lc640_read_int
0012e8  f1000001          ADD      r0,r0,#1              ;1096
0012ec  b284              UXTH     r4,r0                 ;1096
0012ee  2c3f              CMP      r4,#0x3f              ;1097
0012f0  d901              BLS      |L1.4854|
0012f2  f04f0400          MOV      r4,#0                 ;1097
                  |L1.4854|
0012f6  b221              SXTH     r1,r4                 ;1098
0012f8  4628              MOV      r0,r5                 ;1098
0012fa  f7fffffe          BL       lc640_write_int
0012fe  f6406702          MOV      r7,#0xe02             ;1100
001302  4638              MOV      r0,r7                 ;1100
001304  e018              B        |L1.4920|
001306  0000              DCW      0x0000
                  |L1.4872|
                          DCD      bat
                  |L1.4876|
                          DCD      bat_u_old_cnt
                  |L1.4880|
                          DCD      0x40024020
                  |L1.4884|
                          DCD      bat_ips
                  |L1.4888|
                          DCD      ips_bat_av_stat
                  |L1.4892|
                          DCD      ips_bat_av_vzvod
                  |L1.4896|
                          DCD      0x40024000
                  |L1.4900|
001324  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
001328  b9312041
00132c  6c61726d
001330  2c206c6f
001334  737400  
001337  00                DCB      0
                  |L1.4920|
001338  f7fffffe          BL       lc640_read_int
00133c  b280              UXTH     r0,r0                 ;1100
00133e  283f              CMP      r0,#0x3f              ;1101
001340  d000              BEQ      |L1.4932|
001342  4620              MOV      r0,r4                 ;1101
                  |L1.4932|
001344  b201              SXTH     r1,r0                 ;1102
001346  4638              MOV      r0,r7                 ;1102
001348  f7fffffe          BL       lc640_write_int
00134c  4628              MOV      r0,r5                 ;1104
00134e  f7fffffe          BL       lc640_read_int
001352  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1104
001356  b284              UXTH     r4,r0                 ;1104
001358  f88d9000          STRB     r9,[sp,#0]            ;1106
00135c  f88d6001          STRB     r6,[sp,#1]            ;1107
001360  f04f0043          MOV      r0,#0x43              ;1108
001364  f88d0002          STRB     r0,[sp,#2]            ;1108
001368  f88da003          STRB     r10,[sp,#3]           ;1109
00136c  4669              MOV      r1,sp                 ;1110
00136e  4620              MOV      r0,r4                 ;1110
001370  f7fffffe          BL       lc640_write_long_ptr
001374  f8cda000          STR      r10,[sp,#0]           ;1115
001378  4669              MOV      r1,sp                 ;1116
00137a  1d20              ADDS     r0,r4,#4              ;1116
00137c  f7fffffe          BL       lc640_write_long_ptr
001380  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1118
001384  f88d0000          STRB     r0,[sp,#0]            ;1118
001388  f8980038          LDRB     r0,[r8,#0x38]         ;1119
00138c  f88d0001          STRB     r0,[sp,#1]            ;1119
001390  f898002c          LDRB     r0,[r8,#0x2c]         ;1120
001394  f88d0002          STRB     r0,[sp,#2]            ;1120
001398  f88da003          STRB     r10,[sp,#3]           ;1121
00139c  4669              MOV      r1,sp                 ;1122
00139e  f1040008          ADD      r0,r4,#8              ;1122
0013a2  f7fffffe          BL       lc640_write_long_ptr
0013a6  f8980028          LDRB     r0,[r8,#0x28]         ;1124
0013aa  f88d0000          STRB     r0,[sp,#0]            ;1124
0013ae  f8980024          LDRB     r0,[r8,#0x24]         ;1125
0013b2  f88d0001          STRB     r0,[sp,#1]            ;1125
0013b6  f8980020          LDRB     r0,[r8,#0x20]         ;1126
0013ba  f88d0002          STRB     r0,[sp,#2]            ;1126
0013be  f88da003          STRB     r10,[sp,#3]           ;1127
0013c2  4669              MOV      r1,sp                 ;1128
0013c4  f104000c          ADD      r0,r4,#0xc            ;1128
0013c8  f7fffffe          BL       lc640_write_long_ptr
0013cc  f04f0541          MOV      r5,#0x41              ;1130
0013d0  e000              B        |L1.5076|
                  |L1.5074|
0013d2  e045              B        |L1.5216|
                  |L1.5076|
0013d4  f88d5000          STRB     r5,[sp,#0]            ;1130
0013d8  f88d5001          STRB     r5,[sp,#1]            ;1131
0013dc  f88d5002          STRB     r5,[sp,#2]            ;1132
0013e0  f88d5003          STRB     r5,[sp,#3]            ;1133
0013e4  4669              MOV      r1,sp                 ;1134
0013e6  f1040010          ADD      r0,r4,#0x10           ;1134
0013ea  f7fffffe          BL       lc640_write_long_ptr
0013ee  f88d5000          STRB     r5,[sp,#0]            ;1136
0013f2  f88d5001          STRB     r5,[sp,#1]            ;1137
0013f6  f88d5002          STRB     r5,[sp,#2]            ;1138
0013fa  f88d5003          STRB     r5,[sp,#3]            ;1139
0013fe  4669              MOV      r1,sp                 ;1140
001400  f1040014          ADD      r0,r4,#0x14           ;1140
001404  f7fffffe          BL       lc640_write_long_ptr
001408  f88d5000          STRB     r5,[sp,#0]            ;1142
00140c  f88d5001          STRB     r5,[sp,#1]            ;1143
001410  f88d5002          STRB     r5,[sp,#2]            ;1144
001414  f88d5003          STRB     r5,[sp,#3]            ;1145
001418  4669              MOV      r1,sp                 ;1146
00141a  f1040018          ADD      r0,r4,#0x18           ;1146
00141e  f7fffffe          BL       lc640_write_long_ptr
001422  f88d5000          STRB     r5,[sp,#0]            ;1148
001426  f88d5001          STRB     r5,[sp,#1]            ;1149
00142a  f88d5002          STRB     r5,[sp,#2]            ;1150
00142e  f88d5003          STRB     r5,[sp,#3]            ;1151
001432  4669              MOV      r1,sp                 ;1152
001434  f104001c          ADD      r0,r4,#0x1c           ;1152
001438  f7fffffe          BL       lc640_write_long_ptr
00143c  b116              CBZ      r6,|L1.5188|
00143e  2e01              CMP      r6,#1                 ;1158
001440  d007              BEQ      |L1.5202|
001442  e093              B        |L1.5484|
                  |L1.5188|
001444  2301              MOVS     r3,#1                 ;1156
001446  461a              MOV      r2,r3                 ;1156
001448  2105              MOVS     r1,#5                 ;1156
00144a  a0fe              ADR      r0,|L1.6212|
00144c  f7fffffe          BL       snmp_trap_send
001450  e08c              B        |L1.5484|
                  |L1.5202|
001452  2301              MOVS     r3,#1                 ;1160
001454  2202              MOVS     r2,#2                 ;1160
001456  2105              MOVS     r1,#5                 ;1160
001458  a0ff              ADR      r0,|L1.6232|
00145a  f7fffffe          BL       snmp_trap_send
00145e  e085              B        |L1.5484|
                  |L1.5216|
;;;1166   	{
;;;1167   	bat[b]._av&=~1;
001460  f8101f3d          LDRB     r1,[r0,#0x3d]!
001464  f0210101          BIC      r1,r1,#1
001468  7001              STRB     r1,[r0,#0]
;;;1168   
;;;1169        event_ptr=lc640_read_int(PTR_EVENT_LOG);
00146a  4628              MOV      r0,r5
00146c  f7fffffe          BL       lc640_read_int
001470  b287              UXTH     r7,r0
;;;1170   	event_ptr_find=event_ptr;
001472  463c              MOV      r4,r7
                  |L1.5236|
;;;1171   	
;;;1172   avar_bat_hndl_lbl1: 
;;;1173   
;;;1174   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001474  eb0b1044          ADD      r0,r11,r4,LSL #5
001478  b285              UXTH     r5,r0
;;;1175   
;;;1176        lc640_read_long_ptr(lc640_adr,data);
00147a  4669              MOV      r1,sp
00147c  4628              MOV      r0,r5
00147e  f7fffffe          BL       lc640_read_long_ptr
;;;1177        
;;;1178        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
001482  f89d0000          LDRB     r0,[sp,#0]
001486  2842              CMP      r0,#0x42
001488  d107              BNE      |L1.5274|
00148a  f89d0001          LDRB     r0,[sp,#1]
00148e  42b0              CMP      r0,r6
001490  d103              BNE      |L1.5274|
001492  f89d0002          LDRB     r0,[sp,#2]
001496  2843              CMP      r0,#0x43
001498  d009              BEQ      |L1.5294|
                  |L1.5274|
;;;1179        	{        
;;;1180        	if(event_ptr_find)event_ptr_find--;
00149a  b11c              CBZ      r4,|L1.5284|
00149c  f1a40401          SUB      r4,r4,#1
0014a0  b2a4              UXTH     r4,r4
0014a2  e001              B        |L1.5288|
                  |L1.5284|
;;;1181        	else event_ptr_find=63;
0014a4  f04f043f          MOV      r4,#0x3f
                  |L1.5288|
;;;1182        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
0014a8  42bc              CMP      r4,r7
0014aa  d1e3              BNE      |L1.5236|
0014ac  e05e              B        |L1.5484|
                  |L1.5294|
;;;1183        	else goto avar_bat_hndl_lbl1;
;;;1184        	}
;;;1185        else 
;;;1186        	{
;;;1187        	lc640_read_long_ptr(lc640_adr+16,data);
0014ae  4669              MOV      r1,sp
0014b0  f1050010          ADD      r0,r5,#0x10
0014b4  f7fffffe          BL       lc640_read_long_ptr
;;;1188        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0014b8  f89d0000          LDRB     r0,[sp,#0]
0014bc  2841              CMP      r0,#0x41
0014be  d10b              BNE      |L1.5336|
0014c0  f89d0001          LDRB     r0,[sp,#1]
0014c4  2841              CMP      r0,#0x41
0014c6  d107              BNE      |L1.5336|
0014c8  f89d0002          LDRB     r0,[sp,#2]
0014cc  2841              CMP      r0,#0x41
0014ce  d103              BNE      |L1.5336|
0014d0  f89d0003          LDRB     r0,[sp,#3]
0014d4  2841              CMP      r0,#0x41
0014d6  d009              BEQ      |L1.5356|
                  |L1.5336|
;;;1189        		{        
;;;1190        		if(event_ptr_find)event_ptr_find--;
0014d8  b11c              CBZ      r4,|L1.5346|
0014da  f1a40401          SUB      r4,r4,#1
0014de  b2a4              UXTH     r4,r4
0014e0  e001              B        |L1.5350|
                  |L1.5346|
;;;1191            		else event_ptr_find=63;
0014e2  f04f043f          MOV      r4,#0x3f
                  |L1.5350|
;;;1192            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
0014e6  42bc              CMP      r4,r7
0014e8  d1c4              BNE      |L1.5236|
0014ea  e03f              B        |L1.5484|
                  |L1.5356|
;;;1193        		else goto avar_bat_hndl_lbl1;
;;;1194        		}
;;;1195   
;;;1196        	}
;;;1197        		
;;;1198   	data[0]=LPC_RTC->YEAR;
0014ec  f8b8003c          LDRH     r0,[r8,#0x3c]
0014f0  f88d0000          STRB     r0,[sp,#0]
;;;1199   	data[1]=LPC_RTC->MONTH;
0014f4  f8980038          LDRB     r0,[r8,#0x38]
0014f8  f88d0001          STRB     r0,[sp,#1]
;;;1200   	data[2]=LPC_RTC->DOM;
0014fc  f898002c          LDRB     r0,[r8,#0x2c]
001500  f88d0002          STRB     r0,[sp,#2]
;;;1201   	data[3]=0;
001504  f88da003          STRB     r10,[sp,#3]
;;;1202   	lc640_write_long_ptr(lc640_adr+16,data);
001508  4669              MOV      r1,sp
00150a  f1050010          ADD      r0,r5,#0x10
00150e  f7fffffe          BL       lc640_write_long_ptr
;;;1203   
;;;1204   	data[0]=LPC_RTC->HOUR;
001512  f8980028          LDRB     r0,[r8,#0x28]
001516  f88d0000          STRB     r0,[sp,#0]
;;;1205   	data[1]=LPC_RTC->MIN;
00151a  f8980024          LDRB     r0,[r8,#0x24]
00151e  f88d0001          STRB     r0,[sp,#1]
;;;1206   	data[2]=LPC_RTC->SEC;
001522  f8980020          LDRB     r0,[r8,#0x20]
001526  f88d0002          STRB     r0,[sp,#2]
;;;1207   	data[3]=0;
00152a  f88da003          STRB     r10,[sp,#3]
;;;1208   	lc640_write_long_ptr(lc640_adr+20,data);
00152e  4669              MOV      r1,sp
001530  f1050014          ADD      r0,r5,#0x14
001534  f7fffffe          BL       lc640_write_long_ptr
;;;1209   	
;;;1210   	data[0]='B';
001538  f88d9000          STRB     r9,[sp,#0]
;;;1211   	data[1]='B';
00153c  f88d9001          STRB     r9,[sp,#1]
;;;1212   	data[2]='B';
001540  f88d9002          STRB     r9,[sp,#2]
;;;1213   	data[3]='B';
001544  f88d9003          STRB     r9,[sp,#3]
;;;1214   	lc640_write_long_ptr(lc640_adr+24,data);
001548  4669              MOV      r1,sp
00154a  f1050018          ADD      r0,r5,#0x18
00154e  f7fffffe          BL       lc640_write_long_ptr
;;;1215   	
;;;1216   	data[0]='B';
001552  f88d9000          STRB     r9,[sp,#0]
;;;1217   	data[1]='B';
001556  f88d9001          STRB     r9,[sp,#1]
;;;1218   	data[2]='B';
00155a  f88d9002          STRB     r9,[sp,#2]
;;;1219   	data[3]='B';
00155e  f88d9003          STRB     r9,[sp,#3]
;;;1220   	lc640_write_long_ptr(lc640_adr+28,data);
001562  4669              MOV      r1,sp
001564  f105001c          ADD      r0,r5,#0x1c
001568  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5484|
;;;1221   	
;;;1222   
;;;1223   	
;;;1224   	}
;;;1225   	
;;;1226   avar_bat_hndl_end:
;;;1227   __nop();		
00156c  bf00              NOP      
                  |L1.5486|
;;;1228   }
00156e  e4c4              B        |L1.3834|
;;;1229   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1230   //-----------------------------------------------
;;;1231   void avar_bat_as_hndl(char b, char in)
001570  e92d4ff8          PUSH     {r3-r11,lr}
;;;1232   {
001574  4606              MOV      r6,r0
;;;1233   char data[4];
;;;1234   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1235   
;;;1236   if(in==1)
;;;1237   	{
;;;1238   	bat[b]._av|=2;
001576  48bd              LDR      r0,|L1.6252|
001578  eb060246          ADD      r2,r6,r6,LSL #1
;;;1239       
;;;1240   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1241   	event_ptr++;	
;;;1242   	if(event_ptr>63)event_ptr=0;	
;;;1243   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1244   	
;;;1245        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1246   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1247   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1248   	
;;;1249   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1250   	
;;;1251   	data[0]='B';
;;;1252   	data[1]=b;
;;;1253   	data[2]='S';
;;;1254   	data[3]=0;
;;;1255   	lc640_write_long_ptr(lc640_adr,data);
;;;1256   
;;;1257   	data[0]=0;
;;;1258   	data[1]=0;
;;;1259   	data[2]=0;
;;;1260   	data[3]=0;
;;;1261   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1262   
;;;1263   	data[0]=LPC_RTC->YEAR;
00157c  f8df82f0          LDR      r8,|L1.6256|
001580  eb021206          ADD      r2,r2,r6,LSL #4       ;1238
001584  f04f0a00          MOV      r10,#0                ;1242
001588  f04f0942          MOV      r9,#0x42              ;1251
00158c  f44f6560          MOV      r5,#0xe00             ;1240
001590  f44f6b80          MOV      r11,#0x400            ;1249
001594  eb000082          ADD      r0,r0,r2,LSL #2       ;1238
001598  2901              CMP      r1,#1                 ;1236
00159a  d002              BEQ      |L1.5538|
;;;1264   	data[1]=LPC_RTC->MONTH;
;;;1265   	data[2]=LPC_RTC->DOM;
;;;1266   	data[3]=0;
;;;1267   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1268   
;;;1269   	data[0]=LPC_RTC->HOUR;
;;;1270   	data[1]=LPC_RTC->MIN;
;;;1271   	data[2]=LPC_RTC->SEC;
;;;1272   	data[3]=0;
;;;1273   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1274   	
;;;1275   	data[0]='A';
;;;1276   	data[1]='A';
;;;1277   	data[2]='A';
;;;1278   	data[3]='A';
;;;1279   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1280   	
;;;1281   	data[0]='A';
;;;1282   	data[1]='A';
;;;1283   	data[2]='A';
;;;1284   	data[3]='A';
;;;1285   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1286   	
;;;1287   	data[0]='A';
;;;1288   	data[1]='A';
;;;1289   	data[2]='A';
;;;1290   	data[3]='A';
;;;1291   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1292   	
;;;1293   	data[0]='A';
;;;1294   	data[1]='A';
;;;1295   	data[2]='A';
;;;1296   	data[3]='A';
;;;1297   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1298   
;;;1299   	if(b==0)
;;;1300   		{
;;;1301   		snmp_trap_send("BAT #1 Alarm, assimetry",5,1,2);
;;;1302   		}
;;;1303   	else if(b==1)
;;;1304   		{
;;;1305   		snmp_trap_send("BAT #2 Alarm, assimetry",5,2,2);
;;;1306   		} 
;;;1307   	
;;;1308   	}
;;;1309   
;;;1310   else if(in==0)
00159c  2900              CMP      r1,#0
00159e  d07d              BEQ      |L1.5788|
0015a0  e12f              B        |L1.6146|
                  |L1.5538|
0015a2  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1238
0015a6  f0410102          ORR      r1,r1,#2              ;1238
0015aa  7001              STRB     r1,[r0,#0]            ;1238
0015ac  4628              MOV      r0,r5                 ;1240
0015ae  f7fffffe          BL       lc640_read_int
0015b2  f1000001          ADD      r0,r0,#1              ;1241
0015b6  b284              UXTH     r4,r0                 ;1241
0015b8  2c3f              CMP      r4,#0x3f              ;1242
0015ba  d901              BLS      |L1.5568|
0015bc  f04f0400          MOV      r4,#0                 ;1242
                  |L1.5568|
0015c0  b221              SXTH     r1,r4                 ;1243
0015c2  4628              MOV      r0,r5                 ;1243
0015c4  f7fffffe          BL       lc640_write_int
0015c8  f6406702          MOV      r7,#0xe02             ;1245
0015cc  4638              MOV      r0,r7                 ;1245
0015ce  f7fffffe          BL       lc640_read_int
0015d2  b280              UXTH     r0,r0                 ;1245
0015d4  283f              CMP      r0,#0x3f              ;1246
0015d6  d000              BEQ      |L1.5594|
0015d8  4620              MOV      r0,r4                 ;1246
                  |L1.5594|
0015da  b201              SXTH     r1,r0                 ;1247
0015dc  4638              MOV      r0,r7                 ;1247
0015de  f7fffffe          BL       lc640_write_int
0015e2  4628              MOV      r0,r5                 ;1249
0015e4  f7fffffe          BL       lc640_read_int
0015e8  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1249
0015ec  b284              UXTH     r4,r0                 ;1249
0015ee  f88d9000          STRB     r9,[sp,#0]            ;1251
0015f2  f88d6001          STRB     r6,[sp,#1]            ;1252
0015f6  f04f0053          MOV      r0,#0x53              ;1253
0015fa  f88d0002          STRB     r0,[sp,#2]            ;1253
0015fe  f88da003          STRB     r10,[sp,#3]           ;1254
001602  4669              MOV      r1,sp                 ;1255
001604  4620              MOV      r0,r4                 ;1255
001606  f7fffffe          BL       lc640_write_long_ptr
00160a  f8cda000          STR      r10,[sp,#0]           ;1260
00160e  4669              MOV      r1,sp                 ;1261
001610  1d20              ADDS     r0,r4,#4              ;1261
001612  f7fffffe          BL       lc640_write_long_ptr
001616  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1263
00161a  f88d0000          STRB     r0,[sp,#0]            ;1263
00161e  f8980038          LDRB     r0,[r8,#0x38]         ;1264
001622  f88d0001          STRB     r0,[sp,#1]            ;1264
001626  f898002c          LDRB     r0,[r8,#0x2c]         ;1265
00162a  f88d0002          STRB     r0,[sp,#2]            ;1265
00162e  f88da003          STRB     r10,[sp,#3]           ;1266
001632  4669              MOV      r1,sp                 ;1267
001634  f1040008          ADD      r0,r4,#8              ;1267
001638  f7fffffe          BL       lc640_write_long_ptr
00163c  f8980028          LDRB     r0,[r8,#0x28]         ;1269
001640  f88d0000          STRB     r0,[sp,#0]            ;1269
001644  f8980024          LDRB     r0,[r8,#0x24]         ;1270
001648  f88d0001          STRB     r0,[sp,#1]            ;1270
00164c  f8980020          LDRB     r0,[r8,#0x20]         ;1271
001650  f88d0002          STRB     r0,[sp,#2]            ;1271
001654  f88da003          STRB     r10,[sp,#3]           ;1272
001658  4669              MOV      r1,sp                 ;1273
00165a  f104000c          ADD      r0,r4,#0xc            ;1273
00165e  f7fffffe          BL       lc640_write_long_ptr
001662  f04f0541          MOV      r5,#0x41              ;1275
001666  f88d5000          STRB     r5,[sp,#0]            ;1275
00166a  f88d5001          STRB     r5,[sp,#1]            ;1276
00166e  f88d5002          STRB     r5,[sp,#2]            ;1277
001672  f88d5003          STRB     r5,[sp,#3]            ;1278
001676  4669              MOV      r1,sp                 ;1279
001678  f1040010          ADD      r0,r4,#0x10           ;1279
00167c  f7fffffe          BL       lc640_write_long_ptr
001680  f88d5000          STRB     r5,[sp,#0]            ;1281
001684  f88d5001          STRB     r5,[sp,#1]            ;1282
001688  f88d5002          STRB     r5,[sp,#2]            ;1283
00168c  f88d5003          STRB     r5,[sp,#3]            ;1284
001690  4669              MOV      r1,sp                 ;1285
001692  f1040014          ADD      r0,r4,#0x14           ;1285
001696  f7fffffe          BL       lc640_write_long_ptr
00169a  e000              B        |L1.5790|
                  |L1.5788|
00169c  e02b              B        |L1.5878|
                  |L1.5790|
00169e  f88d5000          STRB     r5,[sp,#0]            ;1287
0016a2  f88d5001          STRB     r5,[sp,#1]            ;1288
0016a6  f88d5002          STRB     r5,[sp,#2]            ;1289
0016aa  f88d5003          STRB     r5,[sp,#3]            ;1290
0016ae  4669              MOV      r1,sp                 ;1291
0016b0  f1040018          ADD      r0,r4,#0x18           ;1291
0016b4  f7fffffe          BL       lc640_write_long_ptr
0016b8  f88d5000          STRB     r5,[sp,#0]            ;1293
0016bc  f88d5001          STRB     r5,[sp,#1]            ;1294
0016c0  f88d5002          STRB     r5,[sp,#2]            ;1295
0016c4  f88d5003          STRB     r5,[sp,#3]            ;1296
0016c8  4669              MOV      r1,sp                 ;1297
0016ca  f104001c          ADD      r0,r4,#0x1c           ;1297
0016ce  f7fffffe          BL       lc640_write_long_ptr
0016d2  b116              CBZ      r6,|L1.5850|
0016d4  2e01              CMP      r6,#1                 ;1303
0016d6  d007              BEQ      |L1.5864|
0016d8  e093              B        |L1.6146|
                  |L1.5850|
0016da  2302              MOVS     r3,#2                 ;1301
0016dc  2201              MOVS     r2,#1                 ;1301
0016de  2105              MOVS     r1,#5                 ;1301
0016e0  a064              ADR      r0,|L1.6260|
0016e2  f7fffffe          BL       snmp_trap_send
0016e6  e08c              B        |L1.6146|
                  |L1.5864|
0016e8  2302              MOVS     r3,#2                 ;1305
0016ea  461a              MOV      r2,r3                 ;1305
0016ec  2105              MOVS     r1,#5                 ;1305
0016ee  a067              ADR      r0,|L1.6284|
0016f0  f7fffffe          BL       snmp_trap_send
0016f4  e085              B        |L1.6146|
                  |L1.5878|
;;;1311   	{
;;;1312   	bat[b]._av&=~(1<<1);
0016f6  f8101f3d          LDRB     r1,[r0,#0x3d]!
0016fa  f0210102          BIC      r1,r1,#2
0016fe  7001              STRB     r1,[r0,#0]
;;;1313   
;;;1314        event_ptr=lc640_read_int(PTR_EVENT_LOG);
001700  4628              MOV      r0,r5
001702  f7fffffe          BL       lc640_read_int
001706  b287              UXTH     r7,r0
;;;1315   	event_ptr_find=event_ptr;
001708  463c              MOV      r4,r7
                  |L1.5898|
;;;1316   	
;;;1317   avar_bat_as_hndl_lbl1: 
;;;1318   
;;;1319   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
00170a  eb0b1044          ADD      r0,r11,r4,LSL #5
00170e  b285              UXTH     r5,r0
;;;1320   
;;;1321        lc640_read_long_ptr(lc640_adr,data);
001710  4669              MOV      r1,sp
001712  4628              MOV      r0,r5
001714  f7fffffe          BL       lc640_read_long_ptr
;;;1322        
;;;1323        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
001718  f89d0000          LDRB     r0,[sp,#0]
00171c  2842              CMP      r0,#0x42
00171e  d107              BNE      |L1.5936|
001720  f89d0001          LDRB     r0,[sp,#1]
001724  42b0              CMP      r0,r6
001726  d103              BNE      |L1.5936|
001728  f89d0002          LDRB     r0,[sp,#2]
00172c  2843              CMP      r0,#0x43
00172e  d009              BEQ      |L1.5956|
                  |L1.5936|
;;;1324        	{        
;;;1325        	if(event_ptr_find)event_ptr_find--;
001730  b11c              CBZ      r4,|L1.5946|
001732  f1a40401          SUB      r4,r4,#1
001736  b2a4              UXTH     r4,r4
001738  e001              B        |L1.5950|
                  |L1.5946|
;;;1326        	else event_ptr_find=63;
00173a  f04f043f          MOV      r4,#0x3f
                  |L1.5950|
;;;1327        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
00173e  42bc              CMP      r4,r7
001740  d1e3              BNE      |L1.5898|
001742  e05e              B        |L1.6146|
                  |L1.5956|
;;;1328        	else goto avar_bat_as_hndl_lbl1;
;;;1329        	}
;;;1330        else 
;;;1331        	{
;;;1332        	lc640_read_long_ptr(lc640_adr+16,data);
001744  4669              MOV      r1,sp
001746  f1050010          ADD      r0,r5,#0x10
00174a  f7fffffe          BL       lc640_read_long_ptr
;;;1333        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00174e  f89d0000          LDRB     r0,[sp,#0]
001752  2841              CMP      r0,#0x41
001754  d10b              BNE      |L1.5998|
001756  f89d0001          LDRB     r0,[sp,#1]
00175a  2841              CMP      r0,#0x41
00175c  d107              BNE      |L1.5998|
00175e  f89d0002          LDRB     r0,[sp,#2]
001762  2841              CMP      r0,#0x41
001764  d103              BNE      |L1.5998|
001766  f89d0003          LDRB     r0,[sp,#3]
00176a  2841              CMP      r0,#0x41
00176c  d009              BEQ      |L1.6018|
                  |L1.5998|
;;;1334        		{        
;;;1335        		if(event_ptr_find)event_ptr_find--;
00176e  b11c              CBZ      r4,|L1.6008|
001770  f1a40401          SUB      r4,r4,#1
001774  b2a4              UXTH     r4,r4
001776  e001              B        |L1.6012|
                  |L1.6008|
;;;1336            		else event_ptr_find=63;
001778  f04f043f          MOV      r4,#0x3f
                  |L1.6012|
;;;1337            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
00177c  42bc              CMP      r4,r7
00177e  d1c4              BNE      |L1.5898|
001780  e03f              B        |L1.6146|
                  |L1.6018|
;;;1338        		else goto avar_bat_as_hndl_lbl1;
;;;1339        		}
;;;1340   
;;;1341        	}
;;;1342        		
;;;1343   	data[0]=LPC_RTC->YEAR;
001782  f8b8003c          LDRH     r0,[r8,#0x3c]
001786  f88d0000          STRB     r0,[sp,#0]
;;;1344   	data[1]=LPC_RTC->MONTH;
00178a  f8980038          LDRB     r0,[r8,#0x38]
00178e  f88d0001          STRB     r0,[sp,#1]
;;;1345   	data[2]=LPC_RTC->DOM;
001792  f898002c          LDRB     r0,[r8,#0x2c]
001796  f88d0002          STRB     r0,[sp,#2]
;;;1346   	data[3]=0;
00179a  f88da003          STRB     r10,[sp,#3]
;;;1347   	lc640_write_long_ptr(lc640_adr+16,data);
00179e  4669              MOV      r1,sp
0017a0  f1050010          ADD      r0,r5,#0x10
0017a4  f7fffffe          BL       lc640_write_long_ptr
;;;1348   
;;;1349   	data[0]=LPC_RTC->HOUR;
0017a8  f8980028          LDRB     r0,[r8,#0x28]
0017ac  f88d0000          STRB     r0,[sp,#0]
;;;1350   	data[1]=LPC_RTC->MIN;
0017b0  f8980024          LDRB     r0,[r8,#0x24]
0017b4  f88d0001          STRB     r0,[sp,#1]
;;;1351   	data[2]=LPC_RTC->SEC;
0017b8  f8980020          LDRB     r0,[r8,#0x20]
0017bc  f88d0002          STRB     r0,[sp,#2]
;;;1352   	data[3]=0;
0017c0  f88da003          STRB     r10,[sp,#3]
;;;1353   	lc640_write_long_ptr(lc640_adr+20,data);
0017c4  4669              MOV      r1,sp
0017c6  f1050014          ADD      r0,r5,#0x14
0017ca  f7fffffe          BL       lc640_write_long_ptr
;;;1354   	
;;;1355   	data[0]='B';
0017ce  f88d9000          STRB     r9,[sp,#0]
;;;1356   	data[1]='B';
0017d2  f88d9001          STRB     r9,[sp,#1]
;;;1357   	data[2]='B';
0017d6  f88d9002          STRB     r9,[sp,#2]
;;;1358   	data[3]='B';
0017da  f88d9003          STRB     r9,[sp,#3]
;;;1359   	lc640_write_long_ptr(lc640_adr+24,data);
0017de  4669              MOV      r1,sp
0017e0  f1050018          ADD      r0,r5,#0x18
0017e4  f7fffffe          BL       lc640_write_long_ptr
;;;1360   	
;;;1361   	data[0]='B';
0017e8  f88d9000          STRB     r9,[sp,#0]
;;;1362   	data[1]='B';
0017ec  f88d9001          STRB     r9,[sp,#1]
;;;1363   	data[2]='B';
0017f0  f88d9002          STRB     r9,[sp,#2]
;;;1364   	data[3]='B';
0017f4  f88d9003          STRB     r9,[sp,#3]
;;;1365   	lc640_write_long_ptr(lc640_adr+28,data);
0017f8  4669              MOV      r1,sp
0017fa  f105001c          ADD      r0,r5,#0x1c
0017fe  f7fffffe          BL       lc640_write_long_ptr
                  |L1.6146|
;;;1366   	
;;;1367   
;;;1368   	
;;;1369   	}
;;;1370   	
;;;1371   avar_bat_as_hndl_end:
;;;1372   __nop();		
001802  bf00              NOP      
                  |L1.6148|
;;;1373   }
001804  e54e              B        |L1.4772|
;;;1374   
                          ENDP

                  ke_zvu_mem_hndl PROC
;;;1375   //-----------------------------------------------
;;;1376   void ke_zvu_mem_hndl(char b,unsigned short in,unsigned short in1)
001806  b5f7              PUSH     {r0-r2,r4-r7,lr}
;;;1377   {
001808  b082              SUB      sp,sp,#8
00180a  4605              MOV      r5,r0
;;;1378   char data[4];
;;;1379   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1380   //unsigned char temp,temp_;
;;;1381   //unsigned int tempUI;
;;;1382   //unsigned long tempUL; 
;;;1383   signed temp_temp;
;;;1384   
;;;1385   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
00180c  eb050045          ADD      r0,r5,r5,LSL #1
001810  4916              LDR      r1,|L1.6252|
001812  eb001005          ADD      r0,r0,r5,LSL #4
001816  eb010180          ADD      r1,r1,r0,LSL #2
00181a  4822              LDR      r0,|L1.6308|
00181c  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
001820  f1000001          ADD      r0,r0,#1
001824  eb010040          ADD      r0,r1,r0,LSL #1
001828  f9b00020          LDRSH    r0,[r0,#0x20]
00182c  9000              STR      r0,[sp,#0]
;;;1386   
;;;1387   event_ptr=lc640_read_int(PTR_EVENT_LOG);
00182e  f44f6660          MOV      r6,#0xe00
001832  4630              MOV      r0,r6
001834  f7fffffe          BL       lc640_read_int
;;;1388   event_ptr++;	
001838  f1000001          ADD      r0,r0,#1
00183c  4604              MOV      r4,r0
;;;1389   if(event_ptr>63)event_ptr=0;	
00183e  2c3f              CMP      r4,#0x3f
001840  d934              BLS      |L1.6316|
001842  e031              B        |L1.6312|
                  |L1.6212|
001844  42415420          DCB      "BAT #1 Alarm, lost",0
001848  23312041
00184c  6c61726d
001850  2c206c6f
001854  737400  
001857  00                DCB      0
                  |L1.6232|
001858  42415420          DCB      "BAT #2 Alarm, lost",0
00185c  23322041
001860  6c61726d
001864  2c206c6f
001868  737400  
00186b  00                DCB      0
                  |L1.6252|
                          DCD      bat
                  |L1.6256|
                          DCD      0x40024000
                  |L1.6260|
001874  42415420          DCB      "BAT #1 Alarm, assimetry",0
001878  23312041
00187c  6c61726d
001880  2c206173
001884  73696d65
001888  74727900
                  |L1.6284|
00188c  42415420          DCB      "BAT #2 Alarm, assimetry",0
001890  23322041
001894  6c61726d
001898  2c206173
00189c  73696d65
0018a0  74727900
                  |L1.6308|
                          DCD      bat_u_old_cnt
                  |L1.6312|
0018a8  f04f0400          MOV      r4,#0
                  |L1.6316|
;;;1390   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
0018ac  b221              SXTH     r1,r4
0018ae  4630              MOV      r0,r6
0018b0  f7fffffe          BL       lc640_write_int
;;;1391   	
;;;1392   event_cnt=lc640_read_int(CNT_EVENT_LOG);
0018b4  f6406702          MOV      r7,#0xe02
0018b8  4638              MOV      r0,r7
0018ba  f7fffffe          BL       lc640_read_int
;;;1393   if(event_cnt!=63)event_cnt=event_ptr;
0018be  283f              CMP      r0,#0x3f
0018c0  d000              BEQ      |L1.6340|
0018c2  4620              MOV      r0,r4
                  |L1.6340|
;;;1394   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
0018c4  b201              SXTH     r1,r0
0018c6  4638              MOV      r0,r7
0018c8  f7fffffe          BL       lc640_write_int
;;;1395   	
;;;1396   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
0018cc  4630              MOV      r0,r6
0018ce  f7fffffe          BL       lc640_read_int
0018d2  f44f6180          MOV      r1,#0x400
0018d6  eb011440          ADD      r4,r1,r0,LSL #5
;;;1397   	
;;;1398   data[0]='B';
0018da  f04f0042          MOV      r0,#0x42
0018de  f88d0004          STRB     r0,[sp,#4]
;;;1399   data[1]=b; 
0018e2  f88d5005          STRB     r5,[sp,#5]
;;;1400   data[2]='K';
0018e6  f04f004b          MOV      r0,#0x4b
0018ea  f88d0006          STRB     r0,[sp,#6]
;;;1401   data[3]='Z';
0018ee  f04f005a          MOV      r0,#0x5a
0018f2  f88d0007          STRB     r0,[sp,#7]
;;;1402   
;;;1403   lc640_write_long_ptr(lc640_adr,data);
0018f6  a901              ADD      r1,sp,#4
0018f8  4620              MOV      r0,r4
0018fa  f7fffffe          BL       lc640_write_long_ptr
;;;1404   
;;;1405   data[0]=*((char*)&in);
0018fe  f89d000c          LDRB     r0,[sp,#0xc]
001902  f88d0004          STRB     r0,[sp,#4]
;;;1406   data[1]=*(((char*)(&in))+1);
001906  f89d000d          LDRB     r0,[sp,#0xd]
00190a  f88d0005          STRB     r0,[sp,#5]
;;;1407   data[2]=*((char*)&temp_temp);
00190e  f89d0000          LDRB     r0,[sp,#0]
001912  f88d0006          STRB     r0,[sp,#6]
;;;1408   data[3]=*(((char*)(&temp_temp))+1);
001916  f89d0001          LDRB     r0,[sp,#1]
00191a  f88d0007          STRB     r0,[sp,#7]
;;;1409   lc640_write_long_ptr(lc640_adr+4,data);
00191e  a901              ADD      r1,sp,#4
001920  1d20              ADDS     r0,r4,#4
001922  f7fffffe          BL       lc640_write_long_ptr
;;;1410   
;;;1411   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
001926  f24020a2          MOV      r0,#0x2a2
00192a  f7fffffe          BL       lc640_read_long
00192e  4dff              LDR      r5,|L1.7468|
001930  6028              STR      r0,[r5,#0]  ; ke_date
;;;1412   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
001932  4629              MOV      r1,r5
001934  f1040008          ADD      r0,r4,#8
001938  f7fffffe          BL       lc640_write_long_ptr
;;;1413   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
00193c  f24020a6          MOV      r0,#0x2a6
001940  f7fffffe          BL       lc640_read_long
001944  6068              STR      r0,[r5,#4]  ; ke_date
;;;1414   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
001946  1d29              ADDS     r1,r5,#4
001948  f104000c          ADD      r0,r4,#0xc
00194c  f7fffffe          BL       lc640_write_long_ptr
;;;1415   
;;;1416   data[0]=LPC_RTC->YEAR;
001950  4df7              LDR      r5,|L1.7472|
001952  8ba8              LDRH     r0,[r5,#0x1c]
001954  f88d0004          STRB     r0,[sp,#4]
;;;1417   data[1]=LPC_RTC->MONTH;
001958  7e28              LDRB     r0,[r5,#0x18]
00195a  f88d0005          STRB     r0,[sp,#5]
;;;1418   data[2]=LPC_RTC->DOM;
00195e  7b28              LDRB     r0,[r5,#0xc]
001960  f88d0006          STRB     r0,[sp,#6]
;;;1419   data[3]=*((char*)&in1);
001964  f89d0010          LDRB     r0,[sp,#0x10]
001968  f88d0007          STRB     r0,[sp,#7]
;;;1420   lc640_write_long_ptr(lc640_adr+16,data);
00196c  a901              ADD      r1,sp,#4
00196e  f1040010          ADD      r0,r4,#0x10
001972  f7fffffe          BL       lc640_write_long_ptr
;;;1421   
;;;1422   data[0]=LPC_RTC->HOUR;
001976  7a28              LDRB     r0,[r5,#8]
001978  f88d0004          STRB     r0,[sp,#4]
;;;1423   data[1]=LPC_RTC->MIN;
00197c  7928              LDRB     r0,[r5,#4]
00197e  f88d0005          STRB     r0,[sp,#5]
;;;1424   data[2]=LPC_RTC->SEC;
001982  7828              LDRB     r0,[r5,#0]
001984  f88d0006          STRB     r0,[sp,#6]
;;;1425   data[3]=*(((char*)(&in1))+1);
001988  f89d0011          LDRB     r0,[sp,#0x11]
00198c  f88d0007          STRB     r0,[sp,#7]
;;;1426   lc640_write_long_ptr(lc640_adr+20,data);
001990  a901              ADD      r1,sp,#4
001992  f1040014          ADD      r0,r4,#0x14
001996  f7fffffe          BL       lc640_write_long_ptr
;;;1427    
;;;1428   }
00199a  b005              ADD      sp,sp,#0x14
00199c  bdf0              POP      {r4-r7,pc}
;;;1429   
                          ENDP

                  vz_mem_hndl PROC
;;;1486   //-----------------------------------------------
;;;1487   void vz_mem_hndl(unsigned short in)
00199e  e92d4ff8          PUSH     {r3-r11,lr}
;;;1488   {
;;;1489   char data[4];
;;;1490   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
0019a2  f04f0600          MOV      r6,#0
0019a6  4634              MOV      r4,r6
;;;1491   //char avar_simbol;
;;;1492   
;;;1493   if(in==1)
;;;1494   	{
;;;1495   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1496   	event_ptr++;	
;;;1497   	if(event_ptr>63)event_ptr=0;	
;;;1498   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1499   	
;;;1500        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1501   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1502   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1503   	
;;;1504   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1505   	
;;;1506   	data[0]='B';
;;;1507   	data[1]=0; 
;;;1508   	data[2]='Z';
;;;1509   	data[3]=0;
;;;1510   	lc640_write_long_ptr(lc640_adr,data);
;;;1511   
;;;1512   	data[0]=0;
;;;1513   	data[1]=0;
;;;1514   	data[2]=0;
;;;1515   	data[3]=0;
;;;1516   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1517   
;;;1518   	data[0]=LPC_RTC->YEAR;
0019a8  f8df8388          LDR      r8,|L1.7476|
0019ac  46a1              MOV      r9,r4                 ;1490
0019ae  f04f0742          MOV      r7,#0x42              ;1506
0019b2  f44f6a80          MOV      r10,#0x400            ;1504
0019b6  2801              CMP      r0,#1                 ;1493
0019b8  d002              BEQ      |L1.6592|
;;;1519   	data[1]=LPC_RTC->MONTH;
;;;1520   	data[2]=LPC_RTC->DOM;
;;;1521   	data[3]=0;
;;;1522   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1523   
;;;1524   	data[0]=LPC_RTC->HOUR;
;;;1525   	data[1]=LPC_RTC->MIN;
;;;1526   	data[2]=LPC_RTC->SEC;
;;;1527   	data[3]=0;
;;;1528   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1529   	
;;;1530   	data[0]='A';
;;;1531   	data[1]='A';
;;;1532   	data[2]='A';
;;;1533   	data[3]='A';
;;;1534   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1535   	
;;;1536   	data[0]='A';
;;;1537   	data[1]='A';
;;;1538   	data[2]='A';
;;;1539   	data[3]='A';
;;;1540   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1541   	
;;;1542   	data[0]='A';
;;;1543   	data[1]='A';
;;;1544   	data[2]='A';
;;;1545   	data[3]='A';
;;;1546   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1547   	
;;;1548   	data[0]='A';
;;;1549   	data[1]='A';
;;;1550   	data[2]='A';
;;;1551   	data[3]='A';
;;;1552   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1553    	
;;;1554   	}
;;;1555   
;;;1556   else if(in==0)
0019ba  2800              CMP      r0,#0
0019bc  d07e              BEQ      |L1.6844|
0019be  e108              B        |L1.7122|
                  |L1.6592|
0019c0  f44f6560          MOV      r5,#0xe00             ;1495
0019c4  4628              MOV      r0,r5                 ;1495
0019c6  f7fffffe          BL       lc640_read_int
0019ca  f1000001          ADD      r0,r0,#1              ;1496
0019ce  4604              MOV      r4,r0                 ;1496
0019d0  2c3f              CMP      r4,#0x3f              ;1497
0019d2  d901              BLS      |L1.6616|
0019d4  f04f0400          MOV      r4,#0                 ;1497
                  |L1.6616|
0019d8  b221              SXTH     r1,r4                 ;1498
0019da  4628              MOV      r0,r5                 ;1498
0019dc  f7fffffe          BL       lc640_write_int
0019e0  f6406602          MOV      r6,#0xe02             ;1500
0019e4  4630              MOV      r0,r6                 ;1500
0019e6  f7fffffe          BL       lc640_read_int
0019ea  283f              CMP      r0,#0x3f              ;1501
0019ec  d000              BEQ      |L1.6640|
0019ee  4620              MOV      r0,r4                 ;1501
                  |L1.6640|
0019f0  b201              SXTH     r1,r0                 ;1502
0019f2  4630              MOV      r0,r6                 ;1502
0019f4  f7fffffe          BL       lc640_write_int
0019f8  4628              MOV      r0,r5                 ;1504
0019fa  f7fffffe          BL       lc640_read_int
0019fe  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1504
001a02  f88d7000          STRB     r7,[sp,#0]            ;1506
001a06  f88d9001          STRB     r9,[sp,#1]            ;1507
001a0a  f04f005a          MOV      r0,#0x5a              ;1508
001a0e  f88d0002          STRB     r0,[sp,#2]            ;1508
001a12  f88d9003          STRB     r9,[sp,#3]            ;1509
001a16  4669              MOV      r1,sp                 ;1510
001a18  4620              MOV      r0,r4                 ;1510
001a1a  f7fffffe          BL       lc640_write_long_ptr
001a1e  f8cd9000          STR      r9,[sp,#0]            ;1515
001a22  4669              MOV      r1,sp                 ;1516
001a24  1d20              ADDS     r0,r4,#4              ;1516
001a26  f7fffffe          BL       lc640_write_long_ptr
001a2a  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1518
001a2e  f88d0000          STRB     r0,[sp,#0]            ;1518
001a32  f8980038          LDRB     r0,[r8,#0x38]         ;1519
001a36  f88d0001          STRB     r0,[sp,#1]            ;1519
001a3a  f898002c          LDRB     r0,[r8,#0x2c]         ;1520
001a3e  f88d0002          STRB     r0,[sp,#2]            ;1520
001a42  f88d9003          STRB     r9,[sp,#3]            ;1521
001a46  4669              MOV      r1,sp                 ;1522
001a48  f1040008          ADD      r0,r4,#8              ;1522
001a4c  f7fffffe          BL       lc640_write_long_ptr
001a50  f8980028          LDRB     r0,[r8,#0x28]         ;1524
001a54  f88d0000          STRB     r0,[sp,#0]            ;1524
001a58  f8980024          LDRB     r0,[r8,#0x24]         ;1525
001a5c  f88d0001          STRB     r0,[sp,#1]            ;1525
001a60  f8980020          LDRB     r0,[r8,#0x20]         ;1526
001a64  f88d0002          STRB     r0,[sp,#2]            ;1526
001a68  f88d9003          STRB     r9,[sp,#3]            ;1527
001a6c  4669              MOV      r1,sp                 ;1528
001a6e  f104000c          ADD      r0,r4,#0xc            ;1528
001a72  f7fffffe          BL       lc640_write_long_ptr
001a76  f04f0541          MOV      r5,#0x41              ;1530
001a7a  f88d5000          STRB     r5,[sp,#0]            ;1530
001a7e  f88d5001          STRB     r5,[sp,#1]            ;1531
001a82  f88d5002          STRB     r5,[sp,#2]            ;1532
001a86  f88d5003          STRB     r5,[sp,#3]            ;1533
001a8a  4669              MOV      r1,sp                 ;1534
001a8c  f1040010          ADD      r0,r4,#0x10           ;1534
001a90  f7fffffe          BL       lc640_write_long_ptr
001a94  f88d5000          STRB     r5,[sp,#0]            ;1536
001a98  f88d5001          STRB     r5,[sp,#1]            ;1537
001a9c  f88d5002          STRB     r5,[sp,#2]            ;1538
001aa0  f88d5003          STRB     r5,[sp,#3]            ;1539
001aa4  4669              MOV      r1,sp                 ;1540
001aa6  f1040014          ADD      r0,r4,#0x14           ;1540
001aaa  f7fffffe          BL       lc640_write_long_ptr
001aae  f88d5000          STRB     r5,[sp,#0]            ;1542
001ab2  f88d5001          STRB     r5,[sp,#1]            ;1543
001ab6  f88d5002          STRB     r5,[sp,#2]            ;1544
001aba  e000              B        |L1.6846|
                  |L1.6844|
001abc  e014              B        |L1.6888|
                  |L1.6846|
001abe  f88d5003          STRB     r5,[sp,#3]            ;1545
001ac2  4669              MOV      r1,sp                 ;1546
001ac4  f1040018          ADD      r0,r4,#0x18           ;1546
001ac8  f7fffffe          BL       lc640_write_long_ptr
001acc  f88d5000          STRB     r5,[sp,#0]            ;1548
001ad0  f88d5001          STRB     r5,[sp,#1]            ;1549
001ad4  f88d5002          STRB     r5,[sp,#2]            ;1550
001ad8  f88d5003          STRB     r5,[sp,#3]            ;1551
001adc  4669              MOV      r1,sp                 ;1552
001ade  f104001c          ADD      r0,r4,#0x1c           ;1552
001ae2  f7fffffe          BL       lc640_write_long_ptr
001ae6  e074              B        |L1.7122|
                  |L1.6888|
;;;1557   	{      
;;;1558        
;;;1559   vz_mem_hndl_lbl1: 
;;;1560   
;;;1561   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001ae8  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1562   
;;;1563        lc640_read_long_ptr(lc640_adr,data);
001aec  4669              MOV      r1,sp
001aee  4628              MOV      r0,r5
001af0  f7fffffe          BL       lc640_read_long_ptr
;;;1564        
;;;1565        if(!((data[0]=='B')&&(data[2]=='Z')))
001af4  f89d0000          LDRB     r0,[sp,#0]
001af8  2842              CMP      r0,#0x42
001afa  d103              BNE      |L1.6916|
001afc  f89d0002          LDRB     r0,[sp,#2]
001b00  285a              CMP      r0,#0x5a
001b02  d008              BEQ      |L1.6934|
                  |L1.6916|
;;;1566        	{        
;;;1567        	if(event_ptr_find)event_ptr_find--;
001b04  b114              CBZ      r4,|L1.6924|
001b06  f1a40401          SUB      r4,r4,#1
001b0a  e001              B        |L1.6928|
                  |L1.6924|
;;;1568        	else event_ptr_find=63;
001b0c  f04f043f          MOV      r4,#0x3f
                  |L1.6928|
;;;1569        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001b10  42b4              CMP      r4,r6
001b12  d1e9              BNE      |L1.6888|
001b14  e05d              B        |L1.7122|
                  |L1.6934|
;;;1570        	else goto vz_mem_hndl_lbl1;
;;;1571        	}
;;;1572        else 
;;;1573        	{
;;;1574        	lc640_read_long_ptr(lc640_adr+16,data);
001b16  4669              MOV      r1,sp
001b18  f1050010          ADD      r0,r5,#0x10
001b1c  f7fffffe          BL       lc640_read_long_ptr
;;;1575        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001b20  f89d0000          LDRB     r0,[sp,#0]
001b24  2841              CMP      r0,#0x41
001b26  d10b              BNE      |L1.6976|
001b28  f89d0001          LDRB     r0,[sp,#1]
001b2c  2841              CMP      r0,#0x41
001b2e  d107              BNE      |L1.6976|
001b30  f89d0002          LDRB     r0,[sp,#2]
001b34  2841              CMP      r0,#0x41
001b36  d103              BNE      |L1.6976|
001b38  f89d0003          LDRB     r0,[sp,#3]
001b3c  2841              CMP      r0,#0x41
001b3e  d008              BEQ      |L1.6994|
                  |L1.6976|
;;;1576        		{        
;;;1577        		if(event_ptr_find)event_ptr_find--;
001b40  b114              CBZ      r4,|L1.6984|
001b42  f1a40401          SUB      r4,r4,#1
001b46  e001              B        |L1.6988|
                  |L1.6984|
;;;1578            		else event_ptr_find=63;
001b48  f04f043f          MOV      r4,#0x3f
                  |L1.6988|
;;;1579            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001b4c  42b4              CMP      r4,r6
001b4e  d1cb              BNE      |L1.6888|
001b50  e03f              B        |L1.7122|
                  |L1.6994|
;;;1580        		else goto vz_mem_hndl_lbl1;
;;;1581        		}
;;;1582   
;;;1583        	}	
;;;1584   
;;;1585   
;;;1586   	
;;;1587   	data[0]=LPC_RTC->YEAR;
001b52  f8b8003c          LDRH     r0,[r8,#0x3c]
001b56  f88d0000          STRB     r0,[sp,#0]
;;;1588   	data[1]=LPC_RTC->MONTH;
001b5a  f8980038          LDRB     r0,[r8,#0x38]
001b5e  f88d0001          STRB     r0,[sp,#1]
;;;1589   	data[2]=LPC_RTC->DOM;
001b62  f898002c          LDRB     r0,[r8,#0x2c]
001b66  f88d0002          STRB     r0,[sp,#2]
;;;1590   	data[3]=0;
001b6a  f88d9003          STRB     r9,[sp,#3]
;;;1591   	lc640_write_long_ptr(lc640_adr+16,data);
001b6e  4669              MOV      r1,sp
001b70  f1050010          ADD      r0,r5,#0x10
001b74  f7fffffe          BL       lc640_write_long_ptr
;;;1592   
;;;1593   	data[0]=LPC_RTC->HOUR;
001b78  f8980028          LDRB     r0,[r8,#0x28]
001b7c  f88d0000          STRB     r0,[sp,#0]
;;;1594   	data[1]=LPC_RTC->MIN;
001b80  f8980024          LDRB     r0,[r8,#0x24]
001b84  f88d0001          STRB     r0,[sp,#1]
;;;1595   	data[2]=LPC_RTC->SEC;
001b88  f8980020          LDRB     r0,[r8,#0x20]
001b8c  f88d0002          STRB     r0,[sp,#2]
;;;1596   	data[3]=0;
001b90  f88d9003          STRB     r9,[sp,#3]
;;;1597   	lc640_write_long_ptr(lc640_adr+20,data);
001b94  4669              MOV      r1,sp
001b96  f1050014          ADD      r0,r5,#0x14
001b9a  f7fffffe          BL       lc640_write_long_ptr
;;;1598   	
;;;1599   	data[0]='B';
001b9e  f88d7000          STRB     r7,[sp,#0]
;;;1600   	data[1]='B';
001ba2  f88d7001          STRB     r7,[sp,#1]
;;;1601   	data[2]='B';
001ba6  f88d7002          STRB     r7,[sp,#2]
;;;1602   	data[3]='B';
001baa  f88d7003          STRB     r7,[sp,#3]
;;;1603   	lc640_write_long_ptr(lc640_adr+24,data);
001bae  4669              MOV      r1,sp
001bb0  f1050018          ADD      r0,r5,#0x18
001bb4  f7fffffe          BL       lc640_write_long_ptr
;;;1604   	
;;;1605   	data[0]='B';
001bb8  f88d7000          STRB     r7,[sp,#0]
;;;1606   	data[1]='B';
001bbc  f88d7001          STRB     r7,[sp,#1]
;;;1607   	data[2]='B';
001bc0  f88d7002          STRB     r7,[sp,#2]
;;;1608   	data[3]='B';
001bc4  f88d7003          STRB     r7,[sp,#3]
;;;1609   	lc640_write_long_ptr(lc640_adr+28,data);
001bc8  4669              MOV      r1,sp
001bca  f105001c          ADD      r0,r5,#0x1c
001bce  f7fffffe          BL       lc640_write_long_ptr
                  |L1.7122|
;;;1610   	
;;;1611   	}
;;;1612   
;;;1613   vz_mem_hndl_end:
;;;1614   __nop(); 
001bd2  bf00              NOP      
                  |L1.7124|
;;;1615   
;;;1616   }
001bd4  e4cb              B        |L1.5486|
;;;1617   
                          ENDP

                  speedz_mem_hndl PROC
;;;1618   //-----------------------------------------------
;;;1619   void speedz_mem_hndl(unsigned short in)	 //    (1-, 5- , 0- , 10- )
001bd6  e92d4ff8          PUSH     {r3-r11,lr}
;;;1620   {
001bda  4605              MOV      r5,r0
;;;1621   char data[4];
;;;1622   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001bdc  f04f0600          MOV      r6,#0
001be0  4634              MOV      r4,r6
;;;1623   //char avar_simbol;
;;;1624   
;;;1625   if((in==1)||(in==5)) //  
;;;1626   	{
;;;1627   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1628   	event_ptr++;	
;;;1629   	if(event_ptr>63)event_ptr=0;	
;;;1630   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1631   	
;;;1632       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1633   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1634   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1635   	
;;;1636   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1637   	
;;;1638   	data[0]='s';
;;;1639   	data[1]=0;
;;;1640   	if(in==5)data[1]='a'; 
;;;1641   	data[2]='Z';
;;;1642   	data[3]=0;
;;;1643   	lc640_write_long_ptr(lc640_adr,data);
;;;1644   
;;;1645   	data[0]=0;
;;;1646   	data[1]=0;
;;;1647   	data[2]=0;
;;;1648   	data[3]=0;
;;;1649   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1650   
;;;1651   	data[0]=LPC_RTC->YEAR;
001be2  f8df8150          LDR      r8,|L1.7476|
001be6  46a1              MOV      r9,r4                 ;1622
001be8  f44f6a80          MOV      r10,#0x400            ;1636
001bec  2d01              CMP      r5,#1                 ;1625
001bee  d012              BEQ      |L1.7190|
001bf0  2d05              CMP      r5,#5                 ;1625
001bf2  d010              BEQ      |L1.7190|
;;;1652   	data[1]=LPC_RTC->MONTH;
;;;1653   	data[2]=LPC_RTC->DOM;
;;;1654   	data[3]=0;
;;;1655   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1656   
;;;1657   	data[0]=LPC_RTC->HOUR;
;;;1658   	data[1]=LPC_RTC->MIN;
;;;1659   	data[2]=LPC_RTC->SEC;
;;;1660   	data[3]=0;
;;;1661   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1662   	
;;;1663   	data[0]='A';
;;;1664   	data[1]='A';
;;;1665   	data[2]='A';
;;;1666   	data[3]='A';
;;;1667   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1668   	
;;;1669   	data[0]='A';
;;;1670   	data[1]='A';
;;;1671   	data[2]='A';
;;;1672   	data[3]='A';
;;;1673   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1674   	
;;;1675   	data[0]='A';
;;;1676   	data[1]='A';
;;;1677   	data[2]='A';
;;;1678   	data[3]='A';
;;;1679   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1680   	
;;;1681   	data[0]='A';
;;;1682   	data[1]='A';
;;;1683   	data[2]='A';
;;;1684   	data[3]='A';
;;;1685   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1686    	
;;;1687   	}
;;;1688   
;;;1689   else if(in==0)	// 
001bf4  2d00              CMP      r5,#0
001bf6  d07d              BEQ      |L1.7412|
;;;1690   	{      
;;;1691   	char i;     
;;;1692   	event_ptr_find=0;
;;;1693   	for (i=0;i<63;i++)
;;;1694   		{
;;;1695   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1696   
;;;1697        	lc640_read_long_ptr(lc640_adr,data);
;;;1698        
;;;1699        	if(!((data[0]=='s')&&(data[2]=='Z')))
;;;1700        		{        
;;;1701        		if(event_ptr_find)event_ptr_find--;
;;;1702        		else event_ptr_find=63;
;;;1703        		if(event_ptr_find==event_ptr)
;;;1704   				{
;;;1705   				lc640_adr=0;
;;;1706   				break;
;;;1707   				}
;;;1708        		else continue;
;;;1709        		}
;;;1710        	else 
;;;1711        		{
;;;1712        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1713        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1714        			{        
;;;1715        			if(event_ptr_find)event_ptr_find--;
;;;1716            		else event_ptr_find=63;
;;;1717            		if(event_ptr_find==event_ptr)
;;;1718   					{
;;;1719   					lc640_adr=0;
;;;1720   					break;
;;;1721   					}
;;;1722        			else continue;
;;;1723        			}
;;;1724        		}	
;;;1725   		}
;;;1726   	if(lc640_adr!=0)
;;;1727   		{
;;;1728   		data[0]=LPC_RTC->YEAR;
;;;1729   		data[1]=LPC_RTC->MONTH;
;;;1730   		data[2]=LPC_RTC->DOM;
;;;1731   		data[3]=0;
;;;1732   		lc640_write_long_ptr(lc640_adr+16,data);
;;;1733   	
;;;1734   		data[0]=LPC_RTC->HOUR;
;;;1735   		data[1]=LPC_RTC->MIN;
;;;1736   		data[2]=LPC_RTC->SEC;
;;;1737   		data[3]=0;
;;;1738   		lc640_write_long_ptr(lc640_adr+20,data);
;;;1739   		
;;;1740   		data[0]='C';
;;;1741   		data[1]='C';
;;;1742   		data[2]='C';
;;;1743   		data[3]='C';
;;;1744   		lc640_write_long_ptr(lc640_adr+24,data);
;;;1745   		
;;;1746   		data[0]='C';
;;;1747   		data[1]='C';
;;;1748   		data[2]='C';
;;;1749   		data[3]='C';
;;;1750   		lc640_write_long_ptr(lc640_adr+28,data);
;;;1751   		}
;;;1752   	}
;;;1753   else if(in==10) 	//  
001bf8  2d0a              CMP      r5,#0xa
001bfa  d17c              BNE      |L1.7414|
;;;1754   	{      
;;;1755   	char i;     
;;;1756   
;;;1757   	event_ptr_find=0;
;;;1758   	for (i=0;i<63;i++)
001bfc  f04f0700          MOV      r7,#0
                  |L1.7168|
;;;1759   		{
;;;1760   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
001c00  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1761   
;;;1762        	lc640_read_long_ptr(lc640_adr,data);
001c04  4669              MOV      r1,sp
001c06  4628              MOV      r0,r5
001c08  f7fffffe          BL       lc640_read_long_ptr
;;;1763        
;;;1764        	if(!((data[0]=='s')&&(data[2]=='Z')))
001c0c  f89d0000          LDRB     r0,[sp,#0]
001c10  2873              CMP      r0,#0x73
001c12  d171              BNE      |L1.7416|
001c14  e12a              B        |L1.7788|
                  |L1.7190|
001c16  f44f6660          MOV      r6,#0xe00             ;1627
001c1a  4630              MOV      r0,r6                 ;1627
001c1c  f7fffffe          BL       lc640_read_int
001c20  f1000001          ADD      r0,r0,#1              ;1628
001c24  4604              MOV      r4,r0                 ;1628
001c26  2c3f              CMP      r4,#0x3f              ;1629
001c28  d901              BLS      |L1.7214|
001c2a  f04f0400          MOV      r4,#0                 ;1629
                  |L1.7214|
001c2e  b221              SXTH     r1,r4                 ;1630
001c30  4630              MOV      r0,r6                 ;1630
001c32  f7fffffe          BL       lc640_write_int
001c36  f6406702          MOV      r7,#0xe02             ;1632
001c3a  4638              MOV      r0,r7                 ;1632
001c3c  f7fffffe          BL       lc640_read_int
001c40  283f              CMP      r0,#0x3f              ;1633
001c42  d000              BEQ      |L1.7238|
001c44  4620              MOV      r0,r4                 ;1633
                  |L1.7238|
001c46  b201              SXTH     r1,r0                 ;1634
001c48  4638              MOV      r0,r7                 ;1634
001c4a  f7fffffe          BL       lc640_write_int
001c4e  4630              MOV      r0,r6                 ;1636
001c50  f7fffffe          BL       lc640_read_int
001c54  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1636
001c58  f04f0073          MOV      r0,#0x73              ;1638
001c5c  f88d0000          STRB     r0,[sp,#0]            ;1638
001c60  f88d9001          STRB     r9,[sp,#1]            ;1639
001c64  2d05              CMP      r5,#5                 ;1640
001c66  d103              BNE      |L1.7280|
001c68  f04f0061          MOV      r0,#0x61              ;1640
001c6c  f88d0001          STRB     r0,[sp,#1]            ;1640
                  |L1.7280|
001c70  f04f005a          MOV      r0,#0x5a              ;1641
001c74  f88d0002          STRB     r0,[sp,#2]            ;1641
001c78  f88d9003          STRB     r9,[sp,#3]            ;1642
001c7c  4669              MOV      r1,sp                 ;1643
001c7e  4620              MOV      r0,r4                 ;1643
001c80  f7fffffe          BL       lc640_write_long_ptr
001c84  f8cd9000          STR      r9,[sp,#0]            ;1648
001c88  4669              MOV      r1,sp                 ;1649
001c8a  1d20              ADDS     r0,r4,#4              ;1649
001c8c  f7fffffe          BL       lc640_write_long_ptr
001c90  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1651
001c94  f88d0000          STRB     r0,[sp,#0]            ;1651
001c98  f8980038          LDRB     r0,[r8,#0x38]         ;1652
001c9c  f88d0001          STRB     r0,[sp,#1]            ;1652
001ca0  f898002c          LDRB     r0,[r8,#0x2c]         ;1653
001ca4  f88d0002          STRB     r0,[sp,#2]            ;1653
001ca8  f88d9003          STRB     r9,[sp,#3]            ;1654
001cac  4669              MOV      r1,sp                 ;1655
001cae  f1040008          ADD      r0,r4,#8              ;1655
001cb2  f7fffffe          BL       lc640_write_long_ptr
001cb6  f8980028          LDRB     r0,[r8,#0x28]         ;1657
001cba  f88d0000          STRB     r0,[sp,#0]            ;1657
001cbe  f8980024          LDRB     r0,[r8,#0x24]         ;1658
001cc2  f88d0001          STRB     r0,[sp,#1]            ;1658
001cc6  f8980020          LDRB     r0,[r8,#0x20]         ;1659
001cca  f88d0002          STRB     r0,[sp,#2]            ;1659
001cce  f88d9003          STRB     r9,[sp,#3]            ;1660
001cd2  4669              MOV      r1,sp                 ;1661
001cd4  f104000c          ADD      r0,r4,#0xc            ;1661
001cd8  f7fffffe          BL       lc640_write_long_ptr
001cdc  f04f0541          MOV      r5,#0x41              ;1663
001ce0  f88d5000          STRB     r5,[sp,#0]            ;1663
001ce4  f88d5001          STRB     r5,[sp,#1]            ;1664
001ce8  f88d5002          STRB     r5,[sp,#2]            ;1665
001cec  f88d5003          STRB     r5,[sp,#3]            ;1666
001cf0  4669              MOV      r1,sp                 ;1667
001cf2  e002              B        |L1.7418|
                  |L1.7412|
001cf4  e035              B        |L1.7522|
                  |L1.7414|
001cf6  e033              B        |L1.7520|
                  |L1.7416|
001cf8  e0bc              B        |L1.7796|
                  |L1.7418|
001cfa  f1040010          ADD      r0,r4,#0x10           ;1667
001cfe  f7fffffe          BL       lc640_write_long_ptr
001d02  f88d5000          STRB     r5,[sp,#0]            ;1669
001d06  f88d5001          STRB     r5,[sp,#1]            ;1670
001d0a  f88d5002          STRB     r5,[sp,#2]            ;1671
001d0e  f88d5003          STRB     r5,[sp,#3]            ;1672
001d12  4669              MOV      r1,sp                 ;1673
001d14  f1040014          ADD      r0,r4,#0x14           ;1673
001d18  f7fffffe          BL       lc640_write_long_ptr
001d1c  f88d5000          STRB     r5,[sp,#0]            ;1675
001d20  f88d5001          STRB     r5,[sp,#1]            ;1676
001d24  f88d5002          STRB     r5,[sp,#2]            ;1677
001d28  e006              B        |L1.7480|
001d2a  0000              DCW      0x0000
                  |L1.7468|
                          DCD      ke_date
                  |L1.7472|
                          DCD      0x40024020
                  |L1.7476|
                          DCD      0x40024000
                  |L1.7480|
001d38  f88d5003          STRB     r5,[sp,#3]            ;1678
001d3c  4669              MOV      r1,sp                 ;1679
001d3e  f1040018          ADD      r0,r4,#0x18           ;1679
001d42  f7fffffe          BL       lc640_write_long_ptr
001d46  f88d5000          STRB     r5,[sp,#0]            ;1681
001d4a  f88d5001          STRB     r5,[sp,#1]            ;1682
001d4e  f88d5002          STRB     r5,[sp,#2]            ;1683
001d52  f88d5003          STRB     r5,[sp,#3]            ;1684
001d56  4669              MOV      r1,sp                 ;1685
001d58  f104001c          ADD      r0,r4,#0x1c           ;1685
001d5c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.7520|
;;;1765        		{        
;;;1766        		if(event_ptr_find)event_ptr_find--;
;;;1767        		else event_ptr_find=63;
;;;1768        		if(event_ptr_find==event_ptr)
;;;1769   				{
;;;1770   				lc640_adr=0;
;;;1771   				break;
;;;1772   				}
;;;1773        		else continue;
;;;1774        		}
;;;1775        	else 
;;;1776        		{
;;;1777        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1778        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1779        			{        
;;;1780        			if(event_ptr_find)event_ptr_find--;
;;;1781            		else event_ptr_find=63;
;;;1782            		if(event_ptr_find==event_ptr)
;;;1783   					{
;;;1784   					lc640_adr=0;
;;;1785   					break;
;;;1786   					}
;;;1787        			else continue;
;;;1788        			}
;;;1789        		}	
;;;1790   		}
;;;1791   	if(lc640_adr!=0)
;;;1792   		{
;;;1793   		data[0]=LPC_RTC->YEAR;
;;;1794   		data[1]=LPC_RTC->MONTH;
;;;1795   		data[2]=LPC_RTC->DOM;
;;;1796   		data[3]=0;
;;;1797   		lc640_write_long_ptr(lc640_adr+16,data);
;;;1798   	
;;;1799   		data[0]=LPC_RTC->HOUR;
;;;1800   		data[1]=LPC_RTC->MIN;
;;;1801   		data[2]=LPC_RTC->SEC;
;;;1802   		data[3]=0;
;;;1803   		lc640_write_long_ptr(lc640_adr+20,data);
;;;1804   		
;;;1805   		data[0]='B';
;;;1806   		data[1]='B';
;;;1807   		data[2]='B';
;;;1808   		data[3]='B';
;;;1809   		lc640_write_long_ptr(lc640_adr+24,data);
;;;1810   		
;;;1811   		data[0]='B';
;;;1812   		data[1]='B';
;;;1813   		data[2]='B';
;;;1814   		data[3]='B';
;;;1815   		lc640_write_long_ptr(lc640_adr+28,data);
;;;1816   		}
;;;1817   	}
;;;1818   }
001d60  e405              B        |L1.5486|
                  |L1.7522|
001d62  f04f0700          MOV      r7,#0                 ;1693
                  |L1.7526|
001d66  eb0a1544          ADD      r5,r10,r4,LSL #5      ;1695
001d6a  4669              MOV      r1,sp                 ;1697
001d6c  4628              MOV      r0,r5                 ;1697
001d6e  f7fffffe          BL       lc640_read_long_ptr
001d72  f89d0000          LDRB     r0,[sp,#0]            ;1699
001d76  2873              CMP      r0,#0x73              ;1699
001d78  d103              BNE      |L1.7554|
001d7a  f89d0002          LDRB     r0,[sp,#2]            ;1699
001d7e  285a              CMP      r0,#0x5a              ;1699
001d80  d00a              BEQ      |L1.7576|
                  |L1.7554|
001d82  b114              CBZ      r4,|L1.7562|
001d84  f1a40401          SUB      r4,r4,#1              ;1701
001d88  e001              B        |L1.7566|
                  |L1.7562|
001d8a  f04f043f          MOV      r4,#0x3f              ;1702
                  |L1.7566|
001d8e  42b4              CMP      r4,r6                 ;1703
001d90  d122              BNE      |L1.7640|
001d92  f04f0500          MOV      r5,#0                 ;1705
001d96  e024              B        |L1.7650|
                  |L1.7576|
001d98  4669              MOV      r1,sp                 ;1712
001d9a  f1050010          ADD      r0,r5,#0x10           ;1712
001d9e  f7fffffe          BL       lc640_read_long_ptr
001da2  f89d0000          LDRB     r0,[sp,#0]            ;1713
001da6  2841              CMP      r0,#0x41              ;1713
001da8  d10b              BNE      |L1.7618|
001daa  f89d0001          LDRB     r0,[sp,#1]            ;1713
001dae  2841              CMP      r0,#0x41              ;1713
001db0  d107              BNE      |L1.7618|
001db2  f89d0002          LDRB     r0,[sp,#2]            ;1713
001db6  2841              CMP      r0,#0x41              ;1713
001db8  d103              BNE      |L1.7618|
001dba  f89d0003          LDRB     r0,[sp,#3]            ;1713
001dbe  2841              CMP      r0,#0x41              ;1713
001dc0  d00a              BEQ      |L1.7640|
                  |L1.7618|
001dc2  b114              CBZ      r4,|L1.7626|
001dc4  f1a40401          SUB      r4,r4,#1              ;1715
001dc8  e001              B        |L1.7630|
                  |L1.7626|
001dca  f04f043f          MOV      r4,#0x3f              ;1716
                  |L1.7630|
001dce  42b4              CMP      r4,r6                 ;1717
001dd0  d102              BNE      |L1.7640|
001dd2  f04f0500          MOV      r5,#0                 ;1719
001dd6  e004              B        |L1.7650|
                  |L1.7640|
001dd8  f1070701          ADD      r7,r7,#1              ;1693
001ddc  b2ff              UXTB     r7,r7                 ;1693
001dde  2f3f              CMP      r7,#0x3f              ;1693
001de0  d3c1              BCC      |L1.7526|
                  |L1.7650|
001de2  2d00              CMP      r5,#0                 ;1726
001de4  d0bc              BEQ      |L1.7520|
001de6  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1728
001dea  f88d0000          STRB     r0,[sp,#0]            ;1728
001dee  f8980038          LDRB     r0,[r8,#0x38]         ;1729
001df2  f88d0001          STRB     r0,[sp,#1]            ;1729
001df6  f898002c          LDRB     r0,[r8,#0x2c]         ;1730
001dfa  f88d0002          STRB     r0,[sp,#2]            ;1730
001dfe  f88d9003          STRB     r9,[sp,#3]            ;1731
001e02  4669              MOV      r1,sp                 ;1732
001e04  f1050010          ADD      r0,r5,#0x10           ;1732
001e08  f7fffffe          BL       lc640_write_long_ptr
001e0c  f8980028          LDRB     r0,[r8,#0x28]         ;1734
001e10  f88d0000          STRB     r0,[sp,#0]            ;1734
001e14  f8980024          LDRB     r0,[r8,#0x24]         ;1735
001e18  f88d0001          STRB     r0,[sp,#1]            ;1735
001e1c  f8980020          LDRB     r0,[r8,#0x20]         ;1736
001e20  f88d0002          STRB     r0,[sp,#2]            ;1736
001e24  f88d9003          STRB     r9,[sp,#3]            ;1737
001e28  4669              MOV      r1,sp                 ;1738
001e2a  f1050014          ADD      r0,r5,#0x14           ;1738
001e2e  f7fffffe          BL       lc640_write_long_ptr
001e32  f04f0443          MOV      r4,#0x43              ;1740
001e36  f88d4000          STRB     r4,[sp,#0]            ;1740
001e3a  f88d4001          STRB     r4,[sp,#1]            ;1741
001e3e  f88d4002          STRB     r4,[sp,#2]            ;1742
001e42  f88d4003          STRB     r4,[sp,#3]            ;1743
001e46  4669              MOV      r1,sp                 ;1744
001e48  f1050018          ADD      r0,r5,#0x18           ;1744
001e4c  f7fffffe          BL       lc640_write_long_ptr
001e50  f88d4000          STRB     r4,[sp,#0]            ;1746
001e54  f88d4001          STRB     r4,[sp,#1]            ;1747
001e58  f88d4002          STRB     r4,[sp,#2]            ;1748
001e5c  f88d4003          STRB     r4,[sp,#3]            ;1749
001e60  4669              MOV      r1,sp                 ;1750
001e62  f105001c          ADD      r0,r5,#0x1c           ;1750
001e66  f7fffffe          BL       lc640_write_long_ptr
                  |L1.7786|
001e6a  e4cb              B        |L1.6148|
                  |L1.7788|
001e6c  f89d0002          LDRB     r0,[sp,#2]            ;1764
001e70  285a              CMP      r0,#0x5a              ;1764
001e72  d00a              BEQ      |L1.7818|
                  |L1.7796|
001e74  b114              CBZ      r4,|L1.7804|
001e76  f1a40401          SUB      r4,r4,#1              ;1766
001e7a  e001              B        |L1.7808|
                  |L1.7804|
001e7c  f04f043f          MOV      r4,#0x3f              ;1767
                  |L1.7808|
001e80  42b4              CMP      r4,r6                 ;1768
001e82  d122              BNE      |L1.7882|
001e84  f04f0500          MOV      r5,#0                 ;1770
001e88  e025              B        |L1.7894|
                  |L1.7818|
001e8a  4669              MOV      r1,sp                 ;1777
001e8c  f1050010          ADD      r0,r5,#0x10           ;1777
001e90  f7fffffe          BL       lc640_read_long_ptr
001e94  f89d0000          LDRB     r0,[sp,#0]            ;1778
001e98  2841              CMP      r0,#0x41              ;1778
001e9a  d10b              BNE      |L1.7860|
001e9c  f89d0001          LDRB     r0,[sp,#1]            ;1778
001ea0  2841              CMP      r0,#0x41              ;1778
001ea2  d107              BNE      |L1.7860|
001ea4  f89d0002          LDRB     r0,[sp,#2]            ;1778
001ea8  2841              CMP      r0,#0x41              ;1778
001eaa  d103              BNE      |L1.7860|
001eac  f89d0003          LDRB     r0,[sp,#3]            ;1778
001eb0  2841              CMP      r0,#0x41              ;1778
001eb2  d00a              BEQ      |L1.7882|
                  |L1.7860|
001eb4  b114              CBZ      r4,|L1.7868|
001eb6  f1a40401          SUB      r4,r4,#1              ;1780
001eba  e001              B        |L1.7872|
                  |L1.7868|
001ebc  f04f043f          MOV      r4,#0x3f              ;1781
                  |L1.7872|
001ec0  42b4              CMP      r4,r6                 ;1782
001ec2  d102              BNE      |L1.7882|
001ec4  f04f0500          MOV      r5,#0                 ;1784
001ec8  e005              B        |L1.7894|
                  |L1.7882|
001eca  f1070701          ADD      r7,r7,#1              ;1758
001ece  b2ff              UXTB     r7,r7                 ;1758
001ed0  2f3f              CMP      r7,#0x3f              ;1758
001ed2  f4ffae95          BCC      |L1.7168|
                  |L1.7894|
001ed6  2d00              CMP      r5,#0                 ;1791
001ed8  d0c7              BEQ      |L1.7786|
001eda  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1793
001ede  f88d0000          STRB     r0,[sp,#0]            ;1793
001ee2  f8980038          LDRB     r0,[r8,#0x38]         ;1794
001ee6  f88d0001          STRB     r0,[sp,#1]            ;1794
001eea  f898002c          LDRB     r0,[r8,#0x2c]         ;1795
001eee  f88d0002          STRB     r0,[sp,#2]            ;1795
001ef2  f88d9003          STRB     r9,[sp,#3]            ;1796
001ef6  4669              MOV      r1,sp                 ;1797
001ef8  f1050010          ADD      r0,r5,#0x10           ;1797
001efc  f7fffffe          BL       lc640_write_long_ptr
001f00  f8980028          LDRB     r0,[r8,#0x28]         ;1799
001f04  f88d0000          STRB     r0,[sp,#0]            ;1799
001f08  f8980024          LDRB     r0,[r8,#0x24]         ;1800
001f0c  f88d0001          STRB     r0,[sp,#1]            ;1800
001f10  f8980020          LDRB     r0,[r8,#0x20]         ;1801
001f14  f88d0002          STRB     r0,[sp,#2]            ;1801
001f18  f88d9003          STRB     r9,[sp,#3]            ;1802
001f1c  4669              MOV      r1,sp                 ;1803
001f1e  f1050014          ADD      r0,r5,#0x14           ;1803
001f22  f7fffffe          BL       lc640_write_long_ptr
001f26  f04f0442          MOV      r4,#0x42              ;1805
001f2a  f88d4000          STRB     r4,[sp,#0]            ;1805
001f2e  f88d4001          STRB     r4,[sp,#1]            ;1806
001f32  f88d4002          STRB     r4,[sp,#2]            ;1807
001f36  f88d4003          STRB     r4,[sp,#3]            ;1808
001f3a  4669              MOV      r1,sp                 ;1809
001f3c  f1050018          ADD      r0,r5,#0x18           ;1809
001f40  f7fffffe          BL       lc640_write_long_ptr
001f44  f88d4000          STRB     r4,[sp,#0]            ;1811
001f48  f88d4001          STRB     r4,[sp,#1]            ;1812
001f4c  f88d4002          STRB     r4,[sp,#2]            ;1813
001f50  f88d4003          STRB     r4,[sp,#3]            ;1814
001f54  4669              MOV      r1,sp                 ;1815
001f56  f105001c          ADD      r0,r5,#0x1c           ;1815
001f5a  f7fffffe          BL       lc640_write_long_ptr
001f5e  e451              B        |L1.6148|
;;;1819     
                          ENDP

                  uz_mem_hndl PROC
;;;1821   //-----------------------------------------------
;;;1822   void uz_mem_hndl(unsigned short in)	 //   
001f60  e92d4ff8          PUSH     {r3-r11,lr}
;;;1823   {
;;;1824   char data[4];
;;;1825   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001f64  f04f0600          MOV      r6,#0
001f68  4634              MOV      r4,r6
;;;1826   //char avar_simbol;
;;;1827   
;;;1828   if(in==1) //  
;;;1829   	{
;;;1830   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1831   	event_ptr++;	
;;;1832   	if(event_ptr>63)event_ptr=0;	
;;;1833   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1834   	
;;;1835       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1836   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1837   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1838   	
;;;1839   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1840   	
;;;1841   	data[0]='u';
;;;1842   	data[1]=0; 
;;;1843   	data[2]='Z';
;;;1844   	data[3]=0;
;;;1845   	lc640_write_long_ptr(lc640_adr,data);
;;;1846   
;;;1847   	data[0]=0;
;;;1848   	data[1]=0;
;;;1849   	data[2]=0;
;;;1850   	data[3]=0;
;;;1851   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1852   
;;;1853   	data[0]=LPC_RTC->YEAR;
001f6a  f8df86c4          LDR      r8,|L1.9776|
001f6e  46a1              MOV      r9,r4                 ;1825
001f70  f44f6a80          MOV      r10,#0x400            ;1839
001f74  2801              CMP      r0,#1                 ;1828
001f76  d010              BEQ      |L1.8090|
;;;1854   	data[1]=LPC_RTC->MONTH;
;;;1855   	data[2]=LPC_RTC->DOM;
;;;1856   	data[3]=0;
;;;1857   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1858   
;;;1859   	data[0]=LPC_RTC->HOUR;
;;;1860   	data[1]=LPC_RTC->MIN;
;;;1861   	data[2]=LPC_RTC->SEC;
;;;1862   	data[3]=0;
;;;1863   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1864   	
;;;1865   	data[0]='A';
;;;1866   	data[1]='A';
;;;1867   	data[2]='A';
;;;1868   	data[3]='A';
;;;1869   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1870   	
;;;1871   	data[0]='A';
;;;1872   	data[1]='A';
;;;1873   	data[2]='A';
;;;1874   	data[3]='A';
;;;1875   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1876   	
;;;1877   	data[0]='A';
;;;1878   	data[1]='A';
;;;1879   	data[2]='A';
;;;1880   	data[3]='A';
;;;1881   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1882   	
;;;1883   	data[0]='A';
;;;1884   	data[1]='A';
;;;1885   	data[2]='A';
;;;1886   	data[3]='A';
;;;1887   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1888    	
;;;1889   	}
;;;1890   
;;;1891   else if(in==0)	// 
001f78  2800              CMP      r0,#0
001f7a  d07d              BEQ      |L1.8312|
;;;1892   	{      
;;;1893   	char i;     
;;;1894   	event_ptr_find=0;
;;;1895   	for (i=0;i<63;i++)
;;;1896   		{
;;;1897   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;1898   
;;;1899        	lc640_read_long_ptr(lc640_adr,data);
;;;1900        
;;;1901        	if(!((data[0]=='u')&&(data[2]=='Z')))
;;;1902        		{        
;;;1903        		if(event_ptr_find)event_ptr_find--;
;;;1904        		else event_ptr_find=63;
;;;1905        		if(event_ptr_find==event_ptr)
;;;1906   				{
;;;1907   				lc640_adr=0;
;;;1908   				break;
;;;1909   				}
;;;1910        		else continue;
;;;1911        		}
;;;1912        	else 
;;;1913        		{
;;;1914        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1915        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1916        			{        
;;;1917        			if(event_ptr_find)event_ptr_find--;
;;;1918            		else event_ptr_find=63;
;;;1919            		if(event_ptr_find==event_ptr)
;;;1920   					{
;;;1921   					lc640_adr=0;
;;;1922   					break;
;;;1923   					}
;;;1924        			else continue;
;;;1925        			}
;;;1926        		}	
;;;1927   		}
;;;1928   	if(lc640_adr!=0)
;;;1929   		{
;;;1930   		data[0]=LPC_RTC->YEAR;
;;;1931   		data[1]=LPC_RTC->MONTH;
;;;1932   		data[2]=LPC_RTC->DOM;
;;;1933   		data[3]=0;
;;;1934   		lc640_write_long_ptr(lc640_adr+16,data);
;;;1935   	
;;;1936   		data[0]=LPC_RTC->HOUR;
;;;1937   		data[1]=LPC_RTC->MIN;
;;;1938   		data[2]=LPC_RTC->SEC;
;;;1939   		data[3]=0;
;;;1940   		lc640_write_long_ptr(lc640_adr+20,data);
;;;1941   		
;;;1942   		data[0]='C';
;;;1943   		data[1]='C';
;;;1944   		data[2]='C';
;;;1945   		data[3]='C';
;;;1946   		lc640_write_long_ptr(lc640_adr+24,data);
;;;1947   		
;;;1948   		data[0]='C';
;;;1949   		data[1]='C';
;;;1950   		data[2]='C';
;;;1951   		data[3]='C';
;;;1952   		lc640_write_long_ptr(lc640_adr+28,data);
;;;1953   		}
;;;1954   	}
;;;1955   else if(in==10) 	//  
001f7c  280a              CMP      r0,#0xa
001f7e  d17c              BNE      |L1.8314|
;;;1956   	{      
;;;1957   	char i;     
;;;1958   
;;;1959   	event_ptr_find=0;
;;;1960   	for (i=0;i<63;i++)
001f80  f04f0700          MOV      r7,#0
                  |L1.8068|
;;;1961   		{
;;;1962   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
001f84  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1963   
;;;1964        	lc640_read_long_ptr(lc640_adr,data);
001f88  4669              MOV      r1,sp
001f8a  4628              MOV      r0,r5
001f8c  f7fffffe          BL       lc640_read_long_ptr
;;;1965        
;;;1966        	if(!((data[0]=='u')&&(data[2]=='Z')))
001f90  f89d0000          LDRB     r0,[sp,#0]
001f94  2875              CMP      r0,#0x75
001f96  d171              BNE      |L1.8316|
001f98  e11c              B        |L1.8660|
                  |L1.8090|
001f9a  f44f6560          MOV      r5,#0xe00             ;1830
001f9e  4628              MOV      r0,r5                 ;1830
001fa0  f7fffffe          BL       lc640_read_int
001fa4  f1000001          ADD      r0,r0,#1              ;1831
001fa8  4604              MOV      r4,r0                 ;1831
001faa  2c3f              CMP      r4,#0x3f              ;1832
001fac  d901              BLS      |L1.8114|
001fae  f04f0400          MOV      r4,#0                 ;1832
                  |L1.8114|
001fb2  b221              SXTH     r1,r4                 ;1833
001fb4  4628              MOV      r0,r5                 ;1833
001fb6  f7fffffe          BL       lc640_write_int
001fba  f6406602          MOV      r6,#0xe02             ;1835
001fbe  4630              MOV      r0,r6                 ;1835
001fc0  f7fffffe          BL       lc640_read_int
001fc4  283f              CMP      r0,#0x3f              ;1836
001fc6  d000              BEQ      |L1.8138|
001fc8  4620              MOV      r0,r4                 ;1836
                  |L1.8138|
001fca  b201              SXTH     r1,r0                 ;1837
001fcc  4630              MOV      r0,r6                 ;1837
001fce  f7fffffe          BL       lc640_write_int
001fd2  4628              MOV      r0,r5                 ;1839
001fd4  f7fffffe          BL       lc640_read_int
001fd8  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1839
001fdc  f04f0075          MOV      r0,#0x75              ;1841
001fe0  f88d0000          STRB     r0,[sp,#0]            ;1841
001fe4  f88d9001          STRB     r9,[sp,#1]            ;1842
001fe8  f04f005a          MOV      r0,#0x5a              ;1843
001fec  f88d0002          STRB     r0,[sp,#2]            ;1843
001ff0  f88d9003          STRB     r9,[sp,#3]            ;1844
001ff4  4669              MOV      r1,sp                 ;1845
001ff6  4620              MOV      r0,r4                 ;1845
001ff8  f7fffffe          BL       lc640_write_long_ptr
001ffc  f8cd9000          STR      r9,[sp,#0]            ;1850
002000  4669              MOV      r1,sp                 ;1851
002002  1d20              ADDS     r0,r4,#4              ;1851
002004  f7fffffe          BL       lc640_write_long_ptr
002008  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1853
00200c  f88d0000          STRB     r0,[sp,#0]            ;1853
002010  f8980038          LDRB     r0,[r8,#0x38]         ;1854
002014  f88d0001          STRB     r0,[sp,#1]            ;1854
002018  f898002c          LDRB     r0,[r8,#0x2c]         ;1855
00201c  f88d0002          STRB     r0,[sp,#2]            ;1855
002020  f88d9003          STRB     r9,[sp,#3]            ;1856
002024  4669              MOV      r1,sp                 ;1857
002026  f1040008          ADD      r0,r4,#8              ;1857
00202a  f7fffffe          BL       lc640_write_long_ptr
00202e  f8980028          LDRB     r0,[r8,#0x28]         ;1859
002032  f88d0000          STRB     r0,[sp,#0]            ;1859
002036  f8980024          LDRB     r0,[r8,#0x24]         ;1860
00203a  f88d0001          STRB     r0,[sp,#1]            ;1860
00203e  f8980020          LDRB     r0,[r8,#0x20]         ;1861
002042  f88d0002          STRB     r0,[sp,#2]            ;1861
002046  f88d9003          STRB     r9,[sp,#3]            ;1862
00204a  4669              MOV      r1,sp                 ;1863
00204c  f104000c          ADD      r0,r4,#0xc            ;1863
002050  f7fffffe          BL       lc640_write_long_ptr
002054  f04f0541          MOV      r5,#0x41              ;1865
002058  f88d5000          STRB     r5,[sp,#0]            ;1865
00205c  f88d5001          STRB     r5,[sp,#1]            ;1866
002060  f88d5002          STRB     r5,[sp,#2]            ;1867
002064  f88d5003          STRB     r5,[sp,#3]            ;1868
002068  4669              MOV      r1,sp                 ;1869
00206a  f1040010          ADD      r0,r4,#0x10           ;1869
00206e  f7fffffe          BL       lc640_write_long_ptr
002072  f88d5000          STRB     r5,[sp,#0]            ;1871
002076  e002              B        |L1.8318|
                  |L1.8312|
002078  e027              B        |L1.8394|
                  |L1.8314|
00207a  e025              B        |L1.8392|
                  |L1.8316|
00207c  e0ae              B        |L1.8668|
                  |L1.8318|
00207e  f88d5001          STRB     r5,[sp,#1]            ;1872
002082  f88d5002          STRB     r5,[sp,#2]            ;1873
002086  f88d5003          STRB     r5,[sp,#3]            ;1874
00208a  4669              MOV      r1,sp                 ;1875
00208c  f1040014          ADD      r0,r4,#0x14           ;1875
002090  f7fffffe          BL       lc640_write_long_ptr
002094  f88d5000          STRB     r5,[sp,#0]            ;1877
002098  f88d5001          STRB     r5,[sp,#1]            ;1878
00209c  f88d5002          STRB     r5,[sp,#2]            ;1879
0020a0  f88d5003          STRB     r5,[sp,#3]            ;1880
0020a4  4669              MOV      r1,sp                 ;1881
0020a6  f1040018          ADD      r0,r4,#0x18           ;1881
0020aa  f7fffffe          BL       lc640_write_long_ptr
0020ae  f88d5000          STRB     r5,[sp,#0]            ;1883
0020b2  f88d5001          STRB     r5,[sp,#1]            ;1884
0020b6  f88d5002          STRB     r5,[sp,#2]            ;1885
0020ba  f88d5003          STRB     r5,[sp,#3]            ;1886
0020be  4669              MOV      r1,sp                 ;1887
0020c0  f104001c          ADD      r0,r4,#0x1c           ;1887
0020c4  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8392|
;;;1967        		{        
;;;1968        		if(event_ptr_find)event_ptr_find--;
;;;1969        		else event_ptr_find=63;
;;;1970        		if(event_ptr_find==event_ptr)
;;;1971   				{
;;;1972   				lc640_adr=0;
;;;1973   				break;
;;;1974   				}
;;;1975        		else continue;
;;;1976        		}
;;;1977        	else 
;;;1978        		{
;;;1979        		lc640_read_long_ptr(lc640_adr+16,data);
;;;1980        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;1981        			{        
;;;1982        			if(event_ptr_find)event_ptr_find--;
;;;1983            		else event_ptr_find=63;
;;;1984            		if(event_ptr_find==event_ptr)
;;;1985   					{
;;;1986   					lc640_adr=0;
;;;1987   					break;
;;;1988   					}
;;;1989        			else continue;
;;;1990        			}
;;;1991        		}	
;;;1992   		}
;;;1993   	if(lc640_adr!=0)
;;;1994   		{
;;;1995   		data[0]=LPC_RTC->YEAR;
;;;1996   		data[1]=LPC_RTC->MONTH;
;;;1997   		data[2]=LPC_RTC->DOM;
;;;1998   		data[3]=0;
;;;1999   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2000   	
;;;2001   		data[0]=LPC_RTC->HOUR;
;;;2002   		data[1]=LPC_RTC->MIN;
;;;2003   		data[2]=LPC_RTC->SEC;
;;;2004   		data[3]=0;
;;;2005   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2006   		
;;;2007   		data[0]='B';
;;;2008   		data[1]='B';
;;;2009   		data[2]='B';
;;;2010   		data[3]='B';
;;;2011   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2012   		
;;;2013   		data[0]='B';
;;;2014   		data[1]='B';
;;;2015   		data[2]='B';
;;;2016   		data[3]='B';
;;;2017   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2018   		}
;;;2019   	}
;;;2020   }
0020c8  e584              B        |L1.7124|
                  |L1.8394|
0020ca  f04f0700          MOV      r7,#0                 ;1895
                  |L1.8398|
0020ce  eb0a1544          ADD      r5,r10,r4,LSL #5      ;1897
0020d2  4669              MOV      r1,sp                 ;1899
0020d4  4628              MOV      r0,r5                 ;1899
0020d6  f7fffffe          BL       lc640_read_long_ptr
0020da  f89d0000          LDRB     r0,[sp,#0]            ;1901
0020de  2875              CMP      r0,#0x75              ;1901
0020e0  d103              BNE      |L1.8426|
0020e2  f89d0002          LDRB     r0,[sp,#2]            ;1901
0020e6  285a              CMP      r0,#0x5a              ;1901
0020e8  d00a              BEQ      |L1.8448|
                  |L1.8426|
0020ea  b114              CBZ      r4,|L1.8434|
0020ec  f1a40401          SUB      r4,r4,#1              ;1903
0020f0  e001              B        |L1.8438|
                  |L1.8434|
0020f2  f04f043f          MOV      r4,#0x3f              ;1904
                  |L1.8438|
0020f6  42b4              CMP      r4,r6                 ;1905
0020f8  d122              BNE      |L1.8512|
0020fa  f04f0500          MOV      r5,#0                 ;1907
0020fe  e024              B        |L1.8522|
                  |L1.8448|
002100  4669              MOV      r1,sp                 ;1914
002102  f1050010          ADD      r0,r5,#0x10           ;1914
002106  f7fffffe          BL       lc640_read_long_ptr
00210a  f89d0000          LDRB     r0,[sp,#0]            ;1915
00210e  2841              CMP      r0,#0x41              ;1915
002110  d10b              BNE      |L1.8490|
002112  f89d0001          LDRB     r0,[sp,#1]            ;1915
002116  2841              CMP      r0,#0x41              ;1915
002118  d107              BNE      |L1.8490|
00211a  f89d0002          LDRB     r0,[sp,#2]            ;1915
00211e  2841              CMP      r0,#0x41              ;1915
002120  d103              BNE      |L1.8490|
002122  f89d0003          LDRB     r0,[sp,#3]            ;1915
002126  2841              CMP      r0,#0x41              ;1915
002128  d00a              BEQ      |L1.8512|
                  |L1.8490|
00212a  b114              CBZ      r4,|L1.8498|
00212c  f1a40401          SUB      r4,r4,#1              ;1917
002130  e001              B        |L1.8502|
                  |L1.8498|
002132  f04f043f          MOV      r4,#0x3f              ;1918
                  |L1.8502|
002136  42b4              CMP      r4,r6                 ;1919
002138  d102              BNE      |L1.8512|
00213a  f04f0500          MOV      r5,#0                 ;1921
00213e  e004              B        |L1.8522|
                  |L1.8512|
002140  f1070701          ADD      r7,r7,#1              ;1895
002144  b2ff              UXTB     r7,r7                 ;1895
002146  2f3f              CMP      r7,#0x3f              ;1895
002148  d3c1              BCC      |L1.8398|
                  |L1.8522|
00214a  2d00              CMP      r5,#0                 ;1928
00214c  d0bc              BEQ      |L1.8392|
00214e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1930
002152  f88d0000          STRB     r0,[sp,#0]            ;1930
002156  f8980038          LDRB     r0,[r8,#0x38]         ;1931
00215a  f88d0001          STRB     r0,[sp,#1]            ;1931
00215e  f898002c          LDRB     r0,[r8,#0x2c]         ;1932
002162  f88d0002          STRB     r0,[sp,#2]            ;1932
002166  f88d9003          STRB     r9,[sp,#3]            ;1933
00216a  4669              MOV      r1,sp                 ;1934
00216c  f1050010          ADD      r0,r5,#0x10           ;1934
002170  f7fffffe          BL       lc640_write_long_ptr
002174  f8980028          LDRB     r0,[r8,#0x28]         ;1936
002178  f88d0000          STRB     r0,[sp,#0]            ;1936
00217c  f8980024          LDRB     r0,[r8,#0x24]         ;1937
002180  f88d0001          STRB     r0,[sp,#1]            ;1937
002184  f8980020          LDRB     r0,[r8,#0x20]         ;1938
002188  f88d0002          STRB     r0,[sp,#2]            ;1938
00218c  f88d9003          STRB     r9,[sp,#3]            ;1939
002190  4669              MOV      r1,sp                 ;1940
002192  f1050014          ADD      r0,r5,#0x14           ;1940
002196  f7fffffe          BL       lc640_write_long_ptr
00219a  f04f0443          MOV      r4,#0x43              ;1942
00219e  f88d4000          STRB     r4,[sp,#0]            ;1942
0021a2  f88d4001          STRB     r4,[sp,#1]            ;1943
0021a6  f88d4002          STRB     r4,[sp,#2]            ;1944
0021aa  f88d4003          STRB     r4,[sp,#3]            ;1945
0021ae  4669              MOV      r1,sp                 ;1946
0021b0  f1050018          ADD      r0,r5,#0x18           ;1946
0021b4  f7fffffe          BL       lc640_write_long_ptr
0021b8  f88d4000          STRB     r4,[sp,#0]            ;1948
0021bc  f88d4001          STRB     r4,[sp,#1]            ;1949
0021c0  f88d4002          STRB     r4,[sp,#2]            ;1950
0021c4  f88d4003          STRB     r4,[sp,#3]            ;1951
0021c8  4669              MOV      r1,sp                 ;1952
0021ca  f105001c          ADD      r0,r5,#0x1c           ;1952
0021ce  f7fffffe          BL       lc640_write_long_ptr
                  |L1.8658|
0021d2  e4ff              B        |L1.7124|
                  |L1.8660|
0021d4  f89d0002          LDRB     r0,[sp,#2]            ;1966
0021d8  285a              CMP      r0,#0x5a              ;1966
0021da  d00a              BEQ      |L1.8690|
                  |L1.8668|
0021dc  b114              CBZ      r4,|L1.8676|
0021de  f1a40401          SUB      r4,r4,#1              ;1968
0021e2  e001              B        |L1.8680|
                  |L1.8676|
0021e4  f04f043f          MOV      r4,#0x3f              ;1969
                  |L1.8680|
0021e8  42b4              CMP      r4,r6                 ;1970
0021ea  d122              BNE      |L1.8754|
0021ec  f04f0500          MOV      r5,#0                 ;1972
0021f0  e025              B        |L1.8766|
                  |L1.8690|
0021f2  4669              MOV      r1,sp                 ;1979
0021f4  f1050010          ADD      r0,r5,#0x10           ;1979
0021f8  f7fffffe          BL       lc640_read_long_ptr
0021fc  f89d0000          LDRB     r0,[sp,#0]            ;1980
002200  2841              CMP      r0,#0x41              ;1980
002202  d10b              BNE      |L1.8732|
002204  f89d0001          LDRB     r0,[sp,#1]            ;1980
002208  2841              CMP      r0,#0x41              ;1980
00220a  d107              BNE      |L1.8732|
00220c  f89d0002          LDRB     r0,[sp,#2]            ;1980
002210  2841              CMP      r0,#0x41              ;1980
002212  d103              BNE      |L1.8732|
002214  f89d0003          LDRB     r0,[sp,#3]            ;1980
002218  2841              CMP      r0,#0x41              ;1980
00221a  d00a              BEQ      |L1.8754|
                  |L1.8732|
00221c  b114              CBZ      r4,|L1.8740|
00221e  f1a40401          SUB      r4,r4,#1              ;1982
002222  e001              B        |L1.8744|
                  |L1.8740|
002224  f04f043f          MOV      r4,#0x3f              ;1983
                  |L1.8744|
002228  42b4              CMP      r4,r6                 ;1984
00222a  d102              BNE      |L1.8754|
00222c  f04f0500          MOV      r5,#0                 ;1986
002230  e005              B        |L1.8766|
                  |L1.8754|
002232  f1070701          ADD      r7,r7,#1              ;1960
002236  b2ff              UXTB     r7,r7                 ;1960
002238  2f3f              CMP      r7,#0x3f              ;1960
00223a  f4ffaea3          BCC      |L1.8068|
                  |L1.8766|
00223e  2d00              CMP      r5,#0                 ;1993
002240  d0c7              BEQ      |L1.8658|
002242  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1995
002246  f88d0000          STRB     r0,[sp,#0]            ;1995
00224a  f8980038          LDRB     r0,[r8,#0x38]         ;1996
00224e  f88d0001          STRB     r0,[sp,#1]            ;1996
002252  f898002c          LDRB     r0,[r8,#0x2c]         ;1997
002256  f88d0002          STRB     r0,[sp,#2]            ;1997
00225a  f88d9003          STRB     r9,[sp,#3]            ;1998
00225e  4669              MOV      r1,sp                 ;1999
002260  f1050010          ADD      r0,r5,#0x10           ;1999
002264  f7fffffe          BL       lc640_write_long_ptr
002268  f8980028          LDRB     r0,[r8,#0x28]         ;2001
00226c  f88d0000          STRB     r0,[sp,#0]            ;2001
002270  f8980024          LDRB     r0,[r8,#0x24]         ;2002
002274  f88d0001          STRB     r0,[sp,#1]            ;2002
002278  f8980020          LDRB     r0,[r8,#0x20]         ;2003
00227c  f88d0002          STRB     r0,[sp,#2]            ;2003
002280  f88d9003          STRB     r9,[sp,#3]            ;2004
002284  4669              MOV      r1,sp                 ;2005
002286  f1050014          ADD      r0,r5,#0x14           ;2005
00228a  f7fffffe          BL       lc640_write_long_ptr
00228e  f04f0442          MOV      r4,#0x42              ;2007
002292  f88d4000          STRB     r4,[sp,#0]            ;2007
002296  f88d4001          STRB     r4,[sp,#1]            ;2008
00229a  f88d4002          STRB     r4,[sp,#2]            ;2009
00229e  f88d4003          STRB     r4,[sp,#3]            ;2010
0022a2  4669              MOV      r1,sp                 ;2011
0022a4  f1050018          ADD      r0,r5,#0x18           ;2011
0022a8  f7fffffe          BL       lc640_write_long_ptr
0022ac  f88d4000          STRB     r4,[sp,#0]            ;2013
0022b0  f88d4001          STRB     r4,[sp,#1]            ;2014
0022b4  f88d4002          STRB     r4,[sp,#2]            ;2015
0022b8  f88d4003          STRB     r4,[sp,#3]            ;2016
0022bc  4669              MOV      r1,sp                 ;2017
0022be  f105001c          ADD      r0,r5,#0x1c           ;2017
0022c2  f7fffffe          BL       lc640_write_long_ptr
0022c6  e485              B        |L1.7124|
;;;2021   
                          ENDP

                  fz_mem_hndl PROC
;;;2022   //-----------------------------------------------
;;;2023   void fz_mem_hndl(unsigned short in)	 //   
0022c8  e92d4ff8          PUSH     {r3-r11,lr}
;;;2024   {
;;;2025   char data[4];
;;;2026   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
0022cc  f04f0600          MOV      r6,#0
0022d0  4634              MOV      r4,r6
;;;2027   //char avar_simbol;
;;;2028   
;;;2029   if(in==1) //  
;;;2030   	{
;;;2031   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;2032   	event_ptr++;	
;;;2033   	if(event_ptr>63)event_ptr=0;	
;;;2034   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;2035   	
;;;2036       event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;2037   	if(event_cnt!=63)event_cnt=event_ptr;
;;;2038   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;2039   	
;;;2040   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;2041   	
;;;2042   	data[0]='f';
;;;2043   	data[1]=0; 
;;;2044   	data[2]='Z';
;;;2045   	data[3]=0;
;;;2046   	lc640_write_long_ptr(lc640_adr,data);
;;;2047   
;;;2048   	data[0]=0;
;;;2049   	data[1]=0;
;;;2050   	data[2]=0;
;;;2051   	data[3]=0;
;;;2052   	lc640_write_long_ptr(lc640_adr+4,data);
;;;2053   
;;;2054   	data[0]=LPC_RTC->YEAR;
0022d2  f8df835c          LDR      r8,|L1.9776|
0022d6  46a1              MOV      r9,r4                 ;2026
0022d8  f44f6a80          MOV      r10,#0x400            ;2040
0022dc  2801              CMP      r0,#1                 ;2029
0022de  d010              BEQ      |L1.8962|
;;;2055   	data[1]=LPC_RTC->MONTH;
;;;2056   	data[2]=LPC_RTC->DOM;
;;;2057   	data[3]=0;
;;;2058   	lc640_write_long_ptr(lc640_adr+8,data);
;;;2059   
;;;2060   	data[0]=LPC_RTC->HOUR;
;;;2061   	data[1]=LPC_RTC->MIN;
;;;2062   	data[2]=LPC_RTC->SEC;
;;;2063   	data[3]=0;
;;;2064   	lc640_write_long_ptr(lc640_adr+12,data);
;;;2065   	
;;;2066   	data[0]='A';
;;;2067   	data[1]='A';
;;;2068   	data[2]='A';
;;;2069   	data[3]='A';
;;;2070   	lc640_write_long_ptr(lc640_adr+16,data);
;;;2071   	
;;;2072   	data[0]='A';
;;;2073   	data[1]='A';
;;;2074   	data[2]='A';
;;;2075   	data[3]='A';
;;;2076   	lc640_write_long_ptr(lc640_adr+20,data);
;;;2077   	
;;;2078   	data[0]='A';
;;;2079   	data[1]='A';
;;;2080   	data[2]='A';
;;;2081   	data[3]='A';
;;;2082   	lc640_write_long_ptr(lc640_adr+24,data);
;;;2083   	
;;;2084   	data[0]='A';
;;;2085   	data[1]='A';
;;;2086   	data[2]='A';
;;;2087   	data[3]='A';
;;;2088   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;2089    	
;;;2090   	}
;;;2091   
;;;2092   else if(in==0)	// 
0022e0  2800              CMP      r0,#0
0022e2  d07d              BEQ      |L1.9184|
;;;2093   	{      
;;;2094   	char i;     
;;;2095   	event_ptr_find=0;
;;;2096   	for (i=0;i<63;i++)
;;;2097   		{
;;;2098   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
;;;2099   
;;;2100        	lc640_read_long_ptr(lc640_adr,data);
;;;2101        
;;;2102        	if(!((data[0]=='f')&&(data[2]=='Z')))
;;;2103        		{        
;;;2104        		if(event_ptr_find)event_ptr_find--;
;;;2105        		else event_ptr_find=63;
;;;2106        		if(event_ptr_find==event_ptr)
;;;2107   				{
;;;2108   				lc640_adr=0;
;;;2109   				break;
;;;2110   				}
;;;2111        		else continue;
;;;2112        		}
;;;2113        	else 
;;;2114        		{
;;;2115        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2116        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2117        			{        
;;;2118        			if(event_ptr_find)event_ptr_find--;
;;;2119            		else event_ptr_find=63;
;;;2120            		if(event_ptr_find==event_ptr)
;;;2121   					{
;;;2122   					lc640_adr=0;
;;;2123   					break;
;;;2124   					}
;;;2125        			else continue;
;;;2126        			}
;;;2127        		}	
;;;2128   		}
;;;2129   	if(lc640_adr!=0)
;;;2130   		{
;;;2131   		data[0]=LPC_RTC->YEAR;
;;;2132   		data[1]=LPC_RTC->MONTH;
;;;2133   		data[2]=LPC_RTC->DOM;
;;;2134   		data[3]=0;
;;;2135   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2136   	
;;;2137   		data[0]=LPC_RTC->HOUR;
;;;2138   		data[1]=LPC_RTC->MIN;
;;;2139   		data[2]=LPC_RTC->SEC;
;;;2140   		data[3]=0;
;;;2141   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2142   		
;;;2143   		data[0]='C';
;;;2144   		data[1]='C';
;;;2145   		data[2]='C';
;;;2146   		data[3]='C';
;;;2147   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2148   		
;;;2149   		data[0]='C';
;;;2150   		data[1]='C';
;;;2151   		data[2]='C';
;;;2152   		data[3]='C';
;;;2153   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2154   		}
;;;2155   	}
;;;2156   else if(in==10) 	//  
0022e4  280a              CMP      r0,#0xa
0022e6  d17c              BNE      |L1.9186|
;;;2157   	{      
;;;2158   	char i;     
;;;2159   
;;;2160   	event_ptr_find=0;
;;;2161   	for (i=0;i<63;i++)
0022e8  f04f0700          MOV      r7,#0
                  |L1.8940|
;;;2162   		{
;;;2163   		lc640_adr=EVENT_LOG+(event_ptr_find*32);
0022ec  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;2164   
;;;2165        	lc640_read_long_ptr(lc640_adr,data);
0022f0  4669              MOV      r1,sp
0022f2  4628              MOV      r0,r5
0022f4  f7fffffe          BL       lc640_read_long_ptr
;;;2166        
;;;2167        	if(!((data[0]=='f')&&(data[2]=='Z')))
0022f8  f89d0000          LDRB     r0,[sp,#0]
0022fc  2866              CMP      r0,#0x66
0022fe  d171              BNE      |L1.9188|
002300  e11c              B        |L1.9532|
                  |L1.8962|
002302  f44f6560          MOV      r5,#0xe00             ;2031
002306  4628              MOV      r0,r5                 ;2031
002308  f7fffffe          BL       lc640_read_int
00230c  f1000001          ADD      r0,r0,#1              ;2032
002310  4604              MOV      r4,r0                 ;2032
002312  2c3f              CMP      r4,#0x3f              ;2033
002314  d901              BLS      |L1.8986|
002316  f04f0400          MOV      r4,#0                 ;2033
                  |L1.8986|
00231a  b221              SXTH     r1,r4                 ;2034
00231c  4628              MOV      r0,r5                 ;2034
00231e  f7fffffe          BL       lc640_write_int
002322  f6406602          MOV      r6,#0xe02             ;2036
002326  4630              MOV      r0,r6                 ;2036
002328  f7fffffe          BL       lc640_read_int
00232c  283f              CMP      r0,#0x3f              ;2037
00232e  d000              BEQ      |L1.9010|
002330  4620              MOV      r0,r4                 ;2037
                  |L1.9010|
002332  b201              SXTH     r1,r0                 ;2038
002334  4630              MOV      r0,r6                 ;2038
002336  f7fffffe          BL       lc640_write_int
00233a  4628              MOV      r0,r5                 ;2040
00233c  f7fffffe          BL       lc640_read_int
002340  eb0a1440          ADD      r4,r10,r0,LSL #5      ;2040
002344  f04f0066          MOV      r0,#0x66              ;2042
002348  f88d0000          STRB     r0,[sp,#0]            ;2042
00234c  f88d9001          STRB     r9,[sp,#1]            ;2043
002350  f04f005a          MOV      r0,#0x5a              ;2044
002354  f88d0002          STRB     r0,[sp,#2]            ;2044
002358  f88d9003          STRB     r9,[sp,#3]            ;2045
00235c  4669              MOV      r1,sp                 ;2046
00235e  4620              MOV      r0,r4                 ;2046
002360  f7fffffe          BL       lc640_write_long_ptr
002364  f8cd9000          STR      r9,[sp,#0]            ;2051
002368  4669              MOV      r1,sp                 ;2052
00236a  1d20              ADDS     r0,r4,#4              ;2052
00236c  f7fffffe          BL       lc640_write_long_ptr
002370  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2054
002374  f88d0000          STRB     r0,[sp,#0]            ;2054
002378  f8980038          LDRB     r0,[r8,#0x38]         ;2055
00237c  f88d0001          STRB     r0,[sp,#1]            ;2055
002380  f898002c          LDRB     r0,[r8,#0x2c]         ;2056
002384  f88d0002          STRB     r0,[sp,#2]            ;2056
002388  f88d9003          STRB     r9,[sp,#3]            ;2057
00238c  4669              MOV      r1,sp                 ;2058
00238e  f1040008          ADD      r0,r4,#8              ;2058
002392  f7fffffe          BL       lc640_write_long_ptr
002396  f8980028          LDRB     r0,[r8,#0x28]         ;2060
00239a  f88d0000          STRB     r0,[sp,#0]            ;2060
00239e  f8980024          LDRB     r0,[r8,#0x24]         ;2061
0023a2  f88d0001          STRB     r0,[sp,#1]            ;2061
0023a6  f8980020          LDRB     r0,[r8,#0x20]         ;2062
0023aa  f88d0002          STRB     r0,[sp,#2]            ;2062
0023ae  f88d9003          STRB     r9,[sp,#3]            ;2063
0023b2  4669              MOV      r1,sp                 ;2064
0023b4  f104000c          ADD      r0,r4,#0xc            ;2064
0023b8  f7fffffe          BL       lc640_write_long_ptr
0023bc  f04f0541          MOV      r5,#0x41              ;2066
0023c0  f88d5000          STRB     r5,[sp,#0]            ;2066
0023c4  f88d5001          STRB     r5,[sp,#1]            ;2067
0023c8  f88d5002          STRB     r5,[sp,#2]            ;2068
0023cc  f88d5003          STRB     r5,[sp,#3]            ;2069
0023d0  4669              MOV      r1,sp                 ;2070
0023d2  f1040010          ADD      r0,r4,#0x10           ;2070
0023d6  f7fffffe          BL       lc640_write_long_ptr
0023da  f88d5000          STRB     r5,[sp,#0]            ;2072
0023de  e002              B        |L1.9190|
                  |L1.9184|
0023e0  e027              B        |L1.9266|
                  |L1.9186|
0023e2  e025              B        |L1.9264|
                  |L1.9188|
0023e4  e0ae              B        |L1.9540|
                  |L1.9190|
0023e6  f88d5001          STRB     r5,[sp,#1]            ;2073
0023ea  f88d5002          STRB     r5,[sp,#2]            ;2074
0023ee  f88d5003          STRB     r5,[sp,#3]            ;2075
0023f2  4669              MOV      r1,sp                 ;2076
0023f4  f1040014          ADD      r0,r4,#0x14           ;2076
0023f8  f7fffffe          BL       lc640_write_long_ptr
0023fc  f88d5000          STRB     r5,[sp,#0]            ;2078
002400  f88d5001          STRB     r5,[sp,#1]            ;2079
002404  f88d5002          STRB     r5,[sp,#2]            ;2080
002408  f88d5003          STRB     r5,[sp,#3]            ;2081
00240c  4669              MOV      r1,sp                 ;2082
00240e  f1040018          ADD      r0,r4,#0x18           ;2082
002412  f7fffffe          BL       lc640_write_long_ptr
002416  f88d5000          STRB     r5,[sp,#0]            ;2084
00241a  f88d5001          STRB     r5,[sp,#1]            ;2085
00241e  f88d5002          STRB     r5,[sp,#2]            ;2086
002422  f88d5003          STRB     r5,[sp,#3]            ;2087
002426  4669              MOV      r1,sp                 ;2088
002428  f104001c          ADD      r0,r4,#0x1c           ;2088
00242c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9264|
;;;2168        		{        
;;;2169        		if(event_ptr_find)event_ptr_find--;
;;;2170        		else event_ptr_find=63;
;;;2171        		if(event_ptr_find==event_ptr)
;;;2172   				{
;;;2173   				lc640_adr=0;
;;;2174   				break;
;;;2175   				}
;;;2176        		else continue;
;;;2177        		}
;;;2178        	else 
;;;2179        		{
;;;2180        		lc640_read_long_ptr(lc640_adr+16,data);
;;;2181        		if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
;;;2182        			{        
;;;2183        			if(event_ptr_find)event_ptr_find--;
;;;2184            		else event_ptr_find=63;
;;;2185            		if(event_ptr_find==event_ptr)
;;;2186   					{
;;;2187   					lc640_adr=0;
;;;2188   					break;
;;;2189   					}
;;;2190        			else continue;
;;;2191        			}
;;;2192        		}	
;;;2193   		}
;;;2194   	if(lc640_adr!=0)
;;;2195   		{
;;;2196   		data[0]=LPC_RTC->YEAR;
;;;2197   		data[1]=LPC_RTC->MONTH;
;;;2198   		data[2]=LPC_RTC->DOM;
;;;2199   		data[3]=0;
;;;2200   		lc640_write_long_ptr(lc640_adr+16,data);
;;;2201   	
;;;2202   		data[0]=LPC_RTC->HOUR;
;;;2203   		data[1]=LPC_RTC->MIN;
;;;2204   		data[2]=LPC_RTC->SEC;
;;;2205   		data[3]=0;
;;;2206   		lc640_write_long_ptr(lc640_adr+20,data);
;;;2207   		
;;;2208   		data[0]='B';
;;;2209   		data[1]='B';
;;;2210   		data[2]='B';
;;;2211   		data[3]='B';
;;;2212   		lc640_write_long_ptr(lc640_adr+24,data);
;;;2213   		
;;;2214   		data[0]='B';
;;;2215   		data[1]='B';
;;;2216   		data[2]='B';
;;;2217   		data[3]='B';
;;;2218   		lc640_write_long_ptr(lc640_adr+28,data);
;;;2219   		}
;;;2220   	}
;;;2221   }
002430  e496              B        |L1.7520|
                  |L1.9266|
002432  f04f0700          MOV      r7,#0                 ;2096
                  |L1.9270|
002436  eb0a1544          ADD      r5,r10,r4,LSL #5      ;2098
00243a  4669              MOV      r1,sp                 ;2100
00243c  4628              MOV      r0,r5                 ;2100
00243e  f7fffffe          BL       lc640_read_long_ptr
002442  f89d0000          LDRB     r0,[sp,#0]            ;2102
002446  2866              CMP      r0,#0x66              ;2102
002448  d103              BNE      |L1.9298|
00244a  f89d0002          LDRB     r0,[sp,#2]            ;2102
00244e  285a              CMP      r0,#0x5a              ;2102
002450  d00a              BEQ      |L1.9320|
                  |L1.9298|
002452  b114              CBZ      r4,|L1.9306|
002454  f1a40401          SUB      r4,r4,#1              ;2104
002458  e001              B        |L1.9310|
                  |L1.9306|
00245a  f04f043f          MOV      r4,#0x3f              ;2105
                  |L1.9310|
00245e  42b4              CMP      r4,r6                 ;2106
002460  d122              BNE      |L1.9384|
002462  f04f0500          MOV      r5,#0                 ;2108
002466  e024              B        |L1.9394|
                  |L1.9320|
002468  4669              MOV      r1,sp                 ;2115
00246a  f1050010          ADD      r0,r5,#0x10           ;2115
00246e  f7fffffe          BL       lc640_read_long_ptr
002472  f89d0000          LDRB     r0,[sp,#0]            ;2116
002476  2841              CMP      r0,#0x41              ;2116
002478  d10b              BNE      |L1.9362|
00247a  f89d0001          LDRB     r0,[sp,#1]            ;2116
00247e  2841              CMP      r0,#0x41              ;2116
002480  d107              BNE      |L1.9362|
002482  f89d0002          LDRB     r0,[sp,#2]            ;2116
002486  2841              CMP      r0,#0x41              ;2116
002488  d103              BNE      |L1.9362|
00248a  f89d0003          LDRB     r0,[sp,#3]            ;2116
00248e  2841              CMP      r0,#0x41              ;2116
002490  d00a              BEQ      |L1.9384|
                  |L1.9362|
002492  b114              CBZ      r4,|L1.9370|
002494  f1a40401          SUB      r4,r4,#1              ;2118
002498  e001              B        |L1.9374|
                  |L1.9370|
00249a  f04f043f          MOV      r4,#0x3f              ;2119
                  |L1.9374|
00249e  42b4              CMP      r4,r6                 ;2120
0024a0  d102              BNE      |L1.9384|
0024a2  f04f0500          MOV      r5,#0                 ;2122
0024a6  e004              B        |L1.9394|
                  |L1.9384|
0024a8  f1070701          ADD      r7,r7,#1              ;2096
0024ac  b2ff              UXTB     r7,r7                 ;2096
0024ae  2f3f              CMP      r7,#0x3f              ;2096
0024b0  d3c1              BCC      |L1.9270|
                  |L1.9394|
0024b2  2d00              CMP      r5,#0                 ;2129
0024b4  d0bc              BEQ      |L1.9264|
0024b6  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2131
0024ba  f88d0000          STRB     r0,[sp,#0]            ;2131
0024be  f8980038          LDRB     r0,[r8,#0x38]         ;2132
0024c2  f88d0001          STRB     r0,[sp,#1]            ;2132
0024c6  f898002c          LDRB     r0,[r8,#0x2c]         ;2133
0024ca  f88d0002          STRB     r0,[sp,#2]            ;2133
0024ce  f88d9003          STRB     r9,[sp,#3]            ;2134
0024d2  4669              MOV      r1,sp                 ;2135
0024d4  f1050010          ADD      r0,r5,#0x10           ;2135
0024d8  f7fffffe          BL       lc640_write_long_ptr
0024dc  f8980028          LDRB     r0,[r8,#0x28]         ;2137
0024e0  f88d0000          STRB     r0,[sp,#0]            ;2137
0024e4  f8980024          LDRB     r0,[r8,#0x24]         ;2138
0024e8  f88d0001          STRB     r0,[sp,#1]            ;2138
0024ec  f8980020          LDRB     r0,[r8,#0x20]         ;2139
0024f0  f88d0002          STRB     r0,[sp,#2]            ;2139
0024f4  f88d9003          STRB     r9,[sp,#3]            ;2140
0024f8  4669              MOV      r1,sp                 ;2141
0024fa  f1050014          ADD      r0,r5,#0x14           ;2141
0024fe  f7fffffe          BL       lc640_write_long_ptr
002502  f04f0443          MOV      r4,#0x43              ;2143
002506  f88d4000          STRB     r4,[sp,#0]            ;2143
00250a  f88d4001          STRB     r4,[sp,#1]            ;2144
00250e  f88d4002          STRB     r4,[sp,#2]            ;2145
002512  f88d4003          STRB     r4,[sp,#3]            ;2146
002516  4669              MOV      r1,sp                 ;2147
002518  f1050018          ADD      r0,r5,#0x18           ;2147
00251c  f7fffffe          BL       lc640_write_long_ptr
002520  f88d4000          STRB     r4,[sp,#0]            ;2149
002524  f88d4001          STRB     r4,[sp,#1]            ;2150
002528  f88d4002          STRB     r4,[sp,#2]            ;2151
00252c  f88d4003          STRB     r4,[sp,#3]            ;2152
002530  4669              MOV      r1,sp                 ;2153
002532  f105001c          ADD      r0,r5,#0x1c           ;2153
002536  f7fffffe          BL       lc640_write_long_ptr
                  |L1.9530|
00253a  e411              B        |L1.7520|
                  |L1.9532|
00253c  f89d0002          LDRB     r0,[sp,#2]            ;2167
002540  285a              CMP      r0,#0x5a              ;2167
002542  d00a              BEQ      |L1.9562|
                  |L1.9540|
002544  b114              CBZ      r4,|L1.9548|
002546  f1a40401          SUB      r4,r4,#1              ;2169
00254a  e001              B        |L1.9552|
                  |L1.9548|
00254c  f04f043f          MOV      r4,#0x3f              ;2170
                  |L1.9552|
002550  42b4              CMP      r4,r6                 ;2171
002552  d122              BNE      |L1.9626|
002554  f04f0500          MOV      r5,#0                 ;2173
002558  e025              B        |L1.9638|
                  |L1.9562|
00255a  4669              MOV      r1,sp                 ;2180
00255c  f1050010          ADD      r0,r5,#0x10           ;2180
002560  f7fffffe          BL       lc640_read_long_ptr
002564  f89d0000          LDRB     r0,[sp,#0]            ;2181
002568  2841              CMP      r0,#0x41              ;2181
00256a  d10b              BNE      |L1.9604|
00256c  f89d0001          LDRB     r0,[sp,#1]            ;2181
002570  2841              CMP      r0,#0x41              ;2181
002572  d107              BNE      |L1.9604|
002574  f89d0002          LDRB     r0,[sp,#2]            ;2181
002578  2841              CMP      r0,#0x41              ;2181
00257a  d103              BNE      |L1.9604|
00257c  f89d0003          LDRB     r0,[sp,#3]            ;2181
002580  2841              CMP      r0,#0x41              ;2181
002582  d00a              BEQ      |L1.9626|
                  |L1.9604|
002584  b114              CBZ      r4,|L1.9612|
002586  f1a40401          SUB      r4,r4,#1              ;2183
00258a  e001              B        |L1.9616|
                  |L1.9612|
00258c  f04f043f          MOV      r4,#0x3f              ;2184
                  |L1.9616|
002590  42b4              CMP      r4,r6                 ;2185
002592  d102              BNE      |L1.9626|
002594  f04f0500          MOV      r5,#0                 ;2187
002598  e005              B        |L1.9638|
                  |L1.9626|
00259a  f1070701          ADD      r7,r7,#1              ;2161
00259e  b2ff              UXTB     r7,r7                 ;2161
0025a0  2f3f              CMP      r7,#0x3f              ;2161
0025a2  f4ffaea3          BCC      |L1.8940|
                  |L1.9638|
0025a6  2d00              CMP      r5,#0                 ;2194
0025a8  d0c7              BEQ      |L1.9530|
0025aa  f8b8003c          LDRH     r0,[r8,#0x3c]         ;2196
0025ae  f88d0000          STRB     r0,[sp,#0]            ;2196
0025b2  f8980038          LDRB     r0,[r8,#0x38]         ;2197
0025b6  f88d0001          STRB     r0,[sp,#1]            ;2197
0025ba  f898002c          LDRB     r0,[r8,#0x2c]         ;2198
0025be  f88d0002          STRB     r0,[sp,#2]            ;2198
0025c2  f88d9003          STRB     r9,[sp,#3]            ;2199
0025c6  4669              MOV      r1,sp                 ;2200
0025c8  f1050010          ADD      r0,r5,#0x10           ;2200
0025cc  f7fffffe          BL       lc640_write_long_ptr
0025d0  f8980028          LDRB     r0,[r8,#0x28]         ;2202
0025d4  f88d0000          STRB     r0,[sp,#0]            ;2202
0025d8  f8980024          LDRB     r0,[r8,#0x24]         ;2203
0025dc  f88d0001          STRB     r0,[sp,#1]            ;2203
0025e0  f8980020          LDRB     r0,[r8,#0x20]         ;2204
0025e4  f88d0002          STRB     r0,[sp,#2]            ;2204
0025e8  f88d9003          STRB     r9,[sp,#3]            ;2205
0025ec  4669              MOV      r1,sp                 ;2206
0025ee  f1050014          ADD      r0,r5,#0x14           ;2206
0025f2  f7fffffe          BL       lc640_write_long_ptr
0025f6  f04f0442          MOV      r4,#0x42              ;2208
0025fa  f88d4000          STRB     r4,[sp,#0]            ;2208
0025fe  f88d4001          STRB     r4,[sp,#1]            ;2209
002602  f88d4002          STRB     r4,[sp,#2]            ;2210
002606  f88d4003          STRB     r4,[sp,#3]            ;2211
00260a  4669              MOV      r1,sp                 ;2212
00260c  f1050018          ADD      r0,r5,#0x18           ;2212
002610  f7fffffe          BL       lc640_write_long_ptr
002614  f88d4000          STRB     r4,[sp,#0]            ;2214
002618  f88d4001          STRB     r4,[sp,#1]            ;2215
00261c  f88d4002          STRB     r4,[sp,#2]            ;2216
002620  f88d4003          STRB     r4,[sp,#3]            ;2217
002624  4669              MOV      r1,sp                 ;2218
002626  f105001c          ADD      r0,r5,#0x1c           ;2218
00262a  f7fffffe          BL       lc640_write_long_ptr
00262e  e41c              B        |L1.7786|
                          ENDP

                  |L1.9776|
                          DCD      0x40024000

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  ke_mem_hndl PROC
;;;77     //-----------------------------------------------
;;;78     void avar_hndl(void)
000000  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;79     {
;;;80     //static unsigned avar_stat_old;
;;;81     char i;
;;;82     //unsigned avar_stat_new,avar_stat_offed;
;;;83     
;;;84     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  b083              SUB      sp,sp,#0xc
000004  4605              MOV      r5,r0
000006  eb050045          ADD      r0,r5,r5,LSL #1
00000a  4948              LDR      r1,|L2.300|
00000c  eb001005          ADD      r0,r0,r5,LSL #4
000010  eb010180          ADD      r1,r1,r0,LSL #2
;;;85     else	   			SET_REG(avar_stat,0,0,1);
000014  4846              LDR      r0,|L2.304|
000016  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
;;;86     
;;;87     for(i=0;i<2;i++)
00001a  f1000001          ADD      r0,r0,#1
;;;88     	{
;;;89     	if(bat[i]._av&3)	SET_REG(avar_stat,1,1+i,1);
00001e  eb010040          ADD      r0,r1,r0,LSL #1
000022  f9b00020          LDRSH    r0,[r0,#0x20]
000026  9001              STR      r0,[sp,#4]
000028  f44f6660          MOV      r6,#0xe00
00002c  4630              MOV      r0,r6
00002e  f7fffffe          BL       lc640_read_int
000032  f1000001          ADD      r0,r0,#1
000036  4604              MOV      r4,r0
000038  2c3f              CMP      r4,#0x3f
00003a  d901              BLS      |L2.64|
00003c  f04f0400          MOV      r4,#0
                  |L2.64|
000040  b221              SXTH     r1,r4
000042  4630              MOV      r0,r6
000044  f7fffffe          BL       lc640_write_int
000048  f6406702          MOV      r7,#0xe02
00004c  4638              MOV      r0,r7
;;;90     	else	   			SET_REG(avar_stat,0,1+i,1);
00004e  f7fffffe          BL       lc640_read_int
000052  283f              CMP      r0,#0x3f
000054  d000              BEQ      |L2.88|
000056  4620              MOV      r0,r4
                  |L2.88|
000058  b201              SXTH     r1,r0
00005a  4638              MOV      r0,r7
00005c  f7fffffe          BL       lc640_write_int
000060  4630              MOV      r0,r6                 ;87
000062  f7fffffe          BL       lc640_read_int
000066  f44f6180          MOV      r1,#0x400             ;87
;;;91     	}
;;;92     
;;;93     for(i=0;i<12;i++)
00006a  eb011440          ADD      r4,r1,r0,LSL #5
;;;94     	{
;;;95     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00006e  f04f0042          MOV      r0,#0x42
000072  f88d0008          STRB     r0,[sp,#8]
000076  f88d5009          STRB     r5,[sp,#9]
00007a  f04f004b          MOV      r0,#0x4b
00007e  f88d000a          STRB     r0,[sp,#0xa]
000082  f04f0600          MOV      r6,#0
000086  f88d600b          STRB     r6,[sp,#0xb]
00008a  a902              ADD      r1,sp,#8
00008c  4620              MOV      r0,r4
00008e  f7fffffe          BL       lc640_write_long_ptr
000092  f89d0010          LDRB     r0,[sp,#0x10]
000096  f88d0008          STRB     r0,[sp,#8]
;;;96     	else	   		SET_REG(avar_stat,0,3+i,1);
00009a  f89d0011          LDRB     r0,[sp,#0x11]
00009e  f88d0009          STRB     r0,[sp,#9]
0000a2  f89d0004          LDRB     r0,[sp,#4]
0000a6  f88d000a          STRB     r0,[sp,#0xa]
0000aa  f89d0005          LDRB     r0,[sp,#5]            ;93
0000ae  f88d000b          STRB     r0,[sp,#0xb]          ;93
;;;97     	}
;;;98     
;;;99     for(i=0;i<6;i++)
0000b2  a902              ADD      r1,sp,#8
0000b4  1d20              ADDS     r0,r4,#4
;;;100    	{
;;;101    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
0000b6  f7fffffe          BL       lc640_write_long_ptr
0000ba  f24020a2          MOV      r0,#0x2a2
0000be  f7fffffe          BL       lc640_read_long
0000c2  4d1c              LDR      r5,|L2.308|
0000c4  6028              STR      r0,[r5,#0]  ; ke_date
0000c6  4629              MOV      r1,r5
0000c8  f1040008          ADD      r0,r4,#8
0000cc  f7fffffe          BL       lc640_write_long_ptr
0000d0  f24020a6          MOV      r0,#0x2a6
0000d4  f7fffffe          BL       lc640_read_long
;;;102    	else	   		SET_REG(avar_stat,0,15+i,1);
0000d8  6068              STR      r0,[r5,#4]  ; ke_date
0000da  1d29              ADDS     r1,r5,#4
0000dc  f104000c          ADD      r0,r4,#0xc
0000e0  f7fffffe          BL       lc640_write_long_ptr
0000e4  4d14              LDR      r5,|L2.312|
0000e6  8ba8              LDRH     r0,[r5,#0x1c]         ;99
0000e8  f88d0008          STRB     r0,[sp,#8]            ;99
0000ec  7e28              LDRB     r0,[r5,#0x18]         ;99
0000ee  f88d0009          STRB     r0,[sp,#9]            ;99
;;;103    	}
;;;104    
;;;105    /*for(i=0;i<4;i++)
;;;106    	{
;;;107    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;108    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;109    	}  */
;;;110    for(i=0;i<4;i++)
0000f2  7b28              LDRB     r0,[r5,#0xc]
;;;111    	{
;;;112    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000f4  f88d000a          STRB     r0,[sp,#0xa]
0000f8  f88d600b          STRB     r6,[sp,#0xb]
;;;113    	else	   		SET_REG(avar_stat,0,24+i,1);
0000fc  a902              ADD      r1,sp,#8
0000fe  f1040010          ADD      r0,r4,#0x10
000102  f7fffffe          BL       lc640_write_long_ptr
000106  7a28              LDRB     r0,[r5,#8]
000108  f88d0008          STRB     r0,[sp,#8]
00010c  7928              LDRB     r0,[r5,#4]            ;110
00010e  f88d0009          STRB     r0,[sp,#9]            ;110
000112  7828              LDRB     r0,[r5,#0]            ;110
000114  f88d000a          STRB     r0,[sp,#0xa]          ;110
;;;114    	}
;;;115    
;;;116    //if(uout_av)			SET_REG(avar_stat,1,28,1);
;;;117    //else	   			SET_REG(avar_stat,0,28,1);
;;;118    
;;;119    
;;;120    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000118  f88d600b          STRB     r6,[sp,#0xb]
00011c  a902              ADD      r1,sp,#8
00011e  f1040014          ADD      r0,r4,#0x14
;;;121    
;;;122    avar_ind_stat|=avar_stat_new;
000122  f7fffffe          BL       lc640_write_long_ptr
000126  b005              ADD      sp,sp,#0x14
;;;123    
;;;124    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000128  bdf0              POP      {r4-r7,pc}
;;;125    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
;;;126    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
;;;127    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
;;;128    
;;;129    
;;;130    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
;;;131    
;;;132    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
;;;133    
;;;134    avar_ind_stat&=avar_stat_offed; 
;;;135    
;;;136    avar_stat_old=avar_stat;
;;;137    
;;;138    //oleg_start
;;;139    
;;;140    
;;;141    
;;;142    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
;;;143    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
;;;144    rki_avar1_ind_stat|=rki_avar1_stat_new;
;;;145    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
;;;146    rki_avar1_ind_stat&=rki_avar1_stat_offed;
;;;147    rki_avar1_stat_old=rki_avar1_stat;
;;;148    /*
;;;149    rki_avarI1_stat=status_di1;
;;;150    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
;;;151    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
;;;152    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
;;;153    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
;;;154    rki_avarI1_stat_old=rki_avarI1_stat;
;;;155    
;;;156    rki_avarI2_stat=status_di2;
;;;157    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
;;;158    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
;;;159    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
;;;160    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
;;;161    rki_avarI2_stat_old=rki_avarI2_stat;
;;;162    */
;;;163    //oleg_end
;;;164    }
;;;165    
                          ENDP

00012a  0000              DCW      0x0000
                  |L2.300|
                          DCD      bat
                  |L2.304|
                          DCD      bat_u_old_cnt
                  |L2.308|
                          DCD      ke_date
                  |L2.312|
                          DCD      0x40024020

                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  rki_avar1_stat
                          DCD      0x00000000
                  rki_avar1_ind_stat
                          DCD      0x00000000
                  rki_avar1_stat_old
                          DCD      0x00000000
                  rki_avar1_stat_new
                          DCD      0x00000000
                  rki_avar1_stat_offed
                          DCD      0x00000000
                  av_inv
                          DCD      0x00000000
00002c  0000              DCB      0x00,0x00
