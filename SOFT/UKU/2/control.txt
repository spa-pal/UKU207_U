; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\control.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\control.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DUKU_ZVU --omf_browse=.\EXE\control.crf control.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  bat_flag PROC
;;;326    // заполнение флагов для АКБ
;;;327    void bat_flag (void)
000000  e92d5ff0          PUSH     {r4-r12,lr}
;;;328    {  
;;;329    if(spc_stat!=spcVZ) 
000004  4efd              LDR      r6,|L1.1020|
;;;330    	{
;;;331    	vz_error=0;
000006  2700              MOVS     r7,#0
000008  f8960023          LDRB     r0,[r6,#0x23]         ;329  ; spc_stat
00000c  2802              CMP      r0,#2                 ;329
00000e  d003              BEQ      |L1.24|
000010  7077              STRB     r7,[r6,#1]
;;;332    	sp_ch_error=0;
000012  70b7              STRB     r7,[r6,#2]
;;;333    	vz1_error=0;
000014  70f7              STRB     r7,[r6,#3]
;;;334    	vz2_error=0;
000016  7137              STRB     r7,[r6,#4]
                  |L1.24|
;;;335    	}
;;;336    
;;;337    if( (snmp_bat_status[0]==0 || snmp_bat_status[0]==2) && NUMBAT>0) 	//o_10 	 			//Батарея №1
000018  f8dfb3e4          LDR      r11,|L1.1024|
00001c  f8dfa3e4          LDR      r10,|L1.1028|
;;;338    	{
;;;339    	if((bat[0]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
000020  f8df83e4          LDR      r8,|L1.1032|
000024  f9bb0000          LDRSH    r0,[r11,#0]           ;337  ; snmp_bat_status
;;;340    		{
;;;341    		snmp_bat_flag[0]|=0x0001; 
;;;342    		if((snmp_bat_flag_puts[0]&0x0001)==0) 
;;;343    			{
;;;344    			snmp_trap_send("BAT #1 Alarm, battery is low",5,8,0); 
;;;345    			snmp_bat_flag_puts[0]|=0x0001;
;;;346    			}
;;;347    		}
;;;348    	else 
;;;349    		{
;;;350    		snmp_bat_flag[0]&=~0x0001; 
;;;351    		if(snmp_bat_flag_puts[0]&0x0001) 
;;;352    			{
;;;353    			snmp_trap_send("BAT #1 Alarm clear, battery is not low",5,8,1);
;;;354    			snmp_bat_flag_puts[0]&=~0x0001;
;;;355    			}
;;;356    		}
;;;357    
;;;358    	if(bat[0]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;359    		{
;;;360    		snmp_bat_flag[0]|=0x0002;
;;;361    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;362    			{
;;;363    			//snmp_trap_send("BAT #1 Warning, high battery temperature",5,8,2); 
;;;364    			snmp_bat_flag_puts[0]|=0x0002;
;;;365    			}
;;;366    		}
;;;367    	else 
;;;368    		{
;;;369    		snmp_bat_flag[0]&=~0x0002;
;;;370    		if(snmp_bat_flag_puts[0]&0x0002) 
;;;371    			{
;;;372    			//snmp_trap_send("BAT #1 Warning clear, battery temperature is normal",5,8,3);
;;;373    			snmp_bat_flag_puts[0]&=~0x02;
;;;374    			}
;;;375    		}
;;;376    
;;;377    	if(bat[0]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;378    		{
;;;379    		snmp_bat_flag[0]|=0x0004;
;;;380    		if((snmp_bat_flag_puts[0]&0x0004)==0) 
;;;381    			{
;;;382    			//snmp_trap_send("BAT #1 Alarm, high battery temperature",5,8,4); 
;;;383    			snmp_bat_flag_puts[0]|=0x0004;
;;;384    			}
;;;385    		}
;;;386    	else 
;;;387    		{
;;;388    		snmp_bat_flag[0]&=~0x0004;
;;;389    		if(snmp_bat_flag_puts[0]&0x0004) 
;;;390    			{
;;;391    			//snmp_trap_send("BAT #1 Alarm clear, battery temperature is normal",5,8,5);
;;;392    			snmp_bat_flag_puts[0]&=~0x0004;
;;;393    			}
;;;394    		}
;;;395    
;;;396    	if(bat[0]._Ib<(-IKB)) snmp_bat_flag[0]|=0x0008;		//Разряд батареи
000028  f8df93e0          LDR      r9,|L1.1036|
00002c  4cf8              LDR      r4,|L1.1040|
00002e  4df9              LDR      r5,|L1.1044|
000030  b108              CBZ      r0,|L1.54|
000032  2802              CMP      r0,#2                 ;337
000034  d172              BNE      |L1.284|
                  |L1.54|
000036  f9ba0000          LDRSH    r0,[r10,#0]           ;337  ; NUMBAT
00003a  2800              CMP      r0,#0                 ;337
00003c  dd6e              BLE      |L1.284|
00003e  48f6              LDR      r0,|L1.1048|
000040  f9b82002          LDRSH    r2,[r8,#2]            ;339  ; bat
000044  f9b00000          LDRSH    r0,[r0,#0]            ;339  ; USIGN
000048  eb000380          ADD      r3,r0,r0,LSL #2       ;339
00004c  48f0              LDR      r0,|L1.1040|
00004e  ebb20f43          CMP      r2,r3,LSL #1          ;339
000052  f9b01000          LDRSH    r1,[r0,#0]            ;341
000056  48ef              LDR      r0,|L1.1044|
000058  f9b00000          LDRSH    r0,[r0,#0]            ;342
00005c  da0f              BGE      |L1.126|
00005e  f0410101          ORR      r1,r1,#1              ;341
000062  8021              STRH     r1,[r4,#0]            ;341
000064  07c0              LSLS     r0,r0,#31             ;342
000066  d119              BNE      |L1.156|
000068  2300              MOVS     r3,#0                 ;344
00006a  2208              MOVS     r2,#8                 ;344
00006c  2105              MOVS     r1,#5                 ;344
00006e  a0eb              ADR      r0,|L1.1052|
000070  f7fffffe          BL       snmp_trap_send
000074  8828              LDRH     r0,[r5,#0]            ;345  ; snmp_bat_flag_puts
000076  f0400001          ORR      r0,r0,#1              ;345
00007a  8028              STRH     r0,[r5,#0]            ;345
00007c  e00e              B        |L1.156|
                  |L1.126|
00007e  f0210101          BIC      r1,r1,#1              ;350
000082  8021              STRH     r1,[r4,#0]            ;350
000084  07c0              LSLS     r0,r0,#31             ;351
000086  d009              BEQ      |L1.156|
000088  2301              MOVS     r3,#1                 ;353
00008a  2208              MOVS     r2,#8                 ;353
00008c  2105              MOVS     r1,#5                 ;353
00008e  a0eb              ADR      r0,|L1.1084|
000090  f7fffffe          BL       snmp_trap_send
000094  8828              LDRH     r0,[r5,#0]            ;354  ; snmp_bat_flag_puts
000096  f0200001          BIC      r0,r0,#1              ;354
00009a  8028              STRH     r0,[r5,#0]            ;354
                  |L1.156|
00009c  f898003f          LDRB     r0,[r8,#0x3f]         ;358  ; bat
0000a0  07c1              LSLS     r1,r0,#31             ;358
0000a2  d00b              BEQ      |L1.188|
0000a4  8821              LDRH     r1,[r4,#0]            ;360  ; snmp_bat_flag
0000a6  f0410102          ORR      r1,r1,#2              ;360
0000aa  8021              STRH     r1,[r4,#0]            ;360
0000ac  f9b51000          LDRSH    r1,[r5,#0]            ;361  ; snmp_bat_flag_puts
0000b0  078a              LSLS     r2,r1,#30             ;361
0000b2  d40e              BMI      |L1.210|
0000b4  f0410102          ORR      r1,r1,#2              ;364
0000b8  8029              STRH     r1,[r5,#0]            ;364
0000ba  e00a              B        |L1.210|
                  |L1.188|
0000bc  8821              LDRH     r1,[r4,#0]            ;369  ; snmp_bat_flag
0000be  f0210102          BIC      r1,r1,#2              ;369
0000c2  8021              STRH     r1,[r4,#0]            ;369
0000c4  f9b51000          LDRSH    r1,[r5,#0]            ;370  ; snmp_bat_flag_puts
0000c8  078a              LSLS     r2,r1,#30             ;370
0000ca  d502              BPL      |L1.210|
0000cc  f0210102          BIC      r1,r1,#2              ;373
0000d0  8029              STRH     r1,[r5,#0]            ;373
                  |L1.210|
0000d2  0780              LSLS     r0,r0,#30             ;377
0000d4  d50b              BPL      |L1.238|
0000d6  8820              LDRH     r0,[r4,#0]            ;379  ; snmp_bat_flag
0000d8  f0400004          ORR      r0,r0,#4              ;379
0000dc  8020              STRH     r0,[r4,#0]            ;379
0000de  f9b50000          LDRSH    r0,[r5,#0]            ;380  ; snmp_bat_flag_puts
0000e2  0741              LSLS     r1,r0,#29             ;380
0000e4  d40e              BMI      |L1.260|
0000e6  f0400004          ORR      r0,r0,#4              ;383
0000ea  8028              STRH     r0,[r5,#0]            ;383
0000ec  e00a              B        |L1.260|
                  |L1.238|
0000ee  8820              LDRH     r0,[r4,#0]            ;388  ; snmp_bat_flag
0000f0  f0200004          BIC      r0,r0,#4              ;388
0000f4  8020              STRH     r0,[r4,#0]            ;388
0000f6  f9b50000          LDRSH    r0,[r5,#0]            ;389  ; snmp_bat_flag_puts
0000fa  0741              LSLS     r1,r0,#29             ;389
0000fc  d502              BPL      |L1.260|
0000fe  f0200004          BIC      r0,r0,#4              ;392
000102  8028              STRH     r0,[r5,#0]            ;392
                  |L1.260|
000104  f9b91000          LDRSH    r1,[r9,#0]  ; IKB
000108  f9b80008          LDRSH    r0,[r8,#8]  ; bat
00010c  424a              RSBS     r2,r1,#0
00010e  4290              CMP      r0,r2
000110  da05              BGE      |L1.286|
000112  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
000114  f0400008          ORR      r0,r0,#8
000118  8020              STRH     r0,[r4,#0]
00011a  e006              B        |L1.298|
                  |L1.284|
00011c  e15e              B        |L1.988|
                  |L1.286|
;;;397    	else if(bat[0]._Ib>IKB) snmp_bat_flag[0]&=~0x0008;	//Заряд батареи
00011e  4288              CMP      r0,r1
000120  dd03              BLE      |L1.298|
000122  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
000124  f0200008          BIC      r0,r0,#8
000128  8020              STRH     r0,[r4,#0]
                  |L1.298|
;;;398    
;;;399    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
00012a  f8960023          LDRB     r0,[r6,#0x23]  ; spc_stat
00012e  2801              CMP      r0,#1
000130  d103              BNE      |L1.314|
000132  f8960024          LDRB     r0,[r6,#0x24]  ; spc_bat
000136  2800              CMP      r0,#0
000138  d03a              BEQ      |L1.432|
                  |L1.314|
;;;400    		{
;;;401    		snmp_bat_flag[0]|=0x0010;
;;;402    		if((snmp_bat_flag_puts[0]&0x0010)==0) 
;;;403    			{
;;;404    			snmp_trap_send("BAT #1, capacity test started",5,8,6); 
;;;405    			snmp_bat_flag_puts[0]|=0x0010;
;;;406    			}
;;;407    		}
;;;408    	else 
;;;409    		{
;;;410    		snmp_bat_flag[0]&=~0x0010;
00013a  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
00013c  f0200010          BIC      r0,r0,#0x10
000140  8020              STRH     r0,[r4,#0]
;;;411    		if(snmp_bat_flag_puts[0]&0x0010) 
000142  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
000144  06c0              LSLS     r0,r0,#27
000146  d509              BPL      |L1.348|
;;;412    			{
;;;413    			snmp_trap_send("BAT #1, capacity test stopped",5,8,7);
000148  2307              MOVS     r3,#7
00014a  2208              MOVS     r2,#8
00014c  2105              MOVS     r1,#5
00014e  a0c5              ADR      r0,|L1.1124|
000150  f7fffffe          BL       snmp_trap_send
;;;414    			snmp_bat_flag_puts[0]&=~0x0010;
000154  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
000156  f0200010          BIC      r0,r0,#0x10
00015a  8028              STRH     r0,[r5,#0]
                  |L1.348|
;;;415    			}
;;;416    		}
;;;417    		
;;;418    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
00015c  f8960023          LDRB     r0,[r6,#0x23]  ; spc_stat
000160  2802              CMP      r0,#2
000162  d037              BEQ      |L1.468|
;;;419    		{
;;;420    		snmp_bat_flag[0]|=0x0020;
;;;421    		if((snmp_bat_flag_puts[0]&0x0020)==0) 
;;;422    			{
;;;423    			snmp_trap_send("BAT #1,leveling charge is started",5,8,8); 
;;;424    			snmp_bat_flag_puts[0]|=0x0020;
;;;425    			}
;;;426    		}
;;;427    	else 
;;;428    		{
;;;429    		snmp_bat_flag[0]&=~0x0020;
000164  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
000166  f0200020          BIC      r0,r0,#0x20
00016a  8020              STRH     r0,[r4,#0]
;;;430    		if(snmp_bat_flag_puts[0]&0x0020) 
00016c  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
00016e  0680              LSLS     r0,r0,#26
000170  d509              BPL      |L1.390|
;;;431    			{
;;;432    			snmp_trap_send("BAT #1,leveling charge is stopped",5,8,9);
000172  2309              MOVS     r3,#9
000174  2208              MOVS     r2,#8
000176  2105              MOVS     r1,#5
000178  a0c2              ADR      r0,|L1.1156|
00017a  f7fffffe          BL       snmp_trap_send
;;;433    			snmp_bat_flag_puts[0]&=~0x0020;
00017e  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
000180  f0200020          BIC      r0,r0,#0x20
000184  8028              STRH     r0,[r5,#0]
                  |L1.390|
;;;434    			}
;;;435    		}
;;;436    
;;;437    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
000186  7870              LDRB     r0,[r6,#1]  ; vz_error
000188  2800              CMP      r0,#0
00018a  d035              BEQ      |L1.504|
;;;438    		{
;;;439    		snmp_bat_flag[0]|=0x0040;
00018c  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
00018e  f0400040          ORR      r0,r0,#0x40
000192  8020              STRH     r0,[r4,#0]
;;;440    		if((snmp_bat_flag_puts[0]&0x0040)==0) 
000194  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
000196  0640              LSLS     r0,r0,#25
000198  d43f              BMI      |L1.538|
;;;441    			{
;;;442    			snmp_trap_send("BAT #1,leveling charge is blocked",5,8,10); 
00019a  230a              MOVS     r3,#0xa
00019c  2208              MOVS     r2,#8
00019e  2105              MOVS     r1,#5
0001a0  a0c1              ADR      r0,|L1.1192|
0001a2  f7fffffe          BL       snmp_trap_send
;;;443    			snmp_bat_flag_puts[0]|=0x0040;
0001a6  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
0001a8  f0400040          ORR      r0,r0,#0x40
0001ac  8028              STRH     r0,[r5,#0]
0001ae  e034              B        |L1.538|
                  |L1.432|
0001b0  8820              LDRH     r0,[r4,#0]            ;401  ; snmp_bat_flag
0001b2  f0400010          ORR      r0,r0,#0x10           ;401
0001b6  8020              STRH     r0,[r4,#0]            ;401
0001b8  8828              LDRH     r0,[r5,#0]            ;402  ; snmp_bat_flag_puts
0001ba  06c0              LSLS     r0,r0,#27             ;402
0001bc  d4ce              BMI      |L1.348|
0001be  2306              MOVS     r3,#6                 ;404
0001c0  2208              MOVS     r2,#8                 ;404
0001c2  2105              MOVS     r1,#5                 ;404
0001c4  a0c1              ADR      r0,|L1.1228|
0001c6  f7fffffe          BL       snmp_trap_send
0001ca  8828              LDRH     r0,[r5,#0]            ;405  ; snmp_bat_flag_puts
0001cc  f0400010          ORR      r0,r0,#0x10           ;405
0001d0  8028              STRH     r0,[r5,#0]            ;405
0001d2  e7c3              B        |L1.348|
                  |L1.468|
0001d4  8820              LDRH     r0,[r4,#0]            ;420  ; snmp_bat_flag
0001d6  f0400020          ORR      r0,r0,#0x20           ;420
0001da  8020              STRH     r0,[r4,#0]            ;420
0001dc  8828              LDRH     r0,[r5,#0]            ;421  ; snmp_bat_flag_puts
0001de  0680              LSLS     r0,r0,#26             ;421
0001e0  d4d1              BMI      |L1.390|
0001e2  2308              MOVS     r3,#8                 ;423
0001e4  461a              MOV      r2,r3                 ;423
0001e6  2105              MOVS     r1,#5                 ;423
0001e8  a0c0              ADR      r0,|L1.1260|
0001ea  f7fffffe          BL       snmp_trap_send
0001ee  8828              LDRH     r0,[r5,#0]            ;424  ; snmp_bat_flag_puts
0001f0  f0400020          ORR      r0,r0,#0x20           ;424
0001f4  8028              STRH     r0,[r5,#0]            ;424
0001f6  e7c6              B        |L1.390|
                  |L1.504|
;;;444    			}
;;;445    		}
;;;446    	else 
;;;447    		{
;;;448    		snmp_bat_flag[0]&=~0x0040;
0001f8  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
0001fa  f0200040          BIC      r0,r0,#0x40
0001fe  8020              STRH     r0,[r4,#0]
;;;449    		if(snmp_bat_flag_puts[0]&0x0040) 
000200  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
000202  0640              LSLS     r0,r0,#25
000204  d509              BPL      |L1.538|
;;;450    			{
;;;451    			snmp_trap_send("BAT #1,leveling charge is unblocked",5,8,11);
000206  230b              MOVS     r3,#0xb
000208  2208              MOVS     r2,#8
00020a  2105              MOVS     r1,#5
00020c  a0c0              ADR      r0,|L1.1296|
00020e  f7fffffe          BL       snmp_trap_send
;;;452    			snmp_bat_flag_puts[0]&=~0x0040;
000212  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
000214  f0200040          BIC      r0,r0,#0x40
000218  8028              STRH     r0,[r5,#0]
                  |L1.538|
;;;453    			} 
;;;454    		}
;;;455    
;;;456    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
00021a  48c6              LDR      r0,|L1.1332|
00021c  7800              LDRB     r0,[r0,#0]  ; sp_ch_stat
00021e  2802              CMP      r0,#2
000220  d024              BEQ      |L1.620|
;;;457    		{
;;;458    		snmp_bat_flag[0]|=0x0080;
;;;459    		if((snmp_bat_flag_puts[0]&0x0080)==0) 
;;;460    			{
;;;461    			snmp_trap_send("BAT #1,speed charge is started",5,8,10); 
;;;462    			snmp_bat_flag_puts[0]|=0x0080;
;;;463    			}
;;;464    		}
;;;465    	else 
;;;466    		{
;;;467    		snmp_bat_flag[0]&=~0x0080;
000222  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
000224  f0200080          BIC      r0,r0,#0x80
000228  8020              STRH     r0,[r4,#0]
;;;468    		if(snmp_bat_flag_puts[0]&0x0080) 
00022a  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
00022c  0600              LSLS     r0,r0,#24
00022e  d509              BPL      |L1.580|
;;;469    			{
;;;470    			snmp_trap_send("BAT #1,speed charge is stopped",5,8,11);
000230  230b              MOVS     r3,#0xb
000232  2208              MOVS     r2,#8
000234  2105              MOVS     r1,#5
000236  a0c0              ADR      r0,|L1.1336|
000238  f7fffffe          BL       snmp_trap_send
;;;471    			snmp_bat_flag_puts[0]&=~0x0080;
00023c  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
00023e  f0200080          BIC      r0,r0,#0x80
000242  8028              STRH     r0,[r5,#0]
                  |L1.580|
;;;472    			}
;;;473    		}
;;;474    
;;;475    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
000244  78b0              LDRB     r0,[r6,#2]  ; sp_ch_error
000246  b318              CBZ      r0,|L1.656|
;;;476    		{
;;;477    		snmp_bat_flag[0]|=0x0100;
000248  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
00024a  f4407080          ORR      r0,r0,#0x100
00024e  8020              STRH     r0,[r4,#0]
;;;478    		if((snmp_bat_flag_puts[0]&0x0100)==0) 
000250  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
000252  05c0              LSLS     r0,r0,#23
000254  d42d              BMI      |L1.690|
;;;479    			{
;;;480    			snmp_trap_send("BAT #1,speed charge is blocked",5,8,12); 
000256  230c              MOVS     r3,#0xc
000258  2208              MOVS     r2,#8
00025a  2105              MOVS     r1,#5
00025c  a0be              ADR      r0,|L1.1368|
00025e  f7fffffe          BL       snmp_trap_send
;;;481    			snmp_bat_flag_puts[0]|=0x0100;
000262  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
000264  f4407080          ORR      r0,r0,#0x100
000268  8028              STRH     r0,[r5,#0]
00026a  e022              B        |L1.690|
                  |L1.620|
00026c  8820              LDRH     r0,[r4,#0]            ;458  ; snmp_bat_flag
00026e  f0400080          ORR      r0,r0,#0x80           ;458
000272  8020              STRH     r0,[r4,#0]            ;458
000274  8828              LDRH     r0,[r5,#0]            ;459  ; snmp_bat_flag_puts
000276  0600              LSLS     r0,r0,#24             ;459
000278  d4e4              BMI      |L1.580|
00027a  230a              MOVS     r3,#0xa               ;461
00027c  2208              MOVS     r2,#8                 ;461
00027e  2105              MOVS     r1,#5                 ;461
000280  a0bd              ADR      r0,|L1.1400|
000282  f7fffffe          BL       snmp_trap_send
000286  8828              LDRH     r0,[r5,#0]            ;462  ; snmp_bat_flag_puts
000288  f0400080          ORR      r0,r0,#0x80           ;462
00028c  8028              STRH     r0,[r5,#0]            ;462
00028e  e7d9              B        |L1.580|
                  |L1.656|
;;;482    			}
;;;483    		}
;;;484    	else 
;;;485    		{
;;;486    		snmp_bat_flag[0]&=~0x0100;
000290  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
000292  f4207080          BIC      r0,r0,#0x100
000296  8020              STRH     r0,[r4,#0]
;;;487    		if(snmp_bat_flag_puts[0]&0x0100) 
000298  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
00029a  05c0              LSLS     r0,r0,#23
00029c  d509              BPL      |L1.690|
;;;488    			{
;;;489    			snmp_trap_send("BAT #1,speed charge is unblocked",5,8,13);
00029e  230d              MOVS     r3,#0xd
0002a0  2208              MOVS     r2,#8
0002a2  2105              MOVS     r1,#5
0002a4  a0bc              ADR      r0,|L1.1432|
0002a6  f7fffffe          BL       snmp_trap_send
;;;490    			snmp_bat_flag_puts[0]&=~0x0100;
0002aa  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
0002ac  f4207080          BIC      r0,r0,#0x100
0002b0  8028              STRH     r0,[r5,#0]
                  |L1.690|
;;;491    			} 
;;;492    		}
;;;493    
;;;494    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
0002b2  7970              LDRB     r0,[r6,#5]  ; vz1_stat
0002b4  b188              CBZ      r0,|L1.730|
;;;495    		{
;;;496    		snmp_bat_flag[0]|=0x0200;
0002b6  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
0002b8  f4407000          ORR      r0,r0,#0x200
0002bc  8020              STRH     r0,[r4,#0]
;;;497    		if((snmp_bat_flag_puts[0]&0x0200)==0) 
0002be  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
0002c0  0580              LSLS     r0,r0,#22
0002c2  d41b              BMI      |L1.764|
;;;498    			{
;;;499    			snmp_trap_send("BAT #1,equalising charge is on",5,8,14); 
0002c4  230e              MOVS     r3,#0xe
0002c6  2208              MOVS     r2,#8
0002c8  2105              MOVS     r1,#5
0002ca  a0bc              ADR      r0,|L1.1468|
0002cc  f7fffffe          BL       snmp_trap_send
;;;500    			snmp_bat_flag_puts[0]|=0x0200;
0002d0  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
0002d2  f4407000          ORR      r0,r0,#0x200
0002d6  8028              STRH     r0,[r5,#0]
0002d8  e010              B        |L1.764|
                  |L1.730|
;;;501    			}
;;;502    		}
;;;503    	else 
;;;504    		{
;;;505    		snmp_bat_flag[0]&=~0x0200;
0002da  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
0002dc  f4207000          BIC      r0,r0,#0x200
0002e0  8020              STRH     r0,[r4,#0]
;;;506    		if(snmp_bat_flag_puts[0]&0x0200) 
0002e2  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
0002e4  0580              LSLS     r0,r0,#22
0002e6  d509              BPL      |L1.764|
;;;507    			{
;;;508    			snmp_trap_send("BAT #1,equalising charge is off",5,8,15);
0002e8  230f              MOVS     r3,#0xf
0002ea  2208              MOVS     r2,#8
0002ec  2105              MOVS     r1,#5
0002ee  a0bb              ADR      r0,|L1.1500|
0002f0  f7fffffe          BL       snmp_trap_send
;;;509    			snmp_bat_flag_puts[0]&=~0x0200;
0002f4  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
0002f6  f4207000          BIC      r0,r0,#0x200
0002fa  8028              STRH     r0,[r5,#0]
                  |L1.764|
;;;510    			}
;;;511    		}
;;;512    
;;;513    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
0002fc  78f0              LDRB     r0,[r6,#3]  ; vz1_error
0002fe  b188              CBZ      r0,|L1.804|
;;;514    		{
;;;515    		snmp_bat_flag[0]|=0x0400;
000300  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
000302  f4406080          ORR      r0,r0,#0x400
000306  8020              STRH     r0,[r4,#0]
;;;516    		if((snmp_bat_flag_puts[0]&0x0400)==0) 
000308  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
00030a  0540              LSLS     r0,r0,#21
00030c  d41b              BMI      |L1.838|
;;;517    			{
;;;518    			snmp_trap_send("BAT #1,equalising charge is blocked",5,8,16); 
00030e  2310              MOVS     r3,#0x10
000310  2208              MOVS     r2,#8
000312  2105              MOVS     r1,#5
000314  a0b9              ADR      r0,|L1.1532|
000316  f7fffffe          BL       snmp_trap_send
;;;519    			snmp_bat_flag_puts[0]|=0x0400;
00031a  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
00031c  f4406080          ORR      r0,r0,#0x400
000320  8028              STRH     r0,[r5,#0]
000322  e010              B        |L1.838|
                  |L1.804|
;;;520    			}
;;;521    		}
;;;522    	else 
;;;523    		{
;;;524    		snmp_bat_flag[0]&=~0x0400;
000324  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
000326  f4206080          BIC      r0,r0,#0x400
00032a  8020              STRH     r0,[r4,#0]
;;;525    		if(snmp_bat_flag_puts[0]&0x0400) 
00032c  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
00032e  0540              LSLS     r0,r0,#21
000330  d509              BPL      |L1.838|
;;;526    			{
;;;527    			snmp_trap_send("BAT #1,equalising charge is unblocked",5,8,17);
000332  2311              MOVS     r3,#0x11
000334  2208              MOVS     r2,#8
000336  2105              MOVS     r1,#5
000338  a0b9              ADR      r0,|L1.1568|
00033a  f7fffffe          BL       snmp_trap_send
;;;528    			snmp_bat_flag_puts[0]&=~0x0400;
00033e  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
000340  f4206080          BIC      r0,r0,#0x400
000344  8028              STRH     r0,[r5,#0]
                  |L1.838|
;;;529    			} 
;;;530    		}
;;;531    
;;;532    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
000346  79f0              LDRB     r0,[r6,#7]  ; vz2_stat
000348  b188              CBZ      r0,|L1.878|
;;;533    		{
;;;534    		snmp_bat_flag[0]|=0x0800;
00034a  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
00034c  f4406000          ORR      r0,r0,#0x800
000350  8020              STRH     r0,[r4,#0]
;;;535    		if((snmp_bat_flag_puts[0]&0x0800)==0) 
000352  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
000354  0500              LSLS     r0,r0,#20
000356  d41b              BMI      |L1.912|
;;;536    			{
;;;537    			snmp_trap_send("BAT #1,molding charge is on",5,8,18); 
000358  2312              MOVS     r3,#0x12
00035a  2208              MOVS     r2,#8
00035c  2105              MOVS     r1,#5
00035e  a0ba              ADR      r0,|L1.1608|
000360  f7fffffe          BL       snmp_trap_send
;;;538    			snmp_bat_flag_puts[0]|=0x0800;
000364  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
000366  f4406000          ORR      r0,r0,#0x800
00036a  8028              STRH     r0,[r5,#0]
00036c  e010              B        |L1.912|
                  |L1.878|
;;;539    			}
;;;540    		}
;;;541    	else 
;;;542    		{
;;;543    		snmp_bat_flag[0]&=~0x0800;
00036e  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
000370  f4206000          BIC      r0,r0,#0x800
000374  8020              STRH     r0,[r4,#0]
;;;544    		if(snmp_bat_flag_puts[0]&0x0800) 
000376  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
000378  0500              LSLS     r0,r0,#20
00037a  d509              BPL      |L1.912|
;;;545    			{
;;;546    			snmp_trap_send("BAT #1,molding charge is off",5,8,19);
00037c  2313              MOVS     r3,#0x13
00037e  2208              MOVS     r2,#8
000380  2105              MOVS     r1,#5
000382  a0b8              ADR      r0,|L1.1636|
000384  f7fffffe          BL       snmp_trap_send
;;;547    			snmp_bat_flag_puts[0]&=~0x0800;
000388  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
00038a  f4206000          BIC      r0,r0,#0x800
00038e  8028              STRH     r0,[r5,#0]
                  |L1.912|
;;;548    			}
;;;549    		}
;;;550    
;;;551    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
000390  7930              LDRB     r0,[r6,#4]  ; vz2_error
000392  b188              CBZ      r0,|L1.952|
;;;552    		{
;;;553    		snmp_bat_flag[0]|=0x1000;
000394  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
000396  f4405080          ORR      r0,r0,#0x1000
00039a  8020              STRH     r0,[r4,#0]
;;;554    		if((snmp_bat_flag_puts[0]&0x1000)==0) 
00039c  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
00039e  04c0              LSLS     r0,r0,#19
0003a0  d41e              BMI      |L1.992|
;;;555    			{
;;;556    			snmp_trap_send("BAT #1,molding charge is blocked",5,8,20); 
0003a2  2314              MOVS     r3,#0x14
0003a4  2208              MOVS     r2,#8
0003a6  2105              MOVS     r1,#5
0003a8  a0b6              ADR      r0,|L1.1668|
0003aa  f7fffffe          BL       snmp_trap_send
;;;557    			snmp_bat_flag_puts[0]|=0x1000;
0003ae  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
0003b0  f4405080          ORR      r0,r0,#0x1000
0003b4  8028              STRH     r0,[r5,#0]
0003b6  e013              B        |L1.992|
                  |L1.952|
;;;558    			}
;;;559    		}
;;;560    	else 
;;;561    		{
;;;562    		snmp_bat_flag[0]&=~0x1000;
0003b8  8820              LDRH     r0,[r4,#0]  ; snmp_bat_flag
0003ba  f4205080          BIC      r0,r0,#0x1000
0003be  8020              STRH     r0,[r4,#0]
;;;563    		if(snmp_bat_flag_puts[0]&0x1000) 
0003c0  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
0003c2  04c0              LSLS     r0,r0,#19
0003c4  d50c              BPL      |L1.992|
;;;564    			{
;;;565    			snmp_trap_send("BAT #1,molding charge is unblocked",5,8,21);
0003c6  2315              MOVS     r3,#0x15
0003c8  2208              MOVS     r2,#8
0003ca  2105              MOVS     r1,#5
0003cc  a0b6              ADR      r0,|L1.1704|
0003ce  f7fffffe          BL       snmp_trap_send
;;;566    			snmp_bat_flag_puts[0]&=~0x1000;
0003d2  8828              LDRH     r0,[r5,#0]  ; snmp_bat_flag_puts
0003d4  f4205080          BIC      r0,r0,#0x1000
0003d8  8028              STRH     r0,[r5,#0]
0003da  e001              B        |L1.992|
                  |L1.988|
;;;567    			} 
;;;568    		}
;;;569    	}
;;;570    else 
;;;571    	{
;;;572    	snmp_bat_flag[0]=0; 
0003dc  8027              STRH     r7,[r4,#0]
;;;573    	snmp_bat_flag_puts[0]=0;
0003de  802f              STRH     r7,[r5,#0]
                  |L1.992|
;;;574    	}
;;;575    
;;;576    if( (snmp_bat_status[1]==0 || snmp_bat_status[1]==2) && NUMBAT==2 )	//o_10 
0003e0  f9bb0002          LDRSH    r0,[r11,#2]  ; snmp_bat_status
0003e4  b108              CBZ      r0,|L1.1002|
0003e6  2802              CMP      r0,#2
0003e8  d103              BNE      |L1.1010|
                  |L1.1002|
0003ea  f8ba0000          LDRH     r0,[r10,#0]  ; NUMBAT
0003ee  2802              CMP      r0,#2
0003f0  d003              BEQ      |L1.1018|
                  |L1.1010|
;;;577    	{
;;;578    	if((bat[1]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
;;;579    		{
;;;580    		snmp_bat_flag[1]|=0x0001; 
;;;581    		if((snmp_bat_flag_puts[1]&0x0001)==0) 
;;;582    			{
;;;583    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,22); 
;;;584    			snmp_bat_flag_puts[1]|=0x0001;
;;;585    			}
;;;586    		}
;;;587    	else 
;;;588    		{
;;;589    		snmp_bat_flag[1]&=~0x0001; 
;;;590    		if(snmp_bat_flag_puts[1]&0x0001) 
;;;591    			{
;;;592    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,23);
;;;593    			snmp_bat_flag_puts[1]&=~0x0001;
;;;594    			}
;;;595    		}
;;;596    
;;;597    	if(bat[1]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;598    		{
;;;599    		snmp_bat_flag[1]|=0x0002;
;;;600    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;601    			{
;;;602    			//snmp_trap_send("BAT #2 Warning, high battery temperature",5,8,24); 
;;;603    			snmp_bat_flag_puts[1]|=0x0002;
;;;604    			}
;;;605    		}
;;;606    	else 
;;;607    		{
;;;608    		snmp_bat_flag[1]&=~0x0002;
;;;609    		if(snmp_bat_flag_puts[1]&0x0002) 
;;;610    			{
;;;611    			//snmp_trap_send("BAT #2 Warning clear, battery temperature is normal",5,8,25);
;;;612    			snmp_bat_flag_puts[1]&=~0x02;
;;;613    			}
;;;614    		}
;;;615    
;;;616    	if(bat[1]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;617    		{
;;;618    		snmp_bat_flag[1]|=0x0004;
;;;619    		if((snmp_bat_flag_puts[1]&0x0004)==0) 
;;;620    			{
;;;621    			//snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,26); 
;;;622    			snmp_bat_flag_puts[1]|=0x0004;
;;;623    			}
;;;624    		}
;;;625    	else 
;;;626    		{
;;;627    		snmp_bat_flag[1]&=~0x0004;
;;;628    		if(snmp_bat_flag_puts[1]&0x0004) 
;;;629    			{
;;;630    			//snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,27);
;;;631    			snmp_bat_flag_puts[1]&=~0x0004;
;;;632    			}
;;;633    		}
;;;634    
;;;635    	if(bat[1]._Ib<(-IKB)) snmp_bat_flag[1]|=0x0008;		//Разряд батареи
;;;636    	else if(bat[1]._Ib>IKB) snmp_bat_flag[1]&=~0x0008;	//Заряд батареи
;;;637    
;;;638    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
;;;639    		{
;;;640    		snmp_bat_flag[1]|=0x0010;
;;;641    		if((snmp_bat_flag_puts[1]&0x0010)==0) 
;;;642    			{
;;;643    			snmp_trap_send("BAT #2, capacity test started",5,8,28); 
;;;644    			snmp_bat_flag_puts[1]|=0x0010;
;;;645    			}
;;;646    		}
;;;647    	else 
;;;648    		{
;;;649    		snmp_bat_flag[1]&=~0x0010;
;;;650    		if(snmp_bat_flag_puts[1]&0x0010) 
;;;651    			{
;;;652    			snmp_trap_send("BAT #2, capacity test stopped",5,8,29);
;;;653    			snmp_bat_flag_puts[1]&=~0x0010;
;;;654    			}
;;;655    		}
;;;656    		
;;;657    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
;;;658    		{
;;;659    		snmp_bat_flag[1]|=0x0020;
;;;660    		if((snmp_bat_flag_puts[1]&0x0020)==0) 
;;;661    			{
;;;662    			snmp_trap_send("BAT #2,leveling charge is started",5,8,30); 
;;;663    			snmp_bat_flag_puts[1]|=0x0020;
;;;664    			}
;;;665    		}
;;;666    	else 
;;;667    		{
;;;668    		snmp_bat_flag[1]&=~0x0020;
;;;669    		if(snmp_bat_flag_puts[1]&0x0020) 
;;;670    			{
;;;671    			snmp_trap_send("BAT #2,leveling charge is stopped",5,8,31);
;;;672    			snmp_bat_flag_puts[1]&=~0x0020;
;;;673    			}
;;;674    		}
;;;675    
;;;676    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
;;;677    		{
;;;678    		snmp_bat_flag[1]|=0x0040;
;;;679    		if((snmp_bat_flag_puts[1]&0x0040)==0) 
;;;680    			{
;;;681    			snmp_trap_send("BAT #2,leveling charge is blocked",5,8,32); 
;;;682    			snmp_bat_flag_puts[1]|=0x0040;
;;;683    			}
;;;684    		}
;;;685    	else 
;;;686    		{
;;;687    		snmp_bat_flag[1]&=~0x0040;
;;;688    		if(snmp_bat_flag_puts[1]&0x0040) 
;;;689    			{
;;;690    			snmp_trap_send("BAT #2,leveling charge is unblocked",5,8,33);
;;;691    			snmp_bat_flag_puts[1]&=~0x0040;
;;;692    			} 
;;;693    		}
;;;694    
;;;695    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
;;;696    		{
;;;697    		snmp_bat_flag[1]|=0x0080;
;;;698    		if((snmp_bat_flag_puts[1]&0x0080)==0) 
;;;699    			{
;;;700    			snmp_trap_send("BAT #2,speed charge is started",5,8,34); 
;;;701    			snmp_bat_flag_puts[1]|=0x0080;
;;;702    			}
;;;703    		}
;;;704    	else 
;;;705    		{
;;;706    		snmp_bat_flag[1]&=~0x0080;
;;;707    		if(snmp_bat_flag_puts[1]&0x0080) 
;;;708    			{
;;;709    			snmp_trap_send("BAT #2,speed charge is stopped",5,8,35);
;;;710    			snmp_bat_flag_puts[1]&=~0x0080;
;;;711    			}
;;;712    		}
;;;713    
;;;714    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
;;;715    		{
;;;716    		snmp_bat_flag[1]|=0x0100;
;;;717    		if((snmp_bat_flag_puts[1]&0x0100)==0) 
;;;718    			{
;;;719    			snmp_trap_send("BAT #2,speed charge is blocked",5,8,36); 
;;;720    			snmp_bat_flag_puts[1]|=0x0100;
;;;721    			}
;;;722    		}
;;;723    	else 
;;;724    		{
;;;725    		snmp_bat_flag[1]&=~0x0100;
;;;726    		if(snmp_bat_flag_puts[1]&0x0100) 
;;;727    			{
;;;728    			snmp_trap_send("BAT #2,speed charge is unblocked",5,8,37);
;;;729    			snmp_bat_flag_puts[1]&=~0x0100;
;;;730    			} 
;;;731    		}
;;;732    
;;;733    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;734    		{
;;;735    		snmp_bat_flag[1]|=0x0200;
;;;736    		if((snmp_bat_flag_puts[1]&0x0200)==0) 
;;;737    			{
;;;738    			snmp_trap_send("BAT #2,equalising charge is on",5,8,38); 
;;;739    			snmp_bat_flag_puts[1]|=0x0200;
;;;740    			}
;;;741    		}
;;;742    	else 
;;;743    		{
;;;744    		snmp_bat_flag[1]&=~0x0200;
;;;745    		if(snmp_bat_flag_puts[1]&0x0200) 
;;;746    			{
;;;747    			snmp_trap_send("BAT #2,equalising charge is off",5,8,39);
;;;748    			snmp_bat_flag_puts[1]&=~0x0200;
;;;749    			}
;;;750    		}
;;;751    
;;;752    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;753    		{
;;;754    		snmp_bat_flag[1]|=0x0400;
;;;755    		if((snmp_bat_flag_puts[1]&0x0400)==0) 
;;;756    			{
;;;757    			snmp_trap_send("BAT #2,equalising charge is blocked",5,8,40); 
;;;758    			snmp_bat_flag_puts[1]|=0x0400;
;;;759    			}
;;;760    		}
;;;761    	else 
;;;762    		{
;;;763    		snmp_bat_flag[1]&=~0x0400;
;;;764    		if(snmp_bat_flag_puts[1]&0x0400) 
;;;765    			{
;;;766    			snmp_trap_send("BAT #2,equalising charge is unblocked",5,8,41);
;;;767    			snmp_bat_flag_puts[1]&=~0x0400;
;;;768    			} 
;;;769    		}
;;;770    
;;;771    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;772    		{
;;;773    		snmp_bat_flag[1]|=0x0800;
;;;774    		if((snmp_bat_flag_puts[1]&0x0800)==0) 
;;;775    			{
;;;776    			snmp_trap_send("BAT #2,molding charge is on",5,8,42); 
;;;777    			snmp_bat_flag_puts[1]|=0x0800;
;;;778    			}
;;;779    		}
;;;780    	else 
;;;781    		{
;;;782    		snmp_bat_flag[1]&=~0x0800;
;;;783    		if(snmp_bat_flag_puts[1]&0x0800) 
;;;784    			{
;;;785    			snmp_trap_send("BAT #2,molding charge is off",5,8,43);
;;;786    			snmp_bat_flag_puts[1]&=~0x0800;
;;;787    			}
;;;788    		}
;;;789    
;;;790    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;791    		{
;;;792    		snmp_bat_flag[1]|=0x1000;
;;;793    		if((snmp_bat_flag_puts[1]&0x1000)==0) 
;;;794    			{
;;;795    			snmp_trap_send("BAT #2,molding charge is blocked",5,8,44); 
;;;796    			snmp_bat_flag_puts[1]|=0x1000;
;;;797    			}
;;;798    		}
;;;799    	else 
;;;800    		{
;;;801    		snmp_bat_flag[1]&=~0x1000;
;;;802    		if(snmp_bat_flag_puts[1]&0x1000) 
;;;803    			{
;;;804    			snmp_trap_send("BAT #2,molding charge is unblocked",5,8,45);
;;;805    			snmp_bat_flag_puts[1]&=~0x1000;
;;;806    			} 
;;;807    		}
;;;808    	}
;;;809    else 
;;;810    	{
;;;811    	snmp_bat_flag[1]=0; 
0003f2  8067              STRH     r7,[r4,#2]
;;;812    	snmp_bat_flag_puts[1]=0;
0003f4  806f              STRH     r7,[r5,#2]
                  |L1.1014|
;;;813    	}
;;;814    /*
;;;815    if(!snmp_bat_status[1])
;;;816    	{
;;;817    	if((bat[1]._Ub<(USIGN*10))) 
;;;818    		{
;;;819    		snmp_bat_flag[1]|=0x01; 
;;;820    		if((snmp_bat_flag_puts[1]&0x01)==0) 
;;;821    			{
;;;822    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,0); 
;;;823    			snmp_bat_flag_puts[1]|=0x01;
;;;824    			}
;;;825    		}
;;;826    	else 
;;;827    		{
;;;828    		snmp_bat_flag[1]&=~0x01; 
;;;829    		if(snmp_bat_flag_puts[1]&0x01) 
;;;830    			{
;;;831    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,1);
;;;832    			snmp_bat_flag_puts[1]&=~0x01;
;;;833    			}
;;;834    		}
;;;835    	if(bat[1]._temper_stat&0x01) 
;;;836    		{
;;;837    		snmp_bat_flag[1]|=0x02;
;;;838    		if((snmp_bat_flag_puts[1]&0x02)==0) 
;;;839    			{
;;;840    			snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,2); 
;;;841    			snmp_bat_flag_puts[1]|=0x02;
;;;842    			}
;;;843    		}
;;;844    	else 
;;;845    		{
;;;846    		snmp_bat_flag[1]&=~0x02;
;;;847    		if(snmp_bat_flag_puts[1]&0x02) 
;;;848    			{
;;;849    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,3);
;;;850    			snmp_bat_flag_puts[1]&=~0x02;
;;;851    			}
;;;852    		}
;;;853    	if(bat[1]._temper_stat&0x02) 
;;;854    		{
;;;855    		snmp_bat_flag[1]|=0x04;
;;;856    		if((snmp_bat_flag_puts[1]&0x04)==0) 
;;;857    			{
;;;858    			snmp_trap_send("BAT #2 Alarm, maximum battery temperature",5,8,4); 
;;;859    			snmp_bat_flag_puts[1]|=0x04;
;;;860    			}
;;;861    		}
;;;862    	else 
;;;863    		{
;;;864    		snmp_bat_flag[1]&=~0x04;
;;;865    		if(snmp_bat_flag_puts[1]&0x04) 
;;;866    			{
;;;867    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,5);
;;;868    			snmp_bat_flag_puts[1]&=~0x04;
;;;869    			}
;;;870    		}
;;;871    		
;;;872    	if(bat[1]._Ib<(-IKB))	snmp_bat_flag[1]|=0x80;
;;;873    	else if(bat[1]._Ib>IKB)snmp_bat_flag[1]&=~0x80;
;;;874    
;;;875    	if((spc_stat==spcKE)&&(spc_bat==1)) 
;;;876    		{
;;;877    		snmp_bat_flag[1]|=0x10;
;;;878    		if((snmp_bat_flag_puts[1]&0x10)==0) 
;;;879    			{
;;;880    			snmp_trap_send("BAT #2, capacity check enabled",5,8,6); 
;;;881    			snmp_bat_flag_puts[1]|=0x10;
;;;882    			}
;;;883    		}
;;;884    	else 
;;;885    		{
;;;886    		snmp_bat_flag[1]&=~0x10;
;;;887    		if(snmp_bat_flag_puts[1]&0x10) 
;;;888    			{
;;;889    			snmp_trap_send("BAT #2, capacity check disabled",5,8,7);
;;;890    			snmp_bat_flag_puts[1]&=~0x10;
;;;891    			}
;;;892    		}
;;;893    		
;;;894    	if(spc_stat==spcVZ) 
;;;895    		{
;;;896    		snmp_bat_flag[1]|=0x20;
;;;897    		if((snmp_bat_flag_puts[1]&0x20)==0) 
;;;898    			{
;;;899    			snmp_trap_send("BAT #2,equalizing charge is on",5,8,8); 
;;;900    			snmp_bat_flag_puts[1]|=0x20;
;;;901    			}
;;;902    		}
;;;903    	else 
;;;904    		{
;;;905    		snmp_bat_flag[1]&=~0x20;
;;;906    		if(snmp_bat_flag_puts[1]&0x20) 
;;;907    			{
;;;908    			snmp_trap_send("BAT #2,equalizing charge is off",5,8,9);
;;;909    			snmp_bat_flag_puts[1]&=~0x20;
;;;910    			}
;;;911    		}
;;;912    
;;;913    	if(vz_error) 
;;;914    		{
;;;915    		snmp_bat_flag[1]|=0x40;
;;;916    		if((snmp_bat_flag_puts[1]&0x40)==0) 
;;;917    			{
;;;918    			snmp_trap_send("BAT #2,equalizing charge blocked",5,8,10); 
;;;919    			snmp_bat_flag_puts[1]|=0x40;
;;;920    			}
;;;921    		}
;;;922    	else 
;;;923    		{
;;;924    		snmp_bat_flag[1]&=~0x40;
;;;925    		if(snmp_bat_flag_puts[1]&0x40) 
;;;926    			{
;;;927    			snmp_trap_send("BAT #2,equalizing charge is not blocked",5,8,11);
;;;928    			snmp_bat_flag_puts[1]&=~0x40;
;;;929    			} 
;;;930    		}
;;;931       }
;;;932    else 
;;;933    	{
;;;934    	snmp_bat_flag[1]=0; 
;;;935    	snmp_bat_flag_puts[1]=0;
;;;936    	} */
;;;937    }
0003f6  e8bd9ff0          POP      {r4-r12,pc}
                  |L1.1018|
0003fa  e167              B        |L1.1740|
                  |L1.1020|
                          DCD      ||area_number.26||
                  |L1.1024|
                          DCD      snmp_bat_status
                  |L1.1028|
                          DCD      NUMBAT
                  |L1.1032|
                          DCD      bat
                  |L1.1036|
                          DCD      IKB
                  |L1.1040|
                          DCD      snmp_bat_flag
                  |L1.1044|
                          DCD      snmp_bat_flag_puts
                  |L1.1048|
                          DCD      USIGN
                  |L1.1052|
00041c  42415420          DCB      "BAT #1 Alarm, battery is low",0
000420  23312041
000424  6c61726d
000428  2c206261
00042c  74746572
000430  79206973
000434  206c6f77
000438  00      
000439  00                DCB      0
00043a  00                DCB      0
00043b  00                DCB      0
                  |L1.1084|
00043c  42415420          DCB      "BAT #1 Alarm clear, battery is not low",0
000440  23312041
000444  6c61726d
000448  20636c65
00044c  61722c20
000450  62617474
000454  65727920
000458  6973206e
00045c  6f74206c
000460  6f7700  
000463  00                DCB      0
                  |L1.1124|
000464  42415420          DCB      "BAT #1, capacity test stopped",0
000468  23312c20
00046c  63617061
000470  63697479
000474  20746573
000478  74207374
00047c  6f707065
000480  6400    
000482  00                DCB      0
000483  00                DCB      0
                  |L1.1156|
000484  42415420          DCB      "BAT #1,leveling charge is stopped",0
000488  23312c6c
00048c  6576656c
000490  696e6720
000494  63686172
000498  67652069
00049c  73207374
0004a0  6f707065
0004a4  6400    
0004a6  00                DCB      0
0004a7  00                DCB      0
                  |L1.1192|
0004a8  42415420          DCB      "BAT #1,leveling charge is blocked",0
0004ac  23312c6c
0004b0  6576656c
0004b4  696e6720
0004b8  63686172
0004bc  67652069
0004c0  7320626c
0004c4  6f636b65
0004c8  6400    
0004ca  00                DCB      0
0004cb  00                DCB      0
                  |L1.1228|
0004cc  42415420          DCB      "BAT #1, capacity test started",0
0004d0  23312c20
0004d4  63617061
0004d8  63697479
0004dc  20746573
0004e0  74207374
0004e4  61727465
0004e8  6400    
0004ea  00                DCB      0
0004eb  00                DCB      0
                  |L1.1260|
0004ec  42415420          DCB      "BAT #1,leveling charge is started",0
0004f0  23312c6c
0004f4  6576656c
0004f8  696e6720
0004fc  63686172
000500  67652069
000504  73207374
000508  61727465
00050c  6400    
00050e  00                DCB      0
00050f  00                DCB      0
                  |L1.1296|
000510  42415420          DCB      "BAT #1,leveling charge is unblocked",0
000514  23312c6c
000518  6576656c
00051c  696e6720
000520  63686172
000524  67652069
000528  7320756e
00052c  626c6f63
000530  6b656400
                  |L1.1332|
                          DCD      sp_ch_stat
                  |L1.1336|
000538  42415420          DCB      "BAT #1,speed charge is stopped",0
00053c  23312c73
000540  70656564
000544  20636861
000548  72676520
00054c  69732073
000550  746f7070
000554  656400  
000557  00                DCB      0
                  |L1.1368|
000558  42415420          DCB      "BAT #1,speed charge is blocked",0
00055c  23312c73
000560  70656564
000564  20636861
000568  72676520
00056c  69732062
000570  6c6f636b
000574  656400  
000577  00                DCB      0
                  |L1.1400|
000578  42415420          DCB      "BAT #1,speed charge is started",0
00057c  23312c73
000580  70656564
000584  20636861
000588  72676520
00058c  69732073
000590  74617274
000594  656400  
000597  00                DCB      0
                  |L1.1432|
000598  42415420          DCB      "BAT #1,speed charge is unblocked",0
00059c  23312c73
0005a0  70656564
0005a4  20636861
0005a8  72676520
0005ac  69732075
0005b0  6e626c6f
0005b4  636b6564
0005b8  00      
0005b9  00                DCB      0
0005ba  00                DCB      0
0005bb  00                DCB      0
                  |L1.1468|
0005bc  42415420          DCB      "BAT #1,equalising charge is on",0
0005c0  23312c65
0005c4  7175616c
0005c8  6973696e
0005cc  67206368
0005d0  61726765
0005d4  20697320
0005d8  6f6e00  
0005db  00                DCB      0
                  |L1.1500|
0005dc  42415420          DCB      "BAT #1,equalising charge is off",0
0005e0  23312c65
0005e4  7175616c
0005e8  6973696e
0005ec  67206368
0005f0  61726765
0005f4  20697320
0005f8  6f666600
                  |L1.1532|
0005fc  42415420          DCB      "BAT #1,equalising charge is blocked",0
000600  23312c65
000604  7175616c
000608  6973696e
00060c  67206368
000610  61726765
000614  20697320
000618  626c6f63
00061c  6b656400
                  |L1.1568|
000620  42415420          DCB      "BAT #1,equalising charge is unblocked",0
000624  23312c65
000628  7175616c
00062c  6973696e
000630  67206368
000634  61726765
000638  20697320
00063c  756e626c
000640  6f636b65
000644  6400    
000646  00                DCB      0
000647  00                DCB      0
                  |L1.1608|
000648  42415420          DCB      "BAT #1,molding charge is on",0
00064c  23312c6d
000650  6f6c6469
000654  6e672063
000658  68617267
00065c  65206973
000660  206f6e00
                  |L1.1636|
000664  42415420          DCB      "BAT #1,molding charge is off",0
000668  23312c6d
00066c  6f6c6469
000670  6e672063
000674  68617267
000678  65206973
00067c  206f6666
000680  00      
000681  00                DCB      0
000682  00                DCB      0
000683  00                DCB      0
                  |L1.1668|
000684  42415420          DCB      "BAT #1,molding charge is blocked",0
000688  23312c6d
00068c  6f6c6469
000690  6e672063
000694  68617267
000698  65206973
00069c  20626c6f
0006a0  636b6564
0006a4  00      
0006a5  00                DCB      0
0006a6  00                DCB      0
0006a7  00                DCB      0
                  |L1.1704|
0006a8  42415420          DCB      "BAT #1,molding charge is unblocked",0
0006ac  23312c6d
0006b0  6f6c6469
0006b4  6e672063
0006b8  68617267
0006bc  65206973
0006c0  20756e62
0006c4  6c6f636b
0006c8  656400  
0006cb  00                DCB      0
                  |L1.1740|
0006cc  f9b8104e          LDRSH    r1,[r8,#0x4e]         ;578  ; bat
0006d0  48ff              LDR      r0,|L1.2768|
0006d2  f9b00000          LDRSH    r0,[r0,#0]            ;578  ; USIGN
0006d6  eb000080          ADD      r0,r0,r0,LSL #2       ;578
0006da  ebb10f40          CMP      r1,r0,LSL #1          ;578
0006de  da11              BGE      |L1.1796|
0006e0  8860              LDRH     r0,[r4,#2]            ;580  ; snmp_bat_flag
0006e2  f0400001          ORR      r0,r0,#1              ;580
0006e6  8060              STRH     r0,[r4,#2]            ;580
0006e8  8868              LDRH     r0,[r5,#2]            ;581  ; snmp_bat_flag_puts
0006ea  07c0              LSLS     r0,r0,#31             ;581
0006ec  d11b              BNE      |L1.1830|
0006ee  2316              MOVS     r3,#0x16              ;583
0006f0  2208              MOVS     r2,#8                 ;583
0006f2  2105              MOVS     r1,#5                 ;583
0006f4  a0f7              ADR      r0,|L1.2772|
0006f6  f7fffffe          BL       snmp_trap_send
0006fa  8868              LDRH     r0,[r5,#2]            ;584  ; snmp_bat_flag_puts
0006fc  f0400001          ORR      r0,r0,#1              ;584
000700  8068              STRH     r0,[r5,#2]            ;584
000702  e010              B        |L1.1830|
                  |L1.1796|
000704  8860              LDRH     r0,[r4,#2]            ;589  ; snmp_bat_flag
000706  f0200001          BIC      r0,r0,#1              ;589
00070a  8060              STRH     r0,[r4,#2]            ;589
00070c  8868              LDRH     r0,[r5,#2]            ;590  ; snmp_bat_flag_puts
00070e  07c0              LSLS     r0,r0,#31             ;590
000710  d009              BEQ      |L1.1830|
000712  2317              MOVS     r3,#0x17              ;592
000714  2208              MOVS     r2,#8                 ;592
000716  2105              MOVS     r1,#5                 ;592
000718  a0f6              ADR      r0,|L1.2804|
00071a  f7fffffe          BL       snmp_trap_send
00071e  8868              LDRH     r0,[r5,#2]            ;593  ; snmp_bat_flag_puts
000720  f0200001          BIC      r0,r0,#1              ;593
000724  8068              STRH     r0,[r5,#2]            ;593
                  |L1.1830|
000726  f898008b          LDRB     r0,[r8,#0x8b]         ;597  ; bat
00072a  07c1              LSLS     r1,r0,#31             ;597
00072c  d00b              BEQ      |L1.1862|
00072e  8861              LDRH     r1,[r4,#2]            ;599  ; snmp_bat_flag
000730  f0410102          ORR      r1,r1,#2              ;599
000734  8061              STRH     r1,[r4,#2]            ;599
000736  8829              LDRH     r1,[r5,#0]            ;600  ; snmp_bat_flag_puts
000738  0789              LSLS     r1,r1,#30             ;600
00073a  d40f              BMI      |L1.1884|
00073c  8869              LDRH     r1,[r5,#2]            ;603  ; snmp_bat_flag_puts
00073e  f0410102          ORR      r1,r1,#2              ;603
000742  8069              STRH     r1,[r5,#2]            ;603
000744  e00a              B        |L1.1884|
                  |L1.1862|
000746  8861              LDRH     r1,[r4,#2]            ;608  ; snmp_bat_flag
000748  f0210102          BIC      r1,r1,#2              ;608
00074c  8061              STRH     r1,[r4,#2]            ;608
00074e  f9b51002          LDRSH    r1,[r5,#2]            ;609  ; snmp_bat_flag_puts
000752  078a              LSLS     r2,r1,#30             ;609
000754  d502              BPL      |L1.1884|
000756  f0210102          BIC      r1,r1,#2              ;612
00075a  8069              STRH     r1,[r5,#2]            ;612
                  |L1.1884|
00075c  0780              LSLS     r0,r0,#30             ;616
00075e  d50b              BPL      |L1.1912|
000760  8860              LDRH     r0,[r4,#2]            ;618  ; snmp_bat_flag
000762  f0400004          ORR      r0,r0,#4              ;618
000766  8060              STRH     r0,[r4,#2]            ;618
000768  f9b50002          LDRSH    r0,[r5,#2]            ;619  ; snmp_bat_flag_puts
00076c  0741              LSLS     r1,r0,#29             ;619
00076e  d40e              BMI      |L1.1934|
000770  f0400004          ORR      r0,r0,#4              ;622
000774  8068              STRH     r0,[r5,#2]            ;622
000776  e00a              B        |L1.1934|
                  |L1.1912|
000778  8860              LDRH     r0,[r4,#2]            ;627  ; snmp_bat_flag
00077a  f0200004          BIC      r0,r0,#4              ;627
00077e  8060              STRH     r0,[r4,#2]            ;627
000780  f9b50002          LDRSH    r0,[r5,#2]            ;628  ; snmp_bat_flag_puts
000784  0741              LSLS     r1,r0,#29             ;628
000786  d502              BPL      |L1.1934|
000788  f0200004          BIC      r0,r0,#4              ;631
00078c  8068              STRH     r0,[r5,#2]            ;631
                  |L1.1934|
00078e  f9b91000          LDRSH    r1,[r9,#0]            ;635  ; IKB
000792  f9b80054          LDRSH    r0,[r8,#0x54]         ;635  ; bat
000796  424a              RSBS     r2,r1,#0              ;635
000798  4290              CMP      r0,r2                 ;635
00079a  da04              BGE      |L1.1958|
00079c  8860              LDRH     r0,[r4,#2]            ;635  ; snmp_bat_flag
00079e  f0400008          ORR      r0,r0,#8              ;635
0007a2  8060              STRH     r0,[r4,#2]            ;635
0007a4  e005              B        |L1.1970|
                  |L1.1958|
0007a6  4288              CMP      r0,r1                 ;636
0007a8  dd03              BLE      |L1.1970|
0007aa  8860              LDRH     r0,[r4,#2]            ;636  ; snmp_bat_flag
0007ac  f0200008          BIC      r0,r0,#8              ;636
0007b0  8060              STRH     r0,[r4,#2]            ;636
                  |L1.1970|
0007b2  f8960023          LDRB     r0,[r6,#0x23]         ;638  ; spc_stat
0007b6  2801              CMP      r0,#1                 ;638
0007b8  d102              BNE      |L1.1984|
0007ba  f8960024          LDRB     r0,[r6,#0x24]         ;638  ; spc_bat
0007be  b3c8              CBZ      r0,|L1.2100|
                  |L1.1984|
0007c0  8860              LDRH     r0,[r4,#2]            ;649  ; snmp_bat_flag
0007c2  f0200010          BIC      r0,r0,#0x10           ;649
0007c6  8060              STRH     r0,[r4,#2]            ;649
0007c8  8868              LDRH     r0,[r5,#2]            ;650  ; snmp_bat_flag_puts
0007ca  06c0              LSLS     r0,r0,#27             ;650
0007cc  d509              BPL      |L1.2018|
0007ce  231d              MOVS     r3,#0x1d              ;652
0007d0  2208              MOVS     r2,#8                 ;652
0007d2  2105              MOVS     r1,#5                 ;652
0007d4  a0d1              ADR      r0,|L1.2844|
0007d6  f7fffffe          BL       snmp_trap_send
0007da  8868              LDRH     r0,[r5,#2]            ;653  ; snmp_bat_flag_puts
0007dc  f0200010          BIC      r0,r0,#0x10           ;653
0007e0  8068              STRH     r0,[r5,#2]            ;653
                  |L1.2018|
0007e2  f8960023          LDRB     r0,[r6,#0x23]         ;657  ; spc_stat
0007e6  2802              CMP      r0,#2                 ;657
0007e8  d037              BEQ      |L1.2138|
0007ea  8860              LDRH     r0,[r4,#2]            ;668  ; snmp_bat_flag
0007ec  f0200020          BIC      r0,r0,#0x20           ;668
0007f0  8060              STRH     r0,[r4,#2]            ;668
0007f2  8868              LDRH     r0,[r5,#2]            ;669  ; snmp_bat_flag_puts
0007f4  0680              LSLS     r0,r0,#26             ;669
0007f6  d509              BPL      |L1.2060|
0007f8  231f              MOVS     r3,#0x1f              ;671
0007fa  2208              MOVS     r2,#8                 ;671
0007fc  2105              MOVS     r1,#5                 ;671
0007fe  a0cf              ADR      r0,|L1.2876|
000800  f7fffffe          BL       snmp_trap_send
000804  8868              LDRH     r0,[r5,#2]            ;672  ; snmp_bat_flag_puts
000806  f0200020          BIC      r0,r0,#0x20           ;672
00080a  8068              STRH     r0,[r5,#2]            ;672
                  |L1.2060|
00080c  7870              LDRB     r0,[r6,#1]            ;676  ; vz_error
00080e  b3b0              CBZ      r0,|L1.2174|
000810  8860              LDRH     r0,[r4,#2]            ;678  ; snmp_bat_flag
000812  f0400040          ORR      r0,r0,#0x40           ;678
000816  8060              STRH     r0,[r4,#2]            ;678
000818  8868              LDRH     r0,[r5,#2]            ;679  ; snmp_bat_flag_puts
00081a  0640              LSLS     r0,r0,#25             ;679
00081c  d441              BMI      |L1.2210|
00081e  2320              MOVS     r3,#0x20              ;681
000820  2208              MOVS     r2,#8                 ;681
000822  2105              MOVS     r1,#5                 ;681
000824  a0ce              ADR      r0,|L1.2912|
000826  f7fffffe          BL       snmp_trap_send
00082a  8868              LDRH     r0,[r5,#2]            ;682  ; snmp_bat_flag_puts
00082c  f0400040          ORR      r0,r0,#0x40           ;682
000830  8068              STRH     r0,[r5,#2]            ;682
000832  e036              B        |L1.2210|
                  |L1.2100|
000834  e7ff              B        |L1.2102|
                  |L1.2102|
000836  8860              LDRH     r0,[r4,#2]            ;640  ; snmp_bat_flag
000838  f0400010          ORR      r0,r0,#0x10           ;640
00083c  8060              STRH     r0,[r4,#2]            ;640
00083e  8868              LDRH     r0,[r5,#2]            ;641  ; snmp_bat_flag_puts
000840  06c0              LSLS     r0,r0,#27             ;641
000842  d4ce              BMI      |L1.2018|
000844  231c              MOVS     r3,#0x1c              ;643
000846  2208              MOVS     r2,#8                 ;643
000848  2105              MOVS     r1,#5                 ;643
00084a  a0ce              ADR      r0,|L1.2948|
00084c  f7fffffe          BL       snmp_trap_send
000850  8868              LDRH     r0,[r5,#2]            ;644  ; snmp_bat_flag_puts
000852  f0400010          ORR      r0,r0,#0x10           ;644
000856  8068              STRH     r0,[r5,#2]            ;644
000858  e7c3              B        |L1.2018|
                  |L1.2138|
00085a  8860              LDRH     r0,[r4,#2]            ;659  ; snmp_bat_flag
00085c  f0400020          ORR      r0,r0,#0x20           ;659
000860  8060              STRH     r0,[r4,#2]            ;659
000862  8868              LDRH     r0,[r5,#2]            ;660  ; snmp_bat_flag_puts
000864  0680              LSLS     r0,r0,#26             ;660
000866  d4d1              BMI      |L1.2060|
000868  231e              MOVS     r3,#0x1e              ;662
00086a  2208              MOVS     r2,#8                 ;662
00086c  2105              MOVS     r1,#5                 ;662
00086e  a0cd              ADR      r0,|L1.2980|
000870  f7fffffe          BL       snmp_trap_send
000874  8868              LDRH     r0,[r5,#2]            ;663  ; snmp_bat_flag_puts
000876  f0400020          ORR      r0,r0,#0x20           ;663
00087a  8068              STRH     r0,[r5,#2]            ;663
00087c  e7c6              B        |L1.2060|
                  |L1.2174|
00087e  e7ff              B        |L1.2176|
                  |L1.2176|
000880  8860              LDRH     r0,[r4,#2]            ;687  ; snmp_bat_flag
000882  f0200040          BIC      r0,r0,#0x40           ;687
000886  8060              STRH     r0,[r4,#2]            ;687
000888  8868              LDRH     r0,[r5,#2]            ;688  ; snmp_bat_flag_puts
00088a  0640              LSLS     r0,r0,#25             ;688
00088c  d509              BPL      |L1.2210|
00088e  2321              MOVS     r3,#0x21              ;690
000890  2208              MOVS     r2,#8                 ;690
000892  2105              MOVS     r1,#5                 ;690
000894  a0cc              ADR      r0,|L1.3016|
000896  f7fffffe          BL       snmp_trap_send
00089a  8868              LDRH     r0,[r5,#2]            ;691  ; snmp_bat_flag_puts
00089c  f0200040          BIC      r0,r0,#0x40           ;691
0008a0  8068              STRH     r0,[r5,#2]            ;691
                  |L1.2210|
0008a2  48d2              LDR      r0,|L1.3052|
0008a4  7800              LDRB     r0,[r0,#0]            ;695  ; sp_ch_stat
0008a6  2802              CMP      r0,#2                 ;695
0008a8  d024              BEQ      |L1.2292|
0008aa  8860              LDRH     r0,[r4,#2]            ;706  ; snmp_bat_flag
0008ac  f0200080          BIC      r0,r0,#0x80           ;706
0008b0  8060              STRH     r0,[r4,#2]            ;706
0008b2  8868              LDRH     r0,[r5,#2]            ;707  ; snmp_bat_flag_puts
0008b4  0600              LSLS     r0,r0,#24             ;707
0008b6  d509              BPL      |L1.2252|
0008b8  2323              MOVS     r3,#0x23              ;709
0008ba  2208              MOVS     r2,#8                 ;709
0008bc  2105              MOVS     r1,#5                 ;709
0008be  a0cc              ADR      r0,|L1.3056|
0008c0  f7fffffe          BL       snmp_trap_send
0008c4  8868              LDRH     r0,[r5,#2]            ;710  ; snmp_bat_flag_puts
0008c6  f0200080          BIC      r0,r0,#0x80           ;710
0008ca  8068              STRH     r0,[r5,#2]            ;710
                  |L1.2252|
0008cc  78b0              LDRB     r0,[r6,#2]            ;714  ; sp_ch_error
0008ce  b318              CBZ      r0,|L1.2328|
0008d0  8860              LDRH     r0,[r4,#2]            ;716  ; snmp_bat_flag
0008d2  f4407080          ORR      r0,r0,#0x100          ;716
0008d6  8060              STRH     r0,[r4,#2]            ;716
0008d8  8868              LDRH     r0,[r5,#2]            ;717  ; snmp_bat_flag_puts
0008da  05c0              LSLS     r0,r0,#23             ;717
0008dc  d42d              BMI      |L1.2362|
0008de  2324              MOVS     r3,#0x24              ;719
0008e0  2208              MOVS     r2,#8                 ;719
0008e2  2105              MOVS     r1,#5                 ;719
0008e4  a0ca              ADR      r0,|L1.3088|
0008e6  f7fffffe          BL       snmp_trap_send
0008ea  8868              LDRH     r0,[r5,#2]            ;720  ; snmp_bat_flag_puts
0008ec  f4407080          ORR      r0,r0,#0x100          ;720
0008f0  8068              STRH     r0,[r5,#2]            ;720
0008f2  e022              B        |L1.2362|
                  |L1.2292|
0008f4  8860              LDRH     r0,[r4,#2]            ;697  ; snmp_bat_flag
0008f6  f0400080          ORR      r0,r0,#0x80           ;697
0008fa  8060              STRH     r0,[r4,#2]            ;697
0008fc  8868              LDRH     r0,[r5,#2]            ;698  ; snmp_bat_flag_puts
0008fe  0600              LSLS     r0,r0,#24             ;698
000900  d4e4              BMI      |L1.2252|
000902  2322              MOVS     r3,#0x22              ;700
000904  2208              MOVS     r2,#8                 ;700
000906  2105              MOVS     r1,#5                 ;700
000908  a0c9              ADR      r0,|L1.3120|
00090a  f7fffffe          BL       snmp_trap_send
00090e  8868              LDRH     r0,[r5,#2]            ;701  ; snmp_bat_flag_puts
000910  f0400080          ORR      r0,r0,#0x80           ;701
000914  8068              STRH     r0,[r5,#2]            ;701
000916  e7d9              B        |L1.2252|
                  |L1.2328|
000918  8860              LDRH     r0,[r4,#2]            ;725  ; snmp_bat_flag
00091a  f4207080          BIC      r0,r0,#0x100          ;725
00091e  8060              STRH     r0,[r4,#2]            ;725
000920  8868              LDRH     r0,[r5,#2]            ;726  ; snmp_bat_flag_puts
000922  05c0              LSLS     r0,r0,#23             ;726
000924  d509              BPL      |L1.2362|
000926  2325              MOVS     r3,#0x25              ;728
000928  2208              MOVS     r2,#8                 ;728
00092a  2105              MOVS     r1,#5                 ;728
00092c  a0c8              ADR      r0,|L1.3152|
00092e  f7fffffe          BL       snmp_trap_send
000932  8868              LDRH     r0,[r5,#2]            ;729  ; snmp_bat_flag_puts
000934  f4207080          BIC      r0,r0,#0x100          ;729
000938  8068              STRH     r0,[r5,#2]            ;729
                  |L1.2362|
00093a  7970              LDRB     r0,[r6,#5]            ;733  ; vz1_stat
00093c  b188              CBZ      r0,|L1.2402|
00093e  8860              LDRH     r0,[r4,#2]            ;735  ; snmp_bat_flag
000940  f4407000          ORR      r0,r0,#0x200          ;735
000944  8060              STRH     r0,[r4,#2]            ;735
000946  8868              LDRH     r0,[r5,#2]            ;736  ; snmp_bat_flag_puts
000948  0580              LSLS     r0,r0,#22             ;736
00094a  d41b              BMI      |L1.2436|
00094c  2326              MOVS     r3,#0x26              ;738
00094e  2208              MOVS     r2,#8                 ;738
000950  2105              MOVS     r1,#5                 ;738
000952  a0c8              ADR      r0,|L1.3188|
000954  f7fffffe          BL       snmp_trap_send
000958  8868              LDRH     r0,[r5,#2]            ;739  ; snmp_bat_flag_puts
00095a  f4407000          ORR      r0,r0,#0x200          ;739
00095e  8068              STRH     r0,[r5,#2]            ;739
000960  e010              B        |L1.2436|
                  |L1.2402|
000962  8860              LDRH     r0,[r4,#2]            ;744  ; snmp_bat_flag
000964  f4207000          BIC      r0,r0,#0x200          ;744
000968  8060              STRH     r0,[r4,#2]            ;744
00096a  8868              LDRH     r0,[r5,#2]            ;745  ; snmp_bat_flag_puts
00096c  0580              LSLS     r0,r0,#22             ;745
00096e  d509              BPL      |L1.2436|
000970  2327              MOVS     r3,#0x27              ;747
000972  2208              MOVS     r2,#8                 ;747
000974  2105              MOVS     r1,#5                 ;747
000976  a0c7              ADR      r0,|L1.3220|
000978  f7fffffe          BL       snmp_trap_send
00097c  8868              LDRH     r0,[r5,#2]            ;748  ; snmp_bat_flag_puts
00097e  f4207000          BIC      r0,r0,#0x200          ;748
000982  8068              STRH     r0,[r5,#2]            ;748
                  |L1.2436|
000984  78f0              LDRB     r0,[r6,#3]            ;752  ; vz1_error
000986  b188              CBZ      r0,|L1.2476|
000988  8860              LDRH     r0,[r4,#2]            ;754  ; snmp_bat_flag
00098a  f4406080          ORR      r0,r0,#0x400          ;754
00098e  8060              STRH     r0,[r4,#2]            ;754
000990  8868              LDRH     r0,[r5,#2]            ;755  ; snmp_bat_flag_puts
000992  0540              LSLS     r0,r0,#21             ;755
000994  d41b              BMI      |L1.2510|
000996  2328              MOVS     r3,#0x28              ;757
000998  2208              MOVS     r2,#8                 ;757
00099a  2105              MOVS     r1,#5                 ;757
00099c  a0c5              ADR      r0,|L1.3252|
00099e  f7fffffe          BL       snmp_trap_send
0009a2  8868              LDRH     r0,[r5,#2]            ;758  ; snmp_bat_flag_puts
0009a4  f4406080          ORR      r0,r0,#0x400          ;758
0009a8  8068              STRH     r0,[r5,#2]            ;758
0009aa  e010              B        |L1.2510|
                  |L1.2476|
0009ac  8860              LDRH     r0,[r4,#2]            ;763  ; snmp_bat_flag
0009ae  f4206080          BIC      r0,r0,#0x400          ;763
0009b2  8060              STRH     r0,[r4,#2]            ;763
0009b4  8868              LDRH     r0,[r5,#2]            ;764  ; snmp_bat_flag_puts
0009b6  0540              LSLS     r0,r0,#21             ;764
0009b8  d509              BPL      |L1.2510|
0009ba  2329              MOVS     r3,#0x29              ;766
0009bc  2208              MOVS     r2,#8                 ;766
0009be  2105              MOVS     r1,#5                 ;766
0009c0  a0c5              ADR      r0,|L1.3288|
0009c2  f7fffffe          BL       snmp_trap_send
0009c6  8868              LDRH     r0,[r5,#2]            ;767  ; snmp_bat_flag_puts
0009c8  f4206080          BIC      r0,r0,#0x400          ;767
0009cc  8068              STRH     r0,[r5,#2]            ;767
                  |L1.2510|
0009ce  79f0              LDRB     r0,[r6,#7]            ;771  ; vz2_stat
0009d0  b188              CBZ      r0,|L1.2550|
0009d2  8860              LDRH     r0,[r4,#2]            ;773  ; snmp_bat_flag
0009d4  f4406000          ORR      r0,r0,#0x800          ;773
0009d8  8060              STRH     r0,[r4,#2]            ;773
0009da  8868              LDRH     r0,[r5,#2]            ;774  ; snmp_bat_flag_puts
0009dc  0500              LSLS     r0,r0,#20             ;774
0009de  d41b              BMI      |L1.2584|
0009e0  232a              MOVS     r3,#0x2a              ;776
0009e2  2208              MOVS     r2,#8                 ;776
0009e4  2105              MOVS     r1,#5                 ;776
0009e6  a0c6              ADR      r0,|L1.3328|
0009e8  f7fffffe          BL       snmp_trap_send
0009ec  8868              LDRH     r0,[r5,#2]            ;777  ; snmp_bat_flag_puts
0009ee  f4406000          ORR      r0,r0,#0x800          ;777
0009f2  8068              STRH     r0,[r5,#2]            ;777
0009f4  e010              B        |L1.2584|
                  |L1.2550|
0009f6  8860              LDRH     r0,[r4,#2]            ;782  ; snmp_bat_flag
0009f8  f4206000          BIC      r0,r0,#0x800          ;782
0009fc  8060              STRH     r0,[r4,#2]            ;782
0009fe  8868              LDRH     r0,[r5,#2]            ;783  ; snmp_bat_flag_puts
000a00  0500              LSLS     r0,r0,#20             ;783
000a02  d509              BPL      |L1.2584|
000a04  232b              MOVS     r3,#0x2b              ;785
000a06  2208              MOVS     r2,#8                 ;785
000a08  2105              MOVS     r1,#5                 ;785
000a0a  a0c4              ADR      r0,|L1.3356|
000a0c  f7fffffe          BL       snmp_trap_send
000a10  8868              LDRH     r0,[r5,#2]            ;786  ; snmp_bat_flag_puts
000a12  f4206000          BIC      r0,r0,#0x800          ;786
000a16  8068              STRH     r0,[r5,#2]            ;786
                  |L1.2584|
000a18  7930              LDRB     r0,[r6,#4]            ;790  ; vz2_error
000a1a  b190              CBZ      r0,|L1.2626|
000a1c  8860              LDRH     r0,[r4,#2]            ;792  ; snmp_bat_flag
000a1e  f4405080          ORR      r0,r0,#0x1000         ;792
000a22  8060              STRH     r0,[r4,#2]            ;792
000a24  8868              LDRH     r0,[r5,#2]            ;793  ; snmp_bat_flag_puts
000a26  04c0              LSLS     r0,r0,#19             ;793
000a28  f53face5          BMI      |L1.1014|
000a2c  232c              MOVS     r3,#0x2c              ;795
000a2e  2208              MOVS     r2,#8                 ;795
000a30  2105              MOVS     r1,#5                 ;795
000a32  a0c2              ADR      r0,|L1.3388|
000a34  f7fffffe          BL       snmp_trap_send
000a38  8868              LDRH     r0,[r5,#2]            ;796  ; snmp_bat_flag_puts
000a3a  f4405080          ORR      r0,r0,#0x1000         ;796
000a3e  8068              STRH     r0,[r5,#2]            ;796
                  |L1.2624|
000a40  e4d9              B        |L1.1014|
                  |L1.2626|
000a42  8860              LDRH     r0,[r4,#2]            ;801  ; snmp_bat_flag
000a44  f4205080          BIC      r0,r0,#0x1000         ;801
000a48  8060              STRH     r0,[r4,#2]            ;801
000a4a  8868              LDRH     r0,[r5,#2]            ;802  ; snmp_bat_flag_puts
000a4c  04c0              LSLS     r0,r0,#19             ;802
000a4e  d5f7              BPL      |L1.2624|
000a50  232d              MOVS     r3,#0x2d              ;804
000a52  2208              MOVS     r2,#8                 ;804
000a54  2105              MOVS     r1,#5                 ;804
000a56  a0c2              ADR      r0,|L1.3424|
000a58  f7fffffe          BL       snmp_trap_send
000a5c  8868              LDRH     r0,[r5,#2]            ;805  ; snmp_bat_flag_puts
000a5e  f4205080          BIC      r0,r0,#0x1000         ;805
000a62  8068              STRH     r0,[r5,#2]            ;805
000a64  e4c7              B        |L1.1014|
;;;938    
                          ENDP

                  ke_start PROC
;;;941    //-----------------------------------------------
;;;942    void ke_start(char in)
000a66  e92d41fc          PUSH     {r2-r8,lr}
;;;943    {          
000a6a  4606              MOV      r6,r0
;;;944    ke_start_stat=(enum_ke_start_stat)0;		 
000a6c  4dc5              LDR      r5,|L1.3460|
000a6e  f04f0400          MOV      r4,#0
;;;945    /*
;;;946    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
;;;947    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;948    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;949    #endif
;;;950    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
;;;951    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;952    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;953    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;954    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;955    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;956    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;957    else */
;;;958    	{
;;;959    
;;;960    	ke_start_stat=kssYES;
000a72  f105050a          ADD      r5,r5,#0xa
000a76  f04f0064          MOV      r0,#0x64
000a7a  7768              STRB     r0,[r5,#0x1d]
;;;961    
;;;962    	spc_stat=spcKE;
000a7c  f04f0701          MOV      r7,#1
000a80  766f              STRB     r7,[r5,#0x19]
;;;963    	__ee_spc_stat=spcKE;
000a82  f8a57060          STRH     r7,[r5,#0x60]
;;;964    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
000a86  4639              MOV      r1,r7
000a88  f240209a          MOV      r0,#0x29a
000a8c  f7fffffe          BL       lc640_write_int
;;;965    	
;;;966    	spc_bat=0;
000a90  76ac              STRB     r4,[r5,#0x1a]
;;;967    	__ee_spc_bat=0;
000a92  f8a54062          STRH     r4,[r5,#0x62]
;;;968    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
000a96  4621              MOV      r1,r4
000a98  f240209e          MOV      r0,#0x29e
000a9c  f7fffffe          BL       lc640_write_int
;;;969    
;;;970    	bat[0]._zar_cnt_ke=0;
000aa0  f8df82e4          LDR      r8,|L1.3464|
000aa4  f8c84018          STR      r4,[r8,#0x18]  ; bat
;;;971    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[0],0);
000aa8  48b8              LDR      r0,|L1.3468|
000aaa  2100              MOVS     r1,#0
000aac  f9b00000          LDRSH    r0,[r0,#0]  ; ADR_EE_BAT_ZAR_CNT_KE
000ab0  f7fffffe          BL       lc640_write_int
;;;972    
;;;973    	bat[0]._time_min_cnt_ke=0;
000ab4  f8a8404a          STRH     r4,[r8,#0x4a]
;;;974    	lc640_write_int(EE_ZVU_BAT_MIN_CNT_KE,0);
000ab8  2100              MOVS     r1,#0
000aba  f44f70e3          MOV      r0,#0x1c6
000abe  f7fffffe          BL       lc640_write_int
;;;975    
;;;976    	
;;;977    	spc_phase=0;
000ac2  76ec              STRB     r4,[r5,#0x1b]
;;;978    	__ee_spc_phase=0;
000ac4  f8a54064          STRH     r4,[r5,#0x64]
;;;979    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
000ac8  4621              MOV      r1,r4
000aca  f44f7028          MOV      r0,#0x2a0
000ace  e15f              B        |L1.3472|
                  |L1.2768|
                          DCD      USIGN
                  |L1.2772|
000ad4  42415420          DCB      "BAT #2 Alarm, battery is low",0
000ad8  23322041
000adc  6c61726d
000ae0  2c206261
000ae4  74746572
000ae8  79206973
000aec  206c6f77
000af0  00      
000af1  00                DCB      0
000af2  00                DCB      0
000af3  00                DCB      0
                  |L1.2804|
000af4  42415420          DCB      "BAT #2 Alarm clear, battery is not low",0
000af8  23322041
000afc  6c61726d
000b00  20636c65
000b04  61722c20
000b08  62617474
000b0c  65727920
000b10  6973206e
000b14  6f74206c
000b18  6f7700  
000b1b  00                DCB      0
                  |L1.2844|
000b1c  42415420          DCB      "BAT #2, capacity test stopped",0
000b20  23322c20
000b24  63617061
000b28  63697479
000b2c  20746573
000b30  74207374
000b34  6f707065
000b38  6400    
000b3a  00                DCB      0
000b3b  00                DCB      0
                  |L1.2876|
000b3c  42415420          DCB      "BAT #2,leveling charge is stopped",0
000b40  23322c6c
000b44  6576656c
000b48  696e6720
000b4c  63686172
000b50  67652069
000b54  73207374
000b58  6f707065
000b5c  6400    
000b5e  00                DCB      0
000b5f  00                DCB      0
                  |L1.2912|
000b60  42415420          DCB      "BAT #2,leveling charge is blocked",0
000b64  23322c6c
000b68  6576656c
000b6c  696e6720
000b70  63686172
000b74  67652069
000b78  7320626c
000b7c  6f636b65
000b80  6400    
000b82  00                DCB      0
000b83  00                DCB      0
                  |L1.2948|
000b84  42415420          DCB      "BAT #2, capacity test started",0
000b88  23322c20
000b8c  63617061
000b90  63697479
000b94  20746573
000b98  74207374
000b9c  61727465
000ba0  6400    
000ba2  00                DCB      0
000ba3  00                DCB      0
                  |L1.2980|
000ba4  42415420          DCB      "BAT #2,leveling charge is started",0
000ba8  23322c6c
000bac  6576656c
000bb0  696e6720
000bb4  63686172
000bb8  67652069
000bbc  73207374
000bc0  61727465
000bc4  6400    
000bc6  00                DCB      0
000bc7  00                DCB      0
                  |L1.3016|
000bc8  42415420          DCB      "BAT #2,leveling charge is unblocked",0
000bcc  23322c6c
000bd0  6576656c
000bd4  696e6720
000bd8  63686172
000bdc  67652069
000be0  7320756e
000be4  626c6f63
000be8  6b656400
                  |L1.3052|
                          DCD      sp_ch_stat
                  |L1.3056|
000bf0  42415420          DCB      "BAT #2,speed charge is stopped",0
000bf4  23322c73
000bf8  70656564
000bfc  20636861
000c00  72676520
000c04  69732073
000c08  746f7070
000c0c  656400  
000c0f  00                DCB      0
                  |L1.3088|
000c10  42415420          DCB      "BAT #2,speed charge is blocked",0
000c14  23322c73
000c18  70656564
000c1c  20636861
000c20  72676520
000c24  69732062
000c28  6c6f636b
000c2c  656400  
000c2f  00                DCB      0
                  |L1.3120|
000c30  42415420          DCB      "BAT #2,speed charge is started",0
000c34  23322c73
000c38  70656564
000c3c  20636861
000c40  72676520
000c44  69732073
000c48  74617274
000c4c  656400  
000c4f  00                DCB      0
                  |L1.3152|
000c50  42415420          DCB      "BAT #2,speed charge is unblocked",0
000c54  23322c73
000c58  70656564
000c5c  20636861
000c60  72676520
000c64  69732075
000c68  6e626c6f
000c6c  636b6564
000c70  00      
000c71  00                DCB      0
000c72  00                DCB      0
000c73  00                DCB      0
                  |L1.3188|
000c74  42415420          DCB      "BAT #2,equalising charge is on",0
000c78  23322c65
000c7c  7175616c
000c80  6973696e
000c84  67206368
000c88  61726765
000c8c  20697320
000c90  6f6e00  
000c93  00                DCB      0
                  |L1.3220|
000c94  42415420          DCB      "BAT #2,equalising charge is off",0
000c98  23322c65
000c9c  7175616c
000ca0  6973696e
000ca4  67206368
000ca8  61726765
000cac  20697320
000cb0  6f666600
                  |L1.3252|
000cb4  42415420          DCB      "BAT #2,equalising charge is blocked",0
000cb8  23322c65
000cbc  7175616c
000cc0  6973696e
000cc4  67206368
000cc8  61726765
000ccc  20697320
000cd0  626c6f63
000cd4  6b656400
                  |L1.3288|
000cd8  42415420          DCB      "BAT #2,equalising charge is unblocked",0
000cdc  23322c65
000ce0  7175616c
000ce4  6973696e
000ce8  67206368
000cec  61726765
000cf0  20697320
000cf4  756e626c
000cf8  6f636b65
000cfc  6400    
000cfe  00                DCB      0
000cff  00                DCB      0
                  |L1.3328|
000d00  42415420          DCB      "BAT #2,molding charge is on",0
000d04  23322c6d
000d08  6f6c6469
000d0c  6e672063
000d10  68617267
000d14  65206973
000d18  206f6e00
                  |L1.3356|
000d1c  42415420          DCB      "BAT #2,molding charge is off",0
000d20  23322c6d
000d24  6f6c6469
000d28  6e672063
000d2c  68617267
000d30  65206973
000d34  206f6666
000d38  00      
000d39  00                DCB      0
000d3a  00                DCB      0
000d3b  00                DCB      0
                  |L1.3388|
000d3c  42415420          DCB      "BAT #2,molding charge is blocked",0
000d40  23322c6d
000d44  6f6c6469
000d48  6e672063
000d4c  68617267
000d50  65206973
000d54  20626c6f
000d58  636b6564
000d5c  00      
000d5d  00                DCB      0
000d5e  00                DCB      0
000d5f  00                DCB      0
                  |L1.3424|
000d60  42415420          DCB      "BAT #2,molding charge is unblocked",0
000d64  23322c6d
000d68  6f6c6469
000d6c  6e672063
000d70  68617267
000d74  65206973
000d78  20756e62
000d7c  6c6f636b
000d80  656400  
000d83  00                DCB      0
                  |L1.3460|
                          DCD      ||area_number.26||
                  |L1.3464|
                          DCD      bat
                  |L1.3468|
                          DCD      ADR_EE_BAT_ZAR_CNT_KE
                  |L1.3472|
000d90  f7fffffe          BL       lc640_write_int
;;;980    
;;;981    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;982    
;;;983    		{					
;;;984    		signed short temp_temp;
;;;985    		signed char temp;
;;;986    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
000d94  eb060046          ADD      r0,r6,r6,LSL #1
000d98  eb001006          ADD      r0,r0,r6,LSL #4
000d9c  eb080180          ADD      r1,r8,r0,LSL #2
000da0  48ff              LDR      r0,|L1.4512|
000da2  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000da4  f1000001          ADD      r0,r0,#1
000da8  f0000007          AND      r0,r0,#7
000dac  eb010040          ADD      r0,r1,r0,LSL #1
000db0  8c00              LDRH     r0,[r0,#0x20]
000db2  9001              STR      r0,[sp,#4]
;;;987    		    
;;;988    		temp=LPC_RTC->YEAR;
000db4  4efb              LDR      r6,|L1.4516|
000db6  8bb0              LDRH     r0,[r6,#0x1c]
000db8  9000              STR      r0,[sp,#0]
;;;989    		gran_char(&temp,1,99);
000dba  f04f0263          MOV      r2,#0x63
000dbe  f04f0101          MOV      r1,#1
000dc2  4668              MOV      r0,sp
000dc4  f7fffffe          BL       gran_char
;;;990    		*((char*)(&(ke_date[0])))=temp;
000dc8  4cf7              LDR      r4,|L1.4520|
000dca  f89d0000          LDRB     r0,[sp,#0]
000dce  7020              STRB     r0,[r4,#0]
;;;991    			
;;;992    		temp=LPC_RTC->MONTH;
000dd0  7e30              LDRB     r0,[r6,#0x18]
000dd2  9000              STR      r0,[sp,#0]
;;;993    		gran_char(&temp,1,12);
000dd4  220c              MOVS     r2,#0xc
000dd6  2101              MOVS     r1,#1
000dd8  4668              MOV      r0,sp
000dda  f7fffffe          BL       gran_char
;;;994    		*(((char*)(&(ke_date[0])))+1)=temp;
000dde  f89d0000          LDRB     r0,[sp,#0]
000de2  7060              STRB     r0,[r4,#1]
;;;995    		
;;;996    		temp=LPC_RTC->DOM;
000de4  7b30              LDRB     r0,[r6,#0xc]
000de6  9000              STR      r0,[sp,#0]
;;;997    		gran_char(&temp,1,31);
000de8  221f              MOVS     r2,#0x1f
000dea  2101              MOVS     r1,#1
000dec  4668              MOV      r0,sp
000dee  f7fffffe          BL       gran_char
;;;998    		*(((char*)(&(ke_date[0])))+2)=temp;			
000df2  f89d0000          LDRB     r0,[sp,#0]
000df6  70a0              STRB     r0,[r4,#2]
;;;999    				
;;;1000   		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
000df8  f89d0004          LDRB     r0,[sp,#4]
000dfc  70e0              STRB     r0,[r4,#3]
;;;1001   		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
000dfe  f24020a2          MOV      r0,#0x2a2
000e02  6821              LDR      r1,[r4,#0]  ; ke_date
000e04  f7fffffe          BL       lc640_write_long
;;;1002   
;;;1003   		temp=LPC_RTC->HOUR;
000e08  7a30              LDRB     r0,[r6,#8]
000e0a  9000              STR      r0,[sp,#0]
;;;1004   		gran_char(&temp,0,23);
000e0c  2217              MOVS     r2,#0x17
000e0e  2100              MOVS     r1,#0
000e10  4668              MOV      r0,sp
000e12  f7fffffe          BL       gran_char
;;;1005   		*((char*)(&(ke_date[1])))=temp;
000e16  f89d0000          LDRB     r0,[sp,#0]
000e1a  7120              STRB     r0,[r4,#4]
;;;1006                  
;;;1007   		temp=LPC_RTC->MIN;
000e1c  7930              LDRB     r0,[r6,#4]
000e1e  9000              STR      r0,[sp,#0]
;;;1008   		gran_char(&temp,0,59);
000e20  223b              MOVS     r2,#0x3b
000e22  2100              MOVS     r1,#0
000e24  4668              MOV      r0,sp
000e26  f7fffffe          BL       gran_char
;;;1009   		*(((char*)(&(ke_date[1])))+1)=temp;
000e2a  f89d0000          LDRB     r0,[sp,#0]
000e2e  7160              STRB     r0,[r4,#5]
;;;1010   	          
;;;1011   		temp=LPC_RTC->SEC;
000e30  7830              LDRB     r0,[r6,#0]
000e32  9000              STR      r0,[sp,#0]
;;;1012   		gran_char(&temp,0,59);
000e34  223b              MOVS     r2,#0x3b
000e36  2100              MOVS     r1,#0
000e38  4668              MOV      r0,sp
000e3a  f7fffffe          BL       gran_char
;;;1013   		*(((char*)(&(ke_date[1])))+2)=temp;
000e3e  f89d0000          LDRB     r0,[sp,#0]
000e42  71a0              STRB     r0,[r4,#6]
;;;1014   			
;;;1015   		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
000e44  f89d0005          LDRB     r0,[sp,#5]
000e48  71e0              STRB     r0,[r4,#7]
;;;1016   		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
000e4a  f24020a6          MOV      r0,#0x2a6
000e4e  6861              LDR      r1,[r4,#4]  ; ke_date
000e50  f7fffffe          BL       lc640_write_long
;;;1017   		}
;;;1018   	bat_hndl_zvu_ke_init=1;
000e54  702f              STRB     r7,[r5,#0]
;;;1019   	}
;;;1020   }
000e56  e8bd81fc          POP      {r2-r8,pc}
;;;1021   #endif
                          ENDP

                  ke_drv PROC
;;;1103   //-----------------------------------------------
;;;1104   void ke_drv(void)
000e5a  e92d47f0          PUSH     {r4-r10,lr}
;;;1105   {
000e5e  b088              SUB      sp,sp,#0x20
;;;1106   static char ke_drv_cnt_10s;
;;;1107   static short i_bat_buff[6];
;;;1108   static char i_bat_buff_cnt;
;;;1109   short ke_drv_i_temp;
;;;1110   short ke_drv_i_avg;
;;;1111   char i;
;;;1112   short ke_drv_i_temp_temp;
;;;1113   const long bat_hndl_t_razr_const[7]={600L,1800L,3600L,10800L,18000L,36000L,72000L};
000e60  f04f021c          MOV      r2,#0x1c
000e64  49d1              LDR      r1,|L1.4524|
000e66  a801              ADD      r0,sp,#4
000e68  f7fffffe          BL       __aeabi_memcpy4
;;;1114   
;;;1115   if(bat_hndl_zvu_ke_init==1)	  //Инициализация при включении контроля емкости 
000e6c  4ed0              LDR      r6,|L1.4528|
;;;1116   	{
;;;1117   	
;;;1118   	i_bat_buff[0]=0;
000e6e  4bd1              LDR      r3,|L1.4532|
000e70  2500              MOVS     r5,#0
000e72  7ab0              LDRB     r0,[r6,#0xa]          ;1115  ; bat_hndl_zvu_ke_init
000e74  2801              CMP      r0,#1                 ;1115
000e76  d102              BNE      |L1.3710|
000e78  801d              STRH     r5,[r3,#0]
;;;1119   	i_bat_buff[0]=0;
;;;1120   	i_bat_buff[0]=0;
;;;1121   	i_bat_buff[0]=0;
;;;1122   	i_bat_buff[0]=0;
;;;1123   	i_bat_buff[0]=0;
;;;1124   	i_bat_buff_cnt=0;
000e7a  73b5              STRB     r5,[r6,#0xe]
;;;1125   
;;;1126   	bat_hndl_zvu_ke_init=0;
000e7c  72b5              STRB     r5,[r6,#0xa]
                  |L1.3710|
;;;1127   	}
;;;1128   
;;;1129   
;;;1130   
;;;1131   
;;;1132   if(spc_stat==spcKE)
000e7e  f8960023          LDRB     r0,[r6,#0x23]  ; spc_stat
000e82  2801              CMP      r0,#1
000e84  d17e              BNE      |L1.3972|
;;;1133   	{
;;;1134   	ke_drv_i_temp=-Ib_ips_termokompensat/10;
000e86  48cc              LDR      r0,|L1.4536|
000e88  f04f070a          MOV      r7,#0xa
000e8c  f9b00000          LDRSH    r0,[r0,#0]  ; Ib_ips_termokompensat
000e90  f1c00000          RSB      r0,r0,#0
000e94  fb90f0f7          SDIV     r0,r0,r7
000e98  b200              SXTH     r0,r0
;;;1135   	if(ke_drv_i_temp<0)ke_drv_i_temp=0;
000e9a  2800              CMP      r0,#0
000e9c  da01              BGE      |L1.3746|
000e9e  f04f0000          MOV      r0,#0
                  |L1.3746|
;;;1136   
;;;1137   	bat_hndl_plazma[3]=ke_drv_cnt_10s;
000ea2  4ac6              LDR      r2,|L1.4540|
000ea4  7b71              LDRB     r1,[r6,#0xd]  ; ke_drv_cnt_10s
000ea6  60d1              STR      r1,[r2,#0xc]  ; bat_hndl_plazma
;;;1138   	if(++ke_drv_cnt_10s>10)
000ea8  1c49              ADDS     r1,r1,#1
;;;1139   		{
;;;1140   		ke_drv_cnt_10s=0;
;;;1141   
;;;1142   		i_bat_buff_cnt++;
;;;1143   		if(i_bat_buff_cnt>=6)i_bat_buff_cnt=0;
;;;1144   		bat_hndl_plazma[2]=i_bat_buff_cnt;
;;;1145   		i_bat_buff[i_bat_buff_cnt]=ke_drv_i_temp;
;;;1146   		ke_drv_i_temp_temp=0;
;;;1147   		for(i=0;i<6;i++)
;;;1148   			{
;;;1149   			ke_drv_i_temp_temp+=i_bat_buff[i];
;;;1150   			}
;;;1151   		ke_drv_i_avg=ke_drv_i_temp_temp/6;
;;;1152   
;;;1153   		I_from_t_table[0]=BAT_C_POINT_1_6*6; 	//Ток при котором батарея разрядится за 1/6 часа (0.1А)
;;;1154   		I_from_t_table[1]=BAT_C_POINT_1_2*2; 	//Ток при котором батарея разрядится за 1/2 часа (0.1А)
;;;1155   		I_from_t_table[2]=BAT_C_POINT_1; 		//Ток при котором батарея разрядится за 1 час (0.1А)
;;;1156   		I_from_t_table[3]=BAT_C_POINT_3/3; 		//Ток при котором батарея разрядится за 3 часа (0.1А)
;;;1157   		I_from_t_table[4]=BAT_C_POINT_5/5; 		//Ток при котором батарея разрядится за 5 часов (0.1А)
;;;1158   		I_from_t_table[5]=BAT_C_POINT_10/10; 	//Ток при котором батарея разрядится за 10 часов (0.1А)
;;;1159   		I_from_t_table[6]=BAT_C_POINT_20/20; 	//Ток при котором батарея разрядится за 20 часов (0.1А)
;;;1160   		
;;;1161   		U_end_from_i_table[0]=BAT_U_END_1_6;	//Конечное напряжение контроля емкости при разряде за 1/6 часа
;;;1162   		U_end_from_i_table[1]=BAT_U_END_1_2;	//Конечное напряжение контроля емкости при разряде за 1/2 часа
;;;1163   		U_end_from_i_table[2]=BAT_U_END_1;		//Конечное напряжение контроля емкости при разряде за 1 час
;;;1164   		U_end_from_i_table[3]=BAT_U_END_3;		//Конечное напряжение контроля емкости при разряде за 3 часа
;;;1165   		U_end_from_i_table[4]=BAT_U_END_5;		//Конечное напряжение контроля емкости при разряде за 5 часов
;;;1166   		U_end_from_i_table[5]=BAT_U_END_10;		//Конечное напряжение контроля емкости при разряде за 10 часов
;;;1167   		U_end_from_i_table[6]=BAT_U_END_20;		//Конечное напряжение контроля емкости при разряде за 20 часов		
;;;1168   
;;;1169   		bat_hndl_plazma[1]=ke_drv_i_avg;
;;;1170   		bat_hndl_i_temp=ke_drv_i_avg;
000eaa  4cbf              LDR      r4,|L1.4520|
000eac  b2c9              UXTB     r1,r1                 ;1138
000eae  3c80              SUBS     r4,r4,#0x80
000eb0  7371              STRB     r1,[r6,#0xd]          ;1138
000eb2  290a              CMP      r1,#0xa               ;1138
000eb4  d967              BLS      |L1.3974|
000eb6  7375              STRB     r5,[r6,#0xd]          ;1140
000eb8  7bb1              LDRB     r1,[r6,#0xe]          ;1142  ; i_bat_buff_cnt
000eba  f1010101          ADD      r1,r1,#1              ;1142
000ebe  b2c9              UXTB     r1,r1                 ;1142
000ec0  73b1              STRB     r1,[r6,#0xe]          ;1142
000ec2  2906              CMP      r1,#6                 ;1143
000ec4  d300              BCC      |L1.3784|
000ec6  73b5              STRB     r5,[r6,#0xe]          ;1143
                  |L1.3784|
000ec8  7bb1              LDRB     r1,[r6,#0xe]          ;1144  ; i_bat_buff_cnt
000eca  6091              STR      r1,[r2,#8]            ;1144  ; bat_hndl_plazma
000ecc  f8230011          STRH     r0,[r3,r1,LSL #1]     ;1145
000ed0  f04f0100          MOV      r1,#0                 ;1146
000ed4  4608              MOV      r0,r1                 ;1147
                  |L1.3798|
000ed6  f833c010          LDRH     r12,[r3,r0,LSL #1]    ;1149
000eda  4461              ADD      r1,r1,r12             ;1149
000edc  b209              SXTH     r1,r1                 ;1149
000ede  f1000001          ADD      r0,r0,#1              ;1147
000ee2  b2c0              UXTB     r0,r0                 ;1147
000ee4  2806              CMP      r0,#6                 ;1147
000ee6  d3f6              BCC      |L1.3798|
000ee8  f04f0006          MOV      r0,#6                 ;1151
000eec  fb91f0f0          SDIV     r0,r1,r0              ;1151
000ef0  b201              SXTH     r1,r0                 ;1151
000ef2  48b3              LDR      r0,|L1.4544|
000ef4  f8df82c4          LDR      r8,|L1.4540|
000ef8  8800              LDRH     r0,[r0,#0]            ;1153  ; BAT_C_POINT_1_6
000efa  f1a8081c          SUB      r8,r8,#0x1c           ;1153
000efe  eb000040          ADD      r0,r0,r0,LSL #1       ;1153
000f02  ea4f0040          LSL      r0,r0,#1              ;1153
000f06  f8a80000          STRH     r0,[r8,#0]            ;1153
000f0a  48ae              LDR      r0,|L1.4548|
000f0c  8800              LDRH     r0,[r0,#0]            ;1154  ; BAT_C_POINT_1_2
000f0e  ea4f0040          LSL      r0,r0,#1              ;1154
000f12  f8a80002          STRH     r0,[r8,#2]            ;1154
000f16  48ac              LDR      r0,|L1.4552|
000f18  8800              LDRH     r0,[r0,#0]            ;1155  ; BAT_C_POINT_1
000f1a  f8a80004          STRH     r0,[r8,#4]            ;1155
000f1e  48ab              LDR      r0,|L1.4556|
000f20  f04f0303          MOV      r3,#3                 ;1156
000f24  f9b00000          LDRSH    r0,[r0,#0]            ;1156  ; BAT_C_POINT_3
000f28  fb90f0f3          SDIV     r0,r0,r3              ;1156
000f2c  f8a80006          STRH     r0,[r8,#6]            ;1156
000f30  48a7              LDR      r0,|L1.4560|
000f32  f04f0305          MOV      r3,#5                 ;1157
000f36  f9b00000          LDRSH    r0,[r0,#0]            ;1157  ; BAT_C_POINT_5
000f3a  fb90f0f3          SDIV     r0,r0,r3              ;1157
000f3e  f8a80008          STRH     r0,[r8,#8]            ;1157
000f42  48a4              LDR      r0,|L1.4564|
000f44  f9b00000          LDRSH    r0,[r0,#0]            ;1158  ; BAT_C_POINT_10
000f48  fb90f0f7          SDIV     r0,r0,r7              ;1158
000f4c  f8a8000a          STRH     r0,[r8,#0xa]          ;1158
000f50  48a1              LDR      r0,|L1.4568|
000f52  f04f0314          MOV      r3,#0x14              ;1159
000f56  f9b00000          LDRSH    r0,[r0,#0]            ;1159  ; BAT_C_POINT_20
000f5a  fb90f0f3          SDIV     r0,r0,r3              ;1159
000f5e  f8a8000c          STRH     r0,[r8,#0xc]          ;1159
000f62  489e              LDR      r0,|L1.4572|
000f64  f108090e          ADD      r9,r8,#0xe            ;1161
000f68  f9b07000          LDRSH    r7,[r0,#0]            ;1161  ; BAT_U_END_1_6
000f6c  f8a97000          STRH     r7,[r9,#0]            ;1161
000f70  489b              LDR      r0,|L1.4576|
000f72  8800              LDRH     r0,[r0,#0]            ;1162  ; BAT_U_END_1_2
000f74  f8a90002          STRH     r0,[r9,#2]            ;1162
000f78  489a              LDR      r0,|L1.4580|
000f7a  8800              LDRH     r0,[r0,#0]            ;1163  ; BAT_U_END_1
000f7c  f8a90004          STRH     r0,[r9,#4]            ;1163
000f80  4899              LDR      r0,|L1.4584|
000f82  e001              B        |L1.3976|
                  |L1.3972|
000f84  e0ea              B        |L1.4444|
                  |L1.3974|
000f86  e061              B        |L1.4172|
                  |L1.3976|
000f88  8800              LDRH     r0,[r0,#0]            ;1164  ; BAT_U_END_3
000f8a  f8a90006          STRH     r0,[r9,#6]            ;1164
000f8e  4897              LDR      r0,|L1.4588|
000f90  8800              LDRH     r0,[r0,#0]            ;1165  ; BAT_U_END_5
000f92  f8a90008          STRH     r0,[r9,#8]            ;1165
000f96  4896              LDR      r0,|L1.4592|
000f98  8800              LDRH     r0,[r0,#0]            ;1166  ; BAT_U_END_10
000f9a  f8a9000a          STRH     r0,[r9,#0xa]          ;1166
000f9e  4895              LDR      r0,|L1.4596|
000fa0  f9b0c000          LDRSH    r12,[r0,#0]           ;1167  ; BAT_U_END_20
000fa4  f8a9c00c          STRH     r12,[r9,#0xc]         ;1167
000fa8  6051              STR      r1,[r2,#4]            ;1169  ; bat_hndl_plazma
000faa  8121              STRH     r1,[r4,#8]
;;;1171   		
;;;1172   		for(i=0;i<7;i++)
000fac  f04f0000          MOV      r0,#0
                  |L1.4016|
;;;1173   			{
;;;1174   			if(bat_hndl_i_temp>=I_from_t_table[i])
000fb0  f9383010          LDRSH    r3,[r8,r0,LSL #1]
000fb4  428b              CMP      r3,r1
000fb6  dd04              BLE      |L1.4034|
000fb8  f1000001          ADD      r0,r0,#1              ;1172
000fbc  b2c0              UXTB     r0,r0                 ;1172
000fbe  2807              CMP      r0,#7                 ;1172
000fc0  d3f6              BCC      |L1.4016|
                  |L1.4034|
;;;1175   				{
;;;1176   				break;
;;;1177   				}
;;;1178   			}
;;;1179   
;;;1180   		bat_hndl_plazma[0]=i;
000fc2  6010              STR      r0,[r2,#0]  ; bat_hndl_plazma
000fc4  f10d0a04          ADD      r10,sp,#4             ;1113
;;;1181   
;;;1182   		 if(i==0) bat_hndl_t_razr_ke=bat_hndl_t_razr_const[0];
000fc8  b1c8              CBZ      r0,|L1.4094|
;;;1183   		 else if((i>=1)&&(i<7))
000fca  1e42              SUBS     r2,r0,#1
000fcc  2a06              CMP      r2,#6
000fce  d219              BCS      |L1.4100|
;;;1184   		 	{
;;;1185   			short i1,i2;
;;;1186   			i1=I_from_t_table[i-1]-bat_hndl_i_temp;
000fd0  f8383012          LDRH     r3,[r8,r2,LSL #1]
000fd4  eba30101          SUB      r1,r3,r1
000fd8  b209              SXTH     r1,r1
;;;1187   			i2=I_from_t_table[i-1]-I_from_t_table[i];
000fda  f8388010          LDRH     r8,[r8,r0,LSL #1]
000fde  eba30308          SUB      r3,r3,r8
000fe2  b21b              SXTH     r3,r3
;;;1188   			bat_hndl_t_razr_ke=bat_hndl_t_razr_const[i]-bat_hndl_t_razr_const[i-1];
000fe4  f85a8020          LDR      r8,[r10,r0,LSL #2]
000fe8  f85a2022          LDR      r2,[r10,r2,LSL #2]
000fec  eba80802          SUB      r8,r8,r2
;;;1189   			bat_hndl_t_razr_ke*=(long)i1;
000ff0  fb08f801          MUL      r8,r8,r1
;;;1190   			bat_hndl_t_razr_ke/=(long)i2;
000ff4  fb98f1f3          SDIV     r1,r8,r3
;;;1191   			bat_hndl_t_razr_ke+=bat_hndl_t_razr_const[i-1];
000ff8  4411              ADD      r1,r1,r2
000ffa  6561              STR      r1,[r4,#0x54]  ; bat_hndl_t_razr_ke
;;;1192   			}
000ffc  e006              B        |L1.4108|
                  |L1.4094|
000ffe  9901              LDR      r1,[sp,#4]            ;1182
001000  6561              STR      r1,[r4,#0x54]         ;1182  ; bat_hndl_t_razr_ke
001002  e003              B        |L1.4108|
                  |L1.4100|
;;;1193   		else if(i>=7)
001004  2807              CMP      r0,#7
001006  d301              BCC      |L1.4108|
;;;1194   			{
;;;1195   			bat_hndl_t_razr_ke=bat_hndl_t_razr_const[6];
001008  9907              LDR      r1,[sp,#0x1c]
00100a  6561              STR      r1,[r4,#0x54]  ; bat_hndl_t_razr_ke
                  |L1.4108|
;;;1196   			}
;;;1197   
;;;1198   		 if(i==0) bat_hndl_u_end=U_end_from_i_table[0];
00100c  b1c0              CBZ      r0,|L1.4160|
;;;1199   		 else if((i>=1)&&(i<7))
00100e  1e41              SUBS     r1,r0,#1
001010  2906              CMP      r1,#6
001012  d217              BCS      |L1.4164|
;;;1200   		 	{
;;;1201   			long u1,tempL;
;;;1202   
;;;1203   			tempL=(long)U_end_from_i_table[i]-(long)U_end_from_i_table[i-1];
001014  f9393010          LDRSH    r3,[r9,r0,LSL #1]
001018  f9392011          LDRSH    r2,[r9,r1,LSL #1]
00101c  eba30302          SUB      r3,r3,r2
;;;1204   			u1=bat_hndl_t_razr_ke-bat_hndl_t_razr_const[i-1];
001020  f85a1021          LDR      r1,[r10,r1,LSL #2]
001024  6d67              LDR      r7,[r4,#0x54]  ; bat_hndl_t_razr_ke
001026  eba70701          SUB      r7,r7,r1
;;;1205   			tempL*=u1;
00102a  fb03f307          MUL      r3,r3,r7
;;;1206   			u1=bat_hndl_t_razr_const[i]-bat_hndl_t_razr_const[i-1];
00102e  f85a0020          LDR      r0,[r10,r0,LSL #2]
001032  eba00001          SUB      r0,r0,r1
;;;1207   			tempL/=u1;
001036  fb93f0f0          SDIV     r0,r3,r0
;;;1208   			tempL+=(long)U_end_from_i_table[i-1];
00103a  4410              ADD      r0,r0,r2
;;;1209   			bat_hndl_u_end=(short)tempL;
00103c  8160              STRH     r0,[r4,#0xa]
;;;1210   			}
00103e  e005              B        |L1.4172|
                  |L1.4160|
001040  8167              STRH     r7,[r4,#0xa]          ;1198
001042  e003              B        |L1.4172|
                  |L1.4164|
;;;1211   		else if(i>=7)
001044  2807              CMP      r0,#7
001046  d301              BCC      |L1.4172|
;;;1212   			{
;;;1213   			bat_hndl_u_end=U_end_from_i_table[6];
001048  f8a4c00a          STRH     r12,[r4,#0xa]
                  |L1.4172|
;;;1214   			}
;;;1215   
;;;1216   		}
;;;1217   
;;;1218   
;;;1219   
;;;1220   	if(spc_phase==0)
00104c  f8960025          LDRB     r0,[r6,#0x25]  ; spc_phase
;;;1221   		{
;;;1222   		//mess_send(MESS2BAT_HNDL,PARAM_BAT_MASK_OFF_AFTER_2SEC,(1<<(1-spc_bat)),20);
;;;1223   		mess_send(MESS2BPS_HNDL,PARAM_BPS_ALL_OFF_AFTER_2SEC,0xffff,20);
;;;1224   
;;;1225   		bat[0]._zar_cnt_ke+=abs(bat[spc_bat]._Ib);
;;;1226   	    	
;;;1227   		if(bat[0]._zar_cnt_ke>=AH_CONSTANT)
;;;1228   			{
;;;1229   			bat[0]._zar_cnt_ke-=AH_CONSTANT;
;;;1230   			lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[0],lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[0])+1);
001050  4f69              LDR      r7,|L1.4600|
;;;1231   			}
;;;1232   
;;;1233   		bat[0]._time_min_cnt_ke++;
;;;1234   		if(bat[0]._time_min_cnt_ke>=60)
;;;1235   			{
;;;1236   			lc640_write_int(EE_ZVU_BAT_MIN_CNT_KE,lc640_read_int(EE_ZVU_BAT_MIN_CNT_KE)+1);
001052  f44f78e3          MOV      r8,#0x1c6
001056  bbe8              CBNZ     r0,|L1.4308|
001058  2314              MOVS     r3,#0x14              ;1223
00105a  f04f32ff          MOV      r2,#0xffffffff        ;1223
00105e  21ce              MOVS     r1,#0xce              ;1223
001060  20cd              MOVS     r0,#0xcd              ;1223
001062  f7fffffe          BL       mess_send
001066  f8961024          LDRB     r1,[r6,#0x24]         ;1225  ; spc_bat
00106a  f8df9190          LDR      r9,|L1.4604|
00106e  eb010041          ADD      r0,r1,r1,LSL #1       ;1225
001072  eb001001          ADD      r0,r0,r1,LSL #4       ;1225
001076  eb090080          ADD      r0,r9,r0,LSL #2       ;1225
00107a  f9b00008          LDRSH    r0,[r0,#8]            ;1225
00107e  f7fffffe          BL       abs
001082  f8d91018          LDR      r1,[r9,#0x18]         ;1225  ; bat
001086  4401              ADD      r1,r1,r0              ;1225
001088  f8c91018          STR      r1,[r9,#0x18]         ;1225  ; bat
00108c  f64840a0          MOV      r0,#0x8ca0            ;1227
001090  4281              CMP      r1,r0                 ;1227
001092  db0c              BLT      |L1.4270|
001094  eba10100          SUB      r1,r1,r0              ;1229
001098  f8c91018          STR      r1,[r9,#0x18]         ;1229  ; bat
00109c  8838              LDRH     r0,[r7,#0]            ;1230  ; ADR_EE_BAT_ZAR_CNT_KE
00109e  f7fffffe          BL       lc640_read_int
0010a2  1c40              ADDS     r0,r0,#1              ;1230
0010a4  b201              SXTH     r1,r0                 ;1230
0010a6  f9b70000          LDRSH    r0,[r7,#0]            ;1230  ; ADR_EE_BAT_ZAR_CNT_KE
0010aa  f7fffffe          BL       lc640_write_int
                  |L1.4270|
0010ae  f8b9004a          LDRH     r0,[r9,#0x4a]         ;1233  ; bat
0010b2  f1000001          ADD      r0,r0,#1              ;1233
0010b6  b281              UXTH     r1,r0                 ;1233
0010b8  f8a9104a          STRH     r1,[r9,#0x4a]         ;1233
0010bc  293c              CMP      r1,#0x3c              ;1234
0010be  d309              BCC      |L1.4308|
0010c0  4640              MOV      r0,r8
0010c2  f7fffffe          BL       lc640_read_int
0010c6  1c40              ADDS     r0,r0,#1
0010c8  b201              SXTH     r1,r0
0010ca  4640              MOV      r0,r8
0010cc  f7fffffe          BL       lc640_write_int
;;;1237   			bat[0]._time_min_cnt_ke=0;
0010d0  f8a9504a          STRH     r5,[r9,#0x4a]
                  |L1.4308|
;;;1238   			}
;;;1239   		}
;;;1240   
;;;1241   	else if(spc_phase==1)
;;;1242   		{
;;;1243   		//mess_send(MESS2BAT_HNDL,PARAM_BAT_MASK_OFF_AFTER_2SEC,(1<<(1-spc_bat)),20);
;;;1244   		}
;;;1245   
;;;1246   	if(out_U<bat_hndl_u_end)
0010d4  484a              LDR      r0,|L1.4608|
0010d6  f9b4100a          LDRSH    r1,[r4,#0xa]  ; bat_hndl_u_end
0010da  f9b00000          LDRSH    r0,[r0,#0]  ; out_U
0010de  4288              CMP      r0,r1
0010e0  da3a              BGE      |L1.4440|
;;;1247   		{
;;;1248   		cnt_end_ke++;
0010e2  f8b60066          LDRH     r0,[r6,#0x66]  ; cnt_end_ke
0010e6  f1000001          ADD      r0,r0,#1
0010ea  b200              SXTH     r0,r0
0010ec  f8a60066          STRH     r0,[r6,#0x66]
;;;1249   		if(cnt_end_ke>=30)
0010f0  281e              CMP      r0,#0x1e
0010f2  db33              BLT      |L1.4444|
;;;1250   			{
;;;1251   			
;;;1252   			if((spc_stat==spcKE)&&(spc_phase==0))
0010f4  f8960023          LDRB     r0,[r6,#0x23]  ; spc_stat
0010f8  2801              CMP      r0,#1
0010fa  d121              BNE      |L1.4416|
0010fc  f8960025          LDRB     r0,[r6,#0x25]  ; spc_phase
001100  b9f0              CBNZ     r0,|L1.4416|
;;;1253   				{
;;;1254   				lc640_write_int(ADR_EE_BAT_C_REAL[0],lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[0]));
001102  8838              LDRH     r0,[r7,#0]  ; ADR_EE_BAT_ZAR_CNT_KE
001104  f7fffffe          BL       lc640_read_int
001108  b201              SXTH     r1,r0
00110a  483e              LDR      r0,|L1.4612|
00110c  f9b00000          LDRSH    r0,[r0,#0]  ; ADR_EE_BAT_C_REAL
001110  f7fffffe          BL       lc640_write_int
;;;1255   				ke_zvu_mem_hndl(0,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[0]),lc640_read_int(EE_ZVU_BAT_MIN_CNT_KE));
001114  4640              MOV      r0,r8
001116  f7fffffe          BL       lc640_read_int
00111a  b284              UXTH     r4,r0
00111c  8838              LDRH     r0,[r7,#0]  ; ADR_EE_BAT_ZAR_CNT_KE
00111e  f7fffffe          BL       lc640_read_int
001122  b281              UXTH     r1,r0
001124  4622              MOV      r2,r4
001126  2000              MOVS     r0,#0
001128  f7fffffe          BL       ke_zvu_mem_hndl
;;;1256   				lc640_write_int(ADR_EE_BAT_ZAR_CNT[0],0);
00112c  4836              LDR      r0,|L1.4616|
00112e  2100              MOVS     r1,#0
001130  f9b00000          LDRSH    r0,[r0,#0]  ; ADR_EE_BAT_ZAR_CNT
001134  f7fffffe          BL       lc640_write_int
;;;1257   				cntrl_stat=50;
001138  f04f0032          MOV      r0,#0x32
00113c  8670              STRH     r0,[r6,#0x32]
;;;1258   				cntrl_stat_old=50;
00113e  86b0              STRH     r0,[r6,#0x34]
                  |L1.4416|
;;;1259   				}
;;;1260   
;;;1261   			spc_stat=spcOFF;
001140  f8865023          STRB     r5,[r6,#0x23]
;;;1262   			__ee_spc_stat=spcOFF;
001144  f8a6506a          STRH     r5,[r6,#0x6a]
;;;1263   			lc640_write_int(EE_SPC_STAT,spcOFF);
001148  b008              ADD      sp,sp,#0x20
00114a  2100              MOVS     r1,#0
00114c  e8bd47f0          POP      {r4-r10,lr}
001150  f240209a          MOV      r0,#0x29a
001154  f7ffbffe          B.W      lc640_write_int
                  |L1.4440|
;;;1264   
;;;1265   			}
;;;1266   		}
;;;1267   	else cnt_end_ke=0;
001158  f8a65066          STRH     r5,[r6,#0x66]
                  |L1.4444|
;;;1268   
;;;1269   	}
;;;1270   			
;;;1271   }
00115c  b008              ADD      sp,sp,#0x20
00115e  e8bd87f0          POP      {r4-r10,pc}
;;;1272   #endif
                          ENDP

                  vz_start PROC
;;;1342   //-----------------------------------------------
;;;1343   char vz_start(char hour)
001162  b570              PUSH     {r4-r6,lr}
;;;1344   {          
001164  4605              MOV      r5,r0
;;;1345   char out;
;;;1346   out=0;
001166  f04f0600          MOV      r6,#0
;;;1347   if((spc_stat==spcOFF)&&(speedChrgBlckStat!=1))
00116a  4c11              LDR      r4,|L1.4528|
00116c  f8940023          LDRB     r0,[r4,#0x23]  ; spc_stat
001170  b9a8              CBNZ     r0,|L1.4510|
001172  4826              LDR      r0,|L1.4620|
001174  8800              LDRH     r0,[r0,#0]  ; speedChrgBlckStat
001176  2801              CMP      r0,#1
001178  d06a              BEQ      |L1.4688|
;;;1348   	{
;;;1349   	spc_stat=spcVZ;
00117a  f104042c          ADD      r4,r4,#0x2c
00117e  f04f0102          MOV      r1,#2
001182  f8041c09          STRB     r1,[r4,#-9]
;;;1350   	__ee_spc_stat=spcVZ; 
001186  87e1              STRH     r1,[r4,#0x3e]
;;;1351   	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);   
001188  f240209a          MOV      r0,#0x29a
00118c  f7fffffe          BL       lc640_write_int
;;;1352   	vz_cnt_h=hour;
001190  86e5              STRH     r5,[r4,#0x36]
;;;1353   	__ee_vz_cnt=hour*60;
001192  ebc51005          RSB      r0,r5,r5,LSL #4
001196  ea4f0080          LSL      r0,r0,#2
00119a  87a0              STRH     r0,[r4,#0x3c]
00119c  e038              B        |L1.4624|
                  |L1.4510|
00119e  e057              B        |L1.4688|
                  |L1.4512|
                          DCD      bat_u_old_cnt
                  |L1.4516|
                          DCD      0x40024020
                  |L1.4520|
                          DCD      ||area_number.26||+0x100
                  |L1.4524|
                          DCD      ||area_number.20||+0x4
                  |L1.4528|
                          DCD      ||area_number.26||
                  |L1.4532|
                          DCD      ||.bss||
                  |L1.4536|
                          DCD      Ib_ips_termokompensat
                  |L1.4540|
                          DCD      ||.bss||+0x468
                  |L1.4544|
                          DCD      BAT_C_POINT_1_6
                  |L1.4548|
                          DCD      BAT_C_POINT_1_2
                  |L1.4552|
                          DCD      BAT_C_POINT_1
                  |L1.4556|
                          DCD      BAT_C_POINT_3
                  |L1.4560|
                          DCD      BAT_C_POINT_5
                  |L1.4564|
                          DCD      BAT_C_POINT_10
                  |L1.4568|
                          DCD      BAT_C_POINT_20
                  |L1.4572|
                          DCD      BAT_U_END_1_6
                  |L1.4576|
                          DCD      BAT_U_END_1_2
                  |L1.4580|
                          DCD      BAT_U_END_1
                  |L1.4584|
                          DCD      BAT_U_END_3
                  |L1.4588|
                          DCD      BAT_U_END_5
                  |L1.4592|
                          DCD      BAT_U_END_10
                  |L1.4596|
                          DCD      BAT_U_END_20
                  |L1.4600|
                          DCD      ADR_EE_BAT_ZAR_CNT_KE
                  |L1.4604|
                          DCD      bat
                  |L1.4608|
                          DCD      out_U
                  |L1.4612|
                          DCD      ADR_EE_BAT_C_REAL
                  |L1.4616|
                          DCD      ADR_EE_BAT_ZAR_CNT
                  |L1.4620|
                          DCD      speedChrgBlckStat
                  |L1.4624|
001210  f1a4042c          SUB      r4,r4,#0x2c
;;;1354   	if(hour==0)__ee_vz_cnt=30;
001214  b91d              CBNZ     r5,|L1.4638|
001216  f04f001e          MOV      r0,#0x1e
00121a  f8a40068          STRH     r0,[r4,#0x68]
                  |L1.4638|
;;;1355   	lc640_write_int(EE_VZ_CNT,__ee_vz_cnt);
00121e  f104045e          ADD      r4,r4,#0x5e
001222  f44f7027          MOV      r0,#0x29c
001226  f9b4100a          LDRSH    r1,[r4,#0xa]  ; __ee_vz_cnt
00122a  f7fffffe          BL       lc640_write_int
;;;1356   	lc640_write_int(EE_SPC_VZ_LENGT,__ee_vz_cnt);	
00122e  f9b4100a          LDRSH    r1,[r4,#0xa]  ; __ee_vz_cnt
001232  f44f702a          MOV      r0,#0x2a8
001236  f7fffffe          BL       lc640_write_int
;;;1357   	vz_cnt_h_=0;
00123a  f04f0000          MOV      r0,#0
00123e  80e0              STRH     r0,[r4,#6]
;;;1358   	vz_cnt_s=0;
001240  8020              STRH     r0,[r4,#0]
;;;1359   	vz_cnt_s_=0;
001242  8060              STRH     r0,[r4,#2]
;;;1360   	out=1;
001244  f04f0601          MOV      r6,#1
;;;1361   	vz_mem_hndl(1);
001248  f04f0001          MOV      r0,#1
00124c  f7fffffe          BL       vz_mem_hndl
                  |L1.4688|
;;;1362   	}
;;;1363   //else if((spc_stat==spc_KE1p1)||(spc_stat==spc_KE1p2)) out=22; 
;;;1364   //else if((spc_stat==spc_KE2p1)||(spc_stat==spc_KE2p2)) out=33;
;;;1365   //plazma=out;	
;;;1366   return out;
001250  4630              MOV      r0,r6
;;;1367   }
001252  bd70              POP      {r4-r6,pc}
;;;1368   
                          ENDP

                  vz_stop PROC
;;;1369   //-----------------------------------------------
;;;1370   void vz_stop(void)
001254  b510              PUSH     {r4,lr}
;;;1371   {
;;;1372   if(spc_stat==spcVZ)
001256  4cff              LDR      r4,|L1.5716|
001258  f8940023          LDRB     r0,[r4,#0x23]  ; spc_stat
00125c  2802              CMP      r0,#2
00125e  d113              BNE      |L1.4744|
;;;1373        {
;;;1374   vz_mem_hndl(vz_cnt_h);          
001260  f104042c          ADD      r4,r4,#0x2c
001264  8ee0              LDRH     r0,[r4,#0x36]  ; vz_cnt_h
001266  f7fffffe          BL       vz_mem_hndl
;;;1375   vz_cnt_s=0;
00126a  f04f0000          MOV      r0,#0
00126e  8660              STRH     r0,[r4,#0x32]
;;;1376   vz_cnt_h=0;
001270  86e0              STRH     r0,[r4,#0x36]
;;;1377   vz_cnt_h_=0;
001272  8720              STRH     r0,[r4,#0x38]
;;;1378   spc_stat=spcOFF;
001274  f8040c09          STRB     r0,[r4,#-9]
;;;1379   
;;;1380   		__ee_spc_stat=spcOFF;
001278  87e0              STRH     r0,[r4,#0x3e]
;;;1381   		lc640_write_int(EE_SPC_STAT,spcOFF);
00127a  4601              MOV      r1,r0
00127c  e8bd4010          POP      {r4,lr}
001280  f240209a          MOV      r0,#0x29a
001284  f7ffbffe          B.W      lc640_write_int
                  |L1.4744|
;;;1382        }
;;;1383   
;;;1384   }
001288  bd10              POP      {r4,pc}
;;;1385   
                          ENDP

                  amper_chas_cnt_drv PROC
;;;1387   //-----------------------------------------------
;;;1388   void amper_chas_cnt_drv(void)
00128a  b510              PUSH     {r4,lr}
;;;1389   {
;;;1390   
;;;1391   amper_chas_cnt_drv_summ+=(long)Ib_ips_termokompensat;
00128c  4af1              LDR      r2,|L1.5716|
00128e  49f2              LDR      r1,|L1.5720|
001290  3280              ADDS     r2,r2,#0x80
001292  f9b11000          LDRSH    r1,[r1,#0]  ; Ib_ips_termokompensat
001296  6e50              LDR      r0,[r2,#0x64]  ; amper_chas_cnt_drv_summ
001298  4401              ADD      r1,r1,r0
00129a  6651              STR      r1,[r2,#0x64]  ; amper_chas_cnt_drv_summ
;;;1392   
;;;1393   if(amper_chas_cnt_drv_summ>=36000L)
00129c  f64843a0          MOV      r3,#0x8ca0
;;;1394   	{
;;;1395   	amper_chas_cnt_drv_summ-=36000L;
;;;1396   	lc640_write_int(EE_AMPER_CHAS_CNT,lc640_read_int(EE_AMPER_CHAS_CNT)+1);
0012a0  f44f74e4          MOV      r4,#0x1c8
0012a4  4299              CMP      r1,r3                 ;1393
0012a6  db0c              BLT      |L1.4802|
0012a8  eba10103          SUB      r1,r1,r3              ;1395
0012ac  6651              STR      r1,[r2,#0x64]         ;1395  ; amper_chas_cnt_drv_summ
0012ae  4620              MOV      r0,r4
0012b0  f7fffffe          BL       lc640_read_int
0012b4  1c40              ADDS     r0,r0,#1
0012b6  b201              SXTH     r1,r0
0012b8  4620              MOV      r0,r4
0012ba  e8bd4010          POP      {r4,lr}
0012be  f7ffbffe          B.W      lc640_write_int
                  |L1.4802|
;;;1397   	}
;;;1398   else if(amper_chas_cnt_drv_summ<=-36000L)
0012c2  48e6              LDR      r0,|L1.5724|
0012c4  4281              CMP      r1,r0
0012c6  dc0c              BGT      |L1.4834|
;;;1399   	{
;;;1400   	amper_chas_cnt_drv_summ+=36000L;
0012c8  eb010003          ADD      r0,r1,r3
0012cc  6650              STR      r0,[r2,#0x64]  ; amper_chas_cnt_drv_summ
;;;1401   	lc640_write_int(EE_AMPER_CHAS_CNT,lc640_read_int(EE_AMPER_CHAS_CNT)-1);
0012ce  4620              MOV      r0,r4
0012d0  f7fffffe          BL       lc640_read_int
0012d4  1e40              SUBS     r0,r0,#1
0012d6  b201              SXTH     r1,r0
0012d8  4620              MOV      r0,r4
0012da  e8bd4010          POP      {r4,lr}
0012de  f7ffbffe          B.W      lc640_write_int
                  |L1.4834|
;;;1402   	}
;;;1403   }
0012e2  bd10              POP      {r4,pc}
;;;1404   #endif
                          ENDP

                  avz_next_date_hndl PROC
;;;1406   //-----------------------------------------------
;;;1407   void avz_next_date_hndl(void)
0012e4  b570              PUSH     {r4-r6,lr}
;;;1408   {
;;;1409   if((LPC_RTC->MONTH+AVZ)>12)lc640_write_int(EE_YEAR_AVZ,LPC_RTC->YEAR+1);
0012e6  4cde              LDR      r4,|L1.5728|
0012e8  f8940038          LDRB     r0,[r4,#0x38]
0012ec  4ddd              LDR      r5,|L1.5732|
0012ee  7829              LDRB     r1,[r5,#0]  ; AVZ
0012f0  4408              ADD      r0,r0,r1
0012f2  280c              CMP      r0,#0xc
0012f4  d906              BLS      |L1.4868|
0012f6  8fa0              LDRH     r0,[r4,#0x3c]
0012f8  1c40              ADDS     r0,r0,#1
0012fa  b201              SXTH     r1,r0
0012fc  20b8              MOVS     r0,#0xb8
0012fe  f7fffffe          BL       lc640_write_int
001302  e004              B        |L1.4878|
                  |L1.4868|
;;;1410   else lc640_write_int(EE_YEAR_AVZ,LPC_RTC->YEAR);
001304  f9b4103c          LDRSH    r1,[r4,#0x3c]
001308  20b8              MOVS     r0,#0xb8
00130a  f7fffffe          BL       lc640_write_int
                  |L1.4878|
;;;1411   
;;;1412   //lc640_write_int(EE_YEAR_AVZ,6);
;;;1413   
;;;1414   if((LPC_RTC->MONTH+AVZ)>12)lc640_write_int(EE_MONTH_AVZ,(LPC_RTC->MONTH+AVZ)-12);
00130e  f8941038          LDRB     r1,[r4,#0x38]
001312  7828              LDRB     r0,[r5,#0]  ; AVZ
001314  4401              ADD      r1,r1,r0
001316  290c              CMP      r1,#0xc
001318  d907              BLS      |L1.4906|
00131a  f8941038          LDRB     r1,[r4,#0x38]
00131e  380c              SUBS     r0,r0,#0xc
001320  4401              ADD      r1,r1,r0
001322  20b6              MOVS     r0,#0xb6
001324  f7fffffe          BL       lc640_write_int
001328  e005              B        |L1.4918|
                  |L1.4906|
;;;1415   else lc640_write_int(EE_MONTH_AVZ,LPC_RTC->MONTH+AVZ);                                                 
00132a  f8941038          LDRB     r1,[r4,#0x38]
00132e  4401              ADD      r1,r1,r0
001330  20b6              MOVS     r0,#0xb6
001332  f7fffffe          BL       lc640_write_int
                  |L1.4918|
;;;1416   
;;;1417   //lc640_write_int(EE_MONTH_AVZ,5);
;;;1418   
;;;1419   if(LPC_RTC->DOM>28) lc640_write_int(EE_DATE_AVZ,28);
001336  f894002c          LDRB     r0,[r4,#0x2c]
00133a  281c              CMP      r0,#0x1c
00133c  d904              BLS      |L1.4936|
00133e  211c              MOVS     r1,#0x1c
001340  20b4              MOVS     r0,#0xb4
001342  f7fffffe          BL       lc640_write_int
001346  e004              B        |L1.4946|
                  |L1.4936|
;;;1420   else lc640_write_int(EE_DATE_AVZ,LPC_RTC->DOM);
001348  f894102c          LDRB     r1,[r4,#0x2c]
00134c  20b4              MOVS     r0,#0xb4
00134e  f7fffffe          BL       lc640_write_int
                  |L1.4946|
;;;1421   
;;;1422   //lc640_write_int(EE_DATE_AVZ,4);
;;;1423   
;;;1424   lc640_write_int(EE_HOUR_AVZ,LPC_RTC->HOUR);
001352  f1040420          ADD      r4,r4,#0x20
001356  7a21              LDRB     r1,[r4,#8]
001358  f04f00ae          MOV      r0,#0xae
00135c  f7fffffe          BL       lc640_write_int
;;;1425   lc640_write_int(EE_MIN_AVZ,LPC_RTC->MIN);
001360  7921              LDRB     r1,[r4,#4]
001362  20b0              MOVS     r0,#0xb0
001364  f7fffffe          BL       lc640_write_int
;;;1426   lc640_write_int(EE_SEC_AVZ,LPC_RTC->SEC);
001368  7821              LDRB     r1,[r4,#0]
00136a  e8bd4070          POP      {r4-r6,lr}
00136e  20b2              MOVS     r0,#0xb2
001370  f7ffbffe          B.W      lc640_write_int
;;;1427   
;;;1428   }
;;;1429   
                          ENDP

                  avz_drv PROC
;;;1430   //-----------------------------------------------
;;;1431   void avz_drv(void)                               
001374  b510              PUSH     {r4,lr}
;;;1432   {                
;;;1433   if(AVZ!=AVZ_OFF)
001376  48bb              LDR      r0,|L1.5732|
;;;1434   	{
;;;1435   	if((LPC_RTC->YEAR==YEAR_AVZ)&&(LPC_RTC->MONTH==MONTH_AVZ)&&(LPC_RTC->DOM==DATE_AVZ)&&(LPC_RTC->HOUR==HOUR_AVZ)&&(LPC_RTC->MIN==MIN_AVZ)&&(LPC_RTC->SEC==SEC_AVZ))
;;;1436   		{
;;;1437   		bAVZ=1;
001378  4cb6              LDR      r4,|L1.5716|
00137a  7800              LDRB     r0,[r0,#0]            ;1433  ; AVZ
00137c  b338              CBZ      r0,|L1.5070|
00137e  48b8              LDR      r0,|L1.5728|
001380  8f82              LDRH     r2,[r0,#0x3c]         ;1435
001382  49b9              LDR      r1,|L1.5736|
001384  8809              LDRH     r1,[r1,#0]            ;1435  ; YEAR_AVZ
001386  428a              CMP      r2,r1                 ;1435
001388  d121              BNE      |L1.5070|
00138a  f8902038          LDRB     r2,[r0,#0x38]         ;1435
00138e  49b7              LDR      r1,|L1.5740|
001390  8809              LDRH     r1,[r1,#0]            ;1435  ; MONTH_AVZ
001392  428a              CMP      r2,r1                 ;1435
001394  d11b              BNE      |L1.5070|
001396  f890102c          LDRB     r1,[r0,#0x2c]         ;1435
00139a  4ab5              LDR      r2,|L1.5744|
00139c  8812              LDRH     r2,[r2,#0]            ;1435  ; DATE_AVZ
00139e  4291              CMP      r1,r2                 ;1435
0013a0  d115              BNE      |L1.5070|
0013a2  f8901028          LDRB     r1,[r0,#0x28]         ;1435
0013a6  4ab3              LDR      r2,|L1.5748|
0013a8  8812              LDRH     r2,[r2,#0]            ;1435  ; HOUR_AVZ
0013aa  4291              CMP      r1,r2                 ;1435
0013ac  d10f              BNE      |L1.5070|
0013ae  f8901024          LDRB     r1,[r0,#0x24]         ;1435
0013b2  4ab1              LDR      r2,|L1.5752|
0013b4  8812              LDRH     r2,[r2,#0]            ;1435  ; MIN_AVZ
0013b6  4291              CMP      r1,r2                 ;1435
0013b8  d109              BNE      |L1.5070|
0013ba  f8900020          LDRB     r0,[r0,#0x20]         ;1435
0013be  49af              LDR      r1,|L1.5756|
0013c0  8809              LDRH     r1,[r1,#0]            ;1435  ; SEC_AVZ
0013c2  4288              CMP      r0,r1                 ;1435
0013c4  d103              BNE      |L1.5070|
0013c6  f04f0001          MOV      r0,#1
0013ca  f8840026          STRB     r0,[r4,#0x26]
                  |L1.5070|
;;;1438   		}
;;;1439   	}
;;;1440   if(bAVZ)
0013ce  f8940026          LDRB     r0,[r4,#0x26]  ; bAVZ
0013d2  2800              CMP      r0,#0
0013d4  d00d              BEQ      |L1.5106|
;;;1441   	{
;;;1442   	if(vz_start(AVZ_TIME))
0013d6  48aa              LDR      r0,|L1.5760|
0013d8  8800              LDRH     r0,[r0,#0]  ; AVZ_TIME
0013da  b2c0              UXTB     r0,r0
0013dc  f7fffffe          BL       vz_start
0013e0  2800              CMP      r0,#0
0013e2  d006              BEQ      |L1.5106|
;;;1443   		{
;;;1444   		bAVZ=0;
0013e4  f04f0000          MOV      r0,#0
0013e8  f8840026          STRB     r0,[r4,#0x26]
;;;1445   		avz_next_date_hndl();
0013ec  e8bd4010          POP      {r4,lr}
0013f0  e7fe              B        avz_next_date_hndl
                  |L1.5106|
;;;1446   		}
;;;1447   	}	
;;;1448   
;;;1449   }
0013f2  bd10              POP      {r4,pc}
;;;1450   
                          ENDP

                  vz_drv PROC
;;;1451   //-----------------------------------------------
;;;1452   void vz_drv(void)
0013f4  b538              PUSH     {r3-r5,lr}
;;;1453   { 
;;;1454   if(spc_stat==spcVZ)
0013f6  4c97              LDR      r4,|L1.5716|
0013f8  f8940023          LDRB     r0,[r4,#0x23]  ; spc_stat
0013fc  2802              CMP      r0,#2
0013fe  d11d              BNE      |L1.5180|
;;;1455   	{
;;;1456   #ifndef UKU_6U
;;;1457   	if((sk_stat[0]==1)||(VZ_CH_VENT_BLOK==0))
001400  48a0              LDR      r0,|L1.5764|
001402  7800              LDRB     r0,[r0,#0]  ; sk_stat
001404  2801              CMP      r0,#1
001406  d01a              BEQ      |L1.5182|
001408  489f              LDR      r0,|L1.5768|
00140a  8800              LDRH     r0,[r0,#0]  ; VZ_CH_VENT_BLOK
00140c  2800              CMP      r0,#0
00140e  d016              BEQ      |L1.5182|
;;;1458   #endif //UKU_6U
;;;1459   		{
;;;1460   
;;;1461   		if(vz_cnt_s_<3600)
;;;1462   			{
;;;1463   			vz_cnt_s_++;
;;;1464   			if(vz_cnt_s_>=3600)
;;;1465   				{
;;;1466   				vz_cnt_s_=0;
;;;1467   				if(vz_cnt_h)
;;;1468   					{
;;;1469   					vz_cnt_h--;
;;;1470   					vz_cnt_h_++;
;;;1471   					}
;;;1472   				}
;;;1473   			}
;;;1474   	
;;;1475   	
;;;1476   		if(vz_cnt_s<60)
;;;1477   			{
;;;1478   			vz_cnt_s++;
;;;1479   			if(vz_cnt_s>=60)
;;;1480   				{
;;;1481   				vz_cnt_s=0;
;;;1482   				
;;;1483   				__ee_vz_cnt--;
;;;1484   				lc640_write_int(EE_VZ_CNT,__ee_vz_cnt);
;;;1485   				if((!__ee_vz_cnt)||(speedChrgBlckStat==1))
;;;1486   					{
;;;1487   					spc_stat=spcOFF;
;;;1488   							__ee_spc_stat=spcOFF;
;;;1489   			lc640_write_int(EE_SPC_STAT,spcOFF);
;;;1490   	
;;;1491   	//				hv_vz_stat=hvsOFF;
;;;1492   	//		lc640_write(EE_HV_VZ_STAT,hvsOFF);
;;;1493   					vz_mem_hndl(0);
;;;1494   					}
;;;1495   				}
;;;1496   			}
;;;1497   		vz_error=0; 
;;;1498   		}
;;;1499   #ifndef UKU_6U
;;;1500   	else 
;;;1501   		{
;;;1502   		vz_error=1; 
001410  f04f0001          MOV      r0,#1
001414  7060              STRB     r0,[r4,#1]
;;;1503   		if(((LPC_RTC->SEC)%10)==0)
001416  489d              LDR      r0,|L1.5772|
001418  7800              LDRB     r0,[r0,#0]
00141a  f04f010a          MOV      r1,#0xa
00141e  fbb0f2f1          UDIV     r2,r0,r1
001422  fb010012          MLS      r0,r1,r2,r0
001426  2800              CMP      r0,#0
001428  d108              BNE      |L1.5180|
;;;1504   			{
;;;1505   			show_mess(	"ВЫРАВНИВАЮЩИЙ ЗАРЯД ",
00142a  f2413088          MOV      r0,#0x1388
00142e  9000              STR      r0,[sp,#0]
001430  a397              ADR      r3,|L1.5776|
001432  a29d              ADR      r2,|L1.5800|
001434  a1a2              ADR      r1,|L1.5824|
001436  a0a8              ADR      r0,|L1.5848|
001438  f7fffffe          BL       show_mess
                  |L1.5180|
;;;1506   						"    ЗАБЛОКИРОВАН    ",
;;;1507   						"     НЕИСПРАВНА     ",
;;;1508   						"    ВЕНТИЛЯЦИЯ!!!   ",
;;;1509   						5000);			
;;;1510   			}
;;;1511   		}
;;;1512   #endif //UKU_6U
;;;1513   /*	if(vz_cnt_s_>=3)
;;;1514   		{
;;;1515   		if(sk_stat[0]==0)
;;;1516   		} */
;;;1517   
;;;1518   	}
;;;1519   
;;;1520   
;;;1521   } 
00143c  bd38              POP      {r3-r5,pc}
                  |L1.5182|
00143e  f8b40060          LDRH     r0,[r4,#0x60]         ;1461  ; vz_cnt_s_
001442  f44f6161          MOV      r1,#0xe10             ;1461
001446  2500              MOVS     r5,#0                 ;1457
001448  4288              CMP      r0,r1                 ;1461
00144a  d215              BCS      |L1.5240|
00144c  f1000001          ADD      r0,r0,#1              ;1463
001450  b280              UXTH     r0,r0                 ;1463
001452  f8a40060          STRH     r0,[r4,#0x60]         ;1463
001456  4288              CMP      r0,r1                 ;1464
001458  d30e              BCC      |L1.5240|
00145a  f8a45060          STRH     r5,[r4,#0x60]         ;1466
00145e  f8b40062          LDRH     r0,[r4,#0x62]         ;1467  ; vz_cnt_h
001462  b148              CBZ      r0,|L1.5240|
001464  f1a00001          SUB      r0,r0,#1              ;1469
001468  f8240f62          STRH     r0,[r4,#0x62]!        ;1469
00146c  8860              LDRH     r0,[r4,#2]            ;1470  ; vz_cnt_h_
00146e  f1000001          ADD      r0,r0,#1              ;1470
001472  8060              STRH     r0,[r4,#2]            ;1470
001474  f1a40462          SUB      r4,r4,#0x62           ;1470
                  |L1.5240|
001478  f8b4005e          LDRH     r0,[r4,#0x5e]         ;1476  ; vz_cnt_s
00147c  283c              CMP      r0,#0x3c              ;1476
00147e  d225              BCS      |L1.5324|
001480  f1000001          ADD      r0,r0,#1              ;1478
001484  b280              UXTH     r0,r0                 ;1478
001486  f8a4005e          STRH     r0,[r4,#0x5e]         ;1478
00148a  283c              CMP      r0,#0x3c              ;1479
00148c  d31e              BCC      |L1.5324|
00148e  f8245f5e          STRH     r5,[r4,#0x5e]!        ;1481
001492  8960              LDRH     r0,[r4,#0xa]          ;1483  ; __ee_vz_cnt
001494  f1a00001          SUB      r0,r0,#1              ;1483
001498  b201              SXTH     r1,r0                 ;1483
00149a  8161              STRH     r1,[r4,#0xa]          ;1483
00149c  f44f7027          MOV      r0,#0x29c             ;1484
0014a0  f7fffffe          BL       lc640_write_int
0014a4  8960              LDRH     r0,[r4,#0xa]          ;1485  ; __ee_vz_cnt
0014a6  f1a4045e          SUB      r4,r4,#0x5e           ;1485
0014aa  b118              CBZ      r0,|L1.5300|
0014ac  4890              LDR      r0,|L1.5872|
0014ae  8800              LDRH     r0,[r0,#0]            ;1485  ; speedChrgBlckStat
0014b0  2801              CMP      r0,#1                 ;1485
0014b2  d10b              BNE      |L1.5324|
                  |L1.5300|
0014b4  f8845023          STRB     r5,[r4,#0x23]         ;1487
0014b8  f8a4506a          STRH     r5,[r4,#0x6a]         ;1488
0014bc  2100              MOVS     r1,#0                 ;1489
0014be  f240209a          MOV      r0,#0x29a             ;1489
0014c2  f7fffffe          BL       lc640_write_int
0014c6  2000              MOVS     r0,#0                 ;1493
0014c8  f7fffffe          BL       vz_mem_hndl
                  |L1.5324|
0014cc  7065              STRB     r5,[r4,#1]            ;1497
0014ce  bd38              POP      {r3-r5,pc}
;;;1522   
                          ENDP

                  vz1_drv PROC
;;;1524   //драйвер уравнительного заряда
;;;1525   void vz1_drv(void)
0014d0  e92d4ff8          PUSH     {r3-r11,lr}
;;;1526   {
;;;1527   if(volt_region_cnt)volt_region_cnt--;
0014d4  f8df817c          LDR      r8,|L1.5716|
0014d8  f9b80078          LDRSH    r0,[r8,#0x78]  ; volt_region_cnt
0014dc  b118              CBZ      r0,|L1.5350|
0014de  f1a00001          SUB      r0,r0,#1
0014e2  f8a80078          STRH     r0,[r8,#0x78]
                  |L1.5350|
;;;1528   if(vz1_stat==vz1sOFF)
0014e6  f8980005          LDRB     r0,[r8,#5]  ; vz1_stat
0014ea  b928              CBNZ     r0,|L1.5368|
;;;1529   	{
;;;1530   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
0014ec  2314              MOVS     r3,#0x14
0014ee  2200              MOVS     r2,#0
0014f0  2164              MOVS     r1,#0x64
0014f2  20d2              MOVS     r0,#0xd2
0014f4  f7fffffe          BL       mess_send
                  |L1.5368|
;;;1531   	}
;;;1532   if(vz1_stat==vz1sSTEP1)
0014f8  f8980005          LDRB     r0,[r8,#5]  ; vz1_stat
;;;1533   	{
;;;1534   	if(vz1_stat_old!=vz1_stat)
;;;1535   		{
;;;1536   		vz1_stat_cnt=5;
;;;1537   		}
;;;1538   	if(vz1_stat_cnt)
;;;1539   		{
;;;1540   		vz1_stat_cnt--;
;;;1541   		if(vz1_stat_cnt==0)
;;;1542   			{
;;;1543   			vz1_stat=vz1sERR1; 	//Не включилась вентиляция;
;;;1544   			lc640_write(EE_VZ1_STAT,vz1sERR1);
;;;1545   			}
;;;1546   		}
;;;1547   	if(sk_stat[0]==1)
0014fc  4d61              LDR      r5,|L1.5764|
0014fe  f44f7bc9          MOV      r11,#0x192            ;1544
001502  2801              CMP      r0,#1                 ;1532
001504  d139              BNE      |L1.5498|
001506  f8980006          LDRB     r0,[r8,#6]            ;1534  ; vz1_stat_old
00150a  2801              CMP      r0,#1                 ;1534
00150c  d003              BEQ      |L1.5398|
00150e  f04f0005          MOV      r0,#5                 ;1536
001512  f8a80076          STRH     r0,[r8,#0x76]         ;1536
                  |L1.5398|
001516  f9b80076          LDRSH    r0,[r8,#0x76]         ;1538  ; vz1_stat_cnt
00151a  b168              CBZ      r0,|L1.5432|
00151c  f1a00001          SUB      r0,r0,#1              ;1540
001520  b200              SXTH     r0,r0                 ;1540
001522  f8a80076          STRH     r0,[r8,#0x76]         ;1540
001526  b938              CBNZ     r0,|L1.5432|
001528  f04f000b          MOV      r0,#0xb               ;1543
00152c  f8880005          STRB     r0,[r8,#5]            ;1543
001530  4601              MOV      r1,r0                 ;1544
001532  4658              MOV      r0,r11                ;1544
001534  f7fffffe          BL       lc640_write
                  |L1.5432|
001538  7828              LDRB     r0,[r5,#0]  ; sk_stat
00153a  2801              CMP      r0,#1
00153c  d117              BNE      |L1.5486|
;;;1548   		{
;;;1549   		vz1_stat=vz1sSTEP2;
00153e  f04f0002          MOV      r0,#2
001542  f8880005          STRB     r0,[r8,#5]
;;;1550   		lc640_write(EE_VZ1_STAT,vz1sSTEP2);
001546  4601              MOV      r1,r0
001548  4658              MOV      r0,r11
00154a  f7fffffe          BL       lc640_write
;;;1551   		tree_up(iVZ1_STEP2_2,1,0,0);
00154e  2300              MOVS     r3,#0
001550  461a              MOV      r2,r3
001552  2101              MOVS     r1,#1
001554  20ee              MOVS     r0,#0xee
001556  f7fffffe          BL       tree_up
;;;1552   		tree_up(iVZ1_STEP2_1,0,0,0);
00155a  2300              MOVS     r3,#0
00155c  461a              MOV      r2,r3
00155e  4619              MOV      r1,r3
001560  20ed              MOVS     r0,#0xed
001562  f7fffffe          BL       tree_up
;;;1553   		ret(1200);
001566  f44f6096          MOV      r0,#0x4b0
00156a  f7fffffe          BL       ||ret||
                  |L1.5486|
;;;1554   		}
;;;1555   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
00156e  2314              MOVS     r3,#0x14
001570  2200              MOVS     r2,#0
001572  2164              MOVS     r1,#0x64
001574  20d2              MOVS     r0,#0xd2
001576  f7fffffe          BL       mess_send
                  |L1.5498|
;;;1556   	}
;;;1557   
;;;1558   if(vz1_stat==vz1sSTEP2)
00157a  f8980005          LDRB     r0,[r8,#5]  ; vz1_stat
;;;1559   	{
;;;1560   	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
;;;1561   		{
;;;1562   		vz1_stat_cnt=15;
00157e  f04f090f          MOV      r9,#0xf
001582  2802              CMP      r0,#2                 ;1558
001584  d118              BNE      |L1.5560|
001586  f8980006          LDRB     r0,[r8,#6]            ;1560  ; vz1_stat_old
00158a  2802              CMP      r0,#2                 ;1560
00158c  d102              BNE      |L1.5524|
00158e  f8b80076          LDRH     r0,[r8,#0x76]         ;1560  ; vz1_stat_cnt
001592  b908              CBNZ     r0,|L1.5528|
                  |L1.5524|
001594  f8a89076          STRH     r9,[r8,#0x76]
                  |L1.5528|
;;;1563   		}
;;;1564   	vz1_stat_cnt--;
001598  f8b80076          LDRH     r0,[r8,#0x76]  ; vz1_stat_cnt
00159c  f1a00001          SUB      r0,r0,#1
0015a0  f8a80076          STRH     r0,[r8,#0x76]
;;;1565   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
0015a4  f04f0314          MOV      r3,#0x14
0015a8  f04f0200          MOV      r2,#0
0015ac  f04f0164          MOV      r1,#0x64
0015b0  f04f00d2          MOV      r0,#0xd2
0015b4  f7fffffe          BL       mess_send
                  |L1.5560|
;;;1566   	}
;;;1567   
;;;1568   if(vz1_stat==vz1sSTEP3)
0015b8  f8980005          LDRB     r0,[r8,#5]  ; vz1_stat
;;;1569   	{
;;;1570   	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
;;;1571   		{
;;;1572   		vz1_stat_cnt=10;
0015bc  240a              MOVS     r4,#0xa
0015be  2600              MOVS     r6,#0                 ;1527
0015c0  f04f0a01          MOV      r10,#1                ;1528
;;;1573   
;;;1574   		}
;;;1575   	vz1_stat_cnt--;
;;;1576   	if((vz1_stat_cnt==10)||(vz1_stat_cnt==9))
;;;1577   		{
;;;1578   		show_mess(	"     ВКЛЮЧИТЕ       ",
0015c4  f2413788          MOV      r7,#0x1388
0015c8  2803              CMP      r0,#3                 ;1568
0015ca  d131              BNE      |L1.5680|
0015cc  f8980006          LDRB     r0,[r8,#6]            ;1570  ; vz1_stat_old
0015d0  2803              CMP      r0,#3                 ;1570
0015d2  d102              BNE      |L1.5594|
0015d4  f8b80076          LDRH     r0,[r8,#0x76]         ;1570  ; vz1_stat_cnt
0015d8  b908              CBNZ     r0,|L1.5598|
                  |L1.5594|
0015da  f8a84076          STRH     r4,[r8,#0x76]         ;1572
                  |L1.5598|
0015de  f8b80076          LDRH     r0,[r8,#0x76]         ;1575  ; vz1_stat_cnt
0015e2  f1a00001          SUB      r0,r0,#1              ;1575
0015e6  b200              SXTH     r0,r0                 ;1575
0015e8  f8a80076          STRH     r0,[r8,#0x76]         ;1575
0015ec  280a              CMP      r0,#0xa               ;1576
0015ee  d001              BEQ      |L1.5620|
0015f0  2809              CMP      r0,#9                 ;1576
0015f2  d106              BNE      |L1.5634|
                  |L1.5620|
0015f4  a33f              ADR      r3,|L1.5876|
0015f6  a245              ADR      r2,|L1.5900|
0015f8  a14a              ADR      r1,|L1.5924|
0015fa  a050              ADR      r0,|L1.5948|
0015fc  9700              STR      r7,[sp,#0]
0015fe  f7fffffe          BL       show_mess
                  |L1.5634|
;;;1579   					"      ТУМБЛЕР       ",
;;;1580   					"     ВЫСОКОГО       ",
;;;1581   					"    НАПРЯЖЕНИЯ      ",
;;;1582   					5000);
;;;1583   		}
;;;1584   	if(sk_stat[1]==1)
001602  7868              LDRB     r0,[r5,#1]  ; sk_stat
001604  2801              CMP      r0,#1
001606  d10d              BNE      |L1.5668|
;;;1585   		{
;;;1586   		vz1_stat=vz1sWRK;
001608  f8884005          STRB     r4,[r8,#5]
;;;1587   		lc640_write(EE_VZ1_STAT,vz1sWRK);
00160c  210a              MOVS     r1,#0xa
00160e  4658              MOV      r0,r11
001610  f7fffffe          BL       lc640_write
;;;1588   		volt_region=1;
001614  f888a02f          STRB     r10,[r8,#0x2f]
;;;1589   		cntrl_stat=0;
001618  f8a86032          STRH     r6,[r8,#0x32]
;;;1590   		cntrl_stat_new=0;
00161c  f8a86048          STRH     r6,[r8,#0x48]
;;;1591   		cntrl_stat_old=0;
001620  f8a86034          STRH     r6,[r8,#0x34]
                  |L1.5668|
;;;1592   		}
;;;1593   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
001624  2314              MOVS     r3,#0x14
001626  2200              MOVS     r2,#0
001628  2164              MOVS     r1,#0x64
00162a  20d2              MOVS     r0,#0xd2
00162c  f7fffffe          BL       mess_send
                  |L1.5680|
;;;1594   	}
;;;1595   
;;;1596   if(vz1_stat==vz1sWRK)
001630  f8980005          LDRB     r0,[r8,#5]  ; vz1_stat
001634  280a              CMP      r0,#0xa
001636  d10b              BNE      |L1.5712|
;;;1597   	{
;;;1598   	if(vz1_stat_old!=vz1_stat)
;;;1599   		{
;;;1600   		vz1_wrk_cnt=3600L/*100L*/*((long)UZ_T);
001638  4906              LDR      r1,|L1.5716|
00163a  f8980006          LDRB     r0,[r8,#6]            ;1598  ; vz1_stat_old
00163e  3180              ADDS     r1,r1,#0x80
001640  280a              CMP      r0,#0xa               ;1598
001642  d006              BEQ      |L1.5714|
001644  4843              LDR      r0,|L1.5972|
001646  f44f6261          MOV      r2,#0xe10
00164a  f9b00000          LDRSH    r0,[r0,#0]  ; UZ_T
00164e  e083              B        |L1.5976|
                  |L1.5712|
001650  e0f6              B        |L1.6208|
                  |L1.5714|
001652  e085              B        |L1.5984|
                  |L1.5716|
                          DCD      ||area_number.26||
                  |L1.5720|
                          DCD      Ib_ips_termokompensat
                  |L1.5724|
                          DCD      0xffff7360
                  |L1.5728|
                          DCD      0x40024000
                  |L1.5732|
                          DCD      AVZ
                  |L1.5736|
                          DCD      YEAR_AVZ
                  |L1.5740|
                          DCD      MONTH_AVZ
                  |L1.5744|
                          DCD      DATE_AVZ
                  |L1.5748|
                          DCD      HOUR_AVZ
                  |L1.5752|
                          DCD      MIN_AVZ
                  |L1.5756|
                          DCD      SEC_AVZ
                  |L1.5760|
                          DCD      AVZ_TIME
                  |L1.5764|
                          DCD      sk_stat
                  |L1.5768|
                          DCD      VZ_CH_VENT_BLOK
                  |L1.5772|
                          DCD      0x40024020
                  |L1.5776|
001690  20202020          DCB      "    ",194,197,205,210,200,203,223,214,200,223,"!!!   ",0
001694  c2c5cdd2
001698  c8cbdfd6
00169c  c8df2121
0016a0  21202020
0016a4  00      
0016a5  00                DCB      0
0016a6  00                DCB      0
0016a7  00                DCB      0
                  |L1.5800|
0016a8  20202020          DCB      "     ",205,197,200,209,207,208,192,194,205,192,"     ",0
0016ac  20cdc5c8
0016b0  d1cfd0c0
0016b4  c2cdc020
0016b8  20202020
0016bc  00      
0016bd  00                DCB      0
0016be  00                DCB      0
0016bf  00                DCB      0
                  |L1.5824|
0016c0  20202020          DCB      "    ",199,192,193,203,206,202,200,208,206,194,192,205," "
0016c4  c7c0c1cb
0016c8  cecac8d0
0016cc  cec2c0cd
0016d0  20      
0016d1  20202000          DCB      "   ",0
0016d5  00                DCB      0
0016d6  00                DCB      0
0016d7  00                DCB      0
                  |L1.5848|
0016d8  c2dbd0c0          DCB      194,219,208,192,194,205,200,194,192,222,217,200,201," ",199
0016dc  c2cdc8c2
0016e0  c0ded9c8
0016e4  c920c7  
0016e7  c0d0dfc4          DCB      192,208,223,196," ",0
0016eb  2000    
0016ed  00                DCB      0
0016ee  00                DCB      0
0016ef  00                DCB      0
                  |L1.5872|
                          DCD      speedChrgBlckStat
                  |L1.5876|
0016f4  20202020          DCB      "    ",205,192,207,208,223,198,197,205,200,223,"      ",0
0016f8  cdc0cfd0
0016fc  dfc6c5cd
001700  c8df2020
001704  20202020
001708  00      
001709  00                DCB      0
00170a  00                DCB      0
00170b  00                DCB      0
                  |L1.5900|
00170c  20202020          DCB      "     ",194,219,209,206,202,206,195,206,"       ",0
001710  20c2dbd1
001714  cecacec3
001718  ce202020
00171c  20202020
001720  00      
001721  00                DCB      0
001722  00                DCB      0
001723  00                DCB      0
                  |L1.5924|
001724  20202020          DCB      "      ",210,211,204,193,203,197,208,"       ",0
001728  2020d2d3
00172c  ccc1cbc5
001730  d0202020
001734  20202020
001738  00      
001739  00                DCB      0
00173a  00                DCB      0
00173b  00                DCB      0
                  |L1.5948|
00173c  20202020          DCB      "     ",194,202,203,222,215,200,210,197,"       ",0
001740  20c2cacb
001744  ded7c8d2
001748  c5202020
00174c  20202020
001750  00      
001751  00                DCB      0
001752  00                DCB      0
001753  00                DCB      0
                  |L1.5972|
                          DCD      UZ_T
                  |L1.5976|
001758  fb00f002          MUL      r0,r0,r2
00175c  6408              STR      r0,[r1,#0x40]  ; vz1_wrk_cnt
;;;1601   		//if(VZ_HR==0)  	hv_vz_wrk_cnt=1800L;
;;;1602   		vz1_up_cnt=0L;
00175e  644e              STR      r6,[r1,#0x44]  ; vz1_up_cnt
                  |L1.5984|
;;;1603   
;;;1604   		}
;;;1605   	vz1_wrk_cnt--;
001760  6c08              LDR      r0,[r1,#0x40]  ; vz1_wrk_cnt
001762  f1a00001          SUB      r0,r0,#1
001766  6408              STR      r0,[r1,#0x40]  ; vz1_wrk_cnt
;;;1606   	vz1_up_cnt++;
001768  6c4a              LDR      r2,[r1,#0x44]  ; vz1_up_cnt
00176a  f1020201          ADD      r2,r2,#1
00176e  644a              STR      r2,[r1,#0x44]  ; vz1_up_cnt
;;;1607   
;;;1608   	if(vz1_wrk_cnt==0)
001770  b940              CBNZ     r0,|L1.6020|
;;;1609   		{
;;;1610   		vz1_stat=vz1sFINE;
001772  f8889005          STRB     r9,[r8,#5]
;;;1611   		lc640_write(EE_VZ1_STAT,vz1sFINE);
001776  210f              MOVS     r1,#0xf
001778  4658              MOV      r0,r11
00177a  f7fffffe          BL       lc640_write
;;;1612   		uz_mem_hndl(0);
00177e  2000              MOVS     r0,#0
001780  f7fffffe          BL       uz_mem_hndl
                  |L1.6020|
;;;1613   		}
;;;1614   	if(sk_stat[0]==0)
001784  7828              LDRB     r0,[r5,#0]  ; sk_stat
001786  b938              CBNZ     r0,|L1.6040|
;;;1615   		{
;;;1616   		vz1_stat=vz1sERR2;
001788  f04f000c          MOV      r0,#0xc
00178c  f8880005          STRB     r0,[r8,#5]
;;;1617   		lc640_write(EE_VZ1_STAT,vz1sERR2);
001790  4601              MOV      r1,r0
001792  4658              MOV      r0,r11
001794  f7fffffe          BL       lc640_write
                  |L1.6040|
;;;1618   		}
;;;1619   	if(sk_stat[1]==0)
001798  7868              LDRB     r0,[r5,#1]  ; sk_stat
00179a  b938              CBNZ     r0,|L1.6060|
;;;1620   		{
;;;1621   		vz1_stat=vz1sERR3;
00179c  f04f000d          MOV      r0,#0xd
0017a0  f8880005          STRB     r0,[r8,#5]
;;;1622   		lc640_write(EE_VZ1_STAT,vz1sERR3);
0017a4  4601              MOV      r1,r0
0017a6  4658              MOV      r0,r11
0017a8  f7fffffe          BL       lc640_write
                  |L1.6060|
;;;1623   		}
;;;1624   	if(((Ibmax/10)>IZMAX_)&&(cntrl_stat<=20)&&(volt_region==1)&&(volt_region_cnt==0))
0017ac  f9b8004a          LDRSH    r0,[r8,#0x4a]  ; Ibmax
0017b0  f8b8104c          LDRH     r1,[r8,#0x4c]  ; IZMAX_
0017b4  fb90f0f4          SDIV     r0,r0,r4
;;;1625   		{
;;;1626   		volt_region=0;
;;;1627   		cntrl_stat=1000;
0017b8  f44f727a          MOV      r2,#0x3e8
0017bc  4288              CMP      r0,r1                 ;1624
0017be  dd16              BLE      |L1.6126|
0017c0  f9b83032          LDRSH    r3,[r8,#0x32]         ;1624  ; cntrl_stat
0017c4  2b14              CMP      r3,#0x14              ;1624
0017c6  dc12              BGT      |L1.6126|
0017c8  f898302f          LDRB     r3,[r8,#0x2f]         ;1624  ; volt_region
0017cc  2b01              CMP      r3,#1                 ;1624
0017ce  d10e              BNE      |L1.6126|
0017d0  f8b83078          LDRH     r3,[r8,#0x78]         ;1624  ; volt_region_cnt
0017d4  b95b              CBNZ     r3,|L1.6126|
0017d6  f888602f          STRB     r6,[r8,#0x2f]         ;1626
0017da  f8a82032          STRH     r2,[r8,#0x32]
;;;1628   		cntrl_stat_new=1000;
0017de  f8a82048          STRH     r2,[r8,#0x48]
;;;1629   		cntrl_stat_old=1000;
0017e2  f8a82034          STRH     r2,[r8,#0x34]
;;;1630   		volt_region_cnt=110;
0017e6  f04f036e          MOV      r3,#0x6e
0017ea  f8a83078          STRH     r3,[r8,#0x78]
                  |L1.6126|
;;;1631   		}
;;;1632   	if(((Ibmax/10)<IZMAX_)&&(cntrl_stat>=1000)&&(volt_region==0)&&(volt_region_cnt==0))
0017ee  4288              CMP      r0,r1
0017f0  da13              BGE      |L1.6170|
0017f2  f9b80032          LDRSH    r0,[r8,#0x32]  ; cntrl_stat
0017f6  4290              CMP      r0,r2
0017f8  db0f              BLT      |L1.6170|
0017fa  f898002f          LDRB     r0,[r8,#0x2f]  ; volt_region
0017fe  b960              CBNZ     r0,|L1.6170|
001800  f8b80078          LDRH     r0,[r8,#0x78]  ; volt_region_cnt
001804  b948              CBNZ     r0,|L1.6170|
;;;1633   		{
;;;1634   		volt_region=1;
001806  f888a02f          STRB     r10,[r8,#0x2f]
;;;1635   		cntrl_stat=10;
00180a  f8a84032          STRH     r4,[r8,#0x32]
;;;1636   		cntrl_stat_new=10;
00180e  f8a84048          STRH     r4,[r8,#0x48]
;;;1637   		cntrl_stat_old=10;
001812  f8a84034          STRH     r4,[r8,#0x34]
;;;1638   		volt_region_cnt=10;
001816  f8a84078          STRH     r4,[r8,#0x78]
                  |L1.6170|
;;;1639   		}
;;;1640   	if(volt_region==0) 		mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
00181a  f898002f          LDRB     r0,[r8,#0x2f]  ; volt_region
00181e  b110              CBZ      r0,|L1.6182|
;;;1641   	else if(volt_region==1) mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,1,20);
001820  2801              CMP      r0,#1
001822  d007              BEQ      |L1.6196|
001824  e00c              B        |L1.6208|
                  |L1.6182|
001826  2314              MOVS     r3,#0x14              ;1640
001828  2200              MOVS     r2,#0                 ;1640
00182a  2164              MOVS     r1,#0x64              ;1640
00182c  20d2              MOVS     r0,#0xd2              ;1640
00182e  f7fffffe          BL       mess_send
001832  e005              B        |L1.6208|
                  |L1.6196|
001834  2314              MOVS     r3,#0x14
001836  2201              MOVS     r2,#1
001838  2164              MOVS     r1,#0x64
00183a  20d2              MOVS     r0,#0xd2
00183c  f7fffffe          BL       mess_send
                  |L1.6208|
;;;1642   	}
;;;1643   
;;;1644   if(vz1_stat==vz1sERR1)		//Отсутствует вентиляция при включении
001840  f8980005          LDRB     r0,[r8,#5]  ; vz1_stat
001844  280b              CMP      r0,#0xb
001846  d120              BNE      |L1.6282|
;;;1645   	{
;;;1646   	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
001848  f8980006          LDRB     r0,[r8,#6]  ; vz1_stat_old
00184c  280b              CMP      r0,#0xb
00184e  d102              BNE      |L1.6230|
001850  f8b80076          LDRH     r0,[r8,#0x76]  ; vz1_stat_cnt
001854  b908              CBNZ     r0,|L1.6234|
                  |L1.6230|
;;;1647   		{
;;;1648   		vz1_stat_cnt=10;
001856  f8a84076          STRH     r4,[r8,#0x76]
                  |L1.6234|
;;;1649   		}
;;;1650   	vz1_stat_cnt--;
00185a  f8b80076          LDRH     r0,[r8,#0x76]  ; vz1_stat_cnt
00185e  f1a00001          SUB      r0,r0,#1
001862  b200              SXTH     r0,r0
001864  f8a80076          STRH     r0,[r8,#0x76]
;;;1651   	if((vz1_stat_cnt==10)||(vz1_stat_cnt==9))
001868  280a              CMP      r0,#0xa
00186a  d001              BEQ      |L1.6256|
00186c  2809              CMP      r0,#9
00186e  d106              BNE      |L1.6270|
                  |L1.6256|
;;;1652   		{
;;;1653   		show_mess(	"УРАВНИТЕЛЬНЫЙ ЗАРЯД ",
001870  a3ee              ADR      r3,|L1.7212|
001872  a2f4              ADR      r2,|L1.7236|
001874  a1f9              ADR      r1,|L1.7260|
001876  a0ff              ADR      r0,|L1.7284|
001878  9700              STR      r7,[sp,#0]
00187a  f7fffffe          BL       show_mess
                  |L1.6270|
;;;1654   					"   НЕ МОЖЕТ БЫТЬ    ",
;;;1655   					"      ВКЛЮЧЕН       ",
;;;1656   					"  БЕЗ ВЕНТИЛЯЦИИ!!  ",
;;;1657   					5000);
;;;1658   		}
;;;1659   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
00187e  2314              MOVS     r3,#0x14
001880  2200              MOVS     r2,#0
001882  2164              MOVS     r1,#0x64
001884  20d2              MOVS     r0,#0xd2
001886  f7fffffe          BL       mess_send
                  |L1.6282|
;;;1660   	}
;;;1661   if(vz1_stat==vz1sERR2)		//Пропала вентиляция при работе
00188a  f8980005          LDRB     r0,[r8,#5]  ; vz1_stat
00188e  280c              CMP      r0,#0xc
001890  d12c              BNE      |L1.6380|
;;;1662   	{
;;;1663   	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
001892  f8980006          LDRB     r0,[r8,#6]  ; vz1_stat_old
001896  280c              CMP      r0,#0xc
001898  d102              BNE      |L1.6304|
00189a  f8b80076          LDRH     r0,[r8,#0x76]  ; vz1_stat_cnt
00189e  b908              CBNZ     r0,|L1.6308|
                  |L1.6304|
;;;1664   		{
;;;1665   		vz1_stat_cnt=10;
0018a0  f8a84076          STRH     r4,[r8,#0x76]
                  |L1.6308|
;;;1666   		}
;;;1667   	vz1_stat_cnt--;
0018a4  f8b80076          LDRH     r0,[r8,#0x76]  ; vz1_stat_cnt
0018a8  f1a00001          SUB      r0,r0,#1
0018ac  b200              SXTH     r0,r0
0018ae  f8a80076          STRH     r0,[r8,#0x76]
;;;1668   	if((vz1_stat_cnt==10)||(vz1_stat_cnt==9))
0018b2  280a              CMP      r0,#0xa
0018b4  d001              BEQ      |L1.6330|
0018b6  2809              CMP      r0,#9
0018b8  d109              BNE      |L1.6350|
                  |L1.6330|
;;;1669   		{
;;;1670   		show_mess(	"УРАВНИТЕЛЬНЫЙ ЗАРЯД ",
0018ba  f2af232c          ADR      r3,|L1.5776|
0018be  f2af2218          ADR      r2,|L1.5800|
0018c2  f2af2104          ADR      r1,|L1.5824|
0018c6  a0eb              ADR      r0,|L1.7284|
0018c8  9700              STR      r7,[sp,#0]
0018ca  f7fffffe          BL       show_mess
                  |L1.6350|
;;;1671   					"    ЗАБЛОКИРОВАН    ",
;;;1672   					"     НЕИСПРАВНА     ",
;;;1673   					"    ВЕНТИЛЯЦИЯ!!!   ",
;;;1674   					5000);
;;;1675   		}
;;;1676   	if(sk_stat[0]==1)
0018ce  7828              LDRB     r0,[r5,#0]  ; sk_stat
0018d0  2801              CMP      r0,#1
0018d2  d105              BNE      |L1.6368|
;;;1677   		{
;;;1678   		vz1_stat=vz1sWRK;
0018d4  f8884005          STRB     r4,[r8,#5]
;;;1679   		lc640_write(EE_VZ1_STAT,vz1sWRK);
0018d8  210a              MOVS     r1,#0xa
0018da  4658              MOV      r0,r11
0018dc  f7fffffe          BL       lc640_write
                  |L1.6368|
;;;1680   		}
;;;1681   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
0018e0  2314              MOVS     r3,#0x14
0018e2  2200              MOVS     r2,#0
0018e4  2164              MOVS     r1,#0x64
0018e6  20d2              MOVS     r0,#0xd2
0018e8  f7fffffe          BL       mess_send
                  |L1.6380|
;;;1682   	}
;;;1683   
;;;1684   if(vz1_stat==vz1sERR3)		//Отключен тумблер "Высокое напряжение"
0018ec  f8980005          LDRB     r0,[r8,#5]  ; vz1_stat
0018f0  280d              CMP      r0,#0xd
0018f2  d129              BNE      |L1.6472|
;;;1685   	{
;;;1686   	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
0018f4  f8980006          LDRB     r0,[r8,#6]  ; vz1_stat_old
0018f8  280d              CMP      r0,#0xd
0018fa  d102              BNE      |L1.6402|
0018fc  f8b80076          LDRH     r0,[r8,#0x76]  ; vz1_stat_cnt
001900  b908              CBNZ     r0,|L1.6406|
                  |L1.6402|
;;;1687   		{
;;;1688   		vz1_stat_cnt=10;
001902  f8a84076          STRH     r4,[r8,#0x76]
                  |L1.6406|
;;;1689   		}
;;;1690   	vz1_stat_cnt--;
001906  f8b80076          LDRH     r0,[r8,#0x76]  ; vz1_stat_cnt
00190a  f1a00001          SUB      r0,r0,#1
00190e  b200              SXTH     r0,r0
001910  f8a80076          STRH     r0,[r8,#0x76]
;;;1691   	if((vz1_stat_cnt==10)||(vz1_stat_cnt==9))
001914  280a              CMP      r0,#0xa
001916  d001              BEQ      |L1.6428|
001918  2809              CMP      r0,#9
00191a  d106              BNE      |L1.6442|
                  |L1.6428|
;;;1692   		{
;;;1693   		show_mess(	"УРАВНИТЕЛЬНЫЙ ЗАРЯД ",
00191c  a3db              ADR      r3,|L1.7308|
00191e  a2e1              ADR      r2,|L1.7332|
001920  a1e6              ADR      r1,|L1.7356|
001922  a0d4              ADR      r0,|L1.7284|
001924  9700              STR      r7,[sp,#0]
001926  f7fffffe          BL       show_mess
                  |L1.6442|
;;;1694   					"  БУДЕТ ПРОДОЛЖЕН   ",
;;;1695   					"  ПОСЛЕ ВКЛЮЧЕНИЯ   ",
;;;1696   					"*   ТУМБЛЕРА!!!     ",
;;;1697   					5000);
;;;1698   		}
;;;1699   	if(sk_stat[1]==1)
00192a  7868              LDRB     r0,[r5,#1]  ; sk_stat
00192c  2801              CMP      r0,#1
00192e  d105              BNE      |L1.6460|
;;;1700   		{
;;;1701   		vz1_stat=vz1sWRK;
001930  f8884005          STRB     r4,[r8,#5]
;;;1702   		lc640_write(EE_VZ1_STAT,vz1sWRK);
001934  210a              MOVS     r1,#0xa
001936  4658              MOV      r0,r11
001938  f7fffffe          BL       lc640_write
                  |L1.6460|
;;;1703   		}
;;;1704   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
00193c  2314              MOVS     r3,#0x14
00193e  2200              MOVS     r2,#0
001940  2164              MOVS     r1,#0x64
001942  20d2              MOVS     r0,#0xd2
001944  f7fffffe          BL       mess_send
                  |L1.6472|
;;;1705   	}
;;;1706   if(vz1_stat==vz1sERR4)		//ВЗ закончился а тумблер включен
001948  f8980005          LDRB     r0,[r8,#5]  ; vz1_stat
00194c  280e              CMP      r0,#0xe
00194e  d12d              BNE      |L1.6572|
;;;1707   	{
;;;1708   	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
001950  f8980006          LDRB     r0,[r8,#6]  ; vz1_stat_old
001954  280e              CMP      r0,#0xe
001956  d102              BNE      |L1.6494|
001958  f8b80076          LDRH     r0,[r8,#0x76]  ; vz1_stat_cnt
00195c  b908              CBNZ     r0,|L1.6498|
                  |L1.6494|
;;;1709   		{
;;;1710   		vz1_stat_cnt=10;
00195e  f8a84076          STRH     r4,[r8,#0x76]
                  |L1.6498|
;;;1711   		}
;;;1712   	vz1_stat_cnt--;
001962  f8b80076          LDRH     r0,[r8,#0x76]  ; vz1_stat_cnt
001966  f1a00001          SUB      r0,r0,#1
00196a  b200              SXTH     r0,r0
00196c  f8a80076          STRH     r0,[r8,#0x76]
;;;1713   	if((vz1_stat_cnt==10)||(vz1_stat_cnt==9))
001970  280a              CMP      r0,#0xa
001972  d001              BEQ      |L1.6520|
001974  2809              CMP      r0,#9
001976  d109              BNE      |L1.6540|
                  |L1.6520|
;;;1714   		{
;;;1715   		show_mess(	"*    ВЫКЛЮЧИТЕ      ",
001978  f2af2388          ADR      r3,|L1.5876|
00197c  f2af2274          ADR      r2,|L1.5900|
001980  f2af2160          ADR      r1,|L1.5924|
001984  a0d3              ADR      r0,|L1.7380|
001986  9700              STR      r7,[sp,#0]
001988  f7fffffe          BL       show_mess
                  |L1.6540|
;;;1716   					"      ТУМБЛЕР       ",
;;;1717   					"     ВЫСОКОГО       ",
;;;1718   					"    НАПРЯЖЕНИЯ      ",
;;;1719   					5000);
;;;1720   		}
;;;1721   	if(sk_stat[1]==0)
00198c  7868              LDRB     r0,[r5,#1]  ; sk_stat
00198e  b938              CBNZ     r0,|L1.6560|
;;;1722   		{
;;;1723   		vz1_stat=vz1sOFF;
001990  f8886005          STRB     r6,[r8,#5]
;;;1724   		lc640_write(EE_VZ1_STAT,vz1sOFF);
001994  2100              MOVS     r1,#0
001996  4658              MOV      r0,r11
001998  f7fffffe          BL       lc640_write
;;;1725   		vz_stop();
00199c  f7fffffe          BL       vz_stop
                  |L1.6560|
;;;1726   
;;;1727   		}
;;;1728   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,1,20);
0019a0  2314              MOVS     r3,#0x14
0019a2  2201              MOVS     r2,#1
0019a4  2164              MOVS     r1,#0x64
0019a6  20d2              MOVS     r0,#0xd2
0019a8  f7fffffe          BL       mess_send
                  |L1.6572|
;;;1729   	}
;;;1730   if(vz1_stat==vz1sFINE)		//УЗ закончился, напоминание
0019ac  f8980005          LDRB     r0,[r8,#5]  ; vz1_stat
;;;1731   	{
;;;1732   	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
;;;1733   		{
;;;1734   		vz1_stat_cnt=10;
;;;1735   		}
;;;1736   	vz1_stat_cnt--;
;;;1737   	if((vz1_stat_cnt==10)||(vz1_stat_cnt==9))
;;;1738   		{
;;;1739   		show_mess(	"   УРАВНИТЕЛЬНЫЙ    ",
0019b0  f64037b8          MOV      r7,#0xbb8
0019b4  280f              CMP      r0,#0xf               ;1730
0019b6  d138              BNE      |L1.6698|
0019b8  f8980006          LDRB     r0,[r8,#6]            ;1732  ; vz1_stat_old
0019bc  280f              CMP      r0,#0xf               ;1732
0019be  d102              BNE      |L1.6598|
0019c0  f8b80076          LDRH     r0,[r8,#0x76]         ;1732  ; vz1_stat_cnt
0019c4  b908              CBNZ     r0,|L1.6602|
                  |L1.6598|
0019c6  f8a84076          STRH     r4,[r8,#0x76]         ;1734
                  |L1.6602|
0019ca  f8b80076          LDRH     r0,[r8,#0x76]         ;1736  ; vz1_stat_cnt
0019ce  f1a00001          SUB      r0,r0,#1              ;1736
0019d2  b200              SXTH     r0,r0                 ;1736
0019d4  f8a80076          STRH     r0,[r8,#0x76]         ;1736
0019d8  280a              CMP      r0,#0xa               ;1737
0019da  d001              BEQ      |L1.6624|
0019dc  2809              CMP      r0,#9                 ;1737
0019de  d106              BNE      |L1.6638|
                  |L1.6624|
0019e0  a3c2              ADR      r3,|L1.7404|
0019e2  a2c8              ADR      r2,|L1.7428|
0019e4  a1cd              ADR      r1,|L1.7452|
0019e6  a0d3              ADR      r0,|L1.7476|
0019e8  9700              STR      r7,[sp,#0]
0019ea  f7fffffe          BL       show_mess
                  |L1.6638|
;;;1740   					"       ЗАРЯД        ",
;;;1741   					"      УСПЕШНО       ",
;;;1742   					"     ЗАВЕРШЕН       ",
;;;1743   					3000);
;;;1744   		}
;;;1745   	if((vz1_stat_cnt==6)||(vz1_stat_cnt==5))
0019ee  f9b80076          LDRSH    r0,[r8,#0x76]  ; vz1_stat_cnt
0019f2  2806              CMP      r0,#6
0019f4  d001              BEQ      |L1.6650|
0019f6  2805              CMP      r0,#5
0019f8  d109              BNE      |L1.6670|
                  |L1.6650|
;;;1746   		{
;;;1747   		show_mess(	"     ВЫКЛЮЧИТЕ      ",
0019fa  f2af3308          ADR      r3,|L1.5876|
0019fe  f2af22f4          ADR      r2,|L1.5900|
001a02  f2af21e0          ADR      r1,|L1.5924|
001a06  a0d1              ADR      r0,|L1.7500|
001a08  9700              STR      r7,[sp,#0]
001a0a  f7fffffe          BL       show_mess
                  |L1.6670|
;;;1748   					"      ТУМБЛЕР       ",
;;;1749   					"     ВЫСОКОГО       ",
;;;1750   					"    НАПРЯЖЕНИЯ      ",
;;;1751   					3000);
;;;1752   		}
;;;1753   	if(sk_stat[1]==0)
001a0e  7868              LDRB     r0,[r5,#1]  ; sk_stat
001a10  b928              CBNZ     r0,|L1.6686|
;;;1754   		{
;;;1755   		vz1_stat=vz1sOFF;
001a12  f8886005          STRB     r6,[r8,#5]
;;;1756   		lc640_write(EE_VZ1_STAT,vz1sOFF);
001a16  2100              MOVS     r1,#0
001a18  4658              MOV      r0,r11
001a1a  f7fffffe          BL       lc640_write
                  |L1.6686|
;;;1757   		}
;;;1758   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
001a1e  2314              MOVS     r3,#0x14
001a20  2200              MOVS     r2,#0
001a22  2164              MOVS     r1,#0x64
001a24  20d2              MOVS     r0,#0xd2
001a26  f7fffffe          BL       mess_send
                  |L1.6698|
;;;1759   	}
;;;1760   
;;;1761   if(vz1_stat==vz1sSTOP)		//УЗ прекращен, напоминание
001a2a  f8980005          LDRB     r0,[r8,#5]  ; vz1_stat
001a2e  2810              CMP      r0,#0x10
001a30  d138              BNE      |L1.6820|
;;;1762   	{
;;;1763   	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
001a32  f8980006          LDRB     r0,[r8,#6]  ; vz1_stat_old
001a36  2810              CMP      r0,#0x10
001a38  d102              BNE      |L1.6720|
001a3a  f8b80076          LDRH     r0,[r8,#0x76]  ; vz1_stat_cnt
001a3e  b908              CBNZ     r0,|L1.6724|
                  |L1.6720|
;;;1764   		{
;;;1765   		vz1_stat_cnt=10;
001a40  f8a84076          STRH     r4,[r8,#0x76]
                  |L1.6724|
;;;1766   		}
;;;1767   	vz1_stat_cnt--;
001a44  f8b80076          LDRH     r0,[r8,#0x76]  ; vz1_stat_cnt
001a48  f1a00001          SUB      r0,r0,#1
001a4c  b200              SXTH     r0,r0
001a4e  f8a80076          STRH     r0,[r8,#0x76]
;;;1768   	if((vz1_stat_cnt==10)||(vz1_stat_cnt==9))
001a52  280a              CMP      r0,#0xa
001a54  d001              BEQ      |L1.6746|
001a56  2809              CMP      r0,#9
001a58  d106              BNE      |L1.6760|
                  |L1.6746|
;;;1769   		{
;;;1770   		show_mess(	"   УРАВНИТЕЛЬНЫЙ    ",
001a5a  a3c2              ADR      r3,|L1.7524|
001a5c  a2c7              ADR      r2,|L1.7548|
001a5e  a1af              ADR      r1,|L1.7452|
001a60  a0b4              ADR      r0,|L1.7476|
001a62  9700              STR      r7,[sp,#0]
001a64  f7fffffe          BL       show_mess
                  |L1.6760|
;;;1771   					"       ЗАРЯД        ",
;;;1772   					"     ПРЕКРАЩЕН      ",
;;;1773   					"                    ",
;;;1774   					3000);
;;;1775   		}
;;;1776   	if((vz1_stat_cnt==6)||(vz1_stat_cnt==5))
001a68  f9b80076          LDRSH    r0,[r8,#0x76]  ; vz1_stat_cnt
001a6c  2806              CMP      r0,#6
001a6e  d001              BEQ      |L1.6772|
001a70  2805              CMP      r0,#5
001a72  d109              BNE      |L1.6792|
                  |L1.6772|
;;;1777   		{
;;;1778   		show_mess(	"     ВЫКЛЮЧИТЕ      ",
001a74  f2af3384          ADR      r3,|L1.5876|
001a78  f2af3270          ADR      r2,|L1.5900|
001a7c  f2af315c          ADR      r1,|L1.5924|
001a80  a0b2              ADR      r0,|L1.7500|
001a82  9700              STR      r7,[sp,#0]
001a84  f7fffffe          BL       show_mess
                  |L1.6792|
;;;1779   					"      ТУМБЛЕР       ",
;;;1780   					"     ВЫСОКОГО       ",
;;;1781   					"    НАПРЯЖЕНИЯ      ",
;;;1782   					3000);
;;;1783   		}
;;;1784   	if(sk_stat[1]==0)
001a88  7868              LDRB     r0,[r5,#1]  ; sk_stat
001a8a  b928              CBNZ     r0,|L1.6808|
;;;1785   		{
;;;1786   		vz1_stat=vz1sOFF;
001a8c  f8886005          STRB     r6,[r8,#5]
;;;1787   		lc640_write(EE_VZ1_STAT,vz1sOFF);
001a90  2100              MOVS     r1,#0
001a92  4658              MOV      r0,r11
001a94  f7fffffe          BL       lc640_write
                  |L1.6808|
;;;1788   		}
;;;1789   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
001a98  2314              MOVS     r3,#0x14
001a9a  2200              MOVS     r2,#0
001a9c  2164              MOVS     r1,#0x64
001a9e  20d2              MOVS     r0,#0xd2
001aa0  f7fffffe          BL       mess_send
                  |L1.6820|
;;;1790   	}
;;;1791   
;;;1792   vz1_stat_old=vz1_stat;
001aa4  f8980005          LDRB     r0,[r8,#5]  ; vz1_stat
001aa8  f8880006          STRB     r0,[r8,#6]
;;;1793   
;;;1794   
;;;1795   
;;;1796   }
001aac  e8bd8ff8          POP      {r3-r11,pc}
;;;1797   
                          ENDP

                  vz1_start PROC
;;;1799   //старт уравнительног заряда
;;;1800   char vz1_start(char hour)
001ab0  b510              PUSH     {r4,lr}
;;;1801   {          
;;;1802   char out;
;;;1803   out=0;
001ab2  f04f0000          MOV      r0,#0
;;;1804   if((spc_stat==spcOFF)&&(speedChrgBlckStat!=1)&&(vz1_stat==vz1sOFF))
001ab6  49b7              LDR      r1,|L1.7572|
001ab8  f8912023          LDRB     r2,[r1,#0x23]  ; spc_stat
001abc  2a00              CMP      r2,#0
001abe  d110              BNE      |L1.6882|
001ac0  4ab5              LDR      r2,|L1.7576|
001ac2  8812              LDRH     r2,[r2,#0]  ; speedChrgBlckStat
001ac4  2a01              CMP      r2,#1
001ac6  d00c              BEQ      |L1.6882|
001ac8  794a              LDRB     r2,[r1,#5]  ; vz1_stat
001aca  2a00              CMP      r2,#0
001acc  d109              BNE      |L1.6882|
;;;1805   	{
;;;1806   	if(vz1_stat==vz1sOFF)
;;;1807   		{
;;;1808   		vz1_stat=vz1sSTEP1;
001ace  f04f0001          MOV      r0,#1
001ad2  7148              STRB     r0,[r1,#5]
;;;1809   		lc640_write(EE_VZ1_STAT,vz1sSTEP1);
001ad4  4601              MOV      r1,r0
001ad6  f44f70c9          MOV      r0,#0x192
001ada  f7fffffe          BL       lc640_write
;;;1810   		out=1;
001ade  f04f0001          MOV      r0,#1
                  |L1.6882|
;;;1811   		
;;;1812   		}
;;;1813   /*	spc_stat=spcVZ;
;;;1814   	__ee_spc_stat=spcVZ; 
;;;1815   	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);   
;;;1816   	vz_cnt_h=hour;
;;;1817   	__ee_vz_cnt=hour*60;
;;;1818   	if(hour==0)__ee_vz_cnt=30;
;;;1819   	lc640_write_int(EE_VZ_CNT,__ee_vz_cnt);
;;;1820   	lc640_write_int(EE_SPC_VZ_LENGT,__ee_vz_cnt);	
;;;1821   	vz_cnt_h_=0;
;;;1822   	vz_cnt_s=0;
;;;1823   	vz_cnt_s_=0;
;;;1824   	
;;;1825   		*/
;;;1826   	}
;;;1827   //else if((spc_stat==spc_KE1p1)||(spc_stat==spc_KE1p2)) out=22; 
;;;1828   //else if((spc_stat==spc_KE2p1)||(spc_stat==spc_KE2p2)) out=33;
;;;1829   //plazma=out;	
;;;1830   return out;
;;;1831   }
001ae2  bd10              POP      {r4,pc}
;;;1832   
                          ENDP

                  vz1_stop PROC
;;;1834   //стоп уравнительног заряда
;;;1835   void vz1_stop(void)
001ae4  48ab              LDR      r0,|L1.7572|
;;;1836   {
;;;1837   if(vz1_stat!=vz1sOFF)
001ae6  7941              LDRB     r1,[r0,#5]  ; vz1_stat
001ae8  2900              CMP      r1,#0
001aea  d006              BEQ      |L1.6906|
;;;1838   	{
;;;1839   	vz1_stat=vz1sSTOP;
001aec  f04f0110          MOV      r1,#0x10
001af0  7141              STRB     r1,[r0,#5]
;;;1840   	lc640_write(EE_VZ1_STAT,vz1sSTOP);
001af2  f44f70c9          MOV      r0,#0x192
001af6  f7ffbffe          B.W      lc640_write
                  |L1.6906|
;;;1841   	}
;;;1842   }
001afa  4770              BX       lr
;;;1843   
                          ENDP

                  vz2_drv PROC
;;;1845   //драйвер формовочного заряда
;;;1846   void vz2_drv(void)
001afc  e92d4ff8          PUSH     {r3-r11,lr}
;;;1847   {
;;;1848   
;;;1849   if(vz2_stat==vz2sSTEP1)
001b00  4ea4              LDR      r6,|L1.7572|
;;;1850   	{
;;;1851   	if(vz2_stat_old!=vz2_stat)
;;;1852   		{
;;;1853   		vz2_stat_cnt=5;
;;;1854   		}
;;;1855   	if(vz2_stat_cnt)
;;;1856   		{
;;;1857   		vz2_stat_cnt--;
;;;1858   		if(vz2_stat_cnt==0)
;;;1859   			{
;;;1860   			vz2_stat=vz2sERR1; 	//Не включилась вентиляция;
;;;1861   			lc640_write(EE_VZ2_STAT,vz2sERR1);
;;;1862   			}
;;;1863   		}
;;;1864   	if(sk_stat[0]==1)
001b02  4da6              LDR      r5,|L1.7580|
001b04  79f0              LDRB     r0,[r6,#7]            ;1849  ; vz2_stat
001b06  2801              CMP      r0,#1                 ;1849
001b08  d138              BNE      |L1.7036|
001b0a  7a30              LDRB     r0,[r6,#8]            ;1851  ; vz2_stat_old
001b0c  2801              CMP      r0,#1                 ;1851
001b0e  d003              BEQ      |L1.6936|
001b10  f04f0005          MOV      r0,#5                 ;1853
001b14  f8a6007a          STRH     r0,[r6,#0x7a]         ;1853
                  |L1.6936|
001b18  f9b6007a          LDRSH    r0,[r6,#0x7a]         ;1855  ; vz2_stat_cnt
001b1c  b168              CBZ      r0,|L1.6970|
001b1e  f1a00001          SUB      r0,r0,#1              ;1857
001b22  b200              SXTH     r0,r0                 ;1857
001b24  f8a6007a          STRH     r0,[r6,#0x7a]         ;1857
001b28  b938              CBNZ     r0,|L1.6970|
001b2a  f04f000c          MOV      r0,#0xc               ;1860
001b2e  71f0              STRB     r0,[r6,#7]            ;1860
001b30  4601              MOV      r1,r0                 ;1861
001b32  f44f70ca          MOV      r0,#0x194             ;1861
001b36  f7fffffe          BL       lc640_write
                  |L1.6970|
001b3a  7828              LDRB     r0,[r5,#0]  ; sk_stat
001b3c  2801              CMP      r0,#1
001b3e  d117              BNE      |L1.7024|
;;;1865   		{
;;;1866   		vz2_stat=vz2sSTEP2;
001b40  f04f0002          MOV      r0,#2
001b44  71f0              STRB     r0,[r6,#7]
;;;1867   		lc640_write(EE_VZ2_STAT,vz2sSTEP2);
001b46  4601              MOV      r1,r0
001b48  f44f70ca          MOV      r0,#0x194
001b4c  f7fffffe          BL       lc640_write
;;;1868   		tree_up(iVZ2_STEP2_2,1,0,0);
001b50  2300              MOVS     r3,#0
001b52  461a              MOV      r2,r3
001b54  2101              MOVS     r1,#1
001b56  20f0              MOVS     r0,#0xf0
001b58  f7fffffe          BL       tree_up
;;;1869   		tree_up(iVZ2_STEP2_1,0,0,0);
001b5c  2300              MOVS     r3,#0
001b5e  461a              MOV      r2,r3
001b60  4619              MOV      r1,r3
001b62  20ef              MOVS     r0,#0xef
001b64  f7fffffe          BL       tree_up
;;;1870   		ret(1200);
001b68  f44f6096          MOV      r0,#0x4b0
001b6c  f7fffffe          BL       ||ret||
                  |L1.7024|
;;;1871   		}
;;;1872   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
001b70  2314              MOVS     r3,#0x14
001b72  2200              MOVS     r2,#0
001b74  2164              MOVS     r1,#0x64
001b76  20d2              MOVS     r0,#0xd2
001b78  f7fffffe          BL       mess_send
                  |L1.7036|
;;;1873   	}
;;;1874   
;;;1875   if(vz2_stat==vz2sSTEP2)
001b7c  79f0              LDRB     r0,[r6,#7]  ; vz2_stat
001b7e  2802              CMP      r0,#2
001b80  d119              BNE      |L1.7094|
;;;1876   	{
;;;1877   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
001b82  7a30              LDRB     r0,[r6,#8]  ; vz2_stat_old
001b84  2802              CMP      r0,#2
001b86  d102              BNE      |L1.7054|
001b88  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
001b8c  b918              CBNZ     r0,|L1.7062|
                  |L1.7054|
;;;1878   		{
;;;1879   		vz2_stat_cnt=15;
001b8e  f04f000f          MOV      r0,#0xf
001b92  f8a6007a          STRH     r0,[r6,#0x7a]
                  |L1.7062|
;;;1880   		}
;;;1881   	vz2_stat_cnt--;
001b96  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
001b9a  f1a00001          SUB      r0,r0,#1
001b9e  f8a6007a          STRH     r0,[r6,#0x7a]
;;;1882   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
001ba2  f04f0314          MOV      r3,#0x14
001ba6  f04f0200          MOV      r2,#0
001baa  f04f0164          MOV      r1,#0x64
001bae  f04f00d2          MOV      r0,#0xd2
001bb2  f7fffffe          BL       mess_send
                  |L1.7094|
;;;1883   	}
;;;1884   
;;;1885   if(vz2_stat==vz2sSTEP3)
001bb6  79f0              LDRB     r0,[r6,#7]  ; vz2_stat
;;;1886   	{
;;;1887   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
;;;1888   		{
;;;1889   		vz2_stat_cnt=10;
001bb8  240a              MOVS     r4,#0xa
001bba  2700              MOVS     r7,#0
;;;1890   		cntrl_stat=0;
;;;1891   		cntrl_stat_new=0;
;;;1892   		cntrl_stat_old=0;
;;;1893   		}
;;;1894   	vz2_stat_cnt--;
;;;1895   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
;;;1896   		{
;;;1897   		show_mess(	"     ВКЛЮЧИТЕ       ",
001bbc  f2413888          MOV      r8,#0x1388
001bc0  2803              CMP      r0,#3                 ;1885
001bc2  d131              BNE      |L1.7208|
001bc4  7a30              LDRB     r0,[r6,#8]            ;1887  ; vz2_stat_old
001bc6  2803              CMP      r0,#3                 ;1887
001bc8  d102              BNE      |L1.7120|
001bca  f8b6007a          LDRH     r0,[r6,#0x7a]         ;1887  ; vz2_stat_cnt
001bce  b928              CBNZ     r0,|L1.7132|
                  |L1.7120|
001bd0  f8a6407a          STRH     r4,[r6,#0x7a]         ;1889
001bd4  8677              STRH     r7,[r6,#0x32]         ;1890
001bd6  f8a67048          STRH     r7,[r6,#0x48]         ;1891
001bda  86b7              STRH     r7,[r6,#0x34]         ;1892
                  |L1.7132|
001bdc  f8b6007a          LDRH     r0,[r6,#0x7a]         ;1894  ; vz2_stat_cnt
001be0  f1a00001          SUB      r0,r0,#1              ;1894
001be4  b200              SXTH     r0,r0                 ;1894
001be6  f8a6007a          STRH     r0,[r6,#0x7a]         ;1894
001bea  280a              CMP      r0,#0xa               ;1895
001bec  d001              BEQ      |L1.7154|
001bee  2809              CMP      r0,#9                 ;1895
001bf0  d10b              BNE      |L1.7178|
                  |L1.7154|
001bf2  f2af5300          ADR      r3,|L1.5876|
001bf6  f2af42ec          ADR      r2,|L1.5900|
001bfa  f2af41d8          ADR      r1,|L1.5924|
001bfe  f2af40c4          ADR      r0,|L1.5948|
001c02  f8cd8000          STR      r8,[sp,#0]
001c06  f7fffffe          BL       show_mess
                  |L1.7178|
;;;1898   					"      ТУМБЛЕР       ",
;;;1899   					"     ВЫСОКОГО       ",
;;;1900   					"    НАПРЯЖЕНИЯ      ",
;;;1901   					5000);
;;;1902   		}
;;;1903   	if(sk_stat[1]==1)
001c0a  7868              LDRB     r0,[r5,#1]  ; sk_stat
001c0c  2801              CMP      r0,#1
001c0e  d10c              BNE      |L1.7210|
;;;1904   		{
;;;1905   		vz2_stat=vz2sWRK1;
001c10  71f4              STRB     r4,[r6,#7]
;;;1906   		lc640_write(EE_VZ2_STAT,vz2sWRK1);
001c12  210a              MOVS     r1,#0xa
001c14  f44f70ca          MOV      r0,#0x194
001c18  f7fffffe          BL       lc640_write
;;;1907   		volt_region=1;
001c1c  f04f0001          MOV      r0,#1
001c20  f886002f          STRB     r0,[r6,#0x2f]
;;;1908   		cntrl_stat=0;
001c24  8677              STRH     r7,[r6,#0x32]
;;;1909   		cntrl_stat_new=0;
001c26  e0bb              B        |L1.7584|
                  |L1.7208|
001c28  e0c3              B        |L1.7602|
                  |L1.7210|
001c2a  e0bc              B        |L1.7590|
                  |L1.7212|
001c2c  2020c1c5          DCB      "  ",193,197,199," ",194,197,205,210,200,203,223,214,200
001c30  c720c2c5
001c34  cdd2c8cb
001c38  dfd6c8  
001c3b  c8212120          DCB      200,"!!  ",0
001c3f  2000    
001c41  00                DCB      0
001c42  00                DCB      0
001c43  00                DCB      0
                  |L1.7236|
001c44  20202020          DCB      "      ",194,202,203,222,215,197,205,"       ",0
001c48  2020c2ca
001c4c  cbded7c5
001c50  cd202020
001c54  20202020
001c58  00      
001c59  00                DCB      0
001c5a  00                DCB      0
001c5b  00                DCB      0
                  |L1.7260|
001c5c  202020cd          DCB      "   ",205,197," ",204,206,198,197,210," ",193,219,210,220
001c60  c520ccce
001c64  c6c5d220
001c68  c1dbd2dc
001c6c  20202020          DCB      "    ",0
001c70  00      
001c71  00                DCB      0
001c72  00                DCB      0
001c73  00                DCB      0
                  |L1.7284|
001c74  d3d0c0c2          DCB      211,208,192,194,205,200,210,197,203,220,205,219,201," ",199
001c78  cdc8d2c5
001c7c  cbdccddb
001c80  c920c7  
001c83  c0d0dfc4          DCB      192,208,223,196," ",0
001c87  2000    
001c89  00                DCB      0
001c8a  00                DCB      0
001c8b  00                DCB      0
                  |L1.7308|
001c8c  2a202020          DCB      "*   ",210,211,204,193,203,197,208,192,"!!!     ",0
001c90  d2d3ccc1
001c94  cbc5d0c0
001c98  21212120
001c9c  20202020
001ca0  00      
001ca1  00                DCB      0
001ca2  00                DCB      0
001ca3  00                DCB      0
                  |L1.7332|
001ca4  2020cfce          DCB      "  ",207,206,209,203,197," ",194,202,203,222,215,197,205
001ca8  d1cbc520
001cac  c2cacbde
001cb0  d7c5cd  
001cb3  c8df2020          DCB      200,223,"   ",0
001cb7  2000    
001cb9  00                DCB      0
001cba  00                DCB      0
001cbb  00                DCB      0
                  |L1.7356|
001cbc  2020c1d3          DCB      "  ",193,211,196,197,210," ",207,208,206,196,206,203,198
001cc0  c4c5d220
001cc4  cfd0cec4
001cc8  cecbc6  
001ccb  c5cd2020          DCB      197,205,"   ",0
001ccf  2000    
001cd1  00                DCB      0
001cd2  00                DCB      0
001cd3  00                DCB      0
                  |L1.7380|
001cd4  2a202020          DCB      "*    ",194,219,202,203,222,215,200,210,197,"      ",0
001cd8  20c2dbca
001cdc  cbded7c8
001ce0  d2c52020
001ce4  20202020
001ce8  00      
001ce9  00                DCB      0
001cea  00                DCB      0
001ceb  00                DCB      0
                  |L1.7404|
001cec  20202020          DCB      "     ",199,192,194,197,208,216,197,205,"       ",0
001cf0  20c7c0c2
001cf4  c5d0d8c5
001cf8  cd202020
001cfc  20202020
001d00  00      
001d01  00                DCB      0
001d02  00                DCB      0
001d03  00                DCB      0
                  |L1.7428|
001d04  20202020          DCB      "      ",211,209,207,197,216,205,206,"       ",0
001d08  2020d3d1
001d0c  cfc5d8cd
001d10  ce202020
001d14  20202020
001d18  00      
001d19  00                DCB      0
001d1a  00                DCB      0
001d1b  00                DCB      0
                  |L1.7452|
001d1c  20202020          DCB      "       ",199,192,208,223,196,"        ",0
001d20  202020c7
001d24  c0d0dfc4
001d28  20202020
001d2c  20202020
001d30  00      
001d31  00                DCB      0
001d32  00                DCB      0
001d33  00                DCB      0
                  |L1.7476|
001d34  202020d3          DCB      "   ",211,208,192,194,205,200,210,197,203,220,205,219,201
001d38  d0c0c2cd
001d3c  c8d2c5cb
001d40  dccddbc9
001d44  20202020          DCB      "    ",0
001d48  00      
001d49  00                DCB      0
001d4a  00                DCB      0
001d4b  00                DCB      0
                  |L1.7500|
001d4c  20202020          DCB      "     ",194,219,202,203,222,215,200,210,197,"      ",0
001d50  20c2dbca
001d54  cbded7c8
001d58  d2c52020
001d5c  20202020
001d60  00      
001d61  00                DCB      0
001d62  00                DCB      0
001d63  00                DCB      0
                  |L1.7524|
001d64  20202020          DCB      "                    ",0
001d68  20202020
001d6c  20202020
001d70  20202020
001d74  20202020
001d78  00      
001d79  00                DCB      0
001d7a  00                DCB      0
001d7b  00                DCB      0
                  |L1.7548|
001d7c  20202020          DCB      "     ",207,208,197,202,208,192,217,197,205,"      ",0
001d80  20cfd0c5
001d84  cad0c0d9
001d88  c5cd2020
001d8c  20202020
001d90  00      
001d91  00                DCB      0
001d92  00                DCB      0
001d93  00                DCB      0
                  |L1.7572|
                          DCD      ||area_number.26||
                  |L1.7576|
                          DCD      speedChrgBlckStat
                  |L1.7580|
                          DCD      sk_stat
                  |L1.7584|
001da0  f8a67048          STRH     r7,[r6,#0x48]
;;;1910   		cntrl_stat_old=0;
001da4  86b7              STRH     r7,[r6,#0x34]
                  |L1.7590|
;;;1911   		}
;;;1912   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
001da6  2314              MOVS     r3,#0x14
001da8  2200              MOVS     r2,#0
001daa  2164              MOVS     r1,#0x64
001dac  20d2              MOVS     r0,#0xd2
001dae  f7fffffe          BL       mess_send
                  |L1.7602|
;;;1913   	}
;;;1914   
;;;1915   if(vz2_stat==vz2sWRK1)
001db2  79f0              LDRB     r0,[r6,#7]  ; vz2_stat
;;;1916   	{
;;;1917   
;;;1918   	if(vz2_stat_old!=vz2_stat)
;;;1919   		{
;;;1920   		vz2_wrk_cnt=3600L/*100L*/*((long)FZ_T1);
001db4  f8df940c          LDR      r9,|L1.8644|
;;;1921   		//if(VZ_HR==0)  	hv_vz_wrk_cnt=1800L;
;;;1922   		vz2_up_cnt=0L;
;;;1923   
;;;1924   		}
;;;1925   	vz2_wrk_cnt--;
;;;1926   	vz2_up_cnt++;
;;;1927   
;;;1928   	if(vz2_wrk_cnt==0)
;;;1929   		{
;;;1930   		vz2_stat=vz2sWRK2;
;;;1931   		lc640_write(EE_VZ2_STAT,vz2sWRK2);
;;;1932   		}
;;;1933   	if(sk_stat[0]==0)
;;;1934   		{
;;;1935   		vz2_stat=vz2sERR2;
;;;1936   		lc640_write(EE_VZ2_STAT,vz2sERR2);
;;;1937   		}
;;;1938   	if(sk_stat[1]==0)
;;;1939   		{
;;;1940   		vz2_stat=vz2sERR3;
;;;1941   		lc640_write(EE_VZ2_STAT,vz2sERR3);
;;;1942   		}
;;;1943   	//if(abs(out_U-FZ_U1)<10)
;;;1944   	if((out_U<(FZ_U1+30))&&(out_U>(FZ_U1-10)))
;;;1945   		{
;;;1946   		if((Ib_ips_termokompensat/10)<FZ_ISW12)
;;;1947   			{
;;;1948   			if(vz2_stat_ph2_cnt)
;;;1949   				{
;;;1950   				vz2_stat_ph2_cnt--;
;;;1951   				if(vz2_stat_ph2_cnt==0)
;;;1952   					{
;;;1953   					vz2_stat=vz2sWRK2;
;;;1954   					lc640_write(EE_VZ2_STAT,vz2sWRK2);
;;;1955   					}
;;;1956   				}
;;;1957   			}
;;;1958   		else
;;;1959   			{
;;;1960   			vz2_stat_ph2_cnt=60;
;;;1961   			}
;;;1962   		}
;;;1963   	else
;;;1964   		{
;;;1965   		vz2_stat_ph2_cnt=60;
;;;1966   		}
;;;1967   	if(((Ibmax/10)>IZMAX_)&&(cntrl_stat<=20)&&(volt_region==1)&&(volt_region_cnt==0))
;;;1968   		{
;;;1969   		volt_region=0;
;;;1970   		cntrl_stat=1000;
001db8  f44f7b7a          MOV      r11,#0x3e8
001dbc  f04f0a0b          MOV      r10,#0xb              ;1930
001dc0  280a              CMP      r0,#0xa               ;1915
001dc2  d17d              BNE      |L1.7872|
001dc4  7a30              LDRB     r0,[r6,#8]            ;1918  ; vz2_stat_old
001dc6  280a              CMP      r0,#0xa               ;1918
001dc8  d00a              BEQ      |L1.7648|
001dca  48ff              LDR      r0,|L1.8648|
001dcc  f44f6161          MOV      r1,#0xe10             ;1920
001dd0  f9b00000          LDRSH    r0,[r0,#0]            ;1920  ; FZ_T1
001dd4  fb00f001          MUL      r0,r0,r1              ;1920
001dd8  f8c90048          STR      r0,[r9,#0x48]         ;1920  ; vz2_wrk_cnt
001ddc  f8c9704c          STR      r7,[r9,#0x4c]         ;1922  ; vz2_up_cnt
                  |L1.7648|
001de0  f8d90048          LDR      r0,[r9,#0x48]         ;1925  ; vz2_wrk_cnt
001de4  f1a00001          SUB      r0,r0,#1              ;1925
001de8  f8c90048          STR      r0,[r9,#0x48]         ;1925  ; vz2_wrk_cnt
001dec  f8d9104c          LDR      r1,[r9,#0x4c]         ;1926  ; vz2_up_cnt
001df0  f1010101          ADD      r1,r1,#1              ;1926
001df4  f8c9104c          STR      r1,[r9,#0x4c]         ;1926  ; vz2_up_cnt
001df8  b930              CBNZ     r0,|L1.7688|
001dfa  f886a007          STRB     r10,[r6,#7]           ;1930
001dfe  210b              MOVS     r1,#0xb               ;1931
001e00  f44f70ca          MOV      r0,#0x194             ;1931
001e04  f7fffffe          BL       lc640_write
                  |L1.7688|
001e08  7828              LDRB     r0,[r5,#0]            ;1933  ; sk_stat
001e0a  b938              CBNZ     r0,|L1.7708|
001e0c  f04f000d          MOV      r0,#0xd               ;1935
001e10  71f0              STRB     r0,[r6,#7]            ;1935
001e12  4601              MOV      r1,r0                 ;1936
001e14  f44f70ca          MOV      r0,#0x194             ;1936
001e18  f7fffffe          BL       lc640_write
                  |L1.7708|
001e1c  7868              LDRB     r0,[r5,#1]            ;1938  ; sk_stat
001e1e  b938              CBNZ     r0,|L1.7728|
001e20  f04f000e          MOV      r0,#0xe               ;1940
001e24  71f0              STRB     r0,[r6,#7]            ;1940
001e26  4601              MOV      r1,r0                 ;1941
001e28  f44f70ca          MOV      r0,#0x194             ;1941
001e2c  f7fffffe          BL       lc640_write
                  |L1.7728|
001e30  48e6              LDR      r0,|L1.8652|
001e32  223c              MOVS     r2,#0x3c              ;1960
001e34  f9b01000          LDRSH    r1,[r0,#0]            ;1944  ; out_U
001e38  48e5              LDR      r0,|L1.8656|
001e3a  f9b00000          LDRSH    r0,[r0,#0]            ;1944  ; FZ_U1
001e3e  f100031e          ADD      r3,r0,#0x1e           ;1944
001e42  4299              CMP      r1,r3                 ;1944
001e44  da20              BGE      |L1.7816|
001e46  380a              SUBS     r0,r0,#0xa            ;1944
001e48  4281              CMP      r1,r0                 ;1944
001e4a  dd1d              BLE      |L1.7816|
001e4c  48e1              LDR      r0,|L1.8660|
001e4e  49e2              LDR      r1,|L1.8664|
001e50  f9b00000          LDRSH    r0,[r0,#0]            ;1946  ; Ib_ips_termokompensat
001e54  f9b11000          LDRSH    r1,[r1,#0]            ;1946  ; FZ_ISW12
001e58  fb90f0f4          SDIV     r0,r0,r4              ;1946
001e5c  4288              CMP      r0,r1                 ;1946
001e5e  da10              BGE      |L1.7810|
001e60  f9b6007c          LDRSH    r0,[r6,#0x7c]         ;1948  ; vz2_stat_ph2_cnt
001e64  b190              CBZ      r0,|L1.7820|
001e66  f1a00001          SUB      r0,r0,#1              ;1950
001e6a  b200              SXTH     r0,r0                 ;1950
001e6c  f8a6007c          STRH     r0,[r6,#0x7c]         ;1950
001e70  b960              CBNZ     r0,|L1.7820|
001e72  f886a007          STRB     r10,[r6,#7]           ;1953
001e76  210b              MOVS     r1,#0xb               ;1954
001e78  f44f70ca          MOV      r0,#0x194             ;1954
001e7c  f7fffffe          BL       lc640_write
001e80  e004              B        |L1.7820|
                  |L1.7810|
001e82  f8a6207c          STRH     r2,[r6,#0x7c]         ;1960
001e86  e001              B        |L1.7820|
                  |L1.7816|
001e88  f8a6207c          STRH     r2,[r6,#0x7c]         ;1965
                  |L1.7820|
001e8c  f9b6004a          LDRSH    r0,[r6,#0x4a]         ;1967  ; Ibmax
001e90  f8b6104c          LDRH     r1,[r6,#0x4c]         ;1967  ; IZMAX_
001e94  fb90f0f4          SDIV     r0,r0,r4              ;1967
001e98  4288              CMP      r0,r1                 ;1967
001e9a  dd18              BLE      |L1.7886|
001e9c  f9b62032          LDRSH    r2,[r6,#0x32]         ;1967  ; cntrl_stat
001ea0  2a14              CMP      r2,#0x14              ;1967
001ea2  dc14              BGT      |L1.7886|
001ea4  f896202f          LDRB     r2,[r6,#0x2f]         ;1967  ; volt_region
001ea8  2a01              CMP      r2,#1                 ;1967
001eaa  d110              BNE      |L1.7886|
001eac  f8b62078          LDRH     r2,[r6,#0x78]         ;1967  ; volt_region_cnt
001eb0  b96a              CBNZ     r2,|L1.7886|
001eb2  f886702f          STRB     r7,[r6,#0x2f]         ;1969
001eb6  f8a6b032          STRH     r11,[r6,#0x32]
;;;1971   		cntrl_stat_new=1000;
001eba  f8a6b048          STRH     r11,[r6,#0x48]
;;;1972   		cntrl_stat_old=1000;
001ebe  e000              B        |L1.7874|
                  |L1.7872|
001ec0  e02e              B        |L1.7968|
                  |L1.7874|
001ec2  f8a6b034          STRH     r11,[r6,#0x34]
;;;1973   		volt_region_cnt=110;
001ec6  f04f026e          MOV      r2,#0x6e
001eca  f8a62078          STRH     r2,[r6,#0x78]
                  |L1.7886|
;;;1974   		}
;;;1975   	if(((Ibmax/10)<IZMAX_)&&(cntrl_stat>=1000)&&(volt_region==0)&&(volt_region_cnt==0))
001ece  4288              CMP      r0,r1
001ed0  da13              BGE      |L1.7930|
001ed2  f9b60032          LDRSH    r0,[r6,#0x32]  ; cntrl_stat
001ed6  4558              CMP      r0,r11
001ed8  db0f              BLT      |L1.7930|
001eda  f896002f          LDRB     r0,[r6,#0x2f]  ; volt_region
001ede  b960              CBNZ     r0,|L1.7930|
001ee0  f8b60078          LDRH     r0,[r6,#0x78]  ; volt_region_cnt
001ee4  b948              CBNZ     r0,|L1.7930|
;;;1976   		{
;;;1977   		volt_region=1;
001ee6  f04f0001          MOV      r0,#1
001eea  f886002f          STRB     r0,[r6,#0x2f]
;;;1978   		cntrl_stat=10;
001eee  8674              STRH     r4,[r6,#0x32]
;;;1979   		cntrl_stat_new=10;
001ef0  f8a64048          STRH     r4,[r6,#0x48]
;;;1980   		cntrl_stat_old=10;
001ef4  86b4              STRH     r4,[r6,#0x34]
;;;1981   		volt_region_cnt=10;
001ef6  f8a64078          STRH     r4,[r6,#0x78]
                  |L1.7930|
;;;1982   		}
;;;1983   	if(volt_region==0) 		mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
001efa  f896002f          LDRB     r0,[r6,#0x2f]  ; volt_region
001efe  b110              CBZ      r0,|L1.7942|
;;;1984   	else if(volt_region==1) mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,1,20);
001f00  2801              CMP      r0,#1
001f02  d007              BEQ      |L1.7956|
001f04  e00c              B        |L1.7968|
                  |L1.7942|
001f06  2314              MOVS     r3,#0x14              ;1983
001f08  2200              MOVS     r2,#0                 ;1983
001f0a  2164              MOVS     r1,#0x64              ;1983
001f0c  20d2              MOVS     r0,#0xd2              ;1983
001f0e  f7fffffe          BL       mess_send
001f12  e005              B        |L1.7968|
                  |L1.7956|
001f14  2314              MOVS     r3,#0x14
001f16  2201              MOVS     r2,#1
001f18  2164              MOVS     r1,#0x64
001f1a  20d2              MOVS     r0,#0xd2
001f1c  f7fffffe          BL       mess_send
                  |L1.7968|
;;;1985   	}
;;;1986   
;;;1987   if(vz2_stat==vz2sWRK2)
001f20  79f0              LDRB     r0,[r6,#7]  ; vz2_stat
001f22  280b              CMP      r0,#0xb
001f24  d17f              BNE      |L1.8230|
;;;1988   	{
;;;1989   	if(vz2_stat_old!=vz2_stat)
001f26  7a30              LDRB     r0,[r6,#8]  ; vz2_stat_old
001f28  280b              CMP      r0,#0xb
001f2a  d008              BEQ      |L1.7998|
;;;1990   		{
;;;1991   		vz2_wrk_cnt=3600L/*100L*/*((long)FZ_T2);
001f2c  48ab              LDR      r0,|L1.8668|
001f2e  f44f6161          MOV      r1,#0xe10
001f32  f9b00000          LDRSH    r0,[r0,#0]  ; FZ_T2
001f36  fb00f001          MUL      r0,r0,r1
001f3a  f8c90048          STR      r0,[r9,#0x48]  ; vz2_wrk_cnt
                  |L1.7998|
;;;1992   		//if(VZ_HR==0)  	hv_vz_wrk_cnt=1800L;
;;;1993   		//vz2_up_cnt=0L;
;;;1994   		}
;;;1995   	vz2_wrk_cnt--;
001f3e  f8d90048          LDR      r0,[r9,#0x48]  ; vz2_wrk_cnt
001f42  f1a00001          SUB      r0,r0,#1
001f46  f8c90048          STR      r0,[r9,#0x48]  ; vz2_wrk_cnt
;;;1996   	vz2_up_cnt++;
001f4a  f8d9104c          LDR      r1,[r9,#0x4c]  ; vz2_up_cnt
001f4e  f1010101          ADD      r1,r1,#1
001f52  f8c9104c          STR      r1,[r9,#0x4c]  ; vz2_up_cnt
;;;1997   
;;;1998   	if(vz2_wrk_cnt==0)
001f56  b950              CBNZ     r0,|L1.8046|
;;;1999   		{
;;;2000   		vz2_stat=vz2sFINE;
001f58  f04f0012          MOV      r0,#0x12
001f5c  71f0              STRB     r0,[r6,#7]
;;;2001   		lc640_write(EE_VZ2_STAT,vz2sFINE);
001f5e  4601              MOV      r1,r0
001f60  f44f70ca          MOV      r0,#0x194
001f64  f7fffffe          BL       lc640_write
;;;2002   		fz_mem_hndl(0);
001f68  2000              MOVS     r0,#0
001f6a  f7fffffe          BL       fz_mem_hndl
                  |L1.8046|
;;;2003   		}
;;;2004   	if(sk_stat[0]==0)
001f6e  7828              LDRB     r0,[r5,#0]  ; sk_stat
001f70  b938              CBNZ     r0,|L1.8066|
;;;2005   		{
;;;2006   		vz2_stat=vz2sERR5;
001f72  f04f0010          MOV      r0,#0x10
001f76  71f0              STRB     r0,[r6,#7]
;;;2007   		lc640_write(EE_VZ2_STAT,vz2sERR5);
001f78  4601              MOV      r1,r0
001f7a  f44f70ca          MOV      r0,#0x194
001f7e  f7fffffe          BL       lc640_write
                  |L1.8066|
;;;2008   		}
;;;2009   	if(sk_stat[1]==0)
001f82  7868              LDRB     r0,[r5,#1]  ; sk_stat
001f84  b938              CBNZ     r0,|L1.8086|
;;;2010   		{
;;;2011   		vz2_stat=vz2sERR6;
001f86  f04f0011          MOV      r0,#0x11
001f8a  71f0              STRB     r0,[r6,#7]
;;;2012   		lc640_write(EE_VZ2_STAT,vz2sERR6);
001f8c  4601              MOV      r1,r0
001f8e  f44f70ca          MOV      r0,#0x194
001f92  f7fffffe          BL       lc640_write
                  |L1.8086|
;;;2013   		}
;;;2014   	if(((Ibmax/10)>IZMAX_)&&(cntrl_stat<=20)&&(volt_region==1)&&(volt_region_cnt==0))
001f96  f9b6004a          LDRSH    r0,[r6,#0x4a]  ; Ibmax
001f9a  f8b6104c          LDRH     r1,[r6,#0x4c]  ; IZMAX_
001f9e  fb90f0f4          SDIV     r0,r0,r4
001fa2  4288              CMP      r0,r1
001fa4  dd16              BLE      |L1.8148|
001fa6  f9b62032          LDRSH    r2,[r6,#0x32]  ; cntrl_stat
001faa  2a14              CMP      r2,#0x14
001fac  dc12              BGT      |L1.8148|
001fae  f896202f          LDRB     r2,[r6,#0x2f]  ; volt_region
001fb2  2a01              CMP      r2,#1
001fb4  d10e              BNE      |L1.8148|
001fb6  f8b62078          LDRH     r2,[r6,#0x78]  ; volt_region_cnt
001fba  b95a              CBNZ     r2,|L1.8148|
;;;2015   		{
;;;2016   		volt_region=0;
001fbc  f886702f          STRB     r7,[r6,#0x2f]
;;;2017   		cntrl_stat=1000;
001fc0  f8a6b032          STRH     r11,[r6,#0x32]
;;;2018   		cntrl_stat_new=1000;
001fc4  f8a6b048          STRH     r11,[r6,#0x48]
;;;2019   		cntrl_stat_old=1000;
001fc8  f8a6b034          STRH     r11,[r6,#0x34]
;;;2020   		volt_region_cnt=110;
001fcc  f04f026e          MOV      r2,#0x6e
001fd0  f8a62078          STRH     r2,[r6,#0x78]
                  |L1.8148|
;;;2021   		}
;;;2022   	if(((Ibmax/10)<IZMAX_)&&(cntrl_stat>=1000)&&(volt_region==0)&&(volt_region_cnt==0))
001fd4  4288              CMP      r0,r1
001fd6  da13              BGE      |L1.8192|
001fd8  f9b60032          LDRSH    r0,[r6,#0x32]  ; cntrl_stat
001fdc  4558              CMP      r0,r11
001fde  db0f              BLT      |L1.8192|
001fe0  f896002f          LDRB     r0,[r6,#0x2f]  ; volt_region
001fe4  b960              CBNZ     r0,|L1.8192|
001fe6  f8b60078          LDRH     r0,[r6,#0x78]  ; volt_region_cnt
001fea  b948              CBNZ     r0,|L1.8192|
;;;2023   		{
;;;2024   		volt_region=1;
001fec  f04f0001          MOV      r0,#1
001ff0  f886002f          STRB     r0,[r6,#0x2f]
;;;2025   		cntrl_stat=10;
001ff4  8674              STRH     r4,[r6,#0x32]
;;;2026   		cntrl_stat_new=10;
001ff6  f8a64048          STRH     r4,[r6,#0x48]
;;;2027   		cntrl_stat_old=10;
001ffa  86b4              STRH     r4,[r6,#0x34]
;;;2028   		volt_region_cnt=10;
001ffc  f8a64078          STRH     r4,[r6,#0x78]
                  |L1.8192|
;;;2029   		}
;;;2030   	if(volt_region==0) 		mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
002000  f896002f          LDRB     r0,[r6,#0x2f]  ; volt_region
002004  b110              CBZ      r0,|L1.8204|
;;;2031   	else if(volt_region==1) mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,1,20);
002006  2801              CMP      r0,#1
002008  d007              BEQ      |L1.8218|
00200a  e00c              B        |L1.8230|
                  |L1.8204|
00200c  2314              MOVS     r3,#0x14              ;2030
00200e  2200              MOVS     r2,#0                 ;2030
002010  2164              MOVS     r1,#0x64              ;2030
002012  20d2              MOVS     r0,#0xd2              ;2030
002014  f7fffffe          BL       mess_send
002018  e005              B        |L1.8230|
                  |L1.8218|
00201a  2314              MOVS     r3,#0x14
00201c  2201              MOVS     r2,#1
00201e  2164              MOVS     r1,#0x64
002020  20d2              MOVS     r0,#0xd2
002022  f7fffffe          BL       mess_send
                  |L1.8230|
;;;2032   	}
;;;2033   
;;;2034   if(vz2_stat==vz2sERR1)		//Отсутствует вентиляция при включении
002026  79f0              LDRB     r0,[r6,#7]  ; vz2_stat
002028  280c              CMP      r0,#0xc
00202a  d123              BNE      |L1.8308|
;;;2035   	{
;;;2036   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
00202c  7a30              LDRB     r0,[r6,#8]  ; vz2_stat_old
00202e  280c              CMP      r0,#0xc
002030  d102              BNE      |L1.8248|
002032  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
002036  b908              CBNZ     r0,|L1.8252|
                  |L1.8248|
;;;2037   		{
;;;2038   		vz2_stat_cnt=10;
002038  f8a6407a          STRH     r4,[r6,#0x7a]
                  |L1.8252|
;;;2039   		}
;;;2040   	vz2_stat_cnt--;
00203c  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
002040  f1a00001          SUB      r0,r0,#1
002044  b200              SXTH     r0,r0
002046  f8a6007a          STRH     r0,[r6,#0x7a]
;;;2041   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
00204a  280a              CMP      r0,#0xa
00204c  d001              BEQ      |L1.8274|
00204e  2809              CMP      r0,#9
002050  d10a              BNE      |L1.8296|
                  |L1.8274|
;;;2042   		{
;;;2043   		show_mess(	" ФОРМОВОЧНЫЙ ЗАРЯД  ",
002052  f2af4328          ADR      r3,|L1.7212|
002056  f2af4214          ADR      r2,|L1.7236|
00205a  f2af4100          ADR      r1,|L1.7260|
00205e  a060              ADR      r0,|L1.8672|
002060  f8cd8000          STR      r8,[sp,#0]
002064  f7fffffe          BL       show_mess
                  |L1.8296|
;;;2044   					"   НЕ МОЖЕТ БЫТЬ    ",
;;;2045   					"      ВКЛЮЧЕН       ",
;;;2046   					"  БЕЗ ВЕНТИЛЯЦИИ!!  ",
;;;2047   					5000);
;;;2048   		}
;;;2049   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
002068  2314              MOVS     r3,#0x14
00206a  2200              MOVS     r2,#0
00206c  2164              MOVS     r1,#0x64
00206e  20d2              MOVS     r0,#0xd2
002070  f7fffffe          BL       mess_send
                  |L1.8308|
;;;2050   	}
;;;2051   if(vz2_stat==vz2sERR2)		//Пропала вентиляция при работе в первой фазе ФЗ
002074  79f0              LDRB     r0,[r6,#7]  ; vz2_stat
002076  280d              CMP      r0,#0xd
002078  d12c              BNE      |L1.8404|
;;;2052   	{
;;;2053   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
00207a  7a30              LDRB     r0,[r6,#8]  ; vz2_stat_old
00207c  280d              CMP      r0,#0xd
00207e  d102              BNE      |L1.8326|
002080  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
002084  b908              CBNZ     r0,|L1.8330|
                  |L1.8326|
;;;2054   		{
;;;2055   		vz2_stat_cnt=10;
002086  f8a6407a          STRH     r4,[r6,#0x7a]
                  |L1.8330|
;;;2056   		}
;;;2057   	vz2_stat_cnt--;
00208a  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
00208e  f1a00001          SUB      r0,r0,#1
002092  b200              SXTH     r0,r0
002094  f8a6007a          STRH     r0,[r6,#0x7a]
;;;2058   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
002098  280a              CMP      r0,#0xa
00209a  d001              BEQ      |L1.8352|
00209c  2809              CMP      r0,#9
00209e  d10a              BNE      |L1.8374|
                  |L1.8352|
;;;2059   		{
;;;2060   		show_mess(	" ФОРМОВОЧНЫЙ ЗАРЯД  ",
0020a0  f6af2314          ADR      r3,|L1.5776|
0020a4  f6af2200          ADR      r2,|L1.5800|
0020a8  f6af11ec          ADR      r1,|L1.5824|
0020ac  a04c              ADR      r0,|L1.8672|
0020ae  f8cd8000          STR      r8,[sp,#0]
0020b2  f7fffffe          BL       show_mess
                  |L1.8374|
;;;2061   					"    ЗАБЛОКИРОВАН    ",
;;;2062   					"     НЕИСПРАВНА     ",
;;;2063   					"    ВЕНТИЛЯЦИЯ!!!   ",
;;;2064   					5000);
;;;2065   		}
;;;2066   	if(sk_stat[0]==1)
0020b6  7828              LDRB     r0,[r5,#0]  ; sk_stat
0020b8  2801              CMP      r0,#1
0020ba  d105              BNE      |L1.8392|
;;;2067   		{
;;;2068   		vz2_stat=vz2sWRK1;
0020bc  71f4              STRB     r4,[r6,#7]
;;;2069   		lc640_write(EE_VZ2_STAT,vz2sWRK1);
0020be  210a              MOVS     r1,#0xa
0020c0  f44f70ca          MOV      r0,#0x194
0020c4  f7fffffe          BL       lc640_write
                  |L1.8392|
;;;2070   		}
;;;2071   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
0020c8  2314              MOVS     r3,#0x14
0020ca  2200              MOVS     r2,#0
0020cc  2164              MOVS     r1,#0x64
0020ce  20d2              MOVS     r0,#0xd2
0020d0  f7fffffe          BL       mess_send
                  |L1.8404|
;;;2072   	}
;;;2073   
;;;2074   if(vz2_stat==vz2sERR3)		//Отключен тумблер "Выравнивающий заряд" при работе в первой фазе ФЗ
0020d4  79f0              LDRB     r0,[r6,#7]  ; vz2_stat
0020d6  280e              CMP      r0,#0xe
0020d8  d12b              BNE      |L1.8498|
;;;2075   	{
;;;2076   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
0020da  7a30              LDRB     r0,[r6,#8]  ; vz2_stat_old
0020dc  280e              CMP      r0,#0xe
0020de  d102              BNE      |L1.8422|
0020e0  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
0020e4  b908              CBNZ     r0,|L1.8426|
                  |L1.8422|
;;;2077   		{
;;;2078   		vz2_stat_cnt=10;
0020e6  f8a6407a          STRH     r4,[r6,#0x7a]
                  |L1.8426|
;;;2079   		}
;;;2080   	vz2_stat_cnt--;
0020ea  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
0020ee  f1a00001          SUB      r0,r0,#1
0020f2  b200              SXTH     r0,r0
0020f4  f8a6007a          STRH     r0,[r6,#0x7a]
;;;2081   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
0020f8  280a              CMP      r0,#0xa
0020fa  d001              BEQ      |L1.8448|
0020fc  2809              CMP      r0,#9
0020fe  d109              BNE      |L1.8468|
                  |L1.8448|
;;;2082   		{
;;;2083   		show_mess(	" ФОРМОВОЧНЫЙ ЗАРЯД  ",
002100  a33d              ADR      r3,|L1.8696|
002102  f2af4260          ADR      r2,|L1.7332|
002106  f2af414c          ADR      r1,|L1.7356|
00210a  a035              ADR      r0,|L1.8672|
00210c  f8cd8000          STR      r8,[sp,#0]
002110  f7fffffe          BL       show_mess
                  |L1.8468|
;;;2084   					"  БУДЕТ ПРОДОЛЖЕН   ",
;;;2085   					"  ПОСЛЕ ВКЛЮЧЕНИЯ   ",
;;;2086   					"    ТУМБЛЕРА!!!     ",
;;;2087   					5000);
;;;2088   		}
;;;2089   	if(sk_stat[1]==1)
002114  7868              LDRB     r0,[r5,#1]  ; sk_stat
002116  2801              CMP      r0,#1
002118  d105              BNE      |L1.8486|
;;;2090   		{
;;;2091   		vz2_stat=vz2sWRK1;
00211a  71f4              STRB     r4,[r6,#7]
;;;2092   		lc640_write(EE_VZ2_STAT,vz2sWRK1);
00211c  210a              MOVS     r1,#0xa
00211e  f44f70ca          MOV      r0,#0x194
002122  f7fffffe          BL       lc640_write
                  |L1.8486|
;;;2093   		}
;;;2094   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
002126  2314              MOVS     r3,#0x14
002128  2200              MOVS     r2,#0
00212a  2164              MOVS     r1,#0x64
00212c  20d2              MOVS     r0,#0xd2
00212e  f7fffffe          BL       mess_send
                  |L1.8498|
;;;2095   	}
;;;2096   if(vz2_stat==vz2sERR5)		//Пропала вентиляция при работе
002132  79f0              LDRB     r0,[r6,#7]  ; vz2_stat
002134  2810              CMP      r0,#0x10
002136  d12d              BNE      |L1.8596|
;;;2097   	{
;;;2098   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
002138  7a30              LDRB     r0,[r6,#8]  ; vz2_stat_old
00213a  2810              CMP      r0,#0x10
00213c  d102              BNE      |L1.8516|
00213e  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
002142  b908              CBNZ     r0,|L1.8520|
                  |L1.8516|
;;;2099   		{
;;;2100   		vz2_stat_cnt=10;
002144  f8a6407a          STRH     r4,[r6,#0x7a]
                  |L1.8520|
;;;2101   		}
;;;2102   	vz2_stat_cnt--;
002148  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
00214c  f1a00001          SUB      r0,r0,#1
002150  b200              SXTH     r0,r0
002152  f8a6007a          STRH     r0,[r6,#0x7a]
;;;2103   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
002156  280a              CMP      r0,#0xa
002158  d001              BEQ      |L1.8542|
00215a  2809              CMP      r0,#9
00215c  d10a              BNE      |L1.8564|
                  |L1.8542|
;;;2104   		{
;;;2105   		show_mess(	" ФОРМОВОЧНЫЙ ЗАРЯД  ",
00215e  f6af23d0          ADR      r3,|L1.5776|
002162  f6af22bc          ADR      r2,|L1.5800|
002166  f6af21a8          ADR      r1,|L1.5824|
00216a  a01d              ADR      r0,|L1.8672|
00216c  f8cd8000          STR      r8,[sp,#0]
002170  f7fffffe          BL       show_mess
                  |L1.8564|
;;;2106   					"    ЗАБЛОКИРОВАН    ",
;;;2107   					"     НЕИСПРАВНА     ",
;;;2108   					"    ВЕНТИЛЯЦИЯ!!!   ",
;;;2109   					5000);
;;;2110   		}
;;;2111   	if(sk_stat[0]==1)
002174  7828              LDRB     r0,[r5,#0]  ; sk_stat
002176  2801              CMP      r0,#1
002178  d106              BNE      |L1.8584|
;;;2112   		{
;;;2113   		vz2_stat=vz2sWRK2;
00217a  f886a007          STRB     r10,[r6,#7]
;;;2114   		lc640_write(EE_VZ2_STAT,vz2sWRK2);
00217e  210b              MOVS     r1,#0xb
002180  f44f70ca          MOV      r0,#0x194
002184  f7fffffe          BL       lc640_write
                  |L1.8584|
;;;2115   		}
;;;2116   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
002188  2314              MOVS     r3,#0x14
00218a  2200              MOVS     r2,#0
00218c  2164              MOVS     r1,#0x64
00218e  20d2              MOVS     r0,#0xd2
002190  f7fffffe          BL       mess_send
                  |L1.8596|
;;;2117   	}
;;;2118   
;;;2119   if(vz2_stat==vz2sERR6)		//Отключен тумблер "Выравнивающий заряд"
002194  79f0              LDRB     r0,[r6,#7]  ; vz2_stat
002196  2811              CMP      r0,#0x11
002198  d154              BNE      |L1.8772|
;;;2120   	{
;;;2121   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
00219a  7a30              LDRB     r0,[r6,#8]  ; vz2_stat_old
00219c  2811              CMP      r0,#0x11
00219e  d102              BNE      |L1.8614|
0021a0  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
0021a4  b908              CBNZ     r0,|L1.8618|
                  |L1.8614|
;;;2122   		{
;;;2123   		vz2_stat_cnt=10;
0021a6  f8a6407a          STRH     r4,[r6,#0x7a]
                  |L1.8618|
;;;2124   		}
;;;2125   	vz2_stat_cnt--;
0021aa  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
0021ae  f1a00001          SUB      r0,r0,#1
0021b2  b200              SXTH     r0,r0
0021b4  f8a6007a          STRH     r0,[r6,#0x7a]
;;;2126   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
0021b8  280a              CMP      r0,#0xa
0021ba  d001              BEQ      |L1.8640|
0021bc  2809              CMP      r0,#9
0021be  d131              BNE      |L1.8740|
                  |L1.8640|
;;;2127   		{
;;;2128   		show_mess(	" ФОРМОВОЧНЫЙ ЗАРЯД  ",
0021c0  a30d              ADR      r3,|L1.8696|
0021c2  e025              B        |L1.8720|
                  |L1.8644|
                          DCD      ||area_number.26||+0x80
                  |L1.8648|
                          DCD      FZ_T1
                  |L1.8652|
                          DCD      out_U
                  |L1.8656|
                          DCD      FZ_U1
                  |L1.8660|
                          DCD      Ib_ips_termokompensat
                  |L1.8664|
                          DCD      FZ_ISW12
                  |L1.8668|
                          DCD      FZ_T2
                  |L1.8672|
0021e0  20d4ced0          DCB      " ",212,206,208,204,206,194,206,215,205,219,201," ",199,192
0021e4  cccec2ce
0021e8  d7cddbc9
0021ec  20c7c0  
0021ef  d0dfc420          DCB      208,223,196,"  ",0
0021f3  2000    
0021f5  00                DCB      0
0021f6  00                DCB      0
0021f7  00                DCB      0
                  |L1.8696|
0021f8  20202020          DCB      "    ",210,211,204,193,203,197,208,192,"!!!     ",0
0021fc  d2d3ccc1
002200  cbc5d0c0
002204  21212120
002208  20202020
00220c  00      
00220d  00                DCB      0
00220e  00                DCB      0
00220f  00                DCB      0
                  |L1.8720|
002210  f2af5270          ADR      r2,|L1.7332|
002214  f2af515c          ADR      r1,|L1.7356|
002218  f2af003c          ADR      r0,|L1.8672|
00221c  f8cd8000          STR      r8,[sp,#0]
002220  f7fffffe          BL       show_mess
                  |L1.8740|
;;;2129   					"  БУДЕТ ПРОДОЛЖЕН   ",
;;;2130   					"  ПОСЛЕ ВКЛЮЧЕНИЯ   ",
;;;2131   					"    ТУМБЛЕРА!!!     ",
;;;2132   					5000);
;;;2133   		}
;;;2134   	if(sk_stat[1]==1)
002224  7868              LDRB     r0,[r5,#1]  ; sk_stat
002226  2801              CMP      r0,#1
002228  d106              BNE      |L1.8760|
;;;2135   		{
;;;2136   		vz2_stat=vz2sWRK2;
00222a  f886a007          STRB     r10,[r6,#7]
;;;2137   		lc640_write(EE_VZ2_STAT,vz2sWRK2);
00222e  210b              MOVS     r1,#0xb
002230  f44f70ca          MOV      r0,#0x194
002234  f7fffffe          BL       lc640_write
                  |L1.8760|
;;;2138   		}
;;;2139   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
002238  2314              MOVS     r3,#0x14
00223a  2200              MOVS     r2,#0
00223c  2164              MOVS     r1,#0x64
00223e  20d2              MOVS     r0,#0xd2
002240  f7fffffe          BL       mess_send
                  |L1.8772|
;;;2140   	}
;;;2141   if(vz2_stat==vz2sERR4)		//ВЗ закончился а тумблер включен
002244  79f0              LDRB     r0,[r6,#7]  ; vz2_stat
002246  280f              CMP      r0,#0xf
002248  d12e              BNE      |L1.8872|
;;;2142   	{
;;;2143   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
00224a  7a30              LDRB     r0,[r6,#8]  ; vz2_stat_old
00224c  280f              CMP      r0,#0xf
00224e  d102              BNE      |L1.8790|
002250  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
002254  b908              CBNZ     r0,|L1.8794|
                  |L1.8790|
;;;2144   		{
;;;2145   		vz2_stat_cnt=10;
002256  f8a6407a          STRH     r4,[r6,#0x7a]
                  |L1.8794|
;;;2146   		}
;;;2147   	vz2_stat_cnt--;
00225a  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
00225e  f1a00001          SUB      r0,r0,#1
002262  b200              SXTH     r0,r0
002264  f8a6007a          STRH     r0,[r6,#0x7a]
;;;2148   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
002268  280a              CMP      r0,#0xa
00226a  d001              BEQ      |L1.8816|
00226c  2809              CMP      r0,#9
00226e  d10b              BNE      |L1.8840|
                  |L1.8816|
;;;2149   		{
;;;2150   		show_mess(	"     ВЫКЛЮЧИТЕ      ",
002270  f6af3380          ADR      r3,|L1.5876|
002274  f6af326c          ADR      r2,|L1.5900|
002278  f6af3158          ADR      r1,|L1.5924|
00227c  f2af5034          ADR      r0,|L1.7500|
002280  f8cd8000          STR      r8,[sp,#0]
002284  f7fffffe          BL       show_mess
                  |L1.8840|
;;;2151   					"      ТУМБЛЕР       ",
;;;2152   					"     ВЫСОКОГО       ",
;;;2153   					"    НАПРЯЖЕНИЯ      ",
;;;2154   					5000);
;;;2155   		}
;;;2156   	if(sk_stat[1]==0)
002288  7868              LDRB     r0,[r5,#1]  ; sk_stat
00228a  b938              CBNZ     r0,|L1.8860|
;;;2157   		{
;;;2158   		vz2_stat=vz2sOFF;
00228c  71f7              STRB     r7,[r6,#7]
;;;2159   		lc640_write(EE_VZ2_STAT,vz2sOFF);
00228e  2100              MOVS     r1,#0
002290  f44f70ca          MOV      r0,#0x194
002294  f7fffffe          BL       lc640_write
;;;2160   		vz_stop();
002298  f7fffffe          BL       vz_stop
                  |L1.8860|
;;;2161   
;;;2162   		}
;;;2163   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
00229c  2314              MOVS     r3,#0x14
00229e  2200              MOVS     r2,#0
0022a0  2164              MOVS     r1,#0x64
0022a2  20d2              MOVS     r0,#0xd2
0022a4  f7fffffe          BL       mess_send
                  |L1.8872|
;;;2164   	}
;;;2165   if(vz2_stat==vz2sFINE)		//ФЗ закончился, напоминание
0022a8  79f0              LDRB     r0,[r6,#7]  ; vz2_stat
;;;2166   	{
;;;2167   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
;;;2168   		{
;;;2169   		vz2_stat_cnt=10;
;;;2170   		}
;;;2171   	vz2_stat_cnt--;
;;;2172   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
;;;2173   		{
;;;2174   		show_mess(	"    ФОРМОВОЧНЫЙ     ",
0022aa  f64038b8          MOV      r8,#0xbb8
0022ae  2812              CMP      r0,#0x12              ;2165
0022b0  d13d              BNE      |L1.9006|
0022b2  7a30              LDRB     r0,[r6,#8]            ;2167  ; vz2_stat_old
0022b4  2812              CMP      r0,#0x12              ;2167
0022b6  d102              BNE      |L1.8894|
0022b8  f8b6007a          LDRH     r0,[r6,#0x7a]         ;2167  ; vz2_stat_cnt
0022bc  b908              CBNZ     r0,|L1.8898|
                  |L1.8894|
0022be  f8a6407a          STRH     r4,[r6,#0x7a]         ;2169
                  |L1.8898|
0022c2  f8b6007a          LDRH     r0,[r6,#0x7a]         ;2171  ; vz2_stat_cnt
0022c6  f1a00001          SUB      r0,r0,#1              ;2171
0022ca  b200              SXTH     r0,r0                 ;2171
0022cc  f8a6007a          STRH     r0,[r6,#0x7a]         ;2171
0022d0  280a              CMP      r0,#0xa               ;2172
0022d2  d001              BEQ      |L1.8920|
0022d4  2809              CMP      r0,#9                 ;2172
0022d6  d10a              BNE      |L1.8942|
                  |L1.8920|
0022d8  f2af53f0          ADR      r3,|L1.7404|
0022dc  f2af52dc          ADR      r2,|L1.7428|
0022e0  f2af51c8          ADR      r1,|L1.7452|
0022e4  a0ff              ADR      r0,|L1.9956|
0022e6  f8cd8000          STR      r8,[sp,#0]
0022ea  f7fffffe          BL       show_mess
                  |L1.8942|
;;;2175   					"       ЗАРЯД        ",
;;;2176   					"      УСПЕШНО       ",
;;;2177   					"     ЗАВЕРШЕН       ",
;;;2178   					3000);
;;;2179   		}
;;;2180   	if((vz2_stat_cnt==6)||(vz2_stat_cnt==5))
0022ee  f9b6007a          LDRSH    r0,[r6,#0x7a]  ; vz2_stat_cnt
0022f2  2806              CMP      r0,#6
0022f4  d001              BEQ      |L1.8954|
0022f6  2805              CMP      r0,#5
0022f8  d10b              BNE      |L1.8978|
                  |L1.8954|
;;;2181   		{
;;;2182   		show_mess(	"     ВЫКЛЮЧИТЕ      ",
0022fa  f6af4308          ADR      r3,|L1.5876|
0022fe  f6af32f4          ADR      r2,|L1.5900|
002302  f6af31e0          ADR      r1,|L1.5924|
002306  f2af50bc          ADR      r0,|L1.7500|
00230a  f8cd8000          STR      r8,[sp,#0]
00230e  f7fffffe          BL       show_mess
                  |L1.8978|
;;;2183   					"      ТУМБЛЕР       ",
;;;2184   					"     ВЫСОКОГО       ",
;;;2185   					"    НАПРЯЖЕНИЯ      ",
;;;2186   					3000);
;;;2187   		}
;;;2188   	if(sk_stat[1]==0)
002312  7868              LDRB     r0,[r5,#1]  ; sk_stat
002314  b928              CBNZ     r0,|L1.8994|
;;;2189   		{
;;;2190   		vz2_stat=vz2sOFF;
002316  71f7              STRB     r7,[r6,#7]
;;;2191   		lc640_write(EE_VZ2_STAT,vz2sOFF);
002318  2100              MOVS     r1,#0
00231a  f44f70ca          MOV      r0,#0x194
00231e  f7fffffe          BL       lc640_write
                  |L1.8994|
;;;2192   		}
;;;2193   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
002322  2314              MOVS     r3,#0x14
002324  2200              MOVS     r2,#0
002326  2164              MOVS     r1,#0x64
002328  20d2              MOVS     r0,#0xd2
00232a  f7fffffe          BL       mess_send
                  |L1.9006|
;;;2194   	}
;;;2195   if(vz2_stat==vz2sSTOP)		//ФЗ прекращен, напоминание
00232e  79f0              LDRB     r0,[r6,#7]  ; vz2_stat
002330  2813              CMP      r0,#0x13
002332  d13d              BNE      |L1.9136|
;;;2196   	{
;;;2197   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
002334  7a30              LDRB     r0,[r6,#8]  ; vz2_stat_old
002336  2813              CMP      r0,#0x13
002338  d102              BNE      |L1.9024|
00233a  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
00233e  b908              CBNZ     r0,|L1.9028|
                  |L1.9024|
;;;2198   		{
;;;2199   		vz2_stat_cnt=10;
002340  f8a6407a          STRH     r4,[r6,#0x7a]
                  |L1.9028|
;;;2200   		}
;;;2201   	vz2_stat_cnt--;
002344  f8b6007a          LDRH     r0,[r6,#0x7a]  ; vz2_stat_cnt
002348  f1a00001          SUB      r0,r0,#1
00234c  b200              SXTH     r0,r0
00234e  f8a6007a          STRH     r0,[r6,#0x7a]
;;;2202   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
002352  280a              CMP      r0,#0xa
002354  d001              BEQ      |L1.9050|
002356  2809              CMP      r0,#9
002358  d10a              BNE      |L1.9072|
                  |L1.9050|
;;;2203   		{
;;;2204   		show_mess(	"    ФОРМОВОЧНЫЙ     ",
00235a  f2af53f8          ADR      r3,|L1.7524|
00235e  f2af52e4          ADR      r2,|L1.7548|
002362  f2af6148          ADR      r1,|L1.7452|
002366  a0df              ADR      r0,|L1.9956|
002368  f8cd8000          STR      r8,[sp,#0]
00236c  f7fffffe          BL       show_mess
                  |L1.9072|
;;;2205   					"       ЗАРЯД        ",
;;;2206   					"     ПРЕКРАЩЕН      ",
;;;2207   					"                    ",
;;;2208   					3000);
;;;2209   		}
;;;2210   	if((vz2_stat_cnt==6)||(vz2_stat_cnt==5))
002370  f9b6007a          LDRSH    r0,[r6,#0x7a]  ; vz2_stat_cnt
002374  2806              CMP      r0,#6
002376  d001              BEQ      |L1.9084|
002378  2805              CMP      r0,#5
00237a  d10b              BNE      |L1.9108|
                  |L1.9084|
;;;2211   		{
;;;2212   		show_mess(	"     ВЫКЛЮЧИТЕ      ",
00237c  f6af438c          ADR      r3,|L1.5876|
002380  f6af4278          ADR      r2,|L1.5900|
002384  f6af4164          ADR      r1,|L1.5924|
002388  f2af6040          ADR      r0,|L1.7500|
00238c  f8cd8000          STR      r8,[sp,#0]
002390  f7fffffe          BL       show_mess
                  |L1.9108|
;;;2213   					"      ТУМБЛЕР       ",
;;;2214   					"     ВЫСОКОГО       ",
;;;2215   					"    НАПРЯЖЕНИЯ      ",
;;;2216   					3000);
;;;2217   		}
;;;2218   	if(sk_stat[1]==0)
002394  7868              LDRB     r0,[r5,#1]  ; sk_stat
002396  b928              CBNZ     r0,|L1.9124|
;;;2219   		{
;;;2220   		vz2_stat=vz2sOFF;
002398  71f7              STRB     r7,[r6,#7]
;;;2221   		lc640_write(EE_VZ2_STAT,vz2sOFF);
00239a  2100              MOVS     r1,#0
00239c  f44f70ca          MOV      r0,#0x194
0023a0  f7fffffe          BL       lc640_write
                  |L1.9124|
;;;2222   		}
;;;2223   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
0023a4  2314              MOVS     r3,#0x14
0023a6  2200              MOVS     r2,#0
0023a8  2164              MOVS     r1,#0x64
0023aa  20d2              MOVS     r0,#0xd2
0023ac  f7fffffe          BL       mess_send
                  |L1.9136|
;;;2224   	}
;;;2225   vz2_stat_old=vz2_stat;
0023b0  79f0              LDRB     r0,[r6,#7]  ; vz2_stat
0023b2  7230              STRB     r0,[r6,#8]
;;;2226   
;;;2227   }
0023b4  e8bd8ff8          POP      {r3-r11,pc}
;;;2228   
                          ENDP

                  vz2_start PROC
;;;2230   //старт уравнительног заряда
;;;2231   char vz2_start(char hour)
0023b8  b510              PUSH     {r4,lr}
;;;2232   {          
;;;2233   char out;
;;;2234   out=0;
0023ba  f04f0000          MOV      r0,#0
;;;2235   if((spc_stat==spcOFF)&&(speedChrgBlckStat!=1)&&(vz1_stat==vz1sOFF))
0023be  49cf              LDR      r1,|L1.9980|
0023c0  f8912023          LDRB     r2,[r1,#0x23]  ; spc_stat
0023c4  2a00              CMP      r2,#0
0023c6  d110              BNE      |L1.9194|
0023c8  4acd              LDR      r2,|L1.9984|
0023ca  8812              LDRH     r2,[r2,#0]  ; speedChrgBlckStat
0023cc  2a01              CMP      r2,#1
0023ce  d00c              BEQ      |L1.9194|
0023d0  794a              LDRB     r2,[r1,#5]  ; vz1_stat
0023d2  2a00              CMP      r2,#0
0023d4  d109              BNE      |L1.9194|
;;;2236   	{
;;;2237   	if(vz1_stat==vz1sOFF)
;;;2238   		{
;;;2239   		vz2_stat=vz2sSTEP1;
0023d6  f04f0001          MOV      r0,#1
0023da  71c8              STRB     r0,[r1,#7]
;;;2240   		lc640_write(EE_VZ2_STAT,vz2sSTEP1);
0023dc  4601              MOV      r1,r0
0023de  f44f70ca          MOV      r0,#0x194
0023e2  f7fffffe          BL       lc640_write
;;;2241   		out=1;
0023e6  f04f0001          MOV      r0,#1
                  |L1.9194|
;;;2242   		
;;;2243   		}
;;;2244   /*	spc_stat=spcVZ;
;;;2245   	__ee_spc_stat=spcVZ; 
;;;2246   	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);   
;;;2247   	vz_cnt_h=hour;
;;;2248   	__ee_vz_cnt=hour*60;
;;;2249   	if(hour==0)__ee_vz_cnt=30;
;;;2250   	lc640_write_int(EE_VZ_CNT,__ee_vz_cnt);
;;;2251   	lc640_write_int(EE_SPC_VZ_LENGT,__ee_vz_cnt);	
;;;2252   	vz_cnt_h_=0;
;;;2253   	vz_cnt_s=0;
;;;2254   	vz_cnt_s_=0;
;;;2255   	
;;;2256   		*/
;;;2257   	}
;;;2258   //else if((spc_stat==spc_KE1p1)||(spc_stat==spc_KE1p2)) out=22; 
;;;2259   //else if((spc_stat==spc_KE2p1)||(spc_stat==spc_KE2p2)) out=33;
;;;2260   //plazma=out;	
;;;2261   return out;
;;;2262   }
0023ea  bd10              POP      {r4,pc}
;;;2263   //-----------------------------------------------
                          ENDP

                  vz2_stop PROC
;;;2264   //стоп формовочного заряда
;;;2265   void vz2_stop(void)
0023ec  48c3              LDR      r0,|L1.9980|
;;;2266   {
;;;2267   if(vz2_stat!=vz2sOFF)
0023ee  79c1              LDRB     r1,[r0,#7]  ; vz2_stat
0023f0  2900              CMP      r1,#0
0023f2  d006              BEQ      |L1.9218|
;;;2268   	{
;;;2269   	vz2_stat=vz2sSTOP;
0023f4  f04f0113          MOV      r1,#0x13
0023f8  71c1              STRB     r1,[r0,#7]
;;;2270   	lc640_write(EE_VZ2_STAT,vz2sSTOP);
0023fa  f44f70ca          MOV      r0,#0x194
0023fe  f7ffbffe          B.W      lc640_write
                  |L1.9218|
;;;2271   	}
;;;2272   }
002402  4770              BX       lr
;;;2273   
                          ENDP

                  kb_init PROC
;;;2274   //-----------------------------------------------
;;;2275   void kb_init(void)
002404  48bf              LDR      r0,|L1.9988|
;;;2276   {
;;;2277   main_kb_cnt=(TBAT*60)-60/*120*/;
002406  f06f013b          MVN      r1,#0x3b
00240a  8800              LDRH     r0,[r0,#0]  ; TBAT
00240c  ebc01000          RSB      r0,r0,r0,LSL #4
002410  eb010080          ADD      r0,r1,r0,LSL #2
002414  49b9              LDR      r1,|L1.9980|
002416  f8a10052          STRH     r0,[r1,#0x52]
;;;2278   }
00241a  4770              BX       lr
;;;2279   
                          ENDP

                  kb_hndl PROC
;;;2280   //-----------------------------------------------
;;;2281   void kb_hndl(void)
00241c  e92d5ff0          PUSH     {r4-r12,lr}
;;;2282   {
;;;2283   
;;;2284   static signed short ibat[2],ibat_[2];
;;;2285   #ifdef UKU_TELECORE2015
;;;2286   if(((++main_kb_cnt>=TBAT*60)&&(TBAT))&&(BAT_TYPE==0 ))
;;;2287   #else 
;;;2288   if(((++main_kb_cnt>=TBAT*60)&&(TBAT)))
002420  f8df82d8          LDR      r8,|L1.9980|
;;;2289   #endif
;;;2290   	{
;;;2291   	main_kb_cnt=0;
;;;2292   	
;;;2293   	kb_start[0]=0;
;;;2294   	kb_start[1]=0;
;;;2295   	kb_start_ips=0;
;;;2296   
;;;2297   	if( (BAT_IS_ON[0]==bisON) && (bat[0]._Ub>80) && ( (abs(bat[0]._Ib)<IKB) || (bat[0]._av&1) ) ) kb_start[0]=1;
;;;2298   	if( (BAT_IS_ON[1]==bisON) && (bat[1]._Ub>80) && ( (abs(bat[1]._Ib)<IKB) || (bat[1]._av&1) ) ) kb_start[1]=1;
;;;2299   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;2300   	if( (!ips_bat_av_vzvod)                      && ((abs(Ib_ips_termokompensat)<IKB) || (bat_ips._av&1) ) ) kb_start_ips=1;
002424  f8dfa2e0          LDR      r10,|L1.9992|
002428  2500              MOVS     r5,#0                 ;2288
00242a  f8b80052          LDRH     r0,[r8,#0x52]         ;2288  ; main_kb_cnt
00242e  4eb7              LDR      r6,|L1.9996|
002430  1c40              ADDS     r0,r0,#1              ;2288
002432  b201              SXTH     r1,r0                 ;2288
002434  48b3              LDR      r0,|L1.9988|
002436  f8a81052          STRH     r1,[r8,#0x52]         ;2288
00243a  f8df92d4          LDR      r9,|L1.10000|
00243e  f9b00000          LDRSH    r0,[r0,#0]            ;2288  ; TBAT
;;;2301   #endif	
;;;2302   	if( (net_av) || (num_of_wrks_bps==0) || ( (spc_stat!=spcOFF) && (spc_stat!=spcVZ) ) 
;;;2303   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;2304   	  ||(((vz1_stat!=vz1sOFF)||(vz2_stat!=vz2sOFF))&&SMART_SPC)
;;;2305   #endif
;;;2306   	  ||(sp_ch_stat!=scsOFF) 	)
;;;2307    
;;;2308   		{
;;;2309   		kb_start[0]=0;
;;;2310   		kb_start[1]=0;
;;;2311   		kb_start_ips=0;
;;;2312   		}
;;;2313   
;;;2314   	if((kb_start[0]==1)||(kb_start[1]==1)||(kb_start_ips==1))
;;;2315   		{
;;;2316   		kb_cnt_1lev=10;
002442  270a              MOVS     r7,#0xa
002444  ebc01200          RSB      r2,r0,r0,LSL #4       ;2288
002448  f04f0b01          MOV      r11,#1                ;2297
00244c  f1080458          ADD      r4,r8,#0x58           ;2293
002450  ebb10f82          CMP      r1,r2,LSL #2          ;2288
002454  db6c              BLT      |L1.9520|
002456  2800              CMP      r0,#0                 ;2288
002458  d06a              BEQ      |L1.9520|
00245a  f8a85052          STRH     r5,[r8,#0x52]         ;2291
00245e  7025              STRB     r5,[r4,#0]            ;2293
002460  7065              STRB     r5,[r4,#1]            ;2294
002462  f888501d          STRB     r5,[r8,#0x1d]         ;2295
002466  48ab              LDR      r0,|L1.10004|
002468  7800              LDRB     r0,[r0,#0]            ;2297  ; BAT_IS_ON
00246a  2855              CMP      r0,#0x55              ;2297
00246c  d111              BNE      |L1.9362|
00246e  f9b60002          LDRSH    r0,[r6,#2]            ;2297  ; bat
002472  2850              CMP      r0,#0x50              ;2297
002474  dd0d              BLE      |L1.9362|
002476  f9b60008          LDRSH    r0,[r6,#8]            ;2297  ; bat
00247a  f7fffffe          BL       abs
00247e  f9b91000          LDRSH    r1,[r9,#0]            ;2297  ; IKB
002482  4288              CMP      r0,r1                 ;2297
002484  db03              BLT      |L1.9358|
002486  f896003d          LDRB     r0,[r6,#0x3d]         ;2297  ; bat
00248a  07c0              LSLS     r0,r0,#31             ;2297
00248c  d001              BEQ      |L1.9362|
                  |L1.9358|
00248e  f884b000          STRB     r11,[r4,#0]           ;2297
                  |L1.9362|
002492  48a0              LDR      r0,|L1.10004|
002494  7840              LDRB     r0,[r0,#1]            ;2298  ; BAT_IS_ON
002496  2855              CMP      r0,#0x55              ;2298
002498  d111              BNE      |L1.9406|
00249a  f9b6004e          LDRSH    r0,[r6,#0x4e]         ;2298  ; bat
00249e  2850              CMP      r0,#0x50              ;2298
0024a0  dd0d              BLE      |L1.9406|
0024a2  f9b60054          LDRSH    r0,[r6,#0x54]         ;2298  ; bat
0024a6  f7fffffe          BL       abs
0024aa  f9b91000          LDRSH    r1,[r9,#0]            ;2298  ; IKB
0024ae  4288              CMP      r0,r1                 ;2298
0024b0  db03              BLT      |L1.9402|
0024b2  f8960089          LDRB     r0,[r6,#0x89]         ;2298  ; bat
0024b6  07c0              LSLS     r0,r0,#31             ;2298
0024b8  d001              BEQ      |L1.9406|
                  |L1.9402|
0024ba  f884b001          STRB     r11,[r4,#1]           ;2298
                  |L1.9406|
0024be  4896              LDR      r0,|L1.10008|
0024c0  7800              LDRB     r0,[r0,#0]            ;2300  ; ips_bat_av_vzvod
0024c2  b970              CBNZ     r0,|L1.9442|
0024c4  f9ba0000          LDRSH    r0,[r10,#0]           ;2300  ; Ib_ips_termokompensat
0024c8  f7fffffe          BL       abs
0024cc  f9b91000          LDRSH    r1,[r9,#0]            ;2300  ; IKB
0024d0  4288              CMP      r0,r1                 ;2300
0024d2  db04              BLT      |L1.9438|
0024d4  4891              LDR      r0,|L1.10012|
0024d6  f890003d          LDRB     r0,[r0,#0x3d]         ;2300  ; bat_ips
0024da  07c0              LSLS     r0,r0,#31             ;2300
0024dc  d001              BEQ      |L1.9442|
                  |L1.9438|
0024de  f888b01d          STRB     r11,[r8,#0x1d]        ;2300
                  |L1.9442|
0024e2  488f              LDR      r0,|L1.10016|
0024e4  7800              LDRB     r0,[r0,#0]            ;2302  ; net_av
0024e6  b998              CBNZ     r0,|L1.9488|
0024e8  f898001e          LDRB     r0,[r8,#0x1e]         ;2302  ; num_of_wrks_bps
0024ec  b180              CBZ      r0,|L1.9488|
0024ee  f8980023          LDRB     r0,[r8,#0x23]         ;2302  ; spc_stat
0024f2  b108              CBZ      r0,|L1.9464|
0024f4  2802              CMP      r0,#2                 ;2302
0024f6  d10b              BNE      |L1.9488|
                  |L1.9464|
0024f8  f8980005          LDRB     r0,[r8,#5]            ;2304  ; vz1_stat
0024fc  f8981007          LDRB     r1,[r8,#7]            ;2304  ; vz2_stat
002500  4308              ORRS     r0,r0,r1              ;2304
002502  d002              BEQ      |L1.9482|
002504  4887              LDR      r0,|L1.10020|
002506  8800              LDRH     r0,[r0,#0]            ;2304  ; SMART_SPC
002508  b910              CBNZ     r0,|L1.9488|
                  |L1.9482|
00250a  4887              LDR      r0,|L1.10024|
00250c  7800              LDRB     r0,[r0,#0]            ;2306  ; sp_ch_stat
00250e  b118              CBZ      r0,|L1.9496|
                  |L1.9488|
002510  7025              STRB     r5,[r4,#0]            ;2309
002512  7065              STRB     r5,[r4,#1]            ;2310
002514  f888501d          STRB     r5,[r8,#0x1d]         ;2311
                  |L1.9496|
002518  7820              LDRB     r0,[r4,#0]            ;2314  ; kb_start
00251a  2801              CMP      r0,#1                 ;2314
00251c  d020              BEQ      |L1.9568|
00251e  7860              LDRB     r0,[r4,#1]            ;2314  ; kb_start
002520  2801              CMP      r0,#1                 ;2314
002522  d01d              BEQ      |L1.9568|
002524  f898001d          LDRB     r0,[r8,#0x1d]         ;2314  ; kb_start_ips
002528  2801              CMP      r0,#1                 ;2314
00252a  d019              BEQ      |L1.9568|
;;;2317   		}
;;;2318   	else kb_cnt_1lev=0;
00252c  f8a85054          STRH     r5,[r8,#0x54]
                  |L1.9520|
;;;2319   	}
;;;2320   
;;;2321   if(kb_cnt_1lev)
002530  4641              MOV      r1,r8
002532  f9b80054          LDRSH    r0,[r8,#0x54]  ; kb_cnt_1lev
;;;2322   	{
;;;2323   	kb_cnt_1lev--;
;;;2324   
;;;2325   	if(kb_cnt_1lev>5)mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_PLUS,30,15);
;;;2326   	else if(kb_cnt_1lev>0) mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_MINUS,30,15);
;;;2327   
;;;2328   
;;;2329   	if(kb_cnt_1lev==5)
;;;2330   		{
;;;2331   		ibat[0]=abs(bat[0]._Ib);
002536  f8df81c4          LDR      r8,|L1.9980|
00253a  2800              CMP      r0,#0                 ;2321
00253c  f1080890          ADD      r8,r8,#0x90
002540  d07e              BEQ      |L1.9792|
002542  f1a00001          SUB      r0,r0,#1              ;2323
002546  b200              SXTH     r0,r0                 ;2323
002548  468b              MOV      r11,r1                ;2323
00254a  f8a10054          STRH     r0,[r1,#0x54]         ;2323
00254e  2805              CMP      r0,#5                 ;2325
002550  dd09              BLE      |L1.9574|
002552  230f              MOVS     r3,#0xf               ;2325
002554  221e              MOVS     r2,#0x1e              ;2325
002556  2164              MOVS     r1,#0x64              ;2325
002558  20e1              MOVS     r0,#0xe1              ;2325
00255a  f7fffffe          BL       mess_send
00255e  e00a              B        |L1.9590|
                  |L1.9568|
002560  f8a87054          STRH     r7,[r8,#0x54]         ;2316
002564  e7e4              B        |L1.9520|
                  |L1.9574|
002566  2800              CMP      r0,#0                 ;2326
002568  dd05              BLE      |L1.9590|
00256a  230f              MOVS     r3,#0xf               ;2326
00256c  221e              MOVS     r2,#0x1e              ;2326
00256e  2169              MOVS     r1,#0x69              ;2326
002570  20e1              MOVS     r0,#0xe1              ;2326
002572  f7fffffe          BL       mess_send
                  |L1.9590|
002576  f8bb0054          LDRH     r0,[r11,#0x54]        ;2329  ; kb_cnt_1lev
00257a  2805              CMP      r0,#5                 ;2329
00257c  d111              BNE      |L1.9634|
00257e  f9b60008          LDRSH    r0,[r6,#8]  ; bat
002582  f7fffffe          BL       abs
002586  f8a80000          STRH     r0,[r8,#0]
;;;2332   		ibat[1]=abs(bat[1]._Ib);
00258a  f9b60054          LDRSH    r0,[r6,#0x54]  ; bat
00258e  f7fffffe          BL       abs
002592  f8a80002          STRH     r0,[r8,#2]
;;;2333   		ibat_ips=abs(Ib_ips_termokompensat);
002596  f9ba0000          LDRSH    r0,[r10,#0]  ; Ib_ips_termokompensat
00259a  f7fffffe          BL       abs
00259e  f8ab005a          STRH     r0,[r11,#0x5a]
                  |L1.9634|
;;;2334   		}
;;;2335   	
;;;2336   	if(kb_cnt_1lev==0)
0025a2  4856              LDR      r0,|L1.9980|
0025a4  f8b00054          LDRH     r0,[r0,#0x54]  ; kb_cnt_1lev
0025a8  2800              CMP      r0,#0
0025aa  d158              BNE      |L1.9822|
;;;2337   		{
;;;2338   		ibat_[0]=abs(bat[0]._Ib);
0025ac  f9b60008          LDRSH    r0,[r6,#8]  ; bat
0025b0  f7fffffe          BL       abs
0025b4  f8dfb144          LDR      r11,|L1.9980|
0025b8  f10b0b94          ADD      r11,r11,#0x94
0025bc  f8ab0000          STRH     r0,[r11,#0]
;;;2339   		ibat_[1]=abs(bat[1]._Ib);
0025c0  f9b60054          LDRSH    r0,[r6,#0x54]  ; bat
0025c4  f7fffffe          BL       abs
0025c8  f8ab0002          STRH     r0,[r11,#2]
;;;2340   		ibat_ips_=abs(Ib_ips_termokompensat);
0025cc  f9ba0000          LDRSH    r0,[r10,#0]  ; Ib_ips_termokompensat
0025d0  f7fffffe          BL       abs
0025d4  f8dfa124          LDR      r10,|L1.9980|
0025d8  f8aa005c          STRH     r0,[r10,#0x5c]
;;;2341   
;;;2342   		kb_cnt_2lev=0;
0025dc  f8aa5056          STRH     r5,[r10,#0x56]
;;;2343   
;;;2344   
;;;2345   		if(( (ibat[0]+ibat_[0]) < IKB )&& (kb_start[0]==1))
0025e0  f9b80000          LDRSH    r0,[r8,#0]  ; ibat
0025e4  f9bb1000          LDRSH    r1,[r11,#0]  ; ibat_
0025e8  4408              ADD      r0,r0,r1
0025ea  f9b91000          LDRSH    r1,[r9,#0]  ; IKB
0025ee  4288              CMP      r0,r1
0025f0  da02              BGE      |L1.9720|
0025f2  7820              LDRB     r0,[r4,#0]  ; kb_start
0025f4  2801              CMP      r0,#1
0025f6  d034              BEQ      |L1.9826|
                  |L1.9720|
;;;2346   			{
;;;2347   			kb_cnt_2lev=10;  
;;;2348   			}
;;;2349   		else if(bat[0]._Ub>200)
0025f8  f9b60002          LDRSH    r0,[r6,#2]  ; bat
0025fc  28c8              CMP      r0,#0xc8
0025fe  dd04              BLE      |L1.9738|
;;;2350   			{
;;;2351   			kb_start[0]=0;
002600  7025              STRB     r5,[r4,#0]
;;;2352   			avar_bat_hndl(0,0);
002602  2100              MOVS     r1,#0
002604  4608              MOV      r0,r1
002606  f7fffffe          BL       avar_bat_hndl
                  |L1.9738|
;;;2353   			}
;;;2354   		
;;;2355   		if(( (ibat[1]+ibat_[1]) < IKB ) && (kb_start[1]==1))
00260a  f9b80002          LDRSH    r0,[r8,#2]  ; ibat
00260e  f9bb1002          LDRSH    r1,[r11,#2]  ; ibat_
002612  4408              ADD      r0,r0,r1
002614  f9b91000          LDRSH    r1,[r9,#0]  ; IKB
002618  4288              CMP      r0,r1
00261a  da02              BGE      |L1.9762|
00261c  7860              LDRB     r0,[r4,#1]  ; kb_start
00261e  2801              CMP      r0,#1
002620  d022              BEQ      |L1.9832|
                  |L1.9762|
;;;2356   			{
;;;2357   			kb_cnt_2lev=10;     
;;;2358   			}
;;;2359   		else  if(bat[1]._Ub>200)
002622  f9b6004e          LDRSH    r0,[r6,#0x4e]  ; bat
002626  28c8              CMP      r0,#0xc8
002628  dd04              BLE      |L1.9780|
;;;2360   			{
;;;2361   			kb_start[1]=0;
00262a  7065              STRB     r5,[r4,#1]
;;;2362   			avar_bat_hndl(1,0);
00262c  2100              MOVS     r1,#0
00262e  2001              MOVS     r0,#1
002630  f7fffffe          BL       avar_bat_hndl
                  |L1.9780|
;;;2363   			}
;;;2364   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;2365   		if(( (ibat_ips+ibat_ips_) < IKB ) && (kb_start_ips==1))
002634  f9ba005a          LDRSH    r0,[r10,#0x5a]  ; ibat_ips
002638  f9ba105c          LDRSH    r1,[r10,#0x5c]  ; ibat_ips_
00263c  4408              ADD      r0,r0,r1
00263e  e000              B        |L1.9794|
                  |L1.9792|
002640  e01b              B        |L1.9850|
                  |L1.9794|
002642  f9b91000          LDRSH    r1,[r9,#0]  ; IKB
002646  4288              CMP      r0,r1
002648  da09              BGE      |L1.9822|
00264a  f89a001d          LDRB     r0,[r10,#0x1d]  ; kb_start_ips
00264e  2801              CMP      r0,#1
002650  d105              BNE      |L1.9822|
;;;2366   			{
;;;2367   			if(KB_ALGORITM==1)
002652  4836              LDR      r0,|L1.10028|
002654  8800              LDRH     r0,[r0,#0]  ; KB_ALGORITM
002656  2801              CMP      r0,#1
002658  d009              BEQ      |L1.9838|
;;;2368   				{
;;;2369   				avar_bat_ips_hndl(1);
;;;2370   				kb_start_ips=0;
;;;2371   				}
;;;2372   			else
;;;2373   				{
;;;2374   				kb_cnt_2lev=10;     
00265a  f8aa7056          STRH     r7,[r10,#0x56]
                  |L1.9822|
;;;2375   				}
;;;2376   			}
;;;2377   #endif
;;;2378   		}	
;;;2379   
;;;2380   
;;;2381   	}
;;;2382   else if(kb_cnt_2lev)
;;;2383   	{
;;;2384   	kb_cnt_2lev--;
;;;2385   
;;;2386   	if(kb_cnt_2lev>5)mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_PLUS,200,15);
;;;2387   	else if(kb_cnt_2lev>0) mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_MINUS,200,15);
;;;2388   
;;;2389   
;;;2390   	if(kb_cnt_2lev==5)
;;;2391   		{
;;;2392   		ibat[0]=abs(bat[0]._Ib);
;;;2393   		ibat[1]=abs(bat[1]._Ib);
;;;2394   		ibat_ips=abs(Ib_ips_termokompensat);
;;;2395   		}
;;;2396   	
;;;2397   	if(kb_cnt_2lev==0)
;;;2398   		{
;;;2399   		ibat_[0]=abs(bat[0]._Ib);
;;;2400   		ibat_[1]=abs(bat[1]._Ib);
;;;2401   		ibat_ips_=abs(Ib_ips_termokompensat);
;;;2402   
;;;2403   		kb_full_ver=0;
;;;2404   
;;;2405   		if(( (ibat[0]+ibat_[0]) < IKB ) && (kb_start[0]==1))
;;;2406   			{
;;;2407   			kb_full_ver=1;  
;;;2408   			}
;;;2409   		else if(bat[0]._Ub>200)			
;;;2410   			{
;;;2411   			kb_start[0]=0;
;;;2412   			avar_bat_hndl(0,0);
;;;2413   			}
;;;2414   
;;;2415   		if(( (ibat[1]+ibat_[1]) < IKB ) && (kb_start[1]==1))
;;;2416   			{
;;;2417   			kb_full_ver=1;     
;;;2418   			}
;;;2419   		else	if(bat[1]._Ub>200)		
;;;2420   			{
;;;2421   			kb_start[1]=0;
;;;2422   			avar_bat_hndl(1,0);
;;;2423   			}
;;;2424   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;2425   		if(( (ibat_ips+ibat_ips_) < IKB )  && (kb_start_ips==1))
;;;2426   			{
;;;2427   			if(KB_ALGORITM==2)
;;;2428   				{
;;;2429   				avar_bat_ips_hndl(1);
;;;2430   				kb_start_ips=0;
;;;2431   				}
;;;2432   			else
;;;2433   				{
;;;2434   				kb_full_ver=1;     
;;;2435   				}
;;;2436   			}
;;;2437   #endif
;;;2438   		}	
;;;2439   	}
;;;2440   
;;;2441   else if(kb_full_ver)
;;;2442   	{
;;;2443   	
;;;2444   	mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_STEP_DOWN,0,15);
;;;2445   
;;;2446   	if( abs(bat[0]._Ib) > IKB ) 
;;;2447   		{
;;;2448   		if(kb_start[0]==1)
;;;2449   			{
;;;2450   			kb_start[0]=0;
;;;2451   			avar_bat_hndl(0,0);
;;;2452   			}
;;;2453   		}
;;;2454   
;;;2455   	if( abs(bat[1]._Ib) > IKB ) 
;;;2456   		{
;;;2457   		if(kb_start[1]==1)
;;;2458   			{
;;;2459   			kb_start[1]=0;
;;;2460   			avar_bat_hndl(1,0);
;;;2461   			}
;;;2462   		}
;;;2463   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;2464   	if( abs(Ib_ips_termokompensat) > IKB ) 
;;;2465   		{
;;;2466   		if(kb_start_ips==1)
;;;2467   			{
;;;2468   			kb_start_ips=0;
;;;2469   			avar_bat_ips_hndl(0);
;;;2470   			}
;;;2471   		}
;;;2472   #endif
;;;2473   
;;;2474   	if ((kb_start[0]==0) && (kb_start[1]==0) && (kb_start_ips==0)) 
;;;2475   		{
;;;2476   		kb_full_ver=0;
;;;2477   		}
;;;2478   
;;;2479   	if(( (mess_find(MESS2KB_HNDL))	&& (mess_data[0]==PARAM_CNTRL_IS_DOWN) ) || (load_U<(USIGN*10)) )
;;;2480   		{
;;;2481   		kb_full_ver=0;
;;;2482   		if((kb_start[0]==1)&&((load_I>(2*IKB)/10))&&(!(bat[0]._av&0x01))) avar_bat_hndl(0,1);
;;;2483   		if((kb_start[1]==1)&&((load_I>(2*IKB)/10))&&(!(bat[1]._av&0x01))) avar_bat_hndl(1,1);
;;;2484   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;2485   		if((kb_start_ips==1)&&((load_I>(2*IKB)/10))&&(!(bat_ips._av&0x01))) avar_bat_ips_hndl(1);
;;;2486   #endif
;;;2487   		}
;;;2488   	}
;;;2489   
;;;2490   }
00265e  e8bd9ff0          POP      {r4-r12,pc}
                  |L1.9826|
002662  f8aa7056          STRH     r7,[r10,#0x56]        ;2347
002666  e7d0              B        |L1.9738|
                  |L1.9832|
002668  f8aa7056          STRH     r7,[r10,#0x56]        ;2357
00266c  e7e2              B        |L1.9780|
                  |L1.9838|
00266e  2001              MOVS     r0,#1                 ;2369
002670  f7fffffe          BL       avar_bat_ips_hndl
002674  f88a501d          STRB     r5,[r10,#0x1d]        ;2370
                  |L1.9848|
002678  e7f1              B        |L1.9822|
                  |L1.9850|
00267a  f9b10056          LDRSH    r0,[r1,#0x56]         ;2382  ; kb_cnt_2lev
00267e  b380              CBZ      r0,|L1.9954|
002680  f1a00001          SUB      r0,r0,#1              ;2384
002684  b200              SXTH     r0,r0                 ;2384
002686  460f              MOV      r7,r1                 ;2384
002688  f8a10056          STRH     r0,[r1,#0x56]         ;2384
00268c  2805              CMP      r0,#5                 ;2386
00268e  dd06              BLE      |L1.9886|
002690  230f              MOVS     r3,#0xf               ;2386
002692  22c8              MOVS     r2,#0xc8              ;2386
002694  2164              MOVS     r1,#0x64              ;2386
002696  20e1              MOVS     r0,#0xe1              ;2386
002698  f7fffffe          BL       mess_send
00269c  e007              B        |L1.9902|
                  |L1.9886|
00269e  2800              CMP      r0,#0                 ;2387
0026a0  dd05              BLE      |L1.9902|
0026a2  230f              MOVS     r3,#0xf               ;2387
0026a4  22c8              MOVS     r2,#0xc8              ;2387
0026a6  2169              MOVS     r1,#0x69              ;2387
0026a8  20e1              MOVS     r0,#0xe1              ;2387
0026aa  f7fffffe          BL       mess_send
                  |L1.9902|
0026ae  f8b70056          LDRH     r0,[r7,#0x56]         ;2390  ; kb_cnt_2lev
0026b2  2805              CMP      r0,#5                 ;2390
0026b4  d111              BNE      |L1.9946|
0026b6  f9b60008          LDRSH    r0,[r6,#8]            ;2392  ; bat
0026ba  f7fffffe          BL       abs
0026be  f8a80000          STRH     r0,[r8,#0]            ;2392
0026c2  f9b60054          LDRSH    r0,[r6,#0x54]         ;2393  ; bat
0026c6  f7fffffe          BL       abs
0026ca  f8a80002          STRH     r0,[r8,#2]            ;2393
0026ce  f9ba0000          LDRSH    r0,[r10,#0]           ;2394  ; Ib_ips_termokompensat
0026d2  f7fffffe          BL       abs
0026d6  f8a7005a          STRH     r0,[r7,#0x5a]         ;2394
                  |L1.9946|
0026da  4808              LDR      r0,|L1.9980|
0026dc  f8b00056          LDRH     r0,[r0,#0x56]         ;2397  ; kb_cnt_2lev
0026e0  e026              B        |L1.10032|
                  |L1.9954|
0026e2  e087              B        |L1.10228|
                  |L1.9956|
0026e4  20202020          DCB      "    ",212,206,208,204,206,194,206,215,205,219,201,"    "
0026e8  d4ced0cc
0026ec  cec2ced7
0026f0  cddbc920
0026f4  202020  
0026f7  2000              DCB      " ",0
0026f9  00                DCB      0
0026fa  00                DCB      0
0026fb  00                DCB      0
                  |L1.9980|
                          DCD      ||area_number.26||
                  |L1.9984|
                          DCD      speedChrgBlckStat
                  |L1.9988|
                          DCD      TBAT
                  |L1.9992|
                          DCD      Ib_ips_termokompensat
                  |L1.9996|
                          DCD      bat
                  |L1.10000|
                          DCD      IKB
                  |L1.10004|
                          DCD      BAT_IS_ON
                  |L1.10008|
                          DCD      ips_bat_av_vzvod
                  |L1.10012|
                          DCD      bat_ips
                  |L1.10016|
                          DCD      net_av
                  |L1.10020|
                          DCD      SMART_SPC
                  |L1.10024|
                          DCD      sp_ch_stat
                  |L1.10028|
                          DCD      KB_ALGORITM
                  |L1.10032|
002730  2800              CMP      r0,#0                 ;2397
                  |L1.10034|
002732  d194              BNE      |L1.9822|
002734  f9b60008          LDRSH    r0,[r6,#8]            ;2399  ; bat
002738  f7fffffe          BL       abs
00273c  4fff              LDR      r7,|L1.11068|
00273e  8038              STRH     r0,[r7,#0]            ;2399
002740  f9b60054          LDRSH    r0,[r6,#0x54]         ;2400  ; bat
002744  f7fffffe          BL       abs
002748  8078              STRH     r0,[r7,#2]            ;2400
00274a  f9ba0000          LDRSH    r0,[r10,#0]           ;2401  ; Ib_ips_termokompensat
00274e  f7fffffe          BL       abs
002752  f1a70a94          SUB      r10,r7,#0x94          ;2401
002756  f8aa005c          STRH     r0,[r10,#0x5c]        ;2401
00275a  f88a501c          STRB     r5,[r10,#0x1c]        ;2403
00275e  f9b80000          LDRSH    r0,[r8,#0]            ;2405  ; ibat
002762  f9b71000          LDRSH    r1,[r7,#0]            ;2405  ; ibat_
002766  4408              ADD      r0,r0,r1              ;2405
002768  f9b91000          LDRSH    r1,[r9,#0]            ;2405  ; IKB
00276c  4288              CMP      r0,r1                 ;2405
00276e  da02              BGE      |L1.10102|
002770  7820              LDRB     r0,[r4,#0]            ;2405  ; kb_start
002772  2801              CMP      r0,#1                 ;2405
002774  d032              BEQ      |L1.10204|
                  |L1.10102|
002776  f9b60002          LDRSH    r0,[r6,#2]            ;2409  ; bat
00277a  28c8              CMP      r0,#0xc8              ;2409
00277c  dd04              BLE      |L1.10120|
00277e  7025              STRB     r5,[r4,#0]            ;2411
002780  2100              MOVS     r1,#0                 ;2412
002782  4608              MOV      r0,r1                 ;2412
002784  f7fffffe          BL       avar_bat_hndl
                  |L1.10120|
002788  f9b80002          LDRSH    r0,[r8,#2]            ;2415  ; ibat
00278c  f9b71002          LDRSH    r1,[r7,#2]            ;2415  ; ibat_
002790  4408              ADD      r0,r0,r1              ;2415
002792  f9b91000          LDRSH    r1,[r9,#0]            ;2415  ; IKB
002796  4288              CMP      r0,r1                 ;2415
002798  da02              BGE      |L1.10144|
00279a  7860              LDRB     r0,[r4,#1]            ;2415  ; kb_start
00279c  2801              CMP      r0,#1                 ;2415
00279e  d020              BEQ      |L1.10210|
                  |L1.10144|
0027a0  f9b6004e          LDRSH    r0,[r6,#0x4e]         ;2419  ; bat
0027a4  28c8              CMP      r0,#0xc8              ;2419
0027a6  dd04              BLE      |L1.10162|
0027a8  7065              STRB     r5,[r4,#1]            ;2421
0027aa  2100              MOVS     r1,#0                 ;2422
0027ac  2001              MOVS     r0,#1                 ;2422
0027ae  f7fffffe          BL       avar_bat_hndl
                  |L1.10162|
0027b2  f9ba005a          LDRSH    r0,[r10,#0x5a]        ;2425  ; ibat_ips
0027b6  f9ba105c          LDRSH    r1,[r10,#0x5c]        ;2425  ; ibat_ips_
0027ba  4408              ADD      r0,r0,r1              ;2425
0027bc  f9b91000          LDRSH    r1,[r9,#0]            ;2425  ; IKB
0027c0  4288              CMP      r0,r1                 ;2425
0027c2  f6bfaf59          BGE      |L1.9848|
0027c6  f89a001d          LDRB     r0,[r10,#0x1d]        ;2425  ; kb_start_ips
0027ca  2801              CMP      r0,#1                 ;2425
0027cc  d1b1              BNE      |L1.10034|
0027ce  48dc              LDR      r0,|L1.11072|
0027d0  8800              LDRH     r0,[r0,#0]            ;2427  ; KB_ALGORITM
0027d2  2802              CMP      r0,#2                 ;2427
0027d4  d008              BEQ      |L1.10216|
0027d6  f88ab01c          STRB     r11,[r10,#0x1c]       ;2434
                  |L1.10202|
0027da  e740              B        |L1.9822|
                  |L1.10204|
0027dc  f88ab01c          STRB     r11,[r10,#0x1c]       ;2407
0027e0  e7d2              B        |L1.10120|
                  |L1.10210|
0027e2  f88ab01c          STRB     r11,[r10,#0x1c]       ;2417
0027e6  e7e4              B        |L1.10162|
                  |L1.10216|
0027e8  2001              MOVS     r0,#1                 ;2429
0027ea  f7fffffe          BL       avar_bat_ips_hndl
0027ee  f88a501d          STRB     r5,[r10,#0x1d]        ;2430
0027f2  e734              B        |L1.9822|
                  |L1.10228|
0027f4  7f08              LDRB     r0,[r1,#0x1c]         ;2441  ; kb_full_ver
0027f6  4688              MOV      r8,r1                 ;2441
0027f8  2800              CMP      r0,#0                 ;2441
0027fa  d0ee              BEQ      |L1.10202|
0027fc  230f              MOVS     r3,#0xf               ;2444
0027fe  2200              MOVS     r2,#0                 ;2444
002800  216e              MOVS     r1,#0x6e              ;2444
002802  20e1              MOVS     r0,#0xe1              ;2444
002804  f7fffffe          BL       mess_send
002808  f9b60008          LDRSH    r0,[r6,#8]            ;2446  ; bat
00280c  f7fffffe          BL       abs
002810  f9b91000          LDRSH    r1,[r9,#0]            ;2446  ; IKB
002814  4288              CMP      r0,r1                 ;2446
002816  dd07              BLE      |L1.10280|
002818  7820              LDRB     r0,[r4,#0]            ;2448  ; kb_start
00281a  2801              CMP      r0,#1                 ;2448
00281c  d104              BNE      |L1.10280|
00281e  7025              STRB     r5,[r4,#0]            ;2450
002820  2100              MOVS     r1,#0                 ;2451
002822  4608              MOV      r0,r1                 ;2451
002824  f7fffffe          BL       avar_bat_hndl
                  |L1.10280|
002828  f9b60054          LDRSH    r0,[r6,#0x54]         ;2455  ; bat
00282c  f7fffffe          BL       abs
002830  f9b91000          LDRSH    r1,[r9,#0]            ;2455  ; IKB
002834  4288              CMP      r0,r1                 ;2455
002836  dd06              BLE      |L1.10310|
002838  7860              LDRB     r0,[r4,#1]            ;2457  ; kb_start
00283a  2801              CMP      r0,#1                 ;2457
00283c  d103              BNE      |L1.10310|
00283e  7065              STRB     r5,[r4,#1]            ;2459
002840  2100              MOVS     r1,#0                 ;2460
002842  f7fffffe          BL       avar_bat_hndl
                  |L1.10310|
002846  f9ba0000          LDRSH    r0,[r10,#0]           ;2464  ; Ib_ips_termokompensat
00284a  f7fffffe          BL       abs
00284e  f9b91000          LDRSH    r1,[r9,#0]            ;2464  ; IKB
002852  4288              CMP      r0,r1                 ;2464
002854  dd08              BLE      |L1.10344|
002856  f898001d          LDRB     r0,[r8,#0x1d]         ;2466  ; kb_start_ips
00285a  2801              CMP      r0,#1                 ;2466
00285c  d104              BNE      |L1.10344|
00285e  f888501d          STRB     r5,[r8,#0x1d]         ;2468
002862  2000              MOVS     r0,#0                 ;2469
002864  f7fffffe          BL       avar_bat_ips_hndl
                  |L1.10344|
002868  7820              LDRB     r0,[r4,#0]            ;2474  ; kb_start
00286a  b930              CBNZ     r0,|L1.10362|
00286c  7860              LDRB     r0,[r4,#1]            ;2474  ; kb_start
00286e  b920              CBNZ     r0,|L1.10362|
002870  f898001d          LDRB     r0,[r8,#0x1d]         ;2474  ; kb_start_ips
002874  b908              CBNZ     r0,|L1.10362|
002876  f888501c          STRB     r5,[r8,#0x1c]         ;2476
                  |L1.10362|
00287a  20e6              MOVS     r0,#0xe6              ;2479
00287c  f7fffffe          BL       mess_find
002880  b118              CBZ      r0,|L1.10378|
002882  48b0              LDR      r0,|L1.11076|
002884  6800              LDR      r0,[r0,#0]            ;2479  ; mess_data
002886  28e7              CMP      r0,#0xe7              ;2479
002888  d00a              BEQ      |L1.10400|
                  |L1.10378|
00288a  48af              LDR      r0,|L1.11080|
00288c  49af              LDR      r1,|L1.11084|
00288e  f9b00000          LDRSH    r0,[r0,#0]            ;2479  ; USIGN
002892  f9b11000          LDRSH    r1,[r1,#0]            ;2479  ; load_U
002896  eb000080          ADD      r0,r0,r0,LSL #2       ;2479
00289a  ebb10f40          CMP      r1,r0,LSL #1          ;2479
                  |L1.10398|
00289e  da9c              BGE      |L1.10202|
                  |L1.10400|
0028a0  f888501c          STRB     r5,[r8,#0x1c]         ;2481
0028a4  7820              LDRB     r0,[r4,#0]            ;2482  ; kb_start
0028a6  4daa              LDR      r5,|L1.11088|
0028a8  2801              CMP      r0,#1                 ;2482
0028aa  d10f              BNE      |L1.10444|
0028ac  f9b90000          LDRSH    r0,[r9,#0]            ;2482  ; IKB
0028b0  f9b51000          LDRSH    r1,[r5,#0]            ;2482  ; load_I
0028b4  0040              LSLS     r0,r0,#1              ;2482
0028b6  fb90f0f7          SDIV     r0,r0,r7              ;2482
0028ba  4288              CMP      r0,r1                 ;2482
0028bc  da06              BGE      |L1.10444|
0028be  f896003d          LDRB     r0,[r6,#0x3d]         ;2482  ; bat
0028c2  07c0              LSLS     r0,r0,#31             ;2482
0028c4  d102              BNE      |L1.10444|
0028c6  2101              MOVS     r1,#1                 ;2482
0028c8  f7fffffe          BL       avar_bat_hndl
                  |L1.10444|
0028cc  7860              LDRB     r0,[r4,#1]            ;2483  ; kb_start
0028ce  2801              CMP      r0,#1                 ;2483
0028d0  d110              BNE      |L1.10484|
0028d2  f9b90000          LDRSH    r0,[r9,#0]            ;2483  ; IKB
0028d6  f9b51000          LDRSH    r1,[r5,#0]            ;2483  ; load_I
0028da  0040              LSLS     r0,r0,#1              ;2483
0028dc  fb90f0f7          SDIV     r0,r0,r7              ;2483
0028e0  4288              CMP      r0,r1                 ;2483
0028e2  da07              BGE      |L1.10484|
0028e4  f8960089          LDRB     r0,[r6,#0x89]         ;2483  ; bat
0028e8  07c0              LSLS     r0,r0,#31             ;2483
0028ea  d103              BNE      |L1.10484|
0028ec  2101              MOVS     r1,#1                 ;2483
0028ee  4608              MOV      r0,r1                 ;2483
0028f0  f7fffffe          BL       avar_bat_hndl
                  |L1.10484|
0028f4  f898001d          LDRB     r0,[r8,#0x1d]         ;2485  ; kb_start_ips
0028f8  2801              CMP      r0,#1                 ;2485
                  |L1.10490|
0028fa  f47faebd          BNE      |L1.9848|
0028fe  f9b90000          LDRSH    r0,[r9,#0]            ;2485  ; IKB
002902  f9b51000          LDRSH    r1,[r5,#0]            ;2485  ; load_I
002906  0040              LSLS     r0,r0,#1              ;2485
002908  fb90f0f7          SDIV     r0,r0,r7              ;2485
00290c  4288              CMP      r0,r1                 ;2485
00290e  dac6              BGE      |L1.10398|
002910  4890              LDR      r0,|L1.11092|
002912  f890003d          LDRB     r0,[r0,#0x3d]         ;2485  ; bat_ips
002916  07c0              LSLS     r0,r0,#31             ;2485
002918  d1ef              BNE      |L1.10490|
00291a  e8bd5ff0          POP      {r4-r12,lr}           ;2485
00291e  2001              MOVS     r0,#1                 ;2485
002920  f7ffbffe          B.W      avar_bat_ips_hndl
;;;2491   
                          ENDP

                  samokalibr_hndl PROC
;;;2500   //-----------------------------------------------
;;;2501   void samokalibr_hndl(void)
002924  4770              BX       lr
;;;2502   {
;;;2503   #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;2504   if(++samokalibr_cnt>=1800)samokalibr_cnt=0;
;;;2505   
;;;2506   if((samokalibr_cnt>=1785U)&&(vz2_stat==vz2sOFF))
;;;2507   	{
;;;2508   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,1,15);
;;;2509   	mess_send(MESS2IND_HNDL,PARAM_SAMOKALIBR,0,15);
;;;2510   	mess_send(MESS2MATEMAT,PARAM_SAMOKALIBR,0,15);
;;;2511   	} 
;;;2512   
;;;2513   if((samokalibr_cnt==1799U)&&(vz2_stat==vz2sOFF))
;;;2514   	{
;;;2515   	if((Kibat0[0]!=ad7705_buff_[0])&&(abs(bat[0]._Ib/10)<IZMAX)) lc640_write_int(ADR_KI0BAT[0],ad7705_buff_[0]);
;;;2516   	if((Kibat0[1]!=ad7705_buff_[1])&&(abs(bat[0]._Ib/10)<IZMAX)) lc640_write_int(ADR_KI0BAT[1],ad7705_buff_[1]);
;;;2517   	
;;;2518   	}
;;;2519   #endif	 	
;;;2520   }
;;;2521   
                          ENDP

                  ubat_old_drv PROC
;;;2524   //-----------------------------------------------
;;;2525   void ubat_old_drv(void)
002926  b510              PUSH     {r4,lr}
;;;2526   {        
;;;2527   bat_u_old_cnt++;
002928  4c8b              LDR      r4,|L1.11096|
00292a  8820              LDRH     r0,[r4,#0]  ; bat_u_old_cnt
00292c  f1000001          ADD      r0,r0,#1
002930  8020              STRH     r0,[r4,#0]
;;;2528   gran_ring(&bat_u_old_cnt,0,8);
002932  f04f0208          MOV      r2,#8
002936  f04f0100          MOV      r1,#0
00293a  4620              MOV      r0,r4
00293c  f7fffffe          BL       gran_ring
;;;2529   
;;;2530   bat[0]._u_old[bat_u_old_cnt]=bat[0]._Ub;
002940  4986              LDR      r1,|L1.11100|
002942  f9b40000          LDRSH    r0,[r4,#0]  ; bat_u_old_cnt
002946  eb010040          ADD      r0,r1,r0,LSL #1
00294a  884a              LDRH     r2,[r1,#2]  ; bat
00294c  8402              STRH     r2,[r0,#0x20]
;;;2531   bat[1]._u_old[bat_u_old_cnt]=bat[1]._Ub;
00294e  f8b1104e          LDRH     r1,[r1,#0x4e]  ; bat
002952  f8a0106c          STRH     r1,[r0,#0x6c]
;;;2532   }
002956  bd10              POP      {r4,pc}
;;;2533   
                          ENDP

                  unet_drv PROC
;;;2534   //-----------------------------------------------
;;;2535   void unet_drv(void)
002958  e92d41f0          PUSH     {r4-r8,lr}
;;;2536   {
;;;2537   if(net_av_2min_timer)net_av_2min_timer--;
00295c  4980              LDR      r1,|L1.11104|
00295e  f9b10000          LDRSH    r0,[r1,#0]  ; net_av_2min_timer
002962  b110              CBZ      r0,|L1.10602|
002964  f1a00001          SUB      r0,r0,#1
002968  8008              STRH     r0,[r1,#0]
                  |L1.10602|
;;;2538   
;;;2539   if(net_U<UMN)
00296a  f8df81f8          LDR      r8,|L1.11108|
00296e  487e              LDR      r0,|L1.11112|
;;;2540   	{
;;;2541   	if((unet_drv_cnt<10)&&(main_1Hz_cnt>15))
002970  4a7f              LDR      r2,|L1.11120|
;;;2542   		{
;;;2543   		unet_drv_cnt++;
;;;2544   		if(unet_drv_cnt>=10)
;;;2545   			{
;;;2546   			net_Ustore=net_U;
;;;2547   		 	avar_unet_hndl(1);
;;;2548   			
;;;2549   			}
;;;2550   		}
;;;2551   	else if(unet_drv_cnt>=10)unet_drv_cnt=10;
;;;2552   
;;;2553   	if(net_U<net_Ustore) net_Ustore=net_U;	
;;;2554   	}
;;;2555   
;;;2556   else if(net_U>UMN)
;;;2557   	{                 
;;;2558   	if(unet_drv_cnt)
;;;2559   		{
;;;2560   		unet_drv_cnt--;
;;;2561   		if(unet_drv_cnt<=0)
;;;2562   			{
;;;2563   			avar_unet_hndl(0);
;;;2564   			avar_bps_reset_cnt=10;
002972  4c72              LDR      r4,|L1.11068|
002974  f9b81000          LDRSH    r1,[r8,#0]            ;2539  ; net_U
002978  f9b03000          LDRSH    r3,[r0,#0]            ;2539  ; UMN
00297c  4e7b              LDR      r6,|L1.11116|
00297e  f9920000          LDRSB    r0,[r2,#0]            ;2541
002982  250a              MOVS     r5,#0xa               ;2551
002984  3c94              SUBS     r4,r4,#0x94
002986  4299              CMP      r1,r3                 ;2539
002988  da1c              BGE      |L1.10692|
00298a  4f7a              LDR      r7,|L1.11124|
00298c  280a              CMP      r0,#0xa               ;2541
00298e  da0e              BGE      |L1.10670|
002990  f9b63000          LDRSH    r3,[r6,#0]            ;2541  ; main_1Hz_cnt
002994  2b0f              CMP      r3,#0xf               ;2541
002996  dd0a              BLE      |L1.10670|
002998  f1000001          ADD      r0,r0,#1              ;2543
00299c  b240              SXTB     r0,r0                 ;2543
00299e  7010              STRB     r0,[r2,#0]            ;2543
0029a0  280a              CMP      r0,#0xa               ;2544
0029a2  db07              BLT      |L1.10676|
0029a4  8039              STRH     r1,[r7,#0]            ;2546
0029a6  2001              MOVS     r0,#1                 ;2547
0029a8  f7fffffe          BL       avar_unet_hndl
0029ac  e002              B        |L1.10676|
                  |L1.10670|
0029ae  280a              CMP      r0,#0xa               ;2551
0029b0  db00              BLT      |L1.10676|
0029b2  7015              STRB     r5,[r2,#0]            ;2551
                  |L1.10676|
0029b4  f9b80000          LDRSH    r0,[r8,#0]            ;2553  ; net_U
0029b8  f9b71000          LDRSH    r1,[r7,#0]            ;2553  ; net_Ustore
0029bc  4288              CMP      r0,r1                 ;2553
0029be  da0e              BGE      |L1.10718|
0029c0  8038              STRH     r0,[r7,#0]            ;2553
0029c2  e00c              B        |L1.10718|
                  |L1.10692|
0029c4  dd0b              BLE      |L1.10718|
0029c6  b150              CBZ      r0,|L1.10718|
0029c8  f1a00001          SUB      r0,r0,#1              ;2560
0029cc  b240              SXTB     r0,r0                 ;2560
0029ce  7010              STRB     r0,[r2,#0]            ;2560
0029d0  2800              CMP      r0,#0                 ;2561
0029d2  dc04              BGT      |L1.10718|
0029d4  2000              MOVS     r0,#0                 ;2563
0029d6  f7fffffe          BL       avar_unet_hndl
0029da  f8845031          STRB     r5,[r4,#0x31]
                  |L1.10718|
;;;2565   			}
;;;2566   		}
;;;2567   	else if(unet_drv_cnt<0)unet_drv_cnt=0;
;;;2568   	
;;;2569   	}
;;;2570   //#ifdef UKU_6U || UKU_ZVU
;;;2571   #if defined UKU_6U || defined UKU_ZVU  //o_10
;;;2572   if(net_Umax>UMAXN) //o_11
0029de  f8df8198          LDR      r8,|L1.11128|
0029e2  4866              LDR      r0,|L1.11132|
;;;2573   	{
;;;2574   	if((unet_max_drv_cnt<10)&&(main_1Hz_cnt>15))
0029e4  4a66              LDR      r2,|L1.11136|
0029e6  f9b81000          LDRSH    r1,[r8,#0]            ;2572  ; net_Umax
0029ea  f9b00000          LDRSH    r0,[r0,#0]            ;2572  ; UMAXN
0029ee  4281              CMP      r1,r0                 ;2572
0029f0  dd1e              BLE      |L1.10800|
0029f2  f9920000          LDRSB    r0,[r2,#0]  ; unet_max_drv_cnt
;;;2575   		{
;;;2576   		unet_max_drv_cnt++;
;;;2577   		if(unet_max_drv_cnt>=10)
;;;2578   			{
;;;2579   			net_Ustore_max=net_Umax; //o_11
0029f6  4f63              LDR      r7,|L1.11140|
0029f8  280a              CMP      r0,#0xa               ;2574
0029fa  da0e              BGE      |L1.10778|
0029fc  f9b63000          LDRSH    r3,[r6,#0]            ;2574  ; main_1Hz_cnt
002a00  2b0f              CMP      r3,#0xf               ;2574
002a02  dd0a              BLE      |L1.10778|
002a04  f1000001          ADD      r0,r0,#1              ;2576
002a08  b240              SXTB     r0,r0                 ;2576
002a0a  7010              STRB     r0,[r2,#0]            ;2576
002a0c  280a              CMP      r0,#0xa               ;2577
002a0e  db07              BLT      |L1.10784|
002a10  8039              STRH     r1,[r7,#0]
;;;2580   		 	avar_unet_hndl(2);
002a12  2002              MOVS     r0,#2
002a14  f7fffffe          BL       avar_unet_hndl
002a18  e002              B        |L1.10784|
                  |L1.10778|
;;;2581   			
;;;2582   			}
;;;2583   		}
;;;2584   	else if(unet_max_drv_cnt>=10)unet_max_drv_cnt=10;
002a1a  280a              CMP      r0,#0xa
002a1c  db00              BLT      |L1.10784|
002a1e  7015              STRB     r5,[r2,#0]
                  |L1.10784|
;;;2585   
;;;2586   	if(net_Umax>net_Ustore_max) net_Ustore_max=net_Umax; //o_11	
002a20  f9b80000          LDRSH    r0,[r8,#0]  ; net_Umax
002a24  f9b71000          LDRSH    r1,[r7,#0]  ; net_Ustore_max
002a28  4288              CMP      r0,r1
002a2a  dd10              BLE      |L1.10830|
002a2c  8038              STRH     r0,[r7,#0]
002a2e  e00e              B        |L1.10830|
                  |L1.10800|
;;;2587   	}
;;;2588   
;;;2589   else if(net_Umax<UMAXN) //o_11
002a30  da0d              BGE      |L1.10830|
;;;2590   	{                 
;;;2591   	if(unet_max_drv_cnt)
002a32  f9920000          LDRSB    r0,[r2,#0]  ; unet_max_drv_cnt
002a36  b150              CBZ      r0,|L1.10830|
;;;2592   		{
;;;2593   		unet_max_drv_cnt--;
002a38  f1a00001          SUB      r0,r0,#1
002a3c  b240              SXTB     r0,r0
002a3e  7010              STRB     r0,[r2,#0]
;;;2594   		if(unet_max_drv_cnt<=0)
002a40  2800              CMP      r0,#0
002a42  dc04              BGT      |L1.10830|
;;;2595   			{
;;;2596   			avar_unet_hndl(4); //o_11
002a44  2004              MOVS     r0,#4
002a46  f7fffffe          BL       avar_unet_hndl
;;;2597   			avar_bps_reset_cnt=10;
002a4a  f8845031          STRB     r5,[r4,#0x31]
                  |L1.10830|
;;;2598   			}
;;;2599   		}
;;;2600   	else if(unet_max_drv_cnt<0)unet_max_drv_cnt=0;
;;;2601   	
;;;2602   	}
;;;2603   #endif /*UKU_6U*/
;;;2604   if(avar_bps_reset_cnt)	avar_bps_reset_cnt--;
002a4e  f8940031          LDRB     r0,[r4,#0x31]  ; avar_bps_reset_cnt
002a52  2800              CMP      r0,#0
002a54  d003              BEQ      |L1.10846|
002a56  f1a00001          SUB      r0,r0,#1
002a5a  f8840031          STRB     r0,[r4,#0x31]
                  |L1.10846|
;;;2605   }
002a5e  e8bd81f0          POP      {r4-r8,pc}
;;;2606   
                          ENDP

                  matemat PROC
;;;2608   //-----------------------------------------------
;;;2609   void matemat(void)
002a62  e92d5fff          PUSH     {r0-r12,lr}
;;;2610   {
;;;2611   //signed short temp_SS;
;;;2612   signed long temp_SL/*,temp_SL_*/;
;;;2613   char /*temp,*/i;
;;;2614   //signed short temp_SS;
;;;2615   
;;;2616   #ifdef UKU_MGTS
;;;2617   //напряжение сети
;;;2618   temp_SL=(signed long)net_buff_;
;;;2619   temp_SL*=Kunet;
;;;2620   temp_SL/=110000L;
;;;2621   net_U=(signed short)temp_SL;
;;;2622   #endif
;;;2623   
;;;2624   #ifdef UKU_RSTKM
;;;2625   //напряжение сети
;;;2626   temp_SL=(signed long)net_buff_;
;;;2627   temp_SL*=Kunet;
;;;2628   temp_SL/=110000L;
;;;2629   net_U=(signed short)temp_SL;
;;;2630   #endif
;;;2631   
;;;2632   #ifdef UKU_3U
;;;2633   //напряжение сети
;;;2634   temp_SL=(signed long)net_buff_;
;;;2635   temp_SL*=Kunet;
;;;2636   temp_SL/=36000L;
;;;2637   net_U=(signed short)temp_SL;
;;;2638   #endif
;;;2639   
;;;2640   #ifdef UKU_6U
;;;2641   //напряжение сети
;;;2642   
;;;2643   if((AUSW_MAIN%10)||(AUSW_MAIN==2400)||(AUSW_MAIN==4800)||(AUSW_MAIN==6000))
;;;2644   	{
;;;2645   
;;;2646   	if(bps[11]._device==dNET_METR)
;;;2647   		{
;;;2648   		net_metr_buff_[0]=((signed short)bps[11]._buff[0])+(((signed short)bps[11]._buff[1])<<8);
;;;2649   		net_metr_buff_[1]=((signed short)bps[11]._buff[2])+(((signed short)bps[11]._buff[3])<<8);
;;;2650   		net_metr_buff_[2]=((signed short)bps[11]._buff[4])+(((signed short)bps[11]._buff[5])<<8);
;;;2651   
;;;2652   		temp_SL=(signed long)net_metr_buff_[0];
;;;2653   		temp_SL*=KunetA;
;;;2654   		temp_SL/=6000L;
;;;2655   		net_Ua=(signed short)temp_SL;
;;;2656   	
;;;2657   		temp_SL=(signed long)net_metr_buff_[1];
;;;2658   		temp_SL*=KunetB;
;;;2659   		temp_SL/=6000L;
;;;2660   		net_Ub=(signed short)temp_SL;
;;;2661   	
;;;2662   		temp_SL=(signed long)net_metr_buff_[2];
;;;2663   		temp_SL*=KunetC;
;;;2664   		temp_SL/=6000L;
;;;2665   		net_Uc=(signed short)temp_SL;
;;;2666   		}
;;;2667   	else
;;;2668   		{
;;;2669   		temp_SL=(signed long)net_buff_;
;;;2670   		temp_SL*=KunetA;
;;;2671   		temp_SL/=110000L;
;;;2672   		net_Ua=(signed short)temp_SL;
;;;2673   	
;;;2674   		temp_SL=(signed long)adc_buff_[3];
;;;2675   		temp_SL*=KunetB;
;;;2676   		temp_SL/=6000L;
;;;2677   		net_Ub=(signed short)temp_SL;
;;;2678   	
;;;2679   		temp_SL=(signed long)adc_buff_[10];
;;;2680   		temp_SL*=KunetC;
;;;2681   		temp_SL/=6000L;
;;;2682   		net_Uc=(signed short)temp_SL;
;;;2683   		}
;;;2684   
;;;2685   	net_U=net_Ua;
;;;2686   	if(net_Ub<net_U)net_U=net_Ub;
;;;2687   	if(net_Uc<net_U)net_U=net_Uc;
;;;2688   	//o_10_s
;;;2689   	net_Umax=net_Ua;
;;;2690   	if(net_Ub>net_Umax)net_Umax=net_Ub;
;;;2691   	if(net_Uc>net_Umax)net_Umax=net_Uc;
;;;2692   	//o_10_e
;;;2693   	}
;;;2694   else 
;;;2695   	{
;;;2696   	temp_SL=(signed long)net_buff_;
;;;2697   	temp_SL*=Kunet;
;;;2698   	temp_SL/=110000L;
;;;2699   	net_U=(signed short)temp_SL;
;;;2700   	net_Umax=(signed short)temp_SL;	  //o_10
;;;2701   	}
;;;2702   
;;;2703   
;;;2704   
;;;2705   
;;;2706   #endif
;;;2707   
;;;2708   #ifdef UKU_GLONASS
;;;2709   //напряжение сети
;;;2710   temp_SL=(signed long)net_buff_;
;;;2711   temp_SL*=Kunet;
;;;2712   temp_SL/=110000L;
;;;2713   net_U=(signed short)temp_SL;
;;;2714   #endif
;;;2715   
;;;2716   #ifdef UKU_KONTUR
;;;2717   //напряжение сети
;;;2718   temp_SL=(signed long)net_buff_;
;;;2719   temp_SL*=Kunet;
;;;2720   temp_SL/=110000L;
;;;2721   net_U=(signed short)temp_SL;
;;;2722   #endif
;;;2723   
;;;2724   #ifdef IPS_SGEP_GAZPROM
;;;2725   //напряжение сети
;;;2726   temp_SL=(signed long)net_buff_;
;;;2727   temp_SL*=Kunet;
;;;2728   temp_SL/=110000L;
;;;2729   net_U=(signed short)temp_SL;
;;;2730   #endif
;;;2731   
;;;2732   #ifdef UKU_220_V2
;;;2733   //напряжение сети
;;;2734   
;;;2735   if(AUSW_MAIN==22033)
;;;2736   	{
;;;2737   	temp_SL=(signed long)net_buff_;
;;;2738   	temp_SL*=KunetA;
;;;2739   	temp_SL/=6000L;
;;;2740   	net_Ua=(signed short)temp_SL;
;;;2741   
;;;2742   	temp_SL=(signed long)adc_buff_[3];
;;;2743   	temp_SL*=KunetB;
;;;2744   	temp_SL/=6000L;
;;;2745   	net_Ub=(signed short)temp_SL;
;;;2746   
;;;2747   	temp_SL=(signed long)adc_buff_[10];
;;;2748   	temp_SL*=KunetC;
;;;2749   	temp_SL/=6000L;
;;;2750   	net_Uc=(signed short)temp_SL;
;;;2751   
;;;2752   	net_U=net_Ua;
;;;2753   	if(net_Ub<net_U)net_U=net_Ub;
;;;2754   	if(net_Uc<net_U)net_U=net_Uc;
;;;2755   	}
;;;2756   else
;;;2757   	{
;;;2758   	temp_SL=(signed long)net_buff_;
;;;2759   	temp_SL*=Kunet;
;;;2760   	temp_SL/=5000L;
;;;2761   	net_U=(signed short)temp_SL;
;;;2762   	}
;;;2763   #endif
;;;2764   
;;;2765   
;;;2766   #ifdef UKU_220
;;;2767   //напряжение сети
;;;2768   
;;;2769   if(AUSW_MAIN==22035)
;;;2770   	{
;;;2771   	temp_SL=(signed long)net_buff_;
;;;2772   	temp_SL*=KunetA;
;;;2773   	temp_SL/=6000L;
;;;2774   	net_Ua=(signed short)temp_SL;
;;;2775   
;;;2776   	temp_SL=(signed long)adc_buff_[3];
;;;2777   	temp_SL*=KunetB;
;;;2778   	temp_SL/=6000L;
;;;2779   	net_Ub=(signed short)temp_SL;
;;;2780   
;;;2781   	temp_SL=(signed long)adc_buff_[10];
;;;2782   	temp_SL*=KunetC;
;;;2783   	temp_SL/=6000L;
;;;2784   	net_Uc=(signed short)temp_SL;
;;;2785   
;;;2786   	net_U=net_Ua;
;;;2787   	if(net_Ub<net_U)net_U=net_Ub;
;;;2788   	if(net_Uc<net_U)net_U=net_Uc;
;;;2789   	}
;;;2790   else
;;;2791   	{
;;;2792   	temp_SL=(signed long)net_buff_;
;;;2793   	temp_SL*=Kunet;
;;;2794   	#ifdef _ACDC_
;;;2795   	temp_SL/=500L;
;;;2796   	#else
;;;2797   	temp_SL/=5000L;
;;;2798   	#endif
;;;2799   	net_U=(signed short)temp_SL;
;;;2800   	
;;;2801   	}
;;;2802   #endif
;;;2803   
;;;2804   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;2805   //напряжение сети
;;;2806   
;;;2807   
;;;2808   	if(bps[11]._device==dNET_METR)
002a66  4848              LDR      r0,|L1.11144|
;;;2809   		{
;;;2810   		net_metr_buff_[0]=((signed short)bps[11]._buff[0])+(((signed short)bps[11]._buff[1])<<8);
;;;2811   		net_metr_buff_[1]=((signed short)bps[11]._buff[2])+(((signed short)bps[11]._buff[3])<<8);
;;;2812   		net_metr_buff_[2]=((signed short)bps[11]._buff[4])+(((signed short)bps[11]._buff[5])<<8);
;;;2813   
;;;2814   		temp_SL=(signed long)net_metr_buff_[2];
;;;2815   		temp_SL*=KunetA;
002a68  4a48              LDR      r2,|L1.11148|
;;;2816   		temp_SL/=6000L;
;;;2817   		net_Ua=(signed short)temp_SL;
;;;2818   	
;;;2819   		temp_SL=(signed long)net_metr_buff_[1];
;;;2820   		temp_SL*=KunetB;
;;;2821   		temp_SL/=6000L;
;;;2822   		net_Ub=(signed short)temp_SL;
;;;2823   	
;;;2824   		temp_SL=(signed long)net_metr_buff_[0];
;;;2825   		temp_SL*=KunetC;
002a6a  4b4a              LDR      r3,|L1.11156|
002a6c  f890044c          LDRB     r0,[r0,#0x44c]        ;2808  ; bps
002a70  9003              STR      r0,[sp,#0xc]          ;2815
002a72  4947              LDR      r1,|L1.11152|
;;;2826   		temp_SL/=6000L;
;;;2827   		net_Uc=(signed short)temp_SL;
;;;2828   
;;;2829   		net_F3=((signed short)bps[11]._buff[6])+(((signed short)bps[11]._buff[7])<<8);
;;;2830   
;;;2831   		net_U=net_Ua;
;;;2832   		if(net_Ub<net_U)net_U=net_Ub;
;;;2833   		if(net_Uc<net_U)net_U=net_Uc;
;;;2834   		//o_10_s
;;;2835   		net_Umax=net_Ua;
;;;2836   		if(net_Ub>net_Umax)net_Umax=net_Ub;
;;;2837   		if(net_Uc>net_Umax)net_Umax=net_Uc;
;;;2838   		//o_10_e
;;;2839   		}
;;;2840   	  else if(AUSW_MAIN==22033)
;;;2841   	{
;;;2842   	temp_SL=(signed long)net_buff_;
002a74  4e31              LDR      r6,|L1.11068|
002a76  f9b28000          LDRSH    r8,[r2,#0]            ;2815
002a7a  f9b39000          LDRSH    r9,[r3,#0]            ;2825
002a7e  f9b12000          LDRSH    r2,[r1,#0]            ;2820
002a82  f8dfc114          LDR      r12,|L1.11160|
002a86  4d45              LDR      r5,|L1.11164|
002a88  4c45              LDR      r4,|L1.11168|
002a8a  4b3b              LDR      r3,|L1.11128|
002a8c  3e94              SUBS     r6,r6,#0x94
002a8e  2807              CMP      r0,#7                 ;2808
002a90  d040              BEQ      |L1.11028|
002a92  4631              MOV      r1,r6
;;;2843   	temp_SL*=KunetA;
;;;2844   	temp_SL/=4000L;
;;;2845   	net_Ua=(signed short)temp_SL;
;;;2846   
;;;2847   	temp_SL=(signed long)adc_buff_[3];
002a94  f8dfa110          LDR      r10,|L1.11176|
002a98  8f4f              LDRH     r7,[r1,#0x3a]         ;2842
002a9a  493c              LDR      r1,|L1.11148|
002a9c  4a3c              LDR      r2,|L1.11152|
002a9e  f2417970          MOV      r9,#0x1770            ;2816
002aa2  f9b11000          LDRSH    r1,[r1,#0]            ;2815
002aa6  f9b22000          LDRSH    r2,[r2,#0]            ;2820
002aaa  434f              MULS     r7,r1,r7              ;2843
002aac  f9ba1006          LDRSH    r1,[r10,#6]
002ab0  483c              LDR      r0,|L1.11172|
;;;2848   	temp_SL*=KunetB;
002ab2  4351              MULS     r1,r2,r1
;;;2849   	temp_SL/=6000L;
002ab4  fb91f1f9          SDIV     r1,r1,r9
;;;2850   	net_Ub=(signed short)temp_SL;
002ab8  b20a              SXTH     r2,r1
;;;2851   
;;;2852   	temp_SL=(signed long)adc_buff_[10];
002aba  f9ba1014          LDRSH    r1,[r10,#0x14]
002abe  f8dfa0d4          LDR      r10,|L1.11156|
002ac2  8800              LDRH     r0,[r0,#0]            ;2840  ; AUSW_MAIN
002ac4  f2456811          MOV      r8,#0x5611            ;2840
002ac8  f9baa000          LDRSH    r10,[r10,#0]          ;2825
002acc  4540              CMP      r0,r8                 ;2840
;;;2853   	temp_SL*=KunetC;
002ace  fb01f10a          MUL      r1,r1,r10
;;;2854   	temp_SL/=6000L;
002ad2  fb91f1f9          SDIV     r1,r1,r9
;;;2855   	net_Uc=(signed short)temp_SL;
002ad6  b209              SXTH     r1,r1
002ad8  d12f              BNE      |L1.11066|
002ada  f44f607a          MOV      r0,#0xfa0             ;2844
002ade  fb97f0f0          SDIV     r0,r7,r0              ;2844
002ae2  b200              SXTH     r0,r0                 ;2845
002ae4  f8ac0000          STRH     r0,[r12,#0]           ;2845
002ae8  802a              STRH     r2,[r5,#0]            ;2850
002aea  8021              STRH     r1,[r4,#0]
;;;2856   
;;;2857   	net_U=net_Ua;
002aec  4c1d              LDR      r4,|L1.11108|
002aee  8020              STRH     r0,[r4,#0]
;;;2858   	if(net_Ub<net_U)net_U=net_Ub;
002af0  4282              CMP      r2,r0
002af2  da00              BGE      |L1.10998|
002af4  8022              STRH     r2,[r4,#0]
                  |L1.10998|
;;;2859   	if(net_Uc<net_U)net_U=net_Uc;
002af6  f9b45000          LDRSH    r5,[r4,#0]  ; net_U
002afa  42a9              CMP      r1,r5
002afc  da00              BGE      |L1.11008|
002afe  8021              STRH     r1,[r4,#0]
                  |L1.11008|
;;;2860   	//o_10_s
;;;2861   	net_Umax=net_Ua;
002b00  8018              STRH     r0,[r3,#0]
;;;2862   	if(net_Ub>net_Umax)net_Umax=net_Ub;
002b02  4282              CMP      r2,r0
002b04  dd00              BLE      |L1.11016|
002b06  801a              STRH     r2,[r3,#0]
                  |L1.11016|
;;;2863   	if(net_Uc>net_Umax)net_Umax=net_Uc;
002b08  f9b30000          LDRSH    r0,[r3,#0]  ; net_Umax
002b0c  4281              CMP      r1,r0
002b0e  dd00              BLE      |L1.11026|
002b10  8019              STRH     r1,[r3,#0]
                  |L1.11026|
002b12  e0d1              B        |L1.11448|
                  |L1.11028|
002b14  4925              LDR      r1,|L1.11180|
002b16  7808              LDRB     r0,[r1,#0]            ;2810  ; bps
002b18  784f              LDRB     r7,[r1,#1]            ;2810  ; bps
002b1a  eb002007          ADD      r0,r0,r7,LSL #8       ;2810
002b1e  4f07              LDR      r7,|L1.11068|
002b20  b280              UXTH     r0,r0                 ;2810
002b22  f1070758          ADD      r7,r7,#0x58           ;2810
002b26  8038              STRH     r0,[r7,#0]            ;2810
002b28  f891a002          LDRB     r10,[r1,#2]           ;2811  ; bps
002b2c  f891b003          LDRB     r11,[r1,#3]           ;2811  ; bps
002b30  eb0a2a0b          ADD      r10,r10,r11,LSL #8    ;2811
002b34  fa1ffa8a          UXTH     r10,r10               ;2811
002b38  e03a              B        |L1.11184|
                  |L1.11066|
002b3a  e074              B        |L1.11302|
                  |L1.11068|
                          DCD      ||area_number.26||+0x94
                  |L1.11072|
                          DCD      KB_ALGORITM
                  |L1.11076|
                          DCD      mess_data
                  |L1.11080|
                          DCD      USIGN
                  |L1.11084|
                          DCD      load_U
                  |L1.11088|
                          DCD      load_I
                  |L1.11092|
                          DCD      bat_ips
                  |L1.11096|
                          DCD      bat_u_old_cnt
                  |L1.11100|
                          DCD      bat
                  |L1.11104|
                          DCD      net_av_2min_timer
                  |L1.11108|
                          DCD      net_U
                  |L1.11112|
                          DCD      UMN
                  |L1.11116|
                          DCD      main_1Hz_cnt
                  |L1.11120|
                          DCD      unet_drv_cnt
                  |L1.11124|
                          DCD      net_Ustore
                  |L1.11128|
                          DCD      net_Umax
                  |L1.11132|
                          DCD      UMAXN
                  |L1.11136|
                          DCD      unet_max_drv_cnt
                  |L1.11140|
                          DCD      net_Ustore_max
                  |L1.11144|
                          DCD      bps
                  |L1.11148|
                          DCD      KunetA
                  |L1.11152|
                          DCD      KunetB
                  |L1.11156|
                          DCD      KunetC
                  |L1.11160|
                          DCD      net_Ua
                  |L1.11164|
                          DCD      net_Ub
                  |L1.11168|
                          DCD      net_Uc
                  |L1.11172|
                          DCD      AUSW_MAIN
                  |L1.11176|
                          DCD      ||.bss||+0x40c
                  |L1.11180|
                          DCD      bps+0x452
                  |L1.11184|
002bb0  f8a7a002          STRH     r10,[r7,#2]           ;2811
002bb4  f891b004          LDRB     r11,[r1,#4]           ;2812  ; bps
002bb8  f891e005          LDRB     lr,[r1,#5]            ;2812  ; bps
002bbc  eb0b2b0e          ADD      r11,r11,lr,LSL #8     ;2812
002bc0  fa1ffb8b          UXTH     r11,r11               ;2812
002bc4  f8a7b004          STRH     r11,[r7,#4]           ;2812
002bc8  fb0bfb08          MUL      r11,r11,r8            ;2815
002bcc  f2417870          MOV      r8,#0x1770            ;2816
002bd0  fb9bf7f8          SDIV     r7,r11,r8             ;2816
002bd4  b23f              SXTH     r7,r7                 ;2817
002bd6  f8ac7000          STRH     r7,[r12,#0]           ;2817
002bda  fb0afa02          MUL      r10,r10,r2            ;2820
002bde  fb9af2f8          SDIV     r2,r10,r8             ;2821
002be2  b212              SXTH     r2,r2                 ;2822
002be4  802a              STRH     r2,[r5,#0]            ;2822
002be6  fb00f009          MUL      r0,r0,r9              ;2825
002bea  fb90f0f8          SDIV     r0,r0,r8              ;2826
002bee  b200              SXTH     r0,r0                 ;2827
002bf0  8020              STRH     r0,[r4,#0]            ;2827
002bf2  798c              LDRB     r4,[r1,#6]            ;2829  ; bps
002bf4  79c9              LDRB     r1,[r1,#7]            ;2829  ; bps
002bf6  eb042401          ADD      r4,r4,r1,LSL #8       ;2829
002bfa  49ff              LDR      r1,|L1.12280|
002bfc  800c              STRH     r4,[r1,#0]            ;2829
002bfe  49ff              LDR      r1,|L1.12284|
002c00  800f              STRH     r7,[r1,#0]            ;2831
002c02  42ba              CMP      r2,r7                 ;2832
002c04  da00              BGE      |L1.11272|
002c06  800a              STRH     r2,[r1,#0]            ;2832
                  |L1.11272|
002c08  f9b14000          LDRSH    r4,[r1,#0]            ;2833  ; net_U
002c0c  42a0              CMP      r0,r4                 ;2833
002c0e  da00              BGE      |L1.11282|
002c10  8008              STRH     r0,[r1,#0]            ;2833
                  |L1.11282|
002c12  801f              STRH     r7,[r3,#0]            ;2835
002c14  42ba              CMP      r2,r7                 ;2836
002c16  dd00              BLE      |L1.11290|
002c18  801a              STRH     r2,[r3,#0]            ;2836
                  |L1.11290|
002c1a  f9b31000          LDRSH    r1,[r3,#0]            ;2837  ; net_Umax
002c1e  4288              CMP      r0,r1                 ;2837
002c20  dd4a              BLE      |L1.11448|
002c22  8018              STRH     r0,[r3,#0]            ;2837
002c24  e048              B        |L1.11448|
                  |L1.11302|
;;;2864   	//o_10_e
;;;2865   	}
;;;2866   else if((AUSW_MAIN==22063)||(AUSW_MAIN==22023)||(AUSW_MAIN==22043)||(AUSW_MAIN==22044)||(AUSW_MAIN==22018))
002c26  f5a048ac          SUB      r8,r0,#0x5600
002c2a  f1b8082f          SUBS     r8,r8,#0x2f
002c2e  d00b              BEQ      |L1.11336|
002c30  f1180828          ADDS     r8,r8,#0x28
002c34  d008              BEQ      |L1.11336|
002c36  f1b80814          SUBS     r8,r8,#0x14
002c3a  d005              BEQ      |L1.11336|
002c3c  f1b80801          SUBS     r8,r8,#1
002c40  d002              BEQ      |L1.11336|
002c42  f118081a          ADDS     r8,r8,#0x1a
002c46  d11c              BNE      |L1.11394|
                  |L1.11336|
;;;2867   	{
;;;2868   	temp_SL=(signed long)net_buff_;
;;;2869   	temp_SL*=KunetA;
;;;2870   	temp_SL/=40000L;
002c48  f6494040          MOV      r0,#0x9c40
002c4c  fb97f0f0          SDIV     r0,r7,r0
;;;2871   	net_Ua=(signed short)temp_SL;
002c50  b200              SXTH     r0,r0
002c52  f8ac0000          STRH     r0,[r12,#0]
;;;2872   
;;;2873   	temp_SL=(signed long)adc_buff_[3];
;;;2874   	temp_SL*=KunetB;
;;;2875   	temp_SL/=6000L;
;;;2876   	net_Ub=(signed short)temp_SL;
002c56  802a              STRH     r2,[r5,#0]
;;;2877   
;;;2878   	temp_SL=(signed long)adc_buff_[10];
;;;2879   	temp_SL*=KunetC;
;;;2880   	temp_SL/=6000L;
;;;2881   	net_Uc=(signed short)temp_SL;
002c58  8021              STRH     r1,[r4,#0]
;;;2882   
;;;2883   	net_U=net_Ua;
002c5a  4ce8              LDR      r4,|L1.12284|
002c5c  8020              STRH     r0,[r4,#0]
;;;2884   	if(net_Ub<net_U)net_U=net_Ub;
002c5e  4282              CMP      r2,r0
002c60  da00              BGE      |L1.11364|
002c62  8022              STRH     r2,[r4,#0]
                  |L1.11364|
;;;2885   	if(net_Uc<net_U)net_U=net_Uc;
002c64  f9b45000          LDRSH    r5,[r4,#0]  ; net_U
002c68  42a9              CMP      r1,r5
002c6a  da00              BGE      |L1.11374|
002c6c  8021              STRH     r1,[r4,#0]
                  |L1.11374|
;;;2886   	//o_10_s
;;;2887   	net_Umax=net_Ua;
002c6e  8018              STRH     r0,[r3,#0]
;;;2888   	if(net_Ub>net_Umax)net_Umax=net_Ub;
002c70  4282              CMP      r2,r0
002c72  dd00              BLE      |L1.11382|
002c74  801a              STRH     r2,[r3,#0]
                  |L1.11382|
;;;2889   	if(net_Uc>net_Umax)net_Umax=net_Uc;
002c76  f9b30000          LDRSH    r0,[r3,#0]  ; net_Umax
002c7a  4281              CMP      r1,r0
002c7c  dd1c              BLE      |L1.11448|
002c7e  8019              STRH     r1,[r3,#0]
002c80  e01a              B        |L1.11448|
                  |L1.11394|
;;;2890   	//o_10_e
;;;2891   	}
;;;2892   else	if((AUSW_MAIN==22010)||(AUSW_MAIN==22011) )
;;;2893   	{
;;;2894   	temp_SL=(signed long)net_buff_;
;;;2895   	temp_SL*=Kunet;
002c82  49df              LDR      r1,|L1.12288|
002c84  f5a044aa          SUB      r4,r0,#0x5500         ;2892
002c88  f9b12000          LDRSH    r2,[r1,#0]
002c8c  49dd              LDR      r1,|L1.12292|
002c8e  8f49              LDRH     r1,[r1,#0x3a]         ;2842
002c90  4351              MULS     r1,r2,r1
002c92  3cfa              SUBS     r4,r4,#0xfa           ;2892
002c94  d001              BEQ      |L1.11418|
002c96  1e62              SUBS     r2,r4,#1              ;2892
002c98  d107              BNE      |L1.11434|
                  |L1.11418|
;;;2896   	temp_SL/=35000L;
002c9a  f64800b8          MOV      r0,#0x88b8
002c9e  fb91f0f0          SDIV     r0,r1,r0
;;;2897   	net_U=(signed short)temp_SL;
002ca2  49d6              LDR      r1,|L1.12284|
002ca4  8008              STRH     r0,[r1,#0]
;;;2898   	net_Umax=net_U; //o_10
002ca6  8018              STRH     r0,[r3,#0]
002ca8  e006              B        |L1.11448|
                  |L1.11434|
;;;2899   	}
;;;2900   else
;;;2901   	{
;;;2902   	temp_SL=(signed long)net_buff_;
;;;2903   	temp_SL*=Kunet;
;;;2904   	#ifdef _ACDC_
;;;2905   	temp_SL/=500L;
002caa  f44f70fa          MOV      r0,#0x1f4
002cae  fb91f0f0          SDIV     r0,r1,r0
;;;2906   	#else
;;;2907   	temp_SL/=5000L;
;;;2908   	#endif
;;;2909   	net_U=(signed short)temp_SL;
002cb2  49d2              LDR      r1,|L1.12284|
002cb4  8008              STRH     r0,[r1,#0]
;;;2910   	net_Umax=net_U; //o_10
002cb6  8018              STRH     r0,[r3,#0]
                  |L1.11448|
;;;2911   	
;;;2912   	}
;;;2913   if(bps[11]._device!=dNET_METR) net_F3=net_F;
002cb8  9803              LDR      r0,[sp,#0xc]
002cba  2807              CMP      r0,#7
002cbc  d003              BEQ      |L1.11462|
002cbe  48d2              LDR      r0,|L1.12296|
002cc0  8801              LDRH     r1,[r0,#0]  ; net_F
002cc2  48cd              LDR      r0,|L1.12280|
002cc4  8001              STRH     r1,[r0,#0]
                  |L1.11462|
;;;2914   #endif
;;;2915   
;;;2916   #ifdef UKU_TELECORE2015
;;;2917   //напряжение сети
;;;2918   temp_SL=(signed long)net_buff_;
;;;2919   temp_SL*=Kunet;
;;;2920   temp_SL/=110000L;
;;;2921   net_U=(signed short)temp_SL;
;;;2922   #endif
;;;2923   
;;;2924   #ifdef UKU_TELECORE2017
;;;2925   //напряжение сети
;;;2926   temp_SL=(signed long)net_buff_;
;;;2927   temp_SL*=Kunet;
;;;2928   temp_SL/=110000L;
;;;2929   net_U=(signed short)temp_SL;
;;;2930   #endif
;;;2931   
;;;2932   
;;;2933   #ifdef UKU_FSO
;;;2934   //напряжение сети
;;;2935   if(NUMPHASE==1)
;;;2936   	{
;;;2937   	temp_SL=(signed long)net_buff_;
;;;2938   	temp_SL*=Kunet;
;;;2939   	temp_SL/=110000L;
;;;2940   	net_U=(signed short)temp_SL;
;;;2941   	net_Umax=net_U;
;;;2942   	}
;;;2943   else
;;;2944   	{
;;;2945   	temp_SL=(signed long)net_buff_;
;;;2946   	temp_SL*=KunetA;
;;;2947   	temp_SL/=40000L;
;;;2948   	net_Ua=(signed short)temp_SL;
;;;2949   
;;;2950   	temp_SL=(signed long)adc_buff_[3];
;;;2951   	temp_SL*=KunetB;
;;;2952   	temp_SL/=6000L;
;;;2953   	net_Ub=(signed short)temp_SL;
;;;2954   
;;;2955   	temp_SL=(signed long)adc_buff_[10];
;;;2956   	temp_SL*=KunetC;
;;;2957   	temp_SL/=6000L;
;;;2958   	net_Uc=(signed short)temp_SL;
;;;2959   
;;;2960   	net_U=net_Ua;
;;;2961   	if(net_Ub<net_U)net_U=net_Ub;
;;;2962   	if(net_Uc<net_U)net_U=net_Uc;
;;;2963   	//o_10_s
;;;2964   	net_Umax=net_Ua;
;;;2965   	if(net_Ub>net_Umax)net_Umax=net_Ub;
;;;2966   	if(net_Uc>net_Umax)net_Umax=net_Uc;
;;;2967   	}
;;;2968   #endif	//UKU_FSO
;;;2969   
;;;2970   //Напряжения батарей
;;;2971   temp_SL=(signed long)adc_buff_[0];
002cc6  4cd1              LDR      r4,|L1.12300|
002cc8  f9b41000          LDRSH    r1,[r4,#0]  ; adc_buff_
;;;2972   temp_SL*=Kubat[0];
002ccc  4ad0              LDR      r2,|L1.12304|
002cce  f9b20000          LDRSH    r0,[r2,#0]  ; Kubat
002cd2  4348              MULS     r0,r1,r0
;;;2973   temp_SL/=2000L;
002cd4  f44f68fa          MOV      r8,#0x7d0
002cd8  fb90f0f8          SDIV     r0,r0,r8
;;;2974   bat[0]._Ub=(signed short)temp_SL;
002cdc  4dcd              LDR      r5,|L1.12308|
002cde  8068              STRH     r0,[r5,#2]
;;;2975   
;;;2976   #ifdef UKU_220
;;;2977   //Напряжения батарей
;;;2978   temp_SL=(signed long)adc_buff_[0];
;;;2979   temp_SL*=Kubat[0];
;;;2980   temp_SL/=400L;
;;;2981   bat[0]._Ub=(signed short)temp_SL;
;;;2982   #endif
;;;2983   
;;;2984   #ifdef UKU_220_V2
;;;2985   //Напряжения батарей
;;;2986   temp_SL=(signed long)adc_buff_[0];
;;;2987   temp_SL*=Kubat[0];
;;;2988   temp_SL/=400L;
;;;2989   bat[0]._Ub=(signed short)temp_SL;
;;;2990   #endif
;;;2991   
;;;2992   //adc_buff_[4]=300;
;;;2993   
;;;2994   temp_SL=(signed long)adc_buff_[4];
002ce0  f9b40008          LDRSH    r0,[r4,#8]  ; adc_buff_
;;;2995   temp_SL*=Kubatm[0];
002ce4  4bcc              LDR      r3,|L1.12312|
002ce6  f9b31000          LDRSH    r1,[r3,#0]  ; Kubatm
002cea  fb01f100          MUL      r1,r1,r0
;;;2996   temp_SL/=700L;
002cee  f44f772f          MOV      r7,#0x2bc
002cf2  fb91f0f7          SDIV     r0,r1,r7
;;;2997   bat[0]._Ubm=(signed short)temp_SL;
002cf6  80a8              STRH     r0,[r5,#4]
;;;2998   
;;;2999   #ifdef UKU_KONTUR
;;;3000   temp_SL=(signed long)adc_buff_[4];
;;;3001   temp_SL*=Kubatm[0];
;;;3002   temp_SL/=2000L;
;;;3003   bat[0]._Ubm=(signed short)temp_SL;
;;;3004   #endif
;;;3005   
;;;3006   #ifdef UKU_6U
;;;3007   temp_SL=(signed long)adc_buff_[4];
;;;3008   temp_SL*=Kubatm[0];
;;;3009   temp_SL/=2000L;
;;;3010   bat[0]._Ubm=(signed short)temp_SL;
;;;3011   #endif
;;;3012   
;;;3013   temp_SL=(signed long)adc_buff_[12];
002cf8  f9b40018          LDRSH    r0,[r4,#0x18]  ; adc_buff_
;;;3014   temp_SL*=Kubat[1];
002cfc  f9b21002          LDRSH    r1,[r2,#2]  ; Kubat
002d00  fb01f100          MUL      r1,r1,r0
;;;3015   temp_SL/=2000L;
002d04  fb91f0f8          SDIV     r0,r1,r8
;;;3016   bat[1]._Ub=(signed short)temp_SL;
002d08  f8a5004e          STRH     r0,[r5,#0x4e]
;;;3017   
;;;3018   #ifdef UKU_220
;;;3019   temp_SL=(signed long)adc_buff_[12];
;;;3020   temp_SL*=Kubat[1];
;;;3021   temp_SL/=400L;
;;;3022   bat[1]._Ub=(signed short)temp_SL;
;;;3023   #endif
;;;3024   
;;;3025   #ifdef UKU_220_V2
;;;3026   temp_SL=(signed long)adc_buff_[12];
;;;3027   temp_SL*=Kubat[1];
;;;3028   temp_SL/=400L;
;;;3029   bat[1]._Ub=(signed short)temp_SL;
;;;3030   #endif
;;;3031   
;;;3032   //adc_buff_[1]=300;
;;;3033   
;;;3034   temp_SL=(signed long)adc_buff_[1];
002d0c  f9b41002          LDRSH    r1,[r4,#2]  ; adc_buff_
;;;3035   temp_SL*=Kubatm[1];
002d10  f9b30002          LDRSH    r0,[r3,#2]  ; Kubatm
002d14  fb00f001          MUL      r0,r0,r1
;;;3036   temp_SL/=700L;
002d18  fb90f0f7          SDIV     r0,r0,r7
;;;3037   bat[1]._Ubm=(signed short)temp_SL;
002d1c  f8a50050          STRH     r0,[r5,#0x50]
;;;3038   #ifdef UKU_KONTUR
;;;3039   temp_SL=(signed long)adc_buff_[1];
;;;3040   temp_SL*=Kubatm[1];
;;;3041   temp_SL/=2000L;
;;;3042   bat[1]._Ubm=(signed short)temp_SL;
;;;3043   #endif
;;;3044   #ifdef UKU_6U
;;;3045   temp_SL=(signed long)adc_buff_[1];
;;;3046   temp_SL*=Kubatm[1];
;;;3047   temp_SL/=2000L;
;;;3048   bat[1]._Ubm=(signed short)temp_SL;
;;;3049   #endif
;;;3050   
;;;3051   #ifdef UKU_TELECORE2015
;;;3052   temp_SL=(signed long)adc_buff_[2];
;;;3053   temp_SL*=Kubat[0];
;;;3054   temp_SL/=2000L;
;;;3055   bat[0]._Ub=(signed short)temp_SL;
;;;3056   #endif
;;;3057   
;;;3058   /*
;;;3059   //Токи батарей
;;;3060   if(!mess_find_unvol(MESS2MATEMAT))
;;;3061   	{
;;;3062   	temp_SL=(signed long)ad7705_buff_[0];
;;;3063   	temp_SL-=(signed long)Kibat0[0];
;;;3064   	temp_SL*=(signed long)Kibat1[0];
;;;3065   	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
;;;3066   	else temp_SL/=1000L;
;;;3067   	bat[0]._Ib=(signed short)temp_SL;
;;;3068   
;;;3069   	temp_SL=(signed long)ad7705_buff_[1];
;;;3070   	temp_SL-=(signed long)Kibat0[1];
;;;3071   	temp_SL*=(signed long)Kibat1[1];
;;;3072   	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
;;;3073   	else temp_SL/=1000L;
;;;3074   	bat[1]._Ib=(signed short)temp_SL;
;;;3075   	}
;;;3076   */
;;;3077   
;;;3078   
;;;3079   //Токи батарей
;;;3080   if(!mess_find_unvol(MESS2MATEMAT))
002d20  f04f00dc          MOV      r0,#0xdc
002d24  f7fffffe          BL       mess_find_unvol
;;;3081   	{
;;;3082   	temp_SL=(signed long)ad7705_buff_[0];
;;;3083   	temp_SL-=(signed long)Kibat0[0];
;;;3084   	temp_SL*=(signed long)Kibat1[0];
;;;3085   	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
;;;3086   	else if((AUSW_MAIN==22010)||(AUSW_MAIN==22035)||(AUSW_MAIN==22033))temp_SL/=2000L;
002d28  f2456913          MOV      r9,#0x5613
002d2c  bbf0              CBNZ     r0,|L1.11692|
002d2e  f8dfa2ec          LDR      r10,|L1.12316|
002d32  f8ba0000          LDRH     r0,[r10,#0]           ;3082  ; ad7705_buff_
002d36  f8dfb2e8          LDR      r11,|L1.12320|
002d3a  f8bb1000          LDRH     r1,[r11,#0]           ;3083  ; Kibat0
002d3e  eba00001          SUB      r0,r0,r1              ;3083
002d42  4ab8              LDR      r2,|L1.12324|
002d44  f9b21000          LDRSH    r1,[r2,#0]            ;3084  ; Kibat1
002d48  fb01f100          MUL      r1,r1,r0              ;3084
002d4c  48b6              LDR      r0,|L1.12328|
002d4e  f6456338          MOV      r3,#0x5e38            ;3085
002d52  f6456792          MOV      r7,#0x5e92            ;3085
002d56  8800              LDRH     r0,[r0,#0]            ;3085  ; AUSW_MAIN
002d58  f44f7c96          MOV      r12,#0x12c            ;3085
002d5c  4298              CMP      r0,r3                 ;3085
002d5e  d001              BEQ      |L1.11620|
002d60  42b8              CMP      r0,r7                 ;3085
002d62  d102              BNE      |L1.11626|
                  |L1.11620|
002d64  fb91f1fc          SDIV     r1,r1,r12             ;3085
002d68  e010              B        |L1.11660|
                  |L1.11626|
002d6a  f5a04ea8          SUB      lr,r0,#0x5400
002d6e  f5be7efd          SUBS     lr,lr,#0x1fa
002d72  d004              BEQ      |L1.11646|
002d74  4548              CMP      r0,r9
002d76  d002              BEQ      |L1.11646|
002d78  f1be0e17          SUBS     lr,lr,#0x17
002d7c  d102              BNE      |L1.11652|
                  |L1.11646|
002d7e  fb91f1f8          SDIV     r1,r1,r8
002d82  e003              B        |L1.11660|
                  |L1.11652|
;;;3087   	else temp_SL/=1000L;
002d84  f44f7e7a          MOV      lr,#0x3e8
002d88  fb91f1fe          SDIV     r1,r1,lr
                  |L1.11660|
;;;3088   	#ifdef UKU_TELECORE2015
;;;3089   	temp_SL/=2L;
;;;3090   	//temp_SL=-temp_SL;
;;;3091   	#endif
;;;3092   	//#ifdef UKU_TELECORE2017
;;;3093   	//temp_SL/=-2L;
;;;3094   	//temp_SL=-temp_SL;
;;;3095   	//#endif
;;;3096   	bat[0]._Ib=(signed short)temp_SL;
002d8c  8129              STRH     r1,[r5,#8]
;;;3097   
;;;3098   	temp_SL=(signed long)ad7705_buff_[1];
002d8e  f8ba1002          LDRH     r1,[r10,#2]  ; ad7705_buff_
;;;3099   	temp_SL-=(signed long)Kibat0[1];
002d92  f8bba002          LDRH     r10,[r11,#2]  ; Kibat0
002d96  eba10a0a          SUB      r10,r1,r10
;;;3100   	temp_SL*=(signed long)Kibat1[1];
002d9a  f9b21002          LDRSH    r1,[r2,#2]  ; Kibat1
002d9e  fb01f10a          MUL      r1,r1,r10
;;;3101   	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
002da2  4298              CMP      r0,r3
002da4  d001              BEQ      |L1.11690|
002da6  42b8              CMP      r0,r7
002da8  d104              BNE      |L1.11700|
                  |L1.11690|
002daa  e000              B        |L1.11694|
                  |L1.11692|
002dac  e013              B        |L1.11734|
                  |L1.11694|
002dae  fb91f0fc          SDIV     r0,r1,r12
002db2  e00e              B        |L1.11730|
                  |L1.11700|
;;;3102   	else if((AUSW_MAIN==22010)||(AUSW_MAIN==22035)||(AUSW_MAIN==22033))temp_SL/=2000L;
002db4  f5a042aa          SUB      r2,r0,#0x5500
002db8  3afa              SUBS     r2,r2,#0xfa
002dba  d003              BEQ      |L1.11716|
002dbc  4548              CMP      r0,r9
002dbe  d001              BEQ      |L1.11716|
002dc0  3a17              SUBS     r2,r2,#0x17
002dc2  d102              BNE      |L1.11722|
                  |L1.11716|
002dc4  fb91f0f8          SDIV     r0,r1,r8
002dc8  e003              B        |L1.11730|
                  |L1.11722|
;;;3103   	else temp_SL/=1000L;
002dca  f44f707a          MOV      r0,#0x3e8
002dce  fb91f0f0          SDIV     r0,r1,r0
                  |L1.11730|
;;;3104   	bat[1]._Ib=(signed short)temp_SL;
002dd2  f8a50054          STRH     r0,[r5,#0x54]
                  |L1.11734|
;;;3105   	}
;;;3106   
;;;3107   
;;;3108   
;;;3109   
;;;3110   
;;;3111   //Температуры батарей
;;;3112   
;;;3113   #ifdef UKU_KONTUR
;;;3114   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))bat[0]._nd=0;
;;;3115   else bat[0]._nd=1;
;;;3116   temp_SL=(signed long)adc_buff_[6];
;;;3117   temp_SL*=Ktbat[0];
;;;3118   temp_SL/=20000L;
;;;3119   temp_SL-=273L;
;;;3120   bat[0]._Tb=(signed short)temp_SL;
;;;3121   #else
;;;3122   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))bat[0]._nd=0;
002dd6  f9b4000c          LDRSH    r0,[r4,#0xc]  ; adc_buff_
002dda  f64031b7          MOV      r1,#0xbb7
002dde  4684              MOV      r12,r0
002de0  f2a03021          SUB      r0,r0,#0x321
;;;3123   else bat[0]._nd=1;
002de4  2701              MOVS     r7,#1
002de6  2300              MOVS     r3,#0                 ;3122
002de8  9002              STR      r0,[sp,#8]            ;3122
002dea  4288              CMP      r0,r1                 ;3122
002dec  d201              BCS      |L1.11762|
002dee  732b              STRB     r3,[r5,#0xc]          ;3122
002df0  e000              B        |L1.11764|
                  |L1.11762|
002df2  732f              STRB     r7,[r5,#0xc]
                  |L1.11764|
;;;3124   temp_SL=(signed long)adc_buff_[6];
;;;3125   temp_SL*=Ktbat[0];
002df4  4a8d              LDR      r2,|L1.12332|
002df6  f9b20000          LDRSH    r0,[r2,#0]  ; Ktbat
002dfa  fb00f00c          MUL      r0,r0,r12
;;;3126   temp_SL/=20000L;
002dfe  f6446a20          MOV      r10,#0x4e20
002e02  fb90f0fa          SDIV     r0,r0,r10
;;;3127   temp_SL-=273L;
002e06  f2a01011          SUB      r0,r0,#0x111
;;;3128   bat[0]._Tb=(signed short)temp_SL;
002e0a  8168              STRH     r0,[r5,#0xa]
;;;3129   #endif
;;;3130   
;;;3131   #ifdef UKU_KONTUR
;;;3132   if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))bat[1]._nd=0;
;;;3133   else bat[1]._nd=1;
;;;3134   temp_SL=(signed long)adc_buff_[7];
;;;3135   temp_SL*=Ktbat[1];
;;;3136   temp_SL/=20000L;
;;;3137   temp_SL-=273L;
;;;3138   bat[1]._Tb=(signed short)temp_SL;
;;;3139   #else
;;;3140   if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))bat[1]._nd=0;
002e0c  f9b4000e          LDRSH    r0,[r4,#0xe]  ; adc_buff_
002e10  f64031b7          MOV      r1,#0xbb7
002e14  f2a03b21          SUB      r11,r0,#0x321
002e18  458b              CMP      r11,r1
002e1a  d202              BCS      |L1.11810|
002e1c  f8853058          STRB     r3,[r5,#0x58]
002e20  e001              B        |L1.11814|
                  |L1.11810|
;;;3141   else bat[1]._nd=1;
002e22  f8857058          STRB     r7,[r5,#0x58]
                  |L1.11814|
;;;3142   temp_SL=(signed long)adc_buff_[7];
;;;3143   temp_SL*=Ktbat[1];
002e26  f9b21002          LDRSH    r1,[r2,#2]  ; Ktbat
002e2a  4341              MULS     r1,r0,r1
;;;3144   temp_SL/=20000L;
002e2c  f6446020          MOV      r0,#0x4e20
002e30  fb91f0f0          SDIV     r0,r1,r0
;;;3145   temp_SL-=273L;
002e34  f2a01011          SUB      r0,r0,#0x111
;;;3146   bat[1]._Tb=(signed short)temp_SL;
002e38  4976              LDR      r1,|L1.12308|
002e3a  f8a10056          STRH     r0,[r1,#0x56]
;;;3147   #endif
;;;3148   
;;;3149   #ifdef UKU_6U
;;;3150   
;;;3151   if(NUMMAKB==2)
;;;3152   	{
;;;3153   	if(makb[0]._cnt<5)
;;;3154   		{
;;;3155   		if(makb[0]._T_nd[0]==0)
;;;3156   			{
;;;3157   			bat[0]._Tb=makb[0]._T[0];
;;;3158   			bat[0]._nd=0;
;;;3159   			}
;;;3160   		}
;;;3161   
;;;3162   	if(makb[1]._cnt<5)
;;;3163   		{
;;;3164   		if(makb[1]._T_nd[0]==0)
;;;3165   			{
;;;3166   			bat[1]._Tb=makb[1]._T[0];
;;;3167   			bat[1]._nd=0;
;;;3168   			}
;;;3169   		}
;;;3170   
;;;3171   	}
;;;3172   else if(NUMMAKB==4)
;;;3173   	{
;;;3174   	signed short temp_t;
;;;3175   	temp_t=-20;
;;;3176   	if(makb[0]._cnt<5)
;;;3177   		{
;;;3178   		if(makb[0]._T_nd[0]==0)
;;;3179   			{
;;;3180   			temp_t=makb[0]._T[0];
;;;3181   			bat[0]._nd=0;
;;;3182   			}
;;;3183   		}
;;;3184   	if(makb[1]._cnt<5)
;;;3185   		{
;;;3186   		if(makb[1]._T_nd[0]==0)
;;;3187   			{
;;;3188   			if(temp_t<makb[1]._T[0])
;;;3189   				{
;;;3190   				bat[0]._nd=0;
;;;3191   				temp_t=makb[1]._T[0];
;;;3192   				}
;;;3193   			}
;;;3194   		}
;;;3195   	if(temp_t!=-20)bat[0]._Tb = temp_t;
;;;3196   
;;;3197    	temp_t=-20;
;;;3198   	if(makb[2]._cnt<5)
;;;3199   		{
;;;3200   		if(makb[2]._T_nd[0]==0)
;;;3201   			{
;;;3202   			temp_t=makb[2]._T[0];
;;;3203   			bat[1]._nd=0;
;;;3204   			}
;;;3205   		}
;;;3206   	if(makb[3]._cnt<5)
;;;3207   		{
;;;3208   		if(makb[3]._T_nd[0]==0)
;;;3209   			{
;;;3210   			if(temp_t<makb[3]._T[0])
;;;3211   				{
;;;3212   				bat[1]._nd=0;
;;;3213   				temp_t=makb[3]._T[0];
;;;3214   				}
;;;3215   			}
;;;3216   		}
;;;3217   	if(temp_t!=-20)bat[1]._Tb = temp_t;
;;;3218   	}
;;;3219   
;;;3220   #endif
;;;3221   
;;;3222   
;;;3223   //Напряжение нагрузки
;;;3224   temp_SL=(signed long)adc_buff_[2];
002e3e  f9b41004          LDRSH    r1,[r4,#4]  ; adc_buff_
;;;3225   temp_SL*=Kuload;
002e42  487b              LDR      r0,|L1.12336|
002e44  f9b00000          LDRSH    r0,[r0,#0]  ; Kuload
002e48  fb01f000          MUL      r0,r1,r0
;;;3226   temp_SL/=2000L;
002e4c  f44f62fa          MOV      r2,#0x7d0
002e50  fb90f0f2          SDIV     r0,r0,r2
;;;3227   load_U=(signed short)temp_SL;
002e54  f8dfb1dc          LDR      r11,|L1.12340|
002e58  f8ab0000          STRH     r0,[r11,#0]
;;;3228   
;;;3229   #ifdef UKU_220 
;;;3230   //Напряжение нагрузки
;;;3231   temp_SL=(signed long)adc_buff_[2];
;;;3232   temp_SL*=Kuload;
;;;3233   temp_SL/=350L;
;;;3234   load_U=(signed short)temp_SL;
;;;3235   #endif
;;;3236   
;;;3237   #ifdef UKU_220_V2 
;;;3238   //Напряжение нагрузки
;;;3239   temp_SL=(signed long)adc_buff_[2];
;;;3240   temp_SL*=Kuload;
;;;3241   temp_SL/=350L;
;;;3242   load_U=(signed short)temp_SL;
;;;3243   #endif
;;;3244   
;;;3245   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;3246   //Напряжение шины
;;;3247   temp_SL=(signed long)adc_buff_[1];
002e5c  f9b42002          LDRSH    r2,[r4,#2]  ; adc_buff_
;;;3248   temp_SL*=Kuout;
002e60  4875              LDR      r0,|L1.12344|
002e62  f9b00000          LDRSH    r0,[r0,#0]  ; Kuout
002e66  fb02f200          MUL      r2,r2,r0
;;;3249   if(AUSW_MAIN==22010)temp_SL/=400L;
002e6a  486f              LDR      r0,|L1.12328|
002e6c  f24555fa          MOV      r5,#0x55fa
002e70  f44f78c8          MOV      r8,#0x190
002e74  8800              LDRH     r0,[r0,#0]  ; AUSW_MAIN
002e76  42a8              CMP      r0,r5
002e78  d102              BNE      |L1.11904|
002e7a  fb92f2f8          SDIV     r2,r2,r8
002e7e  e003              B        |L1.11912|
                  |L1.11904|
;;;3250   else temp_SL/=500L;
002e80  f44f7afa          MOV      r10,#0x1f4
002e84  fb92f2fa          SDIV     r2,r2,r10
                  |L1.11912|
;;;3251   out_U=(signed short)temp_SL;
002e88  fa0ffa82          SXTH     r10,r2
002e8c  4a6b              LDR      r2,|L1.12348|
002e8e  f8a2a000          STRH     r10,[r2,#0]
;;;3252   load_U=out_U;
002e92  f8aba000          STRH     r10,[r11,#0]
;;;3253   
;;;3254   //Напряжение выпрямителей
;;;3255   temp_SL=(signed long)adc_buff_[2];
;;;3256   temp_SL*=Kubps;
002e96  4a6a              LDR      r2,|L1.12352|
002e98  f9b22000          LDRSH    r2,[r2,#0]  ; Kubps
002e9c  fb01f102          MUL      r1,r1,r2
;;;3257   if(AUSW_MAIN==22010)temp_SL/=400L;
002ea0  d102              BNE      |L1.11944|
002ea2  fb91f1f8          SDIV     r1,r1,r8
002ea6  e003              B        |L1.11952|
                  |L1.11944|
;;;3258   else temp_SL/=500L;
002ea8  f44f72fa          MOV      r2,#0x1f4
002eac  fb91f1f2          SDIV     r1,r1,r2
                  |L1.11952|
;;;3259   bps_U=(signed short)temp_SL;
002eb0  4d64              LDR      r5,|L1.12356|
002eb2  b209              SXTH     r1,r1
002eb4  8029              STRH     r1,[r5,#0]
;;;3260   
;;;3261   if(bps_U<100)
;;;3262   	{
;;;3263   	char i;
;;;3264   	for(i=0;i<NUMIST;i++)
002eb6  f8dfe190          LDR      lr,|L1.12360|
002eba  2964              CMP      r1,#0x64              ;3261
002ebc  da17              BGE      |L1.12014|
002ebe  f04f0100          MOV      r1,#0
002ec2  f9be8000          LDRSH    r8,[lr,#0]
002ec6  f8dfb184          LDR      r11,|L1.12364|
002eca  e00e              B        |L1.12010|
                  |L1.11980|
;;;3265   		{
;;;3266   		if(bps[i]._Uin>bps_U)bps_U=bps[i]._Uin;
002ecc  eb0102c1          ADD      r2,r1,r1,LSL #3
002ed0  eb021201          ADD      r2,r2,r1,LSL #4
002ed4  eb0b0282          ADD      r2,r11,r2,LSL #2
002ed8  f9b54000          LDRSH    r4,[r5,#0]  ; bps_U
002edc  6a12              LDR      r2,[r2,#0x20]
002ede  42a2              CMP      r2,r4
002ee0  dd00              BLE      |L1.12004|
002ee2  802a              STRH     r2,[r5,#0]
                  |L1.12004|
002ee4  f1010101          ADD      r1,r1,#1              ;3264
002ee8  b2c9              UXTB     r1,r1                 ;3264
                  |L1.12010|
002eea  4541              CMP      r1,r8                 ;3264
002eec  dbee              BLT      |L1.11980|
                  |L1.12014|
;;;3267   		}
;;;3268   	}
;;;3269   
;;;3270   //Суммарный ток выпрямителей
;;;3271   temp_SL=0;
002eee  f04f0500          MOV      r5,#0
;;;3272   for (i=0;i<NUMIST;i++)
002ef2  4629              MOV      r1,r5
002ef4  f9be2000          LDRSH    r2,[lr,#0]            ;3264
002ef8  4c54              LDR      r4,|L1.12364|
002efa  e00b              B        |L1.12052|
                  |L1.12028|
;;;3273   	{
;;;3274   	temp_SL+=((signed long)bps[i]._Ii);
002efc  eb0108c1          ADD      r8,r1,r1,LSL #3
002f00  eb081801          ADD      r8,r8,r1,LSL #4
002f04  eb040888          ADD      r8,r4,r8,LSL #2
002f08  f8d88024          LDR      r8,[r8,#0x24]
002f0c  4445              ADD      r5,r5,r8
002f0e  f1010101          ADD      r1,r1,#1              ;3272
002f12  b2c9              UXTB     r1,r1                 ;3272
                  |L1.12052|
002f14  4291              CMP      r1,r2                 ;3272
002f16  dbf1              BLT      |L1.12028|
;;;3275   	}
;;;3276   bps_I=(signed short)temp_SL;
002f18  494d              LDR      r1,|L1.12368|
002f1a  800d              STRH     r5,[r1,#0]
;;;3277   
;;;3278   
;;;3279   #endif
;;;3280   
;;;3281   
;;;3282   #ifdef UKU_KONTUR
;;;3283   //Внешний датчик температуры №1(температура внешнего воздуха)
;;;3284   if((adc_buff_[5]>800)&&(adc_buff_[5]<3800))ND_EXT[0]=0;
;;;3285   else ND_EXT[0]=1;
;;;3286   temp_SL=(signed long)adc_buff_[5];
;;;3287   temp_SL*=Ktext[0];
;;;3288   temp_SL/=20000L;
;;;3289   temp_SL-=273L;
;;;3290   t_ext[0]=(signed short)temp_SL;
;;;3291   #else 
;;;3292   //Внешний датчик температуры №1(температура внешнего воздуха)
;;;3293   if((adc_buff_[5]>800)&&(adc_buff_[5]<3800))ND_EXT[0]=0;
002f1c  493b              LDR      r1,|L1.12300|
002f1e  f6403bb7          MOV      r11,#0xbb7
002f22  f9b1500a          LDRSH    r5,[r1,#0xa]  ; adc_buff_
002f26  494b              LDR      r1,|L1.12372|
002f28  f2a53821          SUB      r8,r5,#0x321
002f2c  f8cd8004          STR      r8,[sp,#4]
002f30  45d8              CMP      r8,r11
002f32  d201              BCS      |L1.12088|
002f34  700b              STRB     r3,[r1,#0]
002f36  e000              B        |L1.12090|
                  |L1.12088|
;;;3294   else ND_EXT[0]=1;
002f38  700f              STRB     r7,[r1,#0]
                  |L1.12090|
;;;3295   temp_SL=(signed long)adc_buff_[5];
;;;3296   temp_SL*=Ktext[0];
002f3a  f8df811c          LDR      r8,|L1.12376|
002f3e  f9b88000          LDRSH    r8,[r8,#0]  ; Ktext
002f42  fb08fb05          MUL      r11,r8,r5
;;;3297   temp_SL/=20000L;
002f46  f6446e20          MOV      lr,#0x4e20
002f4a  fb9bfbfe          SDIV     r11,r11,lr
;;;3298   temp_SL-=273L;
002f4e  f2ab1b11          SUB      r11,r11,#0x111
;;;3299   t_ext[0]=(signed short)temp_SL;
002f52  f8dfe108          LDR      lr,|L1.12380|
002f56  f8aeb000          STRH     r11,[lr,#0]
;;;3300   /*
;;;3301   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[1]=0;
;;;3302   else ND_EXT[1]=1;
;;;3303   temp_SL=(signed long)adc_buff_[6];
;;;3304   temp_SL*=Ktext[1];
;;;3305   temp_SL/=20000L;
;;;3306   temp_SL-=273L;
;;;3307   t_ext[1]=(signed short)temp_SL;	*/
;;;3308   #endif
;;;3309   
;;;3310   #ifdef UKU_220
;;;3311   
;;;3312   //Внешний датчик температуры №2(температура отсека ЭПУ)
;;;3313   if((adc_buff_[3]>800)&&(adc_buff_[3]<3800))ND_EXT[1]=0;
;;;3314   else ND_EXT[1]=1;
;;;3315   temp_SL=(signed long)adc_buff_[3];
;;;3316   temp_SL*=Ktext[1];
;;;3317   temp_SL/=20000L;
;;;3318   temp_SL-=273L;
;;;3319   t_ext[1]=(signed short)temp_SL;
;;;3320   
;;;3321   //Внешний датчик температуры №3(температура отсека MSAN)
;;;3322   if((adc_buff_[10]>800)&&(adc_buff_[10]<3800))ND_EXT[2]=0;
;;;3323   else ND_EXT[2]=1;
;;;3324   temp_SL=(signed long)adc_buff_[10];
;;;3325   temp_SL*=Ktext[2];
;;;3326   temp_SL/=20000L;
;;;3327   temp_SL-=273L;
;;;3328   t_ext[2]=(signed short)temp_SL;
;;;3329   
;;;3330   #else
;;;3331   
;;;3332   
;;;3333   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;3334   
;;;3335   //Внешний датчик температуры 
;;;3336   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[0]=0;
002f5a  f8dde008          LDR      lr,[sp,#8]
002f5e  f6403bb7          MOV      r11,#0xbb7
002f62  45de              CMP      lr,r11
002f64  d201              BCS      |L1.12138|
002f66  700b              STRB     r3,[r1,#0]
002f68  e000              B        |L1.12140|
                  |L1.12138|
;;;3337   else ND_EXT[0]=1;
002f6a  700f              STRB     r7,[r1,#0]
                  |L1.12140|
;;;3338   temp_SL=(signed long)adc_buff_[6];
;;;3339   temp_SL*=Ktext[0];
002f6c  fb08f80c          MUL      r8,r8,r12
;;;3340   temp_SL/=20000L;
002f70  f6446e20          MOV      lr,#0x4e20
002f74  fb98f8fe          SDIV     r8,r8,lr
;;;3341   temp_SL-=273L;
002f78  f2a81811          SUB      r8,r8,#0x111
;;;3342   t_ext[0]=(signed short)temp_SL;
002f7c  f8dfc0dc          LDR      r12,|L1.12380|
002f80  f8ac8000          STRH     r8,[r12,#0]
;;;3343   
;;;3344   //Внешний датчик температуры №2
;;;3345   if((adc_buff_[5]>800)&&(adc_buff_[5]<3800))ND_EXT[1]=0;
002f84  f8dd8004          LDR      r8,[sp,#4]
002f88  45d8              CMP      r8,r11
002f8a  d201              BCS      |L1.12176|
002f8c  704b              STRB     r3,[r1,#1]
002f8e  e000              B        |L1.12178|
                  |L1.12176|
;;;3346   else ND_EXT[1]=1;
002f90  704f              STRB     r7,[r1,#1]
                  |L1.12178|
;;;3347   temp_SL=(signed long)adc_buff_[5];
;;;3348   temp_SL*=Ktext[1];
002f92  4f31              LDR      r7,|L1.12376|
002f94  f9b77002          LDRSH    r7,[r7,#2]  ; Ktext
002f98  436f              MULS     r7,r5,r7
;;;3349   temp_SL/=20000L;
002f9a  fb97f5fe          SDIV     r5,r7,lr
;;;3350   temp_SL-=273L;
002f9e  f2a51511          SUB      r5,r5,#0x111
;;;3351   t_ext[1]=(signed short)temp_SL;
002fa2  4f2e              LDR      r7,|L1.12380|
002fa4  b22d              SXTH     r5,r5
002fa6  807d              STRH     r5,[r7,#2]
002fa8  9500              STR      r5,[sp,#0]
;;;3352   #else
;;;3353   
;;;3354   
;;;3355   
;;;3356   //Внешний датчик температуры №2(температура отсека ЭПУ)
;;;3357   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[1]=0;
;;;3358   else ND_EXT[1]=1;
;;;3359   temp_SL=(signed long)adc_buff_[6];
;;;3360   temp_SL*=Ktext[1];
;;;3361   temp_SL/=20000L;
;;;3362   temp_SL-=273L;
;;;3363   t_ext[1]=(signed short)temp_SL;
;;;3364   
;;;3365   //Внешний датчик температуры №3(температура отсека MSAN)
;;;3366   if((adc_buff_[3]>800)&&(adc_buff_[3]<3800))ND_EXT[2]=0;
;;;3367   else ND_EXT[2]=1;
;;;3368   temp_SL=(signed long)adc_buff_[3];
;;;3369   temp_SL*=Ktext[2];
;;;3370   temp_SL/=20000L;
;;;3371   temp_SL-=273L;
;;;3372   t_ext[2]=(signed short)temp_SL;
;;;3373   
;;;3374   #endif
;;;3375   #endif
;;;3376   
;;;3377   #ifdef UKU_220_V2
;;;3378   
;;;3379   //Внешний датчик температуры №2(температура отсека ЭПУ)
;;;3380   if((adc_buff_[3]>800)&&(adc_buff_[3]<3800))ND_EXT[1]=0;
;;;3381   else ND_EXT[1]=1;
;;;3382   temp_SL=(signed long)adc_buff_[3];
;;;3383   temp_SL*=Ktext[1];
;;;3384   temp_SL/=20000L;
;;;3385   temp_SL-=273L;
;;;3386   t_ext[1]=(signed short)temp_SL;
;;;3387   
;;;3388   //Внешний датчик температуры №3(температура отсека MSAN)
;;;3389   if((adc_buff_[10]>800)&&(adc_buff_[10]<3800))ND_EXT[2]=0;
;;;3390   else ND_EXT[2]=1;
;;;3391   temp_SL=(signed long)adc_buff_[10];
;;;3392   temp_SL*=Ktext[2];
;;;3393   temp_SL/=20000L;
;;;3394   temp_SL-=273L;
;;;3395   t_ext[2]=(signed short)temp_SL;
;;;3396   
;;;3397   #else
;;;3398   
;;;3399   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;3400   //Ток батареи
;;;3401   if(bps[8]._device==dIBAT_METR)
002faa  f8945320          LDRB     r5,[r4,#0x320]  ; bps
;;;3402   	{
;;;3403   	ibat_metr_buff_[0]=((signed long)bps[8]._buff[0])+(((signed long)bps[8]._buff[1])<<8);
;;;3404   	ibat_metr_buff_[1]=((signed long)bps[8]._buff[2])+(((signed long)bps[8]._buff[3])<<8);
;;;3405   	bIBAT_SMKLBR=((signed short)bps[8]._buff[4])+(((signed short)bps[8]._buff[5])<<8);
;;;3406   	if(bIBAT_SMKLBR) bIBAT_SMKLBR_cnt=50;
;;;3407   	if(!bIBAT_SMKLBR)
;;;3408   		{
;;;3409   		signed long temp_SL;
;;;3410   		temp_SL=(signed long)ibat_metr_buff_[0];
;;;3411   		temp_SL-=(signed long)ibat_metr_buff_[1];
;;;3412   		temp_SL*=(signed long)Kibat1[0];
;;;3413   		if((AUSW_MAIN==22010)||(AUSW_MAIN==22011)||(AUSW_MAIN==22035)||(AUSW_MAIN==22033)||(AUSW_MAIN==22063)||(AUSW_MAIN==22023)||(AUSW_MAIN==22043)||(AUSW_MAIN==22044))temp_SL/=2000L;
;;;3414   	
;;;3415   		Ib_ips_termokompensat =(signed short)temp_SL;
002fae  f8dfc0b0          LDR      r12,|L1.12384|
002fb2  2d09              CMP      r5,#9                 ;3401
002fb4  d17e              BNE      |L1.12468|
002fb6  f8945326          LDRB     r5,[r4,#0x326]        ;3403  ; bps
002fba  f8947327          LDRB     r7,[r4,#0x327]        ;3403  ; bps
002fbe  f8df80a4          LDR      r8,|L1.12388|
002fc2  eb052507          ADD      r5,r5,r7,LSL #8       ;3403
002fc6  f8c85000          STR      r5,[r8,#0]            ;3403  ; ibat_metr_buff_
002fca  f8947328          LDRB     r7,[r4,#0x328]        ;3404  ; bps
002fce  f894b329          LDRB     r11,[r4,#0x329]       ;3404  ; bps
002fd2  eb07270b          ADD      r7,r7,r11,LSL #8      ;3404
002fd6  f8c87004          STR      r7,[r8,#4]            ;3404  ; ibat_metr_buff_
002fda  f894832a          LDRB     r8,[r4,#0x32a]        ;3405  ; bps
002fde  f894b32b          LDRB     r11,[r4,#0x32b]       ;3405  ; bps
002fe2  eb08280b          ADD      r8,r8,r11,LSL #8      ;3405
002fe6  fa0ffb88          SXTH     r11,r8                ;3405
002fea  f8df807c          LDR      r8,|L1.12392|
002fee  f8a8b000          STRH     r11,[r8,#0]           ;3405
002ff2  f8df8078          LDR      r8,|L1.12396|
002ff6  e03b              B        |L1.12400|
                  |L1.12280|
                          DCD      net_F3
                  |L1.12284|
                          DCD      net_U
                  |L1.12288|
                          DCD      Kunet
                  |L1.12292|
                          DCD      ||area_number.26||
                  |L1.12296|
                          DCD      net_F
                  |L1.12300|
                          DCD      ||.bss||+0x40c
                  |L1.12304|
                          DCD      Kubat
                  |L1.12308|
                          DCD      bat
                  |L1.12312|
                          DCD      Kubatm
                  |L1.12316|
                          DCD      ad7705_buff_
                  |L1.12320|
                          DCD      Kibat0
                  |L1.12324|
                          DCD      Kibat1
                  |L1.12328|
                          DCD      AUSW_MAIN
                  |L1.12332|
                          DCD      Ktbat
                  |L1.12336|
                          DCD      Kuload
                  |L1.12340|
                          DCD      load_U
                  |L1.12344|
                          DCD      Kuout
                  |L1.12348|
                          DCD      out_U
                  |L1.12352|
                          DCD      Kubps
                  |L1.12356|
                          DCD      bps_U
                  |L1.12360|
                          DCD      NUMIST
                  |L1.12364|
                          DCD      bps
                  |L1.12368|
                          DCD      bps_I
                  |L1.12372|
                          DCD      ND_EXT
                  |L1.12376|
                          DCD      Ktext
                  |L1.12380|
                          DCD      t_ext
                  |L1.12384|
                          DCD      Ib_ips_termokompensat
                  |L1.12388|
                          DCD      ibat_metr_buff_
                  |L1.12392|
                          DCD      bIBAT_SMKLBR
                  |L1.12396|
                          DCD      bIBAT_SMKLBR_cnt
                  |L1.12400|
003070  f1bb0f00          CMP      r11,#0                ;3406
003074  d003              BEQ      |L1.12414|
003076  f04f0b32          MOV      r11,#0x32             ;3406
00307a  f8a8b000          STRH     r11,[r8,#0]           ;3406
                  |L1.12414|
00307e  d131              BNE      |L1.12516|
003080  eba50707          SUB      r7,r5,r7              ;3411
003084  4dff              LDR      r5,|L1.13444|
003086  f9b55000          LDRSH    r5,[r5,#0]            ;3412  ; Kibat1
00308a  fb05f507          MUL      r5,r5,r7              ;3412
00308e  f5a047aa          SUB      r7,r0,#0x5500         ;3413
003092  3ffa              SUBS     r7,r7,#0xfa           ;3413
003094  d00d              BEQ      |L1.12466|
003096  1e7f              SUBS     r7,r7,#1              ;3413
003098  d00b              BEQ      |L1.12466|
00309a  4548              CMP      r0,r9                 ;3413
00309c  d009              BEQ      |L1.12466|
00309e  3f16              SUBS     r7,r7,#0x16           ;3413
0030a0  d007              BEQ      |L1.12466|
0030a2  3f1e              SUBS     r7,r7,#0x1e           ;3413
0030a4  d005              BEQ      |L1.12466|
0030a6  3728              ADDS     r7,r7,#0x28           ;3413
0030a8  d003              BEQ      |L1.12466|
0030aa  3f14              SUBS     r7,r7,#0x14           ;3413
0030ac  d001              BEQ      |L1.12466|
0030ae  1e7f              SUBS     r7,r7,#1              ;3413
0030b0  d105              BNE      |L1.12478|
                  |L1.12466|
0030b2  e000              B        |L1.12470|
                  |L1.12468|
0030b4  e016              B        |L1.12516|
                  |L1.12470|
0030b6  f44f67fa          MOV      r7,#0x7d0             ;3413
0030ba  fb95f5f7          SDIV     r5,r5,r7              ;3413
                  |L1.12478|
0030be  b22f              SXTH     r7,r5
0030c0  f8ac7000          STRH     r7,[r12,#0]
;;;3416   		if(bIBAT_SMKLBR_cnt)
0030c4  f9b85000          LDRSH    r5,[r8,#0]  ; bIBAT_SMKLBR_cnt
;;;3417   			{
;;;3418   			bIBAT_SMKLBR_cnt--;
;;;3419   			Ib_ips_termokompensat=Ib_ips_termokompensat_temp;
0030c8  f8df93bc          LDR      r9,|L1.13448|
0030cc  b145              CBZ      r5,|L1.12512|
0030ce  f1a50501          SUB      r5,r5,#1              ;3418
0030d2  f8a85000          STRH     r5,[r8,#0]            ;3418
0030d6  f8b95000          LDRH     r5,[r9,#0]  ; Ib_ips_termokompensat_temp
0030da  f8ac5000          STRH     r5,[r12,#0]
0030de  e001              B        |L1.12516|
                  |L1.12512|
;;;3420   			}
;;;3421   		else 
;;;3422   			{
;;;3423   			Ib_ips_termokompensat_temp=Ib_ips_termokompensat;
0030e0  f8a97000          STRH     r7,[r9,#0]
                  |L1.12516|
;;;3424   			}
;;;3425   		}
;;;3426   	}
;;;3427   
;;;3428   bat[0]._Ub=load_U;
0030e4  4de9              LDR      r5,|L1.13452|
0030e6  f8a5a002          STRH     r10,[r5,#2]
;;;3429   if(AUSW_MAIN==22018) Ib_ips_termokompensat=bat[0]._Ib;
0030ea  f5a047ac          SUB      r7,r0,#0x5600
0030ee  3f02              SUBS     r7,#2
0030f0  d103              BNE      |L1.12538|
0030f2  8928              LDRH     r0,[r5,#8]  ; bat
0030f4  f8ac0000          STRH     r0,[r12,#0]
0030f8  e002              B        |L1.12544|
                  |L1.12538|
;;;3430   else bat[0]._Ib=Ib_ips_termokompensat;
0030fa  f8bc0000          LDRH     r0,[r12,#0]  ; Ib_ips_termokompensat
0030fe  8128              STRH     r0,[r5,#8]
                  |L1.12544|
;;;3431   
;;;3432   #endif
;;;3433   #endif
;;;3434   
;;;3435   
;;;3436   #ifdef UKU_TELECORE2015
;;;3437   
;;;3438   //Внешний датчик температуры №1
;;;3439   if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))ND_EXT[0]=0;
;;;3440   else ND_EXT[0]=1;
;;;3441   temp_SL=(signed long)adc_buff_[7];
;;;3442   temp_SL*=Ktext[0];
;;;3443   temp_SL/=20000L;
;;;3444   temp_SL-=273L;
;;;3445   t_ext[0]=(signed short)temp_SL;
;;;3446   
;;;3447   
;;;3448   //Внешний датчик температуры №2
;;;3449   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[1]=0;
;;;3450   else ND_EXT[1]=1;
;;;3451   temp_SL=(signed long)adc_buff_[6];
;;;3452   temp_SL*=Ktext[1];
;;;3453   temp_SL/=20000L;
;;;3454   temp_SL-=273L;
;;;3455   t_ext[1]=(signed short)temp_SL;
;;;3456   
;;;3457   #endif
;;;3458   
;;;3459   #ifdef UKU_TELECORE2017
;;;3460   
;;;3461   //Внешний датчик температуры №1
;;;3462   if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))ND_EXT[0]=0;
;;;3463   else ND_EXT[0]=1;
;;;3464   temp_SL=(signed long)adc_buff_[7];
;;;3465   temp_SL*=Ktext[0];
;;;3466   temp_SL/=20000L;
;;;3467   temp_SL-=273L;
;;;3468   t_ext[0]=(signed short)temp_SL;
;;;3469   
;;;3470   
;;;3471   //Внешний датчик температуры №2
;;;3472   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[1]=0;
;;;3473   else ND_EXT[1]=1;
;;;3474   temp_SL=(signed long)adc_buff_[6];
;;;3475   temp_SL*=Ktext[1];
;;;3476   temp_SL/=20000L;
;;;3477   temp_SL-=273L;
;;;3478   t_ext[1]=(signed short)temp_SL;
;;;3479   
;;;3480   #endif
;;;3481   
;;;3482   //напряжение ввода
;;;3483   temp_SL=(signed long)adc_buff_ext_[0];
003100  f8df838c          LDR      r8,|L1.13456|
003104  f8b87000          LDRH     r7,[r8,#0]  ; adc_buff_ext_
;;;3484   temp_SL*=Kunet_ext[0];
003108  f8df9388          LDR      r9,|L1.13460|
00310c  f9b90000          LDRSH    r0,[r9,#0]  ; Kunet_ext
003110  4378              MULS     r0,r7,r0
;;;3485   temp_SL/=4000L;
003112  f44f6b7a          MOV      r11,#0xfa0
003116  fb90f0fb          SDIV     r0,r0,r11
;;;3486   Uvv[0]=(signed short)temp_SL;
00311a  4fdf              LDR      r7,|L1.13464|
00311c  b280              UXTH     r0,r0
00311e  8038              STRH     r0,[r7,#0]
;;;3487   if(Uvv[0]<100) Uvv0=Uvv[0];
003120  f8dfe378          LDR      lr,|L1.13468|
003124  2864              CMP      r0,#0x64
003126  d202              BCS      |L1.12590|
003128  f8ae0000          STRH     r0,[lr,#0]
00312c  e003              B        |L1.12598|
                  |L1.12590|
;;;3488   else Uvv0=net_U;
00312e  48dc              LDR      r0,|L1.13472|
003130  8800              LDRH     r0,[r0,#0]  ; net_U
003132  f8ae0000          STRH     r0,[lr,#0]
                  |L1.12598|
;;;3489   
;;;3490   //напряжение пэс
;;;3491   temp_SL=(signed long)adc_buff_ext_[1];
003136  f8b88002          LDRH     r8,[r8,#2]  ; adc_buff_ext_
;;;3492   temp_SL*=Kunet_ext[1];
00313a  f9b90002          LDRSH    r0,[r9,#2]  ; Kunet_ext
00313e  fb00f008          MUL      r0,r0,r8
;;;3493   temp_SL/=4000L;
003142  fb90f0fb          SDIV     r0,r0,r11
;;;3494   Uvv[1]=(signed short)temp_SL;
003146  8078              STRH     r0,[r7,#2]
;;;3495   
;;;3496   
;;;3497   //напряжение ввода трехфазное
;;;3498   temp_SL=(signed long)eb2_data_short[0];
003148  4fd6              LDR      r7,|L1.13476|
00314a  f9b70000          LDRSH    r0,[r7,#0]  ; eb2_data_short
;;;3499   temp_SL*=Kvv_eb2[0];
00314e  f8df8358          LDR      r8,|L1.13480|
003152  f9b89000          LDRSH    r9,[r8,#0]  ; Kvv_eb2
003156  fb09f900          MUL      r9,r9,r0
;;;3500   temp_SL/=6000L;
00315a  f2417070          MOV      r0,#0x1770
00315e  fb99fbf0          SDIV     r11,r9,r0
;;;3501   Uvv_eb2[0]=(signed short)temp_SL;
003162  f8df9348          LDR      r9,|L1.13484|
003166  f8a9b000          STRH     r11,[r9,#0]
;;;3502   
;;;3503   temp_SL=(signed long)eb2_data_short[1];
00316a  f9b7e002          LDRSH    lr,[r7,#2]  ; eb2_data_short
;;;3504   temp_SL*=Kvv_eb2[1];
00316e  f9b8b002          LDRSH    r11,[r8,#2]  ; Kvv_eb2
003172  fb0bfb0e          MUL      r11,r11,lr
;;;3505   temp_SL/=6000L;
003176  fb9bfbf0          SDIV     r11,r11,r0
;;;3506   Uvv_eb2[1]=(signed short)temp_SL;
00317a  f8a9b002          STRH     r11,[r9,#2]
;;;3507   
;;;3508   temp_SL=(signed long)eb2_data_short[2];
00317e  f9b7b004          LDRSH    r11,[r7,#4]  ; eb2_data_short
;;;3509   temp_SL*=Kvv_eb2[2];
003182  f9b88004          LDRSH    r8,[r8,#4]  ; Kvv_eb2
003186  fb08f80b          MUL      r8,r8,r11
;;;3510   temp_SL/=6000L;
00318a  fb98f8f0          SDIV     r8,r8,r0
;;;3511   Uvv_eb2[2]=(signed short)temp_SL;
00318e  f8a98004          STRH     r8,[r9,#4]
;;;3512   
;;;3513   //напряжение пэс трехфазное
;;;3514   temp_SL=(signed long)eb2_data_short[3];
003192  f9b7b006          LDRSH    r11,[r7,#6]  ; eb2_data_short
;;;3515   temp_SL*=Kpes_eb2[0];
003196  f8df8318          LDR      r8,|L1.13488|
00319a  f9b89000          LDRSH    r9,[r8,#0]  ; Kpes_eb2
00319e  fb09f90b          MUL      r9,r9,r11
;;;3516   temp_SL/=6000L;
0031a2  fb99fbf0          SDIV     r11,r9,r0
;;;3517   Upes_eb2[0]=(signed short)temp_SL;
0031a6  f8df930c          LDR      r9,|L1.13492|
0031aa  f8a9b000          STRH     r11,[r9,#0]
;;;3518   
;;;3519   temp_SL=(signed long)eb2_data_short[4];
0031ae  f9b7e008          LDRSH    lr,[r7,#8]  ; eb2_data_short
;;;3520   temp_SL*=Kpes_eb2[1];
0031b2  f9b8b002          LDRSH    r11,[r8,#2]  ; Kpes_eb2
0031b6  fb0bfb0e          MUL      r11,r11,lr
;;;3521   temp_SL/=6000L;
0031ba  fb9bfbf0          SDIV     r11,r11,r0
;;;3522   Upes_eb2[1]=(signed short)temp_SL;
0031be  f8a9b002          STRH     r11,[r9,#2]
;;;3523   
;;;3524   temp_SL=(signed long)eb2_data_short[5];
0031c2  f9b7b00a          LDRSH    r11,[r7,#0xa]  ; eb2_data_short
;;;3525   temp_SL*=Kpes_eb2[2];
0031c6  f9b87004          LDRSH    r7,[r8,#4]  ; Kpes_eb2
0031ca  fb07f70b          MUL      r7,r7,r11
;;;3526   temp_SL/=6000L;
0031ce  fb97f0f0          SDIV     r0,r7,r0
;;;3527   Upes_eb2[2]=(signed short)temp_SL;
0031d2  f8a90004          STRH     r0,[r9,#4]
;;;3528   
;;;3529   //Вычисление температуры шкафа
;;;3530   
;;;3531   ibt._T[0]=t_ext[1]+273;
0031d6  9f00              LDR      r7,[sp,#0]
0031d8  f8dfb2e0          LDR      r11,|L1.13500|
0031dc  f2071711          ADD      r7,r7,#0x111
0031e0  48b5              LDR      r0,|L1.13496|
0031e2  fa0ff887          SXTH     r8,r7
0031e6  f8ab8000          STRH     r8,[r11,#0]
;;;3532   ibt._T[1]=t_ext[2]+273;
0031ea  8880              LDRH     r0,[r0,#4]  ; t_ext
0031ec  f2001011          ADD      r0,r0,#0x111
0031f0  fa0ff980          SXTH     r9,r0
0031f4  f8ab9002          STRH     r9,[r11,#2]
;;;3533   
;;;3534   ibt._nd[0]=ND_EXT[1];
0031f8  784f              LDRB     r7,[r1,#1]  ; ND_EXT
0031fa  f88b7008          STRB     r7,[r11,#8]
;;;3535   ibt._nd[1]=ND_EXT[2];
0031fe  7888              LDRB     r0,[r1,#2]  ; ND_EXT
003200  f88b0009          STRB     r0,[r11,#9]
;;;3536   
;;;3537   #ifndef UKU_TELECORE2015
;;;3538   if((ibt._nd[0]==0) &&  (ibt._nd[1]==0))
;;;3539   	{
;;;3540   	t_box=((ibt._T[0]+ibt._T[1])/2)-273;
003204  49ae              LDR      r1,|L1.13504|
003206  b907              CBNZ     r7,|L1.12810|
003208  b110              CBZ      r0,|L1.12816|
                  |L1.12810|
;;;3541   	}
;;;3542   else if((ibt._nd[0]==1) &&  (ibt._nd[1]==0))
00320a  2f01              CMP      r7,#1
00320c  d00a              BEQ      |L1.12836|
00320e  e00a              B        |L1.12838|
                  |L1.12816|
003210  eb080009          ADD      r0,r8,r9              ;3540
003214  eb0070d0          ADD      r0,r0,r0,LSR #31      ;3540
003218  f46f7788          MVN      r7,#0x110             ;3540
00321c  eb070060          ADD      r0,r7,r0,ASR #1       ;3540
003220  8008              STRH     r0,[r1,#0]            ;3540
003222  e01e              B        |L1.12898|
                  |L1.12836|
003224  b108              CBZ      r0,|L1.12842|
                  |L1.12838|
;;;3543   	{
;;;3544   	t_box=ibt._T[1]-273;
;;;3545   	}
;;;3546   else if((ibt._nd[0]==0) &&  (ibt._nd[1]==1))
003226  b12f              CBZ      r7,|L1.12852|
003228  e006              B        |L1.12856|
                  |L1.12842|
00322a  f2a91911          SUB      r9,r9,#0x111          ;3544
00322e  f8a19000          STRH     r9,[r1,#0]            ;3544
003232  e016              B        |L1.12898|
                  |L1.12852|
003234  2801              CMP      r0,#1
003236  d002              BEQ      |L1.12862|
                  |L1.12856|
;;;3547   	{
;;;3548   	t_box=ibt._T[0]-273;
;;;3549   	}
;;;3550   else if((ibt._nd[0]==1) &&  (ibt._nd[1]==1))
003238  2f01              CMP      r7,#1
00323a  d005              BEQ      |L1.12872|
00323c  e011              B        |L1.12898|
                  |L1.12862|
00323e  f2a81811          SUB      r8,r8,#0x111          ;3548
003242  f8a18000          STRH     r8,[r1,#0]            ;3548
003246  e00c              B        |L1.12898|
                  |L1.12872|
003248  2801              CMP      r0,#1
00324a  d10a              BNE      |L1.12898|
;;;3551   	{
;;;3552   	if(t_ext_can_nd<5)t_box= t_ext_can;
00324c  489d              LDR      r0,|L1.13508|
00324e  7800              LDRB     r0,[r0,#0]  ; t_ext_can_nd
003250  2805              CMP      r0,#5
003252  d203              BCS      |L1.12892|
003254  489c              LDR      r0,|L1.13512|
003256  8800              LDRH     r0,[r0,#0]  ; t_ext_can
003258  8008              STRH     r0,[r1,#0]
00325a  e002              B        |L1.12898|
                  |L1.12892|
;;;3553   	else t_box=20;
00325c  f04f0014          MOV      r0,#0x14
003260  8008              STRH     r0,[r1,#0]
                  |L1.12898|
;;;3554   	}
;;;3555   #endif
;;;3556   /*
;;;3557   //Вычисление температуры шкафа
;;;3558   
;;;3559   ibt._T[0]=bat[0]._Tb+273;
;;;3560   ibt._T[1]=bat[1]._Tb+273;
;;;3561   ibt._T[2]=t_ext[1]+273;
;;;3562   ibt._T[3]=t_ext[2]+273;
;;;3563   
;;;3564   ibt._nd[0]=bat[0]._nd;
;;;3565   ibt._nd[1]=bat[1]._nd;
;;;3566   ibt._nd[2]=ND_EXT[1];
;;;3567   ibt._nd[3]=ND_EXT[2];
;;;3568   
;;;3569   ibt._avg1=0;
;;;3570   ibt._avg_cnt=4;
;;;3571   
;;;3572   if(ibt._nd[0]==0)
;;;3573   	{
;;;3574   	ibt._avg1+=ibt._T[0];
;;;3575   	}
;;;3576   else 
;;;3577   	{
;;;3578   	ibt._avg_cnt--;
;;;3579   	}
;;;3580   
;;;3581   if(ibt._nd[1]==0)
;;;3582   	{
;;;3583   	ibt._avg1+=ibt._T[1];
;;;3584   	}
;;;3585   else 
;;;3586   	{
;;;3587   	ibt._avg_cnt--;
;;;3588   	}
;;;3589   
;;;3590   if(ibt._nd[2]==0)
;;;3591   	{
;;;3592   	ibt._avg1+=ibt._T[2];
;;;3593   	}
;;;3594   else 
;;;3595   	{
;;;3596   	ibt._avg_cnt--;
;;;3597   	}
;;;3598   
;;;3599   if(ibt._nd[3]==0)
;;;3600   	{
;;;3601   	ibt._avg1+=ibt._T[3];
;;;3602   	}
;;;3603   else 
;;;3604   	{
;;;3605   	ibt._avg_cnt--;
;;;3606   	}
;;;3607   
;;;3608   if(ibt._avg_cnt==0)
;;;3609   	{
;;;3610   	}
;;;3611   else
;;;3612   	{
;;;3613   	ibt._avg1/=ibt._avg_cnt;
;;;3614   	}
;;;3615   
;;;3616   
;;;3617   if(ibt._nd[0]!=0)
;;;3618   	{
;;;3619   	ibt._T_dispers[0]=0;
;;;3620   	}
;;;3621   else 
;;;3622   	{
;;;3623   	ibt._T_dispers[0]=abs(ibt._T[0]-ibt._avg1);
;;;3624   	}
;;;3625   
;;;3626   if(ibt._nd[1]!=0)
;;;3627   	{
;;;3628   	ibt._T_dispers[1]=0;
;;;3629   	}
;;;3630   else 
;;;3631   	{
;;;3632   	ibt._T_dispers[1]=abs(ibt._T[1]-ibt._avg1);
;;;3633   	}
;;;3634   
;;;3635   if(ibt._nd[2]!=0)
;;;3636   	{
;;;3637   	ibt._T_dispers[2]=0;
;;;3638   	}
;;;3639   else 
;;;3640   	{
;;;3641   	ibt._T_dispers[2]=abs(ibt._T[2]-ibt._avg1);
;;;3642   	}
;;;3643   
;;;3644   if(ibt._nd[3]!=0)
;;;3645   	{
;;;3646   	ibt._T_dispers[3]=0;
;;;3647   	}
;;;3648   else 
;;;3649   	{
;;;3650   	ibt._T_dispers[3]=abs(ibt._T[3]-ibt._avg1);
;;;3651   	}
;;;3652   
;;;3653   if(	ibt._nd[0]&&
;;;3654   	ibt._nd[1]&&
;;;3655   	ibt._nd[2]&&
;;;3656   	ibt._nd[3]
;;;3657   	)
;;;3658   	{
;;;3659   	t_box=(bps[0]._Ti);
;;;3660   	}
;;;3661   
;;;3662   else if(	ibt._nd[0]||
;;;3663   	ibt._nd[1]||
;;;3664   	ibt._nd[2]||
;;;3665   	ibt._nd[3]
;;;3666   	)
;;;3667   	{
;;;3668   	t_box=(ibt._avg1-273);
;;;3669   	}
;;;3670   else 
;;;3671   	{
;;;3672   	ibt._max_dispers_num=0;
;;;3673   	ibt._max_dispers=ibt._T_dispers[0];
;;;3674   
;;;3675   	if(ibt._T_dispers[1]>ibt._max_dispers)
;;;3676   		{
;;;3677   		ibt._max_dispers_num=1;
;;;3678   		ibt._max_dispers=ibt._T_dispers[1];
;;;3679   		}
;;;3680   	if(ibt._T_dispers[2]>ibt._max_dispers)
;;;3681   		{
;;;3682   		ibt._max_dispers_num=2;
;;;3683   		ibt._max_dispers=ibt._T_dispers[2];
;;;3684   		}
;;;3685   	if(ibt._T_dispers[3]>ibt._max_dispers)
;;;3686   		{
;;;3687   		ibt._max_dispers_num=3;
;;;3688   		ibt._max_dispers=ibt._T_dispers[3];
;;;3689   		}
;;;3690   
;;;3691   	ibt._avg2=0;
;;;3692   
;;;3693   	if(ibt._max_dispers_num!=0)
;;;3694   		{
;;;3695   		ibt._avg2+=ibt._T[0];
;;;3696   		}
;;;3697   	if(ibt._max_dispers_num!=1)
;;;3698   		{
;;;3699   		ibt._avg2+=ibt._T[1];
;;;3700   		}
;;;3701   	if(ibt._max_dispers_num!=2)
;;;3702   		{
;;;3703   		ibt._avg2+=ibt._T[2];
;;;3704   		}
;;;3705   	if(ibt._max_dispers_num!=3)
;;;3706   		{
;;;3707   		ibt._avg2+=ibt._T[3];
;;;3708   		}
;;;3709   
;;;3710   	t_box=(ibt._avg2/3)-273;
;;;3711   
;;;3712   	}*/
;;;3713   
;;;3714   
;;;3715   //*********************************************
;;;3716   
;;;3717   #ifndef TELECORE
;;;3718   if((BAT_IS_ON[0]==bisON)&&(bat[0]._Ub>200)) Ibmax=bat[0]._Ib;
003262  489a              LDR      r0,|L1.13516|
003264  7801              LDRB     r1,[r0,#0]  ; BAT_IS_ON
003266  2955              CMP      r1,#0x55
003268  d105              BNE      |L1.12918|
00326a  f1ba0fc8          CMP      r10,#0xc8
00326e  dd02              BLE      |L1.12918|
003270  8929              LDRH     r1,[r5,#8]  ; bat
003272  f8a6104a          STRH     r1,[r6,#0x4a]
                  |L1.12918|
;;;3719   if((BAT_IS_ON[1]==bisON)&&(bat[1]._Ub>200)&&(bat[1]._Ib>bat[0]._Ib)) Ibmax=bat[1]._Ib;
003276  7840              LDRB     r0,[r0,#1]  ; BAT_IS_ON
003278  2855              CMP      r0,#0x55
00327a  d10b              BNE      |L1.12948|
00327c  f9b5004e          LDRSH    r0,[r5,#0x4e]  ; bat
003280  28c8              CMP      r0,#0xc8
003282  dd07              BLE      |L1.12948|
003284  f9b50054          LDRSH    r0,[r5,#0x54]  ; bat
003288  f9b51008          LDRSH    r1,[r5,#8]  ; bat
00328c  4288              CMP      r0,r1
00328e  dd01              BLE      |L1.12948|
003290  f8a6004a          STRH     r0,[r6,#0x4a]
                  |L1.12948|
;;;3720   #endif
;;;3721   
;;;3722   #ifdef TELECORE
;;;3723   Ibmax=0;
;;;3724   /*
;;;3725   if((NUMBAT_TELECORE>0)&&(lakb[0]._communicationFullErrorStat==0)&&(lakb[0]._ch_curr/10>Ibmax))Ibmax=lakb[0]._ch_curr/10;
;;;3726   if((NUMBAT_TELECORE>1)&&(lakb[1]._communicationFullErrorStat==0)&&(lakb[1]._ch_curr/10>Ibmax))Ibmax=lakb[1]._ch_curr/10;
;;;3727   if((NUMBAT_TELECORE>2)&&(lakb[2]._communicationFullErrorStat==0)&&(lakb[2]._ch_curr/10>Ibmax))Ibmax=lakb[2]._ch_curr/10;
;;;3728   */
;;;3729   if((NUMBAT_TELECORE>0)&&(bat[0]._Ib/10>Ibmax))Ibmax=bat[0]._Ib/10;
;;;3730   if((NUMBAT_TELECORE>1)&&(bat[1]._Ib/10>Ibmax))Ibmax=bat[1]._Ib/10;
;;;3731   //if((BAT_IS_ON[0]==bisON)&&(bat[0]._Ub>200)) Ibmax=bat[0]._Ib/1;
;;;3732   //if((BAT_IS_ON[1]==bisON)&&(bat[1]._Ub>200)&&(bat[1]._Ib>bat[0]._Ib)) Ibmax=bat[1]._Ib;
;;;3733   #endif
;;;3734   
;;;3735   #ifdef UKU_FSO
;;;3736   Ibmax=0;
;;;3737   if((NUMBAT_FSO>0)&&(bat[0]._Ib/10>Ibmax))Ibmax=bat[0]._Ib/10;
;;;3738   if((NUMBAT_FSO>1)&&(bat[1]._Ib/10>Ibmax))Ibmax=bat[1]._Ib/10;
;;;3739   #endif
;;;3740   
;;;3741   #ifdef UKU_TELECORE2017
;;;3742   Ibmax=0;
;;;3743   if((NUMBAT_TELECORE>0)&&(bat[0]._Ib/10>Ibmax))Ibmax=bat[0]._Ib/10;
;;;3744   if((NUMBAT_TELECORE>1)&&(bat[1]._Ib/10>Ibmax))Ibmax=bat[1]._Ib/10;
;;;3745   #endif
;;;3746   
;;;3747   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;3748   Ibmax=Ib_ips_termokompensat;
003294  f8bc0000          LDRH     r0,[r12,#0]  ; Ib_ips_termokompensat
003298  f8a6004a          STRH     r0,[r6,#0x4a]
;;;3749   #endif
;;;3750   for(i=0;i<NUMIST;i++)
00329c  f04f0100          MOV      r1,#0
0032a0  e02f              B        |L1.13058|
                  |L1.12962|
;;;3751   	{
;;;3752   	if(bps[i]._cnt<25)
0032a2  eb0100c1          ADD      r0,r1,r1,LSL #3
0032a6  eb001001          ADD      r0,r0,r1,LSL #4
0032aa  eb040080          ADD      r0,r4,r0,LSL #2
0032ae  78c6              LDRB     r6,[r0,#3]
0032b0  2e19              CMP      r6,#0x19
0032b2  d21c              BCS      |L1.13038|
;;;3753        	{
;;;3754        	bps[i]._Ii=bps[i]._buff[0]+(bps[i]._buff[1]*256);
0032b4  7986              LDRB     r6,[r0,#6]
0032b6  79c7              LDRB     r7,[r0,#7]
0032b8  eb062607          ADD      r6,r6,r7,LSL #8
0032bc  6246              STR      r6,[r0,#0x24]
;;;3755        	bps[i]._Uin=bps[i]._buff[2]+(bps[i]._buff[3]*256);
0032be  7a06              LDRB     r6,[r0,#8]
0032c0  7a47              LDRB     r7,[r0,#9]
0032c2  eb062607          ADD      r6,r6,r7,LSL #8
0032c6  6206              STR      r6,[r0,#0x20]
;;;3756        	bps[i]._Uii=bps[i]._buff[4]+(bps[i]._buff[5]*256);
0032c8  7a86              LDRB     r6,[r0,#0xa]
0032ca  7ac7              LDRB     r7,[r0,#0xb]
0032cc  eb062607          ADD      r6,r6,r7,LSL #8
0032d0  61c6              STR      r6,[r0,#0x1c]
;;;3757        	bps[i]._Ti=(signed)(bps[i]._buff[6]);
0032d2  7b06              LDRB     r6,[r0,#0xc]
0032d4  6286              STR      r6,[r0,#0x28]
;;;3758        	bps[i]._adr_ee=bps[i]._buff[7];
0032d6  7b46              LDRB     r6,[r0,#0xd]
0032d8  f8806056          STRB     r6,[r0,#0x56]
;;;3759        	bps[i]._flags_tm=bps[i]._buff[8];
0032dc  7b86              LDRB     r6,[r0,#0xe]
0032de  f8806042          STRB     r6,[r0,#0x42]
;;;3760   	    bps[i]._rotor=bps[i]._buff[10]+(bps[i]._buff[11]*256);    
0032e2  7c06              LDRB     r6,[r0,#0x10]
0032e4  7c47              LDRB     r7,[r0,#0x11]
0032e6  eb062607          ADD      r6,r6,r7,LSL #8
0032ea  6506              STR      r6,[r0,#0x50]
0032ec  e006              B        |L1.13052|
                  |L1.13038|
;;;3761        	} 
;;;3762   	else 
;;;3763        	{
;;;3764        	bps[i]._Uii=0; 
0032ee  61c3              STR      r3,[r0,#0x1c]
;;;3765        	bps[i]._Ii=0;
0032f0  6243              STR      r3,[r0,#0x24]
;;;3766        	bps[i]._Uin=0;
0032f2  6203              STR      r3,[r0,#0x20]
;;;3767        	bps[i]._Ti=0;
0032f4  6283              STR      r3,[r0,#0x28]
;;;3768        	bps[i]._flags_tm=0; 
0032f6  f8803042          STRB     r3,[r0,#0x42]
;;;3769   	     bps[i]._rotor=0;    
0032fa  6503              STR      r3,[r0,#0x50]
                  |L1.13052|
0032fc  f1010101          ADD      r1,r1,#1              ;3750
003300  b2c9              UXTB     r1,r1                 ;3750
                  |L1.13058|
003302  4291              CMP      r1,r2                 ;3750
003304  dbcd              BLT      |L1.12962|
;;;3770        	}
;;;3771        
;;;3772        }
;;;3773   
;;;3774   load_I=0;
003306  4e72              LDR      r6,|L1.13520|
;;;3775   #ifdef TELECORE
;;;3776   
;;;3777   /*for(i=0;i<NUMBAT_TELECORE;i++)
;;;3778   	{
;;;3779   	load_I-=lakb[i]._ch_curr/10;
;;;3780   	}*/
;;;3781   load_I=-(bat[0]._Ib/10)-(bat[1]._Ib/10);
;;;3782   #elif UKU_TELECORE2017
;;;3783   load_I=-(bat[0]._Ib/10)-(bat[1]._Ib/10);
;;;3784   #else
;;;3785   load_I=-(bat[0]._Ib/10)-(bat[1]._Ib/10);
003308  f9b51008          LDRSH    r1,[r5,#8]  ; bat
00330c  f04f000a          MOV      r0,#0xa
003310  fb91f1f0          SDIV     r1,r1,r0
003314  f9b55054          LDRSH    r5,[r5,#0x54]  ; bat
003318  fb95f0f0          SDIV     r0,r5,r0
00331c  4408              ADD      r0,r0,r1
00331e  f1c00000          RSB      r0,r0,#0
003322  b207              SXTH     r7,r0
003324  8037              STRH     r7,[r6,#0]
;;;3786   #endif
;;;3787   Isumm=0;
003326  4d6b              LDR      r5,|L1.13524|
003328  802b              STRH     r3,[r5,#0]
;;;3788   
;;;3789   for(i=0;i<NUMIST;i++)
00332a  f04f0000          MOV      r0,#0
00332e  e012              B        |L1.13142|
                  |L1.13104|
;;;3790        {
;;;3791        if(bps[i]._cnt<5)Isumm+=bps[i]._Ii;
003330  eb0001c0          ADD      r1,r0,r0,LSL #3
003334  eb011100          ADD      r1,r1,r0,LSL #4
003338  eb040181          ADD      r1,r4,r1,LSL #2
00333c  f891c003          LDRB     r12,[r1,#3]
003340  f1bc0f05          CMP      r12,#5
003344  d204              BCS      |L1.13136|
003346  6a49              LDR      r1,[r1,#0x24]
003348  f8b5c000          LDRH     r12,[r5,#0]  ; Isumm
00334c  4461              ADD      r1,r1,r12
00334e  8029              STRH     r1,[r5,#0]
                  |L1.13136|
003350  f1000001          ADD      r0,r0,#1              ;3789
003354  b2c0              UXTB     r0,r0                 ;3789
                  |L1.13142|
003356  4290              CMP      r0,r2                 ;3789
003358  dbea              BLT      |L1.13104|
;;;3792        }  
;;;3793        
;;;3794   load_I=load_I+Isumm;
00335a  8828              LDRH     r0,[r5,#0]  ; Isumm
00335c  4438              ADD      r0,r0,r7
00335e  b200              SXTH     r0,r0
003360  8030              STRH     r0,[r6,#0]
;;;3795   if(load_I<0)load_I=0;
003362  2800              CMP      r0,#0
003364  da00              BGE      |L1.13160|
003366  8033              STRH     r3,[r6,#0]
                  |L1.13160|
;;;3796   
;;;3797   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;3798   load_I=0;
003368  8033              STRH     r3,[r6,#0]
;;;3799   
;;;3800   Isumm=0;
00336a  802b              STRH     r3,[r5,#0]
;;;3801   
;;;3802   for(i=0;i<NUMIST;i++)
00336c  f04f0000          MOV      r0,#0
003370  e00f              B        |L1.13202|
                  |L1.13170|
;;;3803        {
;;;3804        if(bps[i]._cnt<5)Isumm+=bps[i]._Ii;
003372  eb0001c0          ADD      r1,r0,r0,LSL #3
003376  eb011100          ADD      r1,r1,r0,LSL #4
00337a  eb040181          ADD      r1,r4,r1,LSL #2
00337e  78cf              LDRB     r7,[r1,#3]
003380  2f05              CMP      r7,#5
003382  d203              BCS      |L1.13196|
003384  6a49              LDR      r1,[r1,#0x24]
003386  882f              LDRH     r7,[r5,#0]  ; Isumm
003388  4439              ADD      r1,r1,r7
00338a  8029              STRH     r1,[r5,#0]
                  |L1.13196|
00338c  f1000001          ADD      r0,r0,#1              ;3802
003390  b2c0              UXTB     r0,r0                 ;3802
                  |L1.13202|
003392  4290              CMP      r0,r2                 ;3802
003394  dbed              BLT      |L1.13170|
;;;3805        }  
;;;3806        
;;;3807   load_I=load_I+Isumm;
003396  8829              LDRH     r1,[r5,#0]  ; Isumm
003398  eb030001          ADD      r0,r3,r1
00339c  b200              SXTH     r0,r0
00339e  8030              STRH     r0,[r6,#0]
;;;3808   if(load_I<0)load_I=0;
0033a0  2800              CMP      r0,#0
0033a2  da00              BGE      |L1.13222|
0033a4  8033              STRH     r3,[r6,#0]
                  |L1.13222|
;;;3809   
;;;3810   #endif
;;;3811   #ifdef IPS_SGEP_GAZPROM
;;;3812   load_I=Isumm;
;;;3813   #endif
;;;3814   
;;;3815   
;;;3816   #ifdef UKU_GLONASS
;;;3817   inv[0]._Uio=6;
;;;3818   if (NUMINV)
;;;3819   	{
;;;3820   	for(i=0;i<NUMINV;i++)
;;;3821   		{
;;;3822   		if(bps[i+first_inv_slot]._cnt<25)
;;;3823        		{
;;;3824        		inv[i]._Ii=bps[i+first_inv_slot]._buff[0]+(bps[i+first_inv_slot]._buff[1]*256);
;;;3825        		inv[i]._Uin=bps[i+first_inv_slot]._buff[2]+(bps[i+first_inv_slot]._buff[3]*256);
;;;3826        		inv[i]._Uio=bps[i+first_inv_slot]._buff[4]+(bps[i+first_inv_slot]._buff[5]*256);
;;;3827        		inv[i]._Ti=(signed)(bps[i+first_inv_slot]._buff[6]);
;;;3828        		inv[i]._flags_tm=bps[i+first_inv_slot]._buff[8];
;;;3829   	    	//	inv[i]._rotor=bps[i+first_inv_slot]._buff[10]+(bps[i+first_inv_slot]._buff[11]*256);
;;;3830   			inv[i]._cnt=0;    
;;;3831        		} 
;;;3832   		else 
;;;3833        		{
;;;3834        		inv[i]._Uio=0; 
;;;3835        		inv[i]._Ii=0;
;;;3836        		inv[i]._Uin=0;
;;;3837        		inv[i]._Ti=0;
;;;3838        		inv[i]._flags_tm=0; 
;;;3839   //	     	inv[i]._rotor0;
;;;3840   			inv[i]._cnt=25;    
;;;3841        		}
;;;3842        	}
;;;3843      	}
;;;3844   #endif
;;;3845   
;;;3846   #ifndef UKU_GLONASS
;;;3847   if (NUMINV)
0033a6  484c              LDR      r0,|L1.13528|
0033a8  f9b05000          LDRSH    r5,[r0,#0]  ; NUMINV
0033ac  2d00              CMP      r5,#0
0033ae  d066              BEQ      |L1.13438|
;;;3848   	{
;;;3849   	for(i=0;i<NUMINV;i++)
0033b0  f04f0200          MOV      r2,#0
;;;3850   		{
;;;3851   		if(bps[i+20]._cnt<25)
;;;3852        		{
;;;3853        		inv[i]._Ii=bps[i+20]._buff[0]+(bps[i+20]._buff[1]*256);
0033b4  4e49              LDR      r6,|L1.13532|
0033b6  e060              B        |L1.13434|
                  |L1.13240|
0033b8  f1020014          ADD      r0,r2,#0x14           ;3851
0033bc  eb0001c0          ADD      r1,r0,r0,LSL #3       ;3851
0033c0  eb011000          ADD      r0,r1,r0,LSL #4       ;3851
0033c4  eb040080          ADD      r0,r4,r0,LSL #2       ;3851
0033c8  78c1              LDRB     r1,[r0,#3]            ;3851
0033ca  2919              CMP      r1,#0x19              ;3851
0033cc  d239              BCS      |L1.13378|
0033ce  7981              LDRB     r1,[r0,#6]
0033d0  79c7              LDRB     r7,[r0,#7]
0033d2  eb012707          ADD      r7,r1,r7,LSL #8
0033d6  eb020142          ADD      r1,r2,r2,LSL #1
0033da  eb061141          ADD      r1,r6,r1,LSL #5
0033de  61cf              STR      r7,[r1,#0x1c]
;;;3854        		inv[i]._Pio=bps[i+20]._buff[2]+(bps[i+20]._buff[3]*256);
0033e0  7a07              LDRB     r7,[r0,#8]
0033e2  f890c009          LDRB     r12,[r0,#9]
0033e6  eb07270c          ADD      r7,r7,r12,LSL #8
0033ea  62cf              STR      r7,[r1,#0x2c]
;;;3855        		inv[i]._Uio=bps[i+20]._buff[4]+(bps[i+20]._buff[5]*256);
0033ec  7a87              LDRB     r7,[r0,#0xa]
0033ee  f890c00b          LDRB     r12,[r0,#0xb]
0033f2  eb07270c          ADD      r7,r7,r12,LSL #8
0033f6  618f              STR      r7,[r1,#0x18]
;;;3856        		inv[i]._Ti=(signed)(bps[i+20]._buff[6]);
0033f8  7b07              LDRB     r7,[r0,#0xc]
0033fa  620f              STR      r7,[r1,#0x20]
;;;3857        		inv[i]._flags_tm=bps[i+20]._buff[7];
0033fc  7b47              LDRB     r7,[r0,#0xd]
0033fe  f8817046          STRB     r7,[r1,#0x46]
;;;3858        		inv[i]._Uin=bps[i+20]._buff[8]+(bps[i+20]._buff[9]*256);
003402  7b87              LDRB     r7,[r0,#0xe]
003404  f890c00f          LDRB     r12,[r0,#0xf]
003408  eb07270c          ADD      r7,r7,r12,LSL #8
00340c  628f              STR      r7,[r1,#0x28]
;;;3859        		inv[i]._Uil=bps[i+20]._buff[10]+(bps[i+20]._buff[11]*256);
00340e  7c07              LDRB     r7,[r0,#0x10]
003410  f890c011          LDRB     r12,[r0,#0x11]
003414  eb07270c          ADD      r7,r7,r12,LSL #8
003418  624f              STR      r7,[r1,#0x24]
;;;3860   			inv[i]._cnt=0;
00341a  708b              STRB     r3,[r1,#2]
;;;3861   			inv[i]._Uoutmin=bps[i+20]._buff[12]; 
00341c  7c87              LDRB     r7,[r0,#0x12]
00341e  f8817059          STRB     r7,[r1,#0x59]
;;;3862   			inv[i]._Uoutmax=bps[i+20]._buff[13]; 
003422  7cc7              LDRB     r7,[r0,#0x13]
003424  f881705a          STRB     r7,[r1,#0x5a]
;;;3863   			inv[i]._Pnom=bps[i+20]._buff[14]; 
003428  7d07              LDRB     r7,[r0,#0x14]
00342a  f8817058          STRB     r7,[r1,#0x58]
;;;3864   			inv[i]._net_contr_en=bps[i+20]._buff[15];
00342e  7d47              LDRB     r7,[r0,#0x15]
003430  f881705b          STRB     r7,[r1,#0x5b]
;;;3865   			inv[i]._pwm_en=bps[i+20]._buff[16];  
003434  7d87              LDRB     r7,[r0,#0x16]
003436  f881705c          STRB     r7,[r1,#0x5c]
;;;3866   			inv[i]._phase_mode=bps[i+20]._buff[17];  
00343a  7dc0              LDRB     r0,[r0,#0x17]
00343c  f881005d          STRB     r0,[r1,#0x5d]
003440  e018              B        |L1.13428|
                  |L1.13378|
;;;3867        		} 
;;;3868   		else 
;;;3869        		{
;;;3870         		inv[i]._Ii=0;
003442  eb020042          ADD      r0,r2,r2,LSL #1
003446  eb061040          ADD      r0,r6,r0,LSL #5
00344a  61c3              STR      r3,[r0,#0x1c]
;;;3871   			inv[i]._Pio=0;
00344c  62c3              STR      r3,[r0,#0x2c]
;;;3872   			inv[i]._Uio=0;
00344e  6183              STR      r3,[r0,#0x18]
;;;3873        		inv[i]._Ti=0;
003450  6203              STR      r3,[r0,#0x20]
;;;3874        		inv[i]._flags_tm=0; 
003452  f8803046          STRB     r3,[r0,#0x46]
;;;3875        		inv[i]._Uil=0;
003456  6243              STR      r3,[r0,#0x24]
;;;3876        		inv[i]._Uin=0;
003458  6283              STR      r3,[r0,#0x28]
;;;3877   			inv[i]._cnt=25; 
00345a  f04f0119          MOV      r1,#0x19
00345e  7081              STRB     r1,[r0,#2]
;;;3878   			inv[i]._Uoutmin=0; 
003460  f8803059          STRB     r3,[r0,#0x59]
;;;3879   			inv[i]._Uoutmax=0; 
003464  f880305a          STRB     r3,[r0,#0x5a]
;;;3880   			inv[i]._Pnom=0; 
003468  f8803058          STRB     r3,[r0,#0x58]
;;;3881   			inv[i]._net_contr_en=0;
00346c  f880305b          STRB     r3,[r0,#0x5b]
;;;3882   			inv[i]._pwm_en=0;   
003470  f880305c          STRB     r3,[r0,#0x5c]
                  |L1.13428|
003474  f1020201          ADD      r2,r2,#1              ;3849
003478  b2d2              UXTB     r2,r2                 ;3849
                  |L1.13434|
00347a  42aa              CMP      r2,r5                 ;3849
00347c  db9c              BLT      |L1.13240|
                  |L1.13438|
;;;3883   			   
;;;3884        		}
;;;3885        	}
;;;3886      	}
;;;3887   #endif
;;;3888   
;;;3889   #ifdef GLADKOV
;;;3890   inv[0]._Ii=bps[4]._buff[0]+(bps[4]._buff[1]*256);
;;;3891   inv[0]._Pio=bps[4]._buff[2]+(bps[4]._buff[3]*256);
;;;3892   inv[0]._Uio=bps[4]._buff[4]+(bps[4]._buff[5]*256);
;;;3893   inv[0]._Ti=(signed)(bps[4]._buff[6]);
;;;3894   inv[0]._flags_tm=bps[4]._buff[7];
;;;3895   inv[0]._Uin=bps[4]._buff[8]+(bps[4]._buff[9]*256);
;;;3896   inv[0]._Uil=bps[4]._buff[10]+(bps[4]._buff[11]*256);
;;;3897   inv[0]._cnt=0;    
;;;3898   
;;;3899   inv[1]._Ii=bps[21]._buff[0]+(bps[21]._buff[1]*256);
;;;3900   inv[1]._Pio=bps[21]._buff[2]+(bps[21]._buff[3]*256);
;;;3901   inv[1]._Uio=bps[21]._buff[4]+(bps[21]._buff[5]*256);
;;;3902   inv[1]._Ti=(signed)(bps[21]._buff[6]);
;;;3903   inv[1]._flags_tm=bps[21]._buff[7];
;;;3904   inv[1]._Uin=bps[21]._buff[8]+(bps[21]._buff[9]*256);
;;;3905   inv[1]._Uil=bps[21]._buff[10]+(bps[21]._buff[11]*256);
;;;3906   inv[1]._cnt=0;    
;;;3907   #endif
;;;3908   
;;;3909   /*
;;;3910   if((BAT_IS_ON[0]==bisON)&&(BAT_TYPE==1))
;;;3911   	{
;;;3912   	lakb[0]._battCommState=0;
;;;3913   	if(lakb[0]._cnt>10)lakb[0]._battCommState=2;
;;;3914   	else if(lakb[0]._bRS485ERR==1)lakb[0]._battCommState=1;
;;;3915   	
;;;3916   	if(lakb[0]._battCommState==0)
;;;3917   		{	
;;;3918   		bat[0]._Ub=(signed short)((lakb[0]._tot_bat_volt+5)/10);
;;;3919   		bat[0]._Ib=(signed short)lakb[0]._ch_curr;
;;;3920   		if(lakb[0]._dsch_curr) bat[0]._Ib=(signed short) (-lakb[0]._dsch_curr);
;;;3921   		bat[0]._Tb=(signed short)lakb[0]._max_cell_temp;
;;;3922   		}
;;;3923   	}
;;;3924   */
;;;3925   
;;;3926   #ifdef UKU_FSO
;;;3927   
;;;3928   	//if(BAT_TYPE==2)
;;;3929   		//{
;;;3930   		lakb[0]._ch_curr=((ascii2halFhex(liBatteryInBuff[105]))<<12)+
;;;3931   					 		((ascii2halFhex(liBatteryInBuff[106]))<<8)+
;;;3932   							((ascii2halFhex(liBatteryInBuff[107]))<<4)+
;;;3933   							((ascii2halFhex(liBatteryInBuff[108])));
;;;3934   		
;;;3935   		/*if(temp_SS&0x8000)		lakb[0]._ch_curr=~temp_SS;
;;;3936   		else 				lakb[0]._ch_curr=temp_SS;*/
;;;3937   	
;;;3938   		lakb[0]._tot_bat_volt=	(unsigned short)(((ascii2halFhex(liBatteryInBuff[109]))<<12)+
;;;3939   							((ascii2halFhex(liBatteryInBuff[110]))<<8)+
;;;3940   							((ascii2halFhex(liBatteryInBuff[111]))<<4)+
;;;3941   							((ascii2halFhex(liBatteryInBuff[112]))))/10;
;;;3942   
;;;3943   
;;;3944   		lakb[0]._cell_temp_1= (signed char)((((ascii2halFhex(liBatteryInBuff[81]))<<12)+
;;;3945   							((ascii2halFhex(liBatteryInBuff[82]))<<8)+
;;;3946   							((ascii2halFhex(liBatteryInBuff[83]))<<4)+
;;;3947   							((ascii2halFhex(liBatteryInBuff[84]))))/100);
;;;3948   		lakb[0]._cell_temp_2= (signed char)((((ascii2halFhex(liBatteryInBuff[85]))<<12)+
;;;3949   							((ascii2halFhex(liBatteryInBuff[86]))<<8)+
;;;3950   							((ascii2halFhex(liBatteryInBuff[87]))<<4)+
;;;3951   							((ascii2halFhex(liBatteryInBuff[88]))))/100);
;;;3952   		lakb[0]._cell_temp_3= (signed char)((((ascii2halFhex(liBatteryInBuff[89]))<<12)+
;;;3953   							((ascii2halFhex(liBatteryInBuff[90]))<<8)+
;;;3954   							((ascii2halFhex(liBatteryInBuff[91]))<<4)+
;;;3955   							((ascii2halFhex(liBatteryInBuff[92]))))/100);
;;;3956   		lakb[0]._cell_temp_4= (signed char)((((ascii2halFhex(liBatteryInBuff[93]))<<12)+
;;;3957   							((ascii2halFhex(liBatteryInBuff[94]))<<8)+
;;;3958   							((ascii2halFhex(liBatteryInBuff[95]))<<4)+
;;;3959   							((ascii2halFhex(liBatteryInBuff[96]))))/100);
;;;3960   		lakb[0]._cell_temp_ambient= (signed char)((((ascii2halFhex(liBatteryInBuff[97]))<<12)+
;;;3961   							((ascii2halFhex(liBatteryInBuff[98]))<<8)+
;;;3962   							((ascii2halFhex(liBatteryInBuff[99]))<<4)+
;;;3963   							((ascii2halFhex(liBatteryInBuff[100]))))/100);
;;;3964   		lakb[0]._cell_temp_power= (signed char)((((ascii2halFhex(liBatteryInBuff[101]))<<12)+
;;;3965   							((ascii2halFhex(liBatteryInBuff[102]))<<8)+
;;;3966   							((ascii2halFhex(liBatteryInBuff[103]))<<4)+
;;;3967   							((ascii2halFhex(liBatteryInBuff[104]))))/100);
;;;3968   			//int2lcd_mmm(lakb[sub_ind1]._cell_temp_ambient,'[',0);
;;;3969   			//int2lcd_mmm(lakb[sub_ind1]._cell_temp_power,']',0);
;;;3970   	
;;;3971   /*		lakb[0]._max_cell_temp= 	(((ascii2halFhex(liBatteryInBuff[93]))<<12)+
;;;3972   							((ascii2halFhex(liBatteryInBuff[94]))<<8)+
;;;3973   							((ascii2halFhex(liBatteryInBuff[95]))<<4)+
;;;3974   							((ascii2halFhex(liBatteryInBuff[96]))))/10-273;	*/
;;;3975   	
;;;3976   		lakb[0]._s_o_c=		(unsigned short)((ascii2halFhex(liBatteryInBuff[113]))<<12)+
;;;3977   							((ascii2halFhex(liBatteryInBuff[114]))<<8)+
;;;3978   							((ascii2halFhex(liBatteryInBuff[115]))<<4)+
;;;3979   							((ascii2halFhex(liBatteryInBuff[116])));
;;;3980   	
;;;3981   		lakb[0]._s_o_h=		(unsigned short)((ascii2halFhex(liBatteryInBuff[119]))<<12)+
;;;3982   							((ascii2halFhex(liBatteryInBuff[120]))<<8)+
;;;3983   							((ascii2halFhex(liBatteryInBuff[121]))<<4)+
;;;3984   							((ascii2halFhex(liBatteryInBuff[122])));
;;;3985   
;;;3986   		if(lakb[0]._s_o_h==0)lakb[0]._s_o_h=1;
;;;3987   
;;;3988   		temp_SL=((signed long)lakb[0]._s_o_c)*100L;
;;;3989   		temp_SL/=(signed long)lakb[0]._s_o_h;
;;;3990   		lakb[0]._s_o_c_percent=(signed short)temp_SL;
;;;3991   			
;;;3992   
;;;3993   		lakb[0]._rat_cap=		(unsigned short)((ascii2halFhex(liBatteryInBuff[127]))<<12)+
;;;3994   							((ascii2halFhex(liBatteryInBuff[128]))<<8)+
;;;3995   							((ascii2halFhex(liBatteryInBuff[129]))<<4)+
;;;3996   							((ascii2halFhex(liBatteryInBuff[130])));
;;;3997   	
;;;3998   		//lakb[0]._s_o_c=		lakb[0]._s_o_c_abs/(lakb[0]._rat_cap/100);
;;;3999   
;;;4000   
;;;4001   
;;;4002   
;;;4003   //Внешний датчик температуры 
;;;4004   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[0]=0;
;;;4005   else ND_EXT[0]=1;
;;;4006   temp_SL=(signed long)adc_buff_[6];
;;;4007   temp_SL*=Ktext[0];
;;;4008   temp_SL/=20000L;
;;;4009   temp_SL-=273L;
;;;4010   t_ext[0]=(signed short)temp_SL;
;;;4011   
;;;4012   
;;;4013   	
;;;4014   #endif //UKU_FSO	
;;;4015   
;;;4016   
;;;4017   
;;;4018   #ifdef UKU_TELECORE2015
;;;4019   
;;;4020   	if(BAT_TYPE==2)
;;;4021   		{
;;;4022   		lakb[0]._ch_curr/*temp_SS*/=((ascii2halFhex(liBatteryInBuff[113]))<<12)+
;;;4023   					 		((ascii2halFhex(liBatteryInBuff[114]))<<8)+
;;;4024   							((ascii2halFhex(liBatteryInBuff[115]))<<4)+
;;;4025   							((ascii2halFhex(liBatteryInBuff[116])));
;;;4026   		
;;;4027   		/*if(temp_SS&0x8000)		lakb[0]._ch_curr=~temp_SS;
;;;4028   		else 				lakb[0]._ch_curr=temp_SS;*/
;;;4029   	
;;;4030   		lakb[0]._tot_bat_volt=	(unsigned short)(((ascii2halFhex(liBatteryInBuff[117]))<<12)+
;;;4031   							((ascii2halFhex(liBatteryInBuff[118]))<<8)+
;;;4032   							((ascii2halFhex(liBatteryInBuff[119]))<<4)+
;;;4033   							((ascii2halFhex(liBatteryInBuff[120]))))/100;
;;;4034   	
;;;4035   		lakb[0]._max_cell_temp= 	(((ascii2halFhex(liBatteryInBuff[93]))<<12)+
;;;4036   							((ascii2halFhex(liBatteryInBuff[94]))<<8)+
;;;4037   							((ascii2halFhex(liBatteryInBuff[95]))<<4)+
;;;4038   							((ascii2halFhex(liBatteryInBuff[96]))))/10-273;
;;;4039   	
;;;4040   		lakb[0]._s_o_c_abs=		(unsigned short)((ascii2halFhex(liBatteryInBuff[121]))<<12)+
;;;4041   							((ascii2halFhex(liBatteryInBuff[122]))<<8)+
;;;4042   							((ascii2halFhex(liBatteryInBuff[123]))<<4)+
;;;4043   							((ascii2halFhex(liBatteryInBuff[124])));
;;;4044   	
;;;4045   		lakb[0]._rat_cap=		(unsigned short)((ascii2halFhex(liBatteryInBuff[127]))<<12)+
;;;4046   							((ascii2halFhex(liBatteryInBuff[128]))<<8)+
;;;4047   							((ascii2halFhex(liBatteryInBuff[129]))<<4)+
;;;4048   							((ascii2halFhex(liBatteryInBuff[130])));
;;;4049   	
;;;4050   		lakb[0]._s_o_c=		lakb[0]._s_o_c_abs/(lakb[0]._rat_cap/100);
;;;4051   	
;;;4052   	
;;;4053   	/*	lakb[0]._rat_cap= (lakb_damp[i][13]*256)+ lakb_damp[i][14];
;;;4054   		lakb[0]._max_cell_volt= (lakb_damp[i][0]*256)+ lakb_damp[i][1];
;;;4055   		lakb[0]._min_cell_volt= (lakb_damp[i][2]*256)+ lakb_damp[i][3];
;;;4056   		lakb[0]._max_cell_temp= lakb_damp[i][4];
;;;4057   		lakb[0]._min_cell_temp= lakb_damp[i][5];
;;;4058   		lakb[0]._tot_bat_volt= (lakb_damp[i][6]*256)+ lakb_damp[i][7];
;;;4059   		lakb[0]._ch_curr= (lakb_damp[i][8]*256)+ lakb_damp[i][8];
;;;4060   		lakb[0]._dsch_curr= (lakb_damp[i][10]*256)+ lakb_damp[i][11];
;;;4061   		lakb[0]._s_o_c= lakb_damp[i][12];
;;;4062   		lakb[0]._r_b_t= lakb_damp[i][15];
;;;4063   		lakb[0]._c_c_l_v= (lakb_damp[i][16]*256)+ lakb_damp[i][17];
;;;4064   		lakb[0]._s_o_h= lakb_damp[i][18];
;;;4065   	
;;;4066   		if(lakb[i]._rat_cap==0)
;;;4067   			{
;;;4068   			if(lakb[i]._isOnCnt)
;;;4069   				{
;;;4070   				lakb[i]._isOnCnt--;
;;;4071   				if(lakb[i]._isOnCnt==0)
;;;4072   					{
;;;4073   					if(lakb[i]._battIsOn!=0) bLAKB_KONF_CH=1;
;;;4074   					}
;;;4075   				}
;;;4076   			}
;;;4077   		else 
;;;4078   			{
;;;4079   			if(lakb[i]._isOnCnt<50)
;;;4080   				{
;;;4081   				lakb[i]._isOnCnt++;
;;;4082   				if(lakb[i]._isOnCnt==50)
;;;4083   					{
;;;4084   					if(lakb[i]._battIsOn!=1) bLAKB_KONF_CH=1;
;;;4085   					}
;;;4086   				}
;;;4087   			}
;;;4088   		gran(&lakb[i]._isOnCnt,0,50);*/
;;;4089   		}
;;;4090   	else if(BAT_TYPE==3)
;;;4091   		{
;;;4092   		//short numOfPacks;
;;;4093   		//short numOfCells, numOfTemperCells, baseOfData;
;;;4094   		
;;;4095   		#ifndef UKU_TELECORE2016
;;;4096   		numOfCells=((ascii2halFhex(liBatteryInBuff[17]))<<4)+((ascii2halFhex(liBatteryInBuff[18])));
;;;4097   		numOfTemperCells=((ascii2halFhex(liBatteryInBuff[17+(numOfCells*4)+2]))<<4)+((ascii2halFhex(liBatteryInBuff[18+(numOfCells*4)+2])));
;;;4098   		numOfPacks=((ascii2halFhex(liBatteryInBuff[15]))<<4)+((ascii2halFhex(liBatteryInBuff[16])));
;;;4099   		if(numOfPacks)numOfPacks-=1;
;;;4100   		if((numOfPacks<0)||(numOfPacks>NUMBAT_TELECORE))numOfPacks=0;
;;;4101   		plazma_numOfCells=numOfCells;
;;;4102   		plazma_numOfTemperCells=numOfTemperCells;
;;;4103   		plazma_numOfPacks=numOfPacks;
;;;4104   
;;;4105   
;;;4106   		baseOfData=16+(numOfCells*4)+2+(numOfTemperCells*4)+2;
;;;4107   
;;;4108   		lakb[numOfPacks]._ch_curr=(signed short)(
;;;4109   							((ascii2halFhex(liBatteryInBuff[1+baseOfData]))<<12)+
;;;4110   							((ascii2halFhex(liBatteryInBuff[2+baseOfData]))<<8)+
;;;4111   							((ascii2halFhex(liBatteryInBuff[3+baseOfData]))<<4)+
;;;4112   							((ascii2halFhex(liBatteryInBuff[4+baseOfData])))
;;;4113   							);	  
;;;4114   
;;;4115   		lakb[numOfPacks]._tot_bat_volt=(signed short)(
;;;4116   							((ascii2halFhex(liBatteryInBuff[1+baseOfData+4]))<<12)+
;;;4117   							((ascii2halFhex(liBatteryInBuff[2+baseOfData+4]))<<8)+
;;;4118   							((ascii2halFhex(liBatteryInBuff[3+baseOfData+4]))<<4)+
;;;4119   							((ascii2halFhex(liBatteryInBuff[4+baseOfData+4])))
;;;4120   							)/10;
;;;4121   
;;;4122   		lakb[numOfPacks]._max_cell_temp=(signed short)(
;;;4123   							((ascii2halFhex(liBatteryInBuff[1+baseOfData-4]))<<12)+
;;;4124   							((ascii2halFhex(liBatteryInBuff[2+baseOfData-4]))<<8)+
;;;4125   							((ascii2halFhex(liBatteryInBuff[3+baseOfData-4]))<<4)+
;;;4126   							((ascii2halFhex(liBatteryInBuff[4+baseOfData-4])))
;;;4127   							)-2730;
;;;4128   
;;;4129   		lakb[numOfPacks]._s_o_c=(signed short)(
;;;4130   							((ascii2halFhex(liBatteryInBuff[1+baseOfData+8]))<<12)+
;;;4131   							((ascii2halFhex(liBatteryInBuff[2+baseOfData+8]))<<8)+
;;;4132   							((ascii2halFhex(liBatteryInBuff[3+baseOfData+8]))<<4)+
;;;4133   							((ascii2halFhex(liBatteryInBuff[4+baseOfData+8])))
;;;4134   							)/10;
;;;4135   
;;;4136   		lakb[numOfPacks]._s_o_h=(signed short)(
;;;4137   							((ascii2halFhex(liBatteryInBuff[1+baseOfData+14]))<<12)+
;;;4138   							((ascii2halFhex(liBatteryInBuff[2+baseOfData+14]))<<8)+
;;;4139   							((ascii2halFhex(liBatteryInBuff[3+baseOfData+14]))<<4)+
;;;4140   							((ascii2halFhex(liBatteryInBuff[4+baseOfData+14])))
;;;4141   							)/10;
;;;4142   		#endif
;;;4143   		
;;;4144   		#ifdef UKU_TELECORE2016
;;;4145   		{
;;;4146   		char i;
;;;4147   		
;;;4148   		for(i=0;i<NUMBAT_TELECORE;i++)
;;;4149   			{
;;;4150   			lakb[i]._s_o_c_percent= (signed short)(((unsigned long)lakb[i]._s_o_c*100UL)/(unsigned long)lakb[i]._s_o_h);
;;;4151   			}
;;;4152   		}
;;;4153   		#endif
;;;4154   		
;;;4155   										  
;;;4156   		}
;;;4157   	
;;;4158   if(sacredSunSilentCnt<3) 
;;;4159   	{
;;;4160       	bat[0]._Ub=lakb[0]._tot_bat_volt;
;;;4161       	bat[0]._Tb=lakb[0]._max_cell_temp;
;;;4162      	//bat[0]._Ib=lakb[0]._ch_curr/10;
;;;4163   	}
;;;4164   else 
;;;4165   	{
;;;4166       	//bat[0]._Ub=0;
;;;4167       	//bat[0]._Tb=0;
;;;4168      	//bat[0]._Ib=0;
;;;4169   	}
;;;4170   
;;;4171   if(BAT_TYPE==1)
;;;4172   	{
;;;4173   	char i;
;;;4174   	for(i=0;i<1;i++)
;;;4175   		{
;;;4176   		lakb[i]._rat_cap= (lakb_damp[i][13]*256)+ lakb_damp[i][14];
;;;4177   		lakb[i]._max_cell_volt= (lakb_damp[i][0]*256)+ lakb_damp[i][1];
;;;4178   		lakb[i]._min_cell_volt= (lakb_damp[i][2]*256)+ lakb_damp[i][3];
;;;4179   		lakb[i]._max_cell_temp= lakb_damp[i][4];
;;;4180   		lakb[i]._min_cell_temp= lakb_damp[i][5];
;;;4181   		lakb[i]._tot_bat_volt= (lakb_damp[i][6]*256)+ lakb_damp[i][7];
;;;4182   		lakb[i]._ch_curr= (lakb_damp[i][8]*256)+ lakb_damp[i][9];
;;;4183   		lakb[i]._dsch_curr= (lakb_damp[i][10]*256)+ lakb_damp[i][11];
;;;4184   		lakb[i]._s_o_c= lakb_damp[i][12];
;;;4185   		lakb[i]._r_b_t= lakb_damp[i][15];
;;;4186   		lakb[i]._c_c_l_v= (lakb_damp[i][16]*256)+ lakb_damp[i][17];
;;;4187   		lakb[i]._s_o_h= lakb_damp[i][18];
;;;4188   		lakb[i]._flags1= lakb_damp[i][34];
;;;4189   		lakb[i]._flags2= lakb_damp[i][35];
;;;4190   		lakb[i]._b_p_ser_num= lakb_damp[i][36];
;;;4191   
;;;4192   /*		if(lakb[i]._rat_cap==0)
;;;4193   			{
;;;4194   			if(lakb[i]._isOnCnt)
;;;4195   				{
;;;4196   				lakb[i]._isOnCnt--;
;;;4197   				if(lakb[i]._isOnCnt==0)
;;;4198   					{
;;;4199   					if(lakb[i]._battIsOn!=0) bLAKB_KONF_CH=1;
;;;4200   					}
;;;4201   				}
;;;4202   			}
;;;4203   		else 
;;;4204   			{
;;;4205   			if(lakb[i]._isOnCnt<50)
;;;4206   				{
;;;4207   				lakb[i]._isOnCnt++;
;;;4208   				if(lakb[i]._isOnCnt==50)
;;;4209   					{
;;;4210   					if(lakb[i]._battIsOn!=1) bLAKB_KONF_CH=1;
;;;4211   					}
;;;4212   				}
;;;4213   			} */
;;;4214   		gran(&lakb[i]._isOnCnt,0,50);
;;;4215   	 	}
;;;4216   
;;;4217   	if(lakb_damp[0][41]==100)
;;;4218   		{
;;;4219   		li_bat._485Error=1;
;;;4220   		}
;;;4221   	if(lakb_damp[0][41]==0)
;;;4222   		{
;;;4223   		//if(bRS485ERR)bLAKB_KONF_CH=1;
;;;4224   		li_bat._485Error=0;
;;;4225   		}
;;;4226   	li_bat._485ErrorCnt=lakb_damp[0][41];
;;;4227   
;;;4228   
;;;4229   	}
;;;4230   
;;;4231   
;;;4232   #endif
;;;4233   
;;;4234   		#ifdef UKU_TELECORE2017
;;;4235   		{
;;;4236   		char i;
;;;4237   		
;;;4238   		for(i=0;i<NUMBAT_TELECORE;i++)
;;;4239   			{
;;;4240   			lakb[i]._s_o_c_percent= (signed short)(((unsigned long)lakb[i]._s_o_c*100UL)/(unsigned long)lakb[i]._s_o_h);
;;;4241   			}
;;;4242   		}
;;;4243   		#endif
;;;4244   #ifdef UKU_TELECORE2015
;;;4245   //вычисление параметров работы батареи
;;;4246   //TODO дописать для всех батарей все параметры и при отцепке батарей
;;;4247   li_bat._batStat=bsOK;
;;;4248   if(BAT_TYPE==1) //COSLIGHT
;;;4249   	{
;;;4250   	if(li_bat._batStat==bsOK)
;;;4251   		{
;;;4252   		li_bat._Ub=lakb[0]._tot_bat_volt/10;
;;;4253   
;;;4254   		if(lakb[0]._ch_curr)li_bat._Ib=lakb[0]._ch_curr/10;
;;;4255   		else if(lakb[0]._dsch_curr) li_bat._Ib=bat[0]._Ib/10;//lakb[0]._dsch_curr/10;
;;;4256   	
;;;4257   		li_bat._ratCap=lakb[0]._rat_cap/100;
;;;4258   		li_bat._soc=lakb[0]._s_o_c;
;;;4259   		li_bat._soh=lakb[0]._s_o_h;
;;;4260   		li_bat._cclv=lakb[0]._c_c_l_v/10;
;;;4261   		li_bat._Tb=lakb[0]._max_cell_temp;
;;;4262   		li_bat._rbt=lakb[0]._r_b_t;
;;;4263   		}
;;;4264   	else 
;;;4265   		{
;;;4266   		li_bat._Ub=bat[0]._Ub;
;;;4267   		li_bat._Ib=bat[0]._Ib/10;
;;;4268   		li_bat._Tb=bat[0]._Tb;
;;;4269   		}
;;;4270   
;;;4271   	if((li_bat._485Error)||(li_bat._canError))
;;;4272   		{
;;;4273   		li_bat._batStat=bsOFF;
;;;4274   		}
;;;4275   	else li_bat._batStat=bsOK;
;;;4276   	}
;;;4277   else if(BAT_TYPE==2) //SACRED SUN
;;;4278   	{
;;;4279   	}
;;;4280   else if(BAT_TYPE==3) //ZTT
;;;4281   	{
;;;4282   	if(li_bat._batStat==bsOK)
;;;4283   		{
;;;4284   
;;;4285   		}
;;;4286   	}
;;;4287   #endif
;;;4288   
;;;4289   
;;;4290   /*
;;;4291   if((BAT_IS_ON[0]==bisON)&&(BAT_TYPE[0]==1)&&(BAT_LINK==0))
;;;4292   	{
;;;4293   
;;;4294   
;;;4295   	if(bat_drv_rx_buff[13]<=0x39)bbb[0]=bat_drv_rx_buff[13]-0x30;
;;;4296   	else bbb[0]=bat_drv_rx_buff[13]-55;
;;;4297   	if(bat_drv_rx_buff[14]<=0x39)bbb[1]=bat_drv_rx_buff[14]-0x30;
;;;4298   	else bbb[1]=bat_drv_rx_buff[14]-55;
;;;4299   	if(bat_drv_rx_buff[15]<=0x39)bbb[2]=bat_drv_rx_buff[15]-0x30;
;;;4300   	else bbb[2]=bat_drv_rx_buff[15]-55;
;;;4301   	if(bat_drv_rx_buff[16]<=0x39)bbb[3]=bat_drv_rx_buff[16]-0x30;
;;;4302   	else bbb[3]=bat_drv_rx_buff[16]-55;
;;;4303   
;;;4304   	tempSS=0;
;;;4305   	tempSS=((bbb[0]*4096)+(bbb[1]*256)+(bbb[2]*16)+bbb[3]);
;;;4306   
;;;4307   	bat[0]._max_cell_volt=(tempSS+5)/10;
;;;4308   
;;;4309   	if(bat_drv_rx_buff[17]<=0x39)bbb[0]=bat_drv_rx_buff[17]-0x30;
;;;4310   	else bbb[0]=bat_drv_rx_buff[17]-55;
;;;4311   	if(bat_drv_rx_buff[18]<=0x39)bbb[1]=bat_drv_rx_buff[18]-0x30;
;;;4312   	else bbb[1]=bat_drv_rx_buff[18]-55;
;;;4313   	if(bat_drv_rx_buff[19]<=0x39)bbb[2]=bat_drv_rx_buff[19]-0x30;
;;;4314   	else bbb[2]=bat_drv_rx_buff[19]-55;
;;;4315   	if(bat_drv_rx_buff[20]<=0x39)bbb[3]=bat_drv_rx_buff[20]-0x30;
;;;4316   	else bbb[3]=bat_drv_rx_buff[20]-55;
;;;4317   
;;;4318   	tempSS=0;
;;;4319   	tempSS=((bbb[0]*4096)+(bbb[1]*256)+(bbb[2]*16)+bbb[3]);
;;;4320   
;;;4321   	bat[0]._min_cell_volt=(tempSS+5)/10;
;;;4322   
;;;4323   
;;;4324   	}*/
;;;4325   }
00347e  e8bd9fff          POP      {r0-r12,pc}
003482  0000              DCW      0x0000
                  |L1.13444|
                          DCD      Kibat1
                  |L1.13448|
                          DCD      Ib_ips_termokompensat_temp
                  |L1.13452|
                          DCD      bat
                  |L1.13456|
                          DCD      adc_buff_ext_
                  |L1.13460|
                          DCD      Kunet_ext
                  |L1.13464|
                          DCD      Uvv
                  |L1.13468|
                          DCD      Uvv0
                  |L1.13472|
                          DCD      net_U
                  |L1.13476|
                          DCD      eb2_data_short
                  |L1.13480|
                          DCD      Kvv_eb2
                  |L1.13484|
                          DCD      Uvv_eb2
                  |L1.13488|
                          DCD      Kpes_eb2
                  |L1.13492|
                          DCD      Upes_eb2
                  |L1.13496|
                          DCD      t_ext
                  |L1.13500|
                          DCD      ibt
                  |L1.13504|
                          DCD      t_box
                  |L1.13508|
                          DCD      t_ext_can_nd
                  |L1.13512|
                          DCD      t_ext_can
                  |L1.13516|
                          DCD      BAT_IS_ON
                  |L1.13520|
                          DCD      load_I
                  |L1.13524|
                          DCD      Isumm
                  |L1.13528|
                          DCD      NUMINV
                  |L1.13532|
                          DCD      inv
                          ENDP

                  mnemo_hndl PROC
;;;4386   //-----------------------------------------------
;;;4387   void mnemo_hndl(void)
0034e0  4afb              LDR      r2,|L1.14544|
;;;4388   {
;;;4389   if(((ind==iMn_220)||(ind==iMn))&&(sub_ind==0)&&(MNEMO_ON==mnON))
;;;4390   	{
;;;4391   	if(mnemo_cnt)mnemo_cnt--;
0034e2  49fc              LDR      r1,|L1.14548|
0034e4  7810              LDRB     r0,[r2,#0]            ;4389  ; a_ind
0034e6  2804              CMP      r0,#4                 ;4389
0034e8  d001              BEQ      |L1.13550|
0034ea  2801              CMP      r0,#1                 ;4389
0034ec  d105              BNE      |L1.13562|
                  |L1.13550|
0034ee  7850              LDRB     r0,[r2,#1]            ;4389  ; a_ind
0034f0  b918              CBNZ     r0,|L1.13562|
0034f2  48f9              LDR      r0,|L1.14552|
0034f4  7800              LDRB     r0,[r0,#0]            ;4389  ; MNEMO_ON
0034f6  2855              CMP      r0,#0x55              ;4389
0034f8  d003              BEQ      |L1.13570|
                  |L1.13562|
;;;4392   	}
;;;4393   else mnemo_cnt=MNEMO_TIME;
0034fa  48f8              LDR      r0,|L1.14556|
0034fc  8800              LDRH     r0,[r0,#0]  ; MNEMO_TIME
0034fe  7008              STRB     r0,[r1,#0]
                  |L1.13568|
;;;4394   }
003500  4770              BX       lr
                  |L1.13570|
003502  7808              LDRB     r0,[r1,#0]            ;4391  ; mnemo_cnt
003504  2800              CMP      r0,#0                 ;4391
003506  d0fb              BEQ      |L1.13568|
003508  f1a00001          SUB      r0,r0,#1              ;4391
00350c  7008              STRB     r0,[r1,#0]            ;4391
00350e  4770              BX       lr
;;;4395   
                          ENDP

                  apv_start PROC
;;;4396   //-----------------------------------------------
;;;4397   void apv_start(char in)
003510  eb0001c0          ADD      r1,r0,r0,LSL #3
;;;4398   {
;;;4399   if(	(bps[in]._apv_timer_1_lev==0)&&
003514  eb011100          ADD      r1,r1,r0,LSL #4
003518  48f1              LDR      r0,|L1.14560|
00351a  eb000081          ADD      r0,r0,r1,LSL #2
00351e  f890105e          LDRB     r1,[r0,#0x5e]
003522  2900              CMP      r1,#0
003524  d115              BNE      |L1.13650|
;;;4400   	(bps[in]._apv_cnt_1_lev==0)&&
003526  f890105f          LDRB     r1,[r0,#0x5f]
00352a  2900              CMP      r1,#0
00352c  d111              BNE      |L1.13650|
;;;4401   	(bps[in]._apv_timer_2_lev==0) )
00352e  f8b01060          LDRH     r1,[r0,#0x60]
003532  2900              CMP      r1,#0
003534  d10d              BNE      |L1.13650|
;;;4402   		{
;;;4403    		bps[in]._apv_timer_1_lev=60;
003536  f04f013c          MOV      r1,#0x3c
00353a  f8001f5e          STRB     r1,[r0,#0x5e]!
;;;4404   		bps[in]._apv_cnt_1_lev=3;
00353e  f04f0103          MOV      r1,#3
003542  7041              STRB     r1,[r0,#1]
;;;4405   		bps[in]._apv_timer_2_lev=(short)(APV_ON2_TIME*3600);
003544  49e7              LDR      r1,|L1.14564|
003546  f44f6261          MOV      r2,#0xe10
00354a  8809              LDRH     r1,[r1,#0]  ; APV_ON2_TIME
00354c  fb01f102          MUL      r1,r1,r2
003550  8041              STRH     r1,[r0,#2]
                  |L1.13650|
;;;4406   		}
;;;4407   }
003552  4770              BX       lr
;;;4408   
                          ENDP

                  apv_stop PROC
;;;4409   //-----------------------------------------------
;;;4410   void apv_stop(char in)
003554  eb0002c0          ADD      r2,r0,r0,LSL #3
;;;4411   {
;;;4412   bps[in]._apv_timer_1_lev=0;
003558  eb021200          ADD      r2,r2,r0,LSL #4
00355c  48e0              LDR      r0,|L1.14560|
00355e  f04f0100          MOV      r1,#0
003562  eb000082          ADD      r0,r0,r2,LSL #2
003566  f8001f5e          STRB     r1,[r0,#0x5e]!
;;;4413   bps[in]._apv_cnt_1_lev=0;
00356a  7041              STRB     r1,[r0,#1]
;;;4414   bps[in]._apv_timer_2_lev=0;
00356c  8041              STRH     r1,[r0,#2]
;;;4415   }
00356e  4770              BX       lr
;;;4416   
                          ENDP

                  apv_drv PROC
;;;4417   //-----------------------------------------------
;;;4418   void apv_drv(void)		//1 Гц
003570  e92d43f0          PUSH     {r4-r9,lr}
;;;4419   {
;;;4420   for(i=0;i<NUMIST;i++)
003574  4edc              LDR      r6,|L1.14568|
003576  f04f0300          MOV      r3,#0
00357a  75f3              STRB     r3,[r6,#0x17]
;;;4421   	{
;;;4422   	if(APV_ON1==apvOFF)		//если выключен первый уровень АПВ
;;;4423   		{
;;;4424   		bps[i]._apv_timer_1_lev=0;
;;;4425   		bps[i]._apv_cnt_1_lev=0;
;;;4426   		bps[i]._apv_timer_2_lev=0;
;;;4427   		}
;;;4428   	if(APV_ON2==apvOFF)	   //если выключен второй уровень АПВ
00357c  4cdb              LDR      r4,|L1.14572|
;;;4429   		{
;;;4430   		bps[i]._apv_timer_2_lev=0;
;;;4431   		}
;;;4432   
;;;4433   	if(	(bps[i]._apv_timer_1_lev!=0)||	//если работает АПВ-1 или
;;;4434   		(bps[i]._apv_cnt_1_lev!=0)||	//работает АПВ-1 или
;;;4435   		(bps[i]._apv_timer_2_lev!=0) )		 //работает АПВ-2
;;;4436   			{
;;;4437   			if(bps[i]._state==bsWRK)
;;;4438   				{
;;;4439   				if(bps[i]._apv_succes_timer<60)
;;;4440   					{
;;;4441   					bps[i]._apv_succes_timer++;
;;;4442   					if(bps[i]._apv_succes_timer>=60)
;;;4443   						{
;;;4444   						apv_stop(i);
;;;4445   						}
;;;4446   					}
;;;4447   				}
;;;4448   			else bps[i]._apv_succes_timer=0;
;;;4449   			}
;;;4450   
;;;4451   	if(bps[i]._apv_timer_1_lev)
;;;4452   		{
;;;4453   		bps[i]._apv_timer_2_lev=0;
;;;4454   		bps[i]._apv_timer_1_lev--;
;;;4455   		if(bps[i]._apv_timer_1_lev==0)
;;;4456   			{
;;;4457   			if(bps[i]._apv_cnt_1_lev)
;;;4458   				{
;;;4459   				bps[i]._apv_cnt_1_lev--;
;;;4460   				bps[i]._apv_timer_1_lev=60;
00357e  f04f073c          MOV      r7,#0x3c
;;;4461   				bps[i]._apv_reset_av_timer=2;
003582  f04f0802          MOV      r8,#2
003586  4dd6              LDR      r5,|L1.14560|
003588  f8df9364          LDR      r9,|L1.14576|
00358c  e079              B        |L1.13954|
                  |L1.13710|
00358e  49d9              LDR      r1,|L1.14580|
003590  7809              LDRB     r1,[r1,#0]            ;4422  ; APV_ON1
003592  b949              CBNZ     r1,|L1.13736|
003594  eb0001c0          ADD      r1,r0,r0,LSL #3       ;4424
003598  eb011100          ADD      r1,r1,r0,LSL #4       ;4424
00359c  eb050181          ADD      r1,r5,r1,LSL #2       ;4424
0035a0  f8013f5e          STRB     r3,[r1,#0x5e]!        ;4424
0035a4  704b              STRB     r3,[r1,#1]            ;4425
0035a6  804b              STRH     r3,[r1,#2]            ;4426
                  |L1.13736|
0035a8  7821              LDRB     r1,[r4,#0]            ;4428  ; APV_ON2
0035aa  b939              CBNZ     r1,|L1.13756|
0035ac  eb0001c0          ADD      r1,r0,r0,LSL #3       ;4430
0035b0  eb011100          ADD      r1,r1,r0,LSL #4       ;4430
0035b4  eb050181          ADD      r1,r5,r1,LSL #2       ;4430
0035b8  f8a13060          STRH     r3,[r1,#0x60]         ;4430
                  |L1.13756|
0035bc  eb0001c0          ADD      r1,r0,r0,LSL #3       ;4433
0035c0  eb011100          ADD      r1,r1,r0,LSL #4       ;4433
0035c4  eb050181          ADD      r1,r5,r1,LSL #2       ;4433
0035c8  f891205e          LDRB     r2,[r1,#0x5e]         ;4433
0035cc  b92a              CBNZ     r2,|L1.13786|
0035ce  f891205f          LDRB     r2,[r1,#0x5f]         ;4434
0035d2  b912              CBNZ     r2,|L1.13786|
0035d4  f8b12060          LDRH     r2,[r1,#0x60]         ;4435
0035d8  b122              CBZ      r2,|L1.13796|
                  |L1.13786|
0035da  788a              LDRB     r2,[r1,#2]            ;4437
0035dc  2a01              CMP      r2,#1                 ;4437
0035de  d014              BEQ      |L1.13834|
0035e0  f8813063          STRB     r3,[r1,#0x63]         ;4448
                  |L1.13796|
0035e4  7df1              LDRB     r1,[r6,#0x17]         ;4451  ; i
0035e6  eb0100c1          ADD      r0,r1,r1,LSL #3       ;4451
0035ea  eb001001          ADD      r0,r0,r1,LSL #4       ;4451
0035ee  eb050080          ADD      r0,r5,r0,LSL #2       ;4451
0035f2  f890205e          LDRB     r2,[r0,#0x5e]         ;4451
0035f6  b30a              CBZ      r2,|L1.13884|
0035f8  f8a03060          STRH     r3,[r0,#0x60]         ;4453
0035fc  f1a20201          SUB      r2,r2,#1              ;4454
003600  b2d2              UXTB     r2,r2                 ;4454
003602  f880205e          STRB     r2,[r0,#0x5e]         ;4454
003606  b172              CBZ      r2,|L1.13862|
003608  e024              B        |L1.13908|
                  |L1.13834|
00360a  f8912063          LDRB     r2,[r1,#0x63]         ;4439
00360e  2a3c              CMP      r2,#0x3c              ;4439
003610  d2e8              BCS      |L1.13796|
003612  f1020201          ADD      r2,r2,#1              ;4441
003616  b2d2              UXTB     r2,r2                 ;4441
003618  f8812063          STRB     r2,[r1,#0x63]         ;4441
00361c  2a3c              CMP      r2,#0x3c              ;4442
00361e  d3e1              BCC      |L1.13796|
003620  f7fffffe          BL       apv_stop
003624  e7de              B        |L1.13796|
                  |L1.13862|
003626  f890205f          LDRB     r2,[r0,#0x5f]         ;4457
00362a  b142              CBZ      r2,|L1.13886|
00362c  f1a20201          SUB      r2,r2,#1              ;4459
003630  f880205f          STRB     r2,[r0,#0x5f]         ;4459
003634  f880705e          STRB     r7,[r0,#0x5e]         ;4460
003638  f8808062          STRB     r8,[r0,#0x62]
                  |L1.13884|
00363c  e00a              B        |L1.13908|
                  |L1.13886|
;;;4462   				}
;;;4463   			else
;;;4464   				{
;;;4465   				if(APV_ON2==apvON)
00363e  7822              LDRB     r2,[r4,#0]  ; APV_ON2
003640  2a01              CMP      r2,#1
003642  d107              BNE      |L1.13908|
;;;4466   					{
;;;4467   					bps[i]._apv_timer_1_lev=0;
;;;4468   					bps[i]._apv_cnt_1_lev=0;
;;;4469   					bps[i]._apv_timer_2_lev=(short)(APV_ON2_TIME*3600);
003644  4aa7              LDR      r2,|L1.14564|
003646  f44f6c61          MOV      r12,#0xe10
00364a  8812              LDRH     r2,[r2,#0]  ; APV_ON2_TIME
00364c  fb02f20c          MUL      r2,r2,r12
003650  f8a02060          STRH     r2,[r0,#0x60]
                  |L1.13908|
;;;4470   					}
;;;4471   				}
;;;4472   			
;;;4473   			}
;;;4474   		}
;;;4475   	if(bps[i]._apv_timer_2_lev)
003654  f8b02060          LDRH     r2,[r0,#0x60]
003658  b14a              CBZ      r2,|L1.13934|
;;;4476   		{
;;;4477   		bps[i]._apv_timer_2_lev--;
00365a  f1a20201          SUB      r2,r2,#1
00365e  b292              UXTH     r2,r2
003660  f8a02060          STRH     r2,[r0,#0x60]
;;;4478   		if(bps[i]._apv_timer_2_lev==0)
003664  b91a              CBNZ     r2,|L1.13934|
;;;4479   			{
;;;4480   			bps[i]._apv_cnt_1_lev=2;
003666  f880805f          STRB     r8,[r0,#0x5f]
;;;4481   			bps[i]._apv_timer_1_lev=60;
00366a  f880705e          STRB     r7,[r0,#0x5e]
                  |L1.13934|
;;;4482   			}
;;;4483   		}
;;;4484   
;;;4485   	if(bps[i]._apv_reset_av_timer)bps[i]._apv_reset_av_timer--;
00366e  f8902062          LDRB     r2,[r0,#0x62]
003672  b11a              CBZ      r2,|L1.13948|
003674  f1a20201          SUB      r2,r2,#1
003678  f8802062          STRB     r2,[r0,#0x62]
                  |L1.13948|
00367c  f1010101          ADD      r1,r1,#1              ;4420
003680  75f1              STRB     r1,[r6,#0x17]         ;4420
                  |L1.13954|
003682  7df0              LDRB     r0,[r6,#0x17]         ;4420  ; i
003684  f9b91000          LDRSH    r1,[r9,#0]            ;4420  ; NUMIST
003688  4288              CMP      r0,r1                 ;4420
00368a  db80              BLT      |L1.13710|
;;;4486   	} 
;;;4487   /*char i;
;;;4488   for(i=0;i<2;i++) 
;;;4489   	{
;;;4490   	if(apv_cnt_sec[i])
;;;4491   		{
;;;4492   		apv_cnt_sec[i]--;
;;;4493   		if(apv_cnt_sec[i]==0)
;;;4494   			{
;;;4495   			cnt_av_umax[i]=0;
;;;4496   			cnt_av_umin[i]=0;
;;;4497   			reset_apv_cnt[i]=600;
;;;4498   			}
;;;4499   		}
;;;4500   	
;;;4501   	if(reset_apv_cnt[i])
;;;4502   		{
;;;4503   		reset_apv_cnt[i]--;
;;;4504   		if(reset_apv_cnt[i]==0)
;;;4505   			{
;;;4506   			apv_cnt[i]=0;
;;;4507   			}
;;;4508   		}	
;;;4509   		
;;;4510   	if(hour_apv_cnt[i])
;;;4511   		{
;;;4512   		hour_apv_cnt[i]--;
;;;4513   		if(hour_apv_cnt[i]==0)
;;;4514   			{
;;;4515   			apv_cnt[i]=0;
;;;4516   			avar_src_reset(i);
;;;4517   			}
;;;4518   		}			
;;;4519   	}
;;;4520   
;;;4521   
;;;4522   
;;;4523   
;;;4524   if(apv_cnt_1)
;;;4525   	{
;;;4526   	apv_cnt_1--;
;;;4527   	if(!apv_cnt_1) 
;;;4528   		{
;;;4529   		avar_src_reset(0);
;;;4530   		avar_src_reset(1);
;;;4531   		//cntrl_stat=0;
;;;4532   		}
;;;4533   	}*/		
;;;4534   }
00368c  e8bd83f0          POP      {r4-r9,pc}
;;;4535   
                          ENDP

                  adc_init PROC
;;;4536   //-----------------------------------------------
;;;4537   void adc_init(void)
003690  4899              LDR      r0,|L1.14584|
;;;4538   {
;;;4539   
;;;4540   SET_REG(LPC_PINCON->PINSEL1,1,(25-16)*2,2);
003692  6841              LDR      r1,[r0,#4]
003694  f4212140          BIC      r1,r1,#0xc0000
003698  f4412180          ORR      r1,r1,#0x40000
00369c  6041              STR      r1,[r0,#4]
;;;4541   SET_REG(LPC_PINCON->PINSEL1,1,(24-16)*2,2);
00369e  6841              LDR      r1,[r0,#4]
0036a0  f4213140          BIC      r1,r1,#0x30000
0036a4  f4413180          ORR      r1,r1,#0x10000
0036a8  6041              STR      r1,[r0,#4]
;;;4542   SET_REG(LPC_PINCON->PINSEL1,1,(23-16)*2,2);
0036aa  6841              LDR      r1,[r0,#4]
0036ac  f4214140          BIC      r1,r1,#0xc000
0036b0  f4414180          ORR      r1,r1,#0x4000
0036b4  6041              STR      r1,[r0,#4]
;;;4543   
;;;4544   
;;;4545   SET_REG(LPC_PINCON->PINMODE1,2,(25-16)*2,2);
0036b6  6c41              LDR      r1,[r0,#0x44]
0036b8  f4212140          BIC      r1,r1,#0xc0000
0036bc  f4412100          ORR      r1,r1,#0x80000
0036c0  6441              STR      r1,[r0,#0x44]
;;;4546   SET_REG(LPC_PINCON->PINMODE1,2,(24-16)*2,2);
0036c2  6c41              LDR      r1,[r0,#0x44]
0036c4  f4213140          BIC      r1,r1,#0x30000
0036c8  f4413100          ORR      r1,r1,#0x20000
0036cc  6441              STR      r1,[r0,#0x44]
;;;4547   SET_REG(LPC_PINCON->PINMODE1,2,(23-16)*2,2);
0036ce  6c41              LDR      r1,[r0,#0x44]
0036d0  f4214140          BIC      r1,r1,#0xc000
0036d4  f4414100          ORR      r1,r1,#0x8000
0036d8  6441              STR      r1,[r0,#0x44]
;;;4548   
;;;4549   SET_REG(LPC_ADC->ADCR,0,24,3);
0036da  4888              LDR      r0,|L1.14588|
0036dc  6801              LDR      r1,[r0,#0]
0036de  f02161e0          BIC      r1,r1,#0x7000000
0036e2  6001              STR      r1,[r0,#0]
;;;4550   
;;;4551   SET_REG(LPC_ADC->ADCR,1,21,1);
0036e4  6801              LDR      r1,[r0,#0]
0036e6  f4411100          ORR      r1,r1,#0x200000
0036ea  6001              STR      r1,[r0,#0]
;;;4552   SET_REG(LPC_ADC->ADCR,0,16,1);
0036ec  6801              LDR      r1,[r0,#0]
0036ee  f4213180          BIC      r1,r1,#0x10000
0036f2  6001              STR      r1,[r0,#0]
;;;4553   SET_REG(LPC_ADC->ADCR,1,8,8);
0036f4  6801              LDR      r1,[r0,#0]
0036f6  f421417f          BIC      r1,r1,#0xff00
0036fa  f4417180          ORR      r1,r1,#0x100
0036fe  6001              STR      r1,[r0,#0]
;;;4554   
;;;4555   //SET_REG(LPC_GPIO0->FIODIR,7,5,3);
;;;4556   //SET_REG(LPC_GPIO0->FIOPIN,4,5,3);
;;;4557   	
;;;4558   	/*if(adc_ch<=7)*///SET_REG(LPC_ADC->ADCR,1<<5,0,8);
;;;4559        /*else if(adc_ch==8) SET_REG(LPC_ADC->ADCR,1<<2,0,8);
;;;4560        else SET_REG(LPC_ADC->ADCR,1<<4,0,8);*/
;;;4561   
;;;4562   LPC_ADC->ADINTEN     =  (1<< 8);      /* global enable interrupt            */
003700  f44f7180          MOV      r1,#0x100
003704  60c1              STR      r1,[r0,#0xc]
003706  487e              LDR      r0,|L1.14592|
003708  f44f0180          MOV      r1,#0x400000
00370c  6001              STR      r1,[r0,#0]
;;;4563   
;;;4564   NVIC_EnableIRQ(ADC_IRQn);             /* enable ADC Interrupt               */
;;;4565   
;;;4566   
;;;4567   }
00370e  4770              BX       lr
;;;4568   
                          ENDP

                  adc_drv7 PROC
;;;4569   //-----------------------------------------------
;;;4570   void adc_drv7(void) //(Uсети - постоянка)
003710  e92d41f0          PUSH     {r4-r8,lr}
;;;4571   {
;;;4572   //int temp_S;
;;;4573   //char i;
;;;4574   //signed short temp_SS;
;;;4575   
;;;4576   adc_self_ch_disp[0]=abs_pal(adc_self_ch_buff[1]-adc_self_ch_buff[0]);//adc_self_ch_buff[0]&0x0f80;
003714  4c74              LDR      r4,|L1.14568|
003716  34f2              ADDS     r4,r4,#0xf2
003718  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
00371a  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
00371c  1a40              SUBS     r0,r0,r1
00371e  b200              SXTH     r0,r0
003720  f7fffffe          BL       abs_pal
003724  1da6              ADDS     r6,r4,#6
003726  8030              STRH     r0,[r6,#0]
;;;4577   adc_self_ch_disp[1]=abs_pal(adc_self_ch_buff[2]-adc_self_ch_buff[1]);//adc_self_ch_buff[1]&0x0f80;
003728  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
00372a  8861              LDRH     r1,[r4,#2]  ; adc_self_ch_buff
00372c  1a40              SUBS     r0,r0,r1
00372e  b200              SXTH     r0,r0
003730  f7fffffe          BL       abs_pal
003734  8070              STRH     r0,[r6,#2]
;;;4578   adc_self_ch_disp[2]=abs_pal(adc_self_ch_buff[2]-adc_self_ch_buff[0]);//adc_self_ch_buff[2]&0x0f80;
003736  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
003738  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
00373a  1a40              SUBS     r0,r0,r1
00373c  b200              SXTH     r0,r0
00373e  f7fffffe          BL       abs_pal
003742  80b0              STRH     r0,[r6,#4]
;;;4579   
;;;4580   //adc_self_ch_disp[0]=adc_self_ch_buff[0]&0x0ff0;
;;;4581   //adc_self_ch_disp[1]=adc_self_ch_buff[1]&0x0ff0;
;;;4582   //adc_self_ch_disp[2]=adc_self_ch_buff[2]&0x0ff0;
;;;4583   
;;;4584   
;;;4585   if(adc_self_ch_disp[2]<300)//==adc_self_ch_disp[2])
003744  f44f7196          MOV      r1,#0x12c
;;;4586   	{
;;;4587   	adc_result=adc_self_ch_buff[2];
003748  4d67              LDR      r5,|L1.14568|
00374a  4288              CMP      r0,r1                 ;4585
00374c  da02              BGE      |L1.14164|
00374e  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
003750  87a8              STRH     r0,[r5,#0x3c]
003752  e00c              B        |L1.14190|
                  |L1.14164|
;;;4588   	} 
;;;4589   else if(adc_self_ch_disp[1]<300)//==adc_self_ch_disp[2])
003754  f9b60002          LDRSH    r0,[r6,#2]  ; adc_self_ch_disp
003758  4288              CMP      r0,r1
00375a  da02              BGE      |L1.14178|
;;;4590   	{
;;;4591   	adc_result=adc_self_ch_buff[1];
00375c  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
00375e  87a8              STRH     r0,[r5,#0x3c]
003760  e005              B        |L1.14190|
                  |L1.14178|
;;;4592   	}
;;;4593   else if(adc_self_ch_disp[0]<300)//==adc_self_ch_disp[1])
003762  f9b60000          LDRSH    r0,[r6,#0]  ; adc_self_ch_disp
003766  4288              CMP      r0,r1
003768  da01              BGE      |L1.14190|
;;;4594   	{
;;;4595   	adc_result=adc_self_ch_buff[0];
00376a  8820              LDRH     r0,[r4,#0]  ; adc_self_ch_buff
00376c  87a8              STRH     r0,[r5,#0x3c]
                  |L1.14190|
;;;4596   	}
;;;4597       //adc_result=92;
;;;4598   
;;;4599   if(adc_ch_net)
00376e  7c6f              LDRB     r7,[r5,#0x11]  ; adc_ch_net
003770  2600              MOVS     r6,#0
003772  b347              CBZ      r7,|L1.14278|
;;;4600   	{
;;;4601   
;;;4602   	main_power_buffer[0]+=(long)(adc_result);
003774  4863              LDR      r0,|L1.14596|
003776  f9b5103c          LDRSH    r1,[r5,#0x3c]  ; adc_result
00377a  6802              LDR      r2,[r0,#0]  ; main_power_buffer
00377c  440a              ADD      r2,r2,r1
00377e  6002              STR      r2,[r0,#0]  ; main_power_buffer
;;;4603   	main_power_buffer[1]+=(long)(adc_result);
003780  6842              LDR      r2,[r0,#4]  ; main_power_buffer
003782  440a              ADD      r2,r2,r1
003784  6042              STR      r2,[r0,#4]  ; main_power_buffer
;;;4604   	main_power_buffer[2]+=(long)(adc_result);
003786  6882              LDR      r2,[r0,#8]  ; main_power_buffer
003788  440a              ADD      r2,r2,r1
00378a  6082              STR      r2,[r0,#8]  ; main_power_buffer
;;;4605   	main_power_buffer[3]+=(long)(adc_result);
00378c  68c2              LDR      r2,[r0,#0xc]  ; main_power_buffer
00378e  4411              ADD      r1,r1,r2
003790  60c1              STR      r1,[r0,#0xc]  ; main_power_buffer
;;;4606   
;;;4607   	adc_net_buff_cnt++;
003792  f8b51044          LDRH     r1,[r5,#0x44]  ; adc_net_buff_cnt
003796  f1010101          ADD      r1,r1,#1
00379a  b209              SXTH     r1,r1
00379c  f8a51044          STRH     r1,[r5,#0x44]
;;;4608   	if(adc_net_buff_cnt>=0x1000)
0037a0  f5b15f80          CMP      r1,#0x1000
0037a4  db01              BLT      |L1.14250|
;;;4609   		{
;;;4610   		adc_net_buff_cnt=0;
0037a6  f8a56044          STRH     r6,[r5,#0x44]
                  |L1.14250|
;;;4611   		}
;;;4612   	if((adc_net_buff_cnt&0x03ff)==0)
0037aa  f9b51044          LDRSH    r1,[r5,#0x44]  ; adc_net_buff_cnt
0037ae  058a              LSLS     r2,r1,#22
0037b0  d131              BNE      |L1.14358|
;;;4613   		{
;;;4614   		#ifdef UKU_220
;;;4615   		net_buff_=(short)((main_power_buffer[adc_net_buff_cnt>>10])>>11);
;;;4616   		#else
;;;4617   		#ifdef UKU_220_V2
;;;4618   		net_buff_=(short)((main_power_buffer[adc_net_buff_cnt>>10])>>11);
;;;4619   		#else
;;;4620   		net_buff_=(short)((main_power_buffer[adc_net_buff_cnt>>10])>>8);
0037b2  ea4f21a1          ASR      r1,r1,#10
0037b6  f8502021          LDR      r2,[r0,r1,LSL #2]
0037ba  ea4f2222          ASR      r2,r2,#8
0037be  876a              STRH     r2,[r5,#0x3a]
;;;4621   		#endif
;;;4622   		#endif
;;;4623   		main_power_buffer[adc_net_buff_cnt>>10]=0;
0037c0  f8406021          STR      r6,[r0,r1,LSL #2]
0037c4  e027              B        |L1.14358|
                  |L1.14278|
;;;4624   		}
;;;4625   
;;;4626   
;;;4627   	} 
;;;4628   else if(!adc_ch_net)
;;;4629   	{
;;;4630   	adc_buff[adc_ch][adc_ch_cnt]=(long)adc_result;
0037c6  4850              LDR      r0,|L1.14600|
0037c8  7cac              LDRB     r4,[r5,#0x12]  ; adc_ch
0037ca  7cea              LDRB     r2,[r5,#0x13]  ; adc_ch_cnt
0037cc  eb001384          ADD      r3,r0,r4,LSL #6
0037d0  f9b5103c          LDRSH    r1,[r5,#0x3c]  ; adc_result
0037d4  f8431022          STR      r1,[r3,r2,LSL #2]
;;;4631   	
;;;4632   	if((adc_ch_cnt&0x03)==0)
0037d8  0790              LSLS     r0,r2,#30
0037da  d10f              BNE      |L1.14332|
;;;4633   		{
;;;4634   		long temp_L;
;;;4635   		char i;
;;;4636   		temp_L=0;
0037dc  4601              MOV      r1,r0
                  |L1.14302|
;;;4637   		for(i=0;i<16;i++)
;;;4638   			{
;;;4639   			temp_L+=adc_buff[adc_ch][i];
0037de  f853c020          LDR      r12,[r3,r0,LSL #2]
0037e2  4461              ADD      r1,r1,r12
0037e4  f1000001          ADD      r0,r0,#1              ;4637
0037e8  b2c0              UXTB     r0,r0                 ;4637
0037ea  2810              CMP      r0,#0x10              ;4637
0037ec  d3f7              BCC      |L1.14302|
;;;4640   			}
;;;4641   		adc_buff_[adc_ch]= (short)(temp_L>>4);
0037ee  ea4f1021          ASR      r0,r1,#4
0037f2  4944              LDR      r1,|L1.14596|
0037f4  f1a10120          SUB      r1,r1,#0x20
0037f8  f8210014          STRH     r0,[r1,r4,LSL #1]
                  |L1.14332|
;;;4642   
;;;4643   		//adc_buff_[3]=346;
;;;4644   		}
;;;4645   	if(++adc_ch>=16) 
0037fc  1c64              ADDS     r4,r4,#1
0037fe  b2e0              UXTB     r0,r4
003800  74a8              STRB     r0,[r5,#0x12]
003802  2810              CMP      r0,#0x10
003804  d307              BCC      |L1.14358|
;;;4646   		{
;;;4647   		adc_ch=0;
003806  74ae              STRB     r6,[r5,#0x12]
;;;4648   		adc_ch_cnt++;
003808  f1020201          ADD      r2,r2,#1
00380c  b2d0              UXTB     r0,r2
00380e  74e8              STRB     r0,[r5,#0x13]
;;;4649   		if(adc_ch_cnt>=16)adc_ch_cnt=0;
003810  2810              CMP      r0,#0x10
003812  d300              BCC      |L1.14358|
003814  74ee              STRB     r6,[r5,#0x13]
                  |L1.14358|
;;;4650   		}
;;;4651   	}
;;;4652   
;;;4653   //adc_buff[adc_ch][adc_cnt1]=(adc_self_ch_buff[2]+adc_self_ch_buff[1])/2;
;;;4654   
;;;4655   //if(adc_buff[adc_ch][adc_cnt1]<adc_buff_min[adc_ch])adc_buff_min[adc_ch]=adc_buff[adc_ch][adc_cnt1];
;;;4656   //if(adc_buff[adc_ch][adc_cnt1]>adc_buff_max[adc_ch])adc_buff_max[adc_ch]=adc_buff[adc_ch][adc_cnt1];
;;;4657   /*
;;;4658   	{
;;;4659   	if((adc_cnt1&0x03)==0)
;;;4660   		{
;;;4661   		temp_S=0;
;;;4662   		for(i=0;i<16;i++)
;;;4663   			{
;;;4664   			temp_S+=adc_buff[adc_ch][i];
;;;4665   			} 
;;;4666            	adc_buff_[adc_ch]=temp_S>>4;
;;;4667             }
;;;4668   	}*/
;;;4669   
;;;4670   
;;;4671   		  
;;;4672   
;;;4673   adc_self_ch_cnt=0;
003816  742e              STRB     r6,[r5,#0x10]
;;;4674   
;;;4675   adc_ch_net++;
003818  f1070701          ADD      r7,r7,#1
;;;4676   adc_ch_net&=1;
00381c  f0070001          AND      r0,r7,#1
003820  7468              STRB     r0,[r5,#0x11]
;;;4677   
;;;4678   //SET_REG(LPC_GPIO0->FIODIR,7,5,3);
;;;4679   //SET_REG(LPC_GPIO0->FIOPIN,adc_ch,5,3);
;;;4680   
;;;4681   if(adc_ch_net)
;;;4682   	{
;;;4683   	//LPC_GPIO2->FIODIR|=(1<<7);
;;;4684   	//LPC_GPIO2->FIOPIN|=(1<<7);
;;;4685   	SET_REG(LPC_ADC->ADCR,1<<2,0,8);
003822  4a36              LDR      r2,|L1.14588|
003824  b130              CBZ      r0,|L1.14388|
003826  6810              LDR      r0,[r2,#0]
003828  f02000ff          BIC      r0,r0,#0xff
00382c  f1000004          ADD      r0,r0,#4
003830  6010              STR      r0,[r2,#0]
003832  e03d              B        |L1.14512|
                  |L1.14388|
;;;4686   	}
;;;4687   else
;;;4688   	{
;;;4689   	//LPC_GPIO2->FIODIR|=(1<<7);
;;;4690   	//LPC_GPIO2->FIOPIN&=~(1<<7);
;;;4691   	if(!(adc_ch&(1<<3)))SET_REG(LPC_ADC->ADCR,1<<0,0,8);
003834  7ca9              LDRB     r1,[r5,#0x12]  ; adc_ch
003836  0708              LSLS     r0,r1,#28
003838  d406              BMI      |L1.14408|
00383a  6810              LDR      r0,[r2,#0]
00383c  f02000ff          BIC      r0,r0,#0xff
003840  f1000001          ADD      r0,r0,#1
003844  6010              STR      r0,[r2,#0]
003846  e005              B        |L1.14420|
                  |L1.14408|
;;;4692   	else 			SET_REG(LPC_ADC->ADCR,1<<1,0,8);
003848  6810              LDR      r0,[r2,#0]
00384a  f02000ff          BIC      r0,r0,#0xff
00384e  f1000002          ADD      r0,r0,#2
003852  6010              STR      r0,[r2,#0]
                  |L1.14420|
;;;4693   
;;;4694   
;;;4695   	SET_REG(LPC_GPIO0->FIODIR,1,28,1);
003854  482d              LDR      r0,|L1.14604|
003856  6803              LDR      r3,[r0,#0]
003858  f0435380          ORR      r3,r3,#0x10000000
00385c  6003              STR      r3,[r0,#0]
;;;4696   	SET_REG(LPC_GPIO1->FIODIR,1,30,1);
00385e  6a03              LDR      r3,[r0,#0x20]
003860  f0434380          ORR      r3,r3,#0x40000000
003864  6203              STR      r3,[r0,#0x20]
;;;4697   	SET_REG(LPC_GPIO3->FIODIR,1,26,1);
003866  6e03              LDR      r3,[r0,#0x60]
003868  f0436380          ORR      r3,r3,#0x4000000
00386c  6603              STR      r3,[r0,#0x60]
;;;4698   
;;;4699   	if(!(adc_ch&(1<<0)))SET_REG(LPC_GPIO0->FIOPIN,0,28,1);
00386e  07cb              LSLS     r3,r1,#31
003870  d00a              BEQ      |L1.14472|
;;;4700   	else 			SET_REG(LPC_GPIO0->FIOPIN,1,28,1);
003872  6943              LDR      r3,[r0,#0x14]
003874  f0435380          ORR      r3,r3,#0x10000000
003878  6143              STR      r3,[r0,#0x14]
                  |L1.14458|
;;;4701   
;;;4702   	if(!(adc_ch&(1<<1)))SET_REG(LPC_GPIO1->FIOPIN,0,30,1);
00387a  078b              LSLS     r3,r1,#30
00387c  d409              BMI      |L1.14482|
00387e  6b43              LDR      r3,[r0,#0x34]
003880  f0234380          BIC      r3,r3,#0x40000000
003884  6343              STR      r3,[r0,#0x34]
003886  e008              B        |L1.14490|
                  |L1.14472|
003888  6943              LDR      r3,[r0,#0x14]         ;4699
00388a  f0235380          BIC      r3,r3,#0x10000000     ;4699
00388e  6143              STR      r3,[r0,#0x14]         ;4699
003890  e7f3              B        |L1.14458|
                  |L1.14482|
;;;4703   	else 			SET_REG(LPC_GPIO1->FIOPIN,1,30,1);
003892  6b43              LDR      r3,[r0,#0x34]
003894  f0434380          ORR      r3,r3,#0x40000000
003898  6343              STR      r3,[r0,#0x34]
                  |L1.14490|
;;;4704   
;;;4705   	if(!(adc_ch&(1<<2)))SET_REG(LPC_GPIO3->FIOPIN,0,26,1);
00389a  0749              LSLS     r1,r1,#29
00389c  d404              BMI      |L1.14504|
00389e  6f41              LDR      r1,[r0,#0x74]
0038a0  f0216180          BIC      r1,r1,#0x4000000
0038a4  6741              STR      r1,[r0,#0x74]
0038a6  e003              B        |L1.14512|
                  |L1.14504|
;;;4706   	else 			SET_REG(LPC_GPIO3->FIOPIN,1,26,1);
0038a8  6f41              LDR      r1,[r0,#0x74]
0038aa  f0416180          ORR      r1,r1,#0x4000000
0038ae  6741              STR      r1,[r0,#0x74]
                  |L1.14512|
;;;4707   	}
;;;4708   	
;;;4709   
;;;4710   
;;;4711   
;;;4712   LPC_ADC->ADCR |=  (1<<24);
0038b0  6810              LDR      r0,[r2,#0]
0038b2  f0407080          ORR      r0,r0,#0x1000000
0038b6  6010              STR      r0,[r2,#0]
                  |L1.14520|
;;;4713   
;;;4714   }
0038b8  e8bd81f0          POP      {r4-r8,pc}
;;;4715   
                          ENDP

                  avg_hndl PROC
;;;4972   //-----------------------------------------------
;;;4973   void avg_hndl(void)
0038bc  e92d41f0          PUSH     {r4-r8,lr}
;;;4974   { 
;;;4975   char i;
;;;4976   
;;;4977   //#define AVGCNTMAX	5
;;;4978   if(avg_main_cnt)
0038c0  4d09              LDR      r5,|L1.14568|
0038c2  f9b50036          LDRSH    r0,[r5,#0x36]  ; avg_main_cnt
0038c6  b318              CBZ      r0,|L1.14608|
;;;4979   	{
;;;4980   	avg_main_cnt--;
0038c8  f1a00001          SUB      r0,r0,#1
0038cc  86e8              STRH     r0,[r5,#0x36]
;;;4981   	//goto avg_hndl_end;
;;;4982   	return;
;;;4983   	}                 
;;;4984   
;;;4985   avg_main_cnt=5;
;;;4986   avg_num=0;
;;;4987   
;;;4988   for(i=0;i<NUMIST;i++)
;;;4989   	{
;;;4990   	if((bps[i]._state==bsWRK)&&(bps[i]._cnt<20))avg_num++;
;;;4991   	}
;;;4992   
;;;4993   /*if((K[NUMI]>=1)&&(bps_state[0]==ssWRK))	avg_num++;
;;;4994   if((K[NUMI]>=2)&&(bps_state[1]==ssWRK))	avg_num++;
;;;4995   if((K[NUMI]>=3)&&(bps_state[2]==ssWRK))	avg_num++;*/
;;;4996   
;;;4997   if(avg_vektor) avg_vektor=0;
;;;4998   else avg_vektor=1;
;;;4999   	
;;;5000   if(avg_num<2)
;;;5001   	{
;;;5002   	//goto avg_hndl_end;
;;;5003   	return;
;;;5004   	}
;;;5005   	
;;;5006   else
;;;5007   	{
;;;5008   	i_avg_min=5000;
;;;5009   	i_avg_max=0;
;;;5010   	i_avg_summ=0;
;;;5011   	for(i=0;i<NUMIST;i++)
;;;5012   		{
;;;5013   		if(bps[i]._state==bsWRK)
;;;5014   			{
;;;5015   			if(bps[i]._Ii>i_avg_max)i_avg_max=bps[i]._Ii;
;;;5016   			if(bps[i]._Ii<i_avg_min)i_avg_min=bps[i]._Ii;
;;;5017   			
;;;5018   			i_avg_summ+=bps[i]._Ii;
;;;5019   			}
;;;5020   		}
;;;5021   	i_avg=i_avg_summ/avg_num;	
;;;5022   	
;;;5023   	if(i_avg_min==0)i_avg_min=1;
;;;5024   
;;;5025   	avg=i_avg_max;
;;;5026   	avg*=100;
;;;5027   	avg/=i_avg_min;
;;;5028   
;;;5029   	if(avg>130) bAVG=1;
;;;5030   	if(avg<110) bAVG=0;
;;;5031   
;;;5032   	if(bAVG==1)
;;;5033   		{
;;;5034   		for(i=0;i<NUMIST;i++)
;;;5035   			{
;;;5036   			if(bps[i]._state==bsWRK)
;;;5037   				{
;;;5038   				if((bps[i]._Ii>i_avg)&&(!avg_vektor))bps[i]._x_--;
;;;5039   				if((bps[i]._Ii<i_avg)&&(avg_vektor))bps[i]._x_++;
;;;5040   			
;;;5041   				if(bps[i]._x_<-50)bps[i]._x_=-50;
;;;5042   				if(bps[i]._x_>50)bps[i]._x_=50;	
;;;5043   				}
;;;5044   			}		
;;;5045   		}			
;;;5046   	}   	 
;;;5047   
;;;5048   
;;;5049   avg_hndl_end:
;;;5050   __nop();  
;;;5051   }
0038ce  e7f3              B        |L1.14520|
                  |L1.14544|
                          DCD      a_ind
                  |L1.14548|
                          DCD      mnemo_cnt
                  |L1.14552|
                          DCD      MNEMO_ON
                  |L1.14556|
                          DCD      MNEMO_TIME
                  |L1.14560|
                          DCD      bps
                  |L1.14564|
                          DCD      APV_ON2_TIME
                  |L1.14568|
                          DCD      ||area_number.26||
                  |L1.14572|
                          DCD      APV_ON2
                  |L1.14576|
                          DCD      NUMIST
                  |L1.14580|
                          DCD      APV_ON1
                  |L1.14584|
                          DCD      0x4002c000
                  |L1.14588|
                          DCD      0x40034000
                  |L1.14592|
                          DCD      0xe000e100
                  |L1.14596|
                          DCD      ||.bss||+0x42c
                  |L1.14600|
                          DCD      ||.bss||+0xc
                  |L1.14604|
                          DCD      0x2009c000
                  |L1.14608|
003910  f04f0005          MOV      r0,#5                 ;4985
003914  86e8              STRH     r0,[r5,#0x36]         ;4985
003916  f04f0700          MOV      r7,#0                 ;4986
00391a  76af              STRB     r7,[r5,#0x1a]         ;4986
00391c  f04f0000          MOV      r0,#0                 ;4988
003920  49f8              LDR      r1,|L1.15620|
003922  4cf7              LDR      r4,|L1.15616|
003924  f9b12000          LDRSH    r2,[r1,#0]            ;4988
003928  e012              B        |L1.14672|
                  |L1.14634|
00392a  eb0001c0          ADD      r1,r0,r0,LSL #3       ;4990
00392e  eb011100          ADD      r1,r1,r0,LSL #4       ;4990
003932  eb040181          ADD      r1,r4,r1,LSL #2       ;4990
003936  788b              LDRB     r3,[r1,#2]            ;4990
003938  2b01              CMP      r3,#1                 ;4990
00393a  d106              BNE      |L1.14666|
00393c  78c9              LDRB     r1,[r1,#3]            ;4990
00393e  2914              CMP      r1,#0x14              ;4990
003940  d203              BCS      |L1.14666|
003942  7ea9              LDRB     r1,[r5,#0x1a]         ;4990  ; avg_num
003944  f1010101          ADD      r1,r1,#1              ;4990
003948  76a9              STRB     r1,[r5,#0x1a]         ;4990
                  |L1.14666|
00394a  f1000001          ADD      r0,r0,#1              ;4988
00394e  b2c0              UXTB     r0,r0                 ;4988
                  |L1.14672|
003950  4290              CMP      r0,r2                 ;4988
003952  dbea              BLT      |L1.14634|
003954  7ee8              LDRB     r0,[r5,#0x1b]         ;4997  ; avg_vektor
003956  f04f0c01          MOV      r12,#1                ;4990
00395a  b108              CBZ      r0,|L1.14688|
00395c  76ef              STRB     r7,[r5,#0x1b]         ;4997
00395e  e001              B        |L1.14692|
                  |L1.14688|
003960  f885c01b          STRB     r12,[r5,#0x1b]        ;4998
                  |L1.14692|
003964  7eae              LDRB     r6,[r5,#0x1a]         ;5000  ; avg_num
003966  2e02              CMP      r6,#2                 ;5000
003968  d3a6              BCC      |L1.14520|
00396a  4be7              LDR      r3,|L1.15624|
00396c  f2413088          MOV      r0,#0x1388            ;5008
003970  61d8              STR      r0,[r3,#0x1c]         ;5008  ; i_avg_min
003972  619f              STR      r7,[r3,#0x18]         ;5009  ; i_avg_max
003974  621f              STR      r7,[r3,#0x20]         ;5010  ; i_avg_summ
003976  f04f0100          MOV      r1,#0                 ;5011
00397a  e01c              B        |L1.14774|
                  |L1.14716|
00397c  eb0100c1          ADD      r0,r1,r1,LSL #3       ;5013
003980  eb001001          ADD      r0,r0,r1,LSL #4       ;5013
003984  eb040080          ADD      r0,r4,r0,LSL #2       ;5013
003988  f8908002          LDRB     r8,[r0,#2]            ;5013
00398c  f1b80f01          CMP      r8,#1                 ;5013
003990  d10e              BNE      |L1.14768|
003992  6a40              LDR      r0,[r0,#0x24]         ;5015
003994  f8d38018          LDR      r8,[r3,#0x18]         ;5015  ; i_avg_max
003998  4540              CMP      r0,r8                 ;5015
00399a  dd00              BLE      |L1.14750|
00399c  6198              STR      r0,[r3,#0x18]         ;5015  ; i_avg_max
                  |L1.14750|
00399e  f8d3801c          LDR      r8,[r3,#0x1c]         ;5016  ; i_avg_min
0039a2  4540              CMP      r0,r8                 ;5016
0039a4  da00              BGE      |L1.14760|
0039a6  61d8              STR      r0,[r3,#0x1c]         ;5016  ; i_avg_min
                  |L1.14760|
0039a8  f8d38020          LDR      r8,[r3,#0x20]         ;5018  ; i_avg_summ
0039ac  4440              ADD      r0,r0,r8              ;5018
0039ae  6218              STR      r0,[r3,#0x20]         ;5018  ; i_avg_summ
                  |L1.14768|
0039b0  f1010101          ADD      r1,r1,#1              ;5011
0039b4  b2c9              UXTB     r1,r1                 ;5011
                  |L1.14774|
0039b6  4291              CMP      r1,r2                 ;5011
0039b8  dbe0              BLT      |L1.14716|
0039ba  6a18              LDR      r0,[r3,#0x20]         ;5021  ; i_avg_summ
0039bc  fb90f6f6          SDIV     r6,r0,r6              ;5021
0039c0  625e              STR      r6,[r3,#0x24]         ;5021  ; i_avg
0039c2  69d8              LDR      r0,[r3,#0x1c]         ;5023  ; i_avg_min
0039c4  b908              CBNZ     r0,|L1.14794|
0039c6  f8c3c01c          STR      r12,[r3,#0x1c]        ;5023  ; i_avg_min
                  |L1.14794|
0039ca  6998              LDR      r0,[r3,#0x18]         ;5025  ; i_avg_max
0039cc  f04f0164          MOV      r1,#0x64              ;5026
0039d0  fb00f001          MUL      r0,r0,r1              ;5026
0039d4  69d9              LDR      r1,[r3,#0x1c]         ;5027  ; i_avg_min
0039d6  fb90f0f1          SDIV     r0,r0,r1              ;5027
0039da  6298              STR      r0,[r3,#0x28]         ;5027  ; avg
0039dc  2882              CMP      r0,#0x82              ;5029
0039de  dd01              BLE      |L1.14820|
0039e0  f885c019          STRB     r12,[r5,#0x19]        ;5029
                  |L1.14820|
0039e4  286e              CMP      r0,#0x6e              ;5030
0039e6  da00              BGE      |L1.14826|
0039e8  766f              STRB     r7,[r5,#0x19]         ;5030
                  |L1.14826|
0039ea  7e68              LDRB     r0,[r5,#0x19]         ;5032  ; bAVG
0039ec  2801              CMP      r0,#1                 ;5032
0039ee  d138              BNE      |L1.14946|
0039f0  f04f0100          MOV      r1,#0                 ;5034
0039f4  f06f0731          MVN      r7,#0x31              ;5041
0039f8  e031              B        |L1.14942|
                  |L1.14842|
0039fa  eb0100c1          ADD      r0,r1,r1,LSL #3       ;5036
0039fe  eb001001          ADD      r0,r0,r1,LSL #4       ;5036
003a02  eb040080          ADD      r0,r4,r0,LSL #2       ;5036
003a06  7883              LDRB     r3,[r0,#2]            ;5036
003a08  2b01              CMP      r3,#1                 ;5036
003a0a  d125              BNE      |L1.14936|
003a0c  6a43              LDR      r3,[r0,#0x24]         ;5038
003a0e  42b3              CMP      r3,r6                 ;5038
003a10  dd0a              BLE      |L1.14888|
003a12  f895c01b          LDRB     r12,[r5,#0x1b]        ;5038  ; avg_vektor
003a16  f1bc0f00          CMP      r12,#0                ;5038
003a1a  d105              BNE      |L1.14888|
003a1c  f8b0c054          LDRH     r12,[r0,#0x54]        ;5038
003a20  f1ac0c01          SUB      r12,r12,#1            ;5038
003a24  f8a0c054          STRH     r12,[r0,#0x54]        ;5038
                  |L1.14888|
003a28  42b3              CMP      r3,r6                 ;5039
003a2a  da07              BGE      |L1.14908|
003a2c  7eeb              LDRB     r3,[r5,#0x1b]         ;5039  ; avg_vektor
003a2e  b12b              CBZ      r3,|L1.14908|
003a30  f8b03054          LDRH     r3,[r0,#0x54]         ;5039
003a34  f1030301          ADD      r3,r3,#1              ;5039
003a38  f8a03054          STRH     r3,[r0,#0x54]         ;5039
                  |L1.14908|
003a3c  f9b03054          LDRSH    r3,[r0,#0x54]         ;5041
003a40  42bb              CMP      r3,r7                 ;5041
003a42  da01              BGE      |L1.14920|
003a44  f8a07054          STRH     r7,[r0,#0x54]         ;5041
                  |L1.14920|
003a48  f9b03054          LDRSH    r3,[r0,#0x54]         ;5042
003a4c  2b32              CMP      r3,#0x32              ;5042
003a4e  dd03              BLE      |L1.14936|
003a50  f04f0332          MOV      r3,#0x32              ;5042
003a54  f8a03054          STRH     r3,[r0,#0x54]         ;5042
                  |L1.14936|
003a58  f1010101          ADD      r1,r1,#1              ;5034
003a5c  b2c9              UXTB     r1,r1                 ;5034
                  |L1.14942|
003a5e  4291              CMP      r1,r2                 ;5034
003a60  dbcb              BLT      |L1.14842|
                  |L1.14946|
003a62  bf00              NOP                            ;5050
003a64  e728              B        |L1.14520|
;;;5052   
                          ENDP

                  rele_hndl PROC
;;;5065   //*************-----------------------------------------------
;;;5066   void rele_hndl(void)
003a66  e92d5ff0          PUSH     {r4-r12,lr}
;;;5067   {
;;;5068   //static char cnt_rel_sam;
;;;5069   //char temp;
;;;5070   
;;;5071   //temp=0;
;;;5072   
;;;5073   
;;;5074   SET_REG(LPC_PINCON->PINSEL0,0,4*2,6*2);
003a6a  48a8              LDR      r0,|L1.15628|
003a6c  6801              LDR      r1,[r0,#0]
003a6e  4aa8              LDR      r2,|L1.15632|
003a70  ea010102          AND      r1,r1,r2
003a74  6001              STR      r1,[r0,#0]
;;;5075   SET_REG(LPC_GPIO0->FIODIR,63,4,6);
003a76  4ca7              LDR      r4,|L1.15636|
003a78  6821              LDR      r1,[r4,#0]
003a7a  f441717c          ORR      r1,r1,#0x3f0
003a7e  6021              STR      r1,[r4,#0]
;;;5076   SET_REG(LPC_PINCON->PINSEL7,0,(25-16)*2,2);
003a80  69c1              LDR      r1,[r0,#0x1c]
003a82  f4212140          BIC      r1,r1,#0xc0000
003a86  61c1              STR      r1,[r0,#0x1c]
;;;5077   SET_REG(LPC_GPIO3->FIODIR,1,25,1);
003a88  6e21              LDR      r1,[r4,#0x60]
003a8a  f0417100          ORR      r1,r1,#0x2000000
003a8e  6621              STR      r1,[r4,#0x60]
;;;5078   SET_REG(LPC_PINCON->PINSEL1,0,(29-16)*2,2);
003a90  6841              LDR      r1,[r0,#4]
003a92  f0216140          BIC      r1,r1,#0xc000000
003a96  6041              STR      r1,[r0,#4]
;;;5079   SET_REG(LPC_GPIO0->FIODIR,1,29,1);
003a98  6820              LDR      r0,[r4,#0]
003a9a  f0405000          ORR      r0,r0,#0x20000000
003a9e  6020              STR      r0,[r4,#0]
;;;5080   
;;;5081   
;;;5082   
;;;5083   
;;;5084   
;;;5085   
;;;5086   if((((bat[0]._rel_stat)  || (tbatdisable_stat!=tbdsON))&&(tbatdisable_cmnd))	&& (main_1Hz_cnt>5))
003aa0  489e              LDR      r0,|L1.15644|
003aa2  4d9d              LDR      r5,|L1.15640|
003aa4  499f              LDR      r1,|L1.15652|
003aa6  7802              LDRB     r2,[r0,#0]  ; tbatdisable_stat
003aa8  489d              LDR      r0,|L1.15648|
003aaa  f895303c          LDRB     r3,[r5,#0x3c]  ; bat
003aae  f9b11000          LDRSH    r1,[r1,#0]
003ab2  7800              LDRB     r0,[r0,#0]
003ab4  4313              ORRS     r3,r3,r2
003ab6  d007              BEQ      |L1.15048|
003ab8  b130              CBZ      r0,|L1.15048|
003aba  2905              CMP      r1,#5
003abc  dd04              BLE      |L1.15048|
;;;5087   	{
;;;5088   	SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_BAT1,1);
003abe  69a3              LDR      r3,[r4,#0x18]
003ac0  f4437380          ORR      r3,r3,#0x100
003ac4  61a3              STR      r3,[r4,#0x18]
003ac6  e003              B        |L1.15056|
                  |L1.15048|
;;;5089   	}
;;;5090   else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_BAT1,1);	  	
003ac8  69e3              LDR      r3,[r4,#0x1c]
003aca  f4437380          ORR      r3,r3,#0x100
003ace  61e3              STR      r3,[r4,#0x1c]
                  |L1.15056|
;;;5091   
;;;5092   if((((bat[1]._rel_stat) || (tbatdisable_stat!=tbdsON))&&(tbatdisable_cmnd))	&& (main_1Hz_cnt>5))
003ad0  f8953088          LDRB     r3,[r5,#0x88]  ; bat
003ad4  4313              ORRS     r3,r3,r2
003ad6  d007              BEQ      |L1.15080|
003ad8  b130              CBZ      r0,|L1.15080|
003ada  2905              CMP      r1,#5
003adc  dd04              BLE      |L1.15080|
;;;5093   	{
;;;5094   	SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_BAT2,1);
003ade  69a0              LDR      r0,[r4,#0x18]
003ae0  f0400040          ORR      r0,r0,#0x40
003ae4  61a0              STR      r0,[r4,#0x18]
003ae6  e003              B        |L1.15088|
                  |L1.15080|
;;;5095   	}
;;;5096   else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_BAT2,1);
003ae8  69e0              LDR      r0,[r4,#0x1c]
003aea  f0400040          ORR      r0,r0,#0x40
003aee  61e0              STR      r0,[r4,#0x1c]
                  |L1.15088|
;;;5097   
;;;5098   
;;;5099   if(mess_find_unvol((MESS2RELE_HNDL))&&(mess_data[0]==PARAM_RELE_SAMOKALIBR)) 
003af0  20d2              MOVS     r0,#0xd2
003af2  f7fffffe          BL       mess_find_unvol
003af6  4d8c              LDR      r5,|L1.15656|
003af8  b110              CBZ      r0,|L1.15104|
003afa  6828              LDR      r0,[r5,#0]  ; mess_data
003afc  2864              CMP      r0,#0x64
003afe  d048              BEQ      |L1.15250|
                  |L1.15104|
;;;5100   	{
;;;5101   	if(mess_data[1]==1)SET_REG(LPC_GPIO0->FIOSET,1,29,1);
;;;5102   	else if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,29,1);
;;;5103   	}
;;;5104   else SET_REG(LPC_GPIO0->FIOCLR,1,29,1);
003b00  69e0              LDR      r0,[r4,#0x1c]
003b02  f0405000          ORR      r0,r0,#0x20000000
003b06  61e0              STR      r0,[r4,#0x1c]
                  |L1.15112|
;;;5105   
;;;5106   
;;;5107   #ifndef UKU2071x
;;;5108   //Реле аварии сети
;;;5109   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;5110   	{
;;;5111   	if(mess_data[1]==0) 			SET_REG(LPC_GPIO3->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;5112   	else 						SET_REG(LPC_GPIO3->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5113   	}
;;;5114   else	if(!(avar_ind_stat&0x00000001)) 	SET_REG(LPC_GPIO3->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;5115   else 							SET_REG(LPC_GPIO3->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5116   #endif
;;;5117   #ifdef UKU2071x
;;;5118   //Реле аварии сети
;;;5119   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
003b08  20d2              MOVS     r0,#0xd2
003b0a  f7fffffe          BL       mess_find_unvol
;;;5120   	{
;;;5121   	if(mess_data[1]==0)				SET_REG(LPC_GPIO3->FIOCLR,1,SHIFT_REL_AV_NET,1); 
;;;5122   	else 						SET_REG(LPC_GPIO3->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;5123   	}
;;;5124   else	if(!(avar_ind_stat&0x00000001))	SET_REG(LPC_GPIO3->FIOCLR,1,SHIFT_REL_AV_NET,1);
003b0e  4e87              LDR      r6,|L1.15660|
003b10  b110              CBZ      r0,|L1.15128|
003b12  6828              LDR      r0,[r5,#0]            ;5119  ; mess_data
003b14  2866              CMP      r0,#0x66              ;5119
003b16  d04b              BEQ      |L1.15280|
                  |L1.15128|
003b18  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
003b1a  07c0              LSLS     r0,r0,#31
003b1c  d054              BEQ      |L1.15304|
;;;5125   else 					  		SET_REG(LPC_GPIO3->FIOSET,1,SHIFT_REL_AV_NET,1);
003b1e  6fa0              LDR      r0,[r4,#0x78]
003b20  f0407000          ORR      r0,r0,#0x2000000
003b24  67a0              STR      r0,[r4,#0x78]
                  |L1.15142|
;;;5126   #endif
;;;5127   
;;;5128   #ifdef UKU_3U
;;;5129   //Реле аварий батарей
;;;5130   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT1))
;;;5131   	{
;;;5132   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT1,1);
;;;5133   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT1,1);
;;;5134        }
;;;5135   else 
;;;5136   	{
;;;5137   	if(!(avar_ind_stat&0x00000002)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT1,1);
;;;5138        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT1,1);
;;;5139   	} 
;;;5140   
;;;5141   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT2))
;;;5142   	{
;;;5143   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;5144   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT2,1);
;;;5145        }
;;;5146   else 
;;;5147   	{
;;;5148   	if(!(avar_ind_stat&0x00000004)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;5149        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT2,1);
;;;5150   	} 
;;;5151   
;;;5152   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
;;;5153   	{
;;;5154   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;5155   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;5156        }
;;;5157   else 
;;;5158   	{
;;;5159   	if(!(avar_ind_stat&0x000007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;5160        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;5161   	} 
;;;5162   
;;;5163   #endif
;;;5164   
;;;5165   
;;;5166   #ifdef UKU_GLONASS
;;;5167   //Реле аварий батарей
;;;5168   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT1))
;;;5169   	{
;;;5170   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT1,1);
;;;5171   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT1,1);
;;;5172        }
;;;5173   else 
;;;5174   	{
;;;5175   	if(!(avar_ind_stat&0x00000002)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT1,1);
;;;5176        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT1,1);
;;;5177   	} 
;;;5178   
;;;5179   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT2))
;;;5180   	{
;;;5181   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;5182   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT2,1);
;;;5183        }
;;;5184   else 
;;;5185   	{
;;;5186   	if(!(avar_ind_stat&0x00000004)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;5187        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT2,1);
;;;5188   	} 
;;;5189   
;;;5190   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
;;;5191   	{
;;;5192   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;5193   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;5194        }
;;;5195   else 
;;;5196   	{
;;;5197   	if(!(avar_ind_stat&0x000007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;5198        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;5199   	} 
;;;5200   
;;;5201   #endif
;;;5202   
;;;5203   #ifdef U 
;;;5204   
;;;5205   #endif
;;;5206   
;;;5207   #ifdef UKU_RSTKM
;;;5208   
;;;5209   //Реле общей аварии
;;;5210   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_COMM))
;;;5211   	{
;;;5212   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_COMM,1);
;;;5213   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_COMM,1);
;;;5214   	}
;;;5215   else 
;;;5216   	{
;;;5217        if(  (!(avar_ind_stat&0x00007fff))/* &&
;;;5218             ((!SK_REL_EN[0]) || (sk_av_stat[0]!=sasON))  &&
;;;5219             ((!SK_REL_EN[1]) || (sk_av_stat[1]!=sasON))  &&
;;;5220             ((!SK_REL_EN[2]) || (sk_av_stat[2]!=sasON))  &&
;;;5221             ((!SK_REL_EN[3]) || (sk_av_stat[3]!=sasON))*/  )SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_COMM,1);
;;;5222        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_COMM,1);
;;;5223   	}
;;;5224   	
;;;5225   
;;;5226   //Реле освещения
;;;5227   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LIGHT))
;;;5228   	{
;;;5229   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;5230   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;5231        }
;;;5232   else 
;;;5233   	{
;;;5234   	if(sk_av_stat[0]!=sasON) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;5235        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;5236   	}
;;;5237   
;;;5238   
;;;5239   //Реле выключения нагрузки
;;;5240   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LOAD_OFF))
;;;5241   	{
;;;5242   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;5243   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;5244        }
;;;5245   else if(tloaddisable_cmnd==0)
;;;5246   	{
;;;5247   	SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;5248   	}
;;;5249   else if((tloaddisable_cmnd)&&(tloaddisable_cmnd<=11))
;;;5250   	{
;;;5251   	SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;5252   	}
;;;5253   
;;;5254   else 
;;;5255   	{
;;;5256   	if(!(tloaddisable_stat==tldsON)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;5257        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;5258   	} 
;;;5259   
;;;5260   //Реле осевого вентилятора
;;;5261   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT))
;;;5262   	{
;;;5263   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;5264   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;5265   	}
;;;5266   else 
;;;5267   	{
;;;5268   	if(mixer_vent_stat==mvsOFF) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;5269        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;5270   	} 
;;;5271   
;;;5272   #endif
;;;5273   
;;;5274   #ifdef UKU_KONTUR
;;;5275   
;;;5276   //Реле общей аварии
;;;5277   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_COMM))
;;;5278   	{
;;;5279   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_COMM,1);
;;;5280   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_COMM,1);
;;;5281   	}
;;;5282   else 
;;;5283   	{
;;;5284        if(  (!(avar_ind_stat&0x00007fff)) &&
;;;5285             ((!SK_REL_EN[0]) || (sk_av_stat[0]!=sasON))  &&
;;;5286             ((!SK_REL_EN[1]) || (sk_av_stat[1]!=sasON))  &&
;;;5287             ((!SK_REL_EN[2]) || (sk_av_stat[2]!=sasON))  /*&&
;;;5288             ((!SK_REL_EN[3]) || (sk_av_stat[3]!=sasON))*/  )SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_COMM,1);
;;;5289        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_COMM,1);
;;;5290   	}
;;;5291   
;;;5292   	
;;;5293   //rel_warm_plazma=0;
;;;5294   //Реле освещения   
;;;5295   /*
;;;5296   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_WARM))
;;;5297   	{
;;;5298   	if(mess_data[1]==0)
;;;5299   		{
;;;5300   		SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;5301   		rel_warm_plazma=1;
;;;5302   		}
;;;5303   	else if(mess_data[1]==1) 
;;;5304   		{
;;;5305   		SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;5306   		rel_warm_plazma=2;
;;;5307   		}
;;;5308        }
;;;5309   else 
;;;5310   	{
;;;5311   	if(warm_stat_k==wsOFF) 
;;;5312   		{
;;;5313   		SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;5314   		rel_warm_plazma=3;
;;;5315   		}
;;;5316        else 
;;;5317   		{
;;;5318   		SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;5319   		rel_warm_plazma=4;
;;;5320   		}
;;;5321   	}
;;;5322   */
;;;5323   //Реле освещения
;;;5324   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LIGHT))
;;;5325   	{
;;;5326   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;5327   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;5328        }
;;;5329   else 
;;;5330   	{
;;;5331   	if(sk_av_stat[0]!=sasON) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;5332        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;5333   	}
;;;5334   
;;;5335   
;;;5336   
;;;5337   //Реле выключения нагрузки
;;;5338   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LOAD_OFF))
;;;5339   	{
;;;5340   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;5341   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;5342        }
;;;5343   else if(tloaddisable_cmnd==0)
;;;5344   	{
;;;5345   	SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;5346   	}
;;;5347   else if((tloaddisable_cmnd)&&(tloaddisable_cmnd<=11))
;;;5348   	{
;;;5349   	SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;5350   	}
;;;5351   
;;;5352   else 
;;;5353   	{
;;;5354   	if(!(tloaddisable_stat==tldsON)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;5355        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;5356   	} 
;;;5357   
;;;5358   //Реле осевого вентилятора или отопителя
;;;5359   if(RELE_LOG)
;;;5360   	{
;;;5361   	if((mess_find_unvol(MESS2RELE_HNDL))&&(mess_data[0]==PARAM_RELE_VENT_WARM))
;;;5362   		{
;;;5363   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;5364   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;5365   		}
;;;5366   	else 
;;;5367   		{
;;;5368   		if(warm_stat_k==wsOFF) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;5369   	     else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;5370   		} 
;;;5371   
;;;5372   	}
;;;5373   else 
;;;5374   	{
;;;5375   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT_WARM))
;;;5376   		{
;;;5377   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;5378   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;5379   		}
;;;5380   	else 
;;;5381   		{
;;;5382   		if(vent_stat_k==vsOFF) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;5383   	     else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;5384   		} 
;;;5385   	}
;;;5386   #endif
;;;5387   
;;;5388   #ifdef UKU_6U
;;;5389   //Реле аварий батарей
;;;5390   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT1))
;;;5391   	{
;;;5392   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT1,1);
;;;5393   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT1,1);
;;;5394        }
;;;5395   else 
;;;5396   	{
;;;5397   	if(!(avar_ind_stat&0x00000002)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT1,1);
;;;5398        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT1,1);
;;;5399   	} 
;;;5400   
;;;5401   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT2))
;;;5402   	{
;;;5403   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;5404   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT2,1);
;;;5405       }
;;;5406   else if(NPN_OUT==npnoRELEAVBAT2)
;;;5407   	{
;;;5408   	if(npn_stat==npnsOFF)//&&(mess_find_unvol(MESS2RELE_HNDL))&&(mess_data[0]==PARAM_RELE_NPN))
;;;5409   		{
;;;5410   		/*if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;5411   		else if(mess_data[1]==1)*/ SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;5412        	}
;;;5413   	else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT2,1);
;;;5414   	}
;;;5415   else 
;;;5416   	{
;;;5417   	if(!(avar_ind_stat&0x00000004)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;5418       else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT2,1);
;;;5419   	} 
;;;5420   
;;;5421   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
;;;5422   	{
;;;5423   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;5424   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;5425        }
;;;5426   else 
;;;5427   	{
;;;5428   	if(!(avar_ind_stat&0x000007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;5429        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;5430   	} 
;;;5431   
;;;5432   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT))
;;;5433   	{
;;;5434   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;5435   	else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;5436   	}
;;;5437   else if((NPN_OUT==npnoRELEVENT))
;;;5438   	{
;;;5439   	if(npn_stat==npnsOFF)//&&(mess_find_unvol(MESS2RELE_HNDL))&&(mess_data[0]==PARAM_RELE_NPN))
;;;5440   		{
;;;5441   		/*if(mess_data[1]==0)*/ SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;5442   		//else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;5443       	}
;;;5444   	else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;5445   	}
;;;5446   else 
;;;5447   	{
;;;5448   	if(!vent_stat) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;5449   	else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;5450   	}
;;;5451   
;;;5452   #endif
;;;5453   
;;;5454   #ifdef UKU_220
;;;5455   //Реле аварий батарей
;;;5456   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT))
;;;5457   	{
;;;5458   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT,1);
;;;5459   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT,1);
;;;5460        }
;;;5461   else 
;;;5462   	{
;;;5463   	if(!(avar_ind_stat&0x00000002)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT,1);
;;;5464        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT,1);
;;;5465   	} 
;;;5466   
;;;5467   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
;;;5468   	{
;;;5469   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;5470   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;5471        }
;;;5472   else 
;;;5473   	{
;;;5474   	if(!(avar_ind_stat&0x000007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;5475        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;5476   	} 
;;;5477   
;;;5478   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT))
;;;5479   	{
;;;5480   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;5481   	else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;5482   	}
;;;5483   else 
;;;5484   	{
;;;5485   	if((RELE_VENT_LOGIC==0)||(RELE_VENT_LOGIC==1))
;;;5486   		{
;;;5487   		if(vent_stat) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;5488   		else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;5489   		}
;;;5490   	else 
;;;5491   		{
;;;5492   		if((avar_ind_stat&0x00000004)) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;5493        	else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;5494   		}
;;;5495   	}
;;;5496   
;;;5497   #endif
;;;5498   
;;;5499   #ifdef UKU_220_V2
;;;5500   //Реле аварий батарей
;;;5501   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT))
;;;5502   	{
;;;5503   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT,1);
;;;5504   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT,1);
;;;5505        }
;;;5506   else 
;;;5507   	{
;;;5508   	if(!(avar_ind_stat&0x00000002)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT,1);
;;;5509        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT,1);
;;;5510   	} 
;;;5511   
;;;5512   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
;;;5513   	{
;;;5514   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;5515   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;5516        }
;;;5517   else 
;;;5518   	{
;;;5519   	if(!(avar_ind_stat&0x000007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;5520        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;5521   	} 
;;;5522   
;;;5523   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT))
;;;5524   	{
;;;5525   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;5526   	else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;5527   	}
;;;5528   else 
;;;5529   	{
;;;5530   	if((RELE_VENT_LOGIC==0)||(RELE_VENT_LOGIC==1))
;;;5531   		{
;;;5532   		if(vent_stat) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;5533   		else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;5534   		}
;;;5535   	else 
;;;5536   		{
;;;5537   		if((avar_ind_stat&0x00000004)) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;5538        	else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;5539   		}
;;;5540   	}
;;;5541   
;;;5542   #endif
;;;5543   
;;;5544   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;5545   
;;;5546   if((AUSW_MAIN==22010)||(AUSW_MAIN==22011))
003b26  4882              LDR      r0,|L1.15664|
;;;5547   	{
;;;5548   	#ifndef UKU2071x
;;;5549   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;5550   		{
;;;5551   		if(mess_data[1]==0) SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;5552   		else SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;5553   		}
;;;5554   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;5555   	else SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;5556   	#endif
;;;5557   
;;;5558   	#ifdef UKU2071x
;;;5559   		#ifndef APSENERGIA
;;;5560   		if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;5561   			{
;;;5562   			if(mess_data[1]==0) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;5563   			else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;5564   			}
;;;5565   		else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;5566   		else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;5567   		#endif
;;;5568   
;;;5569   		#ifdef APSENERGIA
;;;5570   		if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;5571   			{
;;;5572   			if(mess_data[1]==0) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;5573   			else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;5574   			}
;;;5575   		else if((mess_find_unvol(MESS2RELE_HNDL))&& (mess_data[0]==PARAM_RELE_BAT_IS_DISCHARGED))  SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;5576   		else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;5577   		#endif
;;;5578   
;;;5579   	#endif
;;;5580   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
;;;5581   		{
;;;5582   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
;;;5583   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,7,1);
;;;5584   	     }
;;;5585   	else 
;;;5586   		{
;;;5587   		if(!(avar_ind_stat&0x100007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
;;;5588   	     else SET_REG(LPC_GPIO0->FIOSET,1,7,1);
;;;5589   		} 
;;;5590   
;;;5591   	//Реле аварий батарей
;;;5592   	#ifndef APSENERGIA
;;;5593   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT))
;;;5594   		{
;;;5595   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
;;;5596   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,4,1);
;;;5597        	}
;;;5598   	else 
;;;5599   		{
;;;5600   		if(!(ips_bat_av_stat)) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
003b28  f8df8208          LDR      r8,|L1.15668|
003b2c  4f82              LDR      r7,|L1.15672|
003b2e  8800              LDRH     r0,[r0,#0]            ;5546  ; AUSW_MAIN
003b30  f5a041aa          SUB      r1,r0,#0x5500         ;5546
003b34  39fa              SUBS     r1,r1,#0xfa           ;5546
003b36  d001              BEQ      |L1.15164|
003b38  1e49              SUBS     r1,r1,#1              ;5546
003b3a  d16f              BNE      |L1.15388|
                  |L1.15164|
003b3c  20d2              MOVS     r0,#0xd2              ;5560
003b3e  f7fffffe          BL       mess_find_unvol
003b42  b110              CBZ      r0,|L1.15178|
003b44  6828              LDR      r0,[r5,#0]            ;5560  ; mess_data
003b46  2866              CMP      r0,#0x66              ;5560
003b48  d043              BEQ      |L1.15314|
                  |L1.15178|
003b4a  6830              LDR      r0,[r6,#0]            ;5565  ; avar_ind_stat
003b4c  07c0              LSLS     r0,r0,#31             ;5565
003b4e  d04d              BEQ      |L1.15340|
003b50  6fa0              LDR      r0,[r4,#0x78]         ;5566
003b52  f0407000          ORR      r0,r0,#0x2000000      ;5566
003b56  67a0              STR      r0,[r4,#0x78]         ;5566
                  |L1.15192|
003b58  20d2              MOVS     r0,#0xd2              ;5580
003b5a  f7fffffe          BL       mess_find_unvol
003b5e  b110              CBZ      r0,|L1.15206|
003b60  6828              LDR      r0,[r5,#0]            ;5580  ; mess_data
003b62  286a              CMP      r0,#0x6a              ;5580
003b64  d047              BEQ      |L1.15350|
                  |L1.15206|
003b66  6830              LDR      r0,[r6,#0]            ;5587  ; avar_ind_stat
003b68  4238              TST      r0,r7                 ;5587
003b6a  d052              BEQ      |L1.15378|
003b6c  69a0              LDR      r0,[r4,#0x18]         ;5588
003b6e  f0400080          ORR      r0,r0,#0x80           ;5588
003b72  61a0              STR      r0,[r4,#0x18]         ;5588
                  |L1.15220|
003b74  20d2              MOVS     r0,#0xd2              ;5593
003b76  f7fffffe          BL       mess_find_unvol
003b7a  b110              CBZ      r0,|L1.15234|
003b7c  6828              LDR      r0,[r5,#0]            ;5593  ; mess_data
003b7e  2867              CMP      r0,#0x67              ;5593
003b80  d04d              BEQ      |L1.15390|
                  |L1.15234|
003b82  f8980000          LDRB     r0,[r8,#0]  ; ips_bat_av_stat
003b86  b380              CBZ      r0,|L1.15338|
;;;5601        	else SET_REG(LPC_GPIO0->FIOSET,1,4,1);
003b88  69a0              LDR      r0,[r4,#0x18]
003b8a  f0400010          ORR      r0,r0,#0x10
003b8e  61a0              STR      r0,[r4,#0x18]
003b90  e1f1              B        |L1.16246|
                  |L1.15250|
003b92  6868              LDR      r0,[r5,#4]            ;5101  ; mess_data
003b94  2801              CMP      r0,#1                 ;5101
003b96  d006              BEQ      |L1.15270|
003b98  2800              CMP      r0,#0                 ;5102
003b9a  d1b5              BNE      |L1.15112|
003b9c  69e0              LDR      r0,[r4,#0x1c]         ;5102
003b9e  f0405000          ORR      r0,r0,#0x20000000     ;5102
003ba2  61e0              STR      r0,[r4,#0x1c]         ;5102
003ba4  e7b0              B        |L1.15112|
                  |L1.15270|
003ba6  69a0              LDR      r0,[r4,#0x18]         ;5101
003ba8  f0405000          ORR      r0,r0,#0x20000000     ;5101
003bac  61a0              STR      r0,[r4,#0x18]         ;5101
003bae  e7ab              B        |L1.15112|
                  |L1.15280|
003bb0  6868              LDR      r0,[r5,#4]            ;5121  ; mess_data
003bb2  b120              CBZ      r0,|L1.15294|
003bb4  6fa0              LDR      r0,[r4,#0x78]         ;5122
003bb6  f0407000          ORR      r0,r0,#0x2000000      ;5122
003bba  67a0              STR      r0,[r4,#0x78]         ;5122
003bbc  e7b3              B        |L1.15142|
                  |L1.15294|
003bbe  6fe0              LDR      r0,[r4,#0x7c]         ;5121
003bc0  f0407000          ORR      r0,r0,#0x2000000      ;5121
003bc4  67e0              STR      r0,[r4,#0x7c]         ;5121
003bc6  e7ae              B        |L1.15142|
                  |L1.15304|
003bc8  6fe0              LDR      r0,[r4,#0x7c]         ;5124
003bca  f0407000          ORR      r0,r0,#0x2000000      ;5124
003bce  67e0              STR      r0,[r4,#0x7c]         ;5124
003bd0  e7a9              B        |L1.15142|
                  |L1.15314|
003bd2  6868              LDR      r0,[r5,#4]            ;5562  ; mess_data
003bd4  b120              CBZ      r0,|L1.15328|
003bd6  6fa0              LDR      r0,[r4,#0x78]         ;5563
003bd8  f0407000          ORR      r0,r0,#0x2000000      ;5563
003bdc  67a0              STR      r0,[r4,#0x78]         ;5563
003bde  e7bb              B        |L1.15192|
                  |L1.15328|
003be0  6fe0              LDR      r0,[r4,#0x7c]         ;5562
003be2  f0407000          ORR      r0,r0,#0x2000000      ;5562
003be6  67e0              STR      r0,[r4,#0x7c]         ;5562
003be8  e7b6              B        |L1.15192|
                  |L1.15338|
003bea  e027              B        |L1.15420|
                  |L1.15340|
003bec  6fe0              LDR      r0,[r4,#0x7c]         ;5565
003bee  f0407000          ORR      r0,r0,#0x2000000      ;5565
003bf2  67e0              STR      r0,[r4,#0x7c]         ;5565
003bf4  e7b0              B        |L1.15192|
                  |L1.15350|
003bf6  6868              LDR      r0,[r5,#4]            ;5582  ; mess_data
003bf8  b130              CBZ      r0,|L1.15368|
003bfa  2801              CMP      r0,#1                 ;5583
003bfc  d1ba              BNE      |L1.15220|
003bfe  69a0              LDR      r0,[r4,#0x18]         ;5583
003c00  f0400080          ORR      r0,r0,#0x80           ;5583
003c04  61a0              STR      r0,[r4,#0x18]         ;5583
003c06  e7b5              B        |L1.15220|
                  |L1.15368|
003c08  69e0              LDR      r0,[r4,#0x1c]         ;5582
003c0a  f0400080          ORR      r0,r0,#0x80           ;5582
003c0e  61e0              STR      r0,[r4,#0x1c]         ;5582
003c10  e7b0              B        |L1.15220|
                  |L1.15378|
003c12  69e0              LDR      r0,[r4,#0x1c]         ;5587
003c14  f0400080          ORR      r0,r0,#0x80           ;5587
003c18  61e0              STR      r0,[r4,#0x1c]         ;5587
003c1a  e7ab              B        |L1.15220|
                  |L1.15388|
003c1c  e013              B        |L1.15430|
                  |L1.15390|
003c1e  6868              LDR      r0,[r5,#4]            ;5595  ; mess_data
003c20  b110              CBZ      r0,|L1.15400|
003c22  2801              CMP      r0,#1                 ;5596
003c24  d005              BEQ      |L1.15410|
003c26  e1a6              B        |L1.16246|
                  |L1.15400|
003c28  69e0              LDR      r0,[r4,#0x1c]         ;5595
003c2a  f0400010          ORR      r0,r0,#0x10           ;5595
003c2e  61e0              STR      r0,[r4,#0x1c]         ;5595
003c30  e1a1              B        |L1.16246|
                  |L1.15410|
003c32  69a0              LDR      r0,[r4,#0x18]         ;5596
003c34  f0400010          ORR      r0,r0,#0x10           ;5596
003c38  61a0              STR      r0,[r4,#0x18]         ;5596
003c3a  e19c              B        |L1.16246|
                  |L1.15420|
003c3c  69e0              LDR      r0,[r4,#0x1c]         ;5600
003c3e  f0400010          ORR      r0,r0,#0x10           ;5600
003c42  61e0              STR      r0,[r4,#0x1c]         ;5600
003c44  e197              B        |L1.16246|
                  |L1.15430|
;;;5602   		}
;;;5603   	#endif
;;;5604   	#ifdef APSENERGIA
;;;5605   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT))
;;;5606   		{
;;;5607   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
;;;5608   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,4,1);
;;;5609        	}
;;;5610   	else 
;;;5611   		{
;;;5612   		if(!apsEnergiaStat)SET_REG(LPC_GPIO0->FIOSET,1,4,1);
;;;5613   		else SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
;;;5614   		}
;;;5615   	#endif
;;;5616   	}
;;;5617   
;;;5618   else	if(AUSW_MAIN==22023)
003c46  f5a041ac          SUB      r1,r0,#0x5600
003c4a  3907              SUBS     r1,#7
003c4c  d176              BNE      |L1.15676|
;;;5619   	{
;;;5620   
;;;5621   	//Реле аварий батарей
;;;5622   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT))
003c4e  20d2              MOVS     r0,#0xd2
003c50  f7fffffe          BL       mess_find_unvol
003c54  b110              CBZ      r0,|L1.15452|
003c56  6828              LDR      r0,[r5,#0]  ; mess_data
003c58  2867              CMP      r0,#0x67
003c5a  d023              BEQ      |L1.15524|
                  |L1.15452|
;;;5623   		{
;;;5624   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
;;;5625   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,4,1);
;;;5626        	}
;;;5627   	else 
;;;5628   		{
;;;5629   		if(!(ips_bat_av_stat)) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
003c5c  f8980000          LDRB     r0,[r8,#0]  ; ips_bat_av_stat
003c60  b370              CBZ      r0,|L1.15552|
;;;5630        	else SET_REG(LPC_GPIO0->FIOSET,1,4,1);
003c62  69a0              LDR      r0,[r4,#0x18]
003c64  f0400010          ORR      r0,r0,#0x10
003c68  61a0              STR      r0,[r4,#0x18]
                  |L1.15466|
;;;5631   		} 
;;;5632   
;;;5633   
;;;5634   	//Реле аварии сети ТУТ КАКАЯ то ЛАЖА с аварией сети. Обращение к разным портам
;;;5635   	#ifndef UKU2071x
;;;5636   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;5637   		{
;;;5638   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5639   		else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;5640   		}
;;;5641   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO1->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5642   	else SET_REG(LPC_GPIO3->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5643   	#endif
;;;5644   	#ifdef UKU2071x
;;;5645   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
003c6a  20d2              MOVS     r0,#0xd2
003c6c  f7fffffe          BL       mess_find_unvol
003c70  b110              CBZ      r0,|L1.15480|
003c72  6828              LDR      r0,[r5,#0]  ; mess_data
003c74  2866              CMP      r0,#0x66
003c76  d028              BEQ      |L1.15562|
                  |L1.15480|
;;;5646   		{
;;;5647   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;5648   		else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5649   		}
;;;5650   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO1->FIOSET,1,SHIFT_REL_AV_NET,1);
003c78  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
003c7a  07c0              LSLS     r0,r0,#31
003c7c  d031              BEQ      |L1.15586|
;;;5651   	else SET_REG(LPC_GPIO3->FIOSET,1,SHIFT_REL_AV_NET,1);
003c7e  6fa0              LDR      r0,[r4,#0x78]
003c80  f0407000          ORR      r0,r0,#0x2000000
003c84  67a0              STR      r0,[r4,#0x78]
                  |L1.15494|
;;;5652   	#endif
;;;5653   
;;;5654   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
003c86  20d2              MOVS     r0,#0xd2
003c88  f7fffffe          BL       mess_find_unvol
003c8c  b110              CBZ      r0,|L1.15508|
003c8e  6828              LDR      r0,[r5,#0]  ; mess_data
003c90  286a              CMP      r0,#0x6a
003c92  d02b              BEQ      |L1.15596|
                  |L1.15508|
;;;5655   		{
;;;5656   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
;;;5657   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,7,1);
;;;5658   	     }
;;;5659   	else 
;;;5660   		{
;;;5661   		if(!(avar_ind_stat&0x100007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
003c94  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
003c96  4238              TST      r0,r7
003c98  d056              BEQ      |L1.15688|
;;;5662   	     else SET_REG(LPC_GPIO0->FIOSET,1,7,1);
003c9a  69a0              LDR      r0,[r4,#0x18]
003c9c  f0400080          ORR      r0,r0,#0x80
003ca0  61a0              STR      r0,[r4,#0x18]
003ca2  e168              B        |L1.16246|
                  |L1.15524|
003ca4  6868              LDR      r0,[r5,#4]            ;5624  ; mess_data
003ca6  b130              CBZ      r0,|L1.15542|
003ca8  2801              CMP      r0,#1                 ;5625
003caa  d1de              BNE      |L1.15466|
003cac  69a0              LDR      r0,[r4,#0x18]         ;5625
003cae  f0400010          ORR      r0,r0,#0x10           ;5625
003cb2  61a0              STR      r0,[r4,#0x18]         ;5625
003cb4  e7d9              B        |L1.15466|
                  |L1.15542|
003cb6  69e0              LDR      r0,[r4,#0x1c]         ;5624
003cb8  f0400010          ORR      r0,r0,#0x10           ;5624
003cbc  61e0              STR      r0,[r4,#0x1c]         ;5624
003cbe  e7d4              B        |L1.15466|
                  |L1.15552|
003cc0  69e0              LDR      r0,[r4,#0x1c]         ;5629
003cc2  f0400010          ORR      r0,r0,#0x10           ;5629
003cc6  61e0              STR      r0,[r4,#0x1c]         ;5629
003cc8  e7cf              B        |L1.15466|
                  |L1.15562|
003cca  6868              LDR      r0,[r5,#4]            ;5647  ; mess_data
003ccc  b120              CBZ      r0,|L1.15576|
003cce  69e0              LDR      r0,[r4,#0x1c]         ;5648
003cd0  f0407000          ORR      r0,r0,#0x2000000      ;5648
003cd4  61e0              STR      r0,[r4,#0x1c]         ;5648
003cd6  e7d6              B        |L1.15494|
                  |L1.15576|
003cd8  69a0              LDR      r0,[r4,#0x18]         ;5647
003cda  f0407000          ORR      r0,r0,#0x2000000      ;5647
003cde  61a0              STR      r0,[r4,#0x18]         ;5647
003ce0  e7d1              B        |L1.15494|
                  |L1.15586|
003ce2  6ba0              LDR      r0,[r4,#0x38]         ;5650
003ce4  f0407000          ORR      r0,r0,#0x2000000      ;5650
003ce8  63a0              STR      r0,[r4,#0x38]         ;5650
003cea  e7cc              B        |L1.15494|
                  |L1.15596|
003cec  6868              LDR      r0,[r5,#4]            ;5656  ; mess_data
003cee  b110              CBZ      r0,|L1.15606|
003cf0  2801              CMP      r0,#1                 ;5657
003cf2  d024              BEQ      |L1.15678|
003cf4  e13f              B        |L1.16246|
                  |L1.15606|
003cf6  69e0              LDR      r0,[r4,#0x1c]         ;5656
003cf8  f0400080          ORR      r0,r0,#0x80           ;5656
003cfc  61e0              STR      r0,[r4,#0x1c]         ;5656
003cfe  e13a              B        |L1.16246|
                  |L1.15616|
                          DCD      bps
                  |L1.15620|
                          DCD      NUMIST
                  |L1.15624|
                          DCD      ||area_number.26||+0x80
                  |L1.15628|
                          DCD      0x4002c000
                  |L1.15632|
                          DCD      0xfff000ff
                  |L1.15636|
                          DCD      0x2009c000
                  |L1.15640|
                          DCD      bat
                  |L1.15644|
                          DCD      tbatdisable_stat
                  |L1.15648|
                          DCD      tbatdisable_cmnd
                  |L1.15652|
                          DCD      main_1Hz_cnt
                  |L1.15656|
                          DCD      mess_data
                  |L1.15660|
                          DCD      avar_ind_stat
                  |L1.15664|
                          DCD      AUSW_MAIN
                  |L1.15668|
                          DCD      ips_bat_av_stat
                  |L1.15672|
                          DCD      0x100007f8
                  |L1.15676|
003d3c  e009              B        |L1.15698|
                  |L1.15678|
003d3e  69a0              LDR      r0,[r4,#0x18]         ;5657
003d40  f0400080          ORR      r0,r0,#0x80           ;5657
003d44  61a0              STR      r0,[r4,#0x18]         ;5657
003d46  e116              B        |L1.16246|
                  |L1.15688|
003d48  69e0              LDR      r0,[r4,#0x1c]         ;5661
003d4a  f0400080          ORR      r0,r0,#0x80           ;5661
003d4e  61e0              STR      r0,[r4,#0x1c]         ;5661
003d50  e111              B        |L1.16246|
                  |L1.15698|
;;;5663   		} 
;;;5664   	}
;;;5665   else	if((AUSW_MAIN==22043)||(AUSW_MAIN==22044))
003d52  f5a041ac          SUB      r1,r0,#0x5600
003d56  391b              SUBS     r1,r1,#0x1b
003d58  d001              BEQ      |L1.15710|
003d5a  1e49              SUBS     r1,r1,#1
003d5c  d170              BNE      |L1.15936|
                  |L1.15710|
;;;5666   	{
;;;5667   	//Реле аварий батарей
;;;5668   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT))
003d5e  20d2              MOVS     r0,#0xd2
003d60  f7fffffe          BL       mess_find_unvol
003d64  b110              CBZ      r0,|L1.15724|
003d66  6828              LDR      r0,[r5,#0]  ; mess_data
003d68  2867              CMP      r0,#0x67
003d6a  d031              BEQ      |L1.15824|
                  |L1.15724|
;;;5669   		{
;;;5670   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
;;;5671   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,4,1);
;;;5672        	}
;;;5673   	else 
;;;5674   		{
;;;5675   		if(!(ips_bat_av_stat)) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
003d6c  f8980000          LDRB     r0,[r8,#0]  ; ips_bat_av_stat
003d70  b3b8              CBZ      r0,|L1.15842|
;;;5676        	else SET_REG(LPC_GPIO0->FIOSET,1,4,1);
003d72  69a0              LDR      r0,[r4,#0x18]
003d74  f0400010          ORR      r0,r0,#0x10
003d78  61a0              STR      r0,[r4,#0x18]
                  |L1.15738|
;;;5677   		} 
;;;5678   	//Реле аварии сети ТУТ КАКАЯ то ЛАЖА с аварией сети. Обращение к разным портам
;;;5679   	#ifndef UKU2071x 
;;;5680   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;5681   		{
;;;5682   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5683   		else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;5684   		}
;;;5685   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO1->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5686   	else SET_REG(LPC_GPIO3->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5687   	#endif
;;;5688   	#ifdef UKU2071x 
;;;5689   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
003d7a  20d2              MOVS     r0,#0xd2
003d7c  f7fffffe          BL       mess_find_unvol
003d80  b110              CBZ      r0,|L1.15752|
003d82  6828              LDR      r0,[r5,#0]  ; mess_data
003d84  2866              CMP      r0,#0x66
003d86  d037              BEQ      |L1.15864|
                  |L1.15752|
;;;5690   		{
;;;5691   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;5692   		else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5693   		}
;;;5694   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO1->FIOSET,1,SHIFT_REL_AV_NET,1);
003d88  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
003d8a  07c0              LSLS     r0,r0,#31
003d8c  d040              BEQ      |L1.15888|
;;;5695   	else SET_REG(LPC_GPIO3->FIOSET,1,SHIFT_REL_AV_NET,1);
003d8e  6fa0              LDR      r0,[r4,#0x78]
003d90  f0407000          ORR      r0,r0,#0x2000000
003d94  67a0              STR      r0,[r4,#0x78]
                  |L1.15766|
;;;5696   	#endif
;;;5697   
;;;5698   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
003d96  20d2              MOVS     r0,#0xd2
003d98  f7fffffe          BL       mess_find_unvol
003d9c  b110              CBZ      r0,|L1.15780|
003d9e  6828              LDR      r0,[r5,#0]  ; mess_data
003da0  286a              CMP      r0,#0x6a
003da2  d03a              BEQ      |L1.15898|
                  |L1.15780|
;;;5699   		{
;;;5700   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
;;;5701   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,7,1);
;;;5702   	     }
;;;5703   	else 
;;;5704   		{
;;;5705   		if(!(avar_ind_stat&0x100007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
003da4  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
003da6  4238              TST      r0,r7
003da8  d045              BEQ      |L1.15926|
;;;5706   	     else SET_REG(LPC_GPIO0->FIOSET,1,7,1);
003daa  69a0              LDR      r0,[r4,#0x18]
003dac  f0400080          ORR      r0,r0,#0x80
003db0  61a0              STR      r0,[r4,#0x18]
                  |L1.15794|
;;;5707   		}
;;;5708   	//Реле аварии БПС
;;;5709   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
003db2  20d2              MOVS     r0,#0xd2
003db4  f7fffffe          BL       mess_find_unvol
003db8  b110              CBZ      r0,|L1.15808|
003dba  6828              LDR      r0,[r5,#0]  ; mess_data
003dbc  286a              CMP      r0,#0x6a
003dbe  d040              BEQ      |L1.15938|
                  |L1.15808|
;;;5710   		{
;;;5711   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;5712   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;5713        	}
;;;5714   	else 
;;;5715   		{
;;;5716   		if(!(avar_ind_stat&0x100007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
003dc0  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
003dc2  4238              TST      r0,r7
003dc4  d04c              BEQ      |L1.15968|
;;;5717        	else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
003dc6  69a0              LDR      r0,[r4,#0x18]
003dc8  f0400020          ORR      r0,r0,#0x20
003dcc  61a0              STR      r0,[r4,#0x18]
003dce  e0d2              B        |L1.16246|
                  |L1.15824|
003dd0  6868              LDR      r0,[r5,#4]            ;5670  ; mess_data
003dd2  b138              CBZ      r0,|L1.15844|
003dd4  2801              CMP      r0,#1                 ;5671
003dd6  d1d0              BNE      |L1.15738|
003dd8  69a0              LDR      r0,[r4,#0x18]         ;5671
003dda  f0400010          ORR      r0,r0,#0x10           ;5671
003dde  61a0              STR      r0,[r4,#0x18]         ;5671
003de0  e7cb              B        |L1.15738|
                  |L1.15842|
003de2  e004              B        |L1.15854|
                  |L1.15844|
003de4  69e0              LDR      r0,[r4,#0x1c]         ;5670
003de6  f0400010          ORR      r0,r0,#0x10           ;5670
003dea  61e0              STR      r0,[r4,#0x1c]         ;5670
003dec  e7c5              B        |L1.15738|
                  |L1.15854|
003dee  69e0              LDR      r0,[r4,#0x1c]         ;5675
003df0  f0400010          ORR      r0,r0,#0x10           ;5675
003df4  61e0              STR      r0,[r4,#0x1c]         ;5675
003df6  e7c0              B        |L1.15738|
                  |L1.15864|
003df8  6868              LDR      r0,[r5,#4]            ;5691  ; mess_data
003dfa  b120              CBZ      r0,|L1.15878|
003dfc  69e0              LDR      r0,[r4,#0x1c]         ;5692
003dfe  f0407000          ORR      r0,r0,#0x2000000      ;5692
003e02  61e0              STR      r0,[r4,#0x1c]         ;5692
003e04  e7c7              B        |L1.15766|
                  |L1.15878|
003e06  69a0              LDR      r0,[r4,#0x18]         ;5691
003e08  f0407000          ORR      r0,r0,#0x2000000      ;5691
003e0c  61a0              STR      r0,[r4,#0x18]         ;5691
003e0e  e7c2              B        |L1.15766|
                  |L1.15888|
003e10  6ba0              LDR      r0,[r4,#0x38]         ;5694
003e12  f0407000          ORR      r0,r0,#0x2000000      ;5694
003e16  63a0              STR      r0,[r4,#0x38]         ;5694
003e18  e7bd              B        |L1.15766|
                  |L1.15898|
003e1a  6868              LDR      r0,[r5,#4]            ;5700  ; mess_data
003e1c  b130              CBZ      r0,|L1.15916|
003e1e  2801              CMP      r0,#1                 ;5701
003e20  d1c7              BNE      |L1.15794|
003e22  69a0              LDR      r0,[r4,#0x18]         ;5701
003e24  f0400080          ORR      r0,r0,#0x80           ;5701
003e28  61a0              STR      r0,[r4,#0x18]         ;5701
003e2a  e7c2              B        |L1.15794|
                  |L1.15916|
003e2c  69e0              LDR      r0,[r4,#0x1c]         ;5700
003e2e  f0400080          ORR      r0,r0,#0x80           ;5700
003e32  61e0              STR      r0,[r4,#0x1c]         ;5700
003e34  e7bd              B        |L1.15794|
                  |L1.15926|
003e36  69e0              LDR      r0,[r4,#0x1c]         ;5705
003e38  f0400080          ORR      r0,r0,#0x80           ;5705
003e3c  61e0              STR      r0,[r4,#0x1c]         ;5705
003e3e  e7b8              B        |L1.15794|
                  |L1.15936|
003e40  e013              B        |L1.15978|
                  |L1.15938|
003e42  6868              LDR      r0,[r5,#4]            ;5711  ; mess_data
003e44  b110              CBZ      r0,|L1.15948|
003e46  2801              CMP      r0,#1                 ;5712
003e48  d005              BEQ      |L1.15958|
003e4a  e094              B        |L1.16246|
                  |L1.15948|
003e4c  69e0              LDR      r0,[r4,#0x1c]         ;5711
003e4e  f0400020          ORR      r0,r0,#0x20           ;5711
003e52  61e0              STR      r0,[r4,#0x1c]         ;5711
003e54  e08f              B        |L1.16246|
                  |L1.15958|
003e56  69a0              LDR      r0,[r4,#0x18]         ;5712
003e58  f0400020          ORR      r0,r0,#0x20           ;5712
003e5c  61a0              STR      r0,[r4,#0x18]         ;5712
003e5e  e08a              B        |L1.16246|
                  |L1.15968|
003e60  69e0              LDR      r0,[r4,#0x1c]         ;5716
003e62  f0400020          ORR      r0,r0,#0x20           ;5716
003e66  61e0              STR      r0,[r4,#0x1c]         ;5716
003e68  e085              B        |L1.16246|
                  |L1.15978|
;;;5718   		} 
;;;5719   	}
;;;5720   else	if((AUSW_MAIN==22033)||(AUSW_MAIN==22018))
003e6a  f5a041ac          SUB      r1,r0,#0x5600
003e6e  3911              SUBS     r1,r1,#0x11
003e70  d001              BEQ      |L1.15990|
003e72  310f              ADDS     r1,r1,#0xf
003e74  d163              BNE      |L1.16190|
                  |L1.15990|
;;;5721   	{
;;;5722   	#ifndef UKU2071x 
;;;5723   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;5724   		{
;;;5725   		if(mess_data[1]==0) SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;5726   		else SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;5727   		}
;;;5728   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;5729   	else SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;5730   	#endif
;;;5731   	#ifdef UKU2071x 
;;;5732   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
003e76  20d2              MOVS     r0,#0xd2
003e78  f7fffffe          BL       mess_find_unvol
003e7c  b110              CBZ      r0,|L1.16004|
003e7e  6828              LDR      r0,[r5,#0]  ; mess_data
003e80  2866              CMP      r0,#0x66
003e82  d023              BEQ      |L1.16076|
                  |L1.16004|
;;;5733   		{
;;;5734   		if(mess_data[1]==0) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;5735   		else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;5736   		}
;;;5737   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
003e84  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
003e86  07c0              LSLS     r0,r0,#31
003e88  d02c              BEQ      |L1.16100|
;;;5738   	else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
003e8a  6fa0              LDR      r0,[r4,#0x78]
003e8c  f0407000          ORR      r0,r0,#0x2000000
003e90  67a0              STR      r0,[r4,#0x78]
                  |L1.16018|
;;;5739   	#endif
;;;5740   	
;;;5741   	
;;;5742   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
003e92  20d2              MOVS     r0,#0xd2
003e94  f7fffffe          BL       mess_find_unvol
003e98  b110              CBZ      r0,|L1.16032|
003e9a  6828              LDR      r0,[r5,#0]  ; mess_data
003e9c  286a              CMP      r0,#0x6a
003e9e  d026              BEQ      |L1.16110|
                  |L1.16032|
;;;5743   		{
;;;5744   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
;;;5745   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,7,1);
;;;5746   	     }
;;;5747   	else 
;;;5748   		{
;;;5749   		if(!(avar_ind_stat&0x100007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
003ea0  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
003ea2  4238              TST      r0,r7
003ea4  d031              BEQ      |L1.16138|
;;;5750   	     else SET_REG(LPC_GPIO0->FIOSET,1,7,1);
003ea6  69a0              LDR      r0,[r4,#0x18]
003ea8  f0400080          ORR      r0,r0,#0x80
003eac  61a0              STR      r0,[r4,#0x18]
                  |L1.16046|
;;;5751   		} 
;;;5752   
;;;5753   	//Реле аварий батарей
;;;5754   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT))
003eae  20d2              MOVS     r0,#0xd2
003eb0  f7fffffe          BL       mess_find_unvol
003eb4  b110              CBZ      r0,|L1.16060|
003eb6  6828              LDR      r0,[r5,#0]  ; mess_data
003eb8  2867              CMP      r0,#0x67
003eba  d02b              BEQ      |L1.16148|
                  |L1.16060|
;;;5755   		{
;;;5756   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
;;;5757   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,4,1);
;;;5758        	}
;;;5759   	else 
;;;5760   		{
;;;5761   		if(!(ips_bat_av_stat)) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
003ebc  f8980000          LDRB     r0,[r8,#0]  ; ips_bat_av_stat
003ec0  b390              CBZ      r0,|L1.16168|
;;;5762        	else SET_REG(LPC_GPIO0->FIOSET,1,4,1);
003ec2  69a0              LDR      r0,[r4,#0x18]
003ec4  f0400010          ORR      r0,r0,#0x10
003ec8  61a0              STR      r0,[r4,#0x18]
003eca  e054              B        |L1.16246|
                  |L1.16076|
003ecc  6868              LDR      r0,[r5,#4]            ;5734  ; mess_data
003ece  b120              CBZ      r0,|L1.16090|
003ed0  6fa0              LDR      r0,[r4,#0x78]         ;5735
003ed2  f0407000          ORR      r0,r0,#0x2000000      ;5735
003ed6  67a0              STR      r0,[r4,#0x78]         ;5735
003ed8  e7db              B        |L1.16018|
                  |L1.16090|
003eda  6fe0              LDR      r0,[r4,#0x7c]         ;5734
003edc  f0407000          ORR      r0,r0,#0x2000000      ;5734
003ee0  67e0              STR      r0,[r4,#0x7c]         ;5734
003ee2  e7d6              B        |L1.16018|
                  |L1.16100|
003ee4  6fe0              LDR      r0,[r4,#0x7c]         ;5737
003ee6  f0407000          ORR      r0,r0,#0x2000000      ;5737
003eea  67e0              STR      r0,[r4,#0x7c]         ;5737
003eec  e7d1              B        |L1.16018|
                  |L1.16110|
003eee  6868              LDR      r0,[r5,#4]            ;5744  ; mess_data
003ef0  b130              CBZ      r0,|L1.16128|
003ef2  2801              CMP      r0,#1                 ;5745
003ef4  d1db              BNE      |L1.16046|
003ef6  69a0              LDR      r0,[r4,#0x18]         ;5745
003ef8  f0400080          ORR      r0,r0,#0x80           ;5745
003efc  61a0              STR      r0,[r4,#0x18]         ;5745
003efe  e7d6              B        |L1.16046|
                  |L1.16128|
003f00  69e0              LDR      r0,[r4,#0x1c]         ;5744
003f02  f0400080          ORR      r0,r0,#0x80           ;5744
003f06  61e0              STR      r0,[r4,#0x1c]         ;5744
003f08  e7d1              B        |L1.16046|
                  |L1.16138|
003f0a  69e0              LDR      r0,[r4,#0x1c]         ;5749
003f0c  f0400080          ORR      r0,r0,#0x80           ;5749
003f10  61e0              STR      r0,[r4,#0x1c]         ;5749
003f12  e7cc              B        |L1.16046|
                  |L1.16148|
003f14  6868              LDR      r0,[r5,#4]            ;5756  ; mess_data
003f16  b110              CBZ      r0,|L1.16158|
003f18  2801              CMP      r0,#1                 ;5757
003f1a  d006              BEQ      |L1.16170|
003f1c  e02b              B        |L1.16246|
                  |L1.16158|
003f1e  69e0              LDR      r0,[r4,#0x1c]         ;5756
003f20  f0400010          ORR      r0,r0,#0x10           ;5756
003f24  61e0              STR      r0,[r4,#0x1c]         ;5756
003f26  e026              B        |L1.16246|
                  |L1.16168|
003f28  e004              B        |L1.16180|
                  |L1.16170|
003f2a  69a0              LDR      r0,[r4,#0x18]         ;5757
003f2c  f0400010          ORR      r0,r0,#0x10           ;5757
003f30  61a0              STR      r0,[r4,#0x18]         ;5757
003f32  e020              B        |L1.16246|
                  |L1.16180|
003f34  69e0              LDR      r0,[r4,#0x1c]         ;5761
003f36  f0400010          ORR      r0,r0,#0x10           ;5761
003f3a  61e0              STR      r0,[r4,#0x1c]         ;5761
003f3c  e01b              B        |L1.16246|
                  |L1.16190|
;;;5763   		} 
;;;5764   	} 	 
;;;5765   else	
;;;5766   	{
;;;5767   	//Реле аварии сети ТУТ КАКАЯ то ЛАЖА с аварией сети. Обращение к разным портам
;;;5768   	#ifndef UKU2071x 
;;;5769   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;5770   		{
;;;5771   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5772   		else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;5773   		}
;;;5774   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO1->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5775   	else SET_REG(LPC_GPIO3->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5776   	#endif
;;;5777   	#ifdef UKU2071x 
;;;5778   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
003f3e  20d2              MOVS     r0,#0xd2
003f40  f7fffffe          BL       mess_find_unvol
003f44  b110              CBZ      r0,|L1.16204|
003f46  6828              LDR      r0,[r5,#0]  ; mess_data
003f48  2866              CMP      r0,#0x66
003f4a  d026              BEQ      |L1.16282|
                  |L1.16204|
;;;5779   		{
;;;5780   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;5781   		else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5782   		}
;;;5783   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO1->FIOSET,1,SHIFT_REL_AV_NET,1);
003f4c  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
003f4e  07c0              LSLS     r0,r0,#31
003f50  d02f              BEQ      |L1.16306|
;;;5784   	else SET_REG(LPC_GPIO3->FIOSET,1,SHIFT_REL_AV_NET,1);
003f52  6fa0              LDR      r0,[r4,#0x78]
003f54  f0407000          ORR      r0,r0,#0x2000000
003f58  67a0              STR      r0,[r4,#0x78]
                  |L1.16218|
;;;5785   	#endif
;;;5786   
;;;5787   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
003f5a  20d2              MOVS     r0,#0xd2
003f5c  f7fffffe          BL       mess_find_unvol
003f60  b110              CBZ      r0,|L1.16232|
003f62  6828              LDR      r0,[r5,#0]  ; mess_data
003f64  286a              CMP      r0,#0x6a
003f66  d029              BEQ      |L1.16316|
                  |L1.16232|
;;;5788   		{
;;;5789   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;5790   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;5791        	}
;;;5792   	else 
;;;5793   		{
;;;5794   		if(!(avar_ind_stat&0x100007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
003f68  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
003f6a  4238              TST      r0,r7
003f6c  d034              BEQ      |L1.16344|
;;;5795        	else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
003f6e  69a0              LDR      r0,[r4,#0x18]
003f70  f0400020          ORR      r0,r0,#0x20
003f74  61a0              STR      r0,[r4,#0x18]
                  |L1.16246|
;;;5796   		}
;;;5797   	}
;;;5798   //Дополнительное реле УКУ 
;;;5799   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_EXT))	 
003f76  20d2              MOVS     r0,#0xd2
003f78  f7fffffe          BL       mess_find_unvol
;;;5800   	{
;;;5801   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,9,1);
;;;5802   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,9,1);
;;;5803   	}
;;;5804   else if(DOP_RELE_FUNC==0)	//если допреле подключено к ускоренному заряду
;;;5805   	{
;;;5806   	if((!speedChIsOn)&&(spc_stat!=spcVZ)&&(hv_vz_stat==hvsOFF)&&(sp_ch_stat==scsOFF)&&(vz1_stat==vz1sOFF)&&(vz2_stat==vz2sOFF)&&(load_U/10<UVENTOFF))   SET_REG(LPC_GPIO0->FIOCLR,1,9,1);
003f7c  f8df83f8          LDR      r8,|L1.17272|
003f80  4ffe              LDR      r7,|L1.17276|
003f82  4eff              LDR      r6,|L1.17280|
003f84  b110              CBZ      r0,|L1.16268|
003f86  6828              LDR      r0,[r5,#0]            ;5799  ; mess_data
003f88  2871              CMP      r0,#0x71              ;5799
003f8a  d02a              BEQ      |L1.16354|
                  |L1.16268|
003f8c  48fd              LDR      r0,|L1.17284|
003f8e  f9b00000          LDRSH    r0,[r0,#0]            ;5804  ; DOP_RELE_FUNC
003f92  b380              CBZ      r0,|L1.16374|
;;;5807   	else if((speedChIsOn)||(spc_stat==spcVZ)||(hv_vz_stat!=hvsOFF)||(sp_ch_stat!=scsOFF)||(vz1_stat!=vz1sOFF)||(vz2_stat!=vz2sOFF)) SET_REG(LPC_GPIO0->FIOSET,1,9,1);
;;;5808   	}
;;;5809   else if(DOP_RELE_FUNC==1)  //если допреле подключено к индикации разряженной батареи
003f94  2801              CMP      r0,#1
003f96  d066              BEQ      |L1.16486|
003f98  e070              B        |L1.16508|
                  |L1.16282|
003f9a  6868              LDR      r0,[r5,#4]            ;5780  ; mess_data
003f9c  b120              CBZ      r0,|L1.16296|
003f9e  69e0              LDR      r0,[r4,#0x1c]         ;5781
003fa0  f0407000          ORR      r0,r0,#0x2000000      ;5781
003fa4  61e0              STR      r0,[r4,#0x1c]         ;5781
003fa6  e7d8              B        |L1.16218|
                  |L1.16296|
003fa8  69a0              LDR      r0,[r4,#0x18]         ;5780
003faa  f0407000          ORR      r0,r0,#0x2000000      ;5780
003fae  61a0              STR      r0,[r4,#0x18]         ;5780
003fb0  e7d3              B        |L1.16218|
                  |L1.16306|
003fb2  6ba0              LDR      r0,[r4,#0x38]         ;5783
003fb4  f0407000          ORR      r0,r0,#0x2000000      ;5783
003fb8  63a0              STR      r0,[r4,#0x38]         ;5783
003fba  e7ce              B        |L1.16218|
                  |L1.16316|
003fbc  6868              LDR      r0,[r5,#4]            ;5789  ; mess_data
003fbe  b130              CBZ      r0,|L1.16334|
003fc0  2801              CMP      r0,#1                 ;5790
003fc2  d1d8              BNE      |L1.16246|
003fc4  69a0              LDR      r0,[r4,#0x18]         ;5790
003fc6  f0400020          ORR      r0,r0,#0x20           ;5790
003fca  61a0              STR      r0,[r4,#0x18]         ;5790
003fcc  e7d3              B        |L1.16246|
                  |L1.16334|
003fce  69e0              LDR      r0,[r4,#0x1c]         ;5789
003fd0  f0400020          ORR      r0,r0,#0x20           ;5789
003fd4  61e0              STR      r0,[r4,#0x1c]         ;5789
003fd6  e7ce              B        |L1.16246|
                  |L1.16344|
003fd8  69e0              LDR      r0,[r4,#0x1c]         ;5794
003fda  f0400020          ORR      r0,r0,#0x20           ;5794
003fde  61e0              STR      r0,[r4,#0x1c]         ;5794
003fe0  e7c9              B        |L1.16246|
                  |L1.16354|
003fe2  6868              LDR      r0,[r5,#4]            ;5801  ; mess_data
003fe4  b110              CBZ      r0,|L1.16364|
003fe6  2801              CMP      r0,#1                 ;5802
003fe8  d006              BEQ      |L1.16376|
003fea  e047              B        |L1.16508|
                  |L1.16364|
003fec  69e0              LDR      r0,[r4,#0x1c]         ;5801
003fee  f4407000          ORR      r0,r0,#0x200          ;5801
003ff2  61e0              STR      r0,[r4,#0x1c]         ;5801
003ff4  e042              B        |L1.16508|
                  |L1.16374|
003ff6  e004              B        |L1.16386|
                  |L1.16376|
003ff8  69a0              LDR      r0,[r4,#0x18]         ;5802
003ffa  f4407000          ORR      r0,r0,#0x200          ;5802
003ffe  61a0              STR      r0,[r4,#0x18]         ;5802
004000  e03c              B        |L1.16508|
                  |L1.16386|
004002  48e1              LDR      r0,|L1.17288|
004004  49e1              LDR      r1,|L1.17292|
004006  f9b00000          LDRSH    r0,[r0,#0]            ;5806  ; speedChIsOn
00400a  b9d0              CBNZ     r0,|L1.16450|
00400c  f8962023          LDRB     r2,[r6,#0x23]         ;5806  ; spc_stat
004010  2a02              CMP      r2,#2                 ;5806
004012  d016              BEQ      |L1.16450|
004014  780a              LDRB     r2,[r1,#0]            ;5806  ; hv_vz_stat
004016  b9a2              CBNZ     r2,|L1.16450|
004018  783a              LDRB     r2,[r7,#0]            ;5806  ; sp_ch_stat
00401a  b992              CBNZ     r2,|L1.16450|
00401c  7972              LDRB     r2,[r6,#5]            ;5806  ; vz1_stat
00401e  b982              CBNZ     r2,|L1.16450|
004020  79f2              LDRB     r2,[r6,#7]            ;5806  ; vz2_stat
004022  b972              CBNZ     r2,|L1.16450|
004024  f9b82000          LDRSH    r2,[r8,#0]            ;5806  ; load_U
004028  230a              MOVS     r3,#0xa               ;5806
00402a  fb92f2f3          SDIV     r2,r2,r3              ;5806
00402e  4bd8              LDR      r3,|L1.17296|
004030  f9b33000          LDRSH    r3,[r3,#0]            ;5806  ; UVENTOFF
004034  429a              CMP      r2,r3                 ;5806
004036  da04              BGE      |L1.16450|
004038  69e0              LDR      r0,[r4,#0x1c]         ;5806
00403a  f4407000          ORR      r0,r0,#0x200          ;5806
00403e  61e0              STR      r0,[r4,#0x1c]         ;5806
004040  e01c              B        |L1.16508|
                  |L1.16450|
004042  b958              CBNZ     r0,|L1.16476|
004044  f8960023          LDRB     r0,[r6,#0x23]         ;5807  ; spc_stat
004048  2802              CMP      r0,#2                 ;5807
00404a  d007              BEQ      |L1.16476|
00404c  7808              LDRB     r0,[r1,#0]            ;5807  ; hv_vz_stat
00404e  b928              CBNZ     r0,|L1.16476|
004050  7838              LDRB     r0,[r7,#0]            ;5807  ; sp_ch_stat
004052  b918              CBNZ     r0,|L1.16476|
004054  7970              LDRB     r0,[r6,#5]            ;5807  ; vz1_stat
004056  b908              CBNZ     r0,|L1.16476|
004058  79f0              LDRB     r0,[r6,#7]            ;5807  ; vz2_stat
00405a  b178              CBZ      r0,|L1.16508|
                  |L1.16476|
00405c  69a0              LDR      r0,[r4,#0x18]         ;5807
00405e  f4407000          ORR      r0,r0,#0x200          ;5807
004062  61a0              STR      r0,[r4,#0x18]         ;5807
004064  e00a              B        |L1.16508|
                  |L1.16486|
;;;5810   	{
;;;5811   	if((mess_find_unvol(MESS2RELE_HNDL))&& (mess_data[0]==PARAM_RELE_BAT_IS_DISCHARGED)) SET_REG(LPC_GPIO0->FIOCLR,1,9,1);
004066  20d2              MOVS     r0,#0xd2
004068  f7fffffe          BL       mess_find_unvol
00406c  b110              CBZ      r0,|L1.16500|
00406e  6828              LDR      r0,[r5,#0]  ; mess_data
004070  2872              CMP      r0,#0x72
004072  d017              BEQ      |L1.16548|
                  |L1.16500|
;;;5812   	else SET_REG(LPC_GPIO0->FIOSET,1,9,1);
004074  69a0              LDR      r0,[r4,#0x18]
004076  f4407000          ORR      r0,r0,#0x200
00407a  61a0              STR      r0,[r4,#0x18]
                  |L1.16508|
;;;5813   	}
;;;5814   
;;;5815   #endif //o_9
;;;5816   
;;;5817   #if defined UKU_6U || defined UKU_220_IPS_TERMOKOMPENSAT   //o_9	
;;;5818   //Блок выносной реле
;;;5819   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_BDR1))
00407c  20d2              MOVS     r0,#0xd2
00407e  f7fffffe          BL       mess_find_unvol
;;;5820   	{
;;;5821   	if(mess_data[1]==0) 		bdr_transmit_stat&=0xfe;
004082  f8df9310          LDR      r9,|L1.17300|
;;;5822   	else if(mess_data[1]==1) 	bdr_transmit_stat|=0x01;
;;;5823   	}
;;;5824   else 
;;;5825   	{
;;;5826   	if(bdr_avar_stat&0x01)  	bdr_transmit_stat|=0x01;
004086  4cc4              LDR      r4,|L1.17304|
004088  b110              CBZ      r0,|L1.16528|
00408a  6828              LDR      r0,[r5,#0]            ;5819  ; mess_data
00408c  2875              CMP      r0,#0x75              ;5819
00408e  d00e              BEQ      |L1.16558|
                  |L1.16528|
004090  7820              LDRB     r0,[r4,#0]  ; bdr_avar_stat
004092  07c0              LSLS     r0,r0,#31
004094  d01e              BEQ      |L1.16596|
004096  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
00409a  f0400001          ORR      r0,r0,#1
00409e  f8890000          STRB     r0,[r9,#0]
0040a2  e01d              B        |L1.16608|
                  |L1.16548|
0040a4  69e0              LDR      r0,[r4,#0x1c]         ;5811
0040a6  f4407000          ORR      r0,r0,#0x200          ;5811
0040aa  61e0              STR      r0,[r4,#0x1c]         ;5811
0040ac  e7e6              B        |L1.16508|
                  |L1.16558|
0040ae  6868              LDR      r0,[r5,#4]            ;5821  ; mess_data
0040b0  b110              CBZ      r0,|L1.16568|
0040b2  2801              CMP      r0,#1                 ;5822
0040b4  d007              BEQ      |L1.16582|
0040b6  e013              B        |L1.16608|
                  |L1.16568|
0040b8  f8990000          LDRB     r0,[r9,#0]            ;5821  ; bdr_transmit_stat
0040bc  f00000fe          AND      r0,r0,#0xfe           ;5821
0040c0  f8890000          STRB     r0,[r9,#0]            ;5821
0040c4  e00c              B        |L1.16608|
                  |L1.16582|
0040c6  f8990000          LDRB     r0,[r9,#0]            ;5822  ; bdr_transmit_stat
0040ca  f0400001          ORR      r0,r0,#1              ;5822
0040ce  f8890000          STRB     r0,[r9,#0]            ;5822
0040d2  e005              B        |L1.16608|
                  |L1.16596|
;;;5827   	else 						bdr_transmit_stat&=0xfe;
0040d4  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
0040d8  f00000fe          AND      r0,r0,#0xfe
0040dc  f8890000          STRB     r0,[r9,#0]
                  |L1.16608|
;;;5828   	}	
;;;5829   
;;;5830   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_BDR2))
0040e0  20d2              MOVS     r0,#0xd2
0040e2  f7fffffe          BL       mess_find_unvol
0040e6  b110              CBZ      r0,|L1.16622|
0040e8  6828              LDR      r0,[r5,#0]  ; mess_data
0040ea  2876              CMP      r0,#0x76
0040ec  d009              BEQ      |L1.16642|
                  |L1.16622|
;;;5831   	{
;;;5832   	if(mess_data[1]==0) 		bdr_transmit_stat&=0xfd;
;;;5833   	else if(mess_data[1]==1) 	bdr_transmit_stat|=0x02;
;;;5834   	}
;;;5835   else 
;;;5836   	{
;;;5837   	if(bdr_avar_stat&0x02)  	bdr_transmit_stat|=0x02;	 //o_9
0040ee  7820              LDRB     r0,[r4,#0]  ; bdr_avar_stat
0040f0  0780              LSLS     r0,r0,#30
0040f2  d519              BPL      |L1.16680|
0040f4  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
0040f8  f0400002          ORR      r0,r0,#2
0040fc  f8890000          STRB     r0,[r9,#0]
004100  e018              B        |L1.16692|
                  |L1.16642|
004102  6868              LDR      r0,[r5,#4]            ;5832  ; mess_data
004104  b110              CBZ      r0,|L1.16652|
004106  2801              CMP      r0,#1                 ;5833
004108  d007              BEQ      |L1.16666|
00410a  e013              B        |L1.16692|
                  |L1.16652|
00410c  f8990000          LDRB     r0,[r9,#0]            ;5832  ; bdr_transmit_stat
004110  f00000fd          AND      r0,r0,#0xfd           ;5832
004114  f8890000          STRB     r0,[r9,#0]            ;5832
004118  e00c              B        |L1.16692|
                  |L1.16666|
00411a  f8990000          LDRB     r0,[r9,#0]            ;5833  ; bdr_transmit_stat
00411e  f0400002          ORR      r0,r0,#2              ;5833
004122  f8890000          STRB     r0,[r9,#0]            ;5833
004126  e005              B        |L1.16692|
                  |L1.16680|
;;;5838   	else 						bdr_transmit_stat&=0xfd;
004128  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
00412c  f00000fd          AND      r0,r0,#0xfd
004130  f8890000          STRB     r0,[r9,#0]
                  |L1.16692|
;;;5839   	}	
;;;5840   	
;;;5841   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_BDR3))
004134  20d2              MOVS     r0,#0xd2
004136  f7fffffe          BL       mess_find_unvol
00413a  b110              CBZ      r0,|L1.16706|
00413c  6828              LDR      r0,[r5,#0]  ; mess_data
00413e  2877              CMP      r0,#0x77
004140  d009              BEQ      |L1.16726|
                  |L1.16706|
;;;5842   	{
;;;5843   	if(mess_data[1]==0) 		bdr_transmit_stat&=0xfb;
;;;5844   	else if(mess_data[1]==1) 	bdr_transmit_stat|=0x04;
;;;5845   	}
;;;5846   else 
;;;5847   	{
;;;5848   	if(bdr_avar_stat&0x04)  	bdr_transmit_stat|=0x04;	//o_9
004142  7820              LDRB     r0,[r4,#0]  ; bdr_avar_stat
004144  0740              LSLS     r0,r0,#29
004146  d519              BPL      |L1.16764|
004148  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
00414c  f0400004          ORR      r0,r0,#4
004150  f8890000          STRB     r0,[r9,#0]
004154  e018              B        |L1.16776|
                  |L1.16726|
004156  6868              LDR      r0,[r5,#4]            ;5843  ; mess_data
004158  b110              CBZ      r0,|L1.16736|
00415a  2801              CMP      r0,#1                 ;5844
00415c  d007              BEQ      |L1.16750|
00415e  e013              B        |L1.16776|
                  |L1.16736|
004160  f8990000          LDRB     r0,[r9,#0]            ;5843  ; bdr_transmit_stat
004164  f00000fb          AND      r0,r0,#0xfb           ;5843
004168  f8890000          STRB     r0,[r9,#0]            ;5843
00416c  e00c              B        |L1.16776|
                  |L1.16750|
00416e  f8990000          LDRB     r0,[r9,#0]            ;5844  ; bdr_transmit_stat
004172  f0400004          ORR      r0,r0,#4              ;5844
004176  f8890000          STRB     r0,[r9,#0]            ;5844
00417a  e005              B        |L1.16776|
                  |L1.16764|
;;;5849   	else 						bdr_transmit_stat&=0xfb;
00417c  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
004180  f00000fb          AND      r0,r0,#0xfb
004184  f8890000          STRB     r0,[r9,#0]
                  |L1.16776|
;;;5850   	}	
;;;5851   	
;;;5852   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_BDR4))
004188  20d2              MOVS     r0,#0xd2
00418a  f7fffffe          BL       mess_find_unvol
00418e  b110              CBZ      r0,|L1.16790|
004190  6828              LDR      r0,[r5,#0]  ; mess_data
004192  2878              CMP      r0,#0x78
004194  d009              BEQ      |L1.16810|
                  |L1.16790|
;;;5853   	{
;;;5854   	if(mess_data[1]==0) 		bdr_transmit_stat&=0xf7;
;;;5855   	else if(mess_data[1]==1) 	bdr_transmit_stat|=0x08;
;;;5856   	}
;;;5857   else 
;;;5858   	{
;;;5859   	if(bdr_avar_stat&0x08)  	bdr_transmit_stat|=0x08;	 //o_9
004196  7820              LDRB     r0,[r4,#0]  ; bdr_avar_stat
004198  0700              LSLS     r0,r0,#28
00419a  d519              BPL      |L1.16848|
00419c  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
0041a0  f0400008          ORR      r0,r0,#8
0041a4  f8890000          STRB     r0,[r9,#0]
0041a8  e018              B        |L1.16860|
                  |L1.16810|
0041aa  6868              LDR      r0,[r5,#4]            ;5854  ; mess_data
0041ac  b110              CBZ      r0,|L1.16820|
0041ae  2801              CMP      r0,#1                 ;5855
0041b0  d007              BEQ      |L1.16834|
0041b2  e013              B        |L1.16860|
                  |L1.16820|
0041b4  f8990000          LDRB     r0,[r9,#0]            ;5854  ; bdr_transmit_stat
0041b8  f00000f7          AND      r0,r0,#0xf7           ;5854
0041bc  f8890000          STRB     r0,[r9,#0]            ;5854
0041c0  e00c              B        |L1.16860|
                  |L1.16834|
0041c2  f8990000          LDRB     r0,[r9,#0]            ;5855  ; bdr_transmit_stat
0041c6  f0400008          ORR      r0,r0,#8              ;5855
0041ca  f8890000          STRB     r0,[r9,#0]            ;5855
0041ce  e005              B        |L1.16860|
                  |L1.16848|
;;;5860   	else 						bdr_transmit_stat&=0xf7;
0041d0  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
0041d4  f00000f7          AND      r0,r0,#0xf7
0041d8  f8890000          STRB     r0,[r9,#0]
                  |L1.16860|
;;;5861   	}	
;;;5862   					 	
;;;5863   #endif
;;;5864   
;;;5865   #ifdef UKU_KONTUR
;;;5866   
;;;5867   //Реле общей аварии
;;;5868   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_COMM))
;;;5869   	{
;;;5870   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_COMM,1);
;;;5871   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_COMM,1);
;;;5872   	}
;;;5873   else 
;;;5874   	{
;;;5875        if(  (!(avar_ind_stat&0x00007fff)) &&
;;;5876             ((!SK_REL_EN[0]) || (sk_av_stat[0]!=sasON))  &&
;;;5877             ((!SK_REL_EN[1]) || (sk_av_stat[1]!=sasON))  &&
;;;5878             ((!SK_REL_EN[2]) || (sk_av_stat[2]!=sasON))  /*&&
;;;5879             ((!SK_REL_EN[3]) || (sk_av_stat[3]!=sasON))*/  )SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_COMM,1);
;;;5880        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_COMM,1);
;;;5881   	}
;;;5882   
;;;5883   	
;;;5884   //rel_warm_plazma=0;
;;;5885   //Реле освещения   
;;;5886   /*
;;;5887   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_WARM))
;;;5888   	{
;;;5889   	if(mess_data[1]==0)
;;;5890   		{
;;;5891   		SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;5892   		rel_warm_plazma=1;
;;;5893   		}
;;;5894   	else if(mess_data[1]==1) 
;;;5895   		{
;;;5896   		SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;5897   		rel_warm_plazma=2;
;;;5898   		}
;;;5899        }
;;;5900   else 
;;;5901   	{
;;;5902   	if(warm_stat_k==wsOFF) 
;;;5903   		{
;;;5904   		SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;5905   		rel_warm_plazma=3;
;;;5906   		}
;;;5907        else 
;;;5908   		{
;;;5909   		SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;5910   		rel_warm_plazma=4;
;;;5911   		}
;;;5912   	}
;;;5913   */
;;;5914   //Реле освещения
;;;5915   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LIGHT))
;;;5916   	{
;;;5917   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;5918   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;5919        }
;;;5920   else 
;;;5921   	{
;;;5922   	if(sk_av_stat[0]!=sasON) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;5923        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;5924   	}
;;;5925   
;;;5926   
;;;5927   
;;;5928   //Реле выключения нагрузки
;;;5929   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LOAD_OFF))
;;;5930   	{
;;;5931   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;5932   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;5933        }
;;;5934   else if(tloaddisable_cmnd==0)
;;;5935   	{
;;;5936   	SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;5937   	}
;;;5938   else if((tloaddisable_cmnd)&&(tloaddisable_cmnd<=11))
;;;5939   	{
;;;5940   	SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;5941   	}
;;;5942   
;;;5943   else 
;;;5944   	{
;;;5945   	if(!(tloaddisable_stat==tldsON)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;5946        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;5947   	} 
;;;5948   
;;;5949   //Реле осевого вентилятора или отопителя
;;;5950   if(RELE_LOG)
;;;5951   	{
;;;5952   	if((mess_find_unvol(MESS2RELE_HNDL))&&(mess_data[0]==PARAM_RELE_VENT_WARM))
;;;5953   		{
;;;5954   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;5955   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;5956   		}
;;;5957   	else 
;;;5958   		{
;;;5959   		if(warm_stat_k==wsOFF) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;5960   	     else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;5961   		} 
;;;5962   
;;;5963   	}
;;;5964   else 
;;;5965   	{
;;;5966   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT_WARM))
;;;5967   		{
;;;5968   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;5969   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;5970   		}
;;;5971   	else 
;;;5972   		{
;;;5973   		if(vent_stat_k==vsOFF) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;5974   	     else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;5975   		} 
;;;5976   	}
;;;5977   #endif
;;;5978   
;;;5979   
;;;5980   #ifdef UKU_TELECORE2015
;;;5981   //Реле аварии сети
;;;5982   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;5983   	{
;;;5984   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5985   	else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;5986   	}
;;;5987   else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;5988   else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;5989   
;;;5990   
;;;5991   //Реле освещения
;;;5992   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LIGHT))
;;;5993   	{
;;;5994   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;5995   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;5996        }
;;;5997   else 
;;;5998   	{
;;;5999   	if(sk_av_stat[0]!=sasON) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;6000        else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;6001   	}
;;;6002   
;;;6003   //Реле отопителя
;;;6004   if((mess_find_unvol(MESS2RELE_HNDL))&&(mess_data[0]==PARAM_RELE_WARM))
;;;6005   	{
;;;6006   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;6007   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;6008   	}
;;;6009   else 
;;;6010   	{
;;;6011   	if(warm_stat_k==wsOFF) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;6012        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;6013   	} 
;;;6014   //Реле вентилятора
;;;6015   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT))
;;;6016   	{
;;;6017   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;6018   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;6019   	}
;;;6020   else 
;;;6021   	{
;;;6022   	if(vent_stat_k==vsOFF) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;6023        else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;6024   	} 
;;;6025   
;;;6026   //Реле внутреннего вентилятора
;;;6027   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VVENT))
;;;6028   	{
;;;6029   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VVENT,1);
;;;6030   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VVENT,1);
;;;6031   	}
;;;6032   else 
;;;6033   	{
;;;6034   	if(vvent_stat_k==vsOFF) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VVENT,1);
;;;6035        else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VVENT,1);
;;;6036   	} 
;;;6037   
;;;6038   #endif
;;;6039   
;;;6040   #ifdef UKU_TELECORE2017
;;;6041   //Реле аварии сети
;;;6042   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;6043   	{
;;;6044   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;6045   	else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;6046   	}
;;;6047   else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;6048   else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;6049   
;;;6050   
;;;6051   //Реле освещения
;;;6052   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LIGHT))
;;;6053   	{
;;;6054   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;6055   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;6056        }
;;;6057   else 
;;;6058   	{
;;;6059   	if(sk_av_stat[0]!=sasON) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;6060        else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;6061   	}
;;;6062   
;;;6063   //Реле отопителя
;;;6064   if((mess_find_unvol(MESS2RELE_HNDL))&&(mess_data[0]==PARAM_RELE_WARM))
;;;6065   	{
;;;6066   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;6067   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;6068   	}
;;;6069   else 
;;;6070   	{
;;;6071   	if(warm_stat_k==wsOFF) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;6072        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;6073   	} 
;;;6074   //Реле вентилятора
;;;6075   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT))
;;;6076   	{
;;;6077   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;6078   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;6079   	}
;;;6080   else 
;;;6081   	{
;;;6082   	if(vent_stat_k==vsOFF) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;6083        else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;6084   	} 
;;;6085   
;;;6086   //Реле внутреннего вентилятора
;;;6087   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VVENT))
;;;6088   	{
;;;6089   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VVENT,1);
;;;6090   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VVENT,1);
;;;6091   	}
;;;6092   else 
;;;6093   	{
;;;6094   	if(vvent_stat_k==vsOFF) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VVENT,1);
;;;6095        else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VVENT,1);
;;;6096   	} 
;;;6097   
;;;6098   //Реле выключения нагрузки
;;;6099   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LOAD_OFF))
;;;6100   	{
;;;6101   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;6102   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;6103        }
;;;6104   else if(tloaddisable_cmnd==0)
;;;6105   	{
;;;6106   	SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;6107   	}
;;;6108   else if((tloaddisable_cmnd)&&(tloaddisable_cmnd<=11))
;;;6109   	{
;;;6110   	SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;6111   	}
;;;6112   
;;;6113   else 
;;;6114   	{
;;;6115   	if(!(tloaddisable_stat==tldsON)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;6116        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;6117   	} 
;;;6118   
;;;6119   
;;;6120   #endif
;;;6121   
;;;6122   #ifdef IPS_SGEP_GAZPROM
;;;6123   rele_hndl_plazma[0]++;
;;;6124   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
;;;6125   	{
;;;6126   	rele_hndl_plazma[1]++;
;;;6127   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;6128   	else/* if(mess_data[1]==1)*/ SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;6129        }
;;;6130   else 
;;;6131   	{
;;;6132   	if(!(avar_ind_stat&0x000007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;6133        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;6134   	} 
;;;6135   
;;;6136   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;6137   	{
;;;6138   	rele_hndl_plazma[2]++;
;;;6139   	if(mess_data[1]==0) SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;6140   	else SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;6141   	}
;;;6142   else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;6143   else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;6144   #endif
;;;6145   
;;;6146   if(NUMBDR==1)
0041dc  486f              LDR      r0,|L1.17308|
0041de  8800              LDRH     r0,[r0,#0]  ; NUMBDR
0041e0  2801              CMP      r0,#1
0041e2  d17e              BNE      |L1.17122|
;;;6147   	{
;;;6148   	char ii_;
;;;6149   	char bdr_avar_stat_temp=0;
0041e4  f04f0000          MOV      r0,#0
;;;6150   	for	(ii_=0;ii_<4;ii_++)
0041e8  4601              MOV      r1,r0
;;;6151   		{
;;;6152   	//o_9_s
;;;6153   	#ifdef UKU_6U
;;;6154   		 //АБ разряжена
;;;6155   		if((RELE_SET_MASK[ii_]&0x01)&&
;;;6156   			( (bat[0]._Ub<(USIGN*10) && (BAT_IS_ON[0]==bisON) ) || 
;;;6157   			(bat[1]._Ub<(USIGN*10) && (BAT_IS_ON[1]==bisON) ) ) )			bdr_avar_stat_temp|=(1<<ii_);
;;;6158   		//Выравнивающий заряд
;;;6159   		if((RELE_SET_MASK[ii_]&0x02)&&
;;;6160   			(spc_stat==spcVZ))				bdr_avar_stat_temp|=(1<<ii_);
;;;6161   	   	//Общая авария ИБЭП
;;;6162   		if((RELE_SET_MASK[ii_]&0x04)&& 		
;;;6163   			(avar_stat&0x7FF)!=0 )		   	bdr_avar_stat_temp|=(1<<ii_);
;;;6164   		//Ток АКБ<-0,5А
;;;6165   		if((RELE_SET_MASK[ii_]&0x08)&&
;;;6166   			(bat[0]._Ib<-50	|| bat[1]._Ib<-50 ) ) bdr_avar_stat_temp|=(1<<ii_);
;;;6167   	   	//отключение НПН
;;;6168   	    if((RELE_SET_MASK[ii_]&0x10)&& 
;;;6169   			NPN_OUT==npnoBDR && npn_stat==npnsOFF) bdr_avar_stat_temp|=(1<<ii_);
;;;6170   		//контроль емкости АКБ1
;;;6171   		if((RELE_SET_MASK[ii_]&0x20)&&
;;;6172   			(spc_stat==spcKE)&&(spc_bat==0))	bdr_avar_stat_temp|=(1<<ii_); 
;;;6173   		//контроль емкости АКБ2
;;;6174   		if((RELE_SET_MASK[ii_]&0x40)&&
;;;6175   			(spc_stat==spcKE)&&(spc_bat==1))	bdr_avar_stat_temp|=(1<<ii_); 
;;;6176   	#else
;;;6177   	//o_9_e		//АБ разряжена
;;;6178   		if((RELE_SET_MASK[ii_]&0x01)&&
;;;6179   			(load_U<(USIGN*10)))			bdr_avar_stat_temp|=(1<<ii_);
;;;6180   		//Ускоренный заряд
;;;6181   		if((RELE_SET_MASK[ii_]&0x02)&&
;;;6182   			(sp_ch_stat==scsWRK))			bdr_avar_stat_temp|=(1<<ii_);
;;;6183   		//Выравнивающий заряд
;;;6184   		if((RELE_SET_MASK[ii_]&0x04)&&
;;;6185   			(spc_stat==spcVZ))			bdr_avar_stat_temp|=(1<<ii_);
;;;6186   		//Общая авария ЗВУ
;;;6187   		if((RELE_SET_MASK[ii_]&0x08)&&
;;;6188   			(avar_stat))					bdr_avar_stat_temp|=(1<<ii_);
;;;6189   		//Uвых завышено
;;;6190   		if((RELE_SET_MASK[ii_]&0x10)&&
;;;6191   			(uout_av==1))					bdr_avar_stat_temp|=(1<<ii_);
0041ea  f8dfa1b4          LDR      r10,|L1.17312|
;;;6192   		//Uвых занижено
;;;6193   		if((RELE_SET_MASK[ii_]&0x20)&&
;;;6194   			(uout_av==2))					bdr_avar_stat_temp|=(1<<ii_);
;;;6195   		if((RELE_SET_MASK[ii_]&0x40)&&
;;;6196   			(
;;;6197   			((bps[0]._av&(1<<4))&&(NUMIST>=1))||
0041ee  f8df91b4          LDR      r9,|L1.17316|
0041f2  4d6d              LDR      r5,|L1.17320|
0041f4  f8dfb1b4          LDR      r11,|L1.17324|
0041f8  f04f0301          MOV      r3,#1                 ;5101
                  |L1.16892|
0041fc  f93b2011          LDRSH    r2,[r11,r1,LSL #1]    ;6178
004200  ea5f7cc2          LSLS     r12,r2,#31            ;6178
004204  d010              BEQ      |L1.16936|
004206  f8dfc1a8          LDR      r12,|L1.17328|
00420a  f9b8e000          LDRSH    lr,[r8,#0]            ;6179  ; load_U
00420e  f9bcc000          LDRSH    r12,[r12,#0]          ;6179  ; USIGN
004212  eb0c0c8c          ADD      r12,r12,r12,LSL #2    ;6179
004216  ebbe0f4c          CMP      lr,r12,LSL #1         ;6179
00421a  da05              BGE      |L1.16936|
00421c  fa03fc01          LSL      r12,r3,r1             ;6179
004220  ea4c0c00          ORR      r12,r12,r0            ;6179
004224  f00c00ff          AND      r0,r12,#0xff          ;6179
                  |L1.16936|
004228  ea5f7c82          LSLS     r12,r2,#30            ;6181
00422c  d50a              BPL      |L1.16964|
00422e  f897c000          LDRB     r12,[r7,#0]           ;6182  ; sp_ch_stat
004232  f1bc0f02          CMP      r12,#2                ;6182
004236  d105              BNE      |L1.16964|
004238  fa03fc01          LSL      r12,r3,r1             ;6182
00423c  ea4c0c00          ORR      r12,r12,r0            ;6182
004240  f00c00ff          AND      r0,r12,#0xff          ;6182
                  |L1.16964|
004244  ea5f7c42          LSLS     r12,r2,#29            ;6184
004248  d50a              BPL      |L1.16992|
00424a  f896c023          LDRB     r12,[r6,#0x23]        ;6185  ; spc_stat
00424e  f1bc0f02          CMP      r12,#2                ;6185
004252  d105              BNE      |L1.16992|
004254  fa03fc01          LSL      r12,r3,r1             ;6185
004258  ea4c0c00          ORR      r12,r12,r0            ;6185
00425c  f00c00ff          AND      r0,r12,#0xff          ;6185
                  |L1.16992|
004260  ea5f7c02          LSLS     r12,r2,#28            ;6187
004264  d50c              BPL      |L1.17024|
004266  f8dfc14c          LDR      r12,|L1.17332|
00426a  f8dcc000          LDR      r12,[r12,#0]          ;6188  ; avar_stat
00426e  f1bc0f00          CMP      r12,#0                ;6188
004272  d005              BEQ      |L1.17024|
004274  fa03fc01          LSL      r12,r3,r1             ;6188
004278  ea4c0c00          ORR      r12,r12,r0            ;6188
00427c  f00c00ff          AND      r0,r12,#0xff          ;6188
                  |L1.17024|
004280  ea5f6cc2          LSLS     r12,r2,#27            ;6190
004284  d50a              BPL      |L1.17052|
004286  f89ac000          LDRB     r12,[r10,#0]          ;6191  ; uout_av
00428a  f1bc0f01          CMP      r12,#1                ;6191
00428e  d105              BNE      |L1.17052|
004290  fa03fc01          LSL      r12,r3,r1             ;6191
004294  ea4c0c00          ORR      r12,r12,r0            ;6191
004298  f00c00ff          AND      r0,r12,#0xff          ;6191
                  |L1.17052|
00429c  ea5f6c82          LSLS     r12,r2,#26            ;6193
0042a0  d50a              BPL      |L1.17080|
0042a2  f89ac000          LDRB     r12,[r10,#0]          ;6194  ; uout_av
0042a6  f1bc0f02          CMP      r12,#2                ;6194
0042aa  d105              BNE      |L1.17080|
0042ac  fa03fc01          LSL      r12,r3,r1             ;6194
0042b0  ea4c0c00          ORR      r12,r12,r0            ;6194
0042b4  f00c00ff          AND      r0,r12,#0xff          ;6194
                  |L1.17080|
0042b8  ea5f6c42          LSLS     r12,r2,#25            ;6195
0042bc  d525              BPL      |L1.17162|
0042be  f899c001          LDRB     r12,[r9,#1]  ; bps
0042c2  ea5f6ccc          LSLS     r12,r12,#27
0042c6  d504              BPL      |L1.17106|
0042c8  f9b5c000          LDRSH    r12,[r5,#0]  ; NUMIST
0042cc  f1bc0f01          CMP      r12,#1
0042d0  da15              BGE      |L1.17150|
                  |L1.17106|
;;;6198   			((bps[1]._av&(1<<4))&&(NUMIST>=2))||
0042d2  f899c065          LDRB     r12,[r9,#0x65]  ; bps
0042d6  ea5f6ccc          LSLS     r12,r12,#27
0042da  d506              BPL      |L1.17130|
0042dc  f9b5c000          LDRSH    r12,[r5,#0]  ; NUMIST
0042e0  e000              B        |L1.17124|
                  |L1.17122|
0042e2  e047              B        |L1.17268|
                  |L1.17124|
0042e4  f1bc0f02          CMP      r12,#2
0042e8  da09              BGE      |L1.17150|
                  |L1.17130|
;;;6199   			((bps[2]._av&(1<<4))&&(NUMIST>=3))
0042ea  f899c0c9          LDRB     r12,[r9,#0xc9]  ; bps
0042ee  ea5f6ccc          LSLS     r12,r12,#27
0042f2  d50a              BPL      |L1.17162|
0042f4  f9b5c000          LDRSH    r12,[r5,#0]  ; NUMIST
0042f8  f1bc0f03          CMP      r12,#3
0042fc  db05              BLT      |L1.17162|
                  |L1.17150|
;;;6200   			))bdr_avar_stat_temp|=(1<<ii_);
0042fe  fa03fc01          LSL      r12,r3,r1
004302  ea4c0c00          ORR      r12,r12,r0
004306  f00c00ff          AND      r0,r12,#0xff
                  |L1.17162|
;;;6201   		if((RELE_SET_MASK[ii_]&0x80)&&
00430a  ea5f6c02          LSLS     r12,r2,#24
00430e  d523              BPL      |L1.17240|
;;;6202   			(
;;;6203   			((bps[0]._av&(0x0f))&&(NUMIST>=1))||
004310  f899c001          LDRB     r12,[r9,#1]  ; bps
004314  ea5f7c0c          LSLS     r12,r12,#28
004318  d004              BEQ      |L1.17188|
00431a  f9b5c000          LDRSH    r12,[r5,#0]  ; NUMIST
00431e  f1bc0f01          CMP      r12,#1
004322  da13              BGE      |L1.17228|
                  |L1.17188|
;;;6204   			((bps[1]._av&(0x0f))&&(NUMIST>=2))||
004324  f899c065          LDRB     r12,[r9,#0x65]  ; bps
004328  ea5f7c0c          LSLS     r12,r12,#28
00432c  d004              BEQ      |L1.17208|
00432e  f9b5c000          LDRSH    r12,[r5,#0]  ; NUMIST
004332  f1bc0f02          CMP      r12,#2
004336  da09              BGE      |L1.17228|
                  |L1.17208|
;;;6205   			((bps[2]._av&(0x0f))&&(NUMIST>=3))
004338  f899c0c9          LDRB     r12,[r9,#0xc9]  ; bps
00433c  ea5f7c0c          LSLS     r12,r12,#28
004340  d00a              BEQ      |L1.17240|
004342  f9b5c000          LDRSH    r12,[r5,#0]  ; NUMIST
004346  f1bc0f03          CMP      r12,#3
00434a  db05              BLT      |L1.17240|
                  |L1.17228|
;;;6206   			))bdr_avar_stat_temp|=(1<<ii_);
00434c  fa03fc01          LSL      r12,r3,r1
004350  ea4c0c00          ORR      r12,r12,r0
004354  f00c00ff          AND      r0,r12,#0xff
                  |L1.17240|
;;;6207   	  #endif											 //o_9
;;;6208   		if(!(RELE_SET_MASK[ii_]&(1<<15))) bdr_avar_stat_temp^=(1<<ii_); 
004358  0412              LSLS     r2,r2,#16
00435a  d404              BMI      |L1.17254|
00435c  fa03f201          LSL      r2,r3,r1
004360  ea820200          EOR      r2,r2,r0
004364  b2d0              UXTB     r0,r2
                  |L1.17254|
004366  f1010101          ADD      r1,r1,#1              ;6150
00436a  b2c9              UXTB     r1,r1                 ;6150
00436c  2904              CMP      r1,#4                 ;6150
00436e  f4ffaf45          BCC      |L1.16892|
;;;6209   		}
;;;6210   	bdr_avar_stat=bdr_avar_stat_temp;
004372  7020              STRB     r0,[r4,#0]
                  |L1.17268|
;;;6211   	}
;;;6212   }
004374  e8bd9ff0          POP      {r4-r12,pc}
                  |L1.17272|
                          DCD      load_U
                  |L1.17276|
                          DCD      sp_ch_stat
                  |L1.17280|
                          DCD      ||area_number.26||
                  |L1.17284|
                          DCD      DOP_RELE_FUNC
                  |L1.17288|
                          DCD      speedChIsOn
                  |L1.17292|
                          DCD      hv_vz_stat
                  |L1.17296|
                          DCD      UVENTOFF
                  |L1.17300|
                          DCD      bdr_transmit_stat
                  |L1.17304|
                          DCD      bdr_avar_stat
                  |L1.17308|
                          DCD      NUMBDR
                  |L1.17312|
                          DCD      uout_av
                  |L1.17316|
                          DCD      bps
                  |L1.17320|
                          DCD      NUMIST
                  |L1.17324|
                          DCD      RELE_SET_MASK
                  |L1.17328|
                          DCD      USIGN
                  |L1.17332|
                          DCD      avar_stat
                          ENDP

                  bps_hndl PROC
;;;6215   //-----------------------------------------------
;;;6216   void bps_hndl(void)
0043b8  e92d5ff0          PUSH     {r4-r12,lr}
;;;6217   {
;;;6218   char ptr__,i;
;;;6219   unsigned short tempUS;
;;;6220   
;;;6221   if(sh_cnt0<10)
0043bc  f8dfb40c          LDR      r11,|L1.18380|
;;;6222   	{
;;;6223   	sh_cnt0++;
;;;6224   	if(sh_cnt0>=10)
;;;6225   		{
;;;6226   		sh_cnt0=0;
0043c0  2600              MOVS     r6,#0
;;;6227   		b1Hz_sh=1;
0043c2  f04f0a01          MOV      r10,#1
0043c6  f89b0021          LDRB     r0,[r11,#0x21]        ;6221  ; sh_cnt0
0043ca  280a              CMP      r0,#0xa               ;6221
0043cc  d20a              BCS      |L1.17380|
0043ce  f1000001          ADD      r0,r0,#1              ;6223
0043d2  b2c0              UXTB     r0,r0                 ;6223
0043d4  f88b0021          STRB     r0,[r11,#0x21]        ;6223
0043d8  280a              CMP      r0,#0xa               ;6224
0043da  d303              BCC      |L1.17380|
0043dc  f88b6021          STRB     r6,[r11,#0x21]        ;6226
0043e0  f88ba022          STRB     r10,[r11,#0x22]
                  |L1.17380|
;;;6228   		}
;;;6229   	}
;;;6230   
;;;6231   /*if(sh_cnt1<5)
;;;6232   	{
;;;6233   	sh_cnt1++;
;;;6234   	if(sh_cnt1==5)
;;;6235   		{
;;;6236   		sh_cnt1=0;
;;;6237   		b2Hz_sh=1;
;;;6238   		}
;;;6239   	} */
;;;6240   
;;;6241   
;;;6242   /*
;;;6243   if(mess_find(MESS_SRC_ON_OFF))
;;;6244   	{
;;;6245   	if(mess_data[0]==_MESS_SRC_MASK_BLOK_2SEC)
;;;6246   		{
;;;6247   		char i;
;;;6248   		for(i=0;i<NUMIST;i++)
;;;6249   			{
;;;6250   			if(mess_data[1]&(1<<i))src[i]._ist_blok_cnt=20;
;;;6251   			}
;;;6252   		
;;;6253   		}
;;;6254   	else if(mess_data[0]==_MESS_SRC_MASK_UNBLOK)
;;;6255   		{
;;;6256   		char i;
;;;6257   		for(i=0;i<NUMIST;i++)
;;;6258   			{
;;;6259   			if(mess_data[1]&(1<<i))src[i]._ist_blok_cnt=0;
;;;6260   			}
;;;6261   		
;;;6262   		}
;;;6263   	}
;;;6264   	
;;;6265   else if(mess_find(_MESS_SRC_MASK_ON))
;;;6266   	{				
;;;6267   	if(mess_data[0]==_MESS_SRC_MASK_ON)
;;;6268   		{
;;;6269   		char i;
;;;6270   		for(i=0;i<NUMIST;i++)
;;;6271   			{
;;;6272   			if(mess_data[1]&(1<<i))
;;;6273   				{
;;;6274   				src[i]._ist_blok_cnt=0;
;;;6275   				src[i]._flags_tu=2;
;;;6276   				}
;;;6277   			}
;;;6278   		
;;;6279   		}				
;;;6280   	}*/
;;;6281   
;;;6282   
;;;6283   
;;;6284   /*else*/ 
;;;6285   bps_on_mask=0;
0043e4  4ff9              LDR      r7,|L1.18380|
0043e6  3780              ADDS     r7,r7,#0x80
0043e8  62fe              STR      r6,[r7,#0x2c]  ; bps_on_mask
;;;6286   bps_off_mask=0;
0043ea  633e              STR      r6,[r7,#0x30]  ; bps_off_mask
;;;6287   
;;;6288   if(mess_find_unvol(MESS2BPS_HNDL))
0043ec  20cd              MOVS     r0,#0xcd
0043ee  f7fffffe          BL       mess_find_unvol
;;;6289   	{
;;;6290   	if(mess_data[0]==PARAM_BPS_ALL_OFF_AFTER_2SEC)
;;;6291   		{
;;;6292   		bps_off_mask=0xffff;
;;;6293   		}
;;;6294   
;;;6295   	if(mess_data[0]==PARAM_BPS_MASK_OFF_AFTER_2SEC)
;;;6296   		{
;;;6297   		bps_off_mask=mess_data[1];
;;;6298   		}
;;;6299   
;;;6300   	if(mess_data[0]==PARAM_BPS_MASK_ON)
;;;6301   		{
;;;6302   		bps_on_mask=mess_data[1];
;;;6303   		}
;;;6304   
;;;6305   	if(mess_data[0]==PARAM_BPS_ALL_ON)
;;;6306   		{
;;;6307   		bps_on_mask=0xffff;
;;;6308   		}
;;;6309   
;;;6310   	if(mess_data[0]==PARAM_BPS_MASK_ON_OFF_AFTER_2SEC)
;;;6311   		{
;;;6312   		bps_on_mask=(unsigned)mess_data[1];
;;;6313   		bps_off_mask=~((unsigned)mess_data[1]);
;;;6314   		}
;;;6315   
;;;6316    	if(mess_data[0]==PARAM_BPS_MASK_ON_OFF_AFTER_2SEC_FOR_NUMBER)
;;;6317   		{
;;;6318   		bps_on_mask=(unsigned)(1<<mess_data[1]);
;;;6319   		bps_off_mask=~((unsigned)(1<<mess_data[1]));
;;;6320   		}
;;;6321   
;;;6322   	for(i=0;i<=NUMIST;i++)
;;;6323   		{
;;;6324   		if(bps_off_mask&(1<<i)) bps[i]._blok_cnt++;
0043f2  f8df83dc          LDR      r8,|L1.18384|
0043f6  b3b8              CBZ      r0,|L1.17512|
0043f8  4af6              LDR      r2,|L1.18388|
0043fa  f64f71ff          MOV      r1,#0xffff            ;6292
0043fe  6810              LDR      r0,[r2,#0]            ;6290  ; mess_data
004400  28ce              CMP      r0,#0xce              ;6290
004402  d100              BNE      |L1.17414|
004404  6339              STR      r1,[r7,#0x30]         ;6292  ; bps_off_mask
                  |L1.17414|
004406  28cf              CMP      r0,#0xcf              ;6295
004408  d101              BNE      |L1.17422|
00440a  6853              LDR      r3,[r2,#4]            ;6297  ; mess_data
00440c  633b              STR      r3,[r7,#0x30]         ;6297  ; bps_off_mask
                  |L1.17422|
00440e  28d1              CMP      r0,#0xd1              ;6300
004410  d101              BNE      |L1.17430|
004412  6853              LDR      r3,[r2,#4]            ;6302  ; mess_data
004414  62fb              STR      r3,[r7,#0x2c]         ;6302  ; bps_on_mask
                  |L1.17430|
004416  28d2              CMP      r0,#0xd2              ;6305
004418  d100              BNE      |L1.17436|
00441a  62f9              STR      r1,[r7,#0x2c]         ;6307  ; bps_on_mask
                  |L1.17436|
00441c  28d0              CMP      r0,#0xd0              ;6310
00441e  d104              BNE      |L1.17450|
004420  6851              LDR      r1,[r2,#4]            ;6312  ; mess_data
004422  62f9              STR      r1,[r7,#0x2c]         ;6312  ; bps_on_mask
004424  ea6f0101          MVN      r1,r1                 ;6313
004428  6339              STR      r1,[r7,#0x30]         ;6313  ; bps_off_mask
                  |L1.17450|
00442a  f5b07f9a          CMP      r0,#0x134             ;6316
00442e  d106              BNE      |L1.17470|
004430  6851              LDR      r1,[r2,#4]            ;6318  ; mess_data
004432  fa0af001          LSL      r0,r10,r1             ;6318
004436  62f8              STR      r0,[r7,#0x2c]         ;6318  ; bps_on_mask
004438  ea6f0000          MVN      r0,r0                 ;6319
00443c  6338              STR      r0,[r7,#0x30]         ;6319  ; bps_off_mask
                  |L1.17470|
00443e  f04f0400          MOV      r4,#0                 ;6322
004442  e035              B        |L1.17584|
                  |L1.17476|
004444  6b38              LDR      r0,[r7,#0x30]  ; bps_off_mask
004446  fa0af904          LSL      r9,r10,r4
00444a  ea190f00          TST      r9,r0
00444e  d00c              BEQ      |L1.17514|
004450  eb0400c4          ADD      r0,r4,r4,LSL #3
004454  eb001004          ADD      r0,r0,r4,LSL #4
004458  eb080080          ADD      r0,r8,r0,LSL #2
00445c  f8301f40          LDRH     r1,[r0,#0x40]!
004460  f1010101          ADD      r1,r1,#1
004464  8001              STRH     r1,[r0,#0]
004466  e008              B        |L1.17530|
                  |L1.17512|
004468  e028              B        |L1.17596|
                  |L1.17514|
;;;6325   		else bps[i]._blok_cnt=0;
00446a  eb0400c4          ADD      r0,r4,r4,LSL #3
00446e  eb001004          ADD      r0,r0,r4,LSL #4
004472  eb080080          ADD      r0,r8,r0,LSL #2
004476  f8a06040          STRH     r6,[r0,#0x40]
                  |L1.17530|
;;;6326   		gran(&bps[i]._blok_cnt,0,50);
00447a  eb0400c4          ADD      r0,r4,r4,LSL #3
00447e  eb001004          ADD      r0,r0,r4,LSL #4
004482  eb080580          ADD      r5,r8,r0,LSL #2
004486  f1050040          ADD      r0,r5,#0x40
00448a  2232              MOVS     r2,#0x32
00448c  2100              MOVS     r1,#0
00448e  f7fffffe          BL       gran
;;;6327   		if(bps[i]._blok_cnt>20) bps[i]._flags_tu=1;
004492  f9b50040          LDRSH    r0,[r5,#0x40]
004496  2814              CMP      r0,#0x14
004498  dd01              BLE      |L1.17566|
00449a  f885a02c          STRB     r10,[r5,#0x2c]
                  |L1.17566|
;;;6328   		if(bps_on_mask&(1<<i)) bps[i]._flags_tu=0;
00449e  6af8              LDR      r0,[r7,#0x2c]  ; bps_on_mask
0044a0  ea190f00          TST      r9,r0
0044a4  d001              BEQ      |L1.17578|
0044a6  f885602c          STRB     r6,[r5,#0x2c]
                  |L1.17578|
0044aa  f1040401          ADD      r4,r4,#1              ;6322
0044ae  b2e4              UXTB     r4,r4                 ;6322
                  |L1.17584|
0044b0  48c9              LDR      r0,|L1.18392|
0044b2  f9b00000          LDRSH    r0,[r0,#0]            ;6322  ; NUMIST
0044b6  4284              CMP      r4,r0                 ;6322
0044b8  ddc4              BLE      |L1.17476|
0044ba  e08e              B        |L1.17882|
                  |L1.17596|
;;;6329   	     }
;;;6330   
;;;6331   	
;;;6332   /*
;;;6333   
;;;6334   	if(bps_all_off_cnt>20)
;;;6335   		{
;;;6336   		for(i=0;i<=NUMIST;i++)
;;;6337   			{
;;;6338   	     	bps[i]._flags_tu=1;
;;;6339   	     	}
;;;6340   		}
;;;6341   	else if(bps_mask_off_cnt>20)
;;;6342   		{
;;;6343   		for(i=0;i<=NUMIST;i++)
;;;6344   			{
;;;6345   			if(mess_data[1]&(1<<i)) bps[i]._flags_tu=1;
;;;6346   	     	}
;;;6347   		}	
;;;6348   		
;;;6349   	else if(bps_mask_on_off_cnt>20)
;;;6350   		{
;;;6351   		for(i=0;i<=NUMIST;i++)
;;;6352   			{
;;;6353   			if(mess_data[1]&(1<<i)) bps[i]._flags_tu=1;
;;;6354   			else bps[i]._flags_tu=0;
;;;6355   	     	}
;;;6356   		}
;;;6357   		
;;;6358   	if(mess_data[0]==PARAM_BPS_MASK_ON)
;;;6359   		{
;;;6360   		for(i=0;i<=NUMIST;i++)
;;;6361   			{
;;;6362   			if(mess_data[1]&(1<<i)) bps[i]._flags_tu=0;
;;;6363   	     	}
;;;6364   		}
;;;6365   */										
;;;6366   	}
;;;6367   
;;;6368   
;;;6369   else if(b1Hz_sh)
0044bc  f89b0022          LDRB     r0,[r11,#0x22]  ; b1Hz_sh
0044c0  b3f0              CBZ      r0,|L1.17728|
;;;6370   	{
;;;6371   	ptr__=0;
0044c2  f04f0400          MOV      r4,#0
;;;6372        for(i=0;i<=NUMIST;i++)
0044c6  4621              MOV      r1,r4
0044c8  48c3              LDR      r0,|L1.18392|
0044ca  f9b00000          LDRSH    r0,[r0,#0]            ;6322
0044ce  e00a              B        |L1.17638|
                  |L1.17616|
;;;6373   		{
;;;6374   	     bps[i]._flags_tu=1;
0044d0  eb0102c1          ADD      r2,r1,r1,LSL #3
0044d4  eb021201          ADD      r2,r2,r1,LSL #4
0044d8  eb080282          ADD      r2,r8,r2,LSL #2
0044dc  f882a02c          STRB     r10,[r2,#0x2c]
0044e0  f1010101          ADD      r1,r1,#1              ;6372
0044e4  b2c9              UXTB     r1,r1                 ;6372
                  |L1.17638|
0044e6  4281              CMP      r1,r0                 ;6372
0044e8  ddf2              BLE      |L1.17616|
;;;6375   	     }	
;;;6376     	     
;;;6377     	for(i=0;(i<NUMIST)&&(ptr__<num_necc);i++)
0044ea  f04f0100          MOV      r1,#0
0044ee  e023              B        |L1.17720|
                  |L1.17648|
;;;6378     		{
;;;6379   		char ii,iii;
;;;6380   
;;;6381   		ii=(char)NUMIST;
0044f0  b2c2              UXTB     r2,r0
;;;6382   		//if(ii<0)ii=0;
;;;6383   		if(ii>32)ii=32;
0044f2  2a20              CMP      r2,#0x20
0044f4  d901              BLS      |L1.17658|
0044f6  f04f0220          MOV      r2,#0x20
                  |L1.17658|
;;;6384   		iii=numOfForvardBps;
0044fa  f89b3028          LDRB     r3,[r11,#0x28]  ; numOfForvardBps
;;;6385   		//if(iii<0)iii=0;
;;;6386   		if(iii>=NUMIST)iii=0;
0044fe  4283              CMP      r3,r0
004500  db01              BLT      |L1.17670|
004502  f04f0300          MOV      r3,#0
                  |L1.17670|
;;;6387   		iii+=i;
004506  440b              ADD      r3,r3,r1
004508  b2db              UXTB     r3,r3
;;;6388   		iii=iii%ii;
00450a  fbb3f5f2          UDIV     r5,r3,r2
00450e  fb023215          MLS      r2,r2,r5,r3
;;;6389   		
;;;6390     	     if((bps[iii]._state==bsRDY)||(bps[iii]._state==bsWRK))
004512  eb0203c2          ADD      r3,r2,r2,LSL #3
004516  eb031202          ADD      r2,r3,r2,LSL #4
00451a  eb080282          ADD      r2,r8,r2,LSL #2
00451e  7893              LDRB     r3,[r2,#2]
004520  2b02              CMP      r3,#2
004522  d001              BEQ      |L1.17704|
004524  2b01              CMP      r3,#1
004526  d104              BNE      |L1.17714|
                  |L1.17704|
;;;6391     	         	{
;;;6392     	         	bps[iii]._flags_tu=0;
004528  f882602c          STRB     r6,[r2,#0x2c]
;;;6393     	         	ptr__++;
00452c  f1040401          ADD      r4,r4,#1
004530  b2e4              UXTB     r4,r4
                  |L1.17714|
004532  f1010101          ADD      r1,r1,#1              ;6377
004536  b2c9              UXTB     r1,r1                 ;6377
                  |L1.17720|
004538  4281              CMP      r1,r0                 ;6377
00453a  da06              BGE      |L1.17738|
00453c  4aa7              LDR      r2,|L1.18396|
00453e  e000              B        |L1.17730|
                  |L1.17728|
004540  e04b              B        |L1.17882|
                  |L1.17730|
004542  f9b22000          LDRSH    r2,[r2,#0]            ;6377  ; num_necc
004546  4294              CMP      r4,r2                 ;6377
004548  dbd2              BLT      |L1.17648|
                  |L1.17738|
;;;6394     	         	}
;;;6395   			
;;;6396     	     }
;;;6397   	bps[numOfForvardBps_old]._flags_tu=0;
00454a  f89b1029          LDRB     r1,[r11,#0x29]  ; numOfForvardBps_old
00454e  eb0102c1          ADD      r2,r1,r1,LSL #3
004552  eb021101          ADD      r1,r2,r1,LSL #4
004556  eb080181          ADD      r1,r8,r1,LSL #2
00455a  f881602c          STRB     r6,[r1,#0x2c]
;;;6398   
;;;6399   	if(main_1Hz_cnt<60)
00455e  49a0              LDR      r1,|L1.18400|
004560  f9b11000          LDRSH    r1,[r1,#0]  ; main_1Hz_cnt
004564  293c              CMP      r1,#0x3c
004566  da0f              BGE      |L1.17800|
;;;6400   		{
;;;6401        	for(i=0;i<=NUMIST;i++)
004568  f04f0100          MOV      r1,#0
00456c  e00a              B        |L1.17796|
                  |L1.17774|
;;;6402   			{
;;;6403   	     	bps[i]._flags_tu=0;
00456e  eb0102c1          ADD      r2,r1,r1,LSL #3
004572  eb021201          ADD      r2,r2,r1,LSL #4
004576  eb080282          ADD      r2,r8,r2,LSL #2
00457a  f882602c          STRB     r6,[r2,#0x2c]
00457e  f1010101          ADD      r1,r1,#1              ;6401
004582  b2c9              UXTB     r1,r1                 ;6401
                  |L1.17796|
004584  4281              CMP      r1,r0                 ;6401
004586  ddf2              BLE      |L1.17774|
                  |L1.17800|
;;;6404   	     	}	
;;;6405   		}
;;;6406   	if(ipsBlckStat)
004588  4996              LDR      r1,|L1.18404|
00458a  8809              LDRH     r1,[r1,#0]  ; ipsBlckStat
00458c  b179              CBZ      r1,|L1.17838|
;;;6407   		{
;;;6408        	for(i=0;i<=NUMIST;i++)
00458e  f04f0100          MOV      r1,#0
004592  e00a              B        |L1.17834|
                  |L1.17812|
;;;6409   			{
;;;6410   	     	bps[i]._flags_tu=1;
004594  eb0102c1          ADD      r2,r1,r1,LSL #3
004598  eb021201          ADD      r2,r2,r1,LSL #4
00459c  eb080282          ADD      r2,r8,r2,LSL #2
0045a0  f882a02c          STRB     r10,[r2,#0x2c]
0045a4  f1010101          ADD      r1,r1,#1              ;6408
0045a8  b2c9              UXTB     r1,r1                 ;6408
                  |L1.17834|
0045aa  4281              CMP      r1,r0                 ;6408
0045ac  ddf2              BLE      |L1.17812|
                  |L1.17838|
;;;6411   	     	}
;;;6412   		}
;;;6413   
;;;6414        for(i=0;i<=NUMIST;i++)
0045ae  f04f0100          MOV      r1,#0
;;;6415   		{
;;;6416   	    if(bps[i]._flags_tu==1) 	bps[i]._x_=-50;
0045b2  f06f0331          MVN      r3,#0x31
0045b6  e00e              B        |L1.17878|
                  |L1.17848|
0045b8  eb0102c1          ADD      r2,r1,r1,LSL #3
0045bc  eb021201          ADD      r2,r2,r1,LSL #4
0045c0  eb080282          ADD      r2,r8,r2,LSL #2
0045c4  f892402c          LDRB     r4,[r2,#0x2c]
0045c8  2c01              CMP      r4,#1
0045ca  d101              BNE      |L1.17872|
0045cc  f8a23054          STRH     r3,[r2,#0x54]
                  |L1.17872|
0045d0  f1010101          ADD      r1,r1,#1              ;6414
0045d4  b2c9              UXTB     r1,r1                 ;6414
                  |L1.17878|
0045d6  4281              CMP      r1,r0                 ;6414
0045d8  ddee              BLE      |L1.17848|
                  |L1.17882|
;;;6417   	   	}	
;;;6418   		 
;;;6419     	}
;;;6420   
;;;6421   
;;;6422   for(i=0;i<NUMIST;i++)
0045da  f04f0000          MOV      r0,#0
0045de  497e              LDR      r1,|L1.18392|
;;;6423        {
;;;6424        if(bps[i]._ist_blok_host_cnt!=0)
;;;6425             {
;;;6426             bps[i]._flags_tu=99;
0045e0  f04f0463          MOV      r4,#0x63
0045e4  f9b11000          LDRSH    r1,[r1,#0]            ;6322
0045e8  e00f              B        |L1.17930|
                  |L1.17898|
0045ea  eb0002c0          ADD      r2,r0,r0,LSL #3       ;6424
0045ee  eb021200          ADD      r2,r2,r0,LSL #4       ;6424
0045f2  eb080282          ADD      r2,r8,r2,LSL #2       ;6424
0045f6  6bd3              LDR      r3,[r2,#0x3c]         ;6424
0045f8  b123              CBZ      r3,|L1.17924|
0045fa  f882402c          STRB     r4,[r2,#0x2c]
;;;6427   	     bps[i]._ist_blok_host_cnt--;
0045fe  f1a30301          SUB      r3,r3,#1
004602  63d3              STR      r3,[r2,#0x3c]
                  |L1.17924|
004604  f1000001          ADD      r0,r0,#1              ;6422
004608  b2c0              UXTB     r0,r0                 ;6422
                  |L1.17930|
00460a  4288              CMP      r0,r1                 ;6422
00460c  dbed              BLT      |L1.17898|
;;;6428             }
;;;6429        }
;;;6430   
;;;6431   
;;;6432   
;;;6433   
;;;6434   b1Hz_sh=0;
00460e  f88b6022          STRB     r6,[r11,#0x22]
;;;6435   
;;;6436   
;;;6437   num_of_wrks_bps=0;
004612  f88b601e          STRB     r6,[r11,#0x1e]
;;;6438   tempUS=0;
004616  f04f0200          MOV      r2,#0
;;;6439   for(i=0;i<NUMIST;i++)
00461a  4610              MOV      r0,r2
00461c  e015              B        |L1.17994|
                  |L1.17950|
;;;6440   	{
;;;6441   	if(bps[i]._state==bsWRK)
00461e  eb0003c0          ADD      r3,r0,r0,LSL #3
004622  eb031300          ADD      r3,r3,r0,LSL #4
004626  eb080383          ADD      r3,r8,r3,LSL #2
00462a  789c              LDRB     r4,[r3,#2]
00462c  2c01              CMP      r4,#1
00462e  d109              BNE      |L1.17988|
;;;6442   		{
;;;6443   		num_of_wrks_bps++;
004630  f89b401e          LDRB     r4,[r11,#0x1e]  ; num_of_wrks_bps
004634  f1040401          ADD      r4,r4,#1
004638  f88b401e          STRB     r4,[r11,#0x1e]
;;;6444   		if(bps[i]._Uii>tempUS)tempUS=bps[i]._Uii;
00463c  69db              LDR      r3,[r3,#0x1c]
00463e  4293              CMP      r3,r2
004640  dd00              BLE      |L1.17988|
004642  b29a              UXTH     r2,r3
                  |L1.17988|
004644  f1000001          ADD      r0,r0,#1              ;6439
004648  b2c0              UXTB     r0,r0                 ;6439
                  |L1.17994|
00464a  4288              CMP      r0,r1                 ;6439
00464c  dbe7              BLT      |L1.17950|
;;;6445   		}
;;;6446   	}
;;;6447   Ubpsmax=tempUS;
00464e  f8ab204e          STRH     r2,[r11,#0x4e]
;;;6448   
;;;6449   bPARALLEL_ENOUG=0;
004652  f88b602c          STRB     r6,[r11,#0x2c]
;;;6450   bPARALLEL_NOT_ENOUG=1;
004656  f88ba02b          STRB     r10,[r11,#0x2b]
;;;6451   
;;;6452   for(i=0;i<NUMIST;i++)
00465a  f04f0000          MOV      r0,#0
;;;6453   	{
;;;6454   	if(bps[i]._Ti>=TSIGN)
00465e  4a62              LDR      r2,|L1.18408|
004660  f9b23000          LDRSH    r3,[r2,#0]
;;;6455   		{
;;;6456   		bPARALLEL_ENOUG=1;
;;;6457   		}
;;;6458   	if(bps[i]._Ti>=(TSIGN-5))
004664  f1a30405          SUB      r4,r3,#5
004668  e011              B        |L1.18062|
                  |L1.18026|
00466a  eb0002c0          ADD      r2,r0,r0,LSL #3       ;6454
00466e  eb021200          ADD      r2,r2,r0,LSL #4       ;6454
004672  eb080282          ADD      r2,r8,r2,LSL #2       ;6454
004676  6a92              LDR      r2,[r2,#0x28]         ;6454
004678  429a              CMP      r2,r3                 ;6454
00467a  db01              BLT      |L1.18048|
00467c  f88ba02c          STRB     r10,[r11,#0x2c]       ;6456
                  |L1.18048|
004680  42a2              CMP      r2,r4
004682  db01              BLT      |L1.18056|
;;;6459   		{
;;;6460   		bPARALLEL_NOT_ENOUG=0;
004684  f88b602b          STRB     r6,[r11,#0x2b]
                  |L1.18056|
004688  f1000001          ADD      r0,r0,#1              ;6452
00468c  b2c0              UXTB     r0,r0                 ;6452
                  |L1.18062|
00468e  4288              CMP      r0,r1                 ;6452
004690  dbeb              BLT      |L1.18026|
;;;6461   		}
;;;6462   	}
;;;6463   
;;;6464   if(bPARALLEL_ENOUG==1)
004692  f89b002c          LDRB     r0,[r11,#0x2c]  ; bPARALLEL_ENOUG
004696  2801              CMP      r0,#1
004698  d00a              BEQ      |L1.18096|
;;;6465   	{
;;;6466   	bPARALLEL=1;
;;;6467   	}
;;;6468   else if(bPARALLEL && bPARALLEL_NOT_ENOUG)
00469a  f89b002d          LDRB     r0,[r11,#0x2d]  ; bPARALLEL
00469e  2800              CMP      r0,#0
0046a0  d005              BEQ      |L1.18094|
0046a2  f89b002b          LDRB     r0,[r11,#0x2b]  ; bPARALLEL_NOT_ENOUG
0046a6  2800              CMP      r0,#0
0046a8  d001              BEQ      |L1.18094|
;;;6469   	{
;;;6470   	bPARALLEL=0;
0046aa  f88b602d          STRB     r6,[r11,#0x2d]
                  |L1.18094|
;;;6471   	}
;;;6472   }
0046ae  e661              B        |L1.17268|
                  |L1.18096|
0046b0  f88ba02d          STRB     r10,[r11,#0x2d]       ;6466
0046b4  e65e              B        |L1.17268|
;;;6473   
                          ENDP

                  powerAntiAliasingHndl PROC
;;;6480   //-----------------------------------------------
;;;6481   void powerAntiAliasingHndl(void)
0046b6  b570              PUSH     {r4-r6,lr}
;;;6482   {
;;;6483   if((power_summary_tempo/10UL)==(power_summary_tempo_old/10UL))
0046b8  230a              MOVS     r3,#0xa
0046ba  4c4d              LDR      r4,|L1.18416|
0046bc  484b              LDR      r0,|L1.18412|
;;;6484   	{
;;;6485   	if(powerSummaryCnt<15)powerSummaryCnt++;
;;;6486   	if(powerSummaryCnt>=10)
;;;6487   		{
;;;6488   		power_summary=power_summary_tempo;
;;;6489   		}
;;;6490   	}
;;;6491   else powerSummaryCnt=0;
0046be  2500              MOVS     r5,#0
0046c0  6822              LDR      r2,[r4,#0]            ;6483  ; power_summary_tempo_old
0046c2  6800              LDR      r0,[r0,#0]            ;6483  ; power_summary_tempo
0046c4  fbb2f6f3          UDIV     r6,r2,r3              ;6483
0046c8  fbb0f1f3          UDIV     r1,r0,r3              ;6483
0046cc  4a49              LDR      r2,|L1.18420|
0046ce  42b1              CMP      r1,r6                 ;6483
0046d0  d10b              BNE      |L1.18154|
0046d2  7811              LDRB     r1,[r2,#0]            ;6485  ; powerSummaryCnt
0046d4  290f              CMP      r1,#0xf               ;6485
0046d6  d202              BCS      |L1.18142|
0046d8  f1010101          ADD      r1,r1,#1              ;6485
0046dc  7011              STRB     r1,[r2,#0]            ;6485
                  |L1.18142|
0046de  7811              LDRB     r1,[r2,#0]            ;6486  ; powerSummaryCnt
0046e0  290a              CMP      r1,#0xa               ;6486
0046e2  d303              BCC      |L1.18156|
0046e4  4944              LDR      r1,|L1.18424|
0046e6  6008              STR      r0,[r1,#0]            ;6488  ; power_summary
0046e8  e000              B        |L1.18156|
                  |L1.18154|
0046ea  7015              STRB     r5,[r2,#0]
                  |L1.18156|
;;;6492   power_summary_tempo_old=power_summary_tempo;
0046ec  6020              STR      r0,[r4,#0]  ; power_summary_tempo_old
;;;6493   
;;;6494   if((power_current_tempo/10UL)==(power_current_tempo_old/10UL))
0046ee  4843              LDR      r0,|L1.18428|
0046f0  4c43              LDR      r4,|L1.18432|
0046f2  f9b00000          LDRSH    r0,[r0,#0]  ; power_current_tempo
0046f6  f9b42000          LDRSH    r2,[r4,#0]  ; power_current_tempo_old
0046fa  fbb0f1f3          UDIV     r1,r0,r3
0046fe  fbb2f3f3          UDIV     r3,r2,r3
;;;6495   	{
;;;6496   	if(powerCurrentCnt<15)powerCurrentCnt++;
004702  4a40              LDR      r2,|L1.18436|
004704  4299              CMP      r1,r3                 ;6494
004706  d10b              BNE      |L1.18208|
004708  7811              LDRB     r1,[r2,#0]  ; powerCurrentCnt
00470a  290f              CMP      r1,#0xf
00470c  d202              BCS      |L1.18196|
00470e  f1010101          ADD      r1,r1,#1
004712  7011              STRB     r1,[r2,#0]
                  |L1.18196|
;;;6497   	if(powerCurrentCnt>=10)
004714  7811              LDRB     r1,[r2,#0]  ; powerCurrentCnt
004716  290a              CMP      r1,#0xa
004718  d303              BCC      |L1.18210|
;;;6498   		{
;;;6499   		power_current=power_current_tempo;
00471a  493b              LDR      r1,|L1.18440|
00471c  8008              STRH     r0,[r1,#0]
00471e  e000              B        |L1.18210|
                  |L1.18208|
;;;6500   		}
;;;6501   	}
;;;6502   else powerCurrentCnt=0;
004720  7015              STRB     r5,[r2,#0]
                  |L1.18210|
;;;6503   power_current_tempo_old=power_current_tempo;
004722  8020              STRH     r0,[r4,#0]
;;;6504   }
004724  bd70              POP      {r4-r6,pc}
;;;6505   
                          ENDP

                  energometr_hndl PROC
;;;6615   //-----------------------------------------------
;;;6616   void energometr_hndl(void)
004726  4770              BX       lr
;;;6617   {
;;;6618   //2F 3F 21 0D 0A 
;;;6619   //05 33 0A 2F 45 4B 54 35 43 45 31 30 32 4D 76 30 31 0D 0A 
;;;6620   //2F 3F 21 0D 0A 
;;;6621   //05 33 0A 2F 45 4B 54 35 43 45 31 30 32 4D 76 30 31 0D 0A 
;;;6622   //06 30 35 31 0D 0A 
;;;6623   //06 33 0A 01 50 30 02 28 31 31 38 36 35 32 39 32 32 29 03 2A 
;;;6624   
;;;6625   #ifdef CE102M_ENABLED
;;;6626   /*if
;;;6627   uart_out1 (5,0xaf,0x3f,0x21,0x8d,0x0a,0);*/
;;;6628   
;;;6629   if(read_power_cnt_main_cnt)
;;;6630   	{
;;;6631   	read_power_cnt_main_cnt--;
;;;6632   	if(read_power_cnt_main_cnt==0)
;;;6633   		{
;;;6634   		rx_read_power_cnt_phase=0;
;;;6635   		if(bENERGOMETR_UIP==0)bENERGOMETR_UIP=1;
;;;6636   		else if(bENERGOMETR_UIP==1)bENERGOMETR_UIP=2;
;;;6637   		else bENERGOMETR_UIP=0;
;;;6638   		//bENERGOMETR_UIP=2;
;;;6639   		}
;;;6640   	}
;;;6641   
;;;6642   if (rx_read_power_cnt_phase==0)
;;;6643   	{
;;;6644   	char command_with_crc[20];
;;;6645   	
;;;6646      	command_with_crc[0]=0xaf;  // /
;;;6647   	command_with_crc[1]=0x3f;  // ?
;;;6648   	command_with_crc[2]=0x21;  // !
;;;6649   	command_with_crc[3]=0x8d;  // CR
;;;6650   	command_with_crc[4]=0x0a;  // LF
;;;6651   
;;;6652   	uart_out__adr1(command_with_crc,5);
;;;6653   
;;;6654   	rx_wr_index1=0;
;;;6655   	rx_read_power_cnt_phase=1;
;;;6656   
;;;6657   	read_power_cnt_main_cnt=50;
;;;6658   	}
;;;6659   if ((rx_read_power_cnt_phase==2)&&(!ce102m_delayCnt))
;;;6660   	{
;;;6661   	char command_with_crc[20];
;;;6662   	
;;;6663   	command_with_crc[0]=0x06;  //  
;;;6664   	command_with_crc[1]=0x30;  // 0
;;;6665   	command_with_crc[2]=0x35;  // 5
;;;6666   	command_with_crc[3]=0xb1;  // 1
;;;6667   	command_with_crc[4]=0x8d;  // CR
;;;6668   	command_with_crc[5]=0x0a;  // LF
;;;6669   	
;;;6670   	uart_out__adr1(command_with_crc,6);
;;;6671   	
;;;6672   	rx_wr_index1=0;
;;;6673   	rx_read_power_cnt_phase=3;
;;;6674   
;;;6675   	read_power_cnt_main_cnt=50;
;;;6676   	}  
;;;6677   
;;;6678   if ((rx_read_power_cnt_phase==4)&&(!ce102m_delayCnt))
;;;6679   	{
;;;6680   	char command_with_crc[20];
;;;6681   	
;;;6682   	command_with_crc[0]=0x81;  //  
;;;6683   	command_with_crc[1]=0xd2;  // 0
;;;6684   	command_with_crc[2]=0xb1;  // 5
;;;6685   	command_with_crc[3]=0x82;  // 1
;;;6686   	command_with_crc[4]=0x56;  // CR
;;;6687   	command_with_crc[5]=0xcf;  // LF
;;;6688   	command_with_crc[6]=0xcc;  // 1
;;;6689   	command_with_crc[7]=0xd4;  // CR
;;;6690   	command_with_crc[8]=0x41;  // LF
;;;6691   	command_with_crc[9]=0x28;  // 1
;;;6692   	command_with_crc[10]=0xa9;  // CR
;;;6693   	command_with_crc[11]=0x03;  // LF
;;;6694   	command_with_crc[12]=0x5f;  // LF
;;;6695   		
;;;6696   	uart_out__adr1(command_with_crc,13);
;;;6697   	
;;;6698   	rx_wr_index1=0;
;;;6699   	rx_read_power_cnt_phase=5;
;;;6700   
;;;6701   	read_power_cnt_main_cnt=50;
;;;6702   	}  
;;;6703   
;;;6704   if ((rx_read_power_cnt_phase==8)&&(!ce102m_delayCnt))
;;;6705   	{
;;;6706   	char command_with_crc[20];
;;;6707   	
;;;6708   	command_with_crc[0]=0x81;  //  
;;;6709   	command_with_crc[1]=0xd2;  // 0
;;;6710   	command_with_crc[2]=0xb1;  // 5
;;;6711   	command_with_crc[3]=0x82;  // 1
;;;6712   	command_with_crc[4]=0xc3;  // CR
;;;6713   	command_with_crc[5]=0x55;  // LF
;;;6714   	command_with_crc[6]=0xd2;  // 1
;;;6715   	command_with_crc[7]=0xd2;  // CR
;;;6716   	command_with_crc[8]=0xc5;  // LF
;;;6717   	command_with_crc[9]=0x28;  // 1
;;;6718   	command_with_crc[10]=0xa9;  // CR
;;;6719   	command_with_crc[11]=0x03;  // LF
;;;6720   	command_with_crc[12]=0x5a;  // LF
;;;6721   		
;;;6722   	uart_out__adr1(command_with_crc,13);
;;;6723   	
;;;6724   	rx_wr_index1=0;
;;;6725   	rx_read_power_cnt_phase=9;
;;;6726   
;;;6727   	read_power_cnt_main_cnt=50;
;;;6728   	}  
;;;6729   
;;;6730   if ((rx_read_power_cnt_phase==20)&&(!ce102m_delayCnt))
;;;6731   	{
;;;6732   	char command_with_crc[20];
;;;6733   	
;;;6734   	command_with_crc[0]=0x81;  //  		01
;;;6735   	command_with_crc[1]=0xd2;  // R		52
;;;6736   	command_with_crc[2]=0xb1;  // 1		31
;;;6737   	command_with_crc[3]=0x82;  // 		02
;;;6738   	command_with_crc[4]=0x50;  // P		50
;;;6739   	command_with_crc[5]=0xcf;  // O	  	4f
;;;6740   	command_with_crc[6]=0xd7;  // W		57
;;;6741   	command_with_crc[7]=0xc5;  // E		45
;;;6742   	command_with_crc[8]=0x50;  // P		50
;;;6743   	command_with_crc[9]=0x28;  // (		28
;;;6744   	command_with_crc[10]=0xa9;  // )	29
;;;6745   	command_with_crc[11]=0x03;  // 		03
;;;6746   	command_with_crc[12]=0xe4;  // d	64
;;;6747   		
;;;6748   	uart_out__adr1(command_with_crc,13);
;;;6749   	
;;;6750   	rx_wr_index1=0;
;;;6751   	rx_read_power_cnt_phase=21;
;;;6752   
;;;6753   	read_power_cnt_main_cnt=50;
;;;6754   	}  
;;;6755   
;;;6756   
;;;6757   #endif
;;;6758   }
;;;6759   
                          ENDP

                  ips_current_average_hndl PROC
;;;6760   //-----------------------------------------------
;;;6761   void ips_current_average_hndl(void)		//процедура выравнивания токов между комплектами ЗВУ 1Гц
004728  e92d4ff0          PUSH     {r4-r11,lr}
;;;6762   {
00472c  b089              SUB      sp,sp,#0x24
;;;6763   
;;;6764   if(++ica_timer_cnt>=10) 
00472e  4e37              LDR      r6,|L1.18444|
;;;6765   	{
;;;6766   	ica_timer_cnt=0;
004730  2400              MOVS     r4,#0
004732  7830              LDRB     r0,[r6,#0]            ;6764  ; ica_timer_cnt
004734  1c40              ADDS     r0,r0,#1              ;6764
004736  b2c0              UXTB     r0,r0                 ;6764
004738  7030              STRB     r0,[r6,#0]            ;6764
00473a  280a              CMP      r0,#0xa               ;6764
00473c  d300              BCC      |L1.18240|
00473e  7034              STRB     r4,[r6,#0]
                  |L1.18240|
;;;6767   	}
;;;6768   
;;;6769   if((ica_timer_cnt==0) && (num_of_wrks_bps)&&((spc_stat==spcOFF)&&(vz1_stat==vz1sOFF)&&(vz2_stat==vz2sOFF)&&(sp_ch_stat==scsOFF)))
004740  7830              LDRB     r0,[r6,#0]  ; ica_timer_cnt
004742  4f33              LDR      r7,|L1.18448|
;;;6770   	{
;;;6771   	
;;;6772   	ica_plazma[0]++;
;;;6773   
;;;6774   	ica_my_current=bps_I;
;;;6775   
;;;6776   	if((ica_my_current>ica_your_current)&&((ica_my_current-ica_your_current)>=5)&&((ICA_EN==1)||((ICA_EN==2)&&(ica_cntrl_hndl_cnt>5))))
004744  f8dfb0cc          LDR      r11,|L1.18452|
004748  4d20              LDR      r5,|L1.18380|
00474a  bbe8              CBNZ     r0,|L1.18376|
00474c  7fa8              LDRB     r0,[r5,#0x1e]         ;6769  ; num_of_wrks_bps
00474e  b3d8              CBZ      r0,|L1.18376|
004750  f8950023          LDRB     r0,[r5,#0x23]         ;6769  ; spc_stat
004754  7969              LDRB     r1,[r5,#5]            ;6769  ; vz1_stat
004756  4308              ORRS     r0,r0,r1              ;6769
004758  79e9              LDRB     r1,[r5,#7]            ;6769  ; vz2_stat
00475a  4308              ORRS     r0,r0,r1              ;6769
00475c  7839              LDRB     r1,[r7,#0]            ;6769  ; sp_ch_stat
00475e  4308              ORRS     r0,r0,r1              ;6769
004760  d17f              BNE      |L1.18530|
004762  f8df90b4          LDR      r9,|L1.18456|
004766  f8990000          LDRB     r0,[r9,#0]            ;6772  ; ica_plazma
00476a  f1000001          ADD      r0,r0,#1              ;6772
00476e  f8890000          STRB     r0,[r9,#0]            ;6772
004772  482a              LDR      r0,|L1.18460|
004774  f9b01000          LDRSH    r1,[r0,#0]            ;6774  ; bps_I
004778  4829              LDR      r0,|L1.18464|
00477a  8001              STRH     r1,[r0,#0]            ;6774
00477c  4829              LDR      r0,|L1.18468|
;;;6777   		{
;;;6778   		ica_plazma[1]++;
;;;6779   		ica_u_necc--;
00477e  f8dfa0a8          LDR      r10,|L1.18472|
004782  f9b02000          LDRSH    r2,[r0,#0]            ;6776  ; ica_your_current
004786  4648              MOV      r0,r9                 ;6772
004788  f9bac000          LDRSH    r12,[r10,#0]
00478c  7843              LDRB     r3,[r0,#1]            ;6778
00478e  4827              LDR      r0,|L1.18476|
004790  4291              CMP      r1,r2                 ;6776
004792  f9b08000          LDRSH    r8,[r0,#0]            ;6776
004796  4658              MOV      r0,r11                ;6776
004798  f9b00000          LDRSH    r0,[r0,#0]            ;6776
00479c  dd48              BLE      |L1.18480|
00479e  eba10e02          SUB      lr,r1,r2              ;6776
0047a2  f1be0f05          CMP      lr,#5                 ;6776
0047a6  db43              BLT      |L1.18480|
0047a8  2801              CMP      r0,#1                 ;6776
0047aa  d004              BEQ      |L1.18358|
0047ac  2802              CMP      r0,#2                 ;6776
0047ae  d13f              BNE      |L1.18480|
0047b0  f1b80f05          CMP      r8,#5                 ;6776
0047b4  dd3c              BLE      |L1.18480|
                  |L1.18358|
0047b6  f1030301          ADD      r3,r3,#1              ;6778
0047ba  f8893001          STRB     r3,[r9,#1]            ;6778
0047be  f1ac0c01          SUB      r12,r12,#1
0047c2  f8aac000          STRH     r12,[r10,#0]
0047c6  e047              B        |L1.18520|
                  |L1.18376|
0047c8  e04b              B        |L1.18530|
0047ca  0000              DCW      0x0000
                  |L1.18380|
                          DCD      ||area_number.26||
                  |L1.18384|
                          DCD      bps
                  |L1.18388|
                          DCD      mess_data
                  |L1.18392|
                          DCD      NUMIST
                  |L1.18396|
                          DCD      num_necc
                  |L1.18400|
                          DCD      main_1Hz_cnt
                  |L1.18404|
                          DCD      ipsBlckStat
                  |L1.18408|
                          DCD      TSIGN
                  |L1.18412|
                          DCD      power_summary_tempo
                  |L1.18416|
                          DCD      power_summary_tempo_old
                  |L1.18420|
                          DCD      powerSummaryCnt
                  |L1.18424|
                          DCD      power_summary
                  |L1.18428|
                          DCD      power_current_tempo
                  |L1.18432|
                          DCD      power_current_tempo_old
                  |L1.18436|
                          DCD      powerCurrentCnt
                  |L1.18440|
                          DCD      power_current
                  |L1.18444|
                          DCD      ica_timer_cnt
                  |L1.18448|
                          DCD      sp_ch_stat
                  |L1.18452|
                          DCD      ICA_EN
                  |L1.18456|
                          DCD      ica_plazma
                  |L1.18460|
                          DCD      bps_I
                  |L1.18464|
                          DCD      ica_my_current
                  |L1.18468|
                          DCD      ica_your_current
                  |L1.18472|
                          DCD      ica_u_necc
                  |L1.18476|
                          DCD      ica_cntrl_hndl_cnt
                  |L1.18480|
;;;6780   		}
;;;6781   	else if((ica_my_current<ica_your_current)&&((ica_your_current-ica_my_current)>=5)&&((ICA_EN==1)||((ICA_EN==2)&&(ica_cntrl_hndl_cnt>5))))
004830  4291              CMP      r1,r2
004832  da11              BGE      |L1.18520|
004834  1a51              SUBS     r1,r2,r1
004836  2905              CMP      r1,#5
004838  db0e              BLT      |L1.18520|
00483a  2801              CMP      r0,#1
00483c  d004              BEQ      |L1.18504|
00483e  2802              CMP      r0,#2
004840  d10a              BNE      |L1.18520|
004842  f1b80f05          CMP      r8,#5
004846  dd07              BLE      |L1.18520|
                  |L1.18504|
;;;6782   		{
;;;6783   		ica_plazma[1]--;
004848  f1a30301          SUB      r3,r3,#1
00484c  f8893001          STRB     r3,[r9,#1]
;;;6784   		ica_u_necc++;
004850  f10c0c01          ADD      r12,r12,#1
004854  f8aac000          STRH     r12,[r10,#0]
                  |L1.18520|
;;;6785   		}
;;;6786   	gran(&ica_u_necc,-100,100);
004858  2264              MOVS     r2,#0x64
00485a  4251              RSBS     r1,r2,#0
00485c  48fc              LDR      r0,|L1.19536|
00485e  f7fffffe          BL       gran
                  |L1.18530|
;;;6787   	}
;;;6788   
;;;6789   
;;;6790   if((ICA_EN==1)&&((spc_stat==spcOFF)&&(vz1_stat==vz1sOFF)&&(vz2_stat==vz2sOFF)&&(sp_ch_stat==scsOFF)) && (num_of_wrks_bps))
004862  f8bb0000          LDRH     r0,[r11,#0]  ; ICA_EN
004866  2801              CMP      r0,#1
004868  d169              BNE      |L1.18750|
00486a  f8950023          LDRB     r0,[r5,#0x23]  ; spc_stat
00486e  7969              LDRB     r1,[r5,#5]  ; vz1_stat
004870  4308              ORRS     r0,r0,r1
004872  79e9              LDRB     r1,[r5,#7]  ; vz2_stat
004874  4308              ORRS     r0,r0,r1
004876  7839              LDRB     r1,[r7,#0]  ; sp_ch_stat
004878  4308              ORRS     r0,r0,r1
00487a  d160              BNE      |L1.18750|
00487c  7fa8              LDRB     r0,[r5,#0x1e]  ; num_of_wrks_bps
00487e  2800              CMP      r0,#0
004880  d05d              BEQ      |L1.18750|
;;;6791   	{
;;;6792   	
;;;6793   //	ica_connect_cnt++;
;;;6794   
;;;6795   	if(ica_timer_cnt==8)
004882  7830              LDRB     r0,[r6,#0]  ; ica_timer_cnt
;;;6796   		{
;;;6797   		char modbus_buff[20],i;
;;;6798   		short crc_temp;
;;;6799   	
;;;6800   		modbus_buff[0] = ICA_MODBUS_ADDRESS;
004884  4bf3              LDR      r3,|L1.19540|
;;;6801   		modbus_buff[1] = 4;
;;;6802   		modbus_buff[2] = 0;
;;;6803   		modbus_buff[3] = 2;
;;;6804   		modbus_buff[4] = 0;	
;;;6805   		modbus_buff[5] = 1;
;;;6806   	
;;;6807   		crc_temp= CRC16_2(modbus_buff,6);
;;;6808   	
;;;6809   		modbus_buff[6]= (char)crc_temp;
;;;6810   		modbus_buff[7]= (char)(crc_temp>>8);
;;;6811   	
;;;6812   		if(ICA_CH==0)
004886  4ff4              LDR      r7,|L1.19544|
004888  2808              CMP      r0,#8                 ;6795
00488a  d05b              BEQ      |L1.18756|
;;;6813   			{
;;;6814   			for (i=0;i<8;i++)
;;;6815   				{
;;;6816   				putchar_sc16is700(modbus_buff[i]);
;;;6817   				}
;;;6818   			}
;;;6819   		else if(ICA_CH==2)
;;;6820   			{
;;;6821   			uart_out1 (5,4,0,2,0,1,0);
;;;6822   			}
;;;6823   		}
;;;6824   	else
;;;6825   		{
;;;6826   		char modbus_buff[20],i;
;;;6827   		short crc_temp, tempSSSS;
;;;6828   
;;;6829   		tempSSSS=cntrl_stat_old;
00488c  f9b56034          LDRSH    r6,[r5,#0x34]  ; cntrl_stat_old
;;;6830   		if(	(main_kb_cnt==(TBAT*60)-21) || (main_kb_cnt==(TBAT*60)-20) || (main_kb_cnt==(TBAT*60)-19)) tempSSSS=((short)TBAT)|0x4000;
004890  48f2              LDR      r0,|L1.19548|
004892  f06f0214          MVN      r2,#0x14
004896  f9b00000          LDRSH    r0,[r0,#0]  ; TBAT
00489a  ebc01100          RSB      r1,r0,r0,LSL #4
00489e  eb020c81          ADD      r12,r2,r1,LSL #2
0048a2  f9b52052          LDRSH    r2,[r5,#0x52]  ; main_kb_cnt
0048a6  4594              CMP      r12,r2
0048a8  d00b              BEQ      |L1.18626|
0048aa  f06f0c13          MVN      r12,#0x13
0048ae  eb0c0c81          ADD      r12,r12,r1,LSL #2
0048b2  4594              CMP      r12,r2
0048b4  d005              BEQ      |L1.18626|
0048b6  f06f0c12          MVN      r12,#0x12
0048ba  eb0c0181          ADD      r1,r12,r1,LSL #2
0048be  4291              CMP      r1,r2
0048c0  d101              BNE      |L1.18630|
                  |L1.18626|
0048c2  f4404680          ORR      r6,r0,#0x4000
                  |L1.18630|
;;;6831   
;;;6832   
;;;6833   		modbus_buff[0] = ICA_MODBUS_ADDRESS;
0048c6  8818              LDRH     r0,[r3,#0]  ; ICA_MODBUS_ADDRESS
0048c8  f88d0010          STRB     r0,[sp,#0x10]
;;;6834   		modbus_buff[1] = 6;
0048cc  f04f0006          MOV      r0,#6
0048d0  f88d0011          STRB     r0,[sp,#0x11]
;;;6835   		modbus_buff[2] = 0;
0048d4  f88d4012          STRB     r4,[sp,#0x12]
;;;6836   		modbus_buff[3] = 100;
0048d8  f04f0064          MOV      r0,#0x64
0048dc  f88d0013          STRB     r0,[sp,#0x13]
;;;6837   		modbus_buff[4] = (char)(tempSSSS/256);	
0048e0  ea4f70e6          ASR      r0,r6,#31
0048e4  eb066010          ADD      r0,r6,r0,LSR #24
0048e8  ea4f2120          ASR      r1,r0,#8
0048ec  f88d1014          STRB     r1,[sp,#0x14]
;;;6838   		modbus_buff[5] = (char)(tempSSSS%256);
0048f0  4630              MOV      r0,r6
0048f2  f88d0015          STRB     r0,[sp,#0x15]
;;;6839   	
;;;6840   		crc_temp= CRC16_2(modbus_buff,6);
0048f6  f04f0106          MOV      r1,#6
0048fa  a804              ADD      r0,sp,#0x10
0048fc  f7fffffe          BL       CRC16_2
;;;6841   	
;;;6842   		modbus_buff[6]= (char)crc_temp;
004900  f88d0016          STRB     r0,[sp,#0x16]
;;;6843   		modbus_buff[7]= (char)(crc_temp>>8);
004904  ea4f2020          ASR      r0,r0,#8
004908  f88d0017          STRB     r0,[sp,#0x17]
;;;6844   	
;;;6845   		crc_temp= CRC16_2(modbus_buff,6);
00490c  f04f0106          MOV      r1,#6
004910  a804              ADD      r0,sp,#0x10
004912  f7fffffe          BL       CRC16_2
;;;6846   	
;;;6847   		plazma_ica1=tempSSSS;
004916  f8a5607e          STRH     r6,[r5,#0x7e]
;;;6848   		if(ICA_CH==0)
00491a  f9b70000          LDRSH    r0,[r7,#0]  ; ICA_CH
00491e  b3f0              CBZ      r0,|L1.18846|
;;;6849   			{
;;;6850   			for (i=0;i<8;i++)
;;;6851   				{
;;;6852   				putchar_sc16is700(modbus_buff[i]);
;;;6853   				}
;;;6854   			}
;;;6855   		else if(ICA_CH==2)
004920  2802              CMP      r0,#2
004922  d10c              BNE      |L1.18750|
;;;6856   			{
;;;6857   			uart_out1 (5,6,0,100,modbus_buff[4],modbus_buff[5],0);
004924  f89d0015          LDRB     r0,[sp,#0x15]
004928  f89d1014          LDRB     r1,[sp,#0x14]
00492c  e9cd0401          STRD     r0,r4,[sp,#4]
004930  9100              STR      r1,[sp,#0]
004932  2364              MOVS     r3,#0x64
004934  2200              MOVS     r2,#0
004936  2106              MOVS     r1,#6
004938  2005              MOVS     r0,#5
00493a  f7fffffe          BL       uart_out1
                  |L1.18750|
;;;6858   			}
;;;6859   		}
;;;6860   	}
;;;6861   }
00493e  b009              ADD      sp,sp,#0x24
004940  e8bd8ff0          POP      {r4-r11,pc}
                  |L1.18756|
004944  8818              LDRH     r0,[r3,#0]            ;6800  ; ICA_MODBUS_ADDRESS
004946  f88d0010          STRB     r0,[sp,#0x10]         ;6800
00494a  f04f0004          MOV      r0,#4                 ;6801
00494e  f88d0011          STRB     r0,[sp,#0x11]         ;6801
004952  f88d4012          STRB     r4,[sp,#0x12]         ;6802
004956  f04f0002          MOV      r0,#2                 ;6803
00495a  f88d0013          STRB     r0,[sp,#0x13]         ;6803
00495e  f88d4014          STRB     r4,[sp,#0x14]         ;6804
004962  f04f0501          MOV      r5,#1                 ;6805
004966  f88d5015          STRB     r5,[sp,#0x15]         ;6805
00496a  f04f0106          MOV      r1,#6                 ;6807
00496e  a804              ADD      r0,sp,#0x10           ;6807
004970  f7fffffe          BL       CRC16_2
004974  f88d0016          STRB     r0,[sp,#0x16]         ;6809
004978  ea4f2020          ASR      r0,r0,#8              ;6810
00497c  f88d0017          STRB     r0,[sp,#0x17]         ;6810
004980  f9b70000          LDRSH    r0,[r7,#0]            ;6812  ; ICA_CH
004984  b160              CBZ      r0,|L1.18848|
004986  2802              CMP      r0,#2                 ;6819
004988  d1d9              BNE      |L1.18750|
00498a  e9cd4500          STRD     r4,r5,[sp,#0]         ;6821
00498e  2302              MOVS     r3,#2                 ;6821
004990  2200              MOVS     r2,#0                 ;6821
004992  2104              MOVS     r1,#4                 ;6821
004994  2005              MOVS     r0,#5                 ;6821
004996  9402              STR      r4,[sp,#8]            ;6821
004998  f7fffffe          BL       uart_out1
00499c  e7cf              B        |L1.18750|
                  |L1.18846|
00499e  e00b              B        |L1.18872|
                  |L1.18848|
0049a0  f04f0400          MOV      r4,#0                 ;6814
0049a4  ad04              ADD      r5,sp,#0x10           ;6797
                  |L1.18854|
0049a6  5d28              LDRB     r0,[r5,r4]            ;6816
0049a8  f7fffffe          BL       putchar_sc16is700
0049ac  f1040401          ADD      r4,r4,#1              ;6814
0049b0  b2e4              UXTB     r4,r4                 ;6814
0049b2  2c08              CMP      r4,#8                 ;6814
0049b4  d3f7              BCC      |L1.18854|
0049b6  e7c2              B        |L1.18750|
                  |L1.18872|
0049b8  f04f0400          MOV      r4,#0                 ;6850
0049bc  ad04              ADD      r5,sp,#0x10           ;6826
                  |L1.18878|
0049be  5d28              LDRB     r0,[r5,r4]            ;6852
0049c0  f7fffffe          BL       putchar_sc16is700
0049c4  f1040401          ADD      r4,r4,#1              ;6850
0049c8  b2e4              UXTB     r4,r4                 ;6850
0049ca  2c08              CMP      r4,#8                 ;6850
0049cc  d3f7              BCC      |L1.18878|
0049ce  e7b6              B        |L1.18750|
;;;6862   
                          ENDP

                  ipsBlckHndl PROC
;;;6945   //-----------------------------------------------
;;;6946   void ipsBlckHndl(char in)
0049d0  b510              PUSH     {r4,lr}
;;;6947   {
;;;6948   
;;;6949   ipsBlckStat=0;
0049d2  4ba3              LDR      r3,|L1.19552|
0049d4  f04f0000          MOV      r0,#0
0049d8  8018              STRH     r0,[r3,#0]
;;;6950   if(ipsBlckSrc==1)
0049da  48a2              LDR      r0,|L1.19556|
0049dc  f04f0401          MOV      r4,#1
;;;6951   	{
;;;6952   	if(((ipsBlckLog==0)&&(adc_buff_[11]>2000)) || ((ipsBlckLog==1)&&(adc_buff_[11]<2000))) ipsBlckStat=1;
0049e0  f44f62fa          MOV      r2,#0x7d0
0049e4  f9b01000          LDRSH    r1,[r0,#0]            ;6950  ; ipsBlckSrc
0049e8  489f              LDR      r0,|L1.19560|
0049ea  2901              CMP      r1,#1                 ;6950
0049ec  f9b00000          LDRSH    r0,[r0,#0]
0049f0  d006              BEQ      |L1.18944|
;;;6953   	}
;;;6954   else if(ipsBlckSrc==2)
0049f2  2902              CMP      r1,#2
0049f4  d10f              BNE      |L1.18966|
0049f6  499d              LDR      r1,|L1.19564|
;;;6955   	{
;;;6956   	if(((ipsBlckLog==0)&&(adc_buff_[13]>2000)) || ((ipsBlckLog==1)&&(adc_buff_[13]<2000))) ipsBlckStat=1;
0049f8  f9b1101a          LDRSH    r1,[r1,#0x1a]
0049fc  b160              CBZ      r0,|L1.18968|
0049fe  e00d              B        |L1.18972|
                  |L1.18944|
004a00  499a              LDR      r1,|L1.19564|
004a02  f9b11016          LDRSH    r1,[r1,#0x16]         ;6952
004a06  b908              CBNZ     r0,|L1.18956|
004a08  4291              CMP      r1,r2                 ;6952
004a0a  dc03              BGT      |L1.18964|
                  |L1.18956|
004a0c  2801              CMP      r0,#1                 ;6952
004a0e  d102              BNE      |L1.18966|
004a10  4291              CMP      r1,r2                 ;6952
004a12  da00              BGE      |L1.18966|
                  |L1.18964|
004a14  801c              STRH     r4,[r3,#0]            ;6952
                  |L1.18966|
;;;6957   	}
;;;6958   }
004a16  bd10              POP      {r4,pc}
                  |L1.18968|
004a18  4291              CMP      r1,r2                 ;6956
004a1a  dc03              BGT      |L1.18980|
                  |L1.18972|
004a1c  2801              CMP      r0,#1                 ;6956
004a1e  d1fa              BNE      |L1.18966|
004a20  4291              CMP      r1,r2                 ;6956
004a22  daf8              BGE      |L1.18966|
                  |L1.18980|
004a24  801c              STRH     r4,[r3,#0]            ;6956
004a26  bd10              POP      {r4,pc}
;;;6959   
                          ENDP

                  bps_drv PROC
;;;6960   //-----------------------------------------------
;;;6961   void bps_drv(char in)
004a28  e92d41f0          PUSH     {r4-r8,lr}
;;;6962   {
004a2c  4606              MOV      r6,r0
;;;6963   char temp;
;;;6964   
;;;6965   if (bps[in]._device!=dSRC) return;
004a2e  eb0600c6          ADD      r0,r6,r6,LSL #3
004a32  498f              LDR      r1,|L1.19568|
004a34  eb001006          ADD      r0,r0,r6,LSL #4
004a38  f8112020          LDRB     r2,[r1,r0,LSL #2]
004a3c  2a03              CMP      r2,#3
004a3e  d17d              BNE      |L1.19260|
;;;6966   temp=bps[in]._flags_tm;
004a40  eb010480          ADD      r4,r1,r0,LSL #2
004a44  f8945042          LDRB     r5,[r4,#0x42]
;;;6967   if(temp&(1<<AV_T))
004a48  07a8              LSLS     r0,r5,#30
004a4a  d517              BPL      |L1.19068|
;;;6968   	{
;;;6969   	if(bps[in]._temp_av_cnt<1200) 
004a4c  f9b41046          LDRSH    r1,[r4,#0x46]
004a50  f44f6296          MOV      r2,#0x4b0
004a54  4291              CMP      r1,r2
004a56  da22              BGE      |L1.19102|
;;;6970   		{
;;;6971   		bps[in]._temp_av_cnt++;
004a58  f1010101          ADD      r1,r1,#1
004a5c  b208              SXTH     r0,r1
004a5e  f8a40046          STRH     r0,[r4,#0x46]
;;;6972   		if(bps[in]._temp_av_cnt>=1200)
004a62  4290              CMP      r0,r2
004a64  db1b              BLT      |L1.19102|
;;;6973   			{
;;;6974   			bps[in]._temp_av_cnt=1200;
004a66  f8a42046          STRH     r2,[r4,#0x46]
;;;6975   		   	if(!(bps[in]._av&(1<<0)))avar_bps_hndl(in,0,1);
004a6a  7860              LDRB     r0,[r4,#1]
004a6c  07c0              LSLS     r0,r0,#31
004a6e  d116              BNE      |L1.19102|
004a70  2201              MOVS     r2,#1
004a72  2100              MOVS     r1,#0
004a74  4630              MOV      r0,r6
004a76  f7fffffe          BL       avar_bps_hndl
004a7a  e010              B        |L1.19102|
                  |L1.19068|
;;;6976   			}
;;;6977   		}
;;;6978   	}
;;;6979   
;;;6980   else if(!(temp&(1<<AV_T)))
;;;6981   	{
;;;6982   	if(bps[in]._temp_av_cnt) 
004a7c  f9b41046          LDRSH    r1,[r4,#0x46]
004a80  b169              CBZ      r1,|L1.19102|
;;;6983   		{
;;;6984   		bps[in]._temp_av_cnt--;
004a82  f1a10101          SUB      r1,r1,#1
004a86  b208              SXTH     r0,r1
004a88  f8a40046          STRH     r0,[r4,#0x46]
;;;6985   		if(!bps[in]._temp_av_cnt)
004a8c  b938              CBNZ     r0,|L1.19102|
;;;6986   			{
;;;6987   			if(bps[in]._av&(1<<0))avar_bps_hndl(in,0,0);
004a8e  7860              LDRB     r0,[r4,#1]
004a90  07c0              LSLS     r0,r0,#31
004a92  d004              BEQ      |L1.19102|
004a94  2200              MOVS     r2,#0
004a96  4611              MOV      r1,r2
004a98  4630              MOV      r0,r6
004a9a  f7fffffe          BL       avar_bps_hndl
                  |L1.19102|
;;;6988   			}
;;;6989   		} 	
;;;6990   
;;;6991   	}
;;;6992   
;;;6993   if((temp&(1<<AVUMAX)))
004a9e  0728              LSLS     r0,r5,#28
;;;6994   	{
;;;6995   	if(bps[in]._umax_av_cnt<10) 
;;;6996   		{
;;;6997   		bps[in]._umax_av_cnt++;
;;;6998   		if(bps[in]._umax_av_cnt>=10)
;;;6999   			{ 
;;;7000   			bps[in]._umax_av_cnt=10;
004aa0  f04f080a          MOV      r8,#0xa
004aa4  f04f0700          MOV      r7,#0                 ;6975
004aa8  d518              BPL      |L1.19164|
004aaa  f9b41048          LDRSH    r1,[r4,#0x48]         ;6995
004aae  290a              CMP      r1,#0xa               ;6995
004ab0  da29              BGE      |L1.19206|
004ab2  f1010101          ADD      r1,r1,#1              ;6997
004ab6  b208              SXTH     r0,r1                 ;6997
004ab8  f8a40048          STRH     r0,[r4,#0x48]         ;6997
004abc  280a              CMP      r0,#0xa               ;6998
004abe  db22              BLT      |L1.19206|
004ac0  f8a48048          STRH     r8,[r4,#0x48]
;;;7001   			if(!(bps[in]._av&(1<<1)))avar_bps_hndl(in,1,1);
004ac4  7860              LDRB     r0,[r4,#1]
004ac6  0780              LSLS     r0,r0,#30
004ac8  d404              BMI      |L1.19156|
004aca  2201              MOVS     r2,#1
004acc  4611              MOV      r1,r2
004ace  4630              MOV      r0,r6
004ad0  f7fffffe          BL       avar_bps_hndl
                  |L1.19156|
;;;7002   			apv_start(in);
004ad4  4630              MOV      r0,r6
004ad6  f7fffffe          BL       apv_start
004ada  e014              B        |L1.19206|
                  |L1.19164|
;;;7003   		  	/*if((K[APV]!=ON)||((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afOFF)))avar_s_hndl(in,1,1);
;;;7004   			if((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afON))
;;;7005   				{
;;;7006   				apv_cnt[in,0]=APV_INIT;
;;;7007   				apv_cnt[in,1]=APV_INIT;
;;;7008   				apv_cnt[in,2]=APV_INIT;
;;;7009   				apv_flags[in]=afOFF;
;;;7010   				}				*/
;;;7011   						
;;;7012   			}
;;;7013   		} 
;;;7014   	}		
;;;7015   else if(!(temp&(1<<AVUMAX)))
;;;7016   	{
;;;7017   	if(bps[in]._umax_av_cnt>0) 
004adc  f9b41048          LDRSH    r1,[r4,#0x48]
004ae0  2900              CMP      r1,#0
004ae2  dd0d              BLE      |L1.19200|
;;;7018   		{
;;;7019   		bps[in]._umax_av_cnt--;
004ae4  f1a10101          SUB      r1,r1,#1
004ae8  b208              SXTH     r0,r1
004aea  f8a40048          STRH     r0,[r4,#0x48]
;;;7020   		if(bps[in]._umax_av_cnt==0)
004aee  b950              CBNZ     r0,|L1.19206|
;;;7021   			{
;;;7022   			bps[in]._umax_av_cnt=0;
;;;7023   			avar_bps_hndl(in,1,0);
004af0  f04f0200          MOV      r2,#0
004af4  f04f0101          MOV      r1,#1
004af8  4630              MOV      r0,r6
004afa  f7fffffe          BL       avar_bps_hndl
004afe  e002              B        |L1.19206|
                  |L1.19200|
;;;7024   			//apv_stop(in);
;;;7025   	 //		apv_cnt[in,0]=0;
;;;7026   	//		apv_cnt[in,1]=0;
;;;7027   	 //		apv_cnt[in,2]=0;			
;;;7028   			}
;;;7029   		}
;;;7030   	else if(bps[in]._umax_av_cnt<0) bps[in]._umax_av_cnt=0;		 
004b00  da01              BGE      |L1.19206|
004b02  f8a47048          STRH     r7,[r4,#0x48]
                  |L1.19206|
;;;7031   	}
;;;7032   
;;;7033   if(temp&(1<<AVUMIN))
004b06  06e8              LSLS     r0,r5,#27
004b08  d519              BPL      |L1.19262|
;;;7034   	{
;;;7035   	if(bps[in]._umin_av_cnt<10) 
004b0a  f9b4104a          LDRSH    r1,[r4,#0x4a]
004b0e  290a              CMP      r1,#0xa
004b10  da23              BGE      |L1.19290|
;;;7036   		{
;;;7037   		bps[in]._umin_av_cnt++;
004b12  f1010101          ADD      r1,r1,#1
004b16  b208              SXTH     r0,r1
004b18  f8a4004a          STRH     r0,[r4,#0x4a]
;;;7038   		if(bps[in]._umin_av_cnt>=10)
004b1c  280a              CMP      r0,#0xa
004b1e  db1c              BLT      |L1.19290|
;;;7039   			{ 
;;;7040   			bps[in]._umin_av_cnt=10;
004b20  f8a4804a          STRH     r8,[r4,#0x4a]
;;;7041   			if(!(bps[in]._av&(1<<2)))avar_bps_hndl(in,2,1);
004b24  7860              LDRB     r0,[r4,#1]
004b26  0740              LSLS     r0,r0,#29
004b28  d404              BMI      |L1.19252|
004b2a  2201              MOVS     r2,#1
004b2c  2102              MOVS     r1,#2
004b2e  4630              MOV      r0,r6
004b30  f7fffffe          BL       avar_bps_hndl
                  |L1.19252|
;;;7042   			apv_start(in);
004b34  4630              MOV      r0,r6
004b36  f7fffffe          BL       apv_start
004b3a  e00e              B        |L1.19290|
                  |L1.19260|
004b3c  e0b1              B        |L1.19618|
                  |L1.19262|
;;;7043   		  	/*	if((K[APV]!=ON)||((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afOFF)))avar_s_hndl(in,2,1);
;;;7044   			if((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afON))
;;;7045   				{
;;;7046   				apv_cnt[in,0]=APV_INIT;
;;;7047   				apv_cnt[in,1]=APV_INIT;
;;;7048   				apv_cnt[in,2]=APV_INIT;
;;;7049   				apv_flags[in]=afOFF;
;;;7050   				}*/				
;;;7051   			}
;;;7052   		} 
;;;7053   	}	
;;;7054   	
;;;7055   else if(!(temp&(1<<AVUMIN)))
;;;7056   	{
;;;7057   	if(bps[in]._umin_av_cnt) 
004b3e  f9b4004a          LDRSH    r0,[r4,#0x4a]
004b42  b150              CBZ      r0,|L1.19290|
;;;7058   		{
;;;7059   		bps[in]._umin_av_cnt--;
004b44  f1a00001          SUB      r0,r0,#1
004b48  b200              SXTH     r0,r0
004b4a  f8a4004a          STRH     r0,[r4,#0x4a]
;;;7060   		if(bps[in]._umin_av_cnt==0)
004b4e  b920              CBNZ     r0,|L1.19290|
;;;7061   			{
;;;7062   			bps[in]._umin_av_cnt=0;
;;;7063   			avar_bps_hndl(in,2,0);
004b50  2200              MOVS     r2,#0
004b52  2102              MOVS     r1,#2
004b54  4630              MOV      r0,r6
004b56  f7fffffe          BL       avar_bps_hndl
                  |L1.19290|
;;;7064   			//apv_stop(in);
;;;7065   		//	apv_cnt[in,0]=0;
;;;7066   		//	apv_cnt[in,1]=0;
;;;7067   		//	apv_cnt[in,2]=0;
;;;7068   			}
;;;7069   		}
;;;7070   	else if(bps[in]._umin_av_cnt>10)bps[in]._umin_av_cnt--;	 
;;;7071   	}
;;;7072   
;;;7073   if((bps[in]._Uii<(UB20-DU)))
004b5a  4846              LDR      r0,|L1.19572|
004b5c  69e1              LDR      r1,[r4,#0x1c]
004b5e  f9b02000          LDRSH    r2,[r0,#0]  ; UB20
004b62  4845              LDR      r0,|L1.19576|
004b64  f9b00000          LDRSH    r0,[r0,#0]  ; DU
004b68  1a10              SUBS     r0,r2,r0
004b6a  4281              CMP      r1,r0
004b6c  da1d              BGE      |L1.19370|
;;;7074   	{
;;;7075   	if(bps[in]._state==bsWRK)
004b6e  78a0              LDRB     r0,[r4,#2]
004b70  2801              CMP      r0,#1
004b72  d128              BNE      |L1.19398|
;;;7076   		{
;;;7077   		if(bps[in]._umin_av_cnt_uku<300) 
004b74  f9b4004c          LDRSH    r0,[r4,#0x4c]
004b78  f44f7196          MOV      r1,#0x12c
004b7c  4288              CMP      r0,r1
004b7e  da11              BGE      |L1.19364|
;;;7078   			{
;;;7079   			bps[in]._umin_av_cnt_uku++;
004b80  f1000001          ADD      r0,r0,#1
004b84  b200              SXTH     r0,r0
004b86  f8a4004c          STRH     r0,[r4,#0x4c]
;;;7080   			if(bps[in]._umin_av_cnt_uku>=300)
004b8a  4288              CMP      r0,r1
004b8c  db1b              BLT      |L1.19398|
;;;7081   				{ 
;;;7082   				bps[in]._umin_av_cnt_uku=300;
004b8e  f8a4104c          STRH     r1,[r4,#0x4c]
;;;7083   				if(!(bps[in]._av&(1<<2)))avar_bps_hndl(in,2,1);
004b92  7860              LDRB     r0,[r4,#1]
004b94  0740              LSLS     r0,r0,#29
004b96  d416              BMI      |L1.19398|
004b98  2201              MOVS     r2,#1
004b9a  2102              MOVS     r1,#2
004b9c  4630              MOV      r0,r6
004b9e  f7fffffe          BL       avar_bps_hndl
004ba2  e010              B        |L1.19398|
                  |L1.19364|
;;;7084   			  	/*	if((K[APV]!=ON)||((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afOFF)))avar_s_hndl(in,2,1);
;;;7085   				if((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afON))
;;;7086   					{
;;;7087   					apv_cnt[in,0]=APV_INIT;
;;;7088   					apv_cnt[in,1]=APV_INIT;
;;;7089   					apv_cnt[in,2]=APV_INIT;
;;;7090   					apv_flags[in]=afOFF;
;;;7091   					}*/				
;;;7092   				}
;;;7093   			}
;;;7094   		else
;;;7095   			{
;;;7096   			bps[in]._umin_av_cnt_uku=0;
004ba4  f8a4704c          STRH     r7,[r4,#0x4c]
004ba8  e00d              B        |L1.19398|
                  |L1.19370|
;;;7097   			} 
;;;7098   		}
;;;7099   	}	
;;;7100   	
;;;7101   else if(bps[in]._Uii>=(UB20-DU))
;;;7102   	{
;;;7103   	if(bps[in]._umin_av_cnt_uku) 
004baa  f9b4004c          LDRSH    r0,[r4,#0x4c]
004bae  b150              CBZ      r0,|L1.19398|
;;;7104   		{
;;;7105   		bps[in]._umin_av_cnt_uku--;
004bb0  f1a00001          SUB      r0,r0,#1
004bb4  b200              SXTH     r0,r0
004bb6  f8a4004c          STRH     r0,[r4,#0x4c]
;;;7106   		if(bps[in]._umin_av_cnt_uku==0)
004bba  b920              CBNZ     r0,|L1.19398|
;;;7107   			{
;;;7108   			bps[in]._umin_av_cnt_uku=0;
;;;7109   			avar_bps_hndl(in,2,0);
004bbc  2200              MOVS     r2,#0
004bbe  2102              MOVS     r1,#2
004bc0  4630              MOV      r0,r6
004bc2  f7fffffe          BL       avar_bps_hndl
                  |L1.19398|
;;;7110   		//	apv_cnt[in,0]=0;
;;;7111   		//	apv_cnt[in,1]=0;
;;;7112   		//	apv_cnt[in,2]=0;
;;;7113   			}
;;;7114   		}
;;;7115   	else if(bps[in]._umin_av_cnt_uku>300)bps[in]._umin_av_cnt_uku=300;	 
;;;7116   	}
;;;7117   
;;;7118   //bps[in]._state=bsOFF;
;;;7119   
;;;7120   if (bps[in]._av&0x0f)					bps[in]._state=bsAV;
004bc6  7860              LDRB     r0,[r4,#1]
004bc8  0700              LSLS     r0,r0,#28
004bca  d003              BEQ      |L1.19412|
004bcc  f04f0004          MOV      r0,#4
004bd0  70a0              STRB     r0,[r4,#2]
004bd2  e017              B        |L1.19460|
                  |L1.19412|
;;;7121   else if ( (net_av) && (bps[in]._cnt>20)/*&& 
004bd4  4829              LDR      r0,|L1.19580|
004bd6  7800              LDRB     r0,[r0,#0]  ; net_av
004bd8  b130              CBZ      r0,|L1.19432|
004bda  78e0              LDRB     r0,[r4,#3]
004bdc  2814              CMP      r0,#0x14
004bde  d903              BLS      |L1.19432|
;;;7122   		(bps[in]._Uii<200)*/)				bps[in]._state=bsOFF_AV_NET;
004be0  f04f0005          MOV      r0,#5
004be4  70a0              STRB     r0,[r4,#2]
004be6  e00d              B        |L1.19460|
                  |L1.19432|
;;;7123   else if (bps[in]._flags_tm&BIN8(100000))	bps[in]._state=bsRDY;
004be8  f8940042          LDRB     r0,[r4,#0x42]
004bec  0680              LSLS     r0,r0,#26
004bee  d503              BPL      |L1.19448|
004bf0  f04f0002          MOV      r0,#2
004bf4  70a0              STRB     r0,[r4,#2]
004bf6  e005              B        |L1.19460|
                  |L1.19448|
;;;7124   else if (bps[in]._cnt<20)				bps[in]._state=bsWRK;
004bf8  78e0              LDRB     r0,[r4,#3]
004bfa  2814              CMP      r0,#0x14
004bfc  d202              BCS      |L1.19460|
004bfe  f04f0001          MOV      r0,#1
004c02  70a0              STRB     r0,[r4,#2]
                  |L1.19460|
;;;7125   
;;;7126   
;;;7127   
;;;7128   //else if(bps[in]._flags_tm&BIN8(100000)) bps[in]._state=ssBL;
;;;7129   //else if((!(bps[in]._flags_tm&BIN8(100000)))&&(net_U>100))bps[in]._state=ssWRK;
;;;7130   //else bps[0]._state=ssNOT;
;;;7131   
;;;7132   //bps[in]._is_ready=0;
;;;7133   //bps[in]._is_wrk=0;
;;;7134   //if(bps[in]._av_net) bps[in]._flags_bp='N';// не подключен
;;;7135   //else if(bps[in]._av_u_max) bps[in]._flags_bp='P';// завышено напряжение(u_.av_.bAS1T)) bps_state[0]=ssAV;
;;;7136   //else if(bps[in]._av_u_min) bps[in]._flags_bp='M';// занижено напряжение
;;;7137   //else if(bps[in]._av_temper) bps[in]._flags_bp='T';// температура
;;;7138   //else if(bps[in]._flags_tm&BIN8(100000)) 
;;;7139   //	{
;;;7140   //	bps[in]._flags_bp='B';// заблокирован
;;;7141   //	bps[in]._is_ready=1;
;;;7142   //	}
;;;7143   //else if((!(bps[in]._flags_tm&BIN8(100000)))&&(net_U>100))
;;;7144   //     {
;;;7145   //     bps[in]._flags_bp='W';// работает
;;;7146   //     bps[in]._is_ready=1;
;;;7147   //     bps[in]._is_wrk=1;
;;;7148        
;;;7149   //     }
;;;7150   //else bps[in]._is_ready=1;     
;;;7151   
;;;7152   
;;;7153   
;;;7154   
;;;7155   
;;;7156   /*
;;;7157   bps[in]._flags_tu&=BIN8(11111110);
;;;7158   if(bps[in]._ist_blok_cnt)
;;;7159   	{
;;;7160   	bps[in]._ist_blok_cnt--;
;;;7161   	bps[in]._flags_tu|=BIN8(1);
;;;7162   	}
;;;7163   
;;;7164   	   */ 
;;;7165   
;;;7166   //Пересброс БПСа при потере связи
;;;7167   if(bps[in]._cnt>=10) bps[in]._flags_tu|=BIN8(10000000);
004c04  78e0              LDRB     r0,[r4,#3]
004c06  280a              CMP      r0,#0xa
004c08  d306              BCC      |L1.19480|
004c0a  f894002c          LDRB     r0,[r4,#0x2c]
004c0e  f0400080          ORR      r0,r0,#0x80
004c12  f884002c          STRB     r0,[r4,#0x2c]
004c16  e005              B        |L1.19492|
                  |L1.19480|
;;;7168   else bps[in]._flags_tu&=BIN8(1111111);
004c18  f894002c          LDRB     r0,[r4,#0x2c]
004c1c  f000007f          AND      r0,r0,#0x7f
004c20  f884002c          STRB     r0,[r4,#0x2c]
                  |L1.19492|
;;;7169   
;;;7170   if(avar_bps_reset_cnt) 
004c24  4816              LDR      r0,|L1.19584|
004c26  f8901031          LDRB     r1,[r0,#0x31]  ; avar_bps_reset_cnt
004c2a  b139              CBZ      r1,|L1.19516|
;;;7171   	{
;;;7172   	bps[in]._flags_tu|=BIN8(10);
004c2c  f894102c          LDRB     r1,[r4,#0x2c]
004c30  f0410102          ORR      r1,r1,#2
004c34  f884102c          STRB     r1,[r4,#0x2c]
;;;7173   	bps[in]._av=0;
004c38  7067              STRB     r7,[r4,#1]
004c3a  e029              B        |L1.19600|
                  |L1.19516|
;;;7174   	}
;;;7175   else if(bps[in]._apv_reset_av_timer) bps[in]._flags_tu|=BIN8(10);
004c3c  f8941062          LDRB     r1,[r4,#0x62]
004c40  b301              CBZ      r1,|L1.19588|
004c42  f894102c          LDRB     r1,[r4,#0x2c]
004c46  f0410102          ORR      r1,r1,#2
004c4a  f884102c          STRB     r1,[r4,#0x2c]
004c4e  e01f              B        |L1.19600|
                  |L1.19536|
                          DCD      ica_u_necc
                  |L1.19540|
                          DCD      ICA_MODBUS_ADDRESS
                  |L1.19544|
                          DCD      ICA_CH
                  |L1.19548|
                          DCD      TBAT
                  |L1.19552|
                          DCD      ipsBlckStat
                  |L1.19556|
                          DCD      ipsBlckSrc
                  |L1.19560|
                          DCD      ipsBlckLog
                  |L1.19564|
                          DCD      ||.bss||+0x40c
                  |L1.19568|
                          DCD      bps
                  |L1.19572|
                          DCD      UB20
                  |L1.19576|
                          DCD      ||DU||
                  |L1.19580|
                          DCD      net_av
                  |L1.19584|
                          DCD      ||area_number.26||
                  |L1.19588|
;;;7176   else bps[in]._flags_tu&=BIN8(11111101);
004c84  f894102c          LDRB     r1,[r4,#0x2c]
004c88  f00101fd          AND      r1,r1,#0xfd
004c8c  f884102c          STRB     r1,[r4,#0x2c]
                  |L1.19600|
;;;7177   	
;;;7178   bps[in]._vol_u=cntrl_stat+bps[in]._x_;	
004c90  f9b41054          LDRSH    r1,[r4,#0x54]
004c94  f9b00032          LDRSH    r0,[r0,#0x32]  ; cntrl_stat
004c98  4408              ADD      r0,r0,r1
004c9a  6320              STR      r0,[r4,#0x30]
;;;7179   bps[in]._vol_i=1000;
004c9c  f44f707a          MOV      r0,#0x3e8
004ca0  6360              STR      r0,[r4,#0x34]
                  |L1.19618|
;;;7180   //bps[0]._vol_u=500;
;;;7181   //bps[1]._vol_u=cntrl_stat_pwm; 
;;;7182   }
004ca2  e8bd81f0          POP      {r4-r8,pc}
;;;7183   
                          ENDP

                  avt_hndl PROC
;;;7184   //-----------------------------------------------
;;;7185   void avt_hndl(void)
004ca6  b570              PUSH     {r4-r6,lr}
;;;7186   {
;;;7187   char i;
;;;7188   for(i=0;i<12;i++)
004ca8  f04f0000          MOV      r0,#0
;;;7189   	{
;;;7190   	if(eb2_data_short[6]&(1<<i))
004cac  49ff              LDR      r1,|L1.20652|
004cae  f04f0401          MOV      r4,#1
004cb2  4603              MOV      r3,r0                 ;7188
004cb4  f9b1200c          LDRSH    r2,[r1,#0xc]
;;;7191   		{
;;;7192   		avt_stat[i]=avtON;
004cb8  4dfd              LDR      r5,|L1.20656|
                  |L1.19642|
004cba  fa04f100          LSL      r1,r4,r0              ;7190
004cbe  420a              TST      r2,r1                 ;7190
004cc0  d001              BEQ      |L1.19654|
004cc2  542c              STRB     r4,[r5,r0]
004cc4  e000              B        |L1.19656|
                  |L1.19654|
;;;7193   		}
;;;7194   	else avt_stat[i]=avtOFF;
004cc6  542b              STRB     r3,[r5,r0]
                  |L1.19656|
004cc8  f1000001          ADD      r0,r0,#1              ;7188
004ccc  b2c0              UXTB     r0,r0                 ;7188
004cce  280c              CMP      r0,#0xc               ;7188
004cd0  d3f3              BCC      |L1.19642|
;;;7195   	}
;;;7196   
;;;7197   if((avt_stat_old[0]!=avt_stat[0])&&(NUMAVT>=1))
004cd2  4ef8              LDR      r6,|L1.20660|
004cd4  7828              LDRB     r0,[r5,#0]  ; avt_stat
004cd6  4cf8              LDR      r4,|L1.20664|
004cd8  7831              LDRB     r1,[r6,#0]  ; avt_stat_old
004cda  4281              CMP      r1,r0
004cdc  d00b              BEQ      |L1.19702|
004cde  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
004ce2  2901              CMP      r1,#1
004ce4  db07              BLT      |L1.19702|
;;;7198   	{
;;;7199   	if(avt_stat[0]==avtON) 	snmp_trap_send("Avtomat #1 is ON ",11,1,1);
004ce6  2801              CMP      r0,#1
004ce8  d07e              BEQ      |L1.19944|
;;;7200   	else 				snmp_trap_send("Avtomat #1 is OFF",11,1,0);
004cea  2300              MOVS     r3,#0
004cec  2201              MOVS     r2,#1
004cee  210b              MOVS     r1,#0xb
004cf0  a0f2              ADR      r0,|L1.20668|
004cf2  f7fffffe          BL       snmp_trap_send
                  |L1.19702|
;;;7201   	}
;;;7202   if((avt_stat_old[1]!=avt_stat[1])&&(NUMAVT>=2))
004cf6  7871              LDRB     r1,[r6,#1]  ; avt_stat_old
004cf8  7868              LDRB     r0,[r5,#1]  ; avt_stat
004cfa  4281              CMP      r1,r0
004cfc  d00b              BEQ      |L1.19734|
004cfe  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
004d02  2902              CMP      r1,#2
004d04  db07              BLT      |L1.19734|
;;;7203   	{
;;;7204   	if(avt_stat[1]==avtON) 	snmp_trap_send("Avtomat #2 is ON ",11,2,1);
004d06  2801              CMP      r0,#1
004d08  d06f              BEQ      |L1.19946|
;;;7205   	else 				snmp_trap_send("Avtomat #2 is OFF",11,2,0);
004d0a  2300              MOVS     r3,#0
004d0c  2202              MOVS     r2,#2
004d0e  210b              MOVS     r1,#0xb
004d10  a0ef              ADR      r0,|L1.20688|
004d12  f7fffffe          BL       snmp_trap_send
                  |L1.19734|
;;;7206   	}
;;;7207   if((avt_stat_old[2]!=avt_stat[2])&&(NUMAVT>=3))
004d16  78b1              LDRB     r1,[r6,#2]  ; avt_stat_old
004d18  78a8              LDRB     r0,[r5,#2]  ; avt_stat
004d1a  4281              CMP      r1,r0
004d1c  d00b              BEQ      |L1.19766|
004d1e  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
004d22  2903              CMP      r1,#3
004d24  db07              BLT      |L1.19766|
;;;7208   	{
;;;7209   	if(avt_stat[2]==avtON) 	snmp_trap_send("Avtomat #3 is ON ",11,3,1);
004d26  2801              CMP      r0,#1
004d28  d072              BEQ      |L1.19984|
;;;7210   	else 				snmp_trap_send("Avtomat #3 is OFF",11,3,0);
004d2a  2300              MOVS     r3,#0
004d2c  2203              MOVS     r2,#3
004d2e  210b              MOVS     r1,#0xb
004d30  a0ec              ADR      r0,|L1.20708|
004d32  f7fffffe          BL       snmp_trap_send
                  |L1.19766|
;;;7211   	}
;;;7212   if((avt_stat_old[3]!=avt_stat[3])&&(NUMAVT>=4))
004d36  78f1              LDRB     r1,[r6,#3]  ; avt_stat_old
004d38  78e8              LDRB     r0,[r5,#3]  ; avt_stat
004d3a  4281              CMP      r1,r0
004d3c  d00b              BEQ      |L1.19798|
004d3e  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
004d42  2904              CMP      r1,#4
004d44  db07              BLT      |L1.19798|
;;;7213   	{
;;;7214   	if(avt_stat[3]==avtON) 	snmp_trap_send("Avtomat #4 is ON ",11,4,1);
004d46  2801              CMP      r0,#1
004d48  d079              BEQ      |L1.20030|
;;;7215   	else 				snmp_trap_send("Avtomat #4 is OFF",11,4,0);
004d4a  2300              MOVS     r3,#0
004d4c  2204              MOVS     r2,#4
004d4e  210b              MOVS     r1,#0xb
004d50  a0e9              ADR      r0,|L1.20728|
004d52  f7fffffe          BL       snmp_trap_send
                  |L1.19798|
;;;7216   	}
;;;7217   if((avt_stat_old[4]!=avt_stat[4])&&(NUMAVT>=5))
004d56  7931              LDRB     r1,[r6,#4]  ; avt_stat_old
004d58  7928              LDRB     r0,[r5,#4]  ; avt_stat
004d5a  4281              CMP      r1,r0
004d5c  d00b              BEQ      |L1.19830|
004d5e  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
004d62  2905              CMP      r1,#5
004d64  db07              BLT      |L1.19830|
;;;7218   	{
;;;7219   	if(avt_stat[4]==avtON) 	snmp_trap_send("Avtomat #5 is ON ",11,5,1);
004d66  2801              CMP      r0,#1
004d68  d071              BEQ      |L1.20046|
;;;7220   	else 				snmp_trap_send("Avtomat #5 is OFF",11,5,0);
004d6a  2300              MOVS     r3,#0
004d6c  2205              MOVS     r2,#5
004d6e  210b              MOVS     r1,#0xb
004d70  a0e6              ADR      r0,|L1.20748|
004d72  f7fffffe          BL       snmp_trap_send
                  |L1.19830|
;;;7221   	}
;;;7222   if((avt_stat_old[5]!=avt_stat[5])&&(NUMAVT>=6))
004d76  7971              LDRB     r1,[r6,#5]  ; avt_stat_old
004d78  7968              LDRB     r0,[r5,#5]  ; avt_stat
004d7a  4281              CMP      r1,r0
004d7c  d00b              BEQ      |L1.19862|
004d7e  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
004d82  2906              CMP      r1,#6
004d84  db07              BLT      |L1.19862|
;;;7223   	{
;;;7224   	if(avt_stat[5]==avtON) 	snmp_trap_send("Avtomat #6 is ON ",11,6,1);
004d86  2801              CMP      r0,#1
004d88  d068              BEQ      |L1.20060|
;;;7225   	else 				snmp_trap_send("Avtomat #6 is OFF",11,6,0);
004d8a  2300              MOVS     r3,#0
004d8c  2206              MOVS     r2,#6
004d8e  210b              MOVS     r1,#0xb
004d90  a0e3              ADR      r0,|L1.20768|
004d92  f7fffffe          BL       snmp_trap_send
                  |L1.19862|
;;;7226   	}
;;;7227   if((avt_stat_old[6]!=avt_stat[6])&&(NUMAVT>=7))
004d96  79b1              LDRB     r1,[r6,#6]  ; avt_stat_old
004d98  79a8              LDRB     r0,[r5,#6]  ; avt_stat
004d9a  4281              CMP      r1,r0
004d9c  d00b              BEQ      |L1.19894|
004d9e  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
004da2  2907              CMP      r1,#7
004da4  db07              BLT      |L1.19894|
;;;7228   	{
;;;7229   	if(avt_stat[6]==avtON) 	snmp_trap_send("Avtomat #7 is ON ",11,7,1);
004da6  2801              CMP      r0,#1
004da8  d05f              BEQ      |L1.20074|
;;;7230   	else 				snmp_trap_send("Avtomat #7 is OFF",11,7,0);
004daa  2300              MOVS     r3,#0
004dac  2207              MOVS     r2,#7
004dae  210b              MOVS     r1,#0xb
004db0  a0e0              ADR      r0,|L1.20788|
004db2  f7fffffe          BL       snmp_trap_send
                  |L1.19894|
;;;7231   	}
;;;7232   if((avt_stat_old[7]!=avt_stat[7])&&(NUMAVT>=8))
004db6  79f1              LDRB     r1,[r6,#7]  ; avt_stat_old
004db8  79e8              LDRB     r0,[r5,#7]  ; avt_stat
004dba  4281              CMP      r1,r0
004dbc  d00b              BEQ      |L1.19926|
004dbe  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
004dc2  2908              CMP      r1,#8
004dc4  db07              BLT      |L1.19926|
;;;7233   	{
;;;7234   	if(avt_stat[7]==avtON) 	snmp_trap_send("Avtomat #8 is ON ",11,8,1);
004dc6  2801              CMP      r0,#1
004dc8  d056              BEQ      |L1.20088|
;;;7235   	else 				snmp_trap_send("Avtomat #8 is OFF",11,8,0);
004dca  2300              MOVS     r3,#0
004dcc  2208              MOVS     r2,#8
004dce  210b              MOVS     r1,#0xb
004dd0  a0dd              ADR      r0,|L1.20808|
004dd2  f7fffffe          BL       snmp_trap_send
                  |L1.19926|
;;;7236   	}
;;;7237   if((avt_stat_old[8]!=avt_stat[8])&&(NUMAVT>=9))
004dd6  7a31              LDRB     r1,[r6,#8]  ; avt_stat_old
004dd8  7a28              LDRB     r0,[r5,#8]  ; avt_stat
004dda  4281              CMP      r1,r0
004ddc  d00e              BEQ      |L1.19964|
004dde  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
004de2  2909              CMP      r1,#9
004de4  db0a              BLT      |L1.19964|
;;;7238   	{
;;;7239   	if(avt_stat[8]==avtON) 	snmp_trap_send("Avtomat #9 is ON ",11,9,1);
004de6  e001              B        |L1.19948|
                  |L1.19944|
004de8  e013              B        |L1.19986|
                  |L1.19946|
004dea  e019              B        |L1.20000|
                  |L1.19948|
004dec  2801              CMP      r0,#1
004dee  d04a              BEQ      |L1.20102|
;;;7240   	else 				snmp_trap_send("Avtomat #9 is OFF",11,9,0);
004df0  2300              MOVS     r3,#0
004df2  2209              MOVS     r2,#9
004df4  210b              MOVS     r1,#0xb
004df6  a0d9              ADR      r0,|L1.20828|
004df8  f7fffffe          BL       snmp_trap_send
                  |L1.19964|
;;;7241   	}
;;;7242   
;;;7243   for(i=0;i<12;i++)
004dfc  f04f0000          MOV      r0,#0
                  |L1.19968|
;;;7244   	{
;;;7245   	avt_stat_old[i]=avt_stat[i];
004e00  5c29              LDRB     r1,[r5,r0]
004e02  5431              STRB     r1,[r6,r0]
004e04  f1000001          ADD      r0,r0,#1              ;7243
004e08  b2c0              UXTB     r0,r0                 ;7243
004e0a  280c              CMP      r0,#0xc               ;7243
004e0c  d3f8              BCC      |L1.19968|
                  |L1.19982|
;;;7246   	}
;;;7247   }
004e0e  bd70              POP      {r4-r6,pc}
                  |L1.19984|
004e10  e00e              B        |L1.20016|
                  |L1.19986|
004e12  2301              MOVS     r3,#1                 ;7199
004e14  461a              MOV      r2,r3                 ;7199
004e16  210b              MOVS     r1,#0xb               ;7199
004e18  a0d5              ADR      r0,|L1.20848|
004e1a  f7fffffe          BL       snmp_trap_send
004e1e  e76a              B        |L1.19702|
                  |L1.20000|
004e20  2301              MOVS     r3,#1                 ;7204
004e22  2202              MOVS     r2,#2                 ;7204
004e24  210b              MOVS     r1,#0xb               ;7204
004e26  a0d7              ADR      r0,|L1.20868|
004e28  f7fffffe          BL       snmp_trap_send
004e2c  e773              B        |L1.19734|
004e2e  e006              B        |L1.20030|
                  |L1.20016|
004e30  2301              MOVS     r3,#1                 ;7209
004e32  2203              MOVS     r2,#3                 ;7209
004e34  210b              MOVS     r1,#0xb               ;7209
004e36  a0d8              ADR      r0,|L1.20888|
004e38  f7fffffe          BL       snmp_trap_send
004e3c  e77b              B        |L1.19766|
                  |L1.20030|
004e3e  2301              MOVS     r3,#1                 ;7214
004e40  2204              MOVS     r2,#4                 ;7214
004e42  210b              MOVS     r1,#0xb               ;7214
004e44  a0d9              ADR      r0,|L1.20908|
004e46  f7fffffe          BL       snmp_trap_send
004e4a  e784              B        |L1.19798|
004e4c  e7ff              B        |L1.20046|
                  |L1.20046|
004e4e  2301              MOVS     r3,#1                 ;7219
004e50  2205              MOVS     r2,#5                 ;7219
004e52  210b              MOVS     r1,#0xb               ;7219
004e54  a0da              ADR      r0,|L1.20928|
004e56  f7fffffe          BL       snmp_trap_send
004e5a  e78c              B        |L1.19830|
                  |L1.20060|
004e5c  2301              MOVS     r3,#1                 ;7224
004e5e  2206              MOVS     r2,#6                 ;7224
004e60  210b              MOVS     r1,#0xb               ;7224
004e62  a0dc              ADR      r0,|L1.20948|
004e64  f7fffffe          BL       snmp_trap_send
004e68  e795              B        |L1.19862|
                  |L1.20074|
004e6a  2301              MOVS     r3,#1                 ;7229
004e6c  2207              MOVS     r2,#7                 ;7229
004e6e  210b              MOVS     r1,#0xb               ;7229
004e70  a0dd              ADR      r0,|L1.20968|
004e72  f7fffffe          BL       snmp_trap_send
004e76  e79e              B        |L1.19894|
                  |L1.20088|
004e78  2301              MOVS     r3,#1                 ;7234
004e7a  2208              MOVS     r2,#8                 ;7234
004e7c  210b              MOVS     r1,#0xb               ;7234
004e7e  a0df              ADR      r0,|L1.20988|
004e80  f7fffffe          BL       snmp_trap_send
004e84  e7a7              B        |L1.19926|
                  |L1.20102|
004e86  2301              MOVS     r3,#1                 ;7239
004e88  2209              MOVS     r2,#9                 ;7239
004e8a  210b              MOVS     r1,#0xb               ;7239
004e8c  a0e0              ADR      r0,|L1.21008|
004e8e  f7fffffe          BL       snmp_trap_send
004e92  e7b3              B        |L1.19964|
;;;7248   
                          ENDP

                  bat_hndl PROC
;;;7249   //-----------------------------------------------
;;;7250   void bat_hndl(void)
004e94  b570              PUSH     {r4-r6,lr}
;;;7251   {
;;;7252   /*if(mess_find(_MESS_BAT_MASK_ON))
;;;7253   	{
;;;7254   	if(mess_data[0]==_MESS_BAT_MASK_ON)
;;;7255   		{
;;;7256   		char i;
;;;7257   		for(i=0;i<2;i++)
;;;7258   			{
;;;7259   			if(mess_data[1]&(1<<i))
;;;7260   				{
;;;7261   				bat[i]._cnt_to_block=0;
;;;7262        			bat[i]._rel_stat=0;
;;;7263        			}
;;;7264   			}
;;;7265   		}
;;;7266   	}
;;;7267   if(mess_find(_MESS_BAT_MASK_OFF))
;;;7268   	{		
;;;7269   	if(mess_data[0]==_MESS_BAT_MASK_OFF)
;;;7270   		{
;;;7271   		char i;
;;;7272   		for(i=0;i<2;i++)
;;;7273   			{
;;;7274   			if((mess_data[1]&(1<<i)) && (bat[i]._cnt_to_block==0) && (bat[i]._rel_stat==0))
;;;7275   				{
;;;7276   				bat[i]._cnt_to_block=20;
;;;7277   				bat[i]._rel_stat=1;
;;;7278        			}
;;;7279   			}
;;;7280   		
;;;7281   		}		
;;;7282   	}*/
;;;7283   
;;;7284   if(mess_find_unvol(MESS2BAT_HNDL))
004e96  20c8              MOVS     r0,#0xc8
004e98  f7fffffe          BL       mess_find_unvol
;;;7285   	{ 
;;;7286   	char i;
;;;7287   	
;;;7288   	if(mess_data[0]==PARAM_BAT_ALL_OFF_AFTER_2SEC)
;;;7289   		{
;;;7290   		for(i=0;i<MAX_NUM_OF_BAT;i++)
;;;7291   			{
;;;7292   			if(bat[i]._cnt_to_block<50)bat[i]._cnt_to_block++;
004e9c  49e1              LDR      r1,|L1.21028|
004e9e  2200              MOVS     r2,#0                 ;7290
004ea0  b3a8              CBZ      r0,|L1.20238|
004ea2  4be1              LDR      r3,|L1.21032|
;;;7293   			}
;;;7294   		}
;;;7295   
;;;7296   	else if(mess_data[0]==PARAM_BAT_MASK_OFF_AFTER_2SEC)
;;;7297   		{
;;;7298   		for(i=0;i<MAX_NUM_OF_BAT;i++)
;;;7299   			{
;;;7300   			if(mess_data[1]&(1<<i))
004ea4  2401              MOVS     r4,#1
004ea6  6818              LDR      r0,[r3,#0]            ;7288  ; mess_data
004ea8  28c9              CMP      r0,#0xc9              ;7288
004eaa  d01c              BEQ      |L1.20198|
004eac  28ca              CMP      r0,#0xca              ;7296
004eae  d02f              BEQ      |L1.20240|
;;;7301   				{
;;;7302   				if(bat[i]._cnt_to_block<50) bat[i]._cnt_to_block++;
;;;7303   				}
;;;7304   			else bat[i]._cnt_to_block=0;
;;;7305   			}
;;;7306   		}
;;;7307   	else 
;;;7308   	 	{
;;;7309   		for(i=0;i<MAX_NUM_OF_BAT;i++)
004eb0  4610              MOV      r0,r2
                  |L1.20146|
;;;7310   			{
;;;7311   			bat[i]._cnt_to_block=0;
004eb2  eb000340          ADD      r3,r0,r0,LSL #1
004eb6  eb031300          ADD      r3,r3,r0,LSL #4
004eba  f8012023          STRB     r2,[r1,r3,LSL #2]
004ebe  f1000001          ADD      r0,r0,#1              ;7309
004ec2  b2c0              UXTB     r0,r0                 ;7309
004ec4  2802              CMP      r0,#2                 ;7309
004ec6  d3f4              BCC      |L1.20146|
                  |L1.20168|
;;;7312   			}
;;;7313   
;;;7314   		}
;;;7315   	for(i=0;i<MAX_NUM_OF_BAT;i++)
004ec8  f04f0000          MOV      r0,#0
                  |L1.20172|
;;;7316   		{
;;;7317   		if(bat[i]._cnt_to_block>20)bat[i]._rel_stat=1;
004ecc  eb000340          ADD      r3,r0,r0,LSL #1
004ed0  eb031300          ADD      r3,r3,r0,LSL #4
004ed4  f8115023          LDRB     r5,[r1,r3,LSL #2]
004ed8  2d14              CMP      r5,#0x14
004eda  d939              BLS      |L1.20304|
004edc  eb010383          ADD      r3,r1,r3,LSL #2
004ee0  f883403c          STRB     r4,[r3,#0x3c]
004ee4  e038              B        |L1.20312|
                  |L1.20198|
004ee6  f04f0000          MOV      r0,#0                 ;7290
                  |L1.20202|
004eea  eb000340          ADD      r3,r0,r0,LSL #1       ;7292
004eee  eb031500          ADD      r5,r3,r0,LSL #4       ;7292
004ef2  f8113025          LDRB     r3,[r1,r5,LSL #2]     ;7292
004ef6  2b32              CMP      r3,#0x32              ;7292
004ef8  d203              BCS      |L1.20226|
004efa  f1030301          ADD      r3,r3,#1              ;7292
004efe  f8013025          STRB     r3,[r1,r5,LSL #2]     ;7292
                  |L1.20226|
004f02  f1000001          ADD      r0,r0,#1              ;7290
004f06  b2c0              UXTB     r0,r0                 ;7290
004f08  2802              CMP      r0,#2                 ;7290
004f0a  d3ee              BCC      |L1.20202|
004f0c  e7dc              B        |L1.20168|
                  |L1.20238|
004f0e  e029              B        |L1.20324|
                  |L1.20240|
004f10  f04f0000          MOV      r0,#0                 ;7298
004f14  685e              LDR      r6,[r3,#4]            ;7300
                  |L1.20246|
004f16  fa04f300          LSL      r3,r4,r0              ;7300
004f1a  421e              TST      r6,r3                 ;7300
004f1c  d00c              BEQ      |L1.20280|
004f1e  eb000340          ADD      r3,r0,r0,LSL #1       ;7302
004f22  eb031500          ADD      r5,r3,r0,LSL #4       ;7302
004f26  f8113025          LDRB     r3,[r1,r5,LSL #2]     ;7302
004f2a  2b32              CMP      r3,#0x32              ;7302
004f2c  d20a              BCS      |L1.20292|
004f2e  f1030301          ADD      r3,r3,#1              ;7302
004f32  f8013025          STRB     r3,[r1,r5,LSL #2]     ;7302
004f36  e005              B        |L1.20292|
                  |L1.20280|
004f38  eb000340          ADD      r3,r0,r0,LSL #1       ;7304
004f3c  eb031300          ADD      r3,r3,r0,LSL #4       ;7304
004f40  f8012023          STRB     r2,[r1,r3,LSL #2]     ;7304
                  |L1.20292|
004f44  f1000001          ADD      r0,r0,#1              ;7298
004f48  b2c0              UXTB     r0,r0                 ;7298
004f4a  2802              CMP      r0,#2                 ;7298
004f4c  d3e3              BCC      |L1.20246|
004f4e  e7bb              B        |L1.20168|
                  |L1.20304|
;;;7318   		else bat[i]._rel_stat=0;
004f50  eb010383          ADD      r3,r1,r3,LSL #2
004f54  f883203c          STRB     r2,[r3,#0x3c]
                  |L1.20312|
004f58  f1000001          ADD      r0,r0,#1              ;7315
004f5c  b2c0              UXTB     r0,r0                 ;7315
004f5e  2802              CMP      r0,#2                 ;7315
004f60  d3b4              BCC      |L1.20172|
;;;7319   		}
;;;7320   
;;;7321   	}
;;;7322   
;;;7323   else 
;;;7324   	{
;;;7325   	char i;
;;;7326   	for(i=0;i<MAX_NUM_OF_BAT;i++)
;;;7327   		{
;;;7328   		bat[i]._cnt_to_block=0;
;;;7329   		bat[i]._rel_stat=0;
;;;7330   		}
;;;7331   
;;;7332   	}
;;;7333   
;;;7334   /*if(mess_find_unvol(MESS2BAT_HNDL1))
;;;7335   	{
;;;7336   	if(PARAM_BAT_ON)
;;;7337   		{
;;;7338   		char i;
;;;7339   		for(i=0;i<MAX_NUM_OF_BAT;i++)
;;;7340   			{
;;;7341   			if(mess_data[1]&(1<<i))
;;;7342   				{
;;;7343   				bat[i]._cnt_to_block=0;
;;;7344   				bat[i]._rel_stat=0;
;;;7345   				}
;;;7346   			}
;;;7347   		}
;;;7348   	} */
;;;7349   }
004f62  e754              B        |L1.19982|
                  |L1.20324|
004f64  f04f0000          MOV      r0,#0                 ;7326
                  |L1.20328|
004f68  eb000340          ADD      r3,r0,r0,LSL #1       ;7328
004f6c  eb031300          ADD      r3,r3,r0,LSL #4       ;7328
004f70  f8012023          STRB     r2,[r1,r3,LSL #2]     ;7328
004f74  eb010383          ADD      r3,r1,r3,LSL #2       ;7329
004f78  f883203c          STRB     r2,[r3,#0x3c]         ;7329
004f7c  f1000001          ADD      r0,r0,#1              ;7326
004f80  b2c0              UXTB     r0,r0                 ;7326
004f82  2802              CMP      r0,#2                 ;7326
004f84  d3f0              BCC      |L1.20328|
004f86  e742              B        |L1.19982|
;;;7350   
                          ENDP

                  bat_drv PROC
;;;7988   //-----------------------------------------------
;;;7989   void bat_drv(char in)
004f88  e92d5ffc          PUSH     {r2-r12,lr}
;;;7990   {
004f8c  4605              MOV      r5,r0
;;;7991   unsigned short /*tempUS,*/tempUS_;
;;;7992   unsigned long tempUL,tempUL_;
;;;7993   unsigned short b_zar;
;;;7994   //static unsigned short time_cnt[2];
;;;7995   
;;;7996   
;;;7997   
;;;7998   if(cntrl_stat_blok_cnt_plus[in])cntrl_stat_blok_cnt_plus[in]--;
004f8e  49a7              LDR      r1,|L1.21036|
004f90  f9310015          LDRSH    r0,[r1,r5,LSL #1]
004f94  b118              CBZ      r0,|L1.20382|
004f96  f1a00001          SUB      r0,r0,#1
004f9a  f8210015          STRH     r0,[r1,r5,LSL #1]
                  |L1.20382|
;;;7999   if(cntrl_stat_blok_cnt_minus[in])cntrl_stat_blok_cnt_minus[in]--;
004f9e  4aa3              LDR      r2,|L1.21036|
004fa0  1d12              ADDS     r2,r2,#4
004fa2  f9320015          LDRSH    r0,[r2,r5,LSL #1]
004fa6  b118              CBZ      r0,|L1.20400|
004fa8  f1a00001          SUB      r0,r0,#1
004fac  f8220015          STRH     r0,[r2,r5,LSL #1]
                  |L1.20400|
;;;8000   
;;;8001   
;;;8002   if(bat[in]._Ib>IZMAX) cntrl_stat_blok_cnt_plus[in]=100;
004fb0  eb050045          ADD      r0,r5,r5,LSL #1
004fb4  eb001305          ADD      r3,r0,r5,LSL #4
004fb8  489a              LDR      r0,|L1.21028|
004fba  eb000483          ADD      r4,r0,r3,LSL #2
004fbe  4b9c              LDR      r3,|L1.21040|
004fc0  f9b40008          LDRSH    r0,[r4,#8]
004fc4  f9b36000          LDRSH    r6,[r3,#0]  ; IZMAX
004fc8  2364              MOVS     r3,#0x64
004fca  42b0              CMP      r0,r6
004fcc  dd01              BLE      |L1.20434|
004fce  f8213015          STRH     r3,[r1,r5,LSL #1]
                  |L1.20434|
;;;8003   if(bat[in]._Ib<0)     cntrl_stat_blok_cnt_minus[in]=100;
004fd2  2800              CMP      r0,#0
004fd4  da01              BGE      |L1.20442|
004fd6  f8223015          STRH     r3,[r2,r5,LSL #1]
                  |L1.20442|
;;;8004   
;;;8005   if(cntrl_stat_blok_cnt_plus[in] && cntrl_stat_blok_cnt_minus[in])
;;;8006        {
;;;8007        if(!cntrl_stat_blok_cnt_)
004fda  4894              LDR      r0,|L1.21036|
004fdc  f8313015          LDRH     r3,[r1,r5,LSL #1]     ;8005
004fe0  38b4              SUBS     r0,r0,#0xb4
004fe2  2700              MOVS     r7,#0
004fe4  b14b              CBZ      r3,|L1.20474|
004fe6  f8323015          LDRH     r3,[r2,r5,LSL #1]     ;8005
004fea  b133              CBZ      r3,|L1.20474|
004fec  f8b03072          LDRH     r3,[r0,#0x72]  ; cntrl_stat_blok_cnt_
004ff0  b1a3              CBZ      r3,|L1.20508|
;;;8008             {
;;;8009             cntrl_stat_blok_cnt_=600; 
;;;8010             cntrl_stat_blok_cnt_plus[in]=0;
;;;8011             cntrl_stat_blok_cnt_minus[in]=0;
;;;8012             }
;;;8013        else cntrl_stat_blok_cnt=3000;
004ff2  f64031b8          MOV      r1,#0xbb8
004ff6  f8a01070          STRH     r1,[r0,#0x70]
                  |L1.20474|
;;;8014        }
;;;8015   cntrl_stat_blok_cnt=0;
004ffa  f8a07070          STRH     r7,[r0,#0x70]
;;;8016   
;;;8017   if(++(bat[in]._time_cnt)>=10)
004ffe  f894003e          LDRB     r0,[r4,#0x3e]
005002  1c40              ADDS     r0,r0,#1
005004  b2c0              UXTB     r0,r0
005006  f884003e          STRB     r0,[r4,#0x3e]
00500a  280a              CMP      r0,#0xa
00500c  d301              BCC      |L1.20498|
;;;8018   	{
;;;8019   	bat[in]._time_cnt=0;
00500e  f884703e          STRB     r7,[r4,#0x3e]
                  |L1.20498|
;;;8020   	//bat[in]._zar_cnt++;
;;;8021   	}
;;;8022   
;;;8023   if(main_10Hz_cnt==50)
005012  4e88              LDR      r6,|L1.21044|
005014  8830              LDRH     r0,[r6,#0]  ; main_10Hz_cnt
005016  2832              CMP      r0,#0x32
005018  d009              BEQ      |L1.20526|
00501a  e017              B        |L1.20556|
                  |L1.20508|
00501c  f44f7316          MOV      r3,#0x258             ;8009
005020  f8a03072          STRH     r3,[r0,#0x72]         ;8009
005024  f8217015          STRH     r7,[r1,r5,LSL #1]     ;8010
005028  f8227015          STRH     r7,[r2,r5,LSL #1]     ;8011
00502c  e7e5              B        |L1.20474|
                  |L1.20526|
;;;8024   	{
;;;8025   	if(!bat[in]._rel_stat)
00502e  f894003c          LDRB     r0,[r4,#0x3c]
005032  b958              CBNZ     r0,|L1.20556|
;;;8026   		{
;;;8027   		
;;;8028   		if(bat[in]._Ub<80) 
005034  f9b40002          LDRSH    r0,[r4,#2]
005038  2850              CMP      r0,#0x50
00503a  da07              BGE      |L1.20556|
;;;8029   			{
;;;8030   			
;;;8031   			if(!(bat[in]._av&1))
00503c  f894003d          LDRB     r0,[r4,#0x3d]
005040  07c0              LSLS     r0,r0,#31
005042  d103              BNE      |L1.20556|
;;;8032   				{
;;;8033   				avar_bat_hndl(in,1);
005044  2101              MOVS     r1,#1
005046  4628              MOV      r0,r5
005048  f7fffffe          BL       avar_bat_hndl
                  |L1.20556|
;;;8034   				//if(in==0)plazma_bat++;
;;;8035   				}
;;;8036   			}				
;;;8037   
;;;8038   		}
;;;8039   	}
;;;8040   
;;;8041   if(main_10Hz_cnt>200)
00504c  f9b60000          LDRSH    r0,[r6,#0]  ; main_10Hz_cnt
;;;8042   	{
;;;8043   	if(abs(bat[in]._Ib)>IKB) 
005050  4e79              LDR      r6,|L1.21048|
005052  28c8              CMP      r0,#0xc8              ;8041
005054  dd0f              BLE      |L1.20598|
005056  f9b40008          LDRSH    r0,[r4,#8]
00505a  f7fffffe          BL       abs
00505e  f9b61000          LDRSH    r1,[r6,#0]  ; IKB
005062  4288              CMP      r0,r1
005064  dd07              BLE      |L1.20598|
;;;8044   		{
;;;8045   		if((bat[in]._av&1))avar_bat_hndl(in,0);
005066  f894003d          LDRB     r0,[r4,#0x3d]
00506a  07c0              LSLS     r0,r0,#31
00506c  d003              BEQ      |L1.20598|
00506e  2100              MOVS     r1,#0
005070  4628              MOV      r0,r5
005072  f7fffffe          BL       avar_bat_hndl
                  |L1.20598|
;;;8046   		}
;;;8047   	}
;;;8048   
;;;8049   #ifdef APSENERGIA
;;;8050   //if(bat[in]._Ib>(-IKB))
;;;8051   
;;;8052   
;;;8053   #endif
;;;8054   
;;;8055   if(bat[in]._Ib>(-IKB))
005076  f9b61000          LDRSH    r1,[r6,#0]  ; IKB
00507a  f9b40008          LDRSH    r0,[r4,#8]
00507e  4249              RSBS     r1,r1,#0
005080  4288              CMP      r0,r1
005082  dd10              BLE      |L1.20646|
;;;8056   	{
;;;8057   	if(bat[in]._cnt_wrk<10)
005084  7b60              LDRB     r0,[r4,#0xd]
005086  280a              CMP      r0,#0xa
005088  d20e              BCS      |L1.20648|
;;;8058   		{
;;;8059   		bat[in]._cnt_wrk++;
00508a  f1000001          ADD      r0,r0,#1
00508e  b2c0              UXTB     r0,r0
005090  7360              STRB     r0,[r4,#0xd]
;;;8060   		if((bat[in]._cnt_wrk>=10)&&(bat[in]._wrk)) 
005092  280a              CMP      r0,#0xa
005094  d306              BCC      |L1.20644|
005096  7ba0              LDRB     r0,[r4,#0xe]
005098  2800              CMP      r0,#0
00509a  d003              BEQ      |L1.20644|
;;;8061   			{
;;;8062   			bat[in]._wrk=0;
00509c  73a7              STRB     r7,[r4,#0xe]
;;;8063   			//beep_init(0x7L,'O');
;;;8064   			//wrk_mem_hndl(0);
;;;8065   			wrk_mem_hndl(in);
00509e  4628              MOV      r0,r5
0050a0  f7fffffe          BL       wrk_mem_hndl
                  |L1.20644|
0050a4  e134              B        |L1.21264|
                  |L1.20646|
0050a6  e0cd              B        |L1.21060|
                  |L1.20648|
0050a8  e0c8              B        |L1.21052|
0050aa  0000              DCW      0x0000
                  |L1.20652|
                          DCD      eb2_data_short
                  |L1.20656|
                          DCD      avt_stat
                  |L1.20660|
                          DCD      avt_stat_old
                  |L1.20664|
                          DCD      NUMAVT
                  |L1.20668|
0050bc  4176746f          DCB      "Avtomat #1 is OFF",0
0050c0  6d617420
0050c4  23312069
0050c8  73204f46
0050cc  4600    
0050ce  00                DCB      0
0050cf  00                DCB      0
                  |L1.20688|
0050d0  4176746f          DCB      "Avtomat #2 is OFF",0
0050d4  6d617420
0050d8  23322069
0050dc  73204f46
0050e0  4600    
0050e2  00                DCB      0
0050e3  00                DCB      0
                  |L1.20708|
0050e4  4176746f          DCB      "Avtomat #3 is OFF",0
0050e8  6d617420
0050ec  23332069
0050f0  73204f46
0050f4  4600    
0050f6  00                DCB      0
0050f7  00                DCB      0
                  |L1.20728|
0050f8  4176746f          DCB      "Avtomat #4 is OFF",0
0050fc  6d617420
005100  23342069
005104  73204f46
005108  4600    
00510a  00                DCB      0
00510b  00                DCB      0
                  |L1.20748|
00510c  4176746f          DCB      "Avtomat #5 is OFF",0
005110  6d617420
005114  23352069
005118  73204f46
00511c  4600    
00511e  00                DCB      0
00511f  00                DCB      0
                  |L1.20768|
005120  4176746f          DCB      "Avtomat #6 is OFF",0
005124  6d617420
005128  23362069
00512c  73204f46
005130  4600    
005132  00                DCB      0
005133  00                DCB      0
                  |L1.20788|
005134  4176746f          DCB      "Avtomat #7 is OFF",0
005138  6d617420
00513c  23372069
005140  73204f46
005144  4600    
005146  00                DCB      0
005147  00                DCB      0
                  |L1.20808|
005148  4176746f          DCB      "Avtomat #8 is OFF",0
00514c  6d617420
005150  23382069
005154  73204f46
005158  4600    
00515a  00                DCB      0
00515b  00                DCB      0
                  |L1.20828|
00515c  4176746f          DCB      "Avtomat #9 is OFF",0
005160  6d617420
005164  23392069
005168  73204f46
00516c  4600    
00516e  00                DCB      0
00516f  00                DCB      0
                  |L1.20848|
005170  4176746f          DCB      "Avtomat #1 is ON ",0
005174  6d617420
005178  23312069
00517c  73204f4e
005180  2000    
005182  00                DCB      0
005183  00                DCB      0
                  |L1.20868|
005184  4176746f          DCB      "Avtomat #2 is ON ",0
005188  6d617420
00518c  23322069
005190  73204f4e
005194  2000    
005196  00                DCB      0
005197  00                DCB      0
                  |L1.20888|
005198  4176746f          DCB      "Avtomat #3 is ON ",0
00519c  6d617420
0051a0  23332069
0051a4  73204f4e
0051a8  2000    
0051aa  00                DCB      0
0051ab  00                DCB      0
                  |L1.20908|
0051ac  4176746f          DCB      "Avtomat #4 is ON ",0
0051b0  6d617420
0051b4  23342069
0051b8  73204f4e
0051bc  2000    
0051be  00                DCB      0
0051bf  00                DCB      0
                  |L1.20928|
0051c0  4176746f          DCB      "Avtomat #5 is ON ",0
0051c4  6d617420
0051c8  23352069
0051cc  73204f4e
0051d0  2000    
0051d2  00                DCB      0
0051d3  00                DCB      0
                  |L1.20948|
0051d4  4176746f          DCB      "Avtomat #6 is ON ",0
0051d8  6d617420
0051dc  23362069
0051e0  73204f4e
0051e4  2000    
0051e6  00                DCB      0
0051e7  00                DCB      0
                  |L1.20968|
0051e8  4176746f          DCB      "Avtomat #7 is ON ",0
0051ec  6d617420
0051f0  23372069
0051f4  73204f4e
0051f8  2000    
0051fa  00                DCB      0
0051fb  00                DCB      0
                  |L1.20988|
0051fc  4176746f          DCB      "Avtomat #8 is ON ",0
005200  6d617420
005204  23382069
005208  73204f4e
00520c  2000    
00520e  00                DCB      0
00520f  00                DCB      0
                  |L1.21008|
005210  4176746f          DCB      "Avtomat #9 is ON ",0
005214  6d617420
005218  23392069
00521c  73204f4e
005220  2000    
005222  00                DCB      0
005223  00                DCB      0
                  |L1.21028|
                          DCD      bat
                  |L1.21032|
                          DCD      mess_data
                  |L1.21036|
                          DCD      ||area_number.26||+0xb4
                  |L1.21040|
                          DCD      IZMAX
                  |L1.21044|
                          DCD      main_10Hz_cnt
                  |L1.21048|
                          DCD      IKB
                  |L1.21052|
;;;8066   			//plazma++;
;;;8067   			}
;;;8068   		}
;;;8069   	else bat[in]._cnt_wrk=10;	
00523c  f04f000a          MOV      r0,#0xa
005240  7360              STRB     r0,[r4,#0xd]
005242  e065              B        |L1.21264|
                  |L1.21060|
;;;8070   	}	
;;;8071   
;;;8072   else if(bat[in]._Ib<(-IKB))
005244  da64              BGE      |L1.21264|
;;;8073   	{
;;;8074   	if(bat[in]._cnt_wrk)
005246  7b60              LDRB     r0,[r4,#0xd]
005248  b3f0              CBZ      r0,|L1.21192|
;;;8075   		{
;;;8076   		bat[in]._cnt_wrk--;
00524a  f1a00001          SUB      r0,r0,#1
00524e  b2c0              UXTB     r0,r0
005250  7360              STRB     r0,[r4,#0xd]
;;;8077   		if((bat[in]._cnt_wrk==0)&&(bat[in]._wrk==0)) 
005252  bbc8              CBNZ     r0,|L1.21192|
005254  7ba0              LDRB     r0,[r4,#0xe]
005256  bbb8              CBNZ     r0,|L1.21192|
;;;8078   			{
;;;8079   			bat[in]._wrk=1;
005258  f04f0001          MOV      r0,#1
00525c  73a0              STRB     r0,[r4,#0xe]
;;;8080   
;;;8081   				{
;;;8082   				char temp;
;;;8083   				signed short temp_temp;
;;;8084   				temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)];
00525e  48ff              LDR      r0,|L1.22108|
005260  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
005262  f1000001          ADD      r0,r0,#1
005266  f0000007          AND      r0,r0,#7
00526a  eb040040          ADD      r0,r4,r0,LSL #1
00526e  8c00              LDRH     r0,[r0,#0x20]
005270  9000              STR      r0,[sp,#0]
;;;8085   			 
;;;8086   				temp=LPC_RTC->YEAR;
005272  4efb              LDR      r6,|L1.22112|
005274  8bb0              LDRH     r0,[r6,#0x1c]
005276  9001              STR      r0,[sp,#4]
;;;8087   				gran_char((signed char*)&temp,1,99);
005278  f04f0263          MOV      r2,#0x63
00527c  f04f0101          MOV      r1,#1
005280  a801              ADD      r0,sp,#4
005282  f7fffffe          BL       gran_char
;;;8088   				*((char*)(&(bat[in]._wrk_date[0])))=temp;
005286  f104041c          ADD      r4,r4,#0x1c
00528a  f89d0004          LDRB     r0,[sp,#4]
00528e  7620              STRB     r0,[r4,#0x18]
;;;8089   			
;;;8090   				temp=LPC_RTC->MONTH;
005290  7e30              LDRB     r0,[r6,#0x18]
005292  9001              STR      r0,[sp,#4]
;;;8091   				gran_char((signed char*)&temp,1,12);
005294  f04f020c          MOV      r2,#0xc
005298  f04f0101          MOV      r1,#1
00529c  a801              ADD      r0,sp,#4
00529e  f7fffffe          BL       gran_char
;;;8092   				*(((char*)(&(bat[in]._wrk_date[0])))+1)=temp;
0052a2  f89d0004          LDRB     r0,[sp,#4]
0052a6  7660              STRB     r0,[r4,#0x19]
;;;8093   			
;;;8094   				temp=LPC_RTC->DOM;
0052a8  7b30              LDRB     r0,[r6,#0xc]
0052aa  9001              STR      r0,[sp,#4]
;;;8095   				gran_char((signed char*)&temp,1,31);
0052ac  221f              MOVS     r2,#0x1f
0052ae  2101              MOVS     r1,#1
0052b0  a801              ADD      r0,sp,#4
0052b2  f7fffffe          BL       gran_char
;;;8096   				*(((char*)(&(bat[in]._wrk_date[0])))+2)=temp;			
0052b6  f89d0004          LDRB     r0,[sp,#4]
0052ba  76a0              STRB     r0,[r4,#0x1a]
;;;8097   				
;;;8098   				*(((char*)(&(bat[in]._wrk_date[0])))+3)=*((char*)&temp_temp);
0052bc  f89d0000          LDRB     r0,[sp,#0]
0052c0  76e0              STRB     r0,[r4,#0x1b]
;;;8099   
;;;8100   				temp=LPC_RTC->HOUR;
0052c2  7a30              LDRB     r0,[r6,#8]
0052c4  9001              STR      r0,[sp,#4]
;;;8101   				gran_char((signed char*)&temp,0,23);
0052c6  e000              B        |L1.21194|
                  |L1.21192|
0052c8  e022              B        |L1.21264|
                  |L1.21194|
0052ca  2217              MOVS     r2,#0x17
0052cc  2100              MOVS     r1,#0
0052ce  a801              ADD      r0,sp,#4
0052d0  f7fffffe          BL       gran_char
;;;8102   				*((char*)(&(bat[in]._wrk_date[1])))=temp;
0052d4  f89d0004          LDRB     r0,[sp,#4]
0052d8  7720              STRB     r0,[r4,#0x1c]
;;;8103                  	
;;;8104   				temp=LPC_RTC->MIN;
0052da  7930              LDRB     r0,[r6,#4]
0052dc  9001              STR      r0,[sp,#4]
;;;8105   				gran_char((signed char*)&temp,0,59);
0052de  223b              MOVS     r2,#0x3b
0052e0  2100              MOVS     r1,#0
0052e2  a801              ADD      r0,sp,#4
0052e4  f7fffffe          BL       gran_char
;;;8106   				*(((char*)(&(bat[in]._wrk_date[1])))+1)=temp;
0052e8  f89d0004          LDRB     r0,[sp,#4]
0052ec  7760              STRB     r0,[r4,#0x1d]
;;;8107   	          
;;;8108   				temp=LPC_RTC->SEC;
0052ee  7830              LDRB     r0,[r6,#0]
0052f0  9001              STR      r0,[sp,#4]
;;;8109   				gran_char((signed char*)&temp,0,59);
0052f2  223b              MOVS     r2,#0x3b
0052f4  2100              MOVS     r1,#0
0052f6  a801              ADD      r0,sp,#4
0052f8  f7fffffe          BL       gran_char
;;;8110   				*(((char*)(&(bat[in]._wrk_date[1])))+2)=temp;
0052fc  f89d0004          LDRB     r0,[sp,#4]
005300  77a0              STRB     r0,[r4,#0x1e]
;;;8111   			
;;;8112   				*(((char*)(&(bat[in]._wrk_date[1])))+3)=*(((char*)&temp_temp)+1);
005302  f89d0001          LDRB     r0,[sp,#1]
005306  77e0              STRB     r0,[r4,#0x1f]
;;;8113   				bat[in]._Iintegr=0;		//Счетчик десятков милиамперсекунд
005308  8027              STRH     r7,[r4,#0]
;;;8114   				bat[in]._Iintegr_=0;	//Счетчик сотен милиамперчасов
00530a  8067              STRH     r7,[r4,#2]
00530c  f1a4041c          SUB      r4,r4,#0x1c
                  |L1.21264|
;;;8115   				}
;;;8116   	
;;;8117   			}
;;;8118   
;;;8119   		}
;;;8120   	else bat[in]._cnt_wrk=0;	 
;;;8121   	
;;;8122   	}					
;;;8123   
;;;8124   /*
;;;8125   if(Ibat>=(-IKB))
;;;8126   	{
;;;8127   	if(cnt_wrk<10)
;;;8128   		{
;;;8129   		cnt_wrk++;
;;;8130   		if((cnt_wrk>=10)&&(wrk!=wrkOFF)) 
;;;8131   			{
;;;8132   			wrk=wrkOFF;
;;;8133   			//beep_init(0x7L,'O');
;;;8134   			wrk_mem_hndl(ibat_integr);
;;;8135   			}
;;;8136   		}
;;;8137   	else cnt_wrk=10;	
;;;8138   	}	
;;;8139   
;;;8140   else if((Ibat<(-IKB))&&(spc_stat!=spc_KE))
;;;8141   	{
;;;8142   	if(cnt_wrk)
;;;8143   		{
;;;8144   		cnt_wrk--;
;;;8145   		if((cnt_wrk==0)&&(wrk!=wrkON)) 
;;;8146   			{
;;;8147   			char temp;
;;;8148   			signed short temp_temp;
;;;8149   			temp_temp=ubat_old[((ubat_old_cnt+1)&0x07)];
;;;8150   			 
;;;8151   			wrk=wrkON;
;;;8152   			
;;;8153   			temp=_year;
;;;8154   			gran_char(&temp,1,99);
;;;8155   			*((char*)(&(wrk_date[0])))=temp;
;;;8156   			
;;;8157   			temp=_month;
;;;8158   			gran_char(&temp,1,12);
;;;8159   			*(((char*)(&(wrk_date[0])))+1)=temp;
;;;8160   			
;;;8161   			temp=_date;
;;;8162   			gran_char(&temp,1,31);
;;;8163   			*(((char*)(&(wrk_date[0])))+2)=temp;			
;;;8164   				
;;;8165   			*(((char*)(&(wrk_date[0])))+3)=*((char*)&temp_temp);
;;;8166   
;;;8167   			temp=_hour;
;;;8168   			gran_char(&temp,0,23);
;;;8169   			*((char*)(&(wrk_date[1])))=temp;
;;;8170                  
;;;8171   			temp=_min;
;;;8172   			gran_char(&temp,0,59);
;;;8173   			*(((char*)(&(wrk_date[1])))+1)=temp;
;;;8174   	          
;;;8175   			temp=_sec;
;;;8176   			gran_char(&temp,0,59);
;;;8177   			*(((char*)(&(wrk_date[1])))+2)=temp;
;;;8178   			
;;;8179   			*(((char*)(&(wrk_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;8180   
;;;8181   			
;;;8182   			//beep_init(0xFL,'O'); 
;;;8183   			ibat_integr=0;
;;;8184   			ibat_integr_=0;
;;;8185   			}
;;;8186   		}
;;;8187   	else cnt_wrk=0;	 
;;;8188   	
;;;8189   	}
;;;8190   if(wrk==wrkON)
;;;8191   	{
;;;8192   	ibat_integr_+=-Ibat;
;;;8193   	if(ibat_integr_>=SEC_IN_HOUR*10L)
;;;8194   		{
;;;8195   		ibat_integr_-=SEC_IN_HOUR*10L;
;;;8196   		ibat_integr++;
;;;8197   		}
;;;8198   	}
;;;8199   
;;;8200   */
;;;8201   
;;;8202   
;;;8203   /*if(bat[in]._cnt_to_block)
;;;8204   	{
;;;8205   	bat[in]._cnt_to_block--;
;;;8206   	if(!(bat[in]._cnt_to_block))
;;;8207   		{
;;;8208   		//bat[in]._rel_stat=1;
;;;8209   		}
;;;8210   	}
;;;8211   */
;;;8212   
;;;8213   
;;;8214   
;;;8215   
;;;8216   //unsigned int tempUI,tempUI_;
;;;8217   //unsigned int b_zar; 
;;;8218   //char i;
;;;8219   //Ibat[0]=5000;                     
;;;8220   
;;;8221   
;;;8222                               
;;;8223   if(bat[in]._time_cnt==0)
;;;8224   	{
;;;8225   	bat[in]._zar_cnt+=(signed long)bat[in]._Ib;
;;;8226   	
;;;8227   	if(bat[in]._zar_cnt>=AH_CONSTANT)
005310  f64848a0          MOV      r8,#0x8ca0
005314  f894003e          LDRB     r0,[r4,#0x3e]         ;8223
005318  bba8              CBNZ     r0,|L1.21382|
00531a  f9b41008          LDRSH    r1,[r4,#8]            ;8225
00531e  6960              LDR      r0,[r4,#0x14]         ;8225
005320  4408              ADD      r0,r0,r1              ;8225
005322  6160              STR      r0,[r4,#0x14]         ;8225
;;;8228   		{
;;;8229   		if(BAT_C_REAL[in]==0x5555) tempUS_=BAT_C_NOM[in];
;;;8230   		else tempUS_=BAT_C_REAL[in];
;;;8231   		
;;;8232   		b_zar=lc640_read_int(ADR_EE_BAT_ZAR_CNT[in]);
005324  f8df933c          LDR      r9,|L1.22116|
005328  f8dfa33c          LDR      r10,|L1.22120|
00532c  f2455b55          MOV      r11,#0x5555           ;8229
005330  4540              CMP      r0,r8                 ;8227
005332  db29              BLT      |L1.21384|
005334  f93a0015          LDRSH    r0,[r10,r5,LSL #1]    ;8229
005338  4558              CMP      r0,r11                ;8229
00533a  d103              BNE      |L1.21316|
00533c  48cb              LDR      r0,|L1.22124|
00533e  f8306015          LDRH     r6,[r0,r5,LSL #1]     ;8229
005342  e001              B        |L1.21320|
                  |L1.21316|
005344  f83a6015          LDRH     r6,[r10,r5,LSL #1]    ;8230
                  |L1.21320|
005348  f8390015          LDRH     r0,[r9,r5,LSL #1]
00534c  f7fffffe          BL       lc640_read_int
005350  b280              UXTH     r0,r0
;;;8233   
;;;8234   		if(b_zar<(tempUS_/**10*/))
005352  42b0              CMP      r0,r6
005354  d20e              BCS      |L1.21364|
;;;8235   			{
;;;8236   			bat[in]._zar_cnt-=AH_CONSTANT;
005356  6961              LDR      r1,[r4,#0x14]
005358  f5a14100          SUB      r1,r1,#0x8000
00535c  f5a1614a          SUB      r1,r1,#0xca0
005360  6161              STR      r1,[r4,#0x14]
;;;8237   
;;;8238   			lc640_write_int(ADR_EE_BAT_ZAR_CNT[in],b_zar+1);
005362  f9392015          LDRSH    r2,[r9,r5,LSL #1]
005366  f1000001          ADD      r0,r0,#1
00536a  b201              SXTH     r1,r0
00536c  4610              MOV      r0,r2
00536e  f7fffffe          BL       lc640_write_int
005372  e032              B        |L1.21466|
                  |L1.21364|
;;;8239   			}
;;;8240   		else if(b_zar>(tempUS_/**10*/))  
005374  d931              BLS      |L1.21466|
;;;8241   			{
;;;8242   			lc640_write_int(ADR_EE_BAT_ZAR_CNT[in],tempUS_);
005376  f9390015          LDRSH    r0,[r9,r5,LSL #1]
00537a  b231              SXTH     r1,r6
00537c  f7fffffe          BL       lc640_write_int
;;;8243   			bat[in]._zar_cnt=AH_CONSTANT;
005380  f8c48014          STR      r8,[r4,#0x14]
005384  e029              B        |L1.21466|
                  |L1.21382|
005386  e055              B        |L1.21556|
                  |L1.21384|
;;;8244   
;;;8245   			}
;;;8246   
;;;8247   		}
;;;8248   
;;;8249   	else if(bat[in]._zar_cnt<=-AH_CONSTANT)
005388  49b9              LDR      r1,|L1.22128|
00538a  4288              CMP      r0,r1
00538c  dc25              BGT      |L1.21466|
;;;8250   		{
;;;8251   		if(BAT_C_REAL[in]==0x5555) tempUS_=BAT_C_NOM[in];
00538e  f93a0015          LDRSH    r0,[r10,r5,LSL #1]
005392  4558              CMP      r0,r11
005394  d103              BNE      |L1.21406|
005396  48b5              LDR      r0,|L1.22124|
005398  f8306015          LDRH     r6,[r0,r5,LSL #1]
00539c  e001              B        |L1.21410|
                  |L1.21406|
;;;8252   		else tempUS_=BAT_C_REAL[in];
00539e  f83a6015          LDRH     r6,[r10,r5,LSL #1]
                  |L1.21410|
;;;8253   		
;;;8254   		b_zar=lc640_read_int(ADR_EE_BAT_ZAR_CNT[in]);
0053a2  f8390015          LDRH     r0,[r9,r5,LSL #1]
0053a6  f7fffffe          BL       lc640_read_int
0053aa  b280              UXTH     r0,r0
;;;8255   
;;;8256   		if(b_zar>tempUS_)
0053ac  42b0              CMP      r0,r6
0053ae  d905              BLS      |L1.21436|
;;;8257   			{
;;;8258   			lc640_write_int(ADR_EE_BAT_ZAR_CNT[in],tempUS_);
0053b0  f9390015          LDRSH    r0,[r9,r5,LSL #1]
0053b4  b231              SXTH     r1,r6
0053b6  f7fffffe          BL       lc640_write_int
;;;8259   			b_zar=tempUS_;
0053ba  4630              MOV      r0,r6
                  |L1.21436|
;;;8260   			}
;;;8261   		if(b_zar)
0053bc  b158              CBZ      r0,|L1.21462|
;;;8262   			{
;;;8263   			bat[in]._zar_cnt+=AH_CONSTANT;
0053be  6961              LDR      r1,[r4,#0x14]
0053c0  4441              ADD      r1,r1,r8
0053c2  6161              STR      r1,[r4,#0x14]
;;;8264   
;;;8265   			lc640_write_int(ADR_EE_BAT_ZAR_CNT[in],b_zar-1);
0053c4  f9392015          LDRSH    r2,[r9,r5,LSL #1]
0053c8  f1a00001          SUB      r0,r0,#1
0053cc  b201              SXTH     r1,r0
0053ce  4610              MOV      r0,r2
0053d0  f7fffffe          BL       lc640_write_int
0053d4  e001              B        |L1.21466|
                  |L1.21462|
;;;8266   			}
;;;8267   		else 
;;;8268   			{
;;;8269   			bat[in]._zar_cnt=-AH_CONSTANT;
0053d6  48a6              LDR      r0,|L1.22128|
0053d8  6160              STR      r0,[r4,#0x14]
                  |L1.21466|
;;;8270   			}
;;;8271   
;;;8272   		}
;;;8273   
;;;8274   			
;;;8275   	tempUL=(unsigned long)lc640_read_int(ADR_EE_BAT_ZAR_CNT[in]);
0053da  f8390015          LDRH     r0,[r9,r5,LSL #1]
0053de  f7fffffe          BL       lc640_read_int
0053e2  4601              MOV      r1,r0
;;;8276   	
;;;8277   	if(BAT_C_REAL[in]==0x5555) tempUL_=(unsigned long)BAT_C_NOM[in];
0053e4  f93a0015          LDRSH    r0,[r10,r5,LSL #1]
0053e8  4558              CMP      r0,r11
0053ea  d102              BNE      |L1.21490|
0053ec  489f              LDR      r0,|L1.22124|
0053ee  f9300015          LDRSH    r0,[r0,r5,LSL #1]
                  |L1.21490|
;;;8278   	else tempUL_=(unsigned long)BAT_C_REAL[in];
;;;8279   		           	
;;;8280   	tempUL*=1000L;
0053f2  f44f727a          MOV      r2,#0x3e8
0053f6  fb01f102          MUL      r1,r1,r2
;;;8281   
;;;8282   
;;;8283   	if(tempUL_==0) tempUL=0;
0053fa  b158              CBZ      r0,|L1.21524|
;;;8284   	else tempUL/=tempUL_;
0053fc  fbb1f0f0          UDIV     r0,r1,r0
                  |L1.21504|
;;;8285   
;;;8286   	tempUL/=10L;
005400  f04f010a          MOV      r1,#0xa
005404  fbb0f0f1          UDIV     r0,r0,r1
;;;8287   
;;;8288   	bat[in]._zar=(unsigned short)tempUL;
005408  8220              STRH     r0,[r4,#0x10]
;;;8289   
;;;8290   	if(BAT_TYPE==1)
00540a  489a              LDR      r0,|L1.22132|
00540c  8800              LDRH     r0,[r0,#0]  ; BAT_TYPE
00540e  2801              CMP      r0,#1
005410  d003              BEQ      |L1.21530|
005412  e009              B        |L1.21544|
                  |L1.21524|
005414  f04f0000          MOV      r0,#0                 ;8283
005418  e7f2              B        |L1.21504|
                  |L1.21530|
;;;8291   		{
;;;8292   		bat[in]._zar=lakb[in]._s_o_c;
00541a  4997              LDR      r1,|L1.22136|
00541c  eb050085          ADD      r0,r5,r5,LSL #2
005420  eb011000          ADD      r0,r1,r0,LSL #4
005424  8a40              LDRH     r0,[r0,#0x12]
005426  8220              STRH     r0,[r4,#0x10]
                  |L1.21544|
;;;8293   		}
;;;8294   	
;;;8295   	gran((signed short*)&bat[in]._zar,0,100);
005428  f1040010          ADD      r0,r4,#0x10
00542c  2264              MOVS     r2,#0x64
00542e  2100              MOVS     r1,#0
005430  f7fffffe          BL       gran
                  |L1.21556|
;;;8296        }
;;;8297   
;;;8298   
;;;8299   //Подсчет тока разряда батареи      
;;;8300   if(bat[in]._wrk==1)
005434  7ba0              LDRB     r0,[r4,#0xe]
005436  2801              CMP      r0,#1
005438  d113              BNE      |L1.21602|
;;;8301   	{
;;;8302   	if(bat[in]._Iintegr<36000)
00543a  8ba0              LDRH     r0,[r4,#0x1c]
00543c  4540              CMP      r0,r8
00543e  d20f              BCS      |L1.21600|
;;;8303   		{          
;;;8304   		bat[in]._Iintegr+=abs(bat[in]._Ib);
005440  f9b40008          LDRSH    r0,[r4,#8]
005444  f7fffffe          BL       abs
005448  8ba1              LDRH     r1,[r4,#0x1c]
00544a  4408              ADD      r0,r0,r1
00544c  b280              UXTH     r0,r0
00544e  83a0              STRH     r0,[r4,#0x1c]
;;;8305   		if(bat[in]._Iintegr>=36000)
005450  4540              CMP      r0,r8
005452  d306              BCC      |L1.21602|
;;;8306   			{
;;;8307   			bat[in]._Iintegr=0;		//Счетчик десятков милиамперсекунд
005454  83a7              STRH     r7,[r4,#0x1c]
;;;8308   			bat[in]._Iintegr_++;	//Счетчик сотен милиамперчасов
005456  8be0              LDRH     r0,[r4,#0x1e]
005458  f1000001          ADD      r0,r0,#1
00545c  83e0              STRH     r0,[r4,#0x1e]
00545e  e000              B        |L1.21602|
                  |L1.21600|
;;;8309   			}
;;;8310   		}
;;;8311   	else 
;;;8312   		{
;;;8313   		bat[in]._Iintegr=0;
005460  83a7              STRH     r7,[r4,#0x1c]
                  |L1.21602|
;;;8314   		}	
;;;8315   	} 
;;;8316   	    
;;;8317   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;8318   if((t_ext[0]>TBATSIGN)&&(!ND_EXT[0]))	
005462  4e86              LDR      r6,|L1.22140|
005464  4986              LDR      r1,|L1.22144|
005466  f8df921c          LDR      r9,|L1.22148|
00546a  f9b60000          LDRSH    r0,[r6,#0]  ; t_ext
00546e  f9b11000          LDRSH    r1,[r1,#0]  ; TBATSIGN
005472  4288              CMP      r0,r1
005474  dd02              BLE      |L1.21628|
005476  f8990000          LDRB     r0,[r9,#0]  ; ND_EXT
00547a  b380              CBZ      r0,|L1.21726|
                  |L1.21628|
;;;8319   	{
;;;8320   	bat[in]._sign_temper_cnt++;
;;;8321   	}
;;;8322   else 
;;;8323   	{
;;;8324   	bat[in]._sign_temper_cnt--;
00547c  f8b40040          LDRH     r0,[r4,#0x40]
005480  f1a00001          SUB      r0,r0,#1
005484  f8a40040          STRH     r0,[r4,#0x40]
                  |L1.21640|
;;;8325   	}
;;;8326   #else
;;;8327   if((bat[in]._Tb>TBATSIGN)&&(!bat[in]._nd))	
;;;8328   	{
;;;8329   	bat[in]._sign_temper_cnt++;
;;;8330   	}
;;;8331   else 
;;;8332   	{
;;;8333   	bat[in]._sign_temper_cnt--;
;;;8334   	}
;;;8335   #endif
;;;8336   gran(&bat[in]._sign_temper_cnt,0,600);
005488  f44f7b16          MOV      r11,#0x258
00548c  f1040040          ADD      r0,r4,#0x40
005490  465a              MOV      r2,r11
005492  2100              MOVS     r1,#0
005494  f7fffffe          BL       gran
;;;8337   if(bat[in]._sign_temper_cnt>=590)	bat[in]._temper_stat|=(1<<0);
005498  f9b40040          LDRSH    r0,[r4,#0x40]
00549c  f2402a4e          MOV      r10,#0x24e
0054a0  4550              CMP      r0,r10
0054a2  db05              BLT      |L1.21680|
0054a4  f894103f          LDRB     r1,[r4,#0x3f]
0054a8  f0410101          ORR      r1,r1,#1
0054ac  f884103f          STRB     r1,[r4,#0x3f]
                  |L1.21680|
;;;8338   if(bat[in]._sign_temper_cnt<=10)	bat[in]._temper_stat&=~(1<<0);
0054b0  280a              CMP      r0,#0xa
0054b2  dc05              BGT      |L1.21696|
0054b4  f894003f          LDRB     r0,[r4,#0x3f]
0054b8  f0200001          BIC      r0,r0,#1
0054bc  f884003f          STRB     r0,[r4,#0x3f]
                  |L1.21696|
;;;8339   
;;;8340   if((bat[in]._temper_stat&(1<<0))&&(!(bat[in]._temper_stat&(1<<4))))	avar_bat_temper_hndl(in,1);
0054c0  f894003f          LDRB     r0,[r4,#0x3f]
0054c4  07c1              LSLS     r1,r0,#31
0054c6  d005              BEQ      |L1.21716|
0054c8  06c0              LSLS     r0,r0,#27
0054ca  d403              BMI      |L1.21716|
0054cc  2101              MOVS     r1,#1
0054ce  4628              MOV      r0,r5
0054d0  f7fffffe          BL       avar_bat_temper_hndl
                  |L1.21716|
;;;8341   if((!(bat[in]._temper_stat&(1<<0)))&&(bat[in]._temper_stat&(1<<4)))	avar_bat_temper_hndl(in,0);
0054d4  f894003f          LDRB     r0,[r4,#0x3f]
0054d8  07c1              LSLS     r1,r0,#31
0054da  d008              BEQ      |L1.21742|
0054dc  e00d              B        |L1.21754|
                  |L1.21726|
0054de  e7ff              B        |L1.21728|
                  |L1.21728|
0054e0  f8b40040          LDRH     r0,[r4,#0x40]         ;8320
0054e4  f1000001          ADD      r0,r0,#1              ;8320
0054e8  f8a40040          STRH     r0,[r4,#0x40]         ;8320
0054ec  e7cc              B        |L1.21640|
                  |L1.21742|
0054ee  06c0              LSLS     r0,r0,#27
0054f0  d503              BPL      |L1.21754|
0054f2  2100              MOVS     r1,#0
0054f4  4628              MOV      r0,r5
0054f6  f7fffffe          BL       avar_bat_temper_hndl
                  |L1.21754|
;;;8342   
;;;8343   if(bat[in]._temper_stat&(1<<0))		bat[in]._temper_stat|=(1<<4);
0054fa  f894003f          LDRB     r0,[r4,#0x3f]
0054fe  07c1              LSLS     r1,r0,#31
005500  d004              BEQ      |L1.21772|
005502  f0400010          ORR      r0,r0,#0x10
005506  f884003f          STRB     r0,[r4,#0x3f]
00550a  e003              B        |L1.21780|
                  |L1.21772|
;;;8344   else 								bat[in]._temper_stat&=~(1<<4);
00550c  f0200010          BIC      r0,r0,#0x10
005510  f884003f          STRB     r0,[r4,#0x3f]
                  |L1.21780|
;;;8345   
;;;8346   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;8347   if((t_ext[0]>TBATMAX)&&(!ND_EXT[0]))	
005514  495c              LDR      r1,|L1.22152|
005516  f9b60000          LDRSH    r0,[r6,#0]  ; t_ext
00551a  f9b11000          LDRSH    r1,[r1,#0]  ; TBATMAX
00551e  4288              CMP      r0,r1
005520  dd02              BLE      |L1.21800|
005522  f8990000          LDRB     r0,[r9,#0]  ; ND_EXT
005526  b3d0              CBZ      r0,|L1.21918|
                  |L1.21800|
;;;8348   	{
;;;8349   	bat[in]._max_temper_cnt++;
;;;8350   	}
;;;8351   else 
;;;8352   	{
;;;8353   	bat[in]._max_temper_cnt--;
005528  f8b40042          LDRH     r0,[r4,#0x42]
00552c  f1a00001          SUB      r0,r0,#1
005530  f8a40042          STRH     r0,[r4,#0x42]
                  |L1.21812|
;;;8354   	}
;;;8355   #else
;;;8356   if((bat[in]._Tb>TBATMAX)&&(!bat[in]._nd))	
;;;8357   	{
;;;8358   	bat[in]._max_temper_cnt++;
;;;8359   	}
;;;8360   else 
;;;8361   	{
;;;8362   	bat[in]._max_temper_cnt--;
;;;8363   	}
;;;8364   #endif
;;;8365   
;;;8366   gran(&bat[in]._max_temper_cnt,0,600);
005534  f1040042          ADD      r0,r4,#0x42
005538  465a              MOV      r2,r11
00553a  2100              MOVS     r1,#0
00553c  f7fffffe          BL       gran
;;;8367   if(bat[in]._max_temper_cnt>=590)	bat[in]._temper_stat|=(1<<1);
005540  f9b40042          LDRSH    r0,[r4,#0x42]
005544  4550              CMP      r0,r10
005546  db05              BLT      |L1.21844|
005548  f894103f          LDRB     r1,[r4,#0x3f]
00554c  f0410102          ORR      r1,r1,#2
005550  f884103f          STRB     r1,[r4,#0x3f]
                  |L1.21844|
;;;8368   if(bat[in]._max_temper_cnt<=10)	bat[in]._temper_stat&=~(1<<1);
005554  280a              CMP      r0,#0xa
005556  dc05              BGT      |L1.21860|
005558  f894003f          LDRB     r0,[r4,#0x3f]
00555c  f0200002          BIC      r0,r0,#2
005560  f884003f          STRB     r0,[r4,#0x3f]
                  |L1.21860|
;;;8369   
;;;8370   if((bat[in]._temper_stat&(1<<1))&&(!(bat[in]._temper_stat&(1<<5))))	avar_bat_temper_hndl(in,3);
005564  f894003f          LDRB     r0,[r4,#0x3f]
005568  0781              LSLS     r1,r0,#30
00556a  d505              BPL      |L1.21880|
00556c  0680              LSLS     r0,r0,#26
00556e  d403              BMI      |L1.21880|
005570  2103              MOVS     r1,#3
005572  4628              MOV      r0,r5
005574  f7fffffe          BL       avar_bat_temper_hndl
                  |L1.21880|
;;;8371   if((!(bat[in]._temper_stat&(1<<1)))&&(bat[in]._temper_stat&(1<<5)))	avar_bat_temper_hndl(in,2);
005578  f894003f          LDRB     r0,[r4,#0x3f]
00557c  0781              LSLS     r1,r0,#30
00557e  d405              BMI      |L1.21900|
005580  0680              LSLS     r0,r0,#26
005582  d503              BPL      |L1.21900|
005584  2102              MOVS     r1,#2
005586  4628              MOV      r0,r5
005588  f7fffffe          BL       avar_bat_temper_hndl
                  |L1.21900|
;;;8372   
;;;8373   if(bat[in]._temper_stat&(1<<1))		bat[in]._temper_stat|=(1<<5);
00558c  f894003f          LDRB     r0,[r4,#0x3f]
005590  0781              LSLS     r1,r0,#30
005592  d50c              BPL      |L1.21934|
005594  f0400020          ORR      r0,r0,#0x20
005598  f884003f          STRB     r0,[r4,#0x3f]
00559c  e00b              B        |L1.21942|
                  |L1.21918|
00559e  e7ff              B        |L1.21920|
                  |L1.21920|
0055a0  f8b40042          LDRH     r0,[r4,#0x42]         ;8349
0055a4  f1000001          ADD      r0,r0,#1              ;8349
0055a8  f8a40042          STRH     r0,[r4,#0x42]         ;8349
0055ac  e7c2              B        |L1.21812|
                  |L1.21934|
;;;8374   else 								bat[in]._temper_stat&=~(1<<5);
0055ae  f0200020          BIC      r0,r0,#0x20
0055b2  f884003f          STRB     r0,[r4,#0x3f]
                  |L1.21942|
;;;8375   
;;;8376   //Подсчет наработки батареи
;;;8377   if(bat[in]._resurs_cnt<36000)
0055b6  6c60              LDR      r0,[r4,#0x44]
0055b8  4540              CMP      r0,r8
0055ba  da12              BGE      |L1.21986|
;;;8378   	{               
;;;8379   	bat[in]._resurs_cnt++;
0055bc  f1000001          ADD      r0,r0,#1
0055c0  6460              STR      r0,[r4,#0x44]
;;;8380   	if(bat[in]._resurs_cnt>=36000)
0055c2  4540              CMP      r0,r8
0055c4  db0e              BLT      |L1.21988|
;;;8381   		{
;;;8382   		bat[in]._resurs_cnt=0;
0055c6  6467              STR      r7,[r4,#0x44]
;;;8383   		lc640_write_int(ADR_EE_BAT_RESURS[in],lc640_read_int(ADR_EE_BAT_RESURS[in])+1);
0055c8  4c30              LDR      r4,|L1.22156|
0055ca  f8340015          LDRH     r0,[r4,r5,LSL #1]
0055ce  f7fffffe          BL       lc640_read_int
0055d2  1c40              ADDS     r0,r0,#1
0055d4  b201              SXTH     r1,r0
0055d6  f9340015          LDRSH    r0,[r4,r5,LSL #1]
0055da  e8bd5ffc          POP      {r2-r12,lr}
0055de  f7ffbffe          B.W      lc640_write_int
                  |L1.21986|
;;;8384   		}
;;;8385   	}
;;;8386   else bat[in]._resurs_cnt=0;
0055e2  6467              STR      r7,[r4,#0x44]
                  |L1.21988|
;;;8387   
;;;8388   
;;;8389   #ifndef UKU_220_V2
;;;8390   #ifndef UKU_GLONASS
;;;8391   #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;8392   //#ifndef UKU_6U
;;;8393   //#ifndef UKU_220
;;;8394   if(UBM_AV)
;;;8395        {
;;;8396        signed short temp_SS;
;;;8397   #ifdef UKU_220
;;;8398   temp_SS=bat[in]._Ub/2;
;;;8399   #else
;;;8400        if(U0B<600)
;;;8401             {
;;;8402   
;;;8403             temp_SS=bat[in]._Ub/4;
;;;8404             }
;;;8405        else temp_SS=bat[in]._Ub/5;
;;;8406   	
;;;8407   	temp_SS+=temp_SS;     
;;;8408   #endif
;;;8409        temp_SS-=(bat[in]._Ubm);
;;;8410   
;;;8411        temp_SS=abs(temp_SS);
;;;8412   
;;;8413        temp_SS*=10;
;;;8414   
;;;8415        temp_SS/=12;
;;;8416   
;;;8417        bat[in]._dUbm=temp_SS;
;;;8418   
;;;8419   
;;;8420        if(	(bat[in]._dUbm>UBM_AV) &&
;;;8421   		(abs(bat[in]._Ib)<(5*IKB)) &&
;;;8422   		(bat[in]._Ub>((short)(((long)USIGN*115)/100))) &&
;;;8423   		(!(bat[in]._av & 2))  )
;;;8424   		{
;;;8425   		bat[in]._cnt_as++;
;;;8426   		if(bat[in]._cnt_as==3000)
;;;8427   			{
;;;8428   			avar_bat_as_hndl(in,1);
;;;8429   			}
;;;8430   		if(bat[in]._cnt_as>=3005) bat[in]._cnt_as=3005;
;;;8431   		}
;;;8432   	else 
;;;8433   		{
;;;8434   		if(bat[in]._cnt_as)
;;;8435   			{
;;;8436   			bat[in]._cnt_as--;
;;;8437   			if(bat[in]._cnt_as==0)avar_bat_as_hndl(in,0);
;;;8438   			}
;;;8439   		}
;;;8440        
;;;8441        }
;;;8442   //#endif 
;;;8443   #endif 
;;;8444   #endif
;;;8445   #endif
;;;8446   
;;;8447   }
0055e4  e8bd9ffc          POP      {r2-r12,pc}
;;;8448   
                          ENDP

                  bat_hndl_zvu PROC
;;;8450   //-----------------------------------------------
;;;8451   void bat_hndl_zvu(void)
0055e8  e92d4ff0          PUSH     {r4-r11,lr}
;;;8452   {
0055ec  b089              SUB      sp,sp,#0x24
;;;8453   char i;
;;;8454   short bat_hndl_i_temp;
;;;8455   const long bat_hndl_t_razr_const[7]={600L,1800L,3600L,10800L,18000L,36000L,72000L};
0055ee  f04f021c          MOV      r2,#0x1c
0055f2  4927              LDR      r1,|L1.22160|
0055f4  4668              MOV      r0,sp
0055f6  f7fffffe          BL       __aeabi_memcpy4
;;;8456   
;;;8457   //Ib_ips_termokompensat=-17000;
;;;8458    
;;;8459   if(bat_hndl_zvu_init==0)
0055fa  4c26              LDR      r4,|L1.22164|
;;;8460   	{
;;;8461   	//Инициализация при включении системы
;;;8462   	bat_hndl_zvu_Q=(long)lc640_read_int(EE_BAT1_ZAR_CNT);
;;;8463   	if((bat_hndl_zvu_Q>100L)||(bat_hndl_zvu_Q<0L)) bat_hndl_zvu_Q=100L;
0055fc  2564              MOVS     r5,#0x64
;;;8464   	bat_hndl_zvu_Q*=10000L;
;;;8465   
;;;8466   	bat_hndl_zvu_init=1;
;;;8467   	}
;;;8468   else 
;;;8469   	{
;;;8470   	if(Ib_ips_termokompensat<-IKB)
;;;8471   		{
;;;8472   		bat_hndl_i_vector=0;
;;;8473   		bat_hndl_i_zar_price=0L;
;;;8474   			
;;;8475   		bat_hndl_i=-Ib_ips_termokompensat;
;;;8476   		I_from_t_table[0]=BAT_C_POINT_1_6*6; //Ток при котором батарея разрядится за 1/6 часа (0.1А)
;;;8477   		I_from_t_table[1]=BAT_C_POINT_1_2*2; //Ток при котором батарея разрядится за 1/2 часа (0.1А)
;;;8478   		I_from_t_table[2]=BAT_C_POINT_1; //Ток при котором батарея разрядится за 1 час (0.1А)
;;;8479   		I_from_t_table[3]=BAT_C_POINT_3/3; //Ток при котором батарея разрядится за 3 часа (0.1А)
;;;8480   		I_from_t_table[4]=BAT_C_POINT_5/5; //Ток при котором батарея разрядится за 5 часов (0.1А)
;;;8481   		I_from_t_table[5]=BAT_C_POINT_10/10; //Ток при котором батарея разрядится за 10 часов (0.1А)
;;;8482   		I_from_t_table[6]=BAT_C_POINT_20/20; //Ток при котором батарея разрядится за 20 часов (0.1А)
;;;8483   		
;;;8484   		I_from_t_table[0]=(short)((((long)I_from_t_table[0])*((long)BAT_K_OLD))/100L);
;;;8485   		I_from_t_table[1]=(short)((((long)I_from_t_table[1])*((long)BAT_K_OLD))/100L);
;;;8486   		I_from_t_table[2]=(short)((((long)I_from_t_table[2])*((long)BAT_K_OLD))/100L);
;;;8487   		I_from_t_table[3]=(short)((((long)I_from_t_table[3])*((long)BAT_K_OLD))/100L);
;;;8488   		I_from_t_table[4]=(short)((((long)I_from_t_table[4])*((long)BAT_K_OLD))/100L);
;;;8489   		I_from_t_table[5]=(short)((((long)I_from_t_table[5])*((long)BAT_K_OLD))/100L);
;;;8490   		I_from_t_table[6]=(short)((((long)I_from_t_table[6])*((long)BAT_K_OLD))/100L);
;;;8491   
;;;8492   		bat_hndl_i_temp=bat_hndl_i/10;
;;;8493   		for(i=0;i<7;i++)
;;;8494   			{
;;;8495   			if(bat_hndl_i_temp>=I_from_t_table[i])
;;;8496   				{
;;;8497   				break;
;;;8498   				}
;;;8499   			}
;;;8500   		 if(i==0) bat_hndl_t_razr=bat_hndl_t_razr_const[0];
;;;8501   		 else if((i>=1)&&(i<7))
;;;8502   		 	{
;;;8503   			short i1,i2;
;;;8504   			i1=I_from_t_table[i-1]-bat_hndl_i_temp;
;;;8505   			i2=I_from_t_table[i-1]-I_from_t_table[i];
;;;8506   			bat_hndl_t_razr=bat_hndl_t_razr_const[i]-bat_hndl_t_razr_const[i-1];
;;;8507   			bat_hndl_t_razr*=(long)i1;
;;;8508   			bat_hndl_t_razr/=(long)i2;
;;;8509   			bat_hndl_t_razr+=bat_hndl_t_razr_const[i-1];
;;;8510   			}
;;;8511   		else if(i>=7)
;;;8512   			{
;;;8513   			bat_hndl_t_razr=bat_hndl_t_razr_const[6];
;;;8514   			}
;;;8515   		bat_hndl_proc_razr=1000000L/bat_hndl_t_razr;
0055fe  f8df8098          LDR      r8,|L1.22168|
005602  7a60              LDRB     r0,[r4,#9]            ;8459  ; bat_hndl_zvu_init
005604  2700              MOVS     r7,#0                 ;8459
005606  f04f0901          MOV      r9,#1                 ;8466
00560a  f1040680          ADD      r6,r4,#0x80           ;8462
00560e  2800              CMP      r0,#0                 ;8459
005610  d07d              BEQ      |L1.22286|
005612  4923              LDR      r1,|L1.22176|
005614  4821              LDR      r0,|L1.22172|
005616  f9b12000          LDRSH    r2,[r1,#0]            ;8470  ; IKB
00561a  4631              MOV      r1,r6                 ;8462
00561c  f9b00000          LDRSH    r0,[r0,#0]            ;8470  ; Ib_ips_termokompensat
005620  4253              RSBS     r3,r2,#0              ;8470
005622  6d89              LDR      r1,[r1,#0x58]         ;8462
005624  4298              CMP      r0,r3                 ;8470
005626  da73              BGE      |L1.22288|
005628  72e7              STRB     r7,[r4,#0xb]          ;8472
00562a  60f7              STR      r7,[r6,#0xc]          ;8473  ; bat_hndl_i_zar_price
00562c  f1c00000          RSB      r0,r0,#0              ;8475
005630  b200              SXTH     r0,r0                 ;8475
005632  8030              STRH     r0,[r6,#0]            ;8475
005634  9008              STR      r0,[sp,#0x20]         ;8475
005636  481b              LDR      r0,|L1.22180|
005638  4a1b              LDR      r2,|L1.22184|
00563a  8800              LDRH     r0,[r0,#0]            ;8476  ; BAT_C_POINT_1_6
00563c  eb000040          ADD      r0,r0,r0,LSL #1       ;8476
005640  ea4f0040          LSL      r0,r0,#1              ;8476
005644  fa0ffb80          SXTH     r11,r0                ;8476
005648  4818              LDR      r0,|L1.22188|
00564a  8800              LDRH     r0,[r0,#0]            ;8477  ; BAT_C_POINT_1_2
00564c  ea4f0040          LSL      r0,r0,#1              ;8477
005650  b203              SXTH     r3,r0                 ;8477
005652  4817              LDR      r0,|L1.22192|
005654  f9b0c000          LDRSH    r12,[r0,#0]           ;8478  ; BAT_C_POINT_1
005658  4816              LDR      r0,|L1.22196|
00565a  e02d              B        |L1.22200|
                  |L1.22108|
                          DCD      bat_u_old_cnt
                  |L1.22112|
                          DCD      0x40024020
                  |L1.22116|
                          DCD      ADR_EE_BAT_ZAR_CNT
                  |L1.22120|
                          DCD      BAT_C_REAL
                  |L1.22124|
                          DCD      BAT_C_NOM
                  |L1.22128|
                          DCD      0xffff7360
                  |L1.22132|
                          DCD      BAT_TYPE
                  |L1.22136|
                          DCD      lakb
                  |L1.22140|
                          DCD      t_ext
                  |L1.22144|
                          DCD      TBATSIGN
                  |L1.22148|
                          DCD      ND_EXT
                  |L1.22152|
                          DCD      TBATMAX
                  |L1.22156|
                          DCD      ADR_EE_BAT_RESURS
                  |L1.22160|
                          DCD      ||area_number.20||+0x20
                  |L1.22164|
                          DCD      ||area_number.26||
                  |L1.22168|
                          DCD      0x000f4240
                  |L1.22172|
                          DCD      Ib_ips_termokompensat
                  |L1.22176|
                          DCD      IKB
                  |L1.22180|
                          DCD      BAT_C_POINT_1_6
                  |L1.22184|
                          DCD      ||.bss||+0x44c
                  |L1.22188|
                          DCD      BAT_C_POINT_1_2
                  |L1.22192|
                          DCD      BAT_C_POINT_1
                  |L1.22196|
                          DCD      BAT_C_POINT_3
                  |L1.22200|
0056b8  f9b00000          LDRSH    r0,[r0,#0]            ;8479  ; BAT_C_POINT_3
0056bc  f04f0903          MOV      r9,#3                 ;8479
0056c0  fb90f0f9          SDIV     r0,r0,r9              ;8479
0056c4  b200              SXTH     r0,r0                 ;8479
0056c6  9007              STR      r0,[sp,#0x1c]         ;8479
0056c8  48ff              LDR      r0,|L1.23240|
0056ca  f04f0905          MOV      r9,#5                 ;8480
0056ce  f9b00000          LDRSH    r0,[r0,#0]            ;8480  ; BAT_C_POINT_5
0056d2  fb90f0f9          SDIV     r0,r0,r9              ;8480
0056d6  fa0ff980          SXTH     r9,r0                 ;8480
0056da  48fc              LDR      r0,|L1.23244|
0056dc  f9b0a000          LDRSH    r10,[r0,#0]           ;8481  ; BAT_C_POINT_10
0056e0  f04f000a          MOV      r0,#0xa               ;8481
0056e4  fb9af0f0          SDIV     r0,r10,r0             ;8481
0056e8  fa0ffe80          SXTH     lr,r0                 ;8481
0056ec  48f8              LDR      r0,|L1.23248|
0056ee  f04f0a14          MOV      r10,#0x14             ;8482
0056f2  f9b00000          LDRSH    r0,[r0,#0]            ;8482  ; BAT_C_POINT_20
0056f6  fb90f0fa          SDIV     r0,r0,r10             ;8482
0056fa  fa0ffa80          SXTH     r10,r0                ;8482
0056fe  48f5              LDR      r0,|L1.23252|
005700  f9b00000          LDRSH    r0,[r0,#0]            ;8484  ; BAT_K_OLD
005704  fb0bfb00          MUL      r11,r11,r0            ;8484
005708  fb9bfbf5          SDIV     r11,r11,r5            ;8484
00570c  e001              B        |L1.22290|
                  |L1.22286|
00570e  e04e              B        |L1.22446|
                  |L1.22288|
005710  e082              B        |L1.22552|
                  |L1.22290|
005712  f8a2b000          STRH     r11,[r2,#0]           ;8484
005716  fb03f300          MUL      r3,r3,r0              ;8485
00571a  fb93f3f5          SDIV     r3,r3,r5              ;8485
00571e  8053              STRH     r3,[r2,#2]            ;8485
005720  fb0cfc00          MUL      r12,r12,r0            ;8486
005724  fb9cf3f5          SDIV     r3,r12,r5             ;8486
005728  8093              STRH     r3,[r2,#4]            ;8486
00572a  9b07              LDR      r3,[sp,#0x1c]         ;8487
00572c  fb03f300          MUL      r3,r3,r0              ;8487
005730  fb93f3f5          SDIV     r3,r3,r5              ;8487
005734  80d3              STRH     r3,[r2,#6]            ;8487
005736  fb09f900          MUL      r9,r9,r0              ;8488
00573a  fb99f3f5          SDIV     r3,r9,r5              ;8488
00573e  8113              STRH     r3,[r2,#8]            ;8488
005740  fb0efe00          MUL      lr,lr,r0              ;8489
005744  fb9ef3f5          SDIV     r3,lr,r5              ;8489
005748  8153              STRH     r3,[r2,#0xa]          ;8489
00574a  fb0afa00          MUL      r10,r10,r0            ;8490
00574e  fb9af0f5          SDIV     r0,r10,r5             ;8490
005752  8190              STRH     r0,[r2,#0xc]          ;8490
005754  9808              LDR      r0,[sp,#0x20]         ;8492
005756  f04f030a          MOV      r3,#0xa               ;8492
00575a  fb90f0f3          SDIV     r0,r0,r3              ;8492
00575e  b203              SXTH     r3,r0                 ;8492
005760  f04f0000          MOV      r0,#0                 ;8493
                  |L1.22372|
005764  f9325010          LDRSH    r5,[r2,r0,LSL #1]     ;8495
005768  429d              CMP      r5,r3                 ;8495
00576a  dd04              BLE      |L1.22390|
00576c  f1000001          ADD      r0,r0,#1              ;8493
005770  b2c0              UXTB     r0,r0                 ;8493
005772  2807              CMP      r0,#7                 ;8493
005774  d3f6              BCC      |L1.22372|
                  |L1.22390|
005776  b358              CBZ      r0,|L1.22480|
005778  1e45              SUBS     r5,r0,#1              ;8501
00577a  2d06              CMP      r5,#6                 ;8501
00577c  d22b              BCS      |L1.22486|
00577e  f832c015          LDRH     r12,[r2,r5,LSL #1]    ;8504
005782  ebac0303          SUB      r3,r12,r3             ;8504
005786  b21b              SXTH     r3,r3                 ;8504
005788  f8322010          LDRH     r2,[r2,r0,LSL #1]     ;8505
00578c  ebac0202          SUB      r2,r12,r2             ;8505
005790  fa0ffc82          SXTH     r12,r2                ;8505
005794  f85d9020          LDR      r9,[sp,r0,LSL #2]     ;8506
005798  f85d0025          LDR      r0,[sp,r5,LSL #2]     ;8506
00579c  eba90200          SUB      r2,r9,r0              ;8506
0057a0  fb02f203          MUL      r2,r2,r3              ;8507
0057a4  fb92f2fc          SDIV     r2,r2,r12             ;8508
0057a8  4410              ADD      r0,r0,r2              ;8509
0057aa  6530              STR      r0,[r6,#0x50]         ;8509  ; bat_hndl_t_razr
0057ac  e017              B        |L1.22494|
                  |L1.22446|
0057ae  f44f70ef          MOV      r0,#0x1de             ;8462
0057b2  f7fffffe          BL       lc640_read_int
0057b6  65b0              STR      r0,[r6,#0x58]         ;8462  ; bat_hndl_zvu_Q
0057b8  2865              CMP      r0,#0x65              ;8463
0057ba  d300              BCC      |L1.22462|
0057bc  65b5              STR      r5,[r6,#0x58]         ;8463  ; bat_hndl_zvu_Q
                  |L1.22462|
0057be  6db0              LDR      r0,[r6,#0x58]         ;8464  ; bat_hndl_zvu_Q
0057c0  f2427110          MOV      r1,#0x2710            ;8464
0057c4  fb00f001          MUL      r0,r0,r1              ;8464
0057c8  65b0              STR      r0,[r6,#0x58]         ;8464  ; bat_hndl_zvu_Q
0057ca  f8849009          STRB     r9,[r4,#9]            ;8466
0057ce  e066              B        |L1.22686|
                  |L1.22480|
0057d0  9800              LDR      r0,[sp,#0]            ;8500
0057d2  6530              STR      r0,[r6,#0x50]         ;8500  ; bat_hndl_t_razr
0057d4  e003              B        |L1.22494|
                  |L1.22486|
0057d6  2807              CMP      r0,#7                 ;8511
0057d8  d301              BCC      |L1.22494|
0057da  9806              LDR      r0,[sp,#0x18]         ;8513
0057dc  6530              STR      r0,[r6,#0x50]         ;8513  ; bat_hndl_t_razr
                  |L1.22494|
0057de  6d30              LDR      r0,[r6,#0x50]  ; bat_hndl_t_razr
0057e0  fb98f0f0          SDIV     r0,r8,r0
0057e4  65f0              STR      r0,[r6,#0x5c]  ; bat_hndl_proc_razr
;;;8516   
;;;8517   		if(bat_hndl_zvu_Q>bat_hndl_proc_razr)bat_hndl_zvu_Q-=bat_hndl_proc_razr;
0057e6  4281              CMP      r1,r0
0057e8  dd03              BLE      |L1.22514|
0057ea  eba10000          SUB      r0,r1,r0
0057ee  65b0              STR      r0,[r6,#0x58]  ; bat_hndl_zvu_Q
0057f0  e000              B        |L1.22516|
                  |L1.22514|
;;;8518   		else bat_hndl_zvu_Q=0L;
0057f2  65b7              STR      r7,[r6,#0x58]  ; bat_hndl_zvu_Q
                  |L1.22516|
;;;8519   
;;;8520   		bat_hndl_t_razr_hour=(short)(bat_hndl_remain_time/3600L);
0057f4  6e31              LDR      r1,[r6,#0x60]  ; bat_hndl_remain_time
0057f6  f44f6061          MOV      r0,#0xe10
0057fa  fb91f0f0          SDIV     r0,r1,r0
0057fe  8070              STRH     r0,[r6,#2]
;;;8521   		bat_hndl_t_razr_min=(short)(bat_hndl_remain_time/60L);
005800  f04f003c          MOV      r0,#0x3c
005804  fb91f1f0          SDIV     r1,r1,r0
005808  b209              SXTH     r1,r1
00580a  80b1              STRH     r1,[r6,#4]
;;;8522   		bat_hndl_t_razr_mininhour=bat_hndl_t_razr_min%60L;
00580c  fb91f2f0          SDIV     r2,r1,r0
005810  fb001012          MLS      r0,r0,r2,r1
005814  80f0              STRH     r0,[r6,#6]
005816  e016              B        |L1.22598|
                  |L1.22552|
;;;8523   
;;;8524   		}
;;;8525   	else if(Ib_ips_termokompensat>IKB)
005818  4290              CMP      r0,r2
00581a  dd14              BLE      |L1.22598|
;;;8526   		{
;;;8527   		bat_hndl_i_vector=1;
00581c  f884900b          STRB     r9,[r4,#0xb]
;;;8528   
;;;8529   		bat_hndl_i=Ib_ips_termokompensat;
005820  8030              STRH     r0,[r6,#0]
;;;8530   		bat_hndl_i_summ+=(long)bat_hndl_i;
005822  6eb2              LDR      r2,[r6,#0x68]  ; bat_hndl_i_summ
005824  4410              ADD      r0,r0,r2
005826  66b0              STR      r0,[r6,#0x68]  ; bat_hndl_i_summ
;;;8531   		if(bat_hndl_i_summ>=36000L)
005828  f64842a0          MOV      r2,#0x8ca0
00582c  4290              CMP      r0,r2
00582e  db0a              BLT      |L1.22598|
;;;8532   
;;;8533   		//bat_hndl_t_razr=BAT_C_POINT_20*36000L/bat_hndl_i;
;;;8534   		//bat_hndl_proc_razr=1000000L/bat_hndl_t_razr;
;;;8535   			{
;;;8536   			bat_hndl_i_summ-=36000L;
005830  eba00002          SUB      r0,r0,r2
005834  66b0              STR      r0,[r6,#0x68]  ; bat_hndl_i_summ
;;;8537   			if(bat_hndl_zvu_Q<1000000L)bat_hndl_zvu_Q+=bat_hndl_i_zar_price;
005836  4541              CMP      r1,r8
005838  da03              BGE      |L1.22594|
00583a  68f0              LDR      r0,[r6,#0xc]  ; bat_hndl_i_zar_price
00583c  4408              ADD      r0,r0,r1
00583e  65b0              STR      r0,[r6,#0x58]  ; bat_hndl_zvu_Q
005840  e001              B        |L1.22598|
                  |L1.22594|
;;;8538   			else bat_hndl_zvu_Q=1000000L; 
005842  f8c68058          STR      r8,[r6,#0x58]  ; bat_hndl_zvu_Q
                  |L1.22598|
;;;8539   			}
;;;8540   		}
;;;8541   
;;;8542   
;;;8543   	if(bat_hndl_i_vector!=bat_hndl_i_vector_old)
005846  7ae0              LDRB     r0,[r4,#0xb]  ; bat_hndl_i_vector
005848  7b21              LDRB     r1,[r4,#0xc]  ; bat_hndl_i_vector_old
00584a  4288              CMP      r0,r1
00584c  d00d              BEQ      |L1.22634|
;;;8544   		{
;;;8545   		if(bat_hndl_i_vector==1)
00584e  2801              CMP      r0,#1
005850  d10b              BNE      |L1.22634|
;;;8546   			{
;;;8547   			signed short tempSS;
;;;8548   			tempSS=lc640_read_int(EE_AMPER_CHAS_CNT);
005852  f44f70e4          MOV      r0,#0x1c8
005856  f7fffffe          BL       lc640_read_int
00585a  b200              SXTH     r0,r0
;;;8549   			bat_hndl_i_zar_price=(bat_hndl_zvu_Q-1000000L)/((long)tempSS);
00585c  4a9e              LDR      r2,|L1.23256|
00585e  6db1              LDR      r1,[r6,#0x58]  ; bat_hndl_zvu_Q
005860  4411              ADD      r1,r1,r2
005862  fb91f0f0          SDIV     r0,r1,r0
005866  60f0              STR      r0,[r6,#0xc]  ; bat_hndl_i_zar_price
;;;8550   			bat_hndl_i_summ=0;
005868  66b7              STR      r7,[r6,#0x68]  ; bat_hndl_i_summ
                  |L1.22634|
;;;8551   			}
;;;8552   		}
;;;8553   	bat_hndl_i_vector_old=bat_hndl_i_vector;
00586a  7ae0              LDRB     r0,[r4,#0xb]  ; bat_hndl_i_vector
00586c  7320              STRB     r0,[r4,#0xc]
;;;8554   
;;;8555   	if((bat_hndl_zvu_Q/10000L)!=lc640_read_int(EE_BAT1_ZAR_CNT)) lc640_write_int(EE_BAT1_ZAR_CNT,bat_hndl_zvu_Q/10000L);
00586e  6db0              LDR      r0,[r6,#0x58]  ; bat_hndl_zvu_Q
005870  f2427a10          MOV      r10,#0x2710
005874  fb90f5fa          SDIV     r5,r0,r10
005878  f44f79ef          MOV      r9,#0x1de
00587c  4648              MOV      r0,r9
00587e  f7fffffe          BL       lc640_read_int
005882  4285              CMP      r5,r0
005884  d006              BEQ      |L1.22676|
005886  6db0              LDR      r0,[r6,#0x58]  ; bat_hndl_zvu_Q
005888  fb90f0fa          SDIV     r0,r0,r10
00588c  b201              SXTH     r1,r0
00588e  4648              MOV      r0,r9
005890  f7fffffe          BL       lc640_write_int
                  |L1.22676|
;;;8556   	bat_hndl_remain_time=bat_hndl_zvu_Q/bat_hndl_proc_razr;
005894  e9d60116          LDRD     r0,r1,[r6,#0x58]
005898  fb90f0f1          SDIV     r0,r0,r1
00589c  6630              STR      r0,[r6,#0x60]  ; bat_hndl_remain_time
                  |L1.22686|
;;;8557   	}
;;;8558   
;;;8559   if(bat_hndl_zvu_Q>1000000L)	bat_hndl_zvu_Q=1000000L;
00589e  6db0              LDR      r0,[r6,#0x58]  ; bat_hndl_zvu_Q
0058a0  4540              CMP      r0,r8
0058a2  dd02              BLE      |L1.22698|
0058a4  f8c68058          STR      r8,[r6,#0x58]  ; bat_hndl_zvu_Q
0058a8  e002              B        |L1.22704|
                  |L1.22698|
;;;8560   else if(bat_hndl_zvu_Q<0L)	bat_hndl_zvu_Q=0L;
0058aa  2800              CMP      r0,#0
0058ac  da00              BGE      |L1.22704|
0058ae  65b7              STR      r7,[r6,#0x58]  ; bat_hndl_zvu_Q
                  |L1.22704|
;;;8561   
;;;8562   if((Ib_ips_termokompensat/10<(2*IKB))&&(Ib_ips_termokompensat/10>(-2*IKB))&&(!(bat[0]._av&0x01))&& (out_U<=u_necc_up) && (out_U>u_necc_dn) && (main_kb_cnt>=10) && (main_kb_cnt<=200) /*(main_kb_cnt==((TBAT*60)-10))*//*&& ((TVENTMAX!=0))*/ )
0058b0  488a              LDR      r0,|L1.23260|
0058b2  f9b01000          LDRSH    r1,[r0,#0]  ; Ib_ips_termokompensat
0058b6  200a              MOVS     r0,#0xa
0058b8  fb91f0f0          SDIV     r0,r1,r0
0058bc  4988              LDR      r1,|L1.23264|
0058be  f9b11000          LDRSH    r1,[r1,#0]  ; IKB
0058c2  ebb00f41          CMP      r0,r1,LSL #1
0058c6  da30              BGE      |L1.22826|
0058c8  4249              RSBS     r1,r1,#0
0058ca  ebb00f41          CMP      r0,r1,LSL #1
0058ce  dd2c              BLE      |L1.22826|
0058d0  4884              LDR      r0,|L1.23268|
0058d2  f890003d          LDRB     r0,[r0,#0x3d]  ; bat
0058d6  07c0              LSLS     r0,r0,#31
0058d8  d127              BNE      |L1.22826|
0058da  4883              LDR      r0,|L1.23272|
0058dc  4983              LDR      r1,|L1.23276|
0058de  f9b00000          LDRSH    r0,[r0,#0]  ; out_U
0058e2  f9b11000          LDRSH    r1,[r1,#0]  ; u_necc_up
0058e6  4288              CMP      r0,r1
0058e8  dc1f              BGT      |L1.22826|
0058ea  4981              LDR      r1,|L1.23280|
0058ec  f9b11000          LDRSH    r1,[r1,#0]  ; u_necc_dn
0058f0  4288              CMP      r0,r1
0058f2  dd1a              BLE      |L1.22826|
0058f4  f9b40052          LDRSH    r0,[r4,#0x52]  ; main_kb_cnt
0058f8  280a              CMP      r0,#0xa
0058fa  db16              BLT      |L1.22826|
0058fc  28c8              CMP      r0,#0xc8
0058fe  dc14              BGT      |L1.22826|
;;;8563   	{
;;;8564   	if(bat_hndl_zvu_Q_cnt<60)
005900  f8940030          LDRB     r0,[r4,#0x30]  ; bat_hndl_zvu_Q_cnt
005904  283c              CMP      r0,#0x3c
005906  d20d              BCS      |L1.22820|
;;;8565   		{
;;;8566   		bat_hndl_zvu_Q_cnt++;
005908  f1000001          ADD      r0,r0,#1
00590c  b2c0              UXTB     r0,r0
00590e  f8840030          STRB     r0,[r4,#0x30]
;;;8567   		if(bat_hndl_zvu_Q_cnt>=60)
005912  283c              CMP      r0,#0x3c
005914  d306              BCC      |L1.22820|
;;;8568   			{
;;;8569   			lc640_write_int(EE_BAT1_ZAR_CNT,100);
005916  2164              MOVS     r1,#0x64
005918  f44f70ef          MOV      r0,#0x1de
00591c  f7fffffe          BL       lc640_write_int
;;;8570   			bat_hndl_zvu_Q=1000000L;
005920  f8c68058          STR      r8,[r6,#0x58]  ; bat_hndl_zvu_Q
                  |L1.22820|
;;;8571   
;;;8572   
;;;8573   			}
;;;8574   		}
;;;8575   	}
;;;8576   else 
;;;8577   	{
;;;8578   	bat_hndl_zvu_Q_cnt=0;
;;;8579   	}
;;;8580   
;;;8581   
;;;8582   
;;;8583   };
005924  b009              ADD      sp,sp,#0x24
005926  e8bd8ff0          POP      {r4-r11,pc}
                  |L1.22826|
00592a  f8847030          STRB     r7,[r4,#0x30]         ;8578
00592e  e7f9              B        |L1.22820|
;;;8584   #endif
                          ENDP

                  u_avt_set_hndl PROC
;;;8588   //Установка напряжения автономной работы в полуавтоматическом режиме
;;;8589   void u_avt_set_hndl(void)
005930  e92d5fff          PUSH     {r0-r12,lr}
;;;8590   {
;;;8591   if(uavt_set_stat==uassSTEP1)
005934  4d6f              LDR      r5,|L1.23284|
;;;8592   	{
;;;8593   	char i,find_succes;
;;;8594   
;;;8595   	//u_max_temp=U_AVT+10;//(short)((((long)U_AVT)*101U)/100U);
;;;8596   	//u_min_temp=U_AVT-10;//(short)((((long)U_AVT)*99U)/100U);
;;;8597   	if(uavt_set_stat_old!=uavt_set_stat)
;;;8598   		{
;;;8599   		uavt_set_error_cnt=60;
005936  4e70              LDR      r6,|L1.23288|
005938  f8df81c0          LDR      r8,|L1.23292|
00593c  7828              LDRB     r0,[r5,#0]            ;8591  ; uavt_set_stat
;;;8600   		}
;;;8601   	//mess_send(MESS2UNECC_HNDL,PARAM_UNECC_SET,U_AVT,10);
;;;8602   	mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_FAST_REG,0,10);
;;;8603   	find_succes=0;
;;;8604   /*	for(i=0;i<NUMIST;i++)
;;;8605   		{
;;;8606   		if((bps[i]._Uii<u_max_temp)&&(bps[i]._Uii>u_min_temp))continue;
;;;8607   		else
;;;8608   			{
;;;8609   			find_succes=0;
;;;8610   			break;
;;;8611   			}
;;;8612   		}*/
;;;8613   	if((bps_U>=U_AVT-1)&&(bps_U<=U_AVT+1))find_succes=1;
00593e  f8dfa1c0          LDR      r10,|L1.23296|
005942  2400              MOVS     r4,#0                 ;8602
;;;8614   
;;;8615   	if(find_succes==1)
;;;8616   		{
;;;8617   		uavt_set_stat=uassSTEP2;
005944  f04f0902          MOV      r9,#2
;;;8618   		}
;;;8619   	if(uavt_set_error_cnt)
;;;8620   		{
;;;8621   		uavt_set_error_cnt--;
;;;8622   		if(!uavt_set_error_cnt)
;;;8623   			{
;;;8624   			uavt_set_stat=uassOFF;
;;;8625   			uavt_set_result_stat=uasrsERR;
;;;8626   			avt_error_bps=100;
005948  f04f0b64          MOV      r11,#0x64
00594c  2801              CMP      r0,#1                 ;8591
00594e  d12e              BNE      |L1.22958|
005950  f8980000          LDRB     r0,[r8,#0]            ;8597  ; uavt_set_stat_old
005954  2801              CMP      r0,#1                 ;8597
005956  d002              BEQ      |L1.22878|
005958  f04f003c          MOV      r0,#0x3c              ;8599
00595c  7030              STRB     r0,[r6,#0]            ;8599
                  |L1.22878|
00595e  230a              MOVS     r3,#0xa               ;8602
005960  2200              MOVS     r2,#0                 ;8602
005962  21e6              MOVS     r1,#0xe6              ;8602
005964  20e1              MOVS     r0,#0xe1              ;8602
005966  f7fffffe          BL       mess_send
00596a  f04f0000          MOV      r0,#0                 ;8603
00596e  4965              LDR      r1,|L1.23300|
005970  f9b12000          LDRSH    r2,[r1,#0]            ;8613  ; bps_U
005974  f9ba1000          LDRSH    r1,[r10,#0]           ;8613  ; U_AVT
005978  f1a10301          SUB      r3,r1,#1              ;8613
00597c  429a              CMP      r2,r3                 ;8613
00597e  db04              BLT      |L1.22922|
005980  1c49              ADDS     r1,r1,#1              ;8613
005982  428a              CMP      r2,r1                 ;8613
005984  dc01              BGT      |L1.22922|
005986  f04f0001          MOV      r0,#1                 ;8613
                  |L1.22922|
00598a  2801              CMP      r0,#1                 ;8615
00598c  d101              BNE      |L1.22930|
00598e  f8859000          STRB     r9,[r5,#0]            ;8617
                  |L1.22930|
005992  7830              LDRB     r0,[r6,#0]            ;8619  ; uavt_set_error_cnt
005994  b158              CBZ      r0,|L1.22958|
005996  f1a00001          SUB      r0,r0,#1              ;8621
00599a  b2c0              UXTB     r0,r0                 ;8621
00599c  7030              STRB     r0,[r6,#0]            ;8621
00599e  b930              CBNZ     r0,|L1.22958|
0059a0  702c              STRB     r4,[r5,#0]            ;8624
0059a2  4859              LDR      r0,|L1.23304|
0059a4  f8809000          STRB     r9,[r0,#0]            ;8625
0059a8  4858              LDR      r0,|L1.23308|
0059aa  f880b000          STRB     r11,[r0,#0]
                  |L1.22958|
;;;8627   			}
;;;8628   		}
;;;8629   	}
;;;8630   if(uavt_set_stat==uassSTEP2)
0059ae  782a              LDRB     r2,[r5,#0]  ; uavt_set_stat
;;;8631   	{
;;;8632   	char i,find_succes;
;;;8633   
;;;8634   	u_max_temp=(short)((((long)U_AVT)*101U)/100U);
0059b0  4957              LDR      r1,|L1.23312|
;;;8635   	u_min_temp=(short)((((long)U_AVT)*99U)/100U);
0059b2  4858              LDR      r0,|L1.23316|
;;;8636   
;;;8637   	if(uavt_set_stat_old!=uavt_set_stat)
;;;8638   		{
;;;8639   		uavt_set_error_cnt=60;
;;;8640   		}
;;;8641   
;;;8642   	mess_send(MESS2UNECC_HNDL,PARAM_UNECC_SET,U_AVT,10);
;;;8643   	mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_FAST_REG,0,10);
;;;8644   	find_succes=1;
;;;8645   
;;;8646   	for(i=0;i<NUMIST;i++)
;;;8647   		{
;;;8648   		if((bps[i]._Uii<u_max_temp)&&(bps[i]._Uii>u_min_temp))continue;
;;;8649   		else
;;;8650   			{
;;;8651   			find_succes=0;
;;;8652   			avt_error_bps=i+1;
;;;8653   			break;
;;;8654   			}
;;;8655   		}
;;;8656   
;;;8657   	if(find_succes==1)
;;;8658   		{
;;;8659   		uavt_set_stat=uassSTEP3;
;;;8660   		uavt_bps_pntr=0;
0059b4  4f58              LDR      r7,|L1.23320|
0059b6  2a02              CMP      r2,#2                 ;8630
0059b8  d002              BEQ      |L1.22976|
;;;8661   		avt_plazma=0;
;;;8662   		}
;;;8663   
;;;8664   	if(uavt_set_error_cnt)
;;;8665   		{
;;;8666   		uavt_set_error_cnt--;
;;;8667   		if(!uavt_set_error_cnt)
;;;8668   			{
;;;8669   			uavt_set_stat=uassOFF;
;;;8670   			uavt_set_result_stat=uasrsERR;
;;;8671   			}
;;;8672   		}
;;;8673   	}
;;;8674   else if(uavt_set_stat==uassSTEP3)
0059ba  2a03              CMP      r2,#3
0059bc  d05e              BEQ      |L1.23164|
0059be  e0fb              B        |L1.23480|
                  |L1.22976|
0059c0  f9ba2000          LDRSH    r2,[r10,#0]           ;8634  ; U_AVT
0059c4  f04f0365          MOV      r3,#0x65              ;8634
0059c8  fb02f303          MUL      r3,r2,r3              ;8634
0059cc  fbb3f3fb          UDIV     r3,r3,r11             ;8634
0059d0  468a              MOV      r10,r1                ;8634
0059d2  800b              STRH     r3,[r1,#0]            ;8634
0059d4  eb021142          ADD      r1,r2,r2,LSL #5       ;8635
0059d8  eb010141          ADD      r1,r1,r1,LSL #1       ;8635
0059dc  fbb1f1fb          UDIV     r1,r1,r11             ;8635
0059e0  4683              MOV      r11,r0                ;8635
0059e2  8001              STRH     r1,[r0,#0]            ;8635
0059e4  f8980000          LDRB     r0,[r8,#0]            ;8637  ; uavt_set_stat_old
0059e8  2802              CMP      r0,#2                 ;8637
0059ea  d002              BEQ      |L1.23026|
0059ec  f04f003c          MOV      r0,#0x3c              ;8639
0059f0  7030              STRB     r0,[r6,#0]            ;8639
                  |L1.23026|
0059f2  230a              MOVS     r3,#0xa               ;8642
0059f4  21bf              MOVS     r1,#0xbf              ;8642
0059f6  20be              MOVS     r0,#0xbe              ;8642
0059f8  f7fffffe          BL       mess_send
0059fc  230a              MOVS     r3,#0xa               ;8643
0059fe  2200              MOVS     r2,#0                 ;8643
005a00  21e6              MOVS     r1,#0xe6              ;8643
005a02  20e1              MOVS     r0,#0xe1              ;8643
005a04  f7fffffe          BL       mess_send
005a08  f04f0201          MOV      r2,#1                 ;8644
005a0c  f04f0000          MOV      r0,#0                 ;8646
005a10  4943              LDR      r1,|L1.23328|
005a12  f9ba3000          LDRSH    r3,[r10,#0]           ;8646
005a16  f8dfe104          LDR      lr,|L1.23324|
005a1a  f9bbc000          LDRSH    r12,[r11,#0]          ;8648
005a1e  f9b1a000          LDRSH    r10,[r1,#0]           ;8646
005a22  e00d              B        |L1.23104|
                  |L1.23076|
005a24  eb0001c0          ADD      r1,r0,r0,LSL #3       ;8648
005a28  eb011100          ADD      r1,r1,r0,LSL #4       ;8648
005a2c  eb0e0181          ADD      r1,lr,r1,LSL #2       ;8648
005a30  69c9              LDR      r1,[r1,#0x1c]         ;8648
005a32  4299              CMP      r1,r3                 ;8648
005a34  da09              BGE      |L1.23114|
005a36  4561              CMP      r1,r12                ;8648
005a38  dd07              BLE      |L1.23114|
005a3a  f1000001          ADD      r0,r0,#1              ;8646
005a3e  b2c0              UXTB     r0,r0                 ;8646
                  |L1.23104|
005a40  4550              CMP      r0,r10                ;8646
005a42  dbef              BLT      |L1.23076|
                  |L1.23108|
005a44  2a01              CMP      r2,#1                 ;8657
005a46  d007              BEQ      |L1.23128|
005a48  e00c              B        |L1.23140|
                  |L1.23114|
005a4a  f04f0200          MOV      r2,#0                 ;8651
005a4e  492f              LDR      r1,|L1.23308|
005a50  f1000001          ADD      r0,r0,#1              ;8652
005a54  7008              STRB     r0,[r1,#0]            ;8652
005a56  e7f5              B        |L1.23108|
                  |L1.23128|
005a58  f04f0003          MOV      r0,#3                 ;8659
005a5c  7028              STRB     r0,[r5,#0]            ;8659
005a5e  703c              STRB     r4,[r7,#0]            ;8660
005a60  4830              LDR      r0,|L1.23332|
005a62  7004              STRB     r4,[r0,#0]            ;8661
                  |L1.23140|
005a64  7830              LDRB     r0,[r6,#0]            ;8664  ; uavt_set_error_cnt
005a66  b370              CBZ      r0,|L1.23238|
005a68  f1a00001          SUB      r0,r0,#1              ;8666
005a6c  b2c0              UXTB     r0,r0                 ;8666
005a6e  7030              STRB     r0,[r6,#0]            ;8666
005a70  bb48              CBNZ     r0,|L1.23238|
005a72  702c              STRB     r4,[r5,#0]            ;8669
005a74  4824              LDR      r0,|L1.23304|
005a76  f8809000          STRB     r9,[r0,#0]            ;8670
005a7a  e09d              B        |L1.23480|
                  |L1.23164|
;;;8675   	{
;;;8676   	char i,find_succes;
;;;8677   
;;;8678   	u_max_temp=(short)((((long)U_AVT)*101U)/100U);
005a7c  f9ba2000          LDRSH    r2,[r10,#0]  ; U_AVT
005a80  f04f0365          MOV      r3,#0x65
005a84  fb02f303          MUL      r3,r2,r3
005a88  fbb3f3fb          UDIV     r3,r3,r11
005a8c  468a              MOV      r10,r1
005a8e  800b              STRH     r3,[r1,#0]
;;;8679   	u_min_temp=(short)((((long)U_AVT)*99U)/100U);
005a90  eb021142          ADD      r1,r2,r2,LSL #5
005a94  eb010141          ADD      r1,r1,r1,LSL #1
005a98  fbb1f1fb          UDIV     r1,r1,r11
005a9c  4683              MOV      r11,r0
005a9e  8001              STRH     r1,[r0,#0]
;;;8680   	
;;;8681   	if(uavt_set_stat_old!=uavt_set_stat)
005aa0  f8980000          LDRB     r0,[r8,#0]  ; uavt_set_stat_old
005aa4  2803              CMP      r0,#3
005aa6  d000              BEQ      |L1.23210|
;;;8682   		{
;;;8683   		uavt_bps_pntr=0;
005aa8  703c              STRB     r4,[r7,#0]
                  |L1.23210|
;;;8684   		}
;;;8685   
;;;8686   	mess_send(MESS2UNECC_HNDL,PARAM_UNECC_SET,U_AVT,10);
005aaa  230a              MOVS     r3,#0xa
005aac  21bf              MOVS     r1,#0xbf
005aae  20be              MOVS     r0,#0xbe
005ab0  f7fffffe          BL       mess_send
;;;8687   	mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_FAST_REG,0,10);
005ab4  230a              MOVS     r3,#0xa
005ab6  2200              MOVS     r2,#0
005ab8  21e6              MOVS     r1,#0xe6
005aba  20e1              MOVS     r0,#0xe1
005abc  f7fffffe          BL       mess_send
;;;8688   
;;;8689   	find_succes=1;
005ac0  f04f0601          MOV      r6,#1
;;;8690   	for(i=0;i<NUMIST;i++)
005ac4  e030              B        |L1.23336|
                  |L1.23238|
005ac6  e077              B        |L1.23480|
                  |L1.23240|
                          DCD      BAT_C_POINT_5
                  |L1.23244|
                          DCD      BAT_C_POINT_10
                  |L1.23248|
                          DCD      BAT_C_POINT_20
                  |L1.23252|
                          DCD      BAT_K_OLD
                  |L1.23256|
                          DCD      0xfff0bdc0
                  |L1.23260|
                          DCD      Ib_ips_termokompensat
                  |L1.23264|
                          DCD      IKB
                  |L1.23268|
                          DCD      bat
                  |L1.23272|
                          DCD      out_U
                  |L1.23276|
                          DCD      u_necc_up
                  |L1.23280|
                          DCD      u_necc_dn
                  |L1.23284|
                          DCD      uavt_set_stat
                  |L1.23288|
                          DCD      uavt_set_error_cnt
                  |L1.23292|
                          DCD      uavt_set_stat_old
                  |L1.23296|
                          DCD      U_AVT
                  |L1.23300|
                          DCD      bps_U
                  |L1.23304|
                          DCD      uavt_set_result_stat
                  |L1.23308|
                          DCD      avt_error_bps
                  |L1.23312|
                          DCD      u_max_temp
                  |L1.23316|
                          DCD      u_min_temp
                  |L1.23320|
                          DCD      uavt_bps_pntr
                  |L1.23324|
                          DCD      bps
                  |L1.23328|
                          DCD      NUMIST
                  |L1.23332|
                          DCD      avt_plazma
                  |L1.23336|
005b28  f04f0000          MOV      r0,#0
005b2c  f8df9414          LDR      r9,|L1.24388|
005b30  f9ba2000          LDRSH    r2,[r10,#0]
005b34  f8dfc408          LDR      r12,|L1.24384|
005b38  f9bb3000          LDRSH    r3,[r11,#0]           ;8648
005b3c  f9b9a000          LDRSH    r10,[r9,#0]           ;8646
005b40  e00d              B        |L1.23390|
                  |L1.23362|
;;;8691   		{
;;;8692   		if((bps[i]._Uii<u_max_temp)&&(bps[i]._Uii>u_min_temp))continue;
005b42  eb0001c0          ADD      r1,r0,r0,LSL #3
005b46  eb011100          ADD      r1,r1,r0,LSL #4
005b4a  eb0c0181          ADD      r1,r12,r1,LSL #2
005b4e  69c9              LDR      r1,[r1,#0x1c]
005b50  4291              CMP      r1,r2
005b52  da0f              BGE      |L1.23412|
005b54  4299              CMP      r1,r3
005b56  dd0d              BLE      |L1.23412|
005b58  f1000001          ADD      r0,r0,#1              ;8690
005b5c  b2c0              UXTB     r0,r0                 ;8690
                  |L1.23390|
005b5e  4550              CMP      r0,r10                ;8690
005b60  dbef              BLT      |L1.23362|
                  |L1.23394|
;;;8693   		else
;;;8694   			{
;;;8695   			find_succes=0;
;;;8696   			break;
;;;8697   			}
;;;8698   		}
;;;8699   
;;;8700   	if(mess_find( (MESS2IND_HNDL)) && (mess_data[0]==PARAM_U_AVT_GOOD) )
005b62  20d7              MOVS     r0,#0xd7
005b64  f7fffffe          BL       mess_find
005b68  b1a0              CBZ      r0,|L1.23444|
005b6a  48f7              LDR      r0,|L1.24392|
005b6c  6800              LDR      r0,[r0,#0]  ; mess_data
005b6e  28d9              CMP      r0,#0xd9
005b70  d003              BEQ      |L1.23418|
005b72  e00f              B        |L1.23444|
                  |L1.23412|
005b74  f04f0600          MOV      r6,#0                 ;8695
005b78  e7f3              B        |L1.23394|
                  |L1.23418|
;;;8701   		{
;;;8702   		if(++uavt_bps_pntr>=NUMIST)
005b7a  7838              LDRB     r0,[r7,#0]  ; uavt_bps_pntr
005b7c  1c40              ADDS     r0,r0,#1
005b7e  b2c0              UXTB     r0,r0
005b80  7038              STRB     r0,[r7,#0]
005b82  f9b91000          LDRSH    r1,[r9,#0]  ; NUMIST
005b86  4288              CMP      r0,r1
005b88  db04              BLT      |L1.23444|
;;;8703   			{
;;;8704   			uavt_set_stat=uassOFF;
005b8a  702c              STRB     r4,[r5,#0]
;;;8705   			uavt_set_result_stat=uasrsSUCCESS;
005b8c  49ef              LDR      r1,|L1.24396|
005b8e  f04f0003          MOV      r0,#3
005b92  7008              STRB     r0,[r1,#0]
                  |L1.23444|
;;;8706   			}
;;;8707   		//uavt_bps_pntr++;
;;;8708   		//if()
;;;8709   		}
;;;8710   	if(find_succes==1)
005b94  2e01              CMP      r6,#1
005b96  d10f              BNE      |L1.23480|
;;;8711   		{
;;;8712   		mcp2515_transmit(uavt_bps_pntr,uavt_bps_pntr,CMND,0xee,0xee,0,0,0);
005b98  20ee              MOVS     r0,#0xee
005b9a  e9cd0400          STRD     r0,r4,[sp,#0]
005b9e  9402              STR      r4,[sp,#8]
005ba0  9403              STR      r4,[sp,#0xc]
005ba2  7839              LDRB     r1,[r7,#0]  ; uavt_bps_pntr
005ba4  4603              MOV      r3,r0
005ba6  2216              MOVS     r2,#0x16
005ba8  4608              MOV      r0,r1
005baa  f7fffffe          BL       mcp2515_transmit
;;;8713   		avt_plazma++;
005bae  48e8              LDR      r0,|L1.24400|
005bb0  7801              LDRB     r1,[r0,#0]  ; avt_plazma
005bb2  f1010101          ADD      r1,r1,#1
005bb6  7001              STRB     r1,[r0,#0]
                  |L1.23480|
;;;8714   		}
;;;8715   	}
;;;8716   
;;;8717   
;;;8718   
;;;8719   uavt_set_stat_old=uavt_set_stat;
005bb8  7828              LDRB     r0,[r5,#0]  ; uavt_set_stat
005bba  f8880000          STRB     r0,[r8,#0]
;;;8720   
;;;8721   }
005bbe  e8bd9fff          POP      {r0-r12,pc}
;;;8722   
                          ENDP

                  u_necc_hndl PROC
;;;8797   //-----------------------------------------------
;;;8798   void u_necc_hndl(void)
005bc2  b5f8              PUSH     {r3-r7,lr}
;;;8799   {
;;;8800   signed long temp_L;
;;;8801   signed long temp_SL;
;;;8802   //signed short temp_SS;
;;;8803   
;;;8804   //char i;
;;;8805   
;;;8806   //temp_SS=0;
;;;8807   signed short t[2];
;;;8808   
;;;8809   
;;;8810   
;;;8811   
;;;8812   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;8813   
;;;8814   if(!TERMOKOMPENS)
005bc4  48e3              LDR      r0,|L1.24404|
;;;8815   	{
;;;8816   	//u_necc=U0B;
;;;8817   	u_necc=UB20;
;;;8818   	}
;;;8819   else
;;;8820   	{
;;;8821   	if(ND_EXT[0])t[0]=20;
;;;8822   	else t[0]=t_ext[0];
;;;8823   
;;;8824   	mat_temper=t[0];
;;;8825   			
;;;8826   	if(mat_temper<0)temp_SL=UB0; 
;;;8827   	else 
;;;8828   		{
;;;8829   		if(mat_temper>40)mat_temper=40; 
;;;8830   		temp_SL=(UB20-UB0)*10;
;;;8831   		temp_SL*=mat_temper;
;;;8832   		temp_SL/=200;
;;;8833   		temp_SL+=UB0;
;;;8834   		}
;;;8835   	if((spc_stat==spcVZ)&&((sk_stat[0]==1)||(VZ_CH_VENT_BLOK==0)))
005bc6  4de6              LDR      r5,|L1.24416|
005bc8  4ce6              LDR      r4,|L1.24420|
005bca  8801              LDRH     r1,[r0,#0]            ;8814  ; TERMOKOMPENS
005bcc  48e2              LDR      r0,|L1.24408|
005bce  f9b03000          LDRSH    r3,[r0,#0]            ;8817
;;;8836   		{
;;;8837   		temp_SL=UVZ;
005bd2  48e2              LDR      r0,|L1.24412|
005bd4  f9b02000          LDRSH    r2,[r0,#0]
005bd8  b139              CBZ      r1,|L1.23530|
005bda  48e3              LDR      r0,|L1.24424|
005bdc  7800              LDRB     r0,[r0,#0]            ;8821  ; ND_EXT
005bde  b130              CBZ      r0,|L1.23534|
005be0  f04f0014          MOV      r0,#0x14              ;8821
005be4  f8ad0000          STRH     r0,[sp,#0]            ;8821
005be8  e005              B        |L1.23542|
                  |L1.23530|
005bea  8023              STRH     r3,[r4,#0]            ;8817
005bec  e02c              B        |L1.23624|
                  |L1.23534|
005bee  48df              LDR      r0,|L1.24428|
005bf0  8800              LDRH     r0,[r0,#0]            ;8822  ; t_ext
005bf2  f8ad0000          STRH     r0,[sp,#0]            ;8822
                  |L1.23542|
005bf6  4ede              LDR      r6,|L1.24432|
005bf8  f9bd1000          LDRSH    r1,[sp,#0]            ;8824
005bfc  6031              STR      r1,[r6,#0]            ;8824  ; mat_temper
005bfe  48dd              LDR      r0,|L1.24436|
005c00  2900              CMP      r1,#0                 ;8826
005c02  f9b00000          LDRSH    r0,[r0,#0]            ;8826
005c06  db12              BLT      |L1.23598|
005c08  2928              CMP      r1,#0x28              ;8829
005c0a  dd02              BLE      |L1.23570|
005c0c  f04f0128          MOV      r1,#0x28              ;8829
005c10  6031              STR      r1,[r6,#0]            ;8829  ; mat_temper
                  |L1.23570|
005c12  eba30100          SUB      r1,r3,r0              ;8830
005c16  eb010181          ADD      r1,r1,r1,LSL #2       ;8830
005c1a  ea4f0141          LSL      r1,r1,#1              ;8830
005c1e  6833              LDR      r3,[r6,#0]            ;8831  ; mat_temper
005c20  fb01f103          MUL      r1,r1,r3              ;8831
005c24  f04f03c8          MOV      r3,#0xc8              ;8832
005c28  fb91f1f3          SDIV     r1,r1,r3              ;8832
005c2c  4408              ADD      r0,r0,r1              ;8833
                  |L1.23598|
005c2e  f8951023          LDRB     r1,[r5,#0x23]         ;8835  ; spc_stat
005c32  2902              CMP      r1,#2                 ;8835
005c34  d107              BNE      |L1.23622|
005c36  49d0              LDR      r1,|L1.24440|
005c38  7809              LDRB     r1,[r1,#0]            ;8835  ; sk_stat
005c3a  2901              CMP      r1,#1                 ;8835
005c3c  d002              BEQ      |L1.23620|
005c3e  49cf              LDR      r1,|L1.24444|
005c40  8809              LDRH     r1,[r1,#0]            ;8835  ; VZ_CH_VENT_BLOK
005c42  b901              CBNZ     r1,|L1.23622|
                  |L1.23620|
005c44  4610              MOV      r0,r2
                  |L1.23622|
;;;8838   		}
;;;8839   	u_necc=(unsigned int)temp_SL;
005c46  8020              STRH     r0,[r4,#0]
                  |L1.23624|
;;;8840   	///u_necc=3456;
;;;8841   	}  
;;;8842   
;;;8843   //u_necc=2355;
;;;8844   
;;;8845   if((speedChIsOn)||(sp_ch_stat==scsWRK))
005c48  48cd              LDR      r0,|L1.24448|
005c4a  8800              LDRH     r0,[r0,#0]  ; speedChIsOn
005c4c  b918              CBNZ     r0,|L1.23638|
005c4e  48cd              LDR      r0,|L1.24452|
005c50  7800              LDRB     r0,[r0,#0]  ; sp_ch_stat
005c52  2802              CMP      r0,#2
005c54  d102              BNE      |L1.23644|
                  |L1.23638|
;;;8846   	{
;;;8847   	u_necc=speedChrgVolt;
005c56  48cc              LDR      r0,|L1.24456|
005c58  8800              LDRH     r0,[r0,#0]  ; speedChrgVolt
005c5a  8020              STRH     r0,[r4,#0]
                  |L1.23644|
;;;8848   	}
;;;8849   if(hv_vz_stat==hvsWRK)
005c5c  48cb              LDR      r0,|L1.24460|
005c5e  7800              LDRB     r0,[r0,#0]  ; hv_vz_stat
005c60  2805              CMP      r0,#5
005c62  d100              BNE      |L1.23654|
;;;8850   	{
;;;8851   	u_necc=UVZ;
005c64  8022              STRH     r2,[r4,#0]
                  |L1.23654|
;;;8852   	}
;;;8853   if(vz1_stat==vz1sWRK)
005c66  7968              LDRB     r0,[r5,#5]  ; vz1_stat
005c68  280a              CMP      r0,#0xa
005c6a  d102              BNE      |L1.23666|
;;;8854   	{
;;;8855   	u_necc=UZ_U;
005c6c  48c8              LDR      r0,|L1.24464|
005c6e  8800              LDRH     r0,[r0,#0]  ; UZ_U
005c70  8020              STRH     r0,[r4,#0]
                  |L1.23666|
;;;8856   	}
;;;8857   if(vz2_stat==vz2sWRK1)
005c72  79e8              LDRB     r0,[r5,#7]  ; vz2_stat
005c74  280a              CMP      r0,#0xa
005c76  d102              BNE      |L1.23678|
;;;8858   	{
;;;8859   	u_necc=FZ_U1;
005c78  49c6              LDR      r1,|L1.24468|
005c7a  8809              LDRH     r1,[r1,#0]  ; FZ_U1
005c7c  8021              STRH     r1,[r4,#0]
                  |L1.23678|
;;;8860   	}
;;;8861   if(vz2_stat==vz2sWRK2)
005c7e  280b              CMP      r0,#0xb
005c80  d102              BNE      |L1.23688|
;;;8862   	{
;;;8863   	u_necc=FZ_U2;
005c82  48c5              LDR      r0,|L1.24472|
005c84  8800              LDRH     r0,[r0,#0]  ; FZ_U2
005c86  8020              STRH     r0,[r4,#0]
                  |L1.23688|
;;;8864   	}
;;;8865   
;;;8866   if((uavt_set_stat==uassSTEP1)||(uavt_set_stat==uassSTEP2))
005c88  48c4              LDR      r0,|L1.24476|
005c8a  7800              LDRB     r0,[r0,#0]  ; uavt_set_stat
005c8c  2801              CMP      r0,#1
005c8e  d001              BEQ      |L1.23700|
005c90  2802              CMP      r0,#2
005c92  d102              BNE      |L1.23706|
                  |L1.23700|
;;;8867   	{
;;;8868   	u_necc=U_AVT;
005c94  48c2              LDR      r0,|L1.24480|
005c96  8800              LDRH     r0,[r0,#0]  ; U_AVT
005c98  8020              STRH     r0,[r4,#0]
                  |L1.23706|
;;;8869   	}
;;;8870   
;;;8871   if(mess_find_unvol(MESS2UNECC_HNDL))
005c9a  20be              MOVS     r0,#0xbe
005c9c  f7fffffe          BL       mess_find_unvol
005ca0  b128              CBZ      r0,|L1.23726|
;;;8872   	{		
;;;8873   	if(mess_data[0]==PARAM_UNECC_SET)
005ca2  48a9              LDR      r0,|L1.24392|
005ca4  6801              LDR      r1,[r0,#0]  ; mess_data
005ca6  29bf              CMP      r1,#0xbf
005ca8  d101              BNE      |L1.23726|
;;;8874   		{
;;;8875   		u_necc=mess_data[1];
005caa  6840              LDR      r0,[r0,#4]  ; mess_data
005cac  8020              STRH     r0,[r4,#0]
                  |L1.23726|
;;;8876   		}		
;;;8877   	} 
;;;8878   
;;;8879   //if(ICA_EN)u_necc+=ica_u_necc;
;;;8880   #endif
;;;8881   
;;;8882   
;;;8883   #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;8884   
;;;8885   #ifndef UKU_TELECORE2015
;;;8886   #ifndef UKU_TELECORE2017
;;;8887   if(unh_cnt0<10)
;;;8888   	{
;;;8889   	unh_cnt0++;
;;;8890   	if(unh_cnt0>=10)
;;;8891   		{
;;;8892   		unh_cnt0=0;
;;;8893   		b1Hz_unh=1;
;;;8894   		}
;;;8895   	}
;;;8896   
;;;8897   if(unh_cnt1<5)
;;;8898   	{
;;;8899   	unh_cnt1++;
;;;8900   	if(unh_cnt1==5)
;;;8901   		{
;;;8902   		unh_cnt1=0;
;;;8903   //		b2Hz_unh=1;
;;;8904   		}
;;;8905   	} 
;;;8906   
;;;8907   
;;;8908   
;;;8909   if(mess_find_unvol(MESS2UNECC_HNDL))
;;;8910   	{		
;;;8911   	if(mess_data[0]==PARAM_UNECC_SET)
;;;8912   		{
;;;8913   		u_necc=mess_data[1];
;;;8914   		}		
;;;8915   	}
;;;8916   
;;;8917   
;;;8918   else if(b1Hz_unh)
;;;8919   	{
;;;8920   	
;;;8921   	if((BAT_IS_ON[0]!=bisON) && (BAT_IS_ON[1]!=bisON))
;;;8922   		{
;;;8923   		
;;;8924   		u_necc=U0B;
;;;8925   		#ifdef IPS_SGEP_GAZPROM
;;;8926   		u_necc=UB0;
;;;8927   		#endif
;;;8928   		}
;;;8929   	else 
;;;8930   		{
;;;8931   		if(BAT_TYPE==0) //если батарея обычная
;;;8932   			{
;;;8933   			for(i=0;i<2;i++)
;;;8934   				{
;;;8935   				if(BAT_IS_ON[i]==bisON)
;;;8936   					{
;;;8937   					if(bat[i]._nd)t[i]=20;
;;;8938   					else t[i]=bat[i]._Tb;
;;;8939   					}
;;;8940   				else
;;;8941   					{
;;;8942   					t[i]=-20;
;;;8943   					}
;;;8944   				}
;;;8945   			if(t[0]>t[1])mat_temper=t[0];
;;;8946   			else mat_temper=t[1];
;;;8947   			
;;;8948   		
;;;8949   			if(mat_temper<0)temp_SL=UB0; 
;;;8950   			else 
;;;8951   				{
;;;8952   				if(mat_temper>40)mat_temper=40; 
;;;8953   				temp_SL=(UB20-UB0)*10;
;;;8954   				temp_SL*=mat_temper;
;;;8955   				temp_SL/=200;
;;;8956   				temp_SL+=UB0;
;;;8957   				}
;;;8958   			if((spc_stat==spcVZ)
;;;8959   #ifndef UKU_6U			
;;;8960   			&&(sk_stat[0]==1)
;;;8961   #endif //UKU_6U
;;;8962   			)
;;;8963   				{
;;;8964   				temp_SL=UVZ;
;;;8965   				}
;;;8966   			u_necc=(unsigned int)temp_SL;
;;;8967   			}
;;;8968   		else if(BAT_TYPE==1) //если батарея китайская
;;;8969   			{
;;;8970   			u_necc=U0B;
;;;8971   					
;;;8972   			u_necc=bat[0]._Ub+10;
;;;8973   
;;;8974   			
;;;8975   			if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;8976   				{
;;;8977   				u_necc=UVZ;
;;;8978   				}
;;;8979   			if(u_necc>=UB0) u_necc=UB0;
;;;8980   			if(u_necc>=UB20) u_necc=UB20;
;;;8981   			}
;;;8982   		}  
;;;8983   	}
;;;8984   #endif
;;;8985   #endif
;;;8986   
;;;8987   #ifdef UKU_TELECORE2015
;;;8988   
;;;8989   if(unh_cnt0<10)
;;;8990   	{
;;;8991   	unh_cnt0++;
;;;8992   	if(unh_cnt0>=10)
;;;8993   		{
;;;8994   		unh_cnt0=0;
;;;8995   		b1Hz_unh=1;
;;;8996   		}
;;;8997   	}
;;;8998   
;;;8999   if(unh_cnt1<5)
;;;9000   	{
;;;9001   	unh_cnt1++;
;;;9002   	if(unh_cnt1==5)
;;;9003   		{
;;;9004   		unh_cnt1=0;
;;;9005   //		b2Hz_unh=1;
;;;9006   		}
;;;9007   	} 
;;;9008   
;;;9009   
;;;9010   
;;;9011   if(mess_find_unvol(MESS2UNECC_HNDL))
;;;9012   	{		
;;;9013   	if(mess_data[0]==PARAM_UNECC_SET)
;;;9014   		{
;;;9015   		u_necc=mess_data[1];
;;;9016   		}		
;;;9017   	}
;;;9018   
;;;9019   
;;;9020   else if(b1Hz_unh)
;;;9021   	{
;;;9022   	b1Hz_unh=0;
;;;9023   
;;;9024   	if(BAT_TYPE==0)
;;;9025   		{
;;;9026   		if(bat[0]._nd)mat_temper=20;
;;;9027   		else mat_temper=bat[0]._Tb;
;;;9028   
;;;9029   			
;;;9030   		if(mat_temper<0)temp_SL=UB0; 
;;;9031   		else 
;;;9032   			{
;;;9033   			if(mat_temper>40)mat_temper=40; 
;;;9034   			temp_SL=(UB20-UB0)*10;
;;;9035   			temp_SL*=mat_temper;
;;;9036   			temp_SL/=200;
;;;9037   			temp_SL+=UB0;
;;;9038   			}
;;;9039   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;9040   			{
;;;9041   			temp_SL=UVZ;
;;;9042   			}
;;;9043   		u_necc=(unsigned int)temp_SL;
;;;9044   	///u_necc=3456;
;;;9045   		}
;;;9046   	else if(BAT_TYPE==1)
;;;9047   		{
;;;9048   		
;;;9049   		gran(&DU_LI_BAT,1,30);
;;;9050   		u_necc=li_bat._Ub+DU_LI_BAT;
;;;9051   		gran(&u_necc,0,UB0);
;;;9052   		gran(&u_necc,0,UB20);
;;;9053   		gran(&u_necc,0,540);		
;;;9054   
;;;9055   
;;;9056   		if(li_bat._batStat!=bsOK)
;;;9057   			{
;;;9058   			u_necc=U0B;
;;;9059   			}
;;;9060   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;9061   			{
;;;9062   			u_necc=UVZ;
;;;9063   			}
;;;9064   		/* 
;;;9065   		u_necc=U0B;
;;;9066   		
;;;9067   
;;;9068   	
;;;9069   		u_necc=UB0;
;;;9070   		u_necc=li_bat._Ub+10;
;;;9071   		if((li_bat._Ub<450)||(li_bat._Ub>550))
;;;9072   			{
;;;9073   			lakb_error_cnt++;
;;;9074   			if(lakb_error_cnt>=30)
;;;9075   				{
;;;9076   				lakb_error_cnt=30;
;;;9077   				u_necc=U0B;
;;;9078   				}
;;;9079   			}
;;;9080   		else lakb_error_cnt=0;*/
;;;9081   		}
;;;9082   	else if(BAT_TYPE==2)
;;;9083   		{
;;;9084   		u_necc=U0B;
;;;9085   		
;;;9086   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;9087   			{
;;;9088   			u_necc=UVZ;
;;;9089   			}
;;;9090   	
;;;9091   		u_necc=UB0;
;;;9092   		}
;;;9093   
;;;9094   	else if(BAT_TYPE==3)
;;;9095   		{
;;;9096   		u_necc=U0B;
;;;9097   		
;;;9098   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;9099   			{
;;;9100   			u_necc=UVZ;
;;;9101   			}
;;;9102   
;;;9103   		gran(&DU_LI_BAT,1,30);
;;;9104   
;;;9105   
;;;9106   		if(lakbNotErrorNum==0)
;;;9107   			{
;;;9108   			u_necc=U0B;
;;;9109   			}
;;;9110   		else 
;;;9111   			{
;;;9112   			signed short i;
;;;9113   			//signed short u_necc_max;
;;;9114   			//u_necc_max=0;
;;;9115   			char soc_flag=0;
;;;9116   
;;;9117   			for(i=(NUMBAT_TELECORE-1);i>=0;i--)
;;;9118   				{
;;;9119   				if(lakb[i]._communicationFullErrorStat==0)u_necc=lakb[i]._tot_bat_volt+DU_LI_BAT;
;;;9120   				if(lakb[i]._s_o_c_percent<QSODERG_LI_BAT)soc_flag=1;
;;;9121   				}
;;;9122   
;;;9123   			if(soc_flag==0)u_necc=USODERG_LI_BAT;
;;;9124   			}
;;;9125   		gran(&u_necc,0,UB0);
;;;9126   		//gran(&u_necc,0,UB20);
;;;9127   		gran(&u_necc,0,540);
;;;9128   		}
;;;9129   	}
;;;9130   
;;;9131   #endif 
;;;9132   
;;;9133   #ifdef UKU_TELECORE2017
;;;9134   
;;;9135   if(unh_cnt0<10)
;;;9136   	{
;;;9137   	unh_cnt0++;
;;;9138   	if(unh_cnt0>=10)
;;;9139   		{
;;;9140   		unh_cnt0=0;
;;;9141   		b1Hz_unh=1;
;;;9142   		}
;;;9143   	}
;;;9144   
;;;9145   if(unh_cnt1<5)
;;;9146   	{
;;;9147   	unh_cnt1++;
;;;9148   	if(unh_cnt1==5)
;;;9149   		{
;;;9150   		unh_cnt1=0;
;;;9151   //		b2Hz_unh=1;
;;;9152   		}
;;;9153   	} 
;;;9154   
;;;9155   
;;;9156   
;;;9157   if(mess_find_unvol(MESS2UNECC_HNDL))
;;;9158   	{		
;;;9159   	if(mess_data[0]==PARAM_UNECC_SET)
;;;9160   		{
;;;9161   		u_necc=mess_data[1];
;;;9162   		}		
;;;9163   	}
;;;9164   
;;;9165   
;;;9166   else if(b1Hz_unh)
;;;9167   	{
;;;9168   	b1Hz_unh=0;
;;;9169   
;;;9170   	if(BAT_TYPE==0)
;;;9171   		{
;;;9172   		if(bat[0]._nd)mat_temper=20;
;;;9173   		else mat_temper=bat[0]._Tb;
;;;9174   
;;;9175   			
;;;9176   		if(mat_temper<0)temp_SL=UB0; 
;;;9177   		else 
;;;9178   			{
;;;9179   			if(mat_temper>40)mat_temper=40; 
;;;9180   			temp_SL=(UB20-UB0)*10;
;;;9181   			temp_SL*=mat_temper;
;;;9182   			temp_SL/=200;
;;;9183   			temp_SL+=UB0;
;;;9184   			}
;;;9185   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;9186   			{
;;;9187   			temp_SL=UVZ;
;;;9188   			}
;;;9189   		u_necc=(unsigned int)temp_SL;
;;;9190   	///u_necc=3456;
;;;9191   		}
;;;9192   	else if(BAT_TYPE==1)
;;;9193   		{
;;;9194   		
;;;9195   		gran(&DU_LI_BAT,1,30);
;;;9196   		u_necc=li_bat._Ub+DU_LI_BAT;
;;;9197   		gran(&u_necc,0,UB0);
;;;9198   		gran(&u_necc,0,UB20);
;;;9199   		gran(&u_necc,0,540);		
;;;9200   
;;;9201   
;;;9202   		if(li_bat._batStat!=bsOK)
;;;9203   			{
;;;9204   			u_necc=U0B;
;;;9205   			}
;;;9206   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;9207   			{
;;;9208   			u_necc=UVZ;
;;;9209   			}
;;;9210   		}
;;;9211   	else if(BAT_TYPE==2)
;;;9212   		{
;;;9213   		u_necc=U0B;
;;;9214   		
;;;9215   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;9216   			{
;;;9217   			u_necc=UVZ;
;;;9218   			}
;;;9219   	
;;;9220   		u_necc=UB0;
;;;9221   		}
;;;9222   
;;;9223   	else if(BAT_TYPE==3)
;;;9224   		{
;;;9225   		u_necc=U0B;
;;;9226   		
;;;9227   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;9228   			{
;;;9229   			u_necc=UVZ;
;;;9230   			}
;;;9231   
;;;9232   		gran(&DU_LI_BAT,1,30);
;;;9233   
;;;9234   
;;;9235   		if(lakbNotErrorNum==0)
;;;9236   			{
;;;9237   			u_necc=U0B;
;;;9238   			}
;;;9239   		else 
;;;9240   			{
;;;9241   			signed short i;
;;;9242   			//signed short u_necc_max;
;;;9243   			//u_necc_max=0;
;;;9244   			char soc_flag=0;
;;;9245   
;;;9246   			for(i=(NUMBAT_TELECORE-1);i>=0;i--)
;;;9247   				{
;;;9248   				if(lakb[i]._communicationFullErrorStat==0)u_necc=lakb[i]._tot_bat_volt+DU_LI_BAT;
;;;9249   				if(lakb[i]._s_o_c_percent<QSODERG_LI_BAT)soc_flag=1;
;;;9250   				}
;;;9251   
;;;9252   			if(soc_flag==0)u_necc=USODERG_LI_BAT;
;;;9253   			}
;;;9254   		gran(&u_necc,0,UB0);
;;;9255   		//gran(&u_necc,0,UB20);
;;;9256   		gran(&u_necc,0,540);
;;;9257   		}
;;;9258   	}
;;;9259   
;;;9260   #endif 
;;;9261   //u_necc=2356;
;;;9262   
;;;9263   #ifdef UKU_FSO
;;;9264   
;;;9265   if(unh_cnt0<10)
;;;9266   	{
;;;9267   	unh_cnt0++;
;;;9268   	if(unh_cnt0>=10)
;;;9269   		{
;;;9270   		unh_cnt0=0;
;;;9271   		b1Hz_unh=1;
;;;9272   		}
;;;9273   	}
;;;9274   
;;;9275   if(unh_cnt1<5)
;;;9276   	{
;;;9277   	unh_cnt1++;
;;;9278   	if(unh_cnt1==5)
;;;9279   		{
;;;9280   		unh_cnt1=0;
;;;9281   //		b2Hz_unh=1;
;;;9282   		}
;;;9283   	} 
;;;9284   
;;;9285   
;;;9286   
;;;9287   if(mess_find_unvol(MESS2UNECC_HNDL))
;;;9288   	{		
;;;9289   	if(mess_data[0]==PARAM_UNECC_SET)
;;;9290   		{
;;;9291   		u_necc=mess_data[1];
;;;9292   		}		
;;;9293   	}
;;;9294   
;;;9295   
;;;9296   else if(b1Hz_unh)
;;;9297   	{
;;;9298   	b1Hz_unh=0;
;;;9299   
;;;9300   	if(BAT_TYPE==4)
;;;9301   		{
;;;9302   		u_necc=U0B;
;;;9303   		
;;;9304   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;9305   			{
;;;9306   			u_necc=UVZ;
;;;9307   			}
;;;9308   
;;;9309   		gran(&DU_LI_BAT,1,30);
;;;9310   
;;;9311   
;;;9312   		if(lakbNotErrorNum==0)
;;;9313   			{
;;;9314   			u_necc=U0B;
;;;9315   			}
;;;9316   		else 
;;;9317   			{
;;;9318   			signed short i;
;;;9319   			//signed short u_necc_max;
;;;9320   			//u_necc_max=0;
;;;9321   			char soc_flag=0;
;;;9322   
;;;9323   			for(i=(NUMBAT_TELECORE-1);i>=0;i--)
;;;9324   				{
;;;9325   				if(lakb[i]._communicationFullErrorStat==0)u_necc=lakb[i]._tot_bat_volt+DU_LI_BAT;
;;;9326   				if(lakb[i]._s_o_c_percent<QSODERG_LI_BAT)soc_flag=1;
;;;9327   				}
;;;9328   
;;;9329   			if(soc_flag==0)u_necc=USODERG_LI_BAT;
;;;9330   			}
;;;9331   
;;;9332   		u_necc=512;
;;;9333   		gran(&u_necc,0,UB0);
;;;9334   		//gran(&u_necc,0,UB20);
;;;9335   		gran(&u_necc,0,540);
;;;9336   		}
;;;9337   	}
;;;9338   
;;;9339   #endif //UKU_FSO
;;;9340   
;;;9341   
;;;9342   if((speedChIsOn)||(sp_ch_stat==scsWRK))
;;;9343   	{
;;;9344   	u_necc=speedChrgVolt;
;;;9345   	}
;;;9346   #endif//gran(&u_necc,400,UMAX);
;;;9347   
;;;9348   
;;;9349   
;;;9350   temp_L=(signed long) u_necc;
005cae  f9b40000          LDRSH    r0,[r4,#0]  ; u_necc
;;;9351   temp_L*=98L;
005cb2  f04f0162          MOV      r1,#0x62
005cb6  fb00f101          MUL      r1,r0,r1
;;;9352   temp_L/=100L;
005cba  f04f0264          MOV      r2,#0x64
005cbe  fb91f1f2          SDIV     r1,r1,r2
;;;9353   u_necc_dn=(signed short)temp_L;
005cc2  4bb8              LDR      r3,|L1.24484|
005cc4  8019              STRH     r1,[r3,#0]
;;;9354   
;;;9355   temp_L=(signed long) u_necc;
;;;9356   temp_L*=102L;
005cc6  f04f0166          MOV      r1,#0x66
005cca  fb00f001          MUL      r0,r0,r1
;;;9357   temp_L/=100L;
005cce  fb90f0f2          SDIV     r0,r0,r2
;;;9358   u_necc_up=(signed short)temp_L;
005cd2  49b5              LDR      r1,|L1.24488|
005cd4  8008              STRH     r0,[r1,#0]
;;;9359   /*
;;;9360   #ifdef IPS_SGEP_GAZPROM
;;;9361   u_necc=248;
;;;9362   #endif */
;;;9363   }
005cd6  bdf8              POP      {r3-r7,pc}
;;;9364   
                          ENDP

                  num_necc_hndl PROC
;;;9366   //-----------------------------------------------
;;;9367   void num_necc_hndl(void)
005cd8  e92d41f0          PUSH     {r4-r8,lr}
;;;9368   {
;;;9369   
;;;9370   static short num_necc_block_cnt;
;;;9371   if(num_necc_block_cnt) num_necc_block_cnt--;
005cdc  4ca0              LDR      r4,|L1.24416|
005cde  f9b40038          LDRSH    r0,[r4,#0x38]  ; num_necc_block_cnt
005ce2  b110              CBZ      r0,|L1.23786|
005ce4  f1a00001          SUB      r0,r0,#1
005ce8  8720              STRH     r0,[r4,#0x38]
                  |L1.23786|
;;;9372   
;;;9373   Isumm_=Isumm;
005cea  48b0              LDR      r0,|L1.24492|
005cec  4db0              LDR      r5,|L1.24496|
005cee  8800              LDRH     r0,[r0,#0]  ; Isumm
005cf0  8028              STRH     r0,[r5,#0]
;;;9374   
;;;9375   if(bat[0]._Ib<0) Isumm_+=(abs(bat[0]._Ib))/10;
005cf2  4eb0              LDR      r6,|L1.24500|
005cf4  270a              MOVS     r7,#0xa
005cf6  f9b60008          LDRSH    r0,[r6,#8]  ; bat
005cfa  2800              CMP      r0,#0
005cfc  da06              BGE      |L1.23820|
005cfe  f7fffffe          BL       abs
005d02  fb90f0f7          SDIV     r0,r0,r7
005d06  8829              LDRH     r1,[r5,#0]  ; Isumm_
005d08  4408              ADD      r0,r0,r1
005d0a  8028              STRH     r0,[r5,#0]
                  |L1.23820|
;;;9376   if(bat[1]._Ib<0) Isumm_+=(abs(bat[1]._Ib))/10;
005d0c  f9b60054          LDRSH    r0,[r6,#0x54]  ; bat
005d10  2800              CMP      r0,#0
005d12  da06              BGE      |L1.23842|
005d14  f7fffffe          BL       abs
005d18  fb90f0f7          SDIV     r0,r0,r7
005d1c  8829              LDRH     r1,[r5,#0]  ; Isumm_
005d1e  4408              ADD      r0,r0,r1
005d20  8028              STRH     r0,[r5,#0]
                  |L1.23842|
;;;9377   
;;;9378   num_necc_up=(Isumm_/((signed short)IMAX))+1;
005d22  49a5              LDR      r1,|L1.24504|
005d24  f9b50000          LDRSH    r0,[r5,#0]  ; Isumm_
005d28  f9b11000          LDRSH    r1,[r1,#0]  ; IMAX
005d2c  fb90f1f1          SDIV     r1,r0,r1
005d30  f1010101          ADD      r1,r1,#1
005d34  b2c9              UXTB     r1,r1
005d36  77e1              STRB     r1,[r4,#0x1f]
;;;9379   ////Isumm_+=(signed short)((IMAX*(10-KIMAX))/10);
;;;9380   ////Isumm_+=(signed short)(IMAX-IMIN);
;;;9381   
;;;9382   num_necc_down=(Isumm_/((signed short)IMIN))+1;
005d38  4aa0              LDR      r2,|L1.24508|
005d3a  f9b22000          LDRSH    r2,[r2,#0]  ; IMIN
005d3e  fb90f0f2          SDIV     r0,r0,r2
005d42  f1000001          ADD      r0,r0,#1
005d46  b2c2              UXTB     r2,r0
005d48  f8842020          STRB     r2,[r4,#0x20]
;;;9383   
;;;9384   if(num_necc_up>num_necc)
005d4c  489c              LDR      r0,|L1.24512|
;;;9385   	{
;;;9386   	num_necc=num_necc_up;
;;;9387   	num_necc_block_cnt=60;
005d4e  f04f053c          MOV      r5,#0x3c
005d52  f9b03000          LDRSH    r3,[r0,#0]            ;9384  ; num_necc
005d56  4299              CMP      r1,r3                 ;9384
005d58  dd02              BLE      |L1.23904|
005d5a  8001              STRH     r1,[r0,#0]            ;9386
005d5c  8725              STRH     r5,[r4,#0x38]
005d5e  e005              B        |L1.23916|
                  |L1.23904|
;;;9388   	}
;;;9389   else if(num_necc_down<num_necc)
005d60  429a              CMP      r2,r3
005d62  da03              BGE      |L1.23916|
;;;9390   	{
;;;9391   	if(!num_necc_block_cnt)
005d64  8f21              LDRH     r1,[r4,#0x38]  ; num_necc_block_cnt
005d66  b909              CBNZ     r1,|L1.23916|
;;;9392   		{
;;;9393   		num_necc=num_necc_down;
005d68  8002              STRH     r2,[r0,#0]
;;;9394   		num_necc_block_cnt=60;
005d6a  8725              STRH     r5,[r4,#0x38]
                  |L1.23916|
;;;9395   		}
;;;9396   	}
;;;9397   
;;;9398   if(PAR) num_necc=NUMIST;
005d6c  4995              LDR      r1,|L1.24516|
005d6e  880a              LDRH     r2,[r1,#0]  ; PAR
005d70  4974              LDR      r1,|L1.24388|
005d72  b10a              CBZ      r2,|L1.23928|
005d74  880a              LDRH     r2,[r1,#0]  ; NUMIST
005d76  8002              STRH     r2,[r0,#0]
                  |L1.23928|
;;;9399   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;9400   if(bPARALLEL) num_necc=NUMIST;
005d78  f894202d          LDRB     r2,[r4,#0x2d]  ; bPARALLEL
005d7c  b10a              CBZ      r2,|L1.23938|
005d7e  880a              LDRH     r2,[r1,#0]  ; NUMIST
005d80  8002              STRH     r2,[r0,#0]
                  |L1.23938|
;;;9401   if(vz1_stat==vz1sWRK)num_necc=NUMIST; //Включаем все источники если уравнительный заряд
005d82  7962              LDRB     r2,[r4,#5]  ; vz1_stat
005d84  2a0a              CMP      r2,#0xa
005d86  d101              BNE      |L1.23948|
005d88  880a              LDRH     r2,[r1,#0]  ; NUMIST
005d8a  8002              STRH     r2,[r0,#0]
                  |L1.23948|
;;;9402   if((vz2_stat==vz2sWRK1)||(vz2_stat==vz2sWRK2))num_necc=NUMIST; //Включаем все источники если уравнительный заряд
005d8c  79e2              LDRB     r2,[r4,#7]  ; vz2_stat
005d8e  2a0a              CMP      r2,#0xa
005d90  d001              BEQ      |L1.23958|
005d92  2a0b              CMP      r2,#0xb
005d94  d101              BNE      |L1.23962|
                  |L1.23958|
005d96  880a              LDRH     r2,[r1,#0]  ; NUMIST
005d98  8002              STRH     r2,[r0,#0]
                  |L1.23962|
;;;9403   #endif
;;;9404   
;;;9405   gran(&num_necc,1,NUMIST);
005d9a  f9b12000          LDRSH    r2,[r1,#0]  ; NUMIST
005d9e  e8bd41f0          POP      {r4-r8,lr}
005da2  2101              MOVS     r1,#1
005da4  4886              LDR      r0,|L1.24512|
005da6  f7ffbffe          B.W      gran
;;;9406   
;;;9407   }
;;;9408   
                          ENDP

                  ext_drv PROC
;;;10537  //-----------------------------------------------
;;;10538  void ext_drv(void)
005daa  e92d5ff0          PUSH     {r4-r12,lr}
;;;10539  {
;;;10540  char i;
;;;10541  
;;;10542  #ifdef UKU_FSO
;;;10543  NUMSK=3;
;;;10544  #endif
;;;10545  
;;;10546  for(i=0;i<NUMSK;i++)
005dae  f04f0000          MOV      r0,#0
005db2  4a86              LDR      r2,|L1.24524|
;;;10547  	{
;;;10548  	#ifdef UKU_MGTS
;;;10549  	if(adc_buff_[sk_buff_RSTKM[i]]<2000)
;;;10550  	#endif
;;;10551  	#ifdef UKU_RSTKM
;;;10552  	if(adc_buff_[sk_buff_RSTKM[i]]<2000)
;;;10553  	#endif
;;;10554  	#ifdef UKU_3U
;;;10555  	if(adc_buff_[sk_buff_3U[i]]<2000)
;;;10556  	#endif
;;;10557  	#ifdef UKU_GLONASS
;;;10558  	if(adc_buff_[sk_buff_GLONASS[i]]<2000)
;;;10559  	#endif
;;;10560  	#ifdef UKU_KONTUR
;;;10561  	if(adc_buff_[sk_buff_KONTUR[i]]<2000)
;;;10562  	#endif
;;;10563  	#ifdef UKU_6U
;;;10564  	if(adc_buff_[sk_buff_6U[i]]<2000)
;;;10565  	#endif
;;;10566  	#ifdef UKU_220
;;;10567  	if(adc_buff_[sk_buff_220[i]]<2000)
;;;10568  	#endif
;;;10569  	#ifdef UKU_220_V2
;;;10570  	if(adc_buff_[sk_buff_220[i]]<2000)
;;;10571  	#endif
;;;10572  	#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;10573  	if(adc_buff_[sk_buff_220[i]]<2000)
;;;10574  	#endif
;;;10575  	#ifdef UKU_TELECORE2015	
;;;10576  	if(adc_buff_[sk_buff_TELECORE2015[i]]<2000)	 //TODO
;;;10577  	#endif
;;;10578  	#ifdef UKU_TELECORE2017
;;;10579  	if(adc_buff_[sk_buff_TELECORE2015[i]]<2000)	 //TODO
;;;10580  	#endif
;;;10581  	#ifdef IPS_SGEP_GAZPROM
;;;10582  	if(adc_buff_[sk_buff_6U[i]]<2000)
;;;10583  	#endif		
;;;10584   	#ifdef UKU_FSO
;;;10585  	if(adc_buff_[sk_buff_6U[i]]<2000)
;;;10586  	#endif	
;;;10587  		{
;;;10588  		if(sk_cnt[i]<10)
005db4  4b84              LDR      r3,|L1.24520|
;;;10589  			{
;;;10590  			sk_cnt[i]++;
;;;10591  			if(sk_cnt[i]>=10)
;;;10592  				{
;;;10593  				sk_stat[i]=ssON;
005db6  4d70              LDR      r5,|L1.24440|
005db8  f04f0a01          MOV      r10,#1
;;;10594  				}
;;;10595  			}
;;;10596  		else 
;;;10597  			{
;;;10598  			sk_cnt[i]=10;
005dbc  f04f0b0a          MOV      r11,#0xa
005dc0  4606              MOV      r6,r0                 ;10546
005dc2  f9b24000          LDRSH    r4,[r2,#0]            ;10546
005dc6  e025              B        |L1.24084|
                  |L1.24008|
005dc8  4981              LDR      r1,|L1.24528|
005dca  4f82              LDR      r7,|L1.24532|
005dcc  5c09              LDRB     r1,[r1,r0]            ;10573
005dce  f9371011          LDRSH    r1,[r7,r1,LSL #1]     ;10573
005dd2  f5b16ffa          CMP      r1,#0x7d0             ;10573
005dd6  da0e              BGE      |L1.24054|
005dd8  5619              LDRSB    r1,[r3,r0]            ;10588
005dda  290a              CMP      r1,#0xa               ;10588
005ddc  da08              BGE      |L1.24048|
005dde  f1010101          ADD      r1,r1,#1              ;10590
005de2  b249              SXTB     r1,r1                 ;10590
005de4  5419              STRB     r1,[r3,r0]            ;10590
005de6  290a              CMP      r1,#0xa               ;10591
005de8  db11              BLT      |L1.24078|
005dea  f805a000          STRB     r10,[r5,r0]           ;10593
005dee  e00e              B        |L1.24078|
                  |L1.24048|
005df0  f803b000          STRB     r11,[r3,r0]
005df4  e00b              B        |L1.24078|
                  |L1.24054|
;;;10599  			}
;;;10600                 
;;;10601  		}
;;;10602  	else
;;;10603  		{
;;;10604  		if(sk_cnt[i]>0)
005df6  5619              LDRSB    r1,[r3,r0]
005df8  2900              CMP      r1,#0
005dfa  dd07              BLE      |L1.24076|
;;;10605  			{
;;;10606  			sk_cnt[i]--;
005dfc  f1a10101          SUB      r1,r1,#1
005e00  b249              SXTB     r1,r1
005e02  5419              STRB     r1,[r3,r0]
;;;10607  			if(sk_cnt[i]<=0)
005e04  2900              CMP      r1,#0
005e06  dc02              BGT      |L1.24078|
;;;10608  				{
;;;10609  				sk_stat[i]=ssOFF;
005e08  542e              STRB     r6,[r5,r0]
005e0a  e000              B        |L1.24078|
                  |L1.24076|
;;;10610  				}
;;;10611  			}
;;;10612  		else 
;;;10613  			{
;;;10614  			sk_cnt[i]=0;
005e0c  541e              STRB     r6,[r3,r0]
                  |L1.24078|
005e0e  f1000001          ADD      r0,r0,#1              ;10546
005e12  b2c0              UXTB     r0,r0                 ;10546
                  |L1.24084|
005e14  42a0              CMP      r0,r4                 ;10546
005e16  dbd7              BLT      |L1.24008|
;;;10615  			}
;;;10616  		}
;;;10617  	}
;;;10618  
;;;10619  for(i=0;i<NUMSK;i++)
005e18  f04f0400          MOV      r4,#0
;;;10620  	{
;;;10621  	if(((SK_SIGN[i]==0)&&(sk_stat[i]==ssON))||((SK_SIGN[i])&&(sk_stat[i]==ssOFF)) )
;;;10622  		{
;;;10623  		if(sk_av_cnt[i]<10)
005e1c  f8df91b8          LDR      r9,|L1.24536|
;;;10624  			{
;;;10625  			sk_av_cnt[i]++;
;;;10626  			if(sk_av_cnt[i]>=10)
;;;10627  				{
;;;10628  				sk_av_stat[i]=sasON;
005e20  4f6e              LDR      r7,|L1.24540|
;;;10629  				}
;;;10630  			}
;;;10631  		else 
;;;10632  			{
;;;10633  			sk_av_cnt[i]=10;
;;;10634  			}
;;;10635  		}
;;;10636  	else
;;;10637  		{
;;;10638  		if(sk_av_cnt[i]>=0)
;;;10639  			{
;;;10640  			sk_av_cnt[i]--;
;;;10641  			if(sk_av_cnt[i]<=0)
;;;10642  				{
;;;10643  				sk_av_stat[i]=sasOFF;
;;;10644  				}
;;;10645  			}
;;;10646  		else 
;;;10647  			{
;;;10648  			sk_av_cnt[i]=0;
;;;10649  			}
;;;10650  		}
;;;10651  
;;;10652  #ifndef UKU_KONTUR
;;;10653  	if(sk_av_stat_old[i]!=sk_av_stat[i])
005e22  f8df81bc          LDR      r8,|L1.24544|
005e26  e083              B        |L1.24368|
                  |L1.24104|
005e28  486e              LDR      r0,|L1.24548|
005e2a  f9300014          LDRSH    r0,[r0,r4,LSL #1]     ;10621
005e2e  b910              CBNZ     r0,|L1.24118|
005e30  5d29              LDRB     r1,[r5,r4]            ;10621
005e32  2901              CMP      r1,#1                 ;10621
005e34  d00f              BEQ      |L1.24150|
                  |L1.24118|
005e36  b108              CBZ      r0,|L1.24124|
005e38  5d28              LDRB     r0,[r5,r4]            ;10621
005e3a  b160              CBZ      r0,|L1.24150|
                  |L1.24124|
005e3c  f9190004          LDRSB    r0,[r9,r4]            ;10638
005e40  2800              CMP      r0,#0                 ;10638
005e42  db19              BLT      |L1.24184|
005e44  f1a00001          SUB      r0,r0,#1              ;10640
005e48  b240              SXTB     r0,r0                 ;10640
005e4a  f8090004          STRB     r0,[r9,r4]            ;10640
005e4e  2800              CMP      r0,#0                 ;10641
005e50  dc14              BGT      |L1.24188|
005e52  553e              STRB     r6,[r7,r4]            ;10643
005e54  e012              B        |L1.24188|
                  |L1.24150|
005e56  f9190004          LDRSB    r0,[r9,r4]            ;10623
005e5a  280a              CMP      r0,#0xa               ;10623
005e5c  da09              BGE      |L1.24178|
005e5e  f1000001          ADD      r0,r0,#1              ;10625
005e62  b240              SXTB     r0,r0                 ;10625
005e64  f8090004          STRB     r0,[r9,r4]            ;10625
005e68  280a              CMP      r0,#0xa               ;10626
005e6a  db07              BLT      |L1.24188|
005e6c  f807a004          STRB     r10,[r7,r4]           ;10628
005e70  e004              B        |L1.24188|
                  |L1.24178|
005e72  f809b004          STRB     r11,[r9,r4]           ;10633
005e76  e001              B        |L1.24188|
                  |L1.24184|
005e78  f8096004          STRB     r6,[r9,r4]            ;10648
                  |L1.24188|
005e7c  f8181004          LDRB     r1,[r8,r4]
005e80  5d38              LDRB     r0,[r7,r4]
005e82  4281              CMP      r1,r0
005e84  d04e              BEQ      |L1.24356|
;;;10654  		{
;;;10655  		plazma_sk++;
005e86  4a36              LDR      r2,|L1.24416|
005e88  3246              ADDS     r2,r2,#0x46
005e8a  8811              LDRH     r1,[r2,#0]  ; plazma_sk
005e8c  f1010101          ADD      r1,r1,#1
005e90  8011              STRH     r1,[r2,#0]
;;;10656  		if(sk_av_stat[i]==sasON)
005e92  2801              CMP      r0,#1
005e94  d007              BEQ      |L1.24230|
;;;10657  			{
;;;10658  			if(i==0)snmp_trap_send("SK #1 Alarm",15,1,1);
;;;10659  			else if(i==1)
;;;10660  				{
;;;10661  				#ifndef UKU_TELEKORE2017
;;;10662  				snmp_trap_send("SK #2 Alarm",15,2,1);
;;;10663  				#endif
;;;10664  				#ifdef UKU_TELEKORE2017
;;;10665  				snmp_trap_send("Door open",15,2,1);
;;;10666  				#endif
;;;10667  				}
;;;10668  			else if(i==2)snmp_trap_send("SK #3 Alarm",15,3,1);
;;;10669  			else if(i==3)snmp_trap_send("SK #4 Alarm",15,4,1);
;;;10670  			}
;;;10671  		else 
;;;10672  			{
;;;10673  			if(i==0)snmp_trap_send("SK #1 Alarm is off",15,1,0);
005e96  b354              CBZ      r4,|L1.24302|
;;;10674  			else if(i==1)
005e98  2c01              CMP      r4,#1
005e9a  d02f              BEQ      |L1.24316|
;;;10675  				{
;;;10676  				#ifndef UKU_TELEKORE2017
;;;10677  				snmp_trap_send("SK #2 Alarm is off",15,2,0);
;;;10678  				#endif
;;;10679  				#ifdef UKU_TELEKORE2017
;;;10680  				snmp_trap_send("Door open clear",15,2,0);
;;;10681  				#endif
;;;10682  				}
;;;10683  			else if(i==2)snmp_trap_send("SK #3 Alarm is off",15,3,0);
005e9c  2c02              CMP      r4,#2
005e9e  d034              BEQ      |L1.24330|
;;;10684  			else if(i==3)snmp_trap_send("SK #4 Alarm is off",15,4,0);
005ea0  2c03              CMP      r4,#3
005ea2  d039              BEQ      |L1.24344|
005ea4  e03e              B        |L1.24356|
                  |L1.24230|
005ea6  b134              CBZ      r4,|L1.24246|
005ea8  2c01              CMP      r4,#1                 ;10659
005eaa  d00b              BEQ      |L1.24260|
005eac  2c02              CMP      r4,#2                 ;10668
005eae  d010              BEQ      |L1.24274|
005eb0  2c03              CMP      r4,#3                 ;10669
005eb2  d015              BEQ      |L1.24288|
005eb4  e036              B        |L1.24356|
                  |L1.24246|
005eb6  2301              MOVS     r3,#1                 ;10658
005eb8  461a              MOV      r2,r3                 ;10658
005eba  210f              MOVS     r1,#0xf               ;10658
005ebc  a04a              ADR      r0,|L1.24552|
005ebe  f7fffffe          BL       snmp_trap_send
005ec2  e02f              B        |L1.24356|
                  |L1.24260|
005ec4  2301              MOVS     r3,#1                 ;10662
005ec6  2202              MOVS     r2,#2                 ;10662
005ec8  210f              MOVS     r1,#0xf               ;10662
005eca  a04a              ADR      r0,|L1.24564|
005ecc  f7fffffe          BL       snmp_trap_send
005ed0  e028              B        |L1.24356|
                  |L1.24274|
005ed2  2301              MOVS     r3,#1                 ;10668
005ed4  2203              MOVS     r2,#3                 ;10668
005ed6  210f              MOVS     r1,#0xf               ;10668
005ed8  a049              ADR      r0,|L1.24576|
005eda  f7fffffe          BL       snmp_trap_send
005ede  e021              B        |L1.24356|
                  |L1.24288|
005ee0  2301              MOVS     r3,#1                 ;10669
005ee2  2204              MOVS     r2,#4                 ;10669
005ee4  210f              MOVS     r1,#0xf               ;10669
005ee6  a049              ADR      r0,|L1.24588|
005ee8  f7fffffe          BL       snmp_trap_send
005eec  e01a              B        |L1.24356|
                  |L1.24302|
005eee  2300              MOVS     r3,#0                 ;10673
005ef0  2201              MOVS     r2,#1                 ;10673
005ef2  210f              MOVS     r1,#0xf               ;10673
005ef4  a048              ADR      r0,|L1.24600|
005ef6  f7fffffe          BL       snmp_trap_send
005efa  e013              B        |L1.24356|
                  |L1.24316|
005efc  2300              MOVS     r3,#0                 ;10677
005efe  2202              MOVS     r2,#2                 ;10677
005f00  210f              MOVS     r1,#0xf               ;10677
005f02  a04a              ADR      r0,|L1.24620|
005f04  f7fffffe          BL       snmp_trap_send
005f08  e00c              B        |L1.24356|
                  |L1.24330|
005f0a  2300              MOVS     r3,#0                 ;10683
005f0c  2203              MOVS     r2,#3                 ;10683
005f0e  210f              MOVS     r1,#0xf               ;10683
005f10  a04b              ADR      r0,|L1.24640|
005f12  f7fffffe          BL       snmp_trap_send
005f16  e005              B        |L1.24356|
                  |L1.24344|
005f18  2300              MOVS     r3,#0
005f1a  2204              MOVS     r2,#4
005f1c  210f              MOVS     r1,#0xf
005f1e  a04d              ADR      r0,|L1.24660|
005f20  f7fffffe          BL       snmp_trap_send
                  |L1.24356|
;;;10685  			}
;;;10686  	 	}
;;;10687  #endif
;;;10688  
;;;10689  #ifdef UKU_KONTUR
;;;10690  	if(sk_av_stat_old[i]!=sk_av_stat[i])
;;;10691  		{
;;;10692  		plazma_sk++;
;;;10693  		if(sk_av_stat[i]==sasON)
;;;10694  			{
;;;10695  			if(i==0)snmp_trap_send("Door is opened",15,1,1);
;;;10696  			else if(i==1)snmp_trap_send("Smoke Alarm",15,2,1);
;;;10697  			else if(i==2)snmp_trap_send("Shock Sensor Alarm",15,3,1);
;;;10698  			else if(i==3)snmp_trap_send("SK #4 Alarm",15,4,1);
;;;10699  			}
;;;10700  		else 
;;;10701  			{
;;;10702  			if(i==0)snmp_trap_send("Door is closed",15,1,0);
;;;10703  			else if(i==1)snmp_trap_send("Smoke Alarm is off",15,2,0);
;;;10704  			else if(i==2)snmp_trap_send("Shock Sensor Alarm is off",15,3,0);
;;;10705  			else if(i==3)snmp_trap_send("SK #4 Alarm is off",15,4,0);
;;;10706  			}
;;;10707  	 	}
;;;10708  #endif
;;;10709  	sk_av_stat_old[i]=sk_av_stat[i];
005f24  5d38              LDRB     r0,[r7,r4]
005f26  f8080004          STRB     r0,[r8,r4]
005f2a  f1040401          ADD      r4,r4,#1              ;10619
005f2e  b2e4              UXTB     r4,r4                 ;10619
                  |L1.24368|
005f30  4826              LDR      r0,|L1.24524|
005f32  f9b00000          LDRSH    r0,[r0,#0]            ;10619  ; NUMSK
005f36  4284              CMP      r4,r0                 ;10619
005f38  f6ffaf76          BLT      |L1.24104|
                  |L1.24380|
;;;10710  	}
;;;10711  }
005f3c  e8bd9ff0          POP      {r4-r12,pc}
                  |L1.24384|
                          DCD      bps
                  |L1.24388|
                          DCD      NUMIST
                  |L1.24392|
                          DCD      mess_data
                  |L1.24396|
                          DCD      uavt_set_result_stat
                  |L1.24400|
                          DCD      avt_plazma
                  |L1.24404|
                          DCD      TERMOKOMPENS
                  |L1.24408|
                          DCD      UB20
                  |L1.24412|
                          DCD      UVZ
                  |L1.24416|
                          DCD      ||area_number.26||
                  |L1.24420|
                          DCD      u_necc
                  |L1.24424|
                          DCD      ND_EXT
                  |L1.24428|
                          DCD      t_ext
                  |L1.24432|
                          DCD      mat_temper
                  |L1.24436|
                          DCD      UB0
                  |L1.24440|
                          DCD      sk_stat
                  |L1.24444|
                          DCD      VZ_CH_VENT_BLOK
                  |L1.24448|
                          DCD      speedChIsOn
                  |L1.24452|
                          DCD      sp_ch_stat
                  |L1.24456|
                          DCD      speedChrgVolt
                  |L1.24460|
                          DCD      hv_vz_stat
                  |L1.24464|
                          DCD      UZ_U
                  |L1.24468|
                          DCD      FZ_U1
                  |L1.24472|
                          DCD      FZ_U2
                  |L1.24476|
                          DCD      uavt_set_stat
                  |L1.24480|
                          DCD      U_AVT
                  |L1.24484|
                          DCD      u_necc_dn
                  |L1.24488|
                          DCD      u_necc_up
                  |L1.24492|
                          DCD      Isumm
                  |L1.24496|
                          DCD      Isumm_
                  |L1.24500|
                          DCD      bat
                  |L1.24504|
                          DCD      IMAX
                  |L1.24508|
                          DCD      IMIN
                  |L1.24512|
                          DCD      num_necc
                  |L1.24516|
                          DCD      PAR
                  |L1.24520|
                          DCD      sk_cnt
                  |L1.24524|
                          DCD      NUMSK
                  |L1.24528|
                          DCD      ||area_number.20||
                  |L1.24532|
                          DCD      ||.bss||+0x40c
                  |L1.24536|
                          DCD      sk_av_cnt
                  |L1.24540|
                          DCD      sk_av_stat
                  |L1.24544|
                          DCD      sk_av_stat_old
                  |L1.24548|
                          DCD      SK_SIGN
                  |L1.24552|
005fe8  534b2023          DCB      "SK #1 Alarm",0
005fec  3120416c
005ff0  61726d00
                  |L1.24564|
005ff4  534b2023          DCB      "SK #2 Alarm",0
005ff8  3220416c
005ffc  61726d00
                  |L1.24576|
006000  534b2023          DCB      "SK #3 Alarm",0
006004  3320416c
006008  61726d00
                  |L1.24588|
00600c  534b2023          DCB      "SK #4 Alarm",0
006010  3420416c
006014  61726d00
                  |L1.24600|
006018  534b2023          DCB      "SK #1 Alarm is off",0
00601c  3120416c
006020  61726d20
006024  6973206f
006028  666600  
00602b  00                DCB      0
                  |L1.24620|
00602c  534b2023          DCB      "SK #2 Alarm is off",0
006030  3220416c
006034  61726d20
006038  6973206f
00603c  666600  
00603f  00                DCB      0
                  |L1.24640|
006040  534b2023          DCB      "SK #3 Alarm is off",0
006044  3320416c
006048  61726d20
00604c  6973206f
006050  666600  
006053  00                DCB      0
                  |L1.24660|
006054  534b2023          DCB      "SK #4 Alarm is off",0
006058  3420416c
00605c  61726d20
006060  6973206f
006064  666600  
006067  00                DCB      0
                          ENDP

                  zar_superviser_start PROC
;;;10749  //-----------------------------------------------
;;;10750  void zar_superviser_start(void)
006068  f04f0001          MOV      r0,#1
;;;10751  {
;;;10752  sign_U[0]=1;
00606c  4aff              LDR      r2,|L1.25708|
00606e  7010              STRB     r0,[r2,#0]
;;;10753  sign_I[0]=1;
006070  49ff              LDR      r1,|L1.25712|
006072  7008              STRB     r0,[r1,#0]
;;;10754  sign_U[1]=1;
006074  7050              STRB     r0,[r2,#1]
;;;10755  sign_I[1]=1;
006076  7048              STRB     r0,[r1,#1]
;;;10756  
;;;10757  }
006078  4770              BX       lr
;;;10758  
                          ENDP

                  zar_superviser_drv PROC
;;;10714  //-----------------------------------------------
;;;10715  void zar_superviser_drv(void)
00607a  e92d5ff0          PUSH     {r4-r12,lr}
;;;10716  {
;;;10717  
;;;10718  if(((bat[0]._Ub>u_necc_up) || (bat[0]._Ub<u_necc_dn))&&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_U[0]=0;
00607e  48fe              LDR      r0,|L1.25720|
006080  f8df93f8          LDR      r9,|L1.25724|
006084  f8df83ec          LDR      r8,|L1.25716|
006088  f9b0c000          LDRSH    r12,[r0,#0]  ; u_necc_up
00608c  f9b90000          LDRSH    r0,[r9,#0]
006090  4cfb              LDR      r4,|L1.25728|
006092  ebc01100          RSB      r1,r0,r0,LSL #4
006096  f9b87002          LDRSH    r7,[r8,#2]  ; bat
00609a  f06f0a1d          MVN      r10,#0x1d
00609e  f06f0b95          MVN      r11,#0x95
0060a2  2500              MOVS     r5,#0
0060a4  4ef1              LDR      r6,|L1.25708|
0060a6  f9b40052          LDRSH    r0,[r4,#0x52]
0060aa  eb0a0281          ADD      r2,r10,r1,LSL #2
0060ae  eb0b0381          ADD      r3,r11,r1,LSL #2
0060b2  4567              CMP      r7,r12
0060b4  dc05              BGT      |L1.24770|
0060b6  f8dfc3cc          LDR      r12,|L1.25732|
0060ba  f9bcc000          LDRSH    r12,[r12,#0]  ; u_necc_dn
0060be  4567              CMP      r7,r12
0060c0  da04              BGE      |L1.24780|
                  |L1.24770|
0060c2  4282              CMP      r2,r0
0060c4  dd02              BLE      |L1.24780|
0060c6  4283              CMP      r3,r0
0060c8  da00              BGE      |L1.24780|
0060ca  7035              STRB     r5,[r6,#0]
                  |L1.24780|
;;;10719  
;;;10720  if(((bat[0]._Ib>(2*IKB)) || (bat[0]._Ib<(-IKB*2))) &&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_I[0]=0;
0060cc  4fee              LDR      r7,|L1.25736|
0060ce  f9b8c008          LDRSH    r12,[r8,#8]  ; bat
0060d2  f9b7e000          LDRSH    lr,[r7,#0]  ; IKB
0060d6  4fe6              LDR      r7,|L1.25712|
0060d8  ebbc0f4e          CMP      r12,lr,LSL #1
0060dc  dc04              BGT      |L1.24808|
0060de  f1ce0e00          RSB      lr,lr,#0
0060e2  ebbc0f4e          CMP      r12,lr,LSL #1
0060e6  da04              BGE      |L1.24818|
                  |L1.24808|
0060e8  4282              CMP      r2,r0
0060ea  dd02              BLE      |L1.24818|
0060ec  4283              CMP      r3,r0
0060ee  da00              BGE      |L1.24818|
0060f0  703d              STRB     r5,[r7,#0]
                  |L1.24818|
;;;10721  																 
;;;10722  if((main_kb_cnt==((TBAT*60)-10)) &&(spc_stat==spcOFF))
0060f2  f06f0209          MVN      r2,#9
0060f6  eb020181          ADD      r1,r2,r1,LSL #2
0060fa  4281              CMP      r1,r0
0060fc  d121              BNE      |L1.24898|
0060fe  f8940023          LDRB     r0,[r4,#0x23]  ; spc_stat
006102  b9f0              CBNZ     r0,|L1.24898|
;;;10723  	{
;;;10724  	if((sign_U[0]==1) && (sign_I[0]==1) && (lc640_read_int(EE_BAT1_ZAR_CNT)!=BAT_C_REAL[0]) && (NUMBAT) && (!(bat[0]._av&1)))
006104  7830              LDRB     r0,[r6,#0]  ; sign_U
006106  2801              CMP      r0,#1
006108  d11b              BNE      |L1.24898|
00610a  7838              LDRB     r0,[r7,#0]  ; sign_I
00610c  2801              CMP      r0,#1
00610e  d118              BNE      |L1.24898|
006110  f44f70ef          MOV      r0,#0x1de
006114  f7fffffe          BL       lc640_read_int
006118  49dc              LDR      r1,|L1.25740|
00611a  f9b11000          LDRSH    r1,[r1,#0]  ; BAT_C_REAL
00611e  4288              CMP      r0,r1
006120  d00f              BEQ      |L1.24898|
006122  48db              LDR      r0,|L1.25744|
006124  8800              LDRH     r0,[r0,#0]  ; NUMBAT
006126  b160              CBZ      r0,|L1.24898|
006128  f898003d          LDRB     r0,[r8,#0x3d]  ; bat
00612c  07c0              LSLS     r0,r0,#31
00612e  d108              BNE      |L1.24898|
;;;10725  		{
;;;10726  		lc640_write_int(EE_BAT1_ZAR_CNT,BAT_C_REAL[0]);
006130  f44f70ef          MOV      r0,#0x1de
006134  f7fffffe          BL       lc640_write_int
;;;10727  		superviser_cnt++;
006138  48d6              LDR      r0,|L1.25748|
00613a  7801              LDRB     r1,[r0,#0]  ; superviser_cnt
00613c  f1010101          ADD      r1,r1,#1
006140  7001              STRB     r1,[r0,#0]
                  |L1.24898|
;;;10728  		}
;;;10729  	
;;;10730  	}
;;;10731  
;;;10732  if(((bat[0]._Ub>u_necc_up) || (bat[1]._Ub<u_necc_dn))&&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_U[1]=0;
006142  48cd              LDR      r0,|L1.25720|
006144  f9b81002          LDRSH    r1,[r8,#2]  ; bat
006148  f9b00000          LDRSH    r0,[r0,#0]  ; u_necc_up
00614c  4281              CMP      r1,r0
00614e  dc06              BGT      |L1.24926|
006150  48cc              LDR      r0,|L1.25732|
006152  f9b8104e          LDRSH    r1,[r8,#0x4e]  ; bat
006156  f9b00000          LDRSH    r0,[r0,#0]  ; u_necc_dn
00615a  4281              CMP      r1,r0
00615c  da0e              BGE      |L1.24956|
                  |L1.24926|
00615e  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
006162  f9b41052          LDRSH    r1,[r4,#0x52]  ; main_kb_cnt
006166  ebc01000          RSB      r0,r0,r0,LSL #4
00616a  eb0a0280          ADD      r2,r10,r0,LSL #2
00616e  428a              CMP      r2,r1
006170  dd04              BLE      |L1.24956|
006172  eb0b0080          ADD      r0,r11,r0,LSL #2
006176  4288              CMP      r0,r1
006178  da00              BGE      |L1.24956|
00617a  7075              STRB     r5,[r6,#1]
                  |L1.24956|
;;;10733  
;;;10734  if(((bat[1]._Ib>(2*IKB)) || (bat[1]._Ib<(-IKB*2))) &&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_I[1]=0;
00617c  49c2              LDR      r1,|L1.25736|
00617e  f9b80054          LDRSH    r0,[r8,#0x54]  ; bat
006182  f9b11000          LDRSH    r1,[r1,#0]  ; IKB
006186  ebb00f41          CMP      r0,r1,LSL #1
00618a  dc03              BGT      |L1.24980|
00618c  4249              RSBS     r1,r1,#0
00618e  ebb00f41          CMP      r0,r1,LSL #1
006192  da0e              BGE      |L1.25010|
                  |L1.24980|
006194  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
006198  f9b41052          LDRSH    r1,[r4,#0x52]  ; main_kb_cnt
00619c  ebc01000          RSB      r0,r0,r0,LSL #4
0061a0  eb0a0280          ADD      r2,r10,r0,LSL #2
0061a4  428a              CMP      r2,r1
0061a6  dd04              BLE      |L1.25010|
0061a8  eb0b0080          ADD      r0,r11,r0,LSL #2
0061ac  4288              CMP      r0,r1
0061ae  da00              BGE      |L1.25010|
0061b0  707d              STRB     r5,[r7,#1]
                  |L1.25010|
;;;10735  																 
;;;10736  if((main_kb_cnt==((TBAT*60)-10)) &&(spc_stat==spcOFF))
0061b2  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
0061b6  ebc01100          RSB      r1,r0,r0,LSL #4
0061ba  f06f0009          MVN      r0,#9
0061be  eb000081          ADD      r0,r0,r1,LSL #2
0061c2  f9b41052          LDRSH    r1,[r4,#0x52]  ; main_kb_cnt
0061c6  4288              CMP      r0,r1
0061c8  d122              BNE      |L1.25104|
0061ca  f8940023          LDRB     r0,[r4,#0x23]  ; spc_stat
0061ce  b9f8              CBNZ     r0,|L1.25104|
;;;10737  	{
;;;10738  	if((sign_U[1]==1) && (sign_I[1]==1) && (lc640_read_int(EE_BAT2_ZAR_CNT)!=BAT_C_REAL[1]) && (NUMBAT==2) && (!(bat[1]._av&1)))
0061d0  7870              LDRB     r0,[r6,#1]  ; sign_U
0061d2  2801              CMP      r0,#1
0061d4  d11c              BNE      |L1.25104|
0061d6  7878              LDRB     r0,[r7,#1]  ; sign_I
0061d8  2801              CMP      r0,#1
0061da  d119              BNE      |L1.25104|
0061dc  f44f75fe          MOV      r5,#0x1fc
0061e0  4628              MOV      r0,r5
0061e2  f7fffffe          BL       lc640_read_int
0061e6  49a9              LDR      r1,|L1.25740|
0061e8  f9b11002          LDRSH    r1,[r1,#2]  ; BAT_C_REAL
0061ec  4288              CMP      r0,r1
0061ee  d00f              BEQ      |L1.25104|
0061f0  48a7              LDR      r0,|L1.25744|
0061f2  8800              LDRH     r0,[r0,#0]  ; NUMBAT
0061f4  2802              CMP      r0,#2
0061f6  d10b              BNE      |L1.25104|
0061f8  f8980089          LDRB     r0,[r8,#0x89]  ; bat
0061fc  07c0              LSLS     r0,r0,#31
0061fe  d107              BNE      |L1.25104|
;;;10739  		{
;;;10740  		lc640_write_int(EE_BAT2_ZAR_CNT,BAT_C_REAL[1]);
006200  4628              MOV      r0,r5
006202  f7fffffe          BL       lc640_write_int
;;;10741  		superviser_cnt++;
006206  48a3              LDR      r0,|L1.25748|
006208  7801              LDRB     r1,[r0,#0]  ; superviser_cnt
00620a  f1010101          ADD      r1,r1,#1
00620e  7001              STRB     r1,[r0,#0]
                  |L1.25104|
;;;10742  		}
;;;10743  	
;;;10744  	}
;;;10745  
;;;10746  if(main_kb_cnt==((TBAT*60)-2)) zar_superviser_start();
006210  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
006214  f06f0101          MVN      r1,#1
006218  ebc01000          RSB      r0,r0,r0,LSL #4
00621c  eb010080          ADD      r0,r1,r0,LSL #2
006220  f9b41052          LDRSH    r1,[r4,#0x52]  ; main_kb_cnt
006224  4288              CMP      r0,r1
006226  d102              BNE      |L1.25134|
006228  e8bd5ff0          POP      {r4-r12,lr}
00622c  e7fe              B        zar_superviser_start
                  |L1.25134|
;;;10747  }
00622e  e685              B        |L1.24380|
;;;10748  
                          ENDP

                  npn_hndl PROC
;;;10759  //-----------------------------------------------
;;;10760  void npn_hndl(void)
006230  e92d03f0          PUSH     {r4-r9}
;;;10761  {
;;;10762  if(NPN_OUT!=npnoOFF)
006234  4898              LDR      r0,|L1.25752|
;;;10763  	{
;;;10764  /*	if(NPN_SIGN==npnsAVNET)
;;;10765  		{
;;;10766  		if(net_av==1)
;;;10767  			{
;;;10768  			if(npn_tz_cnt<TZNPN)
;;;10769  				{
;;;10770  				npn_tz_cnt++;
;;;10771  				if(npn_tz_cnt==TZNPN)
;;;10772  					{
;;;10773  					npn_stat=npnsOFF;
;;;10774  					}
;;;10775  				}
;;;10776  			}
;;;10777  		else
;;;10778  			{
;;;10779  			if(npn_tz_cnt)
;;;10780  				{
;;;10781  				npn_tz_cnt--;
;;;10782  				if(npn_tz_cnt==0)
;;;10783  					{
;;;10784  					npn_stat=npnsON;
;;;10785  					}
;;;10786  				}
;;;10787  			}
;;;10788  		}*/
;;;10789  /*	if(NPN_SIGN==npnsULOAD)
;;;10790  		{
;;;10791  		if(load_U<UONPN)
;;;10792  			{
;;;10793  			if(npn_tz_cnt<TZNPN)
;;;10794  				{
;;;10795  				npn_tz_cnt++;
;;;10796  				if(npn_tz_cnt==TZNPN)
;;;10797  					{
;;;10798  					npn_stat=npnsOFF;
;;;10799  					}
;;;10800  				}
;;;10801  			}
;;;10802  		else if(load_U>UVNPN)
;;;10803  			{
;;;10804  			if(npn_tz_cnt)
;;;10805  				{
;;;10806  				npn_tz_cnt--;
;;;10807  				if(npn_tz_cnt==0)
;;;10808  					{
;;;10809  					npn_stat=npnsON;
;;;10810  					}
;;;10811  				}
;;;10812  			}
;;;10813  		}*/
;;;10814  
;;;10815  	if((load_U<UONPN)&&((net_Ua<UMN)||(net_Ub<UMN)||(net_Uc<UMN)))
;;;10816  		{
;;;10817  		if(npn_tz_cnt<TZNPN)
006236  4f99              LDR      r7,|L1.25756|
;;;10818  			{
;;;10819  			npn_tz_cnt++;
;;;10820  			if(npn_tz_cnt==TZNPN)
;;;10821  				{
;;;10822  				npn_stat=npnsOFF;
006238  4e99              LDR      r6,|L1.25760|
00623a  7800              LDRB     r0,[r0,#0]            ;10762  ; NPN_OUT
00623c  f04f0c00          MOV      r12,#0                ;10762
;;;10823  				}
;;;10824  			}
;;;10825  		}
;;;10826  	else if((load_U>UVNPN)&&(net_Ua>UMN)&&(net_Ub>UMN)&&(net_Uc>UMN))
;;;10827  		{
;;;10828  		if(npn_tz_cnt)
;;;10829  			{
;;;10830  			npn_tz_cnt--;
;;;10831  			if(npn_tz_cnt==0)
;;;10832  				{
;;;10833  				npn_stat=npnsON;
006240  f04f0801          MOV      r8,#1
006244  b3e8              CBZ      r0,|L1.25282|
006246  4897              LDR      r0,|L1.25764|
006248  4639              MOV      r1,r7                 ;10817
00624a  f9b05000          LDRSH    r5,[r0,#0]            ;10815  ; load_U
00624e  4896              LDR      r0,|L1.25768|
006250  f9b11000          LDRSH    r1,[r1,#0]            ;10817
006254  f9b09000          LDRSH    r9,[r0,#0]            ;10815  ; UONPN
006258  4894              LDR      r0,|L1.25772|
00625a  454d              CMP      r5,r9                 ;10815
00625c  f9b02000          LDRSH    r2,[r0,#0]            ;10815
006260  4893              LDR      r0,|L1.25776|
006262  f9b03000          LDRSH    r3,[r0,#0]            ;10815
006266  4893              LDR      r0,|L1.25780|
006268  f9b04000          LDRSH    r4,[r0,#0]            ;10815
00626c  4892              LDR      r0,|L1.25784|
00626e  f9b00000          LDRSH    r0,[r0,#0]            ;10815
006272  da13              BGE      |L1.25244|
006274  4282              CMP      r2,r0                 ;10815
006276  db03              BLT      |L1.25216|
006278  4283              CMP      r3,r0                 ;10815
00627a  db01              BLT      |L1.25216|
00627c  4284              CMP      r4,r0                 ;10815
00627e  da0d              BGE      |L1.25244|
                  |L1.25216|
006280  488e              LDR      r0,|L1.25788|
006282  f9b02000          LDRSH    r2,[r0,#0]            ;10817  ; TZNPN
006286  4291              CMP      r1,r2                 ;10817
006288  da23              BGE      |L1.25298|
00628a  f1010101          ADD      r1,r1,#1              ;10819
00628e  b208              SXTH     r0,r1                 ;10819
006290  8038              STRH     r0,[r7,#0]            ;10819
006292  4290              CMP      r0,r2                 ;10820
006294  d11d              BNE      |L1.25298|
006296  f886c000          STRB     r12,[r6,#0]           ;10822
00629a  e01a              B        |L1.25298|
                  |L1.25244|
00629c  f8dfc220          LDR      r12,|L1.25792|
0062a0  f9bcc000          LDRSH    r12,[r12,#0]          ;10826  ; UVNPN
0062a4  4565              CMP      r5,r12                ;10826
0062a6  dd14              BLE      |L1.25298|
0062a8  4282              CMP      r2,r0                 ;10826
0062aa  dd12              BLE      |L1.25298|
0062ac  4283              CMP      r3,r0                 ;10826
0062ae  dd10              BLE      |L1.25298|
0062b0  4284              CMP      r4,r0                 ;10826
0062b2  dd0e              BLE      |L1.25298|
0062b4  b169              CBZ      r1,|L1.25298|
0062b6  f1a10101          SUB      r1,r1,#1              ;10830
0062ba  b208              SXTH     r0,r1                 ;10830
0062bc  8038              STRH     r0,[r7,#0]            ;10830
0062be  b940              CBNZ     r0,|L1.25298|
0062c0  e000              B        |L1.25284|
                  |L1.25282|
0062c2  e002              B        |L1.25290|
                  |L1.25284|
0062c4  f8868000          STRB     r8,[r6,#0]
0062c8  e003              B        |L1.25298|
                  |L1.25290|
;;;10834  				}
;;;10835  			}
;;;10836  		}
;;;10837  	}
;;;10838  else
;;;10839  	{
;;;10840  	npn_tz_cnt=0;
0062ca  f8a7c000          STRH     r12,[r7,#0]
;;;10841  	npn_stat=npnsON;
0062ce  f8868000          STRB     r8,[r6,#0]
                  |L1.25298|
;;;10842  	}
;;;10843  
;;;10844  if(npn_stat==npnsOFF) mess_send(MESS2RELE_HNDL,PARAM_RELE_NPN,1,15);
0062d2  7830              LDRB     r0,[r6,#0]  ; npn_stat
0062d4  2800              CMP      r0,#0
0062d6  d107              BNE      |L1.25320|
0062d8  e8bd03f0          POP      {r4-r9}
0062dc  230f              MOVS     r3,#0xf
0062de  2201              MOVS     r2,#1
0062e0  216e              MOVS     r1,#0x6e
0062e2  20d2              MOVS     r0,#0xd2
0062e4  f7ffbffe          B.W      mess_send
                  |L1.25320|
;;;10845  
;;;10846  
;;;10847  }
0062e8  e8bd03f0          POP      {r4-r9}
0062ec  4770              BX       lr
;;;10848  
                          ENDP

                  loadoff_hndl PROC
;;;10850  //-----------------------------------------------
;;;10851  void loadoff_hndl(void)
0062ee  b5f0              PUSH     {r4-r7,lr}
;;;10852  {
;;;10853  if((load_U>UONPN)||(load_U<UVNPN))
0062f0  486c              LDR      r0,|L1.25764|
;;;10854  	{
;;;10855  	if(load_off_cnt<TZNPN)
0062f2  4d74              LDR      r5,|L1.25796|
;;;10856  		{
;;;10857  		load_off_cnt++;
;;;10858  		if(load_off_cnt>=TZNPN)
;;;10859  			{
;;;10860  			load_off_stat=npnsOFF;
0062f4  2700              MOVS     r7,#0
0062f6  f9b01000          LDRSH    r1,[r0,#0]            ;10853  ; load_U
0062fa  486b              LDR      r0,|L1.25768|
0062fc  4e72              LDR      r6,|L1.25800|
0062fe  f9b02000          LDRSH    r2,[r0,#0]            ;10853  ; UONPN
006302  f9b50000          LDRSH    r0,[r5,#0]            ;10855
006306  4291              CMP      r1,r2                 ;10853
006308  dc04              BGT      |L1.25364|
00630a  4b6d              LDR      r3,|L1.25792|
00630c  f9b33000          LDRSH    r3,[r3,#0]            ;10853  ; UVNPN
006310  4299              CMP      r1,r3                 ;10853
006312  da0d              BGE      |L1.25392|
                  |L1.25364|
006314  4969              LDR      r1,|L1.25788|
006316  f9b11000          LDRSH    r1,[r1,#0]            ;10855  ; TZNPN
00631a  4288              CMP      r0,r1                 ;10855
00631c  da1c              BGE      |L1.25432|
00631e  f1000001          ADD      r0,r0,#1              ;10857
006322  b200              SXTH     r0,r0                 ;10857
006324  8028              STRH     r0,[r5,#0]            ;10857
006326  4288              CMP      r0,r1                 ;10858
006328  db16              BLT      |L1.25432|
00632a  7037              STRB     r7,[r6,#0]
;;;10861  			load_off_cnt=TZNPN;
00632c  8029              STRH     r1,[r5,#0]
00632e  e013              B        |L1.25432|
                  |L1.25392|
;;;10862  			}
;;;10863  		}
;;;10864  	}
;;;10865  else if((load_U>(UVNPN+dUNPN))&&(load_U<(UONPN-dUNPN)))
006330  4c66              LDR      r4,|L1.25804|
006332  f9b44000          LDRSH    r4,[r4,#0]  ; dUNPN
006336  4423              ADD      r3,r3,r4
006338  428b              CMP      r3,r1
00633a  da0d              BGE      |L1.25432|
00633c  1b12              SUBS     r2,r2,r4
00633e  428a              CMP      r2,r1
006340  dd0a              BLE      |L1.25432|
;;;10866  	{
;;;10867  	if(load_off_cnt)
006342  b148              CBZ      r0,|L1.25432|
;;;10868  		{
;;;10869  		load_off_cnt--;
006344  f1a00001          SUB      r0,r0,#1
006348  b200              SXTH     r0,r0
00634a  8028              STRH     r0,[r5,#0]
;;;10870  		if(load_off_cnt<=0)
00634c  2800              CMP      r0,#0
00634e  dc03              BGT      |L1.25432|
;;;10871  			{
;;;10872  			load_off_stat=npnsON;
006350  f04f0001          MOV      r0,#1
006354  7030              STRB     r0,[r6,#0]
;;;10873  			load_off_cnt=0;
006356  802f              STRH     r7,[r5,#0]
                  |L1.25432|
;;;10874  			}
;;;10875  		}
;;;10876  	}
;;;10877  
;;;10878  
;;;10879  if(load_off_stat==npnsOFF) tloaddisable_cmnd=10;
006358  7830              LDRB     r0,[r6,#0]  ; load_off_stat
00635a  2800              CMP      r0,#0
00635c  d103              BNE      |L1.25446|
00635e  495c              LDR      r1,|L1.25808|
006360  f04f000a          MOV      r0,#0xa
006364  7008              STRB     r0,[r1,#0]
                  |L1.25446|
;;;10880  
;;;10881  
;;;10882  }
006366  bdf0              POP      {r4-r7,pc}
;;;10883  
                          ENDP

                  speedChargeStartStop PROC
;;;11071  //-----------------------------------------------
;;;11072  void speedChargeStartStop(void)
006368  b538              PUSH     {r3-r5,lr}
;;;11073  {
;;;11074  spch_plazma[1]++;
00636a  4c5a              LDR      r4,|L1.25812|
00636c  7860              LDRB     r0,[r4,#1]  ; spch_plazma
00636e  f1000001          ADD      r0,r0,#1
006372  7060              STRB     r0,[r4,#1]
;;;11075  /*if(speedChIsOn)
;;;11076  	{
;;;11077  	speedChIsOn=0;
;;;11078  	}
;;;11079  
;;;11080  else
;;;11081  	{
;;;11082  	if(speedChrgBlckStat==0)
;;;11083  		{
;;;11084  		speedChIsOn=1;
;;;11085  		speedChTimeCnt=0;
;;;11086  		}
;;;11087  	else
;;;11088  		{
;;;11089  		show_mess(	"     Ускоренный     ",
;;;11090  	          		"       заряд        ",
;;;11091  	          		"    заблокирован!   ",
;;;11092  	          		"                    ",2000);	 
;;;11093  		}
;;;11094  	}*/
;;;11095  
;;;11096  if(sp_ch_stat!=scsOFF)
006374  4858              LDR      r0,|L1.25816|
006376  7801              LDRB     r1,[r0,#0]  ; sp_ch_stat
006378  b151              CBZ      r1,|L1.25488|
;;;11097  	{
;;;11098  	sp_ch_stat=scsOFF;
00637a  f04f0100          MOV      r1,#0
00637e  7001              STRB     r1,[r0,#0]
;;;11099  	speedz_mem_hndl(10);
006380  f04f000a          MOV      r0,#0xa
006384  f7fffffe          BL       speedz_mem_hndl
;;;11100  	spch_plazma[1]=10;
006388  f04f000a          MOV      r0,#0xa
00638c  7060              STRB     r0,[r4,#1]
;;;11101  	}
;;;11102  
;;;11103  else
;;;11104  	{
;;;11105  	spch_plazma[1]=20;
;;;11106  	if((speedChrgBlckStat==0)&&(spc_stat==spcOFF)
;;;11107  		#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;11108  		&&(vz1_stat==vz1sOFF)&&(vz2_stat==vz2sOFF)
;;;11109  		#endif
;;;11110  		)
;;;11111  		{
;;;11112  		#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;11113  		sp_ch_stat=scsSTEP1;
;;;11114  		#else
;;;11115  		sp_ch_stat=scsWRK;
;;;11116  		#endif
;;;11117  		speedz_mem_hndl(1);
;;;11118  		}
;;;11119  	else 
;;;11120  		{
;;;11121  		show_mess(	"     Ускоренный     ",
;;;11122  	          		"       заряд        ",
;;;11123  	          		"    заблокирован!   ",
;;;11124  	          		"                    ",2000);
;;;11125  		}
;;;11126  	}
;;;11127  }
00638e  bd38              POP      {r3-r5,pc}
                  |L1.25488|
006390  f04f0114          MOV      r1,#0x14              ;11105
006394  7061              STRB     r1,[r4,#1]            ;11105
006396  4951              LDR      r1,|L1.25820|
006398  f9b12000          LDRSH    r2,[r1,#0]            ;11106  ; speedChrgBlckStat
00639c  4938              LDR      r1,|L1.25728|
00639e  f8913023          LDRB     r3,[r1,#0x23]         ;11106  ; spc_stat
0063a2  ea420203          ORR      r2,r2,r3              ;11106
0063a6  794b              LDRB     r3,[r1,#5]            ;11106  ; vz1_stat
0063a8  79c9              LDRB     r1,[r1,#7]            ;11106  ; vz2_stat
0063aa  ea420203          ORR      r2,r2,r3              ;11106
0063ae  430a              ORRS     r2,r2,r1              ;11106
0063b0  d009              BEQ      |L1.25542|
0063b2  f44f60fa          MOV      r0,#0x7d0             ;11121
0063b6  9000              STR      r0,[sp,#0]            ;11121
0063b8  4b49              LDR      r3,|L1.25824|
0063ba  a24a              ADR      r2,|L1.25828|
0063bc  a14f              ADR      r1,|L1.25852|
0063be  a055              ADR      r0,|L1.25876|
0063c0  f7fffffe          BL       show_mess
0063c4  bd38              POP      {r3-r5,pc}
                  |L1.25542|
0063c6  f04f0101          MOV      r1,#1                 ;11113
0063ca  7001              STRB     r1,[r0,#0]            ;11113
0063cc  e8bd4038          POP      {r3-r5,lr}            ;11117
0063d0  4608              MOV      r0,r1                 ;11117
0063d2  f7ffbffe          B.W      speedz_mem_hndl
;;;11128  
                          ENDP

                  speedChargeHndl PROC
;;;10884  //-----------------------------------------------
;;;10885  void speedChargeHndl(void)
0063d6  e92d4ff8          PUSH     {r3-r11,lr}
;;;10886  {
;;;10887  /*
;;;10888  if(sp_ch_stat==scsOFF)
;;;10889  	{
;;;10890  	if((sk_stat[1]==1)&&(sk_stat_old[1]=0))
;;;10891  	}*/
;;;10892  	 
;;;10893  if(sp_ch_stat==scsSTEP1)
0063da  4f3f              LDR      r7,|L1.25816|
;;;10894  	{
;;;10895  	if(sp_ch_stat_old!=sp_ch_stat)
0063dc  4e55              LDR      r6,|L1.25908|
;;;10896  		{
;;;10897  		sp_ch_stat_cnt=5;
;;;10898  		if(SP_CH_VENT_BLOK==0)
0063de  f8dfa14c          LDR      r10,|L1.25900|
0063e2  7839              LDRB     r1,[r7,#0]            ;10893  ; sp_ch_stat
;;;10899  			{
;;;10900  			sp_ch_stat_cnt=0;
;;;10901  			sp_ch_stat=scsWRK;
;;;10902  			}
;;;10903  		}
;;;10904  	if(sp_ch_stat_cnt)
;;;10905  		{
;;;10906  		sp_ch_stat_cnt--;
;;;10907  		if(sp_ch_stat_cnt==0)
;;;10908  			{
;;;10909  			sp_ch_stat=scsERR1; 	//Не включилась вентиляция;
;;;10910  
;;;10911  			}
;;;10912  		}
;;;10913  	if(sk_stat[0]==1)sp_ch_stat=scsWRK;
0063e4  f8df9148          LDR      r9,|L1.25904|
0063e8  7830              LDRB     r0,[r6,#0]            ;10895
0063ea  4c53              LDR      r4,|L1.25912|
0063ec  2500              MOVS     r5,#0                 ;10898
0063ee  f04f0802          MOV      r8,#2                 ;10901
0063f2  2901              CMP      r1,#1                 ;10893
0063f4  d11b              BNE      |L1.25646|
0063f6  2801              CMP      r0,#1                 ;10895
0063f8  d008              BEQ      |L1.25612|
0063fa  f04f0105          MOV      r1,#5                 ;10897
0063fe  8021              STRH     r1,[r4,#0]            ;10897
006400  f8ba1000          LDRH     r1,[r10,#0]           ;10898  ; SP_CH_VENT_BLOK
006404  b911              CBNZ     r1,|L1.25612|
006406  8025              STRH     r5,[r4,#0]            ;10900
006408  f8878000          STRB     r8,[r7,#0]            ;10901
                  |L1.25612|
00640c  f9b41000          LDRSH    r1,[r4,#0]            ;10904  ; sp_ch_stat_cnt
006410  b139              CBZ      r1,|L1.25634|
006412  f1a10101          SUB      r1,r1,#1              ;10906
006416  b209              SXTH     r1,r1                 ;10906
006418  8021              STRH     r1,[r4,#0]            ;10906
00641a  b911              CBNZ     r1,|L1.25634|
00641c  f04f0103          MOV      r1,#3                 ;10909
006420  7039              STRB     r1,[r7,#0]            ;10909
                  |L1.25634|
006422  f8991000          LDRB     r1,[r9,#0]  ; sk_stat
006426  2901              CMP      r1,#1
006428  d101              BNE      |L1.25646|
00642a  f8878000          STRB     r8,[r7,#0]
                  |L1.25646|
;;;10914  	}
;;;10915  
;;;10916  if(sp_ch_stat==scsWRK)
00642e  7839              LDRB     r1,[r7,#0]  ; sp_ch_stat
006430  2902              CMP      r1,#2
006432  d119              BNE      |L1.25704|
;;;10917  	{
;;;10918  	if(sp_ch_stat_old!=sp_ch_stat)
;;;10919  		{
;;;10920  		sp_ch_wrk_cnt=(signed long)speedChrgTimeInHour*3600L;
006434  4a41              LDR      r2,|L1.25916|
;;;10921  		hv_vz_up_cnt=0;
006436  4942              LDR      r1,|L1.25920|
006438  2802              CMP      r0,#2                 ;10918
00643a  d008              BEQ      |L1.25678|
00643c  4841              LDR      r0,|L1.25924|
00643e  f44f6361          MOV      r3,#0xe10             ;10920
006442  f9b00000          LDRSH    r0,[r0,#0]            ;10920  ; speedChrgTimeInHour
006446  fb00f003          MUL      r0,r0,r3              ;10920
00644a  6010              STR      r0,[r2,#0]            ;10920  ; sp_ch_wrk_cnt
00644c  600d              STR      r5,[r1,#0]  ; hv_vz_up_cnt
                  |L1.25678|
;;;10922  		}
;;;10923  	sp_ch_wrk_cnt--;
00644e  6810              LDR      r0,[r2,#0]  ; sp_ch_wrk_cnt
006450  f1a00001          SUB      r0,r0,#1
006454  6010              STR      r0,[r2,#0]  ; sp_ch_wrk_cnt
;;;10924  	hv_vz_up_cnt++;
006456  680a              LDR      r2,[r1,#0]  ; hv_vz_up_cnt
006458  f1020201          ADD      r2,r2,#1
00645c  600a              STR      r2,[r1,#0]  ; hv_vz_up_cnt
;;;10925  	if(sp_ch_wrk_cnt==0)
00645e  b910              CBNZ     r0,|L1.25702|
;;;10926  		{
;;;10927  		sp_ch_stat=scsOFF;
006460  703d              STRB     r5,[r7,#0]
;;;10928  		speedz_mem_hndl(0);
006462  2000              MOVS     r0,#0
006464  e070              B        |L1.25928|
                  |L1.25702|
006466  e071              B        |L1.25932|
                  |L1.25704|
006468  e07a              B        |L1.25952|
00646a  0000              DCW      0x0000
                  |L1.25708|
                          DCD      sign_U
                  |L1.25712|
                          DCD      sign_I
                  |L1.25716|
                          DCD      bat
                  |L1.25720|
                          DCD      u_necc_up
                  |L1.25724|
                          DCD      TBAT
                  |L1.25728|
                          DCD      ||area_number.26||
                  |L1.25732|
                          DCD      u_necc_dn
                  |L1.25736|
                          DCD      IKB
                  |L1.25740|
                          DCD      BAT_C_REAL
                  |L1.25744|
                          DCD      NUMBAT
                  |L1.25748|
                          DCD      superviser_cnt
                  |L1.25752|
                          DCD      NPN_OUT
                  |L1.25756|
                          DCD      npn_tz_cnt
                  |L1.25760|
                          DCD      npn_stat
                  |L1.25764|
                          DCD      load_U
                  |L1.25768|
                          DCD      UONPN
                  |L1.25772|
                          DCD      net_Ua
                  |L1.25776|
                          DCD      net_Ub
                  |L1.25780|
                          DCD      net_Uc
                  |L1.25784|
                          DCD      UMN
                  |L1.25788|
                          DCD      TZNPN
                  |L1.25792|
                          DCD      UVNPN
                  |L1.25796|
                          DCD      load_off_cnt
                  |L1.25800|
                          DCD      load_off_stat
                  |L1.25804|
                          DCD      dUNPN
                  |L1.25808|
                          DCD      tloaddisable_cmnd
                  |L1.25812|
                          DCD      spch_plazma
                  |L1.25816|
                          DCD      sp_ch_stat
                  |L1.25820|
                          DCD      speedChrgBlckStat
                  |L1.25824|
                          DCD      ||.text||+0x1d64
                  |L1.25828|
0064e4  20202020          DCB      "    ",231,224,225,235,238,234,232,240,238,226,224,237,"!"
0064e8  e7e0e1eb
0064ec  eeeae8f0
0064f0  eee2e0ed
0064f4  21      
0064f5  20202000          DCB      "   ",0
0064f9  00                DCB      0
0064fa  00                DCB      0
0064fb  00                DCB      0
                  |L1.25852|
0064fc  20202020          DCB      "       ",231,224,240,255,228,"        ",0
006500  202020e7
006504  e0f0ffe4
006508  20202020
00650c  20202020
006510  00      
006511  00                DCB      0
006512  00                DCB      0
006513  00                DCB      0
                  |L1.25876|
006514  20202020          DCB      "     ",211,241,234,238,240,229,237,237,251,233,"     ",0
006518  20d3f1ea
00651c  eef0e5ed
006520  edfbe920
006524  20202020
006528  00      
006529  00                DCB      0
00652a  00                DCB      0
00652b  00                DCB      0
                  |L1.25900|
                          DCD      SP_CH_VENT_BLOK
                  |L1.25904|
                          DCD      sk_stat
                  |L1.25908|
                          DCD      sp_ch_stat_old
                  |L1.25912|
                          DCD      sp_ch_stat_cnt
                  |L1.25916|
                          DCD      sp_ch_wrk_cnt
                  |L1.25920|
                          DCD      hv_vz_up_cnt
                  |L1.25924|
                          DCD      speedChrgTimeInHour
                  |L1.25928|
006548  f7fffffe          BL       speedz_mem_hndl
                  |L1.25932|
;;;10929  		}
;;;10930  	#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;10931  	if((sk_stat[0]==0)&&(SP_CH_VENT_BLOK==1))sp_ch_stat=scsERR2;
00654c  f8990000          LDRB     r0,[r9,#0]  ; sk_stat
006550  b930              CBNZ     r0,|L1.25952|
006552  f8ba0000          LDRH     r0,[r10,#0]  ; SP_CH_VENT_BLOK
006556  2801              CMP      r0,#1
006558  d102              BNE      |L1.25952|
00655a  f04f0004          MOV      r0,#4
00655e  7038              STRB     r0,[r7,#0]
                  |L1.25952|
;;;10932  	#endif
;;;10933  	}
;;;10934  
;;;10935  if(sp_ch_stat==scsERR1)		//Отсутствует вентиляция при включении
006560  7838              LDRB     r0,[r7,#0]  ; sp_ch_stat
;;;10936  	{
;;;10937  	if((sp_ch_stat_old!=sp_ch_stat)||(sp_ch_stat_cnt==0))
;;;10938  		{
;;;10939  		sp_ch_stat_cnt=10;
;;;10940  		}
;;;10941  	sp_ch_stat_cnt--;
;;;10942  	if((sp_ch_stat_cnt==10)||(sp_ch_stat_cnt==9))
;;;10943  		{
;;;10944  		show_mess(	"  УСКОРЕННЫЙ ЗАРЯД  ",
006562  f2413b88          MOV      r11,#0x1388
006566  f04f0a0a          MOV      r10,#0xa              ;10939
00656a  2803              CMP      r0,#3                 ;10935
00656c  d119              BNE      |L1.26018|
00656e  7830              LDRB     r0,[r6,#0]            ;10937  ; sp_ch_stat_old
006570  2803              CMP      r0,#3                 ;10937
006572  d101              BNE      |L1.25976|
006574  8820              LDRH     r0,[r4,#0]            ;10937  ; sp_ch_stat_cnt
006576  b908              CBNZ     r0,|L1.25980|
                  |L1.25976|
006578  f8a4a000          STRH     r10,[r4,#0]           ;10939
                  |L1.25980|
00657c  8820              LDRH     r0,[r4,#0]            ;10941  ; sp_ch_stat_cnt
00657e  f1a00001          SUB      r0,r0,#1              ;10941
006582  b200              SXTH     r0,r0                 ;10941
006584  8020              STRH     r0,[r4,#0]            ;10941
006586  280a              CMP      r0,#0xa               ;10942
006588  d001              BEQ      |L1.25998|
00658a  2809              CMP      r0,#9                 ;10942
00658c  d109              BNE      |L1.26018|
                  |L1.25998|
00658e  4bfd              LDR      r3,|L1.27012|
006590  a0fd              ADR      r0,|L1.27016|
006592  f1030218          ADD      r2,r3,#0x18
006596  f1020118          ADD      r1,r2,#0x18
00659a  f8cdb000          STR      r11,[sp,#0]
00659e  f7fffffe          BL       show_mess
                  |L1.26018|
;;;10945  					"   НЕ МОЖЕТ БЫТЬ    ",
;;;10946  					"      ВКЛЮЧЕН       ",
;;;10947  					"  БЕЗ ВЕНТИЛЯЦИИ!!  ",
;;;10948  					5000);
;;;10949  		}
;;;10950  	}
;;;10951  if(sp_ch_stat==scsERR2)		//Пропала вентиляция при работе
0065a2  7838              LDRB     r0,[r7,#0]  ; sp_ch_stat
0065a4  2804              CMP      r0,#4
0065a6  d11f              BNE      |L1.26088|
;;;10952  	{
;;;10953  	if((sp_ch_stat_old!=sp_ch_stat)||(sp_ch_stat_cnt==0))
0065a8  7830              LDRB     r0,[r6,#0]  ; sp_ch_stat_old
0065aa  2804              CMP      r0,#4
0065ac  d101              BNE      |L1.26034|
0065ae  8820              LDRH     r0,[r4,#0]  ; sp_ch_stat_cnt
0065b0  b908              CBNZ     r0,|L1.26038|
                  |L1.26034|
;;;10954  		{
;;;10955  		sp_ch_stat_cnt=10;
0065b2  f8a4a000          STRH     r10,[r4,#0]
                  |L1.26038|
;;;10956  		}
;;;10957  	sp_ch_stat_cnt--;
0065b6  8820              LDRH     r0,[r4,#0]  ; sp_ch_stat_cnt
0065b8  f1a00001          SUB      r0,r0,#1
0065bc  b200              SXTH     r0,r0
0065be  8020              STRH     r0,[r4,#0]
;;;10958  	if((sp_ch_stat_cnt==10)||(sp_ch_stat_cnt==9))
0065c0  280a              CMP      r0,#0xa
0065c2  d001              BEQ      |L1.26056|
0065c4  2809              CMP      r0,#9
0065c6  d109              BNE      |L1.26076|
                  |L1.26056|
;;;10959  		{
;;;10960  		show_mess(	"  УСКОРЕННЫЙ ЗАРЯД  ",
0065c8  4bf5              LDR      r3,|L1.27040|
0065ca  a0ef              ADR      r0,|L1.27016|
0065cc  f1030218          ADD      r2,r3,#0x18
0065d0  f1020118          ADD      r1,r2,#0x18
0065d4  f8cdb000          STR      r11,[sp,#0]
0065d8  f7fffffe          BL       show_mess
                  |L1.26076|
;;;10961  					"    ЗАБЛОКИРОВАН    ",
;;;10962  					"     НЕИСПРАВНА     ",
;;;10963  					"    ВЕНТИЛЯЦИЯ!!!   ",
;;;10964  					5000);
;;;10965  		}
;;;10966  	if(sk_stat[0]==1)sp_ch_stat=scsWRK;
0065dc  f8990000          LDRB     r0,[r9,#0]  ; sk_stat
0065e0  2801              CMP      r0,#1
0065e2  d101              BNE      |L1.26088|
0065e4  f8878000          STRB     r8,[r7,#0]
                  |L1.26088|
;;;10967  	}
;;;10968  
;;;10969  
;;;10970  sp_ch_stat_old=sp_ch_stat;
0065e8  7838              LDRB     r0,[r7,#0]  ; sp_ch_stat
0065ea  7030              STRB     r0,[r6,#0]
;;;10971  
;;;10972  
;;;10973  
;;;10974  if(speedChrgAvtEn==1)
0065ec  49ed              LDR      r1,|L1.27044|
;;;10975  	{
;;;10976  	if((sp_ch_stat==scsOFF)&&(spc_stat==spcOFF)
;;;10977  		#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;10978  		&&(vz1_stat==vz1sOFF)&&(vz2_stat==vz2sOFF)
;;;10979  		#endif
;;;10980  		)
;;;10981  		{
;;;10982  		if((load_U<u_necc)&&((u_necc-load_U)>speedChrgDU)
;;;10983  		#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;10984  		&&(abs(Ib_ips_termokompensat/10-IZMAX)<5)
;;;10985  		#endif
;;;10986  		#ifdef UKU_220_V2
;;;10987  		&&(abs(bat[0]._Ib/10-IZMAX)<10)
;;;10988  		#endif
;;;10989  		&&(!speedChrgBlckStat))
0065ee  4cee              LDR      r4,|L1.27048|
0065f0  8809              LDRH     r1,[r1,#0]            ;10974  ; speedChrgAvtEn
0065f2  2901              CMP      r1,#1                 ;10974
0065f4  d10a              BNE      |L1.26124|
0065f6  49ed              LDR      r1,|L1.27052|
;;;10990  			{
;;;10991  			speedChargeStartCnt++;
0065f8  4eed              LDR      r6,|L1.27056|
0065fa  f8912023          LDRB     r2,[r1,#0x23]         ;10976  ; spc_stat
0065fe  4310              ORRS     r0,r0,r2              ;10976
006600  794a              LDRB     r2,[r1,#5]            ;10976  ; vz1_stat
006602  79c9              LDRB     r1,[r1,#7]            ;10976  ; vz2_stat
006604  4310              ORRS     r0,r0,r2              ;10976
006606  4308              ORRS     r0,r0,r1              ;10976
006608  d007              BEQ      |L1.26138|
;;;10992  			if(speedChargeStartCnt>=60)
;;;10993  				{
;;;10994  				speedChargeStartStop();
;;;10995  				speedz_mem_hndl(5);
;;;10996  				}
;;;10997  			}
;;;10998  		else speedChargeStartCnt=0;
;;;10999  		}
;;;11000  	else speedChargeStartCnt=0;
00660a  7035              STRB     r5,[r6,#0]
                  |L1.26124|
;;;11001  	}
;;;11002  
;;;11003  
;;;11004  
;;;11005  /*
;;;11006  if(speedChIsOn)
;;;11007  	{
;;;11008  	speedChTimeCnt++;
;;;11009  	if(speedChTimeCnt>=((signed long)speedChrgTimeInHour*3600L))
;;;11010  		{
;;;11011  		speedChIsOn=0;
;;;11012  		}
;;;11013  	if(speedChrgBlckStat)
;;;11014  		{
;;;11015  		speedChIsOn=0;
;;;11016  		speedChTimeCnt=0;
;;;11017  		}
;;;11018  	}
;;;11019  
;;;11020  
;;;11021  
;;;11022  if(speedChrgAvtEn)
;;;11023  	{
;;;11024  	if(!speedChIsOn)
;;;11025  		{
;;;11026  		if((load_U<u_necc)&&((u_necc-load_U)>speedChrgDU)&&(abs(Ib_ips_termokompensat/10-IZMAX)<5)&&(!speedChrgBlckStat))
;;;11027  			{
;;;11028  			speedChIsOn=1;
;;;11029  			}
;;;11030  		}
;;;11031  	}
;;;11032  
;;;11033  
;;;11034  */
;;;11035  if(/*(speedChrgBlckSrc!=1)&&*/(speedChrgBlckSrc!=2)) speedChrgBlckStat=0;
00660c  48e9              LDR      r0,|L1.27060|
00660e  8800              LDRH     r0,[r0,#0]  ; speedChrgBlckSrc
006610  2802              CMP      r0,#2
006612  d02e              BEQ      |L1.26226|
006614  8025              STRH     r5,[r4,#0]
                  |L1.26134|
;;;11036  else
;;;11037  	{
;;;11038  	speedChrgBlckStat=0;
;;;11039  	if(speedChrgBlckSrc==1)
;;;11040  		{
;;;11041  		if(((speedChrgBlckLog==0)&&(adc_buff_[11]>2000)) || ((speedChrgBlckLog==1)&&(adc_buff_[11]<2000))) speedChrgBlckStat=1;
;;;11042  		}
;;;11043  	else if(speedChrgBlckSrc==2)
;;;11044  		{
;;;11045  		if(((speedChrgBlckLog==0)&&(adc_buff_[13]>2000)) || ((speedChrgBlckLog==1)&&(adc_buff_[13]<2000))) speedChrgBlckStat=1;
;;;11046  		}
;;;11047  	}
;;;11048  
;;;11049  /*
;;;11050  if(speedChrgBlckStat==1)
;;;11051  	{
;;;11052  
;;;11053  	//speedChargeStartStop();
;;;11054  
;;;11055  	speedChrgShowCnt++;
;;;11056  	if(speedChrgShowCnt>=30)	
;;;11057  		{
;;;11058  		speedChrgShowCnt=0;
;;;11059  		show_mess(	"     УСКОРЕННЫЙ     ",
;;;11060  					"       ЗАРЯД        ",
;;;11061  					"     ЗАПРЕЩЕН!!!    ",
;;;11062  					"                    ",
;;;11063  					5000);
;;;11064  		}
;;;11065  	} 
;;;11066  else speedChrgShowCnt=0;  */
;;;11067  
;;;11068  
;;;11069  }
006616  e8bd8ff8          POP      {r3-r11,pc}
                  |L1.26138|
00661a  48e7              LDR      r0,|L1.27064|
00661c  49e7              LDR      r1,|L1.27068|
00661e  f9b00000          LDRSH    r0,[r0,#0]            ;10982  ; load_U
006622  f9b11000          LDRSH    r1,[r1,#0]            ;10982  ; u_necc
006626  4288              CMP      r0,r1                 ;10982
006628  da14              BGE      |L1.26196|
00662a  1a08              SUBS     r0,r1,r0              ;10982
00662c  49e4              LDR      r1,|L1.27072|
00662e  f9b11000          LDRSH    r1,[r1,#0]            ;10982  ; speedChrgDU
006632  4288              CMP      r0,r1                 ;10982
006634  dd0e              BLE      |L1.26196|
006636  48e3              LDR      r0,|L1.27076|
006638  49e3              LDR      r1,|L1.27080|
00663a  f9b00000          LDRSH    r0,[r0,#0]            ;10984  ; Ib_ips_termokompensat
00663e  8809              LDRH     r1,[r1,#0]            ;10984  ; IZMAX
006640  fb90f0fa          SDIV     r0,r0,r10             ;10984
006644  1a40              SUBS     r0,r0,r1              ;10984
006646  b200              SXTH     r0,r0                 ;10984
006648  f7fffffe          BL       abs
00664c  2805              CMP      r0,#5                 ;10984
00664e  da01              BGE      |L1.26196|
006650  8820              LDRH     r0,[r4,#0]            ;10989  ; speedChrgBlckStat
006652  b108              CBZ      r0,|L1.26200|
                  |L1.26196|
006654  7035              STRB     r5,[r6,#0]            ;10998
006656  e7d9              B        |L1.26124|
                  |L1.26200|
006658  7830              LDRB     r0,[r6,#0]            ;10991  ; speedChargeStartCnt
00665a  f1000001          ADD      r0,r0,#1              ;10991
00665e  b2c0              UXTB     r0,r0                 ;10991
006660  7030              STRB     r0,[r6,#0]            ;10991
006662  283c              CMP      r0,#0x3c              ;10992
006664  d3d2              BCC      |L1.26124|
006666  f7fffffe          BL       speedChargeStartStop
00666a  2005              MOVS     r0,#5                 ;10995
00666c  f7fffffe          BL       speedz_mem_hndl
006670  e7cc              B        |L1.26124|
                  |L1.26226|
006672  8025              STRH     r5,[r4,#0]            ;11038
006674  48d5              LDR      r0,|L1.27084|
006676  49d6              LDR      r1,|L1.27088|
006678  f44f63fa          MOV      r3,#0x7d0             ;11041
00667c  f9b00000          LDRSH    r0,[r0,#0]            ;11045  ; speedChrgBlckLog
006680  b918              CBNZ     r0,|L1.26250|
006682  f9b1201a          LDRSH    r2,[r1,#0x1a]         ;11045  ; adc_buff_
006686  429a              CMP      r2,r3                 ;11045
006688  dc05              BGT      |L1.26262|
                  |L1.26250|
00668a  2801              CMP      r0,#1                 ;11045
00668c  d1c3              BNE      |L1.26134|
00668e  f9b1001a          LDRSH    r0,[r1,#0x1a]         ;11045  ; adc_buff_
006692  4298              CMP      r0,r3                 ;11045
006694  dabf              BGE      |L1.26134|
                  |L1.26262|
006696  f04f0001          MOV      r0,#1                 ;11045
00669a  8020              STRH     r0,[r4,#0]            ;11045
00669c  e7bb              B        |L1.26134|
;;;11070  
                          ENDP

                  averageChargeHndl PROC
;;;11129  //-----------------------------------------------
;;;11130  void averageChargeHndl(void)
00669e  e92d4ff8          PUSH     {r3-r11,lr}
;;;11131  {
;;;11132  /*
;;;11133  if(hv_vz_stat==hvsOFF)
;;;11134  	{
;;;11135  	if((sk_stat[1]==1)&&(sk_stat_old[1]=0))
;;;11136  	} */
;;;11137  if(hv_vz_stat!=hvsOFF)
0066a2  f8dfa330          LDR      r10,|L1.27092|
0066a6  f04f0b00          MOV      r11,#0
0066aa  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
0066ae  b130              CBZ      r0,|L1.26302|
;;;11138  	{
;;;11139  	hv_vz_stat=hvsOFF; 	
0066b0  f88ab000          STRB     r11,[r10,#0]
;;;11140  	lc640_write(EE_HV_VZ_STAT,hvsOFF);
0066b4  2100              MOVS     r1,#0
0066b6  f44f70b4          MOV      r0,#0x168
0066ba  f7fffffe          BL       lc640_write
                  |L1.26302|
;;;11141  	}
;;;11142  
;;;11143  if(hv_vz_stat==hvsSTEP1)
0066be  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
;;;11144  	{
;;;11145  	if(hv_vz_stat_old!=hv_vz_stat)
;;;11146  		{
;;;11147  		hv_vz_stat_cnt=5;
;;;11148  		}
;;;11149  	if(hv_vz_stat_cnt)
;;;11150  		{
;;;11151  		hv_vz_stat_cnt--;
;;;11152  		if(hv_vz_stat_cnt==0)
;;;11153  			{
;;;11154  			hv_vz_stat=hvsERR1; 	//Не включилась вентиляция;
;;;11155  			lc640_write(EE_HV_VZ_STAT,hvsERR1);
;;;11156  			}
;;;11157  		}
;;;11158  	if(sk_stat[0]==1)
0066c2  4ec5              LDR      r6,|L1.27096|
0066c4  4dc5              LDR      r5,|L1.27100|
0066c6  4cc6              LDR      r4,|L1.27104|
0066c8  f04f0905          MOV      r9,#5                 ;11147
0066cc  2801              CMP      r0,#1                 ;11143
0066ce  d131              BNE      |L1.26420|
0066d0  7828              LDRB     r0,[r5,#0]            ;11145  ; hv_vz_stat_old
0066d2  2801              CMP      r0,#1                 ;11145
0066d4  d001              BEQ      |L1.26330|
0066d6  f8a49000          STRH     r9,[r4,#0]            ;11147
                  |L1.26330|
0066da  f9b40000          LDRSH    r0,[r4,#0]            ;11149  ; hv_vz_stat_cnt
0066de  b168              CBZ      r0,|L1.26364|
0066e0  f1a00001          SUB      r0,r0,#1              ;11151
0066e4  b200              SXTH     r0,r0                 ;11151
0066e6  8020              STRH     r0,[r4,#0]            ;11151
0066e8  b940              CBNZ     r0,|L1.26364|
0066ea  f04f0006          MOV      r0,#6                 ;11154
0066ee  f88a0000          STRB     r0,[r10,#0]           ;11154
0066f2  4601              MOV      r1,r0                 ;11155
0066f4  f44f70b4          MOV      r0,#0x168             ;11155
0066f8  f7fffffe          BL       lc640_write
                  |L1.26364|
0066fc  7830              LDRB     r0,[r6,#0]  ; sk_stat
0066fe  2801              CMP      r0,#1
006700  d118              BNE      |L1.26420|
;;;11159  		{
;;;11160  		hv_vz_stat=hvsSTEP2;
006702  f04f0002          MOV      r0,#2
006706  f88a0000          STRB     r0,[r10,#0]
;;;11161  		lc640_write(EE_HV_VZ_STAT,hvsSTEP2);
00670a  4601              MOV      r1,r0
00670c  f44f70b4          MOV      r0,#0x168
006710  f7fffffe          BL       lc640_write
;;;11162  		tree_up(iHV_STEP2_2,1,0,0);
006714  2300              MOVS     r3,#0
006716  461a              MOV      r2,r3
006718  2101              MOVS     r1,#1
00671a  20ec              MOVS     r0,#0xec
00671c  f7fffffe          BL       tree_up
;;;11163  		tree_up(iHV_STEP2_1,0,0,0);
006720  2300              MOVS     r3,#0
006722  461a              MOV      r2,r3
006724  4619              MOV      r1,r3
006726  20eb              MOVS     r0,#0xeb
006728  f7fffffe          BL       tree_up
;;;11164  		ret(1200);
00672c  f44f6096          MOV      r0,#0x4b0
006730  f7fffffe          BL       ||ret||
                  |L1.26420|
;;;11165  		}
;;;11166  	}
;;;11167  
;;;11168  if(hv_vz_stat==hvsSTEP2)
006734  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
006738  2802              CMP      r0,#2
00673a  d10b              BNE      |L1.26452|
;;;11169  	{
;;;11170  	if((hv_vz_stat_old!=hv_vz_stat)||(hv_vz_stat_cnt==0))
00673c  7829              LDRB     r1,[r5,#0]  ; hv_vz_stat_old
00673e  2902              CMP      r1,#2
006740  d101              BNE      |L1.26438|
006742  8821              LDRH     r1,[r4,#0]  ; hv_vz_stat_cnt
006744  b911              CBNZ     r1,|L1.26444|
                  |L1.26438|
;;;11171  		{
;;;11172  		hv_vz_stat_cnt=15;
006746  f04f010f          MOV      r1,#0xf
00674a  8021              STRH     r1,[r4,#0]
                  |L1.26444|
;;;11173  		}
;;;11174  	hv_vz_stat_cnt--;
00674c  8821              LDRH     r1,[r4,#0]  ; hv_vz_stat_cnt
00674e  f1a10101          SUB      r1,r1,#1
006752  8021              STRH     r1,[r4,#0]
                  |L1.26452|
;;;11175  	//if((hv_vz_stat_cnt==14)/*||(hv_vz_stat_cnt==13)||(hv_vz_stat_cnt==12)*/)
;;;11176  	//	{
;;;11177  //		show_mess_number(	"     ВНИМАНИЕ!!!    ",
;;;11178  	//				"  Напряжение будет  ",
;;;11179  	//				" увеличено до     @В",
;;;11180  	//				"ОТКЛЮЧИТЕ НАГРУЗКУ!!",
;;;11181  	//				4800,UVZ,1);
;;;11182  	//	}
;;;11183  	//if((hv_vz_stat_cnt==8)/*||(hv_vz_stat_cnt==7)||(hv_vz_stat_cnt==6)*/)
;;;11184  	//	{
;;;11185  	//	show_mess(	"    ПОДТВЕРДИТЕ     ",
;;;11186  	//				"     НАЖАТИЕМ       ",
;;;11187  	//				"    ЦЕНТРАЛЬНОЙ     ",
;;;11188  	//				"      КНОПКИ        ",
;;;11189  	//				4800);
;;;11190  	//	} 
;;;11191  /*	if(sk_stat[1]==1)
;;;11192  		{
;;;11193  		hv_vz_stat=hvsWRK;
;;;11194  		lc640_write(EE_HV_VZ_STAT,hvsWRK);
;;;11195  		}*/
;;;11196  	}
;;;11197  
;;;11198  if(hv_vz_stat==hvsSTEP3)
;;;11199  	{
;;;11200  	if((hv_vz_stat_old!=hv_vz_stat)||(hv_vz_stat_cnt==0))
;;;11201  		{
;;;11202  		hv_vz_stat_cnt=10;
006754  270a              MOVS     r7,#0xa
;;;11203  		}
;;;11204  	hv_vz_stat_cnt--;
;;;11205  	if((hv_vz_stat_cnt==10)||(hv_vz_stat_cnt==9))
;;;11206  		{
;;;11207  		show_mess(	"     ВКЛЮЧИТЕ       ",
006756  f2413888          MOV      r8,#0x1388
00675a  2803              CMP      r0,#3                 ;11198
00675c  d123              BNE      |L1.26534|
00675e  7828              LDRB     r0,[r5,#0]            ;11200  ; hv_vz_stat_old
006760  2803              CMP      r0,#3                 ;11200
006762  d101              BNE      |L1.26472|
006764  8820              LDRH     r0,[r4,#0]            ;11200  ; hv_vz_stat_cnt
006766  b900              CBNZ     r0,|L1.26474|
                  |L1.26472|
006768  8027              STRH     r7,[r4,#0]            ;11202
                  |L1.26474|
00676a  8820              LDRH     r0,[r4,#0]            ;11204  ; hv_vz_stat_cnt
00676c  f1a00001          SUB      r0,r0,#1              ;11204
006770  b200              SXTH     r0,r0                 ;11204
006772  8020              STRH     r0,[r4,#0]            ;11204
006774  280a              CMP      r0,#0xa               ;11205
006776  d001              BEQ      |L1.26492|
006778  2809              CMP      r0,#9                 ;11205
00677a  d10a              BNE      |L1.26514|
                  |L1.26492|
00677c  4b81              LDR      r3,|L1.27012|
00677e  a299              ADR      r2,|L1.27108|
006780  33f0              ADDS     r3,r3,#0xf0
006782  f5a361bf          SUB      r1,r3,#0x5f8
006786  f1010018          ADD      r0,r1,#0x18
00678a  f8cd8000          STR      r8,[sp,#0]
00678e  f7fffffe          BL       show_mess
                  |L1.26514|
;;;11208  					"      ТУМБЛЕР       ",
;;;11209  					"   ВЫРАВНИВАЮЩИЙ    ",
;;;11210  					"       ЗАРЯД        ",
;;;11211  					5000);
;;;11212  		}
;;;11213  	if(sk_stat[1]==1)
006792  7870              LDRB     r0,[r6,#1]  ; sk_stat
006794  2801              CMP      r0,#1
006796  d106              BNE      |L1.26534|
;;;11214  		{
;;;11215  		hv_vz_stat=hvsWRK;
006798  f88a9000          STRB     r9,[r10,#0]
;;;11216  		lc640_write(EE_HV_VZ_STAT,hvsWRK);
00679c  2105              MOVS     r1,#5
00679e  f44f70b4          MOV      r0,#0x168
0067a2  f7fffffe          BL       lc640_write
                  |L1.26534|
;;;11217  		}
;;;11218  	}
;;;11219  
;;;11220  if(hv_vz_stat==hvsWRK)
0067a6  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
0067aa  2805              CMP      r0,#5
0067ac  d13a              BNE      |L1.26660|
;;;11221  	{
;;;11222  	if(hv_vz_stat_old!=hv_vz_stat)
0067ae  7828              LDRB     r0,[r5,#0]  ; hv_vz_stat_old
;;;11223  		{
;;;11224  		hv_vz_wrk_cnt=3600L/*100L*/*((long)VZ_HR);
0067b0  4a92              LDR      r2,|L1.27132|
;;;11225  		if(VZ_HR==0)  	hv_vz_wrk_cnt=1800L;
;;;11226  		hv_vz_up_cnt=0L;
0067b2  4993              LDR      r1,|L1.27136|
0067b4  2805              CMP      r0,#5                 ;11222
0067b6  d00d              BEQ      |L1.26580|
0067b8  4892              LDR      r0,|L1.27140|
0067ba  f44f6361          MOV      r3,#0xe10             ;11224
0067be  f9b00000          LDRSH    r0,[r0,#0]            ;11224  ; VZ_HR
0067c2  fb00f303          MUL      r3,r0,r3              ;11224
0067c6  6013              STR      r3,[r2,#0]            ;11224  ; hv_vz_wrk_cnt
0067c8  b910              CBNZ     r0,|L1.26576|
0067ca  f44f60e1          MOV      r0,#0x708             ;11225
0067ce  6010              STR      r0,[r2,#0]            ;11225  ; hv_vz_wrk_cnt
                  |L1.26576|
0067d0  f8c1b000          STR      r11,[r1,#0]  ; hv_vz_up_cnt
                  |L1.26580|
;;;11227  		}
;;;11228  	hv_vz_wrk_cnt--;
0067d4  6810              LDR      r0,[r2,#0]  ; hv_vz_wrk_cnt
0067d6  f1a00001          SUB      r0,r0,#1
0067da  6010              STR      r0,[r2,#0]  ; hv_vz_wrk_cnt
;;;11229  	hv_vz_up_cnt++;
0067dc  680a              LDR      r2,[r1,#0]  ; hv_vz_up_cnt
0067de  f1020201          ADD      r2,r2,#1
0067e2  600a              STR      r2,[r1,#0]  ; hv_vz_up_cnt
;;;11230  
;;;11231  	if(hv_vz_wrk_cnt==0)
0067e4  b940              CBNZ     r0,|L1.26616|
;;;11232  		{
;;;11233  		hv_vz_stat=hvsERR4;
0067e6  f04f0009          MOV      r0,#9
0067ea  f88a0000          STRB     r0,[r10,#0]
;;;11234  		lc640_write(EE_HV_VZ_STAT,hvsERR4);
0067ee  4601              MOV      r1,r0
0067f0  f44f70b4          MOV      r0,#0x168
0067f4  f7fffffe          BL       lc640_write
                  |L1.26616|
;;;11235  		}
;;;11236  	if(sk_stat[0]==0)
0067f8  7830              LDRB     r0,[r6,#0]  ; sk_stat
0067fa  b940              CBNZ     r0,|L1.26638|
;;;11237  		{
;;;11238  		hv_vz_stat=hvsERR2;
0067fc  f04f0007          MOV      r0,#7
006800  f88a0000          STRB     r0,[r10,#0]
;;;11239  		lc640_write(EE_HV_VZ_STAT,hvsERR2);
006804  4601              MOV      r1,r0
006806  f44f70b4          MOV      r0,#0x168
00680a  f7fffffe          BL       lc640_write
                  |L1.26638|
;;;11240  		}
;;;11241  	if(sk_stat[1]==0)
00680e  7870              LDRB     r0,[r6,#1]  ; sk_stat
006810  b940              CBNZ     r0,|L1.26660|
;;;11242  		{
;;;11243  		hv_vz_stat=hvsERR3;
006812  f04f0008          MOV      r0,#8
006816  f88a0000          STRB     r0,[r10,#0]
;;;11244  		lc640_write(EE_HV_VZ_STAT,hvsERR3);
00681a  4601              MOV      r1,r0
00681c  f44f70b4          MOV      r0,#0x168
006820  f7fffffe          BL       lc640_write
                  |L1.26660|
;;;11245  		}
;;;11246  	}
;;;11247  
;;;11248  if(hv_vz_stat==hvsERR1)		//Отсутствует вентиляция при включении
006824  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
006828  2806              CMP      r0,#6
00682a  d119              BNE      |L1.26720|
;;;11249  	{
;;;11250  	if((hv_vz_stat_old!=hv_vz_stat)||(hv_vz_stat_cnt==0))
00682c  7828              LDRB     r0,[r5,#0]  ; hv_vz_stat_old
00682e  2806              CMP      r0,#6
006830  d101              BNE      |L1.26678|
006832  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
006834  b900              CBNZ     r0,|L1.26680|
                  |L1.26678|
;;;11251  		{
;;;11252  		hv_vz_stat_cnt=10;
006836  8027              STRH     r7,[r4,#0]
                  |L1.26680|
;;;11253  		}
;;;11254  	hv_vz_stat_cnt--;
006838  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
00683a  f1a00001          SUB      r0,r0,#1
00683e  b200              SXTH     r0,r0
006840  8020              STRH     r0,[r4,#0]
;;;11255  	if((hv_vz_stat_cnt==10)||(hv_vz_stat_cnt==9))
006842  280a              CMP      r0,#0xa
006844  d001              BEQ      |L1.26698|
006846  2809              CMP      r0,#9
006848  d10a              BNE      |L1.26720|
                  |L1.26698|
;;;11256  		{
;;;11257  		show_mess(	"ВЫРАВНИВАЮЩИЙ ЗАРЯД ",
00684a  4b4e              LDR      r3,|L1.27012|
00684c  f8cd8000          STR      r8,[sp,#0]
006850  f1030218          ADD      r2,r3,#0x18
006854  f1020118          ADD      r1,r2,#0x18
006858  f2a15084          SUB      r0,r1,#0x584
00685c  f7fffffe          BL       show_mess
                  |L1.26720|
;;;11258  					"   НЕ МОЖЕТ БЫТЬ    ",
;;;11259  					"      ВКЛЮЧЕН       ",
;;;11260  					"  БЕЗ ВЕНТИЛЯЦИИ!!  ",
;;;11261  					5000);
;;;11262  		}
;;;11263  	}
;;;11264  if(hv_vz_stat==hvsERR2)		//Пропала вентиляция при работе
006860  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
006864  2807              CMP      r0,#7
006866  d123              BNE      |L1.26800|
;;;11265  	{
;;;11266  	if((hv_vz_stat_old!=hv_vz_stat)||(hv_vz_stat_cnt==0))
006868  7828              LDRB     r0,[r5,#0]  ; hv_vz_stat_old
00686a  2807              CMP      r0,#7
00686c  d101              BNE      |L1.26738|
00686e  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
006870  b900              CBNZ     r0,|L1.26740|
                  |L1.26738|
;;;11267  		{
;;;11268  		hv_vz_stat_cnt=10;
006872  8027              STRH     r7,[r4,#0]
                  |L1.26740|
;;;11269  		}
;;;11270  	hv_vz_stat_cnt--;
006874  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
006876  f1a00001          SUB      r0,r0,#1
00687a  b200              SXTH     r0,r0
00687c  8020              STRH     r0,[r4,#0]
;;;11271  	if((hv_vz_stat_cnt==10)||(hv_vz_stat_cnt==9))
00687e  280a              CMP      r0,#0xa
006880  d001              BEQ      |L1.26758|
006882  2809              CMP      r0,#9
006884  d10a              BNE      |L1.26780|
                  |L1.26758|
;;;11272  		{
;;;11273  		show_mess(	"ВЫРАВНИВАЮЩИЙ ЗАРЯД ",
006886  4b46              LDR      r3,|L1.27040|
006888  f8cd8000          STR      r8,[sp,#0]
00688c  f1030218          ADD      r2,r3,#0x18
006890  f1020118          ADD      r1,r2,#0x18
006894  f1010018          ADD      r0,r1,#0x18
006898  f7fffffe          BL       show_mess
                  |L1.26780|
;;;11274  					"    ЗАБЛОКИРОВАН    ",
;;;11275  					"     НЕИСПРАВНА     ",
;;;11276  					"    ВЕНТИЛЯЦИЯ!!!   ",
;;;11277  					5000);
;;;11278  		}
;;;11279  	if(sk_stat[0]==1)
00689c  7830              LDRB     r0,[r6,#0]  ; sk_stat
00689e  2801              CMP      r0,#1
0068a0  d106              BNE      |L1.26800|
;;;11280  		{
;;;11281  		hv_vz_stat=hvsWRK;
0068a2  f88a9000          STRB     r9,[r10,#0]
;;;11282  		lc640_write(EE_HV_VZ_STAT,hvsWRK);
0068a6  2105              MOVS     r1,#5
0068a8  f44f70b4          MOV      r0,#0x168
0068ac  f7fffffe          BL       lc640_write
                  |L1.26800|
;;;11283  		}
;;;11284  	}
;;;11285  
;;;11286  if(hv_vz_stat==hvsERR3)		//Отключен тумблер "Выравнивающий заряд"
0068b0  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
0068b4  2808              CMP      r0,#8
0068b6  d123              BNE      |L1.26880|
;;;11287  	{
;;;11288  	if((hv_vz_stat_old!=hv_vz_stat)||(hv_vz_stat_cnt==0))
0068b8  7828              LDRB     r0,[r5,#0]  ; hv_vz_stat_old
0068ba  2808              CMP      r0,#8
0068bc  d101              BNE      |L1.26818|
0068be  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
0068c0  b900              CBNZ     r0,|L1.26820|
                  |L1.26818|
;;;11289  		{
;;;11290  		hv_vz_stat_cnt=10;
0068c2  8027              STRH     r7,[r4,#0]
                  |L1.26820|
;;;11291  		}
;;;11292  	hv_vz_stat_cnt--;
0068c4  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
0068c6  f1a00001          SUB      r0,r0,#1
0068ca  b200              SXTH     r0,r0
0068cc  8020              STRH     r0,[r4,#0]
;;;11293  	if((hv_vz_stat_cnt==10)||(hv_vz_stat_cnt==9))
0068ce  280a              CMP      r0,#0xa
0068d0  d001              BEQ      |L1.26838|
0068d2  2809              CMP      r0,#9
0068d4  d10a              BNE      |L1.26860|
                  |L1.26838|
;;;11294  		{
;;;11295  		show_mess(	"ВЫРАВНИВАЮЩИЙ ЗАРЯД ",
0068d6  4b4c              LDR      r3,|L1.27144|
0068d8  f8cd8000          STR      r8,[sp,#0]
0068dc  f2a35254          SUB      r2,r3,#0x554
0068e0  f1020118          ADD      r1,r2,#0x18
0068e4  f2a150e4          SUB      r0,r1,#0x5e4
0068e8  f7fffffe          BL       show_mess
                  |L1.26860|
;;;11296  					"  БУДЕТ ПРОДОЛЖЕН   ",
;;;11297  					"  ПОСЛЕ ВКЛЮЧЕНИЯ   ",
;;;11298  					"    ТУМБЛЕРА!!!     ",
;;;11299  					5000);
;;;11300  		}
;;;11301  	if(sk_stat[1]==1)
0068ec  7870              LDRB     r0,[r6,#1]  ; sk_stat
0068ee  2801              CMP      r0,#1
0068f0  d106              BNE      |L1.26880|
;;;11302  		{
;;;11303  		hv_vz_stat=hvsWRK;
0068f2  f88a9000          STRB     r9,[r10,#0]
;;;11304  		lc640_write(EE_HV_VZ_STAT,hvsWRK);
0068f6  2105              MOVS     r1,#5
0068f8  f44f70b4          MOV      r0,#0x168
0068fc  f7fffffe          BL       lc640_write
                  |L1.26880|
;;;11305  		}
;;;11306  	}
;;;11307  if(hv_vz_stat==hvsERR4)		//ВЗ закончился а тумблер включен
006900  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
006904  2809              CMP      r0,#9
006906  d124              BNE      |L1.26962|
;;;11308  	{
;;;11309  	if((hv_vz_stat_old!=hv_vz_stat)||(hv_vz_stat_cnt==0))
006908  7828              LDRB     r0,[r5,#0]  ; hv_vz_stat_old
00690a  2809              CMP      r0,#9
00690c  d101              BNE      |L1.26898|
00690e  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
006910  b900              CBNZ     r0,|L1.26900|
                  |L1.26898|
;;;11310  		{
;;;11311  		hv_vz_stat_cnt=10;
006912  8027              STRH     r7,[r4,#0]
                  |L1.26900|
;;;11312  		}
;;;11313  	hv_vz_stat_cnt--;
006914  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
006916  f1a00001          SUB      r0,r0,#1
00691a  b200              SXTH     r0,r0
00691c  8020              STRH     r0,[r4,#0]
;;;11314  	if((hv_vz_stat_cnt==10)||(hv_vz_stat_cnt==9))
00691e  280a              CMP      r0,#0xa
006920  d001              BEQ      |L1.26918|
006922  2809              CMP      r0,#9
006924  d10a              BNE      |L1.26940|
                  |L1.26918|
;;;11315  		{
;;;11316  		show_mess(	"     ВЫКЛЮЧИТЕ      ",
006926  4b17              LDR      r3,|L1.27012|
006928  a22e              ADR      r2,|L1.27108|
00692a  33f0              ADDS     r3,r3,#0xf0
00692c  f5a361bf          SUB      r1,r3,#0x5f8
006930  f50160c5          ADD      r0,r1,#0x628
006934  f8cd8000          STR      r8,[sp,#0]
006938  f7fffffe          BL       show_mess
                  |L1.26940|
;;;11317  					"      ТУМБЛЕР       ",
;;;11318  					"   ВЫРАВНИВАЮЩИЙ    ",
;;;11319  					"       ЗАРЯД        ",
;;;11320  					5000);
;;;11321  		}
;;;11322  	if(sk_stat[1]==0)
00693c  7870              LDRB     r0,[r6,#1]  ; sk_stat
00693e  b940              CBNZ     r0,|L1.26962|
;;;11323  		{
;;;11324  		hv_vz_stat=hvsOFF;
006940  f88ab000          STRB     r11,[r10,#0]
;;;11325  		lc640_write(EE_HV_VZ_STAT,hvsOFF);
006944  2100              MOVS     r1,#0
006946  f44f70b4          MOV      r0,#0x168
00694a  f7fffffe          BL       lc640_write
;;;11326  		vz_stop();
00694e  f7fffffe          BL       vz_stop
                  |L1.26962|
;;;11327  
;;;11328  		}
;;;11329  	}
;;;11330  hv_vz_stat_old=hv_vz_stat;
006952  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
006956  7028              STRB     r0,[r5,#0]
;;;11331  /*
;;;11332  if(speedChIsOn)
;;;11333  	{
;;;11334  	speedChTimeCnt++;
;;;11335  	if(speedChTimeCnt>=((signed long)speedChrgTimeInHour*3600L))
;;;11336  		{
;;;11337  		speedChIsOn=0;
;;;11338  		}
;;;11339  	if(speedChrgBlckStat)
;;;11340  		{
;;;11341  		speedChIsOn=0;
;;;11342  		speedChTimeCnt=0;
;;;11343  		}
;;;11344  	}
;;;11345  
;;;11346  
;;;11347  
;;;11348  if(speedChrgAvtEn)
;;;11349  	{
;;;11350  	if(!speedChIsOn)
;;;11351  		{
;;;11352  		if((load_U<u_necc)&&((u_necc-load_U)>speedChrgDU)&&(abs(Ib_ips_termokompensat/10-IZMAX)<5)&&(!speedChrgBlckStat))
;;;11353  			{
;;;11354  			speedChIsOn=1;
;;;11355  			}
;;;11356  		}
;;;11357  	}
;;;11358  
;;;11359  
;;;11360  
;;;11361  if((speedChrgBlckSrc!=1)&&(speedChrgBlckSrc!=2)) speedChrgBlckStat=0;
;;;11362  else
;;;11363  	{
;;;11364  	speedChrgBlckStat=0;
;;;11365  	if(speedChrgBlckSrc==1)
;;;11366  		{
;;;11367  		if(((speedChrgBlckLog==0)&&(adc_buff_[11]>2000)) || ((speedChrgBlckLog==1)&&(adc_buff_[11]<2000))) speedChrgBlckStat=1;
;;;11368  		}
;;;11369  	else if(speedChrgBlckSrc==2)
;;;11370  		{
;;;11371  		if(((speedChrgBlckLog==0)&&(adc_buff_[13]>2000)) || ((speedChrgBlckLog==1)&&(adc_buff_[13]<2000))) speedChrgBlckStat=1;
;;;11372  		}
;;;11373  	}
;;;11374  
;;;11375  
;;;11376  if(speedChrgBlckStat==1)
;;;11377  	{
;;;11378  
;;;11379  	//speedChargeStartStop();
;;;11380  
;;;11381  	speedChrgShowCnt++;
;;;11382  	if(speedChrgShowCnt>=30)	
;;;11383  		{
;;;11384  		speedChrgShowCnt=0;
;;;11385  		show_mess(	"     УСКОРЕННЫЙ     ",
;;;11386  					"       ЗАРЯД        ",
;;;11387  					"     ЗАПРЕЩЕН!!!    ",
;;;11388  					"                    ",
;;;11389  					5000);
;;;11390  		}
;;;11391  	}
;;;11392  else speedChrgShowCnt=0;
;;;11393  
;;;11394  */
;;;11395  }
006958  e65d              B        |L1.26134|
;;;11396  
                          ENDP

                  numOfForvardBps_hndl PROC
;;;11413  //-----------------------------------------------
;;;11414  void	numOfForvardBps_hndl(void)			//Программа смены первого источника для равномерного износа БПСов
00695a  e92d41f0          PUSH     {r4-r8,lr}
;;;11415  {
;;;11416  
;;;11417  numOfForvardBps_old=numOfForvardBps;
00695e  4c13              LDR      r4,|L1.27052|
006960  3428              ADDS     r4,r4,#0x28
006962  7820              LDRB     r0,[r4,#0]  ; numOfForvardBps
006964  7060              STRB     r0,[r4,#1]
;;;11418  
;;;11419  numOfForvardBps=0;
006966  f04f0500          MOV      r5,#0
00696a  f8045928          STRB     r5,[r4],#-0x28
;;;11420  
;;;11421  //FORVARDBPSCHHOUR=10;
;;;11422  
;;;11423  if((FORVARDBPSCHHOUR<=0)||(FORVARDBPSCHHOUR>500))
00696e  4e27              LDR      r6,|L1.27148|
006970  f9b60000          LDRSH    r0,[r6,#0]  ; FORVARDBPSCHHOUR
006974  2800              CMP      r0,#0
006976  dd02              BLE      |L1.27006|
006978  f5b07ffa          CMP      r0,#0x1f4
00697c  dd48              BLE      |L1.27152|
                  |L1.27006|
;;;11424  	{
;;;11425  	FORVARDBPSCHHOUR=0;
00697e  8035              STRH     r5,[r6,#0]
                  |L1.27008|
;;;11426  	return;
;;;11427  	}
;;;11428  
;;;11429  numOfForvardBps_minCnt++;
;;;11430  
;;;11431  
;;;11432  if(numOfForvardBps_minCnt>=60)
;;;11433  	{
;;;11434  	numOfForvardBps_minCnt=0;
;;;11435  	numOfForvardBps_hourCnt=lc640_read_int(EE_FORVBPSHOURCNT);
;;;11436  	numOfForvardBps_hourCnt++;
;;;11437  	if(numOfForvardBps_hourCnt>=(FORVARDBPSCHHOUR*NUMIST))
;;;11438  		{
;;;11439  		numOfForvardBps_hourCnt=0;
;;;11440  		}
;;;11441  	lc640_write_int(EE_FORVBPSHOURCNT,numOfForvardBps_hourCnt);
;;;11442  	}
;;;11443  
;;;11444  numOfForvardBps=numOfForvardBps_hourCnt/FORVARDBPSCHHOUR;
;;;11445  
;;;11446  //if(numOfForvardBps)
;;;11447  //numOfForvardBps_old=numOfForvardBps; 
;;;11448  }
006980  e8bd81f0          POP      {r4-r8,pc}
                  |L1.27012|
                          DCD      ||.text||+0x1c2c
                  |L1.27016|
006988  2020d3d1          DCB      "  ",211,209,202,206,208,197,205,205,219,201," ",199,192
00698c  caced0c5
006990  cdcddbc9
006994  20c7c0  
006997  d0dfc420          DCB      208,223,196,"  ",0
00699b  2000    
00699d  00                DCB      0
00699e  00                DCB      0
00699f  00                DCB      0
                  |L1.27040|
                          DCD      ||.text||+0x1690
                  |L1.27044|
                          DCD      speedChrgAvtEn
                  |L1.27048|
                          DCD      speedChrgBlckStat
                  |L1.27052|
                          DCD      ||area_number.26||
                  |L1.27056|
                          DCD      speedChargeStartCnt
                  |L1.27060|
                          DCD      speedChrgBlckSrc
                  |L1.27064|
                          DCD      load_U
                  |L1.27068|
                          DCD      u_necc
                  |L1.27072|
                          DCD      speedChrgDU
                  |L1.27076|
                          DCD      Ib_ips_termokompensat
                  |L1.27080|
                          DCD      IZMAX
                  |L1.27084|
                          DCD      speedChrgBlckLog
                  |L1.27088|
                          DCD      ||.bss||+0x40c
                  |L1.27092|
                          DCD      hv_vz_stat
                  |L1.27096|
                          DCD      sk_stat
                  |L1.27100|
                          DCD      hv_vz_stat_old
                  |L1.27104|
                          DCD      hv_vz_stat_cnt
                  |L1.27108|
0069e4  202020c2          DCB      "   ",194,219,208,192,194,205,200,194,192,222,217,200,201
0069e8  dbd0c0c2
0069ec  cdc8c2c0
0069f0  ded9c8c9
0069f4  20202020          DCB      "    ",0
0069f8  00      
0069f9  00                DCB      0
0069fa  00                DCB      0
0069fb  00                DCB      0
                  |L1.27132|
                          DCD      hv_vz_wrk_cnt
                  |L1.27136|
                          DCD      hv_vz_up_cnt
                  |L1.27140|
                          DCD      VZ_HR
                  |L1.27144|
                          DCD      ||.text||+0x21f8
                  |L1.27148|
                          DCD      FORVARDBPSCHHOUR
                  |L1.27152|
006a10  f894002a          LDRB     r0,[r4,#0x2a]         ;11429  ; numOfForvardBps_minCnt
006a14  f1000001          ADD      r0,r0,#1              ;11429
006a18  b2c0              UXTB     r0,r0                 ;11429
006a1a  f884002a          STRB     r0,[r4,#0x2a]         ;11429
006a1e  283c              CMP      r0,#0x3c              ;11432
006a20  d31b              BCC      |L1.27226|
006a22  f884502a          STRB     r5,[r4,#0x2a]         ;11434
006a26  f44f7794          MOV      r7,#0x128             ;11435
006a2a  4638              MOV      r0,r7                 ;11435
006a2c  f7fffffe          BL       lc640_read_int
006a30  f1000001          ADD      r0,r0,#1              ;11436
006a34  b200              SXTH     r0,r0                 ;11436
006a36  f8a40074          STRH     r0,[r4,#0x74]         ;11436
006a3a  f9b61000          LDRSH    r1,[r6,#0]            ;11437  ; FORVARDBPSCHHOUR
006a3e  4aff              LDR      r2,|L1.28220|
006a40  f9b22000          LDRSH    r2,[r2,#0]            ;11437  ; NUMIST
006a44  fb01f102          MUL      r1,r1,r2              ;11437
006a48  4281              CMP      r1,r0                 ;11437
006a4a  dc01              BGT      |L1.27216|
006a4c  f8a45074          STRH     r5,[r4,#0x74]         ;11439
                  |L1.27216|
006a50  f9b41074          LDRSH    r1,[r4,#0x74]         ;11441  ; numOfForvardBps_hourCnt
006a54  4638              MOV      r0,r7                 ;11441
006a56  f7fffffe          BL       lc640_write_int
                  |L1.27226|
006a5a  f9b40074          LDRSH    r0,[r4,#0x74]         ;11444  ; numOfForvardBps_hourCnt
006a5e  f9b61000          LDRSH    r1,[r6,#0]            ;11444  ; FORVARDBPSCHHOUR
006a62  fb90f0f1          SDIV     r0,r0,r1              ;11444
006a66  f8840028          STRB     r0,[r4,#0x28]         ;11444
006a6a  e789              B        |L1.27008|
;;;11449  
                          ENDP

                  numOfForvardBps_init PROC
;;;11450  //-----------------------------------------------
;;;11451  void	numOfForvardBps_init(void)			//Программа сброса системы смены первого источника для равномерного износа БПСов
006a6c  b510              PUSH     {r4,lr}
;;;11452  {									//Должна вызываться при изменении кол-ва источников в структуре
;;;11453  lc640_write_int(EE_FORVBPSHOURCNT,0);
006a6e  2100              MOVS     r1,#0
006a70  f44f7094          MOV      r0,#0x128
006a74  f7fffffe          BL       lc640_write_int
;;;11454  numOfForvardBps_minCnt=58;
006a78  49f1              LDR      r1,|L1.28224|
006a7a  f04f003a          MOV      r0,#0x3a
006a7e  f881002a          STRB     r0,[r1,#0x2a]
;;;11455  }
006a82  bd10              POP      {r4,pc}
;;;11456  
                          ENDP

                  outVoltContrHndl PROC
;;;11457  //-----------------------------------------------
;;;11458  void outVoltContrHndl(void)
006a84  b570              PUSH     {r4-r6,lr}
;;;11459  { 
;;;11460  if((load_U>U_OUT_KONTR_MAX)||(load_U<U_OUT_KONTR_MIN))
006a86  4cef              LDR      r4,|L1.28228|
006a88  48ef              LDR      r0,|L1.28232|
;;;11461  	{
;;;11462  	outVoltContrHndlCnt_=0;
;;;11463  	if(outVoltContrHndlCnt<U_OUT_KONTR_DELAY)
006a8a  4af0              LDR      r2,|L1.28236|
006a8c  f9b41000          LDRSH    r1,[r4,#0]            ;11460  ; load_U
006a90  f9b06000          LDRSH    r6,[r0,#0]            ;11460  ; U_OUT_KONTR_MAX
006a94  2500              MOVS     r5,#0                 ;11462
006a96  f9b20000          LDRSH    r0,[r2,#0]
006a9a  4bed              LDR      r3,|L1.28240|
006a9c  42b1              CMP      r1,r6                 ;11460
006a9e  dc04              BGT      |L1.27306|
006aa0  4eec              LDR      r6,|L1.28244|
006aa2  f9b66000          LDRSH    r6,[r6,#0]            ;11460  ; U_OUT_KONTR_MIN
006aa6  42b1              CMP      r1,r6                 ;11460
006aa8  da0f              BGE      |L1.27338|
                  |L1.27306|
006aaa  801d              STRH     r5,[r3,#0]            ;11462
006aac  49ea              LDR      r1,|L1.28248|
006aae  f9b11000          LDRSH    r1,[r1,#0]  ; U_OUT_KONTR_DELAY
006ab2  4288              CMP      r0,r1
006ab4  da1b              BGE      |L1.27374|
;;;11464  		{
;;;11465  		outVoltContrHndlCnt++;
006ab6  f1000001          ADD      r0,r0,#1
006aba  b200              SXTH     r0,r0
006abc  8010              STRH     r0,[r2,#0]
;;;11466  		if(outVoltContrHndlCnt==U_OUT_KONTR_DELAY)
006abe  4288              CMP      r0,r1
006ac0  d115              BNE      |L1.27374|
;;;11467  			{
;;;11468  			avar_uout_hndl(1);
006ac2  2001              MOVS     r0,#1
006ac4  f7fffffe          BL       avar_uout_hndl
006ac8  e011              B        |L1.27374|
                  |L1.27338|
;;;11469  			}
;;;11470  		}
;;;11471  	}
;;;11472  else
;;;11473  	{
;;;11474  	if(outVoltContrHndlCnt)
006aca  b180              CBZ      r0,|L1.27374|
;;;11475  		{
;;;11476  		if(outVoltContrHndlCnt_<5)
006acc  f9b30000          LDRSH    r0,[r3,#0]  ; outVoltContrHndlCnt_
006ad0  2805              CMP      r0,#5
006ad2  da0c              BGE      |L1.27374|
;;;11477  			{
;;;11478  			outVoltContrHndlCnt_++;
006ad4  f1000001          ADD      r0,r0,#1
006ad8  b200              SXTH     r0,r0
006ada  8018              STRH     r0,[r3,#0]
;;;11479  			if(outVoltContrHndlCnt_>=5)
006adc  2805              CMP      r0,#5
006ade  db06              BLT      |L1.27374|
;;;11480  				{
;;;11481  				outVoltContrHndlCnt=0;
006ae0  8015              STRH     r5,[r2,#0]
;;;11482  				if(uout_av)avar_uout_hndl(0);
006ae2  48de              LDR      r0,|L1.28252|
006ae4  7800              LDRB     r0,[r0,#0]  ; uout_av
006ae6  b110              CBZ      r0,|L1.27374|
006ae8  2000              MOVS     r0,#0
006aea  f7fffffe          BL       avar_uout_hndl
                  |L1.27374|
;;;11483  				}
;;;11484  			}
;;;11485  		}
;;;11486  	}
;;;11487  
;;;11488  if (load_U<(USIGN*10)) 
006aee  48dc              LDR      r0,|L1.28256|
006af0  f9b41000          LDRSH    r1,[r4,#0]  ; load_U
006af4  f9b00000          LDRSH    r0,[r0,#0]  ; USIGN
006af8  eb000080          ADD      r0,r0,r0,LSL #2
006afc  ebb10f40          CMP      r1,r0,LSL #1
006b00  da0b              BGE      |L1.27418|
;;;11489  	{
;;;11490  	if(!bSILENT)
006b02  48d8              LDR      r0,|L1.28260|
006b04  6800              LDR      r0,[r0,#0]  ; bSILENT
006b06  2800              CMP      r0,#0
006b08  d107              BNE      |L1.27418|
;;;11491  		{
;;;11492  		mess_send(MESS2RELE_HNDL,PARAM_RELE_BAT_IS_DISCHARGED,1,20);
006b0a  e8bd4070          POP      {r4-r6,lr}
006b0e  2314              MOVS     r3,#0x14
006b10  2201              MOVS     r2,#1
006b12  2172              MOVS     r1,#0x72
006b14  20d2              MOVS     r0,#0xd2
006b16  f7ffbffe          B.W      mess_send
                  |L1.27418|
;;;11493  		}
;;;11494  
;;;11495  	//bU_BAT2REL_AV_BAT=1;
;;;11496  	}
;;;11497  
;;;11498  
;;;11499  }
006b1a  bd70              POP      {r4-r6,pc}
;;;11500  
                          ENDP

                  vent_resurs_hndl PROC
;;;11501  //-----------------------------------------------
;;;11502  void vent_resurs_hndl(void)
006b1c  e92d47f0          PUSH     {r4-r10,lr}
;;;11503  {
;;;11504  char i;
;;;11505  char crc_in,crc_eval;
;;;11506  
;;;11507  for(i=0;i<NUMIST;i++)
006b20  f04f0200          MOV      r2,#0
;;;11508  	{
;;;11509  	if((bps[i]._buff[7]&0xc0)==0x00)
;;;11510  		{
;;;11511  		bps[i]._vent_resurs_temp[0]=bps[i]._buff[7];
;;;11512  		}
;;;11513  	else if((bps[i]._buff[7]&0xc0)==0x40)
;;;11514  		{
;;;11515  		bps[i]._vent_resurs_temp[1]=bps[i]._buff[7];
;;;11516  		}
;;;11517  	else if((bps[i]._buff[7]&0xc0)==0x80)
;;;11518  		{
;;;11519  		bps[i]._vent_resurs_temp[2]=bps[i]._buff[7];
;;;11520  		}
;;;11521  	else if((bps[i]._buff[7]&0xc0)==0xc0)
;;;11522  		{
;;;11523  		bps[i]._vent_resurs_temp[3]=bps[i]._buff[7];
;;;11524  		}
;;;11525  	crc_in=0;
;;;11526  	crc_in|=(bps[i]._vent_resurs_temp[0]&0x30)>>4;
;;;11527  	crc_in|=(bps[i]._vent_resurs_temp[1]&0x30)>>2;
;;;11528  	crc_in|=(bps[i]._vent_resurs_temp[2]&0x30);
;;;11529  	crc_in|=(bps[i]._vent_resurs_temp[3]&0x30)<<2;
;;;11530  
;;;11531  	crc_eval =bps[i]._vent_resurs_temp[0]&0x0f;
;;;11532  	crc_eval^=bps[i]._vent_resurs_temp[1]&0x0f;
;;;11533  	crc_eval^=bps[i]._vent_resurs_temp[2]&0x0f;
;;;11534  	crc_eval^=bps[i]._vent_resurs_temp[3]&0x0f;
;;;11535  
;;;11536  	if(crc_eval==crc_in)
;;;11537  		{
;;;11538  		unsigned short temp_US;
;;;11539  		temp_US=0;
;;;11540  
;;;11541  		temp_US|=(bps[i]._vent_resurs_temp[3]&0x0f);
;;;11542  		temp_US<<=4;
;;;11543  		temp_US|=(bps[i]._vent_resurs_temp[2]&0x0f);
;;;11544  		temp_US<<=4;
;;;11545  		temp_US|=(bps[i]._vent_resurs_temp[1]&0x0f);
;;;11546  		temp_US<<=4;
;;;11547  		temp_US|=(bps[i]._vent_resurs_temp[0]&0x0f);
;;;11548  
;;;11549  		if(bps[i]._vent_resurs!=temp_US)bps[i]._vent_resurs=temp_US;
;;;11550  		}
;;;11551  
;;;11552  	if((bps[i]._vent_resurs>TVENTMAX*10)&&(TVENTMAX>0))
006b24  48d0              LDR      r0,|L1.28264|
006b26  f8dfc344          LDR      r12,|L1.28268|
006b2a  f9b06000          LDRSH    r6,[r0,#0]
006b2e  48c3              LDR      r0,|L1.28220|
006b30  f9b07000          LDRSH    r7,[r0,#0]            ;11507
006b34  e06e              B        |L1.27668|
                  |L1.27446|
006b36  eb0200c2          ADD      r0,r2,r2,LSL #3       ;11509
006b3a  eb001002          ADD      r0,r0,r2,LSL #4       ;11509
006b3e  eb0c0080          ADD      r0,r12,r0,LSL #2      ;11509
006b42  7b41              LDRB     r1,[r0,#0xd]          ;11509
006b44  098b              LSRS     r3,r1,#6              ;11509
006b46  d006              BEQ      |L1.27478|
006b48  2301              MOVS     r3,#1                 ;11513
006b4a  ebb31f91          CMP      r3,r1,LSR #6          ;11513
006b4e  d105              BNE      |L1.27484|
006b50  f8801059          STRB     r1,[r0,#0x59]         ;11515
006b54  e00f              B        |L1.27510|
                  |L1.27478|
006b56  f8801058          STRB     r1,[r0,#0x58]         ;11511
006b5a  e00c              B        |L1.27510|
                  |L1.27484|
006b5c  2302              MOVS     r3,#2                 ;11517
006b5e  ebb31f91          CMP      r3,r1,LSR #6          ;11517
006b62  d102              BNE      |L1.27498|
006b64  f880105a          STRB     r1,[r0,#0x5a]         ;11519
006b68  e005              B        |L1.27510|
                  |L1.27498|
006b6a  2303              MOVS     r3,#3                 ;11521
006b6c  ebb31f91          CMP      r3,r1,LSR #6          ;11521
006b70  d101              BNE      |L1.27510|
006b72  f880105b          STRB     r1,[r0,#0x5b]         ;11523
                  |L1.27510|
006b76  f8101f58          LDRB     r1,[r0,#0x58]!        ;11526
006b7a  f3c11401          UBFX     r4,r1,#4,#2           ;11526
006b7e  7843              LDRB     r3,[r0,#1]            ;11527
006b80  f0030530          AND      r5,r3,#0x30           ;11527
006b84  ea440495          ORR      r4,r4,r5,LSR #2       ;11527
006b88  f8909002          LDRB     r9,[r0,#2]            ;11528
006b8c  f0090830          AND      r8,r9,#0x30           ;11528
006b90  ea480804          ORR      r8,r8,r4              ;11528
006b94  78c5              LDRB     r5,[r0,#3]            ;11529
006b96  f1a00058          SUB      r0,r0,#0x58           ;11529
006b9a  f0050430          AND      r4,r5,#0x30           ;11529
006b9e  ea480884          ORR      r8,r8,r4,LSL #2       ;11529
006ba2  f001010f          AND      r1,r1,#0xf            ;11531
006ba6  f003040f          AND      r4,r3,#0xf            ;11532
006baa  ea840a01          EOR      r10,r4,r1             ;11532
006bae  f009030f          AND      r3,r9,#0xf            ;11533
006bb2  ea83090a          EOR      r9,r3,r10             ;11533
006bb6  f005050f          AND      r5,r5,#0xf            ;11534
006bba  ea850909          EOR      r9,r5,r9              ;11534
006bbe  45c1              CMP      r9,r8                 ;11536
006bc0  d113              BNE      |L1.27626|
006bc2  ea4f1505          LSL      r5,r5,#4              ;11542
006bc6  ea430305          ORR      r3,r3,r5              ;11543
006bca  ea4f1303          LSL      r3,r3,#4              ;11544
006bce  ea440403          ORR      r4,r4,r3              ;11545
006bd2  ea4f5304          LSL      r3,r4,#20             ;11546
006bd6  ea4f4313          LSR      r3,r3,#16             ;11546
006bda  ea410103          ORR      r1,r1,r3              ;11547
006bde  f8b0305c          LDRH     r3,[r0,#0x5c]         ;11549
006be2  428b              CMP      r3,r1                 ;11549
006be4  d001              BEQ      |L1.27626|
006be6  f8a0105c          STRH     r1,[r0,#0x5c]         ;11549
                  |L1.27626|
006bea  f8b0105c          LDRH     r1,[r0,#0x5c]
006bee  eb060386          ADD      r3,r6,r6,LSL #2
006bf2  ebb10f43          CMP      r1,r3,LSL #1
006bf6  dd06              BLE      |L1.27654|
006bf8  2e00              CMP      r6,#0
006bfa  dd04              BLE      |L1.27654|
;;;11553  		{
;;;11554  		bps[i]._av|=(1<<4);
006bfc  7841              LDRB     r1,[r0,#1]
006bfe  f0410110          ORR      r1,r1,#0x10
006c02  7041              STRB     r1,[r0,#1]
006c04  e003              B        |L1.27662|
                  |L1.27654|
;;;11555  		}
;;;11556  	else bps[i]._av&=~(1<<4);
006c06  7841              LDRB     r1,[r0,#1]
006c08  f0210110          BIC      r1,r1,#0x10
006c0c  7041              STRB     r1,[r0,#1]
                  |L1.27662|
006c0e  f1020201          ADD      r2,r2,#1              ;11507
006c12  b2d2              UXTB     r2,r2                 ;11507
                  |L1.27668|
006c14  42ba              CMP      r2,r7                 ;11507
006c16  db8e              BLT      |L1.27446|
;;;11557  	}
;;;11558  }
006c18  e8bd87f0          POP      {r4-r10,pc}
;;;11559  
                          ENDP

                  vent_hndl PROC
;;;11560  //-----------------------------------------------
;;;11561  void vent_hndl(void)
006c1c  e92d4ff0          PUSH     {r4-r11,lr}
;;;11562  {
006c20  b087              SUB      sp,sp,#0x1c
;;;11563  if(RELEVENTSIGN==rvsAKB)
006c22  4893              LDR      r0,|L1.28272|
;;;11564  	{
;;;11565  	if(vent_stat==0)
006c24  4c86              LDR      r4,|L1.28224|
;;;11566  		{
;;;11567  		if	(
;;;11568  			(BAT_IS_ON[0]==bisON)&&((bat[0]._Tb>TVENTON)||(bat[0]._nd))
006c26  4993              LDR      r1,|L1.28276|
;;;11569  			||
;;;11570  			(BAT_IS_ON[1]==bisON)&&((bat[1]._Tb>TVENTON)||(bat[1]._nd))
;;;11571  			)
;;;11572  			{
;;;11573  			vent_stat=1;
;;;11574  			}
;;;11575  		}
;;;11576  	else if(vent_stat==1)
;;;11577  		{
;;;11578  		if	(
;;;11579  			((BAT_IS_ON[0]!=bisON)||((BAT_IS_ON[0]==bisON)&&(bat[0]._Tb<TVENTOFF)&&(!bat[0]._nd)))
006c28  4a93              LDR      r2,|L1.28280|
006c2a  7800              LDRB     r0,[r0,#0]            ;11563  ; RELEVENTSIGN
006c2c  f9943000          LDRSB    r3,[r4,#0]            ;11565
006c30  f9b11000          LDRSH    r1,[r1,#0]            ;11568
006c34  f9b22000          LDRSH    r2,[r2,#0]
006c38  b148              CBZ      r0,|L1.27726|
;;;11580  			&&
;;;11581  			((BAT_IS_ON[1]!=bisON)||((BAT_IS_ON[1]==bisON)&&(bat[1]._Tb<TVENTOFF)&&(!bat[1]._nd)))
;;;11582  			)
;;;11583  			{
;;;11584  			vent_stat=0;
;;;11585  			}
;;;11586  		}
;;;11587  	}
;;;11588  else if(RELEVENTSIGN==rvsBPS)
006c3a  2802              CMP      r0,#2
006c3c  d03c              BEQ      |L1.27832|
;;;11589  	{
;;;11590  /*	if	(
;;;11591  		(((bps[0]._flags_tm&0x06)||(bps[0]._cnt>=30)))||
;;;11592  		(((bps[1]._flags_tm&0x06)||(bps[1]._cnt>=30))&&(NUMIST>1))||
;;;11593  		(((bps[2]._flags_tm&0x06)||(bps[2]._cnt>=30))&&(NUMIST>2))||
;;;11594  		(((bps[3]._flags_tm&0x06)||(bps[3]._cnt>=30))&&(NUMIST>3))||
;;;11595  		(((bps[4]._flags_tm&0x06)||(bps[4]._cnt>=30))&&(NUMIST>4))||
;;;11596  		(((bps[5]._flags_tm&0x06)||(bps[5]._cnt>=30))&&(NUMIST>5))||
;;;11597  		(((bps[6]._flags_tm&0x06)||(bps[6]._cnt>=30))&&(NUMIST>6))
;;;11598  		)
;;;11599  		{
;;;11600  		vent_stat=1;
;;;11601  		}
;;;11602  	else vent_stat=0;
;;;11603  	*/
;;;11604  
;;;11605  	if	(
;;;11606  		((NUMIST)&&((bps[0]._Ti>TVENTON)||(bps[0]._cnt>=30)))
;;;11607  		||
;;;11608  		((NUMIST>1)&&((bps[1]._Ti>TVENTON)||(bps[1]._cnt>=30)))
;;;11609  		||
;;;11610  		((NUMIST>2)&&((bps[2]._Ti>TVENTON)||(bps[2]._cnt>=30)))
;;;11611  		||
;;;11612  		((NUMIST>3)&&((bps[3]._Ti>TVENTON)||(bps[3]._cnt>=30)))
;;;11613  		||
;;;11614  		((NUMIST>4)&&((bps[4]._Ti>TVENTON)||(bps[4]._cnt>=30)))
;;;11615  		||
;;;11616  		((NUMIST>5)&&((bps[5]._Ti>TVENTON)||(bps[5]._cnt>=30)))
;;;11617  		||
;;;11618  		((NUMIST>6)&&((bps[6]._Ti>TVENTON)||(bps[6]._cnt>=30)))
;;;11619  		||
;;;11620  		((NUMIST>7)&&((bps[7]._Ti>TVENTON)||(bps[7]._cnt>=30)))
;;;11621  		)
;;;11622  		{
;;;11623  		vent_stat=1;
;;;11624  		}
;;;11625  	else if(vent_stat==1)
;;;11626  		{
;;;11627  		if	(
;;;11628  			((!NUMIST)||((NUMIST)&&(bps[0]._Ti<TVENTOFF)&&(bps[0]._cnt<10)))
;;;11629  			&&
;;;11630  			((NUMIST<2)||((NUMIST>=2)&&(bps[1]._Ti<TVENTOFF)&&(bps[1]._cnt<10)))
;;;11631  			&&
;;;11632  			((NUMIST<3)||((NUMIST>=3)&&(bps[2]._Ti<TVENTOFF)&&(bps[2]._cnt<10)))
;;;11633  			&&
;;;11634  			((NUMIST<4)||((NUMIST>=4)&&(bps[3]._Ti<TVENTOFF)&&(bps[3]._cnt<10)))
;;;11635  			&&
;;;11636  			((NUMIST<5)||((NUMIST>=5)&&(bps[4]._Ti<TVENTOFF)&&(bps[4]._cnt<10)))
;;;11637  			&&
;;;11638  			((NUMIST<6)||((NUMIST>=6)&&(bps[5]._Ti<TVENTOFF)&&(bps[5]._cnt<10)))
;;;11639  			&&
;;;11640  			((NUMIST<7)||((NUMIST>=7)&&(bps[6]._Ti<TVENTOFF)&&(bps[6]._cnt<10)))
;;;11641  			&&
;;;11642  			((NUMIST<8)||((NUMIST>=8)&&(bps[7]._Ti<TVENTOFF)&&(bps[7]._cnt<10)))
;;;11643  			)
;;;11644  			{
;;;11645  			vent_stat=0;
;;;11646  			}
;;;11647  		}
;;;11648  	}
;;;11649  else if(RELEVENTSIGN==rvsEXT)
006c3e  2801              CMP      r0,#1
006c40  d07e              BEQ      |L1.27968|
;;;11650  	{
;;;11651  	if	(
;;;11652  		((NUMDT)&&((t_ext[0]>TVENTON)||(ND_EXT[0])))
;;;11653  		||
;;;11654  		((NUMDT>1)&&((t_ext[1]>TVENTON)||(ND_EXT[1])))
;;;11655  		||
;;;11656  		((NUMDT>2)&&((t_ext[2]>TVENTON)||(ND_EXT[2])))
;;;11657  		)
;;;11658  		{
;;;11659  		vent_stat=1;
;;;11660  		}
;;;11661  	else if(vent_stat==1)
;;;11662  		{
;;;11663  		if	(
;;;11664  			((!NUMDT)||((NUMDT)&&(t_ext[0]<TVENTOFF)&&(!ND_EXT[0])))
;;;11665  			&&
;;;11666  			((NUMDT<2)||((NUMDT>=2)&&(t_ext[1]<TVENTOFF)&&(!ND_EXT[1])))
;;;11667  			&&
;;;11668  			((NUMDT<3)||((NUMDT>=3)&&(t_ext[2]<TVENTOFF)&&(!ND_EXT[2])))
;;;11669  			)
;;;11670  			{
;;;11671  			vent_stat=0;
;;;11672  			}
;;;11673  		}
;;;11674  	}
;;;11675  else vent_stat=1;
006c42  f04f0001          MOV      r0,#1
006c46  7020              STRB     r0,[r4,#0]
                  |L1.27720|
;;;11676  }
006c48  b007              ADD      sp,sp,#0x1c
006c4a  e8bd8ff0          POP      {r4-r11,pc}
                  |L1.27726|
006c4e  4f8b              LDR      r7,|L1.28284|
006c50  f8df822c          LDR      r8,|L1.28288|
006c54  f9b7000a          LDRSH    r0,[r7,#0xa]          ;11568
006c58  7b3d              LDRB     r5,[r7,#0xc]          ;11568
006c5a  f9b76056          LDRSH    r6,[r7,#0x56]         ;11570
006c5e  f898c000          LDRB     r12,[r8,#0]           ;11567
006c62  f8977058          LDRB     r7,[r7,#0x58]         ;11570
006c66  f8988001          LDRB     r8,[r8,#1]            ;11570
006c6a  b12b              CBZ      r3,|L1.27768|
006c6c  2b01              CMP      r3,#1                 ;11576
006c6e  d1eb              BNE      |L1.27720|
006c70  f1bc0f55          CMP      r12,#0x55             ;11578
006c74  d115              BNE      |L1.27810|
006c76  e010              B        |L1.27802|
                  |L1.27768|
006c78  f1bc0f55          CMP      r12,#0x55             ;11567
006c7c  d102              BNE      |L1.27780|
006c7e  4288              CMP      r0,r1                 ;11568
006c80  dc07              BGT      |L1.27794|
006c82  b935              CBNZ     r5,|L1.27794|
                  |L1.27780|
006c84  f1b80f55          CMP      r8,#0x55              ;11570
006c88  d1de              BNE      |L1.27720|
006c8a  428e              CMP      r6,r1                 ;11570
006c8c  dc01              BGT      |L1.27794|
006c8e  2f00              CMP      r7,#0                 ;11570
006c90  d0da              BEQ      |L1.27720|
                  |L1.27794|
006c92  f04f0001          MOV      r0,#1                 ;11573
006c96  7020              STRB     r0,[r4,#0]            ;11573
006c98  e7d6              B        |L1.27720|
                  |L1.27802|
006c9a  4290              CMP      r0,r2                 ;11579
006c9c  dad4              BGE      |L1.27720|
006c9e  2d00              CMP      r5,#0                 ;11579
006ca0  d1d2              BNE      |L1.27720|
                  |L1.27810|
006ca2  f1b80f55          CMP      r8,#0x55              ;11581
006ca6  d103              BNE      |L1.27824|
006ca8  4296              CMP      r6,r2                 ;11581
006caa  dacd              BGE      |L1.27720|
006cac  2f00              CMP      r7,#0                 ;11581
006cae  d1cb              BNE      |L1.27720|
                  |L1.27824|
006cb0  f04f0000          MOV      r0,#0                 ;11584
006cb4  7020              STRB     r0,[r4,#0]            ;11584
006cb6  e7c7              B        |L1.27720|
                  |L1.27832|
006cb8  4e6c              LDR      r6,|L1.28268|
006cba  4860              LDR      r0,|L1.28220|
006cbc  6ab5              LDR      r5,[r6,#0x28]         ;11606
006cbe  f9b00000          LDRSH    r0,[r0,#0]            ;11605  ; NUMIST
006cc2  78f6              LDRB     r6,[r6,#3]            ;11606
006cc4  b118              CBZ      r0,|L1.27854|
006cc6  428d              CMP      r5,r1                 ;11606
006cc8  dc7a              BGT      |L1.28096|
006cca  2e1e              CMP      r6,#0x1e              ;11606
006ccc  d278              BCS      |L1.28096|
                  |L1.27854|
006cce  f8dfc19c          LDR      r12,|L1.28268|
006cd2  2801              CMP      r0,#1                 ;11608
006cd4  f8dc708c          LDR      r7,[r12,#0x8c]        ;11608
006cd8  f89cc067          LDRB     r12,[r12,#0x67]       ;11608
006cdc  f8cdc018          STR      r12,[sp,#0x18]        ;11608
006ce0  dd06              BLE      |L1.27888|
006ce2  428f              CMP      r7,r1                 ;11608
006ce4  dc6c              BGT      |L1.28096|
006ce6  f8ddc018          LDR      r12,[sp,#0x18]        ;11608
006cea  f1bc0f1e          CMP      r12,#0x1e             ;11608
006cee  d267              BCS      |L1.28096|
                  |L1.27888|
006cf0  f8dfc178          LDR      r12,|L1.28268|
006cf4  2802              CMP      r0,#2                 ;11610
006cf6  f8dc80f0          LDR      r8,[r12,#0xf0]        ;11610
006cfa  f8cd8014          STR      r8,[sp,#0x14]         ;11610
006cfe  f89cc0cb          LDRB     r12,[r12,#0xcb]       ;11610
006d02  f8cdc010          STR      r12,[sp,#0x10]        ;11610
006d06  dd08              BLE      |L1.27930|
006d08  f8ddc014          LDR      r12,[sp,#0x14]        ;11610
006d0c  458c              CMP      r12,r1                ;11610
006d0e  dc57              BGT      |L1.28096|
006d10  f8ddc010          LDR      r12,[sp,#0x10]        ;11610
006d14  f1bc0f1e          CMP      r12,#0x1e             ;11610
006d18  d252              BCS      |L1.28096|
                  |L1.27930|
006d1a  f8dfc150          LDR      r12,|L1.28268|
006d1e  2803              CMP      r0,#3                 ;11612
006d20  f8dc8154          LDR      r8,[r12,#0x154]       ;11612
006d24  f8cd800c          STR      r8,[sp,#0xc]          ;11612
006d28  f89cc12f          LDRB     r12,[r12,#0x12f]      ;11612
006d2c  f8cdc008          STR      r12,[sp,#8]           ;11612
006d30  dd0a              BLE      |L1.27976|
006d32  f8ddc00c          LDR      r12,[sp,#0xc]         ;11612
006d36  458c              CMP      r12,r1                ;11612
006d38  dc42              BGT      |L1.28096|
006d3a  f8ddc008          LDR      r12,[sp,#8]           ;11612
006d3e  e000              B        |L1.27970|
                  |L1.27968|
006d40  e0a5              B        |L1.28302|
                  |L1.27970|
006d42  f1bc0f1e          CMP      r12,#0x1e             ;11612
006d46  d23b              BCS      |L1.28096|
                  |L1.27976|
006d48  f8df8120          LDR      r8,|L1.28268|
006d4c  2804              CMP      r0,#4                 ;11614
006d4e  f8d8c1b8          LDR      r12,[r8,#0x1b8]       ;11614
006d52  f8988193          LDRB     r8,[r8,#0x193]        ;11614
006d56  f8cd8004          STR      r8,[sp,#4]            ;11614
006d5a  dd06              BLE      |L1.28010|
006d5c  458c              CMP      r12,r1                ;11614
006d5e  dc2f              BGT      |L1.28096|
006d60  f8dd8004          LDR      r8,[sp,#4]            ;11614
006d64  f1b80f1e          CMP      r8,#0x1e              ;11614
006d68  d22a              BCS      |L1.28096|
                  |L1.28010|
006d6a  f8df9100          LDR      r9,|L1.28268|
006d6e  2805              CMP      r0,#5                 ;11616
006d70  f8d9821c          LDR      r8,[r9,#0x21c]        ;11616
006d74  f89991f7          LDRB     r9,[r9,#0x1f7]        ;11616
006d78  f8cd9000          STR      r9,[sp,#0]            ;11616
006d7c  dd06              BLE      |L1.28044|
006d7e  4588              CMP      r8,r1                 ;11616
006d80  dc1e              BGT      |L1.28096|
006d82  f8dd9000          LDR      r9,[sp,#0]            ;11616
006d86  f1b90f1e          CMP      r9,#0x1e              ;11616
006d8a  d219              BCS      |L1.28096|
                  |L1.28044|
006d8c  f8dfa0dc          LDR      r10,|L1.28268|
006d90  2806              CMP      r0,#6                 ;11618
006d92  f89ae25b          LDRB     lr,[r10,#0x25b]       ;11618
006d96  f8da9280          LDR      r9,[r10,#0x280]       ;11618
006d9a  dd04              BLE      |L1.28070|
006d9c  4589              CMP      r9,r1                 ;11618
006d9e  dc0f              BGT      |L1.28096|
006da0  f1be0f1e          CMP      lr,#0x1e              ;11618
006da4  d20c              BCS      |L1.28096|
                  |L1.28070|
006da6  f8dfb0c4          LDR      r11,|L1.28268|
006daa  2807              CMP      r0,#7                 ;11620
006dac  f8dba2e4          LDR      r10,[r11,#0x2e4]      ;11620
006db0  f89bb2bf          LDRB     r11,[r11,#0x2bf]      ;11620
006db4  dd08              BLE      |L1.28104|
006db6  458a              CMP      r10,r1                ;11620
006db8  dc02              BGT      |L1.28096|
006dba  f1bb0f1e          CMP      r11,#0x1e             ;11620
006dbe  d303              BCC      |L1.28104|
                  |L1.28096|
006dc0  f04f0001          MOV      r0,#1                 ;11623
006dc4  7020              STRB     r0,[r4,#0]            ;11623
                  |L1.28102|
006dc6  e73f              B        |L1.27720|
                  |L1.28104|
006dc8  2b01              CMP      r3,#1                 ;11625
006dca  d1fc              BNE      |L1.28102|
006dcc  b118              CBZ      r0,|L1.28118|
006dce  4295              CMP      r5,r2                 ;11628
006dd0  daf9              BGE      |L1.28102|
006dd2  2e0a              CMP      r6,#0xa               ;11628
006dd4  d2f7              BCS      |L1.28102|
                  |L1.28118|
006dd6  2802              CMP      r0,#2                 ;11630
006dd8  db04              BLT      |L1.28132|
006dda  4297              CMP      r7,r2                 ;11630
006ddc  daf3              BGE      |L1.28102|
006dde  9906              LDR      r1,[sp,#0x18]         ;11630
006de0  290a              CMP      r1,#0xa               ;11630
006de2  d2f0              BCS      |L1.28102|
                  |L1.28132|
006de4  2803              CMP      r0,#3                 ;11632
006de6  db05              BLT      |L1.28148|
006de8  9905              LDR      r1,[sp,#0x14]         ;11632
006dea  4291              CMP      r1,r2                 ;11632
006dec  daeb              BGE      |L1.28102|
006dee  9904              LDR      r1,[sp,#0x10]         ;11632
006df0  290a              CMP      r1,#0xa               ;11632
006df2  d2e8              BCS      |L1.28102|
                  |L1.28148|
006df4  2804              CMP      r0,#4                 ;11634
006df6  db05              BLT      |L1.28164|
006df8  9903              LDR      r1,[sp,#0xc]          ;11634
006dfa  4291              CMP      r1,r2                 ;11634
006dfc  dae3              BGE      |L1.28102|
006dfe  9902              LDR      r1,[sp,#8]            ;11634
006e00  290a              CMP      r1,#0xa               ;11634
006e02  d2e0              BCS      |L1.28102|
                  |L1.28164|
006e04  2805              CMP      r0,#5                 ;11636
006e06  db04              BLT      |L1.28178|
006e08  4594              CMP      r12,r2                ;11636
006e0a  dadc              BGE      |L1.28102|
006e0c  9901              LDR      r1,[sp,#4]            ;11636
006e0e  290a              CMP      r1,#0xa               ;11636
006e10  d2d9              BCS      |L1.28102|
                  |L1.28178|
006e12  2806              CMP      r0,#6                 ;11638
006e14  db04              BLT      |L1.28192|
006e16  4590              CMP      r8,r2                 ;11638
006e18  dad5              BGE      |L1.28102|
006e1a  9900              LDR      r1,[sp,#0]            ;11638
006e1c  290a              CMP      r1,#0xa               ;11638
006e1e  d2d2              BCS      |L1.28102|
                  |L1.28192|
006e20  2807              CMP      r0,#7                 ;11640
006e22  db04              BLT      |L1.28206|
006e24  4591              CMP      r9,r2                 ;11640
006e26  dace              BGE      |L1.28102|
006e28  f1be0f0a          CMP      lr,#0xa               ;11640
006e2c  d2cb              BCS      |L1.28102|
                  |L1.28206|
006e2e  2808              CMP      r0,#8                 ;11642
006e30  db29              BLT      |L1.28294|
006e32  4592              CMP      r10,r2                ;11642
006e34  dac7              BGE      |L1.28102|
006e36  f1bb0f0a          CMP      r11,#0xa              ;11642
006e3a  e023              B        |L1.28292|
                  |L1.28220|
                          DCD      NUMIST
                  |L1.28224|
                          DCD      ||area_number.26||
                  |L1.28228|
                          DCD      load_U
                  |L1.28232|
                          DCD      U_OUT_KONTR_MAX
                  |L1.28236|
                          DCD      outVoltContrHndlCnt
                  |L1.28240|
                          DCD      outVoltContrHndlCnt_
                  |L1.28244|
                          DCD      U_OUT_KONTR_MIN
                  |L1.28248|
                          DCD      U_OUT_KONTR_DELAY
                  |L1.28252|
                          DCD      uout_av
                  |L1.28256|
                          DCD      USIGN
                  |L1.28260|
                          DCD      bSILENT
                  |L1.28264|
                          DCD      TVENTMAX
                  |L1.28268|
                          DCD      bps
                  |L1.28272|
                          DCD      RELEVENTSIGN
                  |L1.28276|
                          DCD      TVENTON
                  |L1.28280|
                          DCD      TVENTOFF
                  |L1.28284|
                          DCD      bat
                  |L1.28288|
                          DCD      BAT_IS_ON
                  |L1.28292|
006e84  d29f              BCS      |L1.28102|
                  |L1.28294|
006e86  f04f0000          MOV      r0,#0                 ;11645
006e8a  7020              STRB     r0,[r4,#0]            ;11645
                  |L1.28300|
006e8c  e6dc              B        |L1.27720|
                  |L1.28302|
006e8e  4823              LDR      r0,|L1.28444|
006e90  4d23              LDR      r5,|L1.28448|
006e92  4e24              LDR      r6,|L1.28452|
006e94  f9b00000          LDRSH    r0,[r0,#0]            ;11651  ; NUMDT
006e98  f9b55000          LDRSH    r5,[r5,#0]            ;11652
006e9c  7836              LDRB     r6,[r6,#0]            ;11652
006e9e  b110              CBZ      r0,|L1.28326|
006ea0  428d              CMP      r5,r1                 ;11652
006ea2  dc1d              BGT      |L1.28384|
006ea4  b9e6              CBNZ     r6,|L1.28384|
                  |L1.28326|
006ea6  4f1e              LDR      r7,|L1.28448|
006ea8  f8dfc078          LDR      r12,|L1.28452|
006eac  2801              CMP      r0,#1                 ;11654
006eae  f9b77002          LDRSH    r7,[r7,#2]            ;11654
006eb2  f89cc001          LDRB     r12,[r12,#1]          ;11654
006eb6  dd04              BLE      |L1.28354|
006eb8  428f              CMP      r7,r1                 ;11654
006eba  dc11              BGT      |L1.28384|
006ebc  f1bc0f00          CMP      r12,#0                ;11654
006ec0  d10e              BNE      |L1.28384|
                  |L1.28354|
006ec2  f8df805c          LDR      r8,|L1.28448|
006ec6  f8df905c          LDR      r9,|L1.28452|
006eca  2802              CMP      r0,#2                 ;11656
006ecc  f9b88004          LDRSH    r8,[r8,#4]            ;11656
006ed0  f8999002          LDRB     r9,[r9,#2]            ;11656
006ed4  dd08              BLE      |L1.28392|
006ed6  4588              CMP      r8,r1                 ;11656
006ed8  dc02              BGT      |L1.28384|
006eda  f1b90f00          CMP      r9,#0                 ;11656
006ede  d003              BEQ      |L1.28392|
                  |L1.28384|
006ee0  f04f0001          MOV      r0,#1                 ;11659
006ee4  7020              STRB     r0,[r4,#0]            ;11659
006ee6  e6af              B        |L1.27720|
                  |L1.28392|
006ee8  2b01              CMP      r3,#1                 ;11661
006eea  d1cf              BNE      |L1.28300|
006eec  b118              CBZ      r0,|L1.28406|
006eee  4295              CMP      r5,r2                 ;11664
006ef0  dacc              BGE      |L1.28300|
006ef2  2e00              CMP      r6,#0                 ;11664
006ef4  d1ca              BNE      |L1.28300|
                  |L1.28406|
006ef6  2802              CMP      r0,#2                 ;11666
006ef8  db04              BLT      |L1.28420|
006efa  4297              CMP      r7,r2                 ;11666
006efc  dac6              BGE      |L1.28300|
006efe  f1bc0f00          CMP      r12,#0                ;11666
006f02  d1c3              BNE      |L1.28300|
                  |L1.28420|
006f04  2803              CMP      r0,#3                 ;11668
006f06  db04              BLT      |L1.28434|
006f08  4590              CMP      r8,r2                 ;11668
006f0a  dabf              BGE      |L1.28300|
006f0c  f1b90f00          CMP      r9,#0                 ;11668
006f10  d1bc              BNE      |L1.28300|
                  |L1.28434|
006f12  f04f0000          MOV      r0,#0                 ;11671
006f16  7020              STRB     r0,[r4,#0]            ;11671
006f18  e696              B        |L1.27720|
;;;11677  
                          ENDP

006f1a  0000              DCW      0x0000
                  |L1.28444|
                          DCD      NUMDT
                  |L1.28448|
                          DCD      t_ext
                  |L1.28452|
                          DCD      ND_EXT

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  samokalibr_init PROC
;;;326    // заполнение флагов для АКБ
;;;327    void bat_flag (void)
000000  4902              LDR      r1,|L2.12|
;;;328    {  
000002  f24060f9          MOV      r0,#0x6f9
;;;329    if(spc_stat!=spcVZ) 
;;;330    	{
;;;331    	vz_error=0;
000006  f8a10050          STRH     r0,[r1,#0x50]
00000a  4770              BX       lr                    ;329
;;;332    	sp_ch_error=0;
;;;333    	vz1_error=0;
;;;334    	vz2_error=0;
;;;335    	}
;;;336    
;;;337    if( (snmp_bat_status[0]==0 || snmp_bat_status[0]==2) && NUMBAT>0) 	//o_10 	 			//Батарея №1
;;;338    	{
;;;339    	if((bat[0]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
;;;340    		{
;;;341    		snmp_bat_flag[0]|=0x0001; 
;;;342    		if((snmp_bat_flag_puts[0]&0x0001)==0) 
;;;343    			{
;;;344    			snmp_trap_send("BAT #1 Alarm, battery is low",5,8,0); 
;;;345    			snmp_bat_flag_puts[0]|=0x0001;
;;;346    			}
;;;347    		}
;;;348    	else 
;;;349    		{
;;;350    		snmp_bat_flag[0]&=~0x0001; 
;;;351    		if(snmp_bat_flag_puts[0]&0x0001) 
;;;352    			{
;;;353    			snmp_trap_send("BAT #1 Alarm clear, battery is not low",5,8,1);
;;;354    			snmp_bat_flag_puts[0]&=~0x0001;
;;;355    			}
;;;356    		}
;;;357    
;;;358    	if(bat[0]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;359    		{
;;;360    		snmp_bat_flag[0]|=0x0002;
;;;361    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;362    			{
;;;363    			//snmp_trap_send("BAT #1 Warning, high battery temperature",5,8,2); 
;;;364    			snmp_bat_flag_puts[0]|=0x0002;
;;;365    			}
;;;366    		}
;;;367    	else 
;;;368    		{
;;;369    		snmp_bat_flag[0]&=~0x0002;
;;;370    		if(snmp_bat_flag_puts[0]&0x0002) 
;;;371    			{
;;;372    			//snmp_trap_send("BAT #1 Warning clear, battery temperature is normal",5,8,3);
;;;373    			snmp_bat_flag_puts[0]&=~0x02;
;;;374    			}
;;;375    		}
;;;376    
;;;377    	if(bat[0]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;378    		{
;;;379    		snmp_bat_flag[0]|=0x0004;
;;;380    		if((snmp_bat_flag_puts[0]&0x0004)==0) 
;;;381    			{
;;;382    			//snmp_trap_send("BAT #1 Alarm, high battery temperature",5,8,4); 
;;;383    			snmp_bat_flag_puts[0]|=0x0004;
;;;384    			}
;;;385    		}
;;;386    	else 
;;;387    		{
;;;388    		snmp_bat_flag[0]&=~0x0004;
;;;389    		if(snmp_bat_flag_puts[0]&0x0004) 
;;;390    			{
;;;391    			//snmp_trap_send("BAT #1 Alarm clear, battery temperature is normal",5,8,5);
;;;392    			snmp_bat_flag_puts[0]&=~0x0004;
;;;393    			}
;;;394    		}
;;;395    
;;;396    	if(bat[0]._Ib<(-IKB)) snmp_bat_flag[0]|=0x0008;		//Разряд батареи
;;;397    	else if(bat[0]._Ib>IKB) snmp_bat_flag[0]&=~0x0008;	//Заряд батареи
;;;398    
;;;399    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
;;;400    		{
;;;401    		snmp_bat_flag[0]|=0x0010;
;;;402    		if((snmp_bat_flag_puts[0]&0x0010)==0) 
;;;403    			{
;;;404    			snmp_trap_send("BAT #1, capacity test started",5,8,6); 
;;;405    			snmp_bat_flag_puts[0]|=0x0010;
;;;406    			}
;;;407    		}
;;;408    	else 
;;;409    		{
;;;410    		snmp_bat_flag[0]&=~0x0010;
;;;411    		if(snmp_bat_flag_puts[0]&0x0010) 
;;;412    			{
;;;413    			snmp_trap_send("BAT #1, capacity test stopped",5,8,7);
;;;414    			snmp_bat_flag_puts[0]&=~0x0010;
;;;415    			}
;;;416    		}
;;;417    		
;;;418    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
;;;419    		{
;;;420    		snmp_bat_flag[0]|=0x0020;
;;;421    		if((snmp_bat_flag_puts[0]&0x0020)==0) 
;;;422    			{
;;;423    			snmp_trap_send("BAT #1,leveling charge is started",5,8,8); 
;;;424    			snmp_bat_flag_puts[0]|=0x0020;
;;;425    			}
;;;426    		}
;;;427    	else 
;;;428    		{
;;;429    		snmp_bat_flag[0]&=~0x0020;
;;;430    		if(snmp_bat_flag_puts[0]&0x0020) 
;;;431    			{
;;;432    			snmp_trap_send("BAT #1,leveling charge is stopped",5,8,9);
;;;433    			snmp_bat_flag_puts[0]&=~0x0020;
;;;434    			}
;;;435    		}
;;;436    
;;;437    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
;;;438    		{
;;;439    		snmp_bat_flag[0]|=0x0040;
;;;440    		if((snmp_bat_flag_puts[0]&0x0040)==0) 
;;;441    			{
;;;442    			snmp_trap_send("BAT #1,leveling charge is blocked",5,8,10); 
;;;443    			snmp_bat_flag_puts[0]|=0x0040;
;;;444    			}
;;;445    		}
;;;446    	else 
;;;447    		{
;;;448    		snmp_bat_flag[0]&=~0x0040;
;;;449    		if(snmp_bat_flag_puts[0]&0x0040) 
;;;450    			{
;;;451    			snmp_trap_send("BAT #1,leveling charge is unblocked",5,8,11);
;;;452    			snmp_bat_flag_puts[0]&=~0x0040;
;;;453    			} 
;;;454    		}
;;;455    
;;;456    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
;;;457    		{
;;;458    		snmp_bat_flag[0]|=0x0080;
;;;459    		if((snmp_bat_flag_puts[0]&0x0080)==0) 
;;;460    			{
;;;461    			snmp_trap_send("BAT #1,speed charge is started",5,8,10); 
;;;462    			snmp_bat_flag_puts[0]|=0x0080;
;;;463    			}
;;;464    		}
;;;465    	else 
;;;466    		{
;;;467    		snmp_bat_flag[0]&=~0x0080;
;;;468    		if(snmp_bat_flag_puts[0]&0x0080) 
;;;469    			{
;;;470    			snmp_trap_send("BAT #1,speed charge is stopped",5,8,11);
;;;471    			snmp_bat_flag_puts[0]&=~0x0080;
;;;472    			}
;;;473    		}
;;;474    
;;;475    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
;;;476    		{
;;;477    		snmp_bat_flag[0]|=0x0100;
;;;478    		if((snmp_bat_flag_puts[0]&0x0100)==0) 
;;;479    			{
;;;480    			snmp_trap_send("BAT #1,speed charge is blocked",5,8,12); 
;;;481    			snmp_bat_flag_puts[0]|=0x0100;
;;;482    			}
;;;483    		}
;;;484    	else 
;;;485    		{
;;;486    		snmp_bat_flag[0]&=~0x0100;
;;;487    		if(snmp_bat_flag_puts[0]&0x0100) 
;;;488    			{
;;;489    			snmp_trap_send("BAT #1,speed charge is unblocked",5,8,13);
;;;490    			snmp_bat_flag_puts[0]&=~0x0100;
;;;491    			} 
;;;492    		}
;;;493    
;;;494    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;495    		{
;;;496    		snmp_bat_flag[0]|=0x0200;
;;;497    		if((snmp_bat_flag_puts[0]&0x0200)==0) 
;;;498    			{
;;;499    			snmp_trap_send("BAT #1,equalising charge is on",5,8,14); 
;;;500    			snmp_bat_flag_puts[0]|=0x0200;
;;;501    			}
;;;502    		}
;;;503    	else 
;;;504    		{
;;;505    		snmp_bat_flag[0]&=~0x0200;
;;;506    		if(snmp_bat_flag_puts[0]&0x0200) 
;;;507    			{
;;;508    			snmp_trap_send("BAT #1,equalising charge is off",5,8,15);
;;;509    			snmp_bat_flag_puts[0]&=~0x0200;
;;;510    			}
;;;511    		}
;;;512    
;;;513    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;514    		{
;;;515    		snmp_bat_flag[0]|=0x0400;
;;;516    		if((snmp_bat_flag_puts[0]&0x0400)==0) 
;;;517    			{
;;;518    			snmp_trap_send("BAT #1,equalising charge is blocked",5,8,16); 
;;;519    			snmp_bat_flag_puts[0]|=0x0400;
;;;520    			}
;;;521    		}
;;;522    	else 
;;;523    		{
;;;524    		snmp_bat_flag[0]&=~0x0400;
;;;525    		if(snmp_bat_flag_puts[0]&0x0400) 
;;;526    			{
;;;527    			snmp_trap_send("BAT #1,equalising charge is unblocked",5,8,17);
;;;528    			snmp_bat_flag_puts[0]&=~0x0400;
;;;529    			} 
;;;530    		}
;;;531    
;;;532    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;533    		{
;;;534    		snmp_bat_flag[0]|=0x0800;
;;;535    		if((snmp_bat_flag_puts[0]&0x0800)==0) 
;;;536    			{
;;;537    			snmp_trap_send("BAT #1,molding charge is on",5,8,18); 
;;;538    			snmp_bat_flag_puts[0]|=0x0800;
;;;539    			}
;;;540    		}
;;;541    	else 
;;;542    		{
;;;543    		snmp_bat_flag[0]&=~0x0800;
;;;544    		if(snmp_bat_flag_puts[0]&0x0800) 
;;;545    			{
;;;546    			snmp_trap_send("BAT #1,molding charge is off",5,8,19);
;;;547    			snmp_bat_flag_puts[0]&=~0x0800;
;;;548    			}
;;;549    		}
;;;550    
;;;551    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;552    		{
;;;553    		snmp_bat_flag[0]|=0x1000;
;;;554    		if((snmp_bat_flag_puts[0]&0x1000)==0) 
;;;555    			{
;;;556    			snmp_trap_send("BAT #1,molding charge is blocked",5,8,20); 
;;;557    			snmp_bat_flag_puts[0]|=0x1000;
;;;558    			}
;;;559    		}
;;;560    	else 
;;;561    		{
;;;562    		snmp_bat_flag[0]&=~0x1000;
;;;563    		if(snmp_bat_flag_puts[0]&0x1000) 
;;;564    			{
;;;565    			snmp_trap_send("BAT #1,molding charge is unblocked",5,8,21);
;;;566    			snmp_bat_flag_puts[0]&=~0x1000;
;;;567    			} 
;;;568    		}
;;;569    	}
;;;570    else 
;;;571    	{
;;;572    	snmp_bat_flag[0]=0; 
;;;573    	snmp_bat_flag_puts[0]=0;
;;;574    	}
;;;575    
;;;576    if( (snmp_bat_status[1]==0 || snmp_bat_status[1]==2) && NUMBAT==2 )	//o_10 
;;;577    	{
;;;578    	if((bat[1]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
;;;579    		{
;;;580    		snmp_bat_flag[1]|=0x0001; 
;;;581    		if((snmp_bat_flag_puts[1]&0x0001)==0) 
;;;582    			{
;;;583    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,22); 
;;;584    			snmp_bat_flag_puts[1]|=0x0001;
;;;585    			}
;;;586    		}
;;;587    	else 
;;;588    		{
;;;589    		snmp_bat_flag[1]&=~0x0001; 
;;;590    		if(snmp_bat_flag_puts[1]&0x0001) 
;;;591    			{
;;;592    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,23);
;;;593    			snmp_bat_flag_puts[1]&=~0x0001;
;;;594    			}
;;;595    		}
;;;596    
;;;597    	if(bat[1]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;598    		{
;;;599    		snmp_bat_flag[1]|=0x0002;
;;;600    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;601    			{
;;;602    			//snmp_trap_send("BAT #2 Warning, high battery temperature",5,8,24); 
;;;603    			snmp_bat_flag_puts[1]|=0x0002;
;;;604    			}
;;;605    		}
;;;606    	else 
;;;607    		{
;;;608    		snmp_bat_flag[1]&=~0x0002;
;;;609    		if(snmp_bat_flag_puts[1]&0x0002) 
;;;610    			{
;;;611    			//snmp_trap_send("BAT #2 Warning clear, battery temperature is normal",5,8,25);
;;;612    			snmp_bat_flag_puts[1]&=~0x02;
;;;613    			}
;;;614    		}
;;;615    
;;;616    	if(bat[1]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;617    		{
;;;618    		snmp_bat_flag[1]|=0x0004;
;;;619    		if((snmp_bat_flag_puts[1]&0x0004)==0) 
;;;620    			{
;;;621    			//snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,26); 
;;;622    			snmp_bat_flag_puts[1]|=0x0004;
;;;623    			}
;;;624    		}
;;;625    	else 
;;;626    		{
;;;627    		snmp_bat_flag[1]&=~0x0004;
;;;628    		if(snmp_bat_flag_puts[1]&0x0004) 
;;;629    			{
;;;630    			//snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,27);
;;;631    			snmp_bat_flag_puts[1]&=~0x0004;
;;;632    			}
;;;633    		}
;;;634    
;;;635    	if(bat[1]._Ib<(-IKB)) snmp_bat_flag[1]|=0x0008;		//Разряд батареи
;;;636    	else if(bat[1]._Ib>IKB) snmp_bat_flag[1]&=~0x0008;	//Заряд батареи
;;;637    
;;;638    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
;;;639    		{
;;;640    		snmp_bat_flag[1]|=0x0010;
;;;641    		if((snmp_bat_flag_puts[1]&0x0010)==0) 
;;;642    			{
;;;643    			snmp_trap_send("BAT #2, capacity test started",5,8,28); 
;;;644    			snmp_bat_flag_puts[1]|=0x0010;
;;;645    			}
;;;646    		}
;;;647    	else 
;;;648    		{
;;;649    		snmp_bat_flag[1]&=~0x0010;
;;;650    		if(snmp_bat_flag_puts[1]&0x0010) 
;;;651    			{
;;;652    			snmp_trap_send("BAT #2, capacity test stopped",5,8,29);
;;;653    			snmp_bat_flag_puts[1]&=~0x0010;
;;;654    			}
;;;655    		}
;;;656    		
;;;657    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
;;;658    		{
;;;659    		snmp_bat_flag[1]|=0x0020;
;;;660    		if((snmp_bat_flag_puts[1]&0x0020)==0) 
;;;661    			{
;;;662    			snmp_trap_send("BAT #2,leveling charge is started",5,8,30); 
;;;663    			snmp_bat_flag_puts[1]|=0x0020;
;;;664    			}
;;;665    		}
;;;666    	else 
;;;667    		{
;;;668    		snmp_bat_flag[1]&=~0x0020;
;;;669    		if(snmp_bat_flag_puts[1]&0x0020) 
;;;670    			{
;;;671    			snmp_trap_send("BAT #2,leveling charge is stopped",5,8,31);
;;;672    			snmp_bat_flag_puts[1]&=~0x0020;
;;;673    			}
;;;674    		}
;;;675    
;;;676    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
;;;677    		{
;;;678    		snmp_bat_flag[1]|=0x0040;
;;;679    		if((snmp_bat_flag_puts[1]&0x0040)==0) 
;;;680    			{
;;;681    			snmp_trap_send("BAT #2,leveling charge is blocked",5,8,32); 
;;;682    			snmp_bat_flag_puts[1]|=0x0040;
;;;683    			}
;;;684    		}
;;;685    	else 
;;;686    		{
;;;687    		snmp_bat_flag[1]&=~0x0040;
;;;688    		if(snmp_bat_flag_puts[1]&0x0040) 
;;;689    			{
;;;690    			snmp_trap_send("BAT #2,leveling charge is unblocked",5,8,33);
;;;691    			snmp_bat_flag_puts[1]&=~0x0040;
;;;692    			} 
;;;693    		}
;;;694    
;;;695    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
;;;696    		{
;;;697    		snmp_bat_flag[1]|=0x0080;
;;;698    		if((snmp_bat_flag_puts[1]&0x0080)==0) 
;;;699    			{
;;;700    			snmp_trap_send("BAT #2,speed charge is started",5,8,34); 
;;;701    			snmp_bat_flag_puts[1]|=0x0080;
;;;702    			}
;;;703    		}
;;;704    	else 
;;;705    		{
;;;706    		snmp_bat_flag[1]&=~0x0080;
;;;707    		if(snmp_bat_flag_puts[1]&0x0080) 
;;;708    			{
;;;709    			snmp_trap_send("BAT #2,speed charge is stopped",5,8,35);
;;;710    			snmp_bat_flag_puts[1]&=~0x0080;
;;;711    			}
;;;712    		}
;;;713    
;;;714    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
;;;715    		{
;;;716    		snmp_bat_flag[1]|=0x0100;
;;;717    		if((snmp_bat_flag_puts[1]&0x0100)==0) 
;;;718    			{
;;;719    			snmp_trap_send("BAT #2,speed charge is blocked",5,8,36); 
;;;720    			snmp_bat_flag_puts[1]|=0x0100;
;;;721    			}
;;;722    		}
;;;723    	else 
;;;724    		{
;;;725    		snmp_bat_flag[1]&=~0x0100;
;;;726    		if(snmp_bat_flag_puts[1]&0x0100) 
;;;727    			{
;;;728    			snmp_trap_send("BAT #2,speed charge is unblocked",5,8,37);
;;;729    			snmp_bat_flag_puts[1]&=~0x0100;
;;;730    			} 
;;;731    		}
;;;732    
;;;733    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;734    		{
;;;735    		snmp_bat_flag[1]|=0x0200;
;;;736    		if((snmp_bat_flag_puts[1]&0x0200)==0) 
;;;737    			{
;;;738    			snmp_trap_send("BAT #2,equalising charge is on",5,8,38); 
;;;739    			snmp_bat_flag_puts[1]|=0x0200;
;;;740    			}
;;;741    		}
;;;742    	else 
;;;743    		{
;;;744    		snmp_bat_flag[1]&=~0x0200;
;;;745    		if(snmp_bat_flag_puts[1]&0x0200) 
;;;746    			{
;;;747    			snmp_trap_send("BAT #2,equalising charge is off",5,8,39);
;;;748    			snmp_bat_flag_puts[1]&=~0x0200;
;;;749    			}
;;;750    		}
;;;751    
;;;752    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;753    		{
;;;754    		snmp_bat_flag[1]|=0x0400;
;;;755    		if((snmp_bat_flag_puts[1]&0x0400)==0) 
;;;756    			{
;;;757    			snmp_trap_send("BAT #2,equalising charge is blocked",5,8,40); 
;;;758    			snmp_bat_flag_puts[1]|=0x0400;
;;;759    			}
;;;760    		}
;;;761    	else 
;;;762    		{
;;;763    		snmp_bat_flag[1]&=~0x0400;
;;;764    		if(snmp_bat_flag_puts[1]&0x0400) 
;;;765    			{
;;;766    			snmp_trap_send("BAT #2,equalising charge is unblocked",5,8,41);
;;;767    			snmp_bat_flag_puts[1]&=~0x0400;
;;;768    			} 
;;;769    		}
;;;770    
;;;771    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;772    		{
;;;773    		snmp_bat_flag[1]|=0x0800;
;;;774    		if((snmp_bat_flag_puts[1]&0x0800)==0) 
;;;775    			{
;;;776    			snmp_trap_send("BAT #2,molding charge is on",5,8,42); 
;;;777    			snmp_bat_flag_puts[1]|=0x0800;
;;;778    			}
;;;779    		}
;;;780    	else 
;;;781    		{
;;;782    		snmp_bat_flag[1]&=~0x0800;
;;;783    		if(snmp_bat_flag_puts[1]&0x0800) 
;;;784    			{
;;;785    			snmp_trap_send("BAT #2,molding charge is off",5,8,43);
;;;786    			snmp_bat_flag_puts[1]&=~0x0800;
;;;787    			}
;;;788    		}
;;;789    
;;;790    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;791    		{
;;;792    		snmp_bat_flag[1]|=0x1000;
;;;793    		if((snmp_bat_flag_puts[1]&0x1000)==0) 
;;;794    			{
;;;795    			snmp_trap_send("BAT #2,molding charge is blocked",5,8,44); 
;;;796    			snmp_bat_flag_puts[1]|=0x1000;
;;;797    			}
;;;798    		}
;;;799    	else 
;;;800    		{
;;;801    		snmp_bat_flag[1]&=~0x1000;
;;;802    		if(snmp_bat_flag_puts[1]&0x1000) 
;;;803    			{
;;;804    			snmp_trap_send("BAT #2,molding charge is unblocked",5,8,45);
;;;805    			snmp_bat_flag_puts[1]&=~0x1000;
;;;806    			} 
;;;807    		}
;;;808    	}
;;;809    else 
;;;810    	{
;;;811    	snmp_bat_flag[1]=0; 
;;;812    	snmp_bat_flag_puts[1]=0;
;;;813    	}
;;;814    /*
;;;815    if(!snmp_bat_status[1])
;;;816    	{
;;;817    	if((bat[1]._Ub<(USIGN*10))) 
;;;818    		{
;;;819    		snmp_bat_flag[1]|=0x01; 
;;;820    		if((snmp_bat_flag_puts[1]&0x01)==0) 
;;;821    			{
;;;822    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,0); 
;;;823    			snmp_bat_flag_puts[1]|=0x01;
;;;824    			}
;;;825    		}
;;;826    	else 
;;;827    		{
;;;828    		snmp_bat_flag[1]&=~0x01; 
;;;829    		if(snmp_bat_flag_puts[1]&0x01) 
;;;830    			{
;;;831    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,1);
;;;832    			snmp_bat_flag_puts[1]&=~0x01;
;;;833    			}
;;;834    		}
;;;835    	if(bat[1]._temper_stat&0x01) 
;;;836    		{
;;;837    		snmp_bat_flag[1]|=0x02;
;;;838    		if((snmp_bat_flag_puts[1]&0x02)==0) 
;;;839    			{
;;;840    			snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,2); 
;;;841    			snmp_bat_flag_puts[1]|=0x02;
;;;842    			}
;;;843    		}
;;;844    	else 
;;;845    		{
;;;846    		snmp_bat_flag[1]&=~0x02;
;;;847    		if(snmp_bat_flag_puts[1]&0x02) 
;;;848    			{
;;;849    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,3);
;;;850    			snmp_bat_flag_puts[1]&=~0x02;
;;;851    			}
;;;852    		}
;;;853    	if(bat[1]._temper_stat&0x02) 
;;;854    		{
;;;855    		snmp_bat_flag[1]|=0x04;
;;;856    		if((snmp_bat_flag_puts[1]&0x04)==0) 
;;;857    			{
;;;858    			snmp_trap_send("BAT #2 Alarm, maximum battery temperature",5,8,4); 
;;;859    			snmp_bat_flag_puts[1]|=0x04;
;;;860    			}
;;;861    		}
;;;862    	else 
;;;863    		{
;;;864    		snmp_bat_flag[1]&=~0x04;
;;;865    		if(snmp_bat_flag_puts[1]&0x04) 
;;;866    			{
;;;867    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,5);
;;;868    			snmp_bat_flag_puts[1]&=~0x04;
;;;869    			}
;;;870    		}
;;;871    		
;;;872    	if(bat[1]._Ib<(-IKB))	snmp_bat_flag[1]|=0x80;
;;;873    	else if(bat[1]._Ib>IKB)snmp_bat_flag[1]&=~0x80;
;;;874    
;;;875    	if((spc_stat==spcKE)&&(spc_bat==1)) 
;;;876    		{
;;;877    		snmp_bat_flag[1]|=0x10;
;;;878    		if((snmp_bat_flag_puts[1]&0x10)==0) 
;;;879    			{
;;;880    			snmp_trap_send("BAT #2, capacity check enabled",5,8,6); 
;;;881    			snmp_bat_flag_puts[1]|=0x10;
;;;882    			}
;;;883    		}
;;;884    	else 
;;;885    		{
;;;886    		snmp_bat_flag[1]&=~0x10;
;;;887    		if(snmp_bat_flag_puts[1]&0x10) 
;;;888    			{
;;;889    			snmp_trap_send("BAT #2, capacity check disabled",5,8,7);
;;;890    			snmp_bat_flag_puts[1]&=~0x10;
;;;891    			}
;;;892    		}
;;;893    		
;;;894    	if(spc_stat==spcVZ) 
;;;895    		{
;;;896    		snmp_bat_flag[1]|=0x20;
;;;897    		if((snmp_bat_flag_puts[1]&0x20)==0) 
;;;898    			{
;;;899    			snmp_trap_send("BAT #2,equalizing charge is on",5,8,8); 
;;;900    			snmp_bat_flag_puts[1]|=0x20;
;;;901    			}
;;;902    		}
;;;903    	else 
;;;904    		{
;;;905    		snmp_bat_flag[1]&=~0x20;
;;;906    		if(snmp_bat_flag_puts[1]&0x20) 
;;;907    			{
;;;908    			snmp_trap_send("BAT #2,equalizing charge is off",5,8,9);
;;;909    			snmp_bat_flag_puts[1]&=~0x20;
;;;910    			}
;;;911    		}
;;;912    
;;;913    	if(vz_error) 
;;;914    		{
;;;915    		snmp_bat_flag[1]|=0x40;
;;;916    		if((snmp_bat_flag_puts[1]&0x40)==0) 
;;;917    			{
;;;918    			snmp_trap_send("BAT #2,equalizing charge blocked",5,8,10); 
;;;919    			snmp_bat_flag_puts[1]|=0x40;
;;;920    			}
;;;921    		}
;;;922    	else 
;;;923    		{
;;;924    		snmp_bat_flag[1]&=~0x40;
;;;925    		if(snmp_bat_flag_puts[1]&0x40) 
;;;926    			{
;;;927    			snmp_trap_send("BAT #2,equalizing charge is not blocked",5,8,11);
;;;928    			snmp_bat_flag_puts[1]&=~0x40;
;;;929    			} 
;;;930    		}
;;;931       }
;;;932    else 
;;;933    	{
;;;934    	snmp_bat_flag[1]=0; 
;;;935    	snmp_bat_flag_puts[1]=0;
;;;936    	} */
;;;937    }
;;;938    
                          ENDP

                  |L2.12|
                          DCD      ||area_number.26||

                          AREA ||area_number.3||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.3||, ||.text||
                  adc_drv6 PROC
;;;326    // заполнение флагов для АКБ
;;;327    void bat_flag (void)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;328    {  
;;;329    if(spc_stat!=spcVZ) 
000004  4c82              LDR      r4,|L3.528|
;;;330    	{
;;;331    	vz_error=0;
000006  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
000008  8821              LDRH     r1,[r4,#0]            ;329  ; adc_self_ch_buff
00000a  1a40              SUBS     r0,r0,r1              ;329
00000c  b200              SXTH     r0,r0                 ;329
00000e  f7fffffe          BL       abs_pal
;;;332    	sp_ch_error=0;
000012  1da5              ADDS     r5,r4,#6
;;;333    	vz1_error=0;
000014  8028              STRH     r0,[r5,#0]
;;;334    	vz2_error=0;
000016  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
;;;335    	}
;;;336    
;;;337    if( (snmp_bat_status[0]==0 || snmp_bat_status[0]==2) && NUMBAT>0) 	//o_10 	 			//Батарея №1
000018  8861              LDRH     r1,[r4,#2]  ; adc_self_ch_buff
00001a  1a40              SUBS     r0,r0,r1
00001c  b200              SXTH     r0,r0
00001e  f7fffffe          BL       abs_pal
;;;338    	{
;;;339    	if((bat[0]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
000022  8068              STRH     r0,[r5,#2]
000024  88a0              LDRH     r0,[r4,#4]            ;337  ; adc_self_ch_buff
000026  8821              LDRH     r1,[r4,#0]            ;337  ; adc_self_ch_buff
;;;340    		{
;;;341    		snmp_bat_flag[0]|=0x0001; 
;;;342    		if((snmp_bat_flag_puts[0]&0x0001)==0) 
;;;343    			{
;;;344    			snmp_trap_send("BAT #1 Alarm, battery is low",5,8,0); 
;;;345    			snmp_bat_flag_puts[0]|=0x0001;
;;;346    			}
;;;347    		}
;;;348    	else 
;;;349    		{
;;;350    		snmp_bat_flag[0]&=~0x0001; 
;;;351    		if(snmp_bat_flag_puts[0]&0x0001) 
;;;352    			{
;;;353    			snmp_trap_send("BAT #1 Alarm clear, battery is not low",5,8,1);
;;;354    			snmp_bat_flag_puts[0]&=~0x0001;
;;;355    			}
;;;356    		}
;;;357    
;;;358    	if(bat[0]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;359    		{
;;;360    		snmp_bat_flag[0]|=0x0002;
;;;361    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;362    			{
;;;363    			//snmp_trap_send("BAT #1 Warning, high battery temperature",5,8,2); 
;;;364    			snmp_bat_flag_puts[0]|=0x0002;
;;;365    			}
;;;366    		}
;;;367    	else 
;;;368    		{
;;;369    		snmp_bat_flag[0]&=~0x0002;
;;;370    		if(snmp_bat_flag_puts[0]&0x0002) 
;;;371    			{
;;;372    			//snmp_trap_send("BAT #1 Warning clear, battery temperature is normal",5,8,3);
;;;373    			snmp_bat_flag_puts[0]&=~0x02;
;;;374    			}
;;;375    		}
;;;376    
;;;377    	if(bat[0]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;378    		{
;;;379    		snmp_bat_flag[0]|=0x0004;
;;;380    		if((snmp_bat_flag_puts[0]&0x0004)==0) 
;;;381    			{
;;;382    			//snmp_trap_send("BAT #1 Alarm, high battery temperature",5,8,4); 
;;;383    			snmp_bat_flag_puts[0]|=0x0004;
;;;384    			}
;;;385    		}
;;;386    	else 
;;;387    		{
;;;388    		snmp_bat_flag[0]&=~0x0004;
;;;389    		if(snmp_bat_flag_puts[0]&0x0004) 
;;;390    			{
;;;391    			//snmp_trap_send("BAT #1 Alarm clear, battery temperature is normal",5,8,5);
;;;392    			snmp_bat_flag_puts[0]&=~0x0004;
;;;393    			}
;;;394    		}
;;;395    
;;;396    	if(bat[0]._Ib<(-IKB)) snmp_bat_flag[0]|=0x0008;		//Разряд батареи
000028  1a40              SUBS     r0,r0,r1
00002a  b200              SXTH     r0,r0
00002c  f7fffffe          BL       abs_pal
000030  80a8              STRH     r0,[r5,#4]            ;337
000032  f44f7196          MOV      r1,#0x12c             ;337
000036  f1a406f2          SUB      r6,r4,#0xf2           ;337
00003a  4288              CMP      r0,r1                 ;337
00003c  da02              BGE      |L3.68|
00003e  88a0              LDRH     r0,[r4,#4]            ;339  ; adc_self_ch_buff
000040  87b0              STRH     r0,[r6,#0x3c]         ;339
000042  e00c              B        |L3.94|
                  |L3.68|
000044  f9b50002          LDRSH    r0,[r5,#2]            ;339  ; adc_self_ch_disp
000048  4288              CMP      r0,r1                 ;339
00004a  da02              BGE      |L3.82|
00004c  8860              LDRH     r0,[r4,#2]            ;341  ; adc_self_ch_buff
00004e  87b0              STRH     r0,[r6,#0x3c]         ;339
000050  e005              B        |L3.94|
                  |L3.82|
000052  f9b50000          LDRSH    r0,[r5,#0]            ;341  ; adc_self_ch_disp
000056  4288              CMP      r0,r1                 ;342
000058  da01              BGE      |L3.94|
00005a  8820              LDRH     r0,[r4,#0]            ;342  ; adc_self_ch_buff
00005c  87b0              STRH     r0,[r6,#0x3c]         ;339
                  |L3.94|
00005e  7c77              LDRB     r7,[r6,#0x11]         ;341  ; adc_ch_net
000060  2200              MOVS     r2,#0                 ;341
000062  b3ef              CBZ      r7,|L3.224|
000064  7d33              LDRB     r3,[r6,#0x14]         ;342  ; adc_window_flag
000066  486b              LDR      r0,|L3.532|
000068  b18b              CBZ      r3,|L3.142|
00006a  f9b6103c          LDRSH    r1,[r6,#0x3c]         ;344  ; adc_result
00006e  6804              LDR      r4,[r0,#0]            ;344  ; main_power_buffer
000070  eb0404a1          ADD      r4,r4,r1,ASR #2       ;344
000074  6004              STR      r4,[r0,#0]            ;345  ; main_power_buffer
000076  6844              LDR      r4,[r0,#4]            ;345  ; main_power_buffer
000078  eb0404a1          ADD      r4,r4,r1,ASR #2       ;345
00007c  6044              STR      r4,[r0,#4]            ;345  ; main_power_buffer
00007e  6884              LDR      r4,[r0,#8]            ;350  ; main_power_buffer
000080  eb0404a1          ADD      r4,r4,r1,ASR #2       ;350
000084  6084              STR      r4,[r0,#8]            ;351  ; main_power_buffer
000086  68c4              LDR      r4,[r0,#0xc]          ;351  ; main_power_buffer
000088  eb0401a1          ADD      r1,r4,r1,ASR #2       ;353
00008c  60c1              STR      r1,[r0,#0xc]          ;353  ; main_power_buffer
                  |L3.142|
00008e  f9b6103c          LDRSH    r1,[r6,#0x3c]         ;353  ; adc_result
000092  2964              CMP      r1,#0x64              ;353
000094  da06              BGE      |L3.164|
000096  f8b61040          LDRH     r1,[r6,#0x40]         ;354  ; adc_zero_cnt
00009a  f1010101          ADD      r1,r1,#1              ;354
00009e  f8a61040          STRH     r1,[r6,#0x40]         ;358
0000a2  e001              B        |L3.168|
                  |L3.164|
0000a4  f8a62040          STRH     r2,[r6,#0x40]         ;360
                  |L3.168|
0000a8  f9b64040          LDRSH    r4,[r6,#0x40]         ;360  ; adc_zero_cnt
0000ac  f44f61fa          MOV      r1,#0x7d0             ;361
0000b0  428c              CMP      r4,r1                 ;361
0000b2  db06              BLT      |L3.194|
0000b4  f8a61040          STRH     r1,[r6,#0x40]         ;364
0000b8  6002              STR      r2,[r0,#0]            ;364  ; main_power_buffer
0000ba  6042              STR      r2,[r0,#4]            ;364  ; main_power_buffer
0000bc  6082              STR      r2,[r0,#8]            ;369  ; main_power_buffer
0000be  60c2              STR      r2,[r0,#0xc]          ;369  ; main_power_buffer
0000c0  8772              STRH     r2,[r6,#0x3a]         ;369
                  |L3.194|
0000c2  f8b61040          LDRH     r1,[r6,#0x40]         ;369  ; adc_zero_cnt
0000c6  2905              CMP      r1,#5                 ;370
0000c8  d14f              BNE      |L3.362|
0000ca  b1bb              CBZ      r3,|L3.252|
0000cc  8ff1              LDRH     r1,[r6,#0x3e]         ;373  ; adc_gorb_cnt
0000ce  f1010101          ADD      r1,r1,#1              ;373
0000d2  b209              SXTH     r1,r1                 ;377
0000d4  87f1              STRH     r1,[r6,#0x3e]         ;377
0000d6  f5b17f00          CMP      r1,#0x200             ;379
0000da  db00              BLT      |L3.222|
0000dc  87f2              STRH     r2,[r6,#0x3e]         ;379
                  |L3.222|
0000de  e000              B        |L3.226|
                  |L3.224|
0000e0  e01b              B        |L3.282|
                  |L3.226|
0000e2  f9b6103e          LDRSH    r1,[r6,#0x3e]         ;380  ; adc_gorb_cnt
0000e6  064c              LSLS     r4,r1,#25             ;383
0000e8  d108              BNE      |L3.252|
0000ea  ea4f11e1          ASR      r1,r1,#7              ;383
0000ee  f8504021          LDR      r4,[r0,r1,LSL #2]     ;388
0000f2  ea4f2424          ASR      r4,r4,#8              ;388
0000f6  8774              STRH     r4,[r6,#0x3a]         ;389
0000f8  f8402021          STR      r2,[r0,r1,LSL #2]     ;389
                  |L3.252|
0000fc  f9b60042          LDRSH    r0,[r6,#0x42]         ;389  ; adc_window_cnt
000100  2896              CMP      r0,#0x96              ;392
000102  dd01              BLE      |L3.264|
000104  b103              CBZ      r3,|L3.264|
000106  7532              STRB     r2,[r6,#0x14]
                  |L3.264|
000108  381f              SUBS     r0,r0,#0x1f
00010a  2827              CMP      r0,#0x27
00010c  d22d              BCS      |L3.362|
00010e  7d30              LDRB     r0,[r6,#0x14]  ; adc_window_flag
000110  bb58              CBNZ     r0,|L3.362|
000112  f04f0001          MOV      r0,#1
000116  7530              STRB     r0,[r6,#0x14]
000118  e027              B        |L3.362|
                  |L3.282|
00011a  483f              LDR      r0,|L3.536|
00011c  7cb5              LDRB     r5,[r6,#0x12]  ; adc_ch
;;;397    	else if(bat[0]._Ib>IKB) snmp_bat_flag[0]&=~0x0008;	//Заряд батареи
00011e  7cf3              LDRB     r3,[r6,#0x13]  ; adc_ch_cnt
000120  eb001485          ADD      r4,r0,r5,LSL #6
000124  f9b6103c          LDRSH    r1,[r6,#0x3c]  ; adc_result
000128  f8441023          STR      r1,[r4,r3,LSL #2]
;;;398    
;;;399    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
00012c  0798              LSLS     r0,r3,#30
00012e  d10f              BNE      |L3.336|
000130  4601              MOV      r1,r0
                  |L3.306|
000132  f854c020          LDR      r12,[r4,r0,LSL #2]
000136  4461              ADD      r1,r1,r12
000138  f1000001          ADD      r0,r0,#1
;;;400    		{
;;;401    		snmp_bat_flag[0]|=0x0010;
;;;402    		if((snmp_bat_flag_puts[0]&0x0010)==0) 
;;;403    			{
;;;404    			snmp_trap_send("BAT #1, capacity test started",5,8,6); 
;;;405    			snmp_bat_flag_puts[0]|=0x0010;
;;;406    			}
;;;407    		}
;;;408    	else 
;;;409    		{
;;;410    		snmp_bat_flag[0]&=~0x0010;
00013c  b2c0              UXTB     r0,r0
00013e  2810              CMP      r0,#0x10
000140  d3f7              BCC      |L3.306|
;;;411    		if(snmp_bat_flag_puts[0]&0x0010) 
000142  ea4f1021          ASR      r0,r1,#4
000146  4933              LDR      r1,|L3.532|
;;;412    			{
;;;413    			snmp_trap_send("BAT #1, capacity test stopped",5,8,7);
000148  f1a10120          SUB      r1,r1,#0x20
00014c  f8210015          STRH     r0,[r1,r5,LSL #1]
                  |L3.336|
000150  1c6d              ADDS     r5,r5,#1
000152  b2e8              UXTB     r0,r5
;;;414    			snmp_bat_flag_puts[0]&=~0x0010;
000154  74b0              STRB     r0,[r6,#0x12]
000156  2810              CMP      r0,#0x10
000158  d307              BCC      |L3.362|
00015a  74b2              STRB     r2,[r6,#0x12]
;;;415    			}
;;;416    		}
;;;417    		
;;;418    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
00015c  f1030301          ADD      r3,r3,#1
000160  b2d8              UXTB     r0,r3
000162  74f0              STRB     r0,[r6,#0x13]
;;;419    		{
;;;420    		snmp_bat_flag[0]|=0x0020;
;;;421    		if((snmp_bat_flag_puts[0]&0x0020)==0) 
;;;422    			{
;;;423    			snmp_trap_send("BAT #1,leveling charge is started",5,8,8); 
;;;424    			snmp_bat_flag_puts[0]|=0x0020;
;;;425    			}
;;;426    		}
;;;427    	else 
;;;428    		{
;;;429    		snmp_bat_flag[0]&=~0x0020;
000164  2810              CMP      r0,#0x10
000166  d300              BCC      |L3.362|
000168  74f2              STRB     r2,[r6,#0x13]
                  |L3.362|
00016a  7432              STRB     r2,[r6,#0x10]
;;;430    		if(snmp_bat_flag_puts[0]&0x0020) 
00016c  f1070701          ADD      r7,r7,#1
000170  f0070001          AND      r0,r7,#1
;;;431    			{
;;;432    			snmp_trap_send("BAT #1,leveling charge is stopped",5,8,9);
000174  7470              STRB     r0,[r6,#0x11]
000176  4a29              LDR      r2,|L3.540|
000178  b130              CBZ      r0,|L3.392|
00017a  6810              LDR      r0,[r2,#0]
00017c  f02000ff          BIC      r0,r0,#0xff
;;;433    			snmp_bat_flag_puts[0]&=~0x0020;
000180  f1000004          ADD      r0,r0,#4
000184  6010              STR      r0,[r2,#0]
;;;434    			}
;;;435    		}
;;;436    
;;;437    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
000186  e03d              B        |L3.516|
                  |L3.392|
000188  7cb1              LDRB     r1,[r6,#0x12]  ; adc_ch
00018a  0708              LSLS     r0,r1,#28
;;;438    		{
;;;439    		snmp_bat_flag[0]|=0x0040;
00018c  d406              BMI      |L3.412|
00018e  6810              LDR      r0,[r2,#0]
000190  f02000ff          BIC      r0,r0,#0xff
;;;440    		if((snmp_bat_flag_puts[0]&0x0040)==0) 
000194  f1000001          ADD      r0,r0,#1
000198  6010              STR      r0,[r2,#0]
;;;441    			{
;;;442    			snmp_trap_send("BAT #1,leveling charge is blocked",5,8,10); 
00019a  e005              B        |L3.424|
                  |L3.412|
00019c  6810              LDR      r0,[r2,#0]
00019e  f02000ff          BIC      r0,r0,#0xff
0001a2  f1000002          ADD      r0,r0,#2
;;;443    			snmp_bat_flag_puts[0]|=0x0040;
0001a6  6010              STR      r0,[r2,#0]
                  |L3.424|
0001a8  481d              LDR      r0,|L3.544|
0001aa  6803              LDR      r3,[r0,#0]
0001ac  f0435380          ORR      r3,r3,#0x10000000
0001b0  6003              STR      r3,[r0,#0]            ;401
0001b2  6a03              LDR      r3,[r0,#0x20]         ;401
0001b4  f0434380          ORR      r3,r3,#0x40000000     ;401
0001b8  6203              STR      r3,[r0,#0x20]         ;402
0001ba  6e03              LDR      r3,[r0,#0x60]         ;402
0001bc  f0436380          ORR      r3,r3,#0x4000000      ;402
0001c0  6603              STR      r3,[r0,#0x60]         ;404
0001c2  07cb              LSLS     r3,r1,#31             ;404
0001c4  d00a              BEQ      |L3.476|
0001c6  6943              LDR      r3,[r0,#0x14]         ;404
0001c8  f0435380          ORR      r3,r3,#0x10000000     ;404
0001cc  6143              STR      r3,[r0,#0x14]         ;405
                  |L3.462|
0001ce  078b              LSLS     r3,r1,#30             ;405
0001d0  d409              BMI      |L3.486|
0001d2  6b43              LDR      r3,[r0,#0x34]         ;405
0001d4  f0234380          BIC      r3,r3,#0x40000000     ;420
0001d8  6343              STR      r3,[r0,#0x34]         ;420
0001da  e008              B        |L3.494|
                  |L3.476|
0001dc  6943              LDR      r3,[r0,#0x14]         ;421
0001de  f0235380          BIC      r3,r3,#0x10000000     ;421
0001e2  6143              STR      r3,[r0,#0x14]         ;423
0001e4  e7f3              B        |L3.462|
                  |L3.486|
0001e6  6b43              LDR      r3,[r0,#0x34]         ;423
0001e8  f0434380          ORR      r3,r3,#0x40000000     ;423
0001ec  6343              STR      r3,[r0,#0x34]         ;423
                  |L3.494|
0001ee  0749              LSLS     r1,r1,#29             ;424
0001f0  d404              BMI      |L3.508|
0001f2  6f41              LDR      r1,[r0,#0x74]         ;424
0001f4  f0216180          BIC      r1,r1,#0x4000000      ;424
;;;444    			}
;;;445    		}
;;;446    	else 
;;;447    		{
;;;448    		snmp_bat_flag[0]&=~0x0040;
0001f8  6741              STR      r1,[r0,#0x74]
0001fa  e003              B        |L3.516|
                  |L3.508|
0001fc  6f41              LDR      r1,[r0,#0x74]
0001fe  f0416180          ORR      r1,r1,#0x4000000
;;;449    		if(snmp_bat_flag_puts[0]&0x0040) 
000202  6741              STR      r1,[r0,#0x74]
                  |L3.516|
000204  6810              LDR      r0,[r2,#0]
;;;450    			{
;;;451    			snmp_trap_send("BAT #1,leveling charge is unblocked",5,8,11);
000206  f0407080          ORR      r0,r0,#0x1000000
00020a  6010              STR      r0,[r2,#0]
00020c  e8bd81f0          POP      {r4-r8,pc}
;;;452    			snmp_bat_flag_puts[0]&=~0x0040;
;;;453    			} 
;;;454    		}
;;;455    
;;;456    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
;;;457    		{
;;;458    		snmp_bat_flag[0]|=0x0080;
;;;459    		if((snmp_bat_flag_puts[0]&0x0080)==0) 
;;;460    			{
;;;461    			snmp_trap_send("BAT #1,speed charge is started",5,8,10); 
;;;462    			snmp_bat_flag_puts[0]|=0x0080;
;;;463    			}
;;;464    		}
;;;465    	else 
;;;466    		{
;;;467    		snmp_bat_flag[0]&=~0x0080;
;;;468    		if(snmp_bat_flag_puts[0]&0x0080) 
;;;469    			{
;;;470    			snmp_trap_send("BAT #1,speed charge is stopped",5,8,11);
;;;471    			snmp_bat_flag_puts[0]&=~0x0080;
;;;472    			}
;;;473    		}
;;;474    
;;;475    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
;;;476    		{
;;;477    		snmp_bat_flag[0]|=0x0100;
;;;478    		if((snmp_bat_flag_puts[0]&0x0100)==0) 
;;;479    			{
;;;480    			snmp_trap_send("BAT #1,speed charge is blocked",5,8,12); 
;;;481    			snmp_bat_flag_puts[0]|=0x0100;
;;;482    			}
;;;483    		}
;;;484    	else 
;;;485    		{
;;;486    		snmp_bat_flag[0]&=~0x0100;
;;;487    		if(snmp_bat_flag_puts[0]&0x0100) 
;;;488    			{
;;;489    			snmp_trap_send("BAT #1,speed charge is unblocked",5,8,13);
;;;490    			snmp_bat_flag_puts[0]&=~0x0100;
;;;491    			} 
;;;492    		}
;;;493    
;;;494    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;495    		{
;;;496    		snmp_bat_flag[0]|=0x0200;
;;;497    		if((snmp_bat_flag_puts[0]&0x0200)==0) 
;;;498    			{
;;;499    			snmp_trap_send("BAT #1,equalising charge is on",5,8,14); 
;;;500    			snmp_bat_flag_puts[0]|=0x0200;
;;;501    			}
;;;502    		}
;;;503    	else 
;;;504    		{
;;;505    		snmp_bat_flag[0]&=~0x0200;
;;;506    		if(snmp_bat_flag_puts[0]&0x0200) 
;;;507    			{
;;;508    			snmp_trap_send("BAT #1,equalising charge is off",5,8,15);
;;;509    			snmp_bat_flag_puts[0]&=~0x0200;
;;;510    			}
;;;511    		}
;;;512    
;;;513    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;514    		{
;;;515    		snmp_bat_flag[0]|=0x0400;
;;;516    		if((snmp_bat_flag_puts[0]&0x0400)==0) 
;;;517    			{
;;;518    			snmp_trap_send("BAT #1,equalising charge is blocked",5,8,16); 
;;;519    			snmp_bat_flag_puts[0]|=0x0400;
;;;520    			}
;;;521    		}
;;;522    	else 
;;;523    		{
;;;524    		snmp_bat_flag[0]&=~0x0400;
;;;525    		if(snmp_bat_flag_puts[0]&0x0400) 
;;;526    			{
;;;527    			snmp_trap_send("BAT #1,equalising charge is unblocked",5,8,17);
;;;528    			snmp_bat_flag_puts[0]&=~0x0400;
;;;529    			} 
;;;530    		}
;;;531    
;;;532    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;533    		{
;;;534    		snmp_bat_flag[0]|=0x0800;
;;;535    		if((snmp_bat_flag_puts[0]&0x0800)==0) 
;;;536    			{
;;;537    			snmp_trap_send("BAT #1,molding charge is on",5,8,18); 
;;;538    			snmp_bat_flag_puts[0]|=0x0800;
;;;539    			}
;;;540    		}
;;;541    	else 
;;;542    		{
;;;543    		snmp_bat_flag[0]&=~0x0800;
;;;544    		if(snmp_bat_flag_puts[0]&0x0800) 
;;;545    			{
;;;546    			snmp_trap_send("BAT #1,molding charge is off",5,8,19);
;;;547    			snmp_bat_flag_puts[0]&=~0x0800;
;;;548    			}
;;;549    		}
;;;550    
;;;551    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;552    		{
;;;553    		snmp_bat_flag[0]|=0x1000;
;;;554    		if((snmp_bat_flag_puts[0]&0x1000)==0) 
;;;555    			{
;;;556    			snmp_trap_send("BAT #1,molding charge is blocked",5,8,20); 
;;;557    			snmp_bat_flag_puts[0]|=0x1000;
;;;558    			}
;;;559    		}
;;;560    	else 
;;;561    		{
;;;562    		snmp_bat_flag[0]&=~0x1000;
;;;563    		if(snmp_bat_flag_puts[0]&0x1000) 
;;;564    			{
;;;565    			snmp_trap_send("BAT #1,molding charge is unblocked",5,8,21);
;;;566    			snmp_bat_flag_puts[0]&=~0x1000;
;;;567    			} 
;;;568    		}
;;;569    	}
;;;570    else 
;;;571    	{
;;;572    	snmp_bat_flag[0]=0; 
;;;573    	snmp_bat_flag_puts[0]=0;
;;;574    	}
;;;575    
;;;576    if( (snmp_bat_status[1]==0 || snmp_bat_status[1]==2) && NUMBAT==2 )	//o_10 
;;;577    	{
;;;578    	if((bat[1]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
;;;579    		{
;;;580    		snmp_bat_flag[1]|=0x0001; 
;;;581    		if((snmp_bat_flag_puts[1]&0x0001)==0) 
;;;582    			{
;;;583    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,22); 
;;;584    			snmp_bat_flag_puts[1]|=0x0001;
;;;585    			}
;;;586    		}
;;;587    	else 
;;;588    		{
;;;589    		snmp_bat_flag[1]&=~0x0001; 
;;;590    		if(snmp_bat_flag_puts[1]&0x0001) 
;;;591    			{
;;;592    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,23);
;;;593    			snmp_bat_flag_puts[1]&=~0x0001;
;;;594    			}
;;;595    		}
;;;596    
;;;597    	if(bat[1]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;598    		{
;;;599    		snmp_bat_flag[1]|=0x0002;
;;;600    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;601    			{
;;;602    			//snmp_trap_send("BAT #2 Warning, high battery temperature",5,8,24); 
;;;603    			snmp_bat_flag_puts[1]|=0x0002;
;;;604    			}
;;;605    		}
;;;606    	else 
;;;607    		{
;;;608    		snmp_bat_flag[1]&=~0x0002;
;;;609    		if(snmp_bat_flag_puts[1]&0x0002) 
;;;610    			{
;;;611    			//snmp_trap_send("BAT #2 Warning clear, battery temperature is normal",5,8,25);
;;;612    			snmp_bat_flag_puts[1]&=~0x02;
;;;613    			}
;;;614    		}
;;;615    
;;;616    	if(bat[1]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;617    		{
;;;618    		snmp_bat_flag[1]|=0x0004;
;;;619    		if((snmp_bat_flag_puts[1]&0x0004)==0) 
;;;620    			{
;;;621    			//snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,26); 
;;;622    			snmp_bat_flag_puts[1]|=0x0004;
;;;623    			}
;;;624    		}
;;;625    	else 
;;;626    		{
;;;627    		snmp_bat_flag[1]&=~0x0004;
;;;628    		if(snmp_bat_flag_puts[1]&0x0004) 
;;;629    			{
;;;630    			//snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,27);
;;;631    			snmp_bat_flag_puts[1]&=~0x0004;
;;;632    			}
;;;633    		}
;;;634    
;;;635    	if(bat[1]._Ib<(-IKB)) snmp_bat_flag[1]|=0x0008;		//Разряд батареи
;;;636    	else if(bat[1]._Ib>IKB) snmp_bat_flag[1]&=~0x0008;	//Заряд батареи
;;;637    
;;;638    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
;;;639    		{
;;;640    		snmp_bat_flag[1]|=0x0010;
;;;641    		if((snmp_bat_flag_puts[1]&0x0010)==0) 
;;;642    			{
;;;643    			snmp_trap_send("BAT #2, capacity test started",5,8,28); 
;;;644    			snmp_bat_flag_puts[1]|=0x0010;
;;;645    			}
;;;646    		}
;;;647    	else 
;;;648    		{
;;;649    		snmp_bat_flag[1]&=~0x0010;
;;;650    		if(snmp_bat_flag_puts[1]&0x0010) 
;;;651    			{
;;;652    			snmp_trap_send("BAT #2, capacity test stopped",5,8,29);
;;;653    			snmp_bat_flag_puts[1]&=~0x0010;
;;;654    			}
;;;655    		}
;;;656    		
;;;657    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
;;;658    		{
;;;659    		snmp_bat_flag[1]|=0x0020;
;;;660    		if((snmp_bat_flag_puts[1]&0x0020)==0) 
;;;661    			{
;;;662    			snmp_trap_send("BAT #2,leveling charge is started",5,8,30); 
;;;663    			snmp_bat_flag_puts[1]|=0x0020;
;;;664    			}
;;;665    		}
;;;666    	else 
;;;667    		{
;;;668    		snmp_bat_flag[1]&=~0x0020;
;;;669    		if(snmp_bat_flag_puts[1]&0x0020) 
;;;670    			{
;;;671    			snmp_trap_send("BAT #2,leveling charge is stopped",5,8,31);
;;;672    			snmp_bat_flag_puts[1]&=~0x0020;
;;;673    			}
;;;674    		}
;;;675    
;;;676    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
;;;677    		{
;;;678    		snmp_bat_flag[1]|=0x0040;
;;;679    		if((snmp_bat_flag_puts[1]&0x0040)==0) 
;;;680    			{
;;;681    			snmp_trap_send("BAT #2,leveling charge is blocked",5,8,32); 
;;;682    			snmp_bat_flag_puts[1]|=0x0040;
;;;683    			}
;;;684    		}
;;;685    	else 
;;;686    		{
;;;687    		snmp_bat_flag[1]&=~0x0040;
;;;688    		if(snmp_bat_flag_puts[1]&0x0040) 
;;;689    			{
;;;690    			snmp_trap_send("BAT #2,leveling charge is unblocked",5,8,33);
;;;691    			snmp_bat_flag_puts[1]&=~0x0040;
;;;692    			} 
;;;693    		}
;;;694    
;;;695    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
;;;696    		{
;;;697    		snmp_bat_flag[1]|=0x0080;
;;;698    		if((snmp_bat_flag_puts[1]&0x0080)==0) 
;;;699    			{
;;;700    			snmp_trap_send("BAT #2,speed charge is started",5,8,34); 
;;;701    			snmp_bat_flag_puts[1]|=0x0080;
;;;702    			}
;;;703    		}
;;;704    	else 
;;;705    		{
;;;706    		snmp_bat_flag[1]&=~0x0080;
;;;707    		if(snmp_bat_flag_puts[1]&0x0080) 
;;;708    			{
;;;709    			snmp_trap_send("BAT #2,speed charge is stopped",5,8,35);
;;;710    			snmp_bat_flag_puts[1]&=~0x0080;
;;;711    			}
;;;712    		}
;;;713    
;;;714    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
;;;715    		{
;;;716    		snmp_bat_flag[1]|=0x0100;
;;;717    		if((snmp_bat_flag_puts[1]&0x0100)==0) 
;;;718    			{
;;;719    			snmp_trap_send("BAT #2,speed charge is blocked",5,8,36); 
;;;720    			snmp_bat_flag_puts[1]|=0x0100;
;;;721    			}
;;;722    		}
;;;723    	else 
;;;724    		{
;;;725    		snmp_bat_flag[1]&=~0x0100;
;;;726    		if(snmp_bat_flag_puts[1]&0x0100) 
;;;727    			{
;;;728    			snmp_trap_send("BAT #2,speed charge is unblocked",5,8,37);
;;;729    			snmp_bat_flag_puts[1]&=~0x0100;
;;;730    			} 
;;;731    		}
;;;732    
;;;733    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;734    		{
;;;735    		snmp_bat_flag[1]|=0x0200;
;;;736    		if((snmp_bat_flag_puts[1]&0x0200)==0) 
;;;737    			{
;;;738    			snmp_trap_send("BAT #2,equalising charge is on",5,8,38); 
;;;739    			snmp_bat_flag_puts[1]|=0x0200;
;;;740    			}
;;;741    		}
;;;742    	else 
;;;743    		{
;;;744    		snmp_bat_flag[1]&=~0x0200;
;;;745    		if(snmp_bat_flag_puts[1]&0x0200) 
;;;746    			{
;;;747    			snmp_trap_send("BAT #2,equalising charge is off",5,8,39);
;;;748    			snmp_bat_flag_puts[1]&=~0x0200;
;;;749    			}
;;;750    		}
;;;751    
;;;752    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;753    		{
;;;754    		snmp_bat_flag[1]|=0x0400;
;;;755    		if((snmp_bat_flag_puts[1]&0x0400)==0) 
;;;756    			{
;;;757    			snmp_trap_send("BAT #2,equalising charge is blocked",5,8,40); 
;;;758    			snmp_bat_flag_puts[1]|=0x0400;
;;;759    			}
;;;760    		}
;;;761    	else 
;;;762    		{
;;;763    		snmp_bat_flag[1]&=~0x0400;
;;;764    		if(snmp_bat_flag_puts[1]&0x0400) 
;;;765    			{
;;;766    			snmp_trap_send("BAT #2,equalising charge is unblocked",5,8,41);
;;;767    			snmp_bat_flag_puts[1]&=~0x0400;
;;;768    			} 
;;;769    		}
;;;770    
;;;771    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;772    		{
;;;773    		snmp_bat_flag[1]|=0x0800;
;;;774    		if((snmp_bat_flag_puts[1]&0x0800)==0) 
;;;775    			{
;;;776    			snmp_trap_send("BAT #2,molding charge is on",5,8,42); 
;;;777    			snmp_bat_flag_puts[1]|=0x0800;
;;;778    			}
;;;779    		}
;;;780    	else 
;;;781    		{
;;;782    		snmp_bat_flag[1]&=~0x0800;
;;;783    		if(snmp_bat_flag_puts[1]&0x0800) 
;;;784    			{
;;;785    			snmp_trap_send("BAT #2,molding charge is off",5,8,43);
;;;786    			snmp_bat_flag_puts[1]&=~0x0800;
;;;787    			}
;;;788    		}
;;;789    
;;;790    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;791    		{
;;;792    		snmp_bat_flag[1]|=0x1000;
;;;793    		if((snmp_bat_flag_puts[1]&0x1000)==0) 
;;;794    			{
;;;795    			snmp_trap_send("BAT #2,molding charge is blocked",5,8,44); 
;;;796    			snmp_bat_flag_puts[1]|=0x1000;
;;;797    			}
;;;798    		}
;;;799    	else 
;;;800    		{
;;;801    		snmp_bat_flag[1]&=~0x1000;
;;;802    		if(snmp_bat_flag_puts[1]&0x1000) 
;;;803    			{
;;;804    			snmp_trap_send("BAT #2,molding charge is unblocked",5,8,45);
;;;805    			snmp_bat_flag_puts[1]&=~0x1000;
;;;806    			} 
;;;807    		}
;;;808    	}
;;;809    else 
;;;810    	{
;;;811    	snmp_bat_flag[1]=0; 
;;;812    	snmp_bat_flag_puts[1]=0;
;;;813    	}
;;;814    /*
;;;815    if(!snmp_bat_status[1])
;;;816    	{
;;;817    	if((bat[1]._Ub<(USIGN*10))) 
;;;818    		{
;;;819    		snmp_bat_flag[1]|=0x01; 
;;;820    		if((snmp_bat_flag_puts[1]&0x01)==0) 
;;;821    			{
;;;822    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,0); 
;;;823    			snmp_bat_flag_puts[1]|=0x01;
;;;824    			}
;;;825    		}
;;;826    	else 
;;;827    		{
;;;828    		snmp_bat_flag[1]&=~0x01; 
;;;829    		if(snmp_bat_flag_puts[1]&0x01) 
;;;830    			{
;;;831    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,1);
;;;832    			snmp_bat_flag_puts[1]&=~0x01;
;;;833    			}
;;;834    		}
;;;835    	if(bat[1]._temper_stat&0x01) 
;;;836    		{
;;;837    		snmp_bat_flag[1]|=0x02;
;;;838    		if((snmp_bat_flag_puts[1]&0x02)==0) 
;;;839    			{
;;;840    			snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,2); 
;;;841    			snmp_bat_flag_puts[1]|=0x02;
;;;842    			}
;;;843    		}
;;;844    	else 
;;;845    		{
;;;846    		snmp_bat_flag[1]&=~0x02;
;;;847    		if(snmp_bat_flag_puts[1]&0x02) 
;;;848    			{
;;;849    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,3);
;;;850    			snmp_bat_flag_puts[1]&=~0x02;
;;;851    			}
;;;852    		}
;;;853    	if(bat[1]._temper_stat&0x02) 
;;;854    		{
;;;855    		snmp_bat_flag[1]|=0x04;
;;;856    		if((snmp_bat_flag_puts[1]&0x04)==0) 
;;;857    			{
;;;858    			snmp_trap_send("BAT #2 Alarm, maximum battery temperature",5,8,4); 
;;;859    			snmp_bat_flag_puts[1]|=0x04;
;;;860    			}
;;;861    		}
;;;862    	else 
;;;863    		{
;;;864    		snmp_bat_flag[1]&=~0x04;
;;;865    		if(snmp_bat_flag_puts[1]&0x04) 
;;;866    			{
;;;867    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,5);
;;;868    			snmp_bat_flag_puts[1]&=~0x04;
;;;869    			}
;;;870    		}
;;;871    		
;;;872    	if(bat[1]._Ib<(-IKB))	snmp_bat_flag[1]|=0x80;
;;;873    	else if(bat[1]._Ib>IKB)snmp_bat_flag[1]&=~0x80;
;;;874    
;;;875    	if((spc_stat==spcKE)&&(spc_bat==1)) 
;;;876    		{
;;;877    		snmp_bat_flag[1]|=0x10;
;;;878    		if((snmp_bat_flag_puts[1]&0x10)==0) 
;;;879    			{
;;;880    			snmp_trap_send("BAT #2, capacity check enabled",5,8,6); 
;;;881    			snmp_bat_flag_puts[1]|=0x10;
;;;882    			}
;;;883    		}
;;;884    	else 
;;;885    		{
;;;886    		snmp_bat_flag[1]&=~0x10;
;;;887    		if(snmp_bat_flag_puts[1]&0x10) 
;;;888    			{
;;;889    			snmp_trap_send("BAT #2, capacity check disabled",5,8,7);
;;;890    			snmp_bat_flag_puts[1]&=~0x10;
;;;891    			}
;;;892    		}
;;;893    		
;;;894    	if(spc_stat==spcVZ) 
;;;895    		{
;;;896    		snmp_bat_flag[1]|=0x20;
;;;897    		if((snmp_bat_flag_puts[1]&0x20)==0) 
;;;898    			{
;;;899    			snmp_trap_send("BAT #2,equalizing charge is on",5,8,8); 
;;;900    			snmp_bat_flag_puts[1]|=0x20;
;;;901    			}
;;;902    		}
;;;903    	else 
;;;904    		{
;;;905    		snmp_bat_flag[1]&=~0x20;
;;;906    		if(snmp_bat_flag_puts[1]&0x20) 
;;;907    			{
;;;908    			snmp_trap_send("BAT #2,equalizing charge is off",5,8,9);
;;;909    			snmp_bat_flag_puts[1]&=~0x20;
;;;910    			}
;;;911    		}
;;;912    
;;;913    	if(vz_error) 
;;;914    		{
;;;915    		snmp_bat_flag[1]|=0x40;
;;;916    		if((snmp_bat_flag_puts[1]&0x40)==0) 
;;;917    			{
;;;918    			snmp_trap_send("BAT #2,equalizing charge blocked",5,8,10); 
;;;919    			snmp_bat_flag_puts[1]|=0x40;
;;;920    			}
;;;921    		}
;;;922    	else 
;;;923    		{
;;;924    		snmp_bat_flag[1]&=~0x40;
;;;925    		if(snmp_bat_flag_puts[1]&0x40) 
;;;926    			{
;;;927    			snmp_trap_send("BAT #2,equalizing charge is not blocked",5,8,11);
;;;928    			snmp_bat_flag_puts[1]&=~0x40;
;;;929    			} 
;;;930    		}
;;;931       }
;;;932    else 
;;;933    	{
;;;934    	snmp_bat_flag[1]=0; 
;;;935    	snmp_bat_flag_puts[1]=0;
;;;936    	} */
;;;937    }
;;;938    
                          ENDP

                  |L3.528|
                          DCD      ||area_number.26||+0xf2
                  |L3.532|
                          DCD      ||.bss||+0x42c
                  |L3.536|
                          DCD      ||.bss||+0xc
                  |L3.540|
                          DCD      0x40034000
                  |L3.544|
                          DCD      0x2009c000

                          AREA ||area_number.4||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.4||, ||.text||
                  ips_current_average_hndl_ PROC
;;;326    // заполнение флагов для АКБ
;;;327    void bat_flag (void)
000000  e92d43f0          PUSH     {r4-r9,lr}
;;;328    {  
;;;329    if(spc_stat!=spcVZ) 
000004  b085              SUB      sp,sp,#0x14
;;;330    	{
;;;331    	vz_error=0;
000006  4c64              LDR      r4,|L4.408|
000008  4e64              LDR      r6,|L4.412|
00000a  2500              MOVS     r5,#0                 ;329
00000c  7820              LDRB     r0,[r4,#0]            ;329  ; ica_timer_cnt
00000e  1c40              ADDS     r0,r0,#1              ;329
000010  b2c0              UXTB     r0,r0
;;;332    	sp_ch_error=0;
000012  7020              STRB     r0,[r4,#0]
;;;333    	vz1_error=0;
000014  280a              CMP      r0,#0xa
;;;334    	vz2_error=0;
000016  d340              BCC      |L4.154|
;;;335    	}
;;;336    
;;;337    if( (snmp_bat_status[0]==0 || snmp_bat_status[0]==2) && NUMBAT>0) 	//o_10 	 			//Батарея №1
000018  7025              STRB     r5,[r4,#0]
00001a  f8dfc184          LDR      r12,|L4.416|
00001e  f89c0000          LDRB     r0,[r12,#0]  ; ica_plazma
;;;338    	{
;;;339    	if((bat[0]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
000022  f1000001          ADD      r0,r0,#1
000026  f88c0000          STRB     r0,[r12,#0]           ;337
;;;340    		{
;;;341    		snmp_bat_flag[0]|=0x0001; 
;;;342    		if((snmp_bat_flag_puts[0]&0x0001)==0) 
;;;343    			{
;;;344    			snmp_trap_send("BAT #1 Alarm, battery is low",5,8,0); 
;;;345    			snmp_bat_flag_puts[0]|=0x0001;
;;;346    			}
;;;347    		}
;;;348    	else 
;;;349    		{
;;;350    		snmp_bat_flag[0]&=~0x0001; 
;;;351    		if(snmp_bat_flag_puts[0]&0x0001) 
;;;352    			{
;;;353    			snmp_trap_send("BAT #1 Alarm clear, battery is not low",5,8,1);
;;;354    			snmp_bat_flag_puts[0]&=~0x0001;
;;;355    			}
;;;356    		}
;;;357    
;;;358    	if(bat[0]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;359    		{
;;;360    		snmp_bat_flag[0]|=0x0002;
;;;361    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;362    			{
;;;363    			//snmp_trap_send("BAT #1 Warning, high battery temperature",5,8,2); 
;;;364    			snmp_bat_flag_puts[0]|=0x0002;
;;;365    			}
;;;366    		}
;;;367    	else 
;;;368    		{
;;;369    		snmp_bat_flag[0]&=~0x0002;
;;;370    		if(snmp_bat_flag_puts[0]&0x0002) 
;;;371    			{
;;;372    			//snmp_trap_send("BAT #1 Warning clear, battery temperature is normal",5,8,3);
;;;373    			snmp_bat_flag_puts[0]&=~0x02;
;;;374    			}
;;;375    		}
;;;376    
;;;377    	if(bat[0]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;378    		{
;;;379    		snmp_bat_flag[0]|=0x0004;
;;;380    		if((snmp_bat_flag_puts[0]&0x0004)==0) 
;;;381    			{
;;;382    			//snmp_trap_send("BAT #1 Alarm, high battery temperature",5,8,4); 
;;;383    			snmp_bat_flag_puts[0]|=0x0004;
;;;384    			}
;;;385    		}
;;;386    	else 
;;;387    		{
;;;388    		snmp_bat_flag[0]&=~0x0004;
;;;389    		if(snmp_bat_flag_puts[0]&0x0004) 
;;;390    			{
;;;391    			//snmp_trap_send("BAT #1 Alarm clear, battery temperature is normal",5,8,5);
;;;392    			snmp_bat_flag_puts[0]&=~0x0004;
;;;393    			}
;;;394    		}
;;;395    
;;;396    	if(bat[0]._Ib<(-IKB)) snmp_bat_flag[0]|=0x0008;		//Разряд батареи
00002a  485e              LDR      r0,|L4.420|
00002c  495e              LDR      r1,|L4.424|
00002e  f9b00000          LDRSH    r0,[r0,#0]            ;342  ; bps_I
000032  8008              STRH     r0,[r1,#0]            ;337
000034  495d              LDR      r1,|L4.428|
000036  f8df8178          LDR      r8,|L4.432|
00003a  4662              MOV      r2,r12                ;337
00003c  4637              MOV      r7,r6                 ;337
00003e  f9b11000          LDRSH    r1,[r1,#0]            ;339  ; ica_your_current
000042  7852              LDRB     r2,[r2,#1]            ;339
000044  f9b83000          LDRSH    r3,[r8,#0]            ;339
000048  f9b77000          LDRSH    r7,[r7,#0]            ;339
00004c  4288              CMP      r0,r1                 ;341
00004e  dd06              BLE      |L4.94|
000050  eba00901          SUB      r9,r0,r1              ;339
000054  f1b90f0a          CMP      r9,#0xa               ;341
000058  db01              BLT      |L4.94|
00005a  2f01              CMP      r7,#1                 ;342
00005c  d007              BEQ      |L4.110|
                  |L4.94|
00005e  4288              CMP      r0,r1                 ;341
000060  da16              BGE      |L4.144|
000062  1a08              SUBS     r0,r1,r0              ;341
000064  280a              CMP      r0,#0xa               ;342
000066  db13              BLT      |L4.144|
000068  2f01              CMP      r7,#1                 ;344
00006a  d009              BEQ      |L4.128|
00006c  e010              B        |L4.144|
                  |L4.110|
00006e  f1020201          ADD      r2,r2,#1              ;344
000072  f88c2001          STRB     r2,[r12,#1]           ;344
000076  f1a30301          SUB      r3,r3,#1              ;345
00007a  f8a83000          STRH     r3,[r8,#0]            ;345
00007e  e007              B        |L4.144|
                  |L4.128|
000080  f1a20201          SUB      r2,r2,#1              ;350
000084  f88c2001          STRB     r2,[r12,#1]           ;351
000088  f1030301          ADD      r3,r3,#1              ;353
00008c  f8a83000          STRH     r3,[r8,#0]            ;353
                  |L4.144|
000090  2214              MOVS     r2,#0x14              ;353
000092  4251              RSBS     r1,r2,#0              ;353
000094  4846              LDR      r0,|L4.432|
000096  f7fffffe          BL       gran
                  |L4.154|
00009a  7820              LDRB     r0,[r4,#0]            ;354  ; ica_timer_cnt
00009c  f8df8114          LDR      r8,|L4.436|
0000a0  4f45              LDR      r7,|L4.440|
0000a2  2808              CMP      r0,#8                 ;358
0000a4  d125              BNE      |L4.242|
0000a6  8830              LDRH     r0,[r6,#0]            ;360  ; ICA_EN
0000a8  2801              CMP      r0,#1                 ;360
0000aa  d122              BNE      |L4.242|
0000ac  f8b80000          LDRH     r0,[r8,#0]            ;361  ; ICA_MODBUS_ADDRESS
0000b0  f88d0000          STRB     r0,[sp,#0]            ;361
0000b4  f04f0004          MOV      r0,#4                 ;364
0000b8  f88d0001          STRB     r0,[sp,#1]            ;364
0000bc  f88d5002          STRB     r5,[sp,#2]            ;369
0000c0  f04f0002          MOV      r0,#2                 ;369
0000c4  f88d0003          STRB     r0,[sp,#3]            ;370
0000c8  f88d5004          STRB     r5,[sp,#4]            ;370
0000cc  f04f0001          MOV      r0,#1                 ;373
0000d0  f88d0005          STRB     r0,[sp,#5]            ;373
0000d4  f04f0106          MOV      r1,#6                 ;377
0000d8  4668              MOV      r0,sp                 ;379
0000da  f7fffffe          BL       CRC16_2
0000de  f88d0006          STRB     r0,[sp,#6]            ;380
0000e2  ea4f2020          ASR      r0,r0,#8              ;380
0000e6  f88d0007          STRB     r0,[sp,#7]            ;383
0000ea  f9b70000          LDRSH    r0,[r7,#0]            ;383  ; ICA_CH
0000ee  b3e8              CBZ      r0,|L4.364|
0000f0  2801              CMP      r0,#1                 ;388
                  |L4.242|
0000f2  4832              LDR      r0,|L4.444|
0000f4  f06f0214          MVN      r2,#0x14              ;388
0000f8  f9b00000          LDRSH    r0,[r0,#0]            ;389  ; TBAT
0000fc  ebc01100          RSB      r1,r0,r0,LSL #4       ;389
000100  eb020181          ADD      r1,r2,r1,LSL #2       ;392
000104  4a2e              LDR      r2,|L4.448|
000106  f9b22052          LDRSH    r2,[r2,#0x52]  ; main_kb_cnt
00010a  4291              CMP      r1,r2
00010c  d134              BNE      |L4.376|
00010e  8831              LDRH     r1,[r6,#0]  ; ICA_EN
000110  2901              CMP      r1,#1
000112  d131              BNE      |L4.376|
000114  f8b81000          LDRH     r1,[r8,#0]  ; ICA_MODBUS_ADDRESS
000118  f88d1000          STRB     r1,[sp,#0]
00011c  f04f0106          MOV      r1,#6
;;;397    	else if(bat[0]._Ib>IKB) snmp_bat_flag[0]&=~0x0008;	//Заряд батареи
000120  f88d1001          STRB     r1,[sp,#1]
000124  f88d5002          STRB     r5,[sp,#2]
000128  f04f011e          MOV      r1,#0x1e
;;;398    
;;;399    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
00012c  f88d1003          STRB     r1,[sp,#3]
000130  ea4f71e0          ASR      r1,r0,#31
000134  eb006111          ADD      r1,r0,r1,LSR #24
000138  ea4f2221          ASR      r2,r1,#8
;;;400    		{
;;;401    		snmp_bat_flag[0]|=0x0010;
;;;402    		if((snmp_bat_flag_puts[0]&0x0010)==0) 
;;;403    			{
;;;404    			snmp_trap_send("BAT #1, capacity test started",5,8,6); 
;;;405    			snmp_bat_flag_puts[0]|=0x0010;
;;;406    			}
;;;407    		}
;;;408    	else 
;;;409    		{
;;;410    		snmp_bat_flag[0]&=~0x0010;
00013c  f88d2004          STRB     r2,[sp,#4]
000140  f88d0005          STRB     r0,[sp,#5]
;;;411    		if(snmp_bat_flag_puts[0]&0x0010) 
000144  f04f0106          MOV      r1,#6
;;;412    			{
;;;413    			snmp_trap_send("BAT #1, capacity test stopped",5,8,7);
000148  4668              MOV      r0,sp
00014a  f7fffffe          BL       CRC16_2
00014e  f88d0006          STRB     r0,[sp,#6]
000152  ea4f2020          ASR      r0,r0,#8
;;;414    			snmp_bat_flag_puts[0]&=~0x0010;
000156  f88d0007          STRB     r0,[sp,#7]
00015a  8838              LDRH     r0,[r7,#0]  ; ICA_CH
;;;415    			}
;;;416    		}
;;;417    		
;;;418    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
00015c  2800              CMP      r0,#0
00015e  d10b              BNE      |L4.376|
000160  4604              MOV      r4,r0
000162  466d              MOV      r5,sp
                  |L4.356|
;;;419    		{
;;;420    		snmp_bat_flag[0]|=0x0020;
;;;421    		if((snmp_bat_flag_puts[0]&0x0020)==0) 
;;;422    			{
;;;423    			snmp_trap_send("BAT #1,leveling charge is started",5,8,8); 
;;;424    			snmp_bat_flag_puts[0]|=0x0020;
;;;425    			}
;;;426    		}
;;;427    	else 
;;;428    		{
;;;429    		snmp_bat_flag[0]&=~0x0020;
000164  5d28              LDRB     r0,[r5,r4]
000166  f7fffffe          BL       putchar_sc16is700
00016a  e000              B        |L4.366|
                  |L4.364|
;;;430    		if(snmp_bat_flag_puts[0]&0x0020) 
00016c  e007              B        |L4.382|
                  |L4.366|
00016e  f1040401          ADD      r4,r4,#1
;;;431    			{
;;;432    			snmp_trap_send("BAT #1,leveling charge is stopped",5,8,9);
000172  b2e4              UXTB     r4,r4
000174  2c08              CMP      r4,#8
000176  d3f5              BCC      |L4.356|
                  |L4.376|
000178  b005              ADD      sp,sp,#0x14
00017a  e8bd83f0          POP      {r4-r9,pc}
                  |L4.382|
;;;433    			snmp_bat_flag_puts[0]&=~0x0020;
00017e  f04f0400          MOV      r4,#0
000182  46e9              MOV      r9,sp
                  |L4.388|
000184  f8190004          LDRB     r0,[r9,r4]
;;;434    			}
;;;435    		}
;;;436    
;;;437    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
000188  f7fffffe          BL       putchar_sc16is700
;;;438    		{
;;;439    		snmp_bat_flag[0]|=0x0040;
00018c  f1040401          ADD      r4,r4,#1
000190  b2e4              UXTB     r4,r4
000192  2c08              CMP      r4,#8
;;;440    		if((snmp_bat_flag_puts[0]&0x0040)==0) 
000194  d3f6              BCC      |L4.388|
000196  e7ac              B        |L4.242|
;;;441    			{
;;;442    			snmp_trap_send("BAT #1,leveling charge is blocked",5,8,10); 
;;;443    			snmp_bat_flag_puts[0]|=0x0040;
;;;444    			}
;;;445    		}
;;;446    	else 
;;;447    		{
;;;448    		snmp_bat_flag[0]&=~0x0040;
;;;449    		if(snmp_bat_flag_puts[0]&0x0040) 
;;;450    			{
;;;451    			snmp_trap_send("BAT #1,leveling charge is unblocked",5,8,11);
;;;452    			snmp_bat_flag_puts[0]&=~0x0040;
;;;453    			} 
;;;454    		}
;;;455    
;;;456    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
;;;457    		{
;;;458    		snmp_bat_flag[0]|=0x0080;
;;;459    		if((snmp_bat_flag_puts[0]&0x0080)==0) 
;;;460    			{
;;;461    			snmp_trap_send("BAT #1,speed charge is started",5,8,10); 
;;;462    			snmp_bat_flag_puts[0]|=0x0080;
;;;463    			}
;;;464    		}
;;;465    	else 
;;;466    		{
;;;467    		snmp_bat_flag[0]&=~0x0080;
;;;468    		if(snmp_bat_flag_puts[0]&0x0080) 
;;;469    			{
;;;470    			snmp_trap_send("BAT #1,speed charge is stopped",5,8,11);
;;;471    			snmp_bat_flag_puts[0]&=~0x0080;
;;;472    			}
;;;473    		}
;;;474    
;;;475    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
;;;476    		{
;;;477    		snmp_bat_flag[0]|=0x0100;
;;;478    		if((snmp_bat_flag_puts[0]&0x0100)==0) 
;;;479    			{
;;;480    			snmp_trap_send("BAT #1,speed charge is blocked",5,8,12); 
;;;481    			snmp_bat_flag_puts[0]|=0x0100;
;;;482    			}
;;;483    		}
;;;484    	else 
;;;485    		{
;;;486    		snmp_bat_flag[0]&=~0x0100;
;;;487    		if(snmp_bat_flag_puts[0]&0x0100) 
;;;488    			{
;;;489    			snmp_trap_send("BAT #1,speed charge is unblocked",5,8,13);
;;;490    			snmp_bat_flag_puts[0]&=~0x0100;
;;;491    			} 
;;;492    		}
;;;493    
;;;494    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;495    		{
;;;496    		snmp_bat_flag[0]|=0x0200;
;;;497    		if((snmp_bat_flag_puts[0]&0x0200)==0) 
;;;498    			{
;;;499    			snmp_trap_send("BAT #1,equalising charge is on",5,8,14); 
;;;500    			snmp_bat_flag_puts[0]|=0x0200;
;;;501    			}
;;;502    		}
;;;503    	else 
;;;504    		{
;;;505    		snmp_bat_flag[0]&=~0x0200;
;;;506    		if(snmp_bat_flag_puts[0]&0x0200) 
;;;507    			{
;;;508    			snmp_trap_send("BAT #1,equalising charge is off",5,8,15);
;;;509    			snmp_bat_flag_puts[0]&=~0x0200;
;;;510    			}
;;;511    		}
;;;512    
;;;513    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;514    		{
;;;515    		snmp_bat_flag[0]|=0x0400;
;;;516    		if((snmp_bat_flag_puts[0]&0x0400)==0) 
;;;517    			{
;;;518    			snmp_trap_send("BAT #1,equalising charge is blocked",5,8,16); 
;;;519    			snmp_bat_flag_puts[0]|=0x0400;
;;;520    			}
;;;521    		}
;;;522    	else 
;;;523    		{
;;;524    		snmp_bat_flag[0]&=~0x0400;
;;;525    		if(snmp_bat_flag_puts[0]&0x0400) 
;;;526    			{
;;;527    			snmp_trap_send("BAT #1,equalising charge is unblocked",5,8,17);
;;;528    			snmp_bat_flag_puts[0]&=~0x0400;
;;;529    			} 
;;;530    		}
;;;531    
;;;532    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;533    		{
;;;534    		snmp_bat_flag[0]|=0x0800;
;;;535    		if((snmp_bat_flag_puts[0]&0x0800)==0) 
;;;536    			{
;;;537    			snmp_trap_send("BAT #1,molding charge is on",5,8,18); 
;;;538    			snmp_bat_flag_puts[0]|=0x0800;
;;;539    			}
;;;540    		}
;;;541    	else 
;;;542    		{
;;;543    		snmp_bat_flag[0]&=~0x0800;
;;;544    		if(snmp_bat_flag_puts[0]&0x0800) 
;;;545    			{
;;;546    			snmp_trap_send("BAT #1,molding charge is off",5,8,19);
;;;547    			snmp_bat_flag_puts[0]&=~0x0800;
;;;548    			}
;;;549    		}
;;;550    
;;;551    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;552    		{
;;;553    		snmp_bat_flag[0]|=0x1000;
;;;554    		if((snmp_bat_flag_puts[0]&0x1000)==0) 
;;;555    			{
;;;556    			snmp_trap_send("BAT #1,molding charge is blocked",5,8,20); 
;;;557    			snmp_bat_flag_puts[0]|=0x1000;
;;;558    			}
;;;559    		}
;;;560    	else 
;;;561    		{
;;;562    		snmp_bat_flag[0]&=~0x1000;
;;;563    		if(snmp_bat_flag_puts[0]&0x1000) 
;;;564    			{
;;;565    			snmp_trap_send("BAT #1,molding charge is unblocked",5,8,21);
;;;566    			snmp_bat_flag_puts[0]&=~0x1000;
;;;567    			} 
;;;568    		}
;;;569    	}
;;;570    else 
;;;571    	{
;;;572    	snmp_bat_flag[0]=0; 
;;;573    	snmp_bat_flag_puts[0]=0;
;;;574    	}
;;;575    
;;;576    if( (snmp_bat_status[1]==0 || snmp_bat_status[1]==2) && NUMBAT==2 )	//o_10 
;;;577    	{
;;;578    	if((bat[1]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
;;;579    		{
;;;580    		snmp_bat_flag[1]|=0x0001; 
;;;581    		if((snmp_bat_flag_puts[1]&0x0001)==0) 
;;;582    			{
;;;583    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,22); 
;;;584    			snmp_bat_flag_puts[1]|=0x0001;
;;;585    			}
;;;586    		}
;;;587    	else 
;;;588    		{
;;;589    		snmp_bat_flag[1]&=~0x0001; 
;;;590    		if(snmp_bat_flag_puts[1]&0x0001) 
;;;591    			{
;;;592    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,23);
;;;593    			snmp_bat_flag_puts[1]&=~0x0001;
;;;594    			}
;;;595    		}
;;;596    
;;;597    	if(bat[1]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;598    		{
;;;599    		snmp_bat_flag[1]|=0x0002;
;;;600    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;601    			{
;;;602    			//snmp_trap_send("BAT #2 Warning, high battery temperature",5,8,24); 
;;;603    			snmp_bat_flag_puts[1]|=0x0002;
;;;604    			}
;;;605    		}
;;;606    	else 
;;;607    		{
;;;608    		snmp_bat_flag[1]&=~0x0002;
;;;609    		if(snmp_bat_flag_puts[1]&0x0002) 
;;;610    			{
;;;611    			//snmp_trap_send("BAT #2 Warning clear, battery temperature is normal",5,8,25);
;;;612    			snmp_bat_flag_puts[1]&=~0x02;
;;;613    			}
;;;614    		}
;;;615    
;;;616    	if(bat[1]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;617    		{
;;;618    		snmp_bat_flag[1]|=0x0004;
;;;619    		if((snmp_bat_flag_puts[1]&0x0004)==0) 
;;;620    			{
;;;621    			//snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,26); 
;;;622    			snmp_bat_flag_puts[1]|=0x0004;
;;;623    			}
;;;624    		}
;;;625    	else 
;;;626    		{
;;;627    		snmp_bat_flag[1]&=~0x0004;
;;;628    		if(snmp_bat_flag_puts[1]&0x0004) 
;;;629    			{
;;;630    			//snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,27);
;;;631    			snmp_bat_flag_puts[1]&=~0x0004;
;;;632    			}
;;;633    		}
;;;634    
;;;635    	if(bat[1]._Ib<(-IKB)) snmp_bat_flag[1]|=0x0008;		//Разряд батареи
;;;636    	else if(bat[1]._Ib>IKB) snmp_bat_flag[1]&=~0x0008;	//Заряд батареи
;;;637    
;;;638    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
;;;639    		{
;;;640    		snmp_bat_flag[1]|=0x0010;
;;;641    		if((snmp_bat_flag_puts[1]&0x0010)==0) 
;;;642    			{
;;;643    			snmp_trap_send("BAT #2, capacity test started",5,8,28); 
;;;644    			snmp_bat_flag_puts[1]|=0x0010;
;;;645    			}
;;;646    		}
;;;647    	else 
;;;648    		{
;;;649    		snmp_bat_flag[1]&=~0x0010;
;;;650    		if(snmp_bat_flag_puts[1]&0x0010) 
;;;651    			{
;;;652    			snmp_trap_send("BAT #2, capacity test stopped",5,8,29);
;;;653    			snmp_bat_flag_puts[1]&=~0x0010;
;;;654    			}
;;;655    		}
;;;656    		
;;;657    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
;;;658    		{
;;;659    		snmp_bat_flag[1]|=0x0020;
;;;660    		if((snmp_bat_flag_puts[1]&0x0020)==0) 
;;;661    			{
;;;662    			snmp_trap_send("BAT #2,leveling charge is started",5,8,30); 
;;;663    			snmp_bat_flag_puts[1]|=0x0020;
;;;664    			}
;;;665    		}
;;;666    	else 
;;;667    		{
;;;668    		snmp_bat_flag[1]&=~0x0020;
;;;669    		if(snmp_bat_flag_puts[1]&0x0020) 
;;;670    			{
;;;671    			snmp_trap_send("BAT #2,leveling charge is stopped",5,8,31);
;;;672    			snmp_bat_flag_puts[1]&=~0x0020;
;;;673    			}
;;;674    		}
;;;675    
;;;676    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
;;;677    		{
;;;678    		snmp_bat_flag[1]|=0x0040;
;;;679    		if((snmp_bat_flag_puts[1]&0x0040)==0) 
;;;680    			{
;;;681    			snmp_trap_send("BAT #2,leveling charge is blocked",5,8,32); 
;;;682    			snmp_bat_flag_puts[1]|=0x0040;
;;;683    			}
;;;684    		}
;;;685    	else 
;;;686    		{
;;;687    		snmp_bat_flag[1]&=~0x0040;
;;;688    		if(snmp_bat_flag_puts[1]&0x0040) 
;;;689    			{
;;;690    			snmp_trap_send("BAT #2,leveling charge is unblocked",5,8,33);
;;;691    			snmp_bat_flag_puts[1]&=~0x0040;
;;;692    			} 
;;;693    		}
;;;694    
;;;695    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
;;;696    		{
;;;697    		snmp_bat_flag[1]|=0x0080;
;;;698    		if((snmp_bat_flag_puts[1]&0x0080)==0) 
;;;699    			{
;;;700    			snmp_trap_send("BAT #2,speed charge is started",5,8,34); 
;;;701    			snmp_bat_flag_puts[1]|=0x0080;
;;;702    			}
;;;703    		}
;;;704    	else 
;;;705    		{
;;;706    		snmp_bat_flag[1]&=~0x0080;
;;;707    		if(snmp_bat_flag_puts[1]&0x0080) 
;;;708    			{
;;;709    			snmp_trap_send("BAT #2,speed charge is stopped",5,8,35);
;;;710    			snmp_bat_flag_puts[1]&=~0x0080;
;;;711    			}
;;;712    		}
;;;713    
;;;714    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
;;;715    		{
;;;716    		snmp_bat_flag[1]|=0x0100;
;;;717    		if((snmp_bat_flag_puts[1]&0x0100)==0) 
;;;718    			{
;;;719    			snmp_trap_send("BAT #2,speed charge is blocked",5,8,36); 
;;;720    			snmp_bat_flag_puts[1]|=0x0100;
;;;721    			}
;;;722    		}
;;;723    	else 
;;;724    		{
;;;725    		snmp_bat_flag[1]&=~0x0100;
;;;726    		if(snmp_bat_flag_puts[1]&0x0100) 
;;;727    			{
;;;728    			snmp_trap_send("BAT #2,speed charge is unblocked",5,8,37);
;;;729    			snmp_bat_flag_puts[1]&=~0x0100;
;;;730    			} 
;;;731    		}
;;;732    
;;;733    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;734    		{
;;;735    		snmp_bat_flag[1]|=0x0200;
;;;736    		if((snmp_bat_flag_puts[1]&0x0200)==0) 
;;;737    			{
;;;738    			snmp_trap_send("BAT #2,equalising charge is on",5,8,38); 
;;;739    			snmp_bat_flag_puts[1]|=0x0200;
;;;740    			}
;;;741    		}
;;;742    	else 
;;;743    		{
;;;744    		snmp_bat_flag[1]&=~0x0200;
;;;745    		if(snmp_bat_flag_puts[1]&0x0200) 
;;;746    			{
;;;747    			snmp_trap_send("BAT #2,equalising charge is off",5,8,39);
;;;748    			snmp_bat_flag_puts[1]&=~0x0200;
;;;749    			}
;;;750    		}
;;;751    
;;;752    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;753    		{
;;;754    		snmp_bat_flag[1]|=0x0400;
;;;755    		if((snmp_bat_flag_puts[1]&0x0400)==0) 
;;;756    			{
;;;757    			snmp_trap_send("BAT #2,equalising charge is blocked",5,8,40); 
;;;758    			snmp_bat_flag_puts[1]|=0x0400;
;;;759    			}
;;;760    		}
;;;761    	else 
;;;762    		{
;;;763    		snmp_bat_flag[1]&=~0x0400;
;;;764    		if(snmp_bat_flag_puts[1]&0x0400) 
;;;765    			{
;;;766    			snmp_trap_send("BAT #2,equalising charge is unblocked",5,8,41);
;;;767    			snmp_bat_flag_puts[1]&=~0x0400;
;;;768    			} 
;;;769    		}
;;;770    
;;;771    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;772    		{
;;;773    		snmp_bat_flag[1]|=0x0800;
;;;774    		if((snmp_bat_flag_puts[1]&0x0800)==0) 
;;;775    			{
;;;776    			snmp_trap_send("BAT #2,molding charge is on",5,8,42); 
;;;777    			snmp_bat_flag_puts[1]|=0x0800;
;;;778    			}
;;;779    		}
;;;780    	else 
;;;781    		{
;;;782    		snmp_bat_flag[1]&=~0x0800;
;;;783    		if(snmp_bat_flag_puts[1]&0x0800) 
;;;784    			{
;;;785    			snmp_trap_send("BAT #2,molding charge is off",5,8,43);
;;;786    			snmp_bat_flag_puts[1]&=~0x0800;
;;;787    			}
;;;788    		}
;;;789    
;;;790    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;791    		{
;;;792    		snmp_bat_flag[1]|=0x1000;
;;;793    		if((snmp_bat_flag_puts[1]&0x1000)==0) 
;;;794    			{
;;;795    			snmp_trap_send("BAT #2,molding charge is blocked",5,8,44); 
;;;796    			snmp_bat_flag_puts[1]|=0x1000;
;;;797    			}
;;;798    		}
;;;799    	else 
;;;800    		{
;;;801    		snmp_bat_flag[1]&=~0x1000;
;;;802    		if(snmp_bat_flag_puts[1]&0x1000) 
;;;803    			{
;;;804    			snmp_trap_send("BAT #2,molding charge is unblocked",5,8,45);
;;;805    			snmp_bat_flag_puts[1]&=~0x1000;
;;;806    			} 
;;;807    		}
;;;808    	}
;;;809    else 
;;;810    	{
;;;811    	snmp_bat_flag[1]=0; 
;;;812    	snmp_bat_flag_puts[1]=0;
;;;813    	}
;;;814    /*
;;;815    if(!snmp_bat_status[1])
;;;816    	{
;;;817    	if((bat[1]._Ub<(USIGN*10))) 
;;;818    		{
;;;819    		snmp_bat_flag[1]|=0x01; 
;;;820    		if((snmp_bat_flag_puts[1]&0x01)==0) 
;;;821    			{
;;;822    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,0); 
;;;823    			snmp_bat_flag_puts[1]|=0x01;
;;;824    			}
;;;825    		}
;;;826    	else 
;;;827    		{
;;;828    		snmp_bat_flag[1]&=~0x01; 
;;;829    		if(snmp_bat_flag_puts[1]&0x01) 
;;;830    			{
;;;831    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,1);
;;;832    			snmp_bat_flag_puts[1]&=~0x01;
;;;833    			}
;;;834    		}
;;;835    	if(bat[1]._temper_stat&0x01) 
;;;836    		{
;;;837    		snmp_bat_flag[1]|=0x02;
;;;838    		if((snmp_bat_flag_puts[1]&0x02)==0) 
;;;839    			{
;;;840    			snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,2); 
;;;841    			snmp_bat_flag_puts[1]|=0x02;
;;;842    			}
;;;843    		}
;;;844    	else 
;;;845    		{
;;;846    		snmp_bat_flag[1]&=~0x02;
;;;847    		if(snmp_bat_flag_puts[1]&0x02) 
;;;848    			{
;;;849    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,3);
;;;850    			snmp_bat_flag_puts[1]&=~0x02;
;;;851    			}
;;;852    		}
;;;853    	if(bat[1]._temper_stat&0x02) 
;;;854    		{
;;;855    		snmp_bat_flag[1]|=0x04;
;;;856    		if((snmp_bat_flag_puts[1]&0x04)==0) 
;;;857    			{
;;;858    			snmp_trap_send("BAT #2 Alarm, maximum battery temperature",5,8,4); 
;;;859    			snmp_bat_flag_puts[1]|=0x04;
;;;860    			}
;;;861    		}
;;;862    	else 
;;;863    		{
;;;864    		snmp_bat_flag[1]&=~0x04;
;;;865    		if(snmp_bat_flag_puts[1]&0x04) 
;;;866    			{
;;;867    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,5);
;;;868    			snmp_bat_flag_puts[1]&=~0x04;
;;;869    			}
;;;870    		}
;;;871    		
;;;872    	if(bat[1]._Ib<(-IKB))	snmp_bat_flag[1]|=0x80;
;;;873    	else if(bat[1]._Ib>IKB)snmp_bat_flag[1]&=~0x80;
;;;874    
;;;875    	if((spc_stat==spcKE)&&(spc_bat==1)) 
;;;876    		{
;;;877    		snmp_bat_flag[1]|=0x10;
;;;878    		if((snmp_bat_flag_puts[1]&0x10)==0) 
;;;879    			{
;;;880    			snmp_trap_send("BAT #2, capacity check enabled",5,8,6); 
;;;881    			snmp_bat_flag_puts[1]|=0x10;
;;;882    			}
;;;883    		}
;;;884    	else 
;;;885    		{
;;;886    		snmp_bat_flag[1]&=~0x10;
;;;887    		if(snmp_bat_flag_puts[1]&0x10) 
;;;888    			{
;;;889    			snmp_trap_send("BAT #2, capacity check disabled",5,8,7);
;;;890    			snmp_bat_flag_puts[1]&=~0x10;
;;;891    			}
;;;892    		}
;;;893    		
;;;894    	if(spc_stat==spcVZ) 
;;;895    		{
;;;896    		snmp_bat_flag[1]|=0x20;
;;;897    		if((snmp_bat_flag_puts[1]&0x20)==0) 
;;;898    			{
;;;899    			snmp_trap_send("BAT #2,equalizing charge is on",5,8,8); 
;;;900    			snmp_bat_flag_puts[1]|=0x20;
;;;901    			}
;;;902    		}
;;;903    	else 
;;;904    		{
;;;905    		snmp_bat_flag[1]&=~0x20;
;;;906    		if(snmp_bat_flag_puts[1]&0x20) 
;;;907    			{
;;;908    			snmp_trap_send("BAT #2,equalizing charge is off",5,8,9);
;;;909    			snmp_bat_flag_puts[1]&=~0x20;
;;;910    			}
;;;911    		}
;;;912    
;;;913    	if(vz_error) 
;;;914    		{
;;;915    		snmp_bat_flag[1]|=0x40;
;;;916    		if((snmp_bat_flag_puts[1]&0x40)==0) 
;;;917    			{
;;;918    			snmp_trap_send("BAT #2,equalizing charge blocked",5,8,10); 
;;;919    			snmp_bat_flag_puts[1]|=0x40;
;;;920    			}
;;;921    		}
;;;922    	else 
;;;923    		{
;;;924    		snmp_bat_flag[1]&=~0x40;
;;;925    		if(snmp_bat_flag_puts[1]&0x40) 
;;;926    			{
;;;927    			snmp_trap_send("BAT #2,equalizing charge is not blocked",5,8,11);
;;;928    			snmp_bat_flag_puts[1]&=~0x40;
;;;929    			} 
;;;930    		}
;;;931       }
;;;932    else 
;;;933    	{
;;;934    	snmp_bat_flag[1]=0; 
;;;935    	snmp_bat_flag_puts[1]=0;
;;;936    	} */
;;;937    }
;;;938    
                          ENDP

                  |L4.408|
                          DCD      ica_timer_cnt
                  |L4.412|
                          DCD      ICA_EN
                  |L4.416|
                          DCD      ica_plazma
                  |L4.420|
                          DCD      bps_I
                  |L4.424|
                          DCD      ica_my_current
                  |L4.428|
                          DCD      ica_your_current
                  |L4.432|
                          DCD      ica_u_necc
                  |L4.436|
                          DCD      ICA_MODBUS_ADDRESS
                  |L4.440|
                          DCD      ICA_CH
                  |L4.444|
                          DCD      TBAT
                  |L4.448|
                          DCD      ||area_number.26||

                          AREA ||area_number.5||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.5||, ||.text||
                  inv_drv PROC
;;;326    // заполнение флагов для АКБ
;;;327    void bat_flag (void)
000000  b570              PUSH     {r4-r6,lr}
;;;328    {  
000002  4604              MOV      r4,r0
;;;329    if(spc_stat!=spcVZ) 
000004  f04f0207          MOV      r2,#7
000008  f04f0101          MOV      r1,#1
00000c  48a4              LDR      r0,|L5.672|
00000e  f7fffffe          BL       gran_char
;;;330    	{
;;;331    	vz_error=0;
;;;332    	sp_ch_error=0;
000012  48a4              LDR      r0,|L5.676|
;;;333    	vz1_error=0;
000014  eb040144          ADD      r1,r4,r4,LSL #1
;;;334    	vz2_error=0;
;;;335    	}
;;;336    
;;;337    if( (snmp_bat_status[0]==0 || snmp_bat_status[0]==2) && NUMBAT>0) 	//o_10 	 			//Батарея №1
000018  eb001541          ADD      r5,r0,r1,LSL #5
00001c  f8950047          LDRB     r0,[r5,#0x47]
;;;338    	{
;;;339    	if((bat[0]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
000020  f8951046          LDRB     r1,[r5,#0x46]
000024  ea800001          EOR      r0,r0,r1              ;337
;;;340    		{
;;;341    		snmp_bat_flag[0]|=0x0001; 
;;;342    		if((snmp_bat_flag_puts[0]&0x0001)==0) 
;;;343    			{
;;;344    			snmp_trap_send("BAT #1 Alarm, battery is low",5,8,0); 
;;;345    			snmp_bat_flag_puts[0]|=0x0001;
;;;346    			}
;;;347    		}
;;;348    	else 
;;;349    		{
;;;350    		snmp_bat_flag[0]&=~0x0001; 
;;;351    		if(snmp_bat_flag_puts[0]&0x0001) 
;;;352    			{
;;;353    			snmp_trap_send("BAT #1 Alarm clear, battery is not low",5,8,1);
;;;354    			snmp_bat_flag_puts[0]&=~0x0001;
;;;355    			}
;;;356    		}
;;;357    
;;;358    	if(bat[0]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;359    		{
;;;360    		snmp_bat_flag[0]|=0x0002;
;;;361    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;362    			{
;;;363    			//snmp_trap_send("BAT #1 Warning, high battery temperature",5,8,2); 
;;;364    			snmp_bat_flag_puts[0]|=0x0002;
;;;365    			}
;;;366    		}
;;;367    	else 
;;;368    		{
;;;369    		snmp_bat_flag[0]&=~0x0002;
;;;370    		if(snmp_bat_flag_puts[0]&0x0002) 
;;;371    			{
;;;372    			//snmp_trap_send("BAT #1 Warning clear, battery temperature is normal",5,8,3);
;;;373    			snmp_bat_flag_puts[0]&=~0x02;
;;;374    			}
;;;375    		}
;;;376    
;;;377    	if(bat[0]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;378    		{
;;;379    		snmp_bat_flag[0]|=0x0004;
;;;380    		if((snmp_bat_flag_puts[0]&0x0004)==0) 
;;;381    			{
;;;382    			//snmp_trap_send("BAT #1 Alarm, high battery temperature",5,8,4); 
;;;383    			snmp_bat_flag_puts[0]|=0x0004;
;;;384    			}
;;;385    		}
;;;386    	else 
;;;387    		{
;;;388    		snmp_bat_flag[0]&=~0x0004;
;;;389    		if(snmp_bat_flag_puts[0]&0x0004) 
;;;390    			{
;;;391    			//snmp_trap_send("BAT #1 Alarm clear, battery temperature is normal",5,8,5);
;;;392    			snmp_bat_flag_puts[0]&=~0x0004;
;;;393    			}
;;;394    		}
;;;395    
;;;396    	if(bat[0]._Ib<(-IKB)) snmp_bat_flag[0]|=0x0008;		//Разряд батареи
000028  4a9f              LDR      r2,|L5.680|
00002a  b100              CBZ      r0,|L5.46|
00002c  7050              STRB     r0,[r2,#1]            ;341
                  |L5.46|
00002e  ea010100          AND      r1,r1,r0              ;342
000032  b101              CBZ      r1,|L5.54|
000034  7091              STRB     r1,[r2,#2]            ;337
                  |L5.54|
000036  ea000301          AND      r3,r0,r1              ;337
00003a  07db              LSLS     r3,r3,#31             ;337
00003c  d027              BEQ      |L5.142|
00003e  78d0              LDRB     r0,[r2,#3]            ;339  ; plazma_inv
000040  f1000001          ADD      r0,r0,#1              ;339
000044  70d0              STRB     r0,[r2,#3]            ;339
000046  b134              CBZ      r4,|L5.86|
000048  2c01              CMP      r4,#1                 ;339
00004a  d00b              BEQ      |L5.100|
00004c  2c02              CMP      r4,#2                 ;341
00004e  d010              BEQ      |L5.114|
000050  2c03              CMP      r4,#3                 ;339
000052  d015              BEQ      |L5.128|
000054  e120              B        |L5.664|
                  |L5.86|
000056  2301              MOVS     r3,#1                 ;342
000058  461a              MOV      r2,r3                 ;342
00005a  210e              MOVS     r1,#0xe               ;342
00005c  a093              ADR      r0,|L5.684|
00005e  f7fffffe          BL       snmp_trap_send
000062  e119              B        |L5.664|
                  |L5.100|
000064  2301              MOVS     r3,#1                 ;342
000066  2202              MOVS     r2,#2                 ;342
000068  210e              MOVS     r1,#0xe               ;344
00006a  a097              ADR      r0,|L5.712|
00006c  f7fffffe          BL       snmp_trap_send
000070  e112              B        |L5.664|
                  |L5.114|
000072  2301              MOVS     r3,#1                 ;344
000074  2203              MOVS     r2,#3                 ;345
000076  210e              MOVS     r1,#0xe               ;345
000078  a09a              ADR      r0,|L5.740|
00007a  f7fffffe          BL       snmp_trap_send
00007e  e10b              B        |L5.664|
                  |L5.128|
000080  2301              MOVS     r3,#1                 ;350
000082  2204              MOVS     r2,#4                 ;350
000084  210e              MOVS     r1,#0xe               ;351
000086  a09e              ADR      r0,|L5.768|
000088  f7fffffe          BL       snmp_trap_send
00008c  e104              B        |L5.664|
                  |L5.142|
00008e  0783              LSLS     r3,r0,#30             ;353
000090  d529              BPL      |L5.230|
000092  078b              LSLS     r3,r1,#30             ;353
000094  d527              BPL      |L5.230|
000096  78d0              LDRB     r0,[r2,#3]            ;354  ; plazma_inv
000098  f1000001          ADD      r0,r0,#1              ;354
00009c  70d0              STRB     r0,[r2,#3]            ;358
00009e  b134              CBZ      r4,|L5.174|
0000a0  2c01              CMP      r4,#1                 ;358
0000a2  d00b              BEQ      |L5.188|
0000a4  2c02              CMP      r4,#2                 ;360
0000a6  d010              BEQ      |L5.202|
0000a8  2c03              CMP      r4,#3                 ;360
0000aa  d015              BEQ      |L5.216|
0000ac  e0f4              B        |L5.664|
                  |L5.174|
0000ae  2302              MOVS     r3,#2                 ;361
0000b0  2201              MOVS     r2,#1                 ;361
0000b2  210e              MOVS     r1,#0xe               ;361
0000b4  a099              ADR      r0,|L5.796|
0000b6  f7fffffe          BL       snmp_trap_send
0000ba  e0ed              B        |L5.664|
                  |L5.188|
0000bc  2302              MOVS     r3,#2                 ;369
0000be  461a              MOV      r2,r3                 ;369
0000c0  210e              MOVS     r1,#0xe               ;369
0000c2  a09d              ADR      r0,|L5.824|
0000c4  f7fffffe          BL       snmp_trap_send
0000c8  e0e6              B        |L5.664|
                  |L5.202|
0000ca  2302              MOVS     r3,#2                 ;370
0000cc  2203              MOVS     r2,#3                 ;373
0000ce  210e              MOVS     r1,#0xe               ;373
0000d0  a0a0              ADR      r0,|L5.852|
0000d2  f7fffffe          BL       snmp_trap_send
0000d6  e0df              B        |L5.664|
                  |L5.216|
0000d8  2302              MOVS     r3,#2                 ;379
0000da  2204              MOVS     r2,#4                 ;379
0000dc  210e              MOVS     r1,#0xe               ;379
0000de  a0a4              ADR      r0,|L5.880|
0000e0  f7fffffe          BL       snmp_trap_send
0000e4  e0d8              B        |L5.664|
                  |L5.230|
0000e6  0743              LSLS     r3,r0,#29             ;383
0000e8  d529              BPL      |L5.318|
0000ea  074b              LSLS     r3,r1,#29             ;383
0000ec  d527              BPL      |L5.318|
0000ee  78d0              LDRB     r0,[r2,#3]            ;388  ; plazma_inv
0000f0  f1000001          ADD      r0,r0,#1              ;388
0000f4  70d0              STRB     r0,[r2,#3]            ;388
0000f6  b134              CBZ      r4,|L5.262|
0000f8  2c01              CMP      r4,#1                 ;389
0000fa  d00b              BEQ      |L5.276|
0000fc  2c02              CMP      r4,#2                 ;389
0000fe  d010              BEQ      |L5.290|
000100  2c03              CMP      r4,#3                 ;392
000102  d015              BEQ      |L5.304|
000104  e0c8              B        |L5.664|
                  |L5.262|
000106  2303              MOVS     r3,#3
000108  2201              MOVS     r2,#1
00010a  210e              MOVS     r1,#0xe
00010c  a09f              ADR      r0,|L5.908|
00010e  f7fffffe          BL       snmp_trap_send
000112  e0c1              B        |L5.664|
                  |L5.276|
000114  2303              MOVS     r3,#3
000116  2202              MOVS     r2,#2
000118  210e              MOVS     r1,#0xe
00011a  a0a3              ADR      r0,|L5.936|
00011c  f7fffffe          BL       snmp_trap_send
;;;397    	else if(bat[0]._Ib>IKB) snmp_bat_flag[0]&=~0x0008;	//Заряд батареи
000120  e0ba              B        |L5.664|
                  |L5.290|
000122  2303              MOVS     r3,#3
000124  461a              MOV      r2,r3
000126  210e              MOVS     r1,#0xe
000128  a0a6              ADR      r0,|L5.964|
;;;398    
;;;399    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
00012a  f7fffffe          BL       snmp_trap_send
00012e  e0b3              B        |L5.664|
                  |L5.304|
000130  2303              MOVS     r3,#3
000132  2204              MOVS     r2,#4
000134  210e              MOVS     r1,#0xe
000136  a0aa              ADR      r0,|L5.992|
000138  f7fffffe          BL       snmp_trap_send
;;;400    		{
;;;401    		snmp_bat_flag[0]|=0x0010;
;;;402    		if((snmp_bat_flag_puts[0]&0x0010)==0) 
;;;403    			{
;;;404    			snmp_trap_send("BAT #1, capacity test started",5,8,6); 
;;;405    			snmp_bat_flag_puts[0]|=0x0010;
;;;406    			}
;;;407    		}
;;;408    	else 
;;;409    		{
;;;410    		snmp_bat_flag[0]&=~0x0010;
00013c  e0ac              B        |L5.664|
                  |L5.318|
00013e  0703              LSLS     r3,r0,#28
000140  d529              BPL      |L5.406|
;;;411    		if(snmp_bat_flag_puts[0]&0x0010) 
000142  070b              LSLS     r3,r1,#28
000144  d527              BPL      |L5.406|
000146  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
;;;412    			{
;;;413    			snmp_trap_send("BAT #1, capacity test stopped",5,8,7);
000148  f1000001          ADD      r0,r0,#1
00014c  70d0              STRB     r0,[r2,#3]
00014e  b134              CBZ      r4,|L5.350|
000150  2c01              CMP      r4,#1
000152  d00b              BEQ      |L5.364|
;;;414    			snmp_bat_flag_puts[0]&=~0x0010;
000154  2c02              CMP      r4,#2
000156  d010              BEQ      |L5.378|
000158  2c03              CMP      r4,#3
00015a  d015              BEQ      |L5.392|
;;;415    			}
;;;416    		}
;;;417    		
;;;418    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
00015c  e09c              B        |L5.664|
                  |L5.350|
00015e  2304              MOVS     r3,#4
000160  2201              MOVS     r2,#1
000162  210e              MOVS     r1,#0xe
;;;419    		{
;;;420    		snmp_bat_flag[0]|=0x0020;
;;;421    		if((snmp_bat_flag_puts[0]&0x0020)==0) 
;;;422    			{
;;;423    			snmp_trap_send("BAT #1,leveling charge is started",5,8,8); 
;;;424    			snmp_bat_flag_puts[0]|=0x0020;
;;;425    			}
;;;426    		}
;;;427    	else 
;;;428    		{
;;;429    		snmp_bat_flag[0]&=~0x0020;
000164  a0a5              ADR      r0,|L5.1020|
000166  f7fffffe          BL       snmp_trap_send
00016a  e095              B        |L5.664|
                  |L5.364|
;;;430    		if(snmp_bat_flag_puts[0]&0x0020) 
00016c  2304              MOVS     r3,#4
00016e  2202              MOVS     r2,#2
000170  210e              MOVS     r1,#0xe
;;;431    			{
;;;432    			snmp_trap_send("BAT #1,leveling charge is stopped",5,8,9);
000172  a0ab              ADR      r0,|L5.1056|
000174  f7fffffe          BL       snmp_trap_send
000178  e08e              B        |L5.664|
                  |L5.378|
00017a  2304              MOVS     r3,#4
00017c  2203              MOVS     r2,#3
;;;433    			snmp_bat_flag_puts[0]&=~0x0020;
00017e  210e              MOVS     r1,#0xe
000180  a0b0              ADR      r0,|L5.1092|
000182  f7fffffe          BL       snmp_trap_send
;;;434    			}
;;;435    		}
;;;436    
;;;437    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
000186  e087              B        |L5.664|
                  |L5.392|
000188  2304              MOVS     r3,#4
00018a  461a              MOV      r2,r3
;;;438    		{
;;;439    		snmp_bat_flag[0]|=0x0040;
00018c  210e              MOVS     r1,#0xe
00018e  a0b6              ADR      r0,|L5.1128|
000190  f7fffffe          BL       snmp_trap_send
;;;440    		if((snmp_bat_flag_puts[0]&0x0040)==0) 
000194  e080              B        |L5.664|
                  |L5.406|
000196  06c3              LSLS     r3,r0,#27
000198  d529              BPL      |L5.494|
;;;441    			{
;;;442    			snmp_trap_send("BAT #1,leveling charge is blocked",5,8,10); 
00019a  06cb              LSLS     r3,r1,#27
00019c  d527              BPL      |L5.494|
00019e  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
0001a0  f1000001          ADD      r0,r0,#1
0001a4  70d0              STRB     r0,[r2,#3]
;;;443    			snmp_bat_flag_puts[0]|=0x0040;
0001a6  b134              CBZ      r4,|L5.438|
0001a8  2c01              CMP      r4,#1
0001aa  d00b              BEQ      |L5.452|
0001ac  2c02              CMP      r4,#2
0001ae  d010              BEQ      |L5.466|
0001b0  2c03              CMP      r4,#3                 ;401
0001b2  d015              BEQ      |L5.480|
0001b4  e070              B        |L5.664|
                  |L5.438|
0001b6  2305              MOVS     r3,#5                 ;401
0001b8  2201              MOVS     r2,#1                 ;402
0001ba  210e              MOVS     r1,#0xe               ;402
0001bc  a0b3              ADR      r0,|L5.1164|
0001be  f7fffffe          BL       snmp_trap_send
0001c2  e069              B        |L5.664|
                  |L5.452|
0001c4  2305              MOVS     r3,#5                 ;404
0001c6  2202              MOVS     r2,#2                 ;404
0001c8  210e              MOVS     r1,#0xe               ;404
0001ca  a0b9              ADR      r0,|L5.1200|
0001cc  f7fffffe          BL       snmp_trap_send
0001d0  e062              B        |L5.664|
                  |L5.466|
0001d2  2305              MOVS     r3,#5                 ;405
0001d4  2203              MOVS     r2,#3                 ;420
0001d6  210e              MOVS     r1,#0xe               ;420
0001d8  a0be              ADR      r0,|L5.1236|
0001da  f7fffffe          BL       snmp_trap_send
0001de  e05b              B        |L5.664|
                  |L5.480|
0001e0  2305              MOVS     r3,#5                 ;421
0001e2  2204              MOVS     r2,#4                 ;423
0001e4  210e              MOVS     r1,#0xe               ;423
0001e6  a0c4              ADR      r0,|L5.1272|
0001e8  f7fffffe          BL       snmp_trap_send
0001ec  e054              B        |L5.664|
                  |L5.494|
0001ee  0683              LSLS     r3,r0,#26             ;424
0001f0  d529              BPL      |L5.582|
0001f2  068b              LSLS     r3,r1,#26             ;424
0001f4  d527              BPL      |L5.582|
0001f6  78d0              LDRB     r0,[r2,#3]            ;424  ; plazma_inv
;;;444    			}
;;;445    		}
;;;446    	else 
;;;447    		{
;;;448    		snmp_bat_flag[0]&=~0x0040;
0001f8  f1000001          ADD      r0,r0,#1
0001fc  70d0              STRB     r0,[r2,#3]
0001fe  b134              CBZ      r4,|L5.526|
;;;449    		if(snmp_bat_flag_puts[0]&0x0040) 
000200  2c01              CMP      r4,#1
000202  d00b              BEQ      |L5.540|
000204  2c02              CMP      r4,#2
;;;450    			{
;;;451    			snmp_trap_send("BAT #1,leveling charge is unblocked",5,8,11);
000206  d010              BEQ      |L5.554|
000208  2c03              CMP      r4,#3
00020a  d015              BEQ      |L5.568|
00020c  e044              B        |L5.664|
                  |L5.526|
00020e  2306              MOVS     r3,#6
000210  2201              MOVS     r2,#1
;;;452    			snmp_bat_flag_puts[0]&=~0x0040;
000212  210e              MOVS     r1,#0xe
000214  a0c1              ADR      r0,|L5.1308|
000216  f7fffffe          BL       snmp_trap_send
;;;453    			} 
;;;454    		}
;;;455    
;;;456    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
00021a  e03d              B        |L5.664|
                  |L5.540|
00021c  2306              MOVS     r3,#6
00021e  2202              MOVS     r2,#2
000220  210e              MOVS     r1,#0xe
;;;457    		{
;;;458    		snmp_bat_flag[0]|=0x0080;
;;;459    		if((snmp_bat_flag_puts[0]&0x0080)==0) 
;;;460    			{
;;;461    			snmp_trap_send("BAT #1,speed charge is started",5,8,10); 
;;;462    			snmp_bat_flag_puts[0]|=0x0080;
;;;463    			}
;;;464    		}
;;;465    	else 
;;;466    		{
;;;467    		snmp_bat_flag[0]&=~0x0080;
000222  a0c7              ADR      r0,|L5.1344|
000224  f7fffffe          BL       snmp_trap_send
000228  e036              B        |L5.664|
                  |L5.554|
;;;468    		if(snmp_bat_flag_puts[0]&0x0080) 
00022a  2306              MOVS     r3,#6
00022c  2203              MOVS     r2,#3
00022e  210e              MOVS     r1,#0xe
;;;469    			{
;;;470    			snmp_trap_send("BAT #1,speed charge is stopped",5,8,11);
000230  a0cc              ADR      r0,|L5.1380|
000232  f7fffffe          BL       snmp_trap_send
000236  e02f              B        |L5.664|
                  |L5.568|
000238  2306              MOVS     r3,#6
00023a  2204              MOVS     r2,#4
;;;471    			snmp_bat_flag_puts[0]&=~0x0080;
00023c  210e              MOVS     r1,#0xe
00023e  a0d2              ADR      r0,|L5.1416|
000240  f7fffffe          BL       snmp_trap_send
;;;472    			}
;;;473    		}
;;;474    
;;;475    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
000244  e028              B        |L5.664|
                  |L5.582|
000246  b300              CBZ      r0,|L5.650|
;;;476    		{
;;;477    		snmp_bat_flag[0]|=0x0100;
000248  b9f9              CBNZ     r1,|L5.650|
00024a  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
00024c  f1000001          ADD      r0,r0,#1
;;;478    		if((snmp_bat_flag_puts[0]&0x0100)==0) 
000250  70d0              STRB     r0,[r2,#3]
000252  b134              CBZ      r4,|L5.610|
000254  2c01              CMP      r4,#1
;;;479    			{
;;;480    			snmp_trap_send("BAT #1,speed charge is blocked",5,8,12); 
000256  d00b              BEQ      |L5.624|
000258  2c02              CMP      r4,#2
00025a  d010              BEQ      |L5.638|
00025c  2c03              CMP      r4,#3
00025e  d015              BEQ      |L5.652|
000260  e01a              B        |L5.664|
                  |L5.610|
;;;481    			snmp_bat_flag_puts[0]|=0x0100;
000262  2300              MOVS     r3,#0
000264  2201              MOVS     r2,#1
000266  210e              MOVS     r1,#0xe
000268  a0d0              ADR      r0,|L5.1452|
00026a  f7fffffe          BL       snmp_trap_send
00026e  e013              B        |L5.664|
                  |L5.624|
000270  2300              MOVS     r3,#0                 ;458
000272  2202              MOVS     r2,#2                 ;458
000274  210e              MOVS     r1,#0xe               ;459
000276  a0d2              ADR      r0,|L5.1472|
000278  f7fffffe          BL       snmp_trap_send
00027c  e00c              B        |L5.664|
                  |L5.638|
00027e  2300              MOVS     r3,#0                 ;461
000280  2203              MOVS     r2,#3                 ;461
000282  210e              MOVS     r1,#0xe               ;461
000284  a0d3              ADR      r0,|L5.1492|
000286  f7fffffe          BL       snmp_trap_send
                  |L5.650|
00028a  e005              B        |L5.664|
                  |L5.652|
00028c  2300              MOVS     r3,#0                 ;462
00028e  2204              MOVS     r2,#4                 ;462
;;;482    			}
;;;483    		}
;;;484    	else 
;;;485    		{
;;;486    		snmp_bat_flag[0]&=~0x0100;
000290  210e              MOVS     r1,#0xe
000292  a0d5              ADR      r0,|L5.1512|
000294  f7fffffe          BL       snmp_trap_send
                  |L5.664|
;;;487    		if(snmp_bat_flag_puts[0]&0x0100) 
000298  f8150f46          LDRB     r0,[r5,#0x46]!
00029c  7068              STRB     r0,[r5,#1]
;;;488    			{
;;;489    			snmp_trap_send("BAT #1,speed charge is unblocked",5,8,13);
00029e  bd70              POP      {r4-r6,pc}
;;;490    			snmp_bat_flag_puts[0]&=~0x0100;
;;;491    			} 
;;;492    		}
;;;493    
;;;494    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;495    		{
;;;496    		snmp_bat_flag[0]|=0x0200;
;;;497    		if((snmp_bat_flag_puts[0]&0x0200)==0) 
;;;498    			{
;;;499    			snmp_trap_send("BAT #1,equalising charge is on",5,8,14); 
;;;500    			snmp_bat_flag_puts[0]|=0x0200;
;;;501    			}
;;;502    		}
;;;503    	else 
;;;504    		{
;;;505    		snmp_bat_flag[0]&=~0x0200;
;;;506    		if(snmp_bat_flag_puts[0]&0x0200) 
;;;507    			{
;;;508    			snmp_trap_send("BAT #1,equalising charge is off",5,8,15);
;;;509    			snmp_bat_flag_puts[0]&=~0x0200;
;;;510    			}
;;;511    		}
;;;512    
;;;513    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;514    		{
;;;515    		snmp_bat_flag[0]|=0x0400;
;;;516    		if((snmp_bat_flag_puts[0]&0x0400)==0) 
;;;517    			{
;;;518    			snmp_trap_send("BAT #1,equalising charge is blocked",5,8,16); 
;;;519    			snmp_bat_flag_puts[0]|=0x0400;
;;;520    			}
;;;521    		}
;;;522    	else 
;;;523    		{
;;;524    		snmp_bat_flag[0]&=~0x0400;
;;;525    		if(snmp_bat_flag_puts[0]&0x0400) 
;;;526    			{
;;;527    			snmp_trap_send("BAT #1,equalising charge is unblocked",5,8,17);
;;;528    			snmp_bat_flag_puts[0]&=~0x0400;
;;;529    			} 
;;;530    		}
;;;531    
;;;532    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;533    		{
;;;534    		snmp_bat_flag[0]|=0x0800;
;;;535    		if((snmp_bat_flag_puts[0]&0x0800)==0) 
;;;536    			{
;;;537    			snmp_trap_send("BAT #1,molding charge is on",5,8,18); 
;;;538    			snmp_bat_flag_puts[0]|=0x0800;
;;;539    			}
;;;540    		}
;;;541    	else 
;;;542    		{
;;;543    		snmp_bat_flag[0]&=~0x0800;
;;;544    		if(snmp_bat_flag_puts[0]&0x0800) 
;;;545    			{
;;;546    			snmp_trap_send("BAT #1,molding charge is off",5,8,19);
;;;547    			snmp_bat_flag_puts[0]&=~0x0800;
;;;548    			}
;;;549    		}
;;;550    
;;;551    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;552    		{
;;;553    		snmp_bat_flag[0]|=0x1000;
;;;554    		if((snmp_bat_flag_puts[0]&0x1000)==0) 
;;;555    			{
;;;556    			snmp_trap_send("BAT #1,molding charge is blocked",5,8,20); 
;;;557    			snmp_bat_flag_puts[0]|=0x1000;
;;;558    			}
;;;559    		}
;;;560    	else 
;;;561    		{
;;;562    		snmp_bat_flag[0]&=~0x1000;
;;;563    		if(snmp_bat_flag_puts[0]&0x1000) 
;;;564    			{
;;;565    			snmp_trap_send("BAT #1,molding charge is unblocked",5,8,21);
;;;566    			snmp_bat_flag_puts[0]&=~0x1000;
;;;567    			} 
;;;568    		}
;;;569    	}
;;;570    else 
;;;571    	{
;;;572    	snmp_bat_flag[0]=0; 
;;;573    	snmp_bat_flag_puts[0]=0;
;;;574    	}
;;;575    
;;;576    if( (snmp_bat_status[1]==0 || snmp_bat_status[1]==2) && NUMBAT==2 )	//o_10 
;;;577    	{
;;;578    	if((bat[1]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
;;;579    		{
;;;580    		snmp_bat_flag[1]|=0x0001; 
;;;581    		if((snmp_bat_flag_puts[1]&0x0001)==0) 
;;;582    			{
;;;583    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,22); 
;;;584    			snmp_bat_flag_puts[1]|=0x0001;
;;;585    			}
;;;586    		}
;;;587    	else 
;;;588    		{
;;;589    		snmp_bat_flag[1]&=~0x0001; 
;;;590    		if(snmp_bat_flag_puts[1]&0x0001) 
;;;591    			{
;;;592    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,23);
;;;593    			snmp_bat_flag_puts[1]&=~0x0001;
;;;594    			}
;;;595    		}
;;;596    
;;;597    	if(bat[1]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;598    		{
;;;599    		snmp_bat_flag[1]|=0x0002;
;;;600    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;601    			{
;;;602    			//snmp_trap_send("BAT #2 Warning, high battery temperature",5,8,24); 
;;;603    			snmp_bat_flag_puts[1]|=0x0002;
;;;604    			}
;;;605    		}
;;;606    	else 
;;;607    		{
;;;608    		snmp_bat_flag[1]&=~0x0002;
;;;609    		if(snmp_bat_flag_puts[1]&0x0002) 
;;;610    			{
;;;611    			//snmp_trap_send("BAT #2 Warning clear, battery temperature is normal",5,8,25);
;;;612    			snmp_bat_flag_puts[1]&=~0x02;
;;;613    			}
;;;614    		}
;;;615    
;;;616    	if(bat[1]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;617    		{
;;;618    		snmp_bat_flag[1]|=0x0004;
;;;619    		if((snmp_bat_flag_puts[1]&0x0004)==0) 
;;;620    			{
;;;621    			//snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,26); 
;;;622    			snmp_bat_flag_puts[1]|=0x0004;
;;;623    			}
;;;624    		}
;;;625    	else 
;;;626    		{
;;;627    		snmp_bat_flag[1]&=~0x0004;
;;;628    		if(snmp_bat_flag_puts[1]&0x0004) 
;;;629    			{
;;;630    			//snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,27);
;;;631    			snmp_bat_flag_puts[1]&=~0x0004;
;;;632    			}
;;;633    		}
;;;634    
;;;635    	if(bat[1]._Ib<(-IKB)) snmp_bat_flag[1]|=0x0008;		//Разряд батареи
;;;636    	else if(bat[1]._Ib>IKB) snmp_bat_flag[1]&=~0x0008;	//Заряд батареи
;;;637    
;;;638    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
;;;639    		{
;;;640    		snmp_bat_flag[1]|=0x0010;
;;;641    		if((snmp_bat_flag_puts[1]&0x0010)==0) 
;;;642    			{
;;;643    			snmp_trap_send("BAT #2, capacity test started",5,8,28); 
;;;644    			snmp_bat_flag_puts[1]|=0x0010;
;;;645    			}
;;;646    		}
;;;647    	else 
;;;648    		{
;;;649    		snmp_bat_flag[1]&=~0x0010;
;;;650    		if(snmp_bat_flag_puts[1]&0x0010) 
;;;651    			{
;;;652    			snmp_trap_send("BAT #2, capacity test stopped",5,8,29);
;;;653    			snmp_bat_flag_puts[1]&=~0x0010;
;;;654    			}
;;;655    		}
;;;656    		
;;;657    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
;;;658    		{
;;;659    		snmp_bat_flag[1]|=0x0020;
;;;660    		if((snmp_bat_flag_puts[1]&0x0020)==0) 
;;;661    			{
;;;662    			snmp_trap_send("BAT #2,leveling charge is started",5,8,30); 
;;;663    			snmp_bat_flag_puts[1]|=0x0020;
;;;664    			}
;;;665    		}
;;;666    	else 
;;;667    		{
;;;668    		snmp_bat_flag[1]&=~0x0020;
;;;669    		if(snmp_bat_flag_puts[1]&0x0020) 
;;;670    			{
;;;671    			snmp_trap_send("BAT #2,leveling charge is stopped",5,8,31);
;;;672    			snmp_bat_flag_puts[1]&=~0x0020;
;;;673    			}
;;;674    		}
;;;675    
;;;676    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
;;;677    		{
;;;678    		snmp_bat_flag[1]|=0x0040;
;;;679    		if((snmp_bat_flag_puts[1]&0x0040)==0) 
;;;680    			{
;;;681    			snmp_trap_send("BAT #2,leveling charge is blocked",5,8,32); 
;;;682    			snmp_bat_flag_puts[1]|=0x0040;
;;;683    			}
;;;684    		}
;;;685    	else 
;;;686    		{
;;;687    		snmp_bat_flag[1]&=~0x0040;
;;;688    		if(snmp_bat_flag_puts[1]&0x0040) 
;;;689    			{
;;;690    			snmp_trap_send("BAT #2,leveling charge is unblocked",5,8,33);
;;;691    			snmp_bat_flag_puts[1]&=~0x0040;
;;;692    			} 
;;;693    		}
;;;694    
;;;695    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
;;;696    		{
;;;697    		snmp_bat_flag[1]|=0x0080;
;;;698    		if((snmp_bat_flag_puts[1]&0x0080)==0) 
;;;699    			{
;;;700    			snmp_trap_send("BAT #2,speed charge is started",5,8,34); 
;;;701    			snmp_bat_flag_puts[1]|=0x0080;
;;;702    			}
;;;703    		}
;;;704    	else 
;;;705    		{
;;;706    		snmp_bat_flag[1]&=~0x0080;
;;;707    		if(snmp_bat_flag_puts[1]&0x0080) 
;;;708    			{
;;;709    			snmp_trap_send("BAT #2,speed charge is stopped",5,8,35);
;;;710    			snmp_bat_flag_puts[1]&=~0x0080;
;;;711    			}
;;;712    		}
;;;713    
;;;714    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
;;;715    		{
;;;716    		snmp_bat_flag[1]|=0x0100;
;;;717    		if((snmp_bat_flag_puts[1]&0x0100)==0) 
;;;718    			{
;;;719    			snmp_trap_send("BAT #2,speed charge is blocked",5,8,36); 
;;;720    			snmp_bat_flag_puts[1]|=0x0100;
;;;721    			}
;;;722    		}
;;;723    	else 
;;;724    		{
;;;725    		snmp_bat_flag[1]&=~0x0100;
;;;726    		if(snmp_bat_flag_puts[1]&0x0100) 
;;;727    			{
;;;728    			snmp_trap_send("BAT #2,speed charge is unblocked",5,8,37);
;;;729    			snmp_bat_flag_puts[1]&=~0x0100;
;;;730    			} 
;;;731    		}
;;;732    
;;;733    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;734    		{
;;;735    		snmp_bat_flag[1]|=0x0200;
;;;736    		if((snmp_bat_flag_puts[1]&0x0200)==0) 
;;;737    			{
;;;738    			snmp_trap_send("BAT #2,equalising charge is on",5,8,38); 
;;;739    			snmp_bat_flag_puts[1]|=0x0200;
;;;740    			}
;;;741    		}
;;;742    	else 
;;;743    		{
;;;744    		snmp_bat_flag[1]&=~0x0200;
;;;745    		if(snmp_bat_flag_puts[1]&0x0200) 
;;;746    			{
;;;747    			snmp_trap_send("BAT #2,equalising charge is off",5,8,39);
;;;748    			snmp_bat_flag_puts[1]&=~0x0200;
;;;749    			}
;;;750    		}
;;;751    
;;;752    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;753    		{
;;;754    		snmp_bat_flag[1]|=0x0400;
;;;755    		if((snmp_bat_flag_puts[1]&0x0400)==0) 
;;;756    			{
;;;757    			snmp_trap_send("BAT #2,equalising charge is blocked",5,8,40); 
;;;758    			snmp_bat_flag_puts[1]|=0x0400;
;;;759    			}
;;;760    		}
;;;761    	else 
;;;762    		{
;;;763    		snmp_bat_flag[1]&=~0x0400;
;;;764    		if(snmp_bat_flag_puts[1]&0x0400) 
;;;765    			{
;;;766    			snmp_trap_send("BAT #2,equalising charge is unblocked",5,8,41);
;;;767    			snmp_bat_flag_puts[1]&=~0x0400;
;;;768    			} 
;;;769    		}
;;;770    
;;;771    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;772    		{
;;;773    		snmp_bat_flag[1]|=0x0800;
;;;774    		if((snmp_bat_flag_puts[1]&0x0800)==0) 
;;;775    			{
;;;776    			snmp_trap_send("BAT #2,molding charge is on",5,8,42); 
;;;777    			snmp_bat_flag_puts[1]|=0x0800;
;;;778    			}
;;;779    		}
;;;780    	else 
;;;781    		{
;;;782    		snmp_bat_flag[1]&=~0x0800;
;;;783    		if(snmp_bat_flag_puts[1]&0x0800) 
;;;784    			{
;;;785    			snmp_trap_send("BAT #2,molding charge is off",5,8,43);
;;;786    			snmp_bat_flag_puts[1]&=~0x0800;
;;;787    			}
;;;788    		}
;;;789    
;;;790    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;791    		{
;;;792    		snmp_bat_flag[1]|=0x1000;
;;;793    		if((snmp_bat_flag_puts[1]&0x1000)==0) 
;;;794    			{
;;;795    			snmp_trap_send("BAT #2,molding charge is blocked",5,8,44); 
;;;796    			snmp_bat_flag_puts[1]|=0x1000;
;;;797    			}
;;;798    		}
;;;799    	else 
;;;800    		{
;;;801    		snmp_bat_flag[1]&=~0x1000;
;;;802    		if(snmp_bat_flag_puts[1]&0x1000) 
;;;803    			{
;;;804    			snmp_trap_send("BAT #2,molding charge is unblocked",5,8,45);
;;;805    			snmp_bat_flag_puts[1]&=~0x1000;
;;;806    			} 
;;;807    		}
;;;808    	}
;;;809    else 
;;;810    	{
;;;811    	snmp_bat_flag[1]=0; 
;;;812    	snmp_bat_flag_puts[1]=0;
;;;813    	}
;;;814    /*
;;;815    if(!snmp_bat_status[1])
;;;816    	{
;;;817    	if((bat[1]._Ub<(USIGN*10))) 
;;;818    		{
;;;819    		snmp_bat_flag[1]|=0x01; 
;;;820    		if((snmp_bat_flag_puts[1]&0x01)==0) 
;;;821    			{
;;;822    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,0); 
;;;823    			snmp_bat_flag_puts[1]|=0x01;
;;;824    			}
;;;825    		}
;;;826    	else 
;;;827    		{
;;;828    		snmp_bat_flag[1]&=~0x01; 
;;;829    		if(snmp_bat_flag_puts[1]&0x01) 
;;;830    			{
;;;831    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,1);
;;;832    			snmp_bat_flag_puts[1]&=~0x01;
;;;833    			}
;;;834    		}
;;;835    	if(bat[1]._temper_stat&0x01) 
;;;836    		{
;;;837    		snmp_bat_flag[1]|=0x02;
;;;838    		if((snmp_bat_flag_puts[1]&0x02)==0) 
;;;839    			{
;;;840    			snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,2); 
;;;841    			snmp_bat_flag_puts[1]|=0x02;
;;;842    			}
;;;843    		}
;;;844    	else 
;;;845    		{
;;;846    		snmp_bat_flag[1]&=~0x02;
;;;847    		if(snmp_bat_flag_puts[1]&0x02) 
;;;848    			{
;;;849    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,3);
;;;850    			snmp_bat_flag_puts[1]&=~0x02;
;;;851    			}
;;;852    		}
;;;853    	if(bat[1]._temper_stat&0x02) 
;;;854    		{
;;;855    		snmp_bat_flag[1]|=0x04;
;;;856    		if((snmp_bat_flag_puts[1]&0x04)==0) 
;;;857    			{
;;;858    			snmp_trap_send("BAT #2 Alarm, maximum battery temperature",5,8,4); 
;;;859    			snmp_bat_flag_puts[1]|=0x04;
;;;860    			}
;;;861    		}
;;;862    	else 
;;;863    		{
;;;864    		snmp_bat_flag[1]&=~0x04;
;;;865    		if(snmp_bat_flag_puts[1]&0x04) 
;;;866    			{
;;;867    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,5);
;;;868    			snmp_bat_flag_puts[1]&=~0x04;
;;;869    			}
;;;870    		}
;;;871    		
;;;872    	if(bat[1]._Ib<(-IKB))	snmp_bat_flag[1]|=0x80;
;;;873    	else if(bat[1]._Ib>IKB)snmp_bat_flag[1]&=~0x80;
;;;874    
;;;875    	if((spc_stat==spcKE)&&(spc_bat==1)) 
;;;876    		{
;;;877    		snmp_bat_flag[1]|=0x10;
;;;878    		if((snmp_bat_flag_puts[1]&0x10)==0) 
;;;879    			{
;;;880    			snmp_trap_send("BAT #2, capacity check enabled",5,8,6); 
;;;881    			snmp_bat_flag_puts[1]|=0x10;
;;;882    			}
;;;883    		}
;;;884    	else 
;;;885    		{
;;;886    		snmp_bat_flag[1]&=~0x10;
;;;887    		if(snmp_bat_flag_puts[1]&0x10) 
;;;888    			{
;;;889    			snmp_trap_send("BAT #2, capacity check disabled",5,8,7);
;;;890    			snmp_bat_flag_puts[1]&=~0x10;
;;;891    			}
;;;892    		}
;;;893    		
;;;894    	if(spc_stat==spcVZ) 
;;;895    		{
;;;896    		snmp_bat_flag[1]|=0x20;
;;;897    		if((snmp_bat_flag_puts[1]&0x20)==0) 
;;;898    			{
;;;899    			snmp_trap_send("BAT #2,equalizing charge is on",5,8,8); 
;;;900    			snmp_bat_flag_puts[1]|=0x20;
;;;901    			}
;;;902    		}
;;;903    	else 
;;;904    		{
;;;905    		snmp_bat_flag[1]&=~0x20;
;;;906    		if(snmp_bat_flag_puts[1]&0x20) 
;;;907    			{
;;;908    			snmp_trap_send("BAT #2,equalizing charge is off",5,8,9);
;;;909    			snmp_bat_flag_puts[1]&=~0x20;
;;;910    			}
;;;911    		}
;;;912    
;;;913    	if(vz_error) 
;;;914    		{
;;;915    		snmp_bat_flag[1]|=0x40;
;;;916    		if((snmp_bat_flag_puts[1]&0x40)==0) 
;;;917    			{
;;;918    			snmp_trap_send("BAT #2,equalizing charge blocked",5,8,10); 
;;;919    			snmp_bat_flag_puts[1]|=0x40;
;;;920    			}
;;;921    		}
;;;922    	else 
;;;923    		{
;;;924    		snmp_bat_flag[1]&=~0x40;
;;;925    		if(snmp_bat_flag_puts[1]&0x40) 
;;;926    			{
;;;927    			snmp_trap_send("BAT #2,equalizing charge is not blocked",5,8,11);
;;;928    			snmp_bat_flag_puts[1]&=~0x40;
;;;929    			} 
;;;930    		}
;;;931       }
;;;932    else 
;;;933    	{
;;;934    	snmp_bat_flag[1]=0; 
;;;935    	snmp_bat_flag_puts[1]=0;
;;;936    	} */
;;;937    }
;;;938    
                          ENDP

                  |L5.672|
                          DCD      first_inv_slot
                  |L5.676|
                          DCD      inv
                  |L5.680|
                          DCD      ||area_number.26||+0xbc
                  |L5.684|
0002ac  496e7665          DCB      "Invertor #1 Alarm, overload",0
0002b0  72746f72
0002b4  20233120
0002b8  416c6172
0002bc  6d2c206f
0002c0  7665726c
0002c4  6f616400
                  |L5.712|
0002c8  496e7665          DCB      "Invertor #2 Alarm, overload",0
0002cc  72746f72
0002d0  20233220
0002d4  416c6172
0002d8  6d2c206f
0002dc  7665726c
0002e0  6f616400
                  |L5.740|
0002e4  496e7665          DCB      "Invertor #3 Alarm, overload",0
0002e8  72746f72
0002ec  20233320
0002f0  416c6172
0002f4  6d2c206f
0002f8  7665726c
0002fc  6f616400
                  |L5.768|
000300  496e7665          DCB      "Invertor #4 Alarm, overload",0
000304  72746f72
000308  20233420
00030c  416c6172
000310  6d2c206f
000314  7665726c
000318  6f616400
                  |L5.796|
00031c  496e7665          DCB      "Invertor #1 Alarm, overheat",0
000320  72746f72
000324  20233120
000328  416c6172
00032c  6d2c206f
000330  76657268
000334  65617400
                  |L5.824|
000338  496e7665          DCB      "Invertor #2 Alarm, overheat",0
00033c  72746f72
000340  20233220
000344  416c6172
000348  6d2c206f
00034c  76657268
000350  65617400
                  |L5.852|
000354  496e7665          DCB      "Invertor #3 Alarm, overheat",0
000358  72746f72
00035c  20233320
000360  416c6172
000364  6d2c206f
000368  76657268
00036c  65617400
                  |L5.880|
000370  496e7665          DCB      "Invertor #4 Alarm, overheat",0
000374  72746f72
000378  20233420
00037c  416c6172
000380  6d2c206f
000384  76657268
000388  65617400
                  |L5.908|
00038c  496e7665          DCB      "Invertor #1 Alarm, is warm",0
000390  72746f72
000394  20233120
000398  416c6172
00039c  6d2c2069
0003a0  73207761
0003a4  726d00  
0003a7  00                DCB      0
                  |L5.936|
0003a8  496e7665          DCB      "Invertor #2 Alarm, is warm",0
0003ac  72746f72
0003b0  20233220
0003b4  416c6172
0003b8  6d2c2069
0003bc  73207761
0003c0  726d00  
0003c3  00                DCB      0
                  |L5.964|
0003c4  496e7665          DCB      "Invertor #3 Alarm, is warm",0
0003c8  72746f72
0003cc  20233320
0003d0  416c6172
0003d4  6d2c2069
0003d8  73207761
0003dc  726d00  
0003df  00                DCB      0
                  |L5.992|
0003e0  496e7665          DCB      "Invertor #4 Alarm, is warm",0
0003e4  72746f72
0003e8  20233420
0003ec  416c6172
0003f0  6d2c2069
0003f4  73207761
0003f8  726d00  
0003fb  00                DCB      0
                  |L5.1020|
0003fc  496e7665          DCB      "Invertor #1 Alarm, voltage is up",0
000400  72746f72
000404  20233120
000408  416c6172
00040c  6d2c2076
000410  6f6c7461
000414  67652069
000418  73207570
00041c  00      
00041d  00                DCB      0
00041e  00                DCB      0
00041f  00                DCB      0
                  |L5.1056|
000420  496e7665          DCB      "Invertor #2 Alarm, voltage is up",0
000424  72746f72
000428  20233220
00042c  416c6172
000430  6d2c2076
000434  6f6c7461
000438  67652069
00043c  73207570
000440  00      
000441  00                DCB      0
000442  00                DCB      0
000443  00                DCB      0
                  |L5.1092|
000444  496e7665          DCB      "Invertor #3 Alarm, voltage is up",0
000448  72746f72
00044c  20233320
000450  416c6172
000454  6d2c2076
000458  6f6c7461
00045c  67652069
000460  73207570
000464  00      
000465  00                DCB      0
000466  00                DCB      0
000467  00                DCB      0
                  |L5.1128|
000468  496e7665          DCB      "Invertor #4 Alarm, voltage is up",0
00046c  72746f72
000470  20233420
000474  416c6172
000478  6d2c2076
00047c  6f6c7461
000480  67652069
000484  73207570
000488  00      
000489  00                DCB      0
00048a  00                DCB      0
00048b  00                DCB      0
                  |L5.1164|
00048c  496e7665          DCB      "Invertor #1 Alarm, voltage is down",0
000490  72746f72
000494  20233120
000498  416c6172
00049c  6d2c2076
0004a0  6f6c7461
0004a4  67652069
0004a8  7320646f
0004ac  776e00  
0004af  00                DCB      0
                  |L5.1200|
0004b0  496e7665          DCB      "Invertor #2 Alarm, voltage is down",0
0004b4  72746f72
0004b8  20233220
0004bc  416c6172
0004c0  6d2c2076
0004c4  6f6c7461
0004c8  67652069
0004cc  7320646f
0004d0  776e00  
0004d3  00                DCB      0
                  |L5.1236|
0004d4  496e7665          DCB      "Invertor #3 Alarm, voltage is down",0
0004d8  72746f72
0004dc  20233320
0004e0  416c6172
0004e4  6d2c2076
0004e8  6f6c7461
0004ec  67652069
0004f0  7320646f
0004f4  776e00  
0004f7  00                DCB      0
                  |L5.1272|
0004f8  496e7665          DCB      "Invertor #4 Alarm, voltage is down",0
0004fc  72746f72
000500  20233420
000504  416c6172
000508  6d2c2076
00050c  6f6c7461
000510  67652069
000514  7320646f
000518  776e00  
00051b  00                DCB      0
                  |L5.1308|
00051c  496e7665          DCB      "Invertor #1 Alarm, output is offed",0
000520  72746f72
000524  20233120
000528  416c6172
00052c  6d2c206f
000530  75747075
000534  74206973
000538  206f6666
00053c  656400  
00053f  00                DCB      0
                  |L5.1344|
000540  496e7665          DCB      "Invertor #2 Alarm, output is offed",0
000544  72746f72
000548  20233220
00054c  416c6172
000550  6d2c206f
000554  75747075
000558  74206973
00055c  206f6666
000560  656400  
000563  00                DCB      0
                  |L5.1380|
000564  496e7665          DCB      "Invertor #3 Alarm, output is offed",0
000568  72746f72
00056c  20233320
000570  416c6172
000574  6d2c206f
000578  75747075
00057c  74206973
000580  206f6666
000584  656400  
000587  00                DCB      0
                  |L5.1416|
000588  496e7665          DCB      "Invertor #4 Alarm, output is offed",0
00058c  72746f72
000590  20233420
000594  416c6172
000598  6d2c206f
00059c  75747075
0005a0  74206973
0005a4  206f6666
0005a8  656400  
0005ab  00                DCB      0
                  |L5.1452|
0005ac  496e7665          DCB      "Invertor #1 is norm",0
0005b0  72746f72
0005b4  20233120
0005b8  6973206e
0005bc  6f726d00
                  |L5.1472|
0005c0  496e7665          DCB      "Invertor #2 is norm",0
0005c4  72746f72
0005c8  20233220
0005cc  6973206e
0005d0  6f726d00
                  |L5.1492|
0005d4  496e7665          DCB      "Invertor #3 is norm",0
0005d8  72746f72
0005dc  20233320
0005e0  6973206e
0005e4  6f726d00
                  |L5.1512|
0005e8  496e7665          DCB      "Invertor #4 is norm",0
0005ec  72746f72
0005f0  20233420
0005f4  6973206e
0005f8  6f726d00

                          AREA ||area_number.6||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.6||, ||.text||
                  klimat_hndl PROC
;;;326    // заполнение флагов для АКБ
;;;327    void bat_flag (void)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;328    {  
;;;329    if(spc_stat!=spcVZ) 
000004  4d66              LDR      r5,|L6.416|
;;;330    	{
;;;331    	vz_error=0;
000006  4867              LDR      r0,|L6.420|
000008  4c67              LDR      r4,|L6.424|
00000a  f9b51000          LDRSH    r1,[r5,#0]            ;329  ; t_box
00000e  f9b02000          LDRSH    r2,[r0,#0]            ;329  ; TBOXMAX
;;;332    	sp_ch_error=0;
000012  f9b40000          LDRSH    r0,[r4,#0]
;;;333    	vz1_error=0;
;;;334    	vz2_error=0;
000016  4291              CMP      r1,r2
;;;335    	}
;;;336    
;;;337    if( (snmp_bat_status[0]==0 || snmp_bat_status[0]==2) && NUMBAT>0) 	//o_10 	 			//Батарея №1
000018  dd03              BLE      |L6.34|
00001a  f1000001          ADD      r0,r0,#1
00001e  8020              STRH     r0,[r4,#0]
;;;338    	{
;;;339    	if((bat[0]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
000020  e003              B        |L6.42|
                  |L6.34|
000022  da02              BGE      |L6.42|
000024  f1a00001          SUB      r0,r0,#1              ;337
;;;340    		{
;;;341    		snmp_bat_flag[0]|=0x0001; 
;;;342    		if((snmp_bat_flag_puts[0]&0x0001)==0) 
;;;343    			{
;;;344    			snmp_trap_send("BAT #1 Alarm, battery is low",5,8,0); 
;;;345    			snmp_bat_flag_puts[0]|=0x0001;
;;;346    			}
;;;347    		}
;;;348    	else 
;;;349    		{
;;;350    		snmp_bat_flag[0]&=~0x0001; 
;;;351    		if(snmp_bat_flag_puts[0]&0x0001) 
;;;352    			{
;;;353    			snmp_trap_send("BAT #1 Alarm clear, battery is not low",5,8,1);
;;;354    			snmp_bat_flag_puts[0]&=~0x0001;
;;;355    			}
;;;356    		}
;;;357    
;;;358    	if(bat[0]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;359    		{
;;;360    		snmp_bat_flag[0]|=0x0002;
;;;361    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;362    			{
;;;363    			//snmp_trap_send("BAT #1 Warning, high battery temperature",5,8,2); 
;;;364    			snmp_bat_flag_puts[0]|=0x0002;
;;;365    			}
;;;366    		}
;;;367    	else 
;;;368    		{
;;;369    		snmp_bat_flag[0]&=~0x0002;
;;;370    		if(snmp_bat_flag_puts[0]&0x0002) 
;;;371    			{
;;;372    			//snmp_trap_send("BAT #1 Warning clear, battery temperature is normal",5,8,3);
;;;373    			snmp_bat_flag_puts[0]&=~0x02;
;;;374    			}
;;;375    		}
;;;376    
;;;377    	if(bat[0]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;378    		{
;;;379    		snmp_bat_flag[0]|=0x0004;
;;;380    		if((snmp_bat_flag_puts[0]&0x0004)==0) 
;;;381    			{
;;;382    			//snmp_trap_send("BAT #1 Alarm, high battery temperature",5,8,4); 
;;;383    			snmp_bat_flag_puts[0]|=0x0004;
;;;384    			}
;;;385    		}
;;;386    	else 
;;;387    		{
;;;388    		snmp_bat_flag[0]&=~0x0004;
;;;389    		if(snmp_bat_flag_puts[0]&0x0004) 
;;;390    			{
;;;391    			//snmp_trap_send("BAT #1 Alarm clear, battery temperature is normal",5,8,5);
;;;392    			snmp_bat_flag_puts[0]&=~0x0004;
;;;393    			}
;;;394    		}
;;;395    
;;;396    	if(bat[0]._Ib<(-IKB)) snmp_bat_flag[0]|=0x0008;		//Разряд батареи
000028  8020              STRH     r0,[r4,#0]
                  |L6.42|
00002a  2206              MOVS     r2,#6
00002c  2100              MOVS     r1,#0                 ;341
00002e  485e              LDR      r0,|L6.424|
000030  f7fffffe          BL       gran
000034  f9b40000          LDRSH    r0,[r4,#0]            ;337  ; av_tbox_cnt
000038  495c              LDR      r1,|L6.428|
00003a  2601              MOVS     r6,#1                 ;337
00003c  2805              CMP      r0,#5                 ;337
00003e  dd00              BLE      |L6.66|
000040  700e              STRB     r6,[r1,#0]            ;339
                  |L6.66|
000042  2400              MOVS     r4,#0                 ;339
000044  2801              CMP      r0,#1                 ;339
000046  da00              BGE      |L6.74|
000048  700c              STRB     r4,[r1,#0]            ;339
                  |L6.74|
00004a  4959              LDR      r1,|L6.432|
00004c  f9b50000          LDRSH    r0,[r5,#0]            ;341  ; t_box
000050  4a58              LDR      r2,|L6.436|
000052  f9b11000          LDRSH    r1,[r1,#0]            ;341  ; TBOXREG
000056  4f58              LDR      r7,|L6.440|
000058  1e8b              SUBS     r3,r1,#2              ;342
00005a  4298              CMP      r0,r3                 ;342
00005c  da0f              BGE      |L6.126|
00005e  f9921000          LDRSB    r1,[r2,#0]            ;341  ; t_box_cnt
000062  291e              CMP      r1,#0x1e              ;341
000064  da1e              BGE      |L6.164|
000066  f1010101          ADD      r1,r1,#1              ;342
00006a  b249              SXTB     r1,r1                 ;344
00006c  7011              STRB     r1,[r2,#0]            ;344
00006e  291e              CMP      r1,#0x1e              ;344
000070  db18              BLT      |L6.164|
000072  8839              LDRH     r1,[r7,#0]            ;344  ; main_vent_pos
000074  f1a10101          SUB      r1,r1,#1              ;345
000078  8039              STRH     r1,[r7,#0]            ;345
00007a  7014              STRB     r4,[r2,#0]            ;345
00007c  e012              B        |L6.164|
                  |L6.126|
00007e  4288              CMP      r0,r1                 ;350
000080  dd0f              BLE      |L6.162|
000082  f9921000          LDRSB    r1,[r2,#0]            ;350  ; t_box_cnt
000086  291e              CMP      r1,#0x1e              ;351
000088  da0c              BGE      |L6.164|
00008a  f1010101          ADD      r1,r1,#1              ;353
00008e  b249              SXTB     r1,r1                 ;353
000090  7011              STRB     r1,[r2,#0]            ;353
000092  291e              CMP      r1,#0x1e              ;353
000094  db06              BLT      |L6.164|
000096  8839              LDRH     r1,[r7,#0]            ;354  ; main_vent_pos
000098  f1010101          ADD      r1,r1,#1              ;354
00009c  8039              STRH     r1,[r7,#0]            ;358
00009e  7014              STRB     r4,[r2,#0]            ;358
0000a0  e000              B        |L6.164|
                  |L6.162|
0000a2  7014              STRB     r4,[r2,#0]            ;358
                  |L6.164|
0000a4  4945              LDR      r1,|L6.444|
0000a6  f9b11000          LDRSH    r1,[r1,#0]            ;360  ; TBOXVENTMAX
0000aa  4288              CMP      r0,r1                 ;360
0000ac  dd05              BLE      |L6.186|
0000ae  2214              MOVS     r2,#0x14              ;361
0000b0  2100              MOVS     r1,#0                 ;361
0000b2  4841              LDR      r0,|L6.440|
0000b4  f7fffffe          BL       gran
0000b8  e007              B        |L6.202|
                  |L6.186|
0000ba  4841              LDR      r0,|L6.448|
0000bc  2100              MOVS     r1,#0                 ;369
0000be  8800              LDRH     r0,[r0,#0]            ;369  ; pos_vent
0000c0  3009              ADDS     r0,r0,#9              ;369
0000c2  b202              SXTH     r2,r0                 ;369
0000c4  483c              LDR      r0,|L6.440|
0000c6  f7fffffe          BL       gran
                  |L6.202|
0000ca  20f0              MOVS     r0,#0xf0              ;370
0000cc  f7fffffe          BL       mess_find_unvol
0000d0  b128              CBZ      r0,|L6.222|
0000d2  483c              LDR      r0,|L6.452|
0000d4  6801              LDR      r1,[r0,#0]            ;377  ; mess_data
0000d6  29f1              CMP      r1,#0xf1              ;379
0000d8  d101              BNE      |L6.222|
0000da  6840              LDR      r0,[r0,#4]            ;379  ; mess_data
0000dc  8038              STRH     r0,[r7,#0]            ;379
                  |L6.222|
0000de  f9b71000          LDRSH    r1,[r7,#0]            ;380  ; main_vent_pos
0000e2  4839              LDR      r0,|L6.456|
0000e4  2901              CMP      r1,#1                 ;380
0000e6  dc01              BGT      |L6.236|
0000e8  7006              STRB     r6,[r0,#0]            ;383
0000ea  e000              B        |L6.238|
                  |L6.236|
0000ec  7004              STRB     r4,[r0,#0]            ;383
                  |L6.238|
0000ee  4837              LDR      r0,|L6.460|
0000f0  f8df80dc          LDR      r8,|L6.464|
0000f4  f9b00000          LDRSH    r0,[r0,#0]            ;388  ; TBATDISABLE
0000f8  f1a00132          SUB      r1,r0,#0x32           ;389
0000fc  2928              CMP      r1,#0x28              ;389
0000fe  d821              BHI      |L6.324|
000100  f9b51000          LDRSH    r1,[r5,#0]            ;392  ; t_box
000104  4f33              LDR      r7,|L6.468|
000106  4281              CMP      r1,r0
000108  dd03              BLE      |L6.274|
00010a  8838              LDRH     r0,[r7,#0]  ; tbatdisable_cnt
00010c  f1000001          ADD      r0,r0,#1
000110  8038              STRH     r0,[r7,#0]
                  |L6.274|
000112  4831              LDR      r0,|L6.472|
000114  f9b00000          LDRSH    r0,[r0,#0]  ; TBATENABLE
000118  4281              CMP      r1,r0
00011a  da03              BGE      |L6.292|
00011c  8838              LDRH     r0,[r7,#0]  ; tbatdisable_cnt
;;;397    	else if(bat[0]._Ib>IKB) snmp_bat_flag[0]&=~0x0008;	//Заряд батареи
00011e  f1a00001          SUB      r0,r0,#1
000122  8038              STRH     r0,[r7,#0]
                  |L6.292|
000124  2206              MOVS     r2,#6
000126  2100              MOVS     r1,#0
000128  482a              LDR      r0,|L6.468|
;;;398    
;;;399    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
00012a  f7fffffe          BL       gran
00012e  f9b70000          LDRSH    r0,[r7,#0]  ; tbatdisable_cnt
000132  2805              CMP      r0,#5
000134  dd01              BLE      |L6.314|
000136  f8886000          STRB     r6,[r8,#0]
                  |L6.314|
;;;400    		{
;;;401    		snmp_bat_flag[0]|=0x0010;
;;;402    		if((snmp_bat_flag_puts[0]&0x0010)==0) 
;;;403    			{
;;;404    			snmp_trap_send("BAT #1, capacity test started",5,8,6); 
;;;405    			snmp_bat_flag_puts[0]|=0x0010;
;;;406    			}
;;;407    		}
;;;408    	else 
;;;409    		{
;;;410    		snmp_bat_flag[0]&=~0x0010;
00013a  2801              CMP      r0,#1
00013c  da04              BGE      |L6.328|
00013e  f8884000          STRB     r4,[r8,#0]
;;;411    		if(snmp_bat_flag_puts[0]&0x0010) 
000142  e001              B        |L6.328|
                  |L6.324|
000144  f8884000          STRB     r4,[r8,#0]
                  |L6.328|
;;;412    			{
;;;413    			snmp_trap_send("BAT #1, capacity test stopped",5,8,7);
000148  4824              LDR      r0,|L6.476|
00014a  4f25              LDR      r7,|L6.480|
00014c  f9b00000          LDRSH    r0,[r0,#0]  ; TLOADDISABLE
000150  f1a00132          SUB      r1,r0,#0x32
;;;414    			snmp_bat_flag_puts[0]&=~0x0010;
000154  291e              CMP      r1,#0x1e
000156  d820              BHI      |L6.410|
000158  f9b51000          LDRSH    r1,[r5,#0]  ; t_box
;;;415    			}
;;;416    		}
;;;417    		
;;;418    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
00015c  4d21              LDR      r5,|L6.484|
00015e  4281              CMP      r1,r0
000160  dd03              BLE      |L6.362|
000162  8828              LDRH     r0,[r5,#0]  ; tloaddisable_cnt
;;;419    		{
;;;420    		snmp_bat_flag[0]|=0x0020;
;;;421    		if((snmp_bat_flag_puts[0]&0x0020)==0) 
;;;422    			{
;;;423    			snmp_trap_send("BAT #1,leveling charge is started",5,8,8); 
;;;424    			snmp_bat_flag_puts[0]|=0x0020;
;;;425    			}
;;;426    		}
;;;427    	else 
;;;428    		{
;;;429    		snmp_bat_flag[0]&=~0x0020;
000164  f1000001          ADD      r0,r0,#1
000168  8028              STRH     r0,[r5,#0]
                  |L6.362|
00016a  481f              LDR      r0,|L6.488|
;;;430    		if(snmp_bat_flag_puts[0]&0x0020) 
00016c  f9b00000          LDRSH    r0,[r0,#0]  ; TLOADENABLE
000170  4281              CMP      r1,r0
;;;431    			{
;;;432    			snmp_trap_send("BAT #1,leveling charge is stopped",5,8,9);
000172  da03              BGE      |L6.380|
000174  8828              LDRH     r0,[r5,#0]  ; tloaddisable_cnt
000176  f1a00001          SUB      r0,r0,#1
00017a  8028              STRH     r0,[r5,#0]
                  |L6.380|
00017c  2206              MOVS     r2,#6
;;;433    			snmp_bat_flag_puts[0]&=~0x0020;
00017e  2100              MOVS     r1,#0
000180  4818              LDR      r0,|L6.484|
000182  f7fffffe          BL       gran
;;;434    			}
;;;435    		}
;;;436    
;;;437    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
000186  f9b50000          LDRSH    r0,[r5,#0]  ; tloaddisable_cnt
00018a  2805              CMP      r0,#5
;;;438    		{
;;;439    		snmp_bat_flag[0]|=0x0040;
00018c  dd00              BLE      |L6.400|
00018e  703e              STRB     r6,[r7,#0]
                  |L6.400|
000190  2801              CMP      r0,#1
000192  da00              BGE      |L6.406|
;;;440    		if((snmp_bat_flag_puts[0]&0x0040)==0) 
000194  703c              STRB     r4,[r7,#0]
                  |L6.406|
000196  e8bd81f0          POP      {r4-r8,pc}
                  |L6.410|
;;;441    			{
;;;442    			snmp_trap_send("BAT #1,leveling charge is blocked",5,8,10); 
00019a  703c              STRB     r4,[r7,#0]
00019c  e7fb              B        |L6.406|
;;;443    			snmp_bat_flag_puts[0]|=0x0040;
;;;444    			}
;;;445    		}
;;;446    	else 
;;;447    		{
;;;448    		snmp_bat_flag[0]&=~0x0040;
;;;449    		if(snmp_bat_flag_puts[0]&0x0040) 
;;;450    			{
;;;451    			snmp_trap_send("BAT #1,leveling charge is unblocked",5,8,11);
;;;452    			snmp_bat_flag_puts[0]&=~0x0040;
;;;453    			} 
;;;454    		}
;;;455    
;;;456    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
;;;457    		{
;;;458    		snmp_bat_flag[0]|=0x0080;
;;;459    		if((snmp_bat_flag_puts[0]&0x0080)==0) 
;;;460    			{
;;;461    			snmp_trap_send("BAT #1,speed charge is started",5,8,10); 
;;;462    			snmp_bat_flag_puts[0]|=0x0080;
;;;463    			}
;;;464    		}
;;;465    	else 
;;;466    		{
;;;467    		snmp_bat_flag[0]&=~0x0080;
;;;468    		if(snmp_bat_flag_puts[0]&0x0080) 
;;;469    			{
;;;470    			snmp_trap_send("BAT #1,speed charge is stopped",5,8,11);
;;;471    			snmp_bat_flag_puts[0]&=~0x0080;
;;;472    			}
;;;473    		}
;;;474    
;;;475    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
;;;476    		{
;;;477    		snmp_bat_flag[0]|=0x0100;
;;;478    		if((snmp_bat_flag_puts[0]&0x0100)==0) 
;;;479    			{
;;;480    			snmp_trap_send("BAT #1,speed charge is blocked",5,8,12); 
;;;481    			snmp_bat_flag_puts[0]|=0x0100;
;;;482    			}
;;;483    		}
;;;484    	else 
;;;485    		{
;;;486    		snmp_bat_flag[0]&=~0x0100;
;;;487    		if(snmp_bat_flag_puts[0]&0x0100) 
;;;488    			{
;;;489    			snmp_trap_send("BAT #1,speed charge is unblocked",5,8,13);
;;;490    			snmp_bat_flag_puts[0]&=~0x0100;
;;;491    			} 
;;;492    		}
;;;493    
;;;494    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;495    		{
;;;496    		snmp_bat_flag[0]|=0x0200;
;;;497    		if((snmp_bat_flag_puts[0]&0x0200)==0) 
;;;498    			{
;;;499    			snmp_trap_send("BAT #1,equalising charge is on",5,8,14); 
;;;500    			snmp_bat_flag_puts[0]|=0x0200;
;;;501    			}
;;;502    		}
;;;503    	else 
;;;504    		{
;;;505    		snmp_bat_flag[0]&=~0x0200;
;;;506    		if(snmp_bat_flag_puts[0]&0x0200) 
;;;507    			{
;;;508    			snmp_trap_send("BAT #1,equalising charge is off",5,8,15);
;;;509    			snmp_bat_flag_puts[0]&=~0x0200;
;;;510    			}
;;;511    		}
;;;512    
;;;513    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;514    		{
;;;515    		snmp_bat_flag[0]|=0x0400;
;;;516    		if((snmp_bat_flag_puts[0]&0x0400)==0) 
;;;517    			{
;;;518    			snmp_trap_send("BAT #1,equalising charge is blocked",5,8,16); 
;;;519    			snmp_bat_flag_puts[0]|=0x0400;
;;;520    			}
;;;521    		}
;;;522    	else 
;;;523    		{
;;;524    		snmp_bat_flag[0]&=~0x0400;
;;;525    		if(snmp_bat_flag_puts[0]&0x0400) 
;;;526    			{
;;;527    			snmp_trap_send("BAT #1,equalising charge is unblocked",5,8,17);
;;;528    			snmp_bat_flag_puts[0]&=~0x0400;
;;;529    			} 
;;;530    		}
;;;531    
;;;532    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;533    		{
;;;534    		snmp_bat_flag[0]|=0x0800;
;;;535    		if((snmp_bat_flag_puts[0]&0x0800)==0) 
;;;536    			{
;;;537    			snmp_trap_send("BAT #1,molding charge is on",5,8,18); 
;;;538    			snmp_bat_flag_puts[0]|=0x0800;
;;;539    			}
;;;540    		}
;;;541    	else 
;;;542    		{
;;;543    		snmp_bat_flag[0]&=~0x0800;
;;;544    		if(snmp_bat_flag_puts[0]&0x0800) 
;;;545    			{
;;;546    			snmp_trap_send("BAT #1,molding charge is off",5,8,19);
;;;547    			snmp_bat_flag_puts[0]&=~0x0800;
;;;548    			}
;;;549    		}
;;;550    
;;;551    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;552    		{
;;;553    		snmp_bat_flag[0]|=0x1000;
;;;554    		if((snmp_bat_flag_puts[0]&0x1000)==0) 
;;;555    			{
;;;556    			snmp_trap_send("BAT #1,molding charge is blocked",5,8,20); 
;;;557    			snmp_bat_flag_puts[0]|=0x1000;
;;;558    			}
;;;559    		}
;;;560    	else 
;;;561    		{
;;;562    		snmp_bat_flag[0]&=~0x1000;
;;;563    		if(snmp_bat_flag_puts[0]&0x1000) 
;;;564    			{
;;;565    			snmp_trap_send("BAT #1,molding charge is unblocked",5,8,21);
;;;566    			snmp_bat_flag_puts[0]&=~0x1000;
;;;567    			} 
;;;568    		}
;;;569    	}
;;;570    else 
;;;571    	{
;;;572    	snmp_bat_flag[0]=0; 
;;;573    	snmp_bat_flag_puts[0]=0;
;;;574    	}
;;;575    
;;;576    if( (snmp_bat_status[1]==0 || snmp_bat_status[1]==2) && NUMBAT==2 )	//o_10 
;;;577    	{
;;;578    	if((bat[1]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
;;;579    		{
;;;580    		snmp_bat_flag[1]|=0x0001; 
;;;581    		if((snmp_bat_flag_puts[1]&0x0001)==0) 
;;;582    			{
;;;583    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,22); 
;;;584    			snmp_bat_flag_puts[1]|=0x0001;
;;;585    			}
;;;586    		}
;;;587    	else 
;;;588    		{
;;;589    		snmp_bat_flag[1]&=~0x0001; 
;;;590    		if(snmp_bat_flag_puts[1]&0x0001) 
;;;591    			{
;;;592    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,23);
;;;593    			snmp_bat_flag_puts[1]&=~0x0001;
;;;594    			}
;;;595    		}
;;;596    
;;;597    	if(bat[1]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;598    		{
;;;599    		snmp_bat_flag[1]|=0x0002;
;;;600    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;601    			{
;;;602    			//snmp_trap_send("BAT #2 Warning, high battery temperature",5,8,24); 
;;;603    			snmp_bat_flag_puts[1]|=0x0002;
;;;604    			}
;;;605    		}
;;;606    	else 
;;;607    		{
;;;608    		snmp_bat_flag[1]&=~0x0002;
;;;609    		if(snmp_bat_flag_puts[1]&0x0002) 
;;;610    			{
;;;611    			//snmp_trap_send("BAT #2 Warning clear, battery temperature is normal",5,8,25);
;;;612    			snmp_bat_flag_puts[1]&=~0x02;
;;;613    			}
;;;614    		}
;;;615    
;;;616    	if(bat[1]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;617    		{
;;;618    		snmp_bat_flag[1]|=0x0004;
;;;619    		if((snmp_bat_flag_puts[1]&0x0004)==0) 
;;;620    			{
;;;621    			//snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,26); 
;;;622    			snmp_bat_flag_puts[1]|=0x0004;
;;;623    			}
;;;624    		}
;;;625    	else 
;;;626    		{
;;;627    		snmp_bat_flag[1]&=~0x0004;
;;;628    		if(snmp_bat_flag_puts[1]&0x0004) 
;;;629    			{
;;;630    			//snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,27);
;;;631    			snmp_bat_flag_puts[1]&=~0x0004;
;;;632    			}
;;;633    		}
;;;634    
;;;635    	if(bat[1]._Ib<(-IKB)) snmp_bat_flag[1]|=0x0008;		//Разряд батареи
;;;636    	else if(bat[1]._Ib>IKB) snmp_bat_flag[1]&=~0x0008;	//Заряд батареи
;;;637    
;;;638    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
;;;639    		{
;;;640    		snmp_bat_flag[1]|=0x0010;
;;;641    		if((snmp_bat_flag_puts[1]&0x0010)==0) 
;;;642    			{
;;;643    			snmp_trap_send("BAT #2, capacity test started",5,8,28); 
;;;644    			snmp_bat_flag_puts[1]|=0x0010;
;;;645    			}
;;;646    		}
;;;647    	else 
;;;648    		{
;;;649    		snmp_bat_flag[1]&=~0x0010;
;;;650    		if(snmp_bat_flag_puts[1]&0x0010) 
;;;651    			{
;;;652    			snmp_trap_send("BAT #2, capacity test stopped",5,8,29);
;;;653    			snmp_bat_flag_puts[1]&=~0x0010;
;;;654    			}
;;;655    		}
;;;656    		
;;;657    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
;;;658    		{
;;;659    		snmp_bat_flag[1]|=0x0020;
;;;660    		if((snmp_bat_flag_puts[1]&0x0020)==0) 
;;;661    			{
;;;662    			snmp_trap_send("BAT #2,leveling charge is started",5,8,30); 
;;;663    			snmp_bat_flag_puts[1]|=0x0020;
;;;664    			}
;;;665    		}
;;;666    	else 
;;;667    		{
;;;668    		snmp_bat_flag[1]&=~0x0020;
;;;669    		if(snmp_bat_flag_puts[1]&0x0020) 
;;;670    			{
;;;671    			snmp_trap_send("BAT #2,leveling charge is stopped",5,8,31);
;;;672    			snmp_bat_flag_puts[1]&=~0x0020;
;;;673    			}
;;;674    		}
;;;675    
;;;676    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
;;;677    		{
;;;678    		snmp_bat_flag[1]|=0x0040;
;;;679    		if((snmp_bat_flag_puts[1]&0x0040)==0) 
;;;680    			{
;;;681    			snmp_trap_send("BAT #2,leveling charge is blocked",5,8,32); 
;;;682    			snmp_bat_flag_puts[1]|=0x0040;
;;;683    			}
;;;684    		}
;;;685    	else 
;;;686    		{
;;;687    		snmp_bat_flag[1]&=~0x0040;
;;;688    		if(snmp_bat_flag_puts[1]&0x0040) 
;;;689    			{
;;;690    			snmp_trap_send("BAT #2,leveling charge is unblocked",5,8,33);
;;;691    			snmp_bat_flag_puts[1]&=~0x0040;
;;;692    			} 
;;;693    		}
;;;694    
;;;695    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
;;;696    		{
;;;697    		snmp_bat_flag[1]|=0x0080;
;;;698    		if((snmp_bat_flag_puts[1]&0x0080)==0) 
;;;699    			{
;;;700    			snmp_trap_send("BAT #2,speed charge is started",5,8,34); 
;;;701    			snmp_bat_flag_puts[1]|=0x0080;
;;;702    			}
;;;703    		}
;;;704    	else 
;;;705    		{
;;;706    		snmp_bat_flag[1]&=~0x0080;
;;;707    		if(snmp_bat_flag_puts[1]&0x0080) 
;;;708    			{
;;;709    			snmp_trap_send("BAT #2,speed charge is stopped",5,8,35);
;;;710    			snmp_bat_flag_puts[1]&=~0x0080;
;;;711    			}
;;;712    		}
;;;713    
;;;714    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
;;;715    		{
;;;716    		snmp_bat_flag[1]|=0x0100;
;;;717    		if((snmp_bat_flag_puts[1]&0x0100)==0) 
;;;718    			{
;;;719    			snmp_trap_send("BAT #2,speed charge is blocked",5,8,36); 
;;;720    			snmp_bat_flag_puts[1]|=0x0100;
;;;721    			}
;;;722    		}
;;;723    	else 
;;;724    		{
;;;725    		snmp_bat_flag[1]&=~0x0100;
;;;726    		if(snmp_bat_flag_puts[1]&0x0100) 
;;;727    			{
;;;728    			snmp_trap_send("BAT #2,speed charge is unblocked",5,8,37);
;;;729    			snmp_bat_flag_puts[1]&=~0x0100;
;;;730    			} 
;;;731    		}
;;;732    
;;;733    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;734    		{
;;;735    		snmp_bat_flag[1]|=0x0200;
;;;736    		if((snmp_bat_flag_puts[1]&0x0200)==0) 
;;;737    			{
;;;738    			snmp_trap_send("BAT #2,equalising charge is on",5,8,38); 
;;;739    			snmp_bat_flag_puts[1]|=0x0200;
;;;740    			}
;;;741    		}
;;;742    	else 
;;;743    		{
;;;744    		snmp_bat_flag[1]&=~0x0200;
;;;745    		if(snmp_bat_flag_puts[1]&0x0200) 
;;;746    			{
;;;747    			snmp_trap_send("BAT #2,equalising charge is off",5,8,39);
;;;748    			snmp_bat_flag_puts[1]&=~0x0200;
;;;749    			}
;;;750    		}
;;;751    
;;;752    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;753    		{
;;;754    		snmp_bat_flag[1]|=0x0400;
;;;755    		if((snmp_bat_flag_puts[1]&0x0400)==0) 
;;;756    			{
;;;757    			snmp_trap_send("BAT #2,equalising charge is blocked",5,8,40); 
;;;758    			snmp_bat_flag_puts[1]|=0x0400;
;;;759    			}
;;;760    		}
;;;761    	else 
;;;762    		{
;;;763    		snmp_bat_flag[1]&=~0x0400;
;;;764    		if(snmp_bat_flag_puts[1]&0x0400) 
;;;765    			{
;;;766    			snmp_trap_send("BAT #2,equalising charge is unblocked",5,8,41);
;;;767    			snmp_bat_flag_puts[1]&=~0x0400;
;;;768    			} 
;;;769    		}
;;;770    
;;;771    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;772    		{
;;;773    		snmp_bat_flag[1]|=0x0800;
;;;774    		if((snmp_bat_flag_puts[1]&0x0800)==0) 
;;;775    			{
;;;776    			snmp_trap_send("BAT #2,molding charge is on",5,8,42); 
;;;777    			snmp_bat_flag_puts[1]|=0x0800;
;;;778    			}
;;;779    		}
;;;780    	else 
;;;781    		{
;;;782    		snmp_bat_flag[1]&=~0x0800;
;;;783    		if(snmp_bat_flag_puts[1]&0x0800) 
;;;784    			{
;;;785    			snmp_trap_send("BAT #2,molding charge is off",5,8,43);
;;;786    			snmp_bat_flag_puts[1]&=~0x0800;
;;;787    			}
;;;788    		}
;;;789    
;;;790    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;791    		{
;;;792    		snmp_bat_flag[1]|=0x1000;
;;;793    		if((snmp_bat_flag_puts[1]&0x1000)==0) 
;;;794    			{
;;;795    			snmp_trap_send("BAT #2,molding charge is blocked",5,8,44); 
;;;796    			snmp_bat_flag_puts[1]|=0x1000;
;;;797    			}
;;;798    		}
;;;799    	else 
;;;800    		{
;;;801    		snmp_bat_flag[1]&=~0x1000;
;;;802    		if(snmp_bat_flag_puts[1]&0x1000) 
;;;803    			{
;;;804    			snmp_trap_send("BAT #2,molding charge is unblocked",5,8,45);
;;;805    			snmp_bat_flag_puts[1]&=~0x1000;
;;;806    			} 
;;;807    		}
;;;808    	}
;;;809    else 
;;;810    	{
;;;811    	snmp_bat_flag[1]=0; 
;;;812    	snmp_bat_flag_puts[1]=0;
;;;813    	}
;;;814    /*
;;;815    if(!snmp_bat_status[1])
;;;816    	{
;;;817    	if((bat[1]._Ub<(USIGN*10))) 
;;;818    		{
;;;819    		snmp_bat_flag[1]|=0x01; 
;;;820    		if((snmp_bat_flag_puts[1]&0x01)==0) 
;;;821    			{
;;;822    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,0); 
;;;823    			snmp_bat_flag_puts[1]|=0x01;
;;;824    			}
;;;825    		}
;;;826    	else 
;;;827    		{
;;;828    		snmp_bat_flag[1]&=~0x01; 
;;;829    		if(snmp_bat_flag_puts[1]&0x01) 
;;;830    			{
;;;831    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,1);
;;;832    			snmp_bat_flag_puts[1]&=~0x01;
;;;833    			}
;;;834    		}
;;;835    	if(bat[1]._temper_stat&0x01) 
;;;836    		{
;;;837    		snmp_bat_flag[1]|=0x02;
;;;838    		if((snmp_bat_flag_puts[1]&0x02)==0) 
;;;839    			{
;;;840    			snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,2); 
;;;841    			snmp_bat_flag_puts[1]|=0x02;
;;;842    			}
;;;843    		}
;;;844    	else 
;;;845    		{
;;;846    		snmp_bat_flag[1]&=~0x02;
;;;847    		if(snmp_bat_flag_puts[1]&0x02) 
;;;848    			{
;;;849    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,3);
;;;850    			snmp_bat_flag_puts[1]&=~0x02;
;;;851    			}
;;;852    		}
;;;853    	if(bat[1]._temper_stat&0x02) 
;;;854    		{
;;;855    		snmp_bat_flag[1]|=0x04;
;;;856    		if((snmp_bat_flag_puts[1]&0x04)==0) 
;;;857    			{
;;;858    			snmp_trap_send("BAT #2 Alarm, maximum battery temperature",5,8,4); 
;;;859    			snmp_bat_flag_puts[1]|=0x04;
;;;860    			}
;;;861    		}
;;;862    	else 
;;;863    		{
;;;864    		snmp_bat_flag[1]&=~0x04;
;;;865    		if(snmp_bat_flag_puts[1]&0x04) 
;;;866    			{
;;;867    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,5);
;;;868    			snmp_bat_flag_puts[1]&=~0x04;
;;;869    			}
;;;870    		}
;;;871    		
;;;872    	if(bat[1]._Ib<(-IKB))	snmp_bat_flag[1]|=0x80;
;;;873    	else if(bat[1]._Ib>IKB)snmp_bat_flag[1]&=~0x80;
;;;874    
;;;875    	if((spc_stat==spcKE)&&(spc_bat==1)) 
;;;876    		{
;;;877    		snmp_bat_flag[1]|=0x10;
;;;878    		if((snmp_bat_flag_puts[1]&0x10)==0) 
;;;879    			{
;;;880    			snmp_trap_send("BAT #2, capacity check enabled",5,8,6); 
;;;881    			snmp_bat_flag_puts[1]|=0x10;
;;;882    			}
;;;883    		}
;;;884    	else 
;;;885    		{
;;;886    		snmp_bat_flag[1]&=~0x10;
;;;887    		if(snmp_bat_flag_puts[1]&0x10) 
;;;888    			{
;;;889    			snmp_trap_send("BAT #2, capacity check disabled",5,8,7);
;;;890    			snmp_bat_flag_puts[1]&=~0x10;
;;;891    			}
;;;892    		}
;;;893    		
;;;894    	if(spc_stat==spcVZ) 
;;;895    		{
;;;896    		snmp_bat_flag[1]|=0x20;
;;;897    		if((snmp_bat_flag_puts[1]&0x20)==0) 
;;;898    			{
;;;899    			snmp_trap_send("BAT #2,equalizing charge is on",5,8,8); 
;;;900    			snmp_bat_flag_puts[1]|=0x20;
;;;901    			}
;;;902    		}
;;;903    	else 
;;;904    		{
;;;905    		snmp_bat_flag[1]&=~0x20;
;;;906    		if(snmp_bat_flag_puts[1]&0x20) 
;;;907    			{
;;;908    			snmp_trap_send("BAT #2,equalizing charge is off",5,8,9);
;;;909    			snmp_bat_flag_puts[1]&=~0x20;
;;;910    			}
;;;911    		}
;;;912    
;;;913    	if(vz_error) 
;;;914    		{
;;;915    		snmp_bat_flag[1]|=0x40;
;;;916    		if((snmp_bat_flag_puts[1]&0x40)==0) 
;;;917    			{
;;;918    			snmp_trap_send("BAT #2,equalizing charge blocked",5,8,10); 
;;;919    			snmp_bat_flag_puts[1]|=0x40;
;;;920    			}
;;;921    		}
;;;922    	else 
;;;923    		{
;;;924    		snmp_bat_flag[1]&=~0x40;
;;;925    		if(snmp_bat_flag_puts[1]&0x40) 
;;;926    			{
;;;927    			snmp_trap_send("BAT #2,equalizing charge is not blocked",5,8,11);
;;;928    			snmp_bat_flag_puts[1]&=~0x40;
;;;929    			} 
;;;930    		}
;;;931       }
;;;932    else 
;;;933    	{
;;;934    	snmp_bat_flag[1]=0; 
;;;935    	snmp_bat_flag_puts[1]=0;
;;;936    	} */
;;;937    }
;;;938    
                          ENDP

00019e  0000              DCW      0x0000
                  |L6.416|
                          DCD      t_box
                  |L6.420|
                          DCD      TBOXMAX
                  |L6.424|
                          DCD      av_tbox_cnt
                  |L6.428|
                          DCD      av_tbox_stat
                  |L6.432|
                          DCD      TBOXREG
                  |L6.436|
                          DCD      t_box_cnt
                  |L6.440|
                          DCD      main_vent_pos
                  |L6.444|
                          DCD      TBOXVENTMAX
                  |L6.448|
                          DCD      pos_vent
                  |L6.452|
                          DCD      mess_data
                  |L6.456|
                          DCD      mixer_vent_stat
                  |L6.460|
                          DCD      TBATDISABLE
                  |L6.464|
                          DCD      tbatdisable_stat
                  |L6.468|
                          DCD      tbatdisable_cnt
                  |L6.472|
                          DCD      TBATENABLE
                  |L6.476|
                          DCD      TLOADDISABLE
                  |L6.480|
                          DCD      tloaddisable_stat
                  |L6.484|
                          DCD      tloaddisable_cnt
                  |L6.488|
                          DCD      TLOADENABLE

                          AREA ||area_number.7||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.7||, ||.text||
                  u_avt_set_hndl1 PROC
;;;326    // заполнение флагов для АКБ
;;;327    void bat_flag (void)
000000  e92d5fff          PUSH     {r0-r12,lr}
;;;328    {  
;;;329    if(spc_stat!=spcVZ) 
000004  484e              LDR      r0,|L7.320|
;;;330    	{
;;;331    	vz_error=0;
000006  2165              MOVS     r1,#0x65
000008  2564              MOVS     r5,#0x64              ;329
00000a  f9b00000          LDRSH    r0,[r0,#0]            ;329
00000e  4c4b              LDR      r4,|L7.316|
000010  4341              MULS     r1,r0,r1
;;;332    	sp_ch_error=0;
000012  eb001040          ADD      r0,r0,r0,LSL #5
;;;333    	vz1_error=0;
;;;334    	vz2_error=0;
000016  fbb1f1f5          UDIV     r1,r1,r5
;;;335    	}
;;;336    
;;;337    if( (snmp_bat_status[0]==0 || snmp_bat_status[0]==2) && NUMBAT>0) 	//o_10 	 			//Батарея №1
00001a  eb000040          ADD      r0,r0,r0,LSL #1
00001e  fbb0f0f5          UDIV     r0,r0,r5
;;;338    	{
;;;339    	if((bat[0]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
000022  f8dfb120          LDR      r11,|L7.324|
000026  b20a              SXTH     r2,r1                 ;337
;;;340    		{
;;;341    		snmp_bat_flag[0]|=0x0001; 
;;;342    		if((snmp_bat_flag_puts[0]&0x0001)==0) 
;;;343    			{
;;;344    			snmp_trap_send("BAT #1 Alarm, battery is low",5,8,0); 
;;;345    			snmp_bat_flag_puts[0]|=0x0001;
;;;346    			}
;;;347    		}
;;;348    	else 
;;;349    		{
;;;350    		snmp_bat_flag[0]&=~0x0001; 
;;;351    		if(snmp_bat_flag_puts[0]&0x0001) 
;;;352    			{
;;;353    			snmp_trap_send("BAT #1 Alarm clear, battery is not low",5,8,1);
;;;354    			snmp_bat_flag_puts[0]&=~0x0001;
;;;355    			}
;;;356    		}
;;;357    
;;;358    	if(bat[0]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;359    		{
;;;360    		snmp_bat_flag[0]|=0x0002;
;;;361    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;362    			{
;;;363    			//snmp_trap_send("BAT #1 Warning, high battery temperature",5,8,2); 
;;;364    			snmp_bat_flag_puts[0]|=0x0002;
;;;365    			}
;;;366    		}
;;;367    	else 
;;;368    		{
;;;369    		snmp_bat_flag[0]&=~0x0002;
;;;370    		if(snmp_bat_flag_puts[0]&0x0002) 
;;;371    			{
;;;372    			//snmp_trap_send("BAT #1 Warning clear, battery temperature is normal",5,8,3);
;;;373    			snmp_bat_flag_puts[0]&=~0x02;
;;;374    			}
;;;375    		}
;;;376    
;;;377    	if(bat[0]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;378    		{
;;;379    		snmp_bat_flag[0]|=0x0004;
;;;380    		if((snmp_bat_flag_puts[0]&0x0004)==0) 
;;;381    			{
;;;382    			//snmp_trap_send("BAT #1 Alarm, high battery temperature",5,8,4); 
;;;383    			snmp_bat_flag_puts[0]|=0x0004;
;;;384    			}
;;;385    		}
;;;386    	else 
;;;387    		{
;;;388    		snmp_bat_flag[0]&=~0x0004;
;;;389    		if(snmp_bat_flag_puts[0]&0x0004) 
;;;390    			{
;;;391    			//snmp_trap_send("BAT #1 Alarm clear, battery temperature is normal",5,8,5);
;;;392    			snmp_bat_flag_puts[0]&=~0x0004;
;;;393    			}
;;;394    		}
;;;395    
;;;396    	if(bat[0]._Ib<(-IKB)) snmp_bat_flag[0]|=0x0008;		//Разряд батареи
000028  7823              LDRB     r3,[r4,#0]  ; uavt_set_stat
00002a  b201              SXTH     r1,r0
00002c  f89b0000          LDRB     r0,[r11,#0]           ;341
000030  4e45              LDR      r6,|L7.328|
000032  4f46              LDR      r7,|L7.332|
000034  f8df8118          LDR      r8,|L7.336|
000038  f8df9118          LDR      r9,|L7.340|
00003c  f8dfa118          LDR      r10,|L7.344|
000040  2500              MOVS     r5,#0                 ;339
000042  2b01              CMP      r3,#1                 ;339
000044  d002              BEQ      |L7.76|
000046  2b02              CMP      r3,#2                 ;339
000048  d031              BEQ      |L7.174|
00004a  e071              B        |L7.304|
                  |L7.76|
00004c  803a              STRH     r2,[r7,#0]            ;341
00004e  f8a81000          STRH     r1,[r8,#0]            ;339
000052  2801              CMP      r0,#1                 ;341
000054  d000              BEQ      |L7.88|
000056  7035              STRB     r5,[r6,#0]            ;342
                  |L7.88|
000058  230a              MOVS     r3,#0xa               ;342
00005a  2200              MOVS     r2,#0                 ;342
00005c  21e6              MOVS     r1,#0xe6              ;339
00005e  20e1              MOVS     r0,#0xe1              ;341
000060  f7fffffe          BL       mess_send
000064  f04f0201          MOV      r2,#1                 ;342
000068  f04f0000          MOV      r0,#0                 ;344
00006c  f9b73000          LDRSH    r3,[r7,#0]            ;344
000070  f9b85000          LDRSH    r5,[r8,#0]            ;344
000074  f9ba6000          LDRSH    r6,[r10,#0]           ;345
000078  e00d              B        |L7.150|
                  |L7.122|
00007a  eb0001c0          ADD      r1,r0,r0,LSL #3       ;345
00007e  eb011100          ADD      r1,r1,r0,LSL #4       ;350
000082  eb090181          ADD      r1,r9,r1,LSL #2       ;350
000086  69c9              LDR      r1,[r1,#0x1c]         ;351
000088  4299              CMP      r1,r3                 ;353
00008a  da09              BGE      |L7.160|
00008c  42a9              CMP      r1,r5                 ;353
00008e  dd07              BLE      |L7.160|
000090  f1000001          ADD      r0,r0,#1              ;353
000094  b2c0              UXTB     r0,r0                 ;354
                  |L7.150|
000096  42b0              CMP      r0,r6                 ;354
000098  dbef              BLT      |L7.122|
                  |L7.154|
00009a  2a01              CMP      r2,#1                 ;354
00009c  d003              BEQ      |L7.166|
00009e  e047              B        |L7.304|
                  |L7.160|
0000a0  f04f0200          MOV      r2,#0                 ;358
0000a4  e7f9              B        |L7.154|
                  |L7.166|
0000a6  f04f0002          MOV      r0,#2                 ;360
0000aa  7020              STRB     r0,[r4,#0]            ;360
0000ac  e040              B        |L7.304|
                  |L7.174|
0000ae  803a              STRH     r2,[r7,#0]            ;361
0000b0  f8a81000          STRH     r1,[r8,#0]            ;361
0000b4  2802              CMP      r0,#2                 ;364
0000b6  d000              BEQ      |L7.186|
0000b8  7035              STRB     r5,[r6,#0]            ;364
                  |L7.186|
0000ba  230a              MOVS     r3,#0xa               ;364
0000bc  2200              MOVS     r2,#0                 ;369
0000be  21e6              MOVS     r1,#0xe6              ;369
0000c0  20e1              MOVS     r0,#0xe1              ;369
0000c2  f7fffffe          BL       mess_send
0000c6  f04f0201          MOV      r2,#1                 ;370
0000ca  f04f0000          MOV      r0,#0                 ;370
0000ce  f9b73000          LDRSH    r3,[r7,#0]            ;373
0000d2  f9b87000          LDRSH    r7,[r8,#0]            ;377
0000d6  f9bac000          LDRSH    r12,[r10,#0]          ;379
0000da  e00d              B        |L7.248|
                  |L7.220|
0000dc  eb0001c0          ADD      r1,r0,r0,LSL #3       ;379
0000e0  eb011100          ADD      r1,r1,r0,LSL #4       ;380
0000e4  eb090181          ADD      r1,r9,r1,LSL #2       ;380
0000e8  69c9              LDR      r1,[r1,#0x1c]         ;383
0000ea  4299              CMP      r1,r3                 ;383
0000ec  da09              BGE      |L7.258|
0000ee  42b9              CMP      r1,r7                 ;388
0000f0  dd07              BLE      |L7.258|
0000f2  f1000001          ADD      r0,r0,#1              ;388
0000f6  b2c0              UXTB     r0,r0                 ;389
                  |L7.248|
0000f8  4560              CMP      r0,r12                ;389
0000fa  dbef              BLT      |L7.220|
                  |L7.252|
0000fc  2a01              CMP      r2,#1                 ;389
0000fe  d003              BEQ      |L7.264|
000100  e016              B        |L7.304|
                  |L7.258|
000102  f04f0200          MOV      r2,#0                 ;392
000106  e7f9              B        |L7.252|
                  |L7.264|
000108  20ee              MOVS     r0,#0xee
00010a  e9cd0500          STRD     r0,r5,[sp,#0]
00010e  9502              STR      r5,[sp,#8]
000110  9503              STR      r5,[sp,#0xc]
000112  7831              LDRB     r1,[r6,#0]  ; uavt_bps_pntr
000114  4603              MOV      r3,r0
000116  2216              MOVS     r2,#0x16
000118  4608              MOV      r0,r1
00011a  f7fffffe          BL       mcp2515_transmit
;;;397    	else if(bat[0]._Ib>IKB) snmp_bat_flag[0]&=~0x0008;	//Заряд батареи
00011e  7830              LDRB     r0,[r6,#0]  ; uavt_bps_pntr
000120  1c40              ADDS     r0,r0,#1
000122  b2c0              UXTB     r0,r0
000124  7030              STRB     r0,[r6,#0]
000126  f9ba1000          LDRSH    r1,[r10,#0]  ; NUMIST
;;;398    
;;;399    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
00012a  4288              CMP      r0,r1
00012c  db00              BLT      |L7.304|
00012e  7025              STRB     r5,[r4,#0]
                  |L7.304|
000130  7820              LDRB     r0,[r4,#0]  ; uavt_set_stat
000132  f88b0000          STRB     r0,[r11,#0]
000136  e8bd9fff          POP      {r0-r12,pc}
;;;400    		{
;;;401    		snmp_bat_flag[0]|=0x0010;
;;;402    		if((snmp_bat_flag_puts[0]&0x0010)==0) 
;;;403    			{
;;;404    			snmp_trap_send("BAT #1, capacity test started",5,8,6); 
;;;405    			snmp_bat_flag_puts[0]|=0x0010;
;;;406    			}
;;;407    		}
;;;408    	else 
;;;409    		{
;;;410    		snmp_bat_flag[0]&=~0x0010;
;;;411    		if(snmp_bat_flag_puts[0]&0x0010) 
;;;412    			{
;;;413    			snmp_trap_send("BAT #1, capacity test stopped",5,8,7);
;;;414    			snmp_bat_flag_puts[0]&=~0x0010;
;;;415    			}
;;;416    		}
;;;417    		
;;;418    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
;;;419    		{
;;;420    		snmp_bat_flag[0]|=0x0020;
;;;421    		if((snmp_bat_flag_puts[0]&0x0020)==0) 
;;;422    			{
;;;423    			snmp_trap_send("BAT #1,leveling charge is started",5,8,8); 
;;;424    			snmp_bat_flag_puts[0]|=0x0020;
;;;425    			}
;;;426    		}
;;;427    	else 
;;;428    		{
;;;429    		snmp_bat_flag[0]&=~0x0020;
;;;430    		if(snmp_bat_flag_puts[0]&0x0020) 
;;;431    			{
;;;432    			snmp_trap_send("BAT #1,leveling charge is stopped",5,8,9);
;;;433    			snmp_bat_flag_puts[0]&=~0x0020;
;;;434    			}
;;;435    		}
;;;436    
;;;437    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
;;;438    		{
;;;439    		snmp_bat_flag[0]|=0x0040;
;;;440    		if((snmp_bat_flag_puts[0]&0x0040)==0) 
;;;441    			{
;;;442    			snmp_trap_send("BAT #1,leveling charge is blocked",5,8,10); 
;;;443    			snmp_bat_flag_puts[0]|=0x0040;
;;;444    			}
;;;445    		}
;;;446    	else 
;;;447    		{
;;;448    		snmp_bat_flag[0]&=~0x0040;
;;;449    		if(snmp_bat_flag_puts[0]&0x0040) 
;;;450    			{
;;;451    			snmp_trap_send("BAT #1,leveling charge is unblocked",5,8,11);
;;;452    			snmp_bat_flag_puts[0]&=~0x0040;
;;;453    			} 
;;;454    		}
;;;455    
;;;456    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
;;;457    		{
;;;458    		snmp_bat_flag[0]|=0x0080;
;;;459    		if((snmp_bat_flag_puts[0]&0x0080)==0) 
;;;460    			{
;;;461    			snmp_trap_send("BAT #1,speed charge is started",5,8,10); 
;;;462    			snmp_bat_flag_puts[0]|=0x0080;
;;;463    			}
;;;464    		}
;;;465    	else 
;;;466    		{
;;;467    		snmp_bat_flag[0]&=~0x0080;
;;;468    		if(snmp_bat_flag_puts[0]&0x0080) 
;;;469    			{
;;;470    			snmp_trap_send("BAT #1,speed charge is stopped",5,8,11);
;;;471    			snmp_bat_flag_puts[0]&=~0x0080;
;;;472    			}
;;;473    		}
;;;474    
;;;475    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
;;;476    		{
;;;477    		snmp_bat_flag[0]|=0x0100;
;;;478    		if((snmp_bat_flag_puts[0]&0x0100)==0) 
;;;479    			{
;;;480    			snmp_trap_send("BAT #1,speed charge is blocked",5,8,12); 
;;;481    			snmp_bat_flag_puts[0]|=0x0100;
;;;482    			}
;;;483    		}
;;;484    	else 
;;;485    		{
;;;486    		snmp_bat_flag[0]&=~0x0100;
;;;487    		if(snmp_bat_flag_puts[0]&0x0100) 
;;;488    			{
;;;489    			snmp_trap_send("BAT #1,speed charge is unblocked",5,8,13);
;;;490    			snmp_bat_flag_puts[0]&=~0x0100;
;;;491    			} 
;;;492    		}
;;;493    
;;;494    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;495    		{
;;;496    		snmp_bat_flag[0]|=0x0200;
;;;497    		if((snmp_bat_flag_puts[0]&0x0200)==0) 
;;;498    			{
;;;499    			snmp_trap_send("BAT #1,equalising charge is on",5,8,14); 
;;;500    			snmp_bat_flag_puts[0]|=0x0200;
;;;501    			}
;;;502    		}
;;;503    	else 
;;;504    		{
;;;505    		snmp_bat_flag[0]&=~0x0200;
;;;506    		if(snmp_bat_flag_puts[0]&0x0200) 
;;;507    			{
;;;508    			snmp_trap_send("BAT #1,equalising charge is off",5,8,15);
;;;509    			snmp_bat_flag_puts[0]&=~0x0200;
;;;510    			}
;;;511    		}
;;;512    
;;;513    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;514    		{
;;;515    		snmp_bat_flag[0]|=0x0400;
;;;516    		if((snmp_bat_flag_puts[0]&0x0400)==0) 
;;;517    			{
;;;518    			snmp_trap_send("BAT #1,equalising charge is blocked",5,8,16); 
;;;519    			snmp_bat_flag_puts[0]|=0x0400;
;;;520    			}
;;;521    		}
;;;522    	else 
;;;523    		{
;;;524    		snmp_bat_flag[0]&=~0x0400;
;;;525    		if(snmp_bat_flag_puts[0]&0x0400) 
;;;526    			{
;;;527    			snmp_trap_send("BAT #1,equalising charge is unblocked",5,8,17);
;;;528    			snmp_bat_flag_puts[0]&=~0x0400;
;;;529    			} 
;;;530    		}
;;;531    
;;;532    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;533    		{
;;;534    		snmp_bat_flag[0]|=0x0800;
;;;535    		if((snmp_bat_flag_puts[0]&0x0800)==0) 
;;;536    			{
;;;537    			snmp_trap_send("BAT #1,molding charge is on",5,8,18); 
;;;538    			snmp_bat_flag_puts[0]|=0x0800;
;;;539    			}
;;;540    		}
;;;541    	else 
;;;542    		{
;;;543    		snmp_bat_flag[0]&=~0x0800;
;;;544    		if(snmp_bat_flag_puts[0]&0x0800) 
;;;545    			{
;;;546    			snmp_trap_send("BAT #1,molding charge is off",5,8,19);
;;;547    			snmp_bat_flag_puts[0]&=~0x0800;
;;;548    			}
;;;549    		}
;;;550    
;;;551    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;552    		{
;;;553    		snmp_bat_flag[0]|=0x1000;
;;;554    		if((snmp_bat_flag_puts[0]&0x1000)==0) 
;;;555    			{
;;;556    			snmp_trap_send("BAT #1,molding charge is blocked",5,8,20); 
;;;557    			snmp_bat_flag_puts[0]|=0x1000;
;;;558    			}
;;;559    		}
;;;560    	else 
;;;561    		{
;;;562    		snmp_bat_flag[0]&=~0x1000;
;;;563    		if(snmp_bat_flag_puts[0]&0x1000) 
;;;564    			{
;;;565    			snmp_trap_send("BAT #1,molding charge is unblocked",5,8,21);
;;;566    			snmp_bat_flag_puts[0]&=~0x1000;
;;;567    			} 
;;;568    		}
;;;569    	}
;;;570    else 
;;;571    	{
;;;572    	snmp_bat_flag[0]=0; 
;;;573    	snmp_bat_flag_puts[0]=0;
;;;574    	}
;;;575    
;;;576    if( (snmp_bat_status[1]==0 || snmp_bat_status[1]==2) && NUMBAT==2 )	//o_10 
;;;577    	{
;;;578    	if((bat[1]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
;;;579    		{
;;;580    		snmp_bat_flag[1]|=0x0001; 
;;;581    		if((snmp_bat_flag_puts[1]&0x0001)==0) 
;;;582    			{
;;;583    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,22); 
;;;584    			snmp_bat_flag_puts[1]|=0x0001;
;;;585    			}
;;;586    		}
;;;587    	else 
;;;588    		{
;;;589    		snmp_bat_flag[1]&=~0x0001; 
;;;590    		if(snmp_bat_flag_puts[1]&0x0001) 
;;;591    			{
;;;592    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,23);
;;;593    			snmp_bat_flag_puts[1]&=~0x0001;
;;;594    			}
;;;595    		}
;;;596    
;;;597    	if(bat[1]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;598    		{
;;;599    		snmp_bat_flag[1]|=0x0002;
;;;600    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;601    			{
;;;602    			//snmp_trap_send("BAT #2 Warning, high battery temperature",5,8,24); 
;;;603    			snmp_bat_flag_puts[1]|=0x0002;
;;;604    			}
;;;605    		}
;;;606    	else 
;;;607    		{
;;;608    		snmp_bat_flag[1]&=~0x0002;
;;;609    		if(snmp_bat_flag_puts[1]&0x0002) 
;;;610    			{
;;;611    			//snmp_trap_send("BAT #2 Warning clear, battery temperature is normal",5,8,25);
;;;612    			snmp_bat_flag_puts[1]&=~0x02;
;;;613    			}
;;;614    		}
;;;615    
;;;616    	if(bat[1]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;617    		{
;;;618    		snmp_bat_flag[1]|=0x0004;
;;;619    		if((snmp_bat_flag_puts[1]&0x0004)==0) 
;;;620    			{
;;;621    			//snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,26); 
;;;622    			snmp_bat_flag_puts[1]|=0x0004;
;;;623    			}
;;;624    		}
;;;625    	else 
;;;626    		{
;;;627    		snmp_bat_flag[1]&=~0x0004;
;;;628    		if(snmp_bat_flag_puts[1]&0x0004) 
;;;629    			{
;;;630    			//snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,27);
;;;631    			snmp_bat_flag_puts[1]&=~0x0004;
;;;632    			}
;;;633    		}
;;;634    
;;;635    	if(bat[1]._Ib<(-IKB)) snmp_bat_flag[1]|=0x0008;		//Разряд батареи
;;;636    	else if(bat[1]._Ib>IKB) snmp_bat_flag[1]&=~0x0008;	//Заряд батареи
;;;637    
;;;638    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
;;;639    		{
;;;640    		snmp_bat_flag[1]|=0x0010;
;;;641    		if((snmp_bat_flag_puts[1]&0x0010)==0) 
;;;642    			{
;;;643    			snmp_trap_send("BAT #2, capacity test started",5,8,28); 
;;;644    			snmp_bat_flag_puts[1]|=0x0010;
;;;645    			}
;;;646    		}
;;;647    	else 
;;;648    		{
;;;649    		snmp_bat_flag[1]&=~0x0010;
;;;650    		if(snmp_bat_flag_puts[1]&0x0010) 
;;;651    			{
;;;652    			snmp_trap_send("BAT #2, capacity test stopped",5,8,29);
;;;653    			snmp_bat_flag_puts[1]&=~0x0010;
;;;654    			}
;;;655    		}
;;;656    		
;;;657    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
;;;658    		{
;;;659    		snmp_bat_flag[1]|=0x0020;
;;;660    		if((snmp_bat_flag_puts[1]&0x0020)==0) 
;;;661    			{
;;;662    			snmp_trap_send("BAT #2,leveling charge is started",5,8,30); 
;;;663    			snmp_bat_flag_puts[1]|=0x0020;
;;;664    			}
;;;665    		}
;;;666    	else 
;;;667    		{
;;;668    		snmp_bat_flag[1]&=~0x0020;
;;;669    		if(snmp_bat_flag_puts[1]&0x0020) 
;;;670    			{
;;;671    			snmp_trap_send("BAT #2,leveling charge is stopped",5,8,31);
;;;672    			snmp_bat_flag_puts[1]&=~0x0020;
;;;673    			}
;;;674    		}
;;;675    
;;;676    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
;;;677    		{
;;;678    		snmp_bat_flag[1]|=0x0040;
;;;679    		if((snmp_bat_flag_puts[1]&0x0040)==0) 
;;;680    			{
;;;681    			snmp_trap_send("BAT #2,leveling charge is blocked",5,8,32); 
;;;682    			snmp_bat_flag_puts[1]|=0x0040;
;;;683    			}
;;;684    		}
;;;685    	else 
;;;686    		{
;;;687    		snmp_bat_flag[1]&=~0x0040;
;;;688    		if(snmp_bat_flag_puts[1]&0x0040) 
;;;689    			{
;;;690    			snmp_trap_send("BAT #2,leveling charge is unblocked",5,8,33);
;;;691    			snmp_bat_flag_puts[1]&=~0x0040;
;;;692    			} 
;;;693    		}
;;;694    
;;;695    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
;;;696    		{
;;;697    		snmp_bat_flag[1]|=0x0080;
;;;698    		if((snmp_bat_flag_puts[1]&0x0080)==0) 
;;;699    			{
;;;700    			snmp_trap_send("BAT #2,speed charge is started",5,8,34); 
;;;701    			snmp_bat_flag_puts[1]|=0x0080;
;;;702    			}
;;;703    		}
;;;704    	else 
;;;705    		{
;;;706    		snmp_bat_flag[1]&=~0x0080;
;;;707    		if(snmp_bat_flag_puts[1]&0x0080) 
;;;708    			{
;;;709    			snmp_trap_send("BAT #2,speed charge is stopped",5,8,35);
;;;710    			snmp_bat_flag_puts[1]&=~0x0080;
;;;711    			}
;;;712    		}
;;;713    
;;;714    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
;;;715    		{
;;;716    		snmp_bat_flag[1]|=0x0100;
;;;717    		if((snmp_bat_flag_puts[1]&0x0100)==0) 
;;;718    			{
;;;719    			snmp_trap_send("BAT #2,speed charge is blocked",5,8,36); 
;;;720    			snmp_bat_flag_puts[1]|=0x0100;
;;;721    			}
;;;722    		}
;;;723    	else 
;;;724    		{
;;;725    		snmp_bat_flag[1]&=~0x0100;
;;;726    		if(snmp_bat_flag_puts[1]&0x0100) 
;;;727    			{
;;;728    			snmp_trap_send("BAT #2,speed charge is unblocked",5,8,37);
;;;729    			snmp_bat_flag_puts[1]&=~0x0100;
;;;730    			} 
;;;731    		}
;;;732    
;;;733    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;734    		{
;;;735    		snmp_bat_flag[1]|=0x0200;
;;;736    		if((snmp_bat_flag_puts[1]&0x0200)==0) 
;;;737    			{
;;;738    			snmp_trap_send("BAT #2,equalising charge is on",5,8,38); 
;;;739    			snmp_bat_flag_puts[1]|=0x0200;
;;;740    			}
;;;741    		}
;;;742    	else 
;;;743    		{
;;;744    		snmp_bat_flag[1]&=~0x0200;
;;;745    		if(snmp_bat_flag_puts[1]&0x0200) 
;;;746    			{
;;;747    			snmp_trap_send("BAT #2,equalising charge is off",5,8,39);
;;;748    			snmp_bat_flag_puts[1]&=~0x0200;
;;;749    			}
;;;750    		}
;;;751    
;;;752    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;753    		{
;;;754    		snmp_bat_flag[1]|=0x0400;
;;;755    		if((snmp_bat_flag_puts[1]&0x0400)==0) 
;;;756    			{
;;;757    			snmp_trap_send("BAT #2,equalising charge is blocked",5,8,40); 
;;;758    			snmp_bat_flag_puts[1]|=0x0400;
;;;759    			}
;;;760    		}
;;;761    	else 
;;;762    		{
;;;763    		snmp_bat_flag[1]&=~0x0400;
;;;764    		if(snmp_bat_flag_puts[1]&0x0400) 
;;;765    			{
;;;766    			snmp_trap_send("BAT #2,equalising charge is unblocked",5,8,41);
;;;767    			snmp_bat_flag_puts[1]&=~0x0400;
;;;768    			} 
;;;769    		}
;;;770    
;;;771    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;772    		{
;;;773    		snmp_bat_flag[1]|=0x0800;
;;;774    		if((snmp_bat_flag_puts[1]&0x0800)==0) 
;;;775    			{
;;;776    			snmp_trap_send("BAT #2,molding charge is on",5,8,42); 
;;;777    			snmp_bat_flag_puts[1]|=0x0800;
;;;778    			}
;;;779    		}
;;;780    	else 
;;;781    		{
;;;782    		snmp_bat_flag[1]&=~0x0800;
;;;783    		if(snmp_bat_flag_puts[1]&0x0800) 
;;;784    			{
;;;785    			snmp_trap_send("BAT #2,molding charge is off",5,8,43);
;;;786    			snmp_bat_flag_puts[1]&=~0x0800;
;;;787    			}
;;;788    		}
;;;789    
;;;790    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;791    		{
;;;792    		snmp_bat_flag[1]|=0x1000;
;;;793    		if((snmp_bat_flag_puts[1]&0x1000)==0) 
;;;794    			{
;;;795    			snmp_trap_send("BAT #2,molding charge is blocked",5,8,44); 
;;;796    			snmp_bat_flag_puts[1]|=0x1000;
;;;797    			}
;;;798    		}
;;;799    	else 
;;;800    		{
;;;801    		snmp_bat_flag[1]&=~0x1000;
;;;802    		if(snmp_bat_flag_puts[1]&0x1000) 
;;;803    			{
;;;804    			snmp_trap_send("BAT #2,molding charge is unblocked",5,8,45);
;;;805    			snmp_bat_flag_puts[1]&=~0x1000;
;;;806    			} 
;;;807    		}
;;;808    	}
;;;809    else 
;;;810    	{
;;;811    	snmp_bat_flag[1]=0; 
;;;812    	snmp_bat_flag_puts[1]=0;
;;;813    	}
;;;814    /*
;;;815    if(!snmp_bat_status[1])
;;;816    	{
;;;817    	if((bat[1]._Ub<(USIGN*10))) 
;;;818    		{
;;;819    		snmp_bat_flag[1]|=0x01; 
;;;820    		if((snmp_bat_flag_puts[1]&0x01)==0) 
;;;821    			{
;;;822    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,0); 
;;;823    			snmp_bat_flag_puts[1]|=0x01;
;;;824    			}
;;;825    		}
;;;826    	else 
;;;827    		{
;;;828    		snmp_bat_flag[1]&=~0x01; 
;;;829    		if(snmp_bat_flag_puts[1]&0x01) 
;;;830    			{
;;;831    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,1);
;;;832    			snmp_bat_flag_puts[1]&=~0x01;
;;;833    			}
;;;834    		}
;;;835    	if(bat[1]._temper_stat&0x01) 
;;;836    		{
;;;837    		snmp_bat_flag[1]|=0x02;
;;;838    		if((snmp_bat_flag_puts[1]&0x02)==0) 
;;;839    			{
;;;840    			snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,2); 
;;;841    			snmp_bat_flag_puts[1]|=0x02;
;;;842    			}
;;;843    		}
;;;844    	else 
;;;845    		{
;;;846    		snmp_bat_flag[1]&=~0x02;
;;;847    		if(snmp_bat_flag_puts[1]&0x02) 
;;;848    			{
;;;849    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,3);
;;;850    			snmp_bat_flag_puts[1]&=~0x02;
;;;851    			}
;;;852    		}
;;;853    	if(bat[1]._temper_stat&0x02) 
;;;854    		{
;;;855    		snmp_bat_flag[1]|=0x04;
;;;856    		if((snmp_bat_flag_puts[1]&0x04)==0) 
;;;857    			{
;;;858    			snmp_trap_send("BAT #2 Alarm, maximum battery temperature",5,8,4); 
;;;859    			snmp_bat_flag_puts[1]|=0x04;
;;;860    			}
;;;861    		}
;;;862    	else 
;;;863    		{
;;;864    		snmp_bat_flag[1]&=~0x04;
;;;865    		if(snmp_bat_flag_puts[1]&0x04) 
;;;866    			{
;;;867    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,5);
;;;868    			snmp_bat_flag_puts[1]&=~0x04;
;;;869    			}
;;;870    		}
;;;871    		
;;;872    	if(bat[1]._Ib<(-IKB))	snmp_bat_flag[1]|=0x80;
;;;873    	else if(bat[1]._Ib>IKB)snmp_bat_flag[1]&=~0x80;
;;;874    
;;;875    	if((spc_stat==spcKE)&&(spc_bat==1)) 
;;;876    		{
;;;877    		snmp_bat_flag[1]|=0x10;
;;;878    		if((snmp_bat_flag_puts[1]&0x10)==0) 
;;;879    			{
;;;880    			snmp_trap_send("BAT #2, capacity check enabled",5,8,6); 
;;;881    			snmp_bat_flag_puts[1]|=0x10;
;;;882    			}
;;;883    		}
;;;884    	else 
;;;885    		{
;;;886    		snmp_bat_flag[1]&=~0x10;
;;;887    		if(snmp_bat_flag_puts[1]&0x10) 
;;;888    			{
;;;889    			snmp_trap_send("BAT #2, capacity check disabled",5,8,7);
;;;890    			snmp_bat_flag_puts[1]&=~0x10;
;;;891    			}
;;;892    		}
;;;893    		
;;;894    	if(spc_stat==spcVZ) 
;;;895    		{
;;;896    		snmp_bat_flag[1]|=0x20;
;;;897    		if((snmp_bat_flag_puts[1]&0x20)==0) 
;;;898    			{
;;;899    			snmp_trap_send("BAT #2,equalizing charge is on",5,8,8); 
;;;900    			snmp_bat_flag_puts[1]|=0x20;
;;;901    			}
;;;902    		}
;;;903    	else 
;;;904    		{
;;;905    		snmp_bat_flag[1]&=~0x20;
;;;906    		if(snmp_bat_flag_puts[1]&0x20) 
;;;907    			{
;;;908    			snmp_trap_send("BAT #2,equalizing charge is off",5,8,9);
;;;909    			snmp_bat_flag_puts[1]&=~0x20;
;;;910    			}
;;;911    		}
;;;912    
;;;913    	if(vz_error) 
;;;914    		{
;;;915    		snmp_bat_flag[1]|=0x40;
;;;916    		if((snmp_bat_flag_puts[1]&0x40)==0) 
;;;917    			{
;;;918    			snmp_trap_send("BAT #2,equalizing charge blocked",5,8,10); 
;;;919    			snmp_bat_flag_puts[1]|=0x40;
;;;920    			}
;;;921    		}
;;;922    	else 
;;;923    		{
;;;924    		snmp_bat_flag[1]&=~0x40;
;;;925    		if(snmp_bat_flag_puts[1]&0x40) 
;;;926    			{
;;;927    			snmp_trap_send("BAT #2,equalizing charge is not blocked",5,8,11);
;;;928    			snmp_bat_flag_puts[1]&=~0x40;
;;;929    			} 
;;;930    		}
;;;931       }
;;;932    else 
;;;933    	{
;;;934    	snmp_bat_flag[1]=0; 
;;;935    	snmp_bat_flag_puts[1]=0;
;;;936    	} */
;;;937    }
;;;938    
                          ENDP

00013a  0000              DCW      0x0000
                  |L7.316|
                          DCD      uavt_set_stat
                  |L7.320|
                          DCD      U_AVT
                  |L7.324|
                          DCD      uavt_set_stat_old
                  |L7.328|
                          DCD      uavt_bps_pntr
                  |L7.332|
                          DCD      u_max_temp
                  |L7.336|
                          DCD      u_min_temp
                  |L7.340|
                          DCD      bps
                  |L7.344|
                          DCD      NUMIST

                          AREA ||area_number.8||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.8||, ||.text||
                  cntrl_hndl PROC
;;;326    // заполнение флагов для АКБ
;;;327    void bat_flag (void)
000000  e92d5ff0          PUSH     {r4-r12,lr}
;;;328    {  
;;;329    if(spc_stat!=spcVZ) 
000004  48fd              LDR      r0,|L8.1020|
;;;330    	{
;;;331    	vz_error=0;
000006  4cfe              LDR      r4,|L8.1024|
000008  8800              LDRH     r0,[r0,#0]            ;329  ; IZMAX
00000a  f8a4004c          STRH     r0,[r4,#0x4c]         ;329
00000e  48fd              LDR      r0,|L8.1028|
000010  8800              LDRH     r0,[r0,#0]  ; speedChIsOn
;;;332    	sp_ch_error=0;
000012  b918              CBNZ     r0,|L8.28|
;;;333    	vz1_error=0;
000014  48fc              LDR      r0,|L8.1032|
;;;334    	vz2_error=0;
000016  7800              LDRB     r0,[r0,#0]  ; sp_ch_stat
;;;335    	}
;;;336    
;;;337    if( (snmp_bat_status[0]==0 || snmp_bat_status[0]==2) && NUMBAT>0) 	//o_10 	 			//Батарея №1
000018  2802              CMP      r0,#2
00001a  d103              BNE      |L8.36|
                  |L8.28|
00001c  48fb              LDR      r0,|L8.1036|
00001e  8800              LDRH     r0,[r0,#0]  ; speedChrgCurr
;;;338    	{
;;;339    	if((bat[0]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
000020  f8a4004c          STRH     r0,[r4,#0x4c]
                  |L8.36|
000024  7960              LDRB     r0,[r4,#5]            ;337  ; vz1_stat
000026  280a              CMP      r0,#0xa               ;337
;;;340    		{
;;;341    		snmp_bat_flag[0]|=0x0001; 
;;;342    		if((snmp_bat_flag_puts[0]&0x0001)==0) 
;;;343    			{
;;;344    			snmp_trap_send("BAT #1 Alarm, battery is low",5,8,0); 
;;;345    			snmp_bat_flag_puts[0]|=0x0001;
;;;346    			}
;;;347    		}
;;;348    	else 
;;;349    		{
;;;350    		snmp_bat_flag[0]&=~0x0001; 
;;;351    		if(snmp_bat_flag_puts[0]&0x0001) 
;;;352    			{
;;;353    			snmp_trap_send("BAT #1 Alarm clear, battery is not low",5,8,1);
;;;354    			snmp_bat_flag_puts[0]&=~0x0001;
;;;355    			}
;;;356    		}
;;;357    
;;;358    	if(bat[0]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;359    		{
;;;360    		snmp_bat_flag[0]|=0x0002;
;;;361    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;362    			{
;;;363    			//snmp_trap_send("BAT #1 Warning, high battery temperature",5,8,2); 
;;;364    			snmp_bat_flag_puts[0]|=0x0002;
;;;365    			}
;;;366    		}
;;;367    	else 
;;;368    		{
;;;369    		snmp_bat_flag[0]&=~0x0002;
;;;370    		if(snmp_bat_flag_puts[0]&0x0002) 
;;;371    			{
;;;372    			//snmp_trap_send("BAT #1 Warning clear, battery temperature is normal",5,8,3);
;;;373    			snmp_bat_flag_puts[0]&=~0x02;
;;;374    			}
;;;375    		}
;;;376    
;;;377    	if(bat[0]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;378    		{
;;;379    		snmp_bat_flag[0]|=0x0004;
;;;380    		if((snmp_bat_flag_puts[0]&0x0004)==0) 
;;;381    			{
;;;382    			//snmp_trap_send("BAT #1 Alarm, high battery temperature",5,8,4); 
;;;383    			snmp_bat_flag_puts[0]|=0x0004;
;;;384    			}
;;;385    		}
;;;386    	else 
;;;387    		{
;;;388    		snmp_bat_flag[0]&=~0x0004;
;;;389    		if(snmp_bat_flag_puts[0]&0x0004) 
;;;390    			{
;;;391    			//snmp_trap_send("BAT #1 Alarm clear, battery temperature is normal",5,8,5);
;;;392    			snmp_bat_flag_puts[0]&=~0x0004;
;;;393    			}
;;;394    		}
;;;395    
;;;396    	if(bat[0]._Ib<(-IKB)) snmp_bat_flag[0]|=0x0008;		//Разряд батареи
000028  d103              BNE      |L8.50|
00002a  48f9              LDR      r0,|L8.1040|
00002c  8800              LDRH     r0,[r0,#0]            ;341  ; UZ_IMAX
00002e  f8a4004c          STRH     r0,[r4,#0x4c]         ;342
                  |L8.50|
000032  79e0              LDRB     r0,[r4,#7]            ;337  ; vz2_stat
000034  280a              CMP      r0,#0xa               ;337
000036  d103              BNE      |L8.64|
000038  49f6              LDR      r1,|L8.1044|
00003a  8809              LDRH     r1,[r1,#0]            ;337  ; FZ_IMAX1
00003c  f8a4104c          STRH     r1,[r4,#0x4c]         ;337
                  |L8.64|
000040  280b              CMP      r0,#0xb               ;339
000042  d103              BNE      |L8.76|
000044  48f4              LDR      r0,|L8.1048|
000046  8800              LDRH     r0,[r0,#0]            ;339  ; FZ_IMAX2
000048  f8a4004c          STRH     r0,[r4,#0x4c]         ;339
                  |L8.76|
00004c  f9b40070          LDRSH    r0,[r4,#0x70]         ;341  ; cntrl_stat_blok_cnt
000050  b118              CBZ      r0,|L8.90|
000052  f1a00001          SUB      r0,r0,#1              ;341
000056  f8a40070          STRH     r0,[r4,#0x70]         ;342
                  |L8.90|
00005a  f9b40072          LDRSH    r0,[r4,#0x72]         ;342  ; cntrl_stat_blok_cnt_
00005e  b118              CBZ      r0,|L8.104|
000060  f1a00001          SUB      r0,r0,#1              ;341
000064  f8a40072          STRH     r0,[r4,#0x72]         ;342
                  |L8.104|
000068  48ec              LDR      r0,|L8.1052|
00006a  f04f080a          MOV      r8,#0xa               ;344
00006e  f890103f          LDRB     r1,[r0,#0x3f]         ;344  ; bat
000072  0789              LSLS     r1,r1,#30             ;344
000074  d103              BNE      |L8.126|
000076  f890008b          LDRB     r0,[r0,#0x8b]         ;345  ; bat
00007a  0780              LSLS     r0,r0,#30             ;345
00007c  d005              BEQ      |L8.138|
                  |L8.126|
00007e  f8b4004c          LDRH     r0,[r4,#0x4c]         ;350  ; IZMAX_
000082  fbb0f0f8          UDIV     r0,r0,r8              ;350
000086  f8a4004c          STRH     r0,[r4,#0x4c]         ;351
                  |L8.138|
00008a  48e5              LDR      r0,|L8.1056|
00008c  2601              MOVS     r6,#1                 ;353
00008e  f9b01000          LDRSH    r1,[r0,#0]            ;353  ; REG_SPEED
000092  1e49              SUBS     r1,r1,#1              ;353
000094  2905              CMP      r1,#5                 ;354
000096  d300              BCC      |L8.154|
000098  8006              STRH     r6,[r0,#0]            ;354
                  |L8.154|
00009a  f9b00000          LDRSH    r0,[r0,#0]            ;354  ; REG_SPEED
00009e  2500              MOVS     r5,#0                 ;358
0000a0  eb000180          ADD      r1,r0,r0,LSL #2       ;358
0000a4  7d60              LDRB     r0,[r4,#0x15]         ;360  ; ch_cnt0
0000a6  ebb00f41          CMP      r0,r1,LSL #1          ;360
0000aa  da08              BGE      |L8.190|
0000ac  f1000001          ADD      r0,r0,#1              ;361
0000b0  b2c0              UXTB     r0,r0                 ;361
0000b2  7560              STRB     r0,[r4,#0x15]         ;361
0000b4  ebb00f41          CMP      r0,r1,LSL #1          ;364
0000b8  db01              BLT      |L8.190|
0000ba  7565              STRB     r5,[r4,#0x15]         ;364
0000bc  75a6              STRB     r6,[r4,#0x16]         ;369
                  |L8.190|
0000be  20e1              MOVS     r0,#0xe1              ;369
0000c0  f7fffffe          BL       mess_find_unvol
0000c4  f8dfc35c          LDR      r12,|L8.1060|
0000c8  4ad7              LDR      r2,|L8.1064|
0000ca  f8df9360          LDR      r9,|L8.1068|
0000ce  4fd8              LDR      r7,|L8.1072|
0000d0  b398              CBZ      r0,|L8.314|
0000d2  49d8              LDR      r1,|L8.1076|
0000d4  6808              LDR      r0,[r1,#0]            ;377  ; mess_data
0000d6  2864              CMP      r0,#0x64              ;379
0000d8  d008              BEQ      |L8.236|
0000da  2869              CMP      r0,#0x69              ;379
0000dc  d00b              BEQ      |L8.246|
0000de  286e              CMP      r0,#0x6e              ;380
0000e0  d00f              BEQ      |L8.258|
0000e2  28e5              CMP      r0,#0xe5              ;380
0000e4  d02c              BEQ      |L8.320|
0000e6  28e6              CMP      r0,#0xe6              ;383
0000e8  d02d              BEQ      |L8.326|
                  |L8.234|
0000ea  e1fe              B        |L8.1258|
                  |L8.236|
0000ec  6848              LDR      r0,[r1,#4]            ;383  ; mess_data
0000ee  8ea1              LDRH     r1,[r4,#0x34]         ;388  ; cntrl_stat_old
0000f0  4408              ADD      r0,r0,r1              ;388
0000f2  8660              STRH     r0,[r4,#0x32]         ;388
0000f4  e1f9              B        |L8.1258|
                  |L8.246|
0000f6  6848              LDR      r0,[r1,#4]            ;389  ; mess_data
0000f8  8ea1              LDRH     r1,[r4,#0x34]         ;389  ; cntrl_stat_old
0000fa  eba10000          SUB      r0,r1,r0              ;389
0000fe  8660              STRH     r0,[r4,#0x32]         ;392
000100  e1f3              B        |L8.1258|
                  |L8.258|
000102  8e60              LDRH     r0,[r4,#0x32]         ;392  ; cntrl_stat
000104  f1a00001          SUB      r0,r0,#1
000108  b200              SXTH     r0,r0
00010a  8660              STRH     r0,[r4,#0x32]
00010c  281e              CMP      r0,#0x1e
00010e  dd07              BLE      |L8.288|
000110  48c9              LDR      r0,|L8.1080|
000112  49ca              LDR      r1,|L8.1084|
000114  f9b00000          LDRSH    r0,[r0,#0]  ; load_U
000118  f9b11000          LDRSH    r1,[r1,#0]  ; USIGN
00011c  4288              CMP      r0,r1
;;;397    	else if(bat[0]._Ib>IKB) snmp_bat_flag[0]&=~0x0008;	//Заряд батареи
00011e  da0d              BGE      |L8.316|
                  |L8.288|
000120  7be0              LDRB     r0,[r4,#0xf]  ; cntrlStatIsDownCnt
000122  1c40              ADDS     r0,r0,#1
000124  b2c0              UXTB     r0,r0
000126  73e0              STRB     r0,[r4,#0xf]
000128  28fa              CMP      r0,#0xfa
;;;398    
;;;399    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
00012a  d1de              BNE      |L8.234|
00012c  230a              MOVS     r3,#0xa
00012e  2200              MOVS     r2,#0
000130  21e7              MOVS     r1,#0xe7
000132  20e6              MOVS     r0,#0xe6
000134  f7fffffe          BL       mess_send
000138  e1d7              B        |L8.1258|
                  |L8.314|
;;;400    		{
;;;401    		snmp_bat_flag[0]|=0x0010;
;;;402    		if((snmp_bat_flag_puts[0]&0x0010)==0) 
;;;403    			{
;;;404    			snmp_trap_send("BAT #1, capacity test started",5,8,6); 
;;;405    			snmp_bat_flag_puts[0]|=0x0010;
;;;406    			}
;;;407    		}
;;;408    	else 
;;;409    		{
;;;410    		snmp_bat_flag[0]&=~0x0010;
00013a  e044              B        |L8.454|
                  |L8.316|
00013c  73e5              STRB     r5,[r4,#0xf]
00013e  e1d4              B        |L8.1258|
                  |L8.320|
000140  6848              LDR      r0,[r1,#4]  ; mess_data
;;;411    		if(snmp_bat_flag_puts[0]&0x0010) 
000142  8660              STRH     r0,[r4,#0x32]
000144  e1d1              B        |L8.1258|
                  |L8.326|
000146  f9bc0000          LDRSH    r0,[r12,#0]  ; bps_U
;;;412    			{
;;;413    			snmp_trap_send("BAT #1, capacity test stopped",5,8,7);
00014a  f9b21000          LDRSH    r1,[r2,#0]  ; u_necc
00014e  4288              CMP      r0,r1
000150  dd1a              BLE      |L8.392|
000152  f04f020b          MOV      r2,#0xb
;;;414    			snmp_bat_flag_puts[0]&=~0x0010;
000156  f884202e          STRB     r2,[r4,#0x2e]
00015a  eba00001          SUB      r0,r0,r1
;;;415    			}
;;;416    		}
;;;417    		
;;;418    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
00015e  2828              CMP      r0,#0x28
000160  dd07              BLE      |L8.370|
000162  f9b40032          LDRSH    r0,[r4,#0x32]  ; cntrl_stat
;;;419    		{
;;;420    		snmp_bat_flag[0]|=0x0020;
;;;421    		if((snmp_bat_flag_puts[0]&0x0020)==0) 
;;;422    			{
;;;423    			snmp_trap_send("BAT #1,leveling charge is started",5,8,8); 
;;;424    			snmp_bat_flag_puts[0]|=0x0020;
;;;425    			}
;;;426    		}
;;;427    	else 
;;;428    		{
;;;429    		snmp_bat_flag[0]&=~0x0020;
000166  2800              CMP      r0,#0
000168  dd03              BLE      |L8.370|
00016a  f1a00005          SUB      r0,r0,#5
;;;430    		if(snmp_bat_flag_puts[0]&0x0020) 
00016e  8660              STRH     r0,[r4,#0x32]
000170  e1bb              B        |L8.1258|
                  |L8.370|
;;;431    			{
;;;432    			snmp_trap_send("BAT #1,leveling charge is stopped",5,8,9);
000172  f9b40032          LDRSH    r0,[r4,#0x32]  ; cntrl_stat
000176  2800              CMP      r0,#0
000178  d0b7              BEQ      |L8.234|
00017a  7da1              LDRB     r1,[r4,#0x16]  ; b1Hz_ch
00017c  2900              CMP      r1,#0
;;;433    			snmp_bat_flag_puts[0]&=~0x0020;
00017e  d0b4              BEQ      |L8.234|
000180  f1a00001          SUB      r0,r0,#1
000184  8660              STRH     r0,[r4,#0x32]
;;;434    			}
;;;435    		}
;;;436    
;;;437    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
000186  e1b0              B        |L8.1258|
                  |L8.392|
000188  daaf              BGE      |L8.234|
00018a  f04f020c          MOV      r2,#0xc
;;;438    		{
;;;439    		snmp_bat_flag[0]|=0x0040;
00018e  f884202e          STRB     r2,[r4,#0x2e]
000192  eba10000          SUB      r0,r1,r0
;;;440    		if((snmp_bat_flag_puts[0]&0x0040)==0) 
000196  2828              CMP      r0,#0x28
000198  dd09              BLE      |L8.430|
;;;441    			{
;;;442    			snmp_trap_send("BAT #1,leveling charge is blocked",5,8,10); 
00019a  f9b40032          LDRSH    r0,[r4,#0x32]  ; cntrl_stat
00019e  f24031f7          MOV      r1,#0x3f7
0001a2  4288              CMP      r0,r1
0001a4  da03              BGE      |L8.430|
;;;443    			snmp_bat_flag_puts[0]|=0x0040;
0001a6  f1000005          ADD      r0,r0,#5
0001aa  8660              STRH     r0,[r4,#0x32]
0001ac  e19d              B        |L8.1258|
                  |L8.430|
0001ae  f9b40032          LDRSH    r0,[r4,#0x32]  ; cntrl_stat
0001b2  f5b07f7f          CMP      r0,#0x3fc             ;401
0001b6  da98              BGE      |L8.234|
0001b8  7da1              LDRB     r1,[r4,#0x16]         ;402  ; b1Hz_ch
0001ba  2900              CMP      r1,#0                 ;402
0001bc  d095              BEQ      |L8.234|
0001be  f1000001          ADD      r0,r0,#1              ;404
0001c2  8660              STRH     r0,[r4,#0x32]         ;404
0001c4  e191              B        |L8.1258|
                  |L8.454|
0001c6  7da0              LDRB     r0,[r4,#0x16]         ;404  ; b1Hz_ch
0001c8  2800              CMP      r0,#0                 ;404
0001ca  d08e              BEQ      |L8.234|
0001cc  489c              LDR      r0,|L8.1088|
0001ce  8800              LDRH     r0,[r0,#0]            ;405  ; bIBAT_SMKLBR
0001d0  b118              CBZ      r0,|L8.474|
0001d2  f8990323          LDRB     r0,[r9,#0x323]        ;405  ; bps
0001d6  2828              CMP      r0,#0x28              ;420
0001d8  d987              BLS      |L8.234|
                  |L8.474|
0001da  f104042e          ADD      r4,r4,#0x2e           ;420
0001de  f9b40006          LDRSH    r0,[r4,#6]            ;421  ; cntrl_stat_old
0001e2  8360              STRH     r0,[r4,#0x1a]         ;423
0001e4  f04f0113          MOV      r1,#0x13              ;423
0001e8  7021              STRB     r1,[r4,#0]            ;423
0001ea  f9b4101c          LDRSH    r1,[r4,#0x1c]         ;423  ; Ibmax
0001ee  8be3              LDRH     r3,[r4,#0x1e]         ;424  ; IZMAX_
0001f0  fb91f8f8          SDIV     r8,r1,r8              ;424
0001f4  f1a4042e          SUB      r4,r4,#0x2e           ;424
;;;444    			}
;;;445    		}
;;;446    	else 
;;;447    		{
;;;448    		snmp_bat_flag[0]&=~0x0040;
0001f8  ebb80f43          CMP      r8,r3,LSL #1
0001fc  dd10              BLE      |L8.544|
0001fe  f04f0114          MOV      r1,#0x14
;;;449    		if(snmp_bat_flag_puts[0]&0x0040) 
000202  f884102e          STRB     r1,[r4,#0x2e]
;;;450    			{
;;;451    			snmp_trap_send("BAT #1,leveling charge is unblocked",5,8,11);
000206  f8b41070          LDRH     r1,[r4,#0x70]  ; cntrl_stat_blok_cnt
00020a  b121              CBZ      r1,|L8.534|
00020c  f1a00001          SUB      r0,r0,#1
000210  f8a40048          STRH     r0,[r4,#0x48]
;;;452    			snmp_bat_flag_puts[0]&=~0x0040;
000214  e12d              B        |L8.1138|
                  |L8.534|
000216  f1a0000a          SUB      r0,r0,#0xa
;;;453    			} 
;;;454    		}
;;;455    
;;;456    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
00021a  f8a40048          STRH     r0,[r4,#0x48]
00021e  e128              B        |L8.1138|
                  |L8.544|
000220  da14              BGE      |L8.588|
;;;457    		{
;;;458    		snmp_bat_flag[0]|=0x0080;
;;;459    		if((snmp_bat_flag_puts[0]&0x0080)==0) 
;;;460    			{
;;;461    			snmp_trap_send("BAT #1,speed charge is started",5,8,10); 
;;;462    			snmp_bat_flag_puts[0]|=0x0080;
;;;463    			}
;;;464    		}
;;;465    	else 
;;;466    		{
;;;467    		snmp_bat_flag[0]&=~0x0080;
000222  ebc31a03          RSB      r10,r3,r3,LSL #4
000226  458a              CMP      r10,r1
000228  da10              BGE      |L8.588|
;;;468    		if(snmp_bat_flag_puts[0]&0x0080) 
00022a  f04f0115          MOV      r1,#0x15
00022e  f884102e          STRB     r1,[r4,#0x2e]
;;;469    			{
;;;470    			snmp_trap_send("BAT #1,speed charge is stopped",5,8,11);
000232  f8b41070          LDRH     r1,[r4,#0x70]  ; cntrl_stat_blok_cnt
000236  b121              CBZ      r1,|L8.578|
000238  f1a00001          SUB      r0,r0,#1
;;;471    			snmp_bat_flag_puts[0]&=~0x0080;
00023c  f8a40048          STRH     r0,[r4,#0x48]
000240  e117              B        |L8.1138|
                  |L8.578|
000242  f1a00003          SUB      r0,r0,#3
;;;472    			}
;;;473    		}
;;;474    
;;;475    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
000246  f8a40048          STRH     r0,[r4,#0x48]
;;;476    		{
;;;477    		snmp_bat_flag[0]|=0x0100;
00024a  e112              B        |L8.1138|
                  |L8.588|
00024c  ebc31a03          RSB      r10,r3,r3,LSL #4
;;;478    		if((snmp_bat_flag_puts[0]&0x0100)==0) 
000250  458a              CMP      r10,r1
000252  dd0a              BLE      |L8.618|
000254  4598              CMP      r8,r3
;;;479    			{
;;;480    			snmp_trap_send("BAT #1,speed charge is blocked",5,8,12); 
000256  dd08              BLE      |L8.618|
000258  f04f0116          MOV      r1,#0x16
00025c  f884102e          STRB     r1,[r4,#0x2e]
000260  f1a00001          SUB      r0,r0,#1
;;;481    			snmp_bat_flag_puts[0]|=0x0100;
000264  f8a40048          STRH     r0,[r4,#0x48]
000268  e103              B        |L8.1138|
                  |L8.618|
00026a  f9bcc000          LDRSH    r12,[r12,#0]  ; bps_U
00026e  f9b22000          LDRSH    r2,[r2,#0]            ;458  ; u_necc
000272  f8df81d0          LDR      r8,|L8.1092|
000276  f8dfb1d0          LDR      r11,|L8.1096|
00027a  4594              CMP      r12,r2                ;461
00027c  da72              BGE      |L8.868|
00027e  f04f0a17          MOV      r10,#0x17             ;461
000282  f884a02e          STRB     r10,[r4,#0x2e]        ;461
000286  f9b88000          LDRSH    r8,[r8,#0]            ;462  ; UB0
00028a  f9bba000          LDRSH    r10,[r11,#0]          ;462  ; UB20
00028e  eba8080a          SUB      r8,r8,r10             ;462
;;;482    			}
;;;483    		}
;;;484    	else 
;;;485    		{
;;;486    		snmp_bat_flag[0]&=~0x0100;
000292  eba20a08          SUB      r10,r2,r8
000296  45e2              CMP      r10,r12
;;;487    		if(snmp_bat_flag_puts[0]&0x0100) 
000298  dd37              BLE      |L8.778|
00029a  f04f0218          MOV      r2,#0x18
;;;488    			{
;;;489    			snmp_trap_send("BAT #1,speed charge is unblocked",5,8,13);
00029e  f884202e          STRB     r2,[r4,#0x2e]
0002a2  2900              CMP      r1,#0
0002a4  da10              BGE      |L8.712|
0002a6  f04f0119          MOV      r1,#0x19
;;;490    			snmp_bat_flag_puts[0]&=~0x0100;
0002aa  f884102e          STRB     r1,[r4,#0x2e]
0002ae  f8b41070          LDRH     r1,[r4,#0x70]  ; cntrl_stat_blok_cnt
;;;491    			} 
;;;492    		}
;;;493    
;;;494    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
0002b2  b121              CBZ      r1,|L8.702|
0002b4  f1000001          ADD      r0,r0,#1
;;;495    		{
;;;496    		snmp_bat_flag[0]|=0x0200;
0002b8  f8a40048          STRH     r0,[r4,#0x48]
0002bc  e0d9              B        |L8.1138|
                  |L8.702|
;;;497    		if((snmp_bat_flag_puts[0]&0x0200)==0) 
0002be  f100000a          ADD      r0,r0,#0xa
0002c2  f8a40048          STRH     r0,[r4,#0x48]
;;;498    			{
;;;499    			snmp_trap_send("BAT #1,equalising charge is on",5,8,14); 
0002c6  e0d4              B        |L8.1138|
                  |L8.712|
0002c8  eb030283          ADD      r2,r3,r3,LSL #2
0002cc  428a              CMP      r2,r1
0002ce  dd10              BLE      |L8.754|
;;;500    			snmp_bat_flag_puts[0]|=0x0200;
0002d0  f04f011a          MOV      r1,#0x1a
0002d4  f884102e          STRB     r1,[r4,#0x2e]
0002d8  f8b41070          LDRH     r1,[r4,#0x70]  ; cntrl_stat_blok_cnt
;;;501    			}
;;;502    		}
;;;503    	else 
;;;504    		{
;;;505    		snmp_bat_flag[0]&=~0x0200;
0002dc  b121              CBZ      r1,|L8.744|
0002de  f1000001          ADD      r0,r0,#1
;;;506    		if(snmp_bat_flag_puts[0]&0x0200) 
0002e2  f8a40048          STRH     r0,[r4,#0x48]
0002e6  e0c4              B        |L8.1138|
                  |L8.744|
;;;507    			{
;;;508    			snmp_trap_send("BAT #1,equalising charge is off",5,8,15);
0002e8  f1000002          ADD      r0,r0,#2
0002ec  f8a40048          STRH     r0,[r4,#0x48]
0002f0  e0bf              B        |L8.1138|
                  |L8.754|
0002f2  ebb10f42          CMP      r1,r2,LSL #1
;;;509    			snmp_bat_flag_puts[0]&=~0x0200;
0002f6  da07              BGE      |L8.776|
0002f8  f04f011b          MOV      r1,#0x1b
;;;510    			}
;;;511    		}
;;;512    
;;;513    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
0002fc  f884102e          STRB     r1,[r4,#0x2e]
;;;514    		{
;;;515    		snmp_bat_flag[0]|=0x0400;
000300  f1000001          ADD      r0,r0,#1
000304  f8a40048          STRH     r0,[r4,#0x48]
                  |L8.776|
;;;516    		if((snmp_bat_flag_puts[0]&0x0400)==0) 
000308  e0b3              B        |L8.1138|
                  |L8.778|
00030a  ea4f7ae8          ASR      r10,r8,#31
;;;517    			{
;;;518    			snmp_trap_send("BAT #1,equalising charge is blocked",5,8,16); 
00030e  eb08789a          ADD      r8,r8,r10,LSR #30
000312  eba208a8          SUB      r8,r2,r8,ASR #2
000316  45e0              CMP      r8,r12
000318  dd25              BLE      |L8.870|
;;;519    			snmp_bat_flag_puts[0]|=0x0400;
00031a  f04f021c          MOV      r2,#0x1c
00031e  f884202e          STRB     r2,[r4,#0x2e]
000322  eb030283          ADD      r2,r3,r3,LSL #2
;;;520    			}
;;;521    		}
;;;522    	else 
;;;523    		{
;;;524    		snmp_bat_flag[0]&=~0x0400;
000326  428a              CMP      r2,r1
000328  dd10              BLE      |L8.844|
00032a  f04f011d          MOV      r1,#0x1d
;;;525    		if(snmp_bat_flag_puts[0]&0x0400) 
00032e  f884102e          STRB     r1,[r4,#0x2e]
;;;526    			{
;;;527    			snmp_trap_send("BAT #1,equalising charge is unblocked",5,8,17);
000332  f8b41070          LDRH     r1,[r4,#0x70]  ; cntrl_stat_blok_cnt
000336  b121              CBZ      r1,|L8.834|
000338  f1000001          ADD      r0,r0,#1
00033c  f8a40048          STRH     r0,[r4,#0x48]
;;;528    			snmp_bat_flag_puts[0]&=~0x0400;
000340  e097              B        |L8.1138|
                  |L8.834|
000342  f1000002          ADD      r0,r0,#2
;;;529    			} 
;;;530    		}
;;;531    
;;;532    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
000346  f8a40048          STRH     r0,[r4,#0x48]
;;;533    		{
;;;534    		snmp_bat_flag[0]|=0x0800;
00034a  e092              B        |L8.1138|
                  |L8.844|
00034c  ebb10f42          CMP      r1,r2,LSL #1
000350  da07              BGE      |L8.866|
;;;535    		if((snmp_bat_flag_puts[0]&0x0800)==0) 
000352  f04f011e          MOV      r1,#0x1e
000356  f884102e          STRB     r1,[r4,#0x2e]
;;;536    			{
;;;537    			snmp_trap_send("BAT #1,molding charge is on",5,8,18); 
00035a  f1000001          ADD      r0,r0,#1
00035e  f8a40048          STRH     r0,[r4,#0x48]
                  |L8.866|
000362  e086              B        |L8.1138|
                  |L8.868|
;;;538    			snmp_bat_flag_puts[0]|=0x0800;
000364  e014              B        |L8.912|
                  |L8.870|
000366  1e52              SUBS     r2,r2,#1
000368  4594              CMP      r12,r2
00036a  da10              BGE      |L8.910|
00036c  f04f021f          MOV      r2,#0x1f
;;;539    			}
;;;540    		}
;;;541    	else 
;;;542    		{
;;;543    		snmp_bat_flag[0]&=~0x0800;
000370  f884202e          STRB     r2,[r4,#0x2e]
000374  eb030283          ADD      r2,r3,r3,LSL #2
;;;544    		if(snmp_bat_flag_puts[0]&0x0800) 
000378  ebb10f42          CMP      r1,r2,LSL #1
;;;545    			{
;;;546    			snmp_trap_send("BAT #1,molding charge is off",5,8,19);
00037c  da79              BGE      |L8.1138|
00037e  f04f0120          MOV      r1,#0x20
000382  f884102e          STRB     r1,[r4,#0x2e]
000386  f1000001          ADD      r0,r0,#1
;;;547    			snmp_bat_flag_puts[0]&=~0x0800;
00038a  f8a40048          STRH     r0,[r4,#0x48]
                  |L8.910|
00038e  e070              B        |L8.1138|
                  |L8.912|
;;;548    			}
;;;549    		}
;;;550    
;;;551    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
000390  dd6f              BLE      |L8.1138|
000392  f04f0121          MOV      r1,#0x21
;;;552    		{
;;;553    		snmp_bat_flag[0]|=0x1000;
000396  f884102e          STRB     r1,[r4,#0x2e]
00039a  f9b81000          LDRSH    r1,[r8,#0]  ; UB0
;;;554    		if((snmp_bat_flag_puts[0]&0x1000)==0) 
00039e  f9bb3000          LDRSH    r3,[r11,#0]  ; UB20
;;;555    			{
;;;556    			snmp_trap_send("BAT #1,molding charge is blocked",5,8,20); 
0003a2  eba10103          SUB      r1,r1,r3
0003a6  eb010302          ADD      r3,r1,r2
0003aa  4563              CMP      r3,r12
0003ac  da13              BGE      |L8.982|
;;;557    			snmp_bat_flag_puts[0]|=0x1000;
0003ae  f04f0122          MOV      r1,#0x22
0003b2  f884102e          STRB     r1,[r4,#0x2e]
0003b6  f8b41070          LDRH     r1,[r4,#0x70]  ; cntrl_stat_blok_cnt
;;;558    			}
;;;559    		}
;;;560    	else 
;;;561    		{
;;;562    		snmp_bat_flag[0]&=~0x1000;
0003ba  b939              CBNZ     r1,|L8.972|
0003bc  4923              LDR      r1,|L8.1100|
0003be  8809              LDRH     r1,[r1,#0]  ; TERMOKOMPENS
;;;563    		if(snmp_bat_flag_puts[0]&0x1000) 
0003c0  b121              CBZ      r1,|L8.972|
0003c2  f1a0000a          SUB      r0,r0,#0xa
;;;564    			{
;;;565    			snmp_trap_send("BAT #1,molding charge is unblocked",5,8,21);
0003c6  f8a40048          STRH     r0,[r4,#0x48]
0003ca  e052              B        |L8.1138|
                  |L8.972|
0003cc  f1a00001          SUB      r0,r0,#1
0003d0  f8a40048          STRH     r0,[r4,#0x48]
;;;566    			snmp_bat_flag_puts[0]&=~0x1000;
0003d4  e04d              B        |L8.1138|
                  |L8.982|
0003d6  17cb              ASRS     r3,r1,#31
0003d8  eb017193          ADD      r1,r1,r3,LSR #30
;;;567    			} 
;;;568    		}
;;;569    	}
;;;570    else 
;;;571    	{
;;;572    	snmp_bat_flag[0]=0; 
0003dc  eb0201a1          ADD      r1,r2,r1,ASR #2
;;;573    	snmp_bat_flag_puts[0]=0;
;;;574    	}
;;;575    
;;;576    if( (snmp_bat_status[1]==0 || snmp_bat_status[1]==2) && NUMBAT==2 )	//o_10 
0003e0  4561              CMP      r1,r12
0003e2  da3b              BGE      |L8.1116|
0003e4  f04f0123          MOV      r1,#0x23
0003e8  f884102e          STRB     r1,[r4,#0x2e]
0003ec  f8b41070          LDRH     r1,[r4,#0x70]  ; cntrl_stat_blok_cnt
0003f0  b371              CBZ      r1,|L8.1104|
;;;577    	{
;;;578    	if((bat[1]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
;;;579    		{
;;;580    		snmp_bat_flag[1]|=0x0001; 
;;;581    		if((snmp_bat_flag_puts[1]&0x0001)==0) 
;;;582    			{
;;;583    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,22); 
;;;584    			snmp_bat_flag_puts[1]|=0x0001;
;;;585    			}
;;;586    		}
;;;587    	else 
;;;588    		{
;;;589    		snmp_bat_flag[1]&=~0x0001; 
;;;590    		if(snmp_bat_flag_puts[1]&0x0001) 
;;;591    			{
;;;592    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,23);
;;;593    			snmp_bat_flag_puts[1]&=~0x0001;
;;;594    			}
;;;595    		}
;;;596    
;;;597    	if(bat[1]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;598    		{
;;;599    		snmp_bat_flag[1]|=0x0002;
;;;600    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;601    			{
;;;602    			//snmp_trap_send("BAT #2 Warning, high battery temperature",5,8,24); 
;;;603    			snmp_bat_flag_puts[1]|=0x0002;
;;;604    			}
;;;605    		}
;;;606    	else 
;;;607    		{
;;;608    		snmp_bat_flag[1]&=~0x0002;
;;;609    		if(snmp_bat_flag_puts[1]&0x0002) 
;;;610    			{
;;;611    			//snmp_trap_send("BAT #2 Warning clear, battery temperature is normal",5,8,25);
;;;612    			snmp_bat_flag_puts[1]&=~0x02;
;;;613    			}
;;;614    		}
;;;615    
;;;616    	if(bat[1]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;617    		{
;;;618    		snmp_bat_flag[1]|=0x0004;
;;;619    		if((snmp_bat_flag_puts[1]&0x0004)==0) 
;;;620    			{
;;;621    			//snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,26); 
;;;622    			snmp_bat_flag_puts[1]|=0x0004;
;;;623    			}
;;;624    		}
;;;625    	else 
;;;626    		{
;;;627    		snmp_bat_flag[1]&=~0x0004;
;;;628    		if(snmp_bat_flag_puts[1]&0x0004) 
;;;629    			{
;;;630    			//snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,27);
;;;631    			snmp_bat_flag_puts[1]&=~0x0004;
;;;632    			}
;;;633    		}
;;;634    
;;;635    	if(bat[1]._Ib<(-IKB)) snmp_bat_flag[1]|=0x0008;		//Разряд батареи
;;;636    	else if(bat[1]._Ib>IKB) snmp_bat_flag[1]&=~0x0008;	//Заряд батареи
;;;637    
;;;638    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
;;;639    		{
;;;640    		snmp_bat_flag[1]|=0x0010;
;;;641    		if((snmp_bat_flag_puts[1]&0x0010)==0) 
;;;642    			{
;;;643    			snmp_trap_send("BAT #2, capacity test started",5,8,28); 
;;;644    			snmp_bat_flag_puts[1]|=0x0010;
;;;645    			}
;;;646    		}
;;;647    	else 
;;;648    		{
;;;649    		snmp_bat_flag[1]&=~0x0010;
;;;650    		if(snmp_bat_flag_puts[1]&0x0010) 
;;;651    			{
;;;652    			snmp_trap_send("BAT #2, capacity test stopped",5,8,29);
;;;653    			snmp_bat_flag_puts[1]&=~0x0010;
;;;654    			}
;;;655    		}
;;;656    		
;;;657    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
;;;658    		{
;;;659    		snmp_bat_flag[1]|=0x0020;
;;;660    		if((snmp_bat_flag_puts[1]&0x0020)==0) 
;;;661    			{
;;;662    			snmp_trap_send("BAT #2,leveling charge is started",5,8,30); 
;;;663    			snmp_bat_flag_puts[1]|=0x0020;
;;;664    			}
;;;665    		}
;;;666    	else 
;;;667    		{
;;;668    		snmp_bat_flag[1]&=~0x0020;
;;;669    		if(snmp_bat_flag_puts[1]&0x0020) 
;;;670    			{
;;;671    			snmp_trap_send("BAT #2,leveling charge is stopped",5,8,31);
;;;672    			snmp_bat_flag_puts[1]&=~0x0020;
;;;673    			}
;;;674    		}
;;;675    
;;;676    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
;;;677    		{
;;;678    		snmp_bat_flag[1]|=0x0040;
;;;679    		if((snmp_bat_flag_puts[1]&0x0040)==0) 
;;;680    			{
;;;681    			snmp_trap_send("BAT #2,leveling charge is blocked",5,8,32); 
;;;682    			snmp_bat_flag_puts[1]|=0x0040;
;;;683    			}
;;;684    		}
;;;685    	else 
;;;686    		{
;;;687    		snmp_bat_flag[1]&=~0x0040;
;;;688    		if(snmp_bat_flag_puts[1]&0x0040) 
;;;689    			{
;;;690    			snmp_trap_send("BAT #2,leveling charge is unblocked",5,8,33);
;;;691    			snmp_bat_flag_puts[1]&=~0x0040;
;;;692    			} 
;;;693    		}
;;;694    
;;;695    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
;;;696    		{
;;;697    		snmp_bat_flag[1]|=0x0080;
;;;698    		if((snmp_bat_flag_puts[1]&0x0080)==0) 
;;;699    			{
;;;700    			snmp_trap_send("BAT #2,speed charge is started",5,8,34); 
;;;701    			snmp_bat_flag_puts[1]|=0x0080;
;;;702    			}
;;;703    		}
;;;704    	else 
;;;705    		{
;;;706    		snmp_bat_flag[1]&=~0x0080;
;;;707    		if(snmp_bat_flag_puts[1]&0x0080) 
;;;708    			{
;;;709    			snmp_trap_send("BAT #2,speed charge is stopped",5,8,35);
;;;710    			snmp_bat_flag_puts[1]&=~0x0080;
;;;711    			}
;;;712    		}
;;;713    
;;;714    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
;;;715    		{
;;;716    		snmp_bat_flag[1]|=0x0100;
;;;717    		if((snmp_bat_flag_puts[1]&0x0100)==0) 
;;;718    			{
;;;719    			snmp_trap_send("BAT #2,speed charge is blocked",5,8,36); 
;;;720    			snmp_bat_flag_puts[1]|=0x0100;
;;;721    			}
;;;722    		}
;;;723    	else 
;;;724    		{
;;;725    		snmp_bat_flag[1]&=~0x0100;
;;;726    		if(snmp_bat_flag_puts[1]&0x0100) 
;;;727    			{
;;;728    			snmp_trap_send("BAT #2,speed charge is unblocked",5,8,37);
;;;729    			snmp_bat_flag_puts[1]&=~0x0100;
;;;730    			} 
;;;731    		}
;;;732    
;;;733    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;734    		{
;;;735    		snmp_bat_flag[1]|=0x0200;
;;;736    		if((snmp_bat_flag_puts[1]&0x0200)==0) 
;;;737    			{
;;;738    			snmp_trap_send("BAT #2,equalising charge is on",5,8,38); 
;;;739    			snmp_bat_flag_puts[1]|=0x0200;
;;;740    			}
;;;741    		}
;;;742    	else 
;;;743    		{
;;;744    		snmp_bat_flag[1]&=~0x0200;
;;;745    		if(snmp_bat_flag_puts[1]&0x0200) 
;;;746    			{
;;;747    			snmp_trap_send("BAT #2,equalising charge is off",5,8,39);
;;;748    			snmp_bat_flag_puts[1]&=~0x0200;
;;;749    			}
;;;750    		}
;;;751    
;;;752    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;753    		{
;;;754    		snmp_bat_flag[1]|=0x0400;
;;;755    		if((snmp_bat_flag_puts[1]&0x0400)==0) 
;;;756    			{
;;;757    			snmp_trap_send("BAT #2,equalising charge is blocked",5,8,40); 
;;;758    			snmp_bat_flag_puts[1]|=0x0400;
;;;759    			}
;;;760    		}
;;;761    	else 
;;;762    		{
;;;763    		snmp_bat_flag[1]&=~0x0400;
;;;764    		if(snmp_bat_flag_puts[1]&0x0400) 
;;;765    			{
;;;766    			snmp_trap_send("BAT #2,equalising charge is unblocked",5,8,41);
;;;767    			snmp_bat_flag_puts[1]&=~0x0400;
;;;768    			} 
;;;769    		}
;;;770    
;;;771    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;772    		{
;;;773    		snmp_bat_flag[1]|=0x0800;
;;;774    		if((snmp_bat_flag_puts[1]&0x0800)==0) 
;;;775    			{
;;;776    			snmp_trap_send("BAT #2,molding charge is on",5,8,42); 
;;;777    			snmp_bat_flag_puts[1]|=0x0800;
;;;778    			}
;;;779    		}
;;;780    	else 
;;;781    		{
;;;782    		snmp_bat_flag[1]&=~0x0800;
;;;783    		if(snmp_bat_flag_puts[1]&0x0800) 
;;;784    			{
;;;785    			snmp_trap_send("BAT #2,molding charge is off",5,8,43);
;;;786    			snmp_bat_flag_puts[1]&=~0x0800;
;;;787    			}
;;;788    		}
;;;789    
;;;790    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;791    		{
;;;792    		snmp_bat_flag[1]|=0x1000;
;;;793    		if((snmp_bat_flag_puts[1]&0x1000)==0) 
;;;794    			{
;;;795    			snmp_trap_send("BAT #2,molding charge is blocked",5,8,44); 
;;;796    			snmp_bat_flag_puts[1]|=0x1000;
;;;797    			}
;;;798    		}
;;;799    	else 
;;;800    		{
;;;801    		snmp_bat_flag[1]&=~0x1000;
;;;802    		if(snmp_bat_flag_puts[1]&0x1000) 
;;;803    			{
;;;804    			snmp_trap_send("BAT #2,molding charge is unblocked",5,8,45);
;;;805    			snmp_bat_flag_puts[1]&=~0x1000;
;;;806    			} 
;;;807    		}
;;;808    	}
;;;809    else 
;;;810    	{
;;;811    	snmp_bat_flag[1]=0; 
0003f2  f1a00001          SUB      r0,r0,#1
;;;812    	snmp_bat_flag_puts[1]=0;
;;;813    	}
;;;814    /*
;;;815    if(!snmp_bat_status[1])
;;;816    	{
;;;817    	if((bat[1]._Ub<(USIGN*10))) 
;;;818    		{
;;;819    		snmp_bat_flag[1]|=0x01; 
;;;820    		if((snmp_bat_flag_puts[1]&0x01)==0) 
;;;821    			{
;;;822    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,0); 
;;;823    			snmp_bat_flag_puts[1]|=0x01;
;;;824    			}
;;;825    		}
;;;826    	else 
;;;827    		{
;;;828    		snmp_bat_flag[1]&=~0x01; 
;;;829    		if(snmp_bat_flag_puts[1]&0x01) 
;;;830    			{
;;;831    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,1);
;;;832    			snmp_bat_flag_puts[1]&=~0x01;
;;;833    			}
;;;834    		}
;;;835    	if(bat[1]._temper_stat&0x01) 
;;;836    		{
;;;837    		snmp_bat_flag[1]|=0x02;
;;;838    		if((snmp_bat_flag_puts[1]&0x02)==0) 
;;;839    			{
;;;840    			snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,2); 
;;;841    			snmp_bat_flag_puts[1]|=0x02;
;;;842    			}
;;;843    		}
;;;844    	else 
;;;845    		{
;;;846    		snmp_bat_flag[1]&=~0x02;
;;;847    		if(snmp_bat_flag_puts[1]&0x02) 
;;;848    			{
;;;849    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,3);
;;;850    			snmp_bat_flag_puts[1]&=~0x02;
;;;851    			}
;;;852    		}
;;;853    	if(bat[1]._temper_stat&0x02) 
;;;854    		{
;;;855    		snmp_bat_flag[1]|=0x04;
;;;856    		if((snmp_bat_flag_puts[1]&0x04)==0) 
;;;857    			{
;;;858    			snmp_trap_send("BAT #2 Alarm, maximum battery temperature",5,8,4); 
;;;859    			snmp_bat_flag_puts[1]|=0x04;
;;;860    			}
;;;861    		}
;;;862    	else 
;;;863    		{
;;;864    		snmp_bat_flag[1]&=~0x04;
;;;865    		if(snmp_bat_flag_puts[1]&0x04) 
;;;866    			{
;;;867    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,5);
;;;868    			snmp_bat_flag_puts[1]&=~0x04;
;;;869    			}
;;;870    		}
;;;871    		
;;;872    	if(bat[1]._Ib<(-IKB))	snmp_bat_flag[1]|=0x80;
;;;873    	else if(bat[1]._Ib>IKB)snmp_bat_flag[1]&=~0x80;
;;;874    
;;;875    	if((spc_stat==spcKE)&&(spc_bat==1)) 
;;;876    		{
;;;877    		snmp_bat_flag[1]|=0x10;
;;;878    		if((snmp_bat_flag_puts[1]&0x10)==0) 
;;;879    			{
;;;880    			snmp_trap_send("BAT #2, capacity check enabled",5,8,6); 
;;;881    			snmp_bat_flag_puts[1]|=0x10;
;;;882    			}
;;;883    		}
;;;884    	else 
;;;885    		{
;;;886    		snmp_bat_flag[1]&=~0x10;
;;;887    		if(snmp_bat_flag_puts[1]&0x10) 
;;;888    			{
;;;889    			snmp_trap_send("BAT #2, capacity check disabled",5,8,7);
;;;890    			snmp_bat_flag_puts[1]&=~0x10;
;;;891    			}
;;;892    		}
;;;893    		
;;;894    	if(spc_stat==spcVZ) 
;;;895    		{
;;;896    		snmp_bat_flag[1]|=0x20;
;;;897    		if((snmp_bat_flag_puts[1]&0x20)==0) 
;;;898    			{
;;;899    			snmp_trap_send("BAT #2,equalizing charge is on",5,8,8); 
;;;900    			snmp_bat_flag_puts[1]|=0x20;
;;;901    			}
;;;902    		}
;;;903    	else 
;;;904    		{
;;;905    		snmp_bat_flag[1]&=~0x20;
;;;906    		if(snmp_bat_flag_puts[1]&0x20) 
;;;907    			{
;;;908    			snmp_trap_send("BAT #2,equalizing charge is off",5,8,9);
;;;909    			snmp_bat_flag_puts[1]&=~0x20;
;;;910    			}
;;;911    		}
;;;912    
;;;913    	if(vz_error) 
;;;914    		{
;;;915    		snmp_bat_flag[1]|=0x40;
;;;916    		if((snmp_bat_flag_puts[1]&0x40)==0) 
;;;917    			{
;;;918    			snmp_trap_send("BAT #2,equalizing charge blocked",5,8,10); 
;;;919    			snmp_bat_flag_puts[1]|=0x40;
;;;920    			}
;;;921    		}
;;;922    	else 
;;;923    		{
;;;924    		snmp_bat_flag[1]&=~0x40;
;;;925    		if(snmp_bat_flag_puts[1]&0x40) 
;;;926    			{
;;;927    			snmp_trap_send("BAT #2,equalizing charge is not blocked",5,8,11);
;;;928    			snmp_bat_flag_puts[1]&=~0x40;
;;;929    			} 
;;;930    		}
;;;931       }
;;;932    else 
;;;933    	{
;;;934    	snmp_bat_flag[1]=0; 
;;;935    	snmp_bat_flag_puts[1]=0;
;;;936    	} */
;;;937    }
0003f6  f8a40048          STRH     r0,[r4,#0x48]
0003fa  e03a              B        |L8.1138|
                  |L8.1020|
                          DCD      IZMAX
                  |L8.1024|
                          DCD      ||area_number.26||
                  |L8.1028|
                          DCD      speedChIsOn
                  |L8.1032|
                          DCD      sp_ch_stat
                  |L8.1036|
                          DCD      speedChrgCurr
                  |L8.1040|
                          DCD      UZ_IMAX
                  |L8.1044|
                          DCD      FZ_IMAX1
                  |L8.1048|
                          DCD      FZ_IMAX2
                  |L8.1052|
                          DCD      bat
                  |L8.1056|
                          DCD      REG_SPEED
                  |L8.1060|
                          DCD      bps_U
                  |L8.1064|
                          DCD      u_necc
                  |L8.1068|
                          DCD      bps
                  |L8.1072|
                          DCD      ica_cntrl_hndl_cnt
                  |L8.1076|
                          DCD      mess_data
                  |L8.1080|
                          DCD      load_U
                  |L8.1084|
                          DCD      USIGN
                  |L8.1088|
                          DCD      bIBAT_SMKLBR
                  |L8.1092|
                          DCD      UB0
                  |L8.1096|
                          DCD      UB20
                  |L8.1100|
                          DCD      TERMOKOMPENS
                  |L8.1104|
000450  e7ff              B        |L8.1106|
                  |L8.1106|
000452  f1a00002          SUB      r0,r0,#2
000456  f8a40048          STRH     r0,[r4,#0x48]
00045a  e00a              B        |L8.1138|
                  |L8.1116|
00045c  1c52              ADDS     r2,r2,#1
00045e  4594              CMP      r12,r2
000460  dd07              BLE      |L8.1138|
000462  f04f0124          MOV      r1,#0x24
000466  f884102e          STRB     r1,[r4,#0x2e]
00046a  f1a00001          SUB      r0,r0,#1
00046e  f8a40048          STRH     r0,[r4,#0x48]
                  |L8.1138|
000472  4837              LDR      r0,|L8.1360|
000474  7961              LDRB     r1,[r4,#5]  ; vz1_stat
000476  7800              LDRB     r0,[r0,#0]  ; hv_vz_stat
000478  4308              ORRS     r0,r0,r1
00047a  79e1              LDRB     r1,[r4,#7]  ; vz2_stat
00047c  4308              ORRS     r0,r0,r1
00047e  d10e              BNE      |L8.1182|
000480  4834              LDR      r0,|L8.1364|
000482  7840              LDRB     r0,[r0,#1]  ; sk_stat
000484  2801              CMP      r0,#1
000486  d10a              BNE      |L8.1182|
000488  4833              LDR      r0,|L8.1368|
00048a  7840              LDRB     r0,[r0,#1]  ; sk_stat_old
00048c  b938              CBNZ     r0,|L8.1182|
00048e  4833              LDR      r0,|L8.1372|
000490  8800              LDRH     r0,[r0,#0]  ; VZ_KIND
000492  2801              CMP      r0,#1
000494  d103              BNE      |L8.1182|
000496  f04f0032          MOV      r0,#0x32
00049a  f8a40048          STRH     r0,[r4,#0x48]
                  |L8.1182|
00049e  f24032f2          MOV      r2,#0x3f2
0004a2  210a              MOVS     r1,#0xa
0004a4  482e              LDR      r0,|L8.1376|
0004a6  f7fffffe          BL       gran
0004aa  482e              LDR      r0,|L8.1380|
0004ac  8800              LDRH     r0,[r0,#0]  ; net_av_2min_timer
0004ae  b110              CBZ      r0,|L8.1206|
0004b0  8ea0              LDRH     r0,[r4,#0x34]  ; cntrl_stat_old
0004b2  f8a40048          STRH     r0,[r4,#0x48]
                  |L8.1206|
0004b6  f8b40048          LDRH     r0,[r4,#0x48]  ; cntrl_stat_new
0004ba  86a0              STRH     r0,[r4,#0x34]
0004bc  8660              STRH     r0,[r4,#0x32]
0004be  482a              LDR      r0,|L8.1384|
0004c0  f9b00000          LDRSH    r0,[r0,#0]  ; ICA_EN
0004c4  b938              CBNZ     r0,|L8.1238|
0004c6  8839              LDRH     r1,[r7,#0]  ; ica_cntrl_hndl_cnt
0004c8  b129              CBZ      r1,|L8.1238|
0004ca  4928              LDR      r1,|L8.1388|
0004cc  8809              LDRH     r1,[r1,#0]  ; ica_cntrl_hndl
0004ce  8661              STRH     r1,[r4,#0x32]
0004d0  f8a41048          STRH     r1,[r4,#0x48]
0004d4  86a1              STRH     r1,[r4,#0x34]
                  |L8.1238|
0004d6  2801              CMP      r0,#1
0004d8  d001              BEQ      |L8.1246|
0004da  2802              CMP      r0,#2
0004dc  d105              BNE      |L8.1258|
                  |L8.1246|
0004de  4924              LDR      r1,|L8.1392|
0004e0  f8b40048          LDRH     r0,[r4,#0x48]  ; cntrl_stat_new
0004e4  8809              LDRH     r1,[r1,#0]  ; ica_u_necc
0004e6  4408              ADD      r0,r0,r1
0004e8  8660              STRH     r0,[r4,#0x32]
                  |L8.1258|
0004ea  7625              STRB     r5,[r4,#0x18]
0004ec  75e5              STRB     r5,[r4,#0x17]
0004ee  4821              LDR      r0,|L8.1396|
0004f0  f9b01000          LDRSH    r1,[r0,#0]
0004f4  e00c              B        |L8.1296|
                  |L8.1270|
0004f6  eb0002c0          ADD      r2,r0,r0,LSL #3
0004fa  eb021200          ADD      r2,r2,r0,LSL #4
0004fe  eb090282          ADD      r2,r9,r2,LSL #2
000502  78d2              LDRB     r2,[r2,#3]
000504  2a1e              CMP      r2,#0x1e
000506  d200              BCS      |L8.1290|
000508  7626              STRB     r6,[r4,#0x18]
                  |L8.1290|
00050a  f1000001          ADD      r0,r0,#1
00050e  75e0              STRB     r0,[r4,#0x17]
                  |L8.1296|
000510  7de0              LDRB     r0,[r4,#0x17]  ; i
000512  4288              CMP      r0,r1
000514  dbef              BLT      |L8.1270|
000516  7e20              LDRB     r0,[r4,#0x18]  ; iiii
000518  b948              CBNZ     r0,|L8.1326|
00051a  4817              LDR      r0,|L8.1400|
00051c  8800              LDRH     r0,[r0,#0]  ; PWM_START
00051e  eb000080          ADD      r0,r0,r0,LSL #2
000522  ea4f0040          LSL      r0,r0,#1
000526  8660              STRH     r0,[r4,#0x32]
000528  86a0              STRH     r0,[r4,#0x34]
00052a  f8a40048          STRH     r0,[r4,#0x48]
                  |L8.1326|
00052e  f9b70000          LDRSH    r0,[r7,#0]  ; ica_cntrl_hndl_cnt
000532  b110              CBZ      r0,|L8.1338|
000534  f1a00001          SUB      r0,r0,#1
000538  8038              STRH     r0,[r7,#0]
                  |L8.1338|
00053a  4809              LDR      r0,|L8.1376|
00053c  f24032fe          MOV      r2,#0x3fe
000540  210a              MOVS     r1,#0xa
000542  3816              SUBS     r0,r0,#0x16
000544  f7fffffe          BL       gran
000548  75a5              STRB     r5,[r4,#0x16]
00054a  e8bd9ff0          POP      {r4-r12,pc}
;;;938    
                          ENDP

00054e  0000              DCW      0x0000
                  |L8.1360|
                          DCD      hv_vz_stat
                  |L8.1364|
                          DCD      sk_stat
                  |L8.1368|
                          DCD      sk_stat_old
                  |L8.1372|
                          DCD      VZ_KIND
                  |L8.1376|
                          DCD      ||area_number.26||+0x48
                  |L8.1380|
                          DCD      net_av_2min_timer
                  |L8.1384|
                          DCD      ICA_EN
                  |L8.1388|
                          DCD      ica_cntrl_hndl
                  |L8.1392|
                          DCD      ica_u_necc
                  |L8.1396|
                          DCD      NUMIST
                  |L8.1400|
                          DCD      PWM_START

                          AREA ||area_number.9||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.9||, ||.text||
                  averageChargeStartStop PROC
;;;326    // заполнение флагов для АКБ
;;;327    void bat_flag (void)
000000  4908              LDR      r1,|L9.36|
;;;328    {  
000002  f44f70b4          MOV      r0,#0x168
;;;329    if(spc_stat!=spcVZ) 
;;;330    	{
;;;331    	vz_error=0;
000006  780a              LDRB     r2,[r1,#0]  ; hv_vz_stat
000008  b132              CBZ      r2,|L9.24|
00000a  f04f0200          MOV      r2,#0                 ;329
00000e  700a              STRB     r2,[r1,#0]            ;329
000010  f04f0100          MOV      r1,#0
;;;332    	sp_ch_error=0;
;;;333    	vz1_error=0;
000014  f7ffbffe          B.W      lc640_write
                  |L9.24|
;;;334    	vz2_error=0;
;;;335    	}
;;;336    
;;;337    if( (snmp_bat_status[0]==0 || snmp_bat_status[0]==2) && NUMBAT>0) 	//o_10 	 			//Батарея №1
000018  f04f0201          MOV      r2,#1
00001c  700a              STRB     r2,[r1,#0]
00001e  4611              MOV      r1,r2
;;;338    	{
;;;339    	if((bat[0]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
000020  f7ffbffe          B.W      lc640_write
;;;340    		{
;;;341    		snmp_bat_flag[0]|=0x0001; 
;;;342    		if((snmp_bat_flag_puts[0]&0x0001)==0) 
;;;343    			{
;;;344    			snmp_trap_send("BAT #1 Alarm, battery is low",5,8,0); 
;;;345    			snmp_bat_flag_puts[0]|=0x0001;
;;;346    			}
;;;347    		}
;;;348    	else 
;;;349    		{
;;;350    		snmp_bat_flag[0]&=~0x0001; 
;;;351    		if(snmp_bat_flag_puts[0]&0x0001) 
;;;352    			{
;;;353    			snmp_trap_send("BAT #1 Alarm clear, battery is not low",5,8,1);
;;;354    			snmp_bat_flag_puts[0]&=~0x0001;
;;;355    			}
;;;356    		}
;;;357    
;;;358    	if(bat[0]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;359    		{
;;;360    		snmp_bat_flag[0]|=0x0002;
;;;361    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;362    			{
;;;363    			//snmp_trap_send("BAT #1 Warning, high battery temperature",5,8,2); 
;;;364    			snmp_bat_flag_puts[0]|=0x0002;
;;;365    			}
;;;366    		}
;;;367    	else 
;;;368    		{
;;;369    		snmp_bat_flag[0]&=~0x0002;
;;;370    		if(snmp_bat_flag_puts[0]&0x0002) 
;;;371    			{
;;;372    			//snmp_trap_send("BAT #1 Warning clear, battery temperature is normal",5,8,3);
;;;373    			snmp_bat_flag_puts[0]&=~0x02;
;;;374    			}
;;;375    		}
;;;376    
;;;377    	if(bat[0]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;378    		{
;;;379    		snmp_bat_flag[0]|=0x0004;
;;;380    		if((snmp_bat_flag_puts[0]&0x0004)==0) 
;;;381    			{
;;;382    			//snmp_trap_send("BAT #1 Alarm, high battery temperature",5,8,4); 
;;;383    			snmp_bat_flag_puts[0]|=0x0004;
;;;384    			}
;;;385    		}
;;;386    	else 
;;;387    		{
;;;388    		snmp_bat_flag[0]&=~0x0004;
;;;389    		if(snmp_bat_flag_puts[0]&0x0004) 
;;;390    			{
;;;391    			//snmp_trap_send("BAT #1 Alarm clear, battery temperature is normal",5,8,5);
;;;392    			snmp_bat_flag_puts[0]&=~0x0004;
;;;393    			}
;;;394    		}
;;;395    
;;;396    	if(bat[0]._Ib<(-IKB)) snmp_bat_flag[0]|=0x0008;		//Разряд батареи
;;;397    	else if(bat[0]._Ib>IKB) snmp_bat_flag[0]&=~0x0008;	//Заряд батареи
;;;398    
;;;399    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
;;;400    		{
;;;401    		snmp_bat_flag[0]|=0x0010;
;;;402    		if((snmp_bat_flag_puts[0]&0x0010)==0) 
;;;403    			{
;;;404    			snmp_trap_send("BAT #1, capacity test started",5,8,6); 
;;;405    			snmp_bat_flag_puts[0]|=0x0010;
;;;406    			}
;;;407    		}
;;;408    	else 
;;;409    		{
;;;410    		snmp_bat_flag[0]&=~0x0010;
;;;411    		if(snmp_bat_flag_puts[0]&0x0010) 
;;;412    			{
;;;413    			snmp_trap_send("BAT #1, capacity test stopped",5,8,7);
;;;414    			snmp_bat_flag_puts[0]&=~0x0010;
;;;415    			}
;;;416    		}
;;;417    		
;;;418    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
;;;419    		{
;;;420    		snmp_bat_flag[0]|=0x0020;
;;;421    		if((snmp_bat_flag_puts[0]&0x0020)==0) 
;;;422    			{
;;;423    			snmp_trap_send("BAT #1,leveling charge is started",5,8,8); 
;;;424    			snmp_bat_flag_puts[0]|=0x0020;
;;;425    			}
;;;426    		}
;;;427    	else 
;;;428    		{
;;;429    		snmp_bat_flag[0]&=~0x0020;
;;;430    		if(snmp_bat_flag_puts[0]&0x0020) 
;;;431    			{
;;;432    			snmp_trap_send("BAT #1,leveling charge is stopped",5,8,9);
;;;433    			snmp_bat_flag_puts[0]&=~0x0020;
;;;434    			}
;;;435    		}
;;;436    
;;;437    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
;;;438    		{
;;;439    		snmp_bat_flag[0]|=0x0040;
;;;440    		if((snmp_bat_flag_puts[0]&0x0040)==0) 
;;;441    			{
;;;442    			snmp_trap_send("BAT #1,leveling charge is blocked",5,8,10); 
;;;443    			snmp_bat_flag_puts[0]|=0x0040;
;;;444    			}
;;;445    		}
;;;446    	else 
;;;447    		{
;;;448    		snmp_bat_flag[0]&=~0x0040;
;;;449    		if(snmp_bat_flag_puts[0]&0x0040) 
;;;450    			{
;;;451    			snmp_trap_send("BAT #1,leveling charge is unblocked",5,8,11);
;;;452    			snmp_bat_flag_puts[0]&=~0x0040;
;;;453    			} 
;;;454    		}
;;;455    
;;;456    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
;;;457    		{
;;;458    		snmp_bat_flag[0]|=0x0080;
;;;459    		if((snmp_bat_flag_puts[0]&0x0080)==0) 
;;;460    			{
;;;461    			snmp_trap_send("BAT #1,speed charge is started",5,8,10); 
;;;462    			snmp_bat_flag_puts[0]|=0x0080;
;;;463    			}
;;;464    		}
;;;465    	else 
;;;466    		{
;;;467    		snmp_bat_flag[0]&=~0x0080;
;;;468    		if(snmp_bat_flag_puts[0]&0x0080) 
;;;469    			{
;;;470    			snmp_trap_send("BAT #1,speed charge is stopped",5,8,11);
;;;471    			snmp_bat_flag_puts[0]&=~0x0080;
;;;472    			}
;;;473    		}
;;;474    
;;;475    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
;;;476    		{
;;;477    		snmp_bat_flag[0]|=0x0100;
;;;478    		if((snmp_bat_flag_puts[0]&0x0100)==0) 
;;;479    			{
;;;480    			snmp_trap_send("BAT #1,speed charge is blocked",5,8,12); 
;;;481    			snmp_bat_flag_puts[0]|=0x0100;
;;;482    			}
;;;483    		}
;;;484    	else 
;;;485    		{
;;;486    		snmp_bat_flag[0]&=~0x0100;
;;;487    		if(snmp_bat_flag_puts[0]&0x0100) 
;;;488    			{
;;;489    			snmp_trap_send("BAT #1,speed charge is unblocked",5,8,13);
;;;490    			snmp_bat_flag_puts[0]&=~0x0100;
;;;491    			} 
;;;492    		}
;;;493    
;;;494    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;495    		{
;;;496    		snmp_bat_flag[0]|=0x0200;
;;;497    		if((snmp_bat_flag_puts[0]&0x0200)==0) 
;;;498    			{
;;;499    			snmp_trap_send("BAT #1,equalising charge is on",5,8,14); 
;;;500    			snmp_bat_flag_puts[0]|=0x0200;
;;;501    			}
;;;502    		}
;;;503    	else 
;;;504    		{
;;;505    		snmp_bat_flag[0]&=~0x0200;
;;;506    		if(snmp_bat_flag_puts[0]&0x0200) 
;;;507    			{
;;;508    			snmp_trap_send("BAT #1,equalising charge is off",5,8,15);
;;;509    			snmp_bat_flag_puts[0]&=~0x0200;
;;;510    			}
;;;511    		}
;;;512    
;;;513    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;514    		{
;;;515    		snmp_bat_flag[0]|=0x0400;
;;;516    		if((snmp_bat_flag_puts[0]&0x0400)==0) 
;;;517    			{
;;;518    			snmp_trap_send("BAT #1,equalising charge is blocked",5,8,16); 
;;;519    			snmp_bat_flag_puts[0]|=0x0400;
;;;520    			}
;;;521    		}
;;;522    	else 
;;;523    		{
;;;524    		snmp_bat_flag[0]&=~0x0400;
;;;525    		if(snmp_bat_flag_puts[0]&0x0400) 
;;;526    			{
;;;527    			snmp_trap_send("BAT #1,equalising charge is unblocked",5,8,17);
;;;528    			snmp_bat_flag_puts[0]&=~0x0400;
;;;529    			} 
;;;530    		}
;;;531    
;;;532    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;533    		{
;;;534    		snmp_bat_flag[0]|=0x0800;
;;;535    		if((snmp_bat_flag_puts[0]&0x0800)==0) 
;;;536    			{
;;;537    			snmp_trap_send("BAT #1,molding charge is on",5,8,18); 
;;;538    			snmp_bat_flag_puts[0]|=0x0800;
;;;539    			}
;;;540    		}
;;;541    	else 
;;;542    		{
;;;543    		snmp_bat_flag[0]&=~0x0800;
;;;544    		if(snmp_bat_flag_puts[0]&0x0800) 
;;;545    			{
;;;546    			snmp_trap_send("BAT #1,molding charge is off",5,8,19);
;;;547    			snmp_bat_flag_puts[0]&=~0x0800;
;;;548    			}
;;;549    		}
;;;550    
;;;551    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;552    		{
;;;553    		snmp_bat_flag[0]|=0x1000;
;;;554    		if((snmp_bat_flag_puts[0]&0x1000)==0) 
;;;555    			{
;;;556    			snmp_trap_send("BAT #1,molding charge is blocked",5,8,20); 
;;;557    			snmp_bat_flag_puts[0]|=0x1000;
;;;558    			}
;;;559    		}
;;;560    	else 
;;;561    		{
;;;562    		snmp_bat_flag[0]&=~0x1000;
;;;563    		if(snmp_bat_flag_puts[0]&0x1000) 
;;;564    			{
;;;565    			snmp_trap_send("BAT #1,molding charge is unblocked",5,8,21);
;;;566    			snmp_bat_flag_puts[0]&=~0x1000;
;;;567    			} 
;;;568    		}
;;;569    	}
;;;570    else 
;;;571    	{
;;;572    	snmp_bat_flag[0]=0; 
;;;573    	snmp_bat_flag_puts[0]=0;
;;;574    	}
;;;575    
;;;576    if( (snmp_bat_status[1]==0 || snmp_bat_status[1]==2) && NUMBAT==2 )	//o_10 
;;;577    	{
;;;578    	if((bat[1]._Ub<(USIGN*10)))		//Снижение напряжения батареи ниже Uбсигн 
;;;579    		{
;;;580    		snmp_bat_flag[1]|=0x0001; 
;;;581    		if((snmp_bat_flag_puts[1]&0x0001)==0) 
;;;582    			{
;;;583    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,22); 
;;;584    			snmp_bat_flag_puts[1]|=0x0001;
;;;585    			}
;;;586    		}
;;;587    	else 
;;;588    		{
;;;589    		snmp_bat_flag[1]&=~0x0001; 
;;;590    		if(snmp_bat_flag_puts[1]&0x0001) 
;;;591    			{
;;;592    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,23);
;;;593    			snmp_bat_flag_puts[1]&=~0x0001;
;;;594    			}
;;;595    		}
;;;596    
;;;597    	if(bat[1]._temper_stat&0x01)	//Повышенная температура батареи, первый порог - предупреждение
;;;598    		{
;;;599    		snmp_bat_flag[1]|=0x0002;
;;;600    		if((snmp_bat_flag_puts[0]&0x0002)==0) 
;;;601    			{
;;;602    			//snmp_trap_send("BAT #2 Warning, high battery temperature",5,8,24); 
;;;603    			snmp_bat_flag_puts[1]|=0x0002;
;;;604    			}
;;;605    		}
;;;606    	else 
;;;607    		{
;;;608    		snmp_bat_flag[1]&=~0x0002;
;;;609    		if(snmp_bat_flag_puts[1]&0x0002) 
;;;610    			{
;;;611    			//snmp_trap_send("BAT #2 Warning clear, battery temperature is normal",5,8,25);
;;;612    			snmp_bat_flag_puts[1]&=~0x02;
;;;613    			}
;;;614    		}
;;;615    
;;;616    	if(bat[1]._temper_stat&0x02)  	//Повышенная температура батареи, второй порог - авария
;;;617    		{
;;;618    		snmp_bat_flag[1]|=0x0004;
;;;619    		if((snmp_bat_flag_puts[1]&0x0004)==0) 
;;;620    			{
;;;621    			//snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,26); 
;;;622    			snmp_bat_flag_puts[1]|=0x0004;
;;;623    			}
;;;624    		}
;;;625    	else 
;;;626    		{
;;;627    		snmp_bat_flag[1]&=~0x0004;
;;;628    		if(snmp_bat_flag_puts[1]&0x0004) 
;;;629    			{
;;;630    			//snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,27);
;;;631    			snmp_bat_flag_puts[1]&=~0x0004;
;;;632    			}
;;;633    		}
;;;634    
;;;635    	if(bat[1]._Ib<(-IKB)) snmp_bat_flag[1]|=0x0008;		//Разряд батареи
;;;636    	else if(bat[1]._Ib>IKB) snmp_bat_flag[1]&=~0x0008;	//Заряд батареи
;;;637    
;;;638    	if((spc_stat==spcKE)&&(spc_bat==0))					//Контроль емкости батареи №1 
;;;639    		{
;;;640    		snmp_bat_flag[1]|=0x0010;
;;;641    		if((snmp_bat_flag_puts[1]&0x0010)==0) 
;;;642    			{
;;;643    			snmp_trap_send("BAT #2, capacity test started",5,8,28); 
;;;644    			snmp_bat_flag_puts[1]|=0x0010;
;;;645    			}
;;;646    		}
;;;647    	else 
;;;648    		{
;;;649    		snmp_bat_flag[1]&=~0x0010;
;;;650    		if(snmp_bat_flag_puts[1]&0x0010) 
;;;651    			{
;;;652    			snmp_trap_send("BAT #2, capacity test stopped",5,8,29);
;;;653    			snmp_bat_flag_puts[1]&=~0x0010;
;;;654    			}
;;;655    		}
;;;656    		
;;;657    	if(spc_stat==spcVZ)									//Выравнивающий заряд 
;;;658    		{
;;;659    		snmp_bat_flag[1]|=0x0020;
;;;660    		if((snmp_bat_flag_puts[1]&0x0020)==0) 
;;;661    			{
;;;662    			snmp_trap_send("BAT #2,leveling charge is started",5,8,30); 
;;;663    			snmp_bat_flag_puts[1]|=0x0020;
;;;664    			}
;;;665    		}
;;;666    	else 
;;;667    		{
;;;668    		snmp_bat_flag[1]&=~0x0020;
;;;669    		if(snmp_bat_flag_puts[1]&0x0020) 
;;;670    			{
;;;671    			snmp_trap_send("BAT #2,leveling charge is stopped",5,8,31);
;;;672    			snmp_bat_flag_puts[1]&=~0x0020;
;;;673    			}
;;;674    		}
;;;675    
;;;676    	if(vz_error)										 //Выравнивающий заряд заблокирован по вентиляции
;;;677    		{
;;;678    		snmp_bat_flag[1]|=0x0040;
;;;679    		if((snmp_bat_flag_puts[1]&0x0040)==0) 
;;;680    			{
;;;681    			snmp_trap_send("BAT #2,leveling charge is blocked",5,8,32); 
;;;682    			snmp_bat_flag_puts[1]|=0x0040;
;;;683    			}
;;;684    		}
;;;685    	else 
;;;686    		{
;;;687    		snmp_bat_flag[1]&=~0x0040;
;;;688    		if(snmp_bat_flag_puts[1]&0x0040) 
;;;689    			{
;;;690    			snmp_trap_send("BAT #2,leveling charge is unblocked",5,8,33);
;;;691    			snmp_bat_flag_puts[1]&=~0x0040;
;;;692    			} 
;;;693    		}
;;;694    
;;;695    	if(sp_ch_stat==scsWRK) 								//Ускореннный заряд
;;;696    		{
;;;697    		snmp_bat_flag[1]|=0x0080;
;;;698    		if((snmp_bat_flag_puts[1]&0x0080)==0) 
;;;699    			{
;;;700    			snmp_trap_send("BAT #2,speed charge is started",5,8,34); 
;;;701    			snmp_bat_flag_puts[1]|=0x0080;
;;;702    			}
;;;703    		}
;;;704    	else 
;;;705    		{
;;;706    		snmp_bat_flag[1]&=~0x0080;
;;;707    		if(snmp_bat_flag_puts[1]&0x0080) 
;;;708    			{
;;;709    			snmp_trap_send("BAT #2,speed charge is stopped",5,8,35);
;;;710    			snmp_bat_flag_puts[1]&=~0x0080;
;;;711    			}
;;;712    		}
;;;713    
;;;714    	if(sp_ch_error) 									//Ускореннный заряд заблокирован по вентиляции
;;;715    		{
;;;716    		snmp_bat_flag[1]|=0x0100;
;;;717    		if((snmp_bat_flag_puts[1]&0x0100)==0) 
;;;718    			{
;;;719    			snmp_trap_send("BAT #2,speed charge is blocked",5,8,36); 
;;;720    			snmp_bat_flag_puts[1]|=0x0100;
;;;721    			}
;;;722    		}
;;;723    	else 
;;;724    		{
;;;725    		snmp_bat_flag[1]&=~0x0100;
;;;726    		if(snmp_bat_flag_puts[1]&0x0100) 
;;;727    			{
;;;728    			snmp_trap_send("BAT #2,speed charge is unblocked",5,8,37);
;;;729    			snmp_bat_flag_puts[1]&=~0x0100;
;;;730    			} 
;;;731    		}
;;;732    
;;;733    	if(vz1_stat!=vz1sOFF)								//Уравнительный заряд 
;;;734    		{
;;;735    		snmp_bat_flag[1]|=0x0200;
;;;736    		if((snmp_bat_flag_puts[1]&0x0200)==0) 
;;;737    			{
;;;738    			snmp_trap_send("BAT #2,equalising charge is on",5,8,38); 
;;;739    			snmp_bat_flag_puts[1]|=0x0200;
;;;740    			}
;;;741    		}
;;;742    	else 
;;;743    		{
;;;744    		snmp_bat_flag[1]&=~0x0200;
;;;745    		if(snmp_bat_flag_puts[1]&0x0200) 
;;;746    			{
;;;747    			snmp_trap_send("BAT #2,equalising charge is off",5,8,39);
;;;748    			snmp_bat_flag_puts[1]&=~0x0200;
;;;749    			}
;;;750    		}
;;;751    
;;;752    	if(vz1_error)										//Уравнительный заряд заблокирован по вентиляции 
;;;753    		{
;;;754    		snmp_bat_flag[1]|=0x0400;
;;;755    		if((snmp_bat_flag_puts[1]&0x0400)==0) 
;;;756    			{
;;;757    			snmp_trap_send("BAT #2,equalising charge is blocked",5,8,40); 
;;;758    			snmp_bat_flag_puts[1]|=0x0400;
;;;759    			}
;;;760    		}
;;;761    	else 
;;;762    		{
;;;763    		snmp_bat_flag[1]&=~0x0400;
;;;764    		if(snmp_bat_flag_puts[1]&0x0400) 
;;;765    			{
;;;766    			snmp_trap_send("BAT #2,equalising charge is unblocked",5,8,41);
;;;767    			snmp_bat_flag_puts[1]&=~0x0400;
;;;768    			} 
;;;769    		}
;;;770    
;;;771    	if(vz2_stat!=vz2sOFF)								//Формовочный заряд 
;;;772    		{
;;;773    		snmp_bat_flag[1]|=0x0800;
;;;774    		if((snmp_bat_flag_puts[1]&0x0800)==0) 
;;;775    			{
;;;776    			snmp_trap_send("BAT #2,molding charge is on",5,8,42); 
;;;777    			snmp_bat_flag_puts[1]|=0x0800;
;;;778    			}
;;;779    		}
;;;780    	else 
;;;781    		{
;;;782    		snmp_bat_flag[1]&=~0x0800;
;;;783    		if(snmp_bat_flag_puts[1]&0x0800) 
;;;784    			{
;;;785    			snmp_trap_send("BAT #2,molding charge is off",5,8,43);
;;;786    			snmp_bat_flag_puts[1]&=~0x0800;
;;;787    			}
;;;788    		}
;;;789    
;;;790    	if(vz2_error) 										//Формовочный заряд заблокирован по вентиляции
;;;791    		{
;;;792    		snmp_bat_flag[1]|=0x1000;
;;;793    		if((snmp_bat_flag_puts[1]&0x1000)==0) 
;;;794    			{
;;;795    			snmp_trap_send("BAT #2,molding charge is blocked",5,8,44); 
;;;796    			snmp_bat_flag_puts[1]|=0x1000;
;;;797    			}
;;;798    		}
;;;799    	else 
;;;800    		{
;;;801    		snmp_bat_flag[1]&=~0x1000;
;;;802    		if(snmp_bat_flag_puts[1]&0x1000) 
;;;803    			{
;;;804    			snmp_trap_send("BAT #2,molding charge is unblocked",5,8,45);
;;;805    			snmp_bat_flag_puts[1]&=~0x1000;
;;;806    			} 
;;;807    		}
;;;808    	}
;;;809    else 
;;;810    	{
;;;811    	snmp_bat_flag[1]=0; 
;;;812    	snmp_bat_flag_puts[1]=0;
;;;813    	}
;;;814    /*
;;;815    if(!snmp_bat_status[1])
;;;816    	{
;;;817    	if((bat[1]._Ub<(USIGN*10))) 
;;;818    		{
;;;819    		snmp_bat_flag[1]|=0x01; 
;;;820    		if((snmp_bat_flag_puts[1]&0x01)==0) 
;;;821    			{
;;;822    			snmp_trap_send("BAT #2 Alarm, battery is low",5,8,0); 
;;;823    			snmp_bat_flag_puts[1]|=0x01;
;;;824    			}
;;;825    		}
;;;826    	else 
;;;827    		{
;;;828    		snmp_bat_flag[1]&=~0x01; 
;;;829    		if(snmp_bat_flag_puts[1]&0x01) 
;;;830    			{
;;;831    			snmp_trap_send("BAT #2 Alarm clear, battery is not low",5,8,1);
;;;832    			snmp_bat_flag_puts[1]&=~0x01;
;;;833    			}
;;;834    		}
;;;835    	if(bat[1]._temper_stat&0x01) 
;;;836    		{
;;;837    		snmp_bat_flag[1]|=0x02;
;;;838    		if((snmp_bat_flag_puts[1]&0x02)==0) 
;;;839    			{
;;;840    			snmp_trap_send("BAT #2 Alarm, high battery temperature",5,8,2); 
;;;841    			snmp_bat_flag_puts[1]|=0x02;
;;;842    			}
;;;843    		}
;;;844    	else 
;;;845    		{
;;;846    		snmp_bat_flag[1]&=~0x02;
;;;847    		if(snmp_bat_flag_puts[1]&0x02) 
;;;848    			{
;;;849    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,3);
;;;850    			snmp_bat_flag_puts[1]&=~0x02;
;;;851    			}
;;;852    		}
;;;853    	if(bat[1]._temper_stat&0x02) 
;;;854    		{
;;;855    		snmp_bat_flag[1]|=0x04;
;;;856    		if((snmp_bat_flag_puts[1]&0x04)==0) 
;;;857    			{
;;;858    			snmp_trap_send("BAT #2 Alarm, maximum battery temperature",5,8,4); 
;;;859    			snmp_bat_flag_puts[1]|=0x04;
;;;860    			}
;;;861    		}
;;;862    	else 
;;;863    		{
;;;864    		snmp_bat_flag[1]&=~0x04;
;;;865    		if(snmp_bat_flag_puts[1]&0x04) 
;;;866    			{
;;;867    			snmp_trap_send("BAT #2 Alarm clear, battery temperature is normal",5,8,5);
;;;868    			snmp_bat_flag_puts[1]&=~0x04;
;;;869    			}
;;;870    		}
;;;871    		
;;;872    	if(bat[1]._Ib<(-IKB))	snmp_bat_flag[1]|=0x80;
;;;873    	else if(bat[1]._Ib>IKB)snmp_bat_flag[1]&=~0x80;
;;;874    
;;;875    	if((spc_stat==spcKE)&&(spc_bat==1)) 
;;;876    		{
;;;877    		snmp_bat_flag[1]|=0x10;
;;;878    		if((snmp_bat_flag_puts[1]&0x10)==0) 
;;;879    			{
;;;880    			snmp_trap_send("BAT #2, capacity check enabled",5,8,6); 
;;;881    			snmp_bat_flag_puts[1]|=0x10;
;;;882    			}
;;;883    		}
;;;884    	else 
;;;885    		{
;;;886    		snmp_bat_flag[1]&=~0x10;
;;;887    		if(snmp_bat_flag_puts[1]&0x10) 
;;;888    			{
;;;889    			snmp_trap_send("BAT #2, capacity check disabled",5,8,7);
;;;890    			snmp_bat_flag_puts[1]&=~0x10;
;;;891    			}
;;;892    		}
;;;893    		
;;;894    	if(spc_stat==spcVZ) 
;;;895    		{
;;;896    		snmp_bat_flag[1]|=0x20;
;;;897    		if((snmp_bat_flag_puts[1]&0x20)==0) 
;;;898    			{
;;;899    			snmp_trap_send("BAT #2,equalizing charge is on",5,8,8); 
;;;900    			snmp_bat_flag_puts[1]|=0x20;
;;;901    			}
;;;902    		}
;;;903    	else 
;;;904    		{
;;;905    		snmp_bat_flag[1]&=~0x20;
;;;906    		if(snmp_bat_flag_puts[1]&0x20) 
;;;907    			{
;;;908    			snmp_trap_send("BAT #2,equalizing charge is off",5,8,9);
;;;909    			snmp_bat_flag_puts[1]&=~0x20;
;;;910    			}
;;;911    		}
;;;912    
;;;913    	if(vz_error) 
;;;914    		{
;;;915    		snmp_bat_flag[1]|=0x40;
;;;916    		if((snmp_bat_flag_puts[1]&0x40)==0) 
;;;917    			{
;;;918    			snmp_trap_send("BAT #2,equalizing charge blocked",5,8,10); 
;;;919    			snmp_bat_flag_puts[1]|=0x40;
;;;920    			}
;;;921    		}
;;;922    	else 
;;;923    		{
;;;924    		snmp_bat_flag[1]&=~0x40;
;;;925    		if(snmp_bat_flag_puts[1]&0x40) 
;;;926    			{
;;;927    			snmp_trap_send("BAT #2,equalizing charge is not blocked",5,8,11);
;;;928    			snmp_bat_flag_puts[1]&=~0x40;
;;;929    			} 
;;;930    		}
;;;931       }
;;;932    else 
;;;933    	{
;;;934    	snmp_bat_flag[1]=0; 
;;;935    	snmp_bat_flag_puts[1]=0;
;;;936    	} */
;;;937    }
;;;938    
                          ENDP

                  |L9.36|
                          DCD      hv_vz_stat

                          AREA ||.bss||, DATA, NOINIT, ALIGN=2

                  i_bat_buff
                          %        12
                  adc_buff
                          %        1024
                  adc_buff_
                          %        32
                  main_power_buffer
                          %        32
                  I_from_t_table
                          %        14
                  U_end_from_i_table
                          %        14
                  bat_hndl_plazma
                          %        20

                          AREA ||area_number.12||, DATA, NOINIT, ALIGN=1

                          EXPORTAS ||area_number.12||, ||.bss||
                  adc_buff_max
                          %        24

                          AREA ||area_number.13||, DATA, NOINIT, ALIGN=1

                          EXPORTAS ||area_number.13||, ||.bss||
                  net_buff
                          %        64

                          AREA ||.constdata||, DATA, READONLY, ALIGN=0

                  sk_buff_KONTUR
000000  0d0b0f0e          DCB      0x0d,0x0b,0x0f,0x0e

                          AREA ||area_number.16||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.16||, ||.constdata||
                  sk_buff_RSTKM
000000  0d0b0f0e          DCB      0x0d,0x0b,0x0f,0x0e

                          AREA ||area_number.17||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.17||, ||.constdata||
                  sk_buff_GLONASS
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.18||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.18||, ||.constdata||
                  sk_buff_3U
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.19||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.19||, ||.constdata||
                  sk_buff_6U
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.20||, DATA, READONLY, ALIGN=2

                          EXPORTAS ||area_number.20||, ||.constdata||
                  sk_buff_220
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e
                          DCD      0x00000258
                          DCD      0x00000708
                          DCD      0x00000e10
                          DCD      0x00002a30
                          DCD      0x00004650
                          DCD      0x00008ca0
                          DCD      0x00011940
                          DCD      0x00000258
                          DCD      0x00000708
                          DCD      0x00000e10
                          DCD      0x00002a30
                          DCD      0x00004650
                          DCD      0x00008ca0
                          DCD      0x00011940

                          AREA ||area_number.21||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.21||, ||.constdata||
                  sk_buff_TELECORE2015
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||.data||, DATA, ALIGN=1

                  adc_buff_min
000000  13881388          DCW      0x1388,0x1388
000004  13881388          DCW      0x1388,0x1388
000008  13881388          DCW      0x1388,0x1388
00000c  13881388          DCW      0x1388,0x1388
000010  13881388          DCW      0x1388,0x1388
                          DCDU     0x00000000

                          AREA ||area_number.23||, DATA, ALIGN=1

                          EXPORTAS ||area_number.23||, ||.data||
                  unet_buff_min
000000  1388              DCW      0x1388

                          AREA ||area_number.24||, DATA, ALIGN=0

                          EXPORTAS ||area_number.24||, ||.data||
                  adc_stat
000000  01                DCB      0x01

                          AREA ||area_number.25||, DATA, ALIGN=1

                          EXPORTAS ||area_number.25||, ||.data||
                  bat_ver_cnt
000000  0096              DCW      0x0096

                          AREA ||area_number.26||, DATA, ALIGN=2

                          EXPORTAS ||area_number.26||, ||.data||
                  vent_stat
000000  00                DCB      0x00
                  vz_error
000001  00                DCB      0x00
                  sp_ch_error
000002  00                DCB      0x00
                  vz1_error
000003  00                DCB      0x00
                  vz2_error
000004  00                DCB      0x00
                  vz1_stat
000005  00                DCB      0x00
                  vz1_stat_old
000006  00                DCB      0x00
                  vz2_stat
000007  00                DCB      0x00
                  vz2_stat_old
000008  00                DCB      0x00
                  bat_hndl_zvu_init
000009  00                DCB      0x00
                  bat_hndl_zvu_ke_init
00000a  00                DCB      0x00
                  bat_hndl_i_vector
00000b  00                DCB      0x00
                  bat_hndl_i_vector_old
00000c  00                DCB      0x00
                  ke_drv_cnt_10s
00000d  00                DCB      0x00
                  i_bat_buff_cnt
00000e  00                DCB      0x00
                  cntrlStatIsDownCnt
00000f  00                DCB      0x00
                  adc_self_ch_cnt
000010  00                DCB      0x00
                  adc_ch_net
000011  00                DCB      0x00
                  adc_ch
000012  00                DCB      0x00
                  adc_ch_cnt
000013  00                DCB      0x00
                  adc_window_flag
000014  00                DCB      0x00
                  ch_cnt0
000015  00                DCB      0x00
                  b1Hz_ch
000016  00                DCB      0x00
                  i
000017  00                DCB      0x00
                  iiii
000018  00                DCB      0x00
                  bAVG
000019  00                DCB      0x00
                  avg_num
00001a  00                DCB      0x00
                  avg_vektor
00001b  00                DCB      0x00
                  kb_full_ver
00001c  00                DCB      0x00
                  kb_start_ips
00001d  00                DCB      0x00
                  num_of_wrks_bps
00001e  00                DCB      0x00
                  num_necc_up
00001f  00                DCB      0x00
                  num_necc_down
000020  00                DCB      0x00
                  sh_cnt0
000021  00                DCB      0x00
                  b1Hz_sh
000022  00                DCB      0x00
                  spc_stat
000023  00                DCB      0x00
                  spc_bat
000024  00                DCB      0x00
                  spc_phase
000025  00                DCB      0x00
                  bAVZ
000026  00                DCB      0x00
                  ke_start_stat
000027  00                DCB      0x00
                  numOfForvardBps
000028  00                DCB      0x00
                  numOfForvardBps_old
000029  00                DCB      0x00
                  numOfForvardBps_minCnt
00002a  00                DCB      0x00
                  bPARALLEL_NOT_ENOUG
00002b  00                DCB      0x00
                  bPARALLEL_ENOUG
00002c  00                DCB      0x00
                  bPARALLEL
00002d  00                DCB      0x00
                  cntrl_hndl_plazma
00002e  00                DCB      0x00
                  volt_region
00002f  00                DCB      0x00
                  bat_hndl_zvu_Q_cnt
000030  00                DCB      0x00
                  avar_bps_reset_cnt
000031  00                DCB      0x00
                  cntrl_stat
000032  0262              DCW      0x0262
                  cntrl_stat_old
000034  0262              DCW      0x0262
                  avg_main_cnt
000036  0014              DCW      0x0014
                  num_necc_block_cnt
000038  0000              DCB      0x00,0x00
                  net_buff_
00003a  0000              DCB      0x00,0x00
                  adc_result
00003c  0000              DCB      0x00,0x00
                  adc_gorb_cnt
00003e  0000              DCB      0x00,0x00
                  adc_zero_cnt
000040  0000              DCB      0x00,0x00
                  adc_window_cnt
000042  0000              DCB      0x00,0x00
                  adc_net_buff_cnt
000044  0000              DCB      0x00,0x00
                  plazma_sk
000046  0000              DCB      0x00,0x00
                  cntrl_stat_new
000048  0000              DCB      0x00,0x00
                  Ibmax
00004a  0000              DCB      0x00,0x00
                  IZMAX_
00004c  0000              DCB      0x00,0x00
                  Ubpsmax
00004e  0000              DCB      0x00,0x00
                  samokalibr_cnt
000050  0000              DCB      0x00,0x00
                  main_kb_cnt
000052  0000              DCB      0x00,0x00
                  kb_cnt_1lev
000054  0000              DCB      0x00,0x00
                  kb_cnt_2lev
000056  0000              DCB      0x00,0x00
                  kb_start
000058  0000              DCB      0x00,0x00
                  ibat_ips
00005a  0000              DCB      0x00,0x00
                  ibat_ips_
00005c  0000              DCB      0x00,0x00
                  vz_cnt_s
00005e  0000              DCB      0x00,0x00
                  vz_cnt_s_
000060  0000              DCB      0x00,0x00
                  vz_cnt_h
000062  0000              DCB      0x00,0x00
                  vz_cnt_h_
000064  0000              DCB      0x00,0x00
                  cnt_end_ke
000066  0000              DCB      0x00,0x00
                  __ee_vz_cnt
000068  0000              DCB      0x00,0x00
                  __ee_spc_stat
00006a  0000              DCB      0x00,0x00
                  __ee_spc_bat
00006c  0000              DCB      0x00,0x00
                  __ee_spc_phase
00006e  0000              DCB      0x00,0x00
                  cntrl_stat_blok_cnt
000070  0000              DCB      0x00,0x00
                  cntrl_stat_blok_cnt_
000072  0000              DCB      0x00,0x00
                  numOfForvardBps_hourCnt
000074  0000              DCB      0x00,0x00
                  vz1_stat_cnt
000076  0000              DCB      0x00,0x00
                  volt_region_cnt
000078  0000              DCB      0x00,0x00
                  vz2_stat_cnt
00007a  0000              DCB      0x00,0x00
                  vz2_stat_ph2_cnt
00007c  0000              DCB      0x00,0x00
                  plazma_ica1
00007e  0000              DCB      0x00,0x00
                  bat_hndl_i
000080  0000              DCB      0x00,0x00
                  bat_hndl_t_razr_hour
000082  0000              DCB      0x00,0x00
                  bat_hndl_t_razr_min
000084  0000              DCB      0x00,0x00
                  bat_hndl_t_razr_mininhour
000086  0000              DCB      0x00,0x00
                  bat_hndl_i_temp
000088  0000              DCB      0x00,0x00
                  bat_hndl_u_end
00008a  0000              DCB      0x00,0x00
                  bat_hndl_i_zar_price
                          DCD      0x00000000
                  ibat
                          DCD      0x00000000
                  ibat_
                          DCD      0x00000000
                  i_avg_max
                          DCD      0x00000000
                  i_avg_min
                          DCD      0x00000000
                  i_avg_summ
                          DCD      0x00000000
                  i_avg
                          DCD      0x00000000
                  avg
                          DCD      0x00000000
                  bps_on_mask
                          DCD      0x00000000
                  bps_off_mask
                          DCD      0x00000000
                  cntrl_stat_blok_cnt_plus
                          DCD      0x00000000
                  cntrl_stat_blok_cnt_minus
                          DCD      0x00000000
                  plazma_inv
                          DCD      0x00000000
                  vz1_wrk_cnt
                          DCD      0x00000000
                  vz1_up_cnt
                          DCD      0x00000000
                  vz2_wrk_cnt
                          DCD      0x00000000
                  vz2_up_cnt
                          DCD      0x00000000
                  bat_hndl_t_razr
                          DCD      0x00000000
                  bat_hndl_t_razr_ke
                          DCD      0x00000000
                  bat_hndl_zvu_Q
                          DCD      0x00000000
                  bat_hndl_proc_razr
                          DCD      0x00000000
                  bat_hndl_remain_time
                          DCD      0x00000000
                  amper_chas_cnt_drv_summ
                          DCD      0x00000000
                  bat_hndl_i_summ
                          DCD      0x00000000
                  net_metr_buff_
                          DCD      0x00000000
0000f0  0000              DCB      0x00,0x00
                  adc_self_ch_buff
0000f2  0000              DCB      0x00,0x00
                          DCD      0x00000000
                  adc_self_ch_disp
                          DCD      0x00000000
0000fc  00000000          DCB      0x00,0x00,0x00,0x00
                  ke_date
                          %        8

                          AREA ||area_number.27||, DATA, ALIGN=0

                          EXPORTAS ||area_number.27||, ||.data||
                  rx_read_power_cnt_phase
000000  0f                DCB      0x0f

                          AREA ||area_number.28||, DATA, ALIGN=1

                          EXPORTAS ||area_number.28||, ||.data||
                  read_power_cnt_main_cnt
000000  0064              DCW      0x0064

                          AREA ||area_number.29||, DATA, ALIGN=0

                          EXPORTAS ||area_number.29||, ||.data||
                  rx_read_power_cnt_plazma
000000  00                DCB      0x00

                          AREA ||area_number.30||, DATA, ALIGN=0

                          EXPORTAS ||area_number.30||, ||.data||
                  rx_read_power_cnt_flag
000000  00                DCB      0x00

                          AREA ||area_number.31||, DATA, ALIGN=0

                          EXPORTAS ||area_number.31||, ||.data||
                  bENERGOMETR_UIP
000000  00                DCB      0x00

                          AREA ||area_number.32||, DATA, ALIGN=1

                          EXPORTAS ||area_number.32||, ||.data||
                  unet_buff_max
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.33||, DATA, ALIGN=0

                          EXPORTAS ||area_number.33||, ||.data||
                  adc_cnt
000000  00                DCB      0x00

                          AREA ||area_number.34||, DATA, ALIGN=0

                          EXPORTAS ||area_number.34||, ||.data||
                  adc_cnt1
000000  00                DCB      0x00

                          AREA ||area_number.35||, DATA, ALIGN=1

                          EXPORTAS ||area_number.35||, ||.data||
                  zero_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.36||, DATA, ALIGN=0

                          EXPORTAS ||area_number.36||, ||.data||
                  net_buff_cnt
000000  00                DCB      0x00

                          AREA ||area_number.37||, DATA, ALIGN=1

                          EXPORTAS ||area_number.37||, ||.data||
                  ADWR
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.38||, DATA, ALIGN=1

                          EXPORTAS ||area_number.38||, ||.data||
                  period_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.39||, DATA, ALIGN=1

                          EXPORTAS ||area_number.39||, ||.data||
                  non_zero_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.40||, DATA, ALIGN=0

                          EXPORTAS ||area_number.40||, ||.data||
                  rele_stat
000000  00                DCB      0x00

                          AREA ||area_number.41||, DATA, ALIGN=0

                          EXPORTAS ||area_number.41||, ||.data||
                  bRELE_OUT
000000  00                DCB      0x00

                          AREA ||area_number.42||, DATA, ALIGN=2

                          EXPORTAS ||area_number.42||, ||.data||
                  main_power_buffer_
                          DCD      0x00000000

                          AREA ||area_number.43||, DATA, ALIGN=1

                          EXPORTAS ||area_number.43||, ||.data||
                  main_power_buffer_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.44||, DATA, ALIGN=1

                          EXPORTAS ||area_number.44||, ||.data||
                  adc_buff_out_
                          DCDU     0x00000000
000004  0000              DCB      0x00,0x00

                          AREA ||area_number.45||, DATA, ALIGN=1

                          EXPORTAS ||area_number.45||, ||.data||
                  plazma_adc_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.46||, DATA, ALIGN=0

                          EXPORTAS ||area_number.46||, ||.data||
                  unh_cnt0
000000  00                DCB      0x00

                          AREA ||area_number.47||, DATA, ALIGN=0

                          EXPORTAS ||area_number.47||, ||.data||
                  unh_cnt1
000000  00                DCB      0x00

                          AREA ||area_number.48||, DATA, ALIGN=0

                          EXPORTAS ||area_number.48||, ||.data||
                  b1Hz_unh
000000  00                DCB      0x00

                          AREA ||area_number.49||, DATA, ALIGN=0

                          EXPORTAS ||area_number.49||, ||.data||
                  ch_cnt1
000000  00                DCB      0x00

                          AREA ||area_number.50||, DATA, ALIGN=0

                          EXPORTAS ||area_number.50||, ||.data||
                  b1_30Hz_ch
000000  00                DCB      0x00

                          AREA ||area_number.51||, DATA, ALIGN=0

                          EXPORTAS ||area_number.51||, ||.data||
                  ch_cnt2
000000  00                DCB      0x00

                          AREA ||area_number.52||, DATA, ALIGN=0

                          EXPORTAS ||area_number.52||, ||.data||
                  b1_10Hz_ch
000000  00                DCB      0x00

                          AREA ||area_number.53||, DATA, ALIGN=1

                          EXPORTAS ||area_number.53||, ||.data||
                  IZMAX_70
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.54||, DATA, ALIGN=1

                          EXPORTAS ||area_number.54||, ||.data||
                  IZMAX_130
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.55||, DATA, ALIGN=1

                          EXPORTAS ||area_number.55||, ||.data||
                  cntrl_stat_blck_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.56||, DATA, ALIGN=0

                          EXPORTAS ||area_number.56||, ||.data||
                  avg_cnt
000000  00                DCB      0x00

                          AREA ||area_number.57||, DATA, ALIGN=0

                          EXPORTAS ||area_number.57||, ||.data||
                  bps_all_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.58||, DATA, ALIGN=0

                          EXPORTAS ||area_number.58||, ||.data||
                  bps_mask_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.59||, DATA, ALIGN=0

                          EXPORTAS ||area_number.59||, ||.data||
                  bps_mask_on_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.60||, DATA, ALIGN=0

                          EXPORTAS ||area_number.60||, ||.data||
                  bps_hndl_2sec_cnt
000000  00                DCB      0x00

                          AREA ||area_number.61||, DATA, ALIGN=0

                          EXPORTAS ||area_number.61||, ||.data||
                  plazma_bat
000000  00                DCB      0x00

                          AREA ||area_number.62||, DATA, ALIGN=0

                          EXPORTAS ||area_number.62||, ||.data||
                  plazma_cntrl_stat
000000  00                DCB      0x00

                          AREA ||area_number.63||, DATA, ALIGN=1

                          EXPORTAS ||area_number.63||, ||.data||
                  ce102m_delayCnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.64||, DATA, ALIGN=1

                          EXPORTAS ||area_number.64||, ||.data||
                  volta_short
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.65||, DATA, ALIGN=1

                          EXPORTAS ||area_number.65||, ||.data||
                  curr_short
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.66||, DATA, ALIGN=2

                          EXPORTAS ||area_number.66||, ||.data||
                  power_int
                          DCD      0x00000000

                          AREA ||area_number.67||, DATA, ALIGN=1

                          EXPORTAS ||area_number.67||, ||.data||
                  plazma_ica2
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.68||, DATA, ALIGN=0

                          EXPORTAS ||area_number.68||, ||.data||
                  rele_hndl_plazma
000000  000000            DCB      0x00,0x00,0x00

                          AREA ||area_number.69||, DATA, ALIGN=1

                          EXPORTAS ||area_number.69||, ||.data||
                  spirit_wrk_cnt
000000  0000              DCB      0x00,0x00
