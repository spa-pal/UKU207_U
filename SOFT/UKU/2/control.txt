; generated by ARM C/C++ Compiler with , RVCT4.0 [Build 524] for uVision
; commandline ArmCC [--debug -c --asm --interleave -ocontrol.o --depend=control.d --feedback=UKU206.fed --device=DARMP --apcs=interwork -O3 -IC:\Keil\ARM\INC\Philips -D__MICROLIB --omf_browse=control.crf control.c]
                          ARM

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  ke_start PROC
;;;315    //-----------------------------------------------
;;;316    char ke_start(char in)
000000  e3a00000          MOV      r0,#0
;;;317    {          
;;;318    char out;
;;;319    out=0; /*
;;;320    if(in==0)
;;;321    	{
;;;322    	if(spc_stat==spc_OFF)
;;;323    		{ 
;;;324    		if(lc640_read(BAT1_STAT)==ON)
;;;325    			{
;;;326    			if(!a_.av.bAB1)
;;;327    				{
;;;328    				if(abs(Ibat[0])<=(2*K[Ibk]))
;;;329    					{
;;;330    					if(cnt_BAT1_izar>=600)
;;;331    						{
;;;332    						if((lc640_read(BAT2_STAT)==OFF)||((cnt_BAT2_izar>=600)&&(!a_.av.bAB2)))
;;;333    							{
;;;334    							if(!a_.av.bAN)
;;;335    								{       
;;;336    								spc_stat=spc_KE1p1;
;;;337    								out=100;
;;;338    								ah_cnt0=0;
;;;339    								ah_cnt1=0;
;;;340    								
;;;341    			{					
;;;342    			signed temp_temp;
;;;343    			char temp;
;;;344    			temp_temp=ubat_old[0,((ubat_old_cnt+6)&0x07)]; 
;;;345    		    
;;;346    			temp=_year;
;;;347    			gran_char(&temp,1,99);
;;;348    			*((char*)(&(ke_date[0][0])))=temp;
;;;349    			
;;;350    			temp=_month;
;;;351    			gran_char(&temp,1,12);
;;;352    			*(((char*)(&(ke_date[0][0])))+1)=temp;
;;;353    			
;;;354    			temp=_date;
;;;355    			gran_char(&temp,1,31);
;;;356    			*(((char*)(&(ke_date[0][0])))+2)=temp;			
;;;357    				
;;;358    			*(((char*)(&(ke_date[0][0])))+3)=*((char*)&temp_temp);
;;;359    
;;;360    			temp=_hour;
;;;361    			gran_char(&temp,0,23);
;;;362    			*((char*)(&(ke_date[0][1])))=temp;
;;;363                   
;;;364    			temp=_min;
;;;365    			gran_char(&temp,0,59);
;;;366    			*(((char*)(&(ke_date[0][1])))+1)=temp;
;;;367    	          
;;;368    			temp=_sec;
;;;369    			gran_char(&temp,0,59);
;;;370    			*(((char*)(&(ke_date[0][1])))+2)=temp;
;;;371    			
;;;372    			*(((char*)(&(ke_date[0][1])))+3)=*(((char*)&temp_temp)+1);
;;;373    						
;;;374    			}					
;;;375    								
;;;376    								
;;;377    								}
;;;378    							else out=12;
;;;379    							}
;;;380    						else if(a_.av.bAB2)out=8;
;;;381    						else if(abs(Ibat[1])>=(2*K[Ibk]))
;;;382    							{
;;;383    							if(Ibat[1]>0)out=9;
;;;384    							else if(Ibat[1]<0)out=10;
;;;385    							}
;;;386    						else if(cnt_BAT2_izar<600)out=11;
;;;387    								
;;;388    						}
;;;389    					else out=7;	
;;;390    					}
;;;391    				else 
;;;392    					{
;;;393    					if(Ibat[0]>0)out=5;
;;;394    					else if(Ibat[0]<0)out=6;
;;;395    					}	
;;;396    				}
;;;397    			else
;;;398    				{
;;;399    				out=4;
;;;400    				}	
;;;401    			}               
;;;402    		else
;;;403    			{
;;;404    			out=3;
;;;405    			}	
;;;406    		}   
;;;407    	else 
;;;408    		{
;;;409    		if(spc_stat==spc_VZ) out=1;
;;;410    		else if((spc_stat==spc_KE2p1)||(spc_stat==spc_KE2p2)) out=2;		
;;;411    		}	
;;;412    	} 
;;;413    else if(in==1)
;;;414    	{
;;;415    	if(spc_stat==spc_OFF)
;;;416    		{ 
;;;417    		if(lc640_read(BAT2_STAT)==ON)
;;;418    			{
;;;419    			if(!a_.av.bAB2)
;;;420    				{
;;;421    				if(abs(Ibat[1])<=(2*K[Ibk]))
;;;422    					{
;;;423    					if(cnt_BAT2_izar>=600)
;;;424    						{
;;;425    						if((lc640_read(BAT1_STAT)==OFF)||((cnt_BAT1_izar>=600)&&(!a_.av.bAB1)))
;;;426    							{
;;;427    							if(!a_.av.bAN)
;;;428    								{       
;;;429    								spc_stat=spc_KE2p1;
;;;430    								out=100;
;;;431    								ah_cnt0=0;
;;;432    								ah_cnt1=0;
;;;433    								
;;;434    								
;;;435    			{					
;;;436    			signed temp_temp;
;;;437    			char temp;
;;;438    			temp_temp=ubat_old[1,((ubat_old_cnt+6)&0x07)]; 
;;;439    		    
;;;440    			temp=_year;
;;;441    			gran_char(&temp,1,99);
;;;442    			*((char*)(&(ke_date[1][0])))=temp;
;;;443    			
;;;444    			temp=_month;
;;;445    			gran_char(&temp,1,12);
;;;446    			*(((char*)(&(ke_date[1][0])))+1)=temp;
;;;447    			
;;;448    			temp=_date;
;;;449    			gran_char(&temp,1,31);
;;;450    			*(((char*)(&(ke_date[1][0])))+2)=temp;			
;;;451    				
;;;452    			*(((char*)(&(ke_date[1][0])))+3)=*((char*)&temp_temp);
;;;453    
;;;454    			temp=_hour;
;;;455    			gran_char(&temp,0,23);
;;;456    			*((char*)(&(ke_date[1][1])))=temp;
;;;457                   
;;;458    			temp=_min;
;;;459    			gran_char(&temp,0,59);
;;;460    			*(((char*)(&(ke_date[1][1])))+1)=temp;
;;;461    	          
;;;462    			temp=_sec;
;;;463    			gran_char(&temp,0,59);
;;;464    			*(((char*)(&(ke_date[1][1])))+2)=temp;
;;;465    			
;;;466    			*(((char*)(&(ke_date[1][1])))+3)=*(((char*)&temp_temp)+1);
;;;467    						
;;;468    			}					
;;;469    								
;;;470    								}
;;;471    							else out=12;
;;;472    							}
;;;473    						else if(a_.av.bAB1)out=8;
;;;474    						else if(abs(Ibat[0])>=(2*K[Ibk]))
;;;475    							{
;;;476    							if(Ibat[0]>0)out=9;
;;;477    							else if(Ibat[0]<0)out=10;
;;;478    							}
;;;479    						else if(cnt_BAT1_izar<600)out=11;
;;;480    								
;;;481    						}
;;;482    					else out=7;	
;;;483    					}
;;;484    				else 
;;;485    					{
;;;486    					if(Ibat[1]>0)out=5;
;;;487    					else if(Ibat[1]<0)out=6;
;;;488    					}	
;;;489    				}
;;;490    			else
;;;491    				{
;;;492    				out=4;
;;;493    				}	
;;;494    			}               
;;;495    		else
;;;496    			{
;;;497    			out=3;
;;;498    			}	
;;;499    		}   
;;;500    	else 
;;;501    		{
;;;502    		if(spc_stat==spc_VZ) out=1;
;;;503    		else if((spc_stat==spc_KE1p1)||(spc_stat==spc_KE1p2)) out=2;		
;;;504    		}
;;;505    	}	
;;;506    //plazma=out;
;;;507    */
;;;508    return out;
;;;509    }
000004  e12fff1e          BX       lr
;;;510    
                          ENDP

                  vz_start PROC
;;;638    //-----------------------------------------------
;;;639    char vz_start(char hour)
000008  e59f1f9c          LDR      r1,|L1.4012|
;;;640    {          
00000c  e1a02000          MOV      r2,r0
;;;641    char out;
;;;642    out=0;
;;;643    if(spc_stat==spcOFF)
000010  e5d13013          LDRB     r3,[r1,#0x13]  ; spc_stat
000014  e3a00000          MOV      r0,#0                 ;642
000018  e3530000          CMP      r3,#0
;;;644    	{
;;;645    	spc_stat=spcVZ;  
;;;646    	vz_cnt_h=hour;
;;;647    	vz_cnt_h_=0;
;;;648    	vz_cnt_s=0;
;;;649    	out=1;
;;;650    	//vz_mem_hndl(1);
;;;651    	}
;;;652    //else if((spc_stat==spc_KE1p1)||(spc_stat==spc_KE1p2)) out=22; 
;;;653    //else if((spc_stat==spc_KE2p1)||(spc_stat==spc_KE2p2)) out=33;
;;;654    //plazma=out;	
;;;655    return out;
;;;656    }
00001c  112fff1e          BXNE     lr
000020  e3a00002          MOV      r0,#2                 ;645
000024  e5c10013          STRB     r0,[r1,#0x13]         ;645  ; spc_stat
000028  e3a00000          MOV      r0,#0                 ;647
00002c  e1c124bc          STRH     r2,[r1,#0x4c]         ;646  ; vz_cnt_h
000030  e1c104be          STRH     r0,[r1,#0x4e]         ;647  ; vz_cnt_h_
000034  e1c104ba          STRH     r0,[r1,#0x4a]         ;648  ; vz_cnt_s
000038  e3a00001          MOV      r0,#1                 ;649
00003c  e12fff1e          BX       lr
;;;657    
                          ENDP

                  vz_stop PROC
;;;658    //-----------------------------------------------
;;;659    char vz_stop(void)
000040  e59f1f64          LDR      r1,|L1.4012|
;;;660    {          
;;;661    vz_cnt_s=0;
000044  e3a00000          MOV      r0,#0
000048  e1c104ba          STRH     r0,[r1,#0x4a]  ; vz_cnt_s
;;;662    vz_cnt_h=0;
00004c  e1c104bc          STRH     r0,[r1,#0x4c]  ; vz_cnt_h
;;;663    vz_cnt_h_=0;
000050  e1c104be          STRH     r0,[r1,#0x4e]  ; vz_cnt_h_
;;;664    spc_stat=spcOFF;
000054  e5c10013          STRB     r0,[r1,#0x13]  ; spc_stat
;;;665    }
000058  e12fff1e          BX       lr
;;;666    
                          ENDP

                  avz_next_date_hndl PROC
;;;667    //-----------------------------------------------
;;;668    void avz_next_date_hndl(void)
00005c  e92d4070          PUSH     {r4-r6,lr}
;;;669    {
;;;670    if((month__+AVZ)>12)lc640_write_int(EE_YEAR_AVZ,year__+1);
000060  e59f4f48          LDR      r4,|L1.4016|
000064  e59f5f48          LDR      r5,|L1.4020|
000068  e1d410d0          LDRSB    r1,[r4,#0]  ; month__
00006c  e5d52000          LDRB     r2,[r5,#0]  ; AVZ
000070  e59f0f40          LDR      r0,|L1.4024|
000074  e0822001          ADD      r2,r2,r1
000078  e1d010d0          LDRSB    r1,[r0,#0]
00007c  e352000c          CMP      r2,#0xc
;;;671    else lc640_write_int(EE_YEAR_AVZ,year__);
000080  e3a000b8          MOV      r0,#0xb8
000084  c2811001          ADDGT    r1,r1,#1              ;670
000088  ebfffffe          BL       lc640_write_int
;;;672    
;;;673    //lc640_write_int(EE_YEAR_AVZ,6);
;;;674    
;;;675    if((month__+AVZ)>12)lc640_write_int(EE_MONTH_AVZ,(month__+AVZ)-12);
00008c  e1d400d0          LDRSB    r0,[r4,#0]  ; month__
000090  e5d51000          LDRB     r1,[r5,#0]  ; AVZ
000094  e0811000          ADD      r1,r1,r0
000098  e351000c          CMP      r1,#0xc
00009c  c241100c          SUBGT    r1,r1,#0xc
;;;676    else lc640_write_int(EE_MONTH_AVZ,month__+AVZ);                                                 
0000a0  e3a000b6          MOV      r0,#0xb6
0000a4  ebfffffe          BL       lc640_write_int
;;;677    
;;;678    //lc640_write_int(EE_MONTH_AVZ,5);
;;;679    
;;;680    if(day__>28) lc640_write_int(EE_DATE_AVZ,28);
0000a8  e59f0f0c          LDR      r0,|L1.4028|
0000ac  e1d010d0          LDRSB    r1,[r0,#0]  ; day__
;;;681    else lc640_write_int(EE_DATE_AVZ,day__);
0000b0  e3a000b4          MOV      r0,#0xb4
0000b4  e351001c          CMP      r1,#0x1c              ;680
0000b8  c3a0101c          MOVGT    r1,#0x1c              ;680
0000bc  ebfffffe          BL       lc640_write_int
;;;682    
;;;683    //lc640_write_int(EE_DATE_AVZ,4);
;;;684    
;;;685    lc640_write_int(EE_HOUR_AVZ,hour__);
0000c0  e59f0ef8          LDR      r0,|L1.4032|
0000c4  e1d010d0          LDRSB    r1,[r0,#0]  ; hour__
0000c8  e3a000ae          MOV      r0,#0xae
0000cc  ebfffffe          BL       lc640_write_int
;;;686    lc640_write_int(EE_MIN_AVZ,min__);
0000d0  e59f0eec          LDR      r0,|L1.4036|
0000d4  e1d010d0          LDRSB    r1,[r0,#0]  ; min__
0000d8  e3a000b0          MOV      r0,#0xb0
0000dc  ebfffffe          BL       lc640_write_int
;;;687    lc640_write_int(EE_SEC_AVZ,sec__);
0000e0  e59f0ee0          LDR      r0,|L1.4040|
0000e4  e1d010d0          LDRSB    r1,[r0,#0]  ; sec__
0000e8  e8bd4070          POP      {r4-r6,lr}
0000ec  e3a000b2          MOV      r0,#0xb2
0000f0  eafffffe          B        lc640_write_int
;;;688    
;;;689    }
;;;690    
                          ENDP

                  avz_drv PROC
;;;691    //-----------------------------------------------
;;;692    void avz_drv(void)                               
0000f4  e59f0eb8          LDR      r0,|L1.4020|
;;;693    {                
0000f8  e92d4010          PUSH     {r4,lr}
;;;694    if(AVZ!=AVZ_OFF)
0000fc  e5d00000          LDRB     r0,[r0,#0]  ; AVZ
;;;695    	{
;;;696    	if((year__==YEAR_AVZ)&&(month__==MONTH_AVZ)&&(day__==DATE_AVZ)&&(hour__==HOUR_AVZ)&&(min__==MIN_AVZ)&&(sec__==SEC_AVZ))
;;;697    		{
;;;698    		bAVZ=1;
000100  e59fcea4          LDR      r12,|L1.4012|
000104  e3500000          CMP      r0,#0                 ;694
000108  0a000021          BEQ      |L1.404|
00010c  e59f0ea4          LDR      r0,|L1.4024|
000110  e59f1eb4          LDR      r1,|L1.4044|
000114  e1d000d0          LDRSB    r0,[r0,#0]            ;696  ; year__
000118  e1d110b0          LDRH     r1,[r1,#0]            ;696  ; YEAR_AVZ
00011c  e1500001          CMP      r0,r1                 ;696
000120  059f0e88          LDREQ    r0,|L1.4016|
000124  059f1ea4          LDREQ    r1,|L1.4048|
000128  01d000d0          LDRSBEQ  r0,[r0,#0]            ;696  ; month__
00012c  01d110b0          LDRHEQ   r1,[r1,#0]            ;696  ; MONTH_AVZ
000130  01500001          CMPEQ    r0,r1                 ;696
000134  059f0e80          LDREQ    r0,|L1.4028|
000138  059f1e94          LDREQ    r1,|L1.4052|
00013c  01d000d0          LDRSBEQ  r0,[r0,#0]            ;696  ; day__
000140  01d110b0          LDRHEQ   r1,[r1,#0]            ;696  ; DATE_AVZ
000144  01500001          CMPEQ    r0,r1                 ;696
000148  1a000011          BNE      |L1.404|
00014c  e59f0e6c          LDR      r0,|L1.4032|
000150  e59f1e80          LDR      r1,|L1.4056|
000154  e1d000d0          LDRSB    r0,[r0,#0]            ;696  ; hour__
000158  e1d110b0          LDRH     r1,[r1,#0]            ;696  ; HOUR_AVZ
00015c  e1500001          CMP      r0,r1                 ;696
000160  059f0e5c          LDREQ    r0,|L1.4036|
000164  059f1e70          LDREQ    r1,|L1.4060|
000168  01d000d0          LDRSBEQ  r0,[r0,#0]            ;696  ; min__
00016c  01d110b0          LDRHEQ   r1,[r1,#0]            ;696  ; MIN_AVZ
000170  01500001          CMPEQ    r0,r1                 ;696
000174  059f0e4c          LDREQ    r0,|L1.4040|
000178  059f1e60          LDREQ    r1,|L1.4064|
00017c  01d000d0          LDRSBEQ  r0,[r0,#0]            ;696  ; sec__
000180  01d110b0          LDRHEQ   r1,[r1,#0]            ;696  ; SEC_AVZ
000184  01500001          CMPEQ    r0,r1                 ;696
000188  03a00001          MOVEQ    r0,#1
00018c  05cc0014          STRBEQ   r0,[r12,#0x14]  ; bAVZ
000190  0a000002          BEQ      |L1.416|
                  |L1.404|
;;;699    		}
;;;700    	}
;;;701    if(bAVZ)
000194  e5dc0014          LDRB     r0,[r12,#0x14]  ; bAVZ
000198  e3500000          CMP      r0,#0
00019c  0a000009          BEQ      |L1.456|
                  |L1.416|
;;;702    	{
;;;703    	if(vz_start(AVZ_TIME))
0001a0  e59f0e3c          LDR      r0,|L1.4068|
0001a4  e1d000b0          LDRH     r0,[r0,#0]  ; AVZ_TIME
0001a8  e20000ff          AND      r0,r0,#0xff
0001ac  ebfffffe          BL       vz_start
0001b0  e3500000          CMP      r0,#0
0001b4  0a000003          BEQ      |L1.456|
;;;704    		{
;;;705    		bAVZ=0;
0001b8  e3a00000          MOV      r0,#0
0001bc  e5cc0014          STRB     r0,[r12,#0x14]  ; bAVZ
;;;706    		avz_next_date_hndl();
0001c0  e8bd4010          POP      {r4,lr}
0001c4  eafffffe          B        avz_next_date_hndl
                  |L1.456|
;;;707    		}
;;;708    	}	
;;;709    
;;;710    }
0001c8  e8bd4010          POP      {r4,lr}
0001cc  e12fff1e          BX       lr
;;;711    
                          ENDP

                  vz_drv PROC
;;;712    //-----------------------------------------------
;;;713    void vz_drv(void)
0001d0  e59f1dd4          LDR      r1,|L1.4012|
;;;714    { 
;;;715    if(spc_stat==spcVZ)
0001d4  e5d10013          LDRB     r0,[r1,#0x13]  ; spc_stat
0001d8  e3500002          CMP      r0,#2
;;;716    	{
;;;717    	if(vz_cnt_s<3600)
;;;718    		{
;;;719    		vz_cnt_s++;
;;;720    		if(vz_cnt_s>=3600)
;;;721    			{
;;;722    			vz_cnt_s=0;
;;;723    			if(vz_cnt_h)
;;;724    				{
;;;725    				vz_cnt_h--;
;;;726    				vz_cnt_h_++;
;;;727    				if(vz_cnt_h==0)
;;;728    					{
;;;729    					spc_stat=spcOFF;
;;;730    			    		//vz_mem_hndl(0);
;;;731    					}
;;;732    				}
;;;733    			}
;;;734    		}
;;;735    	}
;;;736    } 
0001dc  112fff1e          BXNE     lr
0001e0  e1d104ba          LDRH     r0,[r1,#0x4a]         ;717  ; vz_cnt_s
0001e4  e3500ee1          CMP      r0,#0xe10             ;717
0001e8  212fff1e          BXCS     lr
0001ec  e2800001          ADD      r0,r0,#1              ;719
0001f0  e1c104ba          STRH     r0,[r1,#0x4a]         ;719  ; vz_cnt_s
0001f4  e1d104ba          LDRH     r0,[r1,#0x4a]         ;720  ; vz_cnt_s
0001f8  e3500ee1          CMP      r0,#0xe10             ;720
0001fc  312fff1e          BXCC     lr
000200  e3a02000          MOV      r2,#0                 ;722
000204  e1c124ba          STRH     r2,[r1,#0x4a]         ;722  ; vz_cnt_s
000208  e1d104bc          LDRH     r0,[r1,#0x4c]         ;723  ; vz_cnt_h
00020c  e3500000          CMP      r0,#0                 ;723
000210  012fff1e          BXEQ     lr
000214  e2400001          SUB      r0,r0,#1              ;725
000218  e1a00800          LSL      r0,r0,#16             ;725
00021c  e1b00820          LSRS     r0,r0,#16             ;725
000220  e1c104bc          STRH     r0,[r1,#0x4c]         ;725  ; vz_cnt_h
000224  e1d134be          LDRH     r3,[r1,#0x4e]         ;726  ; vz_cnt_h_
000228  e2833001          ADD      r3,r3,#1              ;726
00022c  e1c134be          STRH     r3,[r1,#0x4e]         ;726  ; vz_cnt_h_
000230  05c12013          STRBEQ   r2,[r1,#0x13]         ;729  ; spc_stat
000234  e12fff1e          BX       lr
;;;737    
                          ENDP

                  kb_init PROC
;;;741    //-----------------------------------------------
;;;742    void kb_init(void)
000238  e59f0da8          LDR      r0,|L1.4072|
;;;743    {
;;;744    main_kb_cnt=(TBAT*60)-60/*120*/;
00023c  e3e0103b          MVN      r1,#0x3b
000240  e1d000b0          LDRH     r0,[r0,#0]  ; TBAT
000244  e0600200          RSB      r0,r0,r0,LSL #4
000248  e0810100          ADD      r0,r1,r0,LSL #2
00024c  e59f1d58          LDR      r1,|L1.4012|
000250  e1c103be          STRH     r0,[r1,#0x3e]  ; main_kb_cnt
;;;745    }
000254  e12fff1e          BX       lr
;;;746    
                          ENDP

                  kb_hndl PROC
;;;747    //-----------------------------------------------
;;;748    void kb_hndl(void)
000258  e92d5ff0          PUSH     {r4-r12,lr}
;;;749    {
;;;750    
;;;751    static signed short ibat[2],ibat_[2];
;;;752    
;;;753    if(++main_kb_cnt>=TBAT*60)
00025c  e59f9d48          LDR      r9,|L1.4012|
000260  e59f1d80          LDR      r1,|L1.4072|
000264  e1d903be          LDRH     r0,[r9,#0x3e]  ; main_kb_cnt
;;;754    	{
;;;755    	main_kb_cnt=0;
;;;756    	
;;;757    	kb_start[0]=0;
;;;758    	kb_start[1]=0;
;;;759    
;;;760    	if( (BAT_IS_ON[0]==bisON) && (bat[0]._Ub>80) && ( (abs(bat[0]._Ib<IKB)) || (bat[0]._av) ) ) kb_start[0]=1;
000268  e59f5d7c          LDR      r5,|L1.4076|
00026c  e59f7d7c          LDR      r7,|L1.4080|
000270  e2800001          ADD      r0,r0,#1              ;753
000274  e1a00800          LSL      r0,r0,#16             ;753
000278  e1a00840          ASR      r0,r0,#16             ;753
00027c  e1c903be          STRH     r0,[r9,#0x3e]         ;753  ; main_kb_cnt
000280  e1d110f0          LDRSH    r1,[r1,#0]            ;753  ; TBAT
;;;761    	if( (BAT_IS_ON[1]==bisON) && (bat[1]._Ub>80) && ( (abs(bat[1]._Ib<IKB)) || (bat[1]._av) ) ) kb_start[1]=1;
;;;762    	
;;;763    	if( (net_av) || (num_of_wrks_bps==0) || ( (spc_stat!=spcOFF) && (spc_stat!=spcVZ) ) ) 
;;;764    		{
;;;765    		kb_start[0]=0;
;;;766    		kb_start[1]=0;
;;;767    		}
;;;768    
;;;769    	if((kb_start[0]==1)||(kb_start[1]==1))
;;;770    		{
;;;771    		kb_cnt_1lev=10;
000284  e3a0a00a          MOV      r10,#0xa
000288  e3a08001          MOV      r8,#1                 ;760
00028c  e0611201          RSB      r1,r1,r1,LSL #4       ;753
000290  e1500101          CMP      r0,r1,LSL #2          ;753
000294  e3a06000          MOV      r6,#0                 ;755
000298  e2894044          ADD      r4,r9,#0x44           ;757
00029c  ba000037          BLT      |L1.896|
0002a0  e1c963be          STRH     r6,[r9,#0x3e]         ;755  ; main_kb_cnt
0002a4  e59fbd48          LDR      r11,|L1.4084|
0002a8  e5c46000          STRB     r6,[r4,#0]            ;757  ; kb_start
0002ac  e5c46001          STRB     r6,[r4,#1]            ;758  ; kb_start
0002b0  e5db0000          LDRB     r0,[r11,#0]           ;760  ; BAT_IS_ON
0002b4  e3500055          CMP      r0,#0x55              ;760
0002b8  1a00000c          BNE      |L1.752|
0002bc  e1d500f2          LDRSH    r0,[r5,#2]            ;760  ; bat
0002c0  e3500050          CMP      r0,#0x50              ;760
0002c4  da000009          BLE      |L1.752|
0002c8  e1d500f4          LDRSH    r0,[r5,#4]            ;760  ; bat
0002cc  e1d710f0          LDRSH    r1,[r7,#0]            ;760  ; IKB
0002d0  e1500001          CMP      r0,r1                 ;760
0002d4  a3a00000          MOVGE    r0,#0                 ;760
0002d8  b3a00001          MOVLT    r0,#1                 ;760
0002dc  ebfffffe          BL       abs
0002e0  e3500000          CMP      r0,#0                 ;760
0002e4  05d50035          LDRBEQ   r0,[r5,#0x35]         ;760  ; bat
0002e8  03500000          CMPEQ    r0,#0                 ;760
0002ec  15c48000          STRBNE   r8,[r4,#0]            ;760  ; kb_start
                  |L1.752|
0002f0  e5db0001          LDRB     r0,[r11,#1]           ;761  ; BAT_IS_ON
0002f4  e3500055          CMP      r0,#0x55              ;761
0002f8  1a00000c          BNE      |L1.816|
0002fc  e1d503fe          LDRSH    r0,[r5,#0x3e]         ;761  ; bat
000300  e3500050          CMP      r0,#0x50              ;761
000304  da000009          BLE      |L1.816|
000308  e1d504f0          LDRSH    r0,[r5,#0x40]         ;761  ; bat
00030c  e1d710f0          LDRSH    r1,[r7,#0]            ;761  ; IKB
000310  e1500001          CMP      r0,r1                 ;761
000314  a3a00000          MOVGE    r0,#0                 ;761
000318  b3a00001          MOVLT    r0,#1                 ;761
00031c  ebfffffe          BL       abs
000320  e3500000          CMP      r0,#0                 ;761
000324  05d50071          LDRBEQ   r0,[r5,#0x71]         ;761  ; bat
000328  03500000          CMPEQ    r0,#0                 ;761
00032c  15c48001          STRBNE   r8,[r4,#1]            ;761  ; kb_start
                  |L1.816|
000330  e5d90016          LDRB     r0,[r9,#0x16]         ;763  ; net_av
000334  e3500000          CMP      r0,#0                 ;763
000338  1a000006          BNE      |L1.856|
00033c  e5d90012          LDRB     r0,[r9,#0x12]         ;763  ; num_of_wrks_bps
000340  e3500000          CMP      r0,#0                 ;763
000344  0a000003          BEQ      |L1.856|
000348  e5d90013          LDRB     r0,[r9,#0x13]         ;763  ; spc_stat
00034c  e3500000          CMP      r0,#0                 ;763
000350  13500002          CMPNE    r0,#2                 ;763
000354  0a000002          BEQ      |L1.868|
                  |L1.856|
000358  e5c46000          STRB     r6,[r4,#0]            ;765  ; kb_start
00035c  e5c46001          STRB     r6,[r4,#1]            ;766  ; kb_start
000360  ea000005          B        |L1.892|
                  |L1.868|
000364  e5d40000          LDRB     r0,[r4,#0]            ;769  ; kb_start
000368  e3500001          CMP      r0,#1                 ;769
00036c  15d40001          LDRBNE   r0,[r4,#1]            ;769  ; kb_start
000370  13500001          CMPNE    r0,#1                 ;769
000374  01c9a4b0          STRHEQ   r10,[r9,#0x40]  ; kb_cnt_1lev
000378  0a000000          BEQ      |L1.896|
                  |L1.892|
;;;772    		}
;;;773    	else kb_cnt_1lev=0;
00037c  e1c964b0          STRH     r6,[r9,#0x40]  ; kb_cnt_1lev
                  |L1.896|
;;;774    	}
;;;775    
;;;776    if(kb_cnt_1lev)
000380  e1d904f0          LDRSH    r0,[r9,#0x40]  ; kb_cnt_1lev
;;;777    	{
;;;778    	kb_cnt_1lev--;
;;;779    
;;;780    	if(kb_cnt_1lev>5)mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_PLUS,30,15);
;;;781    	else if(kb_cnt_1lev>0) mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_MINUS,30,15);
;;;782    
;;;783    
;;;784    	if(kb_cnt_1lev==5)
;;;785    		{
;;;786    		ibat[0]=abs(bat[0]._Ib);
000384  e59fbc6c          LDR      r11,|L1.4088|
000388  e3500000          CMP      r0,#0                 ;776
00038c  0a000038          BEQ      |L1.1140|
000390  e2400001          SUB      r0,r0,#1              ;778
000394  e1a00800          LSL      r0,r0,#16             ;778
000398  e1a00840          ASR      r0,r0,#16             ;778
00039c  e3500005          CMP      r0,#5                 ;780
0003a0  c3a0300f          MOVGT    r3,#0xf               ;780
0003a4  c3a0201e          MOVGT    r2,#0x1e              ;780
0003a8  c3a01064          MOVGT    r1,#0x64              ;780
0003ac  e1c904b0          STRH     r0,[r9,#0x40]         ;778  ; kb_cnt_1lev
0003b0  ca000004          BGT      |L1.968|
0003b4  e3500000          CMP      r0,#0                 ;781
0003b8  da00000d          BLE      |L1.1012|
0003bc  e3a0300f          MOV      r3,#0xf               ;781
0003c0  e3a0201e          MOV      r2,#0x1e              ;781
0003c4  e3a01069          MOV      r1,#0x69              ;781
                  |L1.968|
0003c8  e3a000e1          MOV      r0,#0xe1              ;781
0003cc  ebfffffe          BL       mess_send
0003d0  e1d904b0          LDRH     r0,[r9,#0x40]         ;784  ; kb_cnt_1lev
0003d4  e3500005          CMP      r0,#5                 ;784
0003d8  1a000005          BNE      |L1.1012|
0003dc  e1d500f4          LDRSH    r0,[r5,#4]  ; bat
0003e0  ebfffffe          BL       abs
0003e4  e1cb00b0          STRH     r0,[r11,#0]  ; ibat
;;;787    		ibat[1]=abs(bat[1]._Ib);
0003e8  e1d504f0          LDRSH    r0,[r5,#0x40]  ; bat
0003ec  ebfffffe          BL       abs
0003f0  e1cb00b2          STRH     r0,[r11,#2]  ; ibat
                  |L1.1012|
;;;788    		}
;;;789    	
;;;790    	if(kb_cnt_1lev==0)
0003f4  e1d904b0          LDRH     r0,[r9,#0x40]  ; kb_cnt_1lev
0003f8  e3500000          CMP      r0,#0
0003fc  1a000055          BNE      |L1.1368|
;;;791    		{
;;;792    		ibat_[0]=abs(bat[0]._Ib);
000400  e1d500f4          LDRSH    r0,[r5,#4]  ; bat
000404  ebfffffe          BL       abs
000408  e59f8bec          LDR      r8,|L1.4092|
00040c  e1c800b0          STRH     r0,[r8,#0]  ; ibat_
;;;793    		ibat_[1]=abs(bat[1]._Ib);
000410  e1d504f0          LDRSH    r0,[r5,#0x40]  ; bat
000414  ebfffffe          BL       abs
000418  e1c800b2          STRH     r0,[r8,#2]  ; ibat_
;;;794    
;;;795    		kb_cnt_2lev=0;
00041c  e1c964b2          STRH     r6,[r9,#0x42]  ; kb_cnt_2lev
;;;796    		if( (ibat[0]+ibat_[0]) < IKB ) 
000420  e1db00f0          LDRSH    r0,[r11,#0]  ; ibat
000424  e1d810f0          LDRSH    r1,[r8,#0]  ; ibat_
000428  e0800001          ADD      r0,r0,r1
00042c  e1d710f0          LDRSH    r1,[r7,#0]  ; IKB
000430  e1500001          CMP      r0,r1
;;;797    			{
;;;798    			kb_cnt_2lev=10;  
000434  b1c9a4b2          STRHLT   r10,[r9,#0x42]  ; kb_cnt_2lev
000438  ba000003          BLT      |L1.1100|
;;;799    			}
;;;800    		else 
;;;801    			{
;;;802    			kb_start[0]=0;
;;;803    			avar_bat_hndl(0,0);
00043c  e3a01000          MOV      r1,#0
000440  e1a00001          MOV      r0,r1
000444  e5c46000          STRB     r6,[r4,#0]            ;802  ; kb_start
000448  ebfffffe          BL       avar_bat_hndl
                  |L1.1100|
;;;804    			}
;;;805    		
;;;806    		if( (ibat[1]+ibat_[1]) < IKB )
00044c  e1db00f2          LDRSH    r0,[r11,#2]  ; ibat
000450  e1d810f2          LDRSH    r1,[r8,#2]  ; ibat_
000454  e1d720f0          LDRSH    r2,[r7,#0]  ; IKB
000458  e0800001          ADD      r0,r0,r1
00045c  e1500002          CMP      r0,r2
;;;807    			{
;;;808    			kb_cnt_2lev=10;     
000460  b1c9a4b2          STRHLT   r10,[r9,#0x42]  ; kb_cnt_2lev
000464  ba00003b          BLT      |L1.1368|
                  |L1.1128|
;;;809    			}
;;;810    		else 
;;;811    			{
;;;812    			kb_start[1]=0;
;;;813    			avar_bat_hndl(1,0);
000468  e3a01000          MOV      r1,#0
00046c  e5c46001          STRB     r6,[r4,#1]            ;812  ; kb_start
000470  ea000069          B        |L1.1564|
                  |L1.1140|
;;;814    			}
;;;815    		}	
;;;816    
;;;817    
;;;818    	}
;;;819    else if(kb_cnt_2lev)
000474  e1d904f2          LDRSH    r0,[r9,#0x42]  ; kb_cnt_2lev
000478  e3500000          CMP      r0,#0
00047c  0a000037          BEQ      |L1.1376|
;;;820    	{
;;;821    	kb_cnt_2lev--;
000480  e2400001          SUB      r0,r0,#1
000484  e1a00800          LSL      r0,r0,#16
000488  e1a00840          ASR      r0,r0,#16
;;;822    
;;;823    	if(kb_cnt_2lev>5)mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_PLUS,200,15);
00048c  e3500005          CMP      r0,#5
000490  c3a0300f          MOVGT    r3,#0xf
000494  c3a020c8          MOVGT    r2,#0xc8
000498  c3a01064          MOVGT    r1,#0x64
00049c  e1c904b2          STRH     r0,[r9,#0x42]         ;821  ; kb_cnt_2lev
0004a0  ca000004          BGT      |L1.1208|
;;;824    	else if(kb_cnt_2lev>0) mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_MINUS,200,15);
0004a4  e3500000          CMP      r0,#0
0004a8  da00000d          BLE      |L1.1252|
0004ac  e3a0300f          MOV      r3,#0xf
0004b0  e3a020c8          MOV      r2,#0xc8
0004b4  e3a01069          MOV      r1,#0x69
                  |L1.1208|
0004b8  e3a000e1          MOV      r0,#0xe1
0004bc  ebfffffe          BL       mess_send
;;;825    
;;;826    
;;;827    	if(kb_cnt_2lev==5)
0004c0  e1d904b2          LDRH     r0,[r9,#0x42]  ; kb_cnt_2lev
0004c4  e3500005          CMP      r0,#5
0004c8  1a000005          BNE      |L1.1252|
;;;828    		{
;;;829    		ibat[0]=abs(bat[0]._Ib);
0004cc  e1d500f4          LDRSH    r0,[r5,#4]  ; bat
0004d0  ebfffffe          BL       abs
0004d4  e1cb00b0          STRH     r0,[r11,#0]  ; ibat
;;;830    		ibat[1]=abs(bat[1]._Ib);
0004d8  e1d504f0          LDRSH    r0,[r5,#0x40]  ; bat
0004dc  ebfffffe          BL       abs
0004e0  e1cb00b2          STRH     r0,[r11,#2]  ; ibat
                  |L1.1252|
;;;831    		}
;;;832    	
;;;833    	if(kb_cnt_2lev==0)
0004e4  e1d904b2          LDRH     r0,[r9,#0x42]  ; kb_cnt_2lev
0004e8  e3500000          CMP      r0,#0
0004ec  1a000019          BNE      |L1.1368|
;;;834    		{
;;;835    		ibat_[0]=abs(bat[0]._Ib);
0004f0  e1d500f4          LDRSH    r0,[r5,#4]  ; bat
0004f4  ebfffffe          BL       abs
0004f8  e59faafc          LDR      r10,|L1.4092|
0004fc  e1ca00b0          STRH     r0,[r10,#0]  ; ibat_
;;;836    		ibat_[1]=abs(bat[1]._Ib);
000500  e1d504f0          LDRSH    r0,[r5,#0x40]  ; bat
000504  ebfffffe          BL       abs
000508  e1ca00b2          STRH     r0,[r10,#2]  ; ibat_
;;;837    
;;;838    		kb_full_ver=0;
00050c  e5c96011          STRB     r6,[r9,#0x11]  ; kb_full_ver
;;;839    
;;;840    		if( (ibat[0]+ibat_[0]) < IKB ) 
000510  e1db00f0          LDRSH    r0,[r11,#0]  ; ibat
000514  e1da10f0          LDRSH    r1,[r10,#0]  ; ibat_
000518  e0800001          ADD      r0,r0,r1
00051c  e1d710f0          LDRSH    r1,[r7,#0]  ; IKB
000520  e1500001          CMP      r0,r1
;;;841    			{
;;;842    			kb_full_ver=1;  
000524  b5c98011          STRBLT   r8,[r9,#0x11]  ; kb_full_ver
000528  ba000003          BLT      |L1.1340|
;;;843    			}
;;;844    		else 			
;;;845    			{
;;;846    			kb_start[0]=0;
;;;847    			avar_bat_hndl(0,0);
00052c  e3a01000          MOV      r1,#0
000530  e1a00001          MOV      r0,r1
000534  e5c46000          STRB     r6,[r4,#0]            ;846  ; kb_start
000538  ebfffffe          BL       avar_bat_hndl
                  |L1.1340|
;;;848    			}
;;;849    
;;;850    		if( (ibat[1]+ibat_[1]) < IKB )
00053c  e1db00f2          LDRSH    r0,[r11,#2]  ; ibat
000540  e1da10f2          LDRSH    r1,[r10,#2]  ; ibat_
000544  e1d720f0          LDRSH    r2,[r7,#0]  ; IKB
000548  e0800001          ADD      r0,r0,r1
00054c  e1500002          CMP      r0,r2
000550  aaffffc4          BGE      |L1.1128|
;;;851    			{
;;;852    			kb_full_ver=1;     
000554  e5c98011          STRB     r8,[r9,#0x11]  ; kb_full_ver
                  |L1.1368|
;;;853    			}
;;;854    		else			
;;;855    			{
;;;856    			kb_start[1]=0;
;;;857    			avar_bat_hndl(1,0);
;;;858    			}
;;;859    
;;;860    
;;;861    		}	
;;;862    	}
;;;863    
;;;864    else if(kb_full_ver)
;;;865    	{
;;;866    	
;;;867    	mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_STEP_DOWN,0,15);
;;;868    
;;;869    	if( abs(bat[0]._Ib) > IKB ) 
;;;870    		{
;;;871    		if(kb_start[0]==1)
;;;872    			{
;;;873    			kb_start[0]=0;
;;;874    			avar_bat_hndl(0,0);
;;;875    			}
;;;876    		}
;;;877    
;;;878    	if( abs(bat[1]._Ib) > IKB ) 
;;;879    		{
;;;880    		if(kb_start[1]==1)
;;;881    			{
;;;882    			kb_start[1]=0;
;;;883    			avar_bat_hndl(1,0);
;;;884    			}
;;;885    		}
;;;886    
;;;887    	if( (mess_find(MESS2KB_HNDL))	&& (mess_data[0]==PARAM_CNTRL_IS_DOWN) )
;;;888    		{
;;;889    		kb_full_ver=0;
;;;890    		if(kb_start[0]==1) avar_bat_hndl(0,1);
;;;891    		if(kb_start[1]==1) avar_bat_hndl(1,1);
;;;892    		}
;;;893    	}
;;;894    
;;;895    }
000558  e8bd5ff0          POP      {r4-r12,lr}
00055c  e12fff1e          BX       lr
                  |L1.1376|
000560  e5d90011          LDRB     r0,[r9,#0x11]         ;864  ; kb_full_ver
000564  e3500000          CMP      r0,#0                 ;864
000568  0afffffa          BEQ      |L1.1368|
00056c  e3a0300f          MOV      r3,#0xf               ;867
000570  e3a02000          MOV      r2,#0                 ;867
000574  e3a0106e          MOV      r1,#0x6e              ;867
000578  e3a000e1          MOV      r0,#0xe1              ;867
00057c  ebfffffe          BL       mess_send
000580  e1d500f4          LDRSH    r0,[r5,#4]            ;869  ; bat
000584  ebfffffe          BL       abs
000588  e1d710f0          LDRSH    r1,[r7,#0]            ;869  ; IKB
00058c  e1500001          CMP      r0,r1                 ;869
000590  da000005          BLE      |L1.1452|
000594  e5d40000          LDRB     r0,[r4,#0]            ;871  ; kb_start
000598  e3500001          CMP      r0,#1                 ;871
00059c  03a01000          MOVEQ    r1,#0                 ;874
0005a0  01a00001          MOVEQ    r0,r1                 ;874
0005a4  05c46000          STRBEQ   r6,[r4,#0]            ;873  ; kb_start
0005a8  0bfffffe          BLEQ     avar_bat_hndl
                  |L1.1452|
0005ac  e1d504f0          LDRSH    r0,[r5,#0x40]         ;878  ; bat
0005b0  ebfffffe          BL       abs
0005b4  e1d710f0          LDRSH    r1,[r7,#0]            ;878  ; IKB
0005b8  e1500001          CMP      r0,r1                 ;878
0005bc  da000004          BLE      |L1.1492|
0005c0  e5d40001          LDRB     r0,[r4,#1]            ;880  ; kb_start
0005c4  e3500001          CMP      r0,#1                 ;880
0005c8  03a01000          MOVEQ    r1,#0                 ;883
0005cc  05c46001          STRBEQ   r6,[r4,#1]            ;882  ; kb_start
0005d0  0bfffffe          BLEQ     avar_bat_hndl
                  |L1.1492|
0005d4  e3a000e6          MOV      r0,#0xe6              ;887
0005d8  ebfffffe          BL       mess_find
0005dc  e3500000          CMP      r0,#0                 ;887
0005e0  0affffdc          BEQ      |L1.1368|
0005e4  e59f0a14          LDR      r0,|L1.4096|
0005e8  e5900000          LDR      r0,[r0,#0]            ;887  ; mess_data
0005ec  e35000e7          CMP      r0,#0xe7              ;887
0005f0  1affffd8          BNE      |L1.1368|
0005f4  e5c96011          STRB     r6,[r9,#0x11]         ;889  ; kb_full_ver
0005f8  e5d40000          LDRB     r0,[r4,#0]            ;890  ; kb_start
0005fc  e3500001          CMP      r0,#1                 ;890
000600  03a01001          MOVEQ    r1,#1                 ;890
000604  03a00000          MOVEQ    r0,#0                 ;890
000608  0bfffffe          BLEQ     avar_bat_hndl
00060c  e5d40001          LDRB     r0,[r4,#1]            ;891  ; kb_start
000610  e3500001          CMP      r0,#1                 ;891
000614  1affffcf          BNE      |L1.1368|
000618  e3a01001          MOV      r1,#1                 ;891
                  |L1.1564|
00061c  e8bd5ff0          POP      {r4-r12,lr}           ;891
000620  e3a00001          MOV      r0,#1                 ;891
000624  eafffffe          B        avar_bat_hndl
;;;896    
                          ENDP

                  samokalibr_init PROC
;;;898    //-----------------------------------------------
;;;899    void samokalibr_init(void)
000628  e59f09d4          LDR      r0,|L1.4100|
;;;900    {
;;;901    samokalibr_cnt=1785;
00062c  e59f1978          LDR      r1,|L1.4012|
000630  e1c103b2          STRH     r0,[r1,#0x32]  ; samokalibr_cnt
;;;902    }
000634  e12fff1e          BX       lr
;;;903    //-----------------------------------------------
                          ENDP

                  samokalibr_hndl PROC
;;;904    void samokalibr_hndl(void)
000638  e92d4070          PUSH     {r4-r6,lr}
;;;905    {
;;;906    if(++samokalibr_cnt>=1800)samokalibr_cnt=0;
00063c  e59f4968          LDR      r4,|L1.4012|
000640  e59f19c0          LDR      r1,|L1.4104|
000644  e1d403b2          LDRH     r0,[r4,#0x32]  ; samokalibr_cnt
000648  e2800001          ADD      r0,r0,#1
00064c  e1a00800          LSL      r0,r0,#16
000650  e1a00840          ASR      r0,r0,#16
000654  e1500001          CMP      r0,r1
000658  e1c403b2          STRH     r0,[r4,#0x32]  ; samokalibr_cnt
00065c  a3a00000          MOVGE    r0,#0
000660  a1c403b2          STRHGE   r0,[r4,#0x32]  ; samokalibr_cnt
000664  aa000026          BGE      |L1.1796|
;;;907    
;;;908    if(samokalibr_cnt>=1785U)
000668  e59f1994          LDR      r1,|L1.4100|
00066c  e1500001          CMP      r0,r1
000670  3a00000e          BCC      |L1.1712|
;;;909    	{
;;;910    	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR_ENABLE,0,15);
000674  e3a0300f          MOV      r3,#0xf
000678  e3a02000          MOV      r2,#0
00067c  e3a01064          MOV      r1,#0x64
000680  e3a000d2          MOV      r0,#0xd2
000684  ebfffffe          BL       mess_send
;;;911    	mess_send(MESS2IND_HNDL,PARAM_SAMOKALIBR,0,15);
000688  e3a0300f          MOV      r3,#0xf
00068c  e3a02000          MOV      r2,#0
000690  e3a010d8          MOV      r1,#0xd8
000694  e3a000d7          MOV      r0,#0xd7
000698  ebfffffe          BL       mess_send
;;;912    	mess_send(MESS2MATEMAT,PARAM_SAMOKALIBR,0,15);
00069c  e3a0300f          MOV      r3,#0xf
0006a0  e3a02000          MOV      r2,#0
0006a4  e3a010d8          MOV      r1,#0xd8
0006a8  e3a000dc          MOV      r0,#0xdc
0006ac  ebfffffe          BL       mess_send
                  |L1.1712|
;;;913    	} 
;;;914    
;;;915    if(samokalibr_cnt==1799U)
0006b0  e1d403f2          LDRSH    r0,[r4,#0x32]  ; samokalibr_cnt
0006b4  e2401c07          SUB      r1,r0,#0x700
0006b8  e2511007          SUBS     r1,r1,#7
0006bc  1a000010          BNE      |L1.1796|
;;;916    	{
;;;917    	if(Kibat0[0]!=ad7705_buff_[0]) lc640_write_int(ADR_KI0BAT[0],ad7705_buff_[0]);
0006c0  e59f6944          LDR      r6,|L1.4108|
0006c4  e59f4944          LDR      r4,|L1.4112|
0006c8  e1d600b0          LDRH     r0,[r6,#0]  ; Kibat0
0006cc  e1d410b0          LDRH     r1,[r4,#0]  ; ad7705_buff_
0006d0  e59f593c          LDR      r5,|L1.4116|
0006d4  e1500001          CMP      r0,r1
0006d8  11d410f0          LDRSHNE  r1,[r4,#0]  ; ad7705_buff_
0006dc  11d500f0          LDRSHNE  r0,[r5,#0]  ; ADR_KI0BAT
0006e0  1bfffffe          BLNE     lc640_write_int
;;;918    	if(Kibat0[1]!=ad7705_buff_[1]) lc640_write_int(ADR_KI0BAT[1],ad7705_buff_[1]);
0006e4  e1d600b2          LDRH     r0,[r6,#2]  ; Kibat0
0006e8  e1d410b2          LDRH     r1,[r4,#2]  ; ad7705_buff_
0006ec  e1500001          CMP      r0,r1
0006f0  0a000003          BEQ      |L1.1796|
0006f4  e1d410f2          LDRSH    r1,[r4,#2]  ; ad7705_buff_
0006f8  e1d500f2          LDRSH    r0,[r5,#2]  ; ADR_KI0BAT
0006fc  e8bd4070          POP      {r4-r6,lr}
000700  eafffffe          B        lc640_write_int
                  |L1.1796|
;;;919    	
;;;920    	}	 	
;;;921    }
000704  e8bd4070          POP      {r4-r6,lr}
000708  e12fff1e          BX       lr
;;;922    
                          ENDP

                  ubat_old_drv PROC
;;;925    //-----------------------------------------------
;;;926    void ubat_old_drv(void)
00070c  e92d4010          PUSH     {r4,lr}
;;;927    {        
;;;928    bat_u_old_cnt++;
000710  e59f4900          LDR      r4,|L1.4120|
;;;929    gran_ring(&bat_u_old_cnt,0,8);
000714  e3a02008          MOV      r2,#8
000718  e1d400b0          LDRH     r0,[r4,#0]            ;928  ; bat_u_old_cnt
00071c  e3a01000          MOV      r1,#0
000720  e2800001          ADD      r0,r0,#1              ;928
000724  e1c400b0          STRH     r0,[r4,#0]            ;928  ; bat_u_old_cnt
000728  e2840000          ADD      r0,r4,#0
00072c  ebfffffe          BL       gran_ring
;;;930    
;;;931    bat[0]._u_old[bat_u_old_cnt]=bat[0]._Ub;
000730  e59f18b4          LDR      r1,|L1.4076|
000734  e1d400f0          LDRSH    r0,[r4,#0]  ; bat_u_old_cnt
000738  e1d120b2          LDRH     r2,[r1,#2]  ; bat
00073c  e0810080          ADD      r0,r1,r0,LSL #1
000740  e1c021b8          STRH     r2,[r0,#0x18]
;;;932    bat[1]._u_old[bat_u_old_cnt]=bat[1]._Ub;
000744  e1d113be          LDRH     r1,[r1,#0x3e]  ; bat
000748  e1c015b4          STRH     r1,[r0,#0x54]
;;;933    }
00074c  e8bd4010          POP      {r4,lr}
000750  e12fff1e          BX       lr
;;;934    
                          ENDP

                  unet_drv PROC
;;;935    //-----------------------------------------------
;;;936    void unet_drv(void)
000754  e92d4010          PUSH     {r4,lr}
;;;937    {
;;;938    if(net_U<UMN)
000758  e59f484c          LDR      r4,|L1.4012|
00075c  e59f08b8          LDR      r0,|L1.4124|
000760  e1d415f0          LDRSH    r1,[r4,#0x50]  ; net_U
000764  e1d020f0          LDRSH    r2,[r0,#0]  ; UMN
000768  e2840000          ADD      r0,r4,#0
;;;939    	{
;;;940    	if(unet_drv_cnt<10)
00076c  e1d001d5          LDRSB    r0,[r0,#0x15]
000770  e1510002          CMP      r1,r2                 ;938
000774  aa000011          BGE      |L1.1984|
000778  e350000a          CMP      r0,#0xa
;;;941    		{
;;;942    		unet_drv_cnt++;
;;;943    		if(unet_drv_cnt>=10)
;;;944    			{
;;;945    			net_Ustore=net_U;
;;;946    		 	avar_unet_hndl(1);
;;;947    			
;;;948    			}
;;;949    		}
;;;950    	else if(unet_drv_cnt>=10)unet_drv_cnt=10;
00077c  a3a0000a          MOVGE    r0,#0xa
000780  a5c40015          STRBGE   r0,[r4,#0x15]  ; unet_drv_cnt
000784  aa000007          BGE      |L1.1960|
000788  e2800001          ADD      r0,r0,#1              ;942
00078c  e1a00c00          LSL      r0,r0,#24             ;942
000790  e1a00c40          ASR      r0,r0,#24             ;942
000794  e350000a          CMP      r0,#0xa               ;943
000798  e5c40015          STRB     r0,[r4,#0x15]         ;942  ; unet_drv_cnt
00079c  a3a00001          MOVGE    r0,#1                 ;946
0007a0  a1c415b2          STRHGE   r1,[r4,#0x52]         ;945  ; net_Ustore
0007a4  abfffffe          BLGE     avar_unet_hndl
                  |L1.1960|
;;;951    
;;;952    	if(net_U<net_Ustore) net_Ustore=net_U;	
0007a8  e1d405f0          LDRSH    r0,[r4,#0x50]  ; net_U
0007ac  e1d415f2          LDRSH    r1,[r4,#0x52]  ; net_Ustore
0007b0  e1500001          CMP      r0,r1
0007b4  b1c405b2          STRHLT   r0,[r4,#0x52]  ; net_Ustore
                  |L1.1976|
;;;953    	}
;;;954    
;;;955    else if(net_U>UMN)
;;;956    	{                 
;;;957    	if(unet_drv_cnt)
;;;958    		{
;;;959    		unet_drv_cnt--;
;;;960    		if(unet_drv_cnt<=0)
;;;961    			{
;;;962    			avar_unet_hndl(0);
;;;963    			}
;;;964    		}
;;;965    	else if(unet_drv_cnt<0)unet_drv_cnt=0;
;;;966    	
;;;967    	}
;;;968    
;;;969    }
0007b8  e8bd4010          POP      {r4,lr}
0007bc  e12fff1e          BX       lr
                  |L1.1984|
0007c0  dafffffc          BLE      |L1.1976|
0007c4  e3500000          CMP      r0,#0                 ;957
0007c8  0afffffa          BEQ      |L1.1976|
0007cc  e2400001          SUB      r0,r0,#1              ;959
0007d0  e1a00c00          LSL      r0,r0,#24             ;959
0007d4  e1a00c40          ASR      r0,r0,#24             ;959
0007d8  e3500000          CMP      r0,#0                 ;960
0007dc  e5c40015          STRB     r0,[r4,#0x15]         ;959  ; unet_drv_cnt
0007e0  cafffff4          BGT      |L1.1976|
0007e4  e8bd4010          POP      {r4,lr}               ;962
0007e8  e3a00000          MOV      r0,#0                 ;962
0007ec  eafffffe          B        avar_unet_hndl
;;;970    
                          ENDP

                  matemat PROC
;;;971    //-----------------------------------------------
;;;972    void matemat(void)
0007f0  e92d5ff0          PUSH     {r4-r12,lr}
;;;973    {
;;;974    //signed short temp_SS;
;;;975    signed long temp_SL/*,temp_SL_*/;
;;;976    char /*temp,*/i;
;;;977    
;;;978    //static char plpl;
;;;979    
;;;980    temp_SL=(signed long)net_buff_;
0007f4  e59f67b0          LDR      r6,|L1.4012|
;;;981    temp_SL*=Kunet;
0007f8  e59f1820          LDR      r1,|L1.4128|
0007fc  e1d602b6          LDRH     r0,[r6,#0x26]         ;980  ; net_buff_
000800  e1d110f0          LDRSH    r1,[r1,#0]  ; Kunet
000804  e0000091          MUL      r0,r1,r0
;;;982    temp_SL/=110000L;
000808  e59f1814          LDR      r1,|L1.4132|
00080c  ebfffffe          BL       __aeabi_idivmod
;;;983    net_U=(signed short)temp_SL;
;;;984    
;;;985    
;;;986    temp_SL=(signed long)adc_buff_[4];
000810  e59f9810          LDR      r9,|L1.4136|
;;;987    temp_SL*=Kubat[0];
000814  e59f4810          LDR      r4,|L1.4140|
000818  e1c605b0          STRH     r0,[r6,#0x50]         ;983  ; net_U
00081c  e1d900f8          LDRSH    r0,[r9,#8]            ;986  ; adc_buff_
000820  e1d410f0          LDRSH    r1,[r4,#0]  ; Kubat
000824  e0000091          MUL      r0,r1,r0
;;;988    temp_SL/=500L;
000828  e3a01f7d          MOV      r1,#0x1f4
00082c  ebfffffe          BL       __aeabi_idivmod
;;;989    bat[0]._Ub=(signed short)temp_SL;
000830  e59f57b4          LDR      r5,|L1.4076|
000834  e1c500b2          STRH     r0,[r5,#2]  ; bat
;;;990    
;;;991    temp_SL=(signed long)adc_buff_[0];
000838  e1d900f0          LDRSH    r0,[r9,#0]  ; adc_buff_
;;;992    temp_SL*=Kubat[1];
00083c  e1d410f2          LDRSH    r1,[r4,#2]  ; Kubat
000840  e0000091          MUL      r0,r1,r0
;;;993    temp_SL/=500L;
000844  e3a01f7d          MOV      r1,#0x1f4
000848  ebfffffe          BL       __aeabi_idivmod
;;;994    bat[1]._Ub=(signed short)temp_SL;
00084c  e1c503be          STRH     r0,[r5,#0x3e]  ; bat
;;;995    
;;;996    if(!mess_find_unvol(MESS2MATEMAT))
000850  e3a000dc          MOV      r0,#0xdc
000854  ebfffffe          BL       mess_find_unvol
000858  e3500000          CMP      r0,#0
00085c  1a000012          BNE      |L1.2220|
;;;997    	{
;;;998    //	ad7705_buff_[0]=32930;
;;;999    //	Kibat0[0]=32900;
;;;1000   	temp_SL=(signed long)ad7705_buff_[0];
000860  e59f47a8          LDR      r4,|L1.4112|
;;;1001   	temp_SL-=(signed long)Kibat0[0];
000864  e59f77a0          LDR      r7,|L1.4108|
000868  e1d400b0          LDRH     r0,[r4,#0]            ;1000  ; ad7705_buff_
00086c  e1d710b0          LDRH     r1,[r7,#0]  ; Kibat0
;;;1002   	temp_SL*=(signed long)Kibat1[0];
000870  e59f87b8          LDR      r8,|L1.4144|
000874  e0400001          SUB      r0,r0,r1              ;1001
000878  e1d810f0          LDRSH    r1,[r8,#0]  ; Kibat1
00087c  e0000091          MUL      r0,r1,r0
;;;1003   	temp_SL/=1000L;
000880  e3a01ffa          MOV      r1,#0x3e8
000884  ebfffffe          BL       __aeabi_idivmod
;;;1004   	bat[0]._Ib=(signed short)temp_SL;
000888  e1c500b4          STRH     r0,[r5,#4]  ; bat
;;;1005   
;;;1006   	temp_SL=(signed long)ad7705_buff_[1];
00088c  e1d400b2          LDRH     r0,[r4,#2]  ; ad7705_buff_
;;;1007   	temp_SL-=(signed long)Kibat0[1];
000890  e1d710b2          LDRH     r1,[r7,#2]  ; Kibat0
000894  e0400001          SUB      r0,r0,r1
;;;1008   	temp_SL*=(signed long)Kibat1[1];
000898  e1d810f2          LDRSH    r1,[r8,#2]  ; Kibat1
00089c  e0000091          MUL      r0,r1,r0
;;;1009   	temp_SL/=1000L;
0008a0  e3a01ffa          MOV      r1,#0x3e8
0008a4  ebfffffe          BL       __aeabi_idivmod
;;;1010   	bat[1]._Ib=(signed short)temp_SL;
0008a8  e1c504b0          STRH     r0,[r5,#0x40]  ; bat
                  |L1.2220|
;;;1011   	}
;;;1012   
;;;1013   if((adc_buff_[12]>200)&&(adc_buff_[12]<1000))bat[0]._nd=0;
0008ac  e1d901f8          LDRSH    r0,[r9,#0x18]  ; adc_buff_
0008b0  e59f777c          LDR      r7,|L1.4148|
;;;1014   else bat[0]._nd=1;
0008b4  e3a08001          MOV      r8,#1
0008b8  e24010c9          SUB      r1,r0,#0xc9           ;1013
0008bc  e1510007          CMP      r1,r7                 ;1013
;;;1015   temp_SL=(signed long)adc_buff_[12];
;;;1016   temp_SL*=Ktbat[0];
0008c0  e59fa770          LDR      r10,|L1.4152|
0008c4  e3a04000          MOV      r4,#0                 ;1013
0008c8  25c58008          STRBCS   r8,[r5,#8]            ;1014  ; bat
0008cc  35c54008          STRBCC   r4,[r5,#8]            ;1013  ; bat
0008d0  e1da10f0          LDRSH    r1,[r10,#0]  ; Ktbat
0008d4  e0000091          MUL      r0,r1,r0
;;;1017   temp_SL/=5000L;
0008d8  e59f175c          LDR      r1,|L1.4156|
0008dc  ebfffffe          BL       __aeabi_idivmod
;;;1018   temp_SL-=273L;
0008e0  e3e0be11          MVN      r11,#0x110
0008e4  e080000b          ADD      r0,r0,r11
;;;1019   bat[0]._Tb=(signed short)temp_SL;
0008e8  e1c500b6          STRH     r0,[r5,#6]  ; bat
;;;1020   
;;;1021   if((adc_buff_[10]>200)&&(adc_buff_[10]<1000))bat[1]._nd=0;
0008ec  e1d901f4          LDRSH    r0,[r9,#0x14]  ; adc_buff_
0008f0  e24010c9          SUB      r1,r0,#0xc9
0008f4  e1510007          CMP      r1,r7
;;;1022   else bat[1]._nd=1;
0008f8  25c58044          STRBCS   r8,[r5,#0x44]  ; bat
0008fc  35c54044          STRBCC   r4,[r5,#0x44]         ;1021  ; bat
;;;1023   temp_SL=(signed long)adc_buff_[10];
;;;1024   temp_SL*=Ktbat[1];
000900  e1da10f2          LDRSH    r1,[r10,#2]  ; Ktbat
000904  e0000091          MUL      r0,r1,r0
;;;1025   temp_SL/=5000L;
000908  e59f172c          LDR      r1,|L1.4156|
00090c  ebfffffe          BL       __aeabi_idivmod
;;;1026   temp_SL-=273L;
000910  e080000b          ADD      r0,r0,r11
;;;1027   bat[1]._Tb=(signed short)temp_SL;
000914  e1c504b2          STRH     r0,[r5,#0x42]  ; bat
;;;1028   
;;;1029   
;;;1030   
;;;1031   /*if(Ibat<0)bit_minus=1;
;;;1032   else bit_minus=0;*/
;;;1033   
;;;1034   if((kb_full_ver)&&(abs(bat[0]._Ib)>IKB))
000918  e5d60011          LDRB     r0,[r6,#0x11]  ; kb_full_ver
00091c  e3500000          CMP      r0,#0
000920  0a00000f          BEQ      |L1.2404|
000924  e1d500f4          LDRSH    r0,[r5,#4]  ; bat
000928  ebfffffe          BL       abs
00092c  e59f16bc          LDR      r1,|L1.4080|
000930  e1d110f0          LDRSH    r1,[r1,#0]  ; IKB
000934  e1500001          CMP      r0,r1
000938  da000009          BLE      |L1.2404|
;;;1035   	{
;;;1036   	kb_full_ver=0;
;;;1037   	//avar_bat_hndl(0);
;;;1038   	gran(&TBAT,5,60);
00093c  e59f06a4          LDR      r0,|L1.4072|
000940  e3a0203c          MOV      r2,#0x3c
000944  e3a01005          MOV      r1,#5
000948  e5c64011          STRB     r4,[r6,#0x11]         ;1036  ; kb_full_ver
00094c  ebfffffe          BL       gran
;;;1039        bat_ver_cnt=TBAT*300;
000950  e59f0690          LDR      r0,|L1.4072|
000954  e3a01f4b          MOV      r1,#0x12c
000958  e1d000b0          LDRH     r0,[r0,#0]  ; TBAT
00095c  e0000091          MUL      r0,r1,r0
000960  e1c601b8          STRH     r0,[r6,#0x18]  ; bat_ver_cnt
                  |L1.2404|
;;;1040   	}
;;;1041   
;;;1042   /*temp_SS=0;
;;;1043   if((bat_Ub[0]>=100)&&(BAT_IS_ON[0]==bisON)&&(bat_rel_stat[0]==0)) temp_SS=bat_Ub[0];
;;;1044   if((bat_Ub[1]>=temp_SS)&&(BAT_IS_ON[1]==bisON)&&(bat_rel_stat[1]==0)) temp_SS=bat_Ub[1];
;;;1045   for(temp=0;temp<NUMIST;temp++)
;;;1046   	{
;;;1047   	if((src[temp]._Uii>200)&&(src[temp]._Uii>temp_SS)&&(src[temp]._cnt<5))
;;;1048   		{
;;;1049   		temp_SS=src[temp]._Uii;
;;;1050   		}
;;;1051   	}
;;;1052   load_U=temp_SS;*/
;;;1053   
;;;1054   
;;;1055   temp_SL=(signed long)adc_buff_[9];
;;;1056   temp_SL*=Kuload;
000964  e59f16d4          LDR      r1,|L1.4160|
000968  e1d901f2          LDRSH    r0,[r9,#0x12]         ;1055  ; adc_buff_
00096c  e1d110f0          LDRSH    r1,[r1,#0]  ; Kuload
000970  e0000091          MUL      r0,r1,r0
;;;1057   temp_SL/=500L;
000974  e3a01f7d          MOV      r1,#0x1f4
000978  ebfffffe          BL       __aeabi_idivmod
;;;1058   load_U=(signed short)temp_SL;
00097c  e59f16c0          LDR      r1,|L1.4164|
;;;1059   
;;;1060   
;;;1061   
;;;1062   	
;;;1063   /*else if (Us[0]>=100) Uload=Us[0];
;;;1064   else Uload=Us[1];*/
;;;1065   
;;;1066   /*iload=Is[0]+Is[1]-(bat[0]._Ib/10);
;;;1067   if(iload<0) iload=0;*/
;;;1068   
;;;1069   
;;;1070   
;;;1071   
;;;1072   /*
;;;1073   if((adc_buff_[6]>200)&&(adc_buff_[6]<1000))ND[0]=0;
;;;1074   else ND[0]=0xff;
;;;1075   temp_SL=(signed long)adc_buff_[6];
;;;1076   temp_SL*=Ktsrc[0];
;;;1077   temp_SL/=5000L;
;;;1078   temp_SL-=273L;
;;;1079   bat_Tb[0]=(signed short)temp_SL;*/
;;;1080   
;;;1081   
;;;1082   
;;;1083   
;;;1084   if((adc_buff_out_[0]>200)&&(adc_buff_out_[0]<800))ND_out[0]=0;
000980  e59f96c4          LDR      r9,|L1.4172|
000984  e1c100b0          STRH     r0,[r1,#0]            ;1058  ; load_U
000988  e59f16b8          LDR      r1,|L1.4168|
00098c  e59f76bc          LDR      r7,|L1.4176|
000990  e1d100f0          LDRSH    r0,[r1,#0]  ; adc_buff_out_
;;;1085   else ND_out[0]=0xff;
000994  e3a080ff          MOV      r8,#0xff
;;;1086   
;;;1087   temp_SL=(signed long)adc_buff_out_[0];
;;;1088   temp_SL*=Ktout[0];
000998  e59fa6b4          LDR      r10,|L1.4180|
00099c  e24020c9          SUB      r2,r0,#0xc9           ;1084
0009a0  e1520009          CMP      r2,r9                 ;1084
0009a4  25c78000          STRBCS   r8,[r7,#0]            ;1085  ; ND_out
0009a8  35c74000          STRBCC   r4,[r7,#0]            ;1084  ; ND_out
0009ac  e1da10f0          LDRSH    r1,[r10,#0]  ; Ktout
0009b0  e0000091          MUL      r0,r1,r0
;;;1089   temp_SL/=2000L;
0009b4  e3a01e7d          MOV      r1,#0x7d0
0009b8  ebfffffe          BL       __aeabi_idivmod
;;;1090   temp_SL-=273L;
;;;1091   tout[0]=(signed short)temp_SL;
0009bc  e59f1694          LDR      r1,|L1.4184|
0009c0  e080000b          ADD      r0,r0,r11             ;1090
0009c4  e1c100b0          STRH     r0,[r1,#0]  ; tout
;;;1092   
;;;1093   
;;;1094   if((adc_buff_out_[1]>200)&&(adc_buff_out_[1]<800))ND_out[1]=0;
0009c8  e59f0678          LDR      r0,|L1.4168|
0009cc  e59f1678          LDR      r1,|L1.4172|
0009d0  e1d000f2          LDRSH    r0,[r0,#2]  ; adc_buff_out_
0009d4  e24020c9          SUB      r2,r0,#0xc9
0009d8  e1520001          CMP      r2,r1
;;;1095   else ND_out[1]=0xff;
0009dc  25c78001          STRBCS   r8,[r7,#1]  ; ND_out
0009e0  35c74001          STRBCC   r4,[r7,#1]            ;1094  ; ND_out
;;;1096   
;;;1097   temp_SL=(signed long)adc_buff_out_[1];
;;;1098   temp_SL*=Ktout[1];
0009e4  e1da10f2          LDRSH    r1,[r10,#2]  ; Ktout
0009e8  e0000091          MUL      r0,r1,r0
;;;1099   temp_SL/=2000L;
0009ec  e3a01e7d          MOV      r1,#0x7d0
0009f0  ebfffffe          BL       __aeabi_idivmod
;;;1100   temp_SL-=273L;
;;;1101   tout[1]=(signed short)temp_SL;
0009f4  e59f965c          LDR      r9,|L1.4184|
0009f8  e080000b          ADD      r0,r0,r11             ;1100
0009fc  e1c900b2          STRH     r0,[r9,#2]  ; tout
;;;1102   
;;;1103   
;;;1104   if((adc_buff_out_[2]>200)&&(adc_buff_out_[2]<800))ND_out[2]=0;
000a00  e59f0640          LDR      r0,|L1.4168|
000a04  e59f1640          LDR      r1,|L1.4172|
000a08  e1d000f4          LDRSH    r0,[r0,#4]  ; adc_buff_out_
000a0c  e24020c9          SUB      r2,r0,#0xc9
000a10  e1520001          CMP      r2,r1
;;;1105   else ND_out[2]=0xff;
000a14  25c78002          STRBCS   r8,[r7,#2]  ; ND_out
000a18  35c74002          STRBCC   r4,[r7,#2]            ;1104  ; ND_out
;;;1106   
;;;1107   temp_SL=(signed long)adc_buff_out_[2];
;;;1108   temp_SL*=Ktout[2];
000a1c  e1da10f4          LDRSH    r1,[r10,#4]  ; Ktout
000a20  e0000091          MUL      r0,r1,r0
;;;1109   temp_SL/=2000L;
000a24  e3a01e7d          MOV      r1,#0x7d0
000a28  ebfffffe          BL       __aeabi_idivmod
;;;1110   temp_SL-=273L;
000a2c  e080000b          ADD      r0,r0,r11
;;;1111   tout[2]=(signed short)temp_SL;
000a30  e1c900b4          STRH     r0,[r9,#4]  ; tout
;;;1112   
;;;1113   
;;;1114   if((BAT_IS_ON[0]==bisON)&&(bat[0]._Ub>200)) Ibmax=bat[0]._Ib;
000a34  e59f05b8          LDR      r0,|L1.4084|
000a38  e5d01000          LDRB     r1,[r0,#0]  ; BAT_IS_ON
000a3c  e3510055          CMP      r1,#0x55
000a40  1a000003          BNE      |L1.2644|
000a44  e1d510f2          LDRSH    r1,[r5,#2]  ; bat
000a48  e35100c8          CMP      r1,#0xc8
000a4c  c1d510b4          LDRHGT   r1,[r5,#4]  ; bat
000a50  c1c613b0          STRHGT   r1,[r6,#0x30]  ; Ibmax
                  |L1.2644|
;;;1115   if((BAT_IS_ON[1]==bisON)&&(bat[1]._Ub>200)&&(bat[1]._Ib>bat[0]._Ib)) Ibmax=bat[1]._Ib;
000a54  e5d00001          LDRB     r0,[r0,#1]  ; BAT_IS_ON
000a58  e3500055          CMP      r0,#0x55
000a5c  1a000005          BNE      |L1.2680|
000a60  e1d503fe          LDRSH    r0,[r5,#0x3e]  ; bat
000a64  e35000c8          CMP      r0,#0xc8
000a68  c1d504f0          LDRSHGT  r0,[r5,#0x40]  ; bat
000a6c  c1d510f4          LDRSHGT  r1,[r5,#4]  ; bat
000a70  c1500001          CMPGT    r0,r1
000a74  c1c603b0          STRHGT   r0,[r6,#0x30]  ; Ibmax
                  |L1.2680|
;;;1116   
;;;1117   
;;;1118   /*if((Is[0]+Is[1])>IMAX)
;;;1119   	{
;;;1120   	num_necc=2;
;;;1121   	cnt_num_necc=25;
;;;1122   	}
;;;1123   	
;;;1124   else if(((Is[0]+Is[1])*10)<(IMAX*KIMAX))
;;;1125   	{
;;;1126   	if(cnt_num_necc)
;;;1127   		{
;;;1128   		cnt_num_necc--;
;;;1129   		if(cnt_num_necc==0) num_necc=1;
;;;1130   		}
;;;1131   	}	*/
;;;1132   
;;;1133   
;;;1134   for(i=0;i<NUMIST;i++)
000a78  e59f05e0          LDR      r0,|L1.4192|
;;;1135   	{
;;;1136   	if(bps[i]._cnt<25)
000a7c  e59f75d8          LDR      r7,|L1.4188|
000a80  e1d060f0          LDRSH    r6,[r0,#0]            ;1134
000a84  e3a01000          MOV      r1,#0                 ;1134
000a88  ea000023          B        |L1.2844|
                  |L1.2700|
000a8c  e0610181          RSB      r0,r1,r1,LSL #3
000a90  e0800080          ADD      r0,r0,r0,LSL #1
000a94  e0870100          ADD      r0,r7,r0,LSL #2
000a98  e5d02003          LDRB     r2,[r0,#3]
000a9c  e3520019          CMP      r2,#0x19
;;;1137        	{
;;;1138        	bps[i]._Ii=bps[i]._buff[0]+(bps[i]._buff[1]*256);
;;;1139        	bps[i]._Uin=bps[i]._buff[2]+(bps[i]._buff[3]*256);
;;;1140        	bps[i]._Uii=bps[i]._buff[4]+(bps[i]._buff[5]*256);
;;;1141        	bps[i]._Ti=(signed)(bps[i]._buff[6]);
;;;1142        	bps[i]._adr_ee=bps[i]._buff[7];
;;;1143        	bps[i]._flags_tm=bps[i]._buff[8];
;;;1144   	     bps[i]._rotor=bps[i]._buff[10]+(bps[i]._buff[11]*256);    
;;;1145        	} 
;;;1146   	else 
;;;1147        	{
;;;1148        	bps[i]._Uii=0; 
;;;1149        	bps[i]._Ii=0;
000aa0  25804018          STRCS    r4,[r0,#0x18]
;;;1150        	bps[i]._Uin=0;
000aa4  25804020          STRCS    r4,[r0,#0x20]
;;;1151        	bps[i]._Ti=0;
000aa8  2580401c          STRCS    r4,[r0,#0x1c]
000aac  25804024          STRCS    r4,[r0,#0x24]
;;;1152        	bps[i]._flags_tm=0; 
000ab0  25c04042          STRBCS   r4,[r0,#0x42]
;;;1153   	     bps[i]._rotor=0;    
000ab4  2580404c          STRCS    r4,[r0,#0x4c]
000ab8  2a000015          BCS      |L1.2836|
000abc  e5d02006          LDRB     r2,[r0,#6]            ;1138
000ac0  e5d03007          LDRB     r3,[r0,#7]            ;1138
000ac4  e0822403          ADD      r2,r2,r3,LSL #8       ;1138
000ac8  e5802020          STR      r2,[r0,#0x20]         ;1138
000acc  e5d02008          LDRB     r2,[r0,#8]            ;1139
000ad0  e5d03009          LDRB     r3,[r0,#9]            ;1139
000ad4  e0822403          ADD      r2,r2,r3,LSL #8       ;1139
000ad8  e580201c          STR      r2,[r0,#0x1c]         ;1139
000adc  e5d0200a          LDRB     r2,[r0,#0xa]          ;1140
000ae0  e5d0300b          LDRB     r3,[r0,#0xb]          ;1140
000ae4  e0822403          ADD      r2,r2,r3,LSL #8       ;1140
000ae8  e5802018          STR      r2,[r0,#0x18]         ;1140
000aec  e5d0200c          LDRB     r2,[r0,#0xc]          ;1141
000af0  e5802024          STR      r2,[r0,#0x24]         ;1141
000af4  e5d0200d          LDRB     r2,[r0,#0xd]          ;1142
000af8  e5c02052          STRB     r2,[r0,#0x52]         ;1142
000afc  e5d0200e          LDRB     r2,[r0,#0xe]          ;1143
000b00  e5c02042          STRB     r2,[r0,#0x42]         ;1143
000b04  e5d02010          LDRB     r2,[r0,#0x10]         ;1144
000b08  e5d03011          LDRB     r3,[r0,#0x11]         ;1144
000b0c  e0822403          ADD      r2,r2,r3,LSL #8       ;1144
000b10  e580204c          STR      r2,[r0,#0x4c]         ;1144
                  |L1.2836|
000b14  e2810001          ADD      r0,r1,#1              ;1134
000b18  e20010ff          AND      r1,r0,#0xff           ;1134
                  |L1.2844|
000b1c  e1510006          CMP      r1,r6                 ;1134
000b20  baffffd9          BLT      |L1.2700|
;;;1154        	}
;;;1155        
;;;1156        }
;;;1157   
;;;1158   
;;;1159   
;;;1160   load_I=-(bat[0]._Ib/10)-(bat[1]._Ib/10);
000b24  e1d500f4          LDRSH    r0,[r5,#4]  ; bat
000b28  e3a0100a          MOV      r1,#0xa
000b2c  ebfffffe          BL       __aeabi_idivmod
000b30  e1a08000          MOV      r8,r0
000b34  e1d504f0          LDRSH    r0,[r5,#0x40]  ; bat
000b38  e3a0100a          MOV      r1,#0xa
000b3c  ebfffffe          BL       __aeabi_idivmod
000b40  e0800008          ADD      r0,r0,r8
000b44  e2600000          RSB      r0,r0,#0
000b48  e1a03800          LSL      r3,r0,#16
000b4c  e59fc510          LDR      r12,|L1.4196|
;;;1161   
;;;1162   Isumm=0;
000b50  e59f2510          LDR      r2,|L1.4200|
000b54  e1a03843          ASR      r3,r3,#16             ;1160
000b58  e1cc30b0          STRH     r3,[r12,#0]           ;1160  ; load_I
;;;1163   
;;;1164   for(i=0;i<NUMIST;i++)
000b5c  e3a00000          MOV      r0,#0
000b60  e1c240b0          STRH     r4,[r2,#0]            ;1162  ; Isumm
000b64  ea00000a          B        |L1.2964|
                  |L1.2920|
;;;1165        {
;;;1166        if(bps[i]._cnt<5)Isumm+=bps[i]._Ii;
000b68  e0601180          RSB      r1,r0,r0,LSL #3
000b6c  e0811081          ADD      r1,r1,r1,LSL #1
000b70  e0871101          ADD      r1,r7,r1,LSL #2
000b74  e5d1e003          LDRB     lr,[r1,#3]
000b78  e2800001          ADD      r0,r0,#1              ;1164
000b7c  e20000ff          AND      r0,r0,#0xff           ;1164
000b80  e35e0005          CMP      lr,#5
000b84  31d2e0b0          LDRHCC   lr,[r2,#0]  ; Isumm
000b88  35911020          LDRCC    r1,[r1,#0x20]
000b8c  3081100e          ADDCC    r1,r1,lr
000b90  31c210b0          STRHCC   r1,[r2,#0]  ; Isumm
                  |L1.2964|
000b94  e1500006          CMP      r0,r6                 ;1164
000b98  bafffff2          BLT      |L1.2920|
;;;1167        }  
;;;1168        
;;;1169   load_I=load_I+Isumm;
000b9c  e1d200b0          LDRH     r0,[r2,#0]  ; Isumm
000ba0  e0800003          ADD      r0,r0,r3
000ba4  e1a00800          LSL      r0,r0,#16
000ba8  e1b00840          ASRS     r0,r0,#16
000bac  e1cc00b0          STRH     r0,[r12,#0]  ; load_I
;;;1170   if(load_I<0)load_I=0;
000bb0  41cc40b0          STRHMI   r4,[r12,#0]  ; load_I
;;;1171   	
;;;1172   }
000bb4  e8bd5ff0          POP      {r4-r12,lr}
000bb8  e12fff1e          BX       lr
;;;1173   
                          ENDP

                  adc_init PROC
;;;1175   //-----------------------------------------------
;;;1176   void adc_init(void)
000bbc  e59f04a8          LDR      r0,|L1.4204|
;;;1177   {
;;;1178   
;;;1179   SET_REG(PINSEL1,1,(28-16)*2,2);
000bc0  e5901004          LDR      r1,[r0,#4]
000bc4  e3c11403          BIC      r1,r1,#0x3000000
000bc8  e3811401          ORR      r1,r1,#0x1000000
000bcc  e5801004          STR      r1,[r0,#4]
;;;1180   SET_REG(PINSEL1,1,(29-16)*2,2);
000bd0  e5901004          LDR      r1,[r0,#4]
000bd4  e3c11303          BIC      r1,r1,#0xc000000
000bd8  e3811301          ORR      r1,r1,#0x4000000
000bdc  e5801004          STR      r1,[r0,#4]
;;;1181   SET_REG(PINSEL1,1,(30-16)*2,2);	
000be0  e5901004          LDR      r1,[r0,#4]
000be4  e3c11203          BIC      r1,r1,#0x30000000
000be8  e3811201          ORR      r1,r1,#0x10000000
000bec  e5801004          STR      r1,[r0,#4]
;;;1182   
;;;1183   SET_REG(PINSEL0,0,(4)*2,2);
000bf0  e5901000          LDR      r1,[r0,#0]
000bf4  e3c11c03          BIC      r1,r1,#0x300
000bf8  e5801000          STR      r1,[r0,#0]
;;;1184   SET_REG(PINSEL0,0,(5)*2,2);
000bfc  e5901000          LDR      r1,[r0,#0]
000c00  e3c11b03          BIC      r1,r1,#0xc00
000c04  e5801000          STR      r1,[r0,#0]
;;;1185   SET_REG(PINSEL0,0,(6)*2,2);
000c08  e5902000          LDR      r2,[r0,#0]
;;;1186   
;;;1187   SET_REG(IO0DIR,1,4,1);
000c0c  e2401901          SUB      r1,r0,#0x4000
000c10  e3c22a03          BIC      r2,r2,#0x3000         ;1185
000c14  e5802000          STR      r2,[r0,#0]            ;1185
000c18  e5910008          LDR      r0,[r1,#8]
000c1c  e3800010          ORR      r0,r0,#0x10
000c20  e5810008          STR      r0,[r1,#8]
;;;1188   SET_REG(IO0DIR,1,5,1);
000c24  e5910008          LDR      r0,[r1,#8]
000c28  e3800020          ORR      r0,r0,#0x20
000c2c  e5810008          STR      r0,[r1,#8]
;;;1189   SET_REG(IO0DIR,1,6,1);
000c30  e5910008          LDR      r0,[r1,#8]
;;;1190   
;;;1191   period_cnt=0;
000c34  e3a02000          MOV      r2,#0
000c38  e3800040          ORR      r0,r0,#0x40           ;1189
000c3c  e5810008          STR      r0,[r1,#8]            ;1189
000c40  e59f0364          LDR      r0,|L1.4012|
;;;1192   zero_cnt=0;
;;;1193   adc_stat=asNET_WAIT;
000c44  e3a01002          MOV      r1,#2
000c48  e1c022ba          STRH     r2,[r0,#0x2a]         ;1191  ; period_cnt
000c4c  e1c022b4          STRH     r2,[r0,#0x24]         ;1192  ; zero_cnt
000c50  e5c01000          STRB     r1,[r0,#0]  ; adc_stat
;;;1194   
;;;1195   SET_REG(ADCR,1,21,1);	//PDN=1;
000c54  e59f0414          LDR      r0,|L1.4208|
000c58  e5901000          LDR      r1,[r0,#0]
000c5c  e3811602          ORR      r1,r1,#0x200000
000c60  e5801000          STR      r1,[r0,#0]
;;;1196   SET_REG(ADCR,14,8,8);	//CLKDIV=14;
000c64  e5901000          LDR      r1,[r0,#0]
000c68  e3c11cff          BIC      r1,r1,#0xff00
000c6c  e3811c0e          ORR      r1,r1,#0xe00
000c70  e5801000          STR      r1,[r0,#0]
;;;1197   SET_REG(ADCR,0,16,1);	//BURST=0;
000c74  e5901000          LDR      r1,[r0,#0]
000c78  e3c11801          BIC      r1,r1,#0x10000
000c7c  e5801000          STR      r1,[r0,#0]
;;;1198   SET_REG(ADCR,0,17,3);	//CLKS=0;
000c80  e5901000          LDR      r1,[r0,#0]
000c84  e3c1180e          BIC      r1,r1,#0xe0000
000c88  e5801000          STR      r1,[r0,#0]
;;;1199   SET_REG(ADCR,0,22,2);	//TEST=0;
000c8c  e5901000          LDR      r1,[r0,#0]
000c90  e3c11503          BIC      r1,r1,#0xc00000
000c94  e5801000          STR      r1,[r0,#0]
;;;1200   SET_REG(ADCR,1,24,3);	//START=1;
000c98  e5901000          LDR      r1,[r0,#0]
000c9c  e3c11407          BIC      r1,r1,#0x7000000
000ca0  e3811401          ORR      r1,r1,#0x1000000
000ca4  e5801000          STR      r1,[r0,#0]
;;;1201   
;;;1202   }
000ca8  e12fff1e          BX       lr
;;;1203   
                          ENDP

                  adc_drv PROC
;;;1204   //-----------------------------------------------
;;;1205   void adc_drv(void)
000cac  e92d41f0          PUSH     {r4-r8,lr}
;;;1206   {
;;;1207   short temp_S;
;;;1208   char i;
;;;1209   if(GET_REG( ADDR,31,1))
000cb0  e59f33b8          LDR      r3,|L1.4208|
000cb4  e5930004          LDR      r0,[r3,#4]
;;;1210   	{
;;;1211   	plazma_adc_cnt++;
000cb8  e59fc2ec          LDR      r12,|L1.4012|
000cbc  e2101102          ANDS     r1,r0,#0x80000000     ;1209
;;;1212   	ADWR=(short)(GET_REG(ADDR,6,10));
;;;1213   
;;;1214   	if(adc_stat==asNET_WAIT)
;;;1215   		{
;;;1216   		if(ADWR<20)
;;;1217   			{
;;;1218   			if(zero_cnt<20) 
;;;1219   				{
;;;1220   				zero_cnt++;
;;;1221   				if(zero_cnt>=20)
;;;1222   					{
;;;1223   					adc_stat=asNET_RDY;
;;;1224   					period_cnt=0;
000cc0  e3a0e000          MOV      lr,#0
;;;1225   			IO0DIR|=(1<<25);
000cc4  e2430903          SUB      r0,r3,#0xc000
000cc8  5a0000a7          BPL      |L1.3948|
000ccc  e1dc12bc          LDRH     r1,[r12,#0x2c]        ;1211  ; plazma_adc_cnt
000cd0  e2811001          ADD      r1,r1,#1              ;1211
000cd4  e1cc12bc          STRH     r1,[r12,#0x2c]        ;1211  ; plazma_adc_cnt
000cd8  e5931004          LDR      r1,[r3,#4]            ;1212
000cdc  e1a01801          LSL      r1,r1,#16             ;1212
000ce0  e1a01b21          LSR      r1,r1,#22             ;1212
000ce4  e1cc12b8          STRH     r1,[r12,#0x28]        ;1212  ; ADWR
000ce8  e5dc4000          LDRB     r4,[r12,#0]           ;1214  ; adc_stat
000cec  e3540002          CMP      r4,#2                 ;1214
000cf0  1a000024          BNE      |L1.3464|
000cf4  e3510014          CMP      r1,#0x14              ;1216
000cf8  e3a02003          MOV      r2,#3                 ;1223
;;;1226   			IO0CLR|=(1<<25);
;;;1227   					}
;;;1228   				}
;;;1229   
;;;1230   			}
;;;1231   		else zero_cnt=0;
000cfc  a1cce2b4          STRHGE   lr,[r12,#0x24]  ; zero_cnt
000d00  aa000010          BGE      |L1.3400|
000d04  e1dc12f4          LDRSH    r1,[r12,#0x24]        ;1218  ; zero_cnt
000d08  e3510014          CMP      r1,#0x14              ;1218
000d0c  aa00000d          BGE      |L1.3400|
000d10  e2811001          ADD      r1,r1,#1              ;1220
000d14  e1a01801          LSL      r1,r1,#16             ;1220
000d18  e1a01841          ASR      r1,r1,#16             ;1220
000d1c  e3510014          CMP      r1,#0x14              ;1221
000d20  e1cc12b4          STRH     r1,[r12,#0x24]        ;1220  ; zero_cnt
000d24  ba000007          BLT      |L1.3400|
000d28  e5cc2000          STRB     r2,[r12,#0]           ;1223  ; adc_stat
000d2c  e1cce2ba          STRH     lr,[r12,#0x2a]        ;1224  ; period_cnt
000d30  e5901008          LDR      r1,[r0,#8]            ;1225
000d34  e3811402          ORR      r1,r1,#0x2000000      ;1225
000d38  e5801008          STR      r1,[r0,#8]            ;1225
000d3c  e590100c          LDR      r1,[r0,#0xc]          ;1226
000d40  e3811402          ORR      r1,r1,#0x2000000      ;1226
000d44  e580100c          STR      r1,[r0,#0xc]          ;1226
                  |L1.3400|
;;;1232   		
;;;1233   		period_cnt++;
000d48  e1dc12ba          LDRH     r1,[r12,#0x2a]  ; period_cnt
000d4c  e2811001          ADD      r1,r1,#1
000d50  e1a01801          LSL      r1,r1,#16
000d54  e1a01841          ASR      r1,r1,#16
;;;1234   		if(period_cnt>50)
000d58  e3510032          CMP      r1,#0x32
000d5c  e1cc12ba          STRH     r1,[r12,#0x2a]        ;1233  ; period_cnt
000d60  da000081          BLE      |L1.3948|
;;;1235   			{
;;;1236   			adc_stat=asNET_RDY;
000d64  e5cc2000          STRB     r2,[r12,#0]  ; adc_stat
;;;1237   			period_cnt=0;
000d68  e1cce2ba          STRH     lr,[r12,#0x2a]  ; period_cnt
;;;1238   			IO0DIR|=(1<<25);
000d6c  e5901008          LDR      r1,[r0,#8]
000d70  e3811402          ORR      r1,r1,#0x2000000
000d74  e5801008          STR      r1,[r0,#8]
;;;1239   			IO0CLR|=(1<<25);
000d78  e590100c          LDR      r1,[r0,#0xc]
000d7c  e3811402          ORR      r1,r1,#0x2000000
000d80  e580100c          STR      r1,[r0,#0xc]
000d84  ea000078          B        |L1.3948|
                  |L1.3464|
000d88  e59f221c          LDR      r2,|L1.4012|
;;;1240   			
;;;1241   			}
;;;1242   
;;;1243   		}
;;;1244   	 else if(adc_stat==asNET_RDY)
;;;1245   		{
;;;1246   		if(ADWR>20)
;;;1247   			{
;;;1248   			adc_stat=asNET;
;;;1249   			period_cnt=0;
;;;1250   			IO0DIR|=(1<<25);
;;;1251   			IO0SET|=(1<<25);
;;;1252   			net_buff[net_buff_cnt]=0;
000d8c  e59f62e0          LDR      r6,|L1.4212|
000d90  e5d2800c          LDRB     r8,[r2,#0xc]
000d94  e3540003          CMP      r4,#3                 ;1244
000d98  e0862088          ADD      r2,r6,r8,LSL #1
000d9c  1a000015          BNE      |L1.3576|
000da0  e3510014          CMP      r1,#0x14              ;1246
000da4  e3a04004          MOV      r4,#4                 ;1248
000da8  da000008          BLE      |L1.3536|
000dac  e5cc4000          STRB     r4,[r12,#0]           ;1248  ; adc_stat
000db0  e1cce2ba          STRH     lr,[r12,#0x2a]        ;1249  ; period_cnt
000db4  e5901008          LDR      r1,[r0,#8]            ;1250
000db8  e3811402          ORR      r1,r1,#0x2000000      ;1250
000dbc  e5801008          STR      r1,[r0,#8]            ;1250
000dc0  e5901004          LDR      r1,[r0,#4]            ;1251
000dc4  e3811402          ORR      r1,r1,#0x2000000      ;1251
000dc8  e5801004          STR      r1,[r0,#4]            ;1251
000dcc  e1c2e0b0          STRH     lr,[r2,#0]
                  |L1.3536|
;;;1253   			}
;;;1254   		period_cnt++;
000dd0  e1dc12ba          LDRH     r1,[r12,#0x2a]  ; period_cnt
000dd4  e2811001          ADD      r1,r1,#1
000dd8  e1a01801          LSL      r1,r1,#16
000ddc  e1a01841          ASR      r1,r1,#16
;;;1255   		if(period_cnt>200)
000de0  e35100c8          CMP      r1,#0xc8
000de4  e1cc12ba          STRH     r1,[r12,#0x2a]        ;1254  ; period_cnt
;;;1256   			{
;;;1257   			adc_stat=asNET;
000de8  c5cc4000          STRBGT   r4,[r12,#0]  ; adc_stat
;;;1258   			period_cnt=0;
000dec  c1cce2ba          STRHGT   lr,[r12,#0x2a]  ; period_cnt
;;;1259   	//		IO0DIR|=(1<<25);
;;;1260   	//		IO0SET|=(1<<25);
;;;1261   			net_buff[net_buff_cnt]=0;
000df0  c1c2e0b0          STRHGT   lr,[r2,#0]
000df4  ea00005c          B        |L1.3948|
                  |L1.3576|
000df8  e59f71ac          LDR      r7,|L1.4012|
;;;1262   			}
;;;1263   		 }
;;;1264   
;;;1265   	else if(adc_stat==asNET)
000dfc  e3540004          CMP      r4,#4
000e00  e1d772ba          LDRH     r7,[r7,#0x2a]         ;1211
;;;1266   		{
;;;1267   
;;;1268   		net_buff[net_buff_cnt]+=ADWR;
;;;1269   		
;;;1270   		period_cnt++;
;;;1271   		if((ADWR<20)||(period_cnt>100))
;;;1272   			{
;;;1273   			adc_stat=asCH;
000e04  e3a05001          MOV      r5,#1
000e08  e2877001          ADD      r7,r7,#1              ;1233
000e0c  e1a07807          LSL      r7,r7,#16             ;1233
000e10  e1a07847          ASR      r7,r7,#16             ;1233
000e14  1a00001c          BNE      |L1.3724|
000e18  e1d240b0          LDRH     r4,[r2,#0]            ;1268
000e1c  e3510014          CMP      r1,#0x14              ;1271
000e20  e0844001          ADD      r4,r4,r1              ;1268
000e24  e1c240b0          STRH     r4,[r2,#0]            ;1268
000e28  e1cc72ba          STRH     r7,[r12,#0x2a]        ;1270  ; period_cnt
000e2c  ba000001          BLT      |L1.3640|
000e30  e3570064          CMP      r7,#0x64              ;1271
000e34  da00004c          BLE      |L1.3948|
                  |L1.3640|
;;;1274   			period_cnt=0;
;;;1275   	//		IO0DIR|=(1<<25);
;;;1276   	//		IO0CLR|=(1<<25);
;;;1277   			
;;;1278   			net_buff_cnt++;
000e38  e2881001          ADD      r1,r8,#1
000e3c  e20110ff          AND      r1,r1,#0xff
000e40  e5cc5000          STRB     r5,[r12,#0]           ;1273  ; adc_stat
000e44  e1cce2ba          STRH     lr,[r12,#0x2a]        ;1274  ; period_cnt
;;;1279   			if(net_buff_cnt>=32)
000e48  e3510020          CMP      r1,#0x20
000e4c  e5cc100c          STRB     r1,[r12,#0xc]         ;1278  ; net_buff_cnt
000e50  3a000045          BCC      |L1.3948|
;;;1280   				{
;;;1281   				unsigned long tempUL=0;
000e54  e3a02000          MOV      r2,#0
;;;1282   				char i;
;;;1283   				net_buff_cnt=0;
;;;1284   				tempUL=0;
;;;1285   				for(i=0;i<32;i++)
000e58  e1a01002          MOV      r1,r2
000e5c  e5cce00c          STRB     lr,[r12,#0xc]         ;1283  ; net_buff_cnt
                  |L1.3680|
;;;1286   					{
;;;1287   					tempUL+=net_buff[i];
000e60  e0864081          ADD      r4,r6,r1,LSL #1
000e64  e1d440b0          LDRH     r4,[r4,#0]
000e68  e2811001          ADD      r1,r1,#1              ;1285
000e6c  e20110ff          AND      r1,r1,#0xff           ;1285
000e70  e3510020          CMP      r1,#0x20              ;1285
000e74  e0822004          ADD      r2,r2,r4
000e78  3afffff8          BCC      |L1.3680|
;;;1288   					}
;;;1289   				net_buff_=(unsigned short)(tempUL>>5);	
000e7c  e1a01582          LSL      r1,r2,#11
000e80  e1a01821          LSR      r1,r1,#16
000e84  e1cc12b6          STRH     r1,[r12,#0x26]  ; net_buff_
;;;1290   				}
000e88  ea000037          B        |L1.3948|
                  |L1.3724|
;;;1291   		
;;;1292   			}
;;;1293   		}
;;;1294   
;;;1295   	else if(adc_stat==asCH)
000e8c  e3540001          CMP      r4,#1
000e90  1a000035          BNE      |L1.3948|
;;;1296   		{
;;;1297   		if(++period_cnt>=10)
000e94  e357000a          CMP      r7,#0xa
000e98  e1cc72ba          STRH     r7,[r12,#0x2a]  ; period_cnt
000e9c  ba000032          BLT      |L1.3948|
;;;1298   			{
;;;1299   			period_cnt=0;
000ea0  e1cce2ba          STRH     lr,[r12,#0x2a]  ; period_cnt
;;;1300   			adc_buff[adc_ch][adc_cnt]=ADWR;
000ea4  e5dc200b          LDRB     r2,[r12,#0xb]  ; adc_ch
000ea8  e59f41c8          LDR      r4,|L1.4216|
000eac  e5dc600a          LDRB     r6,[r12,#0xa]  ; adc_cnt
000eb0  e0847282          ADD      r7,r4,r2,LSL #5
;;;1301   		
;;;1302   			if(++adc_ch>=16) 
000eb4  e2822001          ADD      r2,r2,#1
000eb8  e0877086          ADD      r7,r7,r6,LSL #1       ;1300
000ebc  e1c710b0          STRH     r1,[r7,#0]            ;1300
000ec0  e20210ff          AND      r1,r2,#0xff
000ec4  e3510010          CMP      r1,#0x10
000ec8  e5cc100b          STRB     r1,[r12,#0xb]  ; adc_ch
;;;1303   				{
;;;1304   				adc_ch=0;
;;;1305   				adc_cnt++;
000ecc  22861001          ADDCS    r1,r6,#1
000ed0  220110ff          ANDCS    r1,r1,#0xff
000ed4  25cce00b          STRBCS   lr,[r12,#0xb]         ;1304  ; adc_ch
000ed8  25cc100a          STRBCS   r1,[r12,#0xa]  ; adc_cnt
;;;1306   				if(adc_cnt>=16)adc_cnt=0;
000edc  23510010          CMPCS    r1,#0x10
000ee0  25cce00a          STRBCS   lr,[r12,#0xa]  ; adc_cnt
;;;1307   				}	
;;;1308   
;;;1309   			if((adc_cnt&0x03)==0)
000ee4  e5dc100a          LDRB     r1,[r12,#0xa]  ; adc_cnt
000ee8  e3110003          TST      r1,#3
000eec  1a000010          BNE      |L1.3892|
000ef0  e5dc600b          LDRB     r6,[r12,#0xb]         ;1300
;;;1310   				{
;;;1311   				temp_S=0;
;;;1312   				for(i=0;i<16;i++)
;;;1313   					{
;;;1314   					temp_S+=adc_buff[adc_ch][i];
;;;1315   					adc_buff_[adc_ch]=temp_S>>4;
000ef4  e59f712c          LDR      r7,|L1.4136|
000ef8  e3a02000          MOV      r2,#0                 ;1311
000efc  e0844286          ADD      r4,r4,r6,LSL #5       ;1300
000f00  e1a01002          MOV      r1,r2                 ;1312
000f04  e0876086          ADD      r6,r7,r6,LSL #1
                  |L1.3848|
000f08  e0847081          ADD      r7,r4,r1,LSL #1       ;1314
000f0c  e1d770b0          LDRH     r7,[r7,#0]            ;1314
000f10  e2811001          ADD      r1,r1,#1              ;1312
000f14  e20110ff          AND      r1,r1,#0xff           ;1312
000f18  e0822007          ADD      r2,r2,r7              ;1314
000f1c  e1a02802          LSL      r2,r2,#16             ;1314
000f20  e1a02842          ASR      r2,r2,#16             ;1314
000f24  e1a07242          ASR      r7,r2,#4
000f28  e3510010          CMP      r1,#0x10              ;1312
000f2c  e1c670b0          STRH     r7,[r6,#0]
000f30  3afffff4          BCC      |L1.3848|
                  |L1.3892|
;;;1316   					}
;;;1317   				}
;;;1318   			
;;;1319   		
;;;1320   			if((adc_ch&0x03)==0) 
000f34  e5dc100b          LDRB     r1,[r12,#0xb]  ; adc_ch
000f38  e3110003          TST      r1,#3
000f3c  1a00000a          BNE      |L1.3948|
;;;1321   				{
;;;1322   				adc_stat=asNET_WAIT;
000f40  e3a01002          MOV      r1,#2
000f44  e5cc1000          STRB     r1,[r12,#0]  ; adc_stat
;;;1323   				IO0DIR|=(1<<25);
000f48  e5901008          LDR      r1,[r0,#8]
000f4c  e3811402          ORR      r1,r1,#0x2000000
000f50  e5801008          STR      r1,[r0,#8]
;;;1324   				IO0SET|=(1<<25);
000f54  e5901004          LDR      r1,[r0,#4]
000f58  e3811402          ORR      r1,r1,#0x2000000
000f5c  e5801004          STR      r1,[r0,#4]
;;;1325   				period_cnt=0;
000f60  e1cce2ba          STRH     lr,[r12,#0x2a]  ; period_cnt
;;;1326   				zero_cnt=0;
000f64  e1cce2b4          STRH     lr,[r12,#0x24]  ; zero_cnt
;;;1327   				bRELE_OUT=1;
000f68  e5cc500e          STRB     r5,[r12,#0xe]  ; bRELE_OUT
                  |L1.3948|
;;;1328   				}
;;;1329   			}
;;;1330   
;;;1331   
;;;1332   
;;;1333   
;;;1334   
;;;1335   
;;;1336   
;;;1337   
;;;1338   
;;;1339   
;;;1340   
;;;1341   
;;;1342   
;;;1343   
;;;1344   
;;;1345   
;;;1346   
;;;1347   
;;;1348   
;;;1349   
;;;1350   /*		adc_stat=asNET_WAIT;
;;;1351   		period_cnt=0;
;;;1352   		zero_cnt=0;*/
;;;1353   
;;;1354   
;;;1355   		} 
;;;1356   
;;;1357   
;;;1358   
;;;1359   
;;;1360   
;;;1361   /*	if(ADWR>20)
;;;1362   		{
;;;1363   				IO0DIR|=(1<<25);
;;;1364   				IO0SET|=(1<<25);
;;;1365   		}
;;;1366   	if(ADWR<20)
;;;1367   		{
;;;1368   				IO0DIR|=(1<<25);
;;;1369   				IO0CLR|=(1<<25);		} */
;;;1370   	
;;;1371    /*
;;;1372   	if(adc_stat==asNET_WAIT)
;;;1373   		{
;;;1374   		period_cnt++;
;;;1375   		
;;;1376   
;;;1377   		if((period_cnt>200)||((ADWR>100)&&(zero_cnt>10)))
;;;1378   			{
;;;1379   			adc_stat=asNET;
;;;1380   			net_buff[net_buff_cnt]=0;
;;;1381   			IO0CLR|=(1<<25);
;;;1382   			}
;;;1383   		}	
;;;1384   	else if(adc_stat==asNET)
;;;1385   		{
;;;1386   		net_buff[net_buff_cnt]+=ADWR;
;;;1387   		
;;;1388   		if((ADWR<100)||(++period_cnt>300))
;;;1389   			{
;;;1390   			adc_stat=asCH;
;;;1391   			period_cnt=0;
;;;1392   			net_buff_cnt++;
;;;1393   			if(net_buff_cnt>=32)
;;;1394   				{
;;;1395   				unsigned long tempUL=0;
;;;1396   				char i;
;;;1397   				net_buff_cnt=0;
;;;1398   				tempUL=0;
;;;1399   				for(i=0;i<32;i++)
;;;1400   					{
;;;1401   					tempUL+=net_buff[i];
;;;1402   					}
;;;1403   				net_buff_=(unsigned short)(tempUL>>5);	
;;;1404   				}
;;;1405   			net_buff[net_buff_cnt]=0;
;;;1406   			}	
;;;1407   		}
;;;1408   	else if(adc_stat==asCH)
;;;1409   		{
;;;1410   		if(++period_cnt>=20)
;;;1411   			{
;;;1412   			period_cnt=0;
;;;1413   			adc_buff[adc_ch][adc_cnt]=ADWR;
;;;1414   		
;;;1415   			if((adc_cnt&0x03)==0)
;;;1416   				{
;;;1417   				temp_S=0;
;;;1418   				for(i=0;i<16;i++)
;;;1419   					{
;;;1420   					temp_S+=adc_buff[adc_ch][i];
;;;1421   					adc_buff_[adc_ch]=temp_S>>4;
;;;1422   					}
;;;1423   				}
;;;1424   			if(++adc_ch>=16) 
;;;1425   				{
;;;1426   				adc_ch=0;
;;;1427   				adc_cnt++;
;;;1428   				if(adc_cnt>=16)adc_cnt=0;
;;;1429   				}	
;;;1430   		
;;;1431   			if((adc_ch&0x01)==0) 
;;;1432   				{
;;;1433   				adc_stat=asNET_WAIT;
;;;1434   				period_cnt=0;
;;;1435   				zero_cnt=0;
;;;1436   				//bRELE_OUT=1;
;;;1437   				}
;;;1438   			}*//*
;;;1439   				adc_stat=asNET_WAIT;
;;;1440   				period_cnt=0;
;;;1441   				zero_cnt=0;
;;;1442   				IO0DIR|=(1<<25);
;;;1443   				IO0SET|=(1<<25);								
;;;1444   		}				    */	
;;;1445   	} 
;;;1446   	
;;;1447   
;;;1448   
;;;1449   
;;;1450   
;;;1451   
;;;1452   
;;;1453   /*
;;;1454   if(adc_ch&0x02)	SET_REG(IO0SET,1,5,1);
;;;1455   else 			SET_REG(IO0CLR,1,5,1);
;;;1456   if(adc_ch&0x04)	SET_REG(IO0SET,1,6,1);
;;;1457   else 			SET_REG(IO0CLR,1,6,1);
;;;1458   if(adc_ch&0x08)	SET_REG(IO0SET,1,4,1);
;;;1459   else 			SET_REG(IO0CLR,1,4,1); 
;;;1460   								  */
;;;1461   /*
;;;1462   ADCR|=(1<<21);
;;;1463   ADCR=(ADCR&0xffff00ff)|(14<<8);
;;;1464   ADCR=(ADCR&0xfffeffff)|(1<<16);
;;;1465   ADCR&=0xfff1ffff;
;;;1466   ADCR&=0xff3fffff;
;;;1467   
;;;1468   
;;;1469   
;;;1470   PINSEL2&=~(1<<18);
;;;1471   PINSEL2&=~(1<<19);*/
;;;1472   
;;;1473   
;;;1474   IO1DIR|=(1<<25);
000f6c  e5901018          LDR      r1,[r0,#0x18]
000f70  e3811402          ORR      r1,r1,#0x2000000
000f74  e5801018          STR      r1,[r0,#0x18]
;;;1475   IO1SET|=(1<<25);
000f78  e5901014          LDR      r1,[r0,#0x14]
000f7c  e3811402          ORR      r1,r1,#0x2000000
000f80  e5801014          STR      r1,[r0,#0x14]
;;;1476   
;;;1477   if(bRELE_OUT==1)
000f84  e5dc100e          LDRB     r1,[r12,#0xe]  ; bRELE_OUT
000f88  e3510001          CMP      r1,#1
000f8c  1a000084          BNE      |L1.4516|
;;;1478   	{
;;;1479   	char i,temp;
;;;1480   /*	IO1DIR|=(1<<25);
;;;1481   	IO1CLR|=(1<<25);*/
;;;1482   	IO0CLR|=(1<<6);
000f90  e590100c          LDR      r1,[r0,#0xc]
000f94  e3811040          ORR      r1,r1,#0x40
000f98  e580100c          STR      r1,[r0,#0xc]
;;;1483   	IO0CLR|=(1<<6);
000f9c  e590100c          LDR      r1,[r0,#0xc]
000fa0  e3811040          ORR      r1,r1,#0x40
000fa4  e580100c          STR      r1,[r0,#0xc]
;;;1484   	IO0CLR|=(1<<6);
000fa8  ea000033          B        |L1.4220|
                  |L1.4012|
                          DCD      ||.data||
                  |L1.4016|
                          DCD      month__
                  |L1.4020|
                          DCD      AVZ
                  |L1.4024|
                          DCD      year__
                  |L1.4028|
                          DCD      day__
                  |L1.4032|
                          DCD      hour__
                  |L1.4036|
                          DCD      min__
                  |L1.4040|
                          DCD      sec__
                  |L1.4044|
                          DCD      YEAR_AVZ
                  |L1.4048|
                          DCD      MONTH_AVZ
                  |L1.4052|
                          DCD      DATE_AVZ
                  |L1.4056|
                          DCD      HOUR_AVZ
                  |L1.4060|
                          DCD      MIN_AVZ
                  |L1.4064|
                          DCD      SEC_AVZ
                  |L1.4068|
                          DCD      AVZ_TIME
                  |L1.4072|
                          DCD      TBAT
                  |L1.4076|
                          DCD      bat
                  |L1.4080|
                          DCD      IKB
                  |L1.4084|
                          DCD      BAT_IS_ON
                  |L1.4088|
                          DCD      ||.data||+0x54
                  |L1.4092|
                          DCD      ||.data||+0x58
                  |L1.4096|
                          DCD      mess_data
                  |L1.4100|
                          DCD      0x000006f9
                  |L1.4104|
                          DCD      0x00000708
                  |L1.4108|
                          DCD      Kibat0
                  |L1.4112|
                          DCD      ad7705_buff_
                  |L1.4116|
                          DCD      ADR_KI0BAT
                  |L1.4120|
                          DCD      bat_u_old_cnt
                  |L1.4124|
                          DCD      UMN
                  |L1.4128|
                          DCD      Kunet
                  |L1.4132|
                          DCD      0x0001adb0
                  |L1.4136|
                          DCD      ||.bss||+0x200
                  |L1.4140|
                          DCD      Kubat
                  |L1.4144|
                          DCD      Kibat1
                  |L1.4148|
                          DCD      0x0000031f
                  |L1.4152|
                          DCD      Ktbat
                  |L1.4156|
                          DCD      0x00001388
                  |L1.4160|
                          DCD      Kuload
                  |L1.4164|
                          DCD      load_U
                  |L1.4168|
                          DCD      ||.data||+0x5c
                  |L1.4172|
                          DCD      0x00000257
                  |L1.4176|
                          DCD      ND_out
                  |L1.4180|
                          DCD      Ktout
                  |L1.4184|
                          DCD      tout
                  |L1.4188|
                          DCD      bps
                  |L1.4192|
                          DCD      NUMIST
                  |L1.4196|
                          DCD      load_I
                  |L1.4200|
                          DCD      Isumm
                  |L1.4204|
                          DCD      0xe002c000
                  |L1.4208|
                          DCD      0xe0034000
                  |L1.4212|
                          DCD      ||.bss||+0x220
                  |L1.4216|
                          DCD      ||.bss||
                  |L1.4220|
00107c  e590100c          LDR      r1,[r0,#0xc]
001080  e3811040          ORR      r1,r1,#0x40
001084  e580100c          STR      r1,[r0,#0xc]
;;;1485   	IO0CLR|=(1<<6);
001088  e590100c          LDR      r1,[r0,#0xc]
00108c  e3811040          ORR      r1,r1,#0x40
001090  e580100c          STR      r1,[r0,#0xc]
;;;1486   	IO0CLR|=(1<<6);
001094  e590100c          LDR      r1,[r0,#0xc]
001098  e3811040          ORR      r1,r1,#0x40
00109c  e580100c          STR      r1,[r0,#0xc]
;;;1487   	IO0CLR|=(1<<6);
0010a0  e590100c          LDR      r1,[r0,#0xc]
0010a4  e3811040          ORR      r1,r1,#0x40
0010a8  e580100c          STR      r1,[r0,#0xc]
;;;1488   	IO0CLR|=(1<<6);
0010ac  e590100c          LDR      r1,[r0,#0xc]
0010b0  e3811040          ORR      r1,r1,#0x40
0010b4  e580100c          STR      r1,[r0,#0xc]
;;;1489   	IO0CLR|=(1<<6);
0010b8  e590100c          LDR      r1,[r0,#0xc]
0010bc  e3811040          ORR      r1,r1,#0x40
0010c0  e580100c          STR      r1,[r0,#0xc]
;;;1490   	IO0CLR|=(1<<6);
0010c4  e590100c          LDR      r1,[r0,#0xc]
0010c8  e3811040          ORR      r1,r1,#0x40
0010cc  e580100c          STR      r1,[r0,#0xc]
;;;1491   	IO0CLR|=(1<<6);
0010d0  e590100c          LDR      r1,[r0,#0xc]
0010d4  e3811040          ORR      r1,r1,#0x40
0010d8  e580100c          STR      r1,[r0,#0xc]
;;;1492   	
;;;1493   	bRELE_OUT=0;
0010dc  e5cce00e          STRB     lr,[r12,#0xe]  ; bRELE_OUT
;;;1494   //	rele_stat=1;
;;;1495   	temp=rele_stat;
0010e0  e5dc200d          LDRB     r2,[r12,#0xd]  ; rele_stat
;;;1496   	for(i=0;i<8;i++)
0010e4  e3a01000          MOV      r1,#0
                  |L1.4328|
;;;1497   		{
;;;1498   		if(temp&0x80)IO0SET|=(1<<4);
0010e8  e3120080          TST      r2,#0x80
;;;1499   		else IO0CLR|=(1<<4);
0010ec  0590e00c          LDREQ    lr,[r0,#0xc]
0010f0  1590e004          LDRNE    lr,[r0,#4]            ;1498
0010f4  e38ee010          ORR      lr,lr,#0x10
0010f8  0580e00c          STREQ    lr,[r0,#0xc]
0010fc  1580e004          STRNE    lr,[r0,#4]            ;1498
;;;1500   		__nop(); 
001100  e1a00000          MOV      r0,r0
;;;1501   		__nop();
001104  e1a00000          MOV      r0,r0
;;;1502   		__nop();
001108  e1a00000          MOV      r0,r0
;;;1503   		__nop();
00110c  e1a00000          MOV      r0,r0
;;;1504   		IO0SET|=(1<<6);
001110  e590e004          LDR      lr,[r0,#4]
;;;1505   		__nop();
001114  e1a00000          MOV      r0,r0
001118  e38ee040          ORR      lr,lr,#0x40           ;1504
00111c  e580e004          STR      lr,[r0,#4]            ;1504
;;;1506   		__nop();
001120  e1a00000          MOV      r0,r0
;;;1507   		__nop();
001124  e1a00000          MOV      r0,r0
;;;1508   		__nop();
001128  e1a00000          MOV      r0,r0
;;;1509   		__nop(); 
00112c  e1a00000          MOV      r0,r0
;;;1510   		__nop();
001130  e1a00000          MOV      r0,r0
;;;1511   		__nop();
001134  e1a00000          MOV      r0,r0
;;;1512   		__nop();
001138  e1a00000          MOV      r0,r0
;;;1513   		IO0CLR|=(1<<6);
00113c  e590e00c          LDR      lr,[r0,#0xc]
;;;1514   		__nop();
001140  e1a00000          MOV      r0,r0
001144  e38ee040          ORR      lr,lr,#0x40           ;1513
001148  e580e00c          STR      lr,[r0,#0xc]          ;1513
;;;1515   		__nop();
00114c  e1a00000          MOV      r0,r0
;;;1516   		__nop();
001150  e1a00000          MOV      r0,r0
;;;1517   		__nop();
001154  e1a00000          MOV      r0,r0
001158  e2811001          ADD      r1,r1,#1              ;1496
;;;1518   		temp<<=1;		
00115c  e1a02c82          LSL      r2,r2,#25
001160  e20110ff          AND      r1,r1,#0xff           ;1496
001164  e3510008          CMP      r1,#8                 ;1496
001168  e1a02c22          LSR      r2,r2,#24
00116c  3affffdd          BCC      |L1.4328|
;;;1519   		}
;;;1520   	IO1DIR|=(1<<25);
001170  e5901018          LDR      r1,[r0,#0x18]
001174  e3811402          ORR      r1,r1,#0x2000000
001178  e5801018          STR      r1,[r0,#0x18]
;;;1521   	IO1CLR|=(1<<25);		
00117c  e590101c          LDR      r1,[r0,#0x1c]
001180  e3811402          ORR      r1,r1,#0x2000000
001184  e580101c          STR      r1,[r0,#0x1c]
;;;1522   	IO1DIR|=(1<<25);
001188  e5901018          LDR      r1,[r0,#0x18]
00118c  e3811402          ORR      r1,r1,#0x2000000
001190  e5801018          STR      r1,[r0,#0x18]
;;;1523   	IO1SET|=(1<<25);
001194  e5901014          LDR      r1,[r0,#0x14]
001198  e3811402          ORR      r1,r1,#0x2000000
00119c  e5801014          STR      r1,[r0,#0x14]
;;;1524   
;;;1525   	
;;;1526   		
;;;1527   	}
0011a0  ea000012          B        |L1.4592|
                  |L1.4516|
;;;1528   else 
;;;1529   	{
;;;1530   
;;;1531   	if(adc_ch&0x02)	SET_REG(IO0SET,1,5,1);
0011a4  e5dc100b          LDRB     r1,[r12,#0xb]  ; adc_ch
0011a8  e3110002          TST      r1,#2
;;;1532   	else 			SET_REG(IO0CLR,1,5,1);
0011ac  0590200c          LDREQ    r2,[r0,#0xc]
0011b0  15902004          LDRNE    r2,[r0,#4]            ;1531
0011b4  e3822020          ORR      r2,r2,#0x20
0011b8  0580200c          STREQ    r2,[r0,#0xc]
0011bc  15802004          STRNE    r2,[r0,#4]            ;1531
;;;1533   	if(adc_ch&0x04)	SET_REG(IO0SET,1,6,1);
0011c0  e3110004          TST      r1,#4
;;;1534   	else 			SET_REG(IO0CLR,1,6,1);
0011c4  0590200c          LDREQ    r2,[r0,#0xc]
0011c8  15902004          LDRNE    r2,[r0,#4]            ;1533
0011cc  e3822040          ORR      r2,r2,#0x40
0011d0  0580200c          STREQ    r2,[r0,#0xc]
0011d4  15802004          STRNE    r2,[r0,#4]            ;1533
;;;1535   	if(adc_ch&0x08)	SET_REG(IO0SET,1,4,1);
0011d8  e3110008          TST      r1,#8
;;;1536   	else 			SET_REG(IO0CLR,1,4,1); 
0011dc  0590100c          LDREQ    r1,[r0,#0xc]
0011e0  15901004          LDRNE    r1,[r0,#4]            ;1535
0011e4  e3811010          ORR      r1,r1,#0x10
0011e8  0580100c          STREQ    r1,[r0,#0xc]
0011ec  15801004          STRNE    r1,[r0,#4]            ;1535
                  |L1.4592|
;;;1537   
;;;1538   	}	
;;;1539   	
;;;1540   if((adc_stat==asNET)
0011f0  e5dc0000          LDRB     r0,[r12,#0]  ; adc_stat
0011f4  e3500004          CMP      r0,#4
;;;1541   ||(adc_stat==asNET_WAIT)
0011f8  13500002          CMPNE    r0,#2
;;;1542   ||(adc_stat==asNET_RDY)) 	SET_REG(ADCR,2,0,8);
0011fc  13500003          CMPNE    r0,#3
001200  05930000          LDREQ    r0,[r3,#0]
001204  03c000ff          BICEQ    r0,r0,#0xff
001208  03800002          ORREQ    r0,r0,#2
00120c  0a000005          BEQ      |L1.4648|
;;;1543   else if(adc_ch&0x01)		SET_REG(ADCR,8,0,8);
001210  e5dc000b          LDRB     r0,[r12,#0xb]  ; adc_ch
001214  e3100001          TST      r0,#1
001218  e5930000          LDR      r0,[r3,#0]
00121c  e3c000ff          BIC      r0,r0,#0xff
;;;1544   else 					SET_REG(ADCR,4,0,8); 
001220  03800004          ORREQ    r0,r0,#4
001224  13800008          ORRNE    r0,r0,#8              ;1543
                  |L1.4648|
001228  e5830000          STR      r0,[r3,#0]            ;1543
;;;1545   					   
;;;1546   SET_REG(ADCR,1,24,3);	//START=1;
00122c  e5930000          LDR      r0,[r3,#0]
001230  e3c00407          BIC      r0,r0,#0x7000000
001234  e3800401          ORR      r0,r0,#0x1000000
001238  e5830000          STR      r0,[r3,#0]
;;;1547   }
00123c  e8bd41f0          POP      {r4-r8,lr}
001240  e12fff1e          BX       lr
;;;1548    /*
                          ENDP

                  avg_hndl PROC
;;;1616   //-----------------------------------------------
;;;1617   void avg_hndl(void)
001244  e92d47f0          PUSH     {r4-r10,lr}
;;;1618   { 
;;;1619   char i;
;;;1620   
;;;1621   #define AVGCNTMAX	5
;;;1622   if(avg_main_cnt)
001248  e51f62a4          LDR      r6,|L1.4012|
00124c  e1d601fe          LDRSH    r0,[r6,#0x1e]  ; avg_main_cnt
001250  e3500000          CMP      r0,#0
;;;1623   	{
;;;1624   	avg_main_cnt--;
001254  12400001          SUBNE    r0,r0,#1
001258  11c601be          STRHNE   r0,[r6,#0x1e]  ; avg_main_cnt
;;;1625   	goto avg_hndl_end;
00125c  1a000069          BNE      |L1.5128|
;;;1626   	}                 
;;;1627   
;;;1628   avg_num=0;
001260  e3a07000          MOV      r7,#0
;;;1629   
;;;1630   for(i=0;i<NUMIST;i++)
001264  e51f120c          LDR      r1,|L1.4192|
001268  e5c67010          STRB     r7,[r6,#0x10]         ;1628  ; avg_num
;;;1631   	{
;;;1632   	if((bps[i]._state==bsWRK)&&(bps[i]._cnt<20))avg_num++;
00126c  e51f5218          LDR      r5,|L1.4188|
001270  e1d140f0          LDRSH    r4,[r1,#0]            ;1630
001274  e1a00007          MOV      r0,r7                 ;1630
001278  ea00000c          B        |L1.4784|
                  |L1.4732|
00127c  e0601180          RSB      r1,r0,r0,LSL #3
001280  e0811081          ADD      r1,r1,r1,LSL #1
001284  e0851101          ADD      r1,r5,r1,LSL #2
001288  e5d12002          LDRB     r2,[r1,#2]
00128c  e3520001          CMP      r2,#1
001290  1a000004          BNE      |L1.4776|
001294  e5d11003          LDRB     r1,[r1,#3]
001298  e3510014          CMP      r1,#0x14
00129c  35d61010          LDRBCC   r1,[r6,#0x10]  ; avg_num
0012a0  32811001          ADDCC    r1,r1,#1
0012a4  35c61010          STRBCC   r1,[r6,#0x10]  ; avg_num
                  |L1.4776|
0012a8  e2800001          ADD      r0,r0,#1              ;1630
0012ac  e20000ff          AND      r0,r0,#0xff           ;1630
                  |L1.4784|
0012b0  e1500004          CMP      r0,r4                 ;1630
0012b4  bafffff0          BLT      |L1.4732|
;;;1633   	}
;;;1634   
;;;1635   /*if((K[NUMI]>=1)&&(bps_state[0]==ssWRK))	avg_num++;
;;;1636   if((K[NUMI]>=2)&&(bps_state[1]==ssWRK))	avg_num++;
;;;1637   if((K[NUMI]>=3)&&(bps_state[2]==ssWRK))	avg_num++;*/
;;;1638   
;;;1639   	
;;;1640   if(avg_num<2)
0012b8  e5d61010          LDRB     r1,[r6,#0x10]  ; avg_num
0012bc  e3510002          CMP      r1,#2
0012c0  3a000050          BCC      |L1.5128|
;;;1641   	{
;;;1642   	goto avg_hndl_end;
;;;1643   	}
;;;1644   	
;;;1645   else
;;;1646   	{
;;;1647   	i_avg_min=5000;
0012c4  e51f0290          LDR      r0,|L1.4156|
;;;1648   	i_avg_max=0;
;;;1649   	i_avg_summ=0;
;;;1650   	for(i=0;i<NUMIST;i++)
0012c8  e3a02000          MOV      r2,#0
0012cc  e1c603b6          STRH     r0,[r6,#0x36]         ;1647  ; i_avg_min
0012d0  e1c673b4          STRH     r7,[r6,#0x34]         ;1648  ; i_avg_max
0012d4  e1c673b8          STRH     r7,[r6,#0x38]         ;1649  ; i_avg_summ
0012d8  ea000011          B        |L1.4900|
                  |L1.4828|
;;;1651   		{
;;;1652   		if(bps[i]._state==bsWRK)
0012dc  e0620182          RSB      r0,r2,r2,LSL #3
0012e0  e0800080          ADD      r0,r0,r0,LSL #1
0012e4  e0850100          ADD      r0,r5,r0,LSL #2
0012e8  e5d03002          LDRB     r3,[r0,#2]
0012ec  e3530001          CMP      r3,#1
0012f0  1a000009          BNE      |L1.4892|
;;;1653   			{
;;;1654   			if(bps[i]._Ii>i_avg_max)i_avg_max=bps[i]._Ii;
0012f4  e1d633f4          LDRSH    r3,[r6,#0x34]  ; i_avg_max
0012f8  e5900020          LDR      r0,[r0,#0x20]
0012fc  e1500003          CMP      r0,r3
001300  c1c603b4          STRHGT   r0,[r6,#0x34]  ; i_avg_max
;;;1655   			if(bps[i]._Ii<i_avg_min)i_avg_min=bps[i]._Ii;
001304  e1d633f6          LDRSH    r3,[r6,#0x36]  ; i_avg_min
001308  e1500003          CMP      r0,r3
00130c  b1c603b6          STRHLT   r0,[r6,#0x36]  ; i_avg_min
;;;1656   			
;;;1657   			i_avg_summ+=bps[i]._Ii;
001310  e1d633b8          LDRH     r3,[r6,#0x38]  ; i_avg_summ
001314  e0800003          ADD      r0,r0,r3
001318  e1c603b8          STRH     r0,[r6,#0x38]  ; i_avg_summ
                  |L1.4892|
00131c  e2820001          ADD      r0,r2,#1              ;1650
001320  e20020ff          AND      r2,r0,#0xff           ;1650
                  |L1.4900|
001324  e1520004          CMP      r2,r4                 ;1650
001328  baffffeb          BLT      |L1.4828|
;;;1658   			}
;;;1659   		}
;;;1660   	i_avg=i_avg_summ/avg_num;	
00132c  e1d603f8          LDRSH    r0,[r6,#0x38]  ; i_avg_summ
001330  ebfffffe          BL       __aeabi_idivmod
001334  e1a08800          LSL      r8,r0,#16
001338  e1a08848          ASR      r8,r8,#16
00133c  e1c683ba          STRH     r8,[r6,#0x3a]  ; i_avg
;;;1661   	
;;;1662   	if(i_avg_min==0)i_avg_min=1;
001340  e1d603b6          LDRH     r0,[r6,#0x36]  ; i_avg_min
001344  e3a09001          MOV      r9,#1                 ;1632
;;;1663   
;;;1664   	avg=i_avg_max;
;;;1665   	avg*=100;
001348  e3a01064          MOV      r1,#0x64
00134c  e3500000          CMP      r0,#0                 ;1662
001350  01c693b6          STRHEQ   r9,[r6,#0x36]         ;1662  ; i_avg_min
001354  e1d603b4          LDRH     r0,[r6,#0x34]         ;1664  ; i_avg_max
001358  e0000091          MUL      r0,r1,r0
00135c  e1a00800          LSL      r0,r0,#16
;;;1666   	avg/=i_avg_min;
001360  e1d613f6          LDRSH    r1,[r6,#0x36]  ; i_avg_min
001364  e1a00840          ASR      r0,r0,#16             ;1665
001368  ebfffffe          BL       __aeabi_idivmod
00136c  e1a00800          LSL      r0,r0,#16
001370  e1a00840          ASR      r0,r0,#16
;;;1667   
;;;1668   	if(avg>160) bAVG=1;
001374  e35000a0          CMP      r0,#0xa0
001378  e1c603bc          STRH     r0,[r6,#0x3c]         ;1666  ; avg
00137c  c5c6900f          STRBGT   r9,[r6,#0xf]  ; bAVG
;;;1669   	if(avg<120) bAVG=0;
001380  e3500078          CMP      r0,#0x78
001384  b5c6700f          STRBLT   r7,[r6,#0xf]  ; bAVG
001388  ba00001e          BLT      |L1.5128|
;;;1670   
;;;1671   	if(bAVG==1)
00138c  e5d6000f          LDRB     r0,[r6,#0xf]  ; bAVG
001390  e3500001          CMP      r0,#1
001394  1a00001b          BNE      |L1.5128|
;;;1672   		{
;;;1673   		for(i=0;i<NUMIST;i++)
001398  e3a01000          MOV      r1,#0
00139c  ea000017          B        |L1.5120|
                  |L1.5024|
;;;1674   			{
;;;1675   			if(bps[i]._state==bsWRK)
0013a0  e0610181          RSB      r0,r1,r1,LSL #3
0013a4  e0800080          ADD      r0,r0,r0,LSL #1
0013a8  e0850100          ADD      r0,r5,r0,LSL #2
0013ac  e5d02002          LDRB     r2,[r0,#2]
0013b0  e3520001          CMP      r2,#1
0013b4  1a00000f          BNE      |L1.5112|
;;;1676   				{
;;;1677   				if(bps[i]._Ii>i_avg)bps[i]._x_--;
0013b8  e5902020          LDR      r2,[r0,#0x20]
0013bc  e1520008          CMP      r2,r8
0013c0  c1d025b0          LDRHGT   r2,[r0,#0x50]
0013c4  c2422001          SUBGT    r2,r2,#1
0013c8  c1c025b0          STRHGT   r2,[r0,#0x50]
;;;1678   				if(bps[i]._Ii<i_avg)bps[i]._x_++;
0013cc  b1d025b0          LDRHLT   r2,[r0,#0x50]
0013d0  b2822001          ADDLT    r2,r2,#1
0013d4  b1c025b0          STRHLT   r2,[r0,#0x50]
;;;1679   			
;;;1680   				if(bps[i]._x_<-50)bps[i]._x_=-50;
0013d8  e1d025f0          LDRSH    r2,[r0,#0x50]
0013dc  e3720032          CMN      r2,#0x32
0013e0  b3e02031          MVNLT    r2,#0x31
0013e4  ba000002          BLT      |L1.5108|
;;;1681   				if(bps[i]._x_>50)bps[i]._x_=50;	
0013e8  e3520032          CMP      r2,#0x32
0013ec  da000001          BLE      |L1.5112|
0013f0  e3a02032          MOV      r2,#0x32
                  |L1.5108|
0013f4  e1c025b0          STRH     r2,[r0,#0x50]         ;1680
                  |L1.5112|
0013f8  e2810001          ADD      r0,r1,#1              ;1673
0013fc  e20010ff          AND      r1,r0,#0xff           ;1673
                  |L1.5120|
001400  e1510004          CMP      r1,r4                 ;1673
001404  baffffe5          BLT      |L1.5024|
                  |L1.5128|
;;;1682   				}
;;;1683   			}		
;;;1684   		}			
;;;1685   	}   	 
;;;1686   
;;;1687   
;;;1688   avg_hndl_end:
;;;1689   __nop();  
001408  e1a00000          MOV      r0,r0
;;;1690   }
00140c  e8bd47f0          POP      {r4-r10,lr}
001410  e12fff1e          BX       lr
;;;1691   
                          ENDP

                  rele_hndl PROC
;;;1704   //-----------------------------------------------
;;;1705   void rele_hndl(void)
001414  e92d41f0          PUSH     {r4-r8,lr}
;;;1706   {
;;;1707   static char cnt_rel_sam;
;;;1708   char temp;
;;;1709   /*if(mess_find(MESS_BAT1_OFF))rele_stat|=(1<<6);
;;;1710   else rele_stat&=(~(1<<6));
;;;1711   
;;;1712   if(mess_find(MESS_BAT2_OFF))rele_stat|=(1<<4);
;;;1713   else rele_stat&=(~(1<<4));*/
;;;1714   
;;;1715   /*if(mess_find(MESS_BAT_CONTROL))
;;;1716   	{
;;;1717   	if(mess_data[0]&0x0001)cnt_rel_bat[0]=20;//rele_stat|=(1<<6);
;;;1718   	if(mess_data[0]&0x0002)cnt_rel_bat[1]=20;//rele_stat|=(1<<4);
;;;1719   	if(mess_data[1]&0x0001)
;;;1720   		{
;;;1721   		cnt_rel_bat[0]=0;
;;;1722   		rele_stat&=(~(1<<6));
;;;1723   		}
;;;1724   	if(mess_data[1]&0x0002)
;;;1725   		{
;;;1726   		cnt_rel_bat[1]=0;
;;;1727   		rele_stat&=(~(1<<4));
;;;1728   		}
;;;1729   	}*/
;;;1730   //else rele_stat&=(~(1<<4))&(~(1<<6));	
;;;1731   
;;;1732   if(mess_find(MESS_RELSAM_ON))
001418  e3a00005          MOV      r0,#5
00141c  ebfffffe          BL       mess_find
;;;1733   	{
;;;1734   	cnt_rel_sam=10;
001420  e51f547c          LDR      r5,|L1.4012|
001424  e3500000          CMP      r0,#0                 ;1732
001428  13a0000a          MOVNE    r0,#0xa
00142c  15c50002          STRBNE   r0,[r5,#2]  ; cnt_rel_sam
;;;1735   	//IO1DIR=(1UL<<21);
;;;1736   	//IO1SET=(1UL<<21);
;;;1737   	}
;;;1738   /*else
;;;1739   	{
;;;1740   	if(mess_find(MESS_BAT_CONTROL))
;;;1741   	{	*/
;;;1742   /*
;;;1743   if(cnt_rel_bat[0])
;;;1744   	{
;;;1745   	cnt_rel_bat[0]--;
;;;1746   	rele_stat&=(~(1<<6));
;;;1747   	if(!cnt_rel_bat[0])rele_stat|=(1<<6);
;;;1748   	}
;;;1749   
;;;1750   
;;;1751   if(cnt_rel_bat[1])
;;;1752   	{
;;;1753   	cnt_rel_bat[1]--;
;;;1754   	rele_stat&=(~(1<<4));
;;;1755   	if(!cnt_rel_bat[1])rele_stat|=(1<<4);
;;;1756   	}*/
;;;1757   
;;;1758   
;;;1759   temp=0;
;;;1760   
;;;1761   if(bat[0]._rel_stat)
001430  e51f044c          LDR      r0,|L1.4076|
001434  e3a04000          MOV      r4,#0                 ;1759
001438  e5d01034          LDRB     r1,[r0,#0x34]  ; bat
;;;1762   	{
;;;1763   	temp|=(1<<SHIFT_REL_BAT1);
;;;1764   	}  
;;;1765   //else rele_stat&=(~(1<<6));	
;;;1766   
;;;1767   if(bat[1]._rel_stat)
00143c  e5d00070          LDRB     r0,[r0,#0x70]  ; bat
;;;1768   	{
;;;1769   	temp|=(1<<SHIFT_REL_BAT2);
;;;1770   	}
;;;1771   //else rele_stat&=(~(1<<4));
;;;1772   
;;;1773   
;;;1774   
;;;1775   if(cnt_rel_sam) cnt_rel_sam--;
;;;1776   
;;;1777   IODIR1|=(1UL<<21);	
001440  e59f6f0c          LDR      r6,|L1.9044|
001444  e3510000          CMP      r1,#0                 ;1761
001448  13a04040          MOVNE    r4,#0x40              ;1763
00144c  e3500000          CMP      r0,#0                 ;1767
001450  e5d50002          LDRB     r0,[r5,#2]            ;1775  ; cnt_rel_sam
001454  13844010          ORRNE    r4,r4,#0x10           ;1769
001458  e3500000          CMP      r0,#0                 ;1775
00145c  12400001          SUBNE    r0,r0,#1              ;1775
001460  15c50002          STRBNE   r0,[r5,#2]            ;1775  ; cnt_rel_sam
001464  e5960018          LDR      r0,[r6,#0x18]
001468  e3800602          ORR      r0,r0,#0x200000
00146c  e5860018          STR      r0,[r6,#0x18]
;;;1778   if(mess_find_unvol((MESS2RELE_HNDL))&&(PARAM_RELE_SAMOKALIBR_ENABLE)) IOSET1=(1UL<<21);
001470  e3a000d2          MOV      r0,#0xd2
001474  ebfffffe          BL       mess_find_unvol
001478  e3500000          CMP      r0,#0
;;;1779   else if (cnt_rel_sam) IOSET1=(1UL<<21);
00147c  05d50002          LDRBEQ   r0,[r5,#2]  ; cnt_rel_sam
001480  e3a01602          MOV      r1,#0x200000          ;1778
001484  03500000          CMPEQ    r0,#0
001488  15861014          STRNE    r1,[r6,#0x14]
;;;1780   else IOCLR1=(1UL<<21);
00148c  0586101c          STREQ    r1,[r6,#0x1c]
;;;1781   
;;;1782   
;;;1783   
;;;1784   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV))
001490  e3a000d2          MOV      r0,#0xd2
001494  ebfffffe          BL       mess_find_unvol
;;;1785   	{
;;;1786   	if(mess_data[1]==0) temp|=(1<<SHIFT_REL_AV);
;;;1787   	}
;;;1788   else 
;;;1789   	{
;;;1790   	if(!(avar_ind_stat)) temp|=(1<<SHIFT_REL_AV);
001498  e59f7eb8          LDR      r7,|L1.9048|
00149c  e51f64a4          LDR      r6,|L1.4096|
0014a0  e3500000          CMP      r0,#0                 ;1784
0014a4  0a000003          BEQ      |L1.5304|
0014a8  e5960000          LDR      r0,[r6,#0]            ;1784  ; mess_data
0014ac  e3500065          CMP      r0,#0x65              ;1784
0014b0  05960004          LDREQ    r0,[r6,#4]            ;1786  ; mess_data
0014b4  0a000000          BEQ      |L1.5308|
                  |L1.5304|
0014b8  e5970000          LDR      r0,[r7,#0]  ; avar_ind_stat
                  |L1.5308|
0014bc  e3500000          CMP      r0,#0
0014c0  03844002          ORREQ    r4,r4,#2
;;;1791   	}
;;;1792   
;;;1793   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
0014c4  e3a000d2          MOV      r0,#0xd2
0014c8  ebfffffe          BL       mess_find_unvol
0014cc  e3500000          CMP      r0,#0
0014d0  0a000003          BEQ      |L1.5348|
0014d4  e5960000          LDR      r0,[r6,#0]  ; mess_data
0014d8  e3500066          CMP      r0,#0x66
;;;1794   	{
;;;1795   	if(mess_data[1]==0) temp|=(1<<SHIFT_REL_AV_NET);
0014dc  05960004          LDREQ    r0,[r6,#4]  ; mess_data
0014e0  0a000001          BEQ      |L1.5356|
                  |L1.5348|
;;;1796   	}
;;;1797   else 
;;;1798   	{
;;;1799   	if(!(avar_ind_stat&0x00000001)) temp|=(1<<SHIFT_REL_AV_NET);
0014e4  e5970000          LDR      r0,[r7,#0]  ; avar_ind_stat
0014e8  e2000001          AND      r0,r0,#1
                  |L1.5356|
0014ec  e3500000          CMP      r0,#0
0014f0  03844020          ORREQ    r4,r4,#0x20
;;;1800   	}
;;;1801   
;;;1802   
;;;1803   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT))
0014f4  e3a000d2          MOV      r0,#0xd2
0014f8  ebfffffe          BL       mess_find_unvol
0014fc  e3500000          CMP      r0,#0
001500  0a000003          BEQ      |L1.5396|
001504  e5960000          LDR      r0,[r6,#0]  ; mess_data
001508  e3500067          CMP      r0,#0x67
;;;1804   	{
;;;1805   	if(mess_data[1]==0) temp|=(1<<SHIFT_REL_AV_BAT);
00150c  05960004          LDREQ    r0,[r6,#4]  ; mess_data
001510  0a000001          BEQ      |L1.5404|
                  |L1.5396|
;;;1806   	}
;;;1807   else 
;;;1808   	{
;;;1809   	if(!(avar_ind_stat&0x00000006)) temp|=(1<<SHIFT_REL_AV_BAT);
001514  e5970000          LDR      r0,[r7,#0]  ; avar_ind_stat
001518  e2000006          AND      r0,r0,#6
                  |L1.5404|
00151c  e3500000          CMP      r0,#0
001520  03844008          ORREQ    r4,r4,#8
;;;1810   	}
;;;1811   
;;;1812   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT))
001524  e3a000d2          MOV      r0,#0xd2
001528  ebfffffe          BL       mess_find_unvol
00152c  e3500000          CMP      r0,#0
001530  0a000003          BEQ      |L1.5444|
001534  e5960000          LDR      r0,[r6,#0]  ; mess_data
001538  e3500067          CMP      r0,#0x67
;;;1813   	{
;;;1814   	if(mess_data[1]==0) temp|=(1<<SHIFT_REL_VENT);
00153c  05960004          LDREQ    r0,[r6,#4]  ; mess_data
001540  0a000000          BEQ      |L1.5448|
                  |L1.5444|
;;;1815   	}
;;;1816   else 
;;;1817   	{
;;;1818   	if(!vent_stat) temp|=(1<<SHIFT_REL_VENT);
001544  e5d50001          LDRB     r0,[r5,#1]  ; vent_stat
                  |L1.5448|
001548  e3500000          CMP      r0,#0
00154c  03844004          ORREQ    r4,r4,#4
;;;1819   	}
;;;1820   
;;;1821   rele_stat=temp;
001550  e5c5400d          STRB     r4,[r5,#0xd]  ; rele_stat
;;;1822   
;;;1823   }
001554  e8bd41f0          POP      {r4-r8,lr}
001558  e12fff1e          BX       lr
;;;1824   
                          ENDP

                  bps_hndl PROC
;;;1825   //-----------------------------------------------
;;;1826   void bps_hndl(void)
00155c  e92d5ff0          PUSH     {r4-r12,lr}
;;;1827   {
;;;1828   static unsigned char sh_cnt0/*,sh_cnt1,sh_cnt2,*/,b1Hz_sh/*,b2Hz_sh*/;
;;;1829   char ptr__,i;
;;;1830   
;;;1831   if(sh_cnt0<10)
001560  e51f65bc          LDR      r6,|L1.4012|
;;;1832   	{
;;;1833   	sh_cnt0++;
;;;1834   	if(sh_cnt0>=10)
;;;1835   		{
;;;1836   		sh_cnt0=0;
;;;1837   		b1Hz_sh=1;
001564  e3a0a001          MOV      r10,#1
001568  e5d60003          LDRB     r0,[r6,#3]            ;1831  ; sh_cnt0
00156c  e3a08000          MOV      r8,#0                 ;1836
001570  e350000a          CMP      r0,#0xa               ;1831
001574  2a000005          BCS      |L1.5520|
001578  e2800001          ADD      r0,r0,#1              ;1833
00157c  e20000ff          AND      r0,r0,#0xff           ;1833
001580  e350000a          CMP      r0,#0xa               ;1834
001584  e5c60003          STRB     r0,[r6,#3]            ;1833  ; sh_cnt0
001588  25c68003          STRBCS   r8,[r6,#3]            ;1836  ; sh_cnt0
00158c  25c6a004          STRBCS   r10,[r6,#4]  ; b1Hz_sh
                  |L1.5520|
;;;1838   		}
;;;1839   	}
;;;1840   
;;;1841   /*if(sh_cnt1<5)
;;;1842   	{
;;;1843   	sh_cnt1++;
;;;1844   	if(sh_cnt1==5)
;;;1845   		{
;;;1846   		sh_cnt1=0;
;;;1847   		b2Hz_sh=1;
;;;1848   		}
;;;1849   	} */
;;;1850   
;;;1851   
;;;1852   /*
;;;1853   if(mess_find(MESS_SRC_ON_OFF))
;;;1854   	{
;;;1855   	if(mess_data[0]==_MESS_SRC_MASK_BLOK_2SEC)
;;;1856   		{
;;;1857   		char i;
;;;1858   		for(i=0;i<NUMIST;i++)
;;;1859   			{
;;;1860   			if(mess_data[1]&(1<<i))src[i]._ist_blok_cnt=20;
;;;1861   			}
;;;1862   		
;;;1863   		}
;;;1864   	else if(mess_data[0]==_MESS_SRC_MASK_UNBLOK)
;;;1865   		{
;;;1866   		char i;
;;;1867   		for(i=0;i<NUMIST;i++)
;;;1868   			{
;;;1869   			if(mess_data[1]&(1<<i))src[i]._ist_blok_cnt=0;
;;;1870   			}
;;;1871   		
;;;1872   		}
;;;1873   	}
;;;1874   	
;;;1875   else if(mess_find(_MESS_SRC_MASK_ON))
;;;1876   	{				
;;;1877   	if(mess_data[0]==_MESS_SRC_MASK_ON)
;;;1878   		{
;;;1879   		char i;
;;;1880   		for(i=0;i<NUMIST;i++)
;;;1881   			{
;;;1882   			if(mess_data[1]&(1<<i))
;;;1883   				{
;;;1884   				src[i]._ist_blok_cnt=0;
;;;1885   				src[i]._flags_tu=2;
;;;1886   				}
;;;1887   			}
;;;1888   		
;;;1889   		}				
;;;1890   	}*/
;;;1891   
;;;1892   
;;;1893   
;;;1894   /*else*/ 
;;;1895   bps_on_mask=0;
001590  e1c684b6          STRH     r8,[r6,#0x46]  ; bps_on_mask
;;;1896   bps_off_mask=0;
;;;1897   
;;;1898   if(mess_find_unvol(MESS2BPS_HNDL))
001594  e3a000cd          MOV      r0,#0xcd
001598  e1c684b8          STRH     r8,[r6,#0x48]         ;1896  ; bps_off_mask
00159c  ebfffffe          BL       mess_find_unvol
;;;1899   	{
;;;1900   	if(mess_data[0]==PARAM_BPS_ALL_OFF_AFTER_2SEC)
;;;1901   		{
;;;1902   		bps_off_mask=0xffff;
;;;1903   		}
;;;1904   
;;;1905   	if(mess_data[0]==PARAM_BPS_MASK_OFF_AFTER_2SEC)
;;;1906   		{
;;;1907   		bps_off_mask=mess_data[1];
;;;1908   		}
;;;1909   
;;;1910   	if(mess_data[0]==PARAM_BPS_MASK_ON)
;;;1911   		{
;;;1912   		bps_on_mask=mess_data[1];
;;;1913   		}
;;;1914   
;;;1915   	if(mess_data[0]==PARAM_BPS_ALL_ON)
;;;1916   		{
;;;1917   		bps_on_mask=0xffff;
;;;1918   		}
;;;1919   
;;;1920   	if(mess_data[0]==PARAM_BPS_MASK_ON_OFF_AFTER_2SEC)
;;;1921   		{
;;;1922   		bps_on_mask=mess_data[1];
;;;1923   		bps_off_mask=~(mess_data[1]);
;;;1924   		}
;;;1925   
;;;1926   
;;;1927   	for(i=0;i<=NUMIST;i++)
;;;1928   		{
;;;1929   		if(bps_off_mask&(1<<i)) bps[i]._blok_cnt++;
0015a0  e51f754c          LDR      r7,|L1.4188|
0015a4  e51fb54c          LDR      r11,|L1.4192|
0015a8  e3500000          CMP      r0,#0                 ;1898
0015ac  0a000034          BEQ      |L1.5764|
0015b0  e51f15b8          LDR      r1,|L1.4096|
0015b4  e59f2da0          LDR      r2,|L1.9052|
0015b8  e5910000          LDR      r0,[r1,#0]            ;1902  ; mess_data
0015bc  e35000ce          CMP      r0,#0xce              ;1900
0015c0  01c624b8          STRHEQ   r2,[r6,#0x48]         ;1902  ; bps_off_mask
0015c4  0a00000f          BEQ      |L1.5640|
0015c8  e35000cf          CMP      r0,#0xcf              ;1905
0015cc  05910004          LDREQ    r0,[r1,#4]            ;1907  ; mess_data
0015d0  0a00000b          BEQ      |L1.5636|
0015d4  e35000d1          CMP      r0,#0xd1              ;1910
0015d8  05910004          LDREQ    r0,[r1,#4]            ;1912  ; mess_data
0015dc  01c604b6          STRHEQ   r0,[r6,#0x46]         ;1912  ; bps_on_mask
0015e0  0a000008          BEQ      |L1.5640|
0015e4  e35000d2          CMP      r0,#0xd2              ;1915
0015e8  01c624b6          STRHEQ   r2,[r6,#0x46]         ;1917  ; bps_on_mask
0015ec  0a000005          BEQ      |L1.5640|
0015f0  e35000d0          CMP      r0,#0xd0              ;1920
0015f4  1a000003          BNE      |L1.5640|
0015f8  e5910004          LDR      r0,[r1,#4]            ;1922  ; mess_data
0015fc  e1c604b6          STRH     r0,[r6,#0x46]         ;1922  ; bps_on_mask
001600  e1e00000          MVN      r0,r0                 ;1923
                  |L1.5636|
001604  e1c604b8          STRH     r0,[r6,#0x48]         ;1907  ; bps_off_mask
                  |L1.5640|
001608  e3a04000          MOV      r4,#0                 ;1927
00160c  ea000018          B        |L1.5748|
                  |L1.5648|
001610  e1d604b8          LDRH     r0,[r6,#0x48]  ; bps_off_mask
001614  e1a0941a          LSL      r9,r10,r4
001618  e1100009          TST      r0,r9
00161c  e0640184          RSB      r0,r4,r4,LSL #3
001620  e0800080          ADD      r0,r0,r0,LSL #1
001624  e0870100          ADD      r0,r7,r0,LSL #2
001628  11d014b0          LDRHNE   r1,[r0,#0x40]
;;;1930   		else bps[i]._blok_cnt=0;
00162c  01c084b0          STRHEQ   r8,[r0,#0x40]
;;;1931   		gran(&bps[i]._blok_cnt,0,50);
001630  e3a02032          MOV      r2,#0x32
001634  12811001          ADDNE    r1,r1,#1              ;1929
001638  11c014b0          STRHNE   r1,[r0,#0x40]         ;1929
00163c  e0640184          RSB      r0,r4,r4,LSL #3
001640  e0800080          ADD      r0,r0,r0,LSL #1
001644  e0875100          ADD      r5,r7,r0,LSL #2
001648  e2850040          ADD      r0,r5,#0x40
00164c  e3a01000          MOV      r1,#0
001650  ebfffffe          BL       gran
;;;1932   		if(bps[i]._blok_cnt>20) bps[i]._flags_tu=1;
001654  e1d504f0          LDRSH    r0,[r5,#0x40]
001658  e3500014          CMP      r0,#0x14
00165c  c5c5a028          STRBGT   r10,[r5,#0x28]
;;;1933   		if(bps_on_mask&(1<<i)) bps[i]._flags_tu=0;
001660  e1d604b6          LDRH     r0,[r6,#0x46]  ; bps_on_mask
001664  e1100009          TST      r0,r9
001668  e2840001          ADD      r0,r4,#1              ;1927
00166c  e20040ff          AND      r4,r0,#0xff           ;1927
001670  15c58028          STRBNE   r8,[r5,#0x28]
                  |L1.5748|
001674  e1db00f0          LDRSH    r0,[r11,#0]           ;1927  ; NUMIST
001678  e1540000          CMP      r4,r0                 ;1927
00167c  daffffe3          BLE      |L1.5648|
001680  ea00002c          B        |L1.5944|
                  |L1.5764|
;;;1934   	     }
;;;1935   
;;;1936   	
;;;1937   /*
;;;1938   
;;;1939   	if(bps_all_off_cnt>20)
;;;1940   		{
;;;1941   		for(i=0;i<=NUMIST;i++)
;;;1942   			{
;;;1943   	     	bps[i]._flags_tu=1;
;;;1944   	     	}
;;;1945   		}
;;;1946   	else if(bps_mask_off_cnt>20)
;;;1947   		{
;;;1948   		for(i=0;i<=NUMIST;i++)
;;;1949   			{
;;;1950   			if(mess_data[1]&(1<<i)) bps[i]._flags_tu=1;
;;;1951   	     	}
;;;1952   		}	
;;;1953   		
;;;1954   	else if(bps_mask_on_off_cnt>20)
;;;1955   		{
;;;1956   		for(i=0;i<=NUMIST;i++)
;;;1957   			{
;;;1958   			if(mess_data[1]&(1<<i)) bps[i]._flags_tu=1;
;;;1959   			else bps[i]._flags_tu=0;
;;;1960   	     	}
;;;1961   		}
;;;1962   		
;;;1963   	if(mess_data[0]==PARAM_BPS_MASK_ON)
;;;1964   		{
;;;1965   		for(i=0;i<=NUMIST;i++)
;;;1966   			{
;;;1967   			if(mess_data[1]&(1<<i)) bps[i]._flags_tu=0;
;;;1968   	     	}
;;;1969   		}
;;;1970   */										
;;;1971   	}
;;;1972   
;;;1973   
;;;1974   else if(b1Hz_sh)
001684  e5d60004          LDRB     r0,[r6,#4]  ; b1Hz_sh
001688  e3500000          CMP      r0,#0
00168c  0a000029          BEQ      |L1.5944|
001690  e1db10f0          LDRSH    r1,[r11,#0]           ;1927
;;;1975   	{
;;;1976   	ptr__=0;
001694  e3a02000          MOV      r2,#0
;;;1977        for(i=0;i<=NUMIST;i++)
001698  e1a00002          MOV      r0,r2
                  |L1.5788|
00169c  e1500001          CMP      r0,r1
;;;1978   		{
;;;1979   	     bps[i]._flags_tu=1;
0016a0  d0603180          RSBLE    r3,r0,r0,LSL #3
0016a4  d0833083          ADDLE    r3,r3,r3,LSL #1
0016a8  d0873103          ADDLE    r3,r7,r3,LSL #2
0016ac  d2800001          ADDLE    r0,r0,#1              ;1977
0016b0  d20000ff          ANDLE    r0,r0,#0xff           ;1977
0016b4  d5c3a028          STRBLE   r10,[r3,#0x28]
0016b8  dafffff7          BLE      |L1.5788|
;;;1980   	     }	
;;;1981     	     
;;;1982     	for(i=0;(i<NUMIST)&&(ptr__<num_necc);i++)
0016bc  e59f3c9c          LDR      r3,|L1.9056|
0016c0  e3a00000          MOV      r0,#0
0016c4  e1d3e0f0          LDRSH    lr,[r3,#0]
0016c8  ea00000a          B        |L1.5880|
                  |L1.5836|
;;;1983     		{
;;;1984     	     if((bps[i]._state==bsRDY)||(bps[i]._state==bsWRK))
0016cc  e0603180          RSB      r3,r0,r0,LSL #3
0016d0  e0833083          ADD      r3,r3,r3,LSL #1
0016d4  e0873103          ADD      r3,r7,r3,LSL #2
0016d8  e5d3c002          LDRB     r12,[r3,#2]
0016dc  e2800001          ADD      r0,r0,#1              ;1982
0016e0  e20000ff          AND      r0,r0,#0xff           ;1982
0016e4  e35c0002          CMP      r12,#2
0016e8  135c0001          CMPNE    r12,#1
;;;1985     	         	{
;;;1986     	         	bps[i]._flags_tu=0;
;;;1987     	         	ptr__++;
0016ec  02822001          ADDEQ    r2,r2,#1
0016f0  020220ff          ANDEQ    r2,r2,#0xff
0016f4  05c38028          STRBEQ   r8,[r3,#0x28]         ;1986
                  |L1.5880|
0016f8  e1500001          CMP      r0,r1                 ;1982
0016fc  b152000e          CMPLT    r2,lr                 ;1982
001700  bafffff1          BLT      |L1.5836|
;;;1988     	         	}
;;;1989     	     }
;;;1990   	if(main_1Hz_cnt<60)
001704  e59f0c58          LDR      r0,|L1.9060|
001708  e1d000f0          LDRSH    r0,[r0,#0]  ; main_1Hz_cnt
00170c  e350003c          CMP      r0,#0x3c
001710  aa000008          BGE      |L1.5944|
;;;1991   		{
;;;1992        	for(i=0;i<=NUMIST;i++)
001714  e3a00000          MOV      r0,#0
                  |L1.5912|
001718  e1500001          CMP      r0,r1
;;;1993   			{
;;;1994   	     	bps[i]._flags_tu=0;
00171c  d0602180          RSBLE    r2,r0,r0,LSL #3
001720  d0822082          ADDLE    r2,r2,r2,LSL #1
001724  d0872102          ADDLE    r2,r7,r2,LSL #2
001728  d2800001          ADDLE    r0,r0,#1              ;1992
00172c  d20000ff          ANDLE    r0,r0,#0xff           ;1992
001730  d5c28028          STRBLE   r8,[r2,#0x28]
001734  dafffff7          BLE      |L1.5912|
                  |L1.5944|
001738  e1db30f0          LDRSH    r3,[r11,#0]           ;1927
;;;1995   	     	}	
;;;1996   		}	 
;;;1997     	}
;;;1998   
;;;1999   
;;;2000   for(i=0;i<NUMIST;i++)
00173c  e3a00000          MOV      r0,#0
;;;2001        {
;;;2002        if(bps[i]._ist_blok_host_cnt!=0)
;;;2003             {
;;;2004             bps[i]._flags_tu=99;
001740  e3a0c063          MOV      r12,#0x63
001744  ea000009          B        |L1.6000|
                  |L1.5960|
001748  e0601180          RSB      r1,r0,r0,LSL #3       ;2002
00174c  e0811081          ADD      r1,r1,r1,LSL #1       ;2002
001750  e0871101          ADD      r1,r7,r1,LSL #2       ;2002
001754  e591203c          LDR      r2,[r1,#0x3c]         ;2002
001758  e2800001          ADD      r0,r0,#1              ;2000
00175c  e3520000          CMP      r2,#0                 ;2002
;;;2005   	     bps[i]._ist_blok_host_cnt--;
001760  12422001          SUBNE    r2,r2,#1
001764  15c1c028          STRBNE   r12,[r1,#0x28]        ;2004
001768  e20000ff          AND      r0,r0,#0xff           ;2000
00176c  1581203c          STRNE    r2,[r1,#0x3c]
                  |L1.6000|
001770  e1500003          CMP      r0,r3                 ;2000
001774  bafffff3          BLT      |L1.5960|
;;;2006             }
;;;2007        }
;;;2008   
;;;2009   
;;;2010   
;;;2011   
;;;2012   b1Hz_sh=0;
001778  e5c68004          STRB     r8,[r6,#4]  ; b1Hz_sh
;;;2013   
;;;2014   
;;;2015   num_of_wrks_bps=0;
;;;2016   for(i=0;i<NUMIST;i++)
00177c  e3a00000          MOV      r0,#0
001780  e5c68012          STRB     r8,[r6,#0x12]         ;2015  ; num_of_wrks_bps
001784  ea000009          B        |L1.6064|
                  |L1.6024|
;;;2017   	{
;;;2018   	if(bps[i]._state==bsWRK)num_of_wrks_bps++;
001788  e0601180          RSB      r1,r0,r0,LSL #3
00178c  e0811081          ADD      r1,r1,r1,LSL #1
001790  e0871101          ADD      r1,r7,r1,LSL #2
001794  e5d11002          LDRB     r1,[r1,#2]
001798  e2800001          ADD      r0,r0,#1              ;2016
00179c  e20000ff          AND      r0,r0,#0xff           ;2016
0017a0  e3510001          CMP      r1,#1
0017a4  05d61012          LDRBEQ   r1,[r6,#0x12]  ; num_of_wrks_bps
0017a8  02811001          ADDEQ    r1,r1,#1
0017ac  05c61012          STRBEQ   r1,[r6,#0x12]  ; num_of_wrks_bps
                  |L1.6064|
0017b0  e1500003          CMP      r0,r3                 ;2016
0017b4  bafffff3          BLT      |L1.6024|
;;;2019   	}
;;;2020   }
0017b8  e8bd5ff0          POP      {r4-r12,lr}
0017bc  e12fff1e          BX       lr
;;;2021   
                          ENDP

                  bps_drv PROC
;;;2027   //-----------------------------------------------
;;;2028   void bps_drv(char in)
0017c0  e92d41f0          PUSH     {r4-r8,lr}
;;;2029   {
0017c4  e1a06000          MOV      r6,r0
;;;2030   char temp;
;;;2031   
;;;2032   temp=bps[in]._flags_tm;
0017c8  e0600180          RSB      r0,r0,r0,LSL #3
0017cc  e0801080          ADD      r1,r0,r0,LSL #1
0017d0  e51f077c          LDR      r0,|L1.4188|
0017d4  e0804101          ADD      r4,r0,r1,LSL #2
0017d8  e5d45042          LDRB     r5,[r4,#0x42]
;;;2033   
;;;2034   if(temp&(1<<AV_T))
;;;2035   	{
;;;2036   	if(bps[in]._temp_av_cnt<1200) 
0017dc  e1d404f4          LDRSH    r0,[r4,#0x44]
0017e0  e3150002          TST      r5,#2                 ;2034
0017e4  0a00000d          BEQ      |L1.6176|
0017e8  e3500e4b          CMP      r0,#0x4b0
0017ec  aa000019          BGE      |L1.6232|
;;;2037   		{
;;;2038   		bps[in]._temp_av_cnt++;
0017f0  e2800001          ADD      r0,r0,#1
0017f4  e1a00800          LSL      r0,r0,#16
0017f8  e1a00840          ASR      r0,r0,#16
;;;2039   		if(bps[in]._temp_av_cnt>=1200)
0017fc  e3500e4b          CMP      r0,#0x4b0
001800  e1c404b4          STRH     r0,[r4,#0x44]         ;2038
;;;2040   			{
;;;2041   			bps[in]._temp_av_cnt=1200;
001804  a3a00e4b          MOVGE    r0,#0x4b0
001808  a1c404b4          STRHGE   r0,[r4,#0x44]
;;;2042   		   	if(!(bps[in]._av&(1<<0)))avar_bps_hndl(in,0,1);
00180c  a5d40001          LDRBGE   r0,[r4,#1]
001810  a3100001          TSTGE    r0,#1
001814  1a00000f          BNE      |L1.6232|
001818  e3a02001          MOV      r2,#1
00181c  ea00000a          B        |L1.6220|
                  |L1.6176|
;;;2043   			}
;;;2044   		}
;;;2045   	}
;;;2046   
;;;2047   else if(!(temp&(1<<AV_T)))
;;;2048   	{
;;;2049   	if(bps[in]._temp_av_cnt) 
001820  e3500000          CMP      r0,#0
001824  0a00000b          BEQ      |L1.6232|
;;;2050   		{
;;;2051   		bps[in]._temp_av_cnt--;
001828  e2400001          SUB      r0,r0,#1
00182c  e1a00800          LSL      r0,r0,#16
001830  e1b00840          ASRS     r0,r0,#16
001834  e1c404b4          STRH     r0,[r4,#0x44]
;;;2052   		if(!bps[in]._temp_av_cnt)
001838  1a000006          BNE      |L1.6232|
;;;2053   			{
;;;2054   			if(bps[in]._av&(1<<0))avar_bps_hndl(in,0,0);
00183c  e5d40001          LDRB     r0,[r4,#1]
001840  e3100001          TST      r0,#1
001844  0a000003          BEQ      |L1.6232|
001848  e3a02000          MOV      r2,#0
                  |L1.6220|
00184c  e3a01000          MOV      r1,#0
001850  e1a00006          MOV      r0,r6
001854  ebfffffe          BL       avar_bps_hndl
                  |L1.6232|
;;;2055   			}
;;;2056   		} 	
;;;2057   
;;;2058   	}
;;;2059   
;;;2060   if((temp&(1<<AVUMAX)))
;;;2061   	{
;;;2062   	if(bps[in]._umax_av_cnt<10) 
001858  e1d404f6          LDRSH    r0,[r4,#0x46]
00185c  e3150008          TST      r5,#8                 ;2060
;;;2063   		{
;;;2064   		bps[in]._umax_av_cnt++;
;;;2065   		if(bps[in]._umax_av_cnt>=10)
;;;2066   			{ 
;;;2067   			bps[in]._umax_av_cnt=10;
001860  e3a0700a          MOV      r7,#0xa
001864  e3a01000          MOV      r1,#0                 ;2042
001868  0a00000c          BEQ      |L1.6304|
00186c  e350000a          CMP      r0,#0xa               ;2062
001870  aa000017          BGE      |L1.6356|
001874  e2800001          ADD      r0,r0,#1              ;2064
001878  e1a00800          LSL      r0,r0,#16             ;2064
00187c  e1a00840          ASR      r0,r0,#16             ;2064
001880  e350000a          CMP      r0,#0xa               ;2065
001884  e1c404b6          STRH     r0,[r4,#0x46]         ;2064
001888  a1c474b6          STRHGE   r7,[r4,#0x46]
;;;2068   			if(!(bps[in]._av&(1<<1)))avar_bps_hndl(in,1,1);
00188c  a5d40001          LDRBGE   r0,[r4,#1]
001890  a3100002          TSTGE    r0,#2
001894  1a00000e          BNE      |L1.6356|
001898  e3a02001          MOV      r2,#1
00189c  ea000007          B        |L1.6336|
                  |L1.6304|
;;;2069   		  	/*if((K[APV]!=ON)||((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afOFF)))avar_s_hndl(in,1,1);
;;;2070   			if((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afON))
;;;2071   				{
;;;2072   				apv_cnt[in,0]=APV_INIT;
;;;2073   				apv_cnt[in,1]=APV_INIT;
;;;2074   				apv_cnt[in,2]=APV_INIT;
;;;2075   				apv_flags[in]=afOFF;
;;;2076   				}				*/
;;;2077   						
;;;2078   			}
;;;2079   		} 
;;;2080   	}		
;;;2081   else if(!(temp&(1<<AVUMAX)))
;;;2082   	{
;;;2083   	if(bps[in]._umax_av_cnt>0) 
0018a0  e3500000          CMP      r0,#0
0018a4  da000009          BLE      |L1.6352|
;;;2084   		{
;;;2085   		bps[in]._umax_av_cnt--;
0018a8  e2400001          SUB      r0,r0,#1
0018ac  e1a00800          LSL      r0,r0,#16
0018b0  e1b00840          ASRS     r0,r0,#16
0018b4  e1c404b6          STRH     r0,[r4,#0x46]
;;;2086   		if(bps[in]._umax_av_cnt==0)
0018b8  1a000005          BNE      |L1.6356|
;;;2087   			{
;;;2088   			bps[in]._umax_av_cnt=0;
;;;2089   			avar_bps_hndl(in,1,0);
0018bc  e3a02000          MOV      r2,#0
                  |L1.6336|
0018c0  e3a01001          MOV      r1,#1
0018c4  e1a00006          MOV      r0,r6
0018c8  ebfffffe          BL       avar_bps_hndl
0018cc  ea000000          B        |L1.6356|
                  |L1.6352|
;;;2090   	 //		apv_cnt[in,0]=0;
;;;2091   	//		apv_cnt[in,1]=0;
;;;2092   	 //		apv_cnt[in,2]=0;			
;;;2093   			}
;;;2094   		}
;;;2095   	else if(bps[in]._umax_av_cnt<0) bps[in]._umax_av_cnt=0;		 
0018d0  b1c414b6          STRHLT   r1,[r4,#0x46]
                  |L1.6356|
;;;2096   	}
;;;2097   
;;;2098   if(temp&(1<<AVUMIN))
;;;2099   	{
;;;2100   	if(bps[in]._umin_av_cnt<10) 
0018d4  e1d404f8          LDRSH    r0,[r4,#0x48]
0018d8  e3150010          TST      r5,#0x10              ;2098
0018dc  0a00000c          BEQ      |L1.6420|
0018e0  e350000a          CMP      r0,#0xa
0018e4  aa000015          BGE      |L1.6464|
;;;2101   		{
;;;2102   		bps[in]._umin_av_cnt++;
0018e8  e2800001          ADD      r0,r0,#1
0018ec  e1a00800          LSL      r0,r0,#16
0018f0  e1a00840          ASR      r0,r0,#16
;;;2103   		if(bps[in]._umin_av_cnt>=10)
0018f4  e350000a          CMP      r0,#0xa
0018f8  e1c404b8          STRH     r0,[r4,#0x48]         ;2102
;;;2104   			{ 
;;;2105   			bps[in]._umin_av_cnt=10;
0018fc  a1c474b8          STRHGE   r7,[r4,#0x48]
;;;2106   			if(!(bps[in]._av&(1<<2)))avar_bps_hndl(in,2,1);
001900  a5d40001          LDRBGE   r0,[r4,#1]
001904  a3100004          TSTGE    r0,#4
001908  1a00000c          BNE      |L1.6464|
00190c  e3a02001          MOV      r2,#1
001910  ea000007          B        |L1.6452|
                  |L1.6420|
;;;2107   		  	/*	if((K[APV]!=ON)||((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afOFF)))avar_s_hndl(in,2,1);
;;;2108   			if((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afON))
;;;2109   				{
;;;2110   				apv_cnt[in,0]=APV_INIT;
;;;2111   				apv_cnt[in,1]=APV_INIT;
;;;2112   				apv_cnt[in,2]=APV_INIT;
;;;2113   				apv_flags[in]=afOFF;
;;;2114   				}*/				
;;;2115   			}
;;;2116   		} 
;;;2117   	}	
;;;2118   	
;;;2119   else if(!(temp&(1<<AVUMIN)))
;;;2120   	{
;;;2121   	if(bps[in]._umin_av_cnt) 
001914  e3500000          CMP      r0,#0
001918  0a000008          BEQ      |L1.6464|
;;;2122   		{
;;;2123   		bps[in]._umin_av_cnt--;
00191c  e2400001          SUB      r0,r0,#1
001920  e1a00800          LSL      r0,r0,#16
001924  e1b00840          ASRS     r0,r0,#16
001928  e1c404b8          STRH     r0,[r4,#0x48]
;;;2124   		if(bps[in]._umin_av_cnt==0)
00192c  1a000003          BNE      |L1.6464|
;;;2125   			{
;;;2126   			bps[in]._umin_av_cnt=0;
;;;2127   			avar_bps_hndl(in,2,0);
001930  e3a02000          MOV      r2,#0
                  |L1.6452|
001934  e3a01002          MOV      r1,#2
001938  e1a00006          MOV      r0,r6
00193c  ebfffffe          BL       avar_bps_hndl
                  |L1.6464|
;;;2128   		//	apv_cnt[in,0]=0;
;;;2129   		//	apv_cnt[in,1]=0;
;;;2130   		//	apv_cnt[in,2]=0;
;;;2131   			}
;;;2132   		}
;;;2133   	else if(bps[in]._umin_av_cnt>10)bps[in]._umin_av_cnt--;	 
;;;2134   	}
;;;2135   
;;;2136   
;;;2137   
;;;2138   if (bps[in]._av&0x0f)					bps[in]._state=bsAV;
001940  e5d41001          LDRB     r1,[r4,#1]
;;;2139   else if ( (net_av) && 
001944  e51f09a0          LDR      r0,|L1.4012|
001948  e311000f          TST      r1,#0xf               ;2138
00194c  13a01004          MOVNE    r1,#4                 ;2138
001950  1a00000d          BNE      |L1.6540|
001954  e5d01016          LDRB     r1,[r0,#0x16]  ; net_av
001958  e3510000          CMP      r1,#0
;;;2140   		(bps[in]._Uii<200))				bps[in]._state=bsOFF_AV_NET;
00195c  15941018          LDRNE    r1,[r4,#0x18]
001960  135100c8          CMPNE    r1,#0xc8
001964  b3a01005          MOVLT    r1,#5
001968  ba000007          BLT      |L1.6540|
;;;2141   else if (bps[in]._flags_tm&BIN8(100000))	bps[in]._state=bsRDY;
00196c  e5d41042          LDRB     r1,[r4,#0x42]
001970  e3110020          TST      r1,#0x20
001974  13a01002          MOVNE    r1,#2
001978  1a000003          BNE      |L1.6540|
;;;2142   else if (bps[in]._cnt<20)				bps[in]._state=bsWRK;
00197c  e5d41003          LDRB     r1,[r4,#3]
001980  e3510014          CMP      r1,#0x14
001984  2a000001          BCS      |L1.6544|
001988  e3a01001          MOV      r1,#1
                  |L1.6540|
00198c  e5c41002          STRB     r1,[r4,#2]
                  |L1.6544|
;;;2143   
;;;2144   
;;;2145   
;;;2146   //else if(bps[in]._flags_tm&BIN8(100000)) bps[in]._state=ssBL;
;;;2147   //else if((!(bps[in]._flags_tm&BIN8(100000)))&&(net_U>100))bps[in]._state=ssWRK;
;;;2148   //else bps[0]._state=ssNOT;
;;;2149   
;;;2150   //bps[in]._is_ready=0;
;;;2151   //bps[in]._is_wrk=0;
;;;2152   //if(bps[in]._av_net) bps[in]._flags_bp='N';//  
;;;2153   //else if(bps[in]._av_u_max) bps[in]._flags_bp='P';//  (u_.av_.bAS1T)) bps_state[0]=ssAV;
;;;2154   //else if(bps[in]._av_u_min) bps[in]._flags_bp='M';//  
;;;2155   //else if(bps[in]._av_temper) bps[in]._flags_bp='T';// 
;;;2156   //else if(bps[in]._flags_tm&BIN8(100000)) 
;;;2157   //	{
;;;2158   //	bps[in]._flags_bp='B';// 
;;;2159   //	bps[in]._is_ready=1;
;;;2160   //	}
;;;2161   //else if((!(bps[in]._flags_tm&BIN8(100000)))&&(net_U>100))
;;;2162   //     {
;;;2163   //     bps[in]._flags_bp='W';// 
;;;2164   //     bps[in]._is_ready=1;
;;;2165   //     bps[in]._is_wrk=1;
;;;2166        
;;;2167   //     }
;;;2168   //else bps[in]._is_ready=1;     
;;;2169   
;;;2170   
;;;2171   
;;;2172   
;;;2173   
;;;2174   /*
;;;2175   bps[in]._flags_tu&=BIN8(11111110);
;;;2176   if(bps[in]._ist_blok_cnt)
;;;2177   	{
;;;2178   	bps[in]._ist_blok_cnt--;
;;;2179   	bps[in]._flags_tu|=BIN8(1);
;;;2180   	}
;;;2181   
;;;2182   	   */ 
;;;2183   
;;;2184   //    
;;;2185   if(bps[in]._cnt>=10) bps[in]._flags_tu|=BIN8(10000000);
001990  e5d41003          LDRB     r1,[r4,#3]
001994  e351000a          CMP      r1,#0xa
001998  e5d41028          LDRB     r1,[r4,#0x28]
;;;2186   else bps[in]._flags_tu&=BIN8(1111111);
00199c  3201107f          ANDCC    r1,r1,#0x7f
0019a0  23811080          ORRCS    r1,r1,#0x80           ;2185
0019a4  e5c41028          STRB     r1,[r4,#0x28]
;;;2187   	
;;;2188   bps[in]._vol_u=cntrl_stat+bps[in]._x_;	
0019a8  e1d415f0          LDRSH    r1,[r4,#0x50]
0019ac  e1d001fa          LDRSH    r0,[r0,#0x1a]  ; cntrl_stat
0019b0  e0800001          ADD      r0,r0,r1
0019b4  e584002c          STR      r0,[r4,#0x2c]
;;;2189    
;;;2190   }
0019b8  e8bd41f0          POP      {r4-r8,lr}
0019bc  e12fff1e          BX       lr
;;;2191   
                          ENDP

                  bat_hndl PROC
;;;2192   //-----------------------------------------------
;;;2193   void bat_hndl(void)
0019c0  e92d4010          PUSH     {r4,lr}
;;;2194   {
;;;2195   /*if(mess_find(_MESS_BAT_MASK_ON))
;;;2196   	{
;;;2197   	if(mess_data[0]==_MESS_BAT_MASK_ON)
;;;2198   		{
;;;2199   		char i;
;;;2200   		for(i=0;i<2;i++)
;;;2201   			{
;;;2202   			if(mess_data[1]&(1<<i))
;;;2203   				{
;;;2204   				bat[i]._cnt_to_block=0;
;;;2205        			bat[i]._rel_stat=0;
;;;2206        			}
;;;2207   			}
;;;2208   		}
;;;2209   	}
;;;2210   if(mess_find(_MESS_BAT_MASK_OFF))
;;;2211   	{		
;;;2212   	if(mess_data[0]==_MESS_BAT_MASK_OFF)
;;;2213   		{
;;;2214   		char i;
;;;2215   		for(i=0;i<2;i++)
;;;2216   			{
;;;2217   			if((mess_data[1]&(1<<i)) && (bat[i]._cnt_to_block==0) && (bat[i]._rel_stat==0))
;;;2218   				{
;;;2219   				bat[i]._cnt_to_block=20;
;;;2220   				bat[i]._rel_stat=1;
;;;2221        			}
;;;2222   			}
;;;2223   		
;;;2224   		}		
;;;2225   	}*/
;;;2226   
;;;2227   if(mess_find_unvol(MESS2BAT_HNDL))
0019c4  e3a000c8          MOV      r0,#0xc8
0019c8  ebfffffe          BL       mess_find_unvol
;;;2228   	{ 
;;;2229   	char i;
;;;2230   	
;;;2231   	if(mess_data[0]==PARAM_BAT_ALL_OFF_AFTER_2SEC)
;;;2232   		{
;;;2233   		for(i=0;i<MAX_NUM_OF_BAT;i++)
;;;2234   			{
;;;2235   			if(bat[i]._cnt_to_block<50)bat[i]._cnt_to_block++;
0019cc  e51f29e8          LDR      r2,|L1.4076|
0019d0  e3500000          CMP      r0,#0                 ;2227
0019d4  e3a03000          MOV      r3,#0                 ;2233
0019d8  0a000033          BEQ      |L1.6828|
0019dc  e51f19e4          LDR      r1,|L1.4096|
;;;2236   			}
;;;2237   		}
;;;2238   
;;;2239   	else if(mess_data[0]==PARAM_BAT_MASK_OFF_AFTER_2SEC)
;;;2240   		{
;;;2241   		for(i=0;i<MAX_NUM_OF_BAT;i++)
;;;2242   			{
;;;2243   			if(mess_data[1]&(1<<i))
0019e0  e3a0c001          MOV      r12,#1
0019e4  e5910000          LDR      r0,[r1,#0]  ; mess_data
0019e8  e35000c9          CMP      r0,#0xc9              ;2231
0019ec  1a00000a          BNE      |L1.6684|
0019f0  e3a00000          MOV      r0,#0                 ;2233
                  |L1.6644|
0019f4  e060e200          RSB      lr,r0,r0,LSL #4       ;2235
0019f8  e7d2110e          LDRB     r1,[r2,lr,LSL #2]     ;2235
0019fc  e2800001          ADD      r0,r0,#1              ;2233
001a00  e20000ff          AND      r0,r0,#0xff           ;2233
001a04  e3510032          CMP      r1,#0x32              ;2235
001a08  32811001          ADDCC    r1,r1,#1              ;2235
001a0c  37c2110e          STRBCC   r1,[r2,lr,LSL #2]     ;2235
001a10  e3500002          CMP      r0,#2                 ;2233
001a14  3afffff6          BCC      |L1.6644|
001a18  ea000016          B        |L1.6776|
                  |L1.6684|
001a1c  e35000ca          CMP      r0,#0xca              ;2239
001a20  e3a00000          MOV      r0,#0                 ;2241
001a24  1a00000d          BNE      |L1.6752|
001a28  e5914004          LDR      r4,[r1,#4]
                  |L1.6700|
001a2c  e114001c          TST      r4,r12,LSL r0
;;;2244   				{
;;;2245   				if(bat[i]._cnt_to_block<50) bat[i]._cnt_to_block++;
001a30  e0601200          RSB      r1,r0,r0,LSL #4
;;;2246   				}
;;;2247   			else bat[i]._cnt_to_block=0;
001a34  07c23101          STRBEQ   r3,[r2,r1,LSL #2]
001a38  0a000003          BEQ      |L1.6732|
001a3c  e7d2e101          LDRB     lr,[r2,r1,LSL #2]     ;2245
001a40  e35e0032          CMP      lr,#0x32              ;2245
001a44  328ee001          ADDCC    lr,lr,#1              ;2245
001a48  37c2e101          STRBCC   lr,[r2,r1,LSL #2]     ;2245
                  |L1.6732|
001a4c  e2800001          ADD      r0,r0,#1              ;2241
001a50  e20000ff          AND      r0,r0,#0xff           ;2241
001a54  e3500002          CMP      r0,#2                 ;2241
001a58  3afffff3          BCC      |L1.6700|
001a5c  ea000005          B        |L1.6776|
                  |L1.6752|
;;;2248   			}
;;;2249   		}
;;;2250   	else 
;;;2251   	 	{
;;;2252   		for(i=0;i<MAX_NUM_OF_BAT;i++)
;;;2253   			{
;;;2254   			bat[i]._cnt_to_block=0;
001a60  e0601200          RSB      r1,r0,r0,LSL #4
001a64  e2800001          ADD      r0,r0,#1              ;2252
001a68  e20000ff          AND      r0,r0,#0xff           ;2252
001a6c  e3500002          CMP      r0,#2                 ;2252
001a70  e7c23101          STRB     r3,[r2,r1,LSL #2]
001a74  3afffff9          BCC      |L1.6752|
                  |L1.6776|
;;;2255   			}
;;;2256   
;;;2257   		}
;;;2258   	for(i=0;i<MAX_NUM_OF_BAT;i++)
001a78  e3a00000          MOV      r0,#0
                  |L1.6780|
;;;2259   		{
;;;2260   		if(bat[i]._cnt_to_block>20)bat[i]._rel_stat=1;
001a7c  e0601200          RSB      r1,r0,r0,LSL #4
001a80  e7d2e101          LDRB     lr,[r2,r1,LSL #2]
001a84  e0821101          ADD      r1,r2,r1,LSL #2
001a88  e2800001          ADD      r0,r0,#1              ;2258
001a8c  e35e0014          CMP      lr,#0x14
;;;2261   		else bat[i]._rel_stat=0;
001a90  95c13034          STRBLS   r3,[r1,#0x34]
001a94  e20000ff          AND      r0,r0,#0xff           ;2258
001a98  85c1c034          STRBHI   r12,[r1,#0x34]        ;2260
001a9c  e3500002          CMP      r0,#2                 ;2258
001aa0  3afffff5          BCC      |L1.6780|
                  |L1.6820|
;;;2262   		}
;;;2263   
;;;2264   	}
;;;2265   
;;;2266   else 
;;;2267   	{
;;;2268   	char i;
;;;2269   	for(i=0;i<MAX_NUM_OF_BAT;i++)
;;;2270   		{
;;;2271   		bat[i]._cnt_to_block=0;
;;;2272   		bat[i]._rel_stat=0;
;;;2273   		}
;;;2274   
;;;2275   	}
;;;2276   
;;;2277   /*if(mess_find_unvol(MESS2BAT_HNDL1))
;;;2278   	{
;;;2279   	if(PARAM_BAT_ON)
;;;2280   		{
;;;2281   		char i;
;;;2282   		for(i=0;i<MAX_NUM_OF_BAT;i++)
;;;2283   			{
;;;2284   			if(mess_data[1]&(1<<i))
;;;2285   				{
;;;2286   				bat[i]._cnt_to_block=0;
;;;2287   				bat[i]._rel_stat=0;
;;;2288   				}
;;;2289   			}
;;;2290   		}
;;;2291   	} */
;;;2292   }
001aa4  e8bd4010          POP      {r4,lr}
001aa8  e12fff1e          BX       lr
                  |L1.6828|
001aac  e0601200          RSB      r1,r0,r0,LSL #4       ;2271
001ab0  e2800001          ADD      r0,r0,#1              ;2269
001ab4  e7c23101          STRB     r3,[r2,r1,LSL #2]     ;2271
001ab8  e0821101          ADD      r1,r2,r1,LSL #2       ;2272
001abc  e20000ff          AND      r0,r0,#0xff           ;2269
001ac0  e3500002          CMP      r0,#2                 ;2269
001ac4  e5c13034          STRB     r3,[r1,#0x34]         ;2272
001ac8  3afffff7          BCC      |L1.6828|
001acc  eafffff4          B        |L1.6820|
;;;2293   
                          ENDP

                  bat_drv PROC
;;;2294   //-----------------------------------------------
;;;2295   void bat_drv(char in)
001ad0  e92d5ff0          PUSH     {r4-r12,lr}
;;;2296   {
001ad4  e1a06000          MOV      r6,r0
;;;2297   unsigned short tempUS,tempUS_;
;;;2298   unsigned long tempUL,tempUL_;
;;;2299   unsigned short b_zar;
;;;2300   static unsigned short time_cnt[2];
;;;2301   
;;;2302   
;;;2303   
;;;2304   if(++(bat[in]._time_cnt)>=10)
001ad8  e0601200          RSB      r1,r0,r0,LSL #4
001adc  e51f0af8          LDR      r0,|L1.4076|
;;;2305   	{
;;;2306   	bat[in]._time_cnt=0;
001ae0  e3a08000          MOV      r8,#0
001ae4  e0804101          ADD      r4,r0,r1,LSL #2       ;2304
001ae8  e5d40036          LDRB     r0,[r4,#0x36]         ;2304
001aec  e2800001          ADD      r0,r0,#1              ;2304
001af0  e20000ff          AND      r0,r0,#0xff           ;2304
001af4  e350000a          CMP      r0,#0xa               ;2304
001af8  e5c40036          STRB     r0,[r4,#0x36]         ;2304
;;;2307   	//bat[in]._zar_cnt++;
;;;2308   	}
;;;2309   
;;;2310   if(main_10Hz_cnt==50)
001afc  e59f0864          LDR      r0,|L1.9064|
001b00  25c48036          STRBCS   r8,[r4,#0x36]         ;2306
001b04  e1d000b0          LDRH     r0,[r0,#0]  ; main_10Hz_cnt
001b08  e3500032          CMP      r0,#0x32
;;;2311   	{
;;;2312   	if(!bat[in]._rel_stat)
001b0c  05d40034          LDRBEQ   r0,[r4,#0x34]
001b10  03500000          CMPEQ    r0,#0
001b14  1a000007          BNE      |L1.6968|
;;;2313   		{
;;;2314   		if(bat[in]._Ub<80) 
001b18  e1d400f2          LDRSH    r0,[r4,#2]
001b1c  e3500050          CMP      r0,#0x50
001b20  aa000004          BGE      |L1.6968|
;;;2315   			{
;;;2316   			if(!(bat[in]._av))avar_bat_hndl(in,1);
001b24  e5d40035          LDRB     r0,[r4,#0x35]
001b28  e3500000          CMP      r0,#0
001b2c  03a01001          MOVEQ    r1,#1
001b30  01a00006          MOVEQ    r0,r6
001b34  0bfffffe          BLEQ     avar_bat_hndl
                  |L1.6968|
;;;2317   			}
;;;2318   		}
;;;2319   	}
;;;2320   
;;;2321   if(abs(bat[in]._Ib)>IKB) 
001b38  e1d400f4          LDRSH    r0,[r4,#4]
001b3c  ebfffffe          BL       abs
001b40  e51f5b58          LDR      r5,|L1.4080|
001b44  e1d510f0          LDRSH    r1,[r5,#0]  ; IKB
001b48  e1500001          CMP      r0,r1
001b4c  da000004          BLE      |L1.7012|
;;;2322   	{
;;;2323   	if((bat[in]._av))avar_bat_hndl(in,0);
001b50  e5d40035          LDRB     r0,[r4,#0x35]
001b54  e3500000          CMP      r0,#0
001b58  13a01000          MOVNE    r1,#0
001b5c  11a00006          MOVNE    r0,r6
001b60  1bfffffe          BLNE     avar_bat_hndl
                  |L1.7012|
;;;2324   	}
;;;2325   
;;;2326   
;;;2327   
;;;2328   if(bat[in]._Ib>(-IKB))
001b64  e1d510f0          LDRSH    r1,[r5,#0]  ; IKB
001b68  e1d400f4          LDRSH    r0,[r4,#4]
001b6c  e2611000          RSB      r1,r1,#0
001b70  e1500001          CMP      r0,r1
001b74  da000010          BLE      |L1.7100|
;;;2329   	{
;;;2330   	if(bat[in]._cnt_wrk<10)
001b78  e5d40009          LDRB     r0,[r4,#9]
001b7c  e350000a          CMP      r0,#0xa
;;;2331   		{
;;;2332   		bat[in]._cnt_wrk++;
;;;2333   		if((bat[in]._cnt_wrk>=10)&&(bat[in]._wrk)) 
;;;2334   			{
;;;2335   			bat[in]._wrk=0;
;;;2336   			beep_init(0x7L,'O');
;;;2337   			//wrk_mem_hndl(0);
;;;2338   			//plazma++;
;;;2339   			}
;;;2340   		}
;;;2341   	else bat[in]._cnt_wrk=10;	
001b80  23a0000a          MOVCS    r0,#0xa
001b84  25c40009          STRBCS   r0,[r4,#9]
001b88  2a000016          BCS      |L1.7144|
001b8c  e2800001          ADD      r0,r0,#1              ;2332
001b90  e20000ff          AND      r0,r0,#0xff           ;2332
001b94  e350000a          CMP      r0,#0xa               ;2333
001b98  e5c40009          STRB     r0,[r4,#9]            ;2332
001b9c  3a000011          BCC      |L1.7144|
001ba0  e5d4000a          LDRB     r0,[r4,#0xa]          ;2333
001ba4  e3500000          CMP      r0,#0                 ;2333
001ba8  13a0104f          MOVNE    r1,#0x4f              ;2336
001bac  13a00007          MOVNE    r0,#7                 ;2336
001bb0  15c4800a          STRBNE   r8,[r4,#0xa]          ;2335
001bb4  1bfffffe          BLNE     beep_init
001bb8  ea00000a          B        |L1.7144|
                  |L1.7100|
;;;2342   	}	
;;;2343   
;;;2344   else if(bat[in]._Ib<(-IKB))
001bbc  aa000009          BGE      |L1.7144|
;;;2345   	{
;;;2346   	if(bat[in]._cnt_wrk)
001bc0  e5d40009          LDRB     r0,[r4,#9]
001bc4  e3500000          CMP      r0,#0
001bc8  0a000006          BEQ      |L1.7144|
;;;2347   		{
;;;2348   		bat[in]._cnt_wrk--;
001bcc  e2400001          SUB      r0,r0,#1
001bd0  e21000ff          ANDS     r0,r0,#0xff
001bd4  e5c40009          STRB     r0,[r4,#9]
;;;2349   		if((bat[in]._cnt_wrk==0)&&(bat[in]._wrk==0)) 
001bd8  05d4000a          LDRBEQ   r0,[r4,#0xa]
001bdc  03500000          CMPEQ    r0,#0
;;;2350   			{
;;;2351   			bat[in]._wrk=1;
001be0  03a00001          MOVEQ    r0,#1
001be4  05c4000a          STRBEQ   r0,[r4,#0xa]
                  |L1.7144|
;;;2352   			}
;;;2353   
;;;2354   		}
;;;2355   	else bat[in]._cnt_wrk=0;	 
;;;2356   	
;;;2357   	}					
;;;2358   
;;;2359   
;;;2360   
;;;2361   
;;;2362   /*if(bat[in]._cnt_to_block)
;;;2363   	{
;;;2364   	bat[in]._cnt_to_block--;
;;;2365   	if(!(bat[in]._cnt_to_block))
;;;2366   		{
;;;2367   		//bat[in]._rel_stat=1;
;;;2368   		}
;;;2369   	}
;;;2370   */
;;;2371   
;;;2372   
;;;2373   
;;;2374   
;;;2375   //unsigned int tempUI,tempUI_;
;;;2376   //unsigned int b_zar; 
;;;2377   //char i;
;;;2378   //Ibat[0]=5000;                     
;;;2379   
;;;2380   #define AH_CONSTANT		36000L
;;;2381                               
;;;2382   if(bat[in]._time_cnt==0)
001be8  e5d40036          LDRB     r0,[r4,#0x36]
;;;2383   	{
;;;2384   	bat[in]._zar_cnt+=(signed long)bat[in]._Ib;
;;;2385   	
;;;2386   	if(bat[in]._zar_cnt>=AH_CONSTANT)
001bec  e59fa778          LDR      r10,|L1.9068|
001bf0  e3500000          CMP      r0,#0                 ;2382
001bf4  1a00003e          BNE      |L1.7412|
001bf8  e1d410f4          LDRSH    r1,[r4,#4]            ;2384
001bfc  e5940010          LDR      r0,[r4,#0x10]         ;2384
;;;2387   		{
;;;2388   		if(BAT_C_REAL[in]==0x5555) tempUS_=BAT_C_NOM[in];
001c00  e59f9768          LDR      r9,|L1.9072|
001c04  e0800001          ADD      r0,r0,r1              ;2384
001c08  e59f1764          LDR      r1,|L1.9076|
001c0c  e150000a          CMP      r0,r10                ;2386
001c10  e0817086          ADD      r7,r1,r6,LSL #1
;;;2389   		else tempUS_=BAT_C_REAL[in];
;;;2390   		
;;;2391   		b_zar=lc640_read_int(ADR_EE_BAT_ZAR_CNT[in]);
001c14  e59f175c          LDR      r1,|L1.9080|
001c18  e5840010          STR      r0,[r4,#0x10]         ;2388
001c1c  e0815086          ADD      r5,r1,r6,LSL #1
001c20  e59f1754          LDR      r1,|L1.9084|
001c24  e0816086          ADD      r6,r1,r6,LSL #1       ;2388
001c28  ba000011          BLT      |L1.7284|
001c2c  e1d6b0b0          LDRH     r11,[r6,#0]           ;2388
001c30  e1d500b0          LDRH     r0,[r5,#0]
001c34  e15b0009          CMP      r11,r9                ;2388
001c38  01d7b0b0          LDRHEQ   r11,[r7,#0]           ;2388
001c3c  ebfffffe          BL       lc640_read_int
001c40  e1a01800          LSL      r1,r0,#16
001c44  e1a01821          LSR      r1,r1,#16
001c48  e08b010b          ADD      r0,r11,r11,LSL #2
;;;2392   
;;;2393   		if(b_zar<(tempUS_*10))
001c4c  e1510080          CMP      r1,r0,LSL #1
;;;2394   			{
;;;2395   			bat[in]._zar_cnt-=AH_CONSTANT;
;;;2396   
;;;2397   			lc640_write_int(ADR_EE_BAT_ZAR_CNT[in],b_zar+1);
;;;2398   			}
;;;2399   		else 
;;;2400   			{
;;;2401   			bat[in]._zar_cnt=AH_CONSTANT;
001c50  2584a010          STRCS    r10,[r4,#0x10]
001c54  2a000018          BCS      |L1.7356|
001c58  e5940010          LDR      r0,[r4,#0x10]         ;2395
001c5c  e2811001          ADD      r1,r1,#1              ;2397
001c60  e2400902          SUB      r0,r0,#0x8000         ;2395
001c64  e2400eca          SUB      r0,r0,#0xca0          ;2395
001c68  e5840010          STR      r0,[r4,#0x10]         ;2395
001c6c  e1d500f0          LDRSH    r0,[r5,#0]            ;2397
001c70  ea00000e          B        |L1.7344|
                  |L1.7284|
;;;2402   			}
;;;2403   
;;;2404   		}
;;;2405   
;;;2406   	else if(bat[in]._zar_cnt<=-AH_CONSTANT)
001c74  e59fb704          LDR      r11,|L1.9088|
001c78  e150000b          CMP      r0,r11
001c7c  ca00000e          BGT      |L1.7356|
;;;2407   		{
;;;2408   		if(BAT_C_REAL[in]==0x5555) tempUS_=BAT_C_NOM[in];
001c80  e1d600b0          LDRH     r0,[r6,#0]
;;;2409   		else tempUS_=BAT_C_REAL[in];
;;;2410   		
;;;2411   		b_zar=lc640_read_int(ADR_EE_BAT_ZAR_CNT[in]);
001c84  e1d500b0          LDRH     r0,[r5,#0]
001c88  ebfffffe          BL       lc640_read_int
001c8c  e010182b          ANDS     r1,r0,r11,LSR #16
;;;2412   
;;;2413   		if(b_zar)
;;;2414   			{
;;;2415   			bat[in]._zar_cnt+=AH_CONSTANT;
;;;2416   
;;;2417   			lc640_write_int(ADR_EE_BAT_ZAR_CNT[in],b_zar-1);
;;;2418   			}
;;;2419   		else 
;;;2420   			{
;;;2421   			bat[in]._zar_cnt=-AH_CONSTANT;
001c90  0584b010          STREQ    r11,[r4,#0x10]
001c94  0a000008          BEQ      |L1.7356|
001c98  e5940010          LDR      r0,[r4,#0x10]         ;2415
001c9c  e2411001          SUB      r1,r1,#1              ;2417
001ca0  e2800902          ADD      r0,r0,#0x8000         ;2415
001ca4  e2800eca          ADD      r0,r0,#0xca0          ;2415
001ca8  e5840010          STR      r0,[r4,#0x10]         ;2415
001cac  e1d500f0          LDRSH    r0,[r5,#0]            ;2417
                  |L1.7344|
001cb0  e1a01801          LSL      r1,r1,#16             ;2417
001cb4  e1a01841          ASR      r1,r1,#16             ;2417
001cb8  ebfffffe          BL       lc640_write_int
                  |L1.7356|
;;;2422   			}
;;;2423   
;;;2424   		}
;;;2425   
;;;2426   /*
;;;2427        
;;;2428   	b_zar=lc640_read_int(ADR_EE_BAT_ZAR_CNT[in]);
;;;2429      
;;;2430   	if((bat[in]._Ib>-10000L)&&(bat[in]._Ib<10000L))
;;;2431   		{
;;;2432   		if(bat[in]._Ib<0)
;;;2433   			{
;;;2434   			if((b_zar>0)||((b_zar==0)&&(bat[in]._zar_cnt>0))) 
;;;2435   			{
;;;2436   			bat[in]._zar_cnt+=(signed long)bat[in]._Ib;
;;;2437   			if(bat[in]._zar_cnt<=-360000L)
;;;2438   					{
;;;2439   					bat[in]._zar_cnt=0;
;;;2440   									
;;;2441   					if(b_zar)
;;;2442   						{
;;;2443   						b_zar--;
;;;2444   						lc640_write_int(ADR_EE_BAT_ZAR_CNT[in],b_zar);
;;;2445   						}
;;;2446   			          }
;;;2447   			 	}
;;;2448   			}
;;;2449   	   	}
;;;2450   	else if(bat[in]._Ib>0)
;;;2451   		{           
;;;2452   		if(b_zar>((tempUS_/10)+1))
;;;2453   			{
;;;2454   			lc640_write_int(ADR_EE_BAT_ZAR_CNT[in],tempUS_/10);
;;;2455   			bat[in]._zar_cnt=0;
;;;2456   			}    
;;;2457   		else if((b_zar<=tempUS_/10))
;;;2458   			{
;;;2459   			bat[in]._zar_cnt+=((signed long)bat[in]._Ib*100L)/KOEFPOT;
;;;2460   			if(bat[in]._zar_cnt>=360000L)
;;;2461   				{
;;;2462   				tempUS=lc640_read_int(ADR_EE_BAT_ZAR_CNT[in]); 
;;;2463   			
;;;2464   				if(tempUS<=tempUS_/10)
;;;2465   					{
;;;2466   					tempUS++;
;;;2467   					lc640_write_int(ADR_EE_BAT_ZAR_CNT[in],tempUS);
;;;2468                            bat[in]._zar_cnt=0;
;;;2469   					}
;;;2470   				}	
;;;2471   			}
;;;2472   		}*/	
;;;2473   			
;;;2474   	tempUL=(unsigned long)lc640_read_int(ADR_EE_BAT_ZAR_CNT[in]);
001cbc  e1d500b0          LDRH     r0,[r5,#0]
001cc0  ebfffffe          BL       lc640_read_int
;;;2475   	
;;;2476   	if(BAT_C_REAL[in]==0x5555) tempUL_=(unsigned long)BAT_C_NOM[in];
001cc4  e1d610b0          LDRH     r1,[r6,#0]
;;;2477   	else tempUL_=(unsigned long)BAT_C_REAL[in];
;;;2478   		           	
;;;2479   	tempUL*=1000L;
001cc8  e3a02ffa          MOV      r2,#0x3e8
001ccc  e0000092          MUL      r0,r2,r0
001cd0  e1510009          CMP      r1,r9                 ;2476
001cd4  01d710b0          LDRHEQ   r1,[r7,#0]            ;2476
;;;2480   
;;;2481   
;;;2482   	if(tempUL_==0) tempUL=0;
001cd8  e3510000          CMP      r1,#0
001cdc  03a00000          MOVEQ    r0,#0
001ce0  0a000000          BEQ      |L1.7400|
;;;2483   	else tempUL/=tempUL_;
001ce4  ebfffffe          BL       __aeabi_uidivmod
                  |L1.7400|
;;;2484   
;;;2485   	tempUL/=100L;
001ce8  e3a01064          MOV      r1,#0x64
001cec  ebfffffe          BL       __aeabi_uidivmod
;;;2486   
;;;2487   	bat[in]._zar=(unsigned short)tempUL;
001cf0  e1c400bc          STRH     r0,[r4,#0xc]
                  |L1.7412|
;;;2488   	
;;;2489   	//gran(&bat[in]._zar,0,100);
;;;2490        }
;;;2491        
;;;2492   if(bat[in]._wrk==1)
001cf4  e5d4000a          LDRB     r0,[r4,#0xa]
001cf8  e3500001          CMP      r0,#1
001cfc  1a00000f          BNE      |L1.7488|
;;;2493   	{
;;;2494   	if(bat[in]._Iintegr<36000)
001d00  e1d401b4          LDRH     r0,[r4,#0x14]
001d04  e150000a          CMP      r0,r10
;;;2495   		{          
;;;2496   		bat[in]._Iintegr+=abs(bat[in]._Ib);
;;;2497   		if(bat[in]._Iintegr>=36000)
;;;2498   			{
;;;2499   			bat[in]._Iintegr=0;
;;;2500   			bat[in]._Iintegr_++;
;;;2501   			}
;;;2502   		}
;;;2503   	else 
;;;2504   		{
;;;2505   		bat[in]._Iintegr=0;
001d08  21c481b4          STRHCS   r8,[r4,#0x14]
001d0c  2a00000b          BCS      |L1.7488|
001d10  e1d400f4          LDRSH    r0,[r4,#4]            ;2496
001d14  ebfffffe          BL       abs
001d18  e1d411b4          LDRH     r1,[r4,#0x14]         ;2496
001d1c  e0800001          ADD      r0,r0,r1              ;2496
001d20  e1a00800          LSL      r0,r0,#16             ;2496
001d24  e1a00820          LSR      r0,r0,#16             ;2496
001d28  e150000a          CMP      r0,r10                ;2497
001d2c  e1c401b4          STRH     r0,[r4,#0x14]         ;2496
001d30  21c481b4          STRHCS   r8,[r4,#0x14]         ;2499
001d34  21d401b6          LDRHCS   r0,[r4,#0x16]         ;2500
001d38  22800001          ADDCS    r0,r0,#1              ;2500
001d3c  21c401b6          STRHCS   r0,[r4,#0x16]         ;2500
                  |L1.7488|
;;;2506   		}	
;;;2507   	}     
;;;2508   
;;;2509   if((bat[in]._Tb>TBATSIGN)&&(!bat[in]._nd))	
001d40  e59f163c          LDR      r1,|L1.9092|
001d44  e1d400f6          LDRSH    r0,[r4,#6]
001d48  e1d110f0          LDRSH    r1,[r1,#0]  ; TBATSIGN
001d4c  e1500001          CMP      r0,r1
001d50  da000004          BLE      |L1.7528|
001d54  e5d40008          LDRB     r0,[r4,#8]
001d58  e3500000          CMP      r0,#0
;;;2510   	{
;;;2511   	bat[in]._sign_temper_cnt++;
001d5c  01d403b8          LDRHEQ   r0,[r4,#0x38]
001d60  02800001          ADDEQ    r0,r0,#1
001d64  0a000001          BEQ      |L1.7536|
                  |L1.7528|
;;;2512   	}
;;;2513   else 
;;;2514   	{
;;;2515   	bat[in]._sign_temper_cnt--;
001d68  e1d403b8          LDRH     r0,[r4,#0x38]
001d6c  e2400001          SUB      r0,r0,#1
                  |L1.7536|
001d70  e1c403b8          STRH     r0,[r4,#0x38]
;;;2516   	}
;;;2517   
;;;2518   gran(&bat[in]._sign_temper_cnt,0,600);
001d74  e2840038          ADD      r0,r4,#0x38
001d78  e3a02f96          MOV      r2,#0x258
001d7c  e3a01000          MOV      r1,#0
001d80  ebfffffe          BL       gran
;;;2519   if(bat[in]._sign_temper_cnt>=590)	bat[in]._temper_stat|=(1<<0);
001d84  e1d403f8          LDRSH    r0,[r4,#0x38]
001d88  e59f55f8          LDR      r5,|L1.9096|
001d8c  e1500005          CMP      r0,r5
001d90  a5d41037          LDRBGE   r1,[r4,#0x37]
001d94  a3811001          ORRGE    r1,r1,#1
001d98  a5c41037          STRBGE   r1,[r4,#0x37]
;;;2520   if(bat[in]._sign_temper_cnt<=10)	bat[in]._temper_stat&=~(1<<0);
001d9c  e350000a          CMP      r0,#0xa
001da0  d5d40037          LDRBLE   r0,[r4,#0x37]
;;;2521   
;;;2522   
;;;2523   if((bat[in]._Tb>TBATMAX)&&(!bat[in]._nd))	
001da4  e59f15e0          LDR      r1,|L1.9100|
001da8  d3c00001          BICLE    r0,r0,#1              ;2520
001dac  d5c40037          STRBLE   r0,[r4,#0x37]         ;2520
001db0  e1d400f6          LDRSH    r0,[r4,#6]
001db4  e1d110f0          LDRSH    r1,[r1,#0]  ; TBATMAX
001db8  e1500001          CMP      r0,r1
001dbc  da000004          BLE      |L1.7636|
001dc0  e5d40008          LDRB     r0,[r4,#8]
001dc4  e3500000          CMP      r0,#0
;;;2524   	{
;;;2525   	bat[in]._max_temper_cnt++;
001dc8  01d403ba          LDRHEQ   r0,[r4,#0x3a]
001dcc  02800001          ADDEQ    r0,r0,#1
001dd0  0a000001          BEQ      |L1.7644|
                  |L1.7636|
;;;2526   	}
;;;2527   else 
;;;2528   	{
;;;2529   	bat[in]._max_temper_cnt--;
001dd4  e1d403ba          LDRH     r0,[r4,#0x3a]
001dd8  e2400001          SUB      r0,r0,#1
                  |L1.7644|
001ddc  e1c403ba          STRH     r0,[r4,#0x3a]
;;;2530   	}
;;;2531   
;;;2532   gran(&bat[in]._max_temper_cnt,0,600);
001de0  e284003a          ADD      r0,r4,#0x3a
001de4  e3a02f96          MOV      r2,#0x258
001de8  e3a01000          MOV      r1,#0
001dec  ebfffffe          BL       gran
;;;2533   if(bat[in]._max_temper_cnt>=590)	bat[in]._temper_stat|=(1<<1);
001df0  e1d403fa          LDRSH    r0,[r4,#0x3a]
001df4  e1500005          CMP      r0,r5
001df8  a5d41037          LDRBGE   r1,[r4,#0x37]
001dfc  a3811002          ORRGE    r1,r1,#2
001e00  a5c41037          STRBGE   r1,[r4,#0x37]
;;;2534   if(bat[in]._max_temper_cnt<=10)	bat[in]._temper_stat&=~(1<<1);
001e04  e350000a          CMP      r0,#0xa
001e08  d5d40037          LDRBLE   r0,[r4,#0x37]
001e0c  d3c00002          BICLE    r0,r0,#2
001e10  d5c40037          STRBLE   r0,[r4,#0x37]
;;;2535   }
001e14  e8bd5ff0          POP      {r4-r12,lr}
001e18  e12fff1e          BX       lr
;;;2536   
                          ENDP

                  u_necc_hndl PROC
;;;2549   //-----------------------------------------------
;;;2550   void u_necc_hndl(void)
001e1c  e92d43f8          PUSH     {r3-r9,lr}
;;;2551   {
;;;2552   signed long temp_SL;
;;;2553   //signed short temp_SS;
;;;2554   static unsigned char unh_cnt0,unh_cnt1/*,unh_cnt2*/,b1Hz_unh/*,b2Hz_unh*/;
;;;2555   signed short t[2];
;;;2556   char i;
;;;2557   
;;;2558   //temp_SS=0;
;;;2559   
;;;2560   
;;;2561   if(unh_cnt0<10)
001e20  e51f5e7c          LDR      r5,|L1.4012|
;;;2562   	{
;;;2563   	unh_cnt0++;
;;;2564   	if(unh_cnt0>=10)
;;;2565   		{
;;;2566   		unh_cnt0=0;
001e24  e3a01000          MOV      r1,#0
001e28  e5d50005          LDRB     r0,[r5,#5]            ;2561  ; unh_cnt0
001e2c  e350000a          CMP      r0,#0xa               ;2561
001e30  2a000006          BCS      |L1.7760|
001e34  e2800001          ADD      r0,r0,#1              ;2563
001e38  e20000ff          AND      r0,r0,#0xff           ;2563
001e3c  e350000a          CMP      r0,#0xa               ;2564
001e40  e5c50005          STRB     r0,[r5,#5]            ;2563  ; unh_cnt0
;;;2567   		b1Hz_unh=1;
001e44  23a00001          MOVCS    r0,#1
001e48  25c51005          STRBCS   r1,[r5,#5]            ;2566  ; unh_cnt0
001e4c  25c50007          STRBCS   r0,[r5,#7]  ; b1Hz_unh
                  |L1.7760|
;;;2568   		}
;;;2569   	}
;;;2570   
;;;2571   if(unh_cnt1<5)
001e50  e5d50006          LDRB     r0,[r5,#6]  ; unh_cnt1
001e54  e3500005          CMP      r0,#5
001e58  2a000004          BCS      |L1.7792|
;;;2572   	{
;;;2573   	unh_cnt1++;
001e5c  e2800001          ADD      r0,r0,#1
001e60  e20000ff          AND      r0,r0,#0xff
;;;2574   	if(unh_cnt1==5)
001e64  e3500005          CMP      r0,#5
001e68  e5c50006          STRB     r0,[r5,#6]            ;2573  ; unh_cnt1
;;;2575   		{
;;;2576   		unh_cnt1=0;
001e6c  05c51006          STRBEQ   r1,[r5,#6]  ; unh_cnt1
                  |L1.7792|
;;;2577   //		b2Hz_unh=1;
;;;2578   		}
;;;2579   	} 
;;;2580   
;;;2581   
;;;2582   
;;;2583   if(mess_find_unvol(MESS2UNECC_HNDL))
001e70  e3a000be          MOV      r0,#0xbe
001e74  ebfffffe          BL       mess_find_unvol
;;;2584   	{		
;;;2585   	if(mess_data[0]==PARAM_UNECC_SET)
;;;2586   		{
;;;2587   		u_necc=mess_data[1];
001e78  e59f4510          LDR      r4,|L1.9104|
001e7c  e3500000          CMP      r0,#0                 ;2583
001e80  0a000005          BEQ      |L1.7836|
001e84  e51f0e8c          LDR      r0,|L1.4096|
001e88  e5901000          LDR      r1,[r0,#0]            ;2585  ; mess_data
001e8c  e35100bf          CMP      r1,#0xbf              ;2585
001e90  1a000044          BNE      |L1.8104|
001e94  e5900004          LDR      r0,[r0,#4]  ; mess_data
001e98  ea000041          B        |L1.8100|
                  |L1.7836|
;;;2588   		}		
;;;2589   	}
;;;2590   
;;;2591   
;;;2592   else if(b1Hz_unh)
001e9c  e5d50007          LDRB     r0,[r5,#7]  ; b1Hz_unh
001ea0  e3500000          CMP      r0,#0
001ea4  0a00003f          BEQ      |L1.8104|
;;;2593   	{
;;;2594   	
;;;2595   	if((BAT_IS_ON[0]!=bisON) && (BAT_IS_ON[1]!=bisON))
001ea8  e51f6ebc          LDR      r6,|L1.4084|
001eac  e5d60000          LDRB     r0,[r6,#0]  ; BAT_IS_ON
001eb0  e3500055          CMP      r0,#0x55
001eb4  15d60001          LDRBNE   r0,[r6,#1]  ; BAT_IS_ON
001eb8  13500055          CMPNE    r0,#0x55
;;;2596   		{
;;;2597   		u_necc=U0B;
001ebc  159f04d0          LDRNE    r0,|L1.9108|
001ec0  11d000b0          LDRHNE   r0,[r0,#0]  ; U0B
001ec4  1a000036          BNE      |L1.8100|
;;;2598   		}
;;;2599   	else 
;;;2600   		{
;;;2601   		for(i=0;i<2;i++)
;;;2602   			{
;;;2603   			if(BAT_IS_ON[i]==bisON)
;;;2604   				{
;;;2605   				if(bat[1]._nd)t[i]=20;
001ec8  e51feee4          LDR      lr,|L1.4076|
001ecc  e3a00000          MOV      r0,#0                 ;2601
001ed0  e5dec044          LDRB     r12,[lr,#0x44]
001ed4  e3a02014          MOV      r2,#0x14
001ed8  e1a0100d          MOV      r1,sp                 ;2555
;;;2606   				else t[i]=bat[i]._Tb;
;;;2607   				}
;;;2608   			else
;;;2609   				{
;;;2610   				t[i]=-20;
001edc  e3e03013          MVN      r3,#0x13
                  |L1.7904|
001ee0  e7d67000          LDRB     r7,[r6,r0]            ;2603
001ee4  e3570055          CMP      r7,#0x55              ;2603
001ee8  10817080          ADDNE    r7,r1,r0,LSL #1
001eec  11c730b0          STRHNE   r3,[r7,#0]
001ef0  1a000007          BNE      |L1.7956|
001ef4  e35c0000          CMP      r12,#0                ;2605
001ef8  00607200          RSBEQ    r7,r0,r0,LSL #4       ;2606
001efc  008e7107          ADDEQ    r7,lr,r7,LSL #2       ;2606
001f00  01d770b6          LDRHEQ   r7,[r7,#6]            ;2606
001f04  00818080          ADDEQ    r8,r1,r0,LSL #1       ;2606
001f08  01c870b0          STRHEQ   r7,[r8,#0]            ;2606
001f0c  10817080          ADDNE    r7,r1,r0,LSL #1       ;2605
001f10  11c720b0          STRHNE   r2,[r7,#0]            ;2605
                  |L1.7956|
001f14  e2800001          ADD      r0,r0,#1              ;2601
001f18  e20000ff          AND      r0,r0,#0xff           ;2601
001f1c  e3500002          CMP      r0,#2                 ;2601
001f20  3affffee          BCC      |L1.7904|
;;;2611   				}
;;;2612   			}
;;;2613   		if(t[0]>t[1])mat_temper=t[0];
001f24  e1dd00f0          LDRSH    r0,[sp,#0]
001f28  e1dd10f2          LDRSH    r1,[sp,#2]
001f2c  e59f2464          LDR      r2,|L1.9112|
001f30  e1500001          CMP      r0,r1
;;;2614   		else mat_temper=t[1];
001f34  d5821000          STRLE    r1,[r2,#0]  ; mat_temper
;;;2615   		
;;;2616   	
;;;2617   		if(mat_temper<0)temp_SL=UB0; 
001f38  d1a00001          MOVLE    r0,r1
001f3c  e59f1458          LDR      r1,|L1.9116|
001f40  c5820000          STRGT    r0,[r2,#0]            ;2613  ; mat_temper
001f44  e3500000          CMP      r0,#0
001f48  b1d100f0          LDRSHLT  r0,[r1,#0]  ; UB0
001f4c  ba00000d          BLT      |L1.8072|
;;;2618   		else 
;;;2619   			{
;;;2620   			if(mat_temper>40)mat_temper=40; 
001f50  e3500028          CMP      r0,#0x28
001f54  c3a00028          MOVGT    r0,#0x28
001f58  c5820000          STRGT    r0,[r2,#0]  ; mat_temper
;;;2621   			temp_SL=(UB20-UB0)*10;
001f5c  e59f043c          LDR      r0,|L1.9120|
001f60  e1d160f0          LDRSH    r6,[r1,#0]  ; UB0
001f64  e1d000f0          LDRSH    r0,[r0,#0]  ; UB20
;;;2622   			temp_SL*=mat_temper;
001f68  e5921000          LDR      r1,[r2,#0]  ; mat_temper
001f6c  e0400006          SUB      r0,r0,r6              ;2621
001f70  e0800100          ADD      r0,r0,r0,LSL #2       ;2621
001f74  e1a00080          LSL      r0,r0,#1              ;2621
001f78  e0000091          MUL      r0,r1,r0
;;;2623   			temp_SL/=200;
001f7c  e3a010c8          MOV      r1,#0xc8
001f80  ebfffffe          BL       __aeabi_idivmod
;;;2624   			temp_SL+=UB0;
001f84  e0800006          ADD      r0,r0,r6
                  |L1.8072|
;;;2625   			}
;;;2626   		if(spc_stat==spcVZ)
001f88  e5d51013          LDRB     r1,[r5,#0x13]  ; spc_stat
001f8c  e3510002          CMP      r1,#2
;;;2627   			{
;;;2628   			temp_SL*=KVZ;
001f90  059f140c          LDREQ    r1,|L1.9124|
001f94  01d110f0          LDRSHEQ  r1,[r1,#0]  ; KVZ
001f98  00000091          MULEQ    r0,r1,r0
;;;2629   			temp_SL/=1000U;
001f9c  03a01ffa          MOVEQ    r1,#0x3e8
001fa0  0bfffffe          BLEQ     __aeabi_uidivmod
                  |L1.8100|
;;;2630   			}
;;;2631   		u_necc=(unsigned int)temp_SL;
001fa4  e1c400b0          STRH     r0,[r4,#0]  ; u_necc
                  |L1.8104|
;;;2632   		}  
;;;2633   	}
;;;2634   
;;;2635   
;;;2636   
;;;2637   
;;;2638   
;;;2639   
;;;2640   gran(&u_necc,400,UMAX);
001fa8  e59f03f8          LDR      r0,|L1.9128|
001fac  e3a01e19          MOV      r1,#0x190
001fb0  e1d020f0          LDRSH    r2,[r0,#0]  ; UMAX
001fb4  e8bd43f8          POP      {r3-r9,lr}
001fb8  e59f03d0          LDR      r0,|L1.9104|
001fbc  eafffffe          B        gran
;;;2641   }
;;;2642   
                          ENDP

                  num_necc_hndl PROC
;;;2644   //-----------------------------------------------
;;;2645   void num_necc_hndl(void)
001fc0  e92d41f0          PUSH     {r4-r8,lr}
;;;2646   {
;;;2647   char num_necc_up,num_necc_down;
;;;2648   static short num_necc_block_cnt;
;;;2649   if(num_necc_block_cnt) num_necc_block_cnt--;
001fc4  e59f53e0          LDR      r5,|L1.9132|
;;;2650   
;;;2651   Isumm_=Isumm;
001fc8  e59f63e0          LDR      r6,|L1.9136|
001fcc  e1d502f0          LDRSH    r0,[r5,#0x20]         ;2649  ; num_necc_block_cnt
;;;2652   
;;;2653   if(bat[0]._Ib<0) Isumm_+=(abs(bat[0]._Ib))/10;
001fd0  e59f43dc          LDR      r4,|L1.9140|
001fd4  e3500000          CMP      r0,#0                 ;2649
001fd8  12400001          SUBNE    r0,r0,#1              ;2649
001fdc  11c502b0          STRHNE   r0,[r5,#0x20]         ;2649  ; num_necc_block_cnt
001fe0  e51f0f80          LDR      r0,|L1.4200|
001fe4  e1d000b0          LDRH     r0,[r0,#0]            ;2651  ; Isumm
001fe8  e1c600b0          STRH     r0,[r6,#0]            ;2651  ; Isumm_
001fec  e1d400f4          LDRSH    r0,[r4,#4]  ; bat
001ff0  e3500000          CMP      r0,#0
001ff4  aa000005          BGE      |L1.8208|
001ff8  ebfffffe          BL       abs
001ffc  e3a0100a          MOV      r1,#0xa
002000  ebfffffe          BL       __aeabi_idivmod
002004  e1d610b0          LDRH     r1,[r6,#0]  ; Isumm_
002008  e0800001          ADD      r0,r0,r1
00200c  e1c600b0          STRH     r0,[r6,#0]  ; Isumm_
                  |L1.8208|
;;;2654   if(bat[1]._Ib<0) Isumm_+=(abs(bat[1]._Ib))/10;
002010  e1d404f0          LDRSH    r0,[r4,#0x40]  ; bat
002014  e3500000          CMP      r0,#0
002018  aa000005          BGE      |L1.8244|
00201c  ebfffffe          BL       abs
002020  e3a0100a          MOV      r1,#0xa
002024  ebfffffe          BL       __aeabi_idivmod
002028  e1d610b0          LDRH     r1,[r6,#0]  ; Isumm_
00202c  e0800001          ADD      r0,r0,r1
002030  e1c600b0          STRH     r0,[r6,#0]  ; Isumm_
                  |L1.8244|
;;;2655   
;;;2656   num_necc_up=(Isumm_/((signed short)IMAX))+1;
002034  e59f037c          LDR      r0,|L1.9144|
002038  e1d010f0          LDRSH    r1,[r0,#0]  ; IMAX
00203c  e1d600f0          LDRSH    r0,[r6,#0]  ; Isumm_
002040  e1a07001          MOV      r7,r1
002044  e1a08000          MOV      r8,r0
002048  ebfffffe          BL       __aeabi_idivmod
00204c  e2800001          ADD      r0,r0,#1
002050  e20040ff          AND      r4,r0,#0xff
;;;2657   
;;;2658   Isumm_+=(signed short)((IMAX*(10-KIMAX))/10);
002054  e59f0360          LDR      r0,|L1.9148|
002058  e3a0100a          MOV      r1,#0xa
00205c  e1d000f0          LDRSH    r0,[r0,#0]  ; KIMAX
002060  e260000a          RSB      r0,r0,#0xa
002064  e0000097          MUL      r0,r7,r0
002068  ebfffffe          BL       __aeabi_idivmod
00206c  e0800008          ADD      r0,r0,r8
002070  e1a00800          LSL      r0,r0,#16
002074  e1a00840          ASR      r0,r0,#16
002078  e1a01007          MOV      r1,r7
00207c  e1c600b0          STRH     r0,[r6,#0]  ; Isumm_
;;;2659   
;;;2660   num_necc_down=(Isumm_/((signed short)IMAX))+1;
002080  ebfffffe          BL       __aeabi_idivmod
;;;2661   
;;;2662   if(num_necc_up>num_necc)
002084  e59f22d4          LDR      r2,|L1.9056|
002088  e2800001          ADD      r0,r0,#1              ;2660
00208c  e1d210f0          LDRSH    r1,[r2,#0]  ; num_necc
002090  e20000ff          AND      r0,r0,#0xff           ;2660
;;;2663   	{
;;;2664   	num_necc=num_necc_up;
;;;2665   	num_necc_block_cnt=60;
002094  e3a0303c          MOV      r3,#0x3c
002098  e1540001          CMP      r4,r1                 ;2662
00209c  c1c240b0          STRHGT   r4,[r2,#0]            ;2664  ; num_necc
0020a0  ca000005          BGT      |L1.8380|
;;;2666   	}
;;;2667   else if(num_necc_down<num_necc)
0020a4  e1500001          CMP      r0,r1
0020a8  aa000004          BGE      |L1.8384|
;;;2668   	{
;;;2669   	if(!num_necc_block_cnt)
0020ac  e1d512b0          LDRH     r1,[r5,#0x20]  ; num_necc_block_cnt
0020b0  e3510000          CMP      r1,#0
0020b4  1a000001          BNE      |L1.8384|
;;;2670   		{
;;;2671   		num_necc=num_necc_down;
0020b8  e1c200b0          STRH     r0,[r2,#0]  ; num_necc
                  |L1.8380|
;;;2672   		num_necc_block_cnt=60;
0020bc  e1c532b0          STRH     r3,[r5,#0x20]  ; num_necc_block_cnt
                  |L1.8384|
;;;2673   		}
;;;2674   	}
;;;2675   
;;;2676   if(PAR) num_necc=NUMIST;
0020c0  e59f02f8          LDR      r0,|L1.9152|
0020c4  e1d010b0          LDRH     r1,[r0,#0]  ; PAR
0020c8  e59f02f4          LDR      r0,|L1.9156|
0020cc  e3510000          CMP      r1,#0
0020d0  11d010b0          LDRHNE   r1,[r0,#0]  ; NUMIST
0020d4  11c210b0          STRHNE   r1,[r2,#0]  ; num_necc
;;;2677   
;;;2678   gran(&num_necc,1,NUMIST);
0020d8  e1d020f0          LDRSH    r2,[r0,#0]  ; NUMIST
0020dc  e8bd41f0          POP      {r4-r8,lr}
0020e0  e59f0278          LDR      r0,|L1.9056|
0020e4  e3a01001          MOV      r1,#1
0020e8  eafffffe          B        gran
;;;2679   
;;;2680   }
;;;2681   
                          ENDP

                  cntrl_hndl PROC
;;;2682   //-----------------------------------------------
;;;2683   void cntrl_hndl(void)
0020ec  e92d47f0          PUSH     {r4-r10,lr}
;;;2684   {
;;;2685   static char	ch_cnt0,b1Hz_ch;
;;;2686   static unsigned short IZMAX_;
;;;2687   
;;;2688   IZMAX_=IZMAX;
0020f0  e59f02d0          LDR      r0,|L1.9160|
0020f4  e59f62b0          LDR      r6,|L1.9132|
0020f8  e1d000f0          LDRSH    r0,[r0,#0]  ; IZMAX
;;;2689   
;;;2690   if((bat[0]._temper_stat&0x03)||(bat[1]._temper_stat&0x03))IZMAX_=IZMAX/10;
0020fc  e59f12b0          LDR      r1,|L1.9140|
002100  e1c602b2          STRH     r0,[r6,#0x22]         ;2688  ; IZMAX_
002104  e5d12037          LDRB     r2,[r1,#0x37]  ; bat
002108  e3120003          TST      r2,#3
00210c  05d11073          LDRBEQ   r1,[r1,#0x73]  ; bat
002110  03110003          TSTEQ    r1,#3
002114  0a000002          BEQ      |L1.8484|
002118  e3a0100a          MOV      r1,#0xa
00211c  ebfffffe          BL       __aeabi_idivmod
002120  e1c602b2          STRH     r0,[r6,#0x22]  ; IZMAX_
                  |L1.8484|
;;;2691   
;;;2692   
;;;2693   if(ch_cnt0<10)
002124  e5d60008          LDRB     r0,[r6,#8]  ; ch_cnt0
;;;2694   	{
;;;2695   	ch_cnt0++;
;;;2696   	if(ch_cnt0>=10)
;;;2697   		{
;;;2698   		ch_cnt0=0;
002128  e3a08000          MOV      r8,#0
00212c  e350000a          CMP      r0,#0xa               ;2693
002130  2a000006          BCS      |L1.8528|
002134  e2800001          ADD      r0,r0,#1              ;2695
002138  e20000ff          AND      r0,r0,#0xff           ;2695
00213c  e350000a          CMP      r0,#0xa               ;2696
002140  e5c60008          STRB     r0,[r6,#8]            ;2695  ; ch_cnt0
;;;2699   		b1Hz_ch=1;
002144  23a00001          MOVCS    r0,#1
002148  25c68008          STRBCS   r8,[r6,#8]            ;2698  ; ch_cnt0
00214c  25c60009          STRBCS   r0,[r6,#9]  ; b1Hz_ch
                  |L1.8528|
;;;2700   		}
;;;2701   	}
;;;2702   //signed long temp_L;
;;;2703   
;;;2704   //plazma=0;
;;;2705   
;;;2706   /*if(St&0x01)
;;;2707   	{
;;;2708   	cntrl_stat=0;
;;;2709        old_cntrl_stat=0;
;;;2710        }
;;;2711   else*//* if((kb_cnt[0]>15)&&(kb_cnt[0]<=30))
;;;2712   	{
;;;2713   	cntrl_stat=old_cntrl_stat-30;
;;;2714   	gran(&cntrl_stat,30,970);
;;;2715   	}
;;;2716   else*/ /*if((kb_cnt[0]<=15)&&(kb_cnt[0]>0))
;;;2717   	{
;;;2718   	cntrl_stat=old_cntrl_stat+30;
;;;2719   	gran(&cntrl_stat,30,970);
;;;2720   	} 
;;;2721   else*//* if((kb_cnt[1]>15)&&(kb_cnt[1]<=30))
;;;2722   	{
;;;2723   	cntrl_stat=old_cntrl_stat-100;
;;;2724   	gran(&cntrl_stat,30,970);
;;;2725   	}
;;;2726   else if((kb_cnt[1]<=15)&&(kb_cnt[1]>0))
;;;2727   	{
;;;2728   	cntrl_stat=old_cntrl_stat+100;
;;;2729   	gran(&cntrl_stat,30,970);
;;;2730   	}
;;;2731   else if(kb_full_ver)
;;;2732   	{
;;;2733   	cntrl_stat-=50;
;;;2734   	if(cntrl_stat<30)
;;;2735   		{
;;;2736   		if((av_stat&0x0002)==0)avar_bat_hndl(1);
;;;2737   		kb_full_ver=0;
;;;2738   		gran(&TBAT,5,60);
;;;2739        	bat_ver_cnt=TBAT*300;
;;;2740   		}
;;;2741   	gran(&cntrl_stat,30,970);
;;;2742   	} 	 	
;;;2743   
;;;2744   
;;;2745   else*/ 
;;;2746   /*if(mess_find(_MESS_FAST_REG))
;;;2747   	{
;;;2748    	if(load_U>u_necc)
;;;2749   		{
;;;2750   		if(((load_U-u_necc)>10)&&(cntrl_stat>0))cntrl_stat-=50;
;;;2751   		else if(cntrl_stat)cntrl_stat--;
;;;2752   		}
;;;2753   	else if(load_U<u_necc)
;;;2754   		{
;;;2755   		if(((u_necc-load_U)>10)&&(cntrl_stat<1015))cntrl_stat+=50;
;;;2756   		else	if(cntrl_stat<1020)cntrl_stat++;
;;;2757   		}		
;;;2758   	}
;;;2759   
;;;2760   
;;;2761   if(mess_find(_MESS_SRC_PWM))
;;;2762   	{				
;;;2763   	if(mess_data[0]==_MESS_SRC_PWM)
;;;2764   		{
;;;2765   		cntrl_stat=mess_data[1];
;;;2766   		}				
;;;2767   	}  */
;;;2768   
;;;2769   
;;;2770   //cntrl_stat++;
;;;2771   
;;;2772   
;;;2773   
;;;2774   if(mess_find_unvol(MESS2CNTRL_HNDL))
002150  e3a000e1          MOV      r0,#0xe1
002154  ebfffffe          BL       mess_find_unvol
;;;2775   	{
;;;2776   	if(mess_data[0]==PARAM_CNTRL_STAT_PLUS)
;;;2777   		{
;;;2778   		cntrl_stat=cntrl_stat_old+mess_data[1];
;;;2779   		}
;;;2780   	else if(mess_data[0]==PARAM_CNTRL_STAT_MINUS)
;;;2781   		{
;;;2782   		cntrl_stat=cntrl_stat_old-mess_data[1];
;;;2783   		}
;;;2784   	else if(mess_data[0]==PARAM_CNTRL_STAT_STEP_DOWN)
;;;2785   		{
;;;2786   		cntrl_stat--;
;;;2787   
;;;2788   		if((cntrl_stat<=30)||(load_U<USIGN)) mess_send(MESS2KB_HNDL,PARAM_CNTRL_IS_DOWN,0,10);
002158  e59f726c          LDR      r7,|L1.9164|
;;;2789   
;;;2790   		}
;;;2791   	else if(mess_data[0]==PARAM_CNTRL_STAT_SET)
;;;2792   		{
;;;2793   		cntrl_stat=mess_data[1];
;;;2794   		}
;;;2795   
;;;2796   	else if(mess_data[0]==PARAM_CNTRL_STAT_FAST_REG)
;;;2797   		{
;;;2798   		if(load_U>u_necc)
00215c  e59f922c          LDR      r9,|L1.9104|
;;;2799   			{
;;;2800   			if(((load_U-u_necc)>10)&&(cntrl_stat>0))cntrl_stat-=5;
;;;2801   			else if((cntrl_stat)&&b1Hz_ch)cntrl_stat--;
;;;2802   			}
;;;2803   		else if(load_U<u_necc)
;;;2804   			{	
;;;2805   			if(((u_necc-load_U)>10)&&(cntrl_stat<1015))cntrl_stat+=5;
;;;2806   			else	if((cntrl_stat<1020)&&b1Hz_ch)cntrl_stat++;
;;;2807   			}	
;;;2808   		 }
;;;2809   
;;;2810   	}
;;;2811   
;;;2812   else if(b1Hz_ch)
;;;2813   	{
;;;2814   	cntrl_stat_new=cntrl_stat_old;
;;;2815   	
;;;2816   	if((Ibmax/10)>(2*IZMAX_))
;;;2817   		{
;;;2818   		cntrl_stat_new-=50;
;;;2819   		}		
;;;2820   	else if(((Ibmax/10)<(IZMAX_*2))&&(Ibmax>(IZMAX_*11)))
;;;2821   		{
;;;2822   		cntrl_stat_new-=5;
;;;2823   		}   
;;;2824   	else if((Ibmax<(IZMAX_*11))&&((Ibmax/10)>IZMAX_))
;;;2825   		{
;;;2826   		cntrl_stat_new--;
;;;2827   		}
;;;2828   		
;;;2829   	else if(load_U<u_necc)
;;;2830   		{
;;;2831   		if(load_U<(u_necc-(UB0-UB20)))
;;;2832   			{
;;;2833   			if(Ibmax<0)
;;;2834   				{
;;;2835   				cntrl_stat_new+=50;
;;;2836   				}
;;;2837   			else if(Ibmax<(IZMAX_*5))
;;;2838   				{
;;;2839   				cntrl_stat_new+=5;
;;;2840   				}
;;;2841   			else if(Ibmax<((IZMAX_*95)/10))
;;;2842   				{
;;;2843   				cntrl_stat_new++;
;;;2844   				}					
;;;2845   			}
;;;2846   		else if(load_U<(u_necc-((UB0-UB20)/4)))
;;;2847   			{
;;;2848   			if(Ibmax<(IZMAX_*5))
;;;2849   				{
;;;2850   				cntrl_stat_new+=5;
;;;2851   				}
;;;2852   			else if(Ibmax<((IZMAX_*95)/10))
;;;2853   				{
;;;2854   				cntrl_stat_new++;
;;;2855   				}					
;;;2856   			}	
;;;2857   		else if(load_U<(u_necc-1))
;;;2858   			{
;;;2859   			if(Ibmax<((IZMAX_*95)/10))
;;;2860   				{
;;;2861   				cntrl_stat_new++;
;;;2862   				}					
;;;2863   			}					
;;;2864   		}	
;;;2865   	else if((load_U>u_necc)/*&&(!cntrl_blok)*/)
;;;2866   		{
;;;2867   		if(load_U>(u_necc+(UB0-UB20)))
;;;2868   			{
;;;2869   			cntrl_stat_new-=30;
;;;2870   			}
;;;2871   		else if(load_U>(u_necc+((UB0-UB20)/4)))
;;;2872   			{
;;;2873   			cntrl_stat_new-=5;
;;;2874   			}	
;;;2875   		else if(load_U>(u_necc+1))
;;;2876   			{
;;;2877   			cntrl_stat_new--;
;;;2878   			}					
;;;2879   		}
;;;2880   	gran(&cntrl_stat_new,10,1010);			
002160  e59fa268          LDR      r10,|L1.9168|
002164  e3500000          CMP      r0,#0                 ;2774
002168  0a000046          BEQ      |L1.8840|
00216c  e59f1260          LDR      r1,|L1.9172|
002170  e5910000          LDR      r0,[r1,#0]            ;2776  ; mess_data
002174  e3500064          CMP      r0,#0x64              ;2776
002178  05910004          LDREQ    r0,[r1,#4]            ;2778  ; mess_data
00217c  01d611bc          LDRHEQ   r1,[r6,#0x1c]         ;2778  ; cntrl_stat_old
002180  00800001          ADDEQ    r0,r0,r1              ;2778
002184  0a0000b2          BEQ      |L1.9300|
002188  e3500069          CMP      r0,#0x69              ;2780
00218c  05910004          LDREQ    r0,[r1,#4]            ;2782  ; mess_data
002190  01d611bc          LDRHEQ   r1,[r6,#0x1c]         ;2782  ; cntrl_stat_old
002194  00410000          SUBEQ    r0,r1,r0              ;2782
002198  0a0000ad          BEQ      |L1.9300|
00219c  e350006e          CMP      r0,#0x6e              ;2784
0021a0  1a000011          BNE      |L1.8684|
0021a4  e1d601ba          LDRH     r0,[r6,#0x1a]         ;2786  ; cntrl_stat
0021a8  e2400001          SUB      r0,r0,#1              ;2786
0021ac  e1a00800          LSL      r0,r0,#16             ;2786
0021b0  e1a00840          ASR      r0,r0,#16             ;2786
0021b4  e350001e          CMP      r0,#0x1e              ;2788
0021b8  e1c601ba          STRH     r0,[r6,#0x1a]         ;2786  ; cntrl_stat
0021bc  da000004          BLE      |L1.8660|
0021c0  e59f1210          LDR      r1,|L1.9176|
0021c4  e1d700f0          LDRSH    r0,[r7,#0]            ;2788  ; load_U
0021c8  e1d110f0          LDRSH    r1,[r1,#0]            ;2788  ; USIGN
0021cc  e1500001          CMP      r0,r1                 ;2788
0021d0  aa0000a0          BGE      |L1.9304|
                  |L1.8660|
0021d4  e3a0300a          MOV      r3,#0xa               ;2788
0021d8  e3a02000          MOV      r2,#0                 ;2788
0021dc  e3a010e7          MOV      r1,#0xe7              ;2788
0021e0  e3a000e6          MOV      r0,#0xe6              ;2788
0021e4  ebfffffe          BL       mess_send
0021e8  ea00009a          B        |L1.9304|
                  |L1.8684|
0021ec  e35000e5          CMP      r0,#0xe5              ;2791
0021f0  05910004          LDREQ    r0,[r1,#4]            ;2793  ; mess_data
0021f4  0a000096          BEQ      |L1.9300|
0021f8  e35000e6          CMP      r0,#0xe6              ;2796
0021fc  1a000095          BNE      |L1.9304|
002200  e1d700f0          LDRSH    r0,[r7,#0]            ;2798  ; load_U
002204  e1d910f0          LDRSH    r1,[r9,#0]            ;2798  ; u_necc
002208  e1500001          CMP      r0,r1                 ;2798
00220c  da00000c          BLE      |L1.8772|
002210  e0400001          SUB      r0,r0,r1              ;2800
002214  e350000a          CMP      r0,#0xa               ;2800
002218  c1d601fa          LDRSHGT  r0,[r6,#0x1a]         ;2800  ; cntrl_stat
00221c  c3500000          CMPGT    r0,#0                 ;2800
002220  c2400005          SUBGT    r0,r0,#5              ;2800
002224  ca00008a          BGT      |L1.9300|
002228  e1d601fa          LDRSH    r0,[r6,#0x1a]         ;2801  ; cntrl_stat
00222c  e3500000          CMP      r0,#0                 ;2801
002230  15d61009          LDRBNE   r1,[r6,#9]            ;2801  ; b1Hz_ch
002234  13510000          CMPNE    r1,#0                 ;2801
002238  0a000086          BEQ      |L1.9304|
00223c  e2400001          SUB      r0,r0,#1              ;2801
002240  ea000083          B        |L1.9300|
                  |L1.8772|
002244  aa000083          BGE      |L1.9304|
002248  e0410000          SUB      r0,r1,r0              ;2805
00224c  e350000a          CMP      r0,#0xa               ;2805
002250  da000004          BLE      |L1.8808|
002254  e1d601fa          LDRSH    r0,[r6,#0x1a]         ;2805  ; cntrl_stat
002258  e59f117c          LDR      r1,|L1.9180|
00225c  e1500001          CMP      r0,r1                 ;2805
002260  b2800005          ADDLT    r0,r0,#5              ;2805
002264  ba00007a          BLT      |L1.9300|
                  |L1.8808|
002268  e1d601fa          LDRSH    r0,[r6,#0x1a]         ;2806  ; cntrl_stat
00226c  e3500fff          CMP      r0,#0x3fc             ;2806
002270  aa000078          BGE      |L1.9304|
002274  e5d61009          LDRB     r1,[r6,#9]            ;2806  ; b1Hz_ch
002278  e3510000          CMP      r1,#0                 ;2806
00227c  0a000075          BEQ      |L1.9304|
002280  e2800001          ADD      r0,r0,#1              ;2806
002284  ea000072          B        |L1.9300|
                  |L1.8840|
002288  e5d60009          LDRB     r0,[r6,#9]            ;2812  ; b1Hz_ch
00228c  e3500000          CMP      r0,#0                 ;2812
002290  0a000070          BEQ      |L1.9304|
002294  e1d641fc          LDRSH    r4,[r6,#0x1c]         ;2814  ; cntrl_stat_old
002298  e3a0100a          MOV      r1,#0xa               ;2816
00229c  e1c642be          STRH     r4,[r6,#0x2e]         ;2814  ; cntrl_stat_new
0022a0  e1d603f0          LDRSH    r0,[r6,#0x30]         ;2816  ; Ibmax
0022a4  e1a05000          MOV      r5,r0                 ;2816
0022a8  ebfffffe          BL       __aeabi_idivmod
0022ac  e1d612b2          LDRH     r1,[r6,#0x22]         ;2816  ; IZMAX_
0022b0  e1500081          CMP      r0,r1,LSL #1          ;2816
0022b4  c2440032          SUBGT    r0,r4,#0x32           ;2818
0022b8  ca00005e          BGT      |L1.9272|
0022bc  e1500081          CMP      r0,r1,LSL #1          ;2820
0022c0  b0812081          ADDLT    r2,r1,r1,LSL #1       ;2820
0022c4  b0822181          ADDLT    r2,r2,r1,LSL #3       ;2820
0022c8  b1520005          CMPLT    r2,r5                 ;2820
0022cc  aa000001          BGE      |L1.8920|
                  |L1.8912|
0022d0  e2440005          SUB      r0,r4,#5              ;2822
0022d4  ea000057          B        |L1.9272|
                  |L1.8920|
0022d8  e0812081          ADD      r2,r1,r1,LSL #1       ;2824
0022dc  e0822181          ADD      r2,r2,r1,LSL #3       ;2824
0022e0  e1520005          CMP      r2,r5                 ;2824
0022e4  c1500001          CMPGT    r0,r1                 ;2824
0022e8  da000001          BLE      |L1.8948|
                  |L1.8940|
0022ec  e2440001          SUB      r0,r4,#1              ;2826
0022f0  ea000050          B        |L1.9272|
                  |L1.8948|
0022f4  e1d700f0          LDRSH    r0,[r7,#0]            ;2829  ; load_U
0022f8  e1d920f0          LDRSH    r2,[r9,#0]            ;2829  ; u_necc
0022fc  e59f3098          LDR      r3,|L1.9116|
002300  e59fc098          LDR      r12,|L1.9120|
002304  e1500002          CMP      r0,r2                 ;2829
002308  aa000042          BGE      |L1.9240|
00230c  e1d330f0          LDRSH    r3,[r3,#0]            ;2831  ; UB0
002310  e1dcc0f0          LDRSH    r12,[r12,#0]          ;2831  ; UB20
002314  e043300c          SUB      r3,r3,r12             ;2831
002318  e042c003          SUB      r12,r2,r3             ;2831
00231c  e15c0000          CMP      r12,r0                ;2831
002320  da00002e          BLE      |L1.9184|
002324  e3550000          CMP      r5,#0                 ;2833
002328  b2840032          ADDLT    r0,r4,#0x32           ;2835
00232c  ba000041          BLT      |L1.9272|
002330  ea00002f          B        |L1.9204|
                  |L1.9012|
002334  e0610281          RSB      r0,r1,r1,LSL #5       ;2841
002338  e0800301          ADD      r0,r0,r1,LSL #6       ;2841
00233c  e3a0100a          MOV      r1,#0xa               ;2841
002340  ebfffffe          BL       __aeabi_uidivmod
002344  e1500005          CMP      r0,r5                 ;2841
002348  da00003b          BLE      |L1.9276|
00234c  e2840001          ADD      r0,r4,#1              ;2861
002350  ea000038          B        |L1.9272|
                  |L1.9044|
                          DCD      0xe0028000
                  |L1.9048|
                          DCD      avar_ind_stat
                  |L1.9052|
                          DCD      0x0000ffff
                  |L1.9056|
                          DCD      num_necc
                  |L1.9060|
                          DCD      main_1Hz_cnt
                  |L1.9064|
                          DCD      main_10Hz_cnt
                  |L1.9068|
                          DCD      0x00008ca0
                  |L1.9072|
                          DCD      0x00005555
                  |L1.9076|
                          DCD      BAT_C_NOM
                  |L1.9080|
                          DCD      ADR_EE_BAT_ZAR_CNT
                  |L1.9084|
                          DCD      BAT_C_REAL
                  |L1.9088|
                          DCD      0xffff7360
                  |L1.9092|
                          DCD      TBATSIGN
                  |L1.9096|
                          DCD      0x0000024e
                  |L1.9100|
                          DCD      TBATMAX
                  |L1.9104|
                          DCD      u_necc
                  |L1.9108|
                          DCD      U0B
                  |L1.9112|
                          DCD      mat_temper
                  |L1.9116|
                          DCD      UB0
                  |L1.9120|
                          DCD      UB20
                  |L1.9124|
                          DCD      KVZ
                  |L1.9128|
                          DCD      UMAX
                  |L1.9132|
                          DCD      ||.data||
                  |L1.9136|
                          DCD      Isumm_
                  |L1.9140|
                          DCD      bat
                  |L1.9144|
                          DCD      IMAX
                  |L1.9148|
                          DCD      KIMAX
                  |L1.9152|
                          DCD      PAR
                  |L1.9156|
                          DCD      NUMIST
                  |L1.9160|
                          DCD      IZMAX
                  |L1.9164|
                          DCD      load_U
                  |L1.9168|
                          DCD      0x000003f2
                  |L1.9172|
                          DCD      mess_data
                  |L1.9176|
                          DCD      USIGN
                  |L1.9180|
                          DCD      0x000003f7
                  |L1.9184|
0023e0  e1a0cfc3          ASR      r12,r3,#31            ;2846
0023e4  e0833f2c          ADD      r3,r3,r12,LSR #30     ;2846
0023e8  e0423143          SUB      r3,r2,r3,ASR #2       ;2846
0023ec  e1530000          CMP      r3,r0                 ;2846
0023f0  da000004          BLE      |L1.9224|
                  |L1.9204|
0023f4  e0810101          ADD      r0,r1,r1,LSL #2       ;2846
0023f8  e1500005          CMP      r0,r5                 ;2848
0023fc  daffffcc          BLE      |L1.9012|
002400  e2840005          ADD      r0,r4,#5              ;2850
002404  ea00000b          B        |L1.9272|
                  |L1.9224|
002408  e2422001          SUB      r2,r2,#1              ;2857
00240c  e1500002          CMP      r0,r2                 ;2857
002410  baffffc7          BLT      |L1.9012|
002414  ea000008          B        |L1.9276|
                  |L1.9240|
002418  da000007          BLE      |L1.9276|
00241c  e1d310f0          LDRSH    r1,[r3,#0]            ;2867  ; UB0
002420  e1dc30f0          LDRSH    r3,[r12,#0]           ;2867  ; UB20
002424  e0411003          SUB      r1,r1,r3              ;2867
002428  e0813002          ADD      r3,r1,r2              ;2867
00242c  e1530000          CMP      r3,r0                 ;2867
002430  aa00000f          BGE      |L1.9332|
002434  e244001e          SUB      r0,r4,#0x1e           ;2869
                  |L1.9272|
002438  e1c602be          STRH     r0,[r6,#0x2e]         ;2877  ; cntrl_stat_new
                  |L1.9276|
00243c  e59f0054          LDR      r0,|L1.9368|
002440  e1a0200a          MOV      r2,r10
002444  e3a0100a          MOV      r1,#0xa
002448  ebfffffe          BL       gran
;;;2881   	cntrl_stat_old=cntrl_stat_new;
00244c  e1d602be          LDRH     r0,[r6,#0x2e]  ; cntrl_stat_new
002450  e1c601bc          STRH     r0,[r6,#0x1c]  ; cntrl_stat_old
                  |L1.9300|
;;;2882   	cntrl_stat=cntrl_stat_new;	
002454  e1c601ba          STRH     r0,[r6,#0x1a]  ; cntrl_stat
                  |L1.9304|
;;;2883   	}
;;;2884   
;;;2885   	
;;;2886   gran(&cntrl_stat,10,1010); 
002458  e59f003c          LDR      r0,|L1.9372|
00245c  e1a0200a          MOV      r2,r10
002460  e3a0100a          MOV      r1,#0xa
002464  ebfffffe          BL       gran
;;;2887   b1Hz_ch=0;
002468  e5c68009          STRB     r8,[r6,#9]  ; b1Hz_ch
;;;2888   }
00246c  e8bd47f0          POP      {r4-r10,lr}
002470  e12fff1e          BX       lr
                  |L1.9332|
002474  e1a03fc1          ASR      r3,r1,#31             ;2871
002478  e0811f23          ADD      r1,r1,r3,LSR #30      ;2871
00247c  e0821141          ADD      r1,r2,r1,ASR #2       ;2871
002480  e1510000          CMP      r1,r0                 ;2871
002484  baffff91          BLT      |L1.8912|
002488  e2821001          ADD      r1,r2,#1              ;2875
00248c  e1500001          CMP      r0,r1                 ;2875
002490  daffffe9          BLE      |L1.9276|
002494  eaffff94          B        |L1.8940|
;;;2889   /* 
                          ENDP

                  |L1.9368|
                          DCD      ||.data||+0x2e
                  |L1.9372|
                          DCD      ||.data||+0x1a

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  ke_drv PROC
;;;315    //-----------------------------------------------
;;;316    char ke_start(char in)
000000  e12fff1e          BX       lr
;;;317    {          
;;;318    char out;
;;;319    out=0; /*
;;;320    if(in==0)
;;;321    	{
;;;322    	if(spc_stat==spc_OFF)
;;;323    		{ 
;;;324    		if(lc640_read(BAT1_STAT)==ON)
;;;325    			{
;;;326    			if(!a_.av.bAB1)
;;;327    				{
;;;328    				if(abs(Ibat[0])<=(2*K[Ibk]))
;;;329    					{
;;;330    					if(cnt_BAT1_izar>=600)
;;;331    						{
;;;332    						if((lc640_read(BAT2_STAT)==OFF)||((cnt_BAT2_izar>=600)&&(!a_.av.bAB2)))
;;;333    							{
;;;334    							if(!a_.av.bAN)
;;;335    								{       
;;;336    								spc_stat=spc_KE1p1;
;;;337    								out=100;
;;;338    								ah_cnt0=0;
;;;339    								ah_cnt1=0;
;;;340    								
;;;341    			{					
;;;342    			signed temp_temp;
;;;343    			char temp;
;;;344    			temp_temp=ubat_old[0,((ubat_old_cnt+6)&0x07)]; 
;;;345    		    
;;;346    			temp=_year;
;;;347    			gran_char(&temp,1,99);
;;;348    			*((char*)(&(ke_date[0][0])))=temp;
;;;349    			
;;;350    			temp=_month;
;;;351    			gran_char(&temp,1,12);
;;;352    			*(((char*)(&(ke_date[0][0])))+1)=temp;
;;;353    			
;;;354    			temp=_date;
;;;355    			gran_char(&temp,1,31);
;;;356    			*(((char*)(&(ke_date[0][0])))+2)=temp;			
;;;357    				
;;;358    			*(((char*)(&(ke_date[0][0])))+3)=*((char*)&temp_temp);
;;;359    
;;;360    			temp=_hour;
;;;361    			gran_char(&temp,0,23);
;;;362    			*((char*)(&(ke_date[0][1])))=temp;
;;;363                   
;;;364    			temp=_min;
;;;365    			gran_char(&temp,0,59);
;;;366    			*(((char*)(&(ke_date[0][1])))+1)=temp;
;;;367    	          
;;;368    			temp=_sec;
;;;369    			gran_char(&temp,0,59);
;;;370    			*(((char*)(&(ke_date[0][1])))+2)=temp;
;;;371    			
;;;372    			*(((char*)(&(ke_date[0][1])))+3)=*(((char*)&temp_temp)+1);
;;;373    						
;;;374    			}					
;;;375    								
;;;376    								
;;;377    								}
;;;378    							else out=12;
;;;379    							}
;;;380    						else if(a_.av.bAB2)out=8;
;;;381    						else if(abs(Ibat[1])>=(2*K[Ibk]))
;;;382    							{
;;;383    							if(Ibat[1]>0)out=9;
;;;384    							else if(Ibat[1]<0)out=10;
;;;385    							}
;;;386    						else if(cnt_BAT2_izar<600)out=11;
;;;387    								
;;;388    						}
;;;389    					else out=7;	
;;;390    					}
;;;391    				else 
;;;392    					{
;;;393    					if(Ibat[0]>0)out=5;
;;;394    					else if(Ibat[0]<0)out=6;
;;;395    					}	
;;;396    				}
;;;397    			else
;;;398    				{
;;;399    				out=4;
;;;400    				}	
;;;401    			}               
;;;402    		else
;;;403    			{
;;;404    			out=3;
;;;405    			}	
;;;406    		}   
;;;407    	else 
;;;408    		{
;;;409    		if(spc_stat==spc_VZ) out=1;
;;;410    		else if((spc_stat==spc_KE2p1)||(spc_stat==spc_KE2p2)) out=2;		
;;;411    		}	
;;;412    	} 
;;;413    else if(in==1)
;;;414    	{
;;;415    	if(spc_stat==spc_OFF)
;;;416    		{ 
;;;417    		if(lc640_read(BAT2_STAT)==ON)
;;;418    			{
;;;419    			if(!a_.av.bAB2)
;;;420    				{
;;;421    				if(abs(Ibat[1])<=(2*K[Ibk]))
;;;422    					{
;;;423    					if(cnt_BAT2_izar>=600)
;;;424    						{
;;;425    						if((lc640_read(BAT1_STAT)==OFF)||((cnt_BAT1_izar>=600)&&(!a_.av.bAB1)))
;;;426    							{
;;;427    							if(!a_.av.bAN)
;;;428    								{       
;;;429    								spc_stat=spc_KE2p1;
;;;430    								out=100;
;;;431    								ah_cnt0=0;
;;;432    								ah_cnt1=0;
;;;433    								
;;;434    								
;;;435    			{					
;;;436    			signed temp_temp;
;;;437    			char temp;
;;;438    			temp_temp=ubat_old[1,((ubat_old_cnt+6)&0x07)]; 
;;;439    		    
;;;440    			temp=_year;
;;;441    			gran_char(&temp,1,99);
;;;442    			*((char*)(&(ke_date[1][0])))=temp;
;;;443    			
;;;444    			temp=_month;
;;;445    			gran_char(&temp,1,12);
;;;446    			*(((char*)(&(ke_date[1][0])))+1)=temp;
;;;447    			
;;;448    			temp=_date;
;;;449    			gran_char(&temp,1,31);
;;;450    			*(((char*)(&(ke_date[1][0])))+2)=temp;			
;;;451    				
;;;452    			*(((char*)(&(ke_date[1][0])))+3)=*((char*)&temp_temp);
;;;453    
;;;454    			temp=_hour;
;;;455    			gran_char(&temp,0,23);
;;;456    			*((char*)(&(ke_date[1][1])))=temp;
;;;457                   
;;;458    			temp=_min;
;;;459    			gran_char(&temp,0,59);
;;;460    			*(((char*)(&(ke_date[1][1])))+1)=temp;
;;;461    	          
;;;462    			temp=_sec;
;;;463    			gran_char(&temp,0,59);
;;;464    			*(((char*)(&(ke_date[1][1])))+2)=temp;
;;;465    			
;;;466    			*(((char*)(&(ke_date[1][1])))+3)=*(((char*)&temp_temp)+1);
;;;467    						
;;;468    			}					
;;;469    								
;;;470    								}
;;;471    							else out=12;
;;;472    							}
;;;473    						else if(a_.av.bAB1)out=8;
;;;474    						else if(abs(Ibat[0])>=(2*K[Ibk]))
;;;475    							{
;;;476    							if(Ibat[0]>0)out=9;
;;;477    							else if(Ibat[0]<0)out=10;
;;;478    							}
;;;479    						else if(cnt_BAT1_izar<600)out=11;
;;;480    								
;;;481    						}
;;;482    					else out=7;	
;;;483    					}
;;;484    				else 
;;;485    					{
;;;486    					if(Ibat[1]>0)out=5;
;;;487    					else if(Ibat[1]<0)out=6;
;;;488    					}	
;;;489    				}
;;;490    			else
;;;491    				{
;;;492    				out=4;
;;;493    				}	
;;;494    			}               
;;;495    		else
;;;496    			{
;;;497    			out=3;
;;;498    			}	
;;;499    		}   
;;;500    	else 
;;;501    		{
;;;502    		if(spc_stat==spc_VZ) out=1;
;;;503    		else if((spc_stat==spc_KE1p1)||(spc_stat==spc_KE1p2)) out=2;		
;;;504    		}
;;;505    	}	
;;;506    //plazma=out;
;;;507    */
;;;508    return out;
;;;509    }
;;;510    
                          ENDP


                          AREA ||.bss||, DATA, NOINIT, ALIGN=1

                  adc_buff
                          %        512
                  adc_buff_
                          %        32
                  net_buff
                          %        64

                          AREA ||.data||, DATA, ALIGN=1

                  adc_stat
000000  01                DCB      0x01
                  vent_stat
000001  00                DCB      0x00
                  cnt_rel_sam
000002  00                DCB      0x00
                  sh_cnt0
000003  00                DCB      0x00
                  b1Hz_sh
000004  00                DCB      0x00
                  unh_cnt0
000005  00                DCB      0x00
                  unh_cnt1
000006  00                DCB      0x00
                  b1Hz_unh
000007  00                DCB      0x00
                  ch_cnt0
000008  00                DCB      0x00
                  b1Hz_ch
000009  00                DCB      0x00
                  adc_cnt
00000a  00                DCB      0x00
                  adc_ch
00000b  00                DCB      0x00
                  net_buff_cnt
00000c  00                DCB      0x00
                  rele_stat
00000d  00                DCB      0x00
                  bRELE_OUT
00000e  00                DCB      0x00
                  bAVG
00000f  00                DCB      0x00
                  avg_num
000010  00                DCB      0x00
                  kb_full_ver
000011  00                DCB      0x00
                  num_of_wrks_bps
000012  00                DCB      0x00
                  spc_stat
000013  00                DCB      0x00
                  bAVZ
000014  00                DCB      0x00
                  unet_drv_cnt
000015  00                DCB      0x00
                  net_av
000016  0000              DCB      0x00,0x00
                  bat_ver_cnt
000018  0096              DCW      0x0096
                  cntrl_stat
00001a  0258              DCW      0x0258
                  cntrl_stat_old
00001c  0258              DCW      0x0258
                  avg_main_cnt
00001e  0014              DCW      0x0014
                  num_necc_block_cnt
000020  0000              DCB      0x00,0x00
                  IZMAX_
000022  0000              DCB      0x00,0x00
                  zero_cnt
000024  0000              DCB      0x00,0x00
                  net_buff_
000026  0000              DCB      0x00,0x00
                  ADWR
000028  0000              DCB      0x00,0x00
                  period_cnt
00002a  0000              DCB      0x00,0x00
                  plazma_adc_cnt
00002c  0000              DCB      0x00,0x00
                  cntrl_stat_new
00002e  0000              DCB      0x00,0x00
                  Ibmax
000030  0000              DCB      0x00,0x00
                  samokalibr_cnt
000032  0000              DCB      0x00,0x00
                  i_avg_max
000034  0000              DCB      0x00,0x00
                  i_avg_min
000036  0000              DCB      0x00,0x00
                  i_avg_summ
000038  0000              DCB      0x00,0x00
                  i_avg
00003a  0000              DCB      0x00,0x00
                  avg
00003c  0000              DCB      0x00,0x00
                  main_kb_cnt
00003e  0000              DCB      0x00,0x00
                  kb_cnt_1lev
000040  0000              DCB      0x00,0x00
                  kb_cnt_2lev
000042  0000              DCB      0x00,0x00
                  kb_start
000044  0000              DCB      0x00,0x00
                  bps_on_mask
000046  0000              DCB      0x00,0x00
                  bps_off_mask
000048  0000              DCB      0x00,0x00
                  vz_cnt_s
00004a  0000              DCB      0x00,0x00
                  vz_cnt_h
00004c  0000              DCB      0x00,0x00
                  vz_cnt_h_
00004e  0000              DCB      0x00,0x00
                  net_U
000050  0000              DCB      0x00,0x00
                  net_Ustore
000052  0000              DCB      0x00,0x00
                  ibat
                          DCDU     0x00000000
                  ibat_
                          DCDU     0x00000000
                  adc_buff_out_
                          DCDU     0x00000000
000060  0000              DCB      0x00,0x00

                          AREA ||area_number.7||, DATA, ALIGN=0

                          EXPORTAS ||area_number.7||, ||.data||
                  adc_cnt1
000000  00                DCB      0x00

                          AREA ||area_number.8||, DATA, ALIGN=0

                          EXPORTAS ||area_number.8||, ||.data||
                  avg_cnt
000000  00                DCB      0x00

                          AREA ||area_number.9||, DATA, ALIGN=0

                          EXPORTAS ||area_number.9||, ||.data||
                  bps_all_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.10||, DATA, ALIGN=0

                          EXPORTAS ||area_number.10||, ||.data||
                  bps_mask_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.11||, DATA, ALIGN=0

                          EXPORTAS ||area_number.11||, ||.data||
                  bps_mask_on_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.12||, DATA, ALIGN=0

                          EXPORTAS ||area_number.12||, ||.data||
                  bps_hndl_2sec_cnt
000000  00                DCB      0x00

                          AREA ||area_number.13||, DATA, ALIGN=0

                          EXPORTAS ||area_number.13||, ||.data||
                  spc_bat
000000  00                DCB      0x00

                          AREA ||area_number.14||, DATA, ALIGN=0

                          EXPORTAS ||area_number.14||, ||.data||
                  spc_phase
000000  00                DCB      0x00

                          AREA ||area_number.15||, DATA, ALIGN=0

                          EXPORTAS ||area_number.15||, ||.data||
                  bFF
000000  00                DCB      0x00

                          AREA ||area_number.16||, DATA, ALIGN=0

                          EXPORTAS ||area_number.16||, ||.data||
                  bFF_
000000  00                DCB      0x00

                          AREA ||area_number.17||, DATA, ALIGN=1

                          EXPORTAS ||area_number.17||, ||.data||
                  net_F
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.18||, DATA, ALIGN=1

                          EXPORTAS ||area_number.18||, ||.data||
                  hz_out
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.19||, DATA, ALIGN=1

                          EXPORTAS ||area_number.19||, ||.data||
                  hz_out_cnt
000000  0000              DCB      0x00,0x00
