; generated by ARM C/C++ Compiler, 4.1 [Build 481]
; commandline ArmCC [--debug -c --asm --interleave -o.\EXE\avar_hndl.o --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\INC -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DAPSENERGIA --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;57     //-----------------------------------------------
;;;58     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;59     {
;;;60     //static unsigned avar_stat_old;
;;;61     char i;
;;;62     //unsigned avar_stat_new,avar_stat_offed;
;;;63     
;;;64     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48ff              LDR      r0,|L1.1024|
000004  4aff              LDR      r2,|L1.1028|
000006  7801              LDRB     r1,[r0,#0]  ; net_av
000008  6810              LDR      r0,[r2,#0]
00000a  b119              CBZ      r1,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6010              STR      r0,[r2,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;65     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6010              STR      r0,[r2,#0]  ; avar_stat
                  |L1.26|
;;;66     
;;;67     for(i=0;i<2;i++)
00001a  2000              MOVS     r0,#0
;;;68     	{
;;;69     	if(bat[i]._av&1)	SET_REG(avar_stat,1,1+i,1);
00001c  4cfa              LDR      r4,|L1.1032|
00001e  2301              MOVS     r3,#1
                  |L1.32|
000020  eb000140          ADD      r1,r0,r0,LSL #1
000024  eb011100          ADD      r1,r1,r0,LSL #4
000028  eb040181          ADD      r1,r4,r1,LSL #2
00002c  f891103d          LDRB     r1,[r1,#0x3d]
000030  07c9              LSLS     r1,r1,#31
000032  d007              BEQ      |L1.68|
000034  1c45              ADDS     r5,r0,#1
000036  fa03f105          LSL      r1,r3,r5
00003a  6815              LDR      r5,[r2,#0]  ; avar_stat
00003c  438d              BICS     r5,r5,r1
00003e  430d              ORRS     r5,r5,r1
000040  6015              STR      r5,[r2,#0]  ; avar_stat
000042  e005              B        |L1.80|
                  |L1.68|
;;;70     	else	   		SET_REG(avar_stat,0,1+i,1);
000044  1c45              ADDS     r5,r0,#1
000046  fa03f105          LSL      r1,r3,r5
00004a  6815              LDR      r5,[r2,#0]  ; avar_stat
00004c  438d              BICS     r5,r5,r1
00004e  6015              STR      r5,[r2,#0]  ; avar_stat
                  |L1.80|
000050  1c40              ADDS     r0,r0,#1              ;67
000052  b2c0              UXTB     r0,r0                 ;67
000054  2802              CMP      r0,#2                 ;67
000056  d3e3              BCC      |L1.32|
;;;71     	}
;;;72     
;;;73     for(i=0;i<12;i++)
000058  2000              MOVS     r0,#0
;;;74     	{
;;;75     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00005a  4cec              LDR      r4,|L1.1036|
                  |L1.92|
00005c  ebc001c0          RSB      r1,r0,r0,LSL #3
000060  eb011100          ADD      r1,r1,r0,LSL #4
000064  eb040181          ADD      r1,r4,r1,LSL #2
000068  7849              LDRB     r1,[r1,#1]
00006a  f0110fef          TST      r1,#0xef
00006e  d007              BEQ      |L1.128|
000070  1cc5              ADDS     r5,r0,#3
000072  fa03f105          LSL      r1,r3,r5
000076  6815              LDR      r5,[r2,#0]  ; avar_stat
000078  438d              BICS     r5,r5,r1
00007a  430d              ORRS     r5,r5,r1
00007c  6015              STR      r5,[r2,#0]  ; avar_stat
00007e  e005              B        |L1.140|
                  |L1.128|
;;;76     	else	   		SET_REG(avar_stat,0,3+i,1);
000080  1cc1              ADDS     r1,r0,#3
000082  fa03f501          LSL      r5,r3,r1
000086  6811              LDR      r1,[r2,#0]  ; avar_stat
000088  43a9              BICS     r1,r1,r5
00008a  6011              STR      r1,[r2,#0]  ; avar_stat
                  |L1.140|
00008c  1c40              ADDS     r0,r0,#1              ;73
00008e  b2c0              UXTB     r0,r0                 ;73
000090  280c              CMP      r0,#0xc               ;73
000092  d3e3              BCC      |L1.92|
;;;77     	}
;;;78     
;;;79     for(i=0;i<6;i++)
000094  2000              MOVS     r0,#0
;;;80     	{
;;;81     	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
000096  4cdb              LDR      r4,|L1.1028|
000098  3414              ADDS     r4,r4,#0x14
                  |L1.154|
00009a  5c21              LDRB     r1,[r4,r0]
00009c  b141              CBZ      r1,|L1.176|
00009e  f100050f          ADD      r5,r0,#0xf
0000a2  fa03f105          LSL      r1,r3,r5
0000a6  6815              LDR      r5,[r2,#0]  ; avar_stat
0000a8  438d              BICS     r5,r5,r1
0000aa  430d              ORRS     r5,r5,r1
0000ac  6015              STR      r5,[r2,#0]  ; avar_stat
0000ae  e006              B        |L1.190|
                  |L1.176|
;;;82     	else	   		SET_REG(avar_stat,0,15+i,1);
0000b0  f100010f          ADD      r1,r0,#0xf
0000b4  6815              LDR      r5,[r2,#0]  ; avar_stat
0000b6  fa03f101          LSL      r1,r3,r1
0000ba  438d              BICS     r5,r5,r1
0000bc  6015              STR      r5,[r2,#0]  ; avar_stat
                  |L1.190|
0000be  1c40              ADDS     r0,r0,#1              ;79
0000c0  b2c0              UXTB     r0,r0                 ;79
0000c2  2806              CMP      r0,#6                 ;79
0000c4  d3e9              BCC      |L1.154|
;;;83     	}
;;;84     
;;;85     /*for(i=0;i<4;i++)
;;;86     	{
;;;87     	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;88     	else	   		SET_REG(avar_stat,0,21+i,1);
;;;89     	}  */
;;;90     for(i=0;i<4;i++)
0000c6  2000              MOVS     r0,#0
;;;91     	{
;;;92     	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000c8  4dd1              LDR      r5,|L1.1040|
0000ca  461c              MOV      r4,r3                 ;69
                  |L1.204|
0000cc  5c29              LDRB     r1,[r5,r0]
0000ce  2901              CMP      r1,#1
0000d0  d012              BEQ      |L1.248|
;;;93     	else	   		SET_REG(avar_stat,0,24+i,1);
0000d2  f1000118          ADD      r1,r0,#0x18
0000d6  fa04f301          LSL      r3,r4,r1
0000da  6811              LDR      r1,[r2,#0]  ; avar_stat
0000dc  4399              BICS     r1,r1,r3
0000de  6011              STR      r1,[r2,#0]  ; avar_stat
                  |L1.224|
0000e0  1c40              ADDS     r0,r0,#1              ;90
0000e2  b2c0              UXTB     r0,r0                 ;90
0000e4  2804              CMP      r0,#4                 ;90
0000e6  d3f1              BCC      |L1.204|
;;;94     	}
;;;95     
;;;96     if(uout_av)			SET_REG(avar_stat,1,28,1);
0000e8  48ca              LDR      r0,|L1.1044|
0000ea  7800              LDRB     r0,[r0,#0]  ; uout_av
0000ec  b168              CBZ      r0,|L1.266|
0000ee  6810              LDR      r0,[r2,#0]  ; avar_stat
0000f0  f0405080          ORR      r0,r0,#0x10000000
0000f4  6010              STR      r0,[r2,#0]  ; avar_stat
0000f6  e00c              B        |L1.274|
                  |L1.248|
0000f8  f1000318          ADD      r3,r0,#0x18           ;92
0000fc  fa04f103          LSL      r1,r4,r3              ;92
000100  6813              LDR      r3,[r2,#0]            ;92  ; avar_stat
000102  438b              BICS     r3,r3,r1              ;92
000104  430b              ORRS     r3,r3,r1              ;92
000106  6013              STR      r3,[r2,#0]            ;92  ; avar_stat
000108  e7ea              B        |L1.224|
                  |L1.266|
;;;97     else	   			SET_REG(avar_stat,0,28,1);
00010a  6810              LDR      r0,[r2,#0]  ; avar_stat
00010c  f0205080          BIC      r0,r0,#0x10000000
000110  6010              STR      r0,[r2,#0]  ; avar_stat
                  |L1.274|
;;;98     
;;;99     
;;;100    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000112  6894              LDR      r4,[r2,#8]  ; avar_stat_old
000114  6810              LDR      r0,[r2,#0]  ; avar_stat
000116  ea200104          BIC      r1,r0,r4
00011a  60d1              STR      r1,[r2,#0xc]  ; avar_stat_new
;;;101    
;;;102    avar_ind_stat|=avar_stat_new;
00011c  6853              LDR      r3,[r2,#4]  ; avar_ind_stat
00011e  430b              ORRS     r3,r3,r1
000120  6053              STR      r3,[r2,#4]  ; avar_ind_stat
;;;103    
;;;104    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000122  49bd              LDR      r1,|L1.1048|
000124  880d              LDRH     r5,[r1,#0]  ; SK_ZVUK_EN
000126  b115              CBZ      r5,|L1.302|
000128  f0237380          BIC      r3,r3,#0x1000000
00012c  6053              STR      r3,[r2,#4]  ; avar_ind_stat
                  |L1.302|
;;;105    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
00012e  884b              LDRH     r3,[r1,#2]  ; SK_ZVUK_EN
000130  b11b              CBZ      r3,|L1.314|
000132  6853              LDR      r3,[r2,#4]  ; avar_ind_stat
000134  f0237300          BIC      r3,r3,#0x2000000
000138  6053              STR      r3,[r2,#4]  ; avar_ind_stat
                  |L1.314|
;;;106    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
00013a  888b              LDRH     r3,[r1,#4]  ; SK_ZVUK_EN
00013c  b11b              CBZ      r3,|L1.326|
00013e  6853              LDR      r3,[r2,#4]  ; avar_ind_stat
000140  f0236380          BIC      r3,r3,#0x4000000
000144  6053              STR      r3,[r2,#4]  ; avar_ind_stat
                  |L1.326|
;;;107    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
000146  88c9              LDRH     r1,[r1,#6]  ; SK_ZVUK_EN
000148  b119              CBZ      r1,|L1.338|
00014a  6851              LDR      r1,[r2,#4]  ; avar_ind_stat
00014c  f0216100          BIC      r1,r1,#0x8000000
000150  6051              STR      r1,[r2,#4]  ; avar_ind_stat
                  |L1.338|
;;;108    
;;;109    
;;;110    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
000152  4384              BICS     r4,r4,r0
000154  43e1              MVNS     r1,r4
000156  6111              STR      r1,[r2,#0x10]  ; avar_stat_offed
;;;111    
;;;112    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
000158  4bb0              LDR      r3,|L1.1052|
00015a  881b              LDRH     r3,[r3,#0]  ; AV_OFF_AVT
00015c  b913              CBNZ     r3,|L1.356|
00015e  4bb0              LDR      r3,|L1.1056|
000160  4319              ORRS     r1,r1,r3
000162  6111              STR      r1,[r2,#0x10]  ; avar_stat_offed
                  |L1.356|
;;;113    
;;;114    avar_ind_stat&=avar_stat_offed; 
000164  6913              LDR      r3,[r2,#0x10]  ; avar_stat_offed
000166  6851              LDR      r1,[r2,#4]  ; avar_ind_stat
000168  4019              ANDS     r1,r1,r3
00016a  6051              STR      r1,[r2,#4]  ; avar_ind_stat
;;;115    
;;;116    avar_stat_old=avar_stat;
00016c  6090              STR      r0,[r2,#8]  ; avar_stat_old
;;;117    }
00016e  bd30              POP      {r4,r5,pc}
;;;118    
                          ENDP

                  reload_hndl PROC
;;;119    //-----------------------------------------------
;;;120    void reload_hndl(void)
000170  b5f8              PUSH     {r3-r7,lr}
;;;121    {
;;;122    char data[4];
;;;123    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;124    
;;;125    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000172  f44f6560          MOV      r5,#0xe00
000176  4628              MOV      r0,r5
000178  f7fffffe          BL       lc640_read_int
;;;126    event_ptr++;	
00017c  1c44              ADDS     r4,r0,#1
;;;127    if(event_ptr>63)event_ptr=0;	
00017e  2c3f              CMP      r4,#0x3f
000180  d900              BLS      |L1.388|
000182  2400              MOVS     r4,#0
                  |L1.388|
;;;128    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000184  b221              SXTH     r1,r4
000186  4628              MOV      r0,r5
000188  f7fffffe          BL       lc640_write_int
;;;129    	
;;;130    event_cnt=lc640_read_int(CNT_EVENT_LOG);
00018c  f6406602          MOV      r6,#0xe02
000190  4630              MOV      r0,r6
000192  f7fffffe          BL       lc640_read_int
;;;131    if(event_cnt!=63)event_cnt=event_ptr;
000196  283f              CMP      r0,#0x3f
000198  d000              BEQ      |L1.412|
00019a  4620              MOV      r0,r4
                  |L1.412|
;;;132    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
00019c  b201              SXTH     r1,r0
00019e  4630              MOV      r0,r6
0001a0  f7fffffe          BL       lc640_write_int
;;;133    	
;;;134    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
0001a4  4628              MOV      r0,r5
0001a6  f7fffffe          BL       lc640_read_int
0001aa  f44f6180          MOV      r1,#0x400
0001ae  eb011440          ADD      r4,r1,r0,LSL #5
;;;135    	
;;;136    data[0]='U';
0001b2  2055              MOVS     r0,#0x55
0001b4  f88d0000          STRB     r0,[sp,#0]
;;;137    data[1]=0;
0001b8  2600              MOVS     r6,#0
0001ba  f88d6001          STRB     r6,[sp,#1]
;;;138    data[2]='R';
0001be  2052              MOVS     r0,#0x52
0001c0  f88d0002          STRB     r0,[sp,#2]
;;;139    data[3]=0;
0001c4  f88d6003          STRB     r6,[sp,#3]
;;;140    lc640_write_long_ptr(lc640_adr,data);
0001c8  4669              MOV      r1,sp
0001ca  4620              MOV      r0,r4
0001cc  f7fffffe          BL       lc640_write_long_ptr
;;;141    
;;;142    data[0]=0;
;;;143    data[1]=0;
;;;144    data[2]=0;
;;;145    data[3]=0;
0001d0  9600              STR      r6,[sp,#0]
;;;146    lc640_write_long_ptr(lc640_adr+4,data);
0001d2  4669              MOV      r1,sp
0001d4  1d20              ADDS     r0,r4,#4
0001d6  f7fffffe          BL       lc640_write_long_ptr
;;;147    
;;;148    data[0]=LPC_RTC->YEAR;
0001da  4d92              LDR      r5,|L1.1060|
0001dc  8ba8              LDRH     r0,[r5,#0x1c]
0001de  f88d0000          STRB     r0,[sp,#0]
;;;149    data[1]=LPC_RTC->MONTH;
0001e2  7e28              LDRB     r0,[r5,#0x18]
0001e4  f88d0001          STRB     r0,[sp,#1]
;;;150    data[2]=LPC_RTC->DOM;
0001e8  7b28              LDRB     r0,[r5,#0xc]
0001ea  f88d0002          STRB     r0,[sp,#2]
;;;151    data[3]=0;
0001ee  f88d6003          STRB     r6,[sp,#3]
;;;152    lc640_write_long_ptr(lc640_adr+8,data);
0001f2  4669              MOV      r1,sp
0001f4  f1040008          ADD      r0,r4,#8
0001f8  f7fffffe          BL       lc640_write_long_ptr
;;;153    
;;;154    data[0]=LPC_RTC->HOUR;
0001fc  7a28              LDRB     r0,[r5,#8]
0001fe  f88d0000          STRB     r0,[sp,#0]
;;;155    data[1]=LPC_RTC->MIN;
000202  7928              LDRB     r0,[r5,#4]
000204  f88d0001          STRB     r0,[sp,#1]
;;;156    data[2]=LPC_RTC->SEC;
000208  7828              LDRB     r0,[r5,#0]
00020a  f88d0002          STRB     r0,[sp,#2]
;;;157    data[3]=LPC_SC->RSID;
00020e  4886              LDR      r0,|L1.1064|
000210  f8d00180          LDR      r0,[r0,#0x180]
000214  f88d0003          STRB     r0,[sp,#3]
;;;158    
;;;159    lc640_write_long_ptr(lc640_adr+12,data);
000218  4669              MOV      r1,sp
00021a  f104000c          ADD      r0,r4,#0xc
00021e  f7fffffe          BL       lc640_write_long_ptr
;;;160    	
;;;161    data[0]='A';
000222  2541              MOVS     r5,#0x41
000224  f88d5000          STRB     r5,[sp,#0]
;;;162    data[1]='A';
000228  f88d5001          STRB     r5,[sp,#1]
;;;163    data[2]='A';
00022c  f88d5002          STRB     r5,[sp,#2]
;;;164    data[3]='A';
000230  f88d5003          STRB     r5,[sp,#3]
;;;165    lc640_write_long_ptr(lc640_adr+16,data);
000234  4669              MOV      r1,sp
000236  f1040010          ADD      r0,r4,#0x10
00023a  f7fffffe          BL       lc640_write_long_ptr
;;;166    	
;;;167    data[0]='A';
00023e  f88d5000          STRB     r5,[sp,#0]
;;;168    data[1]='A';
000242  f88d5001          STRB     r5,[sp,#1]
;;;169    data[2]='A';
000246  f88d5002          STRB     r5,[sp,#2]
;;;170    data[3]='A';
00024a  f88d5003          STRB     r5,[sp,#3]
;;;171    lc640_write_long_ptr(lc640_adr+20,data);
00024e  4669              MOV      r1,sp
000250  f1040014          ADD      r0,r4,#0x14
000254  f7fffffe          BL       lc640_write_long_ptr
;;;172    	
;;;173    data[0]='A';
000258  f88d5000          STRB     r5,[sp,#0]
;;;174    data[1]='A';
00025c  f88d5001          STRB     r5,[sp,#1]
;;;175    data[2]='A';
000260  f88d5002          STRB     r5,[sp,#2]
;;;176    data[3]='A';
000264  f88d5003          STRB     r5,[sp,#3]
;;;177    lc640_write_long_ptr(lc640_adr+24,data);
000268  4669              MOV      r1,sp
00026a  f1040018          ADD      r0,r4,#0x18
00026e  f7fffffe          BL       lc640_write_long_ptr
;;;178    	
;;;179    data[0]='A';
000272  f88d5000          STRB     r5,[sp,#0]
;;;180    data[1]='A';
000276  f88d5001          STRB     r5,[sp,#1]
;;;181    data[2]='A';
00027a  f88d5002          STRB     r5,[sp,#2]
;;;182    data[3]='A';
00027e  f88d5003          STRB     r5,[sp,#3]
;;;183    lc640_write_long_ptr(lc640_adr+28,data);				
000282  4669              MOV      r1,sp
000284  f104001c          ADD      r0,r4,#0x1c
000288  f7fffffe          BL       lc640_write_long_ptr
;;;184    	
;;;185    	
;;;186    }
00028c  bdf8              POP      {r3-r7,pc}
;;;187    
                          ENDP

                  avar_unet_hndl PROC
;;;188    //-----------------------------------------------
;;;189    void avar_unet_hndl(char in)
00028e  e92d43f8          PUSH     {r3-r9,lr}
;;;190    {
;;;191    
;;;192    char data[4];
;;;193    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;194    
;;;195    
;;;196    if(in==1)
;;;197    	{
;;;198    	net_av=1;
;;;199    
;;;200    	//beep_init(0x01L,'O');
;;;201    	//a.av.bAN=1;
;;;202    
;;;203    
;;;204    	//beep_init(0x33333333,'A');
;;;205    	 
;;;206    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;207    	event_ptr++;	
;;;208    	if(event_ptr>63)event_ptr=0;	
;;;209    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;210    	
;;;211         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;212    	if(event_cnt!=63)event_cnt=event_ptr;
;;;213    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;214    	
;;;215    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;216    	
;;;217    	data[0]='P';
;;;218    	data[1]=0;
;;;219    	data[2]='A';
;;;220    	data[3]=0;
;;;221    	lc640_write_long_ptr(lc640_adr,data);
;;;222    
;;;223    	data[0]=0;//*((char*)&Unet_store);
;;;224    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;225    	data[2]=0;
;;;226    	data[3]=0;
;;;227    	lc640_write_long_ptr(lc640_adr+4,data);
;;;228    
;;;229    	data[0]=LPC_RTC->YEAR;
000292  4f64              LDR      r7,|L1.1060|
000294  495a              LDR      r1,|L1.1024|
000296  3f20              SUBS     r7,r7,#0x20
000298  f44f6560          MOV      r5,#0xe00             ;206
00029c  f04f0800          MOV      r8,#0                 ;208
0002a0  f44f6980          MOV      r9,#0x400             ;215
0002a4  2801              CMP      r0,#1                 ;196
0002a6  d001              BEQ      |L1.684|
;;;230    	data[1]=LPC_RTC->MONTH;
;;;231    	data[2]=LPC_RTC->DOM;
;;;232    	data[3]=0;
;;;233    	lc640_write_long_ptr(lc640_adr+8,data);
;;;234    
;;;235    	data[0]=LPC_RTC->HOUR;
;;;236    	data[1]=LPC_RTC->MIN;
;;;237    	data[2]=LPC_RTC->SEC;
;;;238    	data[3]=0;
;;;239    	lc640_write_long_ptr(lc640_adr+12,data);
;;;240    	
;;;241    	data[0]='A';
;;;242    	data[1]='A';
;;;243    	data[2]='A';
;;;244    	data[3]='A';
;;;245    	lc640_write_long_ptr(lc640_adr+16,data);
;;;246    	
;;;247    	data[0]='A';
;;;248    	data[1]='A';
;;;249    	data[2]='A';
;;;250    	data[3]='A';
;;;251    	lc640_write_long_ptr(lc640_adr+20,data);
;;;252    	
;;;253    	data[0]='A';
;;;254    	data[1]='A';
;;;255    	data[2]='A';
;;;256    	data[3]='A';
;;;257    	lc640_write_long_ptr(lc640_adr+24,data);
;;;258    	
;;;259    	data[0]='A';
;;;260    	data[1]='A';
;;;261    	data[2]='A';
;;;262    	data[3]='A';
;;;263    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;264    	
;;;265    /*	memo_out0[0]=0x55;
;;;266         memo_out0[1]=0x00+2;
;;;267         memo_out0[2]=1;
;;;268         memo_out0[3]=0x0b;
;;;269         memo_out0[4]=0x55;
;;;270         memo_out0[5]=0x55; 
;;;271         	
;;;272         memo_out0[6]=crc_87(memo_out0,6);
;;;273    	memo_out0[7]=crc_95(memo_out0,6);
;;;274         usart_out_adr0(memo_out0,8); 
;;;275    	*/
;;;276    	snmp_trap_send("Main power alarm",2,1,0);
;;;277    	}
;;;278    
;;;279    else if(in==0)
0002a8  b3f0              CBZ      r0,|L1.808|
0002aa  e13f              B        |L1.1324|
                  |L1.684|
0002ac  2001              MOVS     r0,#1                 ;198
0002ae  7008              STRB     r0,[r1,#0]            ;198
0002b0  4628              MOV      r0,r5                 ;206
0002b2  f7fffffe          BL       lc640_read_int
0002b6  1c44              ADDS     r4,r0,#1              ;207
0002b8  2c3f              CMP      r4,#0x3f              ;208
0002ba  d900              BLS      |L1.702|
0002bc  2400              MOVS     r4,#0                 ;208
                  |L1.702|
0002be  b221              SXTH     r1,r4                 ;209
0002c0  4628              MOV      r0,r5                 ;209
0002c2  f7fffffe          BL       lc640_write_int
0002c6  f6406602          MOV      r6,#0xe02             ;211
0002ca  4630              MOV      r0,r6                 ;211
0002cc  f7fffffe          BL       lc640_read_int
0002d0  283f              CMP      r0,#0x3f              ;212
0002d2  d000              BEQ      |L1.726|
0002d4  4620              MOV      r0,r4                 ;212
                  |L1.726|
0002d6  b201              SXTH     r1,r0                 ;213
0002d8  4630              MOV      r0,r6                 ;213
0002da  f7fffffe          BL       lc640_write_int
0002de  4628              MOV      r0,r5                 ;215
0002e0  f7fffffe          BL       lc640_read_int
0002e4  eb091540          ADD      r5,r9,r0,LSL #5       ;215
0002e8  2050              MOVS     r0,#0x50              ;217
0002ea  f88d0000          STRB     r0,[sp,#0]            ;217
0002ee  f88d8001          STRB     r8,[sp,#1]            ;218
0002f2  2441              MOVS     r4,#0x41              ;219
0002f4  f88d4002          STRB     r4,[sp,#2]            ;219
0002f8  f88d8003          STRB     r8,[sp,#3]            ;220
0002fc  4669              MOV      r1,sp                 ;221
0002fe  4628              MOV      r0,r5                 ;221
000300  f7fffffe          BL       lc640_write_long_ptr
000304  f8cd8000          STR      r8,[sp,#0]            ;226
000308  4669              MOV      r1,sp                 ;227
00030a  1d28              ADDS     r0,r5,#4              ;227
00030c  f7fffffe          BL       lc640_write_long_ptr
000310  f1070720          ADD      r7,r7,#0x20           ;229
000314  8bb8              LDRH     r0,[r7,#0x1c]         ;229
000316  f88d0000          STRB     r0,[sp,#0]            ;229
00031a  7e38              LDRB     r0,[r7,#0x18]         ;230
00031c  f88d0001          STRB     r0,[sp,#1]            ;230
000320  7b38              LDRB     r0,[r7,#0xc]          ;231
000322  f88d0002          STRB     r0,[sp,#2]            ;231
000326  e000              B        |L1.810|
                  |L1.808|
000328  e051              B        |L1.974|
                  |L1.810|
00032a  f88d8003          STRB     r8,[sp,#3]            ;232
00032e  4669              MOV      r1,sp                 ;233
000330  f1050008          ADD      r0,r5,#8              ;233
000334  f7fffffe          BL       lc640_write_long_ptr
000338  7a38              LDRB     r0,[r7,#8]            ;235
00033a  f88d0000          STRB     r0,[sp,#0]            ;235
00033e  7938              LDRB     r0,[r7,#4]            ;236
000340  f88d0001          STRB     r0,[sp,#1]            ;236
000344  7838              LDRB     r0,[r7,#0]            ;237
000346  f88d0002          STRB     r0,[sp,#2]            ;237
00034a  f88d8003          STRB     r8,[sp,#3]            ;238
00034e  4669              MOV      r1,sp                 ;239
000350  f105000c          ADD      r0,r5,#0xc            ;239
000354  f7fffffe          BL       lc640_write_long_ptr
000358  f88d4000          STRB     r4,[sp,#0]            ;241
00035c  f88d4001          STRB     r4,[sp,#1]            ;242
000360  f88d4002          STRB     r4,[sp,#2]            ;243
000364  f88d4003          STRB     r4,[sp,#3]            ;244
000368  4669              MOV      r1,sp                 ;245
00036a  f1050010          ADD      r0,r5,#0x10           ;245
00036e  f7fffffe          BL       lc640_write_long_ptr
000372  f88d4000          STRB     r4,[sp,#0]            ;247
000376  f88d4001          STRB     r4,[sp,#1]            ;248
00037a  f88d4002          STRB     r4,[sp,#2]            ;249
00037e  f88d4003          STRB     r4,[sp,#3]            ;250
000382  4669              MOV      r1,sp                 ;251
000384  f1050014          ADD      r0,r5,#0x14           ;251
000388  f7fffffe          BL       lc640_write_long_ptr
00038c  f88d4000          STRB     r4,[sp,#0]            ;253
000390  f88d4001          STRB     r4,[sp,#1]            ;254
000394  f88d4002          STRB     r4,[sp,#2]            ;255
000398  f88d4003          STRB     r4,[sp,#3]            ;256
00039c  4669              MOV      r1,sp                 ;257
00039e  f1050018          ADD      r0,r5,#0x18           ;257
0003a2  f7fffffe          BL       lc640_write_long_ptr
0003a6  f88d4000          STRB     r4,[sp,#0]            ;259
0003aa  f88d4001          STRB     r4,[sp,#1]            ;260
0003ae  f88d4002          STRB     r4,[sp,#2]            ;261
0003b2  f88d4003          STRB     r4,[sp,#3]            ;262
0003b6  4669              MOV      r1,sp                 ;263
0003b8  f105001c          ADD      r0,r5,#0x1c           ;263
0003bc  f7fffffe          BL       lc640_write_long_ptr
0003c0  2300              MOVS     r3,#0                 ;276
0003c2  2201              MOVS     r2,#1                 ;276
0003c4  2102              MOVS     r1,#2                 ;276
0003c6  a019              ADR      r0,|L1.1068|
0003c8  f7fffffe          BL       snmp_trap_send
0003cc  e0ae              B        |L1.1324|
                  |L1.974|
;;;280    	{
;;;281    	net_av=0;
0003ce  f8818000          STRB     r8,[r1,#0]
;;;282    
;;;283      /*
;;;284    	SET_REG(C2GSR,3,24,8);
;;;285    	C2MOD=0;
;;;286    	bOUT_FREE2=1;*/
;;;287    
;;;288    
;;;289    	//C2MOD=0;
;;;290    
;;;291    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;292    
;;;293         //beep_init(0x02L,'O');
;;;294    	//a_.av.bAN=0;
;;;295    	SET_REG(avar_stat,0,0,1);
0003d2  480c              LDR      r0,|L1.1028|
0003d4  6801              LDR      r1,[r0,#0]  ; avar_stat
0003d6  f0210101          BIC      r1,r1,#1
0003da  6001              STR      r1,[r0,#0]  ; avar_stat
;;;296    
;;;297    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;298    	
;;;299    	if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
0003dc  490f              LDR      r1,|L1.1052|
0003de  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
0003e0  b119              CBZ      r1,|L1.1002|
0003e2  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
0003e4  f0210101          BIC      r1,r1,#1
0003e8  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.1002|
;;;300    
;;;301         event_ptr=lc640_read_int(PTR_EVENT_LOG);
0003ea  4628              MOV      r0,r5
0003ec  f7fffffe          BL       lc640_read_int
0003f0  4606              MOV      r6,r0
;;;302    	event_ptr_find=event_ptr;
0003f2  4634              MOV      r4,r6
                  |L1.1012|
;;;303    avar_unet_hndl_lbl1:
;;;304    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0003f4  eb091544          ADD      r5,r9,r4,LSL #5
;;;305    
;;;306         lc640_read_long_ptr(lc640_adr,data);
0003f8  4669              MOV      r1,sp
0003fa  4628              MOV      r0,r5
0003fc  e020              B        |L1.1088|
0003fe  0000              DCW      0x0000
                  |L1.1024|
                          DCD      net_av
                  |L1.1028|
                          DCD      ||.data||
                  |L1.1032|
                          DCD      bat
                  |L1.1036|
                          DCD      bps
                  |L1.1040|
                          DCD      sk_av_stat
                  |L1.1044|
                          DCD      uout_av
                  |L1.1048|
                          DCD      SK_ZVUK_EN
                  |L1.1052|
                          DCD      AV_OFF_AVT
                  |L1.1056|
                          DCD      0xeffffffe
                  |L1.1060|
                          DCD      0x40024020
                  |L1.1064|
                          DCD      0x400fc000
                  |L1.1068|
00042c  4d61696e          DCB      "Main power alarm",0
000430  20706f77
000434  65722061
000438  6c61726d
00043c  00      
00043d  00                DCB      0
00043e  00                DCB      0
00043f  00                DCB      0
                  |L1.1088|
000440  f7fffffe          BL       lc640_read_long_ptr
;;;307         
;;;308         if(!((data[0]=='P')&&(data[1]==0)&&(data[2]=='A')))
000444  f89d0000          LDRB     r0,[sp,#0]
000448  2850              CMP      r0,#0x50
00044a  d106              BNE      |L1.1114|
00044c  f89d0001          LDRB     r0,[sp,#1]
000450  b918              CBNZ     r0,|L1.1114|
000452  f89d0002          LDRB     r0,[sp,#2]
000456  2841              CMP      r0,#0x41
000458  d006              BEQ      |L1.1128|
                  |L1.1114|
;;;309         	{        
;;;310         	if(event_ptr_find)event_ptr_find--;
00045a  b10c              CBZ      r4,|L1.1120|
00045c  1e64              SUBS     r4,r4,#1
00045e  e000              B        |L1.1122|
                  |L1.1120|
;;;311         	else event_ptr_find=63;
000460  243f              MOVS     r4,#0x3f
                  |L1.1122|
;;;312         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000462  42b4              CMP      r4,r6
000464  d1c6              BNE      |L1.1012|
000466  e061              B        |L1.1324|
                  |L1.1128|
;;;313         	else goto avar_unet_hndl_lbl1;
;;;314         	}
;;;315         else 
;;;316         	{
;;;317         	lc640_read_long_ptr(lc640_adr+16,data);
000468  4669              MOV      r1,sp
00046a  f1050010          ADD      r0,r5,#0x10
00046e  f7fffffe          BL       lc640_read_long_ptr
;;;318         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000472  f89d0000          LDRB     r0,[sp,#0]
000476  2841              CMP      r0,#0x41
000478  d10b              BNE      |L1.1170|
00047a  f89d0001          LDRB     r0,[sp,#1]
00047e  2841              CMP      r0,#0x41
000480  d107              BNE      |L1.1170|
000482  f89d0002          LDRB     r0,[sp,#2]
000486  2841              CMP      r0,#0x41
000488  d103              BNE      |L1.1170|
00048a  f89d0003          LDRB     r0,[sp,#3]
00048e  2841              CMP      r0,#0x41
000490  d006              BEQ      |L1.1184|
                  |L1.1170|
;;;319         		{        
;;;320         		if(event_ptr_find)event_ptr_find--;
000492  b10c              CBZ      r4,|L1.1176|
000494  1e64              SUBS     r4,r4,#1
000496  e000              B        |L1.1178|
                  |L1.1176|
;;;321             		else event_ptr_find=63;
000498  243f              MOVS     r4,#0x3f
                  |L1.1178|
;;;322             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
00049a  42b4              CMP      r4,r6
00049c  d1aa              BNE      |L1.1012|
00049e  e045              B        |L1.1324|
                  |L1.1184|
;;;323         		else goto avar_unet_hndl_lbl1;
;;;324         		}
;;;325    
;;;326         	}	
;;;327    	
;;;328    	data[0]=LPC_RTC->YEAR;
0004a0  f1070720          ADD      r7,r7,#0x20
0004a4  8bb8              LDRH     r0,[r7,#0x1c]
0004a6  f88d0000          STRB     r0,[sp,#0]
;;;329    	data[1]=LPC_RTC->MONTH;
0004aa  7e38              LDRB     r0,[r7,#0x18]
0004ac  f88d0001          STRB     r0,[sp,#1]
;;;330    	data[2]=LPC_RTC->DOM;
0004b0  7b38              LDRB     r0,[r7,#0xc]
0004b2  f88d0002          STRB     r0,[sp,#2]
;;;331    	data[3]=0;
0004b6  f88d8003          STRB     r8,[sp,#3]
;;;332    	lc640_write_long_ptr(lc640_adr+16,data);
0004ba  4669              MOV      r1,sp
0004bc  f1050010          ADD      r0,r5,#0x10
0004c0  f7fffffe          BL       lc640_write_long_ptr
;;;333    
;;;334    	data[0]=LPC_RTC->HOUR;
0004c4  7a38              LDRB     r0,[r7,#8]
0004c6  f88d0000          STRB     r0,[sp,#0]
;;;335    	data[1]=LPC_RTC->MIN;
0004ca  7938              LDRB     r0,[r7,#4]
0004cc  f88d0001          STRB     r0,[sp,#1]
;;;336    	data[2]=LPC_RTC->SEC;
0004d0  7838              LDRB     r0,[r7,#0]
0004d2  f88d0002          STRB     r0,[sp,#2]
;;;337    	data[3]=0;
0004d6  f88d8003          STRB     r8,[sp,#3]
;;;338    	lc640_write_long_ptr(lc640_adr+20,data); 
0004da  4669              MOV      r1,sp
0004dc  f1050014          ADD      r0,r5,#0x14
0004e0  f7fffffe          BL       lc640_write_long_ptr
;;;339    	
;;;340    	data[0]=*((char*)(&net_Ustore));
0004e4  48ff              LDR      r0,|L1.2276|
0004e6  7801              LDRB     r1,[r0,#0]  ; net_Ustore
0004e8  f88d1000          STRB     r1,[sp,#0]
;;;341    	data[1]=*(((char*)(&net_Ustore))+1);
0004ec  7840              LDRB     r0,[r0,#1]  ; net_Ustore
0004ee  f88d0001          STRB     r0,[sp,#1]
;;;342    	data[2]='B';
0004f2  2442              MOVS     r4,#0x42
0004f4  f88d4002          STRB     r4,[sp,#2]
;;;343    	data[3]='B';
0004f8  f88d4003          STRB     r4,[sp,#3]
;;;344    	lc640_write_long_ptr(lc640_adr+24,data);
0004fc  4669              MOV      r1,sp
0004fe  f1050018          ADD      r0,r5,#0x18
000502  f7fffffe          BL       lc640_write_long_ptr
;;;345    	
;;;346    	data[0]='B';
000506  f88d4000          STRB     r4,[sp,#0]
;;;347    	data[1]='B';
00050a  f88d4001          STRB     r4,[sp,#1]
;;;348    	data[2]='B';
00050e  f88d4002          STRB     r4,[sp,#2]
;;;349    	data[3]='B';
000512  f88d4003          STRB     r4,[sp,#3]
;;;350    	lc640_write_long_ptr(lc640_adr+28,data);	
000516  4669              MOV      r1,sp
000518  f105001c          ADD      r0,r5,#0x1c
00051c  f7fffffe          BL       lc640_write_long_ptr
;;;351    	
;;;352    /*	memo_out0[0]=0x55;
;;;353         memo_out0[1]=0x00+2;
;;;354         memo_out0[2]=1;
;;;355         memo_out0[3]=0x0b;
;;;356         memo_out0[4]=0xaa;
;;;357         memo_out0[5]=0xaa; 
;;;358         	
;;;359         memo_out0[6]=crc_87(memo_out0,6);
;;;360    	memo_out0[7]=crc_95(memo_out0,6);
;;;361         usart_out_adr0(memo_out0,8); */
;;;362         snmp_trap_send("Main power alarm  clear",2,1,1);	
000520  2301              MOVS     r3,#1
000522  461a              MOV      r2,r3
000524  2102              MOVS     r1,#2
000526  a0f0              ADR      r0,|L1.2280|
000528  f7fffffe          BL       snmp_trap_send
                  |L1.1324|
;;;363    	}
;;;364    avar_unet_hndl_end:
;;;365    	__nop();		
00052c  bf00              NOP      
                  |L1.1326|
;;;366    }
00052e  e8bd83f8          POP      {r3-r9,pc}
;;;367    
                          ENDP

                  avar_uout_hndl PROC
;;;369    //-----------------------------------------------
;;;370    void avar_uout_hndl(char in)
000532  e92d43f8          PUSH     {r3-r9,lr}
;;;371    {
;;;372    
;;;373    char data[4];
;;;374    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;375    
;;;376    
;;;377    if(in==1)
;;;378    	{
;;;379    	//net_av=1;
;;;380    
;;;381    	//beep_init(0x01L,'O');
;;;382    	//a.av.bAN=1;
;;;383    
;;;384    
;;;385    	//beep_init(0x33333333,'A');
;;;386    
;;;387    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;388    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;389    		 
;;;390    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;391    	event_ptr++;	
;;;392    	if(event_ptr>63)event_ptr=0;	
;;;393    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;394    	
;;;395        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;396    	if(event_cnt!=63)event_cnt=event_ptr;
;;;397    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;398    	
;;;399    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;400    	
;;;401    	data[0]='Q';
;;;402    	data[1]=0;
;;;403    	data[2]='A';
;;;404    	data[3]=0;
;;;405    	lc640_write_long_ptr(lc640_adr,data);
;;;406    
;;;407    	data[0]=0;//*((char*)&Unet_store);
;;;408    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;409    	data[2]=0;
;;;410    	data[3]=0;
;;;411    	lc640_write_long_ptr(lc640_adr+4,data);
;;;412    
;;;413    	data[0]=LPC_RTC->YEAR;
000536  4ff2              LDR      r7,|L1.2304|
000538  49f2              LDR      r1,|L1.2308|
00053a  f44f6560          MOV      r5,#0xe00             ;390
00053e  f04f0800          MOV      r8,#0                 ;392
000542  f44f6980          MOV      r9,#0x400             ;399
000546  2801              CMP      r0,#1                 ;377
000548  d001              BEQ      |L1.1358|
;;;414    	data[1]=LPC_RTC->MONTH;
;;;415    	data[2]=LPC_RTC->DOM;
;;;416    	data[3]=0;
;;;417    	lc640_write_long_ptr(lc640_adr+8,data);
;;;418    
;;;419    	data[0]=LPC_RTC->HOUR;
;;;420    	data[1]=LPC_RTC->MIN;
;;;421    	data[2]=LPC_RTC->SEC;
;;;422    	data[3]=0;
;;;423    	lc640_write_long_ptr(lc640_adr+12,data);
;;;424    	
;;;425    	data[0]='A';
;;;426    	data[1]='A';
;;;427    	data[2]='A';
;;;428    	data[3]='A';
;;;429    	lc640_write_long_ptr(lc640_adr+16,data);
;;;430    	
;;;431    	data[0]='A';
;;;432    	data[1]='A';
;;;433    	data[2]='A';
;;;434    	data[3]='A';
;;;435    	lc640_write_long_ptr(lc640_adr+20,data);
;;;436    	
;;;437    	data[0]='A';
;;;438    	data[1]='A';
;;;439    	data[2]='A';
;;;440    	data[3]='A';
;;;441    	lc640_write_long_ptr(lc640_adr+24,data);
;;;442    	
;;;443    	data[0]='A';
;;;444    	data[1]='A';
;;;445    	data[2]='A';
;;;446    	data[3]='A';
;;;447    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;448    	
;;;449    /*	memo_out0[0]=0x55;
;;;450         memo_out0[1]=0x00+2;
;;;451         memo_out0[2]=1;
;;;452         memo_out0[3]=0x0b;
;;;453         memo_out0[4]=0x55;
;;;454         memo_out0[5]=0x55; 
;;;455         	
;;;456         memo_out0[6]=crc_87(memo_out0,6);
;;;457    	memo_out0[7]=crc_95(memo_out0,6);
;;;458         usart_out_adr0(memo_out0,8); 
;;;459    	*/
;;;460    	//snmp_trap_send("Main power is off",2,1,0);
;;;461    	}
;;;462    
;;;463    else if(in==0)
00054a  b3f0              CBZ      r0,|L1.1482|
00054c  e11a              B        |L1.1924|
                  |L1.1358|
00054e  48ee              LDR      r0,|L1.2312|
000550  4aee              LDR      r2,|L1.2316|
000552  f9b00000          LDRSH    r0,[r0,#0]            ;387  ; load_U
000556  f9b22000          LDRSH    r2,[r2,#0]            ;387  ; U_OUT_KONTR_MAX
00055a  4290              CMP      r0,r2                 ;387
00055c  dd01              BLE      |L1.1378|
00055e  2201              MOVS     r2,#1                 ;387
000560  700a              STRB     r2,[r1,#0]            ;387
                  |L1.1378|
000562  4aeb              LDR      r2,|L1.2320|
000564  f9b22000          LDRSH    r2,[r2,#0]            ;388  ; U_OUT_KONTR_MIN
000568  4290              CMP      r0,r2                 ;388
00056a  da01              BGE      |L1.1392|
00056c  2002              MOVS     r0,#2                 ;388
00056e  7008              STRB     r0,[r1,#0]            ;388
                  |L1.1392|
000570  4628              MOV      r0,r5                 ;390
000572  f7fffffe          BL       lc640_read_int
000576  1c44              ADDS     r4,r0,#1              ;391
000578  2c3f              CMP      r4,#0x3f              ;392
00057a  d900              BLS      |L1.1406|
00057c  2400              MOVS     r4,#0                 ;392
                  |L1.1406|
00057e  b221              SXTH     r1,r4                 ;393
000580  4628              MOV      r0,r5                 ;393
000582  f7fffffe          BL       lc640_write_int
000586  f6406602          MOV      r6,#0xe02             ;395
00058a  4630              MOV      r0,r6                 ;395
00058c  f7fffffe          BL       lc640_read_int
000590  283f              CMP      r0,#0x3f              ;396
000592  d000              BEQ      |L1.1430|
000594  4620              MOV      r0,r4                 ;396
                  |L1.1430|
000596  b201              SXTH     r1,r0                 ;397
000598  4630              MOV      r0,r6                 ;397
00059a  f7fffffe          BL       lc640_write_int
00059e  4628              MOV      r0,r5                 ;399
0005a0  f7fffffe          BL       lc640_read_int
0005a4  eb091540          ADD      r5,r9,r0,LSL #5       ;399
0005a8  2051              MOVS     r0,#0x51              ;401
0005aa  f88d0000          STRB     r0,[sp,#0]            ;401
0005ae  f88d8001          STRB     r8,[sp,#1]            ;402
0005b2  2441              MOVS     r4,#0x41              ;403
0005b4  f88d4002          STRB     r4,[sp,#2]            ;403
0005b8  f88d8003          STRB     r8,[sp,#3]            ;404
0005bc  4669              MOV      r1,sp                 ;405
0005be  4628              MOV      r0,r5                 ;405
0005c0  f7fffffe          BL       lc640_write_long_ptr
0005c4  f8cd8000          STR      r8,[sp,#0]            ;410
0005c8  e000              B        |L1.1484|
                  |L1.1482|
0005ca  e05a              B        |L1.1666|
                  |L1.1484|
0005cc  4669              MOV      r1,sp                 ;411
0005ce  1d28              ADDS     r0,r5,#4              ;411
0005d0  f7fffffe          BL       lc640_write_long_ptr
0005d4  f1070720          ADD      r7,r7,#0x20           ;413
0005d8  8bb8              LDRH     r0,[r7,#0x1c]         ;413
0005da  f88d0000          STRB     r0,[sp,#0]            ;413
0005de  7e38              LDRB     r0,[r7,#0x18]         ;414
0005e0  f88d0001          STRB     r0,[sp,#1]            ;414
0005e4  7b38              LDRB     r0,[r7,#0xc]          ;415
0005e6  f88d0002          STRB     r0,[sp,#2]            ;415
0005ea  f88d8003          STRB     r8,[sp,#3]            ;416
0005ee  4669              MOV      r1,sp                 ;417
0005f0  f1050008          ADD      r0,r5,#8              ;417
0005f4  f7fffffe          BL       lc640_write_long_ptr
0005f8  7a38              LDRB     r0,[r7,#8]            ;419
0005fa  f88d0000          STRB     r0,[sp,#0]            ;419
0005fe  7938              LDRB     r0,[r7,#4]            ;420
000600  f88d0001          STRB     r0,[sp,#1]            ;420
000604  7838              LDRB     r0,[r7,#0]            ;421
000606  f88d0002          STRB     r0,[sp,#2]            ;421
00060a  f88d8003          STRB     r8,[sp,#3]            ;422
00060e  4669              MOV      r1,sp                 ;423
000610  f105000c          ADD      r0,r5,#0xc            ;423
000614  f7fffffe          BL       lc640_write_long_ptr
000618  f88d4000          STRB     r4,[sp,#0]            ;425
00061c  f88d4001          STRB     r4,[sp,#1]            ;426
000620  f88d4002          STRB     r4,[sp,#2]            ;427
000624  f88d4003          STRB     r4,[sp,#3]            ;428
000628  4669              MOV      r1,sp                 ;429
00062a  f1050010          ADD      r0,r5,#0x10           ;429
00062e  f7fffffe          BL       lc640_write_long_ptr
000632  f88d4000          STRB     r4,[sp,#0]            ;431
000636  f88d4001          STRB     r4,[sp,#1]            ;432
00063a  f88d4002          STRB     r4,[sp,#2]            ;433
00063e  f88d4003          STRB     r4,[sp,#3]            ;434
000642  4669              MOV      r1,sp                 ;435
000644  f1050014          ADD      r0,r5,#0x14           ;435
000648  f7fffffe          BL       lc640_write_long_ptr
00064c  f88d4000          STRB     r4,[sp,#0]            ;437
000650  f88d4001          STRB     r4,[sp,#1]            ;438
000654  f88d4002          STRB     r4,[sp,#2]            ;439
000658  f88d4003          STRB     r4,[sp,#3]            ;440
00065c  4669              MOV      r1,sp                 ;441
00065e  f1050018          ADD      r0,r5,#0x18           ;441
000662  f7fffffe          BL       lc640_write_long_ptr
000666  f88d4000          STRB     r4,[sp,#0]            ;443
00066a  f88d4001          STRB     r4,[sp,#1]            ;444
00066e  f88d4002          STRB     r4,[sp,#2]            ;445
000672  f88d4003          STRB     r4,[sp,#3]            ;446
000676  4669              MOV      r1,sp                 ;447
000678  f105001c          ADD      r0,r5,#0x1c           ;447
00067c  f7fffffe          BL       lc640_write_long_ptr
000680  e080              B        |L1.1924|
                  |L1.1666|
;;;464    	{
;;;465    	uout_av=0;
000682  f8818000          STRB     r8,[r1,#0]
;;;466    
;;;467      /*
;;;468    	SET_REG(C2GSR,3,24,8);
;;;469    	C2MOD=0;
;;;470    	bOUT_FREE2=1;*/
;;;471    
;;;472    
;;;473    	//C2MOD=0;
;;;474    
;;;475    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;476    
;;;477         //beep_init(0x02L,'O');
;;;478    	//a_.av.bAN=0;
;;;479    //	SET_REG(avar_stat,0,0,1);
;;;480    
;;;481    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;482    	
;;;483    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;484    
;;;485        event_ptr=lc640_read_int(PTR_EVENT_LOG);
000686  4628              MOV      r0,r5
000688  f7fffffe          BL       lc640_read_int
00068c  4606              MOV      r6,r0
;;;486    	event_ptr_find=event_ptr;
00068e  4634              MOV      r4,r6
                  |L1.1680|
;;;487    avar_uout_hndl_lbl1:
;;;488    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000690  eb091544          ADD      r5,r9,r4,LSL #5
;;;489    
;;;490         lc640_read_long_ptr(lc640_adr,data);
000694  4669              MOV      r1,sp
000696  4628              MOV      r0,r5
000698  f7fffffe          BL       lc640_read_long_ptr
;;;491         
;;;492         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
00069c  f89d0000          LDRB     r0,[sp,#0]
0006a0  2851              CMP      r0,#0x51
0006a2  d106              BNE      |L1.1714|
0006a4  f89d0001          LDRB     r0,[sp,#1]
0006a8  b918              CBNZ     r0,|L1.1714|
0006aa  f89d0002          LDRB     r0,[sp,#2]
0006ae  2841              CMP      r0,#0x41
0006b0  d006              BEQ      |L1.1728|
                  |L1.1714|
;;;493         	{        
;;;494         	if(event_ptr_find)event_ptr_find--;
0006b2  b10c              CBZ      r4,|L1.1720|
0006b4  1e64              SUBS     r4,r4,#1
0006b6  e000              B        |L1.1722|
                  |L1.1720|
;;;495         	else event_ptr_find=63;
0006b8  243f              MOVS     r4,#0x3f
                  |L1.1722|
;;;496         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0006ba  42b4              CMP      r4,r6
0006bc  d1e8              BNE      |L1.1680|
0006be  e061              B        |L1.1924|
                  |L1.1728|
;;;497         	else goto avar_uout_hndl_lbl1;
;;;498         	}
;;;499         else 
;;;500         	{
;;;501         	lc640_read_long_ptr(lc640_adr+16,data);
0006c0  4669              MOV      r1,sp
0006c2  f1050010          ADD      r0,r5,#0x10
0006c6  f7fffffe          BL       lc640_read_long_ptr
;;;502         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0006ca  f89d0000          LDRB     r0,[sp,#0]
0006ce  2841              CMP      r0,#0x41
0006d0  d10b              BNE      |L1.1770|
0006d2  f89d0001          LDRB     r0,[sp,#1]
0006d6  2841              CMP      r0,#0x41
0006d8  d107              BNE      |L1.1770|
0006da  f89d0002          LDRB     r0,[sp,#2]
0006de  2841              CMP      r0,#0x41
0006e0  d103              BNE      |L1.1770|
0006e2  f89d0003          LDRB     r0,[sp,#3]
0006e6  2841              CMP      r0,#0x41
0006e8  d006              BEQ      |L1.1784|
                  |L1.1770|
;;;503         		{        
;;;504         		if(event_ptr_find)event_ptr_find--;
0006ea  b10c              CBZ      r4,|L1.1776|
0006ec  1e64              SUBS     r4,r4,#1
0006ee  e000              B        |L1.1778|
                  |L1.1776|
;;;505             		else event_ptr_find=63;
0006f0  243f              MOVS     r4,#0x3f
                  |L1.1778|
;;;506             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0006f2  42b4              CMP      r4,r6
0006f4  d1cc              BNE      |L1.1680|
0006f6  e045              B        |L1.1924|
                  |L1.1784|
;;;507         		else goto avar_uout_hndl_lbl1;
;;;508         		}
;;;509    
;;;510         	}	
;;;511    	
;;;512    	data[0]=LPC_RTC->YEAR;
0006f8  f1070720          ADD      r7,r7,#0x20
0006fc  8bb8              LDRH     r0,[r7,#0x1c]
0006fe  f88d0000          STRB     r0,[sp,#0]
;;;513    	data[1]=LPC_RTC->MONTH;
000702  7e38              LDRB     r0,[r7,#0x18]
000704  f88d0001          STRB     r0,[sp,#1]
;;;514    	data[2]=LPC_RTC->DOM;
000708  7b38              LDRB     r0,[r7,#0xc]
00070a  f88d0002          STRB     r0,[sp,#2]
;;;515    	data[3]=0;
00070e  f88d8003          STRB     r8,[sp,#3]
;;;516    	lc640_write_long_ptr(lc640_adr+16,data);
000712  4669              MOV      r1,sp
000714  f1050010          ADD      r0,r5,#0x10
000718  f7fffffe          BL       lc640_write_long_ptr
;;;517    
;;;518    	data[0]=LPC_RTC->HOUR;
00071c  7a38              LDRB     r0,[r7,#8]
00071e  f88d0000          STRB     r0,[sp,#0]
;;;519    	data[1]=LPC_RTC->MIN;
000722  7938              LDRB     r0,[r7,#4]
000724  f88d0001          STRB     r0,[sp,#1]
;;;520    	data[2]=LPC_RTC->SEC;
000728  7838              LDRB     r0,[r7,#0]
00072a  f88d0002          STRB     r0,[sp,#2]
;;;521    	data[3]=0;
00072e  f88d8003          STRB     r8,[sp,#3]
;;;522    	lc640_write_long_ptr(lc640_adr+20,data); 
000732  4669              MOV      r1,sp
000734  f1050014          ADD      r0,r5,#0x14
000738  f7fffffe          BL       lc640_write_long_ptr
;;;523    	
;;;524    	data[0]=*((char*)(&net_Ustore));
00073c  4869              LDR      r0,|L1.2276|
00073e  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000740  f88d1000          STRB     r1,[sp,#0]
;;;525    	data[1]=*(((char*)(&net_Ustore))+1);
000744  7840              LDRB     r0,[r0,#1]  ; net_Ustore
000746  f88d0001          STRB     r0,[sp,#1]
;;;526    	data[2]='B';
00074a  2442              MOVS     r4,#0x42
00074c  f88d4002          STRB     r4,[sp,#2]
;;;527    	data[3]='B';
000750  f88d4003          STRB     r4,[sp,#3]
;;;528    	lc640_write_long_ptr(lc640_adr+24,data);
000754  4669              MOV      r1,sp
000756  f1050018          ADD      r0,r5,#0x18
00075a  f7fffffe          BL       lc640_write_long_ptr
;;;529    	
;;;530    	data[0]='B';
00075e  f88d4000          STRB     r4,[sp,#0]
;;;531    	data[1]='B';
000762  f88d4001          STRB     r4,[sp,#1]
;;;532    	data[2]='B';
000766  f88d4002          STRB     r4,[sp,#2]
;;;533    	data[3]='B';
00076a  f88d4003          STRB     r4,[sp,#3]
;;;534    	lc640_write_long_ptr(lc640_adr+28,data);	
00076e  4669              MOV      r1,sp
000770  f105001c          ADD      r0,r5,#0x1c
000774  f7fffffe          BL       lc640_write_long_ptr
;;;535    	
;;;536    /*	memo_out0[0]=0x55;
;;;537         memo_out0[1]=0x00+2;
;;;538         memo_out0[2]=1;
;;;539         memo_out0[3]=0x0b;
;;;540         memo_out0[4]=0xaa;
;;;541         memo_out0[5]=0xaa; 
;;;542         	
;;;543         memo_out0[6]=crc_87(memo_out0,6);
;;;544    	memo_out0[7]=crc_95(memo_out0,6);
;;;545         usart_out_adr0(memo_out0,8); */
;;;546         snmp_trap_send("Main power is on",2,1,1);	
000778  2301              MOVS     r3,#1
00077a  461a              MOV      r2,r3
00077c  2102              MOVS     r1,#2
00077e  a065              ADR      r0,|L1.2324|
000780  f7fffffe          BL       snmp_trap_send
                  |L1.1924|
;;;547    	}
;;;548    avar_unet_hndl_end:
;;;549    	__nop();		
000784  bf00              NOP      
;;;550    }
000786  e6d2              B        |L1.1326|
;;;551    
                          ENDP

                  avar_bps_hndl PROC
;;;552    //-----------------------------------------------
;;;553    void avar_bps_hndl(char dev, char v, char in)
000788  e92d4ff8          PUSH     {r3-r11,lr}
;;;554    {
00078c  4606              MOV      r6,r0
00078e  460c              MOV      r4,r1
;;;555    char data[4];
;;;556    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;557    char avar_simbol;
;;;558    
;;;559    avar_simbol='T';
000790  2754              MOVS     r7,#0x54
;;;560    if(v==0)avar_simbol='T';
000792  b15c              CBZ      r4,|L1.1964|
;;;561    else if(v==1)avar_simbol='U';
000794  2c01              CMP      r4,#1
000796  d004              BEQ      |L1.1954|
;;;562    else if(v==2)avar_simbol='u';
000798  2c02              CMP      r4,#2
00079a  d004              BEQ      |L1.1958|
;;;563    else if(v==3)avar_simbol='L';
00079c  2c03              CMP      r4,#3
00079e  d004              BEQ      |L1.1962|
0007a0  e004              B        |L1.1964|
                  |L1.1954|
0007a2  2755              MOVS     r7,#0x55              ;561
0007a4  e002              B        |L1.1964|
                  |L1.1958|
0007a6  2775              MOVS     r7,#0x75              ;562
0007a8  e000              B        |L1.1964|
                  |L1.1962|
0007aa  274c              MOVS     r7,#0x4c
                  |L1.1964|
;;;564    
;;;565    if(in==1)
;;;566    	{
;;;567    	//av_src[bps]=1;
;;;568    
;;;569    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;570    //	SET_REG(avar_stat,1,3+dev,1);
;;;571    	
;;;572    	if(v==0)bps[dev]._av|=(1<<0);
0007ac  485e              LDR      r0,|L1.2344|
0007ae  ebc601c6          RSB      r1,r6,r6,LSL #3
;;;573    	else if(v==1) bps[dev]._av|=(1<<1);
;;;574    	else if(v==2) bps[dev]._av|=(1<<2);
;;;575    	else if(v==3) bps[dev]._av|=(1<<3);
;;;576    
;;;577    	bps[dev]._last_avar=v;
;;;578    
;;;579    	//beep_init(0x33333333,'A');
;;;580    
;;;581    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;582    	event_ptr++;	
;;;583    	if(event_ptr>63)event_ptr=0;	
;;;584    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;585    	
;;;586         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;587    	if(event_cnt!=63)event_cnt=event_ptr;
;;;588    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;589    	
;;;590    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;591    	
;;;592    	data[0]='S';
;;;593    	data[1]=dev; 
;;;594    	data[2]=avar_simbol;
;;;595    	data[3]=0;
;;;596    	lc640_write_long_ptr(lc640_adr,data);
;;;597    
;;;598    	data[0]=0;
;;;599    	data[1]=0;
;;;600    	data[2]=0;
;;;601    	data[3]=0;
;;;602    	lc640_write_long_ptr(lc640_adr+4,data);
;;;603    
;;;604    	data[0]=LPC_RTC->YEAR;
0007b2  f8df814c          LDR      r8,|L1.2304|
0007b6  eb011106          ADD      r1,r1,r6,LSL #4       ;572
0007ba  f04f0900          MOV      r9,#0                 ;554
0007be  f44f6a60          MOV      r10,#0xe00            ;581
0007c2  f44f6580          MOV      r5,#0x400             ;590
0007c6  eb000081          ADD      r0,r0,r1,LSL #2       ;572
0007ca  2a01              CMP      r2,#1                 ;565
0007cc  d001              BEQ      |L1.2002|
;;;605    	data[1]=LPC_RTC->MONTH;
;;;606    	data[2]=LPC_RTC->DOM;
;;;607    	data[3]=0;
;;;608    	lc640_write_long_ptr(lc640_adr+8,data);
;;;609    
;;;610    	data[0]=LPC_RTC->HOUR;
;;;611    	data[1]=LPC_RTC->MIN;
;;;612    	data[2]=LPC_RTC->SEC;
;;;613    	data[3]=0;
;;;614    	lc640_write_long_ptr(lc640_adr+12,data);
;;;615    	
;;;616    	data[0]='A';
;;;617    	data[1]='A';
;;;618    	data[2]='A';
;;;619    	data[3]='A';
;;;620    	lc640_write_long_ptr(lc640_adr+16,data);
;;;621    	
;;;622    	data[0]='A';
;;;623    	data[1]='A';
;;;624    	data[2]='A';
;;;625    	data[3]='A';
;;;626    	lc640_write_long_ptr(lc640_adr+20,data);
;;;627    	
;;;628    	data[0]='A';
;;;629    	data[1]='A';
;;;630    	data[2]='A';
;;;631    	data[3]='A';
;;;632    	lc640_write_long_ptr(lc640_adr+24,data);
;;;633    	
;;;634    	data[0]='A';
;;;635    	data[1]='A';
;;;636    	data[2]='A';
;;;637    	data[3]='A';
;;;638    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;639    
;;;640    
;;;641    	if(dev==0)
;;;642    		{
;;;643    		if(v==0)
;;;644    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;645    		else if(v==1)
;;;646    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;647    		else if(v==2)
;;;648    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;649    		else if(v==3)
;;;650    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;651    		}
;;;652    	else if(dev==1)
;;;653    		{
;;;654    		if(v==0)
;;;655    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;656    		else if(v==1)
;;;657    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;658    		else if(v==2)
;;;659    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;660    		else if(v==3)
;;;661    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;662    		} 
;;;663    	else if(dev==2)
;;;664    		{
;;;665    		if(v==0)
;;;666    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;667    		else if(v==1)
;;;668    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;669    		else if(v==2)
;;;670    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;671    		else if(v==3)
;;;672    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;673    		} 	
;;;674    			
;;;675    	}
;;;676    
;;;677    else if(in==0)
0007ce  b3f2              CBZ      r2,|L1.2126|
0007d0  e1e2              B        |L1.2968|
                  |L1.2002|
0007d2  b134              CBZ      r4,|L1.2018|
0007d4  2c01              CMP      r4,#1                 ;573
0007d6  d009              BEQ      |L1.2028|
0007d8  2c02              CMP      r4,#2                 ;574
0007da  d00c              BEQ      |L1.2038|
0007dc  2c03              CMP      r4,#3                 ;575
0007de  d00f              BEQ      |L1.2048|
0007e0  e012              B        |L1.2056|
                  |L1.2018|
0007e2  7841              LDRB     r1,[r0,#1]            ;572
0007e4  f0410101          ORR      r1,r1,#1              ;572
0007e8  7041              STRB     r1,[r0,#1]            ;572
0007ea  e00d              B        |L1.2056|
                  |L1.2028|
0007ec  7841              LDRB     r1,[r0,#1]            ;573
0007ee  f0410102          ORR      r1,r1,#2              ;573
0007f2  7041              STRB     r1,[r0,#1]            ;573
0007f4  e008              B        |L1.2056|
                  |L1.2038|
0007f6  7841              LDRB     r1,[r0,#1]            ;574
0007f8  f0410104          ORR      r1,r1,#4              ;574
0007fc  7041              STRB     r1,[r0,#1]            ;574
0007fe  e003              B        |L1.2056|
                  |L1.2048|
000800  7841              LDRB     r1,[r0,#1]            ;575
000802  f0410108          ORR      r1,r1,#8              ;575
000806  7041              STRB     r1,[r0,#1]            ;575
                  |L1.2056|
000808  f8804053          STRB     r4,[r0,#0x53]         ;577
00080c  4650              MOV      r0,r10                ;581
00080e  f7fffffe          BL       lc640_read_int
000812  1c40              ADDS     r0,r0,#1              ;582
000814  fa1ffb80          UXTH     r11,r0                ;582
000818  f1bb0f3f          CMP      r11,#0x3f             ;583
00081c  d901              BLS      |L1.2082|
00081e  f04f0b00          MOV      r11,#0                ;583
                  |L1.2082|
000822  fa0ff18b          SXTH     r1,r11                ;584
000826  4650              MOV      r0,r10                ;584
000828  f7fffffe          BL       lc640_write_int
00082c  f6406002          MOV      r0,#0xe02             ;586
000830  f7fffffe          BL       lc640_read_int
000834  b280              UXTH     r0,r0                 ;586
000836  283f              CMP      r0,#0x3f              ;587
000838  d000              BEQ      |L1.2108|
00083a  4658              MOV      r0,r11                ;587
                  |L1.2108|
00083c  b201              SXTH     r1,r0                 ;588
00083e  f6406002          MOV      r0,#0xe02             ;588
000842  f7fffffe          BL       lc640_write_int
000846  4650              MOV      r0,r10                ;590
000848  f7fffffe          BL       lc640_read_int
00084c  e000              B        |L1.2128|
                  |L1.2126|
00084e  e108              B        |L1.2658|
                  |L1.2128|
000850  eb051040          ADD      r0,r5,r0,LSL #5       ;590
000854  b285              UXTH     r5,r0                 ;590
000856  2053              MOVS     r0,#0x53              ;592
000858  f88d0000          STRB     r0,[sp,#0]            ;592
00085c  f88d6001          STRB     r6,[sp,#1]            ;593
000860  f88d7002          STRB     r7,[sp,#2]            ;594
000864  f88d9003          STRB     r9,[sp,#3]            ;595
000868  4669              MOV      r1,sp                 ;596
00086a  4628              MOV      r0,r5                 ;596
00086c  f7fffffe          BL       lc640_write_long_ptr
000870  f8cd9000          STR      r9,[sp,#0]            ;601
000874  4669              MOV      r1,sp                 ;602
000876  1d28              ADDS     r0,r5,#4              ;602
000878  f7fffffe          BL       lc640_write_long_ptr
00087c  f8b8003c          LDRH     r0,[r8,#0x3c]         ;604
000880  f88d0000          STRB     r0,[sp,#0]            ;604
000884  f8980038          LDRB     r0,[r8,#0x38]         ;605
000888  f88d0001          STRB     r0,[sp,#1]            ;605
00088c  f898002c          LDRB     r0,[r8,#0x2c]         ;606
000890  f88d0002          STRB     r0,[sp,#2]            ;606
000894  f88d9003          STRB     r9,[sp,#3]            ;607
000898  4669              MOV      r1,sp                 ;608
00089a  f1050008          ADD      r0,r5,#8              ;608
00089e  f7fffffe          BL       lc640_write_long_ptr
0008a2  f8980028          LDRB     r0,[r8,#0x28]         ;610
0008a6  f88d0000          STRB     r0,[sp,#0]            ;610
0008aa  f8980024          LDRB     r0,[r8,#0x24]         ;611
0008ae  f88d0001          STRB     r0,[sp,#1]            ;611
0008b2  f8980020          LDRB     r0,[r8,#0x20]         ;612
0008b6  f88d0002          STRB     r0,[sp,#2]            ;612
0008ba  f88d9003          STRB     r9,[sp,#3]            ;613
0008be  4669              MOV      r1,sp                 ;614
0008c0  f105000c          ADD      r0,r5,#0xc            ;614
0008c4  f7fffffe          BL       lc640_write_long_ptr
0008c8  2741              MOVS     r7,#0x41              ;616
0008ca  f88d7000          STRB     r7,[sp,#0]            ;616
0008ce  f88d7001          STRB     r7,[sp,#1]            ;617
0008d2  f88d7002          STRB     r7,[sp,#2]            ;618
0008d6  f88d7003          STRB     r7,[sp,#3]            ;619
0008da  4669              MOV      r1,sp                 ;620
0008dc  f1050010          ADD      r0,r5,#0x10           ;620
0008e0  e024              B        |L1.2348|
0008e2  0000              DCW      0x0000
                  |L1.2276|
                          DCD      net_Ustore
                  |L1.2280|
0008e8  4d61696e          DCB      "Main power alarm  clear",0
0008ec  20706f77
0008f0  65722061
0008f4  6c61726d
0008f8  2020636c
0008fc  65617200
                  |L1.2304|
                          DCD      0x40024000
                  |L1.2308|
                          DCD      uout_av
                  |L1.2312|
                          DCD      load_U
                  |L1.2316|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2320|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2324|
000914  4d61696e          DCB      "Main power is on",0
000918  20706f77
00091c  65722069
000920  73206f6e
000924  00      
000925  00                DCB      0
000926  00                DCB      0
000927  00                DCB      0
                  |L1.2344|
                          DCD      bps
                  |L1.2348|
00092c  f7fffffe          BL       lc640_write_long_ptr
000930  f88d7000          STRB     r7,[sp,#0]            ;622
000934  f88d7001          STRB     r7,[sp,#1]            ;623
000938  f88d7002          STRB     r7,[sp,#2]            ;624
00093c  f88d7003          STRB     r7,[sp,#3]            ;625
000940  4669              MOV      r1,sp                 ;626
000942  f1050014          ADD      r0,r5,#0x14           ;626
000946  f7fffffe          BL       lc640_write_long_ptr
00094a  f88d7000          STRB     r7,[sp,#0]            ;628
00094e  f88d7001          STRB     r7,[sp,#1]            ;629
000952  f88d7002          STRB     r7,[sp,#2]            ;630
000956  f88d7003          STRB     r7,[sp,#3]            ;631
00095a  4669              MOV      r1,sp                 ;632
00095c  f1050018          ADD      r0,r5,#0x18           ;632
000960  f7fffffe          BL       lc640_write_long_ptr
000964  f88d7000          STRB     r7,[sp,#0]            ;634
000968  f88d7001          STRB     r7,[sp,#1]            ;635
00096c  f88d7002          STRB     r7,[sp,#2]            ;636
000970  f88d7003          STRB     r7,[sp,#3]            ;637
000974  4669              MOV      r1,sp                 ;638
000976  f105001c          ADD      r0,r5,#0x1c           ;638
00097a  f7fffffe          BL       lc640_write_long_ptr
00097e  b126              CBZ      r6,|L1.2442|
000980  2e01              CMP      r6,#1                 ;652
000982  d026              BEQ      |L1.2514|
000984  2e02              CMP      r6,#2                 ;663
000986  d048              BEQ      |L1.2586|
000988  e106              B        |L1.2968|
                  |L1.2442|
00098a  b134              CBZ      r4,|L1.2458|
00098c  2c01              CMP      r4,#1                 ;645
00098e  d00b              BEQ      |L1.2472|
000990  2c02              CMP      r4,#2                 ;647
000992  d010              BEQ      |L1.2486|
000994  2c03              CMP      r4,#3                 ;649
000996  d015              BEQ      |L1.2500|
000998  e0fe              B        |L1.2968|
                  |L1.2458|
00099a  2300              MOVS     r3,#0                 ;644
00099c  2201              MOVS     r2,#1                 ;644
00099e  2104              MOVS     r1,#4                 ;644
0009a0  a0de              ADR      r0,|L1.3356|
0009a2  f7fffffe          BL       snmp_trap_send
0009a6  e0f7              B        |L1.2968|
                  |L1.2472|
0009a8  2301              MOVS     r3,#1                 ;646
0009aa  461a              MOV      r2,r3                 ;646
0009ac  2104              MOVS     r1,#4                 ;646
0009ae  a0e1              ADR      r0,|L1.3380|
0009b0  f7fffffe          BL       snmp_trap_send
0009b4  e0f0              B        |L1.2968|
                  |L1.2486|
0009b6  2302              MOVS     r3,#2                 ;648
0009b8  2201              MOVS     r2,#1                 ;648
0009ba  2104              MOVS     r1,#4                 ;648
0009bc  a0e4              ADR      r0,|L1.3408|
0009be  f7fffffe          BL       snmp_trap_send
0009c2  e0e9              B        |L1.2968|
                  |L1.2500|
0009c4  2303              MOVS     r3,#3                 ;650
0009c6  2201              MOVS     r2,#1                 ;650
0009c8  2104              MOVS     r1,#4                 ;650
0009ca  a0e9              ADR      r0,|L1.3440|
0009cc  f7fffffe          BL       snmp_trap_send
0009d0  e0e2              B        |L1.2968|
                  |L1.2514|
0009d2  b134              CBZ      r4,|L1.2530|
0009d4  2c01              CMP      r4,#1                 ;656
0009d6  d00b              BEQ      |L1.2544|
0009d8  2c02              CMP      r4,#2                 ;658
0009da  d010              BEQ      |L1.2558|
0009dc  2c03              CMP      r4,#3                 ;660
0009de  d015              BEQ      |L1.2572|
0009e0  e0da              B        |L1.2968|
                  |L1.2530|
0009e2  2300              MOVS     r3,#0                 ;655
0009e4  2202              MOVS     r2,#2                 ;655
0009e6  2104              MOVS     r1,#4                 ;655
0009e8  a0e9              ADR      r0,|L1.3472|
0009ea  f7fffffe          BL       snmp_trap_send
0009ee  e0d3              B        |L1.2968|
                  |L1.2544|
0009f0  2301              MOVS     r3,#1                 ;657
0009f2  2202              MOVS     r2,#2                 ;657
0009f4  2104              MOVS     r1,#4                 ;657
0009f6  a0ec              ADR      r0,|L1.3496|
0009f8  f7fffffe          BL       snmp_trap_send
0009fc  e0cc              B        |L1.2968|
                  |L1.2558|
0009fe  2302              MOVS     r3,#2                 ;659
000a00  461a              MOV      r2,r3                 ;659
000a02  2104              MOVS     r1,#4                 ;659
000a04  a0ef              ADR      r0,|L1.3524|
000a06  f7fffffe          BL       snmp_trap_send
000a0a  e0c5              B        |L1.2968|
                  |L1.2572|
000a0c  2303              MOVS     r3,#3                 ;661
000a0e  2202              MOVS     r2,#2                 ;661
000a10  2104              MOVS     r1,#4                 ;661
000a12  a0f4              ADR      r0,|L1.3556|
000a14  f7fffffe          BL       snmp_trap_send
000a18  e0be              B        |L1.2968|
                  |L1.2586|
000a1a  b134              CBZ      r4,|L1.2602|
000a1c  2c01              CMP      r4,#1                 ;667
000a1e  d00b              BEQ      |L1.2616|
000a20  2c02              CMP      r4,#2                 ;669
000a22  d010              BEQ      |L1.2630|
000a24  2c03              CMP      r4,#3                 ;671
000a26  d015              BEQ      |L1.2644|
000a28  e0b6              B        |L1.2968|
                  |L1.2602|
000a2a  2300              MOVS     r3,#0                 ;666
000a2c  2203              MOVS     r2,#3                 ;666
000a2e  2104              MOVS     r1,#4                 ;666
000a30  a0f4              ADR      r0,|L1.3588|
000a32  f7fffffe          BL       snmp_trap_send
000a36  e0af              B        |L1.2968|
                  |L1.2616|
000a38  2301              MOVS     r3,#1                 ;668
000a3a  2203              MOVS     r2,#3                 ;668
000a3c  2104              MOVS     r1,#4                 ;668
000a3e  a0f7              ADR      r0,|L1.3612|
000a40  f7fffffe          BL       snmp_trap_send
000a44  e0a8              B        |L1.2968|
                  |L1.2630|
000a46  2302              MOVS     r3,#2                 ;670
000a48  2203              MOVS     r2,#3                 ;670
000a4a  2104              MOVS     r1,#4                 ;670
000a4c  a0fa              ADR      r0,|L1.3640|
000a4e  f7fffffe          BL       snmp_trap_send
000a52  e0a1              B        |L1.2968|
                  |L1.2644|
000a54  2303              MOVS     r3,#3                 ;672
000a56  461a              MOV      r2,r3                 ;672
000a58  2104              MOVS     r1,#4                 ;672
000a5a  a0ff              ADR      r0,|L1.3672|
000a5c  f7fffffe          BL       snmp_trap_send
000a60  e09a              B        |L1.2968|
                  |L1.2658|
;;;678    	{      
;;;679    //	av_bps[bps]=0;
;;;680    
;;;681    	//SET_REG(avar_stat,0,3+bps,1);
;;;682    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;683    
;;;684         if(v==0) bps[dev]._av&=(~(1<<0));
000a62  b134              CBZ      r4,|L1.2674|
;;;685         else if(v==1) bps[dev]._av&=(~(1<<1));
000a64  2c01              CMP      r4,#1
000a66  d009              BEQ      |L1.2684|
;;;686    	else if(v==2) bps[dev]._av&=(~(1<<2));
000a68  2c02              CMP      r4,#2
000a6a  d00c              BEQ      |L1.2694|
;;;687    	else if(v==3) bps[dev]._av&=(~(1<<3));
000a6c  2c03              CMP      r4,#3
000a6e  d00f              BEQ      |L1.2704|
000a70  e012              B        |L1.2712|
                  |L1.2674|
000a72  7841              LDRB     r1,[r0,#1]            ;684
000a74  f0210101          BIC      r1,r1,#1              ;684
000a78  7041              STRB     r1,[r0,#1]            ;684
000a7a  e00d              B        |L1.2712|
                  |L1.2684|
000a7c  7841              LDRB     r1,[r0,#1]            ;685
000a7e  f0210102          BIC      r1,r1,#2              ;685
000a82  7041              STRB     r1,[r0,#1]            ;685
000a84  e008              B        |L1.2712|
                  |L1.2694|
000a86  7841              LDRB     r1,[r0,#1]            ;686
000a88  f0210104          BIC      r1,r1,#4              ;686
000a8c  7041              STRB     r1,[r0,#1]            ;686
000a8e  e003              B        |L1.2712|
                  |L1.2704|
000a90  7841              LDRB     r1,[r0,#1]
000a92  f0210108          BIC      r1,r1,#8
000a96  7041              STRB     r1,[r0,#1]
                  |L1.2712|
;;;688         
;;;689    //	if((bps[dev]._av&0x0f==0))
;;;690    //	     {
;;;691    		//SET_REG(avar_stat,0,3+bps,1);
;;;692    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;693    //	     }
;;;694     
;;;695    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000a98  4650              MOV      r0,r10
000a9a  f7fffffe          BL       lc640_read_int
000a9e  fa1ffb80          UXTH     r11,r0
;;;696    	event_ptr_find=event_ptr;
000aa2  465c              MOV      r4,r11
                  |L1.2724|
;;;697    	
;;;698    avar_src_hndl_lbl1: 
;;;699    
;;;700    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000aa4  eb051044          ADD      r0,r5,r4,LSL #5
000aa8  fa1ffa80          UXTH     r10,r0
;;;701    
;;;702         lc640_read_long_ptr(lc640_adr,data);
000aac  4669              MOV      r1,sp
000aae  4650              MOV      r0,r10
000ab0  f7fffffe          BL       lc640_read_long_ptr
;;;703         
;;;704         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000ab4  f89d0000          LDRB     r0,[sp,#0]
000ab8  2853              CMP      r0,#0x53
000aba  d107              BNE      |L1.2764|
000abc  f89d0001          LDRB     r0,[sp,#1]
000ac0  42b0              CMP      r0,r6
000ac2  d103              BNE      |L1.2764|
000ac4  f89d0002          LDRB     r0,[sp,#2]
000ac8  42b8              CMP      r0,r7
000aca  d007              BEQ      |L1.2780|
                  |L1.2764|
;;;705         	{        
;;;706         	if(event_ptr_find)event_ptr_find--;
000acc  b114              CBZ      r4,|L1.2772|
000ace  1e64              SUBS     r4,r4,#1
000ad0  b2a4              UXTH     r4,r4
000ad2  e000              B        |L1.2774|
                  |L1.2772|
;;;707         	else event_ptr_find=63;
000ad4  243f              MOVS     r4,#0x3f
                  |L1.2774|
;;;708         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000ad6  455c              CMP      r4,r11
000ad8  d1e4              BNE      |L1.2724|
000ada  e05d              B        |L1.2968|
                  |L1.2780|
;;;709         	else goto avar_src_hndl_lbl1;
;;;710         	}
;;;711         else 
;;;712         	{
;;;713         	lc640_read_long_ptr(lc640_adr+16,data);
000adc  4669              MOV      r1,sp
000ade  f10a0010          ADD      r0,r10,#0x10
000ae2  f7fffffe          BL       lc640_read_long_ptr
;;;714         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000ae6  f89d0000          LDRB     r0,[sp,#0]
000aea  2841              CMP      r0,#0x41
000aec  d10b              BNE      |L1.2822|
000aee  f89d0001          LDRB     r0,[sp,#1]
000af2  2841              CMP      r0,#0x41
000af4  d107              BNE      |L1.2822|
000af6  f89d0002          LDRB     r0,[sp,#2]
000afa  2841              CMP      r0,#0x41
000afc  d103              BNE      |L1.2822|
000afe  f89d0003          LDRB     r0,[sp,#3]
000b02  2841              CMP      r0,#0x41
000b04  d007              BEQ      |L1.2838|
                  |L1.2822|
;;;715         		{        
;;;716         		if(event_ptr_find)event_ptr_find--;
000b06  b114              CBZ      r4,|L1.2830|
000b08  1e64              SUBS     r4,r4,#1
000b0a  b2a4              UXTH     r4,r4
000b0c  e000              B        |L1.2832|
                  |L1.2830|
;;;717             		else event_ptr_find=63;
000b0e  243f              MOVS     r4,#0x3f
                  |L1.2832|
;;;718             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000b10  455c              CMP      r4,r11
000b12  d1c7              BNE      |L1.2724|
000b14  e040              B        |L1.2968|
                  |L1.2838|
;;;719         		else goto avar_src_hndl_lbl1;
;;;720         		}
;;;721    
;;;722         	}	
;;;723    
;;;724    
;;;725    	
;;;726    	data[0]=LPC_RTC->YEAR;
000b16  f8b8003c          LDRH     r0,[r8,#0x3c]
000b1a  f88d0000          STRB     r0,[sp,#0]
;;;727    	data[1]=LPC_RTC->MONTH;
000b1e  f8980038          LDRB     r0,[r8,#0x38]
000b22  f88d0001          STRB     r0,[sp,#1]
;;;728    	data[2]=LPC_RTC->DOM;
000b26  f898002c          LDRB     r0,[r8,#0x2c]
000b2a  f88d0002          STRB     r0,[sp,#2]
;;;729    	data[3]=0;
000b2e  f88d9003          STRB     r9,[sp,#3]
;;;730    	lc640_write_long_ptr(lc640_adr+16,data);
000b32  4669              MOV      r1,sp
000b34  f10a0010          ADD      r0,r10,#0x10
000b38  f7fffffe          BL       lc640_write_long_ptr
;;;731    
;;;732    	data[0]=LPC_RTC->HOUR;
000b3c  f8980028          LDRB     r0,[r8,#0x28]
000b40  f88d0000          STRB     r0,[sp,#0]
;;;733    	data[1]=LPC_RTC->MIN;
000b44  f8980024          LDRB     r0,[r8,#0x24]
000b48  f88d0001          STRB     r0,[sp,#1]
;;;734    	data[2]=LPC_RTC->SEC;
000b4c  f8980020          LDRB     r0,[r8,#0x20]
000b50  f88d0002          STRB     r0,[sp,#2]
;;;735    	data[3]=0;
000b54  f88d9003          STRB     r9,[sp,#3]
;;;736    	lc640_write_long_ptr(lc640_adr+20,data);
000b58  4669              MOV      r1,sp
000b5a  f10a0014          ADD      r0,r10,#0x14
000b5e  f7fffffe          BL       lc640_write_long_ptr
;;;737    	
;;;738    	data[0]='B';
000b62  2442              MOVS     r4,#0x42
000b64  f88d4000          STRB     r4,[sp,#0]
;;;739    	data[1]='B';
000b68  f88d4001          STRB     r4,[sp,#1]
;;;740    	data[2]='B';
000b6c  f88d4002          STRB     r4,[sp,#2]
;;;741    	data[3]='B';
000b70  f88d4003          STRB     r4,[sp,#3]
;;;742    	lc640_write_long_ptr(lc640_adr+24,data);
000b74  4669              MOV      r1,sp
000b76  f10a0018          ADD      r0,r10,#0x18
000b7a  f7fffffe          BL       lc640_write_long_ptr
;;;743    	
;;;744    	data[0]='B';
000b7e  f88d4000          STRB     r4,[sp,#0]
;;;745    	data[1]='B';
000b82  f88d4001          STRB     r4,[sp,#1]
;;;746    	data[2]='B';
000b86  f88d4002          STRB     r4,[sp,#2]
;;;747    	data[3]='B';
000b8a  f88d4003          STRB     r4,[sp,#3]
;;;748    	lc640_write_long_ptr(lc640_adr+28,data);
000b8e  4669              MOV      r1,sp
000b90  f10a001c          ADD      r0,r10,#0x1c
000b94  f7fffffe          BL       lc640_write_long_ptr
                  |L1.2968|
;;;749    	
;;;750    	}
;;;751    	
;;;752    avar_src_hndl_end:
;;;753    __nop();		
000b98  bf00              NOP      
                  |L1.2970|
;;;754    }
000b9a  e8bd8ff8          POP      {r3-r11,pc}
;;;755    
                          ENDP

                  wrk_mem_hndl PROC
;;;756    //-----------------------------------------------
;;;757    void wrk_mem_hndl(char b)
000b9e  e92d41fc          PUSH     {r2-r8,lr}
;;;758    {
000ba2  4606              MOV      r6,r0
;;;759    char data[4];
;;;760    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;761    
;;;762    signed short temp_temp;
;;;763    
;;;764    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000ba4  eb060046          ADD      r0,r6,r6,LSL #1
000ba8  eb001106          ADD      r1,r0,r6,LSL #4
000bac  48b2              LDR      r0,|L1.3704|
000bae  eb000481          ADD      r4,r0,r1,LSL #2
000bb2  8be0              LDRH     r0,[r4,#0x1e]
000bb4  2805              CMP      r0,#5
000bb6  d379              BCC      |L1.3244|
;;;765    
;;;766    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000bb8  48b0              LDR      r0,|L1.3708|
000bba  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000bbc  1d80              ADDS     r0,r0,#6
000bbe  f0000007          AND      r0,r0,#7
000bc2  eb040040          ADD      r0,r4,r0,LSL #1
000bc6  8c00              LDRH     r0,[r0,#0x20]
000bc8  9000              STR      r0,[sp,#0]
;;;767    
;;;768    
;;;769    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000bca  f44f6760          MOV      r7,#0xe00
000bce  4638              MOV      r0,r7
000bd0  f7fffffe          BL       lc640_read_int
;;;770    event_ptr++;	
000bd4  1c40              ADDS     r0,r0,#1
000bd6  b285              UXTH     r5,r0
;;;771    if(event_ptr>63)event_ptr=0;	
000bd8  2d3f              CMP      r5,#0x3f
000bda  d900              BLS      |L1.3038|
000bdc  2500              MOVS     r5,#0
                  |L1.3038|
;;;772    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000bde  b229              SXTH     r1,r5
000be0  4638              MOV      r0,r7
000be2  f7fffffe          BL       lc640_write_int
;;;773    	
;;;774    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000be6  f6406802          MOV      r8,#0xe02
000bea  4640              MOV      r0,r8
000bec  f7fffffe          BL       lc640_read_int
000bf0  b280              UXTH     r0,r0
;;;775    if(event_cnt!=63)event_cnt=event_ptr;
000bf2  283f              CMP      r0,#0x3f
000bf4  d000              BEQ      |L1.3064|
000bf6  4628              MOV      r0,r5
                  |L1.3064|
;;;776    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000bf8  b201              SXTH     r1,r0
000bfa  4640              MOV      r0,r8
000bfc  f7fffffe          BL       lc640_write_int
;;;777    	
;;;778    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000c00  4638              MOV      r0,r7
000c02  f7fffffe          BL       lc640_read_int
000c06  f44f6180          MOV      r1,#0x400
000c0a  eb011040          ADD      r0,r1,r0,LSL #5
000c0e  b285              UXTH     r5,r0
;;;779    	
;;;780    data[0]='B';
000c10  2042              MOVS     r0,#0x42
000c12  f88d0004          STRB     r0,[sp,#4]
;;;781    data[1]=b; 
000c16  f88d6005          STRB     r6,[sp,#5]
;;;782    data[2]='W';
000c1a  2057              MOVS     r0,#0x57
000c1c  f88d0006          STRB     r0,[sp,#6]
;;;783    data[3]=0;
000c20  2600              MOVS     r6,#0
000c22  f88d6007          STRB     r6,[sp,#7]
;;;784    
;;;785    lc640_write_long_ptr(lc640_adr,data);
000c26  a901              ADD      r1,sp,#4
000c28  4628              MOV      r0,r5
000c2a  f7fffffe          BL       lc640_write_long_ptr
;;;786    
;;;787    data[0]=*((char*)&bat[b]._Iintegr_);
000c2e  7fa0              LDRB     r0,[r4,#0x1e]
000c30  f88d0004          STRB     r0,[sp,#4]
;;;788    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000c34  7fe0              LDRB     r0,[r4,#0x1f]
000c36  f88d0005          STRB     r0,[sp,#5]
;;;789    data[2]=*((char*)&temp_temp);
000c3a  f89d0000          LDRB     r0,[sp,#0]
000c3e  f88d0006          STRB     r0,[sp,#6]
;;;790    data[3]=*(((char*)(&temp_temp))+1);
000c42  f89d0001          LDRB     r0,[sp,#1]
000c46  f88d0007          STRB     r0,[sp,#7]
;;;791    lc640_write_long_ptr(lc640_adr+4,data);
000c4a  a901              ADD      r1,sp,#4
000c4c  1d28              ADDS     r0,r5,#4
000c4e  f7fffffe          BL       lc640_write_long_ptr
;;;792    
;;;793    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000c52  f1040134          ADD      r1,r4,#0x34
000c56  f1050008          ADD      r0,r5,#8
000c5a  f7fffffe          BL       lc640_write_long_ptr
;;;794    	
;;;795    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000c5e  f1040138          ADD      r1,r4,#0x38
000c62  f105000c          ADD      r0,r5,#0xc
000c66  f7fffffe          BL       lc640_write_long_ptr
;;;796    
;;;797    data[0]=LPC_RTC->YEAR;
000c6a  4c85              LDR      r4,|L1.3712|
000c6c  8ba0              LDRH     r0,[r4,#0x1c]
000c6e  f88d0004          STRB     r0,[sp,#4]
;;;798    data[1]=LPC_RTC->MONTH;
000c72  7e20              LDRB     r0,[r4,#0x18]
000c74  f88d0005          STRB     r0,[sp,#5]
;;;799    data[2]=LPC_RTC->DOM;
000c78  7b20              LDRB     r0,[r4,#0xc]
000c7a  f88d0006          STRB     r0,[sp,#6]
;;;800    data[3]=0;
000c7e  f88d6007          STRB     r6,[sp,#7]
;;;801    lc640_write_long_ptr(lc640_adr+16,data);
000c82  a901              ADD      r1,sp,#4
000c84  f1050010          ADD      r0,r5,#0x10
000c88  f7fffffe          BL       lc640_write_long_ptr
;;;802    
;;;803    data[0]=LPC_RTC->HOUR;
000c8c  7a20              LDRB     r0,[r4,#8]
000c8e  f88d0004          STRB     r0,[sp,#4]
;;;804    data[1]=LPC_RTC->MIN;
000c92  7920              LDRB     r0,[r4,#4]
000c94  f88d0005          STRB     r0,[sp,#5]
;;;805    data[2]=LPC_RTC->SEC;
000c98  7820              LDRB     r0,[r4,#0]
000c9a  f88d0006          STRB     r0,[sp,#6]
;;;806    data[3]=0;
000c9e  f88d6007          STRB     r6,[sp,#7]
;;;807    lc640_write_long_ptr(lc640_adr+20,data);
000ca2  a901              ADD      r1,sp,#4
000ca4  f1050014          ADD      r0,r5,#0x14
000ca8  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3244|
;;;808    	
;;;809    
;;;810    
;;;811    	
;;;812    wrk_mem_hndl_end:	
;;;813    __nop();
000cac  bf00              NOP      
;;;814    }  
000cae  e8bd81fc          POP      {r2-r8,pc}
;;;815    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;817    //-----------------------------------------------
;;;818    void avar_bat_ips_hndl(char in)
000cb2  e92d4ff8          PUSH     {r3-r11,lr}
;;;819    {
000cb6  4602              MOV      r2,r0
;;;820    char data[4];
;;;821    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;822    
;;;823    if(in==1)
;;;824    	{
;;;825    	bat_ips._av|=1;
000cb8  4872              LDR      r0,|L1.3716|
;;;826        ips_bat_av_stat=1;
;;;827    	ips_bat_av_vzvod=1;
;;;828    
;;;829    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;830    	event_ptr++;	
;;;831    	if(event_ptr>63)event_ptr=0;	
;;;832    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;833    	
;;;834         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;835    	if(event_cnt!=63)event_cnt=event_ptr;
;;;836    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;837    	
;;;838    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;839    	
;;;840    	data[0]='B';
;;;841    	data[1]=0;
;;;842    	data[2]='C';
;;;843    	data[3]=0;
;;;844    	lc640_write_long_ptr(lc640_adr,data);
;;;845    
;;;846    	data[0]=0;
;;;847    	data[1]=0;
;;;848    	data[2]=0;
;;;849    	data[3]=0;
;;;850    	lc640_write_long_ptr(lc640_adr+4,data);
;;;851    
;;;852    	data[0]=LPC_RTC->YEAR;
000cba  f8df81c4          LDR      r8,|L1.3712|
000cbe  4c72              LDR      r4,|L1.3720|
000cc0  4b72              LDR      r3,|L1.3724|
000cc2  2742              MOVS     r7,#0x42              ;840
000cc4  f890103d          LDRB     r1,[r0,#0x3d]         ;825
000cc8  f1a80820          SUB      r8,r8,#0x20
000ccc  f44f6560          MOV      r5,#0xe00             ;829
000cd0  f04f0900          MOV      r9,#0                 ;831
000cd4  f44f6a80          MOV      r10,#0x400            ;838
000cd8  2a01              CMP      r2,#1                 ;823
000cda  d001              BEQ      |L1.3296|
;;;853    	data[1]=LPC_RTC->MONTH;
;;;854    	data[2]=LPC_RTC->DOM;
;;;855    	data[3]=0;
;;;856    	lc640_write_long_ptr(lc640_adr+8,data);
;;;857    
;;;858    	data[0]=LPC_RTC->HOUR;
;;;859    	data[1]=LPC_RTC->MIN;
;;;860    	data[2]=LPC_RTC->SEC;
;;;861    	data[3]=0;
;;;862    	lc640_write_long_ptr(lc640_adr+12,data);
;;;863    	
;;;864    	data[0]='A';
;;;865    	data[1]='A';
;;;866    	data[2]='A';
;;;867    	data[3]='A';
;;;868    	lc640_write_long_ptr(lc640_adr+16,data);
;;;869    	
;;;870    	data[0]='A';
;;;871    	data[1]='A';
;;;872    	data[2]='A';
;;;873    	data[3]='A';
;;;874    	lc640_write_long_ptr(lc640_adr+20,data);
;;;875    	
;;;876    	data[0]='A';
;;;877    	data[1]='A';
;;;878    	data[2]='A';
;;;879    	data[3]='A';
;;;880    	lc640_write_long_ptr(lc640_adr+24,data);
;;;881    	
;;;882    	data[0]='A';
;;;883    	data[1]='A';
;;;884    	data[2]='A';
;;;885    	data[3]='A';
;;;886    	lc640_write_long_ptr(lc640_adr+28,data);
;;;887    					
;;;888    	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;889    		
;;;890    	}
;;;891    
;;;892    else if(in==0)
000cdc  b1e2              CBZ      r2,|L1.3352|
000cde  e1db              B        |L1.4248|
                  |L1.3296|
000ce0  f0410101          ORR      r1,r1,#1              ;825
000ce4  f880103d          STRB     r1,[r0,#0x3d]         ;825
000ce8  2001              MOVS     r0,#1                 ;826
000cea  7020              STRB     r0,[r4,#0]            ;826
000cec  7018              STRB     r0,[r3,#0]            ;827
000cee  4628              MOV      r0,r5                 ;829
000cf0  f7fffffe          BL       lc640_read_int
000cf4  1c40              ADDS     r0,r0,#1              ;830
000cf6  b284              UXTH     r4,r0                 ;830
000cf8  2c3f              CMP      r4,#0x3f              ;831
000cfa  d900              BLS      |L1.3326|
000cfc  2400              MOVS     r4,#0                 ;831
                  |L1.3326|
000cfe  b221              SXTH     r1,r4                 ;832
000d00  4628              MOV      r0,r5                 ;832
000d02  f7fffffe          BL       lc640_write_int
000d06  f6406602          MOV      r6,#0xe02             ;834
000d0a  4630              MOV      r0,r6                 ;834
000d0c  f7fffffe          BL       lc640_read_int
000d10  b281              UXTH     r1,r0                 ;834
000d12  293f              CMP      r1,#0x3f              ;835
000d14  d001              BEQ      |L1.3354|
000d16  e0bb              B        |L1.3728|
                  |L1.3352|
000d18  e13a              B        |L1.3984|
                  |L1.3354|
000d1a  e0ba              B        |L1.3730|
                  |L1.3356|
000d1c  42505320          DCB      "BPS #1 Alarm, overheat",0
000d20  23312041
000d24  6c61726d
000d28  2c206f76
000d2c  65726865
000d30  617400  
000d33  00                DCB      0
                  |L1.3380|
000d34  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000d38  23312041
000d3c  6c61726d
000d40  2c20766f
000d44  6c746167
000d48  65206973
000d4c  20757000
                  |L1.3408|
000d50  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000d54  23312041
000d58  6c61726d
000d5c  2c20766f
000d60  6c746167
000d64  65206973
000d68  20646f77
000d6c  6e00    
000d6e  00                DCB      0
000d6f  00                DCB      0
                  |L1.3440|
000d70  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000d74  23312041
000d78  6c61726d
000d7c  2c20636f
000d80  6e6e6563
000d84  74206973
000d88  206c6f73
000d8c  7400    
000d8e  00                DCB      0
000d8f  00                DCB      0
                  |L1.3472|
000d90  42505320          DCB      "BPS #2 Alarm, overheat",0
000d94  23322041
000d98  6c61726d
000d9c  2c206f76
000da0  65726865
000da4  617400  
000da7  00                DCB      0
                  |L1.3496|
000da8  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000dac  23322041
000db0  6c61726d
000db4  2c20766f
000db8  6c746167
000dbc  65206973
000dc0  20757000
                  |L1.3524|
000dc4  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000dc8  23322041
000dcc  6c61726d
000dd0  2c20766f
000dd4  6c746167
000dd8  65206973
000ddc  20646f77
000de0  6e00    
000de2  00                DCB      0
000de3  00                DCB      0
                  |L1.3556|
000de4  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000de8  23322041
000dec  6c61726d
000df0  2c20636f
000df4  6e6e6563
000df8  74206973
000dfc  206c6f73
000e00  7400    
000e02  00                DCB      0
000e03  00                DCB      0
                  |L1.3588|
000e04  42505320          DCB      "BPS #3 Alarm, overheat",0
000e08  23332041
000e0c  6c61726d
000e10  2c206f76
000e14  65726865
000e18  617400  
000e1b  00                DCB      0
                  |L1.3612|
000e1c  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000e20  23332041
000e24  6c61726d
000e28  2c20766f
000e2c  6c746167
000e30  65206973
000e34  20757000
                  |L1.3640|
000e38  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000e3c  23332041
000e40  6c61726d
000e44  2c20766f
000e48  6c746167
000e4c  65206973
000e50  20646f77
000e54  6e00    
000e56  00                DCB      0
000e57  00                DCB      0
                  |L1.3672|
000e58  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000e5c  23332041
000e60  6c61726d
000e64  2c20636f
000e68  6e6e6563
000e6c  74206973
000e70  206c6f73
000e74  7400    
000e76  00                DCB      0
000e77  00                DCB      0
                  |L1.3704|
                          DCD      bat
                  |L1.3708|
                          DCD      bat_u_old_cnt
                  |L1.3712|
                          DCD      0x40024020
                  |L1.3716|
                          DCD      bat_ips
                  |L1.3720|
                          DCD      ips_bat_av_stat
                  |L1.3724|
                          DCD      ips_bat_av_vzvod
                  |L1.3728|
000e90  4621              MOV      r1,r4                 ;835
                  |L1.3730|
000e92  b209              SXTH     r1,r1                 ;836
000e94  4630              MOV      r0,r6                 ;836
000e96  f7fffffe          BL       lc640_write_int
000e9a  4628              MOV      r0,r5                 ;838
000e9c  f7fffffe          BL       lc640_read_int
000ea0  eb0a1040          ADD      r0,r10,r0,LSL #5      ;838
000ea4  b284              UXTH     r4,r0                 ;838
000ea6  f88d7000          STRB     r7,[sp,#0]            ;840
000eaa  f88d9001          STRB     r9,[sp,#1]            ;841
000eae  2043              MOVS     r0,#0x43              ;842
000eb0  f88d0002          STRB     r0,[sp,#2]            ;842
000eb4  f88d9003          STRB     r9,[sp,#3]            ;843
000eb8  4669              MOV      r1,sp                 ;844
000eba  4620              MOV      r0,r4                 ;844
000ebc  f7fffffe          BL       lc640_write_long_ptr
000ec0  f8cd9000          STR      r9,[sp,#0]            ;849
000ec4  4669              MOV      r1,sp                 ;850
000ec6  1d20              ADDS     r0,r4,#4              ;850
000ec8  f7fffffe          BL       lc640_write_long_ptr
000ecc  f8b8003c          LDRH     r0,[r8,#0x3c]         ;852
000ed0  f88d0000          STRB     r0,[sp,#0]            ;852
000ed4  f8980038          LDRB     r0,[r8,#0x38]         ;853
000ed8  f88d0001          STRB     r0,[sp,#1]            ;853
000edc  f898002c          LDRB     r0,[r8,#0x2c]         ;854
000ee0  f88d0002          STRB     r0,[sp,#2]            ;854
000ee4  f88d9003          STRB     r9,[sp,#3]            ;855
000ee8  4669              MOV      r1,sp                 ;856
000eea  f1040008          ADD      r0,r4,#8              ;856
000eee  f7fffffe          BL       lc640_write_long_ptr
000ef2  f8980028          LDRB     r0,[r8,#0x28]         ;858
000ef6  f88d0000          STRB     r0,[sp,#0]            ;858
000efa  f8980024          LDRB     r0,[r8,#0x24]         ;859
000efe  f88d0001          STRB     r0,[sp,#1]            ;859
000f02  f8980020          LDRB     r0,[r8,#0x20]         ;860
000f06  f88d0002          STRB     r0,[sp,#2]            ;860
000f0a  f88d9003          STRB     r9,[sp,#3]            ;861
000f0e  4669              MOV      r1,sp                 ;862
000f10  f104000c          ADD      r0,r4,#0xc            ;862
000f14  f7fffffe          BL       lc640_write_long_ptr
000f18  2541              MOVS     r5,#0x41              ;864
000f1a  f88d5000          STRB     r5,[sp,#0]            ;864
000f1e  f88d5001          STRB     r5,[sp,#1]            ;865
000f22  f88d5002          STRB     r5,[sp,#2]            ;866
000f26  f88d5003          STRB     r5,[sp,#3]            ;867
000f2a  4669              MOV      r1,sp                 ;868
000f2c  f1040010          ADD      r0,r4,#0x10           ;868
000f30  f7fffffe          BL       lc640_write_long_ptr
000f34  f88d5000          STRB     r5,[sp,#0]            ;870
000f38  f88d5001          STRB     r5,[sp,#1]            ;871
000f3c  f88d5002          STRB     r5,[sp,#2]            ;872
000f40  f88d5003          STRB     r5,[sp,#3]            ;873
000f44  4669              MOV      r1,sp                 ;874
000f46  f1040014          ADD      r0,r4,#0x14           ;874
000f4a  f7fffffe          BL       lc640_write_long_ptr
000f4e  f88d5000          STRB     r5,[sp,#0]            ;876
000f52  f88d5001          STRB     r5,[sp,#1]            ;877
000f56  f88d5002          STRB     r5,[sp,#2]            ;878
000f5a  f88d5003          STRB     r5,[sp,#3]            ;879
000f5e  4669              MOV      r1,sp                 ;880
000f60  f1040018          ADD      r0,r4,#0x18           ;880
000f64  f7fffffe          BL       lc640_write_long_ptr
000f68  f88d5000          STRB     r5,[sp,#0]            ;882
000f6c  f88d5001          STRB     r5,[sp,#1]            ;883
000f70  f88d5002          STRB     r5,[sp,#2]            ;884
000f74  f88d5003          STRB     r5,[sp,#3]            ;885
000f78  4669              MOV      r1,sp                 ;886
000f7a  f104001c          ADD      r0,r4,#0x1c           ;886
000f7e  f7fffffe          BL       lc640_write_long_ptr
000f82  2301              MOVS     r3,#1                 ;888
000f84  461a              MOV      r2,r3                 ;888
000f86  2105              MOVS     r1,#5                 ;888
000f88  a0ff              ADR      r0,|L1.5000|
000f8a  f7fffffe          BL       snmp_trap_send
000f8e  e083              B        |L1.4248|
                  |L1.3984|
;;;893    	{
;;;894    	bat_ips._av&=~1;
000f90  f0210101          BIC      r1,r1,#1
000f94  f880103d          STRB     r1,[r0,#0x3d]
;;;895    	ips_bat_av_stat=0;
000f98  f8849000          STRB     r9,[r4,#0]
;;;896    	ips_bat_av_vzvod=0;
000f9c  f8839000          STRB     r9,[r3,#0]
;;;897         
;;;898    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000fa0  4628              MOV      r0,r5
000fa2  f7fffffe          BL       lc640_read_int
000fa6  b286              UXTH     r6,r0
;;;899    	event_ptr_find=event_ptr;
000fa8  4634              MOV      r4,r6
                  |L1.4010|
;;;900    	
;;;901    avar_bat_ips_hndl_lbl1: 
;;;902    
;;;903    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000faa  eb0a1044          ADD      r0,r10,r4,LSL #5
000fae  b285              UXTH     r5,r0
;;;904    
;;;905         lc640_read_long_ptr(lc640_adr,data);
000fb0  4669              MOV      r1,sp
000fb2  4628              MOV      r0,r5
000fb4  f7fffffe          BL       lc640_read_long_ptr
;;;906         
;;;907         if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
000fb8  f89d0000          LDRB     r0,[sp,#0]
000fbc  2842              CMP      r0,#0x42
000fbe  d106              BNE      |L1.4046|
000fc0  f89d0001          LDRB     r0,[sp,#1]
000fc4  b918              CBNZ     r0,|L1.4046|
000fc6  f89d0002          LDRB     r0,[sp,#2]
000fca  2843              CMP      r0,#0x43
000fcc  d007              BEQ      |L1.4062|
                  |L1.4046|
;;;908         	{        
;;;909         	if(event_ptr_find)event_ptr_find--;
000fce  b114              CBZ      r4,|L1.4054|
000fd0  1e64              SUBS     r4,r4,#1
000fd2  b2a4              UXTH     r4,r4
000fd4  e000              B        |L1.4056|
                  |L1.4054|
;;;910         	else event_ptr_find=63;
000fd6  243f              MOVS     r4,#0x3f
                  |L1.4056|
;;;911         	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
000fd8  42b4              CMP      r4,r6
000fda  d1e6              BNE      |L1.4010|
000fdc  e05c              B        |L1.4248|
                  |L1.4062|
;;;912         	else goto avar_bat_ips_hndl_lbl1;
;;;913         	}
;;;914         else 
;;;915         	{
;;;916         	lc640_read_long_ptr(lc640_adr+16,data);
000fde  4669              MOV      r1,sp
000fe0  f1050010          ADD      r0,r5,#0x10
000fe4  f7fffffe          BL       lc640_read_long_ptr
;;;917         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000fe8  f89d0000          LDRB     r0,[sp,#0]
000fec  2841              CMP      r0,#0x41
000fee  d10b              BNE      |L1.4104|
000ff0  f89d0001          LDRB     r0,[sp,#1]
000ff4  2841              CMP      r0,#0x41
000ff6  d107              BNE      |L1.4104|
000ff8  f89d0002          LDRB     r0,[sp,#2]
000ffc  2841              CMP      r0,#0x41
000ffe  d103              BNE      |L1.4104|
001000  f89d0003          LDRB     r0,[sp,#3]
001004  2841              CMP      r0,#0x41
001006  d007              BEQ      |L1.4120|
                  |L1.4104|
;;;918         		{        
;;;919         		if(event_ptr_find)event_ptr_find--;
001008  b114              CBZ      r4,|L1.4112|
00100a  1e64              SUBS     r4,r4,#1
00100c  b2a4              UXTH     r4,r4
00100e  e000              B        |L1.4114|
                  |L1.4112|
;;;920             		else event_ptr_find=63;
001010  243f              MOVS     r4,#0x3f
                  |L1.4114|
;;;921             	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001012  42b4              CMP      r4,r6
001014  d1c9              BNE      |L1.4010|
001016  e03f              B        |L1.4248|
                  |L1.4120|
;;;922         		else goto avar_bat_ips_hndl_lbl1;
;;;923         		}
;;;924    
;;;925         	}
;;;926         		
;;;927    	data[0]=LPC_RTC->YEAR;
001018  f8b8003c          LDRH     r0,[r8,#0x3c]
00101c  f88d0000          STRB     r0,[sp,#0]
;;;928    	data[1]=LPC_RTC->MONTH;
001020  f8980038          LDRB     r0,[r8,#0x38]
001024  f88d0001          STRB     r0,[sp,#1]
;;;929    	data[2]=LPC_RTC->DOM;
001028  f898002c          LDRB     r0,[r8,#0x2c]
00102c  f88d0002          STRB     r0,[sp,#2]
;;;930    	data[3]=0;
001030  f88d9003          STRB     r9,[sp,#3]
;;;931    	lc640_write_long_ptr(lc640_adr+16,data);
001034  4669              MOV      r1,sp
001036  f1050010          ADD      r0,r5,#0x10
00103a  f7fffffe          BL       lc640_write_long_ptr
;;;932    
;;;933    	data[0]=LPC_RTC->HOUR;
00103e  f8980028          LDRB     r0,[r8,#0x28]
001042  f88d0000          STRB     r0,[sp,#0]
;;;934    	data[1]=LPC_RTC->MIN;
001046  f8980024          LDRB     r0,[r8,#0x24]
00104a  f88d0001          STRB     r0,[sp,#1]
;;;935    	data[2]=LPC_RTC->SEC;
00104e  f8980020          LDRB     r0,[r8,#0x20]
001052  f88d0002          STRB     r0,[sp,#2]
;;;936    	data[3]=0;
001056  f88d9003          STRB     r9,[sp,#3]
;;;937    	lc640_write_long_ptr(lc640_adr+20,data);
00105a  4669              MOV      r1,sp
00105c  f1050014          ADD      r0,r5,#0x14
001060  f7fffffe          BL       lc640_write_long_ptr
;;;938    	
;;;939    	data[0]='B';
001064  f88d7000          STRB     r7,[sp,#0]
;;;940    	data[1]='B';
001068  f88d7001          STRB     r7,[sp,#1]
;;;941    	data[2]='B';
00106c  f88d7002          STRB     r7,[sp,#2]
;;;942    	data[3]='B';
001070  f88d7003          STRB     r7,[sp,#3]
;;;943    	lc640_write_long_ptr(lc640_adr+24,data);
001074  4669              MOV      r1,sp
001076  f1050018          ADD      r0,r5,#0x18
00107a  f7fffffe          BL       lc640_write_long_ptr
;;;944    	
;;;945    	data[0]='B';
00107e  f88d7000          STRB     r7,[sp,#0]
;;;946    	data[1]='B';
001082  f88d7001          STRB     r7,[sp,#1]
;;;947    	data[2]='B';
001086  f88d7002          STRB     r7,[sp,#2]
;;;948    	data[3]='B';
00108a  f88d7003          STRB     r7,[sp,#3]
;;;949    	lc640_write_long_ptr(lc640_adr+28,data);
00108e  4669              MOV      r1,sp
001090  f105001c          ADD      r0,r5,#0x1c
001094  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4248|
;;;950    	
;;;951    
;;;952    	
;;;953    	}
;;;954    	
;;;955    avar_bat_ips_hndl_end:
;;;956    __nop();		
001098  bf00              NOP      
                  |L1.4250|
;;;957    }
00109a  e57e              B        |L1.2970|
;;;958    
                          ENDP

                  avar_bat_hndl PROC
;;;961    //-----------------------------------------------
;;;962    void avar_bat_hndl(char b, char in)
00109c  e92d4ff8          PUSH     {r3-r11,lr}
;;;963    {
0010a0  4606              MOV      r6,r0
;;;964    char data[4];
;;;965    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;966    
;;;967    if(in==1)
;;;968    	{
;;;969    	bat[b]._av|=1;
0010a2  48be              LDR      r0,|L1.5020|
0010a4  eb060246          ADD      r2,r6,r6,LSL #1
;;;970        
;;;971    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;972    	event_ptr++;	
;;;973    	if(event_ptr>63)event_ptr=0;	
;;;974    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;975    	
;;;976         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;977    	if(event_cnt!=63)event_cnt=event_ptr;
;;;978    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;979    	
;;;980    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;981    	
;;;982    	data[0]='B';
;;;983    	data[1]=b;
;;;984    	data[2]='C';
;;;985    	data[3]=0;
;;;986    	lc640_write_long_ptr(lc640_adr,data);
;;;987    
;;;988    	data[0]=0;
;;;989    	data[1]=0;
;;;990    	data[2]=0;
;;;991    	data[3]=0;
;;;992    	lc640_write_long_ptr(lc640_adr+4,data);
;;;993    
;;;994    	data[0]=LPC_RTC->YEAR;
0010a8  f8df82f4          LDR      r8,|L1.5024|
0010ac  eb021206          ADD      r2,r2,r6,LSL #4       ;969
0010b0  f04f0a00          MOV      r10,#0                ;973
0010b4  f04f0942          MOV      r9,#0x42              ;982
0010b8  f44f6560          MOV      r5,#0xe00             ;971
0010bc  f44f6b80          MOV      r11,#0x400            ;980
0010c0  eb000082          ADD      r0,r0,r2,LSL #2       ;969
0010c4  2901              CMP      r1,#1                 ;967
0010c6  d001              BEQ      |L1.4300|
;;;995    	data[1]=LPC_RTC->MONTH;
;;;996    	data[2]=LPC_RTC->DOM;
;;;997    	data[3]=0;
;;;998    	lc640_write_long_ptr(lc640_adr+8,data);
;;;999    
;;;1000   	data[0]=LPC_RTC->HOUR;
;;;1001   	data[1]=LPC_RTC->MIN;
;;;1002   	data[2]=LPC_RTC->SEC;
;;;1003   	data[3]=0;
;;;1004   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1005   	
;;;1006   	data[0]='A';
;;;1007   	data[1]='A';
;;;1008   	data[2]='A';
;;;1009   	data[3]='A';
;;;1010   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1011   	
;;;1012   	data[0]='A';
;;;1013   	data[1]='A';
;;;1014   	data[2]='A';
;;;1015   	data[3]='A';
;;;1016   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1017   	
;;;1018   	data[0]='A';
;;;1019   	data[1]='A';
;;;1020   	data[2]='A';
;;;1021   	data[3]='A';
;;;1022   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1023   	
;;;1024   	data[0]='A';
;;;1025   	data[1]='A';
;;;1026   	data[2]='A';
;;;1027   	data[3]='A';
;;;1028   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1029   					
;;;1030   	if(b==0)
;;;1031   		{
;;;1032   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1033   		}
;;;1034   	else if(b==1)
;;;1035   		{
;;;1036   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1037   		} 
;;;1038   			
;;;1039   	}
;;;1040   
;;;1041   else if(in==0)
0010c8  b3f1              CBZ      r1,|L1.4424|
0010ca  e127              B        |L1.4892|
                  |L1.4300|
0010cc  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;969
0010d0  f0410101          ORR      r1,r1,#1              ;969
0010d4  7001              STRB     r1,[r0,#0]            ;969
0010d6  4628              MOV      r0,r5                 ;971
0010d8  f7fffffe          BL       lc640_read_int
0010dc  1c40              ADDS     r0,r0,#1              ;972
0010de  b284              UXTH     r4,r0                 ;972
0010e0  2c3f              CMP      r4,#0x3f              ;973
0010e2  d900              BLS      |L1.4326|
0010e4  2400              MOVS     r4,#0                 ;973
                  |L1.4326|
0010e6  b221              SXTH     r1,r4                 ;974
0010e8  4628              MOV      r0,r5                 ;974
0010ea  f7fffffe          BL       lc640_write_int
0010ee  f6406702          MOV      r7,#0xe02             ;976
0010f2  4638              MOV      r0,r7                 ;976
0010f4  f7fffffe          BL       lc640_read_int
0010f8  b280              UXTH     r0,r0                 ;976
0010fa  283f              CMP      r0,#0x3f              ;977
0010fc  d000              BEQ      |L1.4352|
0010fe  4620              MOV      r0,r4                 ;977
                  |L1.4352|
001100  b201              SXTH     r1,r0                 ;978
001102  4638              MOV      r0,r7                 ;978
001104  f7fffffe          BL       lc640_write_int
001108  4628              MOV      r0,r5                 ;980
00110a  f7fffffe          BL       lc640_read_int
00110e  eb0b1040          ADD      r0,r11,r0,LSL #5      ;980
001112  b284              UXTH     r4,r0                 ;980
001114  f88d9000          STRB     r9,[sp,#0]            ;982
001118  f88d6001          STRB     r6,[sp,#1]            ;983
00111c  2043              MOVS     r0,#0x43              ;984
00111e  f88d0002          STRB     r0,[sp,#2]            ;984
001122  f88da003          STRB     r10,[sp,#3]           ;985
001126  4669              MOV      r1,sp                 ;986
001128  4620              MOV      r0,r4                 ;986
00112a  f7fffffe          BL       lc640_write_long_ptr
00112e  f8cda000          STR      r10,[sp,#0]           ;991
001132  4669              MOV      r1,sp                 ;992
001134  1d20              ADDS     r0,r4,#4              ;992
001136  f7fffffe          BL       lc640_write_long_ptr
00113a  f8b8003c          LDRH     r0,[r8,#0x3c]         ;994
00113e  f88d0000          STRB     r0,[sp,#0]            ;994
001142  f8980038          LDRB     r0,[r8,#0x38]         ;995
001146  e000              B        |L1.4426|
                  |L1.4424|
001148  e066              B        |L1.4632|
                  |L1.4426|
00114a  f88d0001          STRB     r0,[sp,#1]            ;995
00114e  f898002c          LDRB     r0,[r8,#0x2c]         ;996
001152  f88d0002          STRB     r0,[sp,#2]            ;996
001156  f88da003          STRB     r10,[sp,#3]           ;997
00115a  4669              MOV      r1,sp                 ;998
00115c  f1040008          ADD      r0,r4,#8              ;998
001160  f7fffffe          BL       lc640_write_long_ptr
001164  f8980028          LDRB     r0,[r8,#0x28]         ;1000
001168  f88d0000          STRB     r0,[sp,#0]            ;1000
00116c  f8980024          LDRB     r0,[r8,#0x24]         ;1001
001170  f88d0001          STRB     r0,[sp,#1]            ;1001
001174  f8980020          LDRB     r0,[r8,#0x20]         ;1002
001178  f88d0002          STRB     r0,[sp,#2]            ;1002
00117c  f88da003          STRB     r10,[sp,#3]           ;1003
001180  4669              MOV      r1,sp                 ;1004
001182  f104000c          ADD      r0,r4,#0xc            ;1004
001186  f7fffffe          BL       lc640_write_long_ptr
00118a  2541              MOVS     r5,#0x41              ;1006
00118c  f88d5000          STRB     r5,[sp,#0]            ;1006
001190  f88d5001          STRB     r5,[sp,#1]            ;1007
001194  f88d5002          STRB     r5,[sp,#2]            ;1008
001198  f88d5003          STRB     r5,[sp,#3]            ;1009
00119c  4669              MOV      r1,sp                 ;1010
00119e  f1040010          ADD      r0,r4,#0x10           ;1010
0011a2  f7fffffe          BL       lc640_write_long_ptr
0011a6  f88d5000          STRB     r5,[sp,#0]            ;1012
0011aa  f88d5001          STRB     r5,[sp,#1]            ;1013
0011ae  f88d5002          STRB     r5,[sp,#2]            ;1014
0011b2  f88d5003          STRB     r5,[sp,#3]            ;1015
0011b6  4669              MOV      r1,sp                 ;1016
0011b8  f1040014          ADD      r0,r4,#0x14           ;1016
0011bc  f7fffffe          BL       lc640_write_long_ptr
0011c0  f88d5000          STRB     r5,[sp,#0]            ;1018
0011c4  f88d5001          STRB     r5,[sp,#1]            ;1019
0011c8  f88d5002          STRB     r5,[sp,#2]            ;1020
0011cc  f88d5003          STRB     r5,[sp,#3]            ;1021
0011d0  4669              MOV      r1,sp                 ;1022
0011d2  f1040018          ADD      r0,r4,#0x18           ;1022
0011d6  f7fffffe          BL       lc640_write_long_ptr
0011da  f88d5000          STRB     r5,[sp,#0]            ;1024
0011de  f88d5001          STRB     r5,[sp,#1]            ;1025
0011e2  f88d5002          STRB     r5,[sp,#2]            ;1026
0011e6  f88d5003          STRB     r5,[sp,#3]            ;1027
0011ea  4669              MOV      r1,sp                 ;1028
0011ec  f104001c          ADD      r0,r4,#0x1c           ;1028
0011f0  f7fffffe          BL       lc640_write_long_ptr
0011f4  b116              CBZ      r6,|L1.4604|
0011f6  2e01              CMP      r6,#1                 ;1034
0011f8  d007              BEQ      |L1.4618|
0011fa  e08f              B        |L1.4892|
                  |L1.4604|
0011fc  2301              MOVS     r3,#1                 ;1032
0011fe  461a              MOV      r2,r3                 ;1032
001200  2105              MOVS     r1,#5                 ;1032
001202  a068              ADR      r0,|L1.5028|
001204  f7fffffe          BL       snmp_trap_send
001208  e088              B        |L1.4892|
                  |L1.4618|
00120a  2301              MOVS     r3,#1                 ;1036
00120c  2202              MOVS     r2,#2                 ;1036
00120e  2105              MOVS     r1,#5                 ;1036
001210  a069              ADR      r0,|L1.5048|
001212  f7fffffe          BL       snmp_trap_send
001216  e081              B        |L1.4892|
                  |L1.4632|
;;;1042   	{
;;;1043   	bat[b]._av&=~1;
001218  f8101f3d          LDRB     r1,[r0,#0x3d]!
00121c  f0210101          BIC      r1,r1,#1
001220  7001              STRB     r1,[r0,#0]
;;;1044   
;;;1045        event_ptr=lc640_read_int(PTR_EVENT_LOG);
001222  4628              MOV      r0,r5
001224  f7fffffe          BL       lc640_read_int
001228  b287              UXTH     r7,r0
;;;1046   	event_ptr_find=event_ptr;
00122a  463c              MOV      r4,r7
                  |L1.4652|
;;;1047   	
;;;1048   avar_bat_hndl_lbl1: 
;;;1049   
;;;1050   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
00122c  eb0b1044          ADD      r0,r11,r4,LSL #5
001230  b285              UXTH     r5,r0
;;;1051   
;;;1052        lc640_read_long_ptr(lc640_adr,data);
001232  4669              MOV      r1,sp
001234  4628              MOV      r0,r5
001236  f7fffffe          BL       lc640_read_long_ptr
;;;1053        
;;;1054        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
00123a  f89d0000          LDRB     r0,[sp,#0]
00123e  2842              CMP      r0,#0x42
001240  d107              BNE      |L1.4690|
001242  f89d0001          LDRB     r0,[sp,#1]
001246  42b0              CMP      r0,r6
001248  d103              BNE      |L1.4690|
00124a  f89d0002          LDRB     r0,[sp,#2]
00124e  2843              CMP      r0,#0x43
001250  d007              BEQ      |L1.4706|
                  |L1.4690|
;;;1055        	{        
;;;1056        	if(event_ptr_find)event_ptr_find--;
001252  b114              CBZ      r4,|L1.4698|
001254  1e64              SUBS     r4,r4,#1
001256  b2a4              UXTH     r4,r4
001258  e000              B        |L1.4700|
                  |L1.4698|
;;;1057        	else event_ptr_find=63;
00125a  243f              MOVS     r4,#0x3f
                  |L1.4700|
;;;1058        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
00125c  42bc              CMP      r4,r7
00125e  d1e5              BNE      |L1.4652|
001260  e05c              B        |L1.4892|
                  |L1.4706|
;;;1059        	else goto avar_bat_hndl_lbl1;
;;;1060        	}
;;;1061        else 
;;;1062        	{
;;;1063        	lc640_read_long_ptr(lc640_adr+16,data);
001262  4669              MOV      r1,sp
001264  f1050010          ADD      r0,r5,#0x10
001268  f7fffffe          BL       lc640_read_long_ptr
;;;1064        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00126c  f89d0000          LDRB     r0,[sp,#0]
001270  2841              CMP      r0,#0x41
001272  d10b              BNE      |L1.4748|
001274  f89d0001          LDRB     r0,[sp,#1]
001278  2841              CMP      r0,#0x41
00127a  d107              BNE      |L1.4748|
00127c  f89d0002          LDRB     r0,[sp,#2]
001280  2841              CMP      r0,#0x41
001282  d103              BNE      |L1.4748|
001284  f89d0003          LDRB     r0,[sp,#3]
001288  2841              CMP      r0,#0x41
00128a  d007              BEQ      |L1.4764|
                  |L1.4748|
;;;1065        		{        
;;;1066        		if(event_ptr_find)event_ptr_find--;
00128c  b114              CBZ      r4,|L1.4756|
00128e  1e64              SUBS     r4,r4,#1
001290  b2a4              UXTH     r4,r4
001292  e000              B        |L1.4758|
                  |L1.4756|
;;;1067            		else event_ptr_find=63;
001294  243f              MOVS     r4,#0x3f
                  |L1.4758|
;;;1068            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
001296  42bc              CMP      r4,r7
001298  d1c8              BNE      |L1.4652|
00129a  e03f              B        |L1.4892|
                  |L1.4764|
;;;1069        		else goto avar_bat_hndl_lbl1;
;;;1070        		}
;;;1071   
;;;1072        	}
;;;1073        		
;;;1074   	data[0]=LPC_RTC->YEAR;
00129c  f8b8003c          LDRH     r0,[r8,#0x3c]
0012a0  f88d0000          STRB     r0,[sp,#0]
;;;1075   	data[1]=LPC_RTC->MONTH;
0012a4  f8980038          LDRB     r0,[r8,#0x38]
0012a8  f88d0001          STRB     r0,[sp,#1]
;;;1076   	data[2]=LPC_RTC->DOM;
0012ac  f898002c          LDRB     r0,[r8,#0x2c]
0012b0  f88d0002          STRB     r0,[sp,#2]
;;;1077   	data[3]=0;
0012b4  f88da003          STRB     r10,[sp,#3]
;;;1078   	lc640_write_long_ptr(lc640_adr+16,data);
0012b8  4669              MOV      r1,sp
0012ba  f1050010          ADD      r0,r5,#0x10
0012be  f7fffffe          BL       lc640_write_long_ptr
;;;1079   
;;;1080   	data[0]=LPC_RTC->HOUR;
0012c2  f8980028          LDRB     r0,[r8,#0x28]
0012c6  f88d0000          STRB     r0,[sp,#0]
;;;1081   	data[1]=LPC_RTC->MIN;
0012ca  f8980024          LDRB     r0,[r8,#0x24]
0012ce  f88d0001          STRB     r0,[sp,#1]
;;;1082   	data[2]=LPC_RTC->SEC;
0012d2  f8980020          LDRB     r0,[r8,#0x20]
0012d6  f88d0002          STRB     r0,[sp,#2]
;;;1083   	data[3]=0;
0012da  f88da003          STRB     r10,[sp,#3]
;;;1084   	lc640_write_long_ptr(lc640_adr+20,data);
0012de  4669              MOV      r1,sp
0012e0  f1050014          ADD      r0,r5,#0x14
0012e4  f7fffffe          BL       lc640_write_long_ptr
;;;1085   	
;;;1086   	data[0]='B';
0012e8  f88d9000          STRB     r9,[sp,#0]
;;;1087   	data[1]='B';
0012ec  f88d9001          STRB     r9,[sp,#1]
;;;1088   	data[2]='B';
0012f0  f88d9002          STRB     r9,[sp,#2]
;;;1089   	data[3]='B';
0012f4  f88d9003          STRB     r9,[sp,#3]
;;;1090   	lc640_write_long_ptr(lc640_adr+24,data);
0012f8  4669              MOV      r1,sp
0012fa  f1050018          ADD      r0,r5,#0x18
0012fe  f7fffffe          BL       lc640_write_long_ptr
;;;1091   	
;;;1092   	data[0]='B';
001302  f88d9000          STRB     r9,[sp,#0]
;;;1093   	data[1]='B';
001306  f88d9001          STRB     r9,[sp,#1]
;;;1094   	data[2]='B';
00130a  f88d9002          STRB     r9,[sp,#2]
;;;1095   	data[3]='B';
00130e  f88d9003          STRB     r9,[sp,#3]
;;;1096   	lc640_write_long_ptr(lc640_adr+28,data);
001312  4669              MOV      r1,sp
001314  f105001c          ADD      r0,r5,#0x1c
001318  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4892|
;;;1097   	
;;;1098   
;;;1099   	
;;;1100   	}
;;;1101   	
;;;1102   avar_bat_hndl_end:
;;;1103   __nop();		
00131c  bf00              NOP      
                  |L1.4894|
;;;1104   }
00131e  e43c              B        |L1.2970|
;;;1105   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1106   //-----------------------------------------------
;;;1107   void avar_bat_as_hndl(char b, char in)
001320  e92d4ff8          PUSH     {r3-r11,lr}
;;;1108   {
001324  4606              MOV      r6,r0
;;;1109   char data[4];
;;;1110   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1111   
;;;1112   if(in==1)
;;;1113   	{
;;;1114   	bat[b]._av|=2;
;;;1115       
;;;1116   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1117   	event_ptr++;	
;;;1118   	if(event_ptr>63)event_ptr=0;	
;;;1119   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1120   	
;;;1121        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1122   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1123   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1124   	
;;;1125   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1126   	
;;;1127   	data[0]='B';
;;;1128   	data[1]=b;
;;;1129   	data[2]='S';
;;;1130   	data[3]=0;
;;;1131   	lc640_write_long_ptr(lc640_adr,data);
;;;1132   
;;;1133   	data[0]=0;
;;;1134   	data[1]=0;
;;;1135   	data[2]=0;
;;;1136   	data[3]=0;
;;;1137   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1138   
;;;1139   	data[0]=LPC_RTC->YEAR;
001326  f8df8078          LDR      r8,|L1.5024|
00132a  f04f0a00          MOV      r10,#0                ;1118
00132e  f04f0942          MOV      r9,#0x42              ;1127
001332  f44f6560          MOV      r5,#0xe00             ;1116
001336  f44f6b80          MOV      r11,#0x400            ;1125
00133a  2901              CMP      r1,#1                 ;1112
00133c  d001              BEQ      |L1.4930|
;;;1140   	data[1]=LPC_RTC->MONTH;
;;;1141   	data[2]=LPC_RTC->DOM;
;;;1142   	data[3]=0;
;;;1143   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1144   
;;;1145   	data[0]=LPC_RTC->HOUR;
;;;1146   	data[1]=LPC_RTC->MIN;
;;;1147   	data[2]=LPC_RTC->SEC;
;;;1148   	data[3]=0;
;;;1149   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1150   	
;;;1151   	data[0]='A';
;;;1152   	data[1]='A';
;;;1153   	data[2]='A';
;;;1154   	data[3]='A';
;;;1155   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1156   	
;;;1157   	data[0]='A';
;;;1158   	data[1]='A';
;;;1159   	data[2]='A';
;;;1160   	data[3]='A';
;;;1161   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1162   	
;;;1163   	data[0]='A';
;;;1164   	data[1]='A';
;;;1165   	data[2]='A';
;;;1166   	data[3]='A';
;;;1167   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1168   	
;;;1169   	data[0]='A';
;;;1170   	data[1]='A';
;;;1171   	data[2]='A';
;;;1172   	data[3]='A';
;;;1173   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1174   
;;;1175   	if(b==0)
;;;1176   		{
;;;1177   		snmp_trap_send("BAT #1 Alarm, assimetry",5,1,2);
;;;1178   		}
;;;1179   	else if(b==1)
;;;1180   		{
;;;1181   		snmp_trap_send("BAT #2 Alarm, assimetry",5,2,2);
;;;1182   		} 
;;;1183   	
;;;1184   	}
;;;1185   
;;;1186   else if(in==0)
00133e  b311              CBZ      r1,|L1.4998|
001340  e14b              B        |L1.5594|
                  |L1.4930|
001342  eb060046          ADD      r0,r6,r6,LSL #1       ;1114
001346  eb001106          ADD      r1,r0,r6,LSL #4       ;1114
00134a  4814              LDR      r0,|L1.5020|
00134c  eb000081          ADD      r0,r0,r1,LSL #2       ;1114
001350  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1114
001354  f0410102          ORR      r1,r1,#2              ;1114
001358  7001              STRB     r1,[r0,#0]            ;1114
00135a  4628              MOV      r0,r5                 ;1116
00135c  f7fffffe          BL       lc640_read_int
001360  1c40              ADDS     r0,r0,#1              ;1117
001362  b284              UXTH     r4,r0                 ;1117
001364  2c3f              CMP      r4,#0x3f              ;1118
001366  d900              BLS      |L1.4970|
001368  2400              MOVS     r4,#0                 ;1118
                  |L1.4970|
00136a  b221              SXTH     r1,r4                 ;1119
00136c  4628              MOV      r0,r5                 ;1119
00136e  f7fffffe          BL       lc640_write_int
001372  f6406702          MOV      r7,#0xe02             ;1121
001376  4638              MOV      r0,r7                 ;1121
001378  f7fffffe          BL       lc640_read_int
00137c  b280              UXTH     r0,r0                 ;1121
00137e  283f              CMP      r0,#0x3f              ;1122
001380  d000              BEQ      |L1.4996|
001382  4620              MOV      r0,r4                 ;1122
                  |L1.4996|
001384  e022              B        |L1.5068|
                  |L1.4998|
001386  e0ab              B        |L1.5344|
                  |L1.5000|
001388  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
00138c  b9312041
001390  6c61726d
001394  2c206c6f
001398  737400  
00139b  00                DCB      0
                  |L1.5020|
                          DCD      bat
                  |L1.5024|
                          DCD      0x40024000
                  |L1.5028|
0013a4  42415420          DCB      "BAT #1 Alarm, lost",0
0013a8  23312041
0013ac  6c61726d
0013b0  2c206c6f
0013b4  737400  
0013b7  00                DCB      0
                  |L1.5048|
0013b8  42415420          DCB      "BAT #2 Alarm, lost",0
0013bc  23322041
0013c0  6c61726d
0013c4  2c206c6f
0013c8  737400  
0013cb  00                DCB      0
                  |L1.5068|
0013cc  b201              SXTH     r1,r0                 ;1123
0013ce  4638              MOV      r0,r7                 ;1123
0013d0  f7fffffe          BL       lc640_write_int
0013d4  4628              MOV      r0,r5                 ;1125
0013d6  f7fffffe          BL       lc640_read_int
0013da  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1125
0013de  b284              UXTH     r4,r0                 ;1125
0013e0  f88d9000          STRB     r9,[sp,#0]            ;1127
0013e4  f88d6001          STRB     r6,[sp,#1]            ;1128
0013e8  2053              MOVS     r0,#0x53              ;1129
0013ea  f88d0002          STRB     r0,[sp,#2]            ;1129
0013ee  f88da003          STRB     r10,[sp,#3]           ;1130
0013f2  4669              MOV      r1,sp                 ;1131
0013f4  4620              MOV      r0,r4                 ;1131
0013f6  f7fffffe          BL       lc640_write_long_ptr
0013fa  f8cda000          STR      r10,[sp,#0]           ;1136
0013fe  4669              MOV      r1,sp                 ;1137
001400  1d20              ADDS     r0,r4,#4              ;1137
001402  f7fffffe          BL       lc640_write_long_ptr
001406  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1139
00140a  f88d0000          STRB     r0,[sp,#0]            ;1139
00140e  f8980038          LDRB     r0,[r8,#0x38]         ;1140
001412  f88d0001          STRB     r0,[sp,#1]            ;1140
001416  f898002c          LDRB     r0,[r8,#0x2c]         ;1141
00141a  f88d0002          STRB     r0,[sp,#2]            ;1141
00141e  f88da003          STRB     r10,[sp,#3]           ;1142
001422  4669              MOV      r1,sp                 ;1143
001424  f1040008          ADD      r0,r4,#8              ;1143
001428  f7fffffe          BL       lc640_write_long_ptr
00142c  f8980028          LDRB     r0,[r8,#0x28]         ;1145
001430  f88d0000          STRB     r0,[sp,#0]            ;1145
001434  f8980024          LDRB     r0,[r8,#0x24]         ;1146
001438  f88d0001          STRB     r0,[sp,#1]            ;1146
00143c  f8980020          LDRB     r0,[r8,#0x20]         ;1147
001440  f88d0002          STRB     r0,[sp,#2]            ;1147
001444  f88da003          STRB     r10,[sp,#3]           ;1148
001448  4669              MOV      r1,sp                 ;1149
00144a  f104000c          ADD      r0,r4,#0xc            ;1149
00144e  f7fffffe          BL       lc640_write_long_ptr
001452  2541              MOVS     r5,#0x41              ;1151
001454  f88d5000          STRB     r5,[sp,#0]            ;1151
001458  f88d5001          STRB     r5,[sp,#1]            ;1152
00145c  f88d5002          STRB     r5,[sp,#2]            ;1153
001460  f88d5003          STRB     r5,[sp,#3]            ;1154
001464  4669              MOV      r1,sp                 ;1155
001466  f1040010          ADD      r0,r4,#0x10           ;1155
00146a  f7fffffe          BL       lc640_write_long_ptr
00146e  f88d5000          STRB     r5,[sp,#0]            ;1157
001472  f88d5001          STRB     r5,[sp,#1]            ;1158
001476  f88d5002          STRB     r5,[sp,#2]            ;1159
00147a  f88d5003          STRB     r5,[sp,#3]            ;1160
00147e  4669              MOV      r1,sp                 ;1161
001480  f1040014          ADD      r0,r4,#0x14           ;1161
001484  f7fffffe          BL       lc640_write_long_ptr
001488  f88d5000          STRB     r5,[sp,#0]            ;1163
00148c  f88d5001          STRB     r5,[sp,#1]            ;1164
001490  f88d5002          STRB     r5,[sp,#2]            ;1165
001494  f88d5003          STRB     r5,[sp,#3]            ;1166
001498  4669              MOV      r1,sp                 ;1167
00149a  f1040018          ADD      r0,r4,#0x18           ;1167
00149e  f7fffffe          BL       lc640_write_long_ptr
0014a2  f88d5000          STRB     r5,[sp,#0]            ;1169
0014a6  f88d5001          STRB     r5,[sp,#1]            ;1170
0014aa  f88d5002          STRB     r5,[sp,#2]            ;1171
0014ae  f88d5003          STRB     r5,[sp,#3]            ;1172
0014b2  4669              MOV      r1,sp                 ;1173
0014b4  f104001c          ADD      r0,r4,#0x1c           ;1173
0014b8  f7fffffe          BL       lc640_write_long_ptr
0014bc  b116              CBZ      r6,|L1.5316|
0014be  2e01              CMP      r6,#1                 ;1179
0014c0  d007              BEQ      |L1.5330|
0014c2  e08a              B        |L1.5594|
                  |L1.5316|
0014c4  2302              MOVS     r3,#2                 ;1177
0014c6  2201              MOVS     r2,#1                 ;1177
0014c8  2105              MOVS     r1,#5                 ;1177
0014ca  a0fd              ADR      r0,|L1.6336|
0014cc  f7fffffe          BL       snmp_trap_send
0014d0  e083              B        |L1.5594|
                  |L1.5330|
0014d2  2302              MOVS     r3,#2                 ;1181
0014d4  461a              MOV      r2,r3                 ;1181
0014d6  2105              MOVS     r1,#5                 ;1181
0014d8  a0ff              ADR      r0,|L1.6360|
0014da  f7fffffe          BL       snmp_trap_send
0014de  e07c              B        |L1.5594|
                  |L1.5344|
;;;1187   	{
;;;1188   	//bat[b]._av=0;
;;;1189   
;;;1190        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0014e0  4628              MOV      r0,r5
0014e2  f7fffffe          BL       lc640_read_int
0014e6  b287              UXTH     r7,r0
;;;1191   	event_ptr_find=event_ptr;
0014e8  463c              MOV      r4,r7
                  |L1.5354|
;;;1192   	
;;;1193   avar_bat_as_hndl_lbl1: 
;;;1194   
;;;1195   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0014ea  eb0b1044          ADD      r0,r11,r4,LSL #5
0014ee  b285              UXTH     r5,r0
;;;1196   
;;;1197        lc640_read_long_ptr(lc640_adr,data);
0014f0  4669              MOV      r1,sp
0014f2  4628              MOV      r0,r5
0014f4  f7fffffe          BL       lc640_read_long_ptr
;;;1198        
;;;1199        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
0014f8  f89d0000          LDRB     r0,[sp,#0]
0014fc  2842              CMP      r0,#0x42
0014fe  d107              BNE      |L1.5392|
001500  f89d0001          LDRB     r0,[sp,#1]
001504  42b0              CMP      r0,r6
001506  d103              BNE      |L1.5392|
001508  f89d0002          LDRB     r0,[sp,#2]
00150c  2843              CMP      r0,#0x43
00150e  d007              BEQ      |L1.5408|
                  |L1.5392|
;;;1200        	{        
;;;1201        	if(event_ptr_find)event_ptr_find--;
001510  b114              CBZ      r4,|L1.5400|
001512  1e64              SUBS     r4,r4,#1
001514  b2a4              UXTH     r4,r4
001516  e000              B        |L1.5402|
                  |L1.5400|
;;;1202        	else event_ptr_find=63;
001518  243f              MOVS     r4,#0x3f
                  |L1.5402|
;;;1203        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
00151a  42bc              CMP      r4,r7
00151c  d1e5              BNE      |L1.5354|
00151e  e05c              B        |L1.5594|
                  |L1.5408|
;;;1204        	else goto avar_bat_as_hndl_lbl1;
;;;1205        	}
;;;1206        else 
;;;1207        	{
;;;1208        	lc640_read_long_ptr(lc640_adr+16,data);
001520  4669              MOV      r1,sp
001522  f1050010          ADD      r0,r5,#0x10
001526  f7fffffe          BL       lc640_read_long_ptr
;;;1209        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00152a  f89d0000          LDRB     r0,[sp,#0]
00152e  2841              CMP      r0,#0x41
001530  d10b              BNE      |L1.5450|
001532  f89d0001          LDRB     r0,[sp,#1]
001536  2841              CMP      r0,#0x41
001538  d107              BNE      |L1.5450|
00153a  f89d0002          LDRB     r0,[sp,#2]
00153e  2841              CMP      r0,#0x41
001540  d103              BNE      |L1.5450|
001542  f89d0003          LDRB     r0,[sp,#3]
001546  2841              CMP      r0,#0x41
001548  d007              BEQ      |L1.5466|
                  |L1.5450|
;;;1210        		{        
;;;1211        		if(event_ptr_find)event_ptr_find--;
00154a  b114              CBZ      r4,|L1.5458|
00154c  1e64              SUBS     r4,r4,#1
00154e  b2a4              UXTH     r4,r4
001550  e000              B        |L1.5460|
                  |L1.5458|
;;;1212            		else event_ptr_find=63;
001552  243f              MOVS     r4,#0x3f
                  |L1.5460|
;;;1213            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001554  42bc              CMP      r4,r7
001556  d1c8              BNE      |L1.5354|
001558  e03f              B        |L1.5594|
                  |L1.5466|
;;;1214        		else goto avar_bat_as_hndl_lbl1;
;;;1215        		}
;;;1216   
;;;1217        	}
;;;1218        		
;;;1219   	data[0]=LPC_RTC->YEAR;
00155a  f8b8003c          LDRH     r0,[r8,#0x3c]
00155e  f88d0000          STRB     r0,[sp,#0]
;;;1220   	data[1]=LPC_RTC->MONTH;
001562  f8980038          LDRB     r0,[r8,#0x38]
001566  f88d0001          STRB     r0,[sp,#1]
;;;1221   	data[2]=LPC_RTC->DOM;
00156a  f898002c          LDRB     r0,[r8,#0x2c]
00156e  f88d0002          STRB     r0,[sp,#2]
;;;1222   	data[3]=0;
001572  f88da003          STRB     r10,[sp,#3]
;;;1223   	lc640_write_long_ptr(lc640_adr+16,data);
001576  4669              MOV      r1,sp
001578  f1050010          ADD      r0,r5,#0x10
00157c  f7fffffe          BL       lc640_write_long_ptr
;;;1224   
;;;1225   	data[0]=LPC_RTC->HOUR;
001580  f8980028          LDRB     r0,[r8,#0x28]
001584  f88d0000          STRB     r0,[sp,#0]
;;;1226   	data[1]=LPC_RTC->MIN;
001588  f8980024          LDRB     r0,[r8,#0x24]
00158c  f88d0001          STRB     r0,[sp,#1]
;;;1227   	data[2]=LPC_RTC->SEC;
001590  f8980020          LDRB     r0,[r8,#0x20]
001594  f88d0002          STRB     r0,[sp,#2]
;;;1228   	data[3]=0;
001598  f88da003          STRB     r10,[sp,#3]
;;;1229   	lc640_write_long_ptr(lc640_adr+20,data);
00159c  4669              MOV      r1,sp
00159e  f1050014          ADD      r0,r5,#0x14
0015a2  f7fffffe          BL       lc640_write_long_ptr
;;;1230   	
;;;1231   	data[0]='B';
0015a6  f88d9000          STRB     r9,[sp,#0]
;;;1232   	data[1]='B';
0015aa  f88d9001          STRB     r9,[sp,#1]
;;;1233   	data[2]='B';
0015ae  f88d9002          STRB     r9,[sp,#2]
;;;1234   	data[3]='B';
0015b2  f88d9003          STRB     r9,[sp,#3]
;;;1235   	lc640_write_long_ptr(lc640_adr+24,data);
0015b6  4669              MOV      r1,sp
0015b8  f1050018          ADD      r0,r5,#0x18
0015bc  f7fffffe          BL       lc640_write_long_ptr
;;;1236   	
;;;1237   	data[0]='B';
0015c0  f88d9000          STRB     r9,[sp,#0]
;;;1238   	data[1]='B';
0015c4  f88d9001          STRB     r9,[sp,#1]
;;;1239   	data[2]='B';
0015c8  f88d9002          STRB     r9,[sp,#2]
;;;1240   	data[3]='B';
0015cc  f88d9003          STRB     r9,[sp,#3]
;;;1241   	lc640_write_long_ptr(lc640_adr+28,data);
0015d0  4669              MOV      r1,sp
0015d2  f105001c          ADD      r0,r5,#0x1c
0015d6  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5594|
;;;1242   	
;;;1243   
;;;1244   	
;;;1245   	}
;;;1246   	
;;;1247   avar_bat_as_hndl_end:
;;;1248   __nop();		
0015da  bf00              NOP      
;;;1249   }
0015dc  e55d              B        |L1.4250|
;;;1250   
                          ENDP

                  ke_mem_hndl PROC
;;;1252   //-----------------------------------------------
;;;1253   void ke_mem_hndl(char b,unsigned short in)
0015de  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;1254   {
0015e0  b083              SUB      sp,sp,#0xc
0015e2  4605              MOV      r5,r0
;;;1255   char data[4];
;;;1256   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1257   //unsigned char temp,temp_;
;;;1258   //unsigned int tempUI;
;;;1259   //unsigned long tempUL; 
;;;1260   signed temp_temp;
;;;1261   
;;;1262   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
0015e4  eb050045          ADD      r0,r5,r5,LSL #1
0015e8  49c1              LDR      r1,|L1.6384|
0015ea  eb001005          ADD      r0,r0,r5,LSL #4
0015ee  eb010180          ADD      r1,r1,r0,LSL #2
0015f2  48c0              LDR      r0,|L1.6388|
0015f4  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
0015f8  1c40              ADDS     r0,r0,#1
0015fa  eb010040          ADD      r0,r1,r0,LSL #1
0015fe  f9b00020          LDRSH    r0,[r0,#0x20]
001602  9001              STR      r0,[sp,#4]
;;;1263   
;;;1264   event_ptr=lc640_read_int(PTR_EVENT_LOG);
001604  f44f6660          MOV      r6,#0xe00
001608  4630              MOV      r0,r6
00160a  f7fffffe          BL       lc640_read_int
;;;1265   event_ptr++;	
00160e  1c44              ADDS     r4,r0,#1
;;;1266   if(event_ptr>63)event_ptr=0;	
001610  2c3f              CMP      r4,#0x3f
001612  d900              BLS      |L1.5654|
001614  2400              MOVS     r4,#0
                  |L1.5654|
;;;1267   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
001616  b221              SXTH     r1,r4
001618  4630              MOV      r0,r6
00161a  f7fffffe          BL       lc640_write_int
;;;1268   	
;;;1269   event_cnt=lc640_read_int(CNT_EVENT_LOG);
00161e  f6406702          MOV      r7,#0xe02
001622  4638              MOV      r0,r7
001624  f7fffffe          BL       lc640_read_int
;;;1270   if(event_cnt!=63)event_cnt=event_ptr;
001628  283f              CMP      r0,#0x3f
00162a  d000              BEQ      |L1.5678|
00162c  4620              MOV      r0,r4
                  |L1.5678|
;;;1271   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
00162e  b201              SXTH     r1,r0
001630  4638              MOV      r0,r7
001632  f7fffffe          BL       lc640_write_int
;;;1272   	
;;;1273   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
001636  4630              MOV      r0,r6
001638  f7fffffe          BL       lc640_read_int
00163c  f44f6180          MOV      r1,#0x400
001640  eb011440          ADD      r4,r1,r0,LSL #5
;;;1274   	
;;;1275   data[0]='B';
001644  2042              MOVS     r0,#0x42
001646  f88d0008          STRB     r0,[sp,#8]
;;;1276   data[1]=b; 
00164a  f88d5009          STRB     r5,[sp,#9]
;;;1277   data[2]='K';
00164e  204b              MOVS     r0,#0x4b
001650  f88d000a          STRB     r0,[sp,#0xa]
;;;1278   data[3]=0;
001654  2600              MOVS     r6,#0
001656  f88d600b          STRB     r6,[sp,#0xb]
;;;1279   
;;;1280   lc640_write_long_ptr(lc640_adr,data);
00165a  a902              ADD      r1,sp,#8
00165c  4620              MOV      r0,r4
00165e  f7fffffe          BL       lc640_write_long_ptr
;;;1281   
;;;1282   data[0]=*((char*)&in);
001662  f89d0010          LDRB     r0,[sp,#0x10]
001666  f88d0008          STRB     r0,[sp,#8]
;;;1283   data[1]=*(((char*)(&in))+1);
00166a  f89d0011          LDRB     r0,[sp,#0x11]
00166e  f88d0009          STRB     r0,[sp,#9]
;;;1284   data[2]=*((char*)&temp_temp);
001672  f89d0004          LDRB     r0,[sp,#4]
001676  f88d000a          STRB     r0,[sp,#0xa]
;;;1285   data[3]=*(((char*)(&temp_temp))+1);
00167a  f89d0005          LDRB     r0,[sp,#5]
00167e  f88d000b          STRB     r0,[sp,#0xb]
;;;1286   lc640_write_long_ptr(lc640_adr+4,data);
001682  a902              ADD      r1,sp,#8
001684  1d20              ADDS     r0,r4,#4
001686  f7fffffe          BL       lc640_write_long_ptr
;;;1287   
;;;1288   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
00168a  f44f70fc          MOV      r0,#0x1f8
00168e  f7fffffe          BL       lc640_read_long
001692  4d99              LDR      r5,|L1.6392|
001694  6028              STR      r0,[r5,#0]  ; ke_date
;;;1289   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
001696  4629              MOV      r1,r5
001698  f1040008          ADD      r0,r4,#8
00169c  f7fffffe          BL       lc640_write_long_ptr
;;;1290   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
0016a0  f44f70fe          MOV      r0,#0x1fc
0016a4  f7fffffe          BL       lc640_read_long
0016a8  6068              STR      r0,[r5,#4]  ; ke_date
;;;1291   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
0016aa  1d29              ADDS     r1,r5,#4
0016ac  f104000c          ADD      r0,r4,#0xc
0016b0  f7fffffe          BL       lc640_write_long_ptr
;;;1292   
;;;1293   data[0]=LPC_RTC->YEAR;
0016b4  4d91              LDR      r5,|L1.6396|
0016b6  8ba8              LDRH     r0,[r5,#0x1c]
0016b8  f88d0008          STRB     r0,[sp,#8]
;;;1294   data[1]=LPC_RTC->MONTH;
0016bc  7e28              LDRB     r0,[r5,#0x18]
0016be  f88d0009          STRB     r0,[sp,#9]
;;;1295   data[2]=LPC_RTC->DOM;
0016c2  7b28              LDRB     r0,[r5,#0xc]
0016c4  f88d000a          STRB     r0,[sp,#0xa]
;;;1296   data[3]=0;
0016c8  f88d600b          STRB     r6,[sp,#0xb]
;;;1297   lc640_write_long_ptr(lc640_adr+16,data);
0016cc  a902              ADD      r1,sp,#8
0016ce  f1040010          ADD      r0,r4,#0x10
0016d2  f7fffffe          BL       lc640_write_long_ptr
;;;1298   
;;;1299   data[0]=LPC_RTC->HOUR;
0016d6  7a28              LDRB     r0,[r5,#8]
0016d8  f88d0008          STRB     r0,[sp,#8]
;;;1300   data[1]=LPC_RTC->MIN;
0016dc  7928              LDRB     r0,[r5,#4]
0016de  f88d0009          STRB     r0,[sp,#9]
;;;1301   data[2]=LPC_RTC->SEC;
0016e2  7828              LDRB     r0,[r5,#0]
0016e4  f88d000a          STRB     r0,[sp,#0xa]
;;;1302   data[3]=0;
0016e8  f88d600b          STRB     r6,[sp,#0xb]
;;;1303   lc640_write_long_ptr(lc640_adr+20,data);
0016ec  a902              ADD      r1,sp,#8
0016ee  f1040014          ADD      r0,r4,#0x14
0016f2  f7fffffe          BL       lc640_write_long_ptr
;;;1304    
;;;1305   }
0016f6  b005              ADD      sp,sp,#0x14
0016f8  bdf0              POP      {r4-r7,pc}
;;;1306   
                          ENDP

                  vz_mem_hndl PROC
;;;1308   //-----------------------------------------------
;;;1309   void vz_mem_hndl(unsigned short in)
0016fa  e92d4ff8          PUSH     {r3-r11,lr}
;;;1310   {
;;;1311   char data[4];
;;;1312   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
0016fe  2600              MOVS     r6,#0
001700  2400              MOVS     r4,#0
;;;1313   //char avar_simbol;
;;;1314   
;;;1315   if(in==1)
;;;1316   	{
;;;1317   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1318   	event_ptr++;	
;;;1319   	if(event_ptr>63)event_ptr=0;	
;;;1320   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1321   	
;;;1322        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1323   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1324   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1325   	
;;;1326   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1327   	
;;;1328   	data[0]='B';
;;;1329   	data[1]=0; 
;;;1330   	data[2]='Z';
;;;1331   	data[3]=0;
;;;1332   	lc640_write_long_ptr(lc640_adr,data);
;;;1333   
;;;1334   	data[0]=0;
;;;1335   	data[1]=0;
;;;1336   	data[2]=0;
;;;1337   	data[3]=0;
;;;1338   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1339   
;;;1340   	data[0]=LPC_RTC->YEAR;
001702  f8df81f8          LDR      r8,|L1.6396|
001706  2742              MOVS     r7,#0x42              ;1328
001708  46a1              MOV      r9,r4                 ;1312
00170a  f1a80820          SUB      r8,r8,#0x20
00170e  f44f6a80          MOV      r10,#0x400            ;1326
001712  2801              CMP      r0,#1                 ;1315
001714  d001              BEQ      |L1.5914|
;;;1341   	data[1]=LPC_RTC->MONTH;
;;;1342   	data[2]=LPC_RTC->DOM;
;;;1343   	data[3]=0;
;;;1344   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1345   
;;;1346   	data[0]=LPC_RTC->HOUR;
;;;1347   	data[1]=LPC_RTC->MIN;
;;;1348   	data[2]=LPC_RTC->SEC;
;;;1349   	data[3]=0;
;;;1350   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1351   	
;;;1352   	data[0]='A';
;;;1353   	data[1]='A';
;;;1354   	data[2]='A';
;;;1355   	data[3]='A';
;;;1356   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1357   	
;;;1358   	data[0]='A';
;;;1359   	data[1]='A';
;;;1360   	data[2]='A';
;;;1361   	data[3]='A';
;;;1362   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1363   	
;;;1364   	data[0]='A';
;;;1365   	data[1]='A';
;;;1366   	data[2]='A';
;;;1367   	data[3]='A';
;;;1368   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1369   	
;;;1370   	data[0]='A';
;;;1371   	data[1]='A';
;;;1372   	data[2]='A';
;;;1373   	data[3]='A';
;;;1374   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1375    	
;;;1376   	}
;;;1377   
;;;1378   else if(in==0)
001716  b3f0              CBZ      r0,|L1.6038|
001718  e121              B        |L1.6494|
                  |L1.5914|
00171a  f44f6560          MOV      r5,#0xe00             ;1317
00171e  4628              MOV      r0,r5                 ;1317
001720  f7fffffe          BL       lc640_read_int
001724  1c44              ADDS     r4,r0,#1              ;1318
001726  2c3f              CMP      r4,#0x3f              ;1319
001728  d900              BLS      |L1.5932|
00172a  2400              MOVS     r4,#0                 ;1319
                  |L1.5932|
00172c  b221              SXTH     r1,r4                 ;1320
00172e  4628              MOV      r0,r5                 ;1320
001730  f7fffffe          BL       lc640_write_int
001734  f6406602          MOV      r6,#0xe02             ;1322
001738  4630              MOV      r0,r6                 ;1322
00173a  f7fffffe          BL       lc640_read_int
00173e  283f              CMP      r0,#0x3f              ;1323
001740  d000              BEQ      |L1.5956|
001742  4620              MOV      r0,r4                 ;1323
                  |L1.5956|
001744  b201              SXTH     r1,r0                 ;1324
001746  4630              MOV      r0,r6                 ;1324
001748  f7fffffe          BL       lc640_write_int
00174c  4628              MOV      r0,r5                 ;1326
00174e  f7fffffe          BL       lc640_read_int
001752  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1326
001756  f88d7000          STRB     r7,[sp,#0]            ;1328
00175a  f88d9001          STRB     r9,[sp,#1]            ;1329
00175e  205a              MOVS     r0,#0x5a              ;1330
001760  f88d0002          STRB     r0,[sp,#2]            ;1330
001764  f88d9003          STRB     r9,[sp,#3]            ;1331
001768  4669              MOV      r1,sp                 ;1332
00176a  4620              MOV      r0,r4                 ;1332
00176c  f7fffffe          BL       lc640_write_long_ptr
001770  f8cd9000          STR      r9,[sp,#0]            ;1337
001774  4669              MOV      r1,sp                 ;1338
001776  1d20              ADDS     r0,r4,#4              ;1338
001778  f7fffffe          BL       lc640_write_long_ptr
00177c  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1340
001780  f88d0000          STRB     r0,[sp,#0]            ;1340
001784  f8980038          LDRB     r0,[r8,#0x38]         ;1341
001788  f88d0001          STRB     r0,[sp,#1]            ;1341
00178c  f898002c          LDRB     r0,[r8,#0x2c]         ;1342
001790  f88d0002          STRB     r0,[sp,#2]            ;1342
001794  e000              B        |L1.6040|
                  |L1.6038|
001796  e04f              B        |L1.6200|
                  |L1.6040|
001798  f88d9003          STRB     r9,[sp,#3]            ;1343
00179c  4669              MOV      r1,sp                 ;1344
00179e  f1040008          ADD      r0,r4,#8              ;1344
0017a2  f7fffffe          BL       lc640_write_long_ptr
0017a6  f8980028          LDRB     r0,[r8,#0x28]         ;1346
0017aa  f88d0000          STRB     r0,[sp,#0]            ;1346
0017ae  f8980024          LDRB     r0,[r8,#0x24]         ;1347
0017b2  f88d0001          STRB     r0,[sp,#1]            ;1347
0017b6  f8980020          LDRB     r0,[r8,#0x20]         ;1348
0017ba  f88d0002          STRB     r0,[sp,#2]            ;1348
0017be  f88d9003          STRB     r9,[sp,#3]            ;1349
0017c2  4669              MOV      r1,sp                 ;1350
0017c4  f104000c          ADD      r0,r4,#0xc            ;1350
0017c8  f7fffffe          BL       lc640_write_long_ptr
0017cc  2541              MOVS     r5,#0x41              ;1352
0017ce  f88d5000          STRB     r5,[sp,#0]            ;1352
0017d2  f88d5001          STRB     r5,[sp,#1]            ;1353
0017d6  f88d5002          STRB     r5,[sp,#2]            ;1354
0017da  f88d5003          STRB     r5,[sp,#3]            ;1355
0017de  4669              MOV      r1,sp                 ;1356
0017e0  f1040010          ADD      r0,r4,#0x10           ;1356
0017e4  f7fffffe          BL       lc640_write_long_ptr
0017e8  f88d5000          STRB     r5,[sp,#0]            ;1358
0017ec  f88d5001          STRB     r5,[sp,#1]            ;1359
0017f0  f88d5002          STRB     r5,[sp,#2]            ;1360
0017f4  f88d5003          STRB     r5,[sp,#3]            ;1361
0017f8  4669              MOV      r1,sp                 ;1362
0017fa  f1040014          ADD      r0,r4,#0x14           ;1362
0017fe  f7fffffe          BL       lc640_write_long_ptr
001802  f88d5000          STRB     r5,[sp,#0]            ;1364
001806  f88d5001          STRB     r5,[sp,#1]            ;1365
00180a  f88d5002          STRB     r5,[sp,#2]            ;1366
00180e  f88d5003          STRB     r5,[sp,#3]            ;1367
001812  4669              MOV      r1,sp                 ;1368
001814  f1040018          ADD      r0,r4,#0x18           ;1368
001818  f7fffffe          BL       lc640_write_long_ptr
00181c  f88d5000          STRB     r5,[sp,#0]            ;1370
001820  f88d5001          STRB     r5,[sp,#1]            ;1371
001824  f88d5002          STRB     r5,[sp,#2]            ;1372
001828  f88d5003          STRB     r5,[sp,#3]            ;1373
00182c  4669              MOV      r1,sp                 ;1374
00182e  f104001c          ADD      r0,r4,#0x1c           ;1374
001832  f7fffffe          BL       lc640_write_long_ptr
001836  e092              B        |L1.6494|
                  |L1.6200|
;;;1379   	{      
;;;1380        
;;;1381   vz_mem_hndl_lbl1: 
;;;1382   
;;;1383   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001838  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1384   
;;;1385        lc640_read_long_ptr(lc640_adr,data);
00183c  4669              MOV      r1,sp
00183e  4628              MOV      r0,r5
001840  f7fffffe          BL       lc640_read_long_ptr
;;;1386        
;;;1387        if(!((data[0]=='B')&&(data[2]=='Z')))
001844  f89d0000          LDRB     r0,[sp,#0]
001848  2842              CMP      r0,#0x42
00184a  d103              BNE      |L1.6228|
00184c  f89d0002          LDRB     r0,[sp,#2]
001850  285a              CMP      r0,#0x5a
001852  d006              BEQ      |L1.6242|
                  |L1.6228|
;;;1388        	{        
;;;1389        	if(event_ptr_find)event_ptr_find--;
001854  b10c              CBZ      r4,|L1.6234|
001856  1e64              SUBS     r4,r4,#1
001858  e000              B        |L1.6236|
                  |L1.6234|
;;;1390        	else event_ptr_find=63;
00185a  243f              MOVS     r4,#0x3f
                  |L1.6236|
;;;1391        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
00185c  42b4              CMP      r4,r6
00185e  d1eb              BNE      |L1.6200|
001860  e07d              B        |L1.6494|
                  |L1.6242|
;;;1392        	else goto vz_mem_hndl_lbl1;
;;;1393        	}
;;;1394        else 
;;;1395        	{
;;;1396        	lc640_read_long_ptr(lc640_adr+16,data);
001862  4669              MOV      r1,sp
001864  f1050010          ADD      r0,r5,#0x10
001868  f7fffffe          BL       lc640_read_long_ptr
;;;1397        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00186c  f89d0000          LDRB     r0,[sp,#0]
001870  2841              CMP      r0,#0x41
001872  d10b              BNE      |L1.6284|
001874  f89d0001          LDRB     r0,[sp,#1]
001878  2841              CMP      r0,#0x41
00187a  d107              BNE      |L1.6284|
00187c  f89d0002          LDRB     r0,[sp,#2]
001880  2841              CMP      r0,#0x41
001882  d103              BNE      |L1.6284|
001884  f89d0003          LDRB     r0,[sp,#3]
001888  2841              CMP      r0,#0x41
00188a  d006              BEQ      |L1.6298|
                  |L1.6284|
;;;1398        		{        
;;;1399        		if(event_ptr_find)event_ptr_find--;
00188c  b10c              CBZ      r4,|L1.6290|
00188e  1e64              SUBS     r4,r4,#1
001890  e000              B        |L1.6292|
                  |L1.6290|
;;;1400            		else event_ptr_find=63;
001892  243f              MOVS     r4,#0x3f
                  |L1.6292|
;;;1401            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
001894  42b4              CMP      r4,r6
001896  d1cf              BNE      |L1.6200|
001898  e061              B        |L1.6494|
                  |L1.6298|
;;;1402        		else goto vz_mem_hndl_lbl1;
;;;1403        		}
;;;1404   
;;;1405        	}	
;;;1406   
;;;1407   
;;;1408   	
;;;1409   	data[0]=LPC_RTC->YEAR;
00189a  f8b8003c          LDRH     r0,[r8,#0x3c]
00189e  f88d0000          STRB     r0,[sp,#0]
;;;1410   	data[1]=LPC_RTC->MONTH;
0018a2  f8980038          LDRB     r0,[r8,#0x38]
0018a6  f88d0001          STRB     r0,[sp,#1]
;;;1411   	data[2]=LPC_RTC->DOM;
0018aa  f898002c          LDRB     r0,[r8,#0x2c]
0018ae  f88d0002          STRB     r0,[sp,#2]
;;;1412   	data[3]=0;
0018b2  f88d9003          STRB     r9,[sp,#3]
;;;1413   	lc640_write_long_ptr(lc640_adr+16,data);
0018b6  4669              MOV      r1,sp
0018b8  f1050010          ADD      r0,r5,#0x10
0018bc  e020              B        |L1.6400|
0018be  0000              DCW      0x0000
                  |L1.6336|
0018c0  42415420          DCB      "BAT #1 Alarm, assimetry",0
0018c4  23312041
0018c8  6c61726d
0018cc  2c206173
0018d0  73696d65
0018d4  74727900
                  |L1.6360|
0018d8  42415420          DCB      "BAT #2 Alarm, assimetry",0
0018dc  23322041
0018e0  6c61726d
0018e4  2c206173
0018e8  73696d65
0018ec  74727900
                  |L1.6384|
                          DCD      bat
                  |L1.6388|
                          DCD      bat_u_old_cnt
                  |L1.6392|
                          DCD      ke_date
                  |L1.6396|
                          DCD      0x40024020
                  |L1.6400|
001900  f7fffffe          BL       lc640_write_long_ptr
;;;1414   
;;;1415   	data[0]=LPC_RTC->HOUR;
001904  f8980028          LDRB     r0,[r8,#0x28]
001908  f88d0000          STRB     r0,[sp,#0]
;;;1416   	data[1]=LPC_RTC->MIN;
00190c  f8980024          LDRB     r0,[r8,#0x24]
001910  f88d0001          STRB     r0,[sp,#1]
;;;1417   	data[2]=LPC_RTC->SEC;
001914  f8980020          LDRB     r0,[r8,#0x20]
001918  f88d0002          STRB     r0,[sp,#2]
;;;1418   	data[3]=0;
00191c  f88d9003          STRB     r9,[sp,#3]
;;;1419   	lc640_write_long_ptr(lc640_adr+20,data);
001920  4669              MOV      r1,sp
001922  f1050014          ADD      r0,r5,#0x14
001926  f7fffffe          BL       lc640_write_long_ptr
;;;1420   	
;;;1421   	data[0]='B';
00192a  f88d7000          STRB     r7,[sp,#0]
;;;1422   	data[1]='B';
00192e  f88d7001          STRB     r7,[sp,#1]
;;;1423   	data[2]='B';
001932  f88d7002          STRB     r7,[sp,#2]
;;;1424   	data[3]='B';
001936  f88d7003          STRB     r7,[sp,#3]
;;;1425   	lc640_write_long_ptr(lc640_adr+24,data);
00193a  4669              MOV      r1,sp
00193c  f1050018          ADD      r0,r5,#0x18
001940  f7fffffe          BL       lc640_write_long_ptr
;;;1426   	
;;;1427   	data[0]='B';
001944  f88d7000          STRB     r7,[sp,#0]
;;;1428   	data[1]='B';
001948  f88d7001          STRB     r7,[sp,#1]
;;;1429   	data[2]='B';
00194c  f88d7002          STRB     r7,[sp,#2]
;;;1430   	data[3]='B';
001950  f88d7003          STRB     r7,[sp,#3]
;;;1431   	lc640_write_long_ptr(lc640_adr+28,data);
001954  4669              MOV      r1,sp
001956  f105001c          ADD      r0,r5,#0x1c
00195a  f7fffffe          BL       lc640_write_long_ptr
                  |L1.6494|
;;;1432   	
;;;1433   	}
;;;1434   
;;;1435   vz_mem_hndl_end:
;;;1436   __nop(); 
00195e  bf00              NOP      
;;;1437   
;;;1438   }
001960  e4dd              B        |L1.4894|
;;;1439     
                          ENDP


                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  av_inv
                          DCD      0x00000000
000018  0000              DCB      0x00,0x00
