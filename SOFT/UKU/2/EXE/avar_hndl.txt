; generated by ARM C/C++ Compiler, 4.1 [Build 481]
; commandline ArmCC [--debug -c --asm --interleave -o.\EXE\avar_hndl.o --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\INC -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DAPSENERGIA --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;76     //-----------------------------------------------
;;;77     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;78     {
;;;79     //static unsigned avar_stat_old;
;;;80     char i;
;;;81     //unsigned avar_stat_new,avar_stat_offed;
;;;82     
;;;83     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48ff              LDR      r0,|L1.1024|
000004  49ff              LDR      r1,|L1.1028|
000006  7802              LDRB     r2,[r0,#0]  ; net_av
000008  6808              LDR      r0,[r1,#0]
00000a  b11a              CBZ      r2,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6008              STR      r0,[r1,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;84     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6008              STR      r0,[r1,#0]  ; avar_stat
                  |L1.26|
;;;85     
;;;86     for(i=0;i<2;i++)
00001a  2000              MOVS     r0,#0
;;;87     	{
;;;88     	if(bat[i]._av&1)	SET_REG(avar_stat,1,1+i,1);
00001c  4dfa              LDR      r5,|L1.1032|
00001e  2401              MOVS     r4,#1
                  |L1.32|
000020  eb000240          ADD      r2,r0,r0,LSL #1
000024  eb021200          ADD      r2,r2,r0,LSL #4
000028  eb050282          ADD      r2,r5,r2,LSL #2
00002c  f892203d          LDRB     r2,[r2,#0x3d]
000030  07d2              LSLS     r2,r2,#31
000032  d007              BEQ      |L1.68|
000034  1c43              ADDS     r3,r0,#1
000036  fa04f203          LSL      r2,r4,r3
00003a  680b              LDR      r3,[r1,#0]  ; avar_stat
00003c  4393              BICS     r3,r3,r2
00003e  4313              ORRS     r3,r3,r2
000040  600b              STR      r3,[r1,#0]  ; avar_stat
000042  e005              B        |L1.80|
                  |L1.68|
;;;89     	else	   		SET_REG(avar_stat,0,1+i,1);
000044  1c42              ADDS     r2,r0,#1
000046  fa04f302          LSL      r3,r4,r2
00004a  680a              LDR      r2,[r1,#0]  ; avar_stat
00004c  439a              BICS     r2,r2,r3
00004e  600a              STR      r2,[r1,#0]  ; avar_stat
                  |L1.80|
000050  1c40              ADDS     r0,r0,#1              ;86
000052  b2c0              UXTB     r0,r0                 ;86
000054  2802              CMP      r0,#2                 ;86
000056  d3e3              BCC      |L1.32|
;;;90     	}
;;;91     
;;;92     for(i=0;i<12;i++)
000058  2000              MOVS     r0,#0
;;;93     	{
;;;94     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00005a  4aec              LDR      r2,|L1.1036|
                  |L1.92|
00005c  ebc003c0          RSB      r3,r0,r0,LSL #3
000060  eb031300          ADD      r3,r3,r0,LSL #4
000064  eb020383          ADD      r3,r2,r3,LSL #2
000068  785b              LDRB     r3,[r3,#1]
00006a  f0130fef          TST      r3,#0xef
00006e  d007              BEQ      |L1.128|
000070  1cc5              ADDS     r5,r0,#3
000072  fa04f305          LSL      r3,r4,r5
000076  680d              LDR      r5,[r1,#0]  ; avar_stat
000078  439d              BICS     r5,r5,r3
00007a  431d              ORRS     r5,r5,r3
00007c  600d              STR      r5,[r1,#0]  ; avar_stat
00007e  e005              B        |L1.140|
                  |L1.128|
;;;95     	else	   		SET_REG(avar_stat,0,3+i,1);
000080  1cc3              ADDS     r3,r0,#3
000082  fa04f503          LSL      r5,r4,r3
000086  680b              LDR      r3,[r1,#0]  ; avar_stat
000088  43ab              BICS     r3,r3,r5
00008a  600b              STR      r3,[r1,#0]  ; avar_stat
                  |L1.140|
00008c  1c40              ADDS     r0,r0,#1              ;92
00008e  b2c0              UXTB     r0,r0                 ;92
000090  280c              CMP      r0,#0xc               ;92
000092  d3e3              BCC      |L1.92|
;;;96     	}
;;;97     
;;;98     for(i=0;i<6;i++)
000094  2000              MOVS     r0,#0
;;;99     	{
;;;100    	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
000096  4ddb              LDR      r5,|L1.1028|
000098  3550              ADDS     r5,r5,#0x50
                  |L1.154|
00009a  5c2a              LDRB     r2,[r5,r0]
00009c  b142              CBZ      r2,|L1.176|
00009e  f100030f          ADD      r3,r0,#0xf
0000a2  fa04f203          LSL      r2,r4,r3
0000a6  680b              LDR      r3,[r1,#0]  ; avar_stat
0000a8  4393              BICS     r3,r3,r2
0000aa  4313              ORRS     r3,r3,r2
0000ac  600b              STR      r3,[r1,#0]  ; avar_stat
0000ae  e006              B        |L1.190|
                  |L1.176|
;;;101    	else	   		SET_REG(avar_stat,0,15+i,1);
0000b0  f100020f          ADD      r2,r0,#0xf
0000b4  680b              LDR      r3,[r1,#0]  ; avar_stat
0000b6  fa04f202          LSL      r2,r4,r2
0000ba  4393              BICS     r3,r3,r2
0000bc  600b              STR      r3,[r1,#0]  ; avar_stat
                  |L1.190|
0000be  1c40              ADDS     r0,r0,#1              ;98
0000c0  b2c0              UXTB     r0,r0                 ;98
0000c2  2806              CMP      r0,#6                 ;98
0000c4  d3e9              BCC      |L1.154|
;;;102    	}
;;;103    
;;;104    /*for(i=0;i<4;i++)
;;;105    	{
;;;106    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;107    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;108    	}  */
;;;109    for(i=0;i<4;i++)
0000c6  2000              MOVS     r0,#0
;;;110    	{
;;;111    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000c8  4bd1              LDR      r3,|L1.1040|
                  |L1.202|
0000ca  5c1a              LDRB     r2,[r3,r0]
0000cc  2a01              CMP      r2,#1
0000ce  d012              BEQ      |L1.246|
;;;112    	else	   		SET_REG(avar_stat,0,24+i,1);
0000d0  f1000218          ADD      r2,r0,#0x18
0000d4  fa04f502          LSL      r5,r4,r2
0000d8  680a              LDR      r2,[r1,#0]  ; avar_stat
0000da  43aa              BICS     r2,r2,r5
0000dc  600a              STR      r2,[r1,#0]  ; avar_stat
                  |L1.222|
0000de  1c40              ADDS     r0,r0,#1              ;109
0000e0  b2c0              UXTB     r0,r0                 ;109
0000e2  2804              CMP      r0,#4                 ;109
0000e4  d3f1              BCC      |L1.202|
;;;113    	}
;;;114    
;;;115    if(uout_av)			SET_REG(avar_stat,1,28,1);
0000e6  48cb              LDR      r0,|L1.1044|
0000e8  7800              LDRB     r0,[r0,#0]  ; uout_av
0000ea  b168              CBZ      r0,|L1.264|
0000ec  6808              LDR      r0,[r1,#0]  ; avar_stat
0000ee  f0405080          ORR      r0,r0,#0x10000000
0000f2  6008              STR      r0,[r1,#0]  ; avar_stat
0000f4  e00c              B        |L1.272|
                  |L1.246|
0000f6  f1000518          ADD      r5,r0,#0x18           ;111
0000fa  fa04f205          LSL      r2,r4,r5              ;111
0000fe  680d              LDR      r5,[r1,#0]            ;111  ; avar_stat
000100  4395              BICS     r5,r5,r2              ;111
000102  4315              ORRS     r5,r5,r2              ;111
000104  600d              STR      r5,[r1,#0]            ;111  ; avar_stat
000106  e7ea              B        |L1.222|
                  |L1.264|
;;;116    else	   			SET_REG(avar_stat,0,28,1);
000108  6808              LDR      r0,[r1,#0]  ; avar_stat
00010a  f0205080          BIC      r0,r0,#0x10000000
00010e  6008              STR      r0,[r1,#0]  ; avar_stat
                  |L1.272|
;;;117    
;;;118    
;;;119    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000110  688a              LDR      r2,[r1,#8]  ; avar_stat_old
000112  6808              LDR      r0,[r1,#0]  ; avar_stat
000114  ea200302          BIC      r3,r0,r2
000118  60cb              STR      r3,[r1,#0xc]  ; avar_stat_new
;;;120    
;;;121    avar_ind_stat|=avar_stat_new;
00011a  684c              LDR      r4,[r1,#4]  ; avar_ind_stat
00011c  431c              ORRS     r4,r4,r3
00011e  604c              STR      r4,[r1,#4]  ; avar_ind_stat
;;;122    
;;;123    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000120  4bbd              LDR      r3,|L1.1048|
000122  881d              LDRH     r5,[r3,#0]  ; SK_ZVUK_EN
000124  b115              CBZ      r5,|L1.300|
000126  f0247480          BIC      r4,r4,#0x1000000
00012a  604c              STR      r4,[r1,#4]  ; avar_ind_stat
                  |L1.300|
;;;124    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
00012c  885c              LDRH     r4,[r3,#2]  ; SK_ZVUK_EN
00012e  b11c              CBZ      r4,|L1.312|
000130  684c              LDR      r4,[r1,#4]  ; avar_ind_stat
000132  f0247400          BIC      r4,r4,#0x2000000
000136  604c              STR      r4,[r1,#4]  ; avar_ind_stat
                  |L1.312|
;;;125    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
000138  889c              LDRH     r4,[r3,#4]  ; SK_ZVUK_EN
00013a  b11c              CBZ      r4,|L1.324|
00013c  684c              LDR      r4,[r1,#4]  ; avar_ind_stat
00013e  f0246480          BIC      r4,r4,#0x4000000
000142  604c              STR      r4,[r1,#4]  ; avar_ind_stat
                  |L1.324|
;;;126    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
000144  88db              LDRH     r3,[r3,#6]  ; SK_ZVUK_EN
000146  b11b              CBZ      r3,|L1.336|
000148  684b              LDR      r3,[r1,#4]  ; avar_ind_stat
00014a  f0236300          BIC      r3,r3,#0x8000000
00014e  604b              STR      r3,[r1,#4]  ; avar_ind_stat
                  |L1.336|
;;;127    
;;;128    
;;;129    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
000150  4382              BICS     r2,r2,r0
000152  43d2              MVNS     r2,r2
000154  610a              STR      r2,[r1,#0x10]  ; avar_stat_offed
;;;130    
;;;131    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
000156  4bb1              LDR      r3,|L1.1052|
000158  881b              LDRH     r3,[r3,#0]  ; AV_OFF_AVT
00015a  b913              CBNZ     r3,|L1.354|
00015c  4bb0              LDR      r3,|L1.1056|
00015e  431a              ORRS     r2,r2,r3
000160  610a              STR      r2,[r1,#0x10]  ; avar_stat_offed
                  |L1.354|
;;;132    
;;;133    avar_ind_stat&=avar_stat_offed; 
000162  690b              LDR      r3,[r1,#0x10]  ; avar_stat_offed
000164  684a              LDR      r2,[r1,#4]  ; avar_ind_stat
000166  401a              ANDS     r2,r2,r3
000168  604a              STR      r2,[r1,#4]  ; avar_ind_stat
;;;134    
;;;135    avar_stat_old=avar_stat;
00016a  6088              STR      r0,[r1,#8]  ; avar_stat_old
;;;136    
;;;137    //oleg_start+
;;;138    
;;;139    
;;;140    
;;;141    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
00016c  48ad              LDR      r0,|L1.1060|
00016e  4aae              LDR      r2,|L1.1064|
000170  8800              LDRH     r0,[r0,#0]  ; status_izm_r
000172  6812              LDR      r2,[r2,#0]  ; sk_alarm
000174  f000003f          AND      r0,r0,#0x3f
000178  ea402002          ORR      r0,r0,r2,LSL #8
00017c  6148              STR      r0,[r1,#0x14]  ; rki_avar1_stat
;;;142    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
00017e  69cb              LDR      r3,[r1,#0x1c]  ; rki_avar1_stat_old
000180  ea200203          BIC      r2,r0,r3
000184  620a              STR      r2,[r1,#0x20]  ; rki_avar1_stat_new
;;;143    rki_avar1_ind_stat|=rki_avar1_stat_new;
000186  698c              LDR      r4,[r1,#0x18]  ; rki_avar1_ind_stat
000188  4314              ORRS     r4,r4,r2
;;;144    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
00018a  4383              BICS     r3,r3,r0
00018c  43da              MVNS     r2,r3
00018e  624a              STR      r2,[r1,#0x24]  ; rki_avar1_stat_offed
;;;145    rki_avar1_ind_stat&=rki_avar1_stat_offed;
000190  4014              ANDS     r4,r4,r2
000192  618c              STR      r4,[r1,#0x18]  ; rki_avar1_ind_stat
;;;146    rki_avar1_stat_old=rki_avar1_stat;
000194  61c8              STR      r0,[r1,#0x1c]  ; rki_avar1_stat_old
;;;147    
;;;148    rki_avarI1_stat=status_di1;
000196  48a5              LDR      r0,|L1.1068|
000198  6800              LDR      r0,[r0,#0]  ; status_di1
00019a  6288              STR      r0,[r1,#0x28]  ; rki_avarI1_stat
;;;149    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
00019c  6b0b              LDR      r3,[r1,#0x30]  ; rki_avarI1_stat_old
00019e  ea200203          BIC      r2,r0,r3
0001a2  634a              STR      r2,[r1,#0x34]  ; rki_avarI1_stat_new
;;;150    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
0001a4  6acc              LDR      r4,[r1,#0x2c]  ; rki_avarI1_ind_stat
0001a6  4314              ORRS     r4,r4,r2
;;;151    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
0001a8  4383              BICS     r3,r3,r0
0001aa  43da              MVNS     r2,r3
0001ac  638a              STR      r2,[r1,#0x38]  ; rki_avarI1_stat_offed
;;;152    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
0001ae  4014              ANDS     r4,r4,r2
0001b0  62cc              STR      r4,[r1,#0x2c]  ; rki_avarI1_ind_stat
;;;153    rki_avarI1_stat_old=rki_avarI1_stat;
0001b2  6308              STR      r0,[r1,#0x30]  ; rki_avarI1_stat_old
;;;154    
;;;155    rki_avarI2_stat=status_di2;
0001b4  489e              LDR      r0,|L1.1072|
0001b6  6800              LDR      r0,[r0,#0]  ; status_di2
0001b8  63c8              STR      r0,[r1,#0x3c]  ; rki_avarI2_stat
;;;156    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
0001ba  6c4b              LDR      r3,[r1,#0x44]  ; rki_avarI2_stat_old
0001bc  ea200203          BIC      r2,r0,r3
0001c0  648a              STR      r2,[r1,#0x48]  ; rki_avarI2_stat_new
;;;157    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
0001c2  6c0c              LDR      r4,[r1,#0x40]  ; rki_avarI2_ind_stat
0001c4  4314              ORRS     r4,r4,r2
;;;158    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
0001c6  4383              BICS     r3,r3,r0
0001c8  43da              MVNS     r2,r3
0001ca  64ca              STR      r2,[r1,#0x4c]  ; rki_avarI2_stat_offed
;;;159    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
0001cc  4014              ANDS     r4,r4,r2
0001ce  640c              STR      r4,[r1,#0x40]  ; rki_avarI2_ind_stat
;;;160    rki_avarI2_stat_old=rki_avarI2_stat;
0001d0  6448              STR      r0,[r1,#0x44]  ; rki_avarI2_stat_old
;;;161    //oleg_end
;;;162    }
0001d2  bd30              POP      {r4,r5,pc}
;;;163    
                          ENDP

                  reload_hndl PROC
;;;164    //-----------------------------------------------
;;;165    void reload_hndl(void)
0001d4  b5f8              PUSH     {r3-r7,lr}
;;;166    {
;;;167    char data[4];
;;;168    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;169    
;;;170    event_ptr=lc640_read_int(PTR_EVENT_LOG);
0001d6  f44f6560          MOV      r5,#0xe00
0001da  4628              MOV      r0,r5
0001dc  f7fffffe          BL       lc640_read_int
;;;171    event_ptr++;	
0001e0  1c44              ADDS     r4,r0,#1
;;;172    if(event_ptr>63)event_ptr=0;	
0001e2  2c3f              CMP      r4,#0x3f
0001e4  d900              BLS      |L1.488|
0001e6  2400              MOVS     r4,#0
                  |L1.488|
;;;173    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
0001e8  b221              SXTH     r1,r4
0001ea  4628              MOV      r0,r5
0001ec  f7fffffe          BL       lc640_write_int
;;;174    	
;;;175    event_cnt=lc640_read_int(CNT_EVENT_LOG);
0001f0  f6406602          MOV      r6,#0xe02
0001f4  4630              MOV      r0,r6
0001f6  f7fffffe          BL       lc640_read_int
;;;176    if(event_cnt!=63)event_cnt=event_ptr;
0001fa  283f              CMP      r0,#0x3f
0001fc  d000              BEQ      |L1.512|
0001fe  4620              MOV      r0,r4
                  |L1.512|
;;;177    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000200  b201              SXTH     r1,r0
000202  4630              MOV      r0,r6
000204  f7fffffe          BL       lc640_write_int
;;;178    	
;;;179    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000208  4628              MOV      r0,r5
00020a  f7fffffe          BL       lc640_read_int
00020e  f44f6180          MOV      r1,#0x400
000212  eb011440          ADD      r4,r1,r0,LSL #5
;;;180    	
;;;181    data[0]='U';
000216  2055              MOVS     r0,#0x55
000218  f88d0000          STRB     r0,[sp,#0]
;;;182    data[1]=0;
00021c  2600              MOVS     r6,#0
00021e  f88d6001          STRB     r6,[sp,#1]
;;;183    data[2]='R';
000222  2052              MOVS     r0,#0x52
000224  f88d0002          STRB     r0,[sp,#2]
;;;184    data[3]=0;
000228  f88d6003          STRB     r6,[sp,#3]
;;;185    lc640_write_long_ptr(lc640_adr,data);
00022c  4669              MOV      r1,sp
00022e  4620              MOV      r0,r4
000230  f7fffffe          BL       lc640_write_long_ptr
;;;186    
;;;187    data[0]=0;
;;;188    data[1]=0;
;;;189    data[2]=0;
;;;190    data[3]=0;
000234  9600              STR      r6,[sp,#0]
;;;191    lc640_write_long_ptr(lc640_adr+4,data);
000236  4669              MOV      r1,sp
000238  1d20              ADDS     r0,r4,#4
00023a  f7fffffe          BL       lc640_write_long_ptr
;;;192    
;;;193    data[0]=LPC_RTC->YEAR;
00023e  4d7d              LDR      r5,|L1.1076|
000240  8ba8              LDRH     r0,[r5,#0x1c]
000242  f88d0000          STRB     r0,[sp,#0]
;;;194    data[1]=LPC_RTC->MONTH;
000246  7e28              LDRB     r0,[r5,#0x18]
000248  f88d0001          STRB     r0,[sp,#1]
;;;195    data[2]=LPC_RTC->DOM;
00024c  7b28              LDRB     r0,[r5,#0xc]
00024e  f88d0002          STRB     r0,[sp,#2]
;;;196    data[3]=0;
000252  f88d6003          STRB     r6,[sp,#3]
;;;197    lc640_write_long_ptr(lc640_adr+8,data);
000256  4669              MOV      r1,sp
000258  f1040008          ADD      r0,r4,#8
00025c  f7fffffe          BL       lc640_write_long_ptr
;;;198    
;;;199    data[0]=LPC_RTC->HOUR;
000260  7a28              LDRB     r0,[r5,#8]
000262  f88d0000          STRB     r0,[sp,#0]
;;;200    data[1]=LPC_RTC->MIN;
000266  7928              LDRB     r0,[r5,#4]
000268  f88d0001          STRB     r0,[sp,#1]
;;;201    data[2]=LPC_RTC->SEC;
00026c  7828              LDRB     r0,[r5,#0]
00026e  f88d0002          STRB     r0,[sp,#2]
;;;202    data[3]=LPC_SC->RSID;
000272  4871              LDR      r0,|L1.1080|
000274  f8d00180          LDR      r0,[r0,#0x180]
000278  f88d0003          STRB     r0,[sp,#3]
;;;203    
;;;204    lc640_write_long_ptr(lc640_adr+12,data);
00027c  4669              MOV      r1,sp
00027e  f104000c          ADD      r0,r4,#0xc
000282  f7fffffe          BL       lc640_write_long_ptr
;;;205    	
;;;206    data[0]='A';
000286  2541              MOVS     r5,#0x41
000288  f88d5000          STRB     r5,[sp,#0]
;;;207    data[1]='A';
00028c  f88d5001          STRB     r5,[sp,#1]
;;;208    data[2]='A';
000290  f88d5002          STRB     r5,[sp,#2]
;;;209    data[3]='A';
000294  f88d5003          STRB     r5,[sp,#3]
;;;210    lc640_write_long_ptr(lc640_adr+16,data);
000298  4669              MOV      r1,sp
00029a  f1040010          ADD      r0,r4,#0x10
00029e  f7fffffe          BL       lc640_write_long_ptr
;;;211    	
;;;212    data[0]='A';
0002a2  f88d5000          STRB     r5,[sp,#0]
;;;213    data[1]='A';
0002a6  f88d5001          STRB     r5,[sp,#1]
;;;214    data[2]='A';
0002aa  f88d5002          STRB     r5,[sp,#2]
;;;215    data[3]='A';
0002ae  f88d5003          STRB     r5,[sp,#3]
;;;216    lc640_write_long_ptr(lc640_adr+20,data);
0002b2  4669              MOV      r1,sp
0002b4  f1040014          ADD      r0,r4,#0x14
0002b8  f7fffffe          BL       lc640_write_long_ptr
;;;217    	
;;;218    data[0]='A';
0002bc  f88d5000          STRB     r5,[sp,#0]
;;;219    data[1]='A';
0002c0  f88d5001          STRB     r5,[sp,#1]
;;;220    data[2]='A';
0002c4  f88d5002          STRB     r5,[sp,#2]
;;;221    data[3]='A';
0002c8  f88d5003          STRB     r5,[sp,#3]
;;;222    lc640_write_long_ptr(lc640_adr+24,data);
0002cc  4669              MOV      r1,sp
0002ce  f1040018          ADD      r0,r4,#0x18
0002d2  f7fffffe          BL       lc640_write_long_ptr
;;;223    	
;;;224    data[0]='A';
0002d6  f88d5000          STRB     r5,[sp,#0]
;;;225    data[1]='A';
0002da  f88d5001          STRB     r5,[sp,#1]
;;;226    data[2]='A';
0002de  f88d5002          STRB     r5,[sp,#2]
;;;227    data[3]='A';
0002e2  f88d5003          STRB     r5,[sp,#3]
;;;228    lc640_write_long_ptr(lc640_adr+28,data);				
0002e6  4669              MOV      r1,sp
0002e8  f104001c          ADD      r0,r4,#0x1c
0002ec  f7fffffe          BL       lc640_write_long_ptr
;;;229    	
;;;230    	
;;;231    }
0002f0  bdf8              POP      {r3-r7,pc}
;;;232    
                          ENDP

                  avar_unet_hndl PROC
;;;233    //-----------------------------------------------
;;;234    void avar_unet_hndl(char in)
0002f2  e92d43f8          PUSH     {r3-r9,lr}
;;;235    {
;;;236    
;;;237    char data[4];
;;;238    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;239    
;;;240    
;;;241    if(in==1)
;;;242    	{
;;;243    	net_av=1;
;;;244    
;;;245    	//beep_init(0x01L,'O');
;;;246    	//a.av.bAN=1;
;;;247    
;;;248    
;;;249    	//beep_init(0x33333333,'A');
;;;250    	 
;;;251    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;252    	event_ptr++;	
;;;253    	if(event_ptr>63)event_ptr=0;	
;;;254    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;255    	
;;;256         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;257    	if(event_cnt!=63)event_cnt=event_ptr;
;;;258    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;259    	
;;;260    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;261    	
;;;262    	data[0]='P';
;;;263    	data[1]=0;
;;;264    	data[2]='A';
;;;265    	data[3]=0;
;;;266    	lc640_write_long_ptr(lc640_adr,data);
;;;267    
;;;268    	data[0]=0;//*((char*)&Unet_store);
;;;269    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;270    	data[2]=0;
;;;271    	data[3]=0;
;;;272    	lc640_write_long_ptr(lc640_adr+4,data);
;;;273    
;;;274    	data[0]=LPC_RTC->YEAR;
0002f6  4f4f              LDR      r7,|L1.1076|
0002f8  4941              LDR      r1,|L1.1024|
0002fa  3f20              SUBS     r7,r7,#0x20
0002fc  f44f6560          MOV      r5,#0xe00             ;251
000300  f04f0800          MOV      r8,#0                 ;253
000304  f44f6980          MOV      r9,#0x400             ;260
000308  2801              CMP      r0,#1                 ;241
00030a  d001              BEQ      |L1.784|
;;;275    	data[1]=LPC_RTC->MONTH;
;;;276    	data[2]=LPC_RTC->DOM;
;;;277    	data[3]=0;
;;;278    	lc640_write_long_ptr(lc640_adr+8,data);
;;;279    
;;;280    	data[0]=LPC_RTC->HOUR;
;;;281    	data[1]=LPC_RTC->MIN;
;;;282    	data[2]=LPC_RTC->SEC;
;;;283    	data[3]=0;
;;;284    	lc640_write_long_ptr(lc640_adr+12,data);
;;;285    	
;;;286    	data[0]='A';
;;;287    	data[1]='A';
;;;288    	data[2]='A';
;;;289    	data[3]='A';
;;;290    	lc640_write_long_ptr(lc640_adr+16,data);
;;;291    	
;;;292    	data[0]='A';
;;;293    	data[1]='A';
;;;294    	data[2]='A';
;;;295    	data[3]='A';
;;;296    	lc640_write_long_ptr(lc640_adr+20,data);
;;;297    	
;;;298    	data[0]='A';
;;;299    	data[1]='A';
;;;300    	data[2]='A';
;;;301    	data[3]='A';
;;;302    	lc640_write_long_ptr(lc640_adr+24,data);
;;;303    	
;;;304    	data[0]='A';
;;;305    	data[1]='A';
;;;306    	data[2]='A';
;;;307    	data[3]='A';
;;;308    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;309    	
;;;310    /*	memo_out0[0]=0x55;
;;;311         memo_out0[1]=0x00+2;
;;;312         memo_out0[2]=1;
;;;313         memo_out0[3]=0x0b;
;;;314         memo_out0[4]=0x55;
;;;315         memo_out0[5]=0x55; 
;;;316         	
;;;317         memo_out0[6]=crc_87(memo_out0,6);
;;;318    	memo_out0[7]=crc_95(memo_out0,6);
;;;319         usart_out_adr0(memo_out0,8); 
;;;320    	*/
;;;321    	snmp_trap_send("Main power alarm",2,1,0);
;;;322    	}
;;;323    
;;;324    else if(in==0)
00030c  b3f0              CBZ      r0,|L1.908|
00030e  e13d              B        |L1.1420|
                  |L1.784|
000310  2001              MOVS     r0,#1                 ;243
000312  7008              STRB     r0,[r1,#0]            ;243
000314  4628              MOV      r0,r5                 ;251
000316  f7fffffe          BL       lc640_read_int
00031a  1c44              ADDS     r4,r0,#1              ;252
00031c  2c3f              CMP      r4,#0x3f              ;253
00031e  d900              BLS      |L1.802|
000320  2400              MOVS     r4,#0                 ;253
                  |L1.802|
000322  b221              SXTH     r1,r4                 ;254
000324  4628              MOV      r0,r5                 ;254
000326  f7fffffe          BL       lc640_write_int
00032a  f6406602          MOV      r6,#0xe02             ;256
00032e  4630              MOV      r0,r6                 ;256
000330  f7fffffe          BL       lc640_read_int
000334  283f              CMP      r0,#0x3f              ;257
000336  d000              BEQ      |L1.826|
000338  4620              MOV      r0,r4                 ;257
                  |L1.826|
00033a  b201              SXTH     r1,r0                 ;258
00033c  4630              MOV      r0,r6                 ;258
00033e  f7fffffe          BL       lc640_write_int
000342  4628              MOV      r0,r5                 ;260
000344  f7fffffe          BL       lc640_read_int
000348  eb091540          ADD      r5,r9,r0,LSL #5       ;260
00034c  2050              MOVS     r0,#0x50              ;262
00034e  f88d0000          STRB     r0,[sp,#0]            ;262
000352  f88d8001          STRB     r8,[sp,#1]            ;263
000356  2441              MOVS     r4,#0x41              ;264
000358  f88d4002          STRB     r4,[sp,#2]            ;264
00035c  f88d8003          STRB     r8,[sp,#3]            ;265
000360  4669              MOV      r1,sp                 ;266
000362  4628              MOV      r0,r5                 ;266
000364  f7fffffe          BL       lc640_write_long_ptr
000368  f8cd8000          STR      r8,[sp,#0]            ;271
00036c  4669              MOV      r1,sp                 ;272
00036e  1d28              ADDS     r0,r5,#4              ;272
000370  f7fffffe          BL       lc640_write_long_ptr
000374  f1070720          ADD      r7,r7,#0x20           ;274
000378  8bb8              LDRH     r0,[r7,#0x1c]         ;274
00037a  f88d0000          STRB     r0,[sp,#0]            ;274
00037e  7e38              LDRB     r0,[r7,#0x18]         ;275
000380  f88d0001          STRB     r0,[sp,#1]            ;275
000384  7b38              LDRB     r0,[r7,#0xc]          ;276
000386  f88d0002          STRB     r0,[sp,#2]            ;276
00038a  e000              B        |L1.910|
                  |L1.908|
00038c  e071              B        |L1.1138|
                  |L1.910|
00038e  f88d8003          STRB     r8,[sp,#3]            ;277
000392  4669              MOV      r1,sp                 ;278
000394  f1050008          ADD      r0,r5,#8              ;278
000398  f7fffffe          BL       lc640_write_long_ptr
00039c  7a38              LDRB     r0,[r7,#8]            ;280
00039e  f88d0000          STRB     r0,[sp,#0]            ;280
0003a2  7938              LDRB     r0,[r7,#4]            ;281
0003a4  f88d0001          STRB     r0,[sp,#1]            ;281
0003a8  7838              LDRB     r0,[r7,#0]            ;282
0003aa  f88d0002          STRB     r0,[sp,#2]            ;282
0003ae  f88d8003          STRB     r8,[sp,#3]            ;283
0003b2  4669              MOV      r1,sp                 ;284
0003b4  f105000c          ADD      r0,r5,#0xc            ;284
0003b8  f7fffffe          BL       lc640_write_long_ptr
0003bc  f88d4000          STRB     r4,[sp,#0]            ;286
0003c0  f88d4001          STRB     r4,[sp,#1]            ;287
0003c4  f88d4002          STRB     r4,[sp,#2]            ;288
0003c8  f88d4003          STRB     r4,[sp,#3]            ;289
0003cc  4669              MOV      r1,sp                 ;290
0003ce  f1050010          ADD      r0,r5,#0x10           ;290
0003d2  f7fffffe          BL       lc640_write_long_ptr
0003d6  f88d4000          STRB     r4,[sp,#0]            ;292
0003da  f88d4001          STRB     r4,[sp,#1]            ;293
0003de  f88d4002          STRB     r4,[sp,#2]            ;294
0003e2  f88d4003          STRB     r4,[sp,#3]            ;295
0003e6  4669              MOV      r1,sp                 ;296
0003e8  f1050014          ADD      r0,r5,#0x14           ;296
0003ec  f7fffffe          BL       lc640_write_long_ptr
0003f0  f88d4000          STRB     r4,[sp,#0]            ;298
0003f4  f88d4001          STRB     r4,[sp,#1]            ;299
0003f8  f88d4002          STRB     r4,[sp,#2]            ;300
0003fc  e01e              B        |L1.1084|
0003fe  0000              DCW      0x0000
                  |L1.1024|
                          DCD      net_av
                  |L1.1028|
                          DCD      ||.data||
                  |L1.1032|
                          DCD      bat
                  |L1.1036|
                          DCD      bps
                  |L1.1040|
                          DCD      sk_av_stat
                  |L1.1044|
                          DCD      uout_av
                  |L1.1048|
                          DCD      SK_ZVUK_EN
                  |L1.1052|
                          DCD      AV_OFF_AVT
                  |L1.1056|
                          DCD      0xeffffffe
                  |L1.1060|
                          DCD      status_izm_r
                  |L1.1064|
                          DCD      sk_alarm
                  |L1.1068|
                          DCD      status_di1
                  |L1.1072|
                          DCD      status_di2
                  |L1.1076|
                          DCD      0x40024020
                  |L1.1080|
                          DCD      0x400fc000
                  |L1.1084|
00043c  f88d4003          STRB     r4,[sp,#3]            ;301
000440  4669              MOV      r1,sp                 ;302
000442  f1050018          ADD      r0,r5,#0x18           ;302
000446  f7fffffe          BL       lc640_write_long_ptr
00044a  f88d4000          STRB     r4,[sp,#0]            ;304
00044e  f88d4001          STRB     r4,[sp,#1]            ;305
000452  f88d4002          STRB     r4,[sp,#2]            ;306
000456  f88d4003          STRB     r4,[sp,#3]            ;307
00045a  4669              MOV      r1,sp                 ;308
00045c  f105001c          ADD      r0,r5,#0x1c           ;308
000460  f7fffffe          BL       lc640_write_long_ptr
000464  2300              MOVS     r3,#0                 ;321
000466  2201              MOVS     r2,#1                 ;321
000468  2102              MOVS     r1,#2                 ;321
00046a  a0f6              ADR      r0,|L1.2116|
00046c  f7fffffe          BL       snmp_trap_send
000470  e08c              B        |L1.1420|
                  |L1.1138|
;;;325    	{
;;;326    	net_av=0;
000472  f8818000          STRB     r8,[r1,#0]
;;;327    
;;;328      /*
;;;329    	SET_REG(C2GSR,3,24,8);
;;;330    	C2MOD=0;
;;;331    	bOUT_FREE2=1;*/
;;;332    
;;;333    
;;;334    	//C2MOD=0;
;;;335    
;;;336    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;337    
;;;338         //beep_init(0x02L,'O');
;;;339    	//a_.av.bAN=0;
;;;340    	SET_REG(avar_stat,0,0,1);
000476  48f8              LDR      r0,|L1.2136|
000478  6801              LDR      r1,[r0,#0]  ; avar_stat
00047a  f0210101          BIC      r1,r1,#1
00047e  6001              STR      r1,[r0,#0]  ; avar_stat
;;;341    
;;;342    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;343    	
;;;344    	if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
000480  49f6              LDR      r1,|L1.2140|
000482  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
000484  b119              CBZ      r1,|L1.1166|
000486  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
000488  f0210101          BIC      r1,r1,#1
00048c  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.1166|
;;;345    
;;;346         event_ptr=lc640_read_int(PTR_EVENT_LOG);
00048e  4628              MOV      r0,r5
000490  f7fffffe          BL       lc640_read_int
000494  4606              MOV      r6,r0
;;;347    	event_ptr_find=event_ptr;
000496  4634              MOV      r4,r6
                  |L1.1176|
;;;348    avar_unet_hndl_lbl1:
;;;349    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000498  eb091544          ADD      r5,r9,r4,LSL #5
;;;350    
;;;351         lc640_read_long_ptr(lc640_adr,data);
00049c  4669              MOV      r1,sp
00049e  4628              MOV      r0,r5
0004a0  f7fffffe          BL       lc640_read_long_ptr
;;;352         
;;;353         if(!((data[0]=='P')&&(data[1]==0)&&(data[2]=='A')))
0004a4  f89d0000          LDRB     r0,[sp,#0]
0004a8  2850              CMP      r0,#0x50
0004aa  d106              BNE      |L1.1210|
0004ac  f89d0001          LDRB     r0,[sp,#1]
0004b0  b918              CBNZ     r0,|L1.1210|
0004b2  f89d0002          LDRB     r0,[sp,#2]
0004b6  2841              CMP      r0,#0x41
0004b8  d006              BEQ      |L1.1224|
                  |L1.1210|
;;;354         	{        
;;;355         	if(event_ptr_find)event_ptr_find--;
0004ba  b10c              CBZ      r4,|L1.1216|
0004bc  1e64              SUBS     r4,r4,#1
0004be  e000              B        |L1.1218|
                  |L1.1216|
;;;356         	else event_ptr_find=63;
0004c0  243f              MOVS     r4,#0x3f
                  |L1.1218|
;;;357         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0004c2  42b4              CMP      r4,r6
0004c4  d1e8              BNE      |L1.1176|
0004c6  e061              B        |L1.1420|
                  |L1.1224|
;;;358         	else goto avar_unet_hndl_lbl1;
;;;359         	}
;;;360         else 
;;;361         	{
;;;362         	lc640_read_long_ptr(lc640_adr+16,data);
0004c8  4669              MOV      r1,sp
0004ca  f1050010          ADD      r0,r5,#0x10
0004ce  f7fffffe          BL       lc640_read_long_ptr
;;;363         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0004d2  f89d0000          LDRB     r0,[sp,#0]
0004d6  2841              CMP      r0,#0x41
0004d8  d10b              BNE      |L1.1266|
0004da  f89d0001          LDRB     r0,[sp,#1]
0004de  2841              CMP      r0,#0x41
0004e0  d107              BNE      |L1.1266|
0004e2  f89d0002          LDRB     r0,[sp,#2]
0004e6  2841              CMP      r0,#0x41
0004e8  d103              BNE      |L1.1266|
0004ea  f89d0003          LDRB     r0,[sp,#3]
0004ee  2841              CMP      r0,#0x41
0004f0  d006              BEQ      |L1.1280|
                  |L1.1266|
;;;364         		{        
;;;365         		if(event_ptr_find)event_ptr_find--;
0004f2  b10c              CBZ      r4,|L1.1272|
0004f4  1e64              SUBS     r4,r4,#1
0004f6  e000              B        |L1.1274|
                  |L1.1272|
;;;366             		else event_ptr_find=63;
0004f8  243f              MOVS     r4,#0x3f
                  |L1.1274|
;;;367             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0004fa  42b4              CMP      r4,r6
0004fc  d1cc              BNE      |L1.1176|
0004fe  e045              B        |L1.1420|
                  |L1.1280|
;;;368         		else goto avar_unet_hndl_lbl1;
;;;369         		}
;;;370    
;;;371         	}	
;;;372    	
;;;373    	data[0]=LPC_RTC->YEAR;
000500  f1070720          ADD      r7,r7,#0x20
000504  8bb8              LDRH     r0,[r7,#0x1c]
000506  f88d0000          STRB     r0,[sp,#0]
;;;374    	data[1]=LPC_RTC->MONTH;
00050a  7e38              LDRB     r0,[r7,#0x18]
00050c  f88d0001          STRB     r0,[sp,#1]
;;;375    	data[2]=LPC_RTC->DOM;
000510  7b38              LDRB     r0,[r7,#0xc]
000512  f88d0002          STRB     r0,[sp,#2]
;;;376    	data[3]=0;
000516  f88d8003          STRB     r8,[sp,#3]
;;;377    	lc640_write_long_ptr(lc640_adr+16,data);
00051a  4669              MOV      r1,sp
00051c  f1050010          ADD      r0,r5,#0x10
000520  f7fffffe          BL       lc640_write_long_ptr
;;;378    
;;;379    	data[0]=LPC_RTC->HOUR;
000524  7a38              LDRB     r0,[r7,#8]
000526  f88d0000          STRB     r0,[sp,#0]
;;;380    	data[1]=LPC_RTC->MIN;
00052a  7938              LDRB     r0,[r7,#4]
00052c  f88d0001          STRB     r0,[sp,#1]
;;;381    	data[2]=LPC_RTC->SEC;
000530  7838              LDRB     r0,[r7,#0]
000532  f88d0002          STRB     r0,[sp,#2]
;;;382    	data[3]=0;
000536  f88d8003          STRB     r8,[sp,#3]
;;;383    	lc640_write_long_ptr(lc640_adr+20,data); 
00053a  4669              MOV      r1,sp
00053c  f1050014          ADD      r0,r5,#0x14
000540  f7fffffe          BL       lc640_write_long_ptr
;;;384    	
;;;385    	data[0]=*((char*)(&net_Ustore));
000544  48c6              LDR      r0,|L1.2144|
000546  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000548  f88d1000          STRB     r1,[sp,#0]
;;;386    	data[1]=*(((char*)(&net_Ustore))+1);
00054c  7840              LDRB     r0,[r0,#1]  ; net_Ustore
00054e  f88d0001          STRB     r0,[sp,#1]
;;;387    	data[2]='B';
000552  2442              MOVS     r4,#0x42
000554  f88d4002          STRB     r4,[sp,#2]
;;;388    	data[3]='B';
000558  f88d4003          STRB     r4,[sp,#3]
;;;389    	lc640_write_long_ptr(lc640_adr+24,data);
00055c  4669              MOV      r1,sp
00055e  f1050018          ADD      r0,r5,#0x18
000562  f7fffffe          BL       lc640_write_long_ptr
;;;390    	
;;;391    	data[0]='B';
000566  f88d4000          STRB     r4,[sp,#0]
;;;392    	data[1]='B';
00056a  f88d4001          STRB     r4,[sp,#1]
;;;393    	data[2]='B';
00056e  f88d4002          STRB     r4,[sp,#2]
;;;394    	data[3]='B';
000572  f88d4003          STRB     r4,[sp,#3]
;;;395    	lc640_write_long_ptr(lc640_adr+28,data);	
000576  4669              MOV      r1,sp
000578  f105001c          ADD      r0,r5,#0x1c
00057c  f7fffffe          BL       lc640_write_long_ptr
;;;396    	
;;;397    /*	memo_out0[0]=0x55;
;;;398         memo_out0[1]=0x00+2;
;;;399         memo_out0[2]=1;
;;;400         memo_out0[3]=0x0b;
;;;401         memo_out0[4]=0xaa;
;;;402         memo_out0[5]=0xaa; 
;;;403         	
;;;404         memo_out0[6]=crc_87(memo_out0,6);
;;;405    	memo_out0[7]=crc_95(memo_out0,6);
;;;406         usart_out_adr0(memo_out0,8); */
;;;407         snmp_trap_send("Main power alarm  clear",2,1,1);	
000580  2301              MOVS     r3,#1
000582  461a              MOV      r2,r3
000584  2102              MOVS     r1,#2
000586  a0b7              ADR      r0,|L1.2148|
000588  f7fffffe          BL       snmp_trap_send
                  |L1.1420|
;;;408    	}
;;;409    avar_unet_hndl_end:
;;;410    	__nop();		
00058c  bf00              NOP      
                  |L1.1422|
;;;411    }
00058e  e8bd83f8          POP      {r3-r9,pc}
;;;412    
                          ENDP

                  avar_uout_hndl PROC
;;;414    //-----------------------------------------------
;;;415    void avar_uout_hndl(char in)
000592  e92d43f8          PUSH     {r3-r9,lr}
;;;416    {
;;;417    
;;;418    char data[4];
;;;419    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;420    
;;;421    
;;;422    if(in==1)
;;;423    	{
;;;424    	//net_av=1;
;;;425    
;;;426    	//beep_init(0x01L,'O');
;;;427    	//a.av.bAN=1;
;;;428    
;;;429    
;;;430    	//beep_init(0x33333333,'A');
;;;431    
;;;432    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;433    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;434    		 
;;;435    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;436    	event_ptr++;	
;;;437    	if(event_ptr>63)event_ptr=0;	
;;;438    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;439    	
;;;440        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;441    	if(event_cnt!=63)event_cnt=event_ptr;
;;;442    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;443    	
;;;444    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;445    	
;;;446    	data[0]='Q';
;;;447    	data[1]=0;
;;;448    	data[2]='A';
;;;449    	data[3]=0;
;;;450    	lc640_write_long_ptr(lc640_adr,data);
;;;451    
;;;452    	data[0]=0;//*((char*)&Unet_store);
;;;453    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;454    	data[2]=0;
;;;455    	data[3]=0;
;;;456    	lc640_write_long_ptr(lc640_adr+4,data);
;;;457    
;;;458    	data[0]=LPC_RTC->YEAR;
000596  4fb9              LDR      r7,|L1.2172|
000598  49b9              LDR      r1,|L1.2176|
00059a  f44f6560          MOV      r5,#0xe00             ;435
00059e  f04f0800          MOV      r8,#0                 ;437
0005a2  f44f6980          MOV      r9,#0x400             ;444
0005a6  2801              CMP      r0,#1                 ;422
0005a8  d001              BEQ      |L1.1454|
;;;459    	data[1]=LPC_RTC->MONTH;
;;;460    	data[2]=LPC_RTC->DOM;
;;;461    	data[3]=0;
;;;462    	lc640_write_long_ptr(lc640_adr+8,data);
;;;463    
;;;464    	data[0]=LPC_RTC->HOUR;
;;;465    	data[1]=LPC_RTC->MIN;
;;;466    	data[2]=LPC_RTC->SEC;
;;;467    	data[3]=0;
;;;468    	lc640_write_long_ptr(lc640_adr+12,data);
;;;469    	
;;;470    	data[0]='A';
;;;471    	data[1]='A';
;;;472    	data[2]='A';
;;;473    	data[3]='A';
;;;474    	lc640_write_long_ptr(lc640_adr+16,data);
;;;475    	
;;;476    	data[0]='A';
;;;477    	data[1]='A';
;;;478    	data[2]='A';
;;;479    	data[3]='A';
;;;480    	lc640_write_long_ptr(lc640_adr+20,data);
;;;481    	
;;;482    	data[0]='A';
;;;483    	data[1]='A';
;;;484    	data[2]='A';
;;;485    	data[3]='A';
;;;486    	lc640_write_long_ptr(lc640_adr+24,data);
;;;487    	
;;;488    	data[0]='A';
;;;489    	data[1]='A';
;;;490    	data[2]='A';
;;;491    	data[3]='A';
;;;492    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;493    	
;;;494    /*	memo_out0[0]=0x55;
;;;495         memo_out0[1]=0x00+2;
;;;496         memo_out0[2]=1;
;;;497         memo_out0[3]=0x0b;
;;;498         memo_out0[4]=0x55;
;;;499         memo_out0[5]=0x55; 
;;;500         	
;;;501         memo_out0[6]=crc_87(memo_out0,6);
;;;502    	memo_out0[7]=crc_95(memo_out0,6);
;;;503         usart_out_adr0(memo_out0,8); 
;;;504    	*/
;;;505    	//snmp_trap_send("Main power is off",2,1,0);
;;;506    	}
;;;507    
;;;508    else if(in==0)
0005aa  b3f0              CBZ      r0,|L1.1578|
0005ac  e11a              B        |L1.2020|
                  |L1.1454|
0005ae  48b5              LDR      r0,|L1.2180|
0005b0  4ab5              LDR      r2,|L1.2184|
0005b2  f9b00000          LDRSH    r0,[r0,#0]            ;432  ; load_U
0005b6  f9b22000          LDRSH    r2,[r2,#0]            ;432  ; U_OUT_KONTR_MAX
0005ba  4290              CMP      r0,r2                 ;432
0005bc  dd01              BLE      |L1.1474|
0005be  2201              MOVS     r2,#1                 ;432
0005c0  700a              STRB     r2,[r1,#0]            ;432
                  |L1.1474|
0005c2  4ab2              LDR      r2,|L1.2188|
0005c4  f9b22000          LDRSH    r2,[r2,#0]            ;433  ; U_OUT_KONTR_MIN
0005c8  4290              CMP      r0,r2                 ;433
0005ca  da01              BGE      |L1.1488|
0005cc  2002              MOVS     r0,#2                 ;433
0005ce  7008              STRB     r0,[r1,#0]            ;433
                  |L1.1488|
0005d0  4628              MOV      r0,r5                 ;435
0005d2  f7fffffe          BL       lc640_read_int
0005d6  1c44              ADDS     r4,r0,#1              ;436
0005d8  2c3f              CMP      r4,#0x3f              ;437
0005da  d900              BLS      |L1.1502|
0005dc  2400              MOVS     r4,#0                 ;437
                  |L1.1502|
0005de  b221              SXTH     r1,r4                 ;438
0005e0  4628              MOV      r0,r5                 ;438
0005e2  f7fffffe          BL       lc640_write_int
0005e6  f6406602          MOV      r6,#0xe02             ;440
0005ea  4630              MOV      r0,r6                 ;440
0005ec  f7fffffe          BL       lc640_read_int
0005f0  283f              CMP      r0,#0x3f              ;441
0005f2  d000              BEQ      |L1.1526|
0005f4  4620              MOV      r0,r4                 ;441
                  |L1.1526|
0005f6  b201              SXTH     r1,r0                 ;442
0005f8  4630              MOV      r0,r6                 ;442
0005fa  f7fffffe          BL       lc640_write_int
0005fe  4628              MOV      r0,r5                 ;444
000600  f7fffffe          BL       lc640_read_int
000604  eb091540          ADD      r5,r9,r0,LSL #5       ;444
000608  2051              MOVS     r0,#0x51              ;446
00060a  f88d0000          STRB     r0,[sp,#0]            ;446
00060e  f88d8001          STRB     r8,[sp,#1]            ;447
000612  2441              MOVS     r4,#0x41              ;448
000614  f88d4002          STRB     r4,[sp,#2]            ;448
000618  f88d8003          STRB     r8,[sp,#3]            ;449
00061c  4669              MOV      r1,sp                 ;450
00061e  4628              MOV      r0,r5                 ;450
000620  f7fffffe          BL       lc640_write_long_ptr
000624  f8cd8000          STR      r8,[sp,#0]            ;455
000628  e000              B        |L1.1580|
                  |L1.1578|
00062a  e05a              B        |L1.1762|
                  |L1.1580|
00062c  4669              MOV      r1,sp                 ;456
00062e  1d28              ADDS     r0,r5,#4              ;456
000630  f7fffffe          BL       lc640_write_long_ptr
000634  f1070720          ADD      r7,r7,#0x20           ;458
000638  8bb8              LDRH     r0,[r7,#0x1c]         ;458
00063a  f88d0000          STRB     r0,[sp,#0]            ;458
00063e  7e38              LDRB     r0,[r7,#0x18]         ;459
000640  f88d0001          STRB     r0,[sp,#1]            ;459
000644  7b38              LDRB     r0,[r7,#0xc]          ;460
000646  f88d0002          STRB     r0,[sp,#2]            ;460
00064a  f88d8003          STRB     r8,[sp,#3]            ;461
00064e  4669              MOV      r1,sp                 ;462
000650  f1050008          ADD      r0,r5,#8              ;462
000654  f7fffffe          BL       lc640_write_long_ptr
000658  7a38              LDRB     r0,[r7,#8]            ;464
00065a  f88d0000          STRB     r0,[sp,#0]            ;464
00065e  7938              LDRB     r0,[r7,#4]            ;465
000660  f88d0001          STRB     r0,[sp,#1]            ;465
000664  7838              LDRB     r0,[r7,#0]            ;466
000666  f88d0002          STRB     r0,[sp,#2]            ;466
00066a  f88d8003          STRB     r8,[sp,#3]            ;467
00066e  4669              MOV      r1,sp                 ;468
000670  f105000c          ADD      r0,r5,#0xc            ;468
000674  f7fffffe          BL       lc640_write_long_ptr
000678  f88d4000          STRB     r4,[sp,#0]            ;470
00067c  f88d4001          STRB     r4,[sp,#1]            ;471
000680  f88d4002          STRB     r4,[sp,#2]            ;472
000684  f88d4003          STRB     r4,[sp,#3]            ;473
000688  4669              MOV      r1,sp                 ;474
00068a  f1050010          ADD      r0,r5,#0x10           ;474
00068e  f7fffffe          BL       lc640_write_long_ptr
000692  f88d4000          STRB     r4,[sp,#0]            ;476
000696  f88d4001          STRB     r4,[sp,#1]            ;477
00069a  f88d4002          STRB     r4,[sp,#2]            ;478
00069e  f88d4003          STRB     r4,[sp,#3]            ;479
0006a2  4669              MOV      r1,sp                 ;480
0006a4  f1050014          ADD      r0,r5,#0x14           ;480
0006a8  f7fffffe          BL       lc640_write_long_ptr
0006ac  f88d4000          STRB     r4,[sp,#0]            ;482
0006b0  f88d4001          STRB     r4,[sp,#1]            ;483
0006b4  f88d4002          STRB     r4,[sp,#2]            ;484
0006b8  f88d4003          STRB     r4,[sp,#3]            ;485
0006bc  4669              MOV      r1,sp                 ;486
0006be  f1050018          ADD      r0,r5,#0x18           ;486
0006c2  f7fffffe          BL       lc640_write_long_ptr
0006c6  f88d4000          STRB     r4,[sp,#0]            ;488
0006ca  f88d4001          STRB     r4,[sp,#1]            ;489
0006ce  f88d4002          STRB     r4,[sp,#2]            ;490
0006d2  f88d4003          STRB     r4,[sp,#3]            ;491
0006d6  4669              MOV      r1,sp                 ;492
0006d8  f105001c          ADD      r0,r5,#0x1c           ;492
0006dc  f7fffffe          BL       lc640_write_long_ptr
0006e0  e080              B        |L1.2020|
                  |L1.1762|
;;;509    	{
;;;510    	uout_av=0;
0006e2  f8818000          STRB     r8,[r1,#0]
;;;511    
;;;512      /*
;;;513    	SET_REG(C2GSR,3,24,8);
;;;514    	C2MOD=0;
;;;515    	bOUT_FREE2=1;*/
;;;516    
;;;517    
;;;518    	//C2MOD=0;
;;;519    
;;;520    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;521    
;;;522         //beep_init(0x02L,'O');
;;;523    	//a_.av.bAN=0;
;;;524    //	SET_REG(avar_stat,0,0,1);
;;;525    
;;;526    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;527    	
;;;528    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;529    
;;;530        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0006e6  4628              MOV      r0,r5
0006e8  f7fffffe          BL       lc640_read_int
0006ec  4606              MOV      r6,r0
;;;531    	event_ptr_find=event_ptr;
0006ee  4634              MOV      r4,r6
                  |L1.1776|
;;;532    avar_uout_hndl_lbl1:
;;;533    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0006f0  eb091544          ADD      r5,r9,r4,LSL #5
;;;534    
;;;535         lc640_read_long_ptr(lc640_adr,data);
0006f4  4669              MOV      r1,sp
0006f6  4628              MOV      r0,r5
0006f8  f7fffffe          BL       lc640_read_long_ptr
;;;536         
;;;537         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
0006fc  f89d0000          LDRB     r0,[sp,#0]
000700  2851              CMP      r0,#0x51
000702  d106              BNE      |L1.1810|
000704  f89d0001          LDRB     r0,[sp,#1]
000708  b918              CBNZ     r0,|L1.1810|
00070a  f89d0002          LDRB     r0,[sp,#2]
00070e  2841              CMP      r0,#0x41
000710  d006              BEQ      |L1.1824|
                  |L1.1810|
;;;538         	{        
;;;539         	if(event_ptr_find)event_ptr_find--;
000712  b10c              CBZ      r4,|L1.1816|
000714  1e64              SUBS     r4,r4,#1
000716  e000              B        |L1.1818|
                  |L1.1816|
;;;540         	else event_ptr_find=63;
000718  243f              MOVS     r4,#0x3f
                  |L1.1818|
;;;541         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
00071a  42b4              CMP      r4,r6
00071c  d1e8              BNE      |L1.1776|
00071e  e061              B        |L1.2020|
                  |L1.1824|
;;;542         	else goto avar_uout_hndl_lbl1;
;;;543         	}
;;;544         else 
;;;545         	{
;;;546         	lc640_read_long_ptr(lc640_adr+16,data);
000720  4669              MOV      r1,sp
000722  f1050010          ADD      r0,r5,#0x10
000726  f7fffffe          BL       lc640_read_long_ptr
;;;547         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00072a  f89d0000          LDRB     r0,[sp,#0]
00072e  2841              CMP      r0,#0x41
000730  d10b              BNE      |L1.1866|
000732  f89d0001          LDRB     r0,[sp,#1]
000736  2841              CMP      r0,#0x41
000738  d107              BNE      |L1.1866|
00073a  f89d0002          LDRB     r0,[sp,#2]
00073e  2841              CMP      r0,#0x41
000740  d103              BNE      |L1.1866|
000742  f89d0003          LDRB     r0,[sp,#3]
000746  2841              CMP      r0,#0x41
000748  d006              BEQ      |L1.1880|
                  |L1.1866|
;;;548         		{        
;;;549         		if(event_ptr_find)event_ptr_find--;
00074a  b10c              CBZ      r4,|L1.1872|
00074c  1e64              SUBS     r4,r4,#1
00074e  e000              B        |L1.1874|
                  |L1.1872|
;;;550             		else event_ptr_find=63;
000750  243f              MOVS     r4,#0x3f
                  |L1.1874|
;;;551             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000752  42b4              CMP      r4,r6
000754  d1cc              BNE      |L1.1776|
000756  e045              B        |L1.2020|
                  |L1.1880|
;;;552         		else goto avar_uout_hndl_lbl1;
;;;553         		}
;;;554    
;;;555         	}	
;;;556    	
;;;557    	data[0]=LPC_RTC->YEAR;
000758  f1070720          ADD      r7,r7,#0x20
00075c  8bb8              LDRH     r0,[r7,#0x1c]
00075e  f88d0000          STRB     r0,[sp,#0]
;;;558    	data[1]=LPC_RTC->MONTH;
000762  7e38              LDRB     r0,[r7,#0x18]
000764  f88d0001          STRB     r0,[sp,#1]
;;;559    	data[2]=LPC_RTC->DOM;
000768  7b38              LDRB     r0,[r7,#0xc]
00076a  f88d0002          STRB     r0,[sp,#2]
;;;560    	data[3]=0;
00076e  f88d8003          STRB     r8,[sp,#3]
;;;561    	lc640_write_long_ptr(lc640_adr+16,data);
000772  4669              MOV      r1,sp
000774  f1050010          ADD      r0,r5,#0x10
000778  f7fffffe          BL       lc640_write_long_ptr
;;;562    
;;;563    	data[0]=LPC_RTC->HOUR;
00077c  7a38              LDRB     r0,[r7,#8]
00077e  f88d0000          STRB     r0,[sp,#0]
;;;564    	data[1]=LPC_RTC->MIN;
000782  7938              LDRB     r0,[r7,#4]
000784  f88d0001          STRB     r0,[sp,#1]
;;;565    	data[2]=LPC_RTC->SEC;
000788  7838              LDRB     r0,[r7,#0]
00078a  f88d0002          STRB     r0,[sp,#2]
;;;566    	data[3]=0;
00078e  f88d8003          STRB     r8,[sp,#3]
;;;567    	lc640_write_long_ptr(lc640_adr+20,data); 
000792  4669              MOV      r1,sp
000794  f1050014          ADD      r0,r5,#0x14
000798  f7fffffe          BL       lc640_write_long_ptr
;;;568    	
;;;569    	data[0]=*((char*)(&net_Ustore));
00079c  4830              LDR      r0,|L1.2144|
00079e  7801              LDRB     r1,[r0,#0]  ; net_Ustore
0007a0  f88d1000          STRB     r1,[sp,#0]
;;;570    	data[1]=*(((char*)(&net_Ustore))+1);
0007a4  7840              LDRB     r0,[r0,#1]  ; net_Ustore
0007a6  f88d0001          STRB     r0,[sp,#1]
;;;571    	data[2]='B';
0007aa  2442              MOVS     r4,#0x42
0007ac  f88d4002          STRB     r4,[sp,#2]
;;;572    	data[3]='B';
0007b0  f88d4003          STRB     r4,[sp,#3]
;;;573    	lc640_write_long_ptr(lc640_adr+24,data);
0007b4  4669              MOV      r1,sp
0007b6  f1050018          ADD      r0,r5,#0x18
0007ba  f7fffffe          BL       lc640_write_long_ptr
;;;574    	
;;;575    	data[0]='B';
0007be  f88d4000          STRB     r4,[sp,#0]
;;;576    	data[1]='B';
0007c2  f88d4001          STRB     r4,[sp,#1]
;;;577    	data[2]='B';
0007c6  f88d4002          STRB     r4,[sp,#2]
;;;578    	data[3]='B';
0007ca  f88d4003          STRB     r4,[sp,#3]
;;;579    	lc640_write_long_ptr(lc640_adr+28,data);	
0007ce  4669              MOV      r1,sp
0007d0  f105001c          ADD      r0,r5,#0x1c
0007d4  f7fffffe          BL       lc640_write_long_ptr
;;;580    	
;;;581    /*	memo_out0[0]=0x55;
;;;582         memo_out0[1]=0x00+2;
;;;583         memo_out0[2]=1;
;;;584         memo_out0[3]=0x0b;
;;;585         memo_out0[4]=0xaa;
;;;586         memo_out0[5]=0xaa; 
;;;587         	
;;;588         memo_out0[6]=crc_87(memo_out0,6);
;;;589    	memo_out0[7]=crc_95(memo_out0,6);
;;;590         usart_out_adr0(memo_out0,8); */
;;;591         snmp_trap_send("Main power is on",2,1,1);	
0007d8  2301              MOVS     r3,#1
0007da  461a              MOV      r2,r3
0007dc  2102              MOVS     r1,#2
0007de  a02c              ADR      r0,|L1.2192|
0007e0  f7fffffe          BL       snmp_trap_send
                  |L1.2020|
;;;592    	}
;;;593    avar_unet_hndl_end:
;;;594    	__nop();		
0007e4  bf00              NOP      
;;;595    }
0007e6  e6d2              B        |L1.1422|
;;;596    
                          ENDP

                  avar_bps_hndl PROC
;;;597    //-----------------------------------------------
;;;598    void avar_bps_hndl(char dev, char v, char in)
0007e8  e92d4ff8          PUSH     {r3-r11,lr}
;;;599    {
0007ec  4606              MOV      r6,r0
0007ee  460c              MOV      r4,r1
;;;600    char data[4];
;;;601    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;602    char avar_simbol;
;;;603    
;;;604    avar_simbol='T';
0007f0  2754              MOVS     r7,#0x54
;;;605    if(v==0)avar_simbol='T';
0007f2  b15c              CBZ      r4,|L1.2060|
;;;606    else if(v==1)avar_simbol='U';
0007f4  2c01              CMP      r4,#1
0007f6  d004              BEQ      |L1.2050|
;;;607    else if(v==2)avar_simbol='u';
0007f8  2c02              CMP      r4,#2
0007fa  d004              BEQ      |L1.2054|
;;;608    else if(v==3)avar_simbol='L';
0007fc  2c03              CMP      r4,#3
0007fe  d004              BEQ      |L1.2058|
000800  e004              B        |L1.2060|
                  |L1.2050|
000802  2755              MOVS     r7,#0x55              ;606
000804  e002              B        |L1.2060|
                  |L1.2054|
000806  2775              MOVS     r7,#0x75              ;607
000808  e000              B        |L1.2060|
                  |L1.2058|
00080a  274c              MOVS     r7,#0x4c
                  |L1.2060|
;;;609    
;;;610    if(in==1)
;;;611    	{
;;;612    	//av_src[bps]=1;
;;;613    
;;;614    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;615    //	SET_REG(avar_stat,1,3+dev,1);
;;;616    	
;;;617    	if(v==0)bps[dev]._av|=(1<<0);
00080c  4825              LDR      r0,|L1.2212|
00080e  ebc601c6          RSB      r1,r6,r6,LSL #3
;;;618    	else if(v==1) bps[dev]._av|=(1<<1);
;;;619    	else if(v==2) bps[dev]._av|=(1<<2);
;;;620    	else if(v==3) bps[dev]._av|=(1<<3);
;;;621    
;;;622    	bps[dev]._last_avar=v;
;;;623    
;;;624    	//beep_init(0x33333333,'A');
;;;625    
;;;626    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;627    	event_ptr++;	
;;;628    	if(event_ptr>63)event_ptr=0;	
;;;629    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;630    	
;;;631         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;632    	if(event_cnt!=63)event_cnt=event_ptr;
;;;633    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;634    	
;;;635    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;636    	
;;;637    	data[0]='S';
;;;638    	data[1]=dev; 
;;;639    	data[2]=avar_simbol;
;;;640    	data[3]=0;
;;;641    	lc640_write_long_ptr(lc640_adr,data);
;;;642    
;;;643    	data[0]=0;
;;;644    	data[1]=0;
;;;645    	data[2]=0;
;;;646    	data[3]=0;
;;;647    	lc640_write_long_ptr(lc640_adr+4,data);
;;;648    
;;;649    	data[0]=LPC_RTC->YEAR;
000812  f8df8068          LDR      r8,|L1.2172|
000816  eb011106          ADD      r1,r1,r6,LSL #4       ;617
00081a  f04f0900          MOV      r9,#0                 ;599
00081e  f44f6a60          MOV      r10,#0xe00            ;626
000822  f44f6580          MOV      r5,#0x400             ;635
000826  eb000081          ADD      r0,r0,r1,LSL #2       ;617
00082a  2a01              CMP      r2,#1                 ;610
00082c  d001              BEQ      |L1.2098|
;;;650    	data[1]=LPC_RTC->MONTH;
;;;651    	data[2]=LPC_RTC->DOM;
;;;652    	data[3]=0;
;;;653    	lc640_write_long_ptr(lc640_adr+8,data);
;;;654    
;;;655    	data[0]=LPC_RTC->HOUR;
;;;656    	data[1]=LPC_RTC->MIN;
;;;657    	data[2]=LPC_RTC->SEC;
;;;658    	data[3]=0;
;;;659    	lc640_write_long_ptr(lc640_adr+12,data);
;;;660    	
;;;661    	data[0]='A';
;;;662    	data[1]='A';
;;;663    	data[2]='A';
;;;664    	data[3]='A';
;;;665    	lc640_write_long_ptr(lc640_adr+16,data);
;;;666    	
;;;667    	data[0]='A';
;;;668    	data[1]='A';
;;;669    	data[2]='A';
;;;670    	data[3]='A';
;;;671    	lc640_write_long_ptr(lc640_adr+20,data);
;;;672    	
;;;673    	data[0]='A';
;;;674    	data[1]='A';
;;;675    	data[2]='A';
;;;676    	data[3]='A';
;;;677    	lc640_write_long_ptr(lc640_adr+24,data);
;;;678    	
;;;679    	data[0]='A';
;;;680    	data[1]='A';
;;;681    	data[2]='A';
;;;682    	data[3]='A';
;;;683    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;684    
;;;685    
;;;686    	if(dev==0)
;;;687    		{
;;;688    		if(v==0)
;;;689    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;690    		else if(v==1)
;;;691    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;692    		else if(v==2)
;;;693    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;694    		else if(v==3)
;;;695    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;696    		}
;;;697    	else if(dev==1)
;;;698    		{
;;;699    		if(v==0)
;;;700    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;701    		else if(v==1)
;;;702    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;703    		else if(v==2)
;;;704    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;705    		else if(v==3)
;;;706    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;707    		} 
;;;708    	else if(dev==2)
;;;709    		{
;;;710    		if(v==0)
;;;711    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;712    		else if(v==1)
;;;713    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;714    		else if(v==2)
;;;715    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;716    		else if(v==3)
;;;717    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;718    		} 	
;;;719    			
;;;720    	}
;;;721    
;;;722    else if(in==0)
00082e  b142              CBZ      r2,|L1.2114|
000830  e1ee              B        |L1.3088|
                  |L1.2098|
000832  b3cc              CBZ      r4,|L1.2216|
000834  2c01              CMP      r4,#1                 ;618
000836  d03d              BEQ      |L1.2228|
000838  2c02              CMP      r4,#2                 ;619
00083a  d040              BEQ      |L1.2238|
00083c  2c03              CMP      r4,#3                 ;620
00083e  d043              BEQ      |L1.2248|
000840  e046              B        |L1.2256|
                  |L1.2114|
000842  e14a              B        |L1.2778|
                  |L1.2116|
000844  4d61696e          DCB      "Main power alarm",0
000848  20706f77
00084c  65722061
000850  6c61726d
000854  00      
000855  00                DCB      0
000856  00                DCB      0
000857  00                DCB      0
                  |L1.2136|
                          DCD      ||.data||
                  |L1.2140|
                          DCD      AV_OFF_AVT
                  |L1.2144|
                          DCD      net_Ustore
                  |L1.2148|
000864  4d61696e          DCB      "Main power alarm  clear",0
000868  20706f77
00086c  65722061
000870  6c61726d
000874  2020636c
000878  65617200
                  |L1.2172|
                          DCD      0x40024000
                  |L1.2176|
                          DCD      uout_av
                  |L1.2180|
                          DCD      load_U
                  |L1.2184|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2188|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2192|
000890  4d61696e          DCB      "Main power is on",0
000894  20706f77
000898  65722069
00089c  73206f6e
0008a0  00      
0008a1  00                DCB      0
0008a2  00                DCB      0
0008a3  00                DCB      0
                  |L1.2212|
                          DCD      bps
                  |L1.2216|
0008a8  e7ff              B        |L1.2218|
                  |L1.2218|
0008aa  7841              LDRB     r1,[r0,#1]            ;617
0008ac  f0410101          ORR      r1,r1,#1              ;617
0008b0  7041              STRB     r1,[r0,#1]            ;617
0008b2  e00d              B        |L1.2256|
                  |L1.2228|
0008b4  7841              LDRB     r1,[r0,#1]            ;618
0008b6  f0410102          ORR      r1,r1,#2              ;618
0008ba  7041              STRB     r1,[r0,#1]            ;618
0008bc  e008              B        |L1.2256|
                  |L1.2238|
0008be  7841              LDRB     r1,[r0,#1]            ;619
0008c0  f0410104          ORR      r1,r1,#4              ;619
0008c4  7041              STRB     r1,[r0,#1]            ;619
0008c6  e003              B        |L1.2256|
                  |L1.2248|
0008c8  7841              LDRB     r1,[r0,#1]            ;620
0008ca  f0410108          ORR      r1,r1,#8              ;620
0008ce  7041              STRB     r1,[r0,#1]            ;620
                  |L1.2256|
0008d0  f8804053          STRB     r4,[r0,#0x53]         ;622
0008d4  4650              MOV      r0,r10                ;626
0008d6  f7fffffe          BL       lc640_read_int
0008da  1c40              ADDS     r0,r0,#1              ;627
0008dc  fa1ffb80          UXTH     r11,r0                ;627
0008e0  f1bb0f3f          CMP      r11,#0x3f             ;628
0008e4  d901              BLS      |L1.2282|
0008e6  f04f0b00          MOV      r11,#0                ;628
                  |L1.2282|
0008ea  fa0ff18b          SXTH     r1,r11                ;629
0008ee  4650              MOV      r0,r10                ;629
0008f0  f7fffffe          BL       lc640_write_int
0008f4  f6406002          MOV      r0,#0xe02             ;631
0008f8  f7fffffe          BL       lc640_read_int
0008fc  b280              UXTH     r0,r0                 ;631
0008fe  283f              CMP      r0,#0x3f              ;632
000900  d000              BEQ      |L1.2308|
000902  4658              MOV      r0,r11                ;632
                  |L1.2308|
000904  b201              SXTH     r1,r0                 ;633
000906  f6406002          MOV      r0,#0xe02             ;633
00090a  f7fffffe          BL       lc640_write_int
00090e  4650              MOV      r0,r10                ;635
000910  f7fffffe          BL       lc640_read_int
000914  eb051040          ADD      r0,r5,r0,LSL #5       ;635
000918  b285              UXTH     r5,r0                 ;635
00091a  2053              MOVS     r0,#0x53              ;637
00091c  f88d0000          STRB     r0,[sp,#0]            ;637
000920  f88d6001          STRB     r6,[sp,#1]            ;638
000924  f88d7002          STRB     r7,[sp,#2]            ;639
000928  f88d9003          STRB     r9,[sp,#3]            ;640
00092c  4669              MOV      r1,sp                 ;641
00092e  4628              MOV      r0,r5                 ;641
000930  f7fffffe          BL       lc640_write_long_ptr
000934  f8cd9000          STR      r9,[sp,#0]            ;646
000938  4669              MOV      r1,sp                 ;647
00093a  1d28              ADDS     r0,r5,#4              ;647
00093c  f7fffffe          BL       lc640_write_long_ptr
000940  f8b8003c          LDRH     r0,[r8,#0x3c]         ;649
000944  f88d0000          STRB     r0,[sp,#0]            ;649
000948  f8980038          LDRB     r0,[r8,#0x38]         ;650
00094c  f88d0001          STRB     r0,[sp,#1]            ;650
000950  f898002c          LDRB     r0,[r8,#0x2c]         ;651
000954  f88d0002          STRB     r0,[sp,#2]            ;651
000958  f88d9003          STRB     r9,[sp,#3]            ;652
00095c  4669              MOV      r1,sp                 ;653
00095e  f1050008          ADD      r0,r5,#8              ;653
000962  f7fffffe          BL       lc640_write_long_ptr
000966  f8980028          LDRB     r0,[r8,#0x28]         ;655
00096a  f88d0000          STRB     r0,[sp,#0]            ;655
00096e  f8980024          LDRB     r0,[r8,#0x24]         ;656
000972  f88d0001          STRB     r0,[sp,#1]            ;656
000976  f8980020          LDRB     r0,[r8,#0x20]         ;657
00097a  f88d0002          STRB     r0,[sp,#2]            ;657
00097e  f88d9003          STRB     r9,[sp,#3]            ;658
000982  4669              MOV      r1,sp                 ;659
000984  f105000c          ADD      r0,r5,#0xc            ;659
000988  f7fffffe          BL       lc640_write_long_ptr
00098c  2741              MOVS     r7,#0x41              ;661
00098e  f88d7000          STRB     r7,[sp,#0]            ;661
000992  f88d7001          STRB     r7,[sp,#1]            ;662
000996  f88d7002          STRB     r7,[sp,#2]            ;663
00099a  f88d7003          STRB     r7,[sp,#3]            ;664
00099e  4669              MOV      r1,sp                 ;665
0009a0  f1050010          ADD      r0,r5,#0x10           ;665
0009a4  f7fffffe          BL       lc640_write_long_ptr
0009a8  f88d7000          STRB     r7,[sp,#0]            ;667
0009ac  f88d7001          STRB     r7,[sp,#1]            ;668
0009b0  f88d7002          STRB     r7,[sp,#2]            ;669
0009b4  f88d7003          STRB     r7,[sp,#3]            ;670
0009b8  4669              MOV      r1,sp                 ;671
0009ba  f1050014          ADD      r0,r5,#0x14           ;671
0009be  f7fffffe          BL       lc640_write_long_ptr
0009c2  f88d7000          STRB     r7,[sp,#0]            ;673
0009c6  f88d7001          STRB     r7,[sp,#1]            ;674
0009ca  f88d7002          STRB     r7,[sp,#2]            ;675
0009ce  f88d7003          STRB     r7,[sp,#3]            ;676
0009d2  4669              MOV      r1,sp                 ;677
0009d4  f1050018          ADD      r0,r5,#0x18           ;677
0009d8  f7fffffe          BL       lc640_write_long_ptr
0009dc  f88d7000          STRB     r7,[sp,#0]            ;679
0009e0  f88d7001          STRB     r7,[sp,#1]            ;680
0009e4  f88d7002          STRB     r7,[sp,#2]            ;681
0009e8  f88d7003          STRB     r7,[sp,#3]            ;682
0009ec  4669              MOV      r1,sp                 ;683
0009ee  f105001c          ADD      r0,r5,#0x1c           ;683
0009f2  f7fffffe          BL       lc640_write_long_ptr
0009f6  b126              CBZ      r6,|L1.2562|
0009f8  2e01              CMP      r6,#1                 ;697
0009fa  d026              BEQ      |L1.2634|
0009fc  2e02              CMP      r6,#2                 ;708
0009fe  d048              BEQ      |L1.2706|
000a00  e106              B        |L1.3088|
                  |L1.2562|
000a02  b134              CBZ      r4,|L1.2578|
000a04  2c01              CMP      r4,#1                 ;690
000a06  d00b              BEQ      |L1.2592|
000a08  2c02              CMP      r4,#2                 ;692
000a0a  d010              BEQ      |L1.2606|
000a0c  2c03              CMP      r4,#3                 ;694
000a0e  d015              BEQ      |L1.2620|
000a10  e0fe              B        |L1.3088|
                  |L1.2578|
000a12  2300              MOVS     r3,#0                 ;689
000a14  2201              MOVS     r2,#1                 ;689
000a16  2104              MOVS     r1,#4                 ;689
000a18  a0de              ADR      r0,|L1.3476|
000a1a  f7fffffe          BL       snmp_trap_send
000a1e  e0f7              B        |L1.3088|
                  |L1.2592|
000a20  2301              MOVS     r3,#1                 ;691
000a22  461a              MOV      r2,r3                 ;691
000a24  2104              MOVS     r1,#4                 ;691
000a26  a0e1              ADR      r0,|L1.3500|
000a28  f7fffffe          BL       snmp_trap_send
000a2c  e0f0              B        |L1.3088|
                  |L1.2606|
000a2e  2302              MOVS     r3,#2                 ;693
000a30  2201              MOVS     r2,#1                 ;693
000a32  2104              MOVS     r1,#4                 ;693
000a34  a0e4              ADR      r0,|L1.3528|
000a36  f7fffffe          BL       snmp_trap_send
000a3a  e0e9              B        |L1.3088|
                  |L1.2620|
000a3c  2303              MOVS     r3,#3                 ;695
000a3e  2201              MOVS     r2,#1                 ;695
000a40  2104              MOVS     r1,#4                 ;695
000a42  a0e9              ADR      r0,|L1.3560|
000a44  f7fffffe          BL       snmp_trap_send
000a48  e0e2              B        |L1.3088|
                  |L1.2634|
000a4a  b134              CBZ      r4,|L1.2650|
000a4c  2c01              CMP      r4,#1                 ;701
000a4e  d00b              BEQ      |L1.2664|
000a50  2c02              CMP      r4,#2                 ;703
000a52  d010              BEQ      |L1.2678|
000a54  2c03              CMP      r4,#3                 ;705
000a56  d015              BEQ      |L1.2692|
000a58  e0da              B        |L1.3088|
                  |L1.2650|
000a5a  2300              MOVS     r3,#0                 ;700
000a5c  2202              MOVS     r2,#2                 ;700
000a5e  2104              MOVS     r1,#4                 ;700
000a60  a0e9              ADR      r0,|L1.3592|
000a62  f7fffffe          BL       snmp_trap_send
000a66  e0d3              B        |L1.3088|
                  |L1.2664|
000a68  2301              MOVS     r3,#1                 ;702
000a6a  2202              MOVS     r2,#2                 ;702
000a6c  2104              MOVS     r1,#4                 ;702
000a6e  a0ec              ADR      r0,|L1.3616|
000a70  f7fffffe          BL       snmp_trap_send
000a74  e0cc              B        |L1.3088|
                  |L1.2678|
000a76  2302              MOVS     r3,#2                 ;704
000a78  461a              MOV      r2,r3                 ;704
000a7a  2104              MOVS     r1,#4                 ;704
000a7c  a0ef              ADR      r0,|L1.3644|
000a7e  f7fffffe          BL       snmp_trap_send
000a82  e0c5              B        |L1.3088|
                  |L1.2692|
000a84  2303              MOVS     r3,#3                 ;706
000a86  2202              MOVS     r2,#2                 ;706
000a88  2104              MOVS     r1,#4                 ;706
000a8a  a0f4              ADR      r0,|L1.3676|
000a8c  f7fffffe          BL       snmp_trap_send
000a90  e0be              B        |L1.3088|
                  |L1.2706|
000a92  b134              CBZ      r4,|L1.2722|
000a94  2c01              CMP      r4,#1                 ;712
000a96  d00b              BEQ      |L1.2736|
000a98  2c02              CMP      r4,#2                 ;714
000a9a  d010              BEQ      |L1.2750|
000a9c  2c03              CMP      r4,#3                 ;716
000a9e  d015              BEQ      |L1.2764|
000aa0  e0b6              B        |L1.3088|
                  |L1.2722|
000aa2  2300              MOVS     r3,#0                 ;711
000aa4  2203              MOVS     r2,#3                 ;711
000aa6  2104              MOVS     r1,#4                 ;711
000aa8  a0f4              ADR      r0,|L1.3708|
000aaa  f7fffffe          BL       snmp_trap_send
000aae  e0af              B        |L1.3088|
                  |L1.2736|
000ab0  2301              MOVS     r3,#1                 ;713
000ab2  2203              MOVS     r2,#3                 ;713
000ab4  2104              MOVS     r1,#4                 ;713
000ab6  a0f7              ADR      r0,|L1.3732|
000ab8  f7fffffe          BL       snmp_trap_send
000abc  e0a8              B        |L1.3088|
                  |L1.2750|
000abe  2302              MOVS     r3,#2                 ;715
000ac0  2203              MOVS     r2,#3                 ;715
000ac2  2104              MOVS     r1,#4                 ;715
000ac4  a0fa              ADR      r0,|L1.3760|
000ac6  f7fffffe          BL       snmp_trap_send
000aca  e0a1              B        |L1.3088|
                  |L1.2764|
000acc  2303              MOVS     r3,#3                 ;717
000ace  461a              MOV      r2,r3                 ;717
000ad0  2104              MOVS     r1,#4                 ;717
000ad2  a0ff              ADR      r0,|L1.3792|
000ad4  f7fffffe          BL       snmp_trap_send
000ad8  e09a              B        |L1.3088|
                  |L1.2778|
;;;723    	{      
;;;724    //	av_bps[bps]=0;
;;;725    
;;;726    	//SET_REG(avar_stat,0,3+bps,1);
;;;727    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;728    
;;;729         if(v==0) bps[dev]._av&=(~(1<<0));
000ada  b134              CBZ      r4,|L1.2794|
;;;730         else if(v==1) bps[dev]._av&=(~(1<<1));
000adc  2c01              CMP      r4,#1
000ade  d009              BEQ      |L1.2804|
;;;731    	else if(v==2) bps[dev]._av&=(~(1<<2));
000ae0  2c02              CMP      r4,#2
000ae2  d00c              BEQ      |L1.2814|
;;;732    	else if(v==3) bps[dev]._av&=(~(1<<3));
000ae4  2c03              CMP      r4,#3
000ae6  d00f              BEQ      |L1.2824|
000ae8  e012              B        |L1.2832|
                  |L1.2794|
000aea  7841              LDRB     r1,[r0,#1]            ;729
000aec  f0210101          BIC      r1,r1,#1              ;729
000af0  7041              STRB     r1,[r0,#1]            ;729
000af2  e00d              B        |L1.2832|
                  |L1.2804|
000af4  7841              LDRB     r1,[r0,#1]            ;730
000af6  f0210102          BIC      r1,r1,#2              ;730
000afa  7041              STRB     r1,[r0,#1]            ;730
000afc  e008              B        |L1.2832|
                  |L1.2814|
000afe  7841              LDRB     r1,[r0,#1]            ;731
000b00  f0210104          BIC      r1,r1,#4              ;731
000b04  7041              STRB     r1,[r0,#1]            ;731
000b06  e003              B        |L1.2832|
                  |L1.2824|
000b08  7841              LDRB     r1,[r0,#1]
000b0a  f0210108          BIC      r1,r1,#8
000b0e  7041              STRB     r1,[r0,#1]
                  |L1.2832|
;;;733         
;;;734    //	if((bps[dev]._av&0x0f==0))
;;;735    //	     {
;;;736    		//SET_REG(avar_stat,0,3+bps,1);
;;;737    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;738    //	     }
;;;739     
;;;740    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000b10  4650              MOV      r0,r10
000b12  f7fffffe          BL       lc640_read_int
000b16  fa1ffb80          UXTH     r11,r0
;;;741    	event_ptr_find=event_ptr;
000b1a  465c              MOV      r4,r11
                  |L1.2844|
;;;742    	
;;;743    avar_src_hndl_lbl1: 
;;;744    
;;;745    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000b1c  eb051044          ADD      r0,r5,r4,LSL #5
000b20  fa1ffa80          UXTH     r10,r0
;;;746    
;;;747         lc640_read_long_ptr(lc640_adr,data);
000b24  4669              MOV      r1,sp
000b26  4650              MOV      r0,r10
000b28  f7fffffe          BL       lc640_read_long_ptr
;;;748         
;;;749         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000b2c  f89d0000          LDRB     r0,[sp,#0]
000b30  2853              CMP      r0,#0x53
000b32  d107              BNE      |L1.2884|
000b34  f89d0001          LDRB     r0,[sp,#1]
000b38  42b0              CMP      r0,r6
000b3a  d103              BNE      |L1.2884|
000b3c  f89d0002          LDRB     r0,[sp,#2]
000b40  42b8              CMP      r0,r7
000b42  d007              BEQ      |L1.2900|
                  |L1.2884|
;;;750         	{        
;;;751         	if(event_ptr_find)event_ptr_find--;
000b44  b114              CBZ      r4,|L1.2892|
000b46  1e64              SUBS     r4,r4,#1
000b48  b2a4              UXTH     r4,r4
000b4a  e000              B        |L1.2894|
                  |L1.2892|
;;;752         	else event_ptr_find=63;
000b4c  243f              MOVS     r4,#0x3f
                  |L1.2894|
;;;753         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000b4e  455c              CMP      r4,r11
000b50  d1e4              BNE      |L1.2844|
000b52  e05d              B        |L1.3088|
                  |L1.2900|
;;;754         	else goto avar_src_hndl_lbl1;
;;;755         	}
;;;756         else 
;;;757         	{
;;;758         	lc640_read_long_ptr(lc640_adr+16,data);
000b54  4669              MOV      r1,sp
000b56  f10a0010          ADD      r0,r10,#0x10
000b5a  f7fffffe          BL       lc640_read_long_ptr
;;;759         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000b5e  f89d0000          LDRB     r0,[sp,#0]
000b62  2841              CMP      r0,#0x41
000b64  d10b              BNE      |L1.2942|
000b66  f89d0001          LDRB     r0,[sp,#1]
000b6a  2841              CMP      r0,#0x41
000b6c  d107              BNE      |L1.2942|
000b6e  f89d0002          LDRB     r0,[sp,#2]
000b72  2841              CMP      r0,#0x41
000b74  d103              BNE      |L1.2942|
000b76  f89d0003          LDRB     r0,[sp,#3]
000b7a  2841              CMP      r0,#0x41
000b7c  d007              BEQ      |L1.2958|
                  |L1.2942|
;;;760         		{        
;;;761         		if(event_ptr_find)event_ptr_find--;
000b7e  b114              CBZ      r4,|L1.2950|
000b80  1e64              SUBS     r4,r4,#1
000b82  b2a4              UXTH     r4,r4
000b84  e000              B        |L1.2952|
                  |L1.2950|
;;;762             		else event_ptr_find=63;
000b86  243f              MOVS     r4,#0x3f
                  |L1.2952|
;;;763             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000b88  455c              CMP      r4,r11
000b8a  d1c7              BNE      |L1.2844|
000b8c  e040              B        |L1.3088|
                  |L1.2958|
;;;764         		else goto avar_src_hndl_lbl1;
;;;765         		}
;;;766    
;;;767         	}	
;;;768    
;;;769    
;;;770    	
;;;771    	data[0]=LPC_RTC->YEAR;
000b8e  f8b8003c          LDRH     r0,[r8,#0x3c]
000b92  f88d0000          STRB     r0,[sp,#0]
;;;772    	data[1]=LPC_RTC->MONTH;
000b96  f8980038          LDRB     r0,[r8,#0x38]
000b9a  f88d0001          STRB     r0,[sp,#1]
;;;773    	data[2]=LPC_RTC->DOM;
000b9e  f898002c          LDRB     r0,[r8,#0x2c]
000ba2  f88d0002          STRB     r0,[sp,#2]
;;;774    	data[3]=0;
000ba6  f88d9003          STRB     r9,[sp,#3]
;;;775    	lc640_write_long_ptr(lc640_adr+16,data);
000baa  4669              MOV      r1,sp
000bac  f10a0010          ADD      r0,r10,#0x10
000bb0  f7fffffe          BL       lc640_write_long_ptr
;;;776    
;;;777    	data[0]=LPC_RTC->HOUR;
000bb4  f8980028          LDRB     r0,[r8,#0x28]
000bb8  f88d0000          STRB     r0,[sp,#0]
;;;778    	data[1]=LPC_RTC->MIN;
000bbc  f8980024          LDRB     r0,[r8,#0x24]
000bc0  f88d0001          STRB     r0,[sp,#1]
;;;779    	data[2]=LPC_RTC->SEC;
000bc4  f8980020          LDRB     r0,[r8,#0x20]
000bc8  f88d0002          STRB     r0,[sp,#2]
;;;780    	data[3]=0;
000bcc  f88d9003          STRB     r9,[sp,#3]
;;;781    	lc640_write_long_ptr(lc640_adr+20,data);
000bd0  4669              MOV      r1,sp
000bd2  f10a0014          ADD      r0,r10,#0x14
000bd6  f7fffffe          BL       lc640_write_long_ptr
;;;782    	
;;;783    	data[0]='B';
000bda  2442              MOVS     r4,#0x42
000bdc  f88d4000          STRB     r4,[sp,#0]
;;;784    	data[1]='B';
000be0  f88d4001          STRB     r4,[sp,#1]
;;;785    	data[2]='B';
000be4  f88d4002          STRB     r4,[sp,#2]
;;;786    	data[3]='B';
000be8  f88d4003          STRB     r4,[sp,#3]
;;;787    	lc640_write_long_ptr(lc640_adr+24,data);
000bec  4669              MOV      r1,sp
000bee  f10a0018          ADD      r0,r10,#0x18
000bf2  f7fffffe          BL       lc640_write_long_ptr
;;;788    	
;;;789    	data[0]='B';
000bf6  f88d4000          STRB     r4,[sp,#0]
;;;790    	data[1]='B';
000bfa  f88d4001          STRB     r4,[sp,#1]
;;;791    	data[2]='B';
000bfe  f88d4002          STRB     r4,[sp,#2]
;;;792    	data[3]='B';
000c02  f88d4003          STRB     r4,[sp,#3]
;;;793    	lc640_write_long_ptr(lc640_adr+28,data);
000c06  4669              MOV      r1,sp
000c08  f10a001c          ADD      r0,r10,#0x1c
000c0c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3088|
;;;794    	
;;;795    	}
;;;796    	
;;;797    avar_src_hndl_end:
;;;798    __nop();		
000c10  bf00              NOP      
                  |L1.3090|
;;;799    }
000c12  e8bd8ff8          POP      {r3-r11,pc}
;;;800    
                          ENDP

                  wrk_mem_hndl PROC
;;;801    //-----------------------------------------------
;;;802    void wrk_mem_hndl(char b)
000c16  e92d41fc          PUSH     {r2-r8,lr}
;;;803    {
000c1a  4606              MOV      r6,r0
;;;804    char data[4];
;;;805    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;806    
;;;807    signed short temp_temp;
;;;808    
;;;809    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000c1c  eb060046          ADD      r0,r6,r6,LSL #1
000c20  eb001106          ADD      r1,r0,r6,LSL #4
000c24  48b2              LDR      r0,|L1.3824|
000c26  eb000481          ADD      r4,r0,r1,LSL #2
000c2a  8be0              LDRH     r0,[r4,#0x1e]
000c2c  2805              CMP      r0,#5
000c2e  d379              BCC      |L1.3364|
;;;810    
;;;811    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000c30  48b0              LDR      r0,|L1.3828|
000c32  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000c34  1d80              ADDS     r0,r0,#6
000c36  f0000007          AND      r0,r0,#7
000c3a  eb040040          ADD      r0,r4,r0,LSL #1
000c3e  8c00              LDRH     r0,[r0,#0x20]
000c40  9000              STR      r0,[sp,#0]
;;;812    
;;;813    
;;;814    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000c42  f44f6760          MOV      r7,#0xe00
000c46  4638              MOV      r0,r7
000c48  f7fffffe          BL       lc640_read_int
;;;815    event_ptr++;	
000c4c  1c40              ADDS     r0,r0,#1
000c4e  b285              UXTH     r5,r0
;;;816    if(event_ptr>63)event_ptr=0;	
000c50  2d3f              CMP      r5,#0x3f
000c52  d900              BLS      |L1.3158|
000c54  2500              MOVS     r5,#0
                  |L1.3158|
;;;817    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000c56  b229              SXTH     r1,r5
000c58  4638              MOV      r0,r7
000c5a  f7fffffe          BL       lc640_write_int
;;;818    	
;;;819    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000c5e  f6406802          MOV      r8,#0xe02
000c62  4640              MOV      r0,r8
000c64  f7fffffe          BL       lc640_read_int
000c68  b280              UXTH     r0,r0
;;;820    if(event_cnt!=63)event_cnt=event_ptr;
000c6a  283f              CMP      r0,#0x3f
000c6c  d000              BEQ      |L1.3184|
000c6e  4628              MOV      r0,r5
                  |L1.3184|
;;;821    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000c70  b201              SXTH     r1,r0
000c72  4640              MOV      r0,r8
000c74  f7fffffe          BL       lc640_write_int
;;;822    	
;;;823    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000c78  4638              MOV      r0,r7
000c7a  f7fffffe          BL       lc640_read_int
000c7e  f44f6180          MOV      r1,#0x400
000c82  eb011040          ADD      r0,r1,r0,LSL #5
000c86  b285              UXTH     r5,r0
;;;824    	
;;;825    data[0]='B';
000c88  2042              MOVS     r0,#0x42
000c8a  f88d0004          STRB     r0,[sp,#4]
;;;826    data[1]=b; 
000c8e  f88d6005          STRB     r6,[sp,#5]
;;;827    data[2]='W';
000c92  2057              MOVS     r0,#0x57
000c94  f88d0006          STRB     r0,[sp,#6]
;;;828    data[3]=0;
000c98  2600              MOVS     r6,#0
000c9a  f88d6007          STRB     r6,[sp,#7]
;;;829    
;;;830    lc640_write_long_ptr(lc640_adr,data);
000c9e  a901              ADD      r1,sp,#4
000ca0  4628              MOV      r0,r5
000ca2  f7fffffe          BL       lc640_write_long_ptr
;;;831    
;;;832    data[0]=*((char*)&bat[b]._Iintegr_);
000ca6  7fa0              LDRB     r0,[r4,#0x1e]
000ca8  f88d0004          STRB     r0,[sp,#4]
;;;833    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000cac  7fe0              LDRB     r0,[r4,#0x1f]
000cae  f88d0005          STRB     r0,[sp,#5]
;;;834    data[2]=*((char*)&temp_temp);
000cb2  f89d0000          LDRB     r0,[sp,#0]
000cb6  f88d0006          STRB     r0,[sp,#6]
;;;835    data[3]=*(((char*)(&temp_temp))+1);
000cba  f89d0001          LDRB     r0,[sp,#1]
000cbe  f88d0007          STRB     r0,[sp,#7]
;;;836    lc640_write_long_ptr(lc640_adr+4,data);
000cc2  a901              ADD      r1,sp,#4
000cc4  1d28              ADDS     r0,r5,#4
000cc6  f7fffffe          BL       lc640_write_long_ptr
;;;837    
;;;838    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000cca  f1040134          ADD      r1,r4,#0x34
000cce  f1050008          ADD      r0,r5,#8
000cd2  f7fffffe          BL       lc640_write_long_ptr
;;;839    	
;;;840    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000cd6  f1040138          ADD      r1,r4,#0x38
000cda  f105000c          ADD      r0,r5,#0xc
000cde  f7fffffe          BL       lc640_write_long_ptr
;;;841    
;;;842    data[0]=LPC_RTC->YEAR;
000ce2  4c85              LDR      r4,|L1.3832|
000ce4  8ba0              LDRH     r0,[r4,#0x1c]
000ce6  f88d0004          STRB     r0,[sp,#4]
;;;843    data[1]=LPC_RTC->MONTH;
000cea  7e20              LDRB     r0,[r4,#0x18]
000cec  f88d0005          STRB     r0,[sp,#5]
;;;844    data[2]=LPC_RTC->DOM;
000cf0  7b20              LDRB     r0,[r4,#0xc]
000cf2  f88d0006          STRB     r0,[sp,#6]
;;;845    data[3]=0;
000cf6  f88d6007          STRB     r6,[sp,#7]
;;;846    lc640_write_long_ptr(lc640_adr+16,data);
000cfa  a901              ADD      r1,sp,#4
000cfc  f1050010          ADD      r0,r5,#0x10
000d00  f7fffffe          BL       lc640_write_long_ptr
;;;847    
;;;848    data[0]=LPC_RTC->HOUR;
000d04  7a20              LDRB     r0,[r4,#8]
000d06  f88d0004          STRB     r0,[sp,#4]
;;;849    data[1]=LPC_RTC->MIN;
000d0a  7920              LDRB     r0,[r4,#4]
000d0c  f88d0005          STRB     r0,[sp,#5]
;;;850    data[2]=LPC_RTC->SEC;
000d10  7820              LDRB     r0,[r4,#0]
000d12  f88d0006          STRB     r0,[sp,#6]
;;;851    data[3]=0;
000d16  f88d6007          STRB     r6,[sp,#7]
;;;852    lc640_write_long_ptr(lc640_adr+20,data);
000d1a  a901              ADD      r1,sp,#4
000d1c  f1050014          ADD      r0,r5,#0x14
000d20  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3364|
;;;853    	
;;;854    
;;;855    
;;;856    	
;;;857    wrk_mem_hndl_end:	
;;;858    __nop();
000d24  bf00              NOP      
;;;859    }  
000d26  e8bd81fc          POP      {r2-r8,pc}
;;;860    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;862    //-----------------------------------------------
;;;863    void avar_bat_ips_hndl(char in)
000d2a  e92d4ff8          PUSH     {r3-r11,lr}
;;;864    {
000d2e  4602              MOV      r2,r0
;;;865    char data[4];
;;;866    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;867    
;;;868    if(in==1)
;;;869    	{
;;;870    	bat_ips._av|=1;
000d30  4872              LDR      r0,|L1.3836|
;;;871        ips_bat_av_stat=1;
;;;872    	ips_bat_av_vzvod=1;
;;;873    
;;;874    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;875    	event_ptr++;	
;;;876    	if(event_ptr>63)event_ptr=0;	
;;;877    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;878    	
;;;879         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;880    	if(event_cnt!=63)event_cnt=event_ptr;
;;;881    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;882    	
;;;883    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;884    	
;;;885    	data[0]='B';
;;;886    	data[1]=0;
;;;887    	data[2]='C';
;;;888    	data[3]=0;
;;;889    	lc640_write_long_ptr(lc640_adr,data);
;;;890    
;;;891    	data[0]=0;
;;;892    	data[1]=0;
;;;893    	data[2]=0;
;;;894    	data[3]=0;
;;;895    	lc640_write_long_ptr(lc640_adr+4,data);
;;;896    
;;;897    	data[0]=LPC_RTC->YEAR;
000d32  f8df81c4          LDR      r8,|L1.3832|
000d36  4c72              LDR      r4,|L1.3840|
000d38  4b72              LDR      r3,|L1.3844|
000d3a  2742              MOVS     r7,#0x42              ;885
000d3c  f890103d          LDRB     r1,[r0,#0x3d]         ;870
000d40  f1a80820          SUB      r8,r8,#0x20
000d44  f44f6560          MOV      r5,#0xe00             ;874
000d48  f04f0900          MOV      r9,#0                 ;876
000d4c  f44f6a80          MOV      r10,#0x400            ;883
000d50  2a01              CMP      r2,#1                 ;868
000d52  d001              BEQ      |L1.3416|
;;;898    	data[1]=LPC_RTC->MONTH;
;;;899    	data[2]=LPC_RTC->DOM;
;;;900    	data[3]=0;
;;;901    	lc640_write_long_ptr(lc640_adr+8,data);
;;;902    
;;;903    	data[0]=LPC_RTC->HOUR;
;;;904    	data[1]=LPC_RTC->MIN;
;;;905    	data[2]=LPC_RTC->SEC;
;;;906    	data[3]=0;
;;;907    	lc640_write_long_ptr(lc640_adr+12,data);
;;;908    	
;;;909    	data[0]='A';
;;;910    	data[1]='A';
;;;911    	data[2]='A';
;;;912    	data[3]='A';
;;;913    	lc640_write_long_ptr(lc640_adr+16,data);
;;;914    	
;;;915    	data[0]='A';
;;;916    	data[1]='A';
;;;917    	data[2]='A';
;;;918    	data[3]='A';
;;;919    	lc640_write_long_ptr(lc640_adr+20,data);
;;;920    	
;;;921    	data[0]='A';
;;;922    	data[1]='A';
;;;923    	data[2]='A';
;;;924    	data[3]='A';
;;;925    	lc640_write_long_ptr(lc640_adr+24,data);
;;;926    	
;;;927    	data[0]='A';
;;;928    	data[1]='A';
;;;929    	data[2]='A';
;;;930    	data[3]='A';
;;;931    	lc640_write_long_ptr(lc640_adr+28,data);
;;;932    					
;;;933    	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;934    		
;;;935    	}
;;;936    
;;;937    else if(in==0)
000d54  b1e2              CBZ      r2,|L1.3472|
000d56  e1db              B        |L1.4368|
                  |L1.3416|
000d58  f0410101          ORR      r1,r1,#1              ;870
000d5c  f880103d          STRB     r1,[r0,#0x3d]         ;870
000d60  2001              MOVS     r0,#1                 ;871
000d62  7020              STRB     r0,[r4,#0]            ;871
000d64  7018              STRB     r0,[r3,#0]            ;872
000d66  4628              MOV      r0,r5                 ;874
000d68  f7fffffe          BL       lc640_read_int
000d6c  1c40              ADDS     r0,r0,#1              ;875
000d6e  b284              UXTH     r4,r0                 ;875
000d70  2c3f              CMP      r4,#0x3f              ;876
000d72  d900              BLS      |L1.3446|
000d74  2400              MOVS     r4,#0                 ;876
                  |L1.3446|
000d76  b221              SXTH     r1,r4                 ;877
000d78  4628              MOV      r0,r5                 ;877
000d7a  f7fffffe          BL       lc640_write_int
000d7e  f6406602          MOV      r6,#0xe02             ;879
000d82  4630              MOV      r0,r6                 ;879
000d84  f7fffffe          BL       lc640_read_int
000d88  b281              UXTH     r1,r0                 ;879
000d8a  293f              CMP      r1,#0x3f              ;880
000d8c  d001              BEQ      |L1.3474|
000d8e  e0bb              B        |L1.3848|
                  |L1.3472|
000d90  e13a              B        |L1.4104|
                  |L1.3474|
000d92  e0ba              B        |L1.3850|
                  |L1.3476|
000d94  42505320          DCB      "BPS #1 Alarm, overheat",0
000d98  23312041
000d9c  6c61726d
000da0  2c206f76
000da4  65726865
000da8  617400  
000dab  00                DCB      0
                  |L1.3500|
000dac  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000db0  23312041
000db4  6c61726d
000db8  2c20766f
000dbc  6c746167
000dc0  65206973
000dc4  20757000
                  |L1.3528|
000dc8  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000dcc  23312041
000dd0  6c61726d
000dd4  2c20766f
000dd8  6c746167
000ddc  65206973
000de0  20646f77
000de4  6e00    
000de6  00                DCB      0
000de7  00                DCB      0
                  |L1.3560|
000de8  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000dec  23312041
000df0  6c61726d
000df4  2c20636f
000df8  6e6e6563
000dfc  74206973
000e00  206c6f73
000e04  7400    
000e06  00                DCB      0
000e07  00                DCB      0
                  |L1.3592|
000e08  42505320          DCB      "BPS #2 Alarm, overheat",0
000e0c  23322041
000e10  6c61726d
000e14  2c206f76
000e18  65726865
000e1c  617400  
000e1f  00                DCB      0
                  |L1.3616|
000e20  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000e24  23322041
000e28  6c61726d
000e2c  2c20766f
000e30  6c746167
000e34  65206973
000e38  20757000
                  |L1.3644|
000e3c  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000e40  23322041
000e44  6c61726d
000e48  2c20766f
000e4c  6c746167
000e50  65206973
000e54  20646f77
000e58  6e00    
000e5a  00                DCB      0
000e5b  00                DCB      0
                  |L1.3676|
000e5c  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000e60  23322041
000e64  6c61726d
000e68  2c20636f
000e6c  6e6e6563
000e70  74206973
000e74  206c6f73
000e78  7400    
000e7a  00                DCB      0
000e7b  00                DCB      0
                  |L1.3708|
000e7c  42505320          DCB      "BPS #3 Alarm, overheat",0
000e80  23332041
000e84  6c61726d
000e88  2c206f76
000e8c  65726865
000e90  617400  
000e93  00                DCB      0
                  |L1.3732|
000e94  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000e98  23332041
000e9c  6c61726d
000ea0  2c20766f
000ea4  6c746167
000ea8  65206973
000eac  20757000
                  |L1.3760|
000eb0  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000eb4  23332041
000eb8  6c61726d
000ebc  2c20766f
000ec0  6c746167
000ec4  65206973
000ec8  20646f77
000ecc  6e00    
000ece  00                DCB      0
000ecf  00                DCB      0
                  |L1.3792|
000ed0  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000ed4  23332041
000ed8  6c61726d
000edc  2c20636f
000ee0  6e6e6563
000ee4  74206973
000ee8  206c6f73
000eec  7400    
000eee  00                DCB      0
000eef  00                DCB      0
                  |L1.3824|
                          DCD      bat
                  |L1.3828|
                          DCD      bat_u_old_cnt
                  |L1.3832|
                          DCD      0x40024020
                  |L1.3836|
                          DCD      bat_ips
                  |L1.3840|
                          DCD      ips_bat_av_stat
                  |L1.3844|
                          DCD      ips_bat_av_vzvod
                  |L1.3848|
000f08  4621              MOV      r1,r4                 ;880
                  |L1.3850|
000f0a  b209              SXTH     r1,r1                 ;881
000f0c  4630              MOV      r0,r6                 ;881
000f0e  f7fffffe          BL       lc640_write_int
000f12  4628              MOV      r0,r5                 ;883
000f14  f7fffffe          BL       lc640_read_int
000f18  eb0a1040          ADD      r0,r10,r0,LSL #5      ;883
000f1c  b284              UXTH     r4,r0                 ;883
000f1e  f88d7000          STRB     r7,[sp,#0]            ;885
000f22  f88d9001          STRB     r9,[sp,#1]            ;886
000f26  2043              MOVS     r0,#0x43              ;887
000f28  f88d0002          STRB     r0,[sp,#2]            ;887
000f2c  f88d9003          STRB     r9,[sp,#3]            ;888
000f30  4669              MOV      r1,sp                 ;889
000f32  4620              MOV      r0,r4                 ;889
000f34  f7fffffe          BL       lc640_write_long_ptr
000f38  f8cd9000          STR      r9,[sp,#0]            ;894
000f3c  4669              MOV      r1,sp                 ;895
000f3e  1d20              ADDS     r0,r4,#4              ;895
000f40  f7fffffe          BL       lc640_write_long_ptr
000f44  f8b8003c          LDRH     r0,[r8,#0x3c]         ;897
000f48  f88d0000          STRB     r0,[sp,#0]            ;897
000f4c  f8980038          LDRB     r0,[r8,#0x38]         ;898
000f50  f88d0001          STRB     r0,[sp,#1]            ;898
000f54  f898002c          LDRB     r0,[r8,#0x2c]         ;899
000f58  f88d0002          STRB     r0,[sp,#2]            ;899
000f5c  f88d9003          STRB     r9,[sp,#3]            ;900
000f60  4669              MOV      r1,sp                 ;901
000f62  f1040008          ADD      r0,r4,#8              ;901
000f66  f7fffffe          BL       lc640_write_long_ptr
000f6a  f8980028          LDRB     r0,[r8,#0x28]         ;903
000f6e  f88d0000          STRB     r0,[sp,#0]            ;903
000f72  f8980024          LDRB     r0,[r8,#0x24]         ;904
000f76  f88d0001          STRB     r0,[sp,#1]            ;904
000f7a  f8980020          LDRB     r0,[r8,#0x20]         ;905
000f7e  f88d0002          STRB     r0,[sp,#2]            ;905
000f82  f88d9003          STRB     r9,[sp,#3]            ;906
000f86  4669              MOV      r1,sp                 ;907
000f88  f104000c          ADD      r0,r4,#0xc            ;907
000f8c  f7fffffe          BL       lc640_write_long_ptr
000f90  2541              MOVS     r5,#0x41              ;909
000f92  f88d5000          STRB     r5,[sp,#0]            ;909
000f96  f88d5001          STRB     r5,[sp,#1]            ;910
000f9a  f88d5002          STRB     r5,[sp,#2]            ;911
000f9e  f88d5003          STRB     r5,[sp,#3]            ;912
000fa2  4669              MOV      r1,sp                 ;913
000fa4  f1040010          ADD      r0,r4,#0x10           ;913
000fa8  f7fffffe          BL       lc640_write_long_ptr
000fac  f88d5000          STRB     r5,[sp,#0]            ;915
000fb0  f88d5001          STRB     r5,[sp,#1]            ;916
000fb4  f88d5002          STRB     r5,[sp,#2]            ;917
000fb8  f88d5003          STRB     r5,[sp,#3]            ;918
000fbc  4669              MOV      r1,sp                 ;919
000fbe  f1040014          ADD      r0,r4,#0x14           ;919
000fc2  f7fffffe          BL       lc640_write_long_ptr
000fc6  f88d5000          STRB     r5,[sp,#0]            ;921
000fca  f88d5001          STRB     r5,[sp,#1]            ;922
000fce  f88d5002          STRB     r5,[sp,#2]            ;923
000fd2  f88d5003          STRB     r5,[sp,#3]            ;924
000fd6  4669              MOV      r1,sp                 ;925
000fd8  f1040018          ADD      r0,r4,#0x18           ;925
000fdc  f7fffffe          BL       lc640_write_long_ptr
000fe0  f88d5000          STRB     r5,[sp,#0]            ;927
000fe4  f88d5001          STRB     r5,[sp,#1]            ;928
000fe8  f88d5002          STRB     r5,[sp,#2]            ;929
000fec  f88d5003          STRB     r5,[sp,#3]            ;930
000ff0  4669              MOV      r1,sp                 ;931
000ff2  f104001c          ADD      r0,r4,#0x1c           ;931
000ff6  f7fffffe          BL       lc640_write_long_ptr
000ffa  2301              MOVS     r3,#1                 ;933
000ffc  461a              MOV      r2,r3                 ;933
000ffe  2105              MOVS     r1,#5                 ;933
001000  a0ff              ADR      r0,|L1.5120|
001002  f7fffffe          BL       snmp_trap_send
001006  e083              B        |L1.4368|
                  |L1.4104|
;;;938    	{
;;;939    	bat_ips._av&=~1;
001008  f0210101          BIC      r1,r1,#1
00100c  f880103d          STRB     r1,[r0,#0x3d]
;;;940    	ips_bat_av_stat=0;
001010  f8849000          STRB     r9,[r4,#0]
;;;941    	ips_bat_av_vzvod=0;
001014  f8839000          STRB     r9,[r3,#0]
;;;942         
;;;943    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
001018  4628              MOV      r0,r5
00101a  f7fffffe          BL       lc640_read_int
00101e  b286              UXTH     r6,r0
;;;944    	event_ptr_find=event_ptr;
001020  4634              MOV      r4,r6
                  |L1.4130|
;;;945    	
;;;946    avar_bat_ips_hndl_lbl1: 
;;;947    
;;;948    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001022  eb0a1044          ADD      r0,r10,r4,LSL #5
001026  b285              UXTH     r5,r0
;;;949    
;;;950         lc640_read_long_ptr(lc640_adr,data);
001028  4669              MOV      r1,sp
00102a  4628              MOV      r0,r5
00102c  f7fffffe          BL       lc640_read_long_ptr
;;;951         
;;;952         if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
001030  f89d0000          LDRB     r0,[sp,#0]
001034  2842              CMP      r0,#0x42
001036  d106              BNE      |L1.4166|
001038  f89d0001          LDRB     r0,[sp,#1]
00103c  b918              CBNZ     r0,|L1.4166|
00103e  f89d0002          LDRB     r0,[sp,#2]
001042  2843              CMP      r0,#0x43
001044  d007              BEQ      |L1.4182|
                  |L1.4166|
;;;953         	{        
;;;954         	if(event_ptr_find)event_ptr_find--;
001046  b114              CBZ      r4,|L1.4174|
001048  1e64              SUBS     r4,r4,#1
00104a  b2a4              UXTH     r4,r4
00104c  e000              B        |L1.4176|
                  |L1.4174|
;;;955         	else event_ptr_find=63;
00104e  243f              MOVS     r4,#0x3f
                  |L1.4176|
;;;956         	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001050  42b4              CMP      r4,r6
001052  d1e6              BNE      |L1.4130|
001054  e05c              B        |L1.4368|
                  |L1.4182|
;;;957         	else goto avar_bat_ips_hndl_lbl1;
;;;958         	}
;;;959         else 
;;;960         	{
;;;961         	lc640_read_long_ptr(lc640_adr+16,data);
001056  4669              MOV      r1,sp
001058  f1050010          ADD      r0,r5,#0x10
00105c  f7fffffe          BL       lc640_read_long_ptr
;;;962         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001060  f89d0000          LDRB     r0,[sp,#0]
001064  2841              CMP      r0,#0x41
001066  d10b              BNE      |L1.4224|
001068  f89d0001          LDRB     r0,[sp,#1]
00106c  2841              CMP      r0,#0x41
00106e  d107              BNE      |L1.4224|
001070  f89d0002          LDRB     r0,[sp,#2]
001074  2841              CMP      r0,#0x41
001076  d103              BNE      |L1.4224|
001078  f89d0003          LDRB     r0,[sp,#3]
00107c  2841              CMP      r0,#0x41
00107e  d007              BEQ      |L1.4240|
                  |L1.4224|
;;;963         		{        
;;;964         		if(event_ptr_find)event_ptr_find--;
001080  b114              CBZ      r4,|L1.4232|
001082  1e64              SUBS     r4,r4,#1
001084  b2a4              UXTH     r4,r4
001086  e000              B        |L1.4234|
                  |L1.4232|
;;;965             		else event_ptr_find=63;
001088  243f              MOVS     r4,#0x3f
                  |L1.4234|
;;;966             	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
00108a  42b4              CMP      r4,r6
00108c  d1c9              BNE      |L1.4130|
00108e  e03f              B        |L1.4368|
                  |L1.4240|
;;;967         		else goto avar_bat_ips_hndl_lbl1;
;;;968         		}
;;;969    
;;;970         	}
;;;971         		
;;;972    	data[0]=LPC_RTC->YEAR;
001090  f8b8003c          LDRH     r0,[r8,#0x3c]
001094  f88d0000          STRB     r0,[sp,#0]
;;;973    	data[1]=LPC_RTC->MONTH;
001098  f8980038          LDRB     r0,[r8,#0x38]
00109c  f88d0001          STRB     r0,[sp,#1]
;;;974    	data[2]=LPC_RTC->DOM;
0010a0  f898002c          LDRB     r0,[r8,#0x2c]
0010a4  f88d0002          STRB     r0,[sp,#2]
;;;975    	data[3]=0;
0010a8  f88d9003          STRB     r9,[sp,#3]
;;;976    	lc640_write_long_ptr(lc640_adr+16,data);
0010ac  4669              MOV      r1,sp
0010ae  f1050010          ADD      r0,r5,#0x10
0010b2  f7fffffe          BL       lc640_write_long_ptr
;;;977    
;;;978    	data[0]=LPC_RTC->HOUR;
0010b6  f8980028          LDRB     r0,[r8,#0x28]
0010ba  f88d0000          STRB     r0,[sp,#0]
;;;979    	data[1]=LPC_RTC->MIN;
0010be  f8980024          LDRB     r0,[r8,#0x24]
0010c2  f88d0001          STRB     r0,[sp,#1]
;;;980    	data[2]=LPC_RTC->SEC;
0010c6  f8980020          LDRB     r0,[r8,#0x20]
0010ca  f88d0002          STRB     r0,[sp,#2]
;;;981    	data[3]=0;
0010ce  f88d9003          STRB     r9,[sp,#3]
;;;982    	lc640_write_long_ptr(lc640_adr+20,data);
0010d2  4669              MOV      r1,sp
0010d4  f1050014          ADD      r0,r5,#0x14
0010d8  f7fffffe          BL       lc640_write_long_ptr
;;;983    	
;;;984    	data[0]='B';
0010dc  f88d7000          STRB     r7,[sp,#0]
;;;985    	data[1]='B';
0010e0  f88d7001          STRB     r7,[sp,#1]
;;;986    	data[2]='B';
0010e4  f88d7002          STRB     r7,[sp,#2]
;;;987    	data[3]='B';
0010e8  f88d7003          STRB     r7,[sp,#3]
;;;988    	lc640_write_long_ptr(lc640_adr+24,data);
0010ec  4669              MOV      r1,sp
0010ee  f1050018          ADD      r0,r5,#0x18
0010f2  f7fffffe          BL       lc640_write_long_ptr
;;;989    	
;;;990    	data[0]='B';
0010f6  f88d7000          STRB     r7,[sp,#0]
;;;991    	data[1]='B';
0010fa  f88d7001          STRB     r7,[sp,#1]
;;;992    	data[2]='B';
0010fe  f88d7002          STRB     r7,[sp,#2]
;;;993    	data[3]='B';
001102  f88d7003          STRB     r7,[sp,#3]
;;;994    	lc640_write_long_ptr(lc640_adr+28,data);
001106  4669              MOV      r1,sp
001108  f105001c          ADD      r0,r5,#0x1c
00110c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4368|
;;;995    	
;;;996    
;;;997    	
;;;998    	}
;;;999    	
;;;1000   avar_bat_ips_hndl_end:
;;;1001   __nop();		
001110  bf00              NOP      
                  |L1.4370|
;;;1002   }
001112  e57e              B        |L1.3090|
;;;1003   
                          ENDP

                  avar_bat_hndl PROC
;;;1006   //-----------------------------------------------
;;;1007   void avar_bat_hndl(char b, char in)
001114  e92d4ff8          PUSH     {r3-r11,lr}
;;;1008   {
001118  4606              MOV      r6,r0
;;;1009   char data[4];
;;;1010   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1011   
;;;1012   if(in==1)
;;;1013   	{
;;;1014   	bat[b]._av|=1;
00111a  48be              LDR      r0,|L1.5140|
00111c  eb060246          ADD      r2,r6,r6,LSL #1
;;;1015       
;;;1016   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1017   	event_ptr++;	
;;;1018   	if(event_ptr>63)event_ptr=0;	
;;;1019   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1020   	
;;;1021        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1022   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1023   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1024   	
;;;1025   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1026   	
;;;1027   	data[0]='B';
;;;1028   	data[1]=b;
;;;1029   	data[2]='C';
;;;1030   	data[3]=0;
;;;1031   	lc640_write_long_ptr(lc640_adr,data);
;;;1032   
;;;1033   	data[0]=0;
;;;1034   	data[1]=0;
;;;1035   	data[2]=0;
;;;1036   	data[3]=0;
;;;1037   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1038   
;;;1039   	data[0]=LPC_RTC->YEAR;
001120  f8df82f4          LDR      r8,|L1.5144|
001124  eb021206          ADD      r2,r2,r6,LSL #4       ;1014
001128  f04f0a00          MOV      r10,#0                ;1018
00112c  f04f0942          MOV      r9,#0x42              ;1027
001130  f44f6560          MOV      r5,#0xe00             ;1016
001134  f44f6b80          MOV      r11,#0x400            ;1025
001138  eb000082          ADD      r0,r0,r2,LSL #2       ;1014
00113c  2901              CMP      r1,#1                 ;1012
00113e  d001              BEQ      |L1.4420|
;;;1040   	data[1]=LPC_RTC->MONTH;
;;;1041   	data[2]=LPC_RTC->DOM;
;;;1042   	data[3]=0;
;;;1043   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1044   
;;;1045   	data[0]=LPC_RTC->HOUR;
;;;1046   	data[1]=LPC_RTC->MIN;
;;;1047   	data[2]=LPC_RTC->SEC;
;;;1048   	data[3]=0;
;;;1049   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1050   	
;;;1051   	data[0]='A';
;;;1052   	data[1]='A';
;;;1053   	data[2]='A';
;;;1054   	data[3]='A';
;;;1055   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1056   	
;;;1057   	data[0]='A';
;;;1058   	data[1]='A';
;;;1059   	data[2]='A';
;;;1060   	data[3]='A';
;;;1061   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1062   	
;;;1063   	data[0]='A';
;;;1064   	data[1]='A';
;;;1065   	data[2]='A';
;;;1066   	data[3]='A';
;;;1067   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1068   	
;;;1069   	data[0]='A';
;;;1070   	data[1]='A';
;;;1071   	data[2]='A';
;;;1072   	data[3]='A';
;;;1073   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1074   					
;;;1075   	if(b==0)
;;;1076   		{
;;;1077   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1078   		}
;;;1079   	else if(b==1)
;;;1080   		{
;;;1081   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1082   		} 
;;;1083   			
;;;1084   	}
;;;1085   
;;;1086   else if(in==0)
001140  b3f1              CBZ      r1,|L1.4544|
001142  e127              B        |L1.5012|
                  |L1.4420|
001144  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1014
001148  f0410101          ORR      r1,r1,#1              ;1014
00114c  7001              STRB     r1,[r0,#0]            ;1014
00114e  4628              MOV      r0,r5                 ;1016
001150  f7fffffe          BL       lc640_read_int
001154  1c40              ADDS     r0,r0,#1              ;1017
001156  b284              UXTH     r4,r0                 ;1017
001158  2c3f              CMP      r4,#0x3f              ;1018
00115a  d900              BLS      |L1.4446|
00115c  2400              MOVS     r4,#0                 ;1018
                  |L1.4446|
00115e  b221              SXTH     r1,r4                 ;1019
001160  4628              MOV      r0,r5                 ;1019
001162  f7fffffe          BL       lc640_write_int
001166  f6406702          MOV      r7,#0xe02             ;1021
00116a  4638              MOV      r0,r7                 ;1021
00116c  f7fffffe          BL       lc640_read_int
001170  b280              UXTH     r0,r0                 ;1021
001172  283f              CMP      r0,#0x3f              ;1022
001174  d000              BEQ      |L1.4472|
001176  4620              MOV      r0,r4                 ;1022
                  |L1.4472|
001178  b201              SXTH     r1,r0                 ;1023
00117a  4638              MOV      r0,r7                 ;1023
00117c  f7fffffe          BL       lc640_write_int
001180  4628              MOV      r0,r5                 ;1025
001182  f7fffffe          BL       lc640_read_int
001186  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1025
00118a  b284              UXTH     r4,r0                 ;1025
00118c  f88d9000          STRB     r9,[sp,#0]            ;1027
001190  f88d6001          STRB     r6,[sp,#1]            ;1028
001194  2043              MOVS     r0,#0x43              ;1029
001196  f88d0002          STRB     r0,[sp,#2]            ;1029
00119a  f88da003          STRB     r10,[sp,#3]           ;1030
00119e  4669              MOV      r1,sp                 ;1031
0011a0  4620              MOV      r0,r4                 ;1031
0011a2  f7fffffe          BL       lc640_write_long_ptr
0011a6  f8cda000          STR      r10,[sp,#0]           ;1036
0011aa  4669              MOV      r1,sp                 ;1037
0011ac  1d20              ADDS     r0,r4,#4              ;1037
0011ae  f7fffffe          BL       lc640_write_long_ptr
0011b2  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1039
0011b6  f88d0000          STRB     r0,[sp,#0]            ;1039
0011ba  f8980038          LDRB     r0,[r8,#0x38]         ;1040
0011be  e000              B        |L1.4546|
                  |L1.4544|
0011c0  e066              B        |L1.4752|
                  |L1.4546|
0011c2  f88d0001          STRB     r0,[sp,#1]            ;1040
0011c6  f898002c          LDRB     r0,[r8,#0x2c]         ;1041
0011ca  f88d0002          STRB     r0,[sp,#2]            ;1041
0011ce  f88da003          STRB     r10,[sp,#3]           ;1042
0011d2  4669              MOV      r1,sp                 ;1043
0011d4  f1040008          ADD      r0,r4,#8              ;1043
0011d8  f7fffffe          BL       lc640_write_long_ptr
0011dc  f8980028          LDRB     r0,[r8,#0x28]         ;1045
0011e0  f88d0000          STRB     r0,[sp,#0]            ;1045
0011e4  f8980024          LDRB     r0,[r8,#0x24]         ;1046
0011e8  f88d0001          STRB     r0,[sp,#1]            ;1046
0011ec  f8980020          LDRB     r0,[r8,#0x20]         ;1047
0011f0  f88d0002          STRB     r0,[sp,#2]            ;1047
0011f4  f88da003          STRB     r10,[sp,#3]           ;1048
0011f8  4669              MOV      r1,sp                 ;1049
0011fa  f104000c          ADD      r0,r4,#0xc            ;1049
0011fe  f7fffffe          BL       lc640_write_long_ptr
001202  2541              MOVS     r5,#0x41              ;1051
001204  f88d5000          STRB     r5,[sp,#0]            ;1051
001208  f88d5001          STRB     r5,[sp,#1]            ;1052
00120c  f88d5002          STRB     r5,[sp,#2]            ;1053
001210  f88d5003          STRB     r5,[sp,#3]            ;1054
001214  4669              MOV      r1,sp                 ;1055
001216  f1040010          ADD      r0,r4,#0x10           ;1055
00121a  f7fffffe          BL       lc640_write_long_ptr
00121e  f88d5000          STRB     r5,[sp,#0]            ;1057
001222  f88d5001          STRB     r5,[sp,#1]            ;1058
001226  f88d5002          STRB     r5,[sp,#2]            ;1059
00122a  f88d5003          STRB     r5,[sp,#3]            ;1060
00122e  4669              MOV      r1,sp                 ;1061
001230  f1040014          ADD      r0,r4,#0x14           ;1061
001234  f7fffffe          BL       lc640_write_long_ptr
001238  f88d5000          STRB     r5,[sp,#0]            ;1063
00123c  f88d5001          STRB     r5,[sp,#1]            ;1064
001240  f88d5002          STRB     r5,[sp,#2]            ;1065
001244  f88d5003          STRB     r5,[sp,#3]            ;1066
001248  4669              MOV      r1,sp                 ;1067
00124a  f1040018          ADD      r0,r4,#0x18           ;1067
00124e  f7fffffe          BL       lc640_write_long_ptr
001252  f88d5000          STRB     r5,[sp,#0]            ;1069
001256  f88d5001          STRB     r5,[sp,#1]            ;1070
00125a  f88d5002          STRB     r5,[sp,#2]            ;1071
00125e  f88d5003          STRB     r5,[sp,#3]            ;1072
001262  4669              MOV      r1,sp                 ;1073
001264  f104001c          ADD      r0,r4,#0x1c           ;1073
001268  f7fffffe          BL       lc640_write_long_ptr
00126c  b116              CBZ      r6,|L1.4724|
00126e  2e01              CMP      r6,#1                 ;1079
001270  d007              BEQ      |L1.4738|
001272  e08f              B        |L1.5012|
                  |L1.4724|
001274  2301              MOVS     r3,#1                 ;1077
001276  461a              MOV      r2,r3                 ;1077
001278  2105              MOVS     r1,#5                 ;1077
00127a  a068              ADR      r0,|L1.5148|
00127c  f7fffffe          BL       snmp_trap_send
001280  e088              B        |L1.5012|
                  |L1.4738|
001282  2301              MOVS     r3,#1                 ;1081
001284  2202              MOVS     r2,#2                 ;1081
001286  2105              MOVS     r1,#5                 ;1081
001288  a069              ADR      r0,|L1.5168|
00128a  f7fffffe          BL       snmp_trap_send
00128e  e081              B        |L1.5012|
                  |L1.4752|
;;;1087   	{
;;;1088   	bat[b]._av&=~1;
001290  f8101f3d          LDRB     r1,[r0,#0x3d]!
001294  f0210101          BIC      r1,r1,#1
001298  7001              STRB     r1,[r0,#0]
;;;1089   
;;;1090        event_ptr=lc640_read_int(PTR_EVENT_LOG);
00129a  4628              MOV      r0,r5
00129c  f7fffffe          BL       lc640_read_int
0012a0  b287              UXTH     r7,r0
;;;1091   	event_ptr_find=event_ptr;
0012a2  463c              MOV      r4,r7
                  |L1.4772|
;;;1092   	
;;;1093   avar_bat_hndl_lbl1: 
;;;1094   
;;;1095   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0012a4  eb0b1044          ADD      r0,r11,r4,LSL #5
0012a8  b285              UXTH     r5,r0
;;;1096   
;;;1097        lc640_read_long_ptr(lc640_adr,data);
0012aa  4669              MOV      r1,sp
0012ac  4628              MOV      r0,r5
0012ae  f7fffffe          BL       lc640_read_long_ptr
;;;1098        
;;;1099        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
0012b2  f89d0000          LDRB     r0,[sp,#0]
0012b6  2842              CMP      r0,#0x42
0012b8  d107              BNE      |L1.4810|
0012ba  f89d0001          LDRB     r0,[sp,#1]
0012be  42b0              CMP      r0,r6
0012c0  d103              BNE      |L1.4810|
0012c2  f89d0002          LDRB     r0,[sp,#2]
0012c6  2843              CMP      r0,#0x43
0012c8  d007              BEQ      |L1.4826|
                  |L1.4810|
;;;1100        	{        
;;;1101        	if(event_ptr_find)event_ptr_find--;
0012ca  b114              CBZ      r4,|L1.4818|
0012cc  1e64              SUBS     r4,r4,#1
0012ce  b2a4              UXTH     r4,r4
0012d0  e000              B        |L1.4820|
                  |L1.4818|
;;;1102        	else event_ptr_find=63;
0012d2  243f              MOVS     r4,#0x3f
                  |L1.4820|
;;;1103        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
0012d4  42bc              CMP      r4,r7
0012d6  d1e5              BNE      |L1.4772|
0012d8  e05c              B        |L1.5012|
                  |L1.4826|
;;;1104        	else goto avar_bat_hndl_lbl1;
;;;1105        	}
;;;1106        else 
;;;1107        	{
;;;1108        	lc640_read_long_ptr(lc640_adr+16,data);
0012da  4669              MOV      r1,sp
0012dc  f1050010          ADD      r0,r5,#0x10
0012e0  f7fffffe          BL       lc640_read_long_ptr
;;;1109        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0012e4  f89d0000          LDRB     r0,[sp,#0]
0012e8  2841              CMP      r0,#0x41
0012ea  d10b              BNE      |L1.4868|
0012ec  f89d0001          LDRB     r0,[sp,#1]
0012f0  2841              CMP      r0,#0x41
0012f2  d107              BNE      |L1.4868|
0012f4  f89d0002          LDRB     r0,[sp,#2]
0012f8  2841              CMP      r0,#0x41
0012fa  d103              BNE      |L1.4868|
0012fc  f89d0003          LDRB     r0,[sp,#3]
001300  2841              CMP      r0,#0x41
001302  d007              BEQ      |L1.4884|
                  |L1.4868|
;;;1110        		{        
;;;1111        		if(event_ptr_find)event_ptr_find--;
001304  b114              CBZ      r4,|L1.4876|
001306  1e64              SUBS     r4,r4,#1
001308  b2a4              UXTH     r4,r4
00130a  e000              B        |L1.4878|
                  |L1.4876|
;;;1112            		else event_ptr_find=63;
00130c  243f              MOVS     r4,#0x3f
                  |L1.4878|
;;;1113            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
00130e  42bc              CMP      r4,r7
001310  d1c8              BNE      |L1.4772|
001312  e03f              B        |L1.5012|
                  |L1.4884|
;;;1114        		else goto avar_bat_hndl_lbl1;
;;;1115        		}
;;;1116   
;;;1117        	}
;;;1118        		
;;;1119   	data[0]=LPC_RTC->YEAR;
001314  f8b8003c          LDRH     r0,[r8,#0x3c]
001318  f88d0000          STRB     r0,[sp,#0]
;;;1120   	data[1]=LPC_RTC->MONTH;
00131c  f8980038          LDRB     r0,[r8,#0x38]
001320  f88d0001          STRB     r0,[sp,#1]
;;;1121   	data[2]=LPC_RTC->DOM;
001324  f898002c          LDRB     r0,[r8,#0x2c]
001328  f88d0002          STRB     r0,[sp,#2]
;;;1122   	data[3]=0;
00132c  f88da003          STRB     r10,[sp,#3]
;;;1123   	lc640_write_long_ptr(lc640_adr+16,data);
001330  4669              MOV      r1,sp
001332  f1050010          ADD      r0,r5,#0x10
001336  f7fffffe          BL       lc640_write_long_ptr
;;;1124   
;;;1125   	data[0]=LPC_RTC->HOUR;
00133a  f8980028          LDRB     r0,[r8,#0x28]
00133e  f88d0000          STRB     r0,[sp,#0]
;;;1126   	data[1]=LPC_RTC->MIN;
001342  f8980024          LDRB     r0,[r8,#0x24]
001346  f88d0001          STRB     r0,[sp,#1]
;;;1127   	data[2]=LPC_RTC->SEC;
00134a  f8980020          LDRB     r0,[r8,#0x20]
00134e  f88d0002          STRB     r0,[sp,#2]
;;;1128   	data[3]=0;
001352  f88da003          STRB     r10,[sp,#3]
;;;1129   	lc640_write_long_ptr(lc640_adr+20,data);
001356  4669              MOV      r1,sp
001358  f1050014          ADD      r0,r5,#0x14
00135c  f7fffffe          BL       lc640_write_long_ptr
;;;1130   	
;;;1131   	data[0]='B';
001360  f88d9000          STRB     r9,[sp,#0]
;;;1132   	data[1]='B';
001364  f88d9001          STRB     r9,[sp,#1]
;;;1133   	data[2]='B';
001368  f88d9002          STRB     r9,[sp,#2]
;;;1134   	data[3]='B';
00136c  f88d9003          STRB     r9,[sp,#3]
;;;1135   	lc640_write_long_ptr(lc640_adr+24,data);
001370  4669              MOV      r1,sp
001372  f1050018          ADD      r0,r5,#0x18
001376  f7fffffe          BL       lc640_write_long_ptr
;;;1136   	
;;;1137   	data[0]='B';
00137a  f88d9000          STRB     r9,[sp,#0]
;;;1138   	data[1]='B';
00137e  f88d9001          STRB     r9,[sp,#1]
;;;1139   	data[2]='B';
001382  f88d9002          STRB     r9,[sp,#2]
;;;1140   	data[3]='B';
001386  f88d9003          STRB     r9,[sp,#3]
;;;1141   	lc640_write_long_ptr(lc640_adr+28,data);
00138a  4669              MOV      r1,sp
00138c  f105001c          ADD      r0,r5,#0x1c
001390  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5012|
;;;1142   	
;;;1143   
;;;1144   	
;;;1145   	}
;;;1146   	
;;;1147   avar_bat_hndl_end:
;;;1148   __nop();		
001394  bf00              NOP      
                  |L1.5014|
;;;1149   }
001396  e43c              B        |L1.3090|
;;;1150   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1151   //-----------------------------------------------
;;;1152   void avar_bat_as_hndl(char b, char in)
001398  e92d4ff8          PUSH     {r3-r11,lr}
;;;1153   {
00139c  4606              MOV      r6,r0
;;;1154   char data[4];
;;;1155   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1156   
;;;1157   if(in==1)
;;;1158   	{
;;;1159   	bat[b]._av|=2;
;;;1160       
;;;1161   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1162   	event_ptr++;	
;;;1163   	if(event_ptr>63)event_ptr=0;	
;;;1164   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1165   	
;;;1166        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1167   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1168   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1169   	
;;;1170   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1171   	
;;;1172   	data[0]='B';
;;;1173   	data[1]=b;
;;;1174   	data[2]='S';
;;;1175   	data[3]=0;
;;;1176   	lc640_write_long_ptr(lc640_adr,data);
;;;1177   
;;;1178   	data[0]=0;
;;;1179   	data[1]=0;
;;;1180   	data[2]=0;
;;;1181   	data[3]=0;
;;;1182   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1183   
;;;1184   	data[0]=LPC_RTC->YEAR;
00139e  f8df8078          LDR      r8,|L1.5144|
0013a2  f04f0a00          MOV      r10,#0                ;1163
0013a6  f04f0942          MOV      r9,#0x42              ;1172
0013aa  f44f6560          MOV      r5,#0xe00             ;1161
0013ae  f44f6b80          MOV      r11,#0x400            ;1170
0013b2  2901              CMP      r1,#1                 ;1157
0013b4  d001              BEQ      |L1.5050|
;;;1185   	data[1]=LPC_RTC->MONTH;
;;;1186   	data[2]=LPC_RTC->DOM;
;;;1187   	data[3]=0;
;;;1188   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1189   
;;;1190   	data[0]=LPC_RTC->HOUR;
;;;1191   	data[1]=LPC_RTC->MIN;
;;;1192   	data[2]=LPC_RTC->SEC;
;;;1193   	data[3]=0;
;;;1194   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1195   	
;;;1196   	data[0]='A';
;;;1197   	data[1]='A';
;;;1198   	data[2]='A';
;;;1199   	data[3]='A';
;;;1200   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1201   	
;;;1202   	data[0]='A';
;;;1203   	data[1]='A';
;;;1204   	data[2]='A';
;;;1205   	data[3]='A';
;;;1206   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1207   	
;;;1208   	data[0]='A';
;;;1209   	data[1]='A';
;;;1210   	data[2]='A';
;;;1211   	data[3]='A';
;;;1212   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1213   	
;;;1214   	data[0]='A';
;;;1215   	data[1]='A';
;;;1216   	data[2]='A';
;;;1217   	data[3]='A';
;;;1218   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1219   
;;;1220   	if(b==0)
;;;1221   		{
;;;1222   		snmp_trap_send("BAT #1 Alarm, assimetry",5,1,2);
;;;1223   		}
;;;1224   	else if(b==1)
;;;1225   		{
;;;1226   		snmp_trap_send("BAT #2 Alarm, assimetry",5,2,2);
;;;1227   		} 
;;;1228   	
;;;1229   	}
;;;1230   
;;;1231   else if(in==0)
0013b6  b311              CBZ      r1,|L1.5118|
0013b8  e14b              B        |L1.5714|
                  |L1.5050|
0013ba  eb060046          ADD      r0,r6,r6,LSL #1       ;1159
0013be  eb001106          ADD      r1,r0,r6,LSL #4       ;1159
0013c2  4814              LDR      r0,|L1.5140|
0013c4  eb000081          ADD      r0,r0,r1,LSL #2       ;1159
0013c8  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1159
0013cc  f0410102          ORR      r1,r1,#2              ;1159
0013d0  7001              STRB     r1,[r0,#0]            ;1159
0013d2  4628              MOV      r0,r5                 ;1161
0013d4  f7fffffe          BL       lc640_read_int
0013d8  1c40              ADDS     r0,r0,#1              ;1162
0013da  b284              UXTH     r4,r0                 ;1162
0013dc  2c3f              CMP      r4,#0x3f              ;1163
0013de  d900              BLS      |L1.5090|
0013e0  2400              MOVS     r4,#0                 ;1163
                  |L1.5090|
0013e2  b221              SXTH     r1,r4                 ;1164
0013e4  4628              MOV      r0,r5                 ;1164
0013e6  f7fffffe          BL       lc640_write_int
0013ea  f6406702          MOV      r7,#0xe02             ;1166
0013ee  4638              MOV      r0,r7                 ;1166
0013f0  f7fffffe          BL       lc640_read_int
0013f4  b280              UXTH     r0,r0                 ;1166
0013f6  283f              CMP      r0,#0x3f              ;1167
0013f8  d000              BEQ      |L1.5116|
0013fa  4620              MOV      r0,r4                 ;1167
                  |L1.5116|
0013fc  e022              B        |L1.5188|
                  |L1.5118|
0013fe  e0ab              B        |L1.5464|
                  |L1.5120|
001400  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
001404  b9312041
001408  6c61726d
00140c  2c206c6f
001410  737400  
001413  00                DCB      0
                  |L1.5140|
                          DCD      bat
                  |L1.5144|
                          DCD      0x40024000
                  |L1.5148|
00141c  42415420          DCB      "BAT #1 Alarm, lost",0
001420  23312041
001424  6c61726d
001428  2c206c6f
00142c  737400  
00142f  00                DCB      0
                  |L1.5168|
001430  42415420          DCB      "BAT #2 Alarm, lost",0
001434  23322041
001438  6c61726d
00143c  2c206c6f
001440  737400  
001443  00                DCB      0
                  |L1.5188|
001444  b201              SXTH     r1,r0                 ;1168
001446  4638              MOV      r0,r7                 ;1168
001448  f7fffffe          BL       lc640_write_int
00144c  4628              MOV      r0,r5                 ;1170
00144e  f7fffffe          BL       lc640_read_int
001452  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1170
001456  b284              UXTH     r4,r0                 ;1170
001458  f88d9000          STRB     r9,[sp,#0]            ;1172
00145c  f88d6001          STRB     r6,[sp,#1]            ;1173
001460  2053              MOVS     r0,#0x53              ;1174
001462  f88d0002          STRB     r0,[sp,#2]            ;1174
001466  f88da003          STRB     r10,[sp,#3]           ;1175
00146a  4669              MOV      r1,sp                 ;1176
00146c  4620              MOV      r0,r4                 ;1176
00146e  f7fffffe          BL       lc640_write_long_ptr
001472  f8cda000          STR      r10,[sp,#0]           ;1181
001476  4669              MOV      r1,sp                 ;1182
001478  1d20              ADDS     r0,r4,#4              ;1182
00147a  f7fffffe          BL       lc640_write_long_ptr
00147e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1184
001482  f88d0000          STRB     r0,[sp,#0]            ;1184
001486  f8980038          LDRB     r0,[r8,#0x38]         ;1185
00148a  f88d0001          STRB     r0,[sp,#1]            ;1185
00148e  f898002c          LDRB     r0,[r8,#0x2c]         ;1186
001492  f88d0002          STRB     r0,[sp,#2]            ;1186
001496  f88da003          STRB     r10,[sp,#3]           ;1187
00149a  4669              MOV      r1,sp                 ;1188
00149c  f1040008          ADD      r0,r4,#8              ;1188
0014a0  f7fffffe          BL       lc640_write_long_ptr
0014a4  f8980028          LDRB     r0,[r8,#0x28]         ;1190
0014a8  f88d0000          STRB     r0,[sp,#0]            ;1190
0014ac  f8980024          LDRB     r0,[r8,#0x24]         ;1191
0014b0  f88d0001          STRB     r0,[sp,#1]            ;1191
0014b4  f8980020          LDRB     r0,[r8,#0x20]         ;1192
0014b8  f88d0002          STRB     r0,[sp,#2]            ;1192
0014bc  f88da003          STRB     r10,[sp,#3]           ;1193
0014c0  4669              MOV      r1,sp                 ;1194
0014c2  f104000c          ADD      r0,r4,#0xc            ;1194
0014c6  f7fffffe          BL       lc640_write_long_ptr
0014ca  2541              MOVS     r5,#0x41              ;1196
0014cc  f88d5000          STRB     r5,[sp,#0]            ;1196
0014d0  f88d5001          STRB     r5,[sp,#1]            ;1197
0014d4  f88d5002          STRB     r5,[sp,#2]            ;1198
0014d8  f88d5003          STRB     r5,[sp,#3]            ;1199
0014dc  4669              MOV      r1,sp                 ;1200
0014de  f1040010          ADD      r0,r4,#0x10           ;1200
0014e2  f7fffffe          BL       lc640_write_long_ptr
0014e6  f88d5000          STRB     r5,[sp,#0]            ;1202
0014ea  f88d5001          STRB     r5,[sp,#1]            ;1203
0014ee  f88d5002          STRB     r5,[sp,#2]            ;1204
0014f2  f88d5003          STRB     r5,[sp,#3]            ;1205
0014f6  4669              MOV      r1,sp                 ;1206
0014f8  f1040014          ADD      r0,r4,#0x14           ;1206
0014fc  f7fffffe          BL       lc640_write_long_ptr
001500  f88d5000          STRB     r5,[sp,#0]            ;1208
001504  f88d5001          STRB     r5,[sp,#1]            ;1209
001508  f88d5002          STRB     r5,[sp,#2]            ;1210
00150c  f88d5003          STRB     r5,[sp,#3]            ;1211
001510  4669              MOV      r1,sp                 ;1212
001512  f1040018          ADD      r0,r4,#0x18           ;1212
001516  f7fffffe          BL       lc640_write_long_ptr
00151a  f88d5000          STRB     r5,[sp,#0]            ;1214
00151e  f88d5001          STRB     r5,[sp,#1]            ;1215
001522  f88d5002          STRB     r5,[sp,#2]            ;1216
001526  f88d5003          STRB     r5,[sp,#3]            ;1217
00152a  4669              MOV      r1,sp                 ;1218
00152c  f104001c          ADD      r0,r4,#0x1c           ;1218
001530  f7fffffe          BL       lc640_write_long_ptr
001534  b116              CBZ      r6,|L1.5436|
001536  2e01              CMP      r6,#1                 ;1224
001538  d007              BEQ      |L1.5450|
00153a  e08a              B        |L1.5714|
                  |L1.5436|
00153c  2302              MOVS     r3,#2                 ;1222
00153e  2201              MOVS     r2,#1                 ;1222
001540  2105              MOVS     r1,#5                 ;1222
001542  a0fd              ADR      r0,|L1.6456|
001544  f7fffffe          BL       snmp_trap_send
001548  e083              B        |L1.5714|
                  |L1.5450|
00154a  2302              MOVS     r3,#2                 ;1226
00154c  461a              MOV      r2,r3                 ;1226
00154e  2105              MOVS     r1,#5                 ;1226
001550  a0ff              ADR      r0,|L1.6480|
001552  f7fffffe          BL       snmp_trap_send
001556  e07c              B        |L1.5714|
                  |L1.5464|
;;;1232   	{
;;;1233   	//bat[b]._av=0;
;;;1234   
;;;1235        event_ptr=lc640_read_int(PTR_EVENT_LOG);
001558  4628              MOV      r0,r5
00155a  f7fffffe          BL       lc640_read_int
00155e  b287              UXTH     r7,r0
;;;1236   	event_ptr_find=event_ptr;
001560  463c              MOV      r4,r7
                  |L1.5474|
;;;1237   	
;;;1238   avar_bat_as_hndl_lbl1: 
;;;1239   
;;;1240   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001562  eb0b1044          ADD      r0,r11,r4,LSL #5
001566  b285              UXTH     r5,r0
;;;1241   
;;;1242        lc640_read_long_ptr(lc640_adr,data);
001568  4669              MOV      r1,sp
00156a  4628              MOV      r0,r5
00156c  f7fffffe          BL       lc640_read_long_ptr
;;;1243        
;;;1244        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
001570  f89d0000          LDRB     r0,[sp,#0]
001574  2842              CMP      r0,#0x42
001576  d107              BNE      |L1.5512|
001578  f89d0001          LDRB     r0,[sp,#1]
00157c  42b0              CMP      r0,r6
00157e  d103              BNE      |L1.5512|
001580  f89d0002          LDRB     r0,[sp,#2]
001584  2843              CMP      r0,#0x43
001586  d007              BEQ      |L1.5528|
                  |L1.5512|
;;;1245        	{        
;;;1246        	if(event_ptr_find)event_ptr_find--;
001588  b114              CBZ      r4,|L1.5520|
00158a  1e64              SUBS     r4,r4,#1
00158c  b2a4              UXTH     r4,r4
00158e  e000              B        |L1.5522|
                  |L1.5520|
;;;1247        	else event_ptr_find=63;
001590  243f              MOVS     r4,#0x3f
                  |L1.5522|
;;;1248        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001592  42bc              CMP      r4,r7
001594  d1e5              BNE      |L1.5474|
001596  e05c              B        |L1.5714|
                  |L1.5528|
;;;1249        	else goto avar_bat_as_hndl_lbl1;
;;;1250        	}
;;;1251        else 
;;;1252        	{
;;;1253        	lc640_read_long_ptr(lc640_adr+16,data);
001598  4669              MOV      r1,sp
00159a  f1050010          ADD      r0,r5,#0x10
00159e  f7fffffe          BL       lc640_read_long_ptr
;;;1254        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0015a2  f89d0000          LDRB     r0,[sp,#0]
0015a6  2841              CMP      r0,#0x41
0015a8  d10b              BNE      |L1.5570|
0015aa  f89d0001          LDRB     r0,[sp,#1]
0015ae  2841              CMP      r0,#0x41
0015b0  d107              BNE      |L1.5570|
0015b2  f89d0002          LDRB     r0,[sp,#2]
0015b6  2841              CMP      r0,#0x41
0015b8  d103              BNE      |L1.5570|
0015ba  f89d0003          LDRB     r0,[sp,#3]
0015be  2841              CMP      r0,#0x41
0015c0  d007              BEQ      |L1.5586|
                  |L1.5570|
;;;1255        		{        
;;;1256        		if(event_ptr_find)event_ptr_find--;
0015c2  b114              CBZ      r4,|L1.5578|
0015c4  1e64              SUBS     r4,r4,#1
0015c6  b2a4              UXTH     r4,r4
0015c8  e000              B        |L1.5580|
                  |L1.5578|
;;;1257            		else event_ptr_find=63;
0015ca  243f              MOVS     r4,#0x3f
                  |L1.5580|
;;;1258            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
0015cc  42bc              CMP      r4,r7
0015ce  d1c8              BNE      |L1.5474|
0015d0  e03f              B        |L1.5714|
                  |L1.5586|
;;;1259        		else goto avar_bat_as_hndl_lbl1;
;;;1260        		}
;;;1261   
;;;1262        	}
;;;1263        		
;;;1264   	data[0]=LPC_RTC->YEAR;
0015d2  f8b8003c          LDRH     r0,[r8,#0x3c]
0015d6  f88d0000          STRB     r0,[sp,#0]
;;;1265   	data[1]=LPC_RTC->MONTH;
0015da  f8980038          LDRB     r0,[r8,#0x38]
0015de  f88d0001          STRB     r0,[sp,#1]
;;;1266   	data[2]=LPC_RTC->DOM;
0015e2  f898002c          LDRB     r0,[r8,#0x2c]
0015e6  f88d0002          STRB     r0,[sp,#2]
;;;1267   	data[3]=0;
0015ea  f88da003          STRB     r10,[sp,#3]
;;;1268   	lc640_write_long_ptr(lc640_adr+16,data);
0015ee  4669              MOV      r1,sp
0015f0  f1050010          ADD      r0,r5,#0x10
0015f4  f7fffffe          BL       lc640_write_long_ptr
;;;1269   
;;;1270   	data[0]=LPC_RTC->HOUR;
0015f8  f8980028          LDRB     r0,[r8,#0x28]
0015fc  f88d0000          STRB     r0,[sp,#0]
;;;1271   	data[1]=LPC_RTC->MIN;
001600  f8980024          LDRB     r0,[r8,#0x24]
001604  f88d0001          STRB     r0,[sp,#1]
;;;1272   	data[2]=LPC_RTC->SEC;
001608  f8980020          LDRB     r0,[r8,#0x20]
00160c  f88d0002          STRB     r0,[sp,#2]
;;;1273   	data[3]=0;
001610  f88da003          STRB     r10,[sp,#3]
;;;1274   	lc640_write_long_ptr(lc640_adr+20,data);
001614  4669              MOV      r1,sp
001616  f1050014          ADD      r0,r5,#0x14
00161a  f7fffffe          BL       lc640_write_long_ptr
;;;1275   	
;;;1276   	data[0]='B';
00161e  f88d9000          STRB     r9,[sp,#0]
;;;1277   	data[1]='B';
001622  f88d9001          STRB     r9,[sp,#1]
;;;1278   	data[2]='B';
001626  f88d9002          STRB     r9,[sp,#2]
;;;1279   	data[3]='B';
00162a  f88d9003          STRB     r9,[sp,#3]
;;;1280   	lc640_write_long_ptr(lc640_adr+24,data);
00162e  4669              MOV      r1,sp
001630  f1050018          ADD      r0,r5,#0x18
001634  f7fffffe          BL       lc640_write_long_ptr
;;;1281   	
;;;1282   	data[0]='B';
001638  f88d9000          STRB     r9,[sp,#0]
;;;1283   	data[1]='B';
00163c  f88d9001          STRB     r9,[sp,#1]
;;;1284   	data[2]='B';
001640  f88d9002          STRB     r9,[sp,#2]
;;;1285   	data[3]='B';
001644  f88d9003          STRB     r9,[sp,#3]
;;;1286   	lc640_write_long_ptr(lc640_adr+28,data);
001648  4669              MOV      r1,sp
00164a  f105001c          ADD      r0,r5,#0x1c
00164e  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5714|
;;;1287   	
;;;1288   
;;;1289   	
;;;1290   	}
;;;1291   	
;;;1292   avar_bat_as_hndl_end:
;;;1293   __nop();		
001652  bf00              NOP      
;;;1294   }
001654  e55d              B        |L1.4370|
;;;1295   
                          ENDP

                  ke_mem_hndl PROC
;;;1297   //-----------------------------------------------
;;;1298   void ke_mem_hndl(char b,unsigned short in)
001656  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;1299   {
001658  b083              SUB      sp,sp,#0xc
00165a  4605              MOV      r5,r0
;;;1300   char data[4];
;;;1301   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1302   //unsigned char temp,temp_;
;;;1303   //unsigned int tempUI;
;;;1304   //unsigned long tempUL; 
;;;1305   signed temp_temp;
;;;1306   
;;;1307   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
00165c  eb050045          ADD      r0,r5,r5,LSL #1
001660  49c1              LDR      r1,|L1.6504|
001662  eb001005          ADD      r0,r0,r5,LSL #4
001666  eb010180          ADD      r1,r1,r0,LSL #2
00166a  48c0              LDR      r0,|L1.6508|
00166c  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
001670  1c40              ADDS     r0,r0,#1
001672  eb010040          ADD      r0,r1,r0,LSL #1
001676  f9b00020          LDRSH    r0,[r0,#0x20]
00167a  9001              STR      r0,[sp,#4]
;;;1308   
;;;1309   event_ptr=lc640_read_int(PTR_EVENT_LOG);
00167c  f44f6660          MOV      r6,#0xe00
001680  4630              MOV      r0,r6
001682  f7fffffe          BL       lc640_read_int
;;;1310   event_ptr++;	
001686  1c44              ADDS     r4,r0,#1
;;;1311   if(event_ptr>63)event_ptr=0;	
001688  2c3f              CMP      r4,#0x3f
00168a  d900              BLS      |L1.5774|
00168c  2400              MOVS     r4,#0
                  |L1.5774|
;;;1312   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
00168e  b221              SXTH     r1,r4
001690  4630              MOV      r0,r6
001692  f7fffffe          BL       lc640_write_int
;;;1313   	
;;;1314   event_cnt=lc640_read_int(CNT_EVENT_LOG);
001696  f6406702          MOV      r7,#0xe02
00169a  4638              MOV      r0,r7
00169c  f7fffffe          BL       lc640_read_int
;;;1315   if(event_cnt!=63)event_cnt=event_ptr;
0016a0  283f              CMP      r0,#0x3f
0016a2  d000              BEQ      |L1.5798|
0016a4  4620              MOV      r0,r4
                  |L1.5798|
;;;1316   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
0016a6  b201              SXTH     r1,r0
0016a8  4638              MOV      r0,r7
0016aa  f7fffffe          BL       lc640_write_int
;;;1317   	
;;;1318   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
0016ae  4630              MOV      r0,r6
0016b0  f7fffffe          BL       lc640_read_int
0016b4  f44f6180          MOV      r1,#0x400
0016b8  eb011440          ADD      r4,r1,r0,LSL #5
;;;1319   	
;;;1320   data[0]='B';
0016bc  2042              MOVS     r0,#0x42
0016be  f88d0008          STRB     r0,[sp,#8]
;;;1321   data[1]=b; 
0016c2  f88d5009          STRB     r5,[sp,#9]
;;;1322   data[2]='K';
0016c6  204b              MOVS     r0,#0x4b
0016c8  f88d000a          STRB     r0,[sp,#0xa]
;;;1323   data[3]=0;
0016cc  2600              MOVS     r6,#0
0016ce  f88d600b          STRB     r6,[sp,#0xb]
;;;1324   
;;;1325   lc640_write_long_ptr(lc640_adr,data);
0016d2  a902              ADD      r1,sp,#8
0016d4  4620              MOV      r0,r4
0016d6  f7fffffe          BL       lc640_write_long_ptr
;;;1326   
;;;1327   data[0]=*((char*)&in);
0016da  f89d0010          LDRB     r0,[sp,#0x10]
0016de  f88d0008          STRB     r0,[sp,#8]
;;;1328   data[1]=*(((char*)(&in))+1);
0016e2  f89d0011          LDRB     r0,[sp,#0x11]
0016e6  f88d0009          STRB     r0,[sp,#9]
;;;1329   data[2]=*((char*)&temp_temp);
0016ea  f89d0004          LDRB     r0,[sp,#4]
0016ee  f88d000a          STRB     r0,[sp,#0xa]
;;;1330   data[3]=*(((char*)(&temp_temp))+1);
0016f2  f89d0005          LDRB     r0,[sp,#5]
0016f6  f88d000b          STRB     r0,[sp,#0xb]
;;;1331   lc640_write_long_ptr(lc640_adr+4,data);
0016fa  a902              ADD      r1,sp,#8
0016fc  1d20              ADDS     r0,r4,#4
0016fe  f7fffffe          BL       lc640_write_long_ptr
;;;1332   
;;;1333   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
001702  f44f70fc          MOV      r0,#0x1f8
001706  f7fffffe          BL       lc640_read_long
00170a  4d99              LDR      r5,|L1.6512|
00170c  6028              STR      r0,[r5,#0]  ; ke_date
;;;1334   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
00170e  4629              MOV      r1,r5
001710  f1040008          ADD      r0,r4,#8
001714  f7fffffe          BL       lc640_write_long_ptr
;;;1335   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
001718  f44f70fe          MOV      r0,#0x1fc
00171c  f7fffffe          BL       lc640_read_long
001720  6068              STR      r0,[r5,#4]  ; ke_date
;;;1336   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
001722  1d29              ADDS     r1,r5,#4
001724  f104000c          ADD      r0,r4,#0xc
001728  f7fffffe          BL       lc640_write_long_ptr
;;;1337   
;;;1338   data[0]=LPC_RTC->YEAR;
00172c  4d91              LDR      r5,|L1.6516|
00172e  8ba8              LDRH     r0,[r5,#0x1c]
001730  f88d0008          STRB     r0,[sp,#8]
;;;1339   data[1]=LPC_RTC->MONTH;
001734  7e28              LDRB     r0,[r5,#0x18]
001736  f88d0009          STRB     r0,[sp,#9]
;;;1340   data[2]=LPC_RTC->DOM;
00173a  7b28              LDRB     r0,[r5,#0xc]
00173c  f88d000a          STRB     r0,[sp,#0xa]
;;;1341   data[3]=0;
001740  f88d600b          STRB     r6,[sp,#0xb]
;;;1342   lc640_write_long_ptr(lc640_adr+16,data);
001744  a902              ADD      r1,sp,#8
001746  f1040010          ADD      r0,r4,#0x10
00174a  f7fffffe          BL       lc640_write_long_ptr
;;;1343   
;;;1344   data[0]=LPC_RTC->HOUR;
00174e  7a28              LDRB     r0,[r5,#8]
001750  f88d0008          STRB     r0,[sp,#8]
;;;1345   data[1]=LPC_RTC->MIN;
001754  7928              LDRB     r0,[r5,#4]
001756  f88d0009          STRB     r0,[sp,#9]
;;;1346   data[2]=LPC_RTC->SEC;
00175a  7828              LDRB     r0,[r5,#0]
00175c  f88d000a          STRB     r0,[sp,#0xa]
;;;1347   data[3]=0;
001760  f88d600b          STRB     r6,[sp,#0xb]
;;;1348   lc640_write_long_ptr(lc640_adr+20,data);
001764  a902              ADD      r1,sp,#8
001766  f1040014          ADD      r0,r4,#0x14
00176a  f7fffffe          BL       lc640_write_long_ptr
;;;1349    
;;;1350   }
00176e  b005              ADD      sp,sp,#0x14
001770  bdf0              POP      {r4-r7,pc}
;;;1351   
                          ENDP

                  vz_mem_hndl PROC
;;;1353   //-----------------------------------------------
;;;1354   void vz_mem_hndl(unsigned short in)
001772  e92d4ff8          PUSH     {r3-r11,lr}
;;;1355   {
;;;1356   char data[4];
;;;1357   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001776  2600              MOVS     r6,#0
001778  2400              MOVS     r4,#0
;;;1358   //char avar_simbol;
;;;1359   
;;;1360   if(in==1)
;;;1361   	{
;;;1362   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1363   	event_ptr++;	
;;;1364   	if(event_ptr>63)event_ptr=0;	
;;;1365   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1366   	
;;;1367        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1368   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1369   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1370   	
;;;1371   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1372   	
;;;1373   	data[0]='B';
;;;1374   	data[1]=0; 
;;;1375   	data[2]='Z';
;;;1376   	data[3]=0;
;;;1377   	lc640_write_long_ptr(lc640_adr,data);
;;;1378   
;;;1379   	data[0]=0;
;;;1380   	data[1]=0;
;;;1381   	data[2]=0;
;;;1382   	data[3]=0;
;;;1383   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1384   
;;;1385   	data[0]=LPC_RTC->YEAR;
00177a  f8df81f8          LDR      r8,|L1.6516|
00177e  2742              MOVS     r7,#0x42              ;1373
001780  46a1              MOV      r9,r4                 ;1357
001782  f1a80820          SUB      r8,r8,#0x20
001786  f44f6a80          MOV      r10,#0x400            ;1371
00178a  2801              CMP      r0,#1                 ;1360
00178c  d001              BEQ      |L1.6034|
;;;1386   	data[1]=LPC_RTC->MONTH;
;;;1387   	data[2]=LPC_RTC->DOM;
;;;1388   	data[3]=0;
;;;1389   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1390   
;;;1391   	data[0]=LPC_RTC->HOUR;
;;;1392   	data[1]=LPC_RTC->MIN;
;;;1393   	data[2]=LPC_RTC->SEC;
;;;1394   	data[3]=0;
;;;1395   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1396   	
;;;1397   	data[0]='A';
;;;1398   	data[1]='A';
;;;1399   	data[2]='A';
;;;1400   	data[3]='A';
;;;1401   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1402   	
;;;1403   	data[0]='A';
;;;1404   	data[1]='A';
;;;1405   	data[2]='A';
;;;1406   	data[3]='A';
;;;1407   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1408   	
;;;1409   	data[0]='A';
;;;1410   	data[1]='A';
;;;1411   	data[2]='A';
;;;1412   	data[3]='A';
;;;1413   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1414   	
;;;1415   	data[0]='A';
;;;1416   	data[1]='A';
;;;1417   	data[2]='A';
;;;1418   	data[3]='A';
;;;1419   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1420    	
;;;1421   	}
;;;1422   
;;;1423   else if(in==0)
00178e  b3f0              CBZ      r0,|L1.6158|
001790  e121              B        |L1.6614|
                  |L1.6034|
001792  f44f6560          MOV      r5,#0xe00             ;1362
001796  4628              MOV      r0,r5                 ;1362
001798  f7fffffe          BL       lc640_read_int
00179c  1c44              ADDS     r4,r0,#1              ;1363
00179e  2c3f              CMP      r4,#0x3f              ;1364
0017a0  d900              BLS      |L1.6052|
0017a2  2400              MOVS     r4,#0                 ;1364
                  |L1.6052|
0017a4  b221              SXTH     r1,r4                 ;1365
0017a6  4628              MOV      r0,r5                 ;1365
0017a8  f7fffffe          BL       lc640_write_int
0017ac  f6406602          MOV      r6,#0xe02             ;1367
0017b0  4630              MOV      r0,r6                 ;1367
0017b2  f7fffffe          BL       lc640_read_int
0017b6  283f              CMP      r0,#0x3f              ;1368
0017b8  d000              BEQ      |L1.6076|
0017ba  4620              MOV      r0,r4                 ;1368
                  |L1.6076|
0017bc  b201              SXTH     r1,r0                 ;1369
0017be  4630              MOV      r0,r6                 ;1369
0017c0  f7fffffe          BL       lc640_write_int
0017c4  4628              MOV      r0,r5                 ;1371
0017c6  f7fffffe          BL       lc640_read_int
0017ca  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1371
0017ce  f88d7000          STRB     r7,[sp,#0]            ;1373
0017d2  f88d9001          STRB     r9,[sp,#1]            ;1374
0017d6  205a              MOVS     r0,#0x5a              ;1375
0017d8  f88d0002          STRB     r0,[sp,#2]            ;1375
0017dc  f88d9003          STRB     r9,[sp,#3]            ;1376
0017e0  4669              MOV      r1,sp                 ;1377
0017e2  4620              MOV      r0,r4                 ;1377
0017e4  f7fffffe          BL       lc640_write_long_ptr
0017e8  f8cd9000          STR      r9,[sp,#0]            ;1382
0017ec  4669              MOV      r1,sp                 ;1383
0017ee  1d20              ADDS     r0,r4,#4              ;1383
0017f0  f7fffffe          BL       lc640_write_long_ptr
0017f4  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1385
0017f8  f88d0000          STRB     r0,[sp,#0]            ;1385
0017fc  f8980038          LDRB     r0,[r8,#0x38]         ;1386
001800  f88d0001          STRB     r0,[sp,#1]            ;1386
001804  f898002c          LDRB     r0,[r8,#0x2c]         ;1387
001808  f88d0002          STRB     r0,[sp,#2]            ;1387
00180c  e000              B        |L1.6160|
                  |L1.6158|
00180e  e04f              B        |L1.6320|
                  |L1.6160|
001810  f88d9003          STRB     r9,[sp,#3]            ;1388
001814  4669              MOV      r1,sp                 ;1389
001816  f1040008          ADD      r0,r4,#8              ;1389
00181a  f7fffffe          BL       lc640_write_long_ptr
00181e  f8980028          LDRB     r0,[r8,#0x28]         ;1391
001822  f88d0000          STRB     r0,[sp,#0]            ;1391
001826  f8980024          LDRB     r0,[r8,#0x24]         ;1392
00182a  f88d0001          STRB     r0,[sp,#1]            ;1392
00182e  f8980020          LDRB     r0,[r8,#0x20]         ;1393
001832  f88d0002          STRB     r0,[sp,#2]            ;1393
001836  f88d9003          STRB     r9,[sp,#3]            ;1394
00183a  4669              MOV      r1,sp                 ;1395
00183c  f104000c          ADD      r0,r4,#0xc            ;1395
001840  f7fffffe          BL       lc640_write_long_ptr
001844  2541              MOVS     r5,#0x41              ;1397
001846  f88d5000          STRB     r5,[sp,#0]            ;1397
00184a  f88d5001          STRB     r5,[sp,#1]            ;1398
00184e  f88d5002          STRB     r5,[sp,#2]            ;1399
001852  f88d5003          STRB     r5,[sp,#3]            ;1400
001856  4669              MOV      r1,sp                 ;1401
001858  f1040010          ADD      r0,r4,#0x10           ;1401
00185c  f7fffffe          BL       lc640_write_long_ptr
001860  f88d5000          STRB     r5,[sp,#0]            ;1403
001864  f88d5001          STRB     r5,[sp,#1]            ;1404
001868  f88d5002          STRB     r5,[sp,#2]            ;1405
00186c  f88d5003          STRB     r5,[sp,#3]            ;1406
001870  4669              MOV      r1,sp                 ;1407
001872  f1040014          ADD      r0,r4,#0x14           ;1407
001876  f7fffffe          BL       lc640_write_long_ptr
00187a  f88d5000          STRB     r5,[sp,#0]            ;1409
00187e  f88d5001          STRB     r5,[sp,#1]            ;1410
001882  f88d5002          STRB     r5,[sp,#2]            ;1411
001886  f88d5003          STRB     r5,[sp,#3]            ;1412
00188a  4669              MOV      r1,sp                 ;1413
00188c  f1040018          ADD      r0,r4,#0x18           ;1413
001890  f7fffffe          BL       lc640_write_long_ptr
001894  f88d5000          STRB     r5,[sp,#0]            ;1415
001898  f88d5001          STRB     r5,[sp,#1]            ;1416
00189c  f88d5002          STRB     r5,[sp,#2]            ;1417
0018a0  f88d5003          STRB     r5,[sp,#3]            ;1418
0018a4  4669              MOV      r1,sp                 ;1419
0018a6  f104001c          ADD      r0,r4,#0x1c           ;1419
0018aa  f7fffffe          BL       lc640_write_long_ptr
0018ae  e092              B        |L1.6614|
                  |L1.6320|
;;;1424   	{      
;;;1425        
;;;1426   vz_mem_hndl_lbl1: 
;;;1427   
;;;1428   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0018b0  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1429   
;;;1430        lc640_read_long_ptr(lc640_adr,data);
0018b4  4669              MOV      r1,sp
0018b6  4628              MOV      r0,r5
0018b8  f7fffffe          BL       lc640_read_long_ptr
;;;1431        
;;;1432        if(!((data[0]=='B')&&(data[2]=='Z')))
0018bc  f89d0000          LDRB     r0,[sp,#0]
0018c0  2842              CMP      r0,#0x42
0018c2  d103              BNE      |L1.6348|
0018c4  f89d0002          LDRB     r0,[sp,#2]
0018c8  285a              CMP      r0,#0x5a
0018ca  d006              BEQ      |L1.6362|
                  |L1.6348|
;;;1433        	{        
;;;1434        	if(event_ptr_find)event_ptr_find--;
0018cc  b10c              CBZ      r4,|L1.6354|
0018ce  1e64              SUBS     r4,r4,#1
0018d0  e000              B        |L1.6356|
                  |L1.6354|
;;;1435        	else event_ptr_find=63;
0018d2  243f              MOVS     r4,#0x3f
                  |L1.6356|
;;;1436        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
0018d4  42b4              CMP      r4,r6
0018d6  d1eb              BNE      |L1.6320|
0018d8  e07d              B        |L1.6614|
                  |L1.6362|
;;;1437        	else goto vz_mem_hndl_lbl1;
;;;1438        	}
;;;1439        else 
;;;1440        	{
;;;1441        	lc640_read_long_ptr(lc640_adr+16,data);
0018da  4669              MOV      r1,sp
0018dc  f1050010          ADD      r0,r5,#0x10
0018e0  f7fffffe          BL       lc640_read_long_ptr
;;;1442        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0018e4  f89d0000          LDRB     r0,[sp,#0]
0018e8  2841              CMP      r0,#0x41
0018ea  d10b              BNE      |L1.6404|
0018ec  f89d0001          LDRB     r0,[sp,#1]
0018f0  2841              CMP      r0,#0x41
0018f2  d107              BNE      |L1.6404|
0018f4  f89d0002          LDRB     r0,[sp,#2]
0018f8  2841              CMP      r0,#0x41
0018fa  d103              BNE      |L1.6404|
0018fc  f89d0003          LDRB     r0,[sp,#3]
001900  2841              CMP      r0,#0x41
001902  d006              BEQ      |L1.6418|
                  |L1.6404|
;;;1443        		{        
;;;1444        		if(event_ptr_find)event_ptr_find--;
001904  b10c              CBZ      r4,|L1.6410|
001906  1e64              SUBS     r4,r4,#1
001908  e000              B        |L1.6412|
                  |L1.6410|
;;;1445            		else event_ptr_find=63;
00190a  243f              MOVS     r4,#0x3f
                  |L1.6412|
;;;1446            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
00190c  42b4              CMP      r4,r6
00190e  d1cf              BNE      |L1.6320|
001910  e061              B        |L1.6614|
                  |L1.6418|
;;;1447        		else goto vz_mem_hndl_lbl1;
;;;1448        		}
;;;1449   
;;;1450        	}	
;;;1451   
;;;1452   
;;;1453   	
;;;1454   	data[0]=LPC_RTC->YEAR;
001912  f8b8003c          LDRH     r0,[r8,#0x3c]
001916  f88d0000          STRB     r0,[sp,#0]
;;;1455   	data[1]=LPC_RTC->MONTH;
00191a  f8980038          LDRB     r0,[r8,#0x38]
00191e  f88d0001          STRB     r0,[sp,#1]
;;;1456   	data[2]=LPC_RTC->DOM;
001922  f898002c          LDRB     r0,[r8,#0x2c]
001926  f88d0002          STRB     r0,[sp,#2]
;;;1457   	data[3]=0;
00192a  f88d9003          STRB     r9,[sp,#3]
;;;1458   	lc640_write_long_ptr(lc640_adr+16,data);
00192e  4669              MOV      r1,sp
001930  f1050010          ADD      r0,r5,#0x10
001934  e020              B        |L1.6520|
001936  0000              DCW      0x0000
                  |L1.6456|
001938  42415420          DCB      "BAT #1 Alarm, assimetry",0
00193c  23312041
001940  6c61726d
001944  2c206173
001948  73696d65
00194c  74727900
                  |L1.6480|
001950  42415420          DCB      "BAT #2 Alarm, assimetry",0
001954  23322041
001958  6c61726d
00195c  2c206173
001960  73696d65
001964  74727900
                  |L1.6504|
                          DCD      bat
                  |L1.6508|
                          DCD      bat_u_old_cnt
                  |L1.6512|
                          DCD      ke_date
                  |L1.6516|
                          DCD      0x40024020
                  |L1.6520|
001978  f7fffffe          BL       lc640_write_long_ptr
;;;1459   
;;;1460   	data[0]=LPC_RTC->HOUR;
00197c  f8980028          LDRB     r0,[r8,#0x28]
001980  f88d0000          STRB     r0,[sp,#0]
;;;1461   	data[1]=LPC_RTC->MIN;
001984  f8980024          LDRB     r0,[r8,#0x24]
001988  f88d0001          STRB     r0,[sp,#1]
;;;1462   	data[2]=LPC_RTC->SEC;
00198c  f8980020          LDRB     r0,[r8,#0x20]
001990  f88d0002          STRB     r0,[sp,#2]
;;;1463   	data[3]=0;
001994  f88d9003          STRB     r9,[sp,#3]
;;;1464   	lc640_write_long_ptr(lc640_adr+20,data);
001998  4669              MOV      r1,sp
00199a  f1050014          ADD      r0,r5,#0x14
00199e  f7fffffe          BL       lc640_write_long_ptr
;;;1465   	
;;;1466   	data[0]='B';
0019a2  f88d7000          STRB     r7,[sp,#0]
;;;1467   	data[1]='B';
0019a6  f88d7001          STRB     r7,[sp,#1]
;;;1468   	data[2]='B';
0019aa  f88d7002          STRB     r7,[sp,#2]
;;;1469   	data[3]='B';
0019ae  f88d7003          STRB     r7,[sp,#3]
;;;1470   	lc640_write_long_ptr(lc640_adr+24,data);
0019b2  4669              MOV      r1,sp
0019b4  f1050018          ADD      r0,r5,#0x18
0019b8  f7fffffe          BL       lc640_write_long_ptr
;;;1471   	
;;;1472   	data[0]='B';
0019bc  f88d7000          STRB     r7,[sp,#0]
;;;1473   	data[1]='B';
0019c0  f88d7001          STRB     r7,[sp,#1]
;;;1474   	data[2]='B';
0019c4  f88d7002          STRB     r7,[sp,#2]
;;;1475   	data[3]='B';
0019c8  f88d7003          STRB     r7,[sp,#3]
;;;1476   	lc640_write_long_ptr(lc640_adr+28,data);
0019cc  4669              MOV      r1,sp
0019ce  f105001c          ADD      r0,r5,#0x1c
0019d2  f7fffffe          BL       lc640_write_long_ptr
                  |L1.6614|
;;;1477   	
;;;1478   	}
;;;1479   
;;;1480   vz_mem_hndl_end:
;;;1481   __nop(); 
0019d6  bf00              NOP      
;;;1482   
;;;1483   }
0019d8  e4dd              B        |L1.5014|
;;;1484     
                          ENDP


                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  rki_avar1_stat
                          DCD      0x00000000
                  rki_avar1_ind_stat
                          DCD      0x00000000
                  rki_avar1_stat_old
                          DCD      0x00000000
                  rki_avar1_stat_new
                          DCD      0x00000000
                  rki_avar1_stat_offed
                          DCD      0x00000000
                  rki_avarI1_stat
                          DCD      0x00000000
                  rki_avarI1_ind_stat
                          DCD      0x00000000
                  rki_avarI1_stat_old
                          DCD      0x00000000
                  rki_avarI1_stat_new
                          DCD      0x00000000
                  rki_avarI1_stat_offed
                          DCD      0x00000000
                  rki_avarI2_stat
                          DCD      0x00000000
                  rki_avarI2_ind_stat
                          DCD      0x00000000
                  rki_avarI2_stat_old
                          DCD      0x00000000
                  rki_avarI2_stat_new
                          DCD      0x00000000
                  rki_avarI2_stat_offed
                          DCD      0x00000000
                  av_inv
                          DCD      0x00000000
000054  0000              DCB      0x00,0x00
