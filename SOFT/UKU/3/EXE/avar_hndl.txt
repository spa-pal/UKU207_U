; generated by ARM C/C++ Compiler, RVCT4.0 [Build 728]
; commandline ArmCC [--debug -c --asm --interleave -o.\EXE\avar_hndl.o --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\INC -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;56     //-----------------------------------------------
;;;57     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;58     {
;;;59     //static unsigned avar_stat_old;
;;;60     char i;
;;;61     //unsigned avar_stat_new,avar_stat_offed;
;;;62     
;;;63     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48fe              LDR      r0,|L1.1020|
000004  4bfe              LDR      r3,|L1.1024|
000006  7801              LDRB     r1,[r0,#0]  ; net_av
000008  6818              LDR      r0,[r3,#0]
00000a  b119              CBZ      r1,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6018              STR      r0,[r3,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;64     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6018              STR      r0,[r3,#0]  ; avar_stat
                  |L1.26|
;;;65     
;;;66     for(i=0;i<2;i++)
00001a  2000              MOVS     r0,#0
;;;67     	{
;;;68     	if(bat[i]._av&1)	SET_REG(avar_stat,1,1+i,1);
00001c  49f9              LDR      r1,|L1.1028|
00001e  2401              MOVS     r4,#1
                  |L1.32|
000020  eb000240          ADD      r2,r0,r0,LSL #1
000024  eb021200          ADD      r2,r2,r0,LSL #4
000028  eb010282          ADD      r2,r1,r2,LSL #2
00002c  f892203d          LDRB     r2,[r2,#0x3d]
000030  07d2              LSLS     r2,r2,#31
000032  d007              BEQ      |L1.68|
000034  1c45              ADDS     r5,r0,#1
000036  fa04f205          LSL      r2,r4,r5
00003a  681d              LDR      r5,[r3,#0]  ; avar_stat
00003c  4395              BICS     r5,r5,r2
00003e  4315              ORRS     r5,r5,r2
000040  601d              STR      r5,[r3,#0]  ; avar_stat
000042  e005              B        |L1.80|
                  |L1.68|
;;;69     	else	   		SET_REG(avar_stat,0,1+i,1);
000044  1c42              ADDS     r2,r0,#1
000046  681d              LDR      r5,[r3,#0]  ; avar_stat
000048  fa04f202          LSL      r2,r4,r2
00004c  4395              BICS     r5,r5,r2
00004e  601d              STR      r5,[r3,#0]  ; avar_stat
                  |L1.80|
000050  1c40              ADDS     r0,r0,#1              ;66
000052  b2c0              UXTB     r0,r0                 ;66
000054  2802              CMP      r0,#2                 ;66
000056  d3e3              BCC      |L1.32|
;;;70     	}
;;;71     
;;;72     for(i=0;i<12;i++)
000058  2000              MOVS     r0,#0
;;;73     	{
;;;74     	if(bps[i]._av)	SET_REG(avar_stat,1,3+i,1);
00005a  4deb              LDR      r5,|L1.1032|
                  |L1.92|
00005c  ebc002c0          RSB      r2,r0,r0,LSL #3
000060  eb020142          ADD      r1,r2,r2,LSL #1
000064  eb050181          ADD      r1,r5,r1,LSL #2
000068  7849              LDRB     r1,[r1,#1]
00006a  b139              CBZ      r1,|L1.124|
00006c  1cc2              ADDS     r2,r0,#3
00006e  fa04f102          LSL      r1,r4,r2
000072  681a              LDR      r2,[r3,#0]  ; avar_stat
000074  438a              BICS     r2,r2,r1
000076  430a              ORRS     r2,r2,r1
000078  601a              STR      r2,[r3,#0]  ; avar_stat
00007a  e005              B        |L1.136|
                  |L1.124|
;;;75     	else	   		SET_REG(avar_stat,0,3+i,1);
00007c  1cc1              ADDS     r1,r0,#3
00007e  681a              LDR      r2,[r3,#0]  ; avar_stat
000080  fa04f101          LSL      r1,r4,r1
000084  438a              BICS     r2,r2,r1
000086  601a              STR      r2,[r3,#0]  ; avar_stat
                  |L1.136|
000088  1c40              ADDS     r0,r0,#1              ;72
00008a  b2c0              UXTB     r0,r0                 ;72
00008c  280c              CMP      r0,#0xc               ;72
00008e  d3e5              BCC      |L1.92|
;;;76     	}
;;;77     
;;;78     for(i=0;i<6;i++)
000090  2000              MOVS     r0,#0
;;;79     	{
;;;80     	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
000092  49db              LDR      r1,|L1.1024|
000094  3114              ADDS     r1,r1,#0x14
                  |L1.150|
000096  5c0a              LDRB     r2,[r1,r0]
000098  b142              CBZ      r2,|L1.172|
00009a  f100050f          ADD      r5,r0,#0xf
00009e  fa04f205          LSL      r2,r4,r5
0000a2  681d              LDR      r5,[r3,#0]  ; avar_stat
0000a4  4395              BICS     r5,r5,r2
0000a6  4315              ORRS     r5,r5,r2
0000a8  601d              STR      r5,[r3,#0]  ; avar_stat
0000aa  e006              B        |L1.186|
                  |L1.172|
;;;81     	else	   		SET_REG(avar_stat,0,15+i,1);
0000ac  f100020f          ADD      r2,r0,#0xf
0000b0  681d              LDR      r5,[r3,#0]  ; avar_stat
0000b2  fa04f202          LSL      r2,r4,r2
0000b6  4395              BICS     r5,r5,r2
0000b8  601d              STR      r5,[r3,#0]  ; avar_stat
                  |L1.186|
0000ba  1c40              ADDS     r0,r0,#1              ;78
0000bc  b2c0              UXTB     r0,r0                 ;78
0000be  2806              CMP      r0,#6                 ;78
0000c0  d3e9              BCC      |L1.150|
;;;82     	}
;;;83     
;;;84     /*for(i=0;i<4;i++)
;;;85     	{
;;;86     	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;87     	else	   		SET_REG(avar_stat,0,21+i,1);
;;;88     	}  */
;;;89     for(i=0;i<4;i++)
0000c2  2000              MOVS     r0,#0
;;;90     	{
;;;91     	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,25+i,1);
0000c4  4ad1              LDR      r2,|L1.1036|
                  |L1.198|
0000c6  5c11              LDRB     r1,[r2,r0]
0000c8  2901              CMP      r1,#1
0000ca  d108              BNE      |L1.222|
0000cc  f1000519          ADD      r5,r0,#0x19
0000d0  fa04f105          LSL      r1,r4,r5
0000d4  681d              LDR      r5,[r3,#0]  ; avar_stat
0000d6  438d              BICS     r5,r5,r1
0000d8  430d              ORRS     r5,r5,r1
0000da  601d              STR      r5,[r3,#0]  ; avar_stat
0000dc  e006              B        |L1.236|
                  |L1.222|
;;;92     	else	   		SET_REG(avar_stat,0,25+i,1);
0000de  f1000119          ADD      r1,r0,#0x19
0000e2  681d              LDR      r5,[r3,#0]  ; avar_stat
0000e4  fa04f101          LSL      r1,r4,r1
0000e8  438d              BICS     r5,r5,r1
0000ea  601d              STR      r5,[r3,#0]  ; avar_stat
                  |L1.236|
0000ec  1c40              ADDS     r0,r0,#1              ;89
0000ee  b2c0              UXTB     r0,r0                 ;89
0000f0  2804              CMP      r0,#4                 ;89
0000f2  d3e8              BCC      |L1.198|
;;;93     	}
;;;94     
;;;95     avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
0000f4  689c              LDR      r4,[r3,#8]  ; avar_stat_old
0000f6  6818              LDR      r0,[r3,#0]  ; avar_stat
0000f8  ea200104          BIC      r1,r0,r4
0000fc  60d9              STR      r1,[r3,#0xc]  ; avar_stat_new
;;;96     
;;;97     avar_ind_stat|=avar_stat_new;
0000fe  685a              LDR      r2,[r3,#4]  ; avar_ind_stat
000100  430a              ORRS     r2,r2,r1
000102  605a              STR      r2,[r3,#4]  ; avar_ind_stat
;;;98     
;;;99     if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<25));
000104  49c2              LDR      r1,|L1.1040|
000106  880d              LDRH     r5,[r1,#0]  ; SK_ZVUK_EN
000108  b115              CBZ      r5,|L1.272|
00010a  f0227200          BIC      r2,r2,#0x2000000
00010e  605a              STR      r2,[r3,#4]  ; avar_ind_stat
                  |L1.272|
;;;100    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<26));
000110  884a              LDRH     r2,[r1,#2]  ; SK_ZVUK_EN
000112  b11a              CBZ      r2,|L1.284|
000114  685a              LDR      r2,[r3,#4]  ; avar_ind_stat
000116  f0226280          BIC      r2,r2,#0x4000000
00011a  605a              STR      r2,[r3,#4]  ; avar_ind_stat
                  |L1.284|
;;;101    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<27));
00011c  888a              LDRH     r2,[r1,#4]  ; SK_ZVUK_EN
00011e  b11a              CBZ      r2,|L1.296|
000120  685a              LDR      r2,[r3,#4]  ; avar_ind_stat
000122  f0226200          BIC      r2,r2,#0x8000000
000126  605a              STR      r2,[r3,#4]  ; avar_ind_stat
                  |L1.296|
;;;102    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<28));	
000128  88c9              LDRH     r1,[r1,#6]  ; SK_ZVUK_EN
00012a  b119              CBZ      r1,|L1.308|
00012c  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
00012e  f0215180          BIC      r1,r1,#0x10000000
000132  6059              STR      r1,[r3,#4]  ; avar_ind_stat
                  |L1.308|
;;;103    
;;;104    
;;;105    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
000134  4384              BICS     r4,r4,r0
000136  43e1              MVNS     r1,r4
000138  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
;;;106    
;;;107    if(!AV_OFF_AVT)avar_stat_offed|=0xfffffffe;
00013a  4ab6              LDR      r2,|L1.1044|
00013c  8812              LDRH     r2,[r2,#0]  ; AV_OFF_AVT
00013e  b912              CBNZ     r2,|L1.326|
000140  f0610101          ORN      r1,r1,#1
000144  6119              STR      r1,[r3,#0x10]  ; avar_stat_offed
                  |L1.326|
;;;108    
;;;109    avar_ind_stat&=avar_stat_offed; 
000146  691a              LDR      r2,[r3,#0x10]  ; avar_stat_offed
000148  6859              LDR      r1,[r3,#4]  ; avar_ind_stat
00014a  4011              ANDS     r1,r1,r2
00014c  6059              STR      r1,[r3,#4]  ; avar_ind_stat
;;;110    
;;;111    avar_stat_old=avar_stat;
00014e  6098              STR      r0,[r3,#8]  ; avar_stat_old
;;;112    }
000150  bd30              POP      {r4,r5,pc}
;;;113    
                          ENDP

                  reload_hndl PROC
;;;114    //-----------------------------------------------
;;;115    void reload_hndl(void)
000152  b5f8              PUSH     {r3-r7,lr}
;;;116    {
;;;117    char data[4];
;;;118    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;119    
;;;120    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000154  f44f6560          MOV      r5,#0xe00
000158  4628              MOV      r0,r5
00015a  f7fffffe          BL       lc640_read_int
;;;121    event_ptr++;	
00015e  1c44              ADDS     r4,r0,#1
;;;122    if(event_ptr>63)event_ptr=0;	
000160  2c3f              CMP      r4,#0x3f
000162  d900              BLS      |L1.358|
000164  2400              MOVS     r4,#0
                  |L1.358|
;;;123    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000166  b221              SXTH     r1,r4
000168  4628              MOV      r0,r5
00016a  f7fffffe          BL       lc640_write_int
;;;124    	
;;;125    event_cnt=lc640_read_int(CNT_EVENT_LOG);
00016e  f6406602          MOV      r6,#0xe02
000172  4630              MOV      r0,r6
000174  f7fffffe          BL       lc640_read_int
;;;126    if(event_cnt!=63)event_cnt=event_ptr;
000178  283f              CMP      r0,#0x3f
00017a  d000              BEQ      |L1.382|
00017c  4620              MOV      r0,r4
                  |L1.382|
;;;127    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
00017e  b201              SXTH     r1,r0
000180  4630              MOV      r0,r6
000182  f7fffffe          BL       lc640_write_int
;;;128    	
;;;129    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000186  4628              MOV      r0,r5
000188  f7fffffe          BL       lc640_read_int
00018c  f44f6180          MOV      r1,#0x400
000190  eb011440          ADD      r4,r1,r0,LSL #5
;;;130    	
;;;131    data[0]='U';
000194  2055              MOVS     r0,#0x55
000196  f88d0000          STRB     r0,[sp,#0]
;;;132    data[1]=0;
00019a  2600              MOVS     r6,#0
00019c  f88d6001          STRB     r6,[sp,#1]
;;;133    data[2]='R';
0001a0  2052              MOVS     r0,#0x52
0001a2  f88d0002          STRB     r0,[sp,#2]
;;;134    data[3]=0;
0001a6  f88d6003          STRB     r6,[sp,#3]
;;;135    lc640_write_long_ptr(lc640_adr,data);
0001aa  4669              MOV      r1,sp
0001ac  4620              MOV      r0,r4
0001ae  f7fffffe          BL       lc640_write_long_ptr
;;;136    
;;;137    data[0]=0;
;;;138    data[1]=0;
;;;139    data[2]=0;
;;;140    data[3]=0;
0001b2  9600              STR      r6,[sp,#0]
;;;141    lc640_write_long_ptr(lc640_adr+4,data);
0001b4  4669              MOV      r1,sp
0001b6  1d20              ADDS     r0,r4,#4
0001b8  f7fffffe          BL       lc640_write_long_ptr
;;;142    
;;;143    data[0]=LPC_RTC->YEAR;
0001bc  4d96              LDR      r5,|L1.1048|
0001be  8ba8              LDRH     r0,[r5,#0x1c]
0001c0  f88d0000          STRB     r0,[sp,#0]
;;;144    data[1]=LPC_RTC->MONTH;
0001c4  7e28              LDRB     r0,[r5,#0x18]
0001c6  f88d0001          STRB     r0,[sp,#1]
;;;145    data[2]=LPC_RTC->DOM;
0001ca  7b28              LDRB     r0,[r5,#0xc]
0001cc  f88d0002          STRB     r0,[sp,#2]
;;;146    data[3]=0;
0001d0  f88d6003          STRB     r6,[sp,#3]
;;;147    lc640_write_long_ptr(lc640_adr+8,data);
0001d4  4669              MOV      r1,sp
0001d6  f1040008          ADD      r0,r4,#8
0001da  f7fffffe          BL       lc640_write_long_ptr
;;;148    
;;;149    data[0]=LPC_RTC->HOUR;
0001de  7a28              LDRB     r0,[r5,#8]
0001e0  f88d0000          STRB     r0,[sp,#0]
;;;150    data[1]=LPC_RTC->MIN;
0001e4  7928              LDRB     r0,[r5,#4]
0001e6  f88d0001          STRB     r0,[sp,#1]
;;;151    data[2]=LPC_RTC->SEC;
0001ea  7828              LDRB     r0,[r5,#0]
0001ec  f88d0002          STRB     r0,[sp,#2]
;;;152    data[3]=LPC_SC->RSID;
0001f0  488a              LDR      r0,|L1.1052|
0001f2  f8d00180          LDR      r0,[r0,#0x180]
0001f6  f88d0003          STRB     r0,[sp,#3]
;;;153    
;;;154    lc640_write_long_ptr(lc640_adr+12,data);
0001fa  4669              MOV      r1,sp
0001fc  f104000c          ADD      r0,r4,#0xc
000200  f7fffffe          BL       lc640_write_long_ptr
;;;155    	
;;;156    data[0]='A';
000204  2541              MOVS     r5,#0x41
000206  f88d5000          STRB     r5,[sp,#0]
;;;157    data[1]='A';
00020a  f88d5001          STRB     r5,[sp,#1]
;;;158    data[2]='A';
00020e  f88d5002          STRB     r5,[sp,#2]
;;;159    data[3]='A';
000212  f88d5003          STRB     r5,[sp,#3]
;;;160    lc640_write_long_ptr(lc640_adr+16,data);
000216  4669              MOV      r1,sp
000218  f1040010          ADD      r0,r4,#0x10
00021c  f7fffffe          BL       lc640_write_long_ptr
;;;161    	
;;;162    data[0]='A';
000220  f88d5000          STRB     r5,[sp,#0]
;;;163    data[1]='A';
000224  f88d5001          STRB     r5,[sp,#1]
;;;164    data[2]='A';
000228  f88d5002          STRB     r5,[sp,#2]
;;;165    data[3]='A';
00022c  f88d5003          STRB     r5,[sp,#3]
;;;166    lc640_write_long_ptr(lc640_adr+20,data);
000230  4669              MOV      r1,sp
000232  f1040014          ADD      r0,r4,#0x14
000236  f7fffffe          BL       lc640_write_long_ptr
;;;167    	
;;;168    data[0]='A';
00023a  f88d5000          STRB     r5,[sp,#0]
;;;169    data[1]='A';
00023e  f88d5001          STRB     r5,[sp,#1]
;;;170    data[2]='A';
000242  f88d5002          STRB     r5,[sp,#2]
;;;171    data[3]='A';
000246  f88d5003          STRB     r5,[sp,#3]
;;;172    lc640_write_long_ptr(lc640_adr+24,data);
00024a  4669              MOV      r1,sp
00024c  f1040018          ADD      r0,r4,#0x18
000250  f7fffffe          BL       lc640_write_long_ptr
;;;173    	
;;;174    data[0]='A';
000254  f88d5000          STRB     r5,[sp,#0]
;;;175    data[1]='A';
000258  f88d5001          STRB     r5,[sp,#1]
;;;176    data[2]='A';
00025c  f88d5002          STRB     r5,[sp,#2]
;;;177    data[3]='A';
000260  f88d5003          STRB     r5,[sp,#3]
;;;178    lc640_write_long_ptr(lc640_adr+28,data);				
000264  4669              MOV      r1,sp
000266  f104001c          ADD      r0,r4,#0x1c
00026a  f7fffffe          BL       lc640_write_long_ptr
;;;179    	
;;;180    	
;;;181    }
00026e  bdf8              POP      {r3-r7,pc}
;;;182    
                          ENDP

                  avar_unet_hndl PROC
;;;183    //-----------------------------------------------
;;;184    void avar_unet_hndl(char in)
000270  e92d43f8          PUSH     {r3-r9,lr}
;;;185    {
;;;186    
;;;187    char data[4];
;;;188    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;189    
;;;190    
;;;191    if(in==1)
;;;192    	{
;;;193    	net_av=1;
;;;194    
;;;195    	//beep_init(0x01L,'O');
;;;196    	//a.av.bAN=1;
;;;197    
;;;198    
;;;199    	//beep_init(0x33333333,'A');
;;;200    	 
;;;201    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;202    	event_ptr++;	
;;;203    	if(event_ptr>63)event_ptr=0;	
;;;204    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;205    	
;;;206         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;207    	if(event_cnt!=63)event_cnt=event_ptr;
;;;208    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;209    	
;;;210    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;211    	
;;;212    	data[0]='P';
;;;213    	data[1]=0;
;;;214    	data[2]='A';
;;;215    	data[3]=0;
;;;216    	lc640_write_long_ptr(lc640_adr,data);
;;;217    
;;;218    	data[0]=0;//*((char*)&Unet_store);
;;;219    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;220    	data[2]=0;
;;;221    	data[3]=0;
;;;222    	lc640_write_long_ptr(lc640_adr+4,data);
;;;223    
;;;224    	data[0]=LPC_RTC->YEAR;
000274  4f68              LDR      r7,|L1.1048|
000276  4961              LDR      r1,|L1.1020|
000278  3f20              SUBS     r7,r7,#0x20
00027a  f44f6560          MOV      r5,#0xe00             ;201
00027e  f04f0800          MOV      r8,#0                 ;203
000282  f44f6980          MOV      r9,#0x400             ;210
000286  2801              CMP      r0,#1                 ;191
000288  d17e              BNE      |L1.904|
00028a  7008              STRB     r0,[r1,#0]            ;193
00028c  4628              MOV      r0,r5                 ;201
00028e  f7fffffe          BL       lc640_read_int
000292  1c44              ADDS     r4,r0,#1              ;202
000294  2c3f              CMP      r4,#0x3f              ;203
000296  d900              BLS      |L1.666|
000298  2400              MOVS     r4,#0                 ;203
                  |L1.666|
00029a  b221              SXTH     r1,r4                 ;204
00029c  4628              MOV      r0,r5                 ;204
00029e  f7fffffe          BL       lc640_write_int
0002a2  f6406602          MOV      r6,#0xe02             ;206
0002a6  4630              MOV      r0,r6                 ;206
0002a8  f7fffffe          BL       lc640_read_int
0002ac  283f              CMP      r0,#0x3f              ;207
0002ae  d000              BEQ      |L1.690|
0002b0  4620              MOV      r0,r4                 ;207
                  |L1.690|
0002b2  b201              SXTH     r1,r0                 ;208
0002b4  4630              MOV      r0,r6                 ;208
0002b6  f7fffffe          BL       lc640_write_int
0002ba  4628              MOV      r0,r5                 ;210
0002bc  f7fffffe          BL       lc640_read_int
0002c0  eb091540          ADD      r5,r9,r0,LSL #5       ;210
0002c4  2050              MOVS     r0,#0x50              ;212
0002c6  f88d0000          STRB     r0,[sp,#0]            ;212
0002ca  f88d8001          STRB     r8,[sp,#1]            ;213
0002ce  2441              MOVS     r4,#0x41              ;214
0002d0  f88d4002          STRB     r4,[sp,#2]            ;214
0002d4  f88d8003          STRB     r8,[sp,#3]            ;215
0002d8  4669              MOV      r1,sp                 ;216
0002da  4628              MOV      r0,r5                 ;216
0002dc  f7fffffe          BL       lc640_write_long_ptr
0002e0  f8cd8000          STR      r8,[sp,#0]            ;221
0002e4  4669              MOV      r1,sp                 ;222
0002e6  1d28              ADDS     r0,r5,#4              ;222
0002e8  f7fffffe          BL       lc640_write_long_ptr
0002ec  f1070720          ADD      r7,r7,#0x20
0002f0  8bb8              LDRH     r0,[r7,#0x1c]
0002f2  f88d0000          STRB     r0,[sp,#0]
;;;225    	data[1]=LPC_RTC->MONTH;
0002f6  7e38              LDRB     r0,[r7,#0x18]
0002f8  f88d0001          STRB     r0,[sp,#1]
;;;226    	data[2]=LPC_RTC->DOM;
0002fc  7b38              LDRB     r0,[r7,#0xc]
0002fe  f88d0002          STRB     r0,[sp,#2]
;;;227    	data[3]=0;
000302  f88d8003          STRB     r8,[sp,#3]
;;;228    	lc640_write_long_ptr(lc640_adr+8,data);
000306  4669              MOV      r1,sp
000308  f1050008          ADD      r0,r5,#8
00030c  f7fffffe          BL       lc640_write_long_ptr
;;;229    
;;;230    	data[0]=LPC_RTC->HOUR;
000310  7a38              LDRB     r0,[r7,#8]
000312  f88d0000          STRB     r0,[sp,#0]
;;;231    	data[1]=LPC_RTC->MIN;
000316  7938              LDRB     r0,[r7,#4]
000318  f88d0001          STRB     r0,[sp,#1]
;;;232    	data[2]=LPC_RTC->SEC;
00031c  7838              LDRB     r0,[r7,#0]
00031e  f88d0002          STRB     r0,[sp,#2]
;;;233    	data[3]=0;
000322  f88d8003          STRB     r8,[sp,#3]
;;;234    	lc640_write_long_ptr(lc640_adr+12,data);
000326  4669              MOV      r1,sp
000328  f105000c          ADD      r0,r5,#0xc
00032c  f7fffffe          BL       lc640_write_long_ptr
;;;235    	
;;;236    	data[0]='A';
000330  f88d4000          STRB     r4,[sp,#0]
;;;237    	data[1]='A';
000334  f88d4001          STRB     r4,[sp,#1]
;;;238    	data[2]='A';
000338  f88d4002          STRB     r4,[sp,#2]
;;;239    	data[3]='A';
00033c  f88d4003          STRB     r4,[sp,#3]
;;;240    	lc640_write_long_ptr(lc640_adr+16,data);
000340  4669              MOV      r1,sp
000342  f1050010          ADD      r0,r5,#0x10
000346  f7fffffe          BL       lc640_write_long_ptr
;;;241    	
;;;242    	data[0]='A';
00034a  f88d4000          STRB     r4,[sp,#0]
;;;243    	data[1]='A';
00034e  f88d4001          STRB     r4,[sp,#1]
;;;244    	data[2]='A';
000352  f88d4002          STRB     r4,[sp,#2]
;;;245    	data[3]='A';
000356  f88d4003          STRB     r4,[sp,#3]
;;;246    	lc640_write_long_ptr(lc640_adr+20,data);
00035a  4669              MOV      r1,sp
00035c  f1050014          ADD      r0,r5,#0x14
000360  f7fffffe          BL       lc640_write_long_ptr
;;;247    	
;;;248    	data[0]='A';
000364  f88d4000          STRB     r4,[sp,#0]
;;;249    	data[1]='A';
000368  f88d4001          STRB     r4,[sp,#1]
;;;250    	data[2]='A';
00036c  f88d4002          STRB     r4,[sp,#2]
;;;251    	data[3]='A';
000370  f88d4003          STRB     r4,[sp,#3]
;;;252    	lc640_write_long_ptr(lc640_adr+24,data);
000374  4669              MOV      r1,sp
000376  f1050018          ADD      r0,r5,#0x18
00037a  f7fffffe          BL       lc640_write_long_ptr
;;;253    	
;;;254    	data[0]='A';
00037e  f88d4000          STRB     r4,[sp,#0]
;;;255    	data[1]='A';
000382  f88d4001          STRB     r4,[sp,#1]
;;;256    	data[2]='A';
000386  e000              B        |L1.906|
                  |L1.904|
000388  e00f              B        |L1.938|
                  |L1.906|
00038a  f88d4002          STRB     r4,[sp,#2]
;;;257    	data[3]='A';
00038e  f88d4003          STRB     r4,[sp,#3]
;;;258    	lc640_write_long_ptr(lc640_adr+28,data);				
000392  4669              MOV      r1,sp
000394  f105001c          ADD      r0,r5,#0x1c
000398  f7fffffe          BL       lc640_write_long_ptr
;;;259    	
;;;260    /*	memo_out0[0]=0x55;
;;;261         memo_out0[1]=0x00+2;
;;;262         memo_out0[2]=1;
;;;263         memo_out0[3]=0x0b;
;;;264         memo_out0[4]=0x55;
;;;265         memo_out0[5]=0x55; 
;;;266         	
;;;267         memo_out0[6]=crc_87(memo_out0,6);
;;;268    	memo_out0[7]=crc_95(memo_out0,6);
;;;269         usart_out_adr0(memo_out0,8); 
;;;270    	*/
;;;271    	snmp_trap_send("Main power is off",2,1,0);
00039c  2300              MOVS     r3,#0
00039e  2201              MOVS     r2,#1
0003a0  2102              MOVS     r1,#2
0003a2  a01f              ADR      r0,|L1.1056|
0003a4  f7fffffe          BL       snmp_trap_send
                  |L1.936|
0003a8  e0aa              B        |L1.1280|
                  |L1.938|
;;;272    	}
;;;273    
;;;274    else if(in==0)
0003aa  2800              CMP      r0,#0
0003ac  d1fc              BNE      |L1.936|
;;;275    	{
;;;276    	net_av=0;
0003ae  f8818000          STRB     r8,[r1,#0]
;;;277    
;;;278      /*
;;;279    	SET_REG(C2GSR,3,24,8);
;;;280    	C2MOD=0;
;;;281    	bOUT_FREE2=1;*/
;;;282    
;;;283    
;;;284    	//C2MOD=0;
;;;285    
;;;286    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;287    
;;;288         //beep_init(0x02L,'O');
;;;289    	//a_.av.bAN=0;
;;;290    	SET_REG(avar_stat,0,0,1);
0003b2  4813              LDR      r0,|L1.1024|
0003b4  6801              LDR      r1,[r0,#0]  ; avar_stat
0003b6  f0210101          BIC      r1,r1,#1
0003ba  6001              STR      r1,[r0,#0]  ; avar_stat
;;;291    
;;;292    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;293    	
;;;294    	if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
0003bc  4915              LDR      r1,|L1.1044|
0003be  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
0003c0  b119              CBZ      r1,|L1.970|
0003c2  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
0003c4  f0210101          BIC      r1,r1,#1
0003c8  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.970|
;;;295    
;;;296         event_ptr=lc640_read_int(PTR_EVENT_LOG);
0003ca  4628              MOV      r0,r5
0003cc  f7fffffe          BL       lc640_read_int
0003d0  4606              MOV      r6,r0
;;;297    	event_ptr_find=event_ptr;
0003d2  4634              MOV      r4,r6
                  |L1.980|
;;;298    avar_unet_hndl_lbl1:
;;;299    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0003d4  eb091544          ADD      r5,r9,r4,LSL #5
;;;300    
;;;301         lc640_read_long_ptr(lc640_adr,data);
0003d8  4669              MOV      r1,sp
0003da  4628              MOV      r0,r5
0003dc  f7fffffe          BL       lc640_read_long_ptr
;;;302         
;;;303         if(!((data[0]=='P')&&(data[1]==0)&&(data[2]=='A')))
0003e0  f89d0000          LDRB     r0,[sp,#0]
0003e4  2850              CMP      r0,#0x50
0003e6  d106              BNE      |L1.1014|
0003e8  f89d0001          LDRB     r0,[sp,#1]
0003ec  b918              CBNZ     r0,|L1.1014|
0003ee  f89d0002          LDRB     r0,[sp,#2]
0003f2  2841              CMP      r0,#0x41
0003f4  d022              BEQ      |L1.1084|
                  |L1.1014|
;;;304         	{        
;;;305         	if(event_ptr_find)event_ptr_find--;
0003f6  b1ec              CBZ      r4,|L1.1076|
0003f8  1e64              SUBS     r4,r4,#1
0003fa  e01c              B        |L1.1078|
                  |L1.1020|
                          DCD      net_av
                  |L1.1024|
                          DCD      ||.data||
                  |L1.1028|
                          DCD      bat
                  |L1.1032|
                          DCD      bps
                  |L1.1036|
                          DCD      sk_av_stat
                  |L1.1040|
                          DCD      SK_ZVUK_EN
                  |L1.1044|
                          DCD      AV_OFF_AVT
                  |L1.1048|
                          DCD      0x40024020
                  |L1.1052|
                          DCD      0x400fc000
                  |L1.1056|
000420  4d61696e          DCB      "Main power is off",0
000424  20706f77
000428  65722069
00042c  73206f66
000430  6600    
000432  00                DCB      0
000433  00                DCB      0
                  |L1.1076|
;;;306         	else event_ptr_find=63;
000434  243f              MOVS     r4,#0x3f
                  |L1.1078|
;;;307         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000436  42b4              CMP      r4,r6
000438  d1cc              BNE      |L1.980|
00043a  e061              B        |L1.1280|
                  |L1.1084|
;;;308         	else goto avar_unet_hndl_lbl1;
;;;309         	}
;;;310         else 
;;;311         	{
;;;312         	lc640_read_long_ptr(lc640_adr+16,data);
00043c  4669              MOV      r1,sp
00043e  f1050010          ADD      r0,r5,#0x10
000442  f7fffffe          BL       lc640_read_long_ptr
;;;313         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000446  f89d0000          LDRB     r0,[sp,#0]
00044a  2841              CMP      r0,#0x41
00044c  d10b              BNE      |L1.1126|
00044e  f89d0001          LDRB     r0,[sp,#1]
000452  2841              CMP      r0,#0x41
000454  d107              BNE      |L1.1126|
000456  f89d0002          LDRB     r0,[sp,#2]
00045a  2841              CMP      r0,#0x41
00045c  d103              BNE      |L1.1126|
00045e  f89d0003          LDRB     r0,[sp,#3]
000462  2841              CMP      r0,#0x41
000464  d006              BEQ      |L1.1140|
                  |L1.1126|
;;;314         		{        
;;;315         		if(event_ptr_find)event_ptr_find--;
000466  b10c              CBZ      r4,|L1.1132|
000468  1e64              SUBS     r4,r4,#1
00046a  e000              B        |L1.1134|
                  |L1.1132|
;;;316             		else event_ptr_find=63;
00046c  243f              MOVS     r4,#0x3f
                  |L1.1134|
;;;317             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
00046e  42b4              CMP      r4,r6
000470  d1b0              BNE      |L1.980|
000472  e045              B        |L1.1280|
                  |L1.1140|
;;;318         		else goto avar_unet_hndl_lbl1;
;;;319         		}
;;;320    
;;;321         	}	
;;;322    	
;;;323    	data[0]=LPC_RTC->YEAR;
000474  f1070720          ADD      r7,r7,#0x20
000478  8bb8              LDRH     r0,[r7,#0x1c]
00047a  f88d0000          STRB     r0,[sp,#0]
;;;324    	data[1]=LPC_RTC->MONTH;
00047e  7e38              LDRB     r0,[r7,#0x18]
000480  f88d0001          STRB     r0,[sp,#1]
;;;325    	data[2]=LPC_RTC->DOM;
000484  7b38              LDRB     r0,[r7,#0xc]
000486  f88d0002          STRB     r0,[sp,#2]
;;;326    	data[3]=0;
00048a  f88d8003          STRB     r8,[sp,#3]
;;;327    	lc640_write_long_ptr(lc640_adr+16,data);
00048e  4669              MOV      r1,sp
000490  f1050010          ADD      r0,r5,#0x10
000494  f7fffffe          BL       lc640_write_long_ptr
;;;328    
;;;329    	data[0]=LPC_RTC->HOUR;
000498  7a38              LDRB     r0,[r7,#8]
00049a  f88d0000          STRB     r0,[sp,#0]
;;;330    	data[1]=LPC_RTC->MIN;
00049e  7938              LDRB     r0,[r7,#4]
0004a0  f88d0001          STRB     r0,[sp,#1]
;;;331    	data[2]=LPC_RTC->SEC;
0004a4  7838              LDRB     r0,[r7,#0]
0004a6  f88d0002          STRB     r0,[sp,#2]
;;;332    	data[3]=0;
0004aa  f88d8003          STRB     r8,[sp,#3]
;;;333    	lc640_write_long_ptr(lc640_adr+20,data); 
0004ae  4669              MOV      r1,sp
0004b0  f1050014          ADD      r0,r5,#0x14
0004b4  f7fffffe          BL       lc640_write_long_ptr
;;;334    	
;;;335    	data[0]=*((char*)(&net_Ustore));
0004b8  48ff              LDR      r0,|L1.2232|
0004ba  7801              LDRB     r1,[r0,#0]  ; net_Ustore
0004bc  f88d1000          STRB     r1,[sp,#0]
;;;336    	data[1]=*(((char*)(&net_Ustore))+1);
0004c0  7840              LDRB     r0,[r0,#1]  ; net_Ustore
0004c2  f88d0001          STRB     r0,[sp,#1]
;;;337    	data[2]='B';
0004c6  2442              MOVS     r4,#0x42
0004c8  f88d4002          STRB     r4,[sp,#2]
;;;338    	data[3]='B';
0004cc  f88d4003          STRB     r4,[sp,#3]
;;;339    	lc640_write_long_ptr(lc640_adr+24,data);
0004d0  4669              MOV      r1,sp
0004d2  f1050018          ADD      r0,r5,#0x18
0004d6  f7fffffe          BL       lc640_write_long_ptr
;;;340    	
;;;341    	data[0]='B';
0004da  f88d4000          STRB     r4,[sp,#0]
;;;342    	data[1]='B';
0004de  f88d4001          STRB     r4,[sp,#1]
;;;343    	data[2]='B';
0004e2  f88d4002          STRB     r4,[sp,#2]
;;;344    	data[3]='B';
0004e6  f88d4003          STRB     r4,[sp,#3]
;;;345    	lc640_write_long_ptr(lc640_adr+28,data);	
0004ea  4669              MOV      r1,sp
0004ec  f105001c          ADD      r0,r5,#0x1c
0004f0  f7fffffe          BL       lc640_write_long_ptr
;;;346    	
;;;347    /*	memo_out0[0]=0x55;
;;;348         memo_out0[1]=0x00+2;
;;;349         memo_out0[2]=1;
;;;350         memo_out0[3]=0x0b;
;;;351         memo_out0[4]=0xaa;
;;;352         memo_out0[5]=0xaa; 
;;;353         	
;;;354         memo_out0[6]=crc_87(memo_out0,6);
;;;355    	memo_out0[7]=crc_95(memo_out0,6);
;;;356         usart_out_adr0(memo_out0,8); */
;;;357         snmp_trap_send("Main power is on",2,1,1);	
0004f4  2301              MOVS     r3,#1
0004f6  461a              MOV      r2,r3
0004f8  2102              MOVS     r1,#2
0004fa  a0f0              ADR      r0,|L1.2236|
0004fc  f7fffffe          BL       snmp_trap_send
                  |L1.1280|
;;;358    	}
;;;359    avar_unet_hndl_end:
;;;360    	__nop();		
000500  bf00              NOP      
;;;361    }
000502  e8bd83f8          POP      {r3-r9,pc}
;;;362    
                          ENDP

                  avar_bps_hndl PROC
;;;364    //-----------------------------------------------
;;;365    void avar_bps_hndl(char dev, char v, char in)
000506  e92d4ff8          PUSH     {r3-r11,lr}
;;;366    {
00050a  4606              MOV      r6,r0
00050c  460c              MOV      r4,r1
;;;367    char data[4];
;;;368    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;369    char avar_simbol;
;;;370    
;;;371    avar_simbol='T';
00050e  2754              MOVS     r7,#0x54
;;;372    if(v==0)avar_simbol='T';
000510  b154              CBZ      r4,|L1.1320|
;;;373    else if(v==1)avar_simbol='U';
000512  2c01              CMP      r4,#1
000514  d101              BNE      |L1.1306|
000516  2755              MOVS     r7,#0x55
000518  e006              B        |L1.1320|
                  |L1.1306|
;;;374    else if(v==2)avar_simbol='u';
00051a  2c02              CMP      r4,#2
00051c  d101              BNE      |L1.1314|
00051e  2775              MOVS     r7,#0x75
000520  e002              B        |L1.1320|
                  |L1.1314|
;;;375    else if(v==3)avar_simbol='L';
000522  2c03              CMP      r4,#3
000524  d100              BNE      |L1.1320|
000526  274c              MOVS     r7,#0x4c
                  |L1.1320|
;;;376    
;;;377    if(in==1)
;;;378    	{
;;;379    	//av_src[bps]=1;
;;;380    
;;;381    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;382    //	SET_REG(avar_stat,1,3+dev,1);
;;;383    	
;;;384    	if(v==0)bps[dev]._av|=(1<<0);
000528  4bea              LDR      r3,|L1.2260|
00052a  ebc601c6          RSB      r1,r6,r6,LSL #3
;;;385    	else if(v==1) bps[dev]._av|=(1<<1);
;;;386    	else if(v==2) bps[dev]._av|=(1<<2);
;;;387    	else if(v==3) bps[dev]._av|=(1<<3);
;;;388    
;;;389    	bps[dev]._last_avar=v;
;;;390    
;;;391    	//beep_init(0x33333333,'A');
;;;392    
;;;393    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;394    	event_ptr++;	
;;;395    	if(event_ptr>63)event_ptr=0;	
;;;396    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;397    	
;;;398         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;399    	if(event_cnt!=63)event_cnt=event_ptr;
;;;400    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;401    	
;;;402    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;403    	
;;;404    	data[0]='S';
;;;405    	data[1]=dev; 
;;;406    	data[2]=avar_simbol;
;;;407    	data[3]=0;
;;;408    	lc640_write_long_ptr(lc640_adr,data);
;;;409    
;;;410    	data[0]=0;
;;;411    	data[1]=0;
;;;412    	data[2]=0;
;;;413    	data[3]=0;
;;;414    	lc640_write_long_ptr(lc640_adr+4,data);
;;;415    
;;;416    	data[0]=LPC_RTC->YEAR;
00052e  f8df93a0          LDR      r9,|L1.2256|
000532  eb010141          ADD      r1,r1,r1,LSL #1       ;384
000536  f04f0800          MOV      r8,#0                 ;366
00053a  f44f6060          MOV      r0,#0xe00             ;393
00053e  f44f6580          MOV      r5,#0x400             ;402
000542  eb030181          ADD      r1,r3,r1,LSL #2       ;384
000546  2a01              CMP      r2,#1                 ;377
000548  d17d              BNE      |L1.1606|
00054a  b924              CBNZ     r4,|L1.1366|
00054c  784a              LDRB     r2,[r1,#1]            ;384
00054e  f0420201          ORR      r2,r2,#1              ;384
000552  704a              STRB     r2,[r1,#1]            ;384
000554  e013              B        |L1.1406|
                  |L1.1366|
000556  2c01              CMP      r4,#1                 ;385
000558  d104              BNE      |L1.1380|
00055a  784a              LDRB     r2,[r1,#1]            ;385
00055c  f0420202          ORR      r2,r2,#2              ;385
000560  704a              STRB     r2,[r1,#1]            ;385
000562  e00c              B        |L1.1406|
                  |L1.1380|
000564  2c02              CMP      r4,#2                 ;386
000566  d104              BNE      |L1.1394|
000568  784a              LDRB     r2,[r1,#1]            ;386
00056a  f0420204          ORR      r2,r2,#4              ;386
00056e  704a              STRB     r2,[r1,#1]            ;386
000570  e005              B        |L1.1406|
                  |L1.1394|
000572  2c03              CMP      r4,#3                 ;387
000574  d103              BNE      |L1.1406|
000576  784a              LDRB     r2,[r1,#1]            ;387
000578  f0420208          ORR      r2,r2,#8              ;387
00057c  704a              STRB     r2,[r1,#1]            ;387
                  |L1.1406|
00057e  f8814053          STRB     r4,[r1,#0x53]         ;389
000582  4682              MOV      r10,r0                ;393
000584  f7fffffe          BL       lc640_read_int
000588  1c40              ADDS     r0,r0,#1              ;394
00058a  fa1ffb80          UXTH     r11,r0                ;394
00058e  f1bb0f3f          CMP      r11,#0x3f             ;395
000592  d901              BLS      |L1.1432|
000594  f04f0b00          MOV      r11,#0                ;395
                  |L1.1432|
000598  fa0ff18b          SXTH     r1,r11                ;396
00059c  4650              MOV      r0,r10                ;396
00059e  f7fffffe          BL       lc640_write_int
0005a2  f6406002          MOV      r0,#0xe02             ;398
0005a6  f7fffffe          BL       lc640_read_int
0005aa  b280              UXTH     r0,r0                 ;398
0005ac  283f              CMP      r0,#0x3f              ;399
0005ae  d000              BEQ      |L1.1458|
0005b0  4658              MOV      r0,r11                ;399
                  |L1.1458|
0005b2  b201              SXTH     r1,r0                 ;400
0005b4  f6406002          MOV      r0,#0xe02             ;400
0005b8  f7fffffe          BL       lc640_write_int
0005bc  4650              MOV      r0,r10                ;402
0005be  f7fffffe          BL       lc640_read_int
0005c2  eb051040          ADD      r0,r5,r0,LSL #5       ;402
0005c6  b285              UXTH     r5,r0                 ;402
0005c8  2053              MOVS     r0,#0x53              ;404
0005ca  f88d0000          STRB     r0,[sp,#0]            ;404
0005ce  f88d6001          STRB     r6,[sp,#1]            ;405
0005d2  f88d7002          STRB     r7,[sp,#2]            ;406
0005d6  f88d8003          STRB     r8,[sp,#3]            ;407
0005da  4669              MOV      r1,sp                 ;408
0005dc  4628              MOV      r0,r5                 ;408
0005de  f7fffffe          BL       lc640_write_long_ptr
0005e2  f8cd8000          STR      r8,[sp,#0]            ;413
0005e6  4669              MOV      r1,sp                 ;414
0005e8  1d28              ADDS     r0,r5,#4              ;414
0005ea  f7fffffe          BL       lc640_write_long_ptr
0005ee  f8b9003c          LDRH     r0,[r9,#0x3c]
0005f2  f88d0000          STRB     r0,[sp,#0]
;;;417    	data[1]=LPC_RTC->MONTH;
0005f6  f8990038          LDRB     r0,[r9,#0x38]
0005fa  f88d0001          STRB     r0,[sp,#1]
;;;418    	data[2]=LPC_RTC->DOM;
0005fe  f899002c          LDRB     r0,[r9,#0x2c]
000602  f88d0002          STRB     r0,[sp,#2]
;;;419    	data[3]=0;
000606  f88d8003          STRB     r8,[sp,#3]
;;;420    	lc640_write_long_ptr(lc640_adr+8,data);
00060a  4669              MOV      r1,sp
00060c  f1050008          ADD      r0,r5,#8
000610  f7fffffe          BL       lc640_write_long_ptr
;;;421    
;;;422    	data[0]=LPC_RTC->HOUR;
000614  f8990028          LDRB     r0,[r9,#0x28]
000618  f88d0000          STRB     r0,[sp,#0]
;;;423    	data[1]=LPC_RTC->MIN;
00061c  f8990024          LDRB     r0,[r9,#0x24]
000620  f88d0001          STRB     r0,[sp,#1]
;;;424    	data[2]=LPC_RTC->SEC;
000624  f8990020          LDRB     r0,[r9,#0x20]
000628  f88d0002          STRB     r0,[sp,#2]
;;;425    	data[3]=0;
00062c  f88d8003          STRB     r8,[sp,#3]
;;;426    	lc640_write_long_ptr(lc640_adr+12,data);
000630  4669              MOV      r1,sp
000632  f105000c          ADD      r0,r5,#0xc
000636  f7fffffe          BL       lc640_write_long_ptr
;;;427    	
;;;428    	data[0]='A';
00063a  2741              MOVS     r7,#0x41
00063c  f88d7000          STRB     r7,[sp,#0]
;;;429    	data[1]='A';
000640  f88d7001          STRB     r7,[sp,#1]
;;;430    	data[2]='A';
000644  e000              B        |L1.1608|
                  |L1.1606|
000646  e09e              B        |L1.1926|
                  |L1.1608|
000648  f88d7002          STRB     r7,[sp,#2]
;;;431    	data[3]='A';
00064c  f88d7003          STRB     r7,[sp,#3]
;;;432    	lc640_write_long_ptr(lc640_adr+16,data);
000650  4669              MOV      r1,sp
000652  f1050010          ADD      r0,r5,#0x10
000656  f7fffffe          BL       lc640_write_long_ptr
;;;433    	
;;;434    	data[0]='A';
00065a  f88d7000          STRB     r7,[sp,#0]
;;;435    	data[1]='A';
00065e  f88d7001          STRB     r7,[sp,#1]
;;;436    	data[2]='A';
000662  f88d7002          STRB     r7,[sp,#2]
;;;437    	data[3]='A';
000666  f88d7003          STRB     r7,[sp,#3]
;;;438    	lc640_write_long_ptr(lc640_adr+20,data);
00066a  4669              MOV      r1,sp
00066c  f1050014          ADD      r0,r5,#0x14
000670  f7fffffe          BL       lc640_write_long_ptr
;;;439    	
;;;440    	data[0]='A';
000674  f88d7000          STRB     r7,[sp,#0]
;;;441    	data[1]='A';
000678  f88d7001          STRB     r7,[sp,#1]
;;;442    	data[2]='A';
00067c  f88d7002          STRB     r7,[sp,#2]
;;;443    	data[3]='A';
000680  f88d7003          STRB     r7,[sp,#3]
;;;444    	lc640_write_long_ptr(lc640_adr+24,data);
000684  4669              MOV      r1,sp
000686  f1050018          ADD      r0,r5,#0x18
00068a  f7fffffe          BL       lc640_write_long_ptr
;;;445    	
;;;446    	data[0]='A';
00068e  f88d7000          STRB     r7,[sp,#0]
;;;447    	data[1]='A';
000692  f88d7001          STRB     r7,[sp,#1]
;;;448    	data[2]='A';
000696  f88d7002          STRB     r7,[sp,#2]
;;;449    	data[3]='A';
00069a  f88d7003          STRB     r7,[sp,#3]
;;;450    	lc640_write_long_ptr(lc640_adr+28,data);		
00069e  4669              MOV      r1,sp
0006a0  f105001c          ADD      r0,r5,#0x1c
0006a4  f7fffffe          BL       lc640_write_long_ptr
;;;451    
;;;452    
;;;453    	if(dev==0)
0006a8  2e00              CMP      r6,#0
0006aa  d122              BNE      |L1.1778|
;;;454    		{
;;;455    		if(v==0)
0006ac  b934              CBNZ     r4,|L1.1724|
;;;456    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
0006ae  2300              MOVS     r3,#0
0006b0  2201              MOVS     r2,#1
0006b2  2104              MOVS     r1,#4
0006b4  a088              ADR      r0,|L1.2264|
0006b6  f7fffffe          BL       snmp_trap_send
                  |L1.1722|
0006ba  e1bf              B        |L1.2620|
                  |L1.1724|
;;;457    		else if(v==1)
0006bc  2c01              CMP      r4,#1
0006be  d106              BNE      |L1.1742|
;;;458    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
0006c0  2301              MOVS     r3,#1
0006c2  461a              MOV      r2,r3
0006c4  2104              MOVS     r1,#4
0006c6  a08a              ADR      r0,|L1.2288|
0006c8  f7fffffe          BL       snmp_trap_send
0006cc  e1b6              B        |L1.2620|
                  |L1.1742|
;;;459    		else if(v==2)
0006ce  2c02              CMP      r4,#2
0006d0  d106              BNE      |L1.1760|
;;;460    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
0006d2  2302              MOVS     r3,#2
0006d4  2201              MOVS     r2,#1
0006d6  2104              MOVS     r1,#4
0006d8  a08c              ADR      r0,|L1.2316|
0006da  f7fffffe          BL       snmp_trap_send
0006de  e1ad              B        |L1.2620|
                  |L1.1760|
;;;461    		else if(v==3)
0006e0  2c03              CMP      r4,#3
0006e2  d1ea              BNE      |L1.1722|
;;;462    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
0006e4  2303              MOVS     r3,#3
0006e6  2201              MOVS     r2,#1
0006e8  2104              MOVS     r1,#4
0006ea  a090              ADR      r0,|L1.2348|
0006ec  f7fffffe          BL       snmp_trap_send
0006f0  e1a4              B        |L1.2620|
                  |L1.1778|
;;;463    		}
;;;464    	else if(dev==1)
0006f2  2e01              CMP      r6,#1
0006f4  d122              BNE      |L1.1852|
;;;465    		{
;;;466    		if(v==0)
0006f6  b934              CBNZ     r4,|L1.1798|
;;;467    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
0006f8  2300              MOVS     r3,#0
0006fa  2202              MOVS     r2,#2
0006fc  2104              MOVS     r1,#4
0006fe  a093              ADR      r0,|L1.2380|
000700  f7fffffe          BL       snmp_trap_send
000704  e19a              B        |L1.2620|
                  |L1.1798|
;;;468    		else if(v==1)
000706  2c01              CMP      r4,#1
000708  d106              BNE      |L1.1816|
;;;469    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
00070a  2301              MOVS     r3,#1
00070c  2202              MOVS     r2,#2
00070e  2104              MOVS     r1,#4
000710  a094              ADR      r0,|L1.2404|
000712  f7fffffe          BL       snmp_trap_send
000716  e191              B        |L1.2620|
                  |L1.1816|
;;;470    		else if(v==2)
000718  2c02              CMP      r4,#2
00071a  d106              BNE      |L1.1834|
;;;471    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
00071c  2302              MOVS     r3,#2
00071e  461a              MOV      r2,r3
000720  2104              MOVS     r1,#4
000722  a097              ADR      r0,|L1.2432|
000724  f7fffffe          BL       snmp_trap_send
000728  e188              B        |L1.2620|
                  |L1.1834|
;;;472    		else if(v==3)
00072a  2c03              CMP      r4,#3
00072c  d1c5              BNE      |L1.1722|
;;;473    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
00072e  2303              MOVS     r3,#3
000730  2202              MOVS     r2,#2
000732  2104              MOVS     r1,#4
000734  a09a              ADR      r0,|L1.2464|
000736  f7fffffe          BL       snmp_trap_send
00073a  e17f              B        |L1.2620|
                  |L1.1852|
;;;474    		} 
;;;475    	else if(dev==2)
00073c  2e02              CMP      r6,#2
00073e  d1bc              BNE      |L1.1722|
;;;476    		{
;;;477    		if(v==0)
000740  b934              CBNZ     r4,|L1.1872|
;;;478    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
000742  2300              MOVS     r3,#0
000744  2203              MOVS     r2,#3
000746  2104              MOVS     r1,#4
000748  a09d              ADR      r0,|L1.2496|
00074a  f7fffffe          BL       snmp_trap_send
00074e  e175              B        |L1.2620|
                  |L1.1872|
;;;479    		else if(v==1)
000750  2c01              CMP      r4,#1
000752  d106              BNE      |L1.1890|
;;;480    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
000754  2301              MOVS     r3,#1
000756  2203              MOVS     r2,#3
000758  2104              MOVS     r1,#4
00075a  a09f              ADR      r0,|L1.2520|
00075c  f7fffffe          BL       snmp_trap_send
000760  e16c              B        |L1.2620|
                  |L1.1890|
;;;481    		else if(v==2)
000762  2c02              CMP      r4,#2
000764  d106              BNE      |L1.1908|
;;;482    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
000766  2302              MOVS     r3,#2
000768  2203              MOVS     r2,#3
00076a  2104              MOVS     r1,#4
00076c  a0a1              ADR      r0,|L1.2548|
00076e  f7fffffe          BL       snmp_trap_send
000772  e163              B        |L1.2620|
                  |L1.1908|
;;;483    		else if(v==3)
000774  2c03              CMP      r4,#3
000776  d1a0              BNE      |L1.1722|
;;;484    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
000778  2303              MOVS     r3,#3
00077a  461a              MOV      r2,r3
00077c  2104              MOVS     r1,#4
00077e  a0a5              ADR      r0,|L1.2580|
000780  f7fffffe          BL       snmp_trap_send
000784  e15a              B        |L1.2620|
                  |L1.1926|
;;;485    		} 	
;;;486    			
;;;487    	}
;;;488    
;;;489    else if(in==0)
000786  2a00              CMP      r2,#0
000788  d139              BNE      |L1.2046|
;;;490    	{      
;;;491    //	av_bps[bps]=0;
;;;492    
;;;493    	//SET_REG(avar_stat,0,3+bps,1);
;;;494    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;495    
;;;496         if(v==0) bps[dev]._av&=(~(1<<0));
00078a  b924              CBNZ     r4,|L1.1942|
00078c  784a              LDRB     r2,[r1,#1]
00078e  f0220201          BIC      r2,r2,#1
000792  704a              STRB     r2,[r1,#1]
000794  e013              B        |L1.1982|
                  |L1.1942|
;;;497         else if(v==1) bps[dev]._av&=(~(1<<1));
000796  2c01              CMP      r4,#1
000798  d104              BNE      |L1.1956|
00079a  784a              LDRB     r2,[r1,#1]
00079c  f0220202          BIC      r2,r2,#2
0007a0  704a              STRB     r2,[r1,#1]
0007a2  e00c              B        |L1.1982|
                  |L1.1956|
;;;498    	else if(v==2) bps[dev]._av&=(~(1<<2));
0007a4  2c02              CMP      r4,#2
0007a6  d104              BNE      |L1.1970|
0007a8  784a              LDRB     r2,[r1,#1]
0007aa  f0220204          BIC      r2,r2,#4
0007ae  704a              STRB     r2,[r1,#1]
0007b0  e005              B        |L1.1982|
                  |L1.1970|
;;;499    	else if(v==3) bps[dev]._av&=(~(1<<3));
0007b2  2c03              CMP      r4,#3
0007b4  d103              BNE      |L1.1982|
0007b6  784a              LDRB     r2,[r1,#1]
0007b8  f0220208          BIC      r2,r2,#8
0007bc  704a              STRB     r2,[r1,#1]
                  |L1.1982|
;;;500         
;;;501    //	if((bps[dev]._av&0x0f==0))
;;;502    //	     {
;;;503    		//SET_REG(avar_stat,0,3+bps,1);
;;;504    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;505    //	     }
;;;506     
;;;507    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
0007be  f7fffffe          BL       lc640_read_int
0007c2  fa1ffb80          UXTH     r11,r0
;;;508    	event_ptr_find=event_ptr;
0007c6  465c              MOV      r4,r11
                  |L1.1992|
;;;509    	
;;;510    avar_src_hndl_lbl1: 
;;;511    
;;;512    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0007c8  eb051044          ADD      r0,r5,r4,LSL #5
0007cc  fa1ffa80          UXTH     r10,r0
;;;513    
;;;514         lc640_read_long_ptr(lc640_adr,data);
0007d0  4669              MOV      r1,sp
0007d2  4650              MOV      r0,r10
0007d4  f7fffffe          BL       lc640_read_long_ptr
;;;515         
;;;516         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
0007d8  f89d0000          LDRB     r0,[sp,#0]
0007dc  2853              CMP      r0,#0x53
0007de  d107              BNE      |L1.2032|
0007e0  f89d0001          LDRB     r0,[sp,#1]
0007e4  42b0              CMP      r0,r6
0007e6  d103              BNE      |L1.2032|
0007e8  f89d0002          LDRB     r0,[sp,#2]
0007ec  42b8              CMP      r0,r7
0007ee  d007              BEQ      |L1.2048|
                  |L1.2032|
;;;517         	{        
;;;518         	if(event_ptr_find)event_ptr_find--;
0007f0  b114              CBZ      r4,|L1.2040|
0007f2  1e64              SUBS     r4,r4,#1
0007f4  b2a4              UXTH     r4,r4
0007f6  e000              B        |L1.2042|
                  |L1.2040|
;;;519         	else event_ptr_find=63;
0007f8  243f              MOVS     r4,#0x3f
                  |L1.2042|
;;;520         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
0007fa  455c              CMP      r4,r11
0007fc  d1e4              BNE      |L1.1992|
                  |L1.2046|
0007fe  e11d              B        |L1.2620|
                  |L1.2048|
;;;521         	else goto avar_src_hndl_lbl1;
;;;522         	}
;;;523         else 
;;;524         	{
;;;525         	lc640_read_long_ptr(lc640_adr+16,data);
000800  4669              MOV      r1,sp
000802  f10a0010          ADD      r0,r10,#0x10
000806  f7fffffe          BL       lc640_read_long_ptr
;;;526         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00080a  f89d0000          LDRB     r0,[sp,#0]
00080e  2841              CMP      r0,#0x41
000810  d10b              BNE      |L1.2090|
000812  f89d0001          LDRB     r0,[sp,#1]
000816  2841              CMP      r0,#0x41
000818  d107              BNE      |L1.2090|
00081a  f89d0002          LDRB     r0,[sp,#2]
00081e  2841              CMP      r0,#0x41
000820  d103              BNE      |L1.2090|
000822  f89d0003          LDRB     r0,[sp,#3]
000826  2841              CMP      r0,#0x41
000828  d007              BEQ      |L1.2106|
                  |L1.2090|
;;;527         		{        
;;;528         		if(event_ptr_find)event_ptr_find--;
00082a  b114              CBZ      r4,|L1.2098|
00082c  1e64              SUBS     r4,r4,#1
00082e  b2a4              UXTH     r4,r4
000830  e000              B        |L1.2100|
                  |L1.2098|
;;;529             		else event_ptr_find=63;
000832  243f              MOVS     r4,#0x3f
                  |L1.2100|
;;;530             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000834  455c              CMP      r4,r11
000836  d1c7              BNE      |L1.1992|
000838  e100              B        |L1.2620|
                  |L1.2106|
;;;531         		else goto avar_src_hndl_lbl1;
;;;532         		}
;;;533    
;;;534         	}	
;;;535    
;;;536    
;;;537    	
;;;538    	data[0]=LPC_RTC->YEAR;
00083a  f8b9003c          LDRH     r0,[r9,#0x3c]
00083e  f88d0000          STRB     r0,[sp,#0]
;;;539    	data[1]=LPC_RTC->MONTH;
000842  f8990038          LDRB     r0,[r9,#0x38]
000846  f88d0001          STRB     r0,[sp,#1]
;;;540    	data[2]=LPC_RTC->DOM;
00084a  f899002c          LDRB     r0,[r9,#0x2c]
00084e  f88d0002          STRB     r0,[sp,#2]
;;;541    	data[3]=0;
000852  f88d8003          STRB     r8,[sp,#3]
;;;542    	lc640_write_long_ptr(lc640_adr+16,data);
000856  4669              MOV      r1,sp
000858  f10a0010          ADD      r0,r10,#0x10
00085c  f7fffffe          BL       lc640_write_long_ptr
;;;543    
;;;544    	data[0]=LPC_RTC->HOUR;
000860  f8990028          LDRB     r0,[r9,#0x28]
000864  f88d0000          STRB     r0,[sp,#0]
;;;545    	data[1]=LPC_RTC->MIN;
000868  f8990024          LDRB     r0,[r9,#0x24]
00086c  f88d0001          STRB     r0,[sp,#1]
;;;546    	data[2]=LPC_RTC->SEC;
000870  f8990020          LDRB     r0,[r9,#0x20]
000874  f88d0002          STRB     r0,[sp,#2]
;;;547    	data[3]=0;
000878  f88d8003          STRB     r8,[sp,#3]
;;;548    	lc640_write_long_ptr(lc640_adr+20,data);
00087c  4669              MOV      r1,sp
00087e  f10a0014          ADD      r0,r10,#0x14
000882  f7fffffe          BL       lc640_write_long_ptr
;;;549    	
;;;550    	data[0]='B';
000886  2442              MOVS     r4,#0x42
000888  f88d4000          STRB     r4,[sp,#0]
;;;551    	data[1]='B';
00088c  f88d4001          STRB     r4,[sp,#1]
;;;552    	data[2]='B';
000890  f88d4002          STRB     r4,[sp,#2]
;;;553    	data[3]='B';
000894  f88d4003          STRB     r4,[sp,#3]
;;;554    	lc640_write_long_ptr(lc640_adr+24,data);
000898  4669              MOV      r1,sp
00089a  f10a0018          ADD      r0,r10,#0x18
00089e  f7fffffe          BL       lc640_write_long_ptr
;;;555    	
;;;556    	data[0]='B';
0008a2  f88d4000          STRB     r4,[sp,#0]
;;;557    	data[1]='B';
0008a6  f88d4001          STRB     r4,[sp,#1]
;;;558    	data[2]='B';
0008aa  f88d4002          STRB     r4,[sp,#2]
;;;559    	data[3]='B';
0008ae  f88d4003          STRB     r4,[sp,#3]
;;;560    	lc640_write_long_ptr(lc640_adr+28,data);
0008b2  4669              MOV      r1,sp
0008b4  e0be              B        |L1.2612|
0008b6  0000              DCW      0x0000
                  |L1.2232|
                          DCD      net_Ustore
                  |L1.2236|
0008bc  4d61696e          DCB      "Main power is on",0
0008c0  20706f77
0008c4  65722069
0008c8  73206f6e
0008cc  00      
0008cd  00                DCB      0
0008ce  00                DCB      0
0008cf  00                DCB      0
                  |L1.2256|
                          DCD      0x40024000
                  |L1.2260|
                          DCD      bps
                  |L1.2264|
0008d8  42505320          DCB      "BPS #1 Alarm, overheat",0
0008dc  23312041
0008e0  6c61726d
0008e4  2c206f76
0008e8  65726865
0008ec  617400  
0008ef  00                DCB      0
                  |L1.2288|
0008f0  42505320          DCB      "BPS #1 Alarm, voltage is up",0
0008f4  23312041
0008f8  6c61726d
0008fc  2c20766f
000900  6c746167
000904  65206973
000908  20757000
                  |L1.2316|
00090c  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000910  23312041
000914  6c61726d
000918  2c20766f
00091c  6c746167
000920  65206973
000924  20646f77
000928  6e00    
00092a  00                DCB      0
00092b  00                DCB      0
                  |L1.2348|
00092c  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000930  23312041
000934  6c61726d
000938  2c20636f
00093c  6e6e6563
000940  74206973
000944  206c6f73
000948  7400    
00094a  00                DCB      0
00094b  00                DCB      0
                  |L1.2380|
00094c  42505320          DCB      "BPS #2 Alarm, overheat",0
000950  23322041
000954  6c61726d
000958  2c206f76
00095c  65726865
000960  617400  
000963  00                DCB      0
                  |L1.2404|
000964  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000968  23322041
00096c  6c61726d
000970  2c20766f
000974  6c746167
000978  65206973
00097c  20757000
                  |L1.2432|
000980  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000984  23322041
000988  6c61726d
00098c  2c20766f
000990  6c746167
000994  65206973
000998  20646f77
00099c  6e00    
00099e  00                DCB      0
00099f  00                DCB      0
                  |L1.2464|
0009a0  42505320          DCB      "BPS #2 Alarm, connect is lost",0
0009a4  23322041
0009a8  6c61726d
0009ac  2c20636f
0009b0  6e6e6563
0009b4  74206973
0009b8  206c6f73
0009bc  7400    
0009be  00                DCB      0
0009bf  00                DCB      0
                  |L1.2496|
0009c0  42505320          DCB      "BPS #3 Alarm, overheat",0
0009c4  23332041
0009c8  6c61726d
0009cc  2c206f76
0009d0  65726865
0009d4  617400  
0009d7  00                DCB      0
                  |L1.2520|
0009d8  42505320          DCB      "BPS #3 Alarm, voltage is up",0
0009dc  23332041
0009e0  6c61726d
0009e4  2c20766f
0009e8  6c746167
0009ec  65206973
0009f0  20757000
                  |L1.2548|
0009f4  42505320          DCB      "BPS #3 Alarm, voltage is down",0
0009f8  23332041
0009fc  6c61726d
000a00  2c20766f
000a04  6c746167
000a08  65206973
000a0c  20646f77
000a10  6e00    
000a12  00                DCB      0
000a13  00                DCB      0
                  |L1.2580|
000a14  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000a18  23332041
000a1c  6c61726d
000a20  2c20636f
000a24  6e6e6563
000a28  74206973
000a2c  206c6f73
000a30  7400    
000a32  00                DCB      0
000a33  00                DCB      0
                  |L1.2612|
000a34  f10a001c          ADD      r0,r10,#0x1c
000a38  f7fffffe          BL       lc640_write_long_ptr
                  |L1.2620|
;;;561    	
;;;562    	}
;;;563    	
;;;564    avar_src_hndl_end:
;;;565    __nop();		
000a3c  bf00              NOP      
                  |L1.2622|
;;;566    }
000a3e  e8bd8ff8          POP      {r3-r11,pc}
;;;567    
                          ENDP

                  wrk_mem_hndl PROC
;;;568    //-----------------------------------------------
;;;569    void wrk_mem_hndl(char b)
000a42  e92d41fc          PUSH     {r2-r8,lr}
;;;570    {
000a46  4606              MOV      r6,r0
;;;571    char data[4];
;;;572    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;573    
;;;574    signed short temp_temp;
;;;575    
;;;576    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000a48  eb060046          ADD      r0,r6,r6,LSL #1
000a4c  eb001106          ADD      r1,r0,r6,LSL #4
000a50  48ff              LDR      r0,|L1.3664|
000a52  eb000481          ADD      r4,r0,r1,LSL #2
000a56  8be0              LDRH     r0,[r4,#0x1e]
000a58  2805              CMP      r0,#5
000a5a  d379              BCC      |L1.2896|
;;;577    
;;;578    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000a5c  48fd              LDR      r0,|L1.3668|
000a5e  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000a60  1d80              ADDS     r0,r0,#6
000a62  f0000007          AND      r0,r0,#7
000a66  eb040040          ADD      r0,r4,r0,LSL #1
000a6a  8c00              LDRH     r0,[r0,#0x20]
000a6c  9000              STR      r0,[sp,#0]
;;;579    
;;;580    
;;;581    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000a6e  f44f6760          MOV      r7,#0xe00
000a72  4638              MOV      r0,r7
000a74  f7fffffe          BL       lc640_read_int
;;;582    event_ptr++;	
000a78  1c40              ADDS     r0,r0,#1
000a7a  b285              UXTH     r5,r0
;;;583    if(event_ptr>63)event_ptr=0;	
000a7c  2d3f              CMP      r5,#0x3f
000a7e  d900              BLS      |L1.2690|
000a80  2500              MOVS     r5,#0
                  |L1.2690|
;;;584    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000a82  b229              SXTH     r1,r5
000a84  4638              MOV      r0,r7
000a86  f7fffffe          BL       lc640_write_int
;;;585    	
;;;586    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000a8a  f6406802          MOV      r8,#0xe02
000a8e  4640              MOV      r0,r8
000a90  f7fffffe          BL       lc640_read_int
000a94  b280              UXTH     r0,r0
;;;587    if(event_cnt!=63)event_cnt=event_ptr;
000a96  283f              CMP      r0,#0x3f
000a98  d000              BEQ      |L1.2716|
000a9a  4628              MOV      r0,r5
                  |L1.2716|
;;;588    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000a9c  b201              SXTH     r1,r0
000a9e  4640              MOV      r0,r8
000aa0  f7fffffe          BL       lc640_write_int
;;;589    	
;;;590    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000aa4  4638              MOV      r0,r7
000aa6  f7fffffe          BL       lc640_read_int
000aaa  f44f6180          MOV      r1,#0x400
000aae  eb011040          ADD      r0,r1,r0,LSL #5
000ab2  b285              UXTH     r5,r0
;;;591    	
;;;592    data[0]='B';
000ab4  2042              MOVS     r0,#0x42
000ab6  f88d0004          STRB     r0,[sp,#4]
;;;593    data[1]=b; 
000aba  f88d6005          STRB     r6,[sp,#5]
;;;594    data[2]='W';
000abe  2057              MOVS     r0,#0x57
000ac0  f88d0006          STRB     r0,[sp,#6]
;;;595    data[3]=0;
000ac4  2600              MOVS     r6,#0
000ac6  f88d6007          STRB     r6,[sp,#7]
;;;596    
;;;597    lc640_write_long_ptr(lc640_adr,data);
000aca  a901              ADD      r1,sp,#4
000acc  4628              MOV      r0,r5
000ace  f7fffffe          BL       lc640_write_long_ptr
;;;598    
;;;599    data[0]=*((char*)&bat[b]._Iintegr_);
000ad2  7fa0              LDRB     r0,[r4,#0x1e]
000ad4  f88d0004          STRB     r0,[sp,#4]
;;;600    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000ad8  7fe0              LDRB     r0,[r4,#0x1f]
000ada  f88d0005          STRB     r0,[sp,#5]
;;;601    data[2]=*((char*)&temp_temp);
000ade  f89d0000          LDRB     r0,[sp,#0]
000ae2  f88d0006          STRB     r0,[sp,#6]
;;;602    data[3]=*(((char*)(&temp_temp))+1);
000ae6  f89d0001          LDRB     r0,[sp,#1]
000aea  f88d0007          STRB     r0,[sp,#7]
;;;603    lc640_write_long_ptr(lc640_adr+4,data);
000aee  a901              ADD      r1,sp,#4
000af0  1d28              ADDS     r0,r5,#4
000af2  f7fffffe          BL       lc640_write_long_ptr
;;;604    
;;;605    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000af6  f1040134          ADD      r1,r4,#0x34
000afa  f1050008          ADD      r0,r5,#8
000afe  f7fffffe          BL       lc640_write_long_ptr
;;;606    	
;;;607    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000b02  f1040138          ADD      r1,r4,#0x38
000b06  f105000c          ADD      r0,r5,#0xc
000b0a  f7fffffe          BL       lc640_write_long_ptr
;;;608    
;;;609    data[0]=LPC_RTC->YEAR;
000b0e  4cd2              LDR      r4,|L1.3672|
000b10  8ba0              LDRH     r0,[r4,#0x1c]
000b12  f88d0004          STRB     r0,[sp,#4]
;;;610    data[1]=LPC_RTC->MONTH;
000b16  7e20              LDRB     r0,[r4,#0x18]
000b18  f88d0005          STRB     r0,[sp,#5]
;;;611    data[2]=LPC_RTC->DOM;
000b1c  7b20              LDRB     r0,[r4,#0xc]
000b1e  f88d0006          STRB     r0,[sp,#6]
;;;612    data[3]=0;
000b22  f88d6007          STRB     r6,[sp,#7]
;;;613    lc640_write_long_ptr(lc640_adr+16,data);
000b26  a901              ADD      r1,sp,#4
000b28  f1050010          ADD      r0,r5,#0x10
000b2c  f7fffffe          BL       lc640_write_long_ptr
;;;614    
;;;615    data[0]=LPC_RTC->HOUR;
000b30  7a20              LDRB     r0,[r4,#8]
000b32  f88d0004          STRB     r0,[sp,#4]
;;;616    data[1]=LPC_RTC->MIN;
000b36  7920              LDRB     r0,[r4,#4]
000b38  f88d0005          STRB     r0,[sp,#5]
;;;617    data[2]=LPC_RTC->SEC;
000b3c  7820              LDRB     r0,[r4,#0]
000b3e  f88d0006          STRB     r0,[sp,#6]
;;;618    data[3]=0;
000b42  f88d6007          STRB     r6,[sp,#7]
;;;619    lc640_write_long_ptr(lc640_adr+20,data);
000b46  a901              ADD      r1,sp,#4
000b48  f1050014          ADD      r0,r5,#0x14
000b4c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.2896|
;;;620    	
;;;621    
;;;622    
;;;623    	
;;;624    wrk_mem_hndl_end:	
;;;625    __nop();
000b50  bf00              NOP      
;;;626    }  
000b52  e8bd81fc          POP      {r2-r8,pc}
;;;627    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;629    //-----------------------------------------------
;;;630    void avar_bat_ips_hndl(char in)
000b56  e92d4ff8          PUSH     {r3-r11,lr}
;;;631    {
;;;632    char data[4];
;;;633    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;634    
;;;635    if(in==1)
;;;636    	{
;;;637    	bat_ips._av|=1;
000b5a  4ac0              LDR      r2,|L1.3676|
;;;638        	ips_bat_av_stat=1;
;;;639    	ips_bat_av_vzvod=1;
;;;640    
;;;641    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;642    	event_ptr++;	
;;;643    	if(event_ptr>63)event_ptr=0;	
;;;644    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;645    	
;;;646         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;647    	if(event_cnt!=63)event_cnt=event_ptr;
;;;648    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;649    	
;;;650    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;651    	
;;;652    	data[0]='B';
;;;653    	data[1]=0;
;;;654    	data[2]='C';
;;;655    	data[3]=0;
;;;656    	lc640_write_long_ptr(lc640_adr,data);
;;;657    
;;;658    	data[0]=0;
;;;659    	data[1]=0;
;;;660    	data[2]=0;
;;;661    	data[3]=0;
;;;662    	lc640_write_long_ptr(lc640_adr+4,data);
;;;663    
;;;664    	data[0]=LPC_RTC->YEAR;
000b5c  f8df82f8          LDR      r8,|L1.3672|
000b60  4cbf              LDR      r4,|L1.3680|
000b62  4bc0              LDR      r3,|L1.3684|
000b64  2742              MOVS     r7,#0x42              ;652
000b66  f892103d          LDRB     r1,[r2,#0x3d]         ;637
000b6a  f1a80820          SUB      r8,r8,#0x20
000b6e  f44f6560          MOV      r5,#0xe00             ;641
000b72  f04f0900          MOV      r9,#0                 ;643
000b76  f44f6a80          MOV      r10,#0x400            ;650
000b7a  2801              CMP      r0,#1                 ;635
000b7c  d17e              BNE      |L1.3196|
000b7e  f0410001          ORR      r0,r1,#1              ;637
000b82  f882003d          STRB     r0,[r2,#0x3d]         ;637
000b86  2001              MOVS     r0,#1                 ;638
000b88  7020              STRB     r0,[r4,#0]            ;638
000b8a  7018              STRB     r0,[r3,#0]            ;639
000b8c  4628              MOV      r0,r5                 ;641
000b8e  f7fffffe          BL       lc640_read_int
000b92  1c40              ADDS     r0,r0,#1              ;642
000b94  b284              UXTH     r4,r0                 ;642
000b96  2c3f              CMP      r4,#0x3f              ;643
000b98  d900              BLS      |L1.2972|
000b9a  2400              MOVS     r4,#0                 ;643
                  |L1.2972|
000b9c  b221              SXTH     r1,r4                 ;644
000b9e  4628              MOV      r0,r5                 ;644
000ba0  f7fffffe          BL       lc640_write_int
000ba4  f6406602          MOV      r6,#0xe02             ;646
000ba8  4630              MOV      r0,r6                 ;646
000baa  f7fffffe          BL       lc640_read_int
000bae  b280              UXTH     r0,r0                 ;646
000bb0  283f              CMP      r0,#0x3f              ;647
000bb2  d000              BEQ      |L1.2998|
000bb4  4620              MOV      r0,r4                 ;647
                  |L1.2998|
000bb6  b201              SXTH     r1,r0                 ;648
000bb8  4630              MOV      r0,r6                 ;648
000bba  f7fffffe          BL       lc640_write_int
000bbe  4628              MOV      r0,r5                 ;650
000bc0  f7fffffe          BL       lc640_read_int
000bc4  eb0a1040          ADD      r0,r10,r0,LSL #5      ;650
000bc8  b284              UXTH     r4,r0                 ;650
000bca  f88d7000          STRB     r7,[sp,#0]            ;652
000bce  f88d9001          STRB     r9,[sp,#1]            ;653
000bd2  2043              MOVS     r0,#0x43              ;654
000bd4  f88d0002          STRB     r0,[sp,#2]            ;654
000bd8  f88d9003          STRB     r9,[sp,#3]            ;655
000bdc  4669              MOV      r1,sp                 ;656
000bde  4620              MOV      r0,r4                 ;656
000be0  f7fffffe          BL       lc640_write_long_ptr
000be4  f8cd9000          STR      r9,[sp,#0]            ;661
000be8  4669              MOV      r1,sp                 ;662
000bea  1d20              ADDS     r0,r4,#4              ;662
000bec  f7fffffe          BL       lc640_write_long_ptr
000bf0  f8b8003c          LDRH     r0,[r8,#0x3c]
000bf4  f88d0000          STRB     r0,[sp,#0]
;;;665    	data[1]=LPC_RTC->MONTH;
000bf8  f8980038          LDRB     r0,[r8,#0x38]
000bfc  f88d0001          STRB     r0,[sp,#1]
;;;666    	data[2]=LPC_RTC->DOM;
000c00  f898002c          LDRB     r0,[r8,#0x2c]
000c04  f88d0002          STRB     r0,[sp,#2]
;;;667    	data[3]=0;
000c08  f88d9003          STRB     r9,[sp,#3]
;;;668    	lc640_write_long_ptr(lc640_adr+8,data);
000c0c  4669              MOV      r1,sp
000c0e  f1040008          ADD      r0,r4,#8
000c12  f7fffffe          BL       lc640_write_long_ptr
;;;669    
;;;670    	data[0]=LPC_RTC->HOUR;
000c16  f8980028          LDRB     r0,[r8,#0x28]
000c1a  f88d0000          STRB     r0,[sp,#0]
;;;671    	data[1]=LPC_RTC->MIN;
000c1e  f8980024          LDRB     r0,[r8,#0x24]
000c22  f88d0001          STRB     r0,[sp,#1]
;;;672    	data[2]=LPC_RTC->SEC;
000c26  f8980020          LDRB     r0,[r8,#0x20]
000c2a  f88d0002          STRB     r0,[sp,#2]
;;;673    	data[3]=0;
000c2e  f88d9003          STRB     r9,[sp,#3]
;;;674    	lc640_write_long_ptr(lc640_adr+12,data);
000c32  4669              MOV      r1,sp
000c34  f104000c          ADD      r0,r4,#0xc
000c38  f7fffffe          BL       lc640_write_long_ptr
;;;675    	
;;;676    	data[0]='A';
000c3c  2541              MOVS     r5,#0x41
000c3e  f88d5000          STRB     r5,[sp,#0]
;;;677    	data[1]='A';
000c42  f88d5001          STRB     r5,[sp,#1]
;;;678    	data[2]='A';
000c46  f88d5002          STRB     r5,[sp,#2]
;;;679    	data[3]='A';
000c4a  f88d5003          STRB     r5,[sp,#3]
;;;680    	lc640_write_long_ptr(lc640_adr+16,data);
000c4e  4669              MOV      r1,sp
000c50  f1040010          ADD      r0,r4,#0x10
000c54  f7fffffe          BL       lc640_write_long_ptr
;;;681    	
;;;682    	data[0]='A';
000c58  f88d5000          STRB     r5,[sp,#0]
;;;683    	data[1]='A';
000c5c  f88d5001          STRB     r5,[sp,#1]
;;;684    	data[2]='A';
000c60  f88d5002          STRB     r5,[sp,#2]
;;;685    	data[3]='A';
000c64  f88d5003          STRB     r5,[sp,#3]
;;;686    	lc640_write_long_ptr(lc640_adr+20,data);
000c68  4669              MOV      r1,sp
000c6a  f1040014          ADD      r0,r4,#0x14
000c6e  f7fffffe          BL       lc640_write_long_ptr
;;;687    	
;;;688    	data[0]='A';
000c72  f88d5000          STRB     r5,[sp,#0]
;;;689    	data[1]='A';
000c76  f88d5001          STRB     r5,[sp,#1]
;;;690    	data[2]='A';
000c7a  e000              B        |L1.3198|
                  |L1.3196|
000c7c  e01c              B        |L1.3256|
                  |L1.3198|
000c7e  f88d5002          STRB     r5,[sp,#2]
;;;691    	data[3]='A';
000c82  f88d5003          STRB     r5,[sp,#3]
;;;692    	lc640_write_long_ptr(lc640_adr+24,data);
000c86  4669              MOV      r1,sp
000c88  f1040018          ADD      r0,r4,#0x18
000c8c  f7fffffe          BL       lc640_write_long_ptr
;;;693    	
;;;694    	data[0]='A';
000c90  f88d5000          STRB     r5,[sp,#0]
;;;695    	data[1]='A';
000c94  f88d5001          STRB     r5,[sp,#1]
;;;696    	data[2]='A';
000c98  f88d5002          STRB     r5,[sp,#2]
;;;697    	data[3]='A';
000c9c  f88d5003          STRB     r5,[sp,#3]
;;;698    	lc640_write_long_ptr(lc640_adr+28,data);
000ca0  4669              MOV      r1,sp
000ca2  f104001c          ADD      r0,r4,#0x1c
000ca6  f7fffffe          BL       lc640_write_long_ptr
;;;699    					
;;;700    	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
000caa  2301              MOVS     r3,#1
000cac  461a              MOV      r2,r3
000cae  2105              MOVS     r1,#5
000cb0  a06d              ADR      r0,|L1.3688|
000cb2  f7fffffe          BL       snmp_trap_send
000cb6  e085              B        |L1.3524|
                  |L1.3256|
;;;701    		
;;;702    	}
;;;703    
;;;704    else if(in==0)
000cb8  2800              CMP      r0,#0
000cba  d125              BNE      |L1.3336|
;;;705    	{
;;;706    	bat_ips._av&=~1;
000cbc  f0210001          BIC      r0,r1,#1
000cc0  f882003d          STRB     r0,[r2,#0x3d]
;;;707    	ips_bat_av_stat=0;
000cc4  f8849000          STRB     r9,[r4,#0]
;;;708    	ips_bat_av_vzvod=0;
000cc8  f8839000          STRB     r9,[r3,#0]
;;;709         
;;;710    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000ccc  4628              MOV      r0,r5
000cce  f7fffffe          BL       lc640_read_int
000cd2  b286              UXTH     r6,r0
;;;711    	event_ptr_find=event_ptr;
000cd4  4634              MOV      r4,r6
                  |L1.3286|
;;;712    	
;;;713    avar_bat_ips_hndl_lbl1: 
;;;714    
;;;715    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000cd6  eb0a1044          ADD      r0,r10,r4,LSL #5
000cda  b285              UXTH     r5,r0
;;;716    
;;;717         lc640_read_long_ptr(lc640_adr,data);
000cdc  4669              MOV      r1,sp
000cde  4628              MOV      r0,r5
000ce0  f7fffffe          BL       lc640_read_long_ptr
;;;718         
;;;719         if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
000ce4  f89d0000          LDRB     r0,[sp,#0]
000ce8  2842              CMP      r0,#0x42
000cea  d106              BNE      |L1.3322|
000cec  f89d0001          LDRB     r0,[sp,#1]
000cf0  b918              CBNZ     r0,|L1.3322|
000cf2  f89d0002          LDRB     r0,[sp,#2]
000cf6  2843              CMP      r0,#0x43
000cf8  d007              BEQ      |L1.3338|
                  |L1.3322|
;;;720         	{        
;;;721         	if(event_ptr_find)event_ptr_find--;
000cfa  b114              CBZ      r4,|L1.3330|
000cfc  1e64              SUBS     r4,r4,#1
000cfe  b2a4              UXTH     r4,r4
000d00  e000              B        |L1.3332|
                  |L1.3330|
;;;722         	else event_ptr_find=63;
000d02  243f              MOVS     r4,#0x3f
                  |L1.3332|
;;;723         	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
000d04  42b4              CMP      r4,r6
000d06  d1e6              BNE      |L1.3286|
                  |L1.3336|
000d08  e05c              B        |L1.3524|
                  |L1.3338|
;;;724         	else goto avar_bat_ips_hndl_lbl1;
;;;725         	}
;;;726         else 
;;;727         	{
;;;728         	lc640_read_long_ptr(lc640_adr+16,data);
000d0a  4669              MOV      r1,sp
000d0c  f1050010          ADD      r0,r5,#0x10
000d10  f7fffffe          BL       lc640_read_long_ptr
;;;729         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000d14  f89d0000          LDRB     r0,[sp,#0]
000d18  2841              CMP      r0,#0x41
000d1a  d10b              BNE      |L1.3380|
000d1c  f89d0001          LDRB     r0,[sp,#1]
000d20  2841              CMP      r0,#0x41
000d22  d107              BNE      |L1.3380|
000d24  f89d0002          LDRB     r0,[sp,#2]
000d28  2841              CMP      r0,#0x41
000d2a  d103              BNE      |L1.3380|
000d2c  f89d0003          LDRB     r0,[sp,#3]
000d30  2841              CMP      r0,#0x41
000d32  d007              BEQ      |L1.3396|
                  |L1.3380|
;;;730         		{        
;;;731         		if(event_ptr_find)event_ptr_find--;
000d34  b114              CBZ      r4,|L1.3388|
000d36  1e64              SUBS     r4,r4,#1
000d38  b2a4              UXTH     r4,r4
000d3a  e000              B        |L1.3390|
                  |L1.3388|
;;;732             		else event_ptr_find=63;
000d3c  243f              MOVS     r4,#0x3f
                  |L1.3390|
;;;733             	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
000d3e  42b4              CMP      r4,r6
000d40  d1c9              BNE      |L1.3286|
000d42  e03f              B        |L1.3524|
                  |L1.3396|
;;;734         		else goto avar_bat_ips_hndl_lbl1;
;;;735         		}
;;;736    
;;;737         	}
;;;738         		
;;;739    	data[0]=LPC_RTC->YEAR;
000d44  f8b8003c          LDRH     r0,[r8,#0x3c]
000d48  f88d0000          STRB     r0,[sp,#0]
;;;740    	data[1]=LPC_RTC->MONTH;
000d4c  f8980038          LDRB     r0,[r8,#0x38]
000d50  f88d0001          STRB     r0,[sp,#1]
;;;741    	data[2]=LPC_RTC->DOM;
000d54  f898002c          LDRB     r0,[r8,#0x2c]
000d58  f88d0002          STRB     r0,[sp,#2]
;;;742    	data[3]=0;
000d5c  f88d9003          STRB     r9,[sp,#3]
;;;743    	lc640_write_long_ptr(lc640_adr+16,data);
000d60  4669              MOV      r1,sp
000d62  f1050010          ADD      r0,r5,#0x10
000d66  f7fffffe          BL       lc640_write_long_ptr
;;;744    
;;;745    	data[0]=LPC_RTC->HOUR;
000d6a  f8980028          LDRB     r0,[r8,#0x28]
000d6e  f88d0000          STRB     r0,[sp,#0]
;;;746    	data[1]=LPC_RTC->MIN;
000d72  f8980024          LDRB     r0,[r8,#0x24]
000d76  f88d0001          STRB     r0,[sp,#1]
;;;747    	data[2]=LPC_RTC->SEC;
000d7a  f8980020          LDRB     r0,[r8,#0x20]
000d7e  f88d0002          STRB     r0,[sp,#2]
;;;748    	data[3]=0;
000d82  f88d9003          STRB     r9,[sp,#3]
;;;749    	lc640_write_long_ptr(lc640_adr+20,data);
000d86  4669              MOV      r1,sp
000d88  f1050014          ADD      r0,r5,#0x14
000d8c  f7fffffe          BL       lc640_write_long_ptr
;;;750    	
;;;751    	data[0]='B';
000d90  f88d7000          STRB     r7,[sp,#0]
;;;752    	data[1]='B';
000d94  f88d7001          STRB     r7,[sp,#1]
;;;753    	data[2]='B';
000d98  f88d7002          STRB     r7,[sp,#2]
;;;754    	data[3]='B';
000d9c  f88d7003          STRB     r7,[sp,#3]
;;;755    	lc640_write_long_ptr(lc640_adr+24,data);
000da0  4669              MOV      r1,sp
000da2  f1050018          ADD      r0,r5,#0x18
000da6  f7fffffe          BL       lc640_write_long_ptr
;;;756    	
;;;757    	data[0]='B';
000daa  f88d7000          STRB     r7,[sp,#0]
;;;758    	data[1]='B';
000dae  f88d7001          STRB     r7,[sp,#1]
;;;759    	data[2]='B';
000db2  f88d7002          STRB     r7,[sp,#2]
;;;760    	data[3]='B';
000db6  f88d7003          STRB     r7,[sp,#3]
;;;761    	lc640_write_long_ptr(lc640_adr+28,data);
000dba  4669              MOV      r1,sp
000dbc  f105001c          ADD      r0,r5,#0x1c
000dc0  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3524|
;;;762    	
;;;763    
;;;764    	
;;;765    	}
;;;766    	
;;;767    avar_bat_ips_hndl_end:
;;;768    __nop();		
000dc4  bf00              NOP      
                  |L1.3526|
;;;769    }
000dc6  e63a              B        |L1.2622|
;;;770    
                          ENDP

                  avar_bat_hndl PROC
;;;773    //-----------------------------------------------
;;;774    void avar_bat_hndl(char b, char in)
000dc8  e92d4ff8          PUSH     {r3-r11,lr}
;;;775    {
000dcc  4607              MOV      r7,r0
;;;776    char data[4];
;;;777    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;778    
;;;779    if(in==1)
;;;780    	{
;;;781    	bat[b]._av|=1;
000dce  4a20              LDR      r2,|L1.3664|
;;;782        
;;;783    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;784    	event_ptr++;	
;;;785    	if(event_ptr>63)event_ptr=0;	
;;;786    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;787    	
;;;788         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;789    	if(event_cnt!=63)event_cnt=event_ptr;
;;;790    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;791    	
;;;792    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;793    	
;;;794    	data[0]='B';
;;;795    	data[1]=b;
;;;796    	data[2]='C';
;;;797    	data[3]=0;
;;;798    	lc640_write_long_ptr(lc640_adr,data);
;;;799    
;;;800    	data[0]=0;
;;;801    	data[1]=0;
;;;802    	data[2]=0;
;;;803    	data[3]=0;
;;;804    	lc640_write_long_ptr(lc640_adr+4,data);
;;;805    
;;;806    	data[0]=LPC_RTC->YEAR;
000dd0  f8dfa084          LDR      r10,|L1.3672|
000dd4  eb070347          ADD      r3,r7,r7,LSL #1       ;781
000dd8  eb031307          ADD      r3,r3,r7,LSL #4       ;781
000ddc  f04f0800          MOV      r8,#0                 ;785
000de0  f04f0942          MOV      r9,#0x42              ;794
000de4  f1aa0a20          SUB      r10,r10,#0x20
000de8  f44f6060          MOV      r0,#0xe00             ;783
000dec  f44f6b80          MOV      r11,#0x400            ;792
000df0  eb020283          ADD      r2,r2,r3,LSL #2       ;781
000df4  2901              CMP      r1,#1                 ;779
000df6  d17e              BNE      |L1.3830|
000df8  f8121f3d          LDRB     r1,[r2,#0x3d]!        ;781
000dfc  f0410101          ORR      r1,r1,#1              ;781
000e00  7011              STRB     r1,[r2,#0]            ;781
000e02  4605              MOV      r5,r0                 ;783
000e04  f7fffffe          BL       lc640_read_int
000e08  1c40              ADDS     r0,r0,#1              ;784
000e0a  b284              UXTH     r4,r0                 ;784
000e0c  2c3f              CMP      r4,#0x3f              ;785
000e0e  d900              BLS      |L1.3602|
000e10  2400              MOVS     r4,#0                 ;785
                  |L1.3602|
000e12  b221              SXTH     r1,r4                 ;786
000e14  4628              MOV      r0,r5                 ;786
000e16  f7fffffe          BL       lc640_write_int
000e1a  f6406602          MOV      r6,#0xe02             ;788
000e1e  4630              MOV      r0,r6                 ;788
000e20  f7fffffe          BL       lc640_read_int
000e24  b280              UXTH     r0,r0                 ;788
000e26  283f              CMP      r0,#0x3f              ;789
000e28  d000              BEQ      |L1.3628|
000e2a  4620              MOV      r0,r4                 ;789
                  |L1.3628|
000e2c  b201              SXTH     r1,r0                 ;790
000e2e  4630              MOV      r0,r6                 ;790
000e30  f7fffffe          BL       lc640_write_int
000e34  4628              MOV      r0,r5                 ;792
000e36  f7fffffe          BL       lc640_read_int
000e3a  eb0b1040          ADD      r0,r11,r0,LSL #5      ;792
000e3e  b284              UXTH     r4,r0                 ;792
000e40  f88d9000          STRB     r9,[sp,#0]            ;794
000e44  f88d7001          STRB     r7,[sp,#1]            ;795
000e48  2043              MOVS     r0,#0x43              ;796
000e4a  f88d0002          STRB     r0,[sp,#2]            ;796
000e4e  e015              B        |L1.3708|
                  |L1.3664|
                          DCD      bat
                  |L1.3668|
                          DCD      bat_u_old_cnt
                  |L1.3672|
                          DCD      0x40024020
                  |L1.3676|
                          DCD      bat_ips
                  |L1.3680|
                          DCD      ips_bat_av_stat
                  |L1.3684|
                          DCD      ips_bat_av_vzvod
                  |L1.3688|
000e68  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
000e6c  b9312041
000e70  6c61726d
000e74  2c206c6f
000e78  737400  
000e7b  00                DCB      0
                  |L1.3708|
000e7c  f88d8003          STRB     r8,[sp,#3]            ;797
000e80  4669              MOV      r1,sp                 ;798
000e82  4620              MOV      r0,r4                 ;798
000e84  f7fffffe          BL       lc640_write_long_ptr
000e88  f8cd8000          STR      r8,[sp,#0]            ;803
000e8c  4669              MOV      r1,sp                 ;804
000e8e  1d20              ADDS     r0,r4,#4              ;804
000e90  f7fffffe          BL       lc640_write_long_ptr
000e94  f8ba003c          LDRH     r0,[r10,#0x3c]
000e98  f88d0000          STRB     r0,[sp,#0]
;;;807    	data[1]=LPC_RTC->MONTH;
000e9c  f89a0038          LDRB     r0,[r10,#0x38]
000ea0  f88d0001          STRB     r0,[sp,#1]
;;;808    	data[2]=LPC_RTC->DOM;
000ea4  f89a002c          LDRB     r0,[r10,#0x2c]
000ea8  f88d0002          STRB     r0,[sp,#2]
;;;809    	data[3]=0;
000eac  f88d8003          STRB     r8,[sp,#3]
;;;810    	lc640_write_long_ptr(lc640_adr+8,data);
000eb0  4669              MOV      r1,sp
000eb2  f1040008          ADD      r0,r4,#8
000eb6  f7fffffe          BL       lc640_write_long_ptr
;;;811    
;;;812    	data[0]=LPC_RTC->HOUR;
000eba  f89a0028          LDRB     r0,[r10,#0x28]
000ebe  f88d0000          STRB     r0,[sp,#0]
;;;813    	data[1]=LPC_RTC->MIN;
000ec2  f89a0024          LDRB     r0,[r10,#0x24]
000ec6  f88d0001          STRB     r0,[sp,#1]
;;;814    	data[2]=LPC_RTC->SEC;
000eca  f89a0020          LDRB     r0,[r10,#0x20]
000ece  f88d0002          STRB     r0,[sp,#2]
;;;815    	data[3]=0;
000ed2  f88d8003          STRB     r8,[sp,#3]
;;;816    	lc640_write_long_ptr(lc640_adr+12,data);
000ed6  4669              MOV      r1,sp
000ed8  f104000c          ADD      r0,r4,#0xc
000edc  f7fffffe          BL       lc640_write_long_ptr
;;;817    	
;;;818    	data[0]='A';
000ee0  2541              MOVS     r5,#0x41
000ee2  f88d5000          STRB     r5,[sp,#0]
;;;819    	data[1]='A';
000ee6  f88d5001          STRB     r5,[sp,#1]
;;;820    	data[2]='A';
000eea  f88d5002          STRB     r5,[sp,#2]
;;;821    	data[3]='A';
000eee  f88d5003          STRB     r5,[sp,#3]
;;;822    	lc640_write_long_ptr(lc640_adr+16,data);
000ef2  4669              MOV      r1,sp
000ef4  e000              B        |L1.3832|
                  |L1.3830|
000ef6  e03b              B        |L1.3952|
                  |L1.3832|
000ef8  f1040010          ADD      r0,r4,#0x10
000efc  f7fffffe          BL       lc640_write_long_ptr
;;;823    	
;;;824    	data[0]='A';
000f00  f88d5000          STRB     r5,[sp,#0]
;;;825    	data[1]='A';
000f04  f88d5001          STRB     r5,[sp,#1]
;;;826    	data[2]='A';
000f08  f88d5002          STRB     r5,[sp,#2]
;;;827    	data[3]='A';
000f0c  f88d5003          STRB     r5,[sp,#3]
;;;828    	lc640_write_long_ptr(lc640_adr+20,data);
000f10  4669              MOV      r1,sp
000f12  f1040014          ADD      r0,r4,#0x14
000f16  f7fffffe          BL       lc640_write_long_ptr
;;;829    	
;;;830    	data[0]='A';
000f1a  f88d5000          STRB     r5,[sp,#0]
;;;831    	data[1]='A';
000f1e  f88d5001          STRB     r5,[sp,#1]
;;;832    	data[2]='A';
000f22  f88d5002          STRB     r5,[sp,#2]
;;;833    	data[3]='A';
000f26  f88d5003          STRB     r5,[sp,#3]
;;;834    	lc640_write_long_ptr(lc640_adr+24,data);
000f2a  4669              MOV      r1,sp
000f2c  f1040018          ADD      r0,r4,#0x18
000f30  f7fffffe          BL       lc640_write_long_ptr
;;;835    	
;;;836    	data[0]='A';
000f34  f88d5000          STRB     r5,[sp,#0]
;;;837    	data[1]='A';
000f38  f88d5001          STRB     r5,[sp,#1]
;;;838    	data[2]='A';
000f3c  f88d5002          STRB     r5,[sp,#2]
;;;839    	data[3]='A';
000f40  f88d5003          STRB     r5,[sp,#3]
;;;840    	lc640_write_long_ptr(lc640_adr+28,data);
000f44  4669              MOV      r1,sp
000f46  f104001c          ADD      r0,r4,#0x1c
000f4a  f7fffffe          BL       lc640_write_long_ptr
;;;841    					
;;;842    	if(b==0)
000f4e  b937              CBNZ     r7,|L1.3934|
;;;843    		{
;;;844    		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
000f50  2301              MOVS     r3,#1
000f52  461a              MOV      r2,r3
000f54  2105              MOVS     r1,#5
000f56  a0ff              ADR      r0,|L1.4948|
000f58  f7fffffe          BL       snmp_trap_send
000f5c  e08b              B        |L1.4214|
                  |L1.3934|
;;;845    		}
;;;846    	else if(b==1)
000f5e  2f01              CMP      r7,#1
000f60  d105              BNE      |L1.3950|
;;;847    		{
;;;848    		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
000f62  2301              MOVS     r3,#1
000f64  2202              MOVS     r2,#2
000f66  2105              MOVS     r1,#5
000f68  a0ff              ADR      r0,|L1.4968|
000f6a  f7fffffe          BL       snmp_trap_send
                  |L1.3950|
000f6e  e082              B        |L1.4214|
                  |L1.3952|
;;;849    		} 
;;;850    			
;;;851    	}
;;;852    
;;;853    else if(in==0)
000f70  2900              CMP      r1,#0
000f72  d122              BNE      |L1.4026|
;;;854    	{
;;;855    	bat[b]._av&=~1;
000f74  f8121f3d          LDRB     r1,[r2,#0x3d]!
000f78  f0210101          BIC      r1,r1,#1
000f7c  7011              STRB     r1,[r2,#0]
;;;856    
;;;857         event_ptr=lc640_read_int(PTR_EVENT_LOG);
000f7e  f7fffffe          BL       lc640_read_int
000f82  b286              UXTH     r6,r0
;;;858    	event_ptr_find=event_ptr;
000f84  4634              MOV      r4,r6
                  |L1.3974|
;;;859    	
;;;860    avar_bat_hndl_lbl1: 
;;;861    
;;;862    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000f86  eb0b1044          ADD      r0,r11,r4,LSL #5
000f8a  b285              UXTH     r5,r0
;;;863    
;;;864         lc640_read_long_ptr(lc640_adr,data);
000f8c  4669              MOV      r1,sp
000f8e  4628              MOV      r0,r5
000f90  f7fffffe          BL       lc640_read_long_ptr
;;;865         
;;;866         if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
000f94  f89d0000          LDRB     r0,[sp,#0]
000f98  2842              CMP      r0,#0x42
000f9a  d107              BNE      |L1.4012|
000f9c  f89d0001          LDRB     r0,[sp,#1]
000fa0  42b8              CMP      r0,r7
000fa2  d103              BNE      |L1.4012|
000fa4  f89d0002          LDRB     r0,[sp,#2]
000fa8  2843              CMP      r0,#0x43
000faa  d007              BEQ      |L1.4028|
                  |L1.4012|
;;;867         	{        
;;;868         	if(event_ptr_find)event_ptr_find--;
000fac  b114              CBZ      r4,|L1.4020|
000fae  1e64              SUBS     r4,r4,#1
000fb0  b2a4              UXTH     r4,r4
000fb2  e000              B        |L1.4022|
                  |L1.4020|
;;;869         	else event_ptr_find=63;
000fb4  243f              MOVS     r4,#0x3f
                  |L1.4022|
;;;870         	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
000fb6  42b4              CMP      r4,r6
000fb8  d1e5              BNE      |L1.3974|
                  |L1.4026|
000fba  e05c              B        |L1.4214|
                  |L1.4028|
;;;871         	else goto avar_bat_hndl_lbl1;
;;;872         	}
;;;873         else 
;;;874         	{
;;;875         	lc640_read_long_ptr(lc640_adr+16,data);
000fbc  4669              MOV      r1,sp
000fbe  f1050010          ADD      r0,r5,#0x10
000fc2  f7fffffe          BL       lc640_read_long_ptr
;;;876         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000fc6  f89d0000          LDRB     r0,[sp,#0]
000fca  2841              CMP      r0,#0x41
000fcc  d10b              BNE      |L1.4070|
000fce  f89d0001          LDRB     r0,[sp,#1]
000fd2  2841              CMP      r0,#0x41
000fd4  d107              BNE      |L1.4070|
000fd6  f89d0002          LDRB     r0,[sp,#2]
000fda  2841              CMP      r0,#0x41
000fdc  d103              BNE      |L1.4070|
000fde  f89d0003          LDRB     r0,[sp,#3]
000fe2  2841              CMP      r0,#0x41
000fe4  d007              BEQ      |L1.4086|
                  |L1.4070|
;;;877         		{        
;;;878         		if(event_ptr_find)event_ptr_find--;
000fe6  b114              CBZ      r4,|L1.4078|
000fe8  1e64              SUBS     r4,r4,#1
000fea  b2a4              UXTH     r4,r4
000fec  e000              B        |L1.4080|
                  |L1.4078|
;;;879             		else event_ptr_find=63;
000fee  243f              MOVS     r4,#0x3f
                  |L1.4080|
;;;880             	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
000ff0  42b4              CMP      r4,r6
000ff2  d1c8              BNE      |L1.3974|
000ff4  e03f              B        |L1.4214|
                  |L1.4086|
;;;881         		else goto avar_bat_hndl_lbl1;
;;;882         		}
;;;883    
;;;884         	}
;;;885         		
;;;886    	data[0]=LPC_RTC->YEAR;
000ff6  f8ba003c          LDRH     r0,[r10,#0x3c]
000ffa  f88d0000          STRB     r0,[sp,#0]
;;;887    	data[1]=LPC_RTC->MONTH;
000ffe  f89a0038          LDRB     r0,[r10,#0x38]
001002  f88d0001          STRB     r0,[sp,#1]
;;;888    	data[2]=LPC_RTC->DOM;
001006  f89a002c          LDRB     r0,[r10,#0x2c]
00100a  f88d0002          STRB     r0,[sp,#2]
;;;889    	data[3]=0;
00100e  f88d8003          STRB     r8,[sp,#3]
;;;890    	lc640_write_long_ptr(lc640_adr+16,data);
001012  4669              MOV      r1,sp
001014  f1050010          ADD      r0,r5,#0x10
001018  f7fffffe          BL       lc640_write_long_ptr
;;;891    
;;;892    	data[0]=LPC_RTC->HOUR;
00101c  f89a0028          LDRB     r0,[r10,#0x28]
001020  f88d0000          STRB     r0,[sp,#0]
;;;893    	data[1]=LPC_RTC->MIN;
001024  f89a0024          LDRB     r0,[r10,#0x24]
001028  f88d0001          STRB     r0,[sp,#1]
;;;894    	data[2]=LPC_RTC->SEC;
00102c  f89a0020          LDRB     r0,[r10,#0x20]
001030  f88d0002          STRB     r0,[sp,#2]
;;;895    	data[3]=0;
001034  f88d8003          STRB     r8,[sp,#3]
;;;896    	lc640_write_long_ptr(lc640_adr+20,data);
001038  4669              MOV      r1,sp
00103a  f1050014          ADD      r0,r5,#0x14
00103e  f7fffffe          BL       lc640_write_long_ptr
;;;897    	
;;;898    	data[0]='B';
001042  f88d9000          STRB     r9,[sp,#0]
;;;899    	data[1]='B';
001046  f88d9001          STRB     r9,[sp,#1]
;;;900    	data[2]='B';
00104a  f88d9002          STRB     r9,[sp,#2]
;;;901    	data[3]='B';
00104e  f88d9003          STRB     r9,[sp,#3]
;;;902    	lc640_write_long_ptr(lc640_adr+24,data);
001052  4669              MOV      r1,sp
001054  f1050018          ADD      r0,r5,#0x18
001058  f7fffffe          BL       lc640_write_long_ptr
;;;903    	
;;;904    	data[0]='B';
00105c  f88d9000          STRB     r9,[sp,#0]
;;;905    	data[1]='B';
001060  f88d9001          STRB     r9,[sp,#1]
;;;906    	data[2]='B';
001064  f88d9002          STRB     r9,[sp,#2]
;;;907    	data[3]='B';
001068  f88d9003          STRB     r9,[sp,#3]
;;;908    	lc640_write_long_ptr(lc640_adr+28,data);
00106c  4669              MOV      r1,sp
00106e  f105001c          ADD      r0,r5,#0x1c
001072  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4214|
;;;909    	
;;;910    
;;;911    	
;;;912    	}
;;;913    	
;;;914    avar_bat_hndl_end:
;;;915    __nop();		
001076  bf00              NOP      
                  |L1.4216|
;;;916    }
001078  e4e1              B        |L1.2622|
;;;917    
                          ENDP

                  avar_bat_as_hndl PROC
;;;918    //-----------------------------------------------
;;;919    void avar_bat_as_hndl(char b, char in)
00107a  e92d4ff8          PUSH     {r3-r11,lr}
;;;920    {
00107e  4607              MOV      r7,r0
;;;921    char data[4];
;;;922    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;923    
;;;924    if(in==1)
;;;925    	{
;;;926    	bat[b]._av|=2;
;;;927        
;;;928    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;929    	event_ptr++;	
;;;930    	if(event_ptr>63)event_ptr=0;	
;;;931    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;932    	
;;;933         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;934    	if(event_cnt!=63)event_cnt=event_ptr;
;;;935    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;936    	
;;;937    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;938    	
;;;939    	data[0]='B';
;;;940    	data[1]=b;
;;;941    	data[2]='S';
;;;942    	data[3]=0;
;;;943    	lc640_write_long_ptr(lc640_adr,data);
;;;944    
;;;945    	data[0]=0;
;;;946    	data[1]=0;
;;;947    	data[2]=0;
;;;948    	data[3]=0;
;;;949    	lc640_write_long_ptr(lc640_adr+4,data);
;;;950    
;;;951    	data[0]=LPC_RTC->YEAR;
001080  f8dfa2f8          LDR      r10,|L1.4988|
001084  f04f0800          MOV      r8,#0                 ;930
001088  f04f0942          MOV      r9,#0x42              ;939
00108c  f44f6060          MOV      r0,#0xe00             ;928
001090  f44f6b80          MOV      r11,#0x400            ;937
001094  2901              CMP      r1,#1                 ;924
001096  d17d              BNE      |L1.4500|
001098  eb070147          ADD      r1,r7,r7,LSL #1       ;926
00109c  eb011207          ADD      r2,r1,r7,LSL #4       ;926
0010a0  49b7              LDR      r1,|L1.4992|
0010a2  eb010182          ADD      r1,r1,r2,LSL #2       ;926
0010a6  f8112f3d          LDRB     r2,[r1,#0x3d]!        ;926
0010aa  f0420202          ORR      r2,r2,#2              ;926
0010ae  700a              STRB     r2,[r1,#0]            ;926
0010b0  4605              MOV      r5,r0                 ;928
0010b2  f7fffffe          BL       lc640_read_int
0010b6  1c40              ADDS     r0,r0,#1              ;929
0010b8  b284              UXTH     r4,r0                 ;929
0010ba  2c3f              CMP      r4,#0x3f              ;930
0010bc  d900              BLS      |L1.4288|
0010be  2400              MOVS     r4,#0                 ;930
                  |L1.4288|
0010c0  b221              SXTH     r1,r4                 ;931
0010c2  4628              MOV      r0,r5                 ;931
0010c4  f7fffffe          BL       lc640_write_int
0010c8  f6406602          MOV      r6,#0xe02             ;933
0010cc  4630              MOV      r0,r6                 ;933
0010ce  f7fffffe          BL       lc640_read_int
0010d2  b280              UXTH     r0,r0                 ;933
0010d4  283f              CMP      r0,#0x3f              ;934
0010d6  d000              BEQ      |L1.4314|
0010d8  4620              MOV      r0,r4                 ;934
                  |L1.4314|
0010da  b201              SXTH     r1,r0                 ;935
0010dc  4630              MOV      r0,r6                 ;935
0010de  f7fffffe          BL       lc640_write_int
0010e2  4628              MOV      r0,r5                 ;937
0010e4  f7fffffe          BL       lc640_read_int
0010e8  eb0b1040          ADD      r0,r11,r0,LSL #5      ;937
0010ec  b284              UXTH     r4,r0                 ;937
0010ee  f88d9000          STRB     r9,[sp,#0]            ;939
0010f2  f88d7001          STRB     r7,[sp,#1]            ;940
0010f6  2053              MOVS     r0,#0x53              ;941
0010f8  f88d0002          STRB     r0,[sp,#2]            ;941
0010fc  f88d8003          STRB     r8,[sp,#3]            ;942
001100  4669              MOV      r1,sp                 ;943
001102  4620              MOV      r0,r4                 ;943
001104  f7fffffe          BL       lc640_write_long_ptr
001108  f8cd8000          STR      r8,[sp,#0]            ;948
00110c  4669              MOV      r1,sp                 ;949
00110e  1d20              ADDS     r0,r4,#4              ;949
001110  f7fffffe          BL       lc640_write_long_ptr
001114  f8ba003c          LDRH     r0,[r10,#0x3c]
001118  f88d0000          STRB     r0,[sp,#0]
;;;952    	data[1]=LPC_RTC->MONTH;
00111c  f89a0038          LDRB     r0,[r10,#0x38]
001120  f88d0001          STRB     r0,[sp,#1]
;;;953    	data[2]=LPC_RTC->DOM;
001124  f89a002c          LDRB     r0,[r10,#0x2c]
001128  f88d0002          STRB     r0,[sp,#2]
;;;954    	data[3]=0;
00112c  f88d8003          STRB     r8,[sp,#3]
;;;955    	lc640_write_long_ptr(lc640_adr+8,data);
001130  4669              MOV      r1,sp
001132  f1040008          ADD      r0,r4,#8
001136  f7fffffe          BL       lc640_write_long_ptr
;;;956    
;;;957    	data[0]=LPC_RTC->HOUR;
00113a  f89a0028          LDRB     r0,[r10,#0x28]
00113e  f88d0000          STRB     r0,[sp,#0]
;;;958    	data[1]=LPC_RTC->MIN;
001142  f89a0024          LDRB     r0,[r10,#0x24]
001146  f88d0001          STRB     r0,[sp,#1]
;;;959    	data[2]=LPC_RTC->SEC;
00114a  f89a0020          LDRB     r0,[r10,#0x20]
00114e  f88d0002          STRB     r0,[sp,#2]
;;;960    	data[3]=0;
001152  f88d8003          STRB     r8,[sp,#3]
;;;961    	lc640_write_long_ptr(lc640_adr+12,data);
001156  4669              MOV      r1,sp
001158  f104000c          ADD      r0,r4,#0xc
00115c  f7fffffe          BL       lc640_write_long_ptr
;;;962    	
;;;963    	data[0]='A';
001160  2541              MOVS     r5,#0x41
001162  f88d5000          STRB     r5,[sp,#0]
;;;964    	data[1]='A';
001166  f88d5001          STRB     r5,[sp,#1]
;;;965    	data[2]='A';
00116a  f88d5002          STRB     r5,[sp,#2]
;;;966    	data[3]='A';
00116e  f88d5003          STRB     r5,[sp,#3]
;;;967    	lc640_write_long_ptr(lc640_adr+16,data);
001172  4669              MOV      r1,sp
001174  f1040010          ADD      r0,r4,#0x10
001178  f7fffffe          BL       lc640_write_long_ptr
;;;968    	
;;;969    	data[0]='A';
00117c  f88d5000          STRB     r5,[sp,#0]
;;;970    	data[1]='A';
001180  f88d5001          STRB     r5,[sp,#1]
;;;971    	data[2]='A';
001184  f88d5002          STRB     r5,[sp,#2]
;;;972    	data[3]='A';
001188  f88d5003          STRB     r5,[sp,#3]
;;;973    	lc640_write_long_ptr(lc640_adr+20,data);
00118c  4669              MOV      r1,sp
00118e  f1040014          ADD      r0,r4,#0x14
001192  e000              B        |L1.4502|
                  |L1.4500|
001194  e02c              B        |L1.4592|
                  |L1.4502|
001196  f7fffffe          BL       lc640_write_long_ptr
;;;974    	
;;;975    	data[0]='A';
00119a  f88d5000          STRB     r5,[sp,#0]
;;;976    	data[1]='A';
00119e  f88d5001          STRB     r5,[sp,#1]
;;;977    	data[2]='A';
0011a2  f88d5002          STRB     r5,[sp,#2]
;;;978    	data[3]='A';
0011a6  f88d5003          STRB     r5,[sp,#3]
;;;979    	lc640_write_long_ptr(lc640_adr+24,data);
0011aa  4669              MOV      r1,sp
0011ac  f1040018          ADD      r0,r4,#0x18
0011b0  f7fffffe          BL       lc640_write_long_ptr
;;;980    	
;;;981    	data[0]='A';
0011b4  f88d5000          STRB     r5,[sp,#0]
;;;982    	data[1]='A';
0011b8  f88d5001          STRB     r5,[sp,#1]
;;;983    	data[2]='A';
0011bc  f88d5002          STRB     r5,[sp,#2]
;;;984    	data[3]='A';
0011c0  f88d5003          STRB     r5,[sp,#3]
;;;985    	lc640_write_long_ptr(lc640_adr+28,data);				
0011c4  4669              MOV      r1,sp
0011c6  f104001c          ADD      r0,r4,#0x1c
0011ca  f7fffffe          BL       lc640_write_long_ptr
;;;986    
;;;987    	if(b==0)
0011ce  b937              CBNZ     r7,|L1.4574|
;;;988    		{
;;;989    		snmp_trap_send("BAT #1 Alarm, assimetry",5,1,2);
0011d0  2302              MOVS     r3,#2
0011d2  2201              MOVS     r2,#1
0011d4  2105              MOVS     r1,#5
0011d6  a06b              ADR      r0,|L1.4996|
0011d8  f7fffffe          BL       snmp_trap_send
0011dc  e086              B        |L1.4844|
                  |L1.4574|
;;;990    		}
;;;991    	else if(b==1)
0011de  2f01              CMP      r7,#1
0011e0  d105              BNE      |L1.4590|
;;;992    		{
;;;993    		snmp_trap_send("BAT #2 Alarm, assimetry",5,2,2);
0011e2  2302              MOVS     r3,#2
0011e4  461a              MOV      r2,r3
0011e6  2105              MOVS     r1,#5
0011e8  a06c              ADR      r0,|L1.5020|
0011ea  f7fffffe          BL       snmp_trap_send
                  |L1.4590|
0011ee  e07d              B        |L1.4844|
                  |L1.4592|
;;;994    		} 
;;;995    	
;;;996    	}
;;;997    
;;;998    else if(in==0)
0011f0  2900              CMP      r1,#0
0011f2  d17b              BNE      |L1.4844|
;;;999    	{
;;;1000   	//bat[b]._av=0;
;;;1001   
;;;1002        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0011f4  f7fffffe          BL       lc640_read_int
0011f8  b286              UXTH     r6,r0
;;;1003   	event_ptr_find=event_ptr;
0011fa  4634              MOV      r4,r6
                  |L1.4604|
;;;1004   	
;;;1005   avar_bat_as_hndl_lbl1: 
;;;1006   
;;;1007   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0011fc  eb0b1044          ADD      r0,r11,r4,LSL #5
001200  b285              UXTH     r5,r0
;;;1008   
;;;1009        lc640_read_long_ptr(lc640_adr,data);
001202  4669              MOV      r1,sp
001204  4628              MOV      r0,r5
001206  f7fffffe          BL       lc640_read_long_ptr
;;;1010        
;;;1011        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
00120a  f89d0000          LDRB     r0,[sp,#0]
00120e  2842              CMP      r0,#0x42
001210  d107              BNE      |L1.4642|
001212  f89d0001          LDRB     r0,[sp,#1]
001216  42b8              CMP      r0,r7
001218  d103              BNE      |L1.4642|
00121a  f89d0002          LDRB     r0,[sp,#2]
00121e  2843              CMP      r0,#0x43
001220  d007              BEQ      |L1.4658|
                  |L1.4642|
;;;1012        	{        
;;;1013        	if(event_ptr_find)event_ptr_find--;
001222  b114              CBZ      r4,|L1.4650|
001224  1e64              SUBS     r4,r4,#1
001226  b2a4              UXTH     r4,r4
001228  e000              B        |L1.4652|
                  |L1.4650|
;;;1014        	else event_ptr_find=63;
00122a  243f              MOVS     r4,#0x3f
                  |L1.4652|
;;;1015        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
00122c  42b4              CMP      r4,r6
00122e  d1e5              BNE      |L1.4604|
001230  e05c              B        |L1.4844|
                  |L1.4658|
;;;1016        	else goto avar_bat_as_hndl_lbl1;
;;;1017        	}
;;;1018        else 
;;;1019        	{
;;;1020        	lc640_read_long_ptr(lc640_adr+16,data);
001232  4669              MOV      r1,sp
001234  f1050010          ADD      r0,r5,#0x10
001238  f7fffffe          BL       lc640_read_long_ptr
;;;1021        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00123c  f89d0000          LDRB     r0,[sp,#0]
001240  2841              CMP      r0,#0x41
001242  d10b              BNE      |L1.4700|
001244  f89d0001          LDRB     r0,[sp,#1]
001248  2841              CMP      r0,#0x41
00124a  d107              BNE      |L1.4700|
00124c  f89d0002          LDRB     r0,[sp,#2]
001250  2841              CMP      r0,#0x41
001252  d103              BNE      |L1.4700|
001254  f89d0003          LDRB     r0,[sp,#3]
001258  2841              CMP      r0,#0x41
00125a  d007              BEQ      |L1.4716|
                  |L1.4700|
;;;1022        		{        
;;;1023        		if(event_ptr_find)event_ptr_find--;
00125c  b114              CBZ      r4,|L1.4708|
00125e  1e64              SUBS     r4,r4,#1
001260  b2a4              UXTH     r4,r4
001262  e000              B        |L1.4710|
                  |L1.4708|
;;;1024            		else event_ptr_find=63;
001264  243f              MOVS     r4,#0x3f
                  |L1.4710|
;;;1025            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001266  42b4              CMP      r4,r6
001268  d1c8              BNE      |L1.4604|
00126a  e03f              B        |L1.4844|
                  |L1.4716|
;;;1026        		else goto avar_bat_as_hndl_lbl1;
;;;1027        		}
;;;1028   
;;;1029        	}
;;;1030        		
;;;1031   	data[0]=LPC_RTC->YEAR;
00126c  f8ba003c          LDRH     r0,[r10,#0x3c]
001270  f88d0000          STRB     r0,[sp,#0]
;;;1032   	data[1]=LPC_RTC->MONTH;
001274  f89a0038          LDRB     r0,[r10,#0x38]
001278  f88d0001          STRB     r0,[sp,#1]
;;;1033   	data[2]=LPC_RTC->DOM;
00127c  f89a002c          LDRB     r0,[r10,#0x2c]
001280  f88d0002          STRB     r0,[sp,#2]
;;;1034   	data[3]=0;
001284  f88d8003          STRB     r8,[sp,#3]
;;;1035   	lc640_write_long_ptr(lc640_adr+16,data);
001288  4669              MOV      r1,sp
00128a  f1050010          ADD      r0,r5,#0x10
00128e  f7fffffe          BL       lc640_write_long_ptr
;;;1036   
;;;1037   	data[0]=LPC_RTC->HOUR;
001292  f89a0028          LDRB     r0,[r10,#0x28]
001296  f88d0000          STRB     r0,[sp,#0]
;;;1038   	data[1]=LPC_RTC->MIN;
00129a  f89a0024          LDRB     r0,[r10,#0x24]
00129e  f88d0001          STRB     r0,[sp,#1]
;;;1039   	data[2]=LPC_RTC->SEC;
0012a2  f89a0020          LDRB     r0,[r10,#0x20]
0012a6  f88d0002          STRB     r0,[sp,#2]
;;;1040   	data[3]=0;
0012aa  f88d8003          STRB     r8,[sp,#3]
;;;1041   	lc640_write_long_ptr(lc640_adr+20,data);
0012ae  4669              MOV      r1,sp
0012b0  f1050014          ADD      r0,r5,#0x14
0012b4  f7fffffe          BL       lc640_write_long_ptr
;;;1042   	
;;;1043   	data[0]='B';
0012b8  f88d9000          STRB     r9,[sp,#0]
;;;1044   	data[1]='B';
0012bc  f88d9001          STRB     r9,[sp,#1]
;;;1045   	data[2]='B';
0012c0  f88d9002          STRB     r9,[sp,#2]
;;;1046   	data[3]='B';
0012c4  f88d9003          STRB     r9,[sp,#3]
;;;1047   	lc640_write_long_ptr(lc640_adr+24,data);
0012c8  4669              MOV      r1,sp
0012ca  f1050018          ADD      r0,r5,#0x18
0012ce  f7fffffe          BL       lc640_write_long_ptr
;;;1048   	
;;;1049   	data[0]='B';
0012d2  f88d9000          STRB     r9,[sp,#0]
;;;1050   	data[1]='B';
0012d6  f88d9001          STRB     r9,[sp,#1]
;;;1051   	data[2]='B';
0012da  f88d9002          STRB     r9,[sp,#2]
;;;1052   	data[3]='B';
0012de  f88d9003          STRB     r9,[sp,#3]
;;;1053   	lc640_write_long_ptr(lc640_adr+28,data);
0012e2  4669              MOV      r1,sp
0012e4  f105001c          ADD      r0,r5,#0x1c
0012e8  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4844|
;;;1054   	
;;;1055   
;;;1056   	
;;;1057   	}
;;;1058   	
;;;1059   avar_bat_as_hndl_end:
;;;1060   __nop();		
0012ec  bf00              NOP      
;;;1061   }
0012ee  e56a              B        |L1.3526|
;;;1062   
                          ENDP

                  ke_mem_hndl PROC
;;;1064   //-----------------------------------------------
;;;1065   void ke_mem_hndl(char b,unsigned short in)
0012f0  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;1066   {
0012f2  b083              SUB      sp,sp,#0xc
0012f4  4605              MOV      r5,r0
;;;1067   char data[4];
;;;1068   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1069   //unsigned char temp,temp_;
;;;1070   //unsigned int tempUI;
;;;1071   //unsigned long tempUL; 
;;;1072   signed temp_temp;
;;;1073   
;;;1074   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
0012f6  eb050045          ADD      r0,r5,r5,LSL #1
0012fa  4921              LDR      r1,|L1.4992|
0012fc  eb001005          ADD      r0,r0,r5,LSL #4
001300  eb010180          ADD      r1,r1,r0,LSL #2
001304  482b              LDR      r0,|L1.5044|
001306  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
00130a  1c40              ADDS     r0,r0,#1
00130c  eb010040          ADD      r0,r1,r0,LSL #1
001310  f9b00020          LDRSH    r0,[r0,#0x20]
001314  9001              STR      r0,[sp,#4]
;;;1075   
;;;1076   event_ptr=lc640_read_int(PTR_EVENT_LOG);
001316  f44f6660          MOV      r6,#0xe00
00131a  4630              MOV      r0,r6
00131c  f7fffffe          BL       lc640_read_int
;;;1077   event_ptr++;	
001320  1c44              ADDS     r4,r0,#1
;;;1078   if(event_ptr>63)event_ptr=0;	
001322  2c3f              CMP      r4,#0x3f
001324  d900              BLS      |L1.4904|
001326  2400              MOVS     r4,#0
                  |L1.4904|
;;;1079   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
001328  b221              SXTH     r1,r4
00132a  4630              MOV      r0,r6
00132c  f7fffffe          BL       lc640_write_int
;;;1080   	
;;;1081   event_cnt=lc640_read_int(CNT_EVENT_LOG);
001330  f6406702          MOV      r7,#0xe02
001334  4638              MOV      r0,r7
001336  f7fffffe          BL       lc640_read_int
;;;1082   if(event_cnt!=63)event_cnt=event_ptr;
00133a  283f              CMP      r0,#0x3f
00133c  d000              BEQ      |L1.4928|
00133e  4620              MOV      r0,r4
                  |L1.4928|
;;;1083   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
001340  b201              SXTH     r1,r0
001342  4638              MOV      r0,r7
001344  f7fffffe          BL       lc640_write_int
;;;1084   	
;;;1085   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
001348  4630              MOV      r0,r6
00134a  f7fffffe          BL       lc640_read_int
00134e  f44f6180          MOV      r1,#0x400
001352  e031              B        |L1.5048|
                  |L1.4948|
001354  42415420          DCB      "BAT #1 Alarm, lost",0
001358  23312041
00135c  6c61726d
001360  2c206c6f
001364  737400  
001367  00                DCB      0
                  |L1.4968|
001368  42415420          DCB      "BAT #2 Alarm, lost",0
00136c  23322041
001370  6c61726d
001374  2c206c6f
001378  737400  
00137b  00                DCB      0
                  |L1.4988|
                          DCD      0x40024000
                  |L1.4992|
                          DCD      bat
                  |L1.4996|
001384  42415420          DCB      "BAT #1 Alarm, assimetry",0
001388  23312041
00138c  6c61726d
001390  2c206173
001394  73696d65
001398  74727900
                  |L1.5020|
00139c  42415420          DCB      "BAT #2 Alarm, assimetry",0
0013a0  23322041
0013a4  6c61726d
0013a8  2c206173
0013ac  73696d65
0013b0  74727900
                  |L1.5044|
                          DCD      bat_u_old_cnt
                  |L1.5048|
0013b8  eb011440          ADD      r4,r1,r0,LSL #5
;;;1086   	
;;;1087   data[0]='B';
0013bc  2042              MOVS     r0,#0x42
0013be  f88d0008          STRB     r0,[sp,#8]
;;;1088   data[1]=b; 
0013c2  f88d5009          STRB     r5,[sp,#9]
;;;1089   data[2]='K';
0013c6  204b              MOVS     r0,#0x4b
0013c8  f88d000a          STRB     r0,[sp,#0xa]
;;;1090   data[3]=0;
0013cc  2600              MOVS     r6,#0
0013ce  f88d600b          STRB     r6,[sp,#0xb]
;;;1091   
;;;1092   lc640_write_long_ptr(lc640_adr,data);
0013d2  a902              ADD      r1,sp,#8
0013d4  4620              MOV      r0,r4
0013d6  f7fffffe          BL       lc640_write_long_ptr
;;;1093   
;;;1094   data[0]=*((char*)&in);
0013da  f89d0010          LDRB     r0,[sp,#0x10]
0013de  f88d0008          STRB     r0,[sp,#8]
;;;1095   data[1]=*(((char*)(&in))+1);
0013e2  f89d0011          LDRB     r0,[sp,#0x11]
0013e6  f88d0009          STRB     r0,[sp,#9]
;;;1096   data[2]=*((char*)&temp_temp);
0013ea  f89d0004          LDRB     r0,[sp,#4]
0013ee  f88d000a          STRB     r0,[sp,#0xa]
;;;1097   data[3]=*(((char*)(&temp_temp))+1);
0013f2  f89d0005          LDRB     r0,[sp,#5]
0013f6  f88d000b          STRB     r0,[sp,#0xb]
;;;1098   lc640_write_long_ptr(lc640_adr+4,data);
0013fa  a902              ADD      r1,sp,#8
0013fc  1d20              ADDS     r0,r4,#4
0013fe  f7fffffe          BL       lc640_write_long_ptr
;;;1099   
;;;1100   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
001402  f44f70fc          MOV      r0,#0x1f8
001406  f7fffffe          BL       lc640_read_long
00140a  4da3              LDR      r5,|L1.5784|
00140c  6028              STR      r0,[r5,#0]  ; ke_date
;;;1101   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
00140e  4629              MOV      r1,r5
001410  f1040008          ADD      r0,r4,#8
001414  f7fffffe          BL       lc640_write_long_ptr
;;;1102   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
001418  f44f70fe          MOV      r0,#0x1fc
00141c  f7fffffe          BL       lc640_read_long
001420  6068              STR      r0,[r5,#4]  ; ke_date
;;;1103   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
001422  1d29              ADDS     r1,r5,#4
001424  f104000c          ADD      r0,r4,#0xc
001428  f7fffffe          BL       lc640_write_long_ptr
;;;1104   
;;;1105   data[0]=LPC_RTC->YEAR;
00142c  4d9b              LDR      r5,|L1.5788|
00142e  8ba8              LDRH     r0,[r5,#0x1c]
001430  f88d0008          STRB     r0,[sp,#8]
;;;1106   data[1]=LPC_RTC->MONTH;
001434  7e28              LDRB     r0,[r5,#0x18]
001436  f88d0009          STRB     r0,[sp,#9]
;;;1107   data[2]=LPC_RTC->DOM;
00143a  7b28              LDRB     r0,[r5,#0xc]
00143c  f88d000a          STRB     r0,[sp,#0xa]
;;;1108   data[3]=0;
001440  f88d600b          STRB     r6,[sp,#0xb]
;;;1109   lc640_write_long_ptr(lc640_adr+16,data);
001444  a902              ADD      r1,sp,#8
001446  f1040010          ADD      r0,r4,#0x10
00144a  f7fffffe          BL       lc640_write_long_ptr
;;;1110   
;;;1111   data[0]=LPC_RTC->HOUR;
00144e  7a28              LDRB     r0,[r5,#8]
001450  f88d0008          STRB     r0,[sp,#8]
;;;1112   data[1]=LPC_RTC->MIN;
001454  7928              LDRB     r0,[r5,#4]
001456  f88d0009          STRB     r0,[sp,#9]
;;;1113   data[2]=LPC_RTC->SEC;
00145a  7828              LDRB     r0,[r5,#0]
00145c  f88d000a          STRB     r0,[sp,#0xa]
;;;1114   data[3]=0;
001460  f88d600b          STRB     r6,[sp,#0xb]
;;;1115   lc640_write_long_ptr(lc640_adr+20,data);
001464  a902              ADD      r1,sp,#8
001466  f1040014          ADD      r0,r4,#0x14
00146a  f7fffffe          BL       lc640_write_long_ptr
;;;1116    
;;;1117   }
00146e  b005              ADD      sp,sp,#0x14
001470  bdf0              POP      {r4-r7,pc}
;;;1118   
                          ENDP

                  vz_mem_hndl PROC
;;;1120   //-----------------------------------------------
;;;1121   void vz_mem_hndl(unsigned short in)
001472  e92d4ff8          PUSH     {r3-r11,lr}
;;;1122   {
;;;1123   char data[4];
;;;1124   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001476  2600              MOVS     r6,#0
001478  2400              MOVS     r4,#0
;;;1125   //char avar_simbol;
;;;1126   
;;;1127   if(in==1)
;;;1128   	{
;;;1129   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1130   	event_ptr++;	
;;;1131   	if(event_ptr>63)event_ptr=0;	
;;;1132   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1133   	
;;;1134        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1135   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1136   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1137   	
;;;1138   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1139   	
;;;1140   	data[0]='B';
;;;1141   	data[1]=0; 
;;;1142   	data[2]='Z';
;;;1143   	data[3]=0;
;;;1144   	lc640_write_long_ptr(lc640_adr,data);
;;;1145   
;;;1146   	data[0]=0;
;;;1147   	data[1]=0;
;;;1148   	data[2]=0;
;;;1149   	data[3]=0;
;;;1150   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1151   
;;;1152   	data[0]=LPC_RTC->YEAR;
00147a  f8df9220          LDR      r9,|L1.5788|
00147e  2742              MOVS     r7,#0x42              ;1140
001480  46a0              MOV      r8,r4                 ;1124
001482  f1a90920          SUB      r9,r9,#0x20
001486  f44f6a80          MOV      r10,#0x400            ;1138
00148a  2801              CMP      r0,#1                 ;1127
00148c  d17d              BNE      |L1.5514|
00148e  f44f6560          MOV      r5,#0xe00             ;1129
001492  4628              MOV      r0,r5                 ;1129
001494  f7fffffe          BL       lc640_read_int
001498  1c44              ADDS     r4,r0,#1              ;1130
00149a  2c3f              CMP      r4,#0x3f              ;1131
00149c  d900              BLS      |L1.5280|
00149e  2400              MOVS     r4,#0                 ;1131
                  |L1.5280|
0014a0  b221              SXTH     r1,r4                 ;1132
0014a2  4628              MOV      r0,r5                 ;1132
0014a4  f7fffffe          BL       lc640_write_int
0014a8  f6406602          MOV      r6,#0xe02             ;1134
0014ac  4630              MOV      r0,r6                 ;1134
0014ae  f7fffffe          BL       lc640_read_int
0014b2  283f              CMP      r0,#0x3f              ;1135
0014b4  d000              BEQ      |L1.5304|
0014b6  4620              MOV      r0,r4                 ;1135
                  |L1.5304|
0014b8  b201              SXTH     r1,r0                 ;1136
0014ba  4630              MOV      r0,r6                 ;1136
0014bc  f7fffffe          BL       lc640_write_int
0014c0  4628              MOV      r0,r5                 ;1138
0014c2  f7fffffe          BL       lc640_read_int
0014c6  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1138
0014ca  f88d7000          STRB     r7,[sp,#0]            ;1140
0014ce  f88d8001          STRB     r8,[sp,#1]            ;1141
0014d2  205a              MOVS     r0,#0x5a              ;1142
0014d4  f88d0002          STRB     r0,[sp,#2]            ;1142
0014d8  f88d8003          STRB     r8,[sp,#3]            ;1143
0014dc  4669              MOV      r1,sp                 ;1144
0014de  4620              MOV      r0,r4                 ;1144
0014e0  f7fffffe          BL       lc640_write_long_ptr
0014e4  f8cd8000          STR      r8,[sp,#0]            ;1149
0014e8  4669              MOV      r1,sp                 ;1150
0014ea  1d20              ADDS     r0,r4,#4              ;1150
0014ec  f7fffffe          BL       lc640_write_long_ptr
0014f0  f8b9003c          LDRH     r0,[r9,#0x3c]
0014f4  f88d0000          STRB     r0,[sp,#0]
;;;1153   	data[1]=LPC_RTC->MONTH;
0014f8  f8990038          LDRB     r0,[r9,#0x38]
0014fc  f88d0001          STRB     r0,[sp,#1]
;;;1154   	data[2]=LPC_RTC->DOM;
001500  f899002c          LDRB     r0,[r9,#0x2c]
001504  f88d0002          STRB     r0,[sp,#2]
;;;1155   	data[3]=0;
001508  f88d8003          STRB     r8,[sp,#3]
;;;1156   	lc640_write_long_ptr(lc640_adr+8,data);
00150c  4669              MOV      r1,sp
00150e  f1040008          ADD      r0,r4,#8
001512  f7fffffe          BL       lc640_write_long_ptr
;;;1157   
;;;1158   	data[0]=LPC_RTC->HOUR;
001516  f8990028          LDRB     r0,[r9,#0x28]
00151a  f88d0000          STRB     r0,[sp,#0]
;;;1159   	data[1]=LPC_RTC->MIN;
00151e  f8990024          LDRB     r0,[r9,#0x24]
001522  f88d0001          STRB     r0,[sp,#1]
;;;1160   	data[2]=LPC_RTC->SEC;
001526  f8990020          LDRB     r0,[r9,#0x20]
00152a  f88d0002          STRB     r0,[sp,#2]
;;;1161   	data[3]=0;
00152e  f88d8003          STRB     r8,[sp,#3]
;;;1162   	lc640_write_long_ptr(lc640_adr+12,data);
001532  4669              MOV      r1,sp
001534  f104000c          ADD      r0,r4,#0xc
001538  f7fffffe          BL       lc640_write_long_ptr
;;;1163   	
;;;1164   	data[0]='A';
00153c  2541              MOVS     r5,#0x41
00153e  f88d5000          STRB     r5,[sp,#0]
;;;1165   	data[1]='A';
001542  f88d5001          STRB     r5,[sp,#1]
;;;1166   	data[2]='A';
001546  f88d5002          STRB     r5,[sp,#2]
;;;1167   	data[3]='A';
00154a  f88d5003          STRB     r5,[sp,#3]
;;;1168   	lc640_write_long_ptr(lc640_adr+16,data);
00154e  4669              MOV      r1,sp
001550  f1040010          ADD      r0,r4,#0x10
001554  f7fffffe          BL       lc640_write_long_ptr
;;;1169   	
;;;1170   	data[0]='A';
001558  f88d5000          STRB     r5,[sp,#0]
;;;1171   	data[1]='A';
00155c  f88d5001          STRB     r5,[sp,#1]
;;;1172   	data[2]='A';
001560  f88d5002          STRB     r5,[sp,#2]
;;;1173   	data[3]='A';
001564  f88d5003          STRB     r5,[sp,#3]
;;;1174   	lc640_write_long_ptr(lc640_adr+20,data);
001568  4669              MOV      r1,sp
00156a  f1040014          ADD      r0,r4,#0x14
00156e  f7fffffe          BL       lc640_write_long_ptr
;;;1175   	
;;;1176   	data[0]='A';
001572  f88d5000          STRB     r5,[sp,#0]
;;;1177   	data[1]='A';
001576  f88d5001          STRB     r5,[sp,#1]
;;;1178   	data[2]='A';
00157a  f88d5002          STRB     r5,[sp,#2]
;;;1179   	data[3]='A';
00157e  f88d5003          STRB     r5,[sp,#3]
;;;1180   	lc640_write_long_ptr(lc640_adr+24,data);
001582  4669              MOV      r1,sp
001584  f1040018          ADD      r0,r4,#0x18
001588  e000              B        |L1.5516|
                  |L1.5514|
00158a  e00f              B        |L1.5548|
                  |L1.5516|
00158c  f7fffffe          BL       lc640_write_long_ptr
;;;1181   	
;;;1182   	data[0]='A';
001590  f88d5000          STRB     r5,[sp,#0]
;;;1183   	data[1]='A';
001594  f88d5001          STRB     r5,[sp,#1]
;;;1184   	data[2]='A';
001598  f88d5002          STRB     r5,[sp,#2]
;;;1185   	data[3]='A';
00159c  f88d5003          STRB     r5,[sp,#3]
;;;1186   	lc640_write_long_ptr(lc640_adr+28,data);		
0015a0  4669              MOV      r1,sp
0015a2  f104001c          ADD      r0,r4,#0x1c
0015a6  f7fffffe          BL       lc640_write_long_ptr
0015aa  e072              B        |L1.5778|
                  |L1.5548|
;;;1187    	
;;;1188   	}
;;;1189   
;;;1190   else if(in==0)
0015ac  2800              CMP      r0,#0
0015ae  d170              BNE      |L1.5778|
                  |L1.5552|
;;;1191   	{      
;;;1192        
;;;1193   vz_mem_hndl_lbl1: 
;;;1194   
;;;1195   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0015b0  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1196   
;;;1197        lc640_read_long_ptr(lc640_adr,data);
0015b4  4669              MOV      r1,sp
0015b6  4628              MOV      r0,r5
0015b8  f7fffffe          BL       lc640_read_long_ptr
;;;1198        
;;;1199        if(!((data[0]=='B')&&(data[2]=='Z')))
0015bc  f89d0000          LDRB     r0,[sp,#0]
0015c0  2842              CMP      r0,#0x42
0015c2  d103              BNE      |L1.5580|
0015c4  f89d0002          LDRB     r0,[sp,#2]
0015c8  285a              CMP      r0,#0x5a
0015ca  d006              BEQ      |L1.5594|
                  |L1.5580|
;;;1200        	{        
;;;1201        	if(event_ptr_find)event_ptr_find--;
0015cc  b10c              CBZ      r4,|L1.5586|
0015ce  1e64              SUBS     r4,r4,#1
0015d0  e000              B        |L1.5588|
                  |L1.5586|
;;;1202        	else event_ptr_find=63;
0015d2  243f              MOVS     r4,#0x3f
                  |L1.5588|
;;;1203        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
0015d4  42b4              CMP      r4,r6
0015d6  d1eb              BNE      |L1.5552|
0015d8  e05b              B        |L1.5778|
                  |L1.5594|
;;;1204        	else goto vz_mem_hndl_lbl1;
;;;1205        	}
;;;1206        else 
;;;1207        	{
;;;1208        	lc640_read_long_ptr(lc640_adr+16,data);
0015da  4669              MOV      r1,sp
0015dc  f1050010          ADD      r0,r5,#0x10
0015e0  f7fffffe          BL       lc640_read_long_ptr
;;;1209        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0015e4  f89d0000          LDRB     r0,[sp,#0]
0015e8  2841              CMP      r0,#0x41
0015ea  d10b              BNE      |L1.5636|
0015ec  f89d0001          LDRB     r0,[sp,#1]
0015f0  2841              CMP      r0,#0x41
0015f2  d107              BNE      |L1.5636|
0015f4  f89d0002          LDRB     r0,[sp,#2]
0015f8  2841              CMP      r0,#0x41
0015fa  d103              BNE      |L1.5636|
0015fc  f89d0003          LDRB     r0,[sp,#3]
001600  2841              CMP      r0,#0x41
001602  d006              BEQ      |L1.5650|
                  |L1.5636|
;;;1210        		{        
;;;1211        		if(event_ptr_find)event_ptr_find--;
001604  b10c              CBZ      r4,|L1.5642|
001606  1e64              SUBS     r4,r4,#1
001608  e000              B        |L1.5644|
                  |L1.5642|
;;;1212            		else event_ptr_find=63;
00160a  243f              MOVS     r4,#0x3f
                  |L1.5644|
;;;1213            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
00160c  42b4              CMP      r4,r6
00160e  d1cf              BNE      |L1.5552|
001610  e03f              B        |L1.5778|
                  |L1.5650|
;;;1214        		else goto vz_mem_hndl_lbl1;
;;;1215        		}
;;;1216   
;;;1217        	}	
;;;1218   
;;;1219   
;;;1220   	
;;;1221   	data[0]=LPC_RTC->YEAR;
001612  f8b9003c          LDRH     r0,[r9,#0x3c]
001616  f88d0000          STRB     r0,[sp,#0]
;;;1222   	data[1]=LPC_RTC->MONTH;
00161a  f8990038          LDRB     r0,[r9,#0x38]
00161e  f88d0001          STRB     r0,[sp,#1]
;;;1223   	data[2]=LPC_RTC->DOM;
001622  f899002c          LDRB     r0,[r9,#0x2c]
001626  f88d0002          STRB     r0,[sp,#2]
;;;1224   	data[3]=0;
00162a  f88d8003          STRB     r8,[sp,#3]
;;;1225   	lc640_write_long_ptr(lc640_adr+16,data);
00162e  4669              MOV      r1,sp
001630  f1050010          ADD      r0,r5,#0x10
001634  f7fffffe          BL       lc640_write_long_ptr
;;;1226   
;;;1227   	data[0]=LPC_RTC->HOUR;
001638  f8990028          LDRB     r0,[r9,#0x28]
00163c  f88d0000          STRB     r0,[sp,#0]
;;;1228   	data[1]=LPC_RTC->MIN;
001640  f8990024          LDRB     r0,[r9,#0x24]
001644  f88d0001          STRB     r0,[sp,#1]
;;;1229   	data[2]=LPC_RTC->SEC;
001648  f8990020          LDRB     r0,[r9,#0x20]
00164c  f88d0002          STRB     r0,[sp,#2]
;;;1230   	data[3]=0;
001650  f88d8003          STRB     r8,[sp,#3]
;;;1231   	lc640_write_long_ptr(lc640_adr+20,data);
001654  4669              MOV      r1,sp
001656  f1050014          ADD      r0,r5,#0x14
00165a  f7fffffe          BL       lc640_write_long_ptr
;;;1232   	
;;;1233   	data[0]='B';
00165e  f88d7000          STRB     r7,[sp,#0]
;;;1234   	data[1]='B';
001662  f88d7001          STRB     r7,[sp,#1]
;;;1235   	data[2]='B';
001666  f88d7002          STRB     r7,[sp,#2]
;;;1236   	data[3]='B';
00166a  f88d7003          STRB     r7,[sp,#3]
;;;1237   	lc640_write_long_ptr(lc640_adr+24,data);
00166e  4669              MOV      r1,sp
001670  f1050018          ADD      r0,r5,#0x18
001674  f7fffffe          BL       lc640_write_long_ptr
;;;1238   	
;;;1239   	data[0]='B';
001678  f88d7000          STRB     r7,[sp,#0]
;;;1240   	data[1]='B';
00167c  f88d7001          STRB     r7,[sp,#1]
;;;1241   	data[2]='B';
001680  f88d7002          STRB     r7,[sp,#2]
;;;1242   	data[3]='B';
001684  f88d7003          STRB     r7,[sp,#3]
;;;1243   	lc640_write_long_ptr(lc640_adr+28,data);
001688  4669              MOV      r1,sp
00168a  f105001c          ADD      r0,r5,#0x1c
00168e  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5778|
;;;1244   	
;;;1245   	}
;;;1246   
;;;1247   vz_mem_hndl_end:
;;;1248   __nop(); 
001692  bf00              NOP      
;;;1249   
;;;1250   }
001694  e4f0              B        |L1.4216|
;;;1251     
                          ENDP

001696  0000              DCW      0x0000
                  |L1.5784|
                          DCD      ke_date
                  |L1.5788|
                          DCD      0x40024020

                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  av_inv
                          DCD      0x00000000
000018  0000              DCB      0x00,0x00
