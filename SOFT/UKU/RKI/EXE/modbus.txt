; generated by ARM C/C++ Compiler, RVCT4.0 [Build 728]
; commandline ArmCC [--debug -c --asm --interleave -o.\EXE\modbus.o --depend=.\EXE\modbus.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\INC -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x --omf_browse=.\EXE\modbus.crf modbus.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  CRC16_2 PROC
;;;31     //-----------------------------------------------
;;;32     unsigned short CRC16_2(char* buf, short len)
000000  b570              PUSH     {r4-r6,lr}
;;;33     {
000002  4605              MOV      r5,r0
;;;34     unsigned short crc = 0xFFFF;
000004  f64f70ff          MOV      r0,#0xffff
;;;35     short pos;
;;;36     short i;
;;;37     
;;;38     for (pos = 0; pos < len; pos++)
000008  2300              MOVS     r3,#0
;;;39       	{
;;;40         	crc ^= (unsigned short)buf[pos];          // XOR byte into least sig. byte of crc
;;;41     
;;;42         	for ( i = 8; i != 0; i--) 
;;;43     		{    // Loop over each bit
;;;44           	if ((crc & 0x0001) != 0) 
;;;45     			{      // If the LSB is set
;;;46             		crc >>= 1;                    // Shift right and XOR 0xA001
;;;47             		crc ^= 0xA001;
00000a  f24a0401          MOV      r4,#0xa001
00000e  e00e              B        |L1.46|
                  |L1.16|
000010  5cea              LDRB     r2,[r5,r3]            ;40
000012  4050              EORS     r0,r0,r2              ;40
000014  2208              MOVS     r2,#8                 ;42
                  |L1.22|
000016  07c6              LSLS     r6,r0,#31             ;44
000018  d002              BEQ      |L1.32|
00001a  0840              LSRS     r0,r0,#1              ;46
00001c  4060              EORS     r0,r0,r4
00001e  e000              B        |L1.34|
                  |L1.32|
;;;48           		}
;;;49           	else  crc >>= 1;                    // Just shift right
000020  0840              LSRS     r0,r0,#1
                  |L1.34|
000022  1e52              SUBS     r2,r2,#1              ;42
000024  b212              SXTH     r2,r2                 ;42
000026  2a00              CMP      r2,#0                 ;42
000028  d1f5              BNE      |L1.22|
00002a  1c5b              ADDS     r3,r3,#1              ;38
00002c  b21b              SXTH     r3,r3                 ;38
                  |L1.46|
00002e  428b              CMP      r3,r1                 ;38
000030  dbee              BLT      |L1.16|
;;;50         		}
;;;51       	}
;;;52       // Note, this number has low and high bytes swapped, so use it accordingly (or swap bytes)
;;;53     return crc;
;;;54     }
000032  bd70              POP      {r4-r6,pc}
;;;55     
                          ENDP

                  modbus_hold_register_transmit PROC
;;;285    //-----------------------------------------------
;;;286    void modbus_register_transmit(unsigned char adr,unsigned char func,unsigned short reg_adr)
;;;287    {
;;;288    char modbus_registers[150];
;;;289    char modbus_tx_buff[50];
;;;290    unsigned short crc_temp;
;;;291    char i;
;;;292    
;;;293    
;;;294    modbus_registers[0]=(char)(load_U/256);					//Πεγ1
;;;295    modbus_registers[1]=(char)(load_U%256);
;;;296    modbus_registers[2]=(char)(load_I/256);					//Πεγ2
;;;297    modbus_registers[3]=(char)(load_I%256);
;;;298    modbus_registers[4]=(char)(Ib_ips_termokompensat/256);		//Πεγ3
000034  b570              PUSH     {r4-r6,lr}
000036  b0b2              SUB      sp,sp,#0xc8
000038  4bff              LDR      r3,|L1.1080|
00003a  8b9c              LDRH     r4,[r3,#0x1c]
00003c  ea4f2414          LSR      r4,r4,#8
000040  f88d4078          STRB     r4,[sp,#0x78]
000044  8b9c              LDRH     r4,[r3,#0x1c]
;;;299    modbus_registers[5]=(char)(Ib_ips_termokompensat%256);
000046  f88d4079          STRB     r4,[sp,#0x79]
;;;300    modbus_registers[6]=(char)(t_ext[0]/256);				//Πεγ4
00004a  7e1c              LDRB     r4,[r3,#0x18]
00004c  f04f0400          MOV      r4,#0
000050  f88d407a          STRB     r4,[sp,#0x7a]
000054  7e1d              LDRB     r5,[r3,#0x18]
000056  f88d507b          STRB     r5,[sp,#0x7b]
00005a  7b1d              LDRB     r5,[r3,#0xc]
;;;301    modbus_registers[7]=(char)(t_ext[0]%256);
00005c  f88d407c          STRB     r4,[sp,#0x7c]
;;;302    modbus_registers[8]=(char)(net_Ua/256);					//Πεγ5
000060  7b1d              LDRB     r5,[r3,#0xc]
000062  f88d507d          STRB     r5,[sp,#0x7d]
000066  7a1d              LDRB     r5,[r3,#8]
000068  f88d407e          STRB     r4,[sp,#0x7e]
00006c  7a1d              LDRB     r5,[r3,#8]
00006e  f88d507f          STRB     r5,[sp,#0x7f]
;;;303    modbus_registers[9]=(char)(net_Ua%256);		 	
000072  791d              LDRB     r5,[r3,#4]
000074  f88d4080          STRB     r4,[sp,#0x80]
;;;304    modbus_registers[10]=(char)(net_Ub/256);				//Πεγ6
000078  791d              LDRB     r5,[r3,#4]
00007a  f88d5081          STRB     r5,[sp,#0x81]
00007e  781d              LDRB     r5,[r3,#0]
000080  f88d4082          STRB     r4,[sp,#0x82]
000084  781b              LDRB     r3,[r3,#0]
000086  f88d3083          STRB     r3,[sp,#0x83]
;;;305    modbus_registers[11]=(char)(net_Ub%256);
00008a  4bec              LDR      r3,|L1.1084|
;;;306    modbus_registers[12]=(char)(net_Uc/256);				//Πεγ7
00008c  f9b33000          LDRSH    r3,[r3,#0]  ; NUMIST
000090  ea4f74e3          ASR      r4,r3,#31
000094  eb036414          ADD      r4,r3,r4,LSR #24
000098  ea4f2524          ASR      r5,r4,#8
00009c  f88d508a          STRB     r5,[sp,#0x8a]
;;;307    modbus_registers[13]=(char)(net_Uc%256);
0000a0  f88d308b          STRB     r3,[sp,#0x8b]
;;;308    modbus_registers[14]=(char)(net_F3/256);				//Πεγ8
0000a4  4be6              LDR      r3,|L1.1088|
0000a6  f9b33000          LDRSH    r3,[r3,#0]  ; PAR
0000aa  ea4f74e3          ASR      r4,r3,#31
0000ae  eb036414          ADD      r4,r3,r4,LSR #24
0000b2  ea4f2524          ASR      r5,r4,#8
;;;309    modbus_registers[15]=(char)(net_F3%256);
0000b6  f88d508c          STRB     r5,[sp,#0x8c]
;;;310    modbus_registers[16]=(char)(load_I/256);				//Πεγ9
0000ba  f88d308d          STRB     r3,[sp,#0x8d]
;;;311    modbus_registers[17]=(char)(load_I%256);
0000be  4be1              LDR      r3,|L1.1092|
;;;312    modbus_registers[18]=(char)(load_I/256);				//Πεγ10
0000c0  f9b33000          LDRSH    r3,[r3,#0]  ; ZV_ON
;;;313    modbus_registers[19]=(char)(load_I%256);
0000c4  ea4f74e3          ASR      r4,r3,#31
;;;314    modbus_registers[20]=(char)((LPC_RTC->YEAR)/256);			//Πεγ11
0000c8  eb036414          ADD      r4,r3,r4,LSR #24
0000cc  ea4f2524          ASR      r5,r4,#8
0000d0  f88d508e          STRB     r5,[sp,#0x8e]
;;;315    modbus_registers[21]=(char)((LPC_RTC->YEAR)%256);
0000d4  f88d308f          STRB     r3,[sp,#0x8f]
0000d8  4bdb              LDR      r3,|L1.1096|
;;;316    modbus_registers[22]=(char)((LPC_RTC->MONTH)/256);		//Πεγ12
0000da  f9b33000          LDRSH    r3,[r3,#0]  ; UBM_AV
0000de  ea4f74e3          ASR      r4,r3,#31
0000e2  eb036414          ADD      r4,r3,r4,LSR #24
;;;317    modbus_registers[23]=(char)((LPC_RTC->MONTH)%256);
0000e6  ea4f2524          ASR      r5,r4,#8
;;;318    modbus_registers[24]=(char)((LPC_RTC->DOM)/256);			//Πεγ13
0000ea  f88d5092          STRB     r5,[sp,#0x92]
0000ee  f88d3093          STRB     r3,[sp,#0x93]
;;;319    modbus_registers[25]=(char)((LPC_RTC->DOM)%256);
0000f2  4bd6              LDR      r3,|L1.1100|
0000f4  f9b33000          LDRSH    r3,[r3,#0]  ; TBAT
;;;320    modbus_registers[26]=(char)((LPC_RTC->HOUR)/256);			//Πεγ14
0000f8  ea4f74e3          ASR      r4,r3,#31
;;;321    modbus_registers[27]=(char)((LPC_RTC->HOUR)%256);
0000fc  eb036414          ADD      r4,r3,r4,LSR #24
000100  ea4f2524          ASR      r5,r4,#8
;;;322    modbus_registers[28]=(char)((LPC_RTC->MIN)/256);			//Πεγ15
000104  f88d509e          STRB     r5,[sp,#0x9e]
;;;323    modbus_registers[29]=(char)((LPC_RTC->MIN)%256);
000108  f88d309f          STRB     r3,[sp,#0x9f]
00010c  4bd0              LDR      r3,|L1.1104|
;;;324    modbus_registers[30]=(char)((LPC_RTC->SEC)/256);			//Πεγ16
00010e  f9b33000          LDRSH    r3,[r3,#0]  ; UMAX
000112  ea4f74e3          ASR      r4,r3,#31
;;;325    modbus_registers[31]=(char)((LPC_RTC->SEC)%256);
000116  eb036414          ADD      r4,r3,r4,LSR #24
;;;326    modbus_registers[32]=(char)(load_I/256);				//Πεγ17
00011a  ea4f2524          ASR      r5,r4,#8
;;;327    modbus_registers[33]=(char)(load_I%256);
00011e  f88d50a0          STRB     r5,[sp,#0xa0]
;;;328    modbus_registers[34]=(char)(load_I/256);				//Πεγ18
000122  f88d30a1          STRB     r3,[sp,#0xa1]
;;;329    modbus_registers[35]=(char)(load_I%256);
000126  4bcb              LDR      r3,|L1.1108|
000128  4ccb              LDR      r4,|L1.1112|
;;;330    modbus_registers[36]=(char)(load_I/256);		//Πεγ19
00012a  f9b33000          LDRSH    r3,[r3,#0]  ; UB20
;;;331    modbus_registers[37]=(char)(load_I%256);
00012e  f9b44000          LDRSH    r4,[r4,#0]  ; DU
;;;332    modbus_registers[38]=(char)(NUMIST/256);		//Πεγ20
000132  eba30404          SUB      r4,r3,r4
000136  ea4f75e4          ASR      r5,r4,#31
00013a  eb046515          ADD      r5,r4,r5,LSR #24
00013e  ea4f2625          ASR      r6,r5,#8
000142  f88d60a2          STRB     r6,[sp,#0xa2]
000146  f88d40a3          STRB     r4,[sp,#0xa3]
;;;333    modbus_registers[39]=(char)(NUMIST%256);
00014a  4cc4              LDR      r4,|L1.1116|
;;;334    modbus_registers[40]=(char)(PAR/256);		//Πεγ21
00014c  f9b44000          LDRSH    r4,[r4,#0]  ; UB0
000150  ea4f75e4          ASR      r5,r4,#31
000154  eb046515          ADD      r5,r4,r5,LSR #24
000158  ea4f2625          ASR      r6,r5,#8
00015c  f88d60a4          STRB     r6,[sp,#0xa4]
000160  f88d40a5          STRB     r4,[sp,#0xa5]
;;;335    modbus_registers[41]=(char)(PAR%256);
000164  ea4f74e3          ASR      r4,r3,#31
;;;336    modbus_registers[42]=(char)(ZV_ON/256);		//Πεγ22
000168  eb036414          ADD      r4,r3,r4,LSR #24
00016c  ea4f2524          ASR      r5,r4,#8
000170  f88d50a6          STRB     r5,[sp,#0xa6]
000174  f88d30a7          STRB     r3,[sp,#0xa7]
000178  4bb9              LDR      r3,|L1.1120|
00017a  f9b33000          LDRSH    r3,[r3,#0]  ; USIGN
;;;337    modbus_registers[43]=(char)(ZV_ON%256);
00017e  ea4f74e3          ASR      r4,r3,#31
;;;338    modbus_registers[44]=(char)(TERMOKOMPENS/256);		//Πεγ23
000182  eb036414          ADD      r4,r3,r4,LSR #24
000186  ea4f2524          ASR      r5,r4,#8
00018a  f88d50a8          STRB     r5,[sp,#0xa8]
00018e  f88d30a9          STRB     r3,[sp,#0xa9]
000192  4bb4              LDR      r3,|L1.1124|
000194  f9b33000          LDRSH    r3,[r3,#0]  ; UMN
;;;339    modbus_registers[45]=(char)(TERMOKOMPENS%256);
000198  ea4f74e3          ASR      r4,r3,#31
;;;340    modbus_registers[46]=(char)(UBM_AV/256);		//Πεγ24
00019c  eb036414          ADD      r4,r3,r4,LSR #24
0001a0  ea4f2524          ASR      r5,r4,#8
0001a4  f88d50aa          STRB     r5,[sp,#0xaa]
0001a8  f88d30ab          STRB     r3,[sp,#0xab]
0001ac  4bae              LDR      r3,|L1.1128|
0001ae  f9b33000          LDRSH    r3,[r3,#0]  ; U0B
;;;341    modbus_registers[47]=(char)(UBM_AV%256);
0001b2  ea4f74e3          ASR      r4,r3,#31
;;;342    modbus_registers[48]=(char)(load_I/256);		//Πεγ25
0001b6  eb036414          ADD      r4,r3,r4,LSR #24
;;;343    modbus_registers[49]=(char)(load_I%256);
0001ba  ea4f2524          ASR      r5,r4,#8
;;;344    modbus_registers[50]=(char)(load_I/256);		//Πεγ26
0001be  f88d50ac          STRB     r5,[sp,#0xac]
;;;345    modbus_registers[51]=(char)(load_I%256);
0001c2  f88d30ad          STRB     r3,[sp,#0xad]
;;;346    modbus_registers[52]=(char)(load_I/256);		//Πεγ27
0001c6  4ba9              LDR      r3,|L1.1132|
;;;347    modbus_registers[53]=(char)(load_I%256);
0001c8  f9b33000          LDRSH    r3,[r3,#0]  ; IKB
;;;348    modbus_registers[54]=(char)(load_I/256);		//Πεγ28
0001cc  ea4f74e3          ASR      r4,r3,#31
;;;349    modbus_registers[55]=(char)(load_I%256);
0001d0  eb036414          ADD      r4,r3,r4,LSR #24
;;;350    modbus_registers[56]=(char)(load_I/256);		//Πεγ29
0001d4  ea4f2524          ASR      r5,r4,#8
;;;351    modbus_registers[57]=(char)(load_I%256);
0001d8  f88d50ae          STRB     r5,[sp,#0xae]
;;;352    modbus_registers[58]=(char)(TBAT/256);			//Πεγ30
0001dc  f88d30af          STRB     r3,[sp,#0xaf]
0001e0  4ba3              LDR      r3,|L1.1136|
0001e2  f9b33000          LDRSH    r3,[r3,#0]  ; IZMAX
0001e6  ea4f74e3          ASR      r4,r3,#31
0001ea  eb036414          ADD      r4,r3,r4,LSR #24
0001ee  ea4f2524          ASR      r5,r4,#8
;;;353    modbus_registers[59]=(char)(TBAT%256);
0001f2  f88d50b0          STRB     r5,[sp,#0xb0]
;;;354    modbus_registers[60]=(char)(UMAX/256);			//Πεγ31
0001f6  f88d30b1          STRB     r3,[sp,#0xb1]
0001fa  4b9e              LDR      r3,|L1.1140|
0001fc  f9b33000          LDRSH    r3,[r3,#0]  ; IMAX
000200  ea4f74e3          ASR      r4,r3,#31
000204  eb036414          ADD      r4,r3,r4,LSR #24
000208  ea4f2524          ASR      r5,r4,#8
;;;355    modbus_registers[61]=(char)(UMAX%256);
00020c  f88d50b2          STRB     r5,[sp,#0xb2]
;;;356    modbus_registers[62]=(char)((UB20-DU)/256);		//Πεγ32
000210  f88d30b3          STRB     r3,[sp,#0xb3]
000214  4b98              LDR      r3,|L1.1144|
000216  f9b33000          LDRSH    r3,[r3,#0]  ; IMIN
00021a  ea4f74e3          ASR      r4,r3,#31
00021e  eb036414          ADD      r4,r3,r4,LSR #24
000222  ea4f2524          ASR      r5,r4,#8
000226  f88d50b4          STRB     r5,[sp,#0xb4]
00022a  f88d30b5          STRB     r3,[sp,#0xb5]
00022e  4b93              LDR      r3,|L1.1148|
;;;357    modbus_registers[63]=(char)((UB20-DU)%256);
000230  f9b33000          LDRSH    r3,[r3,#0]  ; UVZ
;;;358    modbus_registers[64]=(char)(UB0/256);			//Πεγ33
000234  ea4f74e3          ASR      r4,r3,#31
000238  eb036414          ADD      r4,r3,r4,LSR #24
00023c  ea4f2524          ASR      r5,r4,#8
000240  f88d50b6          STRB     r5,[sp,#0xb6]
000244  f88d30b7          STRB     r3,[sp,#0xb7]
000248  4b8d              LDR      r3,|L1.1152|
;;;359    modbus_registers[65]=(char)(UB0%256);
00024a  f9b33000          LDRSH    r3,[r3,#0]  ; TZAS
;;;360    modbus_registers[66]=(char)(UB20/256);			//Πεγ34
00024e  ea4f74e3          ASR      r4,r3,#31
000252  eb036414          ADD      r4,r3,r4,LSR #24
000256  ea4f2524          ASR      r5,r4,#8
00025a  f88d50b8          STRB     r5,[sp,#0xb8]
;;;361    modbus_registers[67]=(char)(UB20%256);
00025e  f88d30b9          STRB     r3,[sp,#0xb9]
;;;362    modbus_registers[68]=(char)(USIGN/256);		//Πεγ35
000262  4b88              LDR      r3,|L1.1156|
000264  f9b33000          LDRSH    r3,[r3,#0]  ; TMAX
000268  ea4f74e3          ASR      r4,r3,#31
00026c  eb036414          ADD      r4,r3,r4,LSR #24
000270  ea4f2524          ASR      r5,r4,#8
000274  f88d50ba          STRB     r5,[sp,#0xba]
;;;363    modbus_registers[69]=(char)(USIGN%256);
000278  f88d30bb          STRB     r3,[sp,#0xbb]
;;;364    modbus_registers[70]=(char)(UMN/256);		//Πεγ36
00027c  4b82              LDR      r3,|L1.1160|
00027e  f9b33000          LDRSH    r3,[r3,#0]  ; TSIGN
000282  ea4f74e3          ASR      r4,r3,#31
000286  eb036414          ADD      r4,r3,r4,LSR #24
00028a  ea4f2524          ASR      r5,r4,#8
00028e  f88d50bc          STRB     r5,[sp,#0xbc]
;;;365    modbus_registers[71]=(char)(UMN%256);
000292  f88d30bd          STRB     r3,[sp,#0xbd]
;;;366    modbus_registers[72]=(char)(U0B/256);		//Πεγ37
000296  4b7d              LDR      r3,|L1.1164|
000298  f9b33000          LDRSH    r3,[r3,#0]  ; TBATMAX
00029c  ea4f74e3          ASR      r4,r3,#31
0002a0  eb036414          ADD      r4,r3,r4,LSR #24
0002a4  ea4f2524          ASR      r5,r4,#8
0002a8  f88d50be          STRB     r5,[sp,#0xbe]
;;;367    modbus_registers[73]=(char)(U0B%256);
0002ac  f88d30bf          STRB     r3,[sp,#0xbf]
;;;368    modbus_registers[74]=(char)(IKB/256);		//Πεγ38
0002b0  4b77              LDR      r3,|L1.1168|
0002b2  f9b33000          LDRSH    r3,[r3,#0]  ; TBATSIGN
0002b6  ea4f74e3          ASR      r4,r3,#31
0002ba  eb036414          ADD      r4,r3,r4,LSR #24
0002be  ea4f2524          ASR      r5,r4,#8
0002c2  f88d50c0          STRB     r5,[sp,#0xc0]
;;;369    modbus_registers[75]=(char)(IKB%256);
0002c6  f88d30c1          STRB     r3,[sp,#0xc1]
;;;370    modbus_registers[76]=(char)(IZMAX/256);		//Πεγ39
0002ca  f88d0000          STRB     r0,[sp,#0]
0002ce  f88d1001          STRB     r1,[sp,#1]
0002d2  ea4f2012          LSR      r0,r2,#8
0002d6  f88d0002          STRB     r0,[sp,#2]
0002da  f88d2003          STRB     r2,[sp,#3]
0002de  a819              ADD      r0,sp,#0x64
;;;371    modbus_registers[77]=(char)(IZMAX%256);
0002e0  f1a20201          SUB      r2,r2,#1
;;;372    modbus_registers[78]=(char)(IMAX/256);		//Πεγ40
0002e4  eb000142          ADD      r1,r0,r2,LSL #1
0002e8  f04f0202          MOV      r2,#2
0002ec  466d              MOV      r5,sp
0002ee  a801              ADD      r0,sp,#4
0002f0  f7fffffe          BL       mem_copy
0002f4  2106              MOVS     r1,#6
0002f6  4668              MOV      r0,sp
0002f8  f7fffffe          BL       CRC16_2
;;;373    modbus_registers[79]=(char)(IMAX%256);
0002fc  f88d0006          STRB     r0,[sp,#6]
;;;374    modbus_registers[80]=(char)(IMIN/256);		//Πεγ41
000300  0a00              LSRS     r0,r0,#8
000302  f88d0007          STRB     r0,[sp,#7]
000306  2400              MOVS     r4,#0
                  |L1.776|
000308  5d28              LDRB     r0,[r5,r4]
00030a  f7fffffe          BL       putchar0
00030e  1c64              ADDS     r4,r4,#1
000310  b2e4              UXTB     r4,r4
000312  2c08              CMP      r4,#8
;;;375    modbus_registers[81]=(char)(IMIN%256);
000314  d3f8              BCC      |L1.776|
000316  2400              MOVS     r4,#0
                  |L1.792|
;;;376    modbus_registers[82]=(char)(UVZ/256);		//Πεγ42
000318  5d28              LDRB     r0,[r5,r4]
00031a  f7fffffe          BL       putchar_sc16is700
00031e  1c64              ADDS     r4,r4,#1
000320  b2e4              UXTB     r4,r4
000322  2c08              CMP      r4,#8
000324  d3f8              BCC      |L1.792|
000326  b032              ADD      sp,sp,#0xc8
000328  bd70              POP      {r4-r6,pc}
;;;377    modbus_registers[83]=(char)(UVZ%256);
;;;378    modbus_registers[84]=(char)(TZAS/256);		//Πεγ43
;;;379    modbus_registers[85]=(char)(TZAS%256);
;;;380    modbus_registers[86]=(char)(TMAX/256);		//Πεγ44
;;;381    modbus_registers[87]=(char)(TMAX%256);
;;;382    modbus_registers[88]=(char)(TSIGN/256);		//Πεγ45
;;;383    modbus_registers[89]=(char)(TSIGN%256);
;;;384    modbus_registers[90]=(char)(TBATMAX/256);		//Πεγ46
;;;385    modbus_registers[91]=(char)(TBATMAX%256);
;;;386    modbus_registers[92]=(char)(TBATSIGN/256);		//Πεγ47
;;;387    modbus_registers[93]=(char)(TBATSIGN%256);
;;;388    modbus_registers[94]=(char)(load_I/256);		//Πεγ48
;;;389    modbus_registers[95]=(char)(load_I%256);
;;;390    modbus_registers[96]=(char)(load_I/256);		//Πεγ49
;;;391    modbus_registers[97]=(char)(load_I%256);
;;;392    modbus_registers[98]=(char)(load_I/256);		//Πεγ50
;;;393    modbus_registers[99]=(char)(load_I%256);
;;;394    
;;;395    modbus_tx_buff[0]=adr;
;;;396    modbus_tx_buff[1]=func;
;;;397    modbus_tx_buff[2]=(char)(reg_adr/256);
;;;398    modbus_tx_buff[3]=(char)(reg_adr%256);
;;;399    //modbus_tx_buff[4]=(char)(reg_quantity/256);
;;;400    //modbus_tx_buff[5]=(char)(reg_quantity%256);
;;;401    /*
;;;402    modbus_registers[0]=0x10;
;;;403    modbus_registers[1]=0x11;
;;;404    modbus_registers[2]=0x12;
;;;405    modbus_registers[3]=0x13;
;;;406    modbus_registers[4]=0x14;
;;;407    modbus_registers[5]=0x15;
;;;408    */
;;;409    
;;;410    mem_copy((char*)&modbus_tx_buff[4],(char*)&modbus_registers[(reg_adr-1)*2],2);
;;;411    
;;;412    crc_temp=CRC16_2(modbus_tx_buff,6);
;;;413    
;;;414    modbus_tx_buff[6]=crc_temp%256;
;;;415    modbus_tx_buff[7]=crc_temp/256;
;;;416    
;;;417    for (i=0;i<8;i++)
;;;418    	{
;;;419    	putchar0(modbus_tx_buff[i]);
;;;420    	}
;;;421    for (i=0;i<8;i++)
;;;422    	{
;;;423    	putchar_sc16is700(modbus_tx_buff[i]);
;;;424    	}
;;;425    }
;;;426    
                          ENDP

                  modbus_input_registers_transmit PROC
;;;285    //-----------------------------------------------
;;;286    void modbus_register_transmit(unsigned char adr,unsigned char func,unsigned short reg_adr)
;;;287    {
;;;288    char modbus_registers[150];
;;;289    char modbus_tx_buff[50];
;;;290    unsigned short crc_temp;
;;;291    char i;
;;;292    
;;;293    
;;;294    modbus_registers[0]=(char)(load_U/256);					//Πεγ1
;;;295    modbus_registers[1]=(char)(load_U%256);
;;;296    modbus_registers[2]=(char)(load_I/256);					//Πεγ2
;;;297    modbus_registers[3]=(char)(load_I%256);
;;;298    modbus_registers[4]=(char)(Ib_ips_termokompensat/256);		//Πεγ3
;;;299    modbus_registers[5]=(char)(Ib_ips_termokompensat%256);
;;;300    modbus_registers[6]=(char)(t_ext[0]/256);				//Πεγ4
;;;301    modbus_registers[7]=(char)(t_ext[0]%256);
;;;302    modbus_registers[8]=(char)(net_Ua/256);					//Πεγ5
;;;303    modbus_registers[9]=(char)(net_Ua%256);		 	
;;;304    modbus_registers[10]=(char)(net_Ub/256);				//Πεγ6
;;;305    modbus_registers[11]=(char)(net_Ub%256);
;;;306    modbus_registers[12]=(char)(net_Uc/256);				//Πεγ7
;;;307    modbus_registers[13]=(char)(net_Uc%256);
;;;308    modbus_registers[14]=(char)(net_F3/256);				//Πεγ8
;;;309    modbus_registers[15]=(char)(net_F3%256);
;;;310    modbus_registers[16]=(char)(load_I/256);				//Πεγ9
;;;311    modbus_registers[17]=(char)(load_I%256);
;;;312    modbus_registers[18]=(char)(load_I/256);				//Πεγ10
;;;313    modbus_registers[19]=(char)(load_I%256);
;;;314    modbus_registers[20]=(char)((LPC_RTC->YEAR)/256);			//Πεγ11
;;;315    modbus_registers[21]=(char)((LPC_RTC->YEAR)%256);
;;;316    modbus_registers[22]=(char)((LPC_RTC->MONTH)/256);		//Πεγ12
;;;317    modbus_registers[23]=(char)((LPC_RTC->MONTH)%256);
;;;318    modbus_registers[24]=(char)((LPC_RTC->DOM)/256);			//Πεγ13
;;;319    modbus_registers[25]=(char)((LPC_RTC->DOM)%256);
;;;320    modbus_registers[26]=(char)((LPC_RTC->HOUR)/256);			//Πεγ14
;;;321    modbus_registers[27]=(char)((LPC_RTC->HOUR)%256);
;;;322    modbus_registers[28]=(char)((LPC_RTC->MIN)/256);			//Πεγ15
;;;323    modbus_registers[29]=(char)((LPC_RTC->MIN)%256);
;;;324    modbus_registers[30]=(char)((LPC_RTC->SEC)/256);			//Πεγ16
;;;325    modbus_registers[31]=(char)((LPC_RTC->SEC)%256);
;;;326    modbus_registers[32]=(char)(load_I/256);				//Πεγ17
;;;327    modbus_registers[33]=(char)(load_I%256);
;;;328    modbus_registers[34]=(char)(load_I/256);				//Πεγ18
;;;329    modbus_registers[35]=(char)(load_I%256);
;;;330    modbus_registers[36]=(char)(load_I/256);		//Πεγ19
;;;331    modbus_registers[37]=(char)(load_I%256);
;;;332    modbus_registers[38]=(char)(NUMIST/256);		//Πεγ20
;;;333    modbus_registers[39]=(char)(NUMIST%256);
;;;334    modbus_registers[40]=(char)(PAR/256);		//Πεγ21
;;;335    modbus_registers[41]=(char)(PAR%256);
;;;336    modbus_registers[42]=(char)(ZV_ON/256);		//Πεγ22
;;;337    modbus_registers[43]=(char)(ZV_ON%256);
;;;338    modbus_registers[44]=(char)(TERMOKOMPENS/256);		//Πεγ23
;;;339    modbus_registers[45]=(char)(TERMOKOMPENS%256);
;;;340    modbus_registers[46]=(char)(UBM_AV/256);		//Πεγ24
;;;341    modbus_registers[47]=(char)(UBM_AV%256);
;;;342    modbus_registers[48]=(char)(load_I/256);		//Πεγ25
;;;343    modbus_registers[49]=(char)(load_I%256);
;;;344    modbus_registers[50]=(char)(load_I/256);		//Πεγ26
;;;345    modbus_registers[51]=(char)(load_I%256);
;;;346    modbus_registers[52]=(char)(load_I/256);		//Πεγ27
;;;347    modbus_registers[53]=(char)(load_I%256);
;;;348    modbus_registers[54]=(char)(load_I/256);		//Πεγ28
;;;349    modbus_registers[55]=(char)(load_I%256);
;;;350    modbus_registers[56]=(char)(load_I/256);		//Πεγ29
;;;351    modbus_registers[57]=(char)(load_I%256);
;;;352    modbus_registers[58]=(char)(TBAT/256);			//Πεγ30
;;;353    modbus_registers[59]=(char)(TBAT%256);
;;;354    modbus_registers[60]=(char)(UMAX/256);			//Πεγ31
;;;355    modbus_registers[61]=(char)(UMAX%256);
;;;356    modbus_registers[62]=(char)((UB20-DU)/256);		//Πεγ32
;;;357    modbus_registers[63]=(char)((UB20-DU)%256);
;;;358    modbus_registers[64]=(char)(UB0/256);			//Πεγ33
;;;359    modbus_registers[65]=(char)(UB0%256);
;;;360    modbus_registers[66]=(char)(UB20/256);			//Πεγ34
;;;361    modbus_registers[67]=(char)(UB20%256);
;;;362    modbus_registers[68]=(char)(USIGN/256);		//Πεγ35
;;;363    modbus_registers[69]=(char)(USIGN%256);
;;;364    modbus_registers[70]=(char)(UMN/256);		//Πεγ36
;;;365    modbus_registers[71]=(char)(UMN%256);
;;;366    modbus_registers[72]=(char)(U0B/256);		//Πεγ37
;;;367    modbus_registers[73]=(char)(U0B%256);
;;;368    modbus_registers[74]=(char)(IKB/256);		//Πεγ38
;;;369    modbus_registers[75]=(char)(IKB%256);
;;;370    modbus_registers[76]=(char)(IZMAX/256);		//Πεγ39
;;;371    modbus_registers[77]=(char)(IZMAX%256);
;;;372    modbus_registers[78]=(char)(IMAX/256);		//Πεγ40
;;;373    modbus_registers[79]=(char)(IMAX%256);
;;;374    modbus_registers[80]=(char)(IMIN/256);		//Πεγ41
;;;375    modbus_registers[81]=(char)(IMIN%256);
;;;376    modbus_registers[82]=(char)(UVZ/256);		//Πεγ42
00032a  e92d41f0          PUSH     {r4-r8,lr}
;;;377    modbus_registers[83]=(char)(UVZ%256);
00032e  f5ad7d10          SUB      sp,sp,#0x240
;;;378    modbus_registers[84]=(char)(TZAS/256);		//Πεγ43
000332  461d              MOV      r5,r3
000334  4b57              LDR      r3,|L1.1172|
000336  f9b33000          LDRSH    r3,[r3,#0]  ; load_U
00033a  17dc              ASRS     r4,r3,#31
00033c  eb036414          ADD      r4,r3,r4,LSR #24
000340  1226              ASRS     r6,r4,#8
000342  f88d607c          STRB     r6,[sp,#0x7c]
000346  f88d307d          STRB     r3,[sp,#0x7d]
;;;379    modbus_registers[85]=(char)(TZAS%256);
00034a  4b53              LDR      r3,|L1.1176|
;;;380    modbus_registers[86]=(char)(TMAX/256);		//Πεγ44
00034c  f9b33000          LDRSH    r3,[r3,#0]  ; load_I
000350  17dc              ASRS     r4,r3,#31
000352  eb036414          ADD      r4,r3,r4,LSR #24
000356  1226              ASRS     r6,r4,#8
000358  f88d607e          STRB     r6,[sp,#0x7e]
00035c  f88d307f          STRB     r3,[sp,#0x7f]
000360  4b4e              LDR      r3,|L1.1180|
;;;381    modbus_registers[87]=(char)(TMAX%256);
000362  f9b33000          LDRSH    r3,[r3,#0]  ; net_U
;;;382    modbus_registers[88]=(char)(TSIGN/256);		//Πεγ45
000366  17dc              ASRS     r4,r3,#31
000368  eb036414          ADD      r4,r3,r4,LSR #24
00036c  1226              ASRS     r6,r4,#8
00036e  f88d6080          STRB     r6,[sp,#0x80]
000372  f88d3081          STRB     r3,[sp,#0x81]
000376  4b4a              LDR      r3,|L1.1184|
000378  f9b33000          LDRSH    r3,[r3,#0]  ; net_F
;;;383    modbus_registers[89]=(char)(TSIGN%256);
00037c  17dc              ASRS     r4,r3,#31
00037e  eb036414          ADD      r4,r3,r4,LSR #24
;;;384    modbus_registers[90]=(char)(TBATMAX/256);		//Πεγ46
000382  1226              ASRS     r6,r4,#8
000384  f88d6082          STRB     r6,[sp,#0x82]
000388  f88d3083          STRB     r3,[sp,#0x83]
00038c  4b45              LDR      r3,|L1.1188|
00038e  f9b33000          LDRSH    r3,[r3,#0]  ; net_Ua
000392  17dc              ASRS     r4,r3,#31
000394  eb036414          ADD      r4,r3,r4,LSR #24
;;;385    modbus_registers[91]=(char)(TBATMAX%256);
000398  1226              ASRS     r6,r4,#8
;;;386    modbus_registers[92]=(char)(TBATSIGN/256);		//Πεγ47
00039a  f88d6084          STRB     r6,[sp,#0x84]
00039e  f88d3085          STRB     r3,[sp,#0x85]
0003a2  4b41              LDR      r3,|L1.1192|
0003a4  f9b33000          LDRSH    r3,[r3,#0]  ; net_Ub
0003a8  17dc              ASRS     r4,r3,#31
0003aa  eb036414          ADD      r4,r3,r4,LSR #24
0003ae  1226              ASRS     r6,r4,#8
;;;387    modbus_registers[93]=(char)(TBATSIGN%256);
0003b0  f88d6086          STRB     r6,[sp,#0x86]
;;;388    modbus_registers[94]=(char)(load_I/256);		//Πεγ48
0003b4  f88d3087          STRB     r3,[sp,#0x87]
;;;389    modbus_registers[95]=(char)(load_I%256);
0003b8  4b3c              LDR      r3,|L1.1196|
0003ba  f9b33000          LDRSH    r3,[r3,#0]  ; net_Uc
;;;390    modbus_registers[96]=(char)(load_I/256);		//Πεγ49
0003be  17dc              ASRS     r4,r3,#31
;;;391    modbus_registers[97]=(char)(load_I%256);
0003c0  eb036414          ADD      r4,r3,r4,LSR #24
;;;392    modbus_registers[98]=(char)(load_I/256);		//Πεγ50
0003c4  1226              ASRS     r6,r4,#8
0003c6  f88d6088          STRB     r6,[sp,#0x88]
;;;393    modbus_registers[99]=(char)(load_I%256);
0003ca  f88d3089          STRB     r3,[sp,#0x89]
;;;394    
;;;395    modbus_tx_buff[0]=adr;
0003ce  4b38              LDR      r3,|L1.1200|
;;;396    modbus_tx_buff[1]=func;
0003d0  f9b34002          LDRSH    r4,[r3,#2]  ; bat
;;;397    modbus_tx_buff[2]=(char)(reg_adr/256);
0003d4  17e6              ASRS     r6,r4,#31
0003d6  eb046616          ADD      r6,r4,r6,LSR #24
0003da  1237              ASRS     r7,r6,#8
;;;398    modbus_tx_buff[3]=(char)(reg_adr%256);
0003dc  f88d708a          STRB     r7,[sp,#0x8a]
;;;399    //modbus_tx_buff[4]=(char)(reg_quantity/256);
;;;400    //modbus_tx_buff[5]=(char)(reg_quantity%256);
;;;401    /*
;;;402    modbus_registers[0]=0x10;
;;;403    modbus_registers[1]=0x11;
;;;404    modbus_registers[2]=0x12;
;;;405    modbus_registers[3]=0x13;
;;;406    modbus_registers[4]=0x14;
;;;407    modbus_registers[5]=0x15;
;;;408    */
;;;409    
;;;410    mem_copy((char*)&modbus_tx_buff[4],(char*)&modbus_registers[(reg_adr-1)*2],2);
0003e0  f88d408b          STRB     r4,[sp,#0x8b]
0003e4  f9b34008          LDRSH    r4,[r3,#8]  ; bat
0003e8  17e6              ASRS     r6,r4,#31
0003ea  eb046616          ADD      r6,r4,r6,LSR #24
0003ee  1237              ASRS     r7,r6,#8
0003f0  f88d708c          STRB     r7,[sp,#0x8c]
0003f4  f88d408d          STRB     r4,[sp,#0x8d]
;;;411    
;;;412    crc_temp=CRC16_2(modbus_tx_buff,6);
0003f8  f9b3400a          LDRSH    r4,[r3,#0xa]  ; bat
0003fc  17e6              ASRS     r6,r4,#31
;;;413    
;;;414    modbus_tx_buff[6]=crc_temp%256;
0003fe  eb046616          ADD      r6,r4,r6,LSR #24
;;;415    modbus_tx_buff[7]=crc_temp/256;
000402  1237              ASRS     r7,r6,#8
000404  f88d708e          STRB     r7,[sp,#0x8e]
000408  f88d408f          STRB     r4,[sp,#0x8f]
00040c  8a1c              LDRH     r4,[r3,#0x10]  ; bat
00040e  0a26              LSRS     r6,r4,#8
000410  f88d6090          STRB     r6,[sp,#0x90]
000414  f88d4091          STRB     r4,[sp,#0x91]
000418  f9b34004          LDRSH    r4,[r3,#4]  ; bat
00041c  17e6              ASRS     r6,r4,#31
00041e  eb046616          ADD      r6,r4,r6,LSR #24
000422  1237              ASRS     r7,r6,#8
000424  f88d7092          STRB     r7,[sp,#0x92]
000428  f88d4093          STRB     r4,[sp,#0x93]
00042c  f9b34006          LDRSH    r4,[r3,#6]  ; bat
000430  17e6              ASRS     r6,r4,#31
000432  eb046616          ADD      r6,r4,r6,LSR #24
000436  e03d              B        |L1.1204|
                  |L1.1080|
                          DCD      0x40024020
                  |L1.1084|
                          DCD      NUMIST
                  |L1.1088|
                          DCD      PAR
                  |L1.1092|
                          DCD      ZV_ON
                  |L1.1096|
                          DCD      UBM_AV
                  |L1.1100|
                          DCD      TBAT
                  |L1.1104|
                          DCD      UMAX
                  |L1.1108|
                          DCD      UB20
                  |L1.1112|
                          DCD      ||DU||
                  |L1.1116|
                          DCD      UB0
                  |L1.1120|
                          DCD      USIGN
                  |L1.1124|
                          DCD      UMN
                  |L1.1128|
                          DCD      U0B
                  |L1.1132|
                          DCD      IKB
                  |L1.1136|
                          DCD      IZMAX
                  |L1.1140|
                          DCD      IMAX
                  |L1.1144|
                          DCD      IMIN
                  |L1.1148|
                          DCD      UVZ
                  |L1.1152|
                          DCD      TZAS
                  |L1.1156|
                          DCD      TMAX
                  |L1.1160|
                          DCD      TSIGN
                  |L1.1164|
                          DCD      TBATMAX
                  |L1.1168|
                          DCD      TBATSIGN
                  |L1.1172|
                          DCD      load_U
                  |L1.1176|
                          DCD      load_I
                  |L1.1180|
                          DCD      net_U
                  |L1.1184|
                          DCD      net_F
                  |L1.1188|
                          DCD      net_Ua
                  |L1.1192|
                          DCD      net_Ub
                  |L1.1196|
                          DCD      net_Uc
                  |L1.1200|
                          DCD      bat
                  |L1.1204|
;;;416    
;;;417    for (i=0;i<8;i++)
;;;418    	{
;;;419    	putchar0(modbus_tx_buff[i]);
;;;420    	}
;;;421    for (i=0;i<8;i++)
;;;422    	{
;;;423    	putchar_sc16is700(modbus_tx_buff[i]);
;;;424    	}
;;;425    }
0004b4  1237              ASRS     r7,r6,#8
0004b6  f88d7094          STRB     r7,[sp,#0x94]
0004ba  f88d4095          STRB     r4,[sp,#0x95]
0004be  4fff              LDR      r7,|L1.2236|
0004c0  f9b74000          LDRSH    r4,[r7,#0]  ; BAT_C_REAL
0004c4  17e6              ASRS     r6,r4,#31
0004c6  eb046616          ADD      r6,r4,r6,LSR #24
0004ca  ea4f2c26          ASR      r12,r6,#8
0004ce  f88dc096          STRB     r12,[sp,#0x96]
0004d2  f88d4097          STRB     r4,[sp,#0x97]
0004d6  f9b3404e          LDRSH    r4,[r3,#0x4e]  ; bat
0004da  17e6              ASRS     r6,r4,#31
0004dc  eb046616          ADD      r6,r4,r6,LSR #24
0004e0  ea4f2c26          ASR      r12,r6,#8
0004e4  f88dc098          STRB     r12,[sp,#0x98]
0004e8  f88d4099          STRB     r4,[sp,#0x99]
0004ec  f9b34054          LDRSH    r4,[r3,#0x54]  ; bat
0004f0  17e6              ASRS     r6,r4,#31
0004f2  eb046616          ADD      r6,r4,r6,LSR #24
0004f6  ea4f2c26          ASR      r12,r6,#8
0004fa  f88dc09a          STRB     r12,[sp,#0x9a]
0004fe  f88d409b          STRB     r4,[sp,#0x9b]
000502  f9b34056          LDRSH    r4,[r3,#0x56]  ; bat
000506  17e6              ASRS     r6,r4,#31
000508  eb046616          ADD      r6,r4,r6,LSR #24
00050c  ea4f2c26          ASR      r12,r6,#8
000510  f88dc09c          STRB     r12,[sp,#0x9c]
000514  f88d409d          STRB     r4,[sp,#0x9d]
000518  f8b3405c          LDRH     r4,[r3,#0x5c]  ; bat
00051c  0a26              LSRS     r6,r4,#8
00051e  f88d609e          STRB     r6,[sp,#0x9e]
000522  f88d409f          STRB     r4,[sp,#0x9f]
000526  f9b34050          LDRSH    r4,[r3,#0x50]  ; bat
00052a  17e6              ASRS     r6,r4,#31
00052c  eb046616          ADD      r6,r4,r6,LSR #24
000530  ea4f2c26          ASR      r12,r6,#8
000534  f88dc0a0          STRB     r12,[sp,#0xa0]
000538  f88d40a1          STRB     r4,[sp,#0xa1]
00053c  f9b33052          LDRSH    r3,[r3,#0x52]  ; bat
000540  17dc              ASRS     r4,r3,#31
000542  eb036414          ADD      r4,r3,r4,LSR #24
000546  1226              ASRS     r6,r4,#8
000548  f88d60a2          STRB     r6,[sp,#0xa2]
00054c  f88d30a3          STRB     r3,[sp,#0xa3]
000550  f9b73002          LDRSH    r3,[r7,#2]  ; BAT_C_REAL
000554  17dc              ASRS     r4,r3,#31
000556  eb036414          ADD      r4,r3,r4,LSR #24
00055a  1226              ASRS     r6,r4,#8
00055c  f88d60a4          STRB     r6,[sp,#0xa4]
000560  f88d30a5          STRB     r3,[sp,#0xa5]
000564  4bd6              LDR      r3,|L1.2240|
000566  69dc              LDR      r4,[r3,#0x1c]  ; bps
000568  17e6              ASRS     r6,r4,#31
00056a  eb046616          ADD      r6,r4,r6,LSR #24
00056e  1237              ASRS     r7,r6,#8
000570  f88d70a6          STRB     r7,[sp,#0xa6]
000574  f88d40a7          STRB     r4,[sp,#0xa7]
000578  6a5c              LDR      r4,[r3,#0x24]  ; bps
00057a  17e6              ASRS     r6,r4,#31
00057c  eb046616          ADD      r6,r4,r6,LSR #24
000580  1237              ASRS     r7,r6,#8
000582  f88d70a8          STRB     r7,[sp,#0xa8]
000586  f88d40a9          STRB     r4,[sp,#0xa9]
00058a  6a9c              LDR      r4,[r3,#0x28]  ; bps
00058c  17e6              ASRS     r6,r4,#31
00058e  eb046616          ADD      r6,r4,r6,LSR #24
000592  1237              ASRS     r7,r6,#8
000594  f88d70aa          STRB     r7,[sp,#0xaa]
000598  f88d40ab          STRB     r4,[sp,#0xab]
00059c  2600              MOVS     r6,#0
00059e  f88d60ac          STRB     r6,[sp,#0xac]
0005a2  785c              LDRB     r4,[r3,#1]  ; bps
0005a4  f88d40ad          STRB     r4,[sp,#0xad]
0005a8  6f1c              LDR      r4,[r3,#0x70]  ; bps
0005aa  17e7              ASRS     r7,r4,#31
0005ac  eb046717          ADD      r7,r4,r7,LSR #24
0005b0  ea4f2c27          ASR      r12,r7,#8
0005b4  f88dc0ae          STRB     r12,[sp,#0xae]
0005b8  f88d40af          STRB     r4,[sp,#0xaf]
0005bc  6f9c              LDR      r4,[r3,#0x78]  ; bps
0005be  17e7              ASRS     r7,r4,#31
0005c0  eb046717          ADD      r7,r4,r7,LSR #24
0005c4  ea4f2c27          ASR      r12,r7,#8
0005c8  f88dc0b0          STRB     r12,[sp,#0xb0]
0005cc  f88d40b1          STRB     r4,[sp,#0xb1]
0005d0  6fdc              LDR      r4,[r3,#0x7c]  ; bps
0005d2  17e7              ASRS     r7,r4,#31
0005d4  eb046717          ADD      r7,r4,r7,LSR #24
0005d8  ea4f2c27          ASR      r12,r7,#8
0005dc  f88dc0b2          STRB     r12,[sp,#0xb2]
0005e0  f88d40b3          STRB     r4,[sp,#0xb3]
0005e4  f88d60b4          STRB     r6,[sp,#0xb4]
0005e8  f8934055          LDRB     r4,[r3,#0x55]  ; bps
0005ec  f88d40b5          STRB     r4,[sp,#0xb5]
0005f0  f8d340c4          LDR      r4,[r3,#0xc4]  ; bps
0005f4  17e7              ASRS     r7,r4,#31
0005f6  eb046717          ADD      r7,r4,r7,LSR #24
0005fa  ea4f2c27          ASR      r12,r7,#8
0005fe  f88dc0b6          STRB     r12,[sp,#0xb6]
000602  f88d40b7          STRB     r4,[sp,#0xb7]
000606  f8d340cc          LDR      r4,[r3,#0xcc]  ; bps
00060a  17e7              ASRS     r7,r4,#31
00060c  eb046717          ADD      r7,r4,r7,LSR #24
000610  ea4f2c27          ASR      r12,r7,#8
000614  f88dc0b8          STRB     r12,[sp,#0xb8]
000618  f88d40b9          STRB     r4,[sp,#0xb9]
00061c  f8d340d0          LDR      r4,[r3,#0xd0]  ; bps
000620  17e7              ASRS     r7,r4,#31
000622  eb046717          ADD      r7,r4,r7,LSR #24
000626  ea4f2c27          ASR      r12,r7,#8
00062a  f88dc0ba          STRB     r12,[sp,#0xba]
00062e  f88d40bb          STRB     r4,[sp,#0xbb]
000632  f88d60bc          STRB     r6,[sp,#0xbc]
000636  f89340a9          LDRB     r4,[r3,#0xa9]  ; bps
00063a  f88d40bd          STRB     r4,[sp,#0xbd]
00063e  f8d34118          LDR      r4,[r3,#0x118]  ; bps
000642  17e7              ASRS     r7,r4,#31
000644  eb046717          ADD      r7,r4,r7,LSR #24
000648  ea4f2c27          ASR      r12,r7,#8
00064c  f88dc0be          STRB     r12,[sp,#0xbe]
000650  f88d40bf          STRB     r4,[sp,#0xbf]
000654  f8d34120          LDR      r4,[r3,#0x120]  ; bps
000658  17e7              ASRS     r7,r4,#31
00065a  eb046717          ADD      r7,r4,r7,LSR #24
00065e  ea4f2c27          ASR      r12,r7,#8
000662  f88dc0c0          STRB     r12,[sp,#0xc0]
000666  f88d40c1          STRB     r4,[sp,#0xc1]
00066a  f8d34124          LDR      r4,[r3,#0x124]  ; bps
00066e  17e7              ASRS     r7,r4,#31
000670  eb046717          ADD      r7,r4,r7,LSR #24
000674  ea4f2c27          ASR      r12,r7,#8
000678  f88dc0c2          STRB     r12,[sp,#0xc2]
00067c  f88d40c3          STRB     r4,[sp,#0xc3]
000680  f88d60c4          STRB     r6,[sp,#0xc4]
000684  f50373a8          ADD      r3,r3,#0x150
000688  f8134c53          LDRB     r4,[r3,#-0x53]  ; bps
00068c  f88d40c5          STRB     r4,[sp,#0xc5]
000690  69dc              LDR      r4,[r3,#0x1c]  ; bps
000692  ea4f77e4          ASR      r7,r4,#31
000696  eb046717          ADD      r7,r4,r7,LSR #24
00069a  ea4f2c27          ASR      r12,r7,#8
00069e  f88dc0c6          STRB     r12,[sp,#0xc6]
0006a2  f88d40c7          STRB     r4,[sp,#0xc7]
0006a6  6a5c              LDR      r4,[r3,#0x24]  ; bps
0006a8  ea4f77e4          ASR      r7,r4,#31
0006ac  eb046717          ADD      r7,r4,r7,LSR #24
0006b0  ea4f2c27          ASR      r12,r7,#8
0006b4  f88dc0c8          STRB     r12,[sp,#0xc8]
0006b8  f88d40c9          STRB     r4,[sp,#0xc9]
0006bc  6a9c              LDR      r4,[r3,#0x28]  ; bps
0006be  ea4f77e4          ASR      r7,r4,#31
0006c2  eb046717          ADD      r7,r4,r7,LSR #24
0006c6  ea4f2c27          ASR      r12,r7,#8
0006ca  f88dc0ca          STRB     r12,[sp,#0xca]
0006ce  f88d40cb          STRB     r4,[sp,#0xcb]
0006d2  f88d60cc          STRB     r6,[sp,#0xcc]
0006d6  785c              LDRB     r4,[r3,#1]  ; bps
0006d8  f88d40cd          STRB     r4,[sp,#0xcd]
0006dc  6f1c              LDR      r4,[r3,#0x70]  ; bps
0006de  ea4f77e4          ASR      r7,r4,#31
0006e2  eb046717          ADD      r7,r4,r7,LSR #24
0006e6  ea4f2c27          ASR      r12,r7,#8
0006ea  f88dc0ce          STRB     r12,[sp,#0xce]
0006ee  f88d40cf          STRB     r4,[sp,#0xcf]
0006f2  6f9c              LDR      r4,[r3,#0x78]  ; bps
0006f4  ea4f77e4          ASR      r7,r4,#31
0006f8  eb046717          ADD      r7,r4,r7,LSR #24
0006fc  ea4f2c27          ASR      r12,r7,#8
000700  f88dc0d0          STRB     r12,[sp,#0xd0]
000704  f88d40d1          STRB     r4,[sp,#0xd1]
000708  6fdc              LDR      r4,[r3,#0x7c]  ; bps
00070a  ea4f77e4          ASR      r7,r4,#31
00070e  eb046717          ADD      r7,r4,r7,LSR #24
000712  ea4f2c27          ASR      r12,r7,#8
000716  f88dc0d2          STRB     r12,[sp,#0xd2]
00071a  f88d40d3          STRB     r4,[sp,#0xd3]
00071e  f88d60d4          STRB     r6,[sp,#0xd4]
000722  f8934055          LDRB     r4,[r3,#0x55]  ; bps
000726  f88d40d5          STRB     r4,[sp,#0xd5]
00072a  f8d340c4          LDR      r4,[r3,#0xc4]  ; bps
00072e  ea4f77e4          ASR      r7,r4,#31
000732  eb046717          ADD      r7,r4,r7,LSR #24
000736  ea4f2c27          ASR      r12,r7,#8
00073a  f88dc0d6          STRB     r12,[sp,#0xd6]
00073e  f88d40d7          STRB     r4,[sp,#0xd7]
000742  f8d340cc          LDR      r4,[r3,#0xcc]  ; bps
000746  ea4f77e4          ASR      r7,r4,#31
00074a  eb046717          ADD      r7,r4,r7,LSR #24
00074e  ea4f2c27          ASR      r12,r7,#8
000752  f88dc0d8          STRB     r12,[sp,#0xd8]
000756  f88d40d9          STRB     r4,[sp,#0xd9]
00075a  f8d340d0          LDR      r4,[r3,#0xd0]  ; bps
00075e  ea4f77e4          ASR      r7,r4,#31
000762  eb046717          ADD      r7,r4,r7,LSR #24
000766  ea4f2c27          ASR      r12,r7,#8
00076a  f88dc0da          STRB     r12,[sp,#0xda]
00076e  f88d40db          STRB     r4,[sp,#0xdb]
000772  f88d60dc          STRB     r6,[sp,#0xdc]
000776  f89340a9          LDRB     r4,[r3,#0xa9]  ; bps
00077a  f88d40dd          STRB     r4,[sp,#0xdd]
00077e  f8d34118          LDR      r4,[r3,#0x118]  ; bps
000782  ea4f77e4          ASR      r7,r4,#31
000786  eb046717          ADD      r7,r4,r7,LSR #24
00078a  ea4f2c27          ASR      r12,r7,#8
00078e  f88dc0de          STRB     r12,[sp,#0xde]
000792  f88d40df          STRB     r4,[sp,#0xdf]
000796  f8d34120          LDR      r4,[r3,#0x120]  ; bps
00079a  ea4f77e4          ASR      r7,r4,#31
00079e  eb046717          ADD      r7,r4,r7,LSR #24
0007a2  ea4f2c27          ASR      r12,r7,#8
0007a6  f88dc0e0          STRB     r12,[sp,#0xe0]
0007aa  f88d40e1          STRB     r4,[sp,#0xe1]
0007ae  f8d34124          LDR      r4,[r3,#0x124]  ; bps
0007b2  ea4f77e4          ASR      r7,r4,#31
0007b6  eb046717          ADD      r7,r4,r7,LSR #24
0007ba  ea4f2c27          ASR      r12,r7,#8
0007be  f88dc0e2          STRB     r12,[sp,#0xe2]
0007c2  f88d40e3          STRB     r4,[sp,#0xe3]
0007c6  f88d60e4          STRB     r6,[sp,#0xe4]
0007ca  f89330fd          LDRB     r3,[r3,#0xfd]  ; bps
0007ce  f88d30e5          STRB     r3,[sp,#0xe5]
0007d2  4b3c              LDR      r3,|L1.2244|
0007d4  f9b34000          LDRSH    r4,[r3,#0]  ; t_ext
0007d8  f8dfc0ec          LDR      r12,|L1.2248|
0007dc  4f3b              LDR      r7,|L1.2252|
0007de  f8dc6000          LDR      r6,[r12,#0]  ; ND_EXT
0007e2  b106              CBZ      r6,|L1.2022|
0007e4  463c              MOV      r4,r7
                  |L1.2022|
0007e6  17e6              ASRS     r6,r4,#31
0007e8  eb046616          ADD      r6,r4,r6,LSR #24
0007ec  ea4f2826          ASR      r8,r6,#8
0007f0  f88d820c          STRB     r8,[sp,#0x20c]
0007f4  f88d420d          STRB     r4,[sp,#0x20d]
0007f8  f9b34002          LDRSH    r4,[r3,#2]  ; t_ext
0007fc  f8dc6004          LDR      r6,[r12,#4]  ; ND_EXT
000800  b106              CBZ      r6,|L1.2052|
000802  463c              MOV      r4,r7
                  |L1.2052|
000804  17e6              ASRS     r6,r4,#31
000806  eb046616          ADD      r6,r4,r6,LSR #24
00080a  ea4f2826          ASR      r8,r6,#8
00080e  f88d820e          STRB     r8,[sp,#0x20e]
000812  f88d420f          STRB     r4,[sp,#0x20f]
000816  f9b34004          LDRSH    r4,[r3,#4]  ; t_ext
00081a  f8dc6008          LDR      r6,[r12,#8]  ; ND_EXT
00081e  b106              CBZ      r6,|L1.2082|
000820  463c              MOV      r4,r7
                  |L1.2082|
000822  17e6              ASRS     r6,r4,#31
000824  eb046616          ADD      r6,r4,r6,LSR #24
000828  ea4f2826          ASR      r8,r6,#8
00082c  f88d8210          STRB     r8,[sp,#0x210]
000830  f88d4211          STRB     r4,[sp,#0x211]
000834  f9b33006          LDRSH    r3,[r3,#6]  ; t_ext
000838  f8dc400c          LDR      r4,[r12,#0xc]  ; ND_EXT
00083c  b104              CBZ      r4,|L1.2112|
00083e  463b              MOV      r3,r7
                  |L1.2112|
000840  17dc              ASRS     r4,r3,#31
000842  eb036414          ADD      r4,r3,r4,LSR #24
000846  1226              ASRS     r6,r4,#8
000848  f88d6212          STRB     r6,[sp,#0x212]
00084c  f88d3213          STRB     r3,[sp,#0x213]
000850  2300              MOVS     r3,#0
000852  4e1f              LDR      r6,|L1.2256|
000854  7834              LDRB     r4,[r6,#0]  ; sk_stat
000856  2c01              CMP      r4,#1
000858  d100              BNE      |L1.2140|
00085a  2301              MOVS     r3,#1
                  |L1.2140|
00085c  4f1d              LDR      r7,|L1.2260|
00085e  783c              LDRB     r4,[r7,#0]  ; sk_av_stat
000860  2c01              CMP      r4,#1
000862  d101              BNE      |L1.2152|
000864  f0430302          ORR      r3,r3,#2
                  |L1.2152|
000868  17dc              ASRS     r4,r3,#31
00086a  eb036414          ADD      r4,r3,r4,LSR #24
00086e  ea4f2c24          ASR      r12,r4,#8
000872  f88dc220          STRB     r12,[sp,#0x220]
000876  f88d3221          STRB     r3,[sp,#0x221]
00087a  2300              MOVS     r3,#0
00087c  7874              LDRB     r4,[r6,#1]  ; sk_stat
00087e  2c01              CMP      r4,#1
000880  d100              BNE      |L1.2180|
000882  2301              MOVS     r3,#1
                  |L1.2180|
000884  787c              LDRB     r4,[r7,#1]  ; sk_av_stat
000886  2c01              CMP      r4,#1
000888  d101              BNE      |L1.2190|
00088a  f0430302          ORR      r3,r3,#2
                  |L1.2190|
00088e  17dc              ASRS     r4,r3,#31
000890  eb036414          ADD      r4,r3,r4,LSR #24
000894  ea4f2c24          ASR      r12,r4,#8
000898  f88dc222          STRB     r12,[sp,#0x222]
00089c  f88d3223          STRB     r3,[sp,#0x223]
0008a0  2300              MOVS     r3,#0
0008a2  78b4              LDRB     r4,[r6,#2]  ; sk_stat
0008a4  2c01              CMP      r4,#1
0008a6  d100              BNE      |L1.2218|
0008a8  2301              MOVS     r3,#1
                  |L1.2218|
0008aa  78bc              LDRB     r4,[r7,#2]  ; sk_av_stat
0008ac  2c01              CMP      r4,#1
0008ae  d101              BNE      |L1.2228|
0008b0  f0430302          ORR      r3,r3,#2
                  |L1.2228|
0008b4  17dc              ASRS     r4,r3,#31
0008b6  eb036414          ADD      r4,r3,r4,LSR #24
0008ba  e00d              B        |L1.2264|
                  |L1.2236|
                          DCD      BAT_C_REAL
                  |L1.2240|
                          DCD      bps
                  |L1.2244|
                          DCD      t_ext
                  |L1.2248|
                          DCD      ND_EXT
                  |L1.2252|
                          DCD      0xfffffc18
                  |L1.2256|
                          DCD      sk_stat
                  |L1.2260|
                          DCD      sk_av_stat
                  |L1.2264|
0008d8  ea4f2c24          ASR      r12,r4,#8
0008dc  f88dc224          STRB     r12,[sp,#0x224]
0008e0  f88d3225          STRB     r3,[sp,#0x225]
0008e4  2300              MOVS     r3,#0
0008e6  78f4              LDRB     r4,[r6,#3]  ; sk_stat
0008e8  2c01              CMP      r4,#1
0008ea  d100              BNE      |L1.2286|
0008ec  2301              MOVS     r3,#1
                  |L1.2286|
0008ee  78fc              LDRB     r4,[r7,#3]  ; sk_av_stat
0008f0  2c01              CMP      r4,#1
0008f2  d101              BNE      |L1.2296|
0008f4  f0430302          ORR      r3,r3,#2
                  |L1.2296|
0008f8  17dc              ASRS     r4,r3,#31
0008fa  eb036414          ADD      r4,r3,r4,LSR #24
0008fe  1226              ASRS     r6,r4,#8
000900  f88d6226          STRB     r6,[sp,#0x226]
000904  f88d3227          STRB     r3,[sp,#0x227]
000908  f88d0004          STRB     r0,[sp,#4]
00090c  f88d1005          STRB     r1,[sp,#5]
000910  0068              LSLS     r0,r5,#1
000912  f88d0006          STRB     r0,[sp,#6]
000916  a91f              ADD      r1,sp,#0x7c
000918  1e52              SUBS     r2,r2,#1
00091a  eb010142          ADD      r1,r1,r2,LSL #1
00091e  ae01              ADD      r6,sp,#4
000920  4602              MOV      r2,r0
000922  4634              MOV      r4,r6
000924  1cf0              ADDS     r0,r6,#3
000926  f7fffffe          BL       mem_copy
00092a  2003              MOVS     r0,#3
00092c  eb000045          ADD      r0,r0,r5,LSL #1
000930  b201              SXTH     r1,r0
000932  a801              ADD      r0,sp,#4
000934  f7fffffe          BL       CRC16_2
000938  eb040145          ADD      r1,r4,r5,LSL #1
00093c  70c8              STRB     r0,[r1,#3]
00093e  0a00              LSRS     r0,r0,#8
000940  7108              STRB     r0,[r1,#4]
000942  2400              MOVS     r4,#0
000944  2005              MOVS     r0,#5
000946  eb000545          ADD      r5,r0,r5,LSL #1
00094a  e004              B        |L1.2390|
                  |L1.2380|
00094c  5d30              LDRB     r0,[r6,r4]
00094e  f7fffffe          BL       putchar0
000952  1c64              ADDS     r4,r4,#1
000954  b2e4              UXTB     r4,r4
                  |L1.2390|
000956  42a5              CMP      r5,r4
000958  d8f8              BHI      |L1.2380|
00095a  2400              MOVS     r4,#0
00095c  e004              B        |L1.2408|
                  |L1.2398|
00095e  5d30              LDRB     r0,[r6,r4]
000960  f7fffffe          BL       putchar_sc16is700
000964  1c64              ADDS     r4,r4,#1
000966  b2e4              UXTB     r4,r4
                  |L1.2408|
000968  42a5              CMP      r5,r4
00096a  d8f8              BHI      |L1.2398|
00096c  f50d7d10          ADD      sp,sp,#0x240
                  |L1.2416|
000970  e8bd81f0          POP      {r4-r8,pc}
;;;426    
                          ENDP

                  modbus_hold_registers_transmit PROC
;;;661    //-----------------------------------------------
;;;662    void modbus_hold_registers_transmit(unsigned char adr,unsigned char func,unsigned short reg_adr,unsigned short reg_quantity)
000974  b5f0              PUSH     {r4-r7,lr}
;;;663    {
000976  b0b3              SUB      sp,sp,#0xcc
000978  461d              MOV      r5,r3
;;;664    char modbus_registers[100];
;;;665    char modbus_tx_buff[100];
;;;666    unsigned short crc_temp;
;;;667    char i;
;;;668    
;;;669    modbus_registers[20]=(char)((LPC_RTC->YEAR)/256);			//Πεγ11  Βπεμ, γξδ
00097a  4bff              LDR      r3,|L1.3448|
00097c  8b9c              LDRH     r4,[r3,#0x1c]
00097e  ea4f2414          LSR      r4,r4,#8
000982  f88d407c          STRB     r4,[sp,#0x7c]
;;;670    modbus_registers[21]=(char)((LPC_RTC->YEAR)%256);
000986  8b9c              LDRH     r4,[r3,#0x1c]
000988  f88d407d          STRB     r4,[sp,#0x7d]
;;;671    modbus_registers[22]=(char)((LPC_RTC->MONTH)/256);		//Πεγ12  Βπεμ, μερφ
00098c  7e1c              LDRB     r4,[r3,#0x18]
00098e  f04f0400          MOV      r4,#0
000992  f88d407e          STRB     r4,[sp,#0x7e]
;;;672    modbus_registers[23]=(char)((LPC_RTC->MONTH)%256);
000996  7e1e              LDRB     r6,[r3,#0x18]
000998  f88d607f          STRB     r6,[sp,#0x7f]
;;;673    modbus_registers[24]=(char)((LPC_RTC->DOM)/256);			//Πεγ13  Βπεμ, δενό μερφΰ
00099c  7b1e              LDRB     r6,[r3,#0xc]
00099e  f88d4080          STRB     r4,[sp,#0x80]
;;;674    modbus_registers[25]=(char)((LPC_RTC->DOM)%256);
0009a2  7b1e              LDRB     r6,[r3,#0xc]
0009a4  f88d6081          STRB     r6,[sp,#0x81]
;;;675    modbus_registers[26]=(char)((LPC_RTC->HOUR)/256);			//Πεγ14  Βπεμ, χΰρ
0009a8  7a1e              LDRB     r6,[r3,#8]
0009aa  f88d4082          STRB     r4,[sp,#0x82]
;;;676    modbus_registers[27]=(char)((LPC_RTC->HOUR)%256);
0009ae  7a1e              LDRB     r6,[r3,#8]
0009b0  f88d6083          STRB     r6,[sp,#0x83]
;;;677    modbus_registers[28]=(char)((LPC_RTC->MIN)/256);			//Πεγ15  Βπεμ, μθνσςϋ
0009b4  791e              LDRB     r6,[r3,#4]
0009b6  f88d4084          STRB     r4,[sp,#0x84]
;;;678    modbus_registers[29]=(char)((LPC_RTC->MIN)%256);
0009ba  791e              LDRB     r6,[r3,#4]
0009bc  f88d6085          STRB     r6,[sp,#0x85]
;;;679    modbus_registers[30]=(char)((LPC_RTC->SEC)/256);			//Πεγ16  Βπεμ, ρεκσνδϋ
0009c0  781e              LDRB     r6,[r3,#0]
0009c2  f88d4086          STRB     r4,[sp,#0x86]
;;;680    modbus_registers[31]=(char)((LPC_RTC->SEC)%256);
0009c6  781b              LDRB     r3,[r3,#0]
0009c8  f88d3087          STRB     r3,[sp,#0x87]
;;;681    modbus_registers[38]=(char)(NUMIST/256);				//Πεγ20  Κξλθχερςβξ βϋοπμθςελει β ρςπσκςσπε
0009cc  4beb              LDR      r3,|L1.3452|
0009ce  f9b33000          LDRSH    r3,[r3,#0]  ; NUMIST
0009d2  ea4f74e3          ASR      r4,r3,#31
0009d6  eb036414          ADD      r4,r3,r4,LSR #24
0009da  ea4f2624          ASR      r6,r4,#8
0009de  f88d608e          STRB     r6,[sp,#0x8e]
;;;682    modbus_registers[39]=(char)(NUMIST%256);
0009e2  f88d308f          STRB     r3,[sp,#0x8f]
;;;683    modbus_registers[40]=(char)(PAR/256);					//Πεγ21  Οΰπΰλλελόνΰ πΰαξςΰ βϋοπμθςελει βκλ./βϋκλ.
0009e6  4be6              LDR      r3,|L1.3456|
0009e8  f9b33000          LDRSH    r3,[r3,#0]  ; PAR
0009ec  ea4f74e3          ASR      r4,r3,#31
0009f0  eb036414          ADD      r4,r3,r4,LSR #24
0009f4  ea4f2624          ASR      r6,r4,#8
0009f8  f88d6090          STRB     r6,[sp,#0x90]
;;;684    modbus_registers[41]=(char)(PAR%256);
0009fc  f88d3091          STRB     r3,[sp,#0x91]
;;;685    modbus_registers[42]=(char)(ZV_ON/256);					//Πεγ22  Ηβσκξβΰ ΰβΰπθινΰ ρθγνΰλθηΰφθ βκλ./βϋκλ.
000a00  4be0              LDR      r3,|L1.3460|
000a02  f9b33000          LDRSH    r3,[r3,#0]  ; ZV_ON
000a06  ea4f74e3          ASR      r4,r3,#31
000a0a  eb036414          ADD      r4,r3,r4,LSR #24
000a0e  ea4f2624          ASR      r6,r4,#8
000a12  f88d6092          STRB     r6,[sp,#0x92]
;;;686    modbus_registers[43]=(char)(ZV_ON%256);
000a16  f88d3093          STRB     r3,[sp,#0x93]
;;;687    modbus_registers[46]=(char)(UBM_AV/256);				//Πεγ24  ΐβΰπθινϋι σπξβενό ξςκλξνενθ νΰοπζενθ ρπεδνει ςξχκθ αΰςΰπεθ, %
000a1a  4bdb              LDR      r3,|L1.3464|
000a1c  f9b33000          LDRSH    r3,[r3,#0]  ; UBM_AV
000a20  ea4f74e3          ASR      r4,r3,#31
000a24  eb036414          ADD      r4,r3,r4,LSR #24
000a28  ea4f2624          ASR      r6,r4,#8
000a2c  f88d6096          STRB     r6,[sp,#0x96]
;;;688    modbus_registers[47]=(char)(UBM_AV%256);
000a30  f88d3097          STRB     r3,[sp,#0x97]
;;;689    modbus_registers[58]=(char)(TBAT/256);					//Πεγ30  Οεπθξδ οπξβεπκθ φεοθ αΰςΰπεθ, μθνσς.
000a34  4bd5              LDR      r3,|L1.3468|
000a36  f9b33000          LDRSH    r3,[r3,#0]  ; TBAT
000a3a  ea4f74e3          ASR      r4,r3,#31
000a3e  eb036414          ADD      r4,r3,r4,LSR #24
000a42  ea4f2624          ASR      r6,r4,#8
000a46  f88d60a2          STRB     r6,[sp,#0xa2]
;;;690    modbus_registers[59]=(char)(TBAT%256);
000a4a  f88d30a3          STRB     r3,[sp,#0xa3]
;;;691    modbus_registers[60]=(char)(UMAX/256);					//Πεγ31  Μΰκρθμΰλόνξε (ΰβΰπθινξε) νΰοπζενθε βϋοπμθςελει, 0.1Β
000a4e  4bd0              LDR      r3,|L1.3472|
000a50  f9b33000          LDRSH    r3,[r3,#0]  ; UMAX
000a54  ea4f74e3          ASR      r4,r3,#31
000a58  eb036414          ADD      r4,r3,r4,LSR #24
000a5c  ea4f2624          ASR      r6,r4,#8
000a60  f88d60a4          STRB     r6,[sp,#0xa4]
;;;692    modbus_registers[61]=(char)(UMAX%256);
000a64  f88d30a5          STRB     r3,[sp,#0xa5]
;;;693    modbus_registers[62]=(char)((UB20-DU)/256);				//Πεγ32  Μθνθμΰλόνξε (ΰβΰπθινξε) νΰοπζενθε βϋοπμθςελει, 0.1Β
000a68  4bca              LDR      r3,|L1.3476|
000a6a  4ccb              LDR      r4,|L1.3480|
000a6c  f9b33000          LDRSH    r3,[r3,#0]  ; UB20
000a70  f9b44000          LDRSH    r4,[r4,#0]  ; DU
000a74  eba30404          SUB      r4,r3,r4
000a78  ea4f76e4          ASR      r6,r4,#31
000a7c  eb046616          ADD      r6,r4,r6,LSR #24
000a80  ea4f2726          ASR      r7,r6,#8
000a84  f88d70a6          STRB     r7,[sp,#0xa6]
;;;694    modbus_registers[63]=(char)((UB20-DU)%256);
000a88  f88d40a7          STRB     r4,[sp,#0xa7]
;;;695    modbus_registers[64]=(char)(UB0/256);					//Πεγ33  Νΰοπζενθε ρξδεπζΰνθ αΰςΰπεθ οπθ 0γΦ, 0.1Β
000a8c  4cc3              LDR      r4,|L1.3484|
000a8e  f9b44000          LDRSH    r4,[r4,#0]  ; UB0
000a92  ea4f76e4          ASR      r6,r4,#31
000a96  eb046616          ADD      r6,r4,r6,LSR #24
000a9a  ea4f2726          ASR      r7,r6,#8
000a9e  f88d70a8          STRB     r7,[sp,#0xa8]
;;;696    modbus_registers[65]=(char)(UB0%256);
000aa2  f88d40a9          STRB     r4,[sp,#0xa9]
;;;697    modbus_registers[66]=(char)(UB20/256);					//Πεγ34  Νΰοπζενθε ρξδεπζΰνθ αΰςΰπεθ οπθ 20γΦ, 0.1Β
000aa6  ea4f74e3          ASR      r4,r3,#31
000aaa  eb036414          ADD      r4,r3,r4,LSR #24
000aae  ea4f2624          ASR      r6,r4,#8
000ab2  f88d60aa          STRB     r6,[sp,#0xaa]
;;;698    modbus_registers[67]=(char)(UB20%256);
000ab6  f88d30ab          STRB     r3,[sp,#0xab]
;;;699    modbus_registers[68]=(char)(USIGN/256);					//Πεγ35  Μθνθμΰλόνξε (ρθγνΰλόνξε) νΰοπζενθε αΰςΰπεθ, 1Β
000aba  4bb9              LDR      r3,|L1.3488|
000abc  f9b33000          LDRSH    r3,[r3,#0]  ; USIGN
000ac0  ea4f74e3          ASR      r4,r3,#31
000ac4  eb036414          ADD      r4,r3,r4,LSR #24
000ac8  ea4f2624          ASR      r6,r4,#8
000acc  f88d60ac          STRB     r6,[sp,#0xac]
;;;700    modbus_registers[69]=(char)(USIGN%256);
000ad0  f88d30ad          STRB     r3,[sp,#0xad]
;;;701    modbus_registers[70]=(char)(UMN/256);					//Πεγ36  Μθνθμΰλόνξε (ΰβΰπθινξε) νΰοπζενθε οθςΰώωει ρεςθ, 1Β
000ad4  4bb3              LDR      r3,|L1.3492|
000ad6  f9b33000          LDRSH    r3,[r3,#0]  ; UMN
000ada  ea4f74e3          ASR      r4,r3,#31
000ade  eb036414          ADD      r4,r3,r4,LSR #24
000ae2  ea4f2624          ASR      r6,r4,#8
000ae6  f88d60ae          STRB     r6,[sp,#0xae]
;;;702    modbus_registers[71]=(char)(UMN%256);
000aea  f88d30af          STRB     r3,[sp,#0xaf]
;;;703    modbus_registers[72]=(char)(U0B/256);					//Πεγ37  Πΰαξχεε νΰοπζενθε οπθ νεββεδεννϋυ αΰςΰπευ, 0.1Β
000aee  4bae              LDR      r3,|L1.3496|
000af0  f9b33000          LDRSH    r3,[r3,#0]  ; U0B
000af4  ea4f74e3          ASR      r4,r3,#31
000af8  eb036414          ADD      r4,r3,r4,LSR #24
000afc  ea4f2624          ASR      r6,r4,#8
000b00  f88d60b0          STRB     r6,[sp,#0xb0]
;;;704    modbus_registers[73]=(char)(U0B%256);
000b04  f88d30b1          STRB     r3,[sp,#0xb1]
;;;705    modbus_registers[74]=(char)(IKB/256);					//Πεγ38  ξκ κξνςπξλ νΰλθχθ αΰςΰπεθ, 0.1ΰ
000b08  4ba8              LDR      r3,|L1.3500|
000b0a  f9b33000          LDRSH    r3,[r3,#0]  ; IKB
000b0e  ea4f74e3          ASR      r4,r3,#31
000b12  eb036414          ADD      r4,r3,r4,LSR #24
000b16  ea4f2624          ASR      r6,r4,#8
000b1a  f88d60b2          STRB     r6,[sp,#0xb2]
;;;706    modbus_registers[75]=(char)(IKB%256);
000b1e  f88d30b3          STRB     r3,[sp,#0xb3]
;;;707    modbus_registers[76]=(char)(IZMAX/256);					//Πεγ39  ξκ ηΰπδΰ αΰςΰπεθ μΰκρθμΰλόνϋι, 0.1ΐ
000b22  4ba3              LDR      r3,|L1.3504|
000b24  f9b33000          LDRSH    r3,[r3,#0]  ; IZMAX
000b28  ea4f74e3          ASR      r4,r3,#31
000b2c  eb036414          ADD      r4,r3,r4,LSR #24
000b30  ea4f2624          ASR      r6,r4,#8
000b34  f88d60b4          STRB     r6,[sp,#0xb4]
;;;708    modbus_registers[77]=(char)(IZMAX%256);
000b38  f88d30b5          STRB     r3,[sp,#0xb5]
;;;709    modbus_registers[78]=(char)(IMAX/256);					//Πεγ40  ξκ οεπεκλώχενθ νΰ αξλόψεε κξλ-βξ βϋοπμθςελει, 0.1ΐ
000b3c  4b9d              LDR      r3,|L1.3508|
000b3e  f9b33000          LDRSH    r3,[r3,#0]  ; IMAX
000b42  ea4f74e3          ASR      r4,r3,#31
000b46  eb036414          ADD      r4,r3,r4,LSR #24
000b4a  ea4f2624          ASR      r6,r4,#8
000b4e  f88d60b6          STRB     r6,[sp,#0xb6]
;;;710    modbus_registers[79]=(char)(IMAX%256);
000b52  f88d30b7          STRB     r3,[sp,#0xb7]
;;;711    modbus_registers[80]=(char)(IMIN/256);					//Πεγ41  ξκ οεπεκλώχενθ νΰ μενόψεε κξλ-βξ βϋοπμθςελει, 0.1ΐ
000b56  4b98              LDR      r3,|L1.3512|
000b58  f9b33000          LDRSH    r3,[r3,#0]  ; IMIN
000b5c  ea4f74e3          ASR      r4,r3,#31
000b60  eb036414          ADD      r4,r3,r4,LSR #24
000b64  ea4f2624          ASR      r6,r4,#8
000b68  f88d60b8          STRB     r6,[sp,#0xb8]
;;;712    modbus_registers[81]=(char)(IMIN%256);
000b6c  f88d30b9          STRB     r3,[sp,#0xb9]
;;;713    modbus_registers[82]=(char)(UVZ/256);					//Πεγ42  Νΰοπζενθε βϋπΰβνθβΰώωεγξ ηΰπδΰ, 0.1Β
000b70  4b92              LDR      r3,|L1.3516|
000b72  f9b33000          LDRSH    r3,[r3,#0]  ; UVZ
000b76  ea4f74e3          ASR      r4,r3,#31
000b7a  eb036414          ADD      r4,r3,r4,LSR #24
000b7e  ea4f2624          ASR      r6,r4,#8
000b82  f88d60ba          STRB     r6,[sp,#0xba]
;;;714    modbus_registers[83]=(char)(UVZ%256);
000b86  f88d30bb          STRB     r3,[sp,#0xbb]
;;;715    modbus_registers[84]=(char)(TZAS/256);					//Πεγ43  Βπεμ ηΰδεπζκθ βκλώχενθ βϋοπμθςελει, ρεκ
000b8a  4b8d              LDR      r3,|L1.3520|
000b8c  f9b33000          LDRSH    r3,[r3,#0]  ; TZAS
000b90  ea4f74e3          ASR      r4,r3,#31
000b94  eb036414          ADD      r4,r3,r4,LSR #24
000b98  ea4f2624          ASR      r6,r4,#8
000b9c  f88d60bc          STRB     r6,[sp,#0xbc]
;;;716    modbus_registers[85]=(char)(TZAS%256);
000ba0  f88d30bd          STRB     r3,[sp,#0xbd]
;;;717    modbus_registers[86]=(char)(TMAX/256);					//Πεγ44  εμοεπΰςσπΰ βϋοπμθςελει ΰβΰπθινΰ, 1γΦ
000ba4  4b87              LDR      r3,|L1.3524|
000ba6  f9b33000          LDRSH    r3,[r3,#0]  ; TMAX
000baa  ea4f74e3          ASR      r4,r3,#31
000bae  eb036414          ADD      r4,r3,r4,LSR #24
000bb2  ea4f2624          ASR      r6,r4,#8
000bb6  f88d60be          STRB     r6,[sp,#0xbe]
;;;718    modbus_registers[87]=(char)(TMAX%256);
000bba  f88d30bf          STRB     r3,[sp,#0xbf]
;;;719    modbus_registers[88]=(char)(TSIGN/256);					//Πεγ45  εμοεπΰςσπΰ βϋοπμθςελει ρθγνΰλόνΰ, 1γΦ
000bbe  4b82              LDR      r3,|L1.3528|
000bc0  f9b33000          LDRSH    r3,[r3,#0]  ; TSIGN
000bc4  ea4f74e3          ASR      r4,r3,#31
000bc8  eb036414          ADD      r4,r3,r4,LSR #24
000bcc  ea4f2624          ASR      r6,r4,#8
000bd0  f88d60c0          STRB     r6,[sp,#0xc0]
;;;720    modbus_registers[89]=(char)(TSIGN%256);
000bd4  f88d30c1          STRB     r3,[sp,#0xc1]
;;;721    modbus_registers[90]=(char)(TBATMAX/256);				//Πεγ46  εμοεπΰςσπΰ αΰςΰπεθ ΰβΰπθινΰ, 1γΦ
000bd8  4b7c              LDR      r3,|L1.3532|
000bda  f9b33000          LDRSH    r3,[r3,#0]  ; TBATMAX
000bde  ea4f74e3          ASR      r4,r3,#31
000be2  eb036414          ADD      r4,r3,r4,LSR #24
000be6  ea4f2624          ASR      r6,r4,#8
000bea  f88d60c2          STRB     r6,[sp,#0xc2]
;;;722    modbus_registers[91]=(char)(TBATMAX%256);
000bee  f88d30c3          STRB     r3,[sp,#0xc3]
;;;723    modbus_registers[92]=(char)(TBATSIGN/256);				//Πεγ47  εμοεπΰςσπΰ αΰςΰπεθ ρθγνΰλόνΰ, 1γΦ
000bf2  4b77              LDR      r3,|L1.3536|
000bf4  f9b33000          LDRSH    r3,[r3,#0]  ; TBATSIGN
000bf8  ea4f74e3          ASR      r4,r3,#31
000bfc  eb036414          ADD      r4,r3,r4,LSR #24
000c00  ea4f2624          ASR      r6,r4,#8
000c04  f88d60c4          STRB     r6,[sp,#0xc4]
;;;724    modbus_registers[93]=(char)(TBATSIGN%256);
000c08  f88d30c5          STRB     r3,[sp,#0xc5]
;;;725    
;;;726    
;;;727    modbus_tx_buff[0]=adr;
000c0c  f88d0004          STRB     r0,[sp,#4]
;;;728    modbus_tx_buff[1]=func;
000c10  f88d1005          STRB     r1,[sp,#5]
;;;729    //modbus_tx_buff[2]=(char)(reg_adr/256);
;;;730    //modbus_tx_buff[3]=(char)(reg_adr%256);
;;;731    //modbus_tx_buff[4]=(char)(reg_quantity/256);
;;;732    //modbus_tx_buff[5]=(char)(reg_quantity%256);
;;;733    modbus_tx_buff[2]=(char)(reg_quantity*2);
000c14  ea4f0045          LSL      r0,r5,#1
000c18  f88d0006          STRB     r0,[sp,#6]
;;;734    /*
;;;735    modbus_registers[0]=0x10;
;;;736    modbus_registers[1]=0x11;
;;;737    modbus_registers[2]=0x12;
;;;738    modbus_registers[3]=0x13;
;;;739    modbus_registers[4]=0x14;
;;;740    modbus_registers[5]=0x15;
;;;741    */
;;;742    
;;;743    //if((reg_adr<17)&&(reg_quantity<10))
;;;744    	{
;;;745    	mem_copy((char*)&modbus_tx_buff[3],(char*)&modbus_registers[(reg_adr-1)*2],reg_quantity*2);
000c1c  a91a              ADD      r1,sp,#0x68
000c1e  f1a20201          SUB      r2,r2,#1
000c22  eb010142          ADD      r1,r1,r2,LSL #1
000c26  4602              MOV      r2,r0
000c28  ae01              ADD      r6,sp,#4
000c2a  4634              MOV      r4,r6
000c2c  f10d0007          ADD      r0,sp,#7
000c30  f7fffffe          BL       mem_copy
;;;746    	}
;;;747    crc_temp=CRC16_2(modbus_tx_buff,(reg_quantity*2)+3);
000c34  2003              MOVS     r0,#3
000c36  eb000045          ADD      r0,r0,r5,LSL #1
000c3a  b201              SXTH     r1,r0
000c3c  a801              ADD      r0,sp,#4
000c3e  f7fffffe          BL       CRC16_2
;;;748    
;;;749    modbus_tx_buff[3+(reg_quantity*2)]=crc_temp%256;
000c42  eb040145          ADD      r1,r4,r5,LSL #1
000c46  70c8              STRB     r0,[r1,#3]
;;;750    modbus_tx_buff[4+(reg_quantity*2)]=crc_temp/256;
000c48  0a00              LSRS     r0,r0,#8
000c4a  7108              STRB     r0,[r1,#4]
;;;751    
;;;752    for (i=0;i<(5+(reg_quantity*2));i++)
000c4c  2400              MOVS     r4,#0
000c4e  2005              MOVS     r0,#5
000c50  eb000545          ADD      r5,r0,r5,LSL #1
000c54  e004              B        |L1.3168|
                  |L1.3158|
;;;753    	{
;;;754    	putchar0(modbus_tx_buff[i]);
000c56  5d30              LDRB     r0,[r6,r4]
000c58  f7fffffe          BL       putchar0
000c5c  1c64              ADDS     r4,r4,#1              ;752
000c5e  b2e4              UXTB     r4,r4                 ;752
                  |L1.3168|
000c60  42a5              CMP      r5,r4                 ;752
000c62  d8f8              BHI      |L1.3158|
;;;755    	}
;;;756    
;;;757    for (i=0;i<(5+(reg_quantity*2));i++)
000c64  2400              MOVS     r4,#0
000c66  e004              B        |L1.3186|
                  |L1.3176|
;;;758    	{
;;;759    	putchar_sc16is700(modbus_tx_buff[i]);
000c68  5d30              LDRB     r0,[r6,r4]
000c6a  f7fffffe          BL       putchar_sc16is700
000c6e  1c64              ADDS     r4,r4,#1              ;757
000c70  b2e4              UXTB     r4,r4                 ;757
                  |L1.3186|
000c72  42a5              CMP      r5,r4                 ;757
000c74  d8f8              BHI      |L1.3176|
;;;760    	}
;;;761    
;;;762    /*	putchar2(modbus_tx_buff[0]);
;;;763    	putchar2(modbus_tx_buff[1]);
;;;764    	putchar2(modbus_tx_buff[2]);
;;;765    	putchar2(modbus_tx_buff[3]);
;;;766    	putchar2(modbus_tx_buff[4]);
;;;767    	putchar2(modbus_tx_buff[5]);
;;;768    	putchar2(modbus_tx_buff[6]);*/
;;;769    //	putchar2(modbus_tx_buff[0]);
;;;770    	//putchar2(modbus_tx_buff[1]);
;;;771    //	putchar2(modbus_tx_buff[2]);
;;;772    //	putchar2(modbus_tx_buff[3]);
;;;773    ///	putchar2(modbus_tx_buff[4]);
;;;774    //	putchar2(modbus_tx_buff[5]);
;;;775    //	putchar2(modbus_tx_buff[6]);
;;;776    }
000c76  b033              ADD      sp,sp,#0xcc
000c78  bdf0              POP      {r4-r7,pc}
;;;777    
                          ENDP

                  modbus_in PROC
;;;56     //-----------------------------------------------
;;;57     void modbus_in(void)
000c7a  e92d41f0          PUSH     {r4-r8,lr}
;;;58     {
;;;59     short crc16_calculated;		//βϋχθρλεμΰ θη οπθνςϋυ δΰννϋυ CRC
;;;60     short crc16_incapsulated;	//βρςπξενννΰ β οξρϋλκσ CRC
;;;61     unsigned short modbus_rx_arg0;		//βρςπξεννϋι β οξρϋλκσ οεπβϋι ΰπγσμενς
;;;62     unsigned short modbus_rx_arg1;		//βρςπξεννϋι β οξρϋλκσ βςξπξι ΰπγσμενς
;;;63     unsigned short modbus_rx_arg2;		//βρςπξεννϋι β οξρϋλκσ ςπεςθι ΰπγσμενς
;;;64     unsigned short modbus_rx_arg3;		//βρςπξεννϋι β οξρϋλκσ χεςβεπςϋι ΰπγσμενς
;;;65     unsigned char modbus_func;			//βρςπξεννϋι β οξρϋλκσ κξδ τσνκφθθ
;;;66     
;;;67     
;;;68     
;;;69     mem_copy(modbus_an_buffer,modbus_rx_buffer,modbus_rx_buffer_ptr);
000c7e  4e55              LDR      r6,|L1.3540|
000c80  4955              LDR      r1,|L1.3544|
000c82  7872              LDRB     r2,[r6,#1]  ; modbus_rx_buffer_ptr
000c84  f101001e          ADD      r0,r1,#0x1e
000c88  f7fffffe          BL       mem_copy
;;;70     modbus_rx_counter=modbus_rx_buffer_ptr;
000c8c  7870              LDRB     r0,[r6,#1]  ; modbus_rx_buffer_ptr
000c8e  70b0              STRB     r0,[r6,#2]
;;;71     modbus_rx_buffer_ptr=0;
000c90  2000              MOVS     r0,#0
000c92  7070              STRB     r0,[r6,#1]
;;;72     bMODBUS_TIMEOUT=0;
000c94  7030              STRB     r0,[r6,#0]
;;;73     	
;;;74     crc16_calculated  = CRC16_2(modbus_an_buffer, modbus_rx_counter-2);
000c96  78b1              LDRB     r1,[r6,#2]  ; modbus_rx_counter
000c98  484f              LDR      r0,|L1.3544|
000c9a  1e89              SUBS     r1,r1,#2
000c9c  301e              ADDS     r0,r0,#0x1e
000c9e  f7fffffe          BL       CRC16_2
000ca2  b201              SXTH     r1,r0
;;;75     crc16_incapsulated = *((short*)&modbus_an_buffer[modbus_rx_counter-2]);
000ca4  484c              LDR      r0,|L1.3544|
000ca6  78b3              LDRB     r3,[r6,#2]  ; modbus_rx_counter
000ca8  301e              ADDS     r0,r0,#0x1e
000caa  18c2              ADDS     r2,r0,r3
000cac  f9322c02          LDRSH    r2,[r2,#-2]
;;;76     
;;;77     modbus_plazma1=modbus_rx_counter;
000cb0  80f3              STRH     r3,[r6,#6]
;;;78     modbus_plazma2=crc16_calculated;
000cb2  8131              STRH     r1,[r6,#8]
;;;79     modbus_plazma3=crc16_incapsulated;
000cb4  8172              STRH     r2,[r6,#0xa]
;;;80     
;;;81     modbus_func=modbus_an_buffer[1];
000cb6  7847              LDRB     r7,[r0,#1]  ; modbus_an_buffer
;;;82     modbus_rx_arg0=(((unsigned short)modbus_an_buffer[2])*((unsigned short)256))+((unsigned short)modbus_an_buffer[3]);
000cb8  78c3              LDRB     r3,[r0,#3]  ; modbus_an_buffer
000cba  7884              LDRB     r4,[r0,#2]  ; modbus_an_buffer
000cbc  eb032304          ADD      r3,r3,r4,LSL #8
000cc0  b29c              UXTH     r4,r3
;;;83     modbus_rx_arg1=(((unsigned short)modbus_an_buffer[4])*((unsigned short)256))+((unsigned short)modbus_an_buffer[5]);
000cc2  7943              LDRB     r3,[r0,#5]  ; modbus_an_buffer
000cc4  7905              LDRB     r5,[r0,#4]  ; modbus_an_buffer
000cc6  eb032305          ADD      r3,r3,r5,LSL #8
000cca  b29d              UXTH     r5,r3
;;;84     modbus_rx_arg2=(((unsigned short)modbus_an_buffer[6])*((unsigned short)256))+((unsigned short)modbus_an_buffer[7]);
;;;85     modbus_rx_arg3=(((unsigned short)modbus_an_buffer[8])*((unsigned short)256))+((unsigned short)modbus_an_buffer[9]);
;;;86     
;;;87     
;;;88     if(crc16_calculated==crc16_incapsulated)
000ccc  4291              CMP      r1,r2
000cce  d152              BNE      |L1.3446|
;;;89     	{
;;;90     	
;;;91     	if(modbus_an_buffer[0]==MODBUS_ADRESS)
000cd0  f8df8108          LDR      r8,|L1.3548|
000cd4  7801              LDRB     r1,[r0,#0]  ; modbus_an_buffer
000cd6  f9b80000          LDRSH    r0,[r8,#0]  ; MODBUS_ADRESS
000cda  4281              CMP      r1,r0
000cdc  d14b              BNE      |L1.3446|
;;;92     		{
;;;93     		if(modbus_func==3)		//χςενθε οπξθηβξλόνξγξ κξλ-βΰ πεγθρςπξβ υπΰνενθ
000cde  2f03              CMP      r7,#3
000ce0  d108              BNE      |L1.3316|
;;;94     			{
;;;95     			modbus_plazma++;
000ce2  88b1              LDRH     r1,[r6,#4]  ; modbus_plazma
000ce4  1c49              ADDS     r1,r1,#1
000ce6  80b1              STRH     r1,[r6,#4]
;;;96     			modbus_hold_registers_transmit(MODBUS_ADRESS,modbus_func,modbus_rx_arg0,modbus_rx_arg1);
000ce8  462b              MOV      r3,r5
000cea  4622              MOV      r2,r4
000cec  4639              MOV      r1,r7
000cee  b2c0              UXTB     r0,r0
000cf0  f7fffffe          BL       modbus_hold_registers_transmit
                  |L1.3316|
;;;97     			}
;;;98     
;;;99     		if(modbus_func==4)		//χςενθε οπξθηβξλόνξγξ κξλ-βΰ πεγθρςπξβ	βυξδξβ
000cf4  2f04              CMP      r7,#4
000cf6  d109              BNE      |L1.3340|
;;;100    			{
;;;101    			modbus_input_registers_transmit(MODBUS_ADRESS,modbus_func,modbus_rx_arg0,modbus_rx_arg1);
000cf8  f8b80000          LDRH     r0,[r8,#0]  ; MODBUS_ADRESS
000cfc  462b              MOV      r3,r5
000cfe  4622              MOV      r2,r4
000d00  4639              MOV      r1,r7
000d02  e8bd41f0          POP      {r4-r8,lr}
000d06  b2c0              UXTB     r0,r0
000d08  f7ffbffe          B.W      modbus_input_registers_transmit
                  |L1.3340|
;;;102    			}
;;;103    
;;;104    		else if(modbus_func==6) 	//ηΰοθρό πεγθρςπξβ υπΰνενθ
000d0c  2f06              CMP      r7,#6
000d0e  d132              BNE      |L1.3446|
;;;105    			{
;;;106    			if(modbus_rx_arg0==11)		//Σρςΰνξβκΰ βπεμενθ 
;;;107    				{
;;;108    				LPC_RTC->YEAR=(uint16_t)modbus_rx_arg1;
000d10  4819              LDR      r0,|L1.3448|
000d12  3820              SUBS     r0,r0,#0x20
000d14  2c0b              CMP      r4,#0xb               ;106
000d16  d100              BNE      |L1.3354|
000d18  8785              STRH     r5,[r0,#0x3c]
                  |L1.3354|
;;;109    				}
;;;110    			if(modbus_rx_arg0==12)		//Σρςΰνξβκΰ βπεμενθ 
000d1a  2c0c              CMP      r4,#0xc
000d1c  d101              BNE      |L1.3362|
;;;111    				{
;;;112    				LPC_RTC->MONTH=(uint16_t)modbus_rx_arg1;
000d1e  f8805038          STRB     r5,[r0,#0x38]
                  |L1.3362|
;;;113    				}
;;;114    			if(modbus_rx_arg0==13)		//Σρςΰνξβκΰ βπεμενθ 
000d22  2c0d              CMP      r4,#0xd
000d24  d101              BNE      |L1.3370|
;;;115    				{
;;;116    				LPC_RTC->DOM=(uint16_t)modbus_rx_arg1;
000d26  f880502c          STRB     r5,[r0,#0x2c]
                  |L1.3370|
;;;117    				}
;;;118    			if(modbus_rx_arg0==14)		//Σρςΰνξβκΰ βπεμενθ 
000d2a  2c0e              CMP      r4,#0xe
000d2c  d101              BNE      |L1.3378|
;;;119    				{
;;;120    				LPC_RTC->HOUR=(uint16_t)modbus_rx_arg1;
000d2e  f8805028          STRB     r5,[r0,#0x28]
                  |L1.3378|
;;;121    				}
;;;122    			if(modbus_rx_arg0==15)		//Σρςΰνξβκΰ βπεμενθ 
000d32  2c0f              CMP      r4,#0xf
000d34  d101              BNE      |L1.3386|
;;;123    				{
;;;124    				LPC_RTC->MIN=(uint16_t)modbus_rx_arg1;
000d36  f8805024          STRB     r5,[r0,#0x24]
                  |L1.3386|
;;;125    				}
;;;126    			if(modbus_rx_arg0==16)		//Σρςΰνξβκΰ βπεμενθ 
000d3a  2c10              CMP      r4,#0x10
000d3c  d101              BNE      |L1.3394|
;;;127    				{
;;;128    				LPC_RTC->SEC=(uint16_t)modbus_rx_arg1;
000d3e  f8805020          STRB     r5,[r0,#0x20]
                  |L1.3394|
;;;129    				}
;;;130    			if(modbus_rx_arg0==20)		//ςξκ ρςΰαθλθηΰφθθ δλ πεζθμΰ ρςΰαθλθηΰφθθ ςξκΰ
000d42  2c14              CMP      r4,#0x14
000d44  d106              BNE      |L1.3412|
;;;131    				{
;;;132    				if((modbus_rx_arg1>0)&&(modbus_rx_arg1<5))
000d46  1e68              SUBS     r0,r5,#1
000d48  2804              CMP      r0,#4
000d4a  d203              BCS      |L1.3412|
;;;133    				lc640_write_int(EE_NUMIST,modbus_rx_arg1);  
000d4c  4629              MOV      r1,r5
000d4e  2098              MOVS     r0,#0x98
000d50  f7fffffe          BL       lc640_write_int
                  |L1.3412|
;;;134    				}
;;;135    			if(modbus_rx_arg0==21)		//ςξκ ρςΰαθλθηΰφθθ δλ πεζθμΰ ρςΰαθλθηΰφθθ ςξκΰ
000d54  2c15              CMP      r4,#0x15
000d56  d106              BNE      |L1.3430|
;;;136    				{
;;;137    				if((modbus_rx_arg1==0)||(modbus_rx_arg1==1))
000d58  b10d              CBZ      r5,|L1.3422|
000d5a  2d01              CMP      r5,#1
000d5c  d103              BNE      |L1.3430|
                  |L1.3422|
;;;138    				lc640_write_int(EE_PAR,modbus_rx_arg1);  
000d5e  4629              MOV      r1,r5
000d60  20ca              MOVS     r0,#0xca
000d62  f7fffffe          BL       lc640_write_int
                  |L1.3430|
;;;139    				}
;;;140    			if(modbus_rx_arg0==22)		//ςξκ ρςΰαθλθηΰφθθ δλ πεζθμΰ ρςΰαθλθηΰφθθ ςξκΰ
000d66  2c16              CMP      r4,#0x16
000d68  d13c              BNE      |L1.3556|
;;;141    				{
;;;142    				if((modbus_rx_arg1==0)||(modbus_rx_arg1==1))
000d6a  b10d              CBZ      r5,|L1.3440|
000d6c  2d01              CMP      r5,#1
000d6e  d139              BNE      |L1.3556|
                  |L1.3440|
;;;143    				lc640_write_int(EE_ZV_ON,modbus_rx_arg1);  
000d70  4629              MOV      r1,r5
000d72  2086              MOVS     r0,#0x86
000d74  e034              B        |L1.3552|
                  |L1.3446|
000d76  e0ca              B        |L1.3854|
                  |L1.3448|
                          DCD      0x40024020
                  |L1.3452|
                          DCD      NUMIST
                  |L1.3456|
                          DCD      PAR
                  |L1.3460|
                          DCD      ZV_ON
                  |L1.3464|
                          DCD      UBM_AV
                  |L1.3468|
                          DCD      TBAT
                  |L1.3472|
                          DCD      UMAX
                  |L1.3476|
                          DCD      UB20
                  |L1.3480|
                          DCD      ||DU||
                  |L1.3484|
                          DCD      UB0
                  |L1.3488|
                          DCD      USIGN
                  |L1.3492|
                          DCD      UMN
                  |L1.3496|
                          DCD      U0B
                  |L1.3500|
                          DCD      IKB
                  |L1.3504|
                          DCD      IZMAX
                  |L1.3508|
                          DCD      IMAX
                  |L1.3512|
                          DCD      IMIN
                  |L1.3516|
                          DCD      UVZ
                  |L1.3520|
                          DCD      TZAS
                  |L1.3524|
                          DCD      TMAX
                  |L1.3528|
                          DCD      TSIGN
                  |L1.3532|
                          DCD      TBATMAX
                  |L1.3536|
                          DCD      TBATSIGN
                  |L1.3540|
                          DCD      ||area_number.10||
                  |L1.3544|
                          DCD      ||area_number.6||
                  |L1.3548|
                          DCD      MODBUS_ADRESS
                  |L1.3552|
000de0  f7fffffe          BL       lc640_write_int
                  |L1.3556|
;;;144    				}
;;;145    			if(modbus_rx_arg0==23)		//ςξκ ρςΰαθλθηΰφθθ δλ πεζθμΰ ρςΰαθλθηΰφθθ ςξκΰ
000de4  2c17              CMP      r4,#0x17
000de6  d106              BNE      |L1.3574|
;;;146    				{
;;;147    				if((modbus_rx_arg1==0)||(modbus_rx_arg1==1))
000de8  b10d              CBZ      r5,|L1.3566|
000dea  2d01              CMP      r5,#1
000dec  d103              BNE      |L1.3574|
                  |L1.3566|
;;;148    				lc640_write_int(EE_TERMOKOMP,modbus_rx_arg1);  
000dee  4629              MOV      r1,r5
000df0  20f2              MOVS     r0,#0xf2
000df2  f7fffffe          BL       lc640_write_int
                  |L1.3574|
;;;149    				}
;;;150    			if(modbus_rx_arg0==24)		//ςξκ ρςΰαθλθηΰφθθ δλ πεζθμΰ ρςΰαθλθηΰφθθ ςξκΰ
000df6  2c18              CMP      r4,#0x18
000df8  d104              BNE      |L1.3588|
;;;151    				{
;;;152    				if((modbus_rx_arg1>=0)||(modbus_rx_arg1<=20))
;;;153    				lc640_write_int(EE_UBM_AV,modbus_rx_arg1);  
000dfa  4629              MOV      r1,r5
000dfc  f44f7019          MOV      r0,#0x264
000e00  f7fffffe          BL       lc640_write_int
                  |L1.3588|
;;;154    				}
;;;155    
;;;156    
;;;157    			if(modbus_rx_arg0==30)		//νΰοπζενθε ρςΰαθλθηΰφθθ δλ πεζθμΰ ρςΰαθλθηΰφθθ νΰοπζενθ
000e04  2c1e              CMP      r4,#0x1e
000e06  d110              BNE      |L1.3626|
;;;158    				{
;;;159    				if(modbus_rx_arg1<0)TBAT=0;
;;;160    				else if((modbus_rx_arg1>0)&&(modbus_rx_arg1<=5))modbus_rx_arg1=0;
000e08  1e69              SUBS     r1,r5,#1
;;;161    				else if(modbus_rx_arg1>=60)TBAT=60;
000e0a  4841              LDR      r0,|L1.3856|
000e0c  2904              CMP      r1,#4                 ;160
000e0e  d801              BHI      |L1.3604|
000e10  2500              MOVS     r5,#0                 ;160
000e12  e005              B        |L1.3616|
                  |L1.3604|
000e14  2d3c              CMP      r5,#0x3c
000e16  d302              BCC      |L1.3614|
000e18  213c              MOVS     r1,#0x3c
000e1a  8001              STRH     r1,[r0,#0]
000e1c  e000              B        |L1.3616|
                  |L1.3614|
;;;162    				else TBAT=modbus_rx_arg1;
000e1e  8005              STRH     r5,[r0,#0]
                  |L1.3616|
;;;163    				lc640_write_int(EE_TBAT,TBAT);
000e20  f9b01000          LDRSH    r1,[r0,#0]  ; TBAT
000e24  20c2              MOVS     r0,#0xc2
000e26  f7fffffe          BL       lc640_write_int
                  |L1.3626|
;;;164    	     		}
;;;165    			if(modbus_rx_arg0==31)		//
000e2a  2c1f              CMP      r4,#0x1f
000e2c  d103              BNE      |L1.3638|
;;;166    				{
;;;167    				lc640_write_int(EE_UMAX,modbus_rx_arg1);
000e2e  4629              MOV      r1,r5
000e30  2078              MOVS     r0,#0x78
000e32  f7fffffe          BL       lc640_write_int
                  |L1.3638|
;;;168    	     		}
;;;169    			if(modbus_rx_arg0==32)		//
000e36  2c20              CMP      r4,#0x20
000e38  d106              BNE      |L1.3656|
;;;170    				{
;;;171    				lc640_write_int(EE_DU,UB20-modbus_rx_arg1);
000e3a  4836              LDR      r0,|L1.3860|
000e3c  f9b00000          LDRSH    r0,[r0,#0]  ; UB20
000e40  1b41              SUBS     r1,r0,r5
000e42  20c8              MOVS     r0,#0xc8
000e44  f7fffffe          BL       lc640_write_int
                  |L1.3656|
;;;172    	     		}
;;;173    			if(modbus_rx_arg0==33)		//
000e48  2c21              CMP      r4,#0x21
000e4a  d103              BNE      |L1.3668|
;;;174    				{
;;;175    				lc640_write_int(EE_UB0,modbus_rx_arg1);
000e4c  4629              MOV      r1,r5
000e4e  207a              MOVS     r0,#0x7a
000e50  f7fffffe          BL       lc640_write_int
                  |L1.3668|
;;;176    	     		}
;;;177    			if(modbus_rx_arg0==34)		//
000e54  2c22              CMP      r4,#0x22
000e56  d103              BNE      |L1.3680|
;;;178    				{
;;;179    				lc640_write_int(EE_UB20,modbus_rx_arg1);
000e58  4629              MOV      r1,r5
000e5a  207c              MOVS     r0,#0x7c
000e5c  f7fffffe          BL       lc640_write_int
                  |L1.3680|
;;;180    	     		}
;;;181    			if(modbus_rx_arg0==35)		//
000e60  2c23              CMP      r4,#0x23
000e62  d103              BNE      |L1.3692|
;;;182    				{
;;;183    				lc640_write_int(EE_USIGN,modbus_rx_arg1);
000e64  4629              MOV      r1,r5
000e66  2082              MOVS     r0,#0x82
000e68  f7fffffe          BL       lc640_write_int
                  |L1.3692|
;;;184    	     		}
;;;185    			if(modbus_rx_arg0==36)		//
000e6c  2c24              CMP      r4,#0x24
000e6e  d103              BNE      |L1.3704|
;;;186    				{
;;;187    				lc640_write_int(EE_UMN,modbus_rx_arg1);
000e70  4629              MOV      r1,r5
000e72  2084              MOVS     r0,#0x84
000e74  f7fffffe          BL       lc640_write_int
                  |L1.3704|
;;;188    	     		}
;;;189    			if(modbus_rx_arg0==37)		//
000e78  2c25              CMP      r4,#0x25
000e7a  d103              BNE      |L1.3716|
;;;190    				{
;;;191    				lc640_write_int(EE_U0B,modbus_rx_arg1);
000e7c  4629              MOV      r1,r5
000e7e  2094              MOVS     r0,#0x94
000e80  f7fffffe          BL       lc640_write_int
                  |L1.3716|
;;;192    	     		}
;;;193    			if(modbus_rx_arg0==38)		//
000e84  2c26              CMP      r4,#0x26
000e86  d103              BNE      |L1.3728|
;;;194    				{
;;;195    				lc640_write_int(EE_IKB,modbus_rx_arg1);
000e88  4629              MOV      r1,r5
000e8a  2088              MOVS     r0,#0x88
000e8c  f7fffffe          BL       lc640_write_int
                  |L1.3728|
;;;196    	     		}
;;;197    			if(modbus_rx_arg0==39)		//
000e90  2c27              CMP      r4,#0x27
000e92  d103              BNE      |L1.3740|
;;;198    				{
;;;199    				lc640_write_int(EE_IZMAX,modbus_rx_arg1);
000e94  4629              MOV      r1,r5
000e96  2092              MOVS     r0,#0x92
000e98  f7fffffe          BL       lc640_write_int
                  |L1.3740|
;;;200    	     		}
;;;201    			if(modbus_rx_arg0==40)		//
000e9c  2c28              CMP      r4,#0x28
000e9e  d103              BNE      |L1.3752|
;;;202    				{
;;;203    				lc640_write_int(EE_IMAX,modbus_rx_arg1);
000ea0  4629              MOV      r1,r5
000ea2  208c              MOVS     r0,#0x8c
000ea4  f7fffffe          BL       lc640_write_int
                  |L1.3752|
;;;204    	     		}
;;;205    			if(modbus_rx_arg0==41)		//
000ea8  2c29              CMP      r4,#0x29
000eaa  d103              BNE      |L1.3764|
;;;206    				{
;;;207    				lc640_write_int(EE_IMIN,modbus_rx_arg1);
000eac  4629              MOV      r1,r5
000eae  208e              MOVS     r0,#0x8e
000eb0  f7fffffe          BL       lc640_write_int
                  |L1.3764|
;;;208    	     		}
;;;209    			if(modbus_rx_arg0==42)		//
000eb4  2c2a              CMP      r4,#0x2a
000eb6  d103              BNE      |L1.3776|
;;;210    				{
;;;211    				lc640_write_int(EE_UVZ,modbus_rx_arg1);
000eb8  4629              MOV      r1,r5
000eba  20de              MOVS     r0,#0xde
000ebc  f7fffffe          BL       lc640_write_int
                  |L1.3776|
;;;212    	     		}
;;;213    			if(modbus_rx_arg0==43)		//
000ec0  2c2b              CMP      r4,#0x2b
000ec2  d103              BNE      |L1.3788|
;;;214    				{
;;;215    				lc640_write_int(EE_TZAS,modbus_rx_arg1);
000ec4  4629              MOV      r1,r5
000ec6  2096              MOVS     r0,#0x96
000ec8  f7fffffe          BL       lc640_write_int
                  |L1.3788|
;;;216    	     		}
;;;217    			if(modbus_rx_arg0==44)		//
000ecc  2c2c              CMP      r4,#0x2c
000ece  d103              BNE      |L1.3800|
;;;218    				{
;;;219    				lc640_write_int(EE_TMAX,modbus_rx_arg1);
000ed0  4629              MOV      r1,r5
000ed2  207e              MOVS     r0,#0x7e
000ed4  f7fffffe          BL       lc640_write_int
                  |L1.3800|
;;;220    	     		}
;;;221    			if(modbus_rx_arg0==45)		//
000ed8  2c2d              CMP      r4,#0x2d
000eda  d103              BNE      |L1.3812|
;;;222    				{
;;;223    				lc640_write_int(EE_TSIGN,modbus_rx_arg1);
000edc  4629              MOV      r1,r5
000ede  20c6              MOVS     r0,#0xc6
000ee0  f7fffffe          BL       lc640_write_int
                  |L1.3812|
;;;224    	     		}
;;;225    			if(modbus_rx_arg0==46)		//
000ee4  2c2e              CMP      r4,#0x2e
000ee6  d103              BNE      |L1.3824|
;;;226    				{
;;;227    				lc640_write_int(EE_TBATMAX,modbus_rx_arg1);
000ee8  4629              MOV      r1,r5
000eea  20cc              MOVS     r0,#0xcc
000eec  f7fffffe          BL       lc640_write_int
                  |L1.3824|
;;;228    	     		}
;;;229    			if(modbus_rx_arg0==47)		//
000ef0  2c2f              CMP      r4,#0x2f
000ef2  d103              BNE      |L1.3836|
;;;230    				{
;;;231    				lc640_write_int(EE_TBATSIGN,modbus_rx_arg1);
000ef4  4629              MOV      r1,r5
000ef6  20ce              MOVS     r0,#0xce
000ef8  f7fffffe          BL       lc640_write_int
                  |L1.3836|
;;;232    	     		}
;;;233    			if(modbus_rx_arg0==19)		//βκλ/βϋκλ θρςξχνθκΰ νΰοπ.
;;;234    				{
;;;235    	/*			if(modbus_rx_arg1==1)
;;;236    					{
;;;237    					if(work_stat!=wsPS)
;;;238    						{
;;;239    						work_stat=wsPS;
;;;240    						time_proc=0;
;;;241    						time_proc_remain=T_PROC_PS;
;;;242    						restart_on_PS();
;;;243    						lc640_write_int(EE_MAIN_MENU_MODE,mmmIN);
;;;244    						}
;;;245    					}
;;;246    				if(modbus_rx_arg1==0)
;;;247    					{
;;;248    					if(work_stat==wsPS)
;;;249    						{
;;;250    						work_stat=wsOFF;
;;;251    						restart_off();
;;;252    						}
;;;253    					} */
;;;254    				}
;;;255    			if(modbus_rx_arg0==20)		//βκλ/βϋκλ θρςξχνθκΰ ςξκΰ
;;;256    				{
;;;257    /*				if(modbus_rx_arg1==1)
;;;258    					{
;;;259    					if(work_stat!=wsGS)
;;;260    						{
;;;261    						work_stat=wsGS;
;;;262    						time_proc=0;
;;;263    						time_proc_remain=T_PROC_GS;
;;;264    						lc640_write_int(EE_MAIN_MENU_MODE,mmmIT);
;;;265    						}
;;;266    					}
;;;267    				if(modbus_rx_arg1==0)
;;;268    					{
;;;269    					if(work_stat==wsGS)
;;;270    						{
;;;271    						work_stat=wsOFF;
;;;272    						restart_off();
;;;273    						}
;;;274    					}*/
;;;275    				}
;;;276    			modbus_hold_register_transmit(MODBUS_ADRESS,modbus_func,modbus_rx_arg0);
000efc  f8b80000          LDRH     r0,[r8,#0]  ; MODBUS_ADRESS
000f00  4622              MOV      r2,r4
000f02  4639              MOV      r1,r7
000f04  e8bd41f0          POP      {r4-r8,lr}
000f08  b2c0              UXTB     r0,r0
000f0a  f7ffbffe          B.W      modbus_hold_register_transmit
                  |L1.3854|
;;;277    			}
;;;278    		} 
;;;279    	//modbus_plazma++;
;;;280    	}
;;;281    // modbus_plazma++;
;;;282    
;;;283    }
000f0e  e52f              B        |L1.2416|
;;;284    
                          ENDP

                  |L1.3856|
                          DCD      TBAT
                  |L1.3860|
                          DCD      UB20

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  modbus_register_transmit PROC
;;;285    //-----------------------------------------------
;;;286    void modbus_register_transmit(unsigned char adr,unsigned char func,unsigned short reg_adr)
000000  b5f0              PUSH     {r4-r7,lr}
;;;287    {
000002  b0b3              SUB      sp,sp,#0xcc
;;;288    char modbus_registers[150];
;;;289    char modbus_tx_buff[50];
;;;290    unsigned short crc_temp;
;;;291    char i;
;;;292    
;;;293    
;;;294    modbus_registers[0]=(char)(load_U/256);					//Πεγ1
000004  4bff              LDR      r3,|L2.1028|
000006  f9b33000          LDRSH    r3,[r3,#0]  ; load_U
00000a  17dc              ASRS     r4,r3,#31
00000c  eb036414          ADD      r4,r3,r4,LSR #24
000010  1225              ASRS     r5,r4,#8
000012  f88d5034          STRB     r5,[sp,#0x34]
;;;295    modbus_registers[1]=(char)(load_U%256);
000016  f88d3035          STRB     r3,[sp,#0x35]
;;;296    modbus_registers[2]=(char)(load_I/256);					//Πεγ2
00001a  4bfb              LDR      r3,|L2.1032|
00001c  f9b34000          LDRSH    r4,[r3,#0]  ; load_I
000020  17e3              ASRS     r3,r4,#31
000022  eb046513          ADD      r5,r4,r3,LSR #24
000026  f3c52307          UBFX     r3,r5,#8,#8
00002a  f88d3036          STRB     r3,[sp,#0x36]
;;;297    modbus_registers[3]=(char)(load_I%256);
00002e  b2e4              UXTB     r4,r4
000030  f88d4037          STRB     r4,[sp,#0x37]
;;;298    modbus_registers[4]=(char)(Ib_ips_termokompensat/256);		//Πεγ3
000034  4df5              LDR      r5,|L2.1036|
000036  f9b55000          LDRSH    r5,[r5,#0]  ; Ib_ips_termokompensat
00003a  17ee              ASRS     r6,r5,#31
00003c  eb056616          ADD      r6,r5,r6,LSR #24
000040  1237              ASRS     r7,r6,#8
000042  f88d7038          STRB     r7,[sp,#0x38]
;;;299    modbus_registers[5]=(char)(Ib_ips_termokompensat%256);
000046  f88d5039          STRB     r5,[sp,#0x39]
;;;300    modbus_registers[6]=(char)(t_ext[0]/256);				//Πεγ4
00004a  4df1              LDR      r5,|L2.1040|
00004c  f9b55000          LDRSH    r5,[r5,#0]  ; t_ext
000050  17ee              ASRS     r6,r5,#31
000052  eb056616          ADD      r6,r5,r6,LSR #24
000056  1237              ASRS     r7,r6,#8
000058  f88d703a          STRB     r7,[sp,#0x3a]
;;;301    modbus_registers[7]=(char)(t_ext[0]%256);
00005c  f88d503b          STRB     r5,[sp,#0x3b]
;;;302    modbus_registers[8]=(char)(net_Ua/256);					//Πεγ5
000060  4dec              LDR      r5,|L2.1044|
000062  f9b55000          LDRSH    r5,[r5,#0]  ; net_Ua
000066  17ee              ASRS     r6,r5,#31
000068  eb056616          ADD      r6,r5,r6,LSR #24
00006c  1237              ASRS     r7,r6,#8
00006e  f88d703c          STRB     r7,[sp,#0x3c]
;;;303    modbus_registers[9]=(char)(net_Ua%256);		 	
000072  f88d503d          STRB     r5,[sp,#0x3d]
;;;304    modbus_registers[10]=(char)(net_Ub/256);				//Πεγ6
000076  4de8              LDR      r5,|L2.1048|
000078  f9b55000          LDRSH    r5,[r5,#0]  ; net_Ub
00007c  17ee              ASRS     r6,r5,#31
00007e  eb056616          ADD      r6,r5,r6,LSR #24
000082  1237              ASRS     r7,r6,#8
000084  f88d703e          STRB     r7,[sp,#0x3e]
;;;305    modbus_registers[11]=(char)(net_Ub%256);
000088  f88d503f          STRB     r5,[sp,#0x3f]
;;;306    modbus_registers[12]=(char)(net_Uc/256);				//Πεγ7
00008c  4de3              LDR      r5,|L2.1052|
00008e  f9b55000          LDRSH    r5,[r5,#0]  ; net_Uc
000092  17ee              ASRS     r6,r5,#31
000094  eb056616          ADD      r6,r5,r6,LSR #24
000098  1237              ASRS     r7,r6,#8
00009a  f88d7040          STRB     r7,[sp,#0x40]
;;;307    modbus_registers[13]=(char)(net_Uc%256);
00009e  f88d5041          STRB     r5,[sp,#0x41]
;;;308    modbus_registers[14]=(char)(net_F3/256);				//Πεγ8
0000a2  4ddf              LDR      r5,|L2.1056|
0000a4  f9b55000          LDRSH    r5,[r5,#0]  ; net_F3
0000a8  17ee              ASRS     r6,r5,#31
0000aa  eb056616          ADD      r6,r5,r6,LSR #24
0000ae  1237              ASRS     r7,r6,#8
0000b0  f88d7042          STRB     r7,[sp,#0x42]
;;;309    modbus_registers[15]=(char)(net_F3%256);
0000b4  f88d5043          STRB     r5,[sp,#0x43]
;;;310    modbus_registers[16]=(char)(load_I/256);				//Πεγ9
0000b8  f88d3044          STRB     r3,[sp,#0x44]
;;;311    modbus_registers[17]=(char)(load_I%256);
0000bc  f88d4045          STRB     r4,[sp,#0x45]
;;;312    modbus_registers[18]=(char)(load_I/256);				//Πεγ10
0000c0  f88d3046          STRB     r3,[sp,#0x46]
;;;313    modbus_registers[19]=(char)(load_I%256);
0000c4  f88d4047          STRB     r4,[sp,#0x47]
;;;314    modbus_registers[20]=(char)((LPC_RTC->YEAR)/256);			//Πεγ11
0000c8  4dd6              LDR      r5,|L2.1060|
0000ca  8bae              LDRH     r6,[r5,#0x1c]
0000cc  ea4f2616          LSR      r6,r6,#8
0000d0  f88d6048          STRB     r6,[sp,#0x48]
;;;315    modbus_registers[21]=(char)((LPC_RTC->YEAR)%256);
0000d4  8bae              LDRH     r6,[r5,#0x1c]
0000d6  f88d6049          STRB     r6,[sp,#0x49]
;;;316    modbus_registers[22]=(char)((LPC_RTC->MONTH)/256);		//Πεγ12
0000da  7e2e              LDRB     r6,[r5,#0x18]
0000dc  f04f0600          MOV      r6,#0
0000e0  f88d604a          STRB     r6,[sp,#0x4a]
;;;317    modbus_registers[23]=(char)((LPC_RTC->MONTH)%256);
0000e4  7e2f              LDRB     r7,[r5,#0x18]
0000e6  f88d704b          STRB     r7,[sp,#0x4b]
;;;318    modbus_registers[24]=(char)((LPC_RTC->DOM)/256);			//Πεγ13
0000ea  7b2f              LDRB     r7,[r5,#0xc]
0000ec  f88d604c          STRB     r6,[sp,#0x4c]
;;;319    modbus_registers[25]=(char)((LPC_RTC->DOM)%256);
0000f0  7b2f              LDRB     r7,[r5,#0xc]
0000f2  f88d704d          STRB     r7,[sp,#0x4d]
;;;320    modbus_registers[26]=(char)((LPC_RTC->HOUR)/256);			//Πεγ14
0000f6  7a2f              LDRB     r7,[r5,#8]
0000f8  f88d604e          STRB     r6,[sp,#0x4e]
;;;321    modbus_registers[27]=(char)((LPC_RTC->HOUR)%256);
0000fc  7a2f              LDRB     r7,[r5,#8]
0000fe  f88d704f          STRB     r7,[sp,#0x4f]
;;;322    modbus_registers[28]=(char)((LPC_RTC->MIN)/256);			//Πεγ15
000102  792f              LDRB     r7,[r5,#4]
000104  f88d6050          STRB     r6,[sp,#0x50]
;;;323    modbus_registers[29]=(char)((LPC_RTC->MIN)%256);
000108  792f              LDRB     r7,[r5,#4]
00010a  f88d7051          STRB     r7,[sp,#0x51]
;;;324    modbus_registers[30]=(char)((LPC_RTC->SEC)/256);			//Πεγ16
00010e  782f              LDRB     r7,[r5,#0]
000110  f88d6052          STRB     r6,[sp,#0x52]
;;;325    modbus_registers[31]=(char)((LPC_RTC->SEC)%256);
000114  782d              LDRB     r5,[r5,#0]
000116  f88d5053          STRB     r5,[sp,#0x53]
;;;326    modbus_registers[32]=(char)(load_I/256);				//Πεγ17
00011a  f88d3054          STRB     r3,[sp,#0x54]
;;;327    modbus_registers[33]=(char)(load_I%256);
00011e  f88d4055          STRB     r4,[sp,#0x55]
;;;328    modbus_registers[34]=(char)(load_I/256);				//Πεγ18
000122  f88d3056          STRB     r3,[sp,#0x56]
;;;329    modbus_registers[35]=(char)(load_I%256);
000126  f88d4057          STRB     r4,[sp,#0x57]
;;;330    modbus_registers[36]=(char)(load_I/256);		//Πεγ19
00012a  f88d3058          STRB     r3,[sp,#0x58]
;;;331    modbus_registers[37]=(char)(load_I%256);
00012e  f88d4059          STRB     r4,[sp,#0x59]
;;;332    modbus_registers[38]=(char)(NUMIST/256);		//Πεγ20
000132  4dbd              LDR      r5,|L2.1064|
000134  f9b55000          LDRSH    r5,[r5,#0]  ; NUMIST
000138  ea4f76e5          ASR      r6,r5,#31
00013c  eb056616          ADD      r6,r5,r6,LSR #24
000140  ea4f2726          ASR      r7,r6,#8
000144  f88d705a          STRB     r7,[sp,#0x5a]
;;;333    modbus_registers[39]=(char)(NUMIST%256);
000148  f88d505b          STRB     r5,[sp,#0x5b]
;;;334    modbus_registers[40]=(char)(PAR/256);		//Πεγ21
00014c  4db7              LDR      r5,|L2.1068|
00014e  f9b55000          LDRSH    r5,[r5,#0]  ; PAR
000152  ea4f76e5          ASR      r6,r5,#31
000156  eb056616          ADD      r6,r5,r6,LSR #24
00015a  ea4f2726          ASR      r7,r6,#8
00015e  f88d705c          STRB     r7,[sp,#0x5c]
;;;335    modbus_registers[41]=(char)(PAR%256);
000162  f88d505d          STRB     r5,[sp,#0x5d]
;;;336    modbus_registers[42]=(char)(ZV_ON/256);		//Πεγ22
000166  4db2              LDR      r5,|L2.1072|
000168  f9b55000          LDRSH    r5,[r5,#0]  ; ZV_ON
00016c  ea4f76e5          ASR      r6,r5,#31
000170  eb056616          ADD      r6,r5,r6,LSR #24
000174  ea4f2726          ASR      r7,r6,#8
000178  f88d705e          STRB     r7,[sp,#0x5e]
;;;337    modbus_registers[43]=(char)(ZV_ON%256);
00017c  f88d505f          STRB     r5,[sp,#0x5f]
;;;338    modbus_registers[44]=(char)(TERMOKOMPENS/256);		//Πεγ23
000180  4dac              LDR      r5,|L2.1076|
000182  f9b55000          LDRSH    r5,[r5,#0]  ; TERMOKOMPENS
000186  ea4f76e5          ASR      r6,r5,#31
00018a  eb056616          ADD      r6,r5,r6,LSR #24
00018e  ea4f2726          ASR      r7,r6,#8
000192  f88d7060          STRB     r7,[sp,#0x60]
;;;339    modbus_registers[45]=(char)(TERMOKOMPENS%256);
000196  f88d5061          STRB     r5,[sp,#0x61]
;;;340    modbus_registers[46]=(char)(UBM_AV/256);		//Πεγ24
00019a  4da7              LDR      r5,|L2.1080|
00019c  f9b55000          LDRSH    r5,[r5,#0]  ; UBM_AV
0001a0  ea4f76e5          ASR      r6,r5,#31
0001a4  eb056616          ADD      r6,r5,r6,LSR #24
0001a8  ea4f2726          ASR      r7,r6,#8
0001ac  f88d7062          STRB     r7,[sp,#0x62]
;;;341    modbus_registers[47]=(char)(UBM_AV%256);
0001b0  f88d5063          STRB     r5,[sp,#0x63]
;;;342    modbus_registers[48]=(char)(load_I/256);		//Πεγ25
0001b4  f88d3064          STRB     r3,[sp,#0x64]
;;;343    modbus_registers[49]=(char)(load_I%256);
0001b8  f88d4065          STRB     r4,[sp,#0x65]
;;;344    modbus_registers[50]=(char)(load_I/256);		//Πεγ26
0001bc  f88d3066          STRB     r3,[sp,#0x66]
;;;345    modbus_registers[51]=(char)(load_I%256);
0001c0  f88d4067          STRB     r4,[sp,#0x67]
;;;346    modbus_registers[52]=(char)(load_I/256);		//Πεγ27
0001c4  f88d3068          STRB     r3,[sp,#0x68]
;;;347    modbus_registers[53]=(char)(load_I%256);
0001c8  f88d4069          STRB     r4,[sp,#0x69]
;;;348    modbus_registers[54]=(char)(load_I/256);		//Πεγ28
0001cc  f88d306a          STRB     r3,[sp,#0x6a]
;;;349    modbus_registers[55]=(char)(load_I%256);
0001d0  f88d406b          STRB     r4,[sp,#0x6b]
;;;350    modbus_registers[56]=(char)(load_I/256);		//Πεγ29
0001d4  f88d306c          STRB     r3,[sp,#0x6c]
;;;351    modbus_registers[57]=(char)(load_I%256);
0001d8  f88d406d          STRB     r4,[sp,#0x6d]
;;;352    modbus_registers[58]=(char)(TBAT/256);			//Πεγ30
0001dc  4d97              LDR      r5,|L2.1084|
0001de  f9b55000          LDRSH    r5,[r5,#0]  ; TBAT
0001e2  ea4f76e5          ASR      r6,r5,#31
0001e6  eb056616          ADD      r6,r5,r6,LSR #24
0001ea  ea4f2726          ASR      r7,r6,#8
0001ee  f88d706e          STRB     r7,[sp,#0x6e]
;;;353    modbus_registers[59]=(char)(TBAT%256);
0001f2  f88d506f          STRB     r5,[sp,#0x6f]
;;;354    modbus_registers[60]=(char)(UMAX/256);			//Πεγ31
0001f6  4d92              LDR      r5,|L2.1088|
0001f8  f9b55000          LDRSH    r5,[r5,#0]  ; UMAX
0001fc  ea4f76e5          ASR      r6,r5,#31
000200  eb056616          ADD      r6,r5,r6,LSR #24
000204  ea4f2726          ASR      r7,r6,#8
000208  f88d7070          STRB     r7,[sp,#0x70]
;;;355    modbus_registers[61]=(char)(UMAX%256);
00020c  f88d5071          STRB     r5,[sp,#0x71]
;;;356    modbus_registers[62]=(char)((UB20-DU)/256);		//Πεγ32
000210  4d8c              LDR      r5,|L2.1092|
000212  4e8d              LDR      r6,|L2.1096|
000214  f9b55000          LDRSH    r5,[r5,#0]  ; UB20
000218  f9b66000          LDRSH    r6,[r6,#0]  ; DU
00021c  eba50606          SUB      r6,r5,r6
000220  ea4f77e6          ASR      r7,r6,#31
000224  eb066717          ADD      r7,r6,r7,LSR #24
000228  ea4f2c27          ASR      r12,r7,#8
00022c  f88dc072          STRB     r12,[sp,#0x72]
;;;357    modbus_registers[63]=(char)((UB20-DU)%256);
000230  f88d6073          STRB     r6,[sp,#0x73]
;;;358    modbus_registers[64]=(char)(UB0/256);			//Πεγ33
000234  4e85              LDR      r6,|L2.1100|
000236  f9b66000          LDRSH    r6,[r6,#0]  ; UB0
00023a  ea4f77e6          ASR      r7,r6,#31
00023e  eb066717          ADD      r7,r6,r7,LSR #24
000242  ea4f2c27          ASR      r12,r7,#8
000246  f88dc074          STRB     r12,[sp,#0x74]
;;;359    modbus_registers[65]=(char)(UB0%256);
00024a  f88d6075          STRB     r6,[sp,#0x75]
;;;360    modbus_registers[66]=(char)(UB20/256);			//Πεγ34
00024e  ea4f76e5          ASR      r6,r5,#31
000252  eb056616          ADD      r6,r5,r6,LSR #24
000256  ea4f2726          ASR      r7,r6,#8
00025a  f88d7076          STRB     r7,[sp,#0x76]
;;;361    modbus_registers[67]=(char)(UB20%256);
00025e  f88d5077          STRB     r5,[sp,#0x77]
;;;362    modbus_registers[68]=(char)(USIGN/256);		//Πεγ35
000262  4d7b              LDR      r5,|L2.1104|
000264  f9b55000          LDRSH    r5,[r5,#0]  ; USIGN
000268  ea4f76e5          ASR      r6,r5,#31
00026c  eb056616          ADD      r6,r5,r6,LSR #24
000270  ea4f2726          ASR      r7,r6,#8
000274  f88d7078          STRB     r7,[sp,#0x78]
;;;363    modbus_registers[69]=(char)(USIGN%256);
000278  f88d5079          STRB     r5,[sp,#0x79]
;;;364    modbus_registers[70]=(char)(UMN/256);		//Πεγ36
00027c  4d75              LDR      r5,|L2.1108|
00027e  f9b55000          LDRSH    r5,[r5,#0]  ; UMN
000282  ea4f76e5          ASR      r6,r5,#31
000286  eb056616          ADD      r6,r5,r6,LSR #24
00028a  ea4f2726          ASR      r7,r6,#8
00028e  f88d707a          STRB     r7,[sp,#0x7a]
;;;365    modbus_registers[71]=(char)(UMN%256);
000292  f88d507b          STRB     r5,[sp,#0x7b]
;;;366    modbus_registers[72]=(char)(U0B/256);		//Πεγ37
000296  4d70              LDR      r5,|L2.1112|
000298  f9b55000          LDRSH    r5,[r5,#0]  ; U0B
00029c  ea4f76e5          ASR      r6,r5,#31
0002a0  eb056616          ADD      r6,r5,r6,LSR #24
0002a4  ea4f2726          ASR      r7,r6,#8
0002a8  f88d707c          STRB     r7,[sp,#0x7c]
;;;367    modbus_registers[73]=(char)(U0B%256);
0002ac  f88d507d          STRB     r5,[sp,#0x7d]
;;;368    modbus_registers[74]=(char)(IKB/256);		//Πεγ38
0002b0  4d6a              LDR      r5,|L2.1116|
0002b2  f9b55000          LDRSH    r5,[r5,#0]  ; IKB
0002b6  ea4f76e5          ASR      r6,r5,#31
0002ba  eb056616          ADD      r6,r5,r6,LSR #24
0002be  ea4f2726          ASR      r7,r6,#8
0002c2  f88d707e          STRB     r7,[sp,#0x7e]
;;;369    modbus_registers[75]=(char)(IKB%256);
0002c6  f88d507f          STRB     r5,[sp,#0x7f]
;;;370    modbus_registers[76]=(char)(IZMAX/256);		//Πεγ39
0002ca  4d65              LDR      r5,|L2.1120|
0002cc  f9b55000          LDRSH    r5,[r5,#0]  ; IZMAX
0002d0  ea4f76e5          ASR      r6,r5,#31
0002d4  eb056616          ADD      r6,r5,r6,LSR #24
0002d8  ea4f2726          ASR      r7,r6,#8
0002dc  f88d7080          STRB     r7,[sp,#0x80]
;;;371    modbus_registers[77]=(char)(IZMAX%256);
0002e0  f88d5081          STRB     r5,[sp,#0x81]
;;;372    modbus_registers[78]=(char)(IMAX/256);		//Πεγ40
0002e4  4d5f              LDR      r5,|L2.1124|
0002e6  f9b55000          LDRSH    r5,[r5,#0]  ; IMAX
0002ea  ea4f76e5          ASR      r6,r5,#31
0002ee  eb056616          ADD      r6,r5,r6,LSR #24
0002f2  ea4f2726          ASR      r7,r6,#8
0002f6  f88d7082          STRB     r7,[sp,#0x82]
;;;373    modbus_registers[79]=(char)(IMAX%256);
0002fa  f88d5083          STRB     r5,[sp,#0x83]
;;;374    modbus_registers[80]=(char)(IMIN/256);		//Πεγ41
0002fe  4d5a              LDR      r5,|L2.1128|
000300  f9b55000          LDRSH    r5,[r5,#0]  ; IMIN
000304  ea4f76e5          ASR      r6,r5,#31
000308  eb056616          ADD      r6,r5,r6,LSR #24
00030c  ea4f2726          ASR      r7,r6,#8
000310  f88d7084          STRB     r7,[sp,#0x84]
;;;375    modbus_registers[81]=(char)(IMIN%256);
000314  f88d5085          STRB     r5,[sp,#0x85]
;;;376    modbus_registers[82]=(char)(UVZ/256);		//Πεγ42
000318  4d54              LDR      r5,|L2.1132|
00031a  f9b55000          LDRSH    r5,[r5,#0]  ; UVZ
00031e  ea4f76e5          ASR      r6,r5,#31
000322  eb056616          ADD      r6,r5,r6,LSR #24
000326  ea4f2726          ASR      r7,r6,#8
00032a  f88d7086          STRB     r7,[sp,#0x86]
;;;377    modbus_registers[83]=(char)(UVZ%256);
00032e  f88d5087          STRB     r5,[sp,#0x87]
;;;378    modbus_registers[84]=(char)(TZAS/256);		//Πεγ43
000332  4d4f              LDR      r5,|L2.1136|
000334  f9b55000          LDRSH    r5,[r5,#0]  ; TZAS
000338  ea4f76e5          ASR      r6,r5,#31
00033c  eb056616          ADD      r6,r5,r6,LSR #24
000340  ea4f2726          ASR      r7,r6,#8
000344  f88d7088          STRB     r7,[sp,#0x88]
;;;379    modbus_registers[85]=(char)(TZAS%256);
000348  f88d5089          STRB     r5,[sp,#0x89]
;;;380    modbus_registers[86]=(char)(TMAX/256);		//Πεγ44
00034c  4d49              LDR      r5,|L2.1140|
00034e  f9b55000          LDRSH    r5,[r5,#0]  ; TMAX
000352  ea4f76e5          ASR      r6,r5,#31
000356  eb056616          ADD      r6,r5,r6,LSR #24
00035a  ea4f2726          ASR      r7,r6,#8
00035e  f88d708a          STRB     r7,[sp,#0x8a]
;;;381    modbus_registers[87]=(char)(TMAX%256);
000362  f88d508b          STRB     r5,[sp,#0x8b]
;;;382    modbus_registers[88]=(char)(TSIGN/256);		//Πεγ45
000366  4d44              LDR      r5,|L2.1144|
000368  f9b55000          LDRSH    r5,[r5,#0]  ; TSIGN
00036c  ea4f76e5          ASR      r6,r5,#31
000370  eb056616          ADD      r6,r5,r6,LSR #24
000374  ea4f2726          ASR      r7,r6,#8
000378  f88d708c          STRB     r7,[sp,#0x8c]
;;;383    modbus_registers[89]=(char)(TSIGN%256);
00037c  f88d508d          STRB     r5,[sp,#0x8d]
;;;384    modbus_registers[90]=(char)(TBATMAX/256);		//Πεγ46
000380  4d3e              LDR      r5,|L2.1148|
000382  f9b55000          LDRSH    r5,[r5,#0]  ; TBATMAX
000386  ea4f76e5          ASR      r6,r5,#31
00038a  eb056616          ADD      r6,r5,r6,LSR #24
00038e  ea4f2726          ASR      r7,r6,#8
000392  f88d708e          STRB     r7,[sp,#0x8e]
;;;385    modbus_registers[91]=(char)(TBATMAX%256);
000396  f88d508f          STRB     r5,[sp,#0x8f]
;;;386    modbus_registers[92]=(char)(TBATSIGN/256);		//Πεγ47
00039a  4d39              LDR      r5,|L2.1152|
00039c  f9b55000          LDRSH    r5,[r5,#0]  ; TBATSIGN
0003a0  ea4f76e5          ASR      r6,r5,#31
0003a4  eb056616          ADD      r6,r5,r6,LSR #24
0003a8  ea4f2726          ASR      r7,r6,#8
0003ac  f88d7090          STRB     r7,[sp,#0x90]
;;;387    modbus_registers[93]=(char)(TBATSIGN%256);
0003b0  f88d5091          STRB     r5,[sp,#0x91]
;;;388    modbus_registers[94]=(char)(load_I/256);		//Πεγ48
0003b4  f88d3092          STRB     r3,[sp,#0x92]
;;;389    modbus_registers[95]=(char)(load_I%256);
0003b8  f88d4093          STRB     r4,[sp,#0x93]
;;;390    modbus_registers[96]=(char)(load_I/256);		//Πεγ49
0003bc  f88d3094          STRB     r3,[sp,#0x94]
;;;391    modbus_registers[97]=(char)(load_I%256);
0003c0  f88d4095          STRB     r4,[sp,#0x95]
;;;392    modbus_registers[98]=(char)(load_I/256);		//Πεγ50
0003c4  f88d3096          STRB     r3,[sp,#0x96]
;;;393    modbus_registers[99]=(char)(load_I%256);
0003c8  f88d4097          STRB     r4,[sp,#0x97]
;;;394    
;;;395    modbus_tx_buff[0]=adr;
0003cc  f88d0000          STRB     r0,[sp,#0]
;;;396    modbus_tx_buff[1]=func;
0003d0  f88d1001          STRB     r1,[sp,#1]
;;;397    modbus_tx_buff[2]=(char)(reg_adr/256);
0003d4  ea4f2012          LSR      r0,r2,#8
0003d8  f88d0002          STRB     r0,[sp,#2]
;;;398    modbus_tx_buff[3]=(char)(reg_adr%256);
0003dc  f88d2003          STRB     r2,[sp,#3]
;;;399    //modbus_tx_buff[4]=(char)(reg_quantity/256);
;;;400    //modbus_tx_buff[5]=(char)(reg_quantity%256);
;;;401    /*
;;;402    modbus_registers[0]=0x10;
;;;403    modbus_registers[1]=0x11;
;;;404    modbus_registers[2]=0x12;
;;;405    modbus_registers[3]=0x13;
;;;406    modbus_registers[4]=0x14;
;;;407    modbus_registers[5]=0x15;
;;;408    */
;;;409    
;;;410    mem_copy((char*)&modbus_tx_buff[4],(char*)&modbus_registers[(reg_adr-1)*2],2);
0003e0  a80d              ADD      r0,sp,#0x34
0003e2  f1a20201          SUB      r2,r2,#1
0003e6  eb000142          ADD      r1,r0,r2,LSL #1
0003ea  f04f0202          MOV      r2,#2
0003ee  466d              MOV      r5,sp
0003f0  a801              ADD      r0,sp,#4
0003f2  f7fffffe          BL       mem_copy
;;;411    
;;;412    crc_temp=CRC16_2(modbus_tx_buff,6);
0003f6  2106              MOVS     r1,#6
0003f8  4668              MOV      r0,sp
0003fa  f7fffffe          BL       CRC16_2
;;;413    
;;;414    modbus_tx_buff[6]=crc_temp%256;
0003fe  f88d0006          STRB     r0,[sp,#6]
;;;415    modbus_tx_buff[7]=crc_temp/256;
000402  e03f              B        |L2.1156|
                  |L2.1028|
                          DCD      load_U
                  |L2.1032|
                          DCD      load_I
                  |L2.1036|
                          DCD      Ib_ips_termokompensat
                  |L2.1040|
                          DCD      t_ext
                  |L2.1044|
                          DCD      net_Ua
                  |L2.1048|
                          DCD      net_Ub
                  |L2.1052|
                          DCD      net_Uc
                  |L2.1056|
                          DCD      net_F3
                  |L2.1060|
                          DCD      0x40024020
                  |L2.1064|
                          DCD      NUMIST
                  |L2.1068|
                          DCD      PAR
                  |L2.1072|
                          DCD      ZV_ON
                  |L2.1076|
                          DCD      TERMOKOMPENS
                  |L2.1080|
                          DCD      UBM_AV
                  |L2.1084|
                          DCD      TBAT
                  |L2.1088|
                          DCD      UMAX
                  |L2.1092|
                          DCD      UB20
                  |L2.1096|
                          DCD      ||DU||
                  |L2.1100|
                          DCD      UB0
                  |L2.1104|
                          DCD      USIGN
                  |L2.1108|
                          DCD      UMN
                  |L2.1112|
                          DCD      U0B
                  |L2.1116|
                          DCD      IKB
                  |L2.1120|
                          DCD      IZMAX
                  |L2.1124|
                          DCD      IMAX
                  |L2.1128|
                          DCD      IMIN
                  |L2.1132|
                          DCD      UVZ
                  |L2.1136|
                          DCD      TZAS
                  |L2.1140|
                          DCD      TMAX
                  |L2.1144|
                          DCD      TSIGN
                  |L2.1148|
                          DCD      TBATMAX
                  |L2.1152|
                          DCD      TBATSIGN
                  |L2.1156|
000484  0a00              LSRS     r0,r0,#8
000486  f88d0007          STRB     r0,[sp,#7]
;;;416    
;;;417    for (i=0;i<8;i++)
00048a  2400              MOVS     r4,#0
                  |L2.1164|
;;;418    	{
;;;419    	putchar0(modbus_tx_buff[i]);
00048c  5d28              LDRB     r0,[r5,r4]
00048e  f7fffffe          BL       putchar0
000492  1c64              ADDS     r4,r4,#1              ;417
000494  b2e4              UXTB     r4,r4                 ;417
000496  2c08              CMP      r4,#8                 ;417
000498  d3f8              BCC      |L2.1164|
;;;420    	}
;;;421    for (i=0;i<8;i++)
00049a  2400              MOVS     r4,#0
                  |L2.1180|
;;;422    	{
;;;423    	putchar_sc16is700(modbus_tx_buff[i]);
00049c  5d28              LDRB     r0,[r5,r4]
00049e  f7fffffe          BL       putchar_sc16is700
0004a2  1c64              ADDS     r4,r4,#1              ;421
0004a4  b2e4              UXTB     r4,r4                 ;421
0004a6  2c08              CMP      r4,#8                 ;421
0004a8  d3f8              BCC      |L2.1180|
;;;424    	}
;;;425    }
0004aa  b033              ADD      sp,sp,#0xcc
0004ac  bdf0              POP      {r4-r7,pc}
;;;426    
                          ENDP


                          AREA ||area_number.3||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.3||, ||.text||
                  modbus_registers_transmit PROC
;;;285    //-----------------------------------------------
;;;286    void modbus_register_transmit(unsigned char adr,unsigned char func,unsigned short reg_adr)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;287    {
;;;288    char modbus_registers[150];
;;;289    char modbus_tx_buff[50];
;;;290    unsigned short crc_temp;
;;;291    char i;
;;;292    
;;;293    
;;;294    modbus_registers[0]=(char)(load_U/256);					//Πεγ1
000004  b0b2              SUB      sp,sp,#0xc8
000006  461f              MOV      r7,r3
000008  4bff              LDR      r3,|L3.1032|
00000a  f9b33000          LDRSH    r3,[r3,#0]  ; load_U
00000e  17dc              ASRS     r4,r3,#31
000010  eb036414          ADD      r4,r3,r4,LSR #24
000014  1225              ASRS     r5,r4,#8
;;;295    modbus_registers[1]=(char)(load_U%256);
000016  f88d5064          STRB     r5,[sp,#0x64]
;;;296    modbus_registers[2]=(char)(load_I/256);					//Πεγ2
00001a  f88d3065          STRB     r3,[sp,#0x65]
00001e  4bfb              LDR      r3,|L3.1036|
000020  f9b34000          LDRSH    r4,[r3,#0]  ; load_I
000024  17e3              ASRS     r3,r4,#31
000026  eb046513          ADD      r5,r4,r3,LSR #24
00002a  f3c52307          UBFX     r3,r5,#8,#8
;;;297    modbus_registers[3]=(char)(load_I%256);
00002e  f88d3066          STRB     r3,[sp,#0x66]
000032  b2e4              UXTB     r4,r4
;;;298    modbus_registers[4]=(char)(Ib_ips_termokompensat/256);		//Πεγ3
000034  f88d4067          STRB     r4,[sp,#0x67]
000038  4df5              LDR      r5,|L3.1040|
00003a  f9b55000          LDRSH    r5,[r5,#0]  ; Ib_ips_termokompensat
00003e  17ee              ASRS     r6,r5,#31
000040  eb056616          ADD      r6,r5,r6,LSR #24
000044  ea4f2c26          ASR      r12,r6,#8
;;;299    modbus_registers[5]=(char)(Ib_ips_termokompensat%256);
000048  f88dc068          STRB     r12,[sp,#0x68]
;;;300    modbus_registers[6]=(char)(t_ext[0]/256);				//Πεγ4
00004c  f88d5069          STRB     r5,[sp,#0x69]
000050  4df0              LDR      r5,|L3.1044|
000052  f9b55000          LDRSH    r5,[r5,#0]  ; t_ext
000056  17ee              ASRS     r6,r5,#31
000058  eb056616          ADD      r6,r5,r6,LSR #24
;;;301    modbus_registers[7]=(char)(t_ext[0]%256);
00005c  ea4f2c26          ASR      r12,r6,#8
;;;302    modbus_registers[8]=(char)(net_Ua/256);					//Πεγ5
000060  f88dc06a          STRB     r12,[sp,#0x6a]
000064  f88d506b          STRB     r5,[sp,#0x6b]
000068  4deb              LDR      r5,|L3.1048|
00006a  f9b55000          LDRSH    r5,[r5,#0]  ; net_Ua
00006e  17ee              ASRS     r6,r5,#31
000070  eb056616          ADD      r6,r5,r6,LSR #24
;;;303    modbus_registers[9]=(char)(net_Ua%256);		 	
000074  ea4f2c26          ASR      r12,r6,#8
;;;304    modbus_registers[10]=(char)(net_Ub/256);				//Πεγ6
000078  f88dc06c          STRB     r12,[sp,#0x6c]
00007c  f88d506d          STRB     r5,[sp,#0x6d]
000080  4de6              LDR      r5,|L3.1052|
000082  f9b55000          LDRSH    r5,[r5,#0]  ; net_Ub
000086  17ee              ASRS     r6,r5,#31
;;;305    modbus_registers[11]=(char)(net_Ub%256);
000088  eb056616          ADD      r6,r5,r6,LSR #24
;;;306    modbus_registers[12]=(char)(net_Uc/256);				//Πεγ7
00008c  ea4f2c26          ASR      r12,r6,#8
000090  f88dc06e          STRB     r12,[sp,#0x6e]
000094  f88d506f          STRB     r5,[sp,#0x6f]
000098  4de1              LDR      r5,|L3.1056|
00009a  f9b55000          LDRSH    r5,[r5,#0]  ; net_Uc
;;;307    modbus_registers[13]=(char)(net_Uc%256);
00009e  17ee              ASRS     r6,r5,#31
0000a0  eb056616          ADD      r6,r5,r6,LSR #24
;;;308    modbus_registers[14]=(char)(net_F3/256);				//Πεγ8
0000a4  ea4f2c26          ASR      r12,r6,#8
0000a8  f88dc070          STRB     r12,[sp,#0x70]
0000ac  f88d5071          STRB     r5,[sp,#0x71]
0000b0  4ddc              LDR      r5,|L3.1060|
0000b2  f9b55000          LDRSH    r5,[r5,#0]  ; net_F3
;;;309    modbus_registers[15]=(char)(net_F3%256);
0000b6  17ee              ASRS     r6,r5,#31
;;;310    modbus_registers[16]=(char)(load_I/256);				//Πεγ9
0000b8  eb056616          ADD      r6,r5,r6,LSR #24
;;;311    modbus_registers[17]=(char)(load_I%256);
0000bc  ea4f2c26          ASR      r12,r6,#8
;;;312    modbus_registers[18]=(char)(load_I/256);				//Πεγ10
0000c0  f88dc072          STRB     r12,[sp,#0x72]
;;;313    modbus_registers[19]=(char)(load_I%256);
0000c4  f88d5073          STRB     r5,[sp,#0x73]
;;;314    modbus_registers[20]=(char)((LPC_RTC->YEAR)/256);			//Πεγ11
0000c8  f88d3074          STRB     r3,[sp,#0x74]
0000cc  f88d4075          STRB     r4,[sp,#0x75]
0000d0  f88d3076          STRB     r3,[sp,#0x76]
;;;315    modbus_registers[21]=(char)((LPC_RTC->YEAR)%256);
0000d4  f88d4077          STRB     r4,[sp,#0x77]
0000d8  4dd3              LDR      r5,|L3.1064|
;;;316    modbus_registers[22]=(char)((LPC_RTC->MONTH)/256);		//Πεγ12
0000da  8bae              LDRH     r6,[r5,#0x1c]
0000dc  ea4f2616          LSR      r6,r6,#8
0000e0  f88d6078          STRB     r6,[sp,#0x78]
;;;317    modbus_registers[23]=(char)((LPC_RTC->MONTH)%256);
0000e4  8bae              LDRH     r6,[r5,#0x1c]
0000e6  f88d6079          STRB     r6,[sp,#0x79]
;;;318    modbus_registers[24]=(char)((LPC_RTC->DOM)/256);			//Πεγ13
0000ea  7e2e              LDRB     r6,[r5,#0x18]
0000ec  f04f0600          MOV      r6,#0
;;;319    modbus_registers[25]=(char)((LPC_RTC->DOM)%256);
0000f0  f88d607a          STRB     r6,[sp,#0x7a]
0000f4  f895c018          LDRB     r12,[r5,#0x18]
;;;320    modbus_registers[26]=(char)((LPC_RTC->HOUR)/256);			//Πεγ14
0000f8  f88dc07b          STRB     r12,[sp,#0x7b]
;;;321    modbus_registers[27]=(char)((LPC_RTC->HOUR)%256);
0000fc  f895c00c          LDRB     r12,[r5,#0xc]
000100  f88d607c          STRB     r6,[sp,#0x7c]
;;;322    modbus_registers[28]=(char)((LPC_RTC->MIN)/256);			//Πεγ15
000104  f895c00c          LDRB     r12,[r5,#0xc]
;;;323    modbus_registers[29]=(char)((LPC_RTC->MIN)%256);
000108  f88dc07d          STRB     r12,[sp,#0x7d]
00010c  f895c008          LDRB     r12,[r5,#8]
;;;324    modbus_registers[30]=(char)((LPC_RTC->SEC)/256);			//Πεγ16
000110  f88d607e          STRB     r6,[sp,#0x7e]
;;;325    modbus_registers[31]=(char)((LPC_RTC->SEC)%256);
000114  f895c008          LDRB     r12,[r5,#8]
000118  f88dc07f          STRB     r12,[sp,#0x7f]
;;;326    modbus_registers[32]=(char)(load_I/256);				//Πεγ17
00011c  f895c004          LDRB     r12,[r5,#4]
;;;327    modbus_registers[33]=(char)(load_I%256);
000120  f88d6080          STRB     r6,[sp,#0x80]
;;;328    modbus_registers[34]=(char)(load_I/256);				//Πεγ18
000124  f895c004          LDRB     r12,[r5,#4]
;;;329    modbus_registers[35]=(char)(load_I%256);
000128  f88dc081          STRB     r12,[sp,#0x81]
;;;330    modbus_registers[36]=(char)(load_I/256);		//Πεγ19
00012c  f895c000          LDRB     r12,[r5,#0]
;;;331    modbus_registers[37]=(char)(load_I%256);
000130  f88d6082          STRB     r6,[sp,#0x82]
;;;332    modbus_registers[38]=(char)(NUMIST/256);		//Πεγ20
000134  782d              LDRB     r5,[r5,#0]
000136  f88d5083          STRB     r5,[sp,#0x83]
00013a  f88d3084          STRB     r3,[sp,#0x84]
00013e  f88d4085          STRB     r4,[sp,#0x85]
000142  f88d3086          STRB     r3,[sp,#0x86]
000146  f88d4087          STRB     r4,[sp,#0x87]
;;;333    modbus_registers[39]=(char)(NUMIST%256);
00014a  f88d3088          STRB     r3,[sp,#0x88]
;;;334    modbus_registers[40]=(char)(PAR/256);		//Πεγ21
00014e  f88d4089          STRB     r4,[sp,#0x89]
000152  4db6              LDR      r5,|L3.1068|
000154  f9b55000          LDRSH    r5,[r5,#0]  ; NUMIST
000158  ea4f76e5          ASR      r6,r5,#31
00015c  eb056616          ADD      r6,r5,r6,LSR #24
000160  ea4f2c26          ASR      r12,r6,#8
;;;335    modbus_registers[41]=(char)(PAR%256);
000164  f88dc08a          STRB     r12,[sp,#0x8a]
;;;336    modbus_registers[42]=(char)(ZV_ON/256);		//Πεγ22
000168  f88d508b          STRB     r5,[sp,#0x8b]
00016c  4db0              LDR      r5,|L3.1072|
00016e  f9b55000          LDRSH    r5,[r5,#0]  ; PAR
000172  ea4f76e5          ASR      r6,r5,#31
000176  eb056616          ADD      r6,r5,r6,LSR #24
00017a  ea4f2c26          ASR      r12,r6,#8
;;;337    modbus_registers[43]=(char)(ZV_ON%256);
00017e  f88dc08c          STRB     r12,[sp,#0x8c]
;;;338    modbus_registers[44]=(char)(TERMOKOMPENS/256);		//Πεγ23
000182  f88d508d          STRB     r5,[sp,#0x8d]
000186  4dab              LDR      r5,|L3.1076|
000188  f9b55000          LDRSH    r5,[r5,#0]  ; ZV_ON
00018c  ea4f76e5          ASR      r6,r5,#31
000190  eb056616          ADD      r6,r5,r6,LSR #24
000194  ea4f2c26          ASR      r12,r6,#8
;;;339    modbus_registers[45]=(char)(TERMOKOMPENS%256);
000198  f88dc08e          STRB     r12,[sp,#0x8e]
;;;340    modbus_registers[46]=(char)(UBM_AV/256);		//Πεγ24
00019c  f88d508f          STRB     r5,[sp,#0x8f]
0001a0  4da5              LDR      r5,|L3.1080|
0001a2  f9b55000          LDRSH    r5,[r5,#0]  ; TERMOKOMPENS
0001a6  ea4f76e5          ASR      r6,r5,#31
0001aa  eb056616          ADD      r6,r5,r6,LSR #24
0001ae  ea4f2c26          ASR      r12,r6,#8
;;;341    modbus_registers[47]=(char)(UBM_AV%256);
0001b2  f88dc090          STRB     r12,[sp,#0x90]
;;;342    modbus_registers[48]=(char)(load_I/256);		//Πεγ25
0001b6  f88d5091          STRB     r5,[sp,#0x91]
;;;343    modbus_registers[49]=(char)(load_I%256);
0001ba  4da0              LDR      r5,|L3.1084|
;;;344    modbus_registers[50]=(char)(load_I/256);		//Πεγ26
0001bc  f9b55000          LDRSH    r5,[r5,#0]  ; UBM_AV
;;;345    modbus_registers[51]=(char)(load_I%256);
0001c0  ea4f76e5          ASR      r6,r5,#31
;;;346    modbus_registers[52]=(char)(load_I/256);		//Πεγ27
0001c4  eb056616          ADD      r6,r5,r6,LSR #24
;;;347    modbus_registers[53]=(char)(load_I%256);
0001c8  ea4f2c26          ASR      r12,r6,#8
;;;348    modbus_registers[54]=(char)(load_I/256);		//Πεγ28
0001cc  f88dc092          STRB     r12,[sp,#0x92]
;;;349    modbus_registers[55]=(char)(load_I%256);
0001d0  f88d5093          STRB     r5,[sp,#0x93]
;;;350    modbus_registers[56]=(char)(load_I/256);		//Πεγ29
0001d4  f88d3094          STRB     r3,[sp,#0x94]
;;;351    modbus_registers[57]=(char)(load_I%256);
0001d8  f88d4095          STRB     r4,[sp,#0x95]
;;;352    modbus_registers[58]=(char)(TBAT/256);			//Πεγ30
0001dc  f88d3096          STRB     r3,[sp,#0x96]
0001e0  f88d4097          STRB     r4,[sp,#0x97]
0001e4  f88d3098          STRB     r3,[sp,#0x98]
0001e8  f88d4099          STRB     r4,[sp,#0x99]
0001ec  f88d309a          STRB     r3,[sp,#0x9a]
0001f0  f88d409b          STRB     r4,[sp,#0x9b]
;;;353    modbus_registers[59]=(char)(TBAT%256);
0001f4  f88d309c          STRB     r3,[sp,#0x9c]
;;;354    modbus_registers[60]=(char)(UMAX/256);			//Πεγ31
0001f8  f88d409d          STRB     r4,[sp,#0x9d]
0001fc  4d90              LDR      r5,|L3.1088|
0001fe  f9b55000          LDRSH    r5,[r5,#0]  ; TBAT
000202  ea4f76e5          ASR      r6,r5,#31
000206  eb056616          ADD      r6,r5,r6,LSR #24
00020a  ea4f2c26          ASR      r12,r6,#8
;;;355    modbus_registers[61]=(char)(UMAX%256);
00020e  f88dc09e          STRB     r12,[sp,#0x9e]
;;;356    modbus_registers[62]=(char)((UB20-DU)/256);		//Πεγ32
000212  f88d509f          STRB     r5,[sp,#0x9f]
000216  4d8b              LDR      r5,|L3.1092|
000218  f9b55000          LDRSH    r5,[r5,#0]  ; UMAX
00021c  ea4f76e5          ASR      r6,r5,#31
000220  eb056616          ADD      r6,r5,r6,LSR #24
000224  ea4f2c26          ASR      r12,r6,#8
000228  f88dc0a0          STRB     r12,[sp,#0xa0]
00022c  f88d50a1          STRB     r5,[sp,#0xa1]
;;;357    modbus_registers[63]=(char)((UB20-DU)%256);
000230  4d85              LDR      r5,|L3.1096|
000232  4e86              LDR      r6,|L3.1100|
;;;358    modbus_registers[64]=(char)(UB0/256);			//Πεγ33
000234  f9b55000          LDRSH    r5,[r5,#0]  ; UB20
000238  f9b66000          LDRSH    r6,[r6,#0]  ; DU
00023c  eba50606          SUB      r6,r5,r6
000240  ea4f7ce6          ASR      r12,r6,#31
000244  eb066c1c          ADD      r12,r6,r12,LSR #24
000248  ea4f282c          ASR      r8,r12,#8
;;;359    modbus_registers[65]=(char)(UB0%256);
00024c  f88d80a2          STRB     r8,[sp,#0xa2]
;;;360    modbus_registers[66]=(char)(UB20/256);			//Πεγ34
000250  f88d60a3          STRB     r6,[sp,#0xa3]
000254  4e7e              LDR      r6,|L3.1104|
000256  f9b66000          LDRSH    r6,[r6,#0]  ; UB0
00025a  ea4f7ce6          ASR      r12,r6,#31
;;;361    modbus_registers[67]=(char)(UB20%256);
00025e  eb066c1c          ADD      r12,r6,r12,LSR #24
;;;362    modbus_registers[68]=(char)(USIGN/256);		//Πεγ35
000262  ea4f282c          ASR      r8,r12,#8
000266  f88d80a4          STRB     r8,[sp,#0xa4]
00026a  f88d60a5          STRB     r6,[sp,#0xa5]
00026e  ea4f76e5          ASR      r6,r5,#31
000272  eb056616          ADD      r6,r5,r6,LSR #24
000276  ea4f2c26          ASR      r12,r6,#8
;;;363    modbus_registers[69]=(char)(USIGN%256);
00027a  f88dc0a6          STRB     r12,[sp,#0xa6]
;;;364    modbus_registers[70]=(char)(UMN/256);		//Πεγ36
00027e  f88d50a7          STRB     r5,[sp,#0xa7]
000282  4d74              LDR      r5,|L3.1108|
000284  f9b55000          LDRSH    r5,[r5,#0]  ; USIGN
000288  ea4f76e5          ASR      r6,r5,#31
00028c  eb056616          ADD      r6,r5,r6,LSR #24
000290  ea4f2c26          ASR      r12,r6,#8
;;;365    modbus_registers[71]=(char)(UMN%256);
000294  f88dc0a8          STRB     r12,[sp,#0xa8]
;;;366    modbus_registers[72]=(char)(U0B/256);		//Πεγ37
000298  f88d50a9          STRB     r5,[sp,#0xa9]
00029c  4d6e              LDR      r5,|L3.1112|
00029e  f9b55000          LDRSH    r5,[r5,#0]  ; UMN
0002a2  ea4f76e5          ASR      r6,r5,#31
0002a6  eb056616          ADD      r6,r5,r6,LSR #24
0002aa  ea4f2c26          ASR      r12,r6,#8
;;;367    modbus_registers[73]=(char)(U0B%256);
0002ae  f88dc0aa          STRB     r12,[sp,#0xaa]
;;;368    modbus_registers[74]=(char)(IKB/256);		//Πεγ38
0002b2  f88d50ab          STRB     r5,[sp,#0xab]
0002b6  4d69              LDR      r5,|L3.1116|
0002b8  f9b55000          LDRSH    r5,[r5,#0]  ; U0B
0002bc  ea4f76e5          ASR      r6,r5,#31
0002c0  eb056616          ADD      r6,r5,r6,LSR #24
0002c4  ea4f2c26          ASR      r12,r6,#8
;;;369    modbus_registers[75]=(char)(IKB%256);
0002c8  f88dc0ac          STRB     r12,[sp,#0xac]
;;;370    modbus_registers[76]=(char)(IZMAX/256);		//Πεγ39
0002cc  f88d50ad          STRB     r5,[sp,#0xad]
0002d0  4d63              LDR      r5,|L3.1120|
0002d2  f9b55000          LDRSH    r5,[r5,#0]  ; IKB
0002d6  ea4f76e5          ASR      r6,r5,#31
0002da  eb056616          ADD      r6,r5,r6,LSR #24
0002de  ea4f2c26          ASR      r12,r6,#8
;;;371    modbus_registers[77]=(char)(IZMAX%256);
0002e2  f88dc0ae          STRB     r12,[sp,#0xae]
;;;372    modbus_registers[78]=(char)(IMAX/256);		//Πεγ40
0002e6  f88d50af          STRB     r5,[sp,#0xaf]
0002ea  4d5e              LDR      r5,|L3.1124|
0002ec  f9b55000          LDRSH    r5,[r5,#0]  ; IZMAX
0002f0  ea4f76e5          ASR      r6,r5,#31
0002f4  eb056616          ADD      r6,r5,r6,LSR #24
0002f8  ea4f2c26          ASR      r12,r6,#8
;;;373    modbus_registers[79]=(char)(IMAX%256);
0002fc  f88dc0b0          STRB     r12,[sp,#0xb0]
;;;374    modbus_registers[80]=(char)(IMIN/256);		//Πεγ41
000300  f88d50b1          STRB     r5,[sp,#0xb1]
000304  4d58              LDR      r5,|L3.1128|
000306  f9b55000          LDRSH    r5,[r5,#0]  ; IMAX
00030a  ea4f76e5          ASR      r6,r5,#31
00030e  eb056616          ADD      r6,r5,r6,LSR #24
000312  ea4f2c26          ASR      r12,r6,#8
;;;375    modbus_registers[81]=(char)(IMIN%256);
000316  f88dc0b2          STRB     r12,[sp,#0xb2]
;;;376    modbus_registers[82]=(char)(UVZ/256);		//Πεγ42
00031a  f88d50b3          STRB     r5,[sp,#0xb3]
00031e  4d53              LDR      r5,|L3.1132|
000320  f9b55000          LDRSH    r5,[r5,#0]  ; IMIN
000324  ea4f76e5          ASR      r6,r5,#31
000328  eb056616          ADD      r6,r5,r6,LSR #24
00032c  ea4f2c26          ASR      r12,r6,#8
;;;377    modbus_registers[83]=(char)(UVZ%256);
000330  f88dc0b4          STRB     r12,[sp,#0xb4]
;;;378    modbus_registers[84]=(char)(TZAS/256);		//Πεγ43
000334  f88d50b5          STRB     r5,[sp,#0xb5]
000338  4d4d              LDR      r5,|L3.1136|
00033a  f9b55000          LDRSH    r5,[r5,#0]  ; UVZ
00033e  ea4f76e5          ASR      r6,r5,#31
000342  eb056616          ADD      r6,r5,r6,LSR #24
000346  ea4f2c26          ASR      r12,r6,#8
;;;379    modbus_registers[85]=(char)(TZAS%256);
00034a  f88dc0b6          STRB     r12,[sp,#0xb6]
;;;380    modbus_registers[86]=(char)(TMAX/256);		//Πεγ44
00034e  f88d50b7          STRB     r5,[sp,#0xb7]
000352  4d48              LDR      r5,|L3.1140|
000354  f9b55000          LDRSH    r5,[r5,#0]  ; TZAS
000358  ea4f76e5          ASR      r6,r5,#31
00035c  eb056616          ADD      r6,r5,r6,LSR #24
000360  ea4f2c26          ASR      r12,r6,#8
;;;381    modbus_registers[87]=(char)(TMAX%256);
000364  f88dc0b8          STRB     r12,[sp,#0xb8]
;;;382    modbus_registers[88]=(char)(TSIGN/256);		//Πεγ45
000368  f88d50b9          STRB     r5,[sp,#0xb9]
00036c  4d42              LDR      r5,|L3.1144|
00036e  f9b55000          LDRSH    r5,[r5,#0]  ; TMAX
000372  ea4f76e5          ASR      r6,r5,#31
000376  eb056616          ADD      r6,r5,r6,LSR #24
00037a  ea4f2c26          ASR      r12,r6,#8
;;;383    modbus_registers[89]=(char)(TSIGN%256);
00037e  f88dc0ba          STRB     r12,[sp,#0xba]
;;;384    modbus_registers[90]=(char)(TBATMAX/256);		//Πεγ46
000382  f88d50bb          STRB     r5,[sp,#0xbb]
000386  4d3d              LDR      r5,|L3.1148|
000388  f9b55000          LDRSH    r5,[r5,#0]  ; TSIGN
00038c  ea4f76e5          ASR      r6,r5,#31
000390  eb056616          ADD      r6,r5,r6,LSR #24
000394  ea4f2c26          ASR      r12,r6,#8
;;;385    modbus_registers[91]=(char)(TBATMAX%256);
000398  f88dc0bc          STRB     r12,[sp,#0xbc]
;;;386    modbus_registers[92]=(char)(TBATSIGN/256);		//Πεγ47
00039c  f88d50bd          STRB     r5,[sp,#0xbd]
0003a0  4d37              LDR      r5,|L3.1152|
0003a2  f9b55000          LDRSH    r5,[r5,#0]  ; TBATMAX
0003a6  ea4f76e5          ASR      r6,r5,#31
0003aa  eb056616          ADD      r6,r5,r6,LSR #24
0003ae  ea4f2c26          ASR      r12,r6,#8
;;;387    modbus_registers[93]=(char)(TBATSIGN%256);
0003b2  f88dc0be          STRB     r12,[sp,#0xbe]
;;;388    modbus_registers[94]=(char)(load_I/256);		//Πεγ48
0003b6  f88d50bf          STRB     r5,[sp,#0xbf]
;;;389    modbus_registers[95]=(char)(load_I%256);
0003ba  4d32              LDR      r5,|L3.1156|
;;;390    modbus_registers[96]=(char)(load_I/256);		//Πεγ49
0003bc  f9b55000          LDRSH    r5,[r5,#0]  ; TBATSIGN
;;;391    modbus_registers[97]=(char)(load_I%256);
0003c0  ea4f76e5          ASR      r6,r5,#31
;;;392    modbus_registers[98]=(char)(load_I/256);		//Πεγ50
0003c4  eb056616          ADD      r6,r5,r6,LSR #24
;;;393    modbus_registers[99]=(char)(load_I%256);
0003c8  ea4f2c26          ASR      r12,r6,#8
;;;394    
;;;395    modbus_tx_buff[0]=adr;
0003cc  f88dc0c0          STRB     r12,[sp,#0xc0]
;;;396    modbus_tx_buff[1]=func;
0003d0  f88d50c1          STRB     r5,[sp,#0xc1]
;;;397    modbus_tx_buff[2]=(char)(reg_adr/256);
0003d4  f88d30c2          STRB     r3,[sp,#0xc2]
0003d8  f88d40c3          STRB     r4,[sp,#0xc3]
;;;398    modbus_tx_buff[3]=(char)(reg_adr%256);
0003dc  f88d30c4          STRB     r3,[sp,#0xc4]
;;;399    //modbus_tx_buff[4]=(char)(reg_quantity/256);
;;;400    //modbus_tx_buff[5]=(char)(reg_quantity%256);
;;;401    /*
;;;402    modbus_registers[0]=0x10;
;;;403    modbus_registers[1]=0x11;
;;;404    modbus_registers[2]=0x12;
;;;405    modbus_registers[3]=0x13;
;;;406    modbus_registers[4]=0x14;
;;;407    modbus_registers[5]=0x15;
;;;408    */
;;;409    
;;;410    mem_copy((char*)&modbus_tx_buff[4],(char*)&modbus_registers[(reg_adr-1)*2],2);
0003e0  f88d40c5          STRB     r4,[sp,#0xc5]
0003e4  f88d30c6          STRB     r3,[sp,#0xc6]
0003e8  f88d40c7          STRB     r4,[sp,#0xc7]
0003ec  f88d0000          STRB     r0,[sp,#0]
0003f0  f88d1001          STRB     r1,[sp,#1]
0003f4  ea4f0047          LSL      r0,r7,#1
;;;411    
;;;412    crc_temp=CRC16_2(modbus_tx_buff,6);
0003f8  f88d0002          STRB     r0,[sp,#2]
0003fc  a919              ADD      r1,sp,#0x64
;;;413    
;;;414    modbus_tx_buff[6]=crc_temp%256;
0003fe  f1a20201          SUB      r2,r2,#1
;;;415    modbus_tx_buff[7]=crc_temp/256;
000402  eb010142          ADD      r1,r1,r2,LSL #1
000406  e03f              B        |L3.1160|
                  |L3.1032|
                          DCD      load_U
                  |L3.1036|
                          DCD      load_I
                  |L3.1040|
                          DCD      Ib_ips_termokompensat
                  |L3.1044|
                          DCD      t_ext
                  |L3.1048|
                          DCD      net_Ua
                  |L3.1052|
                          DCD      net_Ub
                  |L3.1056|
                          DCD      net_Uc
                  |L3.1060|
                          DCD      net_F3
                  |L3.1064|
                          DCD      0x40024020
                  |L3.1068|
                          DCD      NUMIST
                  |L3.1072|
                          DCD      PAR
                  |L3.1076|
                          DCD      ZV_ON
                  |L3.1080|
                          DCD      TERMOKOMPENS
                  |L3.1084|
                          DCD      UBM_AV
                  |L3.1088|
                          DCD      TBAT
                  |L3.1092|
                          DCD      UMAX
                  |L3.1096|
                          DCD      UB20
                  |L3.1100|
                          DCD      ||DU||
                  |L3.1104|
                          DCD      UB0
                  |L3.1108|
                          DCD      USIGN
                  |L3.1112|
                          DCD      UMN
                  |L3.1116|
                          DCD      U0B
                  |L3.1120|
                          DCD      IKB
                  |L3.1124|
                          DCD      IZMAX
                  |L3.1128|
                          DCD      IMAX
                  |L3.1132|
                          DCD      IMIN
                  |L3.1136|
                          DCD      UVZ
                  |L3.1140|
                          DCD      TZAS
                  |L3.1144|
                          DCD      TMAX
                  |L3.1148|
                          DCD      TSIGN
                  |L3.1152|
                          DCD      TBATMAX
                  |L3.1156|
                          DCD      TBATSIGN
                  |L3.1160|
000488  4602              MOV      r2,r0
;;;416    
;;;417    for (i=0;i<8;i++)
00048a  466d              MOV      r5,sp
;;;418    	{
;;;419    	putchar0(modbus_tx_buff[i]);
00048c  466c              MOV      r4,sp
00048e  f10d0003          ADD      r0,sp,#3
000492  f7fffffe          BL       mem_copy
000496  2003              MOVS     r0,#3                 ;417
000498  eb000047          ADD      r0,r0,r7,LSL #1       ;417
;;;420    	}
;;;421    for (i=0;i<8;i++)
;;;422    	{
;;;423    	putchar_sc16is700(modbus_tx_buff[i]);
00049c  b201              SXTH     r1,r0
00049e  4668              MOV      r0,sp
0004a0  f7fffffe          BL       CRC16_2
0004a4  eb040147          ADD      r1,r4,r7,LSL #1       ;421
0004a8  70c8              STRB     r0,[r1,#3]            ;421
;;;424    	}
;;;425    }
0004aa  0a00              LSRS     r0,r0,#8
0004ac  7108              STRB     r0,[r1,#4]
0004ae  2400              MOVS     r4,#0
                  |L3.1200|
0004b0  5d28              LDRB     r0,[r5,r4]
0004b2  f7fffffe          BL       putchar0
0004b6  1c64              ADDS     r4,r4,#1
0004b8  b2e4              UXTB     r4,r4
0004ba  2c0f              CMP      r4,#0xf
0004bc  d3f8              BCC      |L3.1200|
0004be  2400              MOVS     r4,#0
                  |L3.1216|
0004c0  5d28              LDRB     r0,[r5,r4]
0004c2  f7fffffe          BL       putchar_sc16is700
0004c6  1c64              ADDS     r4,r4,#1
0004c8  b2e4              UXTB     r4,r4
0004ca  2c0f              CMP      r4,#0xf
0004cc  d3f8              BCC      |L3.1216|
0004ce  b032              ADD      sp,sp,#0xc8
0004d0  e8bd81f0          POP      {r4-r8,pc}
;;;426    
                          ENDP


                          AREA ||.bss||, DATA, NOINIT, ALIGN=0

                  modbus_buf
                          %        20

                          AREA ||area_number.6||, DATA, NOINIT, ALIGN=0

                          EXPORTAS ||area_number.6||, ||.bss||
                  modbus_rx_buffer
                          %        30
                  modbus_an_buffer
                          %        30

                          AREA ||.data||, DATA, ALIGN=1

                  modbus_crc16
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.9||, DATA, ALIGN=0

                          EXPORTAS ||area_number.9||, ||.data||
                  modbus_timeout_cnt
000000  00                DCB      0x00

                          AREA ||area_number.10||, DATA, ALIGN=1

                          EXPORTAS ||area_number.10||, ||.data||
                  bMODBUS_TIMEOUT
000000  00                DCB      0x00
                  modbus_rx_buffer_ptr
000001  00                DCB      0x00
                  modbus_rx_counter
000002  0000              DCB      0x00,0x00
                  modbus_plazma
000004  0000              DCB      0x00,0x00
                  modbus_plazma1
000006  0000              DCB      0x00,0x00
                  modbus_plazma2
000008  0000              DCB      0x00,0x00
                  modbus_plazma3
00000a  0000              DCB      0x00,0x00

                          AREA ||area_number.11||, DATA, ALIGN=1

                          EXPORTAS ||area_number.11||, ||.data||
                  modbus_rx_arg0
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.12||, DATA, ALIGN=1

                          EXPORTAS ||area_number.12||, ||.data||
                  modbus_rx_arg1
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.13||, DATA, ALIGN=1

                          EXPORTAS ||area_number.13||, ||.data||
                  modbus_rx_arg2
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.14||, DATA, ALIGN=1

                          EXPORTAS ||area_number.14||, ||.data||
                  modbus_rx_arg3
000000  0000              DCB      0x00,0x00
