; generated by ARM C/C++ Compiler, 4.1 [Build 481]
; commandline ArmCC [--debug -c --asm --interleave -o.\EXE\avar_hndl.o --depend=.\EXE\avar_hndl.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\INC -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x --omf_browse=.\EXE\avar_hndl.crf avar_hndl.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  avar_hndl PROC
;;;75     //-----------------------------------------------
;;;76     void avar_hndl(void)
000000  b530              PUSH     {r4,r5,lr}
;;;77     {
;;;78     //static unsigned avar_stat_old;
;;;79     char i;
;;;80     //unsigned avar_stat_new,avar_stat_offed;
;;;81     
;;;82     if(net_av)		SET_REG(avar_stat,1,0,1);
000002  48ff              LDR      r0,|L1.1024|
000004  49ff              LDR      r1,|L1.1028|
000006  7802              LDRB     r2,[r0,#0]  ; net_av
000008  6808              LDR      r0,[r1,#0]
00000a  b11a              CBZ      r2,|L1.20|
00000c  f0400001          ORR      r0,r0,#1
000010  6008              STR      r0,[r1,#0]  ; avar_stat
000012  e002              B        |L1.26|
                  |L1.20|
;;;83     else	   			SET_REG(avar_stat,0,0,1);
000014  f0200001          BIC      r0,r0,#1
000018  6008              STR      r0,[r1,#0]  ; avar_stat
                  |L1.26|
;;;84     
;;;85     for(i=0;i<2;i++)
00001a  2000              MOVS     r0,#0
;;;86     	{
;;;87     	if(bat[i]._av&1)	SET_REG(avar_stat,1,1+i,1);
00001c  4dfa              LDR      r5,|L1.1032|
00001e  2401              MOVS     r4,#1
                  |L1.32|
000020  eb000240          ADD      r2,r0,r0,LSL #1
000024  eb021200          ADD      r2,r2,r0,LSL #4
000028  eb050282          ADD      r2,r5,r2,LSL #2
00002c  f892203d          LDRB     r2,[r2,#0x3d]
000030  07d2              LSLS     r2,r2,#31
000032  d007              BEQ      |L1.68|
000034  1c43              ADDS     r3,r0,#1
000036  fa04f203          LSL      r2,r4,r3
00003a  680b              LDR      r3,[r1,#0]  ; avar_stat
00003c  4393              BICS     r3,r3,r2
00003e  4313              ORRS     r3,r3,r2
000040  600b              STR      r3,[r1,#0]  ; avar_stat
000042  e005              B        |L1.80|
                  |L1.68|
;;;88     	else	   		SET_REG(avar_stat,0,1+i,1);
000044  1c42              ADDS     r2,r0,#1
000046  fa04f302          LSL      r3,r4,r2
00004a  680a              LDR      r2,[r1,#0]  ; avar_stat
00004c  439a              BICS     r2,r2,r3
00004e  600a              STR      r2,[r1,#0]  ; avar_stat
                  |L1.80|
000050  1c40              ADDS     r0,r0,#1              ;85
000052  b2c0              UXTB     r0,r0                 ;85
000054  2802              CMP      r0,#2                 ;85
000056  d3e3              BCC      |L1.32|
;;;89     	}
;;;90     
;;;91     for(i=0;i<12;i++)
000058  2000              MOVS     r0,#0
;;;92     	{
;;;93     	if(bps[i]._av&0xef)	SET_REG(avar_stat,1,3+i,1);
00005a  4aec              LDR      r2,|L1.1036|
                  |L1.92|
00005c  ebc003c0          RSB      r3,r0,r0,LSL #3
000060  eb031300          ADD      r3,r3,r0,LSL #4
000064  eb020383          ADD      r3,r2,r3,LSL #2
000068  785b              LDRB     r3,[r3,#1]
00006a  f0130fef          TST      r3,#0xef
00006e  d007              BEQ      |L1.128|
000070  1cc5              ADDS     r5,r0,#3
000072  fa04f305          LSL      r3,r4,r5
000076  680d              LDR      r5,[r1,#0]  ; avar_stat
000078  439d              BICS     r5,r5,r3
00007a  431d              ORRS     r5,r5,r3
00007c  600d              STR      r5,[r1,#0]  ; avar_stat
00007e  e005              B        |L1.140|
                  |L1.128|
;;;94     	else	   		SET_REG(avar_stat,0,3+i,1);
000080  1cc3              ADDS     r3,r0,#3
000082  fa04f503          LSL      r5,r4,r3
000086  680b              LDR      r3,[r1,#0]  ; avar_stat
000088  43ab              BICS     r3,r3,r5
00008a  600b              STR      r3,[r1,#0]  ; avar_stat
                  |L1.140|
00008c  1c40              ADDS     r0,r0,#1              ;91
00008e  b2c0              UXTB     r0,r0                 ;91
000090  280c              CMP      r0,#0xc               ;91
000092  d3e3              BCC      |L1.92|
;;;95     	}
;;;96     
;;;97     for(i=0;i<6;i++)
000094  2000              MOVS     r0,#0
;;;98     	{
;;;99     	if(av_inv[i])	SET_REG(avar_stat,1,15+i,1);
000096  4ddb              LDR      r5,|L1.1028|
000098  3550              ADDS     r5,r5,#0x50
                  |L1.154|
00009a  5c2a              LDRB     r2,[r5,r0]
00009c  b142              CBZ      r2,|L1.176|
00009e  f100030f          ADD      r3,r0,#0xf
0000a2  fa04f203          LSL      r2,r4,r3
0000a6  680b              LDR      r3,[r1,#0]  ; avar_stat
0000a8  4393              BICS     r3,r3,r2
0000aa  4313              ORRS     r3,r3,r2
0000ac  600b              STR      r3,[r1,#0]  ; avar_stat
0000ae  e006              B        |L1.190|
                  |L1.176|
;;;100    	else	   		SET_REG(avar_stat,0,15+i,1);
0000b0  f100020f          ADD      r2,r0,#0xf
0000b4  680b              LDR      r3,[r1,#0]  ; avar_stat
0000b6  fa04f202          LSL      r2,r4,r2
0000ba  4393              BICS     r3,r3,r2
0000bc  600b              STR      r3,[r1,#0]  ; avar_stat
                  |L1.190|
0000be  1c40              ADDS     r0,r0,#1              ;97
0000c0  b2c0              UXTB     r0,r0                 ;97
0000c2  2806              CMP      r0,#6                 ;97
0000c4  d3e9              BCC      |L1.154|
;;;101    	}
;;;102    
;;;103    /*for(i=0;i<4;i++)
;;;104    	{
;;;105    	if(av_dt[i])	SET_REG(avar_stat,1,21+i,1);
;;;106    	else	   		SET_REG(avar_stat,0,21+i,1);
;;;107    	}  */
;;;108    for(i=0;i<4;i++)
0000c6  2000              MOVS     r0,#0
;;;109    	{
;;;110    	if(sk_av_stat[i]==sasON)	SET_REG(avar_stat,1,24+i,1);
0000c8  4bd1              LDR      r3,|L1.1040|
                  |L1.202|
0000ca  5c1a              LDRB     r2,[r3,r0]
0000cc  2a01              CMP      r2,#1
0000ce  d012              BEQ      |L1.246|
;;;111    	else	   		SET_REG(avar_stat,0,24+i,1);
0000d0  f1000218          ADD      r2,r0,#0x18
0000d4  fa04f502          LSL      r5,r4,r2
0000d8  680a              LDR      r2,[r1,#0]  ; avar_stat
0000da  43aa              BICS     r2,r2,r5
0000dc  600a              STR      r2,[r1,#0]  ; avar_stat
                  |L1.222|
0000de  1c40              ADDS     r0,r0,#1              ;108
0000e0  b2c0              UXTB     r0,r0                 ;108
0000e2  2804              CMP      r0,#4                 ;108
0000e4  d3f1              BCC      |L1.202|
;;;112    	}
;;;113    
;;;114    if(uout_av)			SET_REG(avar_stat,1,28,1);
0000e6  48cb              LDR      r0,|L1.1044|
0000e8  7800              LDRB     r0,[r0,#0]  ; uout_av
0000ea  b168              CBZ      r0,|L1.264|
0000ec  6808              LDR      r0,[r1,#0]  ; avar_stat
0000ee  f0405080          ORR      r0,r0,#0x10000000
0000f2  6008              STR      r0,[r1,#0]  ; avar_stat
0000f4  e00c              B        |L1.272|
                  |L1.246|
0000f6  f1000518          ADD      r5,r0,#0x18           ;110
0000fa  fa04f205          LSL      r2,r4,r5              ;110
0000fe  680d              LDR      r5,[r1,#0]            ;110  ; avar_stat
000100  4395              BICS     r5,r5,r2              ;110
000102  4315              ORRS     r5,r5,r2              ;110
000104  600d              STR      r5,[r1,#0]            ;110  ; avar_stat
000106  e7ea              B        |L1.222|
                  |L1.264|
;;;115    else	   			SET_REG(avar_stat,0,28,1);
000108  6808              LDR      r0,[r1,#0]  ; avar_stat
00010a  f0205080          BIC      r0,r0,#0x10000000
00010e  6008              STR      r0,[r1,#0]  ; avar_stat
                  |L1.272|
;;;116    
;;;117    
;;;118    avar_stat_new=(avar_stat^avar_stat_old)&avar_stat;
000110  688a              LDR      r2,[r1,#8]  ; avar_stat_old
000112  6808              LDR      r0,[r1,#0]  ; avar_stat
000114  ea200302          BIC      r3,r0,r2
000118  60cb              STR      r3,[r1,#0xc]  ; avar_stat_new
;;;119    
;;;120    avar_ind_stat|=avar_stat_new;
00011a  684c              LDR      r4,[r1,#4]  ; avar_ind_stat
00011c  431c              ORRS     r4,r4,r3
00011e  604c              STR      r4,[r1,#4]  ; avar_ind_stat
;;;121    
;;;122    if((SK_ZVUK_EN[0])) avar_ind_stat&=(~(1UL<<24));
000120  4bbd              LDR      r3,|L1.1048|
000122  881d              LDRH     r5,[r3,#0]  ; SK_ZVUK_EN
000124  b115              CBZ      r5,|L1.300|
000126  f0247480          BIC      r4,r4,#0x1000000
00012a  604c              STR      r4,[r1,#4]  ; avar_ind_stat
                  |L1.300|
;;;123    if((SK_ZVUK_EN[1])) avar_ind_stat&=(~(1UL<<25));
00012c  885c              LDRH     r4,[r3,#2]  ; SK_ZVUK_EN
00012e  b11c              CBZ      r4,|L1.312|
000130  684c              LDR      r4,[r1,#4]  ; avar_ind_stat
000132  f0247400          BIC      r4,r4,#0x2000000
000136  604c              STR      r4,[r1,#4]  ; avar_ind_stat
                  |L1.312|
;;;124    if((SK_ZVUK_EN[2])) avar_ind_stat&=(~(1UL<<26));
000138  889c              LDRH     r4,[r3,#4]  ; SK_ZVUK_EN
00013a  b11c              CBZ      r4,|L1.324|
00013c  684c              LDR      r4,[r1,#4]  ; avar_ind_stat
00013e  f0246480          BIC      r4,r4,#0x4000000
000142  604c              STR      r4,[r1,#4]  ; avar_ind_stat
                  |L1.324|
;;;125    if((SK_ZVUK_EN[3])) avar_ind_stat&=(~(1UL<<27));	
000144  88db              LDRH     r3,[r3,#6]  ; SK_ZVUK_EN
000146  b11b              CBZ      r3,|L1.336|
000148  684b              LDR      r3,[r1,#4]  ; avar_ind_stat
00014a  f0236300          BIC      r3,r3,#0x8000000
00014e  604b              STR      r3,[r1,#4]  ; avar_ind_stat
                  |L1.336|
;;;126    
;;;127    
;;;128    avar_stat_offed=~((avar_stat^avar_stat_old)&avar_stat_old);
000150  4382              BICS     r2,r2,r0
000152  43d2              MVNS     r2,r2
000154  610a              STR      r2,[r1,#0x10]  ; avar_stat_offed
;;;129    
;;;130    if(!AV_OFF_AVT)avar_stat_offed|=0xeffffffe;
000156  4bb1              LDR      r3,|L1.1052|
000158  881b              LDRH     r3,[r3,#0]  ; AV_OFF_AVT
00015a  b913              CBNZ     r3,|L1.354|
00015c  4bb0              LDR      r3,|L1.1056|
00015e  431a              ORRS     r2,r2,r3
000160  610a              STR      r2,[r1,#0x10]  ; avar_stat_offed
                  |L1.354|
;;;131    
;;;132    avar_ind_stat&=avar_stat_offed; 
000162  690b              LDR      r3,[r1,#0x10]  ; avar_stat_offed
000164  684a              LDR      r2,[r1,#4]  ; avar_ind_stat
000166  401a              ANDS     r2,r2,r3
000168  604a              STR      r2,[r1,#4]  ; avar_ind_stat
;;;133    
;;;134    avar_stat_old=avar_stat;
00016a  6088              STR      r0,[r1,#8]  ; avar_stat_old
;;;135    
;;;136    //oleg_start*
;;;137    
;;;138    
;;;139    
;;;140    rki_avar1_stat=(sk_alarm<<8)|(status_izm_r&0x3F);
00016c  48ad              LDR      r0,|L1.1060|
00016e  4aae              LDR      r2,|L1.1064|
000170  8800              LDRH     r0,[r0,#0]  ; status_izm_r
000172  6812              LDR      r2,[r2,#0]  ; sk_alarm
000174  f000003f          AND      r0,r0,#0x3f
000178  ea402002          ORR      r0,r0,r2,LSL #8
00017c  6148              STR      r0,[r1,#0x14]  ; rki_avar1_stat
;;;141    rki_avar1_stat_new=(rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat;
00017e  69cb              LDR      r3,[r1,#0x1c]  ; rki_avar1_stat_old
000180  ea200203          BIC      r2,r0,r3
000184  620a              STR      r2,[r1,#0x20]  ; rki_avar1_stat_new
;;;142    rki_avar1_ind_stat|=rki_avar1_stat_new;
000186  698c              LDR      r4,[r1,#0x18]  ; rki_avar1_ind_stat
000188  4314              ORRS     r4,r4,r2
;;;143    rki_avar1_stat_offed=~((rki_avar1_stat^rki_avar1_stat_old)&rki_avar1_stat_old);
00018a  4383              BICS     r3,r3,r0
00018c  43da              MVNS     r2,r3
00018e  624a              STR      r2,[r1,#0x24]  ; rki_avar1_stat_offed
;;;144    rki_avar1_ind_stat&=rki_avar1_stat_offed;
000190  4014              ANDS     r4,r4,r2
000192  618c              STR      r4,[r1,#0x18]  ; rki_avar1_ind_stat
;;;145    rki_avar1_stat_old=rki_avar1_stat;
000194  61c8              STR      r0,[r1,#0x1c]  ; rki_avar1_stat_old
;;;146    
;;;147    rki_avarI1_stat=status_di1;
000196  48a5              LDR      r0,|L1.1068|
000198  6800              LDR      r0,[r0,#0]  ; status_di1
00019a  6288              STR      r0,[r1,#0x28]  ; rki_avarI1_stat
;;;148    rki_avarI1_stat_new=(rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat;
00019c  6b0b              LDR      r3,[r1,#0x30]  ; rki_avarI1_stat_old
00019e  ea200203          BIC      r2,r0,r3
0001a2  634a              STR      r2,[r1,#0x34]  ; rki_avarI1_stat_new
;;;149    rki_avarI1_ind_stat|=rki_avarI1_stat_new;
0001a4  6acc              LDR      r4,[r1,#0x2c]  ; rki_avarI1_ind_stat
0001a6  4314              ORRS     r4,r4,r2
;;;150    rki_avarI1_stat_offed=~((rki_avarI1_stat^rki_avarI1_stat_old)&rki_avarI1_stat_old);
0001a8  4383              BICS     r3,r3,r0
0001aa  43da              MVNS     r2,r3
0001ac  638a              STR      r2,[r1,#0x38]  ; rki_avarI1_stat_offed
;;;151    rki_avarI1_ind_stat&=rki_avarI1_stat_offed;
0001ae  4014              ANDS     r4,r4,r2
0001b0  62cc              STR      r4,[r1,#0x2c]  ; rki_avarI1_ind_stat
;;;152    rki_avarI1_stat_old=rki_avarI1_stat;
0001b2  6308              STR      r0,[r1,#0x30]  ; rki_avarI1_stat_old
;;;153    
;;;154    rki_avarI2_stat=status_di2;
0001b4  489e              LDR      r0,|L1.1072|
0001b6  6800              LDR      r0,[r0,#0]  ; status_di2
0001b8  63c8              STR      r0,[r1,#0x3c]  ; rki_avarI2_stat
;;;155    rki_avarI2_stat_new=(rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat;
0001ba  6c4b              LDR      r3,[r1,#0x44]  ; rki_avarI2_stat_old
0001bc  ea200203          BIC      r2,r0,r3
0001c0  648a              STR      r2,[r1,#0x48]  ; rki_avarI2_stat_new
;;;156    rki_avarI2_ind_stat|=rki_avarI2_stat_new;
0001c2  6c0c              LDR      r4,[r1,#0x40]  ; rki_avarI2_ind_stat
0001c4  4314              ORRS     r4,r4,r2
;;;157    rki_avarI2_stat_offed=~((rki_avarI2_stat^rki_avarI2_stat_old)&rki_avarI2_stat_old);
0001c6  4383              BICS     r3,r3,r0
0001c8  43da              MVNS     r2,r3
0001ca  64ca              STR      r2,[r1,#0x4c]  ; rki_avarI2_stat_offed
;;;158    rki_avarI2_ind_stat&=rki_avarI2_stat_offed;
0001cc  4014              ANDS     r4,r4,r2
0001ce  640c              STR      r4,[r1,#0x40]  ; rki_avarI2_ind_stat
;;;159    rki_avarI2_stat_old=rki_avarI2_stat;
0001d0  6448              STR      r0,[r1,#0x44]  ; rki_avarI2_stat_old
;;;160    //oleg_end
;;;161    }
0001d2  bd30              POP      {r4,r5,pc}
;;;162    
                          ENDP

                  reload_hndl PROC
;;;163    //-----------------------------------------------
;;;164    void reload_hndl(void)
0001d4  b5f8              PUSH     {r3-r7,lr}
;;;165    {
;;;166    char data[4];
;;;167    unsigned int event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;168    
;;;169    event_ptr=lc640_read_int(PTR_EVENT_LOG);
0001d6  f44f6560          MOV      r5,#0xe00
0001da  4628              MOV      r0,r5
0001dc  f7fffffe          BL       lc640_read_int
;;;170    event_ptr++;	
0001e0  1c44              ADDS     r4,r0,#1
;;;171    if(event_ptr>63)event_ptr=0;	
0001e2  2c3f              CMP      r4,#0x3f
0001e4  d900              BLS      |L1.488|
0001e6  2400              MOVS     r4,#0
                  |L1.488|
;;;172    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
0001e8  b221              SXTH     r1,r4
0001ea  4628              MOV      r0,r5
0001ec  f7fffffe          BL       lc640_write_int
;;;173    	
;;;174    event_cnt=lc640_read_int(CNT_EVENT_LOG);
0001f0  f6406602          MOV      r6,#0xe02
0001f4  4630              MOV      r0,r6
0001f6  f7fffffe          BL       lc640_read_int
;;;175    if(event_cnt!=63)event_cnt=event_ptr;
0001fa  283f              CMP      r0,#0x3f
0001fc  d000              BEQ      |L1.512|
0001fe  4620              MOV      r0,r4
                  |L1.512|
;;;176    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000200  b201              SXTH     r1,r0
000202  4630              MOV      r0,r6
000204  f7fffffe          BL       lc640_write_int
;;;177    	
;;;178    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000208  4628              MOV      r0,r5
00020a  f7fffffe          BL       lc640_read_int
00020e  f44f6180          MOV      r1,#0x400
000212  eb011440          ADD      r4,r1,r0,LSL #5
;;;179    	
;;;180    data[0]='U';
000216  2055              MOVS     r0,#0x55
000218  f88d0000          STRB     r0,[sp,#0]
;;;181    data[1]=0;
00021c  2600              MOVS     r6,#0
00021e  f88d6001          STRB     r6,[sp,#1]
;;;182    data[2]='R';
000222  2052              MOVS     r0,#0x52
000224  f88d0002          STRB     r0,[sp,#2]
;;;183    data[3]=0;
000228  f88d6003          STRB     r6,[sp,#3]
;;;184    lc640_write_long_ptr(lc640_adr,data);
00022c  4669              MOV      r1,sp
00022e  4620              MOV      r0,r4
000230  f7fffffe          BL       lc640_write_long_ptr
;;;185    
;;;186    data[0]=0;
;;;187    data[1]=0;
;;;188    data[2]=0;
;;;189    data[3]=0;
000234  9600              STR      r6,[sp,#0]
;;;190    lc640_write_long_ptr(lc640_adr+4,data);
000236  4669              MOV      r1,sp
000238  1d20              ADDS     r0,r4,#4
00023a  f7fffffe          BL       lc640_write_long_ptr
;;;191    
;;;192    data[0]=LPC_RTC->YEAR;
00023e  4d7d              LDR      r5,|L1.1076|
000240  8ba8              LDRH     r0,[r5,#0x1c]
000242  f88d0000          STRB     r0,[sp,#0]
;;;193    data[1]=LPC_RTC->MONTH;
000246  7e28              LDRB     r0,[r5,#0x18]
000248  f88d0001          STRB     r0,[sp,#1]
;;;194    data[2]=LPC_RTC->DOM;
00024c  7b28              LDRB     r0,[r5,#0xc]
00024e  f88d0002          STRB     r0,[sp,#2]
;;;195    data[3]=0;
000252  f88d6003          STRB     r6,[sp,#3]
;;;196    lc640_write_long_ptr(lc640_adr+8,data);
000256  4669              MOV      r1,sp
000258  f1040008          ADD      r0,r4,#8
00025c  f7fffffe          BL       lc640_write_long_ptr
;;;197    
;;;198    data[0]=LPC_RTC->HOUR;
000260  7a28              LDRB     r0,[r5,#8]
000262  f88d0000          STRB     r0,[sp,#0]
;;;199    data[1]=LPC_RTC->MIN;
000266  7928              LDRB     r0,[r5,#4]
000268  f88d0001          STRB     r0,[sp,#1]
;;;200    data[2]=LPC_RTC->SEC;
00026c  7828              LDRB     r0,[r5,#0]
00026e  f88d0002          STRB     r0,[sp,#2]
;;;201    data[3]=LPC_SC->RSID;
000272  4871              LDR      r0,|L1.1080|
000274  f8d00180          LDR      r0,[r0,#0x180]
000278  f88d0003          STRB     r0,[sp,#3]
;;;202    
;;;203    lc640_write_long_ptr(lc640_adr+12,data);
00027c  4669              MOV      r1,sp
00027e  f104000c          ADD      r0,r4,#0xc
000282  f7fffffe          BL       lc640_write_long_ptr
;;;204    	
;;;205    data[0]='A';
000286  2541              MOVS     r5,#0x41
000288  f88d5000          STRB     r5,[sp,#0]
;;;206    data[1]='A';
00028c  f88d5001          STRB     r5,[sp,#1]
;;;207    data[2]='A';
000290  f88d5002          STRB     r5,[sp,#2]
;;;208    data[3]='A';
000294  f88d5003          STRB     r5,[sp,#3]
;;;209    lc640_write_long_ptr(lc640_adr+16,data);
000298  4669              MOV      r1,sp
00029a  f1040010          ADD      r0,r4,#0x10
00029e  f7fffffe          BL       lc640_write_long_ptr
;;;210    	
;;;211    data[0]='A';
0002a2  f88d5000          STRB     r5,[sp,#0]
;;;212    data[1]='A';
0002a6  f88d5001          STRB     r5,[sp,#1]
;;;213    data[2]='A';
0002aa  f88d5002          STRB     r5,[sp,#2]
;;;214    data[3]='A';
0002ae  f88d5003          STRB     r5,[sp,#3]
;;;215    lc640_write_long_ptr(lc640_adr+20,data);
0002b2  4669              MOV      r1,sp
0002b4  f1040014          ADD      r0,r4,#0x14
0002b8  f7fffffe          BL       lc640_write_long_ptr
;;;216    	
;;;217    data[0]='A';
0002bc  f88d5000          STRB     r5,[sp,#0]
;;;218    data[1]='A';
0002c0  f88d5001          STRB     r5,[sp,#1]
;;;219    data[2]='A';
0002c4  f88d5002          STRB     r5,[sp,#2]
;;;220    data[3]='A';
0002c8  f88d5003          STRB     r5,[sp,#3]
;;;221    lc640_write_long_ptr(lc640_adr+24,data);
0002cc  4669              MOV      r1,sp
0002ce  f1040018          ADD      r0,r4,#0x18
0002d2  f7fffffe          BL       lc640_write_long_ptr
;;;222    	
;;;223    data[0]='A';
0002d6  f88d5000          STRB     r5,[sp,#0]
;;;224    data[1]='A';
0002da  f88d5001          STRB     r5,[sp,#1]
;;;225    data[2]='A';
0002de  f88d5002          STRB     r5,[sp,#2]
;;;226    data[3]='A';
0002e2  f88d5003          STRB     r5,[sp,#3]
;;;227    lc640_write_long_ptr(lc640_adr+28,data);				
0002e6  4669              MOV      r1,sp
0002e8  f104001c          ADD      r0,r4,#0x1c
0002ec  f7fffffe          BL       lc640_write_long_ptr
;;;228    	
;;;229    	
;;;230    }
0002f0  bdf8              POP      {r3-r7,pc}
;;;231    
                          ENDP

                  avar_unet_hndl PROC
;;;232    //-----------------------------------------------
;;;233    void avar_unet_hndl(char in)
0002f2  e92d43f8          PUSH     {r3-r9,lr}
;;;234    {
;;;235    
;;;236    char data[4];
;;;237    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;238    
;;;239    
;;;240    if(in==1)
;;;241    	{
;;;242    	net_av=1;
;;;243    
;;;244    	//beep_init(0x01L,'O');
;;;245    	//a.av.bAN=1;
;;;246    
;;;247    
;;;248    	//beep_init(0x33333333,'A');
;;;249    	 
;;;250    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;251    	event_ptr++;	
;;;252    	if(event_ptr>63)event_ptr=0;	
;;;253    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;254    	
;;;255         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;256    	if(event_cnt!=63)event_cnt=event_ptr;
;;;257    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;258    	
;;;259    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;260    	
;;;261    	data[0]='P';
;;;262    	data[1]=0;
;;;263    	data[2]='A';
;;;264    	data[3]=0;
;;;265    	lc640_write_long_ptr(lc640_adr,data);
;;;266    
;;;267    	data[0]=0;//*((char*)&Unet_store);
;;;268    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;269    	data[2]=0;
;;;270    	data[3]=0;
;;;271    	lc640_write_long_ptr(lc640_adr+4,data);
;;;272    
;;;273    	data[0]=LPC_RTC->YEAR;
0002f6  4f4f              LDR      r7,|L1.1076|
0002f8  4941              LDR      r1,|L1.1024|
0002fa  3f20              SUBS     r7,r7,#0x20
0002fc  f44f6560          MOV      r5,#0xe00             ;250
000300  f04f0800          MOV      r8,#0                 ;252
000304  f44f6980          MOV      r9,#0x400             ;259
000308  2801              CMP      r0,#1                 ;240
00030a  d001              BEQ      |L1.784|
;;;274    	data[1]=LPC_RTC->MONTH;
;;;275    	data[2]=LPC_RTC->DOM;
;;;276    	data[3]=0;
;;;277    	lc640_write_long_ptr(lc640_adr+8,data);
;;;278    
;;;279    	data[0]=LPC_RTC->HOUR;
;;;280    	data[1]=LPC_RTC->MIN;
;;;281    	data[2]=LPC_RTC->SEC;
;;;282    	data[3]=0;
;;;283    	lc640_write_long_ptr(lc640_adr+12,data);
;;;284    	
;;;285    	data[0]='A';
;;;286    	data[1]='A';
;;;287    	data[2]='A';
;;;288    	data[3]='A';
;;;289    	lc640_write_long_ptr(lc640_adr+16,data);
;;;290    	
;;;291    	data[0]='A';
;;;292    	data[1]='A';
;;;293    	data[2]='A';
;;;294    	data[3]='A';
;;;295    	lc640_write_long_ptr(lc640_adr+20,data);
;;;296    	
;;;297    	data[0]='A';
;;;298    	data[1]='A';
;;;299    	data[2]='A';
;;;300    	data[3]='A';
;;;301    	lc640_write_long_ptr(lc640_adr+24,data);
;;;302    	
;;;303    	data[0]='A';
;;;304    	data[1]='A';
;;;305    	data[2]='A';
;;;306    	data[3]='A';
;;;307    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;308    	
;;;309    /*	memo_out0[0]=0x55;
;;;310         memo_out0[1]=0x00+2;
;;;311         memo_out0[2]=1;
;;;312         memo_out0[3]=0x0b;
;;;313         memo_out0[4]=0x55;
;;;314         memo_out0[5]=0x55; 
;;;315         	
;;;316         memo_out0[6]=crc_87(memo_out0,6);
;;;317    	memo_out0[7]=crc_95(memo_out0,6);
;;;318         usart_out_adr0(memo_out0,8); 
;;;319    	*/
;;;320    	snmp_trap_send("Main power alarm",2,1,0);
;;;321    	}
;;;322    
;;;323    else if(in==0)
00030c  b3f0              CBZ      r0,|L1.908|
00030e  e13d              B        |L1.1420|
                  |L1.784|
000310  2001              MOVS     r0,#1                 ;242
000312  7008              STRB     r0,[r1,#0]            ;242
000314  4628              MOV      r0,r5                 ;250
000316  f7fffffe          BL       lc640_read_int
00031a  1c44              ADDS     r4,r0,#1              ;251
00031c  2c3f              CMP      r4,#0x3f              ;252
00031e  d900              BLS      |L1.802|
000320  2400              MOVS     r4,#0                 ;252
                  |L1.802|
000322  b221              SXTH     r1,r4                 ;253
000324  4628              MOV      r0,r5                 ;253
000326  f7fffffe          BL       lc640_write_int
00032a  f6406602          MOV      r6,#0xe02             ;255
00032e  4630              MOV      r0,r6                 ;255
000330  f7fffffe          BL       lc640_read_int
000334  283f              CMP      r0,#0x3f              ;256
000336  d000              BEQ      |L1.826|
000338  4620              MOV      r0,r4                 ;256
                  |L1.826|
00033a  b201              SXTH     r1,r0                 ;257
00033c  4630              MOV      r0,r6                 ;257
00033e  f7fffffe          BL       lc640_write_int
000342  4628              MOV      r0,r5                 ;259
000344  f7fffffe          BL       lc640_read_int
000348  eb091540          ADD      r5,r9,r0,LSL #5       ;259
00034c  2050              MOVS     r0,#0x50              ;261
00034e  f88d0000          STRB     r0,[sp,#0]            ;261
000352  f88d8001          STRB     r8,[sp,#1]            ;262
000356  2441              MOVS     r4,#0x41              ;263
000358  f88d4002          STRB     r4,[sp,#2]            ;263
00035c  f88d8003          STRB     r8,[sp,#3]            ;264
000360  4669              MOV      r1,sp                 ;265
000362  4628              MOV      r0,r5                 ;265
000364  f7fffffe          BL       lc640_write_long_ptr
000368  f8cd8000          STR      r8,[sp,#0]            ;270
00036c  4669              MOV      r1,sp                 ;271
00036e  1d28              ADDS     r0,r5,#4              ;271
000370  f7fffffe          BL       lc640_write_long_ptr
000374  f1070720          ADD      r7,r7,#0x20           ;273
000378  8bb8              LDRH     r0,[r7,#0x1c]         ;273
00037a  f88d0000          STRB     r0,[sp,#0]            ;273
00037e  7e38              LDRB     r0,[r7,#0x18]         ;274
000380  f88d0001          STRB     r0,[sp,#1]            ;274
000384  7b38              LDRB     r0,[r7,#0xc]          ;275
000386  f88d0002          STRB     r0,[sp,#2]            ;275
00038a  e000              B        |L1.910|
                  |L1.908|
00038c  e071              B        |L1.1138|
                  |L1.910|
00038e  f88d8003          STRB     r8,[sp,#3]            ;276
000392  4669              MOV      r1,sp                 ;277
000394  f1050008          ADD      r0,r5,#8              ;277
000398  f7fffffe          BL       lc640_write_long_ptr
00039c  7a38              LDRB     r0,[r7,#8]            ;279
00039e  f88d0000          STRB     r0,[sp,#0]            ;279
0003a2  7938              LDRB     r0,[r7,#4]            ;280
0003a4  f88d0001          STRB     r0,[sp,#1]            ;280
0003a8  7838              LDRB     r0,[r7,#0]            ;281
0003aa  f88d0002          STRB     r0,[sp,#2]            ;281
0003ae  f88d8003          STRB     r8,[sp,#3]            ;282
0003b2  4669              MOV      r1,sp                 ;283
0003b4  f105000c          ADD      r0,r5,#0xc            ;283
0003b8  f7fffffe          BL       lc640_write_long_ptr
0003bc  f88d4000          STRB     r4,[sp,#0]            ;285
0003c0  f88d4001          STRB     r4,[sp,#1]            ;286
0003c4  f88d4002          STRB     r4,[sp,#2]            ;287
0003c8  f88d4003          STRB     r4,[sp,#3]            ;288
0003cc  4669              MOV      r1,sp                 ;289
0003ce  f1050010          ADD      r0,r5,#0x10           ;289
0003d2  f7fffffe          BL       lc640_write_long_ptr
0003d6  f88d4000          STRB     r4,[sp,#0]            ;291
0003da  f88d4001          STRB     r4,[sp,#1]            ;292
0003de  f88d4002          STRB     r4,[sp,#2]            ;293
0003e2  f88d4003          STRB     r4,[sp,#3]            ;294
0003e6  4669              MOV      r1,sp                 ;295
0003e8  f1050014          ADD      r0,r5,#0x14           ;295
0003ec  f7fffffe          BL       lc640_write_long_ptr
0003f0  f88d4000          STRB     r4,[sp,#0]            ;297
0003f4  f88d4001          STRB     r4,[sp,#1]            ;298
0003f8  f88d4002          STRB     r4,[sp,#2]            ;299
0003fc  e01e              B        |L1.1084|
0003fe  0000              DCW      0x0000
                  |L1.1024|
                          DCD      net_av
                  |L1.1028|
                          DCD      ||.data||
                  |L1.1032|
                          DCD      bat
                  |L1.1036|
                          DCD      bps
                  |L1.1040|
                          DCD      sk_av_stat
                  |L1.1044|
                          DCD      uout_av
                  |L1.1048|
                          DCD      SK_ZVUK_EN
                  |L1.1052|
                          DCD      AV_OFF_AVT
                  |L1.1056|
                          DCD      0xeffffffe
                  |L1.1060|
                          DCD      status_izm_r
                  |L1.1064|
                          DCD      sk_alarm
                  |L1.1068|
                          DCD      status_di1
                  |L1.1072|
                          DCD      status_di2
                  |L1.1076|
                          DCD      0x40024020
                  |L1.1080|
                          DCD      0x400fc000
                  |L1.1084|
00043c  f88d4003          STRB     r4,[sp,#3]            ;300
000440  4669              MOV      r1,sp                 ;301
000442  f1050018          ADD      r0,r5,#0x18           ;301
000446  f7fffffe          BL       lc640_write_long_ptr
00044a  f88d4000          STRB     r4,[sp,#0]            ;303
00044e  f88d4001          STRB     r4,[sp,#1]            ;304
000452  f88d4002          STRB     r4,[sp,#2]            ;305
000456  f88d4003          STRB     r4,[sp,#3]            ;306
00045a  4669              MOV      r1,sp                 ;307
00045c  f105001c          ADD      r0,r5,#0x1c           ;307
000460  f7fffffe          BL       lc640_write_long_ptr
000464  2300              MOVS     r3,#0                 ;320
000466  2201              MOVS     r2,#1                 ;320
000468  2102              MOVS     r1,#2                 ;320
00046a  a0f6              ADR      r0,|L1.2116|
00046c  f7fffffe          BL       snmp_trap_send
000470  e08c              B        |L1.1420|
                  |L1.1138|
;;;324    	{
;;;325    	net_av=0;
000472  f8818000          STRB     r8,[r1,#0]
;;;326    
;;;327      /*
;;;328    	SET_REG(C2GSR,3,24,8);
;;;329    	C2MOD=0;
;;;330    	bOUT_FREE2=1;*/
;;;331    
;;;332    
;;;333    	//C2MOD=0;
;;;334    
;;;335    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;336    
;;;337         //beep_init(0x02L,'O');
;;;338    	//a_.av.bAN=0;
;;;339    	SET_REG(avar_stat,0,0,1);
000476  48f8              LDR      r0,|L1.2136|
000478  6801              LDR      r1,[r0,#0]  ; avar_stat
00047a  f0210101          BIC      r1,r1,#1
00047e  6001              STR      r1,[r0,#0]  ; avar_stat
;;;340    
;;;341    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;342    	
;;;343    	if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
000480  49f6              LDR      r1,|L1.2140|
000482  8809              LDRH     r1,[r1,#0]  ; AV_OFF_AVT
000484  b119              CBZ      r1,|L1.1166|
000486  6841              LDR      r1,[r0,#4]  ; avar_ind_stat
000488  f0210101          BIC      r1,r1,#1
00048c  6041              STR      r1,[r0,#4]  ; avar_ind_stat
                  |L1.1166|
;;;344    
;;;345         event_ptr=lc640_read_int(PTR_EVENT_LOG);
00048e  4628              MOV      r0,r5
000490  f7fffffe          BL       lc640_read_int
000494  4606              MOV      r6,r0
;;;346    	event_ptr_find=event_ptr;
000496  4634              MOV      r4,r6
                  |L1.1176|
;;;347    avar_unet_hndl_lbl1:
;;;348    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000498  eb091544          ADD      r5,r9,r4,LSL #5
;;;349    
;;;350         lc640_read_long_ptr(lc640_adr,data);
00049c  4669              MOV      r1,sp
00049e  4628              MOV      r0,r5
0004a0  f7fffffe          BL       lc640_read_long_ptr
;;;351         
;;;352         if(!((data[0]=='P')&&(data[1]==0)&&(data[2]=='A')))
0004a4  f89d0000          LDRB     r0,[sp,#0]
0004a8  2850              CMP      r0,#0x50
0004aa  d106              BNE      |L1.1210|
0004ac  f89d0001          LDRB     r0,[sp,#1]
0004b0  b918              CBNZ     r0,|L1.1210|
0004b2  f89d0002          LDRB     r0,[sp,#2]
0004b6  2841              CMP      r0,#0x41
0004b8  d006              BEQ      |L1.1224|
                  |L1.1210|
;;;353         	{        
;;;354         	if(event_ptr_find)event_ptr_find--;
0004ba  b10c              CBZ      r4,|L1.1216|
0004bc  1e64              SUBS     r4,r4,#1
0004be  e000              B        |L1.1218|
                  |L1.1216|
;;;355         	else event_ptr_find=63;
0004c0  243f              MOVS     r4,#0x3f
                  |L1.1218|
;;;356         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0004c2  42b4              CMP      r4,r6
0004c4  d1e8              BNE      |L1.1176|
0004c6  e061              B        |L1.1420|
                  |L1.1224|
;;;357         	else goto avar_unet_hndl_lbl1;
;;;358         	}
;;;359         else 
;;;360         	{
;;;361         	lc640_read_long_ptr(lc640_adr+16,data);
0004c8  4669              MOV      r1,sp
0004ca  f1050010          ADD      r0,r5,#0x10
0004ce  f7fffffe          BL       lc640_read_long_ptr
;;;362         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0004d2  f89d0000          LDRB     r0,[sp,#0]
0004d6  2841              CMP      r0,#0x41
0004d8  d10b              BNE      |L1.1266|
0004da  f89d0001          LDRB     r0,[sp,#1]
0004de  2841              CMP      r0,#0x41
0004e0  d107              BNE      |L1.1266|
0004e2  f89d0002          LDRB     r0,[sp,#2]
0004e6  2841              CMP      r0,#0x41
0004e8  d103              BNE      |L1.1266|
0004ea  f89d0003          LDRB     r0,[sp,#3]
0004ee  2841              CMP      r0,#0x41
0004f0  d006              BEQ      |L1.1280|
                  |L1.1266|
;;;363         		{        
;;;364         		if(event_ptr_find)event_ptr_find--;
0004f2  b10c              CBZ      r4,|L1.1272|
0004f4  1e64              SUBS     r4,r4,#1
0004f6  e000              B        |L1.1274|
                  |L1.1272|
;;;365             		else event_ptr_find=63;
0004f8  243f              MOVS     r4,#0x3f
                  |L1.1274|
;;;366             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
0004fa  42b4              CMP      r4,r6
0004fc  d1cc              BNE      |L1.1176|
0004fe  e045              B        |L1.1420|
                  |L1.1280|
;;;367         		else goto avar_unet_hndl_lbl1;
;;;368         		}
;;;369    
;;;370         	}	
;;;371    	
;;;372    	data[0]=LPC_RTC->YEAR;
000500  f1070720          ADD      r7,r7,#0x20
000504  8bb8              LDRH     r0,[r7,#0x1c]
000506  f88d0000          STRB     r0,[sp,#0]
;;;373    	data[1]=LPC_RTC->MONTH;
00050a  7e38              LDRB     r0,[r7,#0x18]
00050c  f88d0001          STRB     r0,[sp,#1]
;;;374    	data[2]=LPC_RTC->DOM;
000510  7b38              LDRB     r0,[r7,#0xc]
000512  f88d0002          STRB     r0,[sp,#2]
;;;375    	data[3]=0;
000516  f88d8003          STRB     r8,[sp,#3]
;;;376    	lc640_write_long_ptr(lc640_adr+16,data);
00051a  4669              MOV      r1,sp
00051c  f1050010          ADD      r0,r5,#0x10
000520  f7fffffe          BL       lc640_write_long_ptr
;;;377    
;;;378    	data[0]=LPC_RTC->HOUR;
000524  7a38              LDRB     r0,[r7,#8]
000526  f88d0000          STRB     r0,[sp,#0]
;;;379    	data[1]=LPC_RTC->MIN;
00052a  7938              LDRB     r0,[r7,#4]
00052c  f88d0001          STRB     r0,[sp,#1]
;;;380    	data[2]=LPC_RTC->SEC;
000530  7838              LDRB     r0,[r7,#0]
000532  f88d0002          STRB     r0,[sp,#2]
;;;381    	data[3]=0;
000536  f88d8003          STRB     r8,[sp,#3]
;;;382    	lc640_write_long_ptr(lc640_adr+20,data); 
00053a  4669              MOV      r1,sp
00053c  f1050014          ADD      r0,r5,#0x14
000540  f7fffffe          BL       lc640_write_long_ptr
;;;383    	
;;;384    	data[0]=*((char*)(&net_Ustore));
000544  48c6              LDR      r0,|L1.2144|
000546  7801              LDRB     r1,[r0,#0]  ; net_Ustore
000548  f88d1000          STRB     r1,[sp,#0]
;;;385    	data[1]=*(((char*)(&net_Ustore))+1);
00054c  7840              LDRB     r0,[r0,#1]  ; net_Ustore
00054e  f88d0001          STRB     r0,[sp,#1]
;;;386    	data[2]='B';
000552  2442              MOVS     r4,#0x42
000554  f88d4002          STRB     r4,[sp,#2]
;;;387    	data[3]='B';
000558  f88d4003          STRB     r4,[sp,#3]
;;;388    	lc640_write_long_ptr(lc640_adr+24,data);
00055c  4669              MOV      r1,sp
00055e  f1050018          ADD      r0,r5,#0x18
000562  f7fffffe          BL       lc640_write_long_ptr
;;;389    	
;;;390    	data[0]='B';
000566  f88d4000          STRB     r4,[sp,#0]
;;;391    	data[1]='B';
00056a  f88d4001          STRB     r4,[sp,#1]
;;;392    	data[2]='B';
00056e  f88d4002          STRB     r4,[sp,#2]
;;;393    	data[3]='B';
000572  f88d4003          STRB     r4,[sp,#3]
;;;394    	lc640_write_long_ptr(lc640_adr+28,data);	
000576  4669              MOV      r1,sp
000578  f105001c          ADD      r0,r5,#0x1c
00057c  f7fffffe          BL       lc640_write_long_ptr
;;;395    	
;;;396    /*	memo_out0[0]=0x55;
;;;397         memo_out0[1]=0x00+2;
;;;398         memo_out0[2]=1;
;;;399         memo_out0[3]=0x0b;
;;;400         memo_out0[4]=0xaa;
;;;401         memo_out0[5]=0xaa; 
;;;402         	
;;;403         memo_out0[6]=crc_87(memo_out0,6);
;;;404    	memo_out0[7]=crc_95(memo_out0,6);
;;;405         usart_out_adr0(memo_out0,8); */
;;;406         snmp_trap_send("Main power alarm  clear",2,1,1);	
000580  2301              MOVS     r3,#1
000582  461a              MOV      r2,r3
000584  2102              MOVS     r1,#2
000586  a0b7              ADR      r0,|L1.2148|
000588  f7fffffe          BL       snmp_trap_send
                  |L1.1420|
;;;407    	}
;;;408    avar_unet_hndl_end:
;;;409    	__nop();		
00058c  bf00              NOP      
                  |L1.1422|
;;;410    }
00058e  e8bd83f8          POP      {r3-r9,pc}
;;;411    
                          ENDP

                  avar_uout_hndl PROC
;;;413    //-----------------------------------------------
;;;414    void avar_uout_hndl(char in)
000592  e92d43f8          PUSH     {r3-r9,lr}
;;;415    {
;;;416    
;;;417    char data[4];
;;;418    unsigned int event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;419    
;;;420    
;;;421    if(in==1)
;;;422    	{
;;;423    	//net_av=1;
;;;424    
;;;425    	//beep_init(0x01L,'O');
;;;426    	//a.av.bAN=1;
;;;427    
;;;428    
;;;429    	//beep_init(0x33333333,'A');
;;;430    
;;;431    	if(load_U>U_OUT_KONTR_MAX)uout_av=1;
;;;432    	if(load_U<U_OUT_KONTR_MIN)uout_av=2;
;;;433    		 
;;;434    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;435    	event_ptr++;	
;;;436    	if(event_ptr>63)event_ptr=0;	
;;;437    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;438    	
;;;439        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;440    	if(event_cnt!=63)event_cnt=event_ptr;
;;;441    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;442    	
;;;443    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;444    	
;;;445    	data[0]='Q';
;;;446    	data[1]=0;
;;;447    	data[2]='A';
;;;448    	data[3]=0;
;;;449    	lc640_write_long_ptr(lc640_adr,data);
;;;450    
;;;451    	data[0]=0;//*((char*)&Unet_store);
;;;452    	data[1]=0;//*(((char*)&Unet_store)+1);
;;;453    	data[2]=0;
;;;454    	data[3]=0;
;;;455    	lc640_write_long_ptr(lc640_adr+4,data);
;;;456    
;;;457    	data[0]=LPC_RTC->YEAR;
000596  4fb9              LDR      r7,|L1.2172|
000598  49b9              LDR      r1,|L1.2176|
00059a  f44f6560          MOV      r5,#0xe00             ;434
00059e  f04f0800          MOV      r8,#0                 ;436
0005a2  f44f6980          MOV      r9,#0x400             ;443
0005a6  2801              CMP      r0,#1                 ;421
0005a8  d001              BEQ      |L1.1454|
;;;458    	data[1]=LPC_RTC->MONTH;
;;;459    	data[2]=LPC_RTC->DOM;
;;;460    	data[3]=0;
;;;461    	lc640_write_long_ptr(lc640_adr+8,data);
;;;462    
;;;463    	data[0]=LPC_RTC->HOUR;
;;;464    	data[1]=LPC_RTC->MIN;
;;;465    	data[2]=LPC_RTC->SEC;
;;;466    	data[3]=0;
;;;467    	lc640_write_long_ptr(lc640_adr+12,data);
;;;468    	
;;;469    	data[0]='A';
;;;470    	data[1]='A';
;;;471    	data[2]='A';
;;;472    	data[3]='A';
;;;473    	lc640_write_long_ptr(lc640_adr+16,data);
;;;474    	
;;;475    	data[0]='A';
;;;476    	data[1]='A';
;;;477    	data[2]='A';
;;;478    	data[3]='A';
;;;479    	lc640_write_long_ptr(lc640_adr+20,data);
;;;480    	
;;;481    	data[0]='A';
;;;482    	data[1]='A';
;;;483    	data[2]='A';
;;;484    	data[3]='A';
;;;485    	lc640_write_long_ptr(lc640_adr+24,data);
;;;486    	
;;;487    	data[0]='A';
;;;488    	data[1]='A';
;;;489    	data[2]='A';
;;;490    	data[3]='A';
;;;491    	lc640_write_long_ptr(lc640_adr+28,data);				
;;;492    	
;;;493    /*	memo_out0[0]=0x55;
;;;494         memo_out0[1]=0x00+2;
;;;495         memo_out0[2]=1;
;;;496         memo_out0[3]=0x0b;
;;;497         memo_out0[4]=0x55;
;;;498         memo_out0[5]=0x55; 
;;;499         	
;;;500         memo_out0[6]=crc_87(memo_out0,6);
;;;501    	memo_out0[7]=crc_95(memo_out0,6);
;;;502         usart_out_adr0(memo_out0,8); 
;;;503    	*/
;;;504    	//snmp_trap_send("Main power is off",2,1,0);
;;;505    	}
;;;506    
;;;507    else if(in==0)
0005aa  b3f0              CBZ      r0,|L1.1578|
0005ac  e11a              B        |L1.2020|
                  |L1.1454|
0005ae  48b5              LDR      r0,|L1.2180|
0005b0  4ab5              LDR      r2,|L1.2184|
0005b2  f9b00000          LDRSH    r0,[r0,#0]            ;431  ; load_U
0005b6  f9b22000          LDRSH    r2,[r2,#0]            ;431  ; U_OUT_KONTR_MAX
0005ba  4290              CMP      r0,r2                 ;431
0005bc  dd01              BLE      |L1.1474|
0005be  2201              MOVS     r2,#1                 ;431
0005c0  700a              STRB     r2,[r1,#0]            ;431
                  |L1.1474|
0005c2  4ab2              LDR      r2,|L1.2188|
0005c4  f9b22000          LDRSH    r2,[r2,#0]            ;432  ; U_OUT_KONTR_MIN
0005c8  4290              CMP      r0,r2                 ;432
0005ca  da01              BGE      |L1.1488|
0005cc  2002              MOVS     r0,#2                 ;432
0005ce  7008              STRB     r0,[r1,#0]            ;432
                  |L1.1488|
0005d0  4628              MOV      r0,r5                 ;434
0005d2  f7fffffe          BL       lc640_read_int
0005d6  1c44              ADDS     r4,r0,#1              ;435
0005d8  2c3f              CMP      r4,#0x3f              ;436
0005da  d900              BLS      |L1.1502|
0005dc  2400              MOVS     r4,#0                 ;436
                  |L1.1502|
0005de  b221              SXTH     r1,r4                 ;437
0005e0  4628              MOV      r0,r5                 ;437
0005e2  f7fffffe          BL       lc640_write_int
0005e6  f6406602          MOV      r6,#0xe02             ;439
0005ea  4630              MOV      r0,r6                 ;439
0005ec  f7fffffe          BL       lc640_read_int
0005f0  283f              CMP      r0,#0x3f              ;440
0005f2  d000              BEQ      |L1.1526|
0005f4  4620              MOV      r0,r4                 ;440
                  |L1.1526|
0005f6  b201              SXTH     r1,r0                 ;441
0005f8  4630              MOV      r0,r6                 ;441
0005fa  f7fffffe          BL       lc640_write_int
0005fe  4628              MOV      r0,r5                 ;443
000600  f7fffffe          BL       lc640_read_int
000604  eb091540          ADD      r5,r9,r0,LSL #5       ;443
000608  2051              MOVS     r0,#0x51              ;445
00060a  f88d0000          STRB     r0,[sp,#0]            ;445
00060e  f88d8001          STRB     r8,[sp,#1]            ;446
000612  2441              MOVS     r4,#0x41              ;447
000614  f88d4002          STRB     r4,[sp,#2]            ;447
000618  f88d8003          STRB     r8,[sp,#3]            ;448
00061c  4669              MOV      r1,sp                 ;449
00061e  4628              MOV      r0,r5                 ;449
000620  f7fffffe          BL       lc640_write_long_ptr
000624  f8cd8000          STR      r8,[sp,#0]            ;454
000628  e000              B        |L1.1580|
                  |L1.1578|
00062a  e05a              B        |L1.1762|
                  |L1.1580|
00062c  4669              MOV      r1,sp                 ;455
00062e  1d28              ADDS     r0,r5,#4              ;455
000630  f7fffffe          BL       lc640_write_long_ptr
000634  f1070720          ADD      r7,r7,#0x20           ;457
000638  8bb8              LDRH     r0,[r7,#0x1c]         ;457
00063a  f88d0000          STRB     r0,[sp,#0]            ;457
00063e  7e38              LDRB     r0,[r7,#0x18]         ;458
000640  f88d0001          STRB     r0,[sp,#1]            ;458
000644  7b38              LDRB     r0,[r7,#0xc]          ;459
000646  f88d0002          STRB     r0,[sp,#2]            ;459
00064a  f88d8003          STRB     r8,[sp,#3]            ;460
00064e  4669              MOV      r1,sp                 ;461
000650  f1050008          ADD      r0,r5,#8              ;461
000654  f7fffffe          BL       lc640_write_long_ptr
000658  7a38              LDRB     r0,[r7,#8]            ;463
00065a  f88d0000          STRB     r0,[sp,#0]            ;463
00065e  7938              LDRB     r0,[r7,#4]            ;464
000660  f88d0001          STRB     r0,[sp,#1]            ;464
000664  7838              LDRB     r0,[r7,#0]            ;465
000666  f88d0002          STRB     r0,[sp,#2]            ;465
00066a  f88d8003          STRB     r8,[sp,#3]            ;466
00066e  4669              MOV      r1,sp                 ;467
000670  f105000c          ADD      r0,r5,#0xc            ;467
000674  f7fffffe          BL       lc640_write_long_ptr
000678  f88d4000          STRB     r4,[sp,#0]            ;469
00067c  f88d4001          STRB     r4,[sp,#1]            ;470
000680  f88d4002          STRB     r4,[sp,#2]            ;471
000684  f88d4003          STRB     r4,[sp,#3]            ;472
000688  4669              MOV      r1,sp                 ;473
00068a  f1050010          ADD      r0,r5,#0x10           ;473
00068e  f7fffffe          BL       lc640_write_long_ptr
000692  f88d4000          STRB     r4,[sp,#0]            ;475
000696  f88d4001          STRB     r4,[sp,#1]            ;476
00069a  f88d4002          STRB     r4,[sp,#2]            ;477
00069e  f88d4003          STRB     r4,[sp,#3]            ;478
0006a2  4669              MOV      r1,sp                 ;479
0006a4  f1050014          ADD      r0,r5,#0x14           ;479
0006a8  f7fffffe          BL       lc640_write_long_ptr
0006ac  f88d4000          STRB     r4,[sp,#0]            ;481
0006b0  f88d4001          STRB     r4,[sp,#1]            ;482
0006b4  f88d4002          STRB     r4,[sp,#2]            ;483
0006b8  f88d4003          STRB     r4,[sp,#3]            ;484
0006bc  4669              MOV      r1,sp                 ;485
0006be  f1050018          ADD      r0,r5,#0x18           ;485
0006c2  f7fffffe          BL       lc640_write_long_ptr
0006c6  f88d4000          STRB     r4,[sp,#0]            ;487
0006ca  f88d4001          STRB     r4,[sp,#1]            ;488
0006ce  f88d4002          STRB     r4,[sp,#2]            ;489
0006d2  f88d4003          STRB     r4,[sp,#3]            ;490
0006d6  4669              MOV      r1,sp                 ;491
0006d8  f105001c          ADD      r0,r5,#0x1c           ;491
0006dc  f7fffffe          BL       lc640_write_long_ptr
0006e0  e080              B        |L1.2020|
                  |L1.1762|
;;;508    	{
;;;509    	uout_av=0;
0006e2  f8818000          STRB     r8,[r1,#0]
;;;510    
;;;511      /*
;;;512    	SET_REG(C2GSR,3,24,8);
;;;513    	C2MOD=0;
;;;514    	bOUT_FREE2=1;*/
;;;515    
;;;516    
;;;517    	//C2MOD=0;
;;;518    
;;;519    	//can2_init(7,8,CANBitrate250k_60MHz);
;;;520    
;;;521         //beep_init(0x02L,'O');
;;;522    	//a_.av.bAN=0;
;;;523    //	SET_REG(avar_stat,0,0,1);
;;;524    
;;;525    	//if(AV_OFF_AVT)a.av.bAN=0;
;;;526    	
;;;527    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,0,1);
;;;528    
;;;529        event_ptr=lc640_read_int(PTR_EVENT_LOG);
0006e6  4628              MOV      r0,r5
0006e8  f7fffffe          BL       lc640_read_int
0006ec  4606              MOV      r6,r0
;;;530    	event_ptr_find=event_ptr;
0006ee  4634              MOV      r4,r6
                  |L1.1776|
;;;531    avar_uout_hndl_lbl1:
;;;532    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0006f0  eb091544          ADD      r5,r9,r4,LSL #5
;;;533    
;;;534         lc640_read_long_ptr(lc640_adr,data);
0006f4  4669              MOV      r1,sp
0006f6  4628              MOV      r0,r5
0006f8  f7fffffe          BL       lc640_read_long_ptr
;;;535         
;;;536         if(!((data[0]=='Q')&&(data[1]==0)&&(data[2]=='A')))
0006fc  f89d0000          LDRB     r0,[sp,#0]
000700  2851              CMP      r0,#0x51
000702  d106              BNE      |L1.1810|
000704  f89d0001          LDRB     r0,[sp,#1]
000708  b918              CBNZ     r0,|L1.1810|
00070a  f89d0002          LDRB     r0,[sp,#2]
00070e  2841              CMP      r0,#0x41
000710  d006              BEQ      |L1.1824|
                  |L1.1810|
;;;537         	{        
;;;538         	if(event_ptr_find)event_ptr_find--;
000712  b10c              CBZ      r4,|L1.1816|
000714  1e64              SUBS     r4,r4,#1
000716  e000              B        |L1.1818|
                  |L1.1816|
;;;539         	else event_ptr_find=63;
000718  243f              MOVS     r4,#0x3f
                  |L1.1818|
;;;540         	if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
00071a  42b4              CMP      r4,r6
00071c  d1e8              BNE      |L1.1776|
00071e  e061              B        |L1.2020|
                  |L1.1824|
;;;541         	else goto avar_uout_hndl_lbl1;
;;;542         	}
;;;543         else 
;;;544         	{
;;;545         	lc640_read_long_ptr(lc640_adr+16,data);
000720  4669              MOV      r1,sp
000722  f1050010          ADD      r0,r5,#0x10
000726  f7fffffe          BL       lc640_read_long_ptr
;;;546         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
00072a  f89d0000          LDRB     r0,[sp,#0]
00072e  2841              CMP      r0,#0x41
000730  d10b              BNE      |L1.1866|
000732  f89d0001          LDRB     r0,[sp,#1]
000736  2841              CMP      r0,#0x41
000738  d107              BNE      |L1.1866|
00073a  f89d0002          LDRB     r0,[sp,#2]
00073e  2841              CMP      r0,#0x41
000740  d103              BNE      |L1.1866|
000742  f89d0003          LDRB     r0,[sp,#3]
000746  2841              CMP      r0,#0x41
000748  d006              BEQ      |L1.1880|
                  |L1.1866|
;;;547         		{        
;;;548         		if(event_ptr_find)event_ptr_find--;
00074a  b10c              CBZ      r4,|L1.1872|
00074c  1e64              SUBS     r4,r4,#1
00074e  e000              B        |L1.1874|
                  |L1.1872|
;;;549             		else event_ptr_find=63;
000750  243f              MOVS     r4,#0x3f
                  |L1.1874|
;;;550             		if(event_ptr_find==event_ptr)goto avar_unet_hndl_end;
000752  42b4              CMP      r4,r6
000754  d1cc              BNE      |L1.1776|
000756  e045              B        |L1.2020|
                  |L1.1880|
;;;551         		else goto avar_uout_hndl_lbl1;
;;;552         		}
;;;553    
;;;554         	}	
;;;555    	
;;;556    	data[0]=LPC_RTC->YEAR;
000758  f1070720          ADD      r7,r7,#0x20
00075c  8bb8              LDRH     r0,[r7,#0x1c]
00075e  f88d0000          STRB     r0,[sp,#0]
;;;557    	data[1]=LPC_RTC->MONTH;
000762  7e38              LDRB     r0,[r7,#0x18]
000764  f88d0001          STRB     r0,[sp,#1]
;;;558    	data[2]=LPC_RTC->DOM;
000768  7b38              LDRB     r0,[r7,#0xc]
00076a  f88d0002          STRB     r0,[sp,#2]
;;;559    	data[3]=0;
00076e  f88d8003          STRB     r8,[sp,#3]
;;;560    	lc640_write_long_ptr(lc640_adr+16,data);
000772  4669              MOV      r1,sp
000774  f1050010          ADD      r0,r5,#0x10
000778  f7fffffe          BL       lc640_write_long_ptr
;;;561    
;;;562    	data[0]=LPC_RTC->HOUR;
00077c  7a38              LDRB     r0,[r7,#8]
00077e  f88d0000          STRB     r0,[sp,#0]
;;;563    	data[1]=LPC_RTC->MIN;
000782  7938              LDRB     r0,[r7,#4]
000784  f88d0001          STRB     r0,[sp,#1]
;;;564    	data[2]=LPC_RTC->SEC;
000788  7838              LDRB     r0,[r7,#0]
00078a  f88d0002          STRB     r0,[sp,#2]
;;;565    	data[3]=0;
00078e  f88d8003          STRB     r8,[sp,#3]
;;;566    	lc640_write_long_ptr(lc640_adr+20,data); 
000792  4669              MOV      r1,sp
000794  f1050014          ADD      r0,r5,#0x14
000798  f7fffffe          BL       lc640_write_long_ptr
;;;567    	
;;;568    	data[0]=*((char*)(&net_Ustore));
00079c  4830              LDR      r0,|L1.2144|
00079e  7801              LDRB     r1,[r0,#0]  ; net_Ustore
0007a0  f88d1000          STRB     r1,[sp,#0]
;;;569    	data[1]=*(((char*)(&net_Ustore))+1);
0007a4  7840              LDRB     r0,[r0,#1]  ; net_Ustore
0007a6  f88d0001          STRB     r0,[sp,#1]
;;;570    	data[2]='B';
0007aa  2442              MOVS     r4,#0x42
0007ac  f88d4002          STRB     r4,[sp,#2]
;;;571    	data[3]='B';
0007b0  f88d4003          STRB     r4,[sp,#3]
;;;572    	lc640_write_long_ptr(lc640_adr+24,data);
0007b4  4669              MOV      r1,sp
0007b6  f1050018          ADD      r0,r5,#0x18
0007ba  f7fffffe          BL       lc640_write_long_ptr
;;;573    	
;;;574    	data[0]='B';
0007be  f88d4000          STRB     r4,[sp,#0]
;;;575    	data[1]='B';
0007c2  f88d4001          STRB     r4,[sp,#1]
;;;576    	data[2]='B';
0007c6  f88d4002          STRB     r4,[sp,#2]
;;;577    	data[3]='B';
0007ca  f88d4003          STRB     r4,[sp,#3]
;;;578    	lc640_write_long_ptr(lc640_adr+28,data);	
0007ce  4669              MOV      r1,sp
0007d0  f105001c          ADD      r0,r5,#0x1c
0007d4  f7fffffe          BL       lc640_write_long_ptr
;;;579    	
;;;580    /*	memo_out0[0]=0x55;
;;;581         memo_out0[1]=0x00+2;
;;;582         memo_out0[2]=1;
;;;583         memo_out0[3]=0x0b;
;;;584         memo_out0[4]=0xaa;
;;;585         memo_out0[5]=0xaa; 
;;;586         	
;;;587         memo_out0[6]=crc_87(memo_out0,6);
;;;588    	memo_out0[7]=crc_95(memo_out0,6);
;;;589         usart_out_adr0(memo_out0,8); */
;;;590         snmp_trap_send("Main power is on",2,1,1);	
0007d8  2301              MOVS     r3,#1
0007da  461a              MOV      r2,r3
0007dc  2102              MOVS     r1,#2
0007de  a02c              ADR      r0,|L1.2192|
0007e0  f7fffffe          BL       snmp_trap_send
                  |L1.2020|
;;;591    	}
;;;592    avar_unet_hndl_end:
;;;593    	__nop();		
0007e4  bf00              NOP      
;;;594    }
0007e6  e6d2              B        |L1.1422|
;;;595    
                          ENDP

                  avar_bps_hndl PROC
;;;596    //-----------------------------------------------
;;;597    void avar_bps_hndl(char dev, char v, char in)
0007e8  e92d4ff8          PUSH     {r3-r11,lr}
;;;598    {
0007ec  4606              MOV      r6,r0
0007ee  460c              MOV      r4,r1
;;;599    char data[4];
;;;600    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;601    char avar_simbol;
;;;602    
;;;603    avar_simbol='T';
0007f0  2754              MOVS     r7,#0x54
;;;604    if(v==0)avar_simbol='T';
0007f2  b15c              CBZ      r4,|L1.2060|
;;;605    else if(v==1)avar_simbol='U';
0007f4  2c01              CMP      r4,#1
0007f6  d004              BEQ      |L1.2050|
;;;606    else if(v==2)avar_simbol='u';
0007f8  2c02              CMP      r4,#2
0007fa  d004              BEQ      |L1.2054|
;;;607    else if(v==3)avar_simbol='L';
0007fc  2c03              CMP      r4,#3
0007fe  d004              BEQ      |L1.2058|
000800  e004              B        |L1.2060|
                  |L1.2050|
000802  2755              MOVS     r7,#0x55              ;605
000804  e002              B        |L1.2060|
                  |L1.2054|
000806  2775              MOVS     r7,#0x75              ;606
000808  e000              B        |L1.2060|
                  |L1.2058|
00080a  274c              MOVS     r7,#0x4c
                  |L1.2060|
;;;608    
;;;609    if(in==1)
;;;610    	{
;;;611    	//av_src[bps]=1;
;;;612    
;;;613    //	SET_REG(avar_ind_stat,1,3+dev,1);
;;;614    //	SET_REG(avar_stat,1,3+dev,1);
;;;615    	
;;;616    	if(v==0)bps[dev]._av|=(1<<0);
00080c  4825              LDR      r0,|L1.2212|
00080e  ebc601c6          RSB      r1,r6,r6,LSL #3
;;;617    	else if(v==1) bps[dev]._av|=(1<<1);
;;;618    	else if(v==2) bps[dev]._av|=(1<<2);
;;;619    	else if(v==3) bps[dev]._av|=(1<<3);
;;;620    
;;;621    	bps[dev]._last_avar=v;
;;;622    
;;;623    	//beep_init(0x33333333,'A');
;;;624    
;;;625    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;626    	event_ptr++;	
;;;627    	if(event_ptr>63)event_ptr=0;	
;;;628    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;629    	
;;;630         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;631    	if(event_cnt!=63)event_cnt=event_ptr;
;;;632    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;633    	
;;;634    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;635    	
;;;636    	data[0]='S';
;;;637    	data[1]=dev; 
;;;638    	data[2]=avar_simbol;
;;;639    	data[3]=0;
;;;640    	lc640_write_long_ptr(lc640_adr,data);
;;;641    
;;;642    	data[0]=0;
;;;643    	data[1]=0;
;;;644    	data[2]=0;
;;;645    	data[3]=0;
;;;646    	lc640_write_long_ptr(lc640_adr+4,data);
;;;647    
;;;648    	data[0]=LPC_RTC->YEAR;
000812  f8df8068          LDR      r8,|L1.2172|
000816  eb011106          ADD      r1,r1,r6,LSL #4       ;616
00081a  f04f0900          MOV      r9,#0                 ;598
00081e  f44f6a60          MOV      r10,#0xe00            ;625
000822  f44f6580          MOV      r5,#0x400             ;634
000826  eb000081          ADD      r0,r0,r1,LSL #2       ;616
00082a  2a01              CMP      r2,#1                 ;609
00082c  d001              BEQ      |L1.2098|
;;;649    	data[1]=LPC_RTC->MONTH;
;;;650    	data[2]=LPC_RTC->DOM;
;;;651    	data[3]=0;
;;;652    	lc640_write_long_ptr(lc640_adr+8,data);
;;;653    
;;;654    	data[0]=LPC_RTC->HOUR;
;;;655    	data[1]=LPC_RTC->MIN;
;;;656    	data[2]=LPC_RTC->SEC;
;;;657    	data[3]=0;
;;;658    	lc640_write_long_ptr(lc640_adr+12,data);
;;;659    	
;;;660    	data[0]='A';
;;;661    	data[1]='A';
;;;662    	data[2]='A';
;;;663    	data[3]='A';
;;;664    	lc640_write_long_ptr(lc640_adr+16,data);
;;;665    	
;;;666    	data[0]='A';
;;;667    	data[1]='A';
;;;668    	data[2]='A';
;;;669    	data[3]='A';
;;;670    	lc640_write_long_ptr(lc640_adr+20,data);
;;;671    	
;;;672    	data[0]='A';
;;;673    	data[1]='A';
;;;674    	data[2]='A';
;;;675    	data[3]='A';
;;;676    	lc640_write_long_ptr(lc640_adr+24,data);
;;;677    	
;;;678    	data[0]='A';
;;;679    	data[1]='A';
;;;680    	data[2]='A';
;;;681    	data[3]='A';
;;;682    	lc640_write_long_ptr(lc640_adr+28,data);		
;;;683    
;;;684    
;;;685    	if(dev==0)
;;;686    		{
;;;687    		if(v==0)
;;;688    		snmp_trap_send("BPS #1 Alarm, overheat",4,1,0);
;;;689    		else if(v==1)
;;;690    		snmp_trap_send("BPS #1 Alarm, voltage is up",4,1,1);
;;;691    		else if(v==2)
;;;692    		snmp_trap_send("BPS #1 Alarm, voltage is down",4,1,2);
;;;693    		else if(v==3)
;;;694    		snmp_trap_send("BPS #1 Alarm, connect is lost",4,1,3);
;;;695    		}
;;;696    	else if(dev==1)
;;;697    		{
;;;698    		if(v==0)
;;;699    		snmp_trap_send("BPS #2 Alarm, overheat",4,2,0);
;;;700    		else if(v==1)
;;;701    		snmp_trap_send("BPS #2 Alarm, voltage is up",4,2,1);
;;;702    		else if(v==2)
;;;703    		snmp_trap_send("BPS #2 Alarm, voltage is down",4,2,2);
;;;704    		else if(v==3)
;;;705    		snmp_trap_send("BPS #2 Alarm, connect is lost",4,2,3);
;;;706    		} 
;;;707    	else if(dev==2)
;;;708    		{
;;;709    		if(v==0)
;;;710    		snmp_trap_send("BPS #3 Alarm, overheat",4,3,0);
;;;711    		else if(v==1)
;;;712    		snmp_trap_send("BPS #3 Alarm, voltage is up",4,3,1);
;;;713    		else if(v==2)
;;;714    		snmp_trap_send("BPS #3 Alarm, voltage is down",4,3,2);
;;;715    		else if(v==3)
;;;716    		snmp_trap_send("BPS #3 Alarm, connect is lost",4,3,3);
;;;717    		} 	
;;;718    			
;;;719    	}
;;;720    
;;;721    else if(in==0)
00082e  b142              CBZ      r2,|L1.2114|
000830  e1ee              B        |L1.3088|
                  |L1.2098|
000832  b3cc              CBZ      r4,|L1.2216|
000834  2c01              CMP      r4,#1                 ;617
000836  d03d              BEQ      |L1.2228|
000838  2c02              CMP      r4,#2                 ;618
00083a  d040              BEQ      |L1.2238|
00083c  2c03              CMP      r4,#3                 ;619
00083e  d043              BEQ      |L1.2248|
000840  e046              B        |L1.2256|
                  |L1.2114|
000842  e14a              B        |L1.2778|
                  |L1.2116|
000844  4d61696e          DCB      "Main power alarm",0
000848  20706f77
00084c  65722061
000850  6c61726d
000854  00      
000855  00                DCB      0
000856  00                DCB      0
000857  00                DCB      0
                  |L1.2136|
                          DCD      ||.data||
                  |L1.2140|
                          DCD      AV_OFF_AVT
                  |L1.2144|
                          DCD      net_Ustore
                  |L1.2148|
000864  4d61696e          DCB      "Main power alarm  clear",0
000868  20706f77
00086c  65722061
000870  6c61726d
000874  2020636c
000878  65617200
                  |L1.2172|
                          DCD      0x40024000
                  |L1.2176|
                          DCD      uout_av
                  |L1.2180|
                          DCD      load_U
                  |L1.2184|
                          DCD      U_OUT_KONTR_MAX
                  |L1.2188|
                          DCD      U_OUT_KONTR_MIN
                  |L1.2192|
000890  4d61696e          DCB      "Main power is on",0
000894  20706f77
000898  65722069
00089c  73206f6e
0008a0  00      
0008a1  00                DCB      0
0008a2  00                DCB      0
0008a3  00                DCB      0
                  |L1.2212|
                          DCD      bps
                  |L1.2216|
0008a8  e7ff              B        |L1.2218|
                  |L1.2218|
0008aa  7841              LDRB     r1,[r0,#1]            ;616
0008ac  f0410101          ORR      r1,r1,#1              ;616
0008b0  7041              STRB     r1,[r0,#1]            ;616
0008b2  e00d              B        |L1.2256|
                  |L1.2228|
0008b4  7841              LDRB     r1,[r0,#1]            ;617
0008b6  f0410102          ORR      r1,r1,#2              ;617
0008ba  7041              STRB     r1,[r0,#1]            ;617
0008bc  e008              B        |L1.2256|
                  |L1.2238|
0008be  7841              LDRB     r1,[r0,#1]            ;618
0008c0  f0410104          ORR      r1,r1,#4              ;618
0008c4  7041              STRB     r1,[r0,#1]            ;618
0008c6  e003              B        |L1.2256|
                  |L1.2248|
0008c8  7841              LDRB     r1,[r0,#1]            ;619
0008ca  f0410108          ORR      r1,r1,#8              ;619
0008ce  7041              STRB     r1,[r0,#1]            ;619
                  |L1.2256|
0008d0  f8804053          STRB     r4,[r0,#0x53]         ;621
0008d4  4650              MOV      r0,r10                ;625
0008d6  f7fffffe          BL       lc640_read_int
0008da  1c40              ADDS     r0,r0,#1              ;626
0008dc  fa1ffb80          UXTH     r11,r0                ;626
0008e0  f1bb0f3f          CMP      r11,#0x3f             ;627
0008e4  d901              BLS      |L1.2282|
0008e6  f04f0b00          MOV      r11,#0                ;627
                  |L1.2282|
0008ea  fa0ff18b          SXTH     r1,r11                ;628
0008ee  4650              MOV      r0,r10                ;628
0008f0  f7fffffe          BL       lc640_write_int
0008f4  f6406002          MOV      r0,#0xe02             ;630
0008f8  f7fffffe          BL       lc640_read_int
0008fc  b280              UXTH     r0,r0                 ;630
0008fe  283f              CMP      r0,#0x3f              ;631
000900  d000              BEQ      |L1.2308|
000902  4658              MOV      r0,r11                ;631
                  |L1.2308|
000904  b201              SXTH     r1,r0                 ;632
000906  f6406002          MOV      r0,#0xe02             ;632
00090a  f7fffffe          BL       lc640_write_int
00090e  4650              MOV      r0,r10                ;634
000910  f7fffffe          BL       lc640_read_int
000914  eb051040          ADD      r0,r5,r0,LSL #5       ;634
000918  b285              UXTH     r5,r0                 ;634
00091a  2053              MOVS     r0,#0x53              ;636
00091c  f88d0000          STRB     r0,[sp,#0]            ;636
000920  f88d6001          STRB     r6,[sp,#1]            ;637
000924  f88d7002          STRB     r7,[sp,#2]            ;638
000928  f88d9003          STRB     r9,[sp,#3]            ;639
00092c  4669              MOV      r1,sp                 ;640
00092e  4628              MOV      r0,r5                 ;640
000930  f7fffffe          BL       lc640_write_long_ptr
000934  f8cd9000          STR      r9,[sp,#0]            ;645
000938  4669              MOV      r1,sp                 ;646
00093a  1d28              ADDS     r0,r5,#4              ;646
00093c  f7fffffe          BL       lc640_write_long_ptr
000940  f8b8003c          LDRH     r0,[r8,#0x3c]         ;648
000944  f88d0000          STRB     r0,[sp,#0]            ;648
000948  f8980038          LDRB     r0,[r8,#0x38]         ;649
00094c  f88d0001          STRB     r0,[sp,#1]            ;649
000950  f898002c          LDRB     r0,[r8,#0x2c]         ;650
000954  f88d0002          STRB     r0,[sp,#2]            ;650
000958  f88d9003          STRB     r9,[sp,#3]            ;651
00095c  4669              MOV      r1,sp                 ;652
00095e  f1050008          ADD      r0,r5,#8              ;652
000962  f7fffffe          BL       lc640_write_long_ptr
000966  f8980028          LDRB     r0,[r8,#0x28]         ;654
00096a  f88d0000          STRB     r0,[sp,#0]            ;654
00096e  f8980024          LDRB     r0,[r8,#0x24]         ;655
000972  f88d0001          STRB     r0,[sp,#1]            ;655
000976  f8980020          LDRB     r0,[r8,#0x20]         ;656
00097a  f88d0002          STRB     r0,[sp,#2]            ;656
00097e  f88d9003          STRB     r9,[sp,#3]            ;657
000982  4669              MOV      r1,sp                 ;658
000984  f105000c          ADD      r0,r5,#0xc            ;658
000988  f7fffffe          BL       lc640_write_long_ptr
00098c  2741              MOVS     r7,#0x41              ;660
00098e  f88d7000          STRB     r7,[sp,#0]            ;660
000992  f88d7001          STRB     r7,[sp,#1]            ;661
000996  f88d7002          STRB     r7,[sp,#2]            ;662
00099a  f88d7003          STRB     r7,[sp,#3]            ;663
00099e  4669              MOV      r1,sp                 ;664
0009a0  f1050010          ADD      r0,r5,#0x10           ;664
0009a4  f7fffffe          BL       lc640_write_long_ptr
0009a8  f88d7000          STRB     r7,[sp,#0]            ;666
0009ac  f88d7001          STRB     r7,[sp,#1]            ;667
0009b0  f88d7002          STRB     r7,[sp,#2]            ;668
0009b4  f88d7003          STRB     r7,[sp,#3]            ;669
0009b8  4669              MOV      r1,sp                 ;670
0009ba  f1050014          ADD      r0,r5,#0x14           ;670
0009be  f7fffffe          BL       lc640_write_long_ptr
0009c2  f88d7000          STRB     r7,[sp,#0]            ;672
0009c6  f88d7001          STRB     r7,[sp,#1]            ;673
0009ca  f88d7002          STRB     r7,[sp,#2]            ;674
0009ce  f88d7003          STRB     r7,[sp,#3]            ;675
0009d2  4669              MOV      r1,sp                 ;676
0009d4  f1050018          ADD      r0,r5,#0x18           ;676
0009d8  f7fffffe          BL       lc640_write_long_ptr
0009dc  f88d7000          STRB     r7,[sp,#0]            ;678
0009e0  f88d7001          STRB     r7,[sp,#1]            ;679
0009e4  f88d7002          STRB     r7,[sp,#2]            ;680
0009e8  f88d7003          STRB     r7,[sp,#3]            ;681
0009ec  4669              MOV      r1,sp                 ;682
0009ee  f105001c          ADD      r0,r5,#0x1c           ;682
0009f2  f7fffffe          BL       lc640_write_long_ptr
0009f6  b126              CBZ      r6,|L1.2562|
0009f8  2e01              CMP      r6,#1                 ;696
0009fa  d026              BEQ      |L1.2634|
0009fc  2e02              CMP      r6,#2                 ;707
0009fe  d048              BEQ      |L1.2706|
000a00  e106              B        |L1.3088|
                  |L1.2562|
000a02  b134              CBZ      r4,|L1.2578|
000a04  2c01              CMP      r4,#1                 ;689
000a06  d00b              BEQ      |L1.2592|
000a08  2c02              CMP      r4,#2                 ;691
000a0a  d010              BEQ      |L1.2606|
000a0c  2c03              CMP      r4,#3                 ;693
000a0e  d015              BEQ      |L1.2620|
000a10  e0fe              B        |L1.3088|
                  |L1.2578|
000a12  2300              MOVS     r3,#0                 ;688
000a14  2201              MOVS     r2,#1                 ;688
000a16  2104              MOVS     r1,#4                 ;688
000a18  a0de              ADR      r0,|L1.3476|
000a1a  f7fffffe          BL       snmp_trap_send
000a1e  e0f7              B        |L1.3088|
                  |L1.2592|
000a20  2301              MOVS     r3,#1                 ;690
000a22  461a              MOV      r2,r3                 ;690
000a24  2104              MOVS     r1,#4                 ;690
000a26  a0e1              ADR      r0,|L1.3500|
000a28  f7fffffe          BL       snmp_trap_send
000a2c  e0f0              B        |L1.3088|
                  |L1.2606|
000a2e  2302              MOVS     r3,#2                 ;692
000a30  2201              MOVS     r2,#1                 ;692
000a32  2104              MOVS     r1,#4                 ;692
000a34  a0e4              ADR      r0,|L1.3528|
000a36  f7fffffe          BL       snmp_trap_send
000a3a  e0e9              B        |L1.3088|
                  |L1.2620|
000a3c  2303              MOVS     r3,#3                 ;694
000a3e  2201              MOVS     r2,#1                 ;694
000a40  2104              MOVS     r1,#4                 ;694
000a42  a0e9              ADR      r0,|L1.3560|
000a44  f7fffffe          BL       snmp_trap_send
000a48  e0e2              B        |L1.3088|
                  |L1.2634|
000a4a  b134              CBZ      r4,|L1.2650|
000a4c  2c01              CMP      r4,#1                 ;700
000a4e  d00b              BEQ      |L1.2664|
000a50  2c02              CMP      r4,#2                 ;702
000a52  d010              BEQ      |L1.2678|
000a54  2c03              CMP      r4,#3                 ;704
000a56  d015              BEQ      |L1.2692|
000a58  e0da              B        |L1.3088|
                  |L1.2650|
000a5a  2300              MOVS     r3,#0                 ;699
000a5c  2202              MOVS     r2,#2                 ;699
000a5e  2104              MOVS     r1,#4                 ;699
000a60  a0e9              ADR      r0,|L1.3592|
000a62  f7fffffe          BL       snmp_trap_send
000a66  e0d3              B        |L1.3088|
                  |L1.2664|
000a68  2301              MOVS     r3,#1                 ;701
000a6a  2202              MOVS     r2,#2                 ;701
000a6c  2104              MOVS     r1,#4                 ;701
000a6e  a0ec              ADR      r0,|L1.3616|
000a70  f7fffffe          BL       snmp_trap_send
000a74  e0cc              B        |L1.3088|
                  |L1.2678|
000a76  2302              MOVS     r3,#2                 ;703
000a78  461a              MOV      r2,r3                 ;703
000a7a  2104              MOVS     r1,#4                 ;703
000a7c  a0ef              ADR      r0,|L1.3644|
000a7e  f7fffffe          BL       snmp_trap_send
000a82  e0c5              B        |L1.3088|
                  |L1.2692|
000a84  2303              MOVS     r3,#3                 ;705
000a86  2202              MOVS     r2,#2                 ;705
000a88  2104              MOVS     r1,#4                 ;705
000a8a  a0f4              ADR      r0,|L1.3676|
000a8c  f7fffffe          BL       snmp_trap_send
000a90  e0be              B        |L1.3088|
                  |L1.2706|
000a92  b134              CBZ      r4,|L1.2722|
000a94  2c01              CMP      r4,#1                 ;711
000a96  d00b              BEQ      |L1.2736|
000a98  2c02              CMP      r4,#2                 ;713
000a9a  d010              BEQ      |L1.2750|
000a9c  2c03              CMP      r4,#3                 ;715
000a9e  d015              BEQ      |L1.2764|
000aa0  e0b6              B        |L1.3088|
                  |L1.2722|
000aa2  2300              MOVS     r3,#0                 ;710
000aa4  2203              MOVS     r2,#3                 ;710
000aa6  2104              MOVS     r1,#4                 ;710
000aa8  a0f4              ADR      r0,|L1.3708|
000aaa  f7fffffe          BL       snmp_trap_send
000aae  e0af              B        |L1.3088|
                  |L1.2736|
000ab0  2301              MOVS     r3,#1                 ;712
000ab2  2203              MOVS     r2,#3                 ;712
000ab4  2104              MOVS     r1,#4                 ;712
000ab6  a0f7              ADR      r0,|L1.3732|
000ab8  f7fffffe          BL       snmp_trap_send
000abc  e0a8              B        |L1.3088|
                  |L1.2750|
000abe  2302              MOVS     r3,#2                 ;714
000ac0  2203              MOVS     r2,#3                 ;714
000ac2  2104              MOVS     r1,#4                 ;714
000ac4  a0fa              ADR      r0,|L1.3760|
000ac6  f7fffffe          BL       snmp_trap_send
000aca  e0a1              B        |L1.3088|
                  |L1.2764|
000acc  2303              MOVS     r3,#3                 ;716
000ace  461a              MOV      r2,r3                 ;716
000ad0  2104              MOVS     r1,#4                 ;716
000ad2  a0ff              ADR      r0,|L1.3792|
000ad4  f7fffffe          BL       snmp_trap_send
000ad8  e09a              B        |L1.3088|
                  |L1.2778|
;;;722    	{      
;;;723    //	av_bps[bps]=0;
;;;724    
;;;725    	//SET_REG(avar_stat,0,3+bps,1);
;;;726    	//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;727    
;;;728         if(v==0) bps[dev]._av&=(~(1<<0));
000ada  b134              CBZ      r4,|L1.2794|
;;;729         else if(v==1) bps[dev]._av&=(~(1<<1));
000adc  2c01              CMP      r4,#1
000ade  d009              BEQ      |L1.2804|
;;;730    	else if(v==2) bps[dev]._av&=(~(1<<2));
000ae0  2c02              CMP      r4,#2
000ae2  d00c              BEQ      |L1.2814|
;;;731    	else if(v==3) bps[dev]._av&=(~(1<<3));
000ae4  2c03              CMP      r4,#3
000ae6  d00f              BEQ      |L1.2824|
000ae8  e012              B        |L1.2832|
                  |L1.2794|
000aea  7841              LDRB     r1,[r0,#1]            ;728
000aec  f0210101          BIC      r1,r1,#1              ;728
000af0  7041              STRB     r1,[r0,#1]            ;728
000af2  e00d              B        |L1.2832|
                  |L1.2804|
000af4  7841              LDRB     r1,[r0,#1]            ;729
000af6  f0210102          BIC      r1,r1,#2              ;729
000afa  7041              STRB     r1,[r0,#1]            ;729
000afc  e008              B        |L1.2832|
                  |L1.2814|
000afe  7841              LDRB     r1,[r0,#1]            ;730
000b00  f0210104          BIC      r1,r1,#4              ;730
000b04  7041              STRB     r1,[r0,#1]            ;730
000b06  e003              B        |L1.2832|
                  |L1.2824|
000b08  7841              LDRB     r1,[r0,#1]
000b0a  f0210108          BIC      r1,r1,#8
000b0e  7041              STRB     r1,[r0,#1]
                  |L1.2832|
;;;732         
;;;733    //	if((bps[dev]._av&0x0f==0))
;;;734    //	     {
;;;735    		//SET_REG(avar_stat,0,3+bps,1);
;;;736    		//if(AV_OFF_AVT) SET_REG(avar_ind_stat,0,3+bps,1);
;;;737    //	     }
;;;738     
;;;739    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
000b10  4650              MOV      r0,r10
000b12  f7fffffe          BL       lc640_read_int
000b16  fa1ffb80          UXTH     r11,r0
;;;740    	event_ptr_find=event_ptr;
000b1a  465c              MOV      r4,r11
                  |L1.2844|
;;;741    	
;;;742    avar_src_hndl_lbl1: 
;;;743    
;;;744    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
000b1c  eb051044          ADD      r0,r5,r4,LSL #5
000b20  fa1ffa80          UXTH     r10,r0
;;;745    
;;;746         lc640_read_long_ptr(lc640_adr,data);
000b24  4669              MOV      r1,sp
000b26  4650              MOV      r0,r10
000b28  f7fffffe          BL       lc640_read_long_ptr
;;;747         
;;;748         if(!((data[0]=='S')&&(data[1]==dev)&&(data[2]==avar_simbol)))
000b2c  f89d0000          LDRB     r0,[sp,#0]
000b30  2853              CMP      r0,#0x53
000b32  d107              BNE      |L1.2884|
000b34  f89d0001          LDRB     r0,[sp,#1]
000b38  42b0              CMP      r0,r6
000b3a  d103              BNE      |L1.2884|
000b3c  f89d0002          LDRB     r0,[sp,#2]
000b40  42b8              CMP      r0,r7
000b42  d007              BEQ      |L1.2900|
                  |L1.2884|
;;;749         	{        
;;;750         	if(event_ptr_find)event_ptr_find--;
000b44  b114              CBZ      r4,|L1.2892|
000b46  1e64              SUBS     r4,r4,#1
000b48  b2a4              UXTH     r4,r4
000b4a  e000              B        |L1.2894|
                  |L1.2892|
;;;751         	else event_ptr_find=63;
000b4c  243f              MOVS     r4,#0x3f
                  |L1.2894|
;;;752         	if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000b4e  455c              CMP      r4,r11
000b50  d1e4              BNE      |L1.2844|
000b52  e05d              B        |L1.3088|
                  |L1.2900|
;;;753         	else goto avar_src_hndl_lbl1;
;;;754         	}
;;;755         else 
;;;756         	{
;;;757         	lc640_read_long_ptr(lc640_adr+16,data);
000b54  4669              MOV      r1,sp
000b56  f10a0010          ADD      r0,r10,#0x10
000b5a  f7fffffe          BL       lc640_read_long_ptr
;;;758         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
000b5e  f89d0000          LDRB     r0,[sp,#0]
000b62  2841              CMP      r0,#0x41
000b64  d10b              BNE      |L1.2942|
000b66  f89d0001          LDRB     r0,[sp,#1]
000b6a  2841              CMP      r0,#0x41
000b6c  d107              BNE      |L1.2942|
000b6e  f89d0002          LDRB     r0,[sp,#2]
000b72  2841              CMP      r0,#0x41
000b74  d103              BNE      |L1.2942|
000b76  f89d0003          LDRB     r0,[sp,#3]
000b7a  2841              CMP      r0,#0x41
000b7c  d007              BEQ      |L1.2958|
                  |L1.2942|
;;;759         		{        
;;;760         		if(event_ptr_find)event_ptr_find--;
000b7e  b114              CBZ      r4,|L1.2950|
000b80  1e64              SUBS     r4,r4,#1
000b82  b2a4              UXTH     r4,r4
000b84  e000              B        |L1.2952|
                  |L1.2950|
;;;761             		else event_ptr_find=63;
000b86  243f              MOVS     r4,#0x3f
                  |L1.2952|
;;;762             		if(event_ptr_find==event_ptr)goto avar_src_hndl_end;
000b88  455c              CMP      r4,r11
000b8a  d1c7              BNE      |L1.2844|
000b8c  e040              B        |L1.3088|
                  |L1.2958|
;;;763         		else goto avar_src_hndl_lbl1;
;;;764         		}
;;;765    
;;;766         	}	
;;;767    
;;;768    
;;;769    	
;;;770    	data[0]=LPC_RTC->YEAR;
000b8e  f8b8003c          LDRH     r0,[r8,#0x3c]
000b92  f88d0000          STRB     r0,[sp,#0]
;;;771    	data[1]=LPC_RTC->MONTH;
000b96  f8980038          LDRB     r0,[r8,#0x38]
000b9a  f88d0001          STRB     r0,[sp,#1]
;;;772    	data[2]=LPC_RTC->DOM;
000b9e  f898002c          LDRB     r0,[r8,#0x2c]
000ba2  f88d0002          STRB     r0,[sp,#2]
;;;773    	data[3]=0;
000ba6  f88d9003          STRB     r9,[sp,#3]
;;;774    	lc640_write_long_ptr(lc640_adr+16,data);
000baa  4669              MOV      r1,sp
000bac  f10a0010          ADD      r0,r10,#0x10
000bb0  f7fffffe          BL       lc640_write_long_ptr
;;;775    
;;;776    	data[0]=LPC_RTC->HOUR;
000bb4  f8980028          LDRB     r0,[r8,#0x28]
000bb8  f88d0000          STRB     r0,[sp,#0]
;;;777    	data[1]=LPC_RTC->MIN;
000bbc  f8980024          LDRB     r0,[r8,#0x24]
000bc0  f88d0001          STRB     r0,[sp,#1]
;;;778    	data[2]=LPC_RTC->SEC;
000bc4  f8980020          LDRB     r0,[r8,#0x20]
000bc8  f88d0002          STRB     r0,[sp,#2]
;;;779    	data[3]=0;
000bcc  f88d9003          STRB     r9,[sp,#3]
;;;780    	lc640_write_long_ptr(lc640_adr+20,data);
000bd0  4669              MOV      r1,sp
000bd2  f10a0014          ADD      r0,r10,#0x14
000bd6  f7fffffe          BL       lc640_write_long_ptr
;;;781    	
;;;782    	data[0]='B';
000bda  2442              MOVS     r4,#0x42
000bdc  f88d4000          STRB     r4,[sp,#0]
;;;783    	data[1]='B';
000be0  f88d4001          STRB     r4,[sp,#1]
;;;784    	data[2]='B';
000be4  f88d4002          STRB     r4,[sp,#2]
;;;785    	data[3]='B';
000be8  f88d4003          STRB     r4,[sp,#3]
;;;786    	lc640_write_long_ptr(lc640_adr+24,data);
000bec  4669              MOV      r1,sp
000bee  f10a0018          ADD      r0,r10,#0x18
000bf2  f7fffffe          BL       lc640_write_long_ptr
;;;787    	
;;;788    	data[0]='B';
000bf6  f88d4000          STRB     r4,[sp,#0]
;;;789    	data[1]='B';
000bfa  f88d4001          STRB     r4,[sp,#1]
;;;790    	data[2]='B';
000bfe  f88d4002          STRB     r4,[sp,#2]
;;;791    	data[3]='B';
000c02  f88d4003          STRB     r4,[sp,#3]
;;;792    	lc640_write_long_ptr(lc640_adr+28,data);
000c06  4669              MOV      r1,sp
000c08  f10a001c          ADD      r0,r10,#0x1c
000c0c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3088|
;;;793    	
;;;794    	}
;;;795    	
;;;796    avar_src_hndl_end:
;;;797    __nop();		
000c10  bf00              NOP      
                  |L1.3090|
;;;798    }
000c12  e8bd8ff8          POP      {r3-r11,pc}
;;;799    
                          ENDP

                  wrk_mem_hndl PROC
;;;800    //-----------------------------------------------
;;;801    void wrk_mem_hndl(char b)
000c16  e92d41fc          PUSH     {r2-r8,lr}
;;;802    {
000c1a  4606              MOV      r6,r0
;;;803    char data[4];
;;;804    unsigned short event_ptr,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;805    
;;;806    signed short temp_temp;
;;;807    
;;;808    if(bat[b]._Iintegr_<5) goto wrk_mem_hndl_end;
000c1c  eb060046          ADD      r0,r6,r6,LSL #1
000c20  eb001106          ADD      r1,r0,r6,LSL #4
000c24  48b2              LDR      r0,|L1.3824|
000c26  eb000481          ADD      r4,r0,r1,LSL #2
000c2a  8be0              LDRH     r0,[r4,#0x1e]
000c2c  2805              CMP      r0,#5
000c2e  d379              BCC      |L1.3364|
;;;809    
;;;810    temp_temp=bat[b]._u_old[((bat_u_old_cnt+6)&0x07)]; 
000c30  48b0              LDR      r0,|L1.3828|
000c32  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000c34  1d80              ADDS     r0,r0,#6
000c36  f0000007          AND      r0,r0,#7
000c3a  eb040040          ADD      r0,r4,r0,LSL #1
000c3e  8c00              LDRH     r0,[r0,#0x20]
000c40  9000              STR      r0,[sp,#0]
;;;811    
;;;812    
;;;813    event_ptr=lc640_read_int(PTR_EVENT_LOG);
000c42  f44f6760          MOV      r7,#0xe00
000c46  4638              MOV      r0,r7
000c48  f7fffffe          BL       lc640_read_int
;;;814    event_ptr++;	
000c4c  1c40              ADDS     r0,r0,#1
000c4e  b285              UXTH     r5,r0
;;;815    if(event_ptr>63)event_ptr=0;	
000c50  2d3f              CMP      r5,#0x3f
000c52  d900              BLS      |L1.3158|
000c54  2500              MOVS     r5,#0
                  |L1.3158|
;;;816    lc640_write_int(PTR_EVENT_LOG,event_ptr);	
000c56  b229              SXTH     r1,r5
000c58  4638              MOV      r0,r7
000c5a  f7fffffe          BL       lc640_write_int
;;;817    	
;;;818    event_cnt=lc640_read_int(CNT_EVENT_LOG);
000c5e  f6406802          MOV      r8,#0xe02
000c62  4640              MOV      r0,r8
000c64  f7fffffe          BL       lc640_read_int
000c68  b280              UXTH     r0,r0
;;;819    if(event_cnt!=63)event_cnt=event_ptr;
000c6a  283f              CMP      r0,#0x3f
000c6c  d000              BEQ      |L1.3184|
000c6e  4628              MOV      r0,r5
                  |L1.3184|
;;;820    lc640_write_int(CNT_EVENT_LOG,event_cnt); 
000c70  b201              SXTH     r1,r0
000c72  4640              MOV      r0,r8
000c74  f7fffffe          BL       lc640_write_int
;;;821    	
;;;822    lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
000c78  4638              MOV      r0,r7
000c7a  f7fffffe          BL       lc640_read_int
000c7e  f44f6180          MOV      r1,#0x400
000c82  eb011040          ADD      r0,r1,r0,LSL #5
000c86  b285              UXTH     r5,r0
;;;823    	
;;;824    data[0]='B';
000c88  2042              MOVS     r0,#0x42
000c8a  f88d0004          STRB     r0,[sp,#4]
;;;825    data[1]=b; 
000c8e  f88d6005          STRB     r6,[sp,#5]
;;;826    data[2]='W';
000c92  2057              MOVS     r0,#0x57
000c94  f88d0006          STRB     r0,[sp,#6]
;;;827    data[3]=0;
000c98  2600              MOVS     r6,#0
000c9a  f88d6007          STRB     r6,[sp,#7]
;;;828    
;;;829    lc640_write_long_ptr(lc640_adr,data);
000c9e  a901              ADD      r1,sp,#4
000ca0  4628              MOV      r0,r5
000ca2  f7fffffe          BL       lc640_write_long_ptr
;;;830    
;;;831    data[0]=*((char*)&bat[b]._Iintegr_);
000ca6  7fa0              LDRB     r0,[r4,#0x1e]
000ca8  f88d0004          STRB     r0,[sp,#4]
;;;832    data[1]=*(((char*)(&bat[b]._Iintegr_))+1);
000cac  7fe0              LDRB     r0,[r4,#0x1f]
000cae  f88d0005          STRB     r0,[sp,#5]
;;;833    data[2]=*((char*)&temp_temp);
000cb2  f89d0000          LDRB     r0,[sp,#0]
000cb6  f88d0006          STRB     r0,[sp,#6]
;;;834    data[3]=*(((char*)(&temp_temp))+1);
000cba  f89d0001          LDRB     r0,[sp,#1]
000cbe  f88d0007          STRB     r0,[sp,#7]
;;;835    lc640_write_long_ptr(lc640_adr+4,data);
000cc2  a901              ADD      r1,sp,#4
000cc4  1d28              ADDS     r0,r5,#4
000cc6  f7fffffe          BL       lc640_write_long_ptr
;;;836    
;;;837    lc640_write_long_ptr(lc640_adr+8,(char*)&bat[b]._wrk_date[0]);
000cca  f1040134          ADD      r1,r4,#0x34
000cce  f1050008          ADD      r0,r5,#8
000cd2  f7fffffe          BL       lc640_write_long_ptr
;;;838    	
;;;839    lc640_write_long_ptr(lc640_adr+12,(char*)&bat[b]._wrk_date[1]);
000cd6  f1040138          ADD      r1,r4,#0x38
000cda  f105000c          ADD      r0,r5,#0xc
000cde  f7fffffe          BL       lc640_write_long_ptr
;;;840    
;;;841    data[0]=LPC_RTC->YEAR;
000ce2  4c85              LDR      r4,|L1.3832|
000ce4  8ba0              LDRH     r0,[r4,#0x1c]
000ce6  f88d0004          STRB     r0,[sp,#4]
;;;842    data[1]=LPC_RTC->MONTH;
000cea  7e20              LDRB     r0,[r4,#0x18]
000cec  f88d0005          STRB     r0,[sp,#5]
;;;843    data[2]=LPC_RTC->DOM;
000cf0  7b20              LDRB     r0,[r4,#0xc]
000cf2  f88d0006          STRB     r0,[sp,#6]
;;;844    data[3]=0;
000cf6  f88d6007          STRB     r6,[sp,#7]
;;;845    lc640_write_long_ptr(lc640_adr+16,data);
000cfa  a901              ADD      r1,sp,#4
000cfc  f1050010          ADD      r0,r5,#0x10
000d00  f7fffffe          BL       lc640_write_long_ptr
;;;846    
;;;847    data[0]=LPC_RTC->HOUR;
000d04  7a20              LDRB     r0,[r4,#8]
000d06  f88d0004          STRB     r0,[sp,#4]
;;;848    data[1]=LPC_RTC->MIN;
000d0a  7920              LDRB     r0,[r4,#4]
000d0c  f88d0005          STRB     r0,[sp,#5]
;;;849    data[2]=LPC_RTC->SEC;
000d10  7820              LDRB     r0,[r4,#0]
000d12  f88d0006          STRB     r0,[sp,#6]
;;;850    data[3]=0;
000d16  f88d6007          STRB     r6,[sp,#7]
;;;851    lc640_write_long_ptr(lc640_adr+20,data);
000d1a  a901              ADD      r1,sp,#4
000d1c  f1050014          ADD      r0,r5,#0x14
000d20  f7fffffe          BL       lc640_write_long_ptr
                  |L1.3364|
;;;852    	
;;;853    
;;;854    
;;;855    	
;;;856    wrk_mem_hndl_end:	
;;;857    __nop();
000d24  bf00              NOP      
;;;858    }  
000d26  e8bd81fc          POP      {r2-r8,pc}
;;;859    
                          ENDP

                  avar_bat_ips_hndl PROC
;;;861    //-----------------------------------------------
;;;862    void avar_bat_ips_hndl(char in)
000d2a  e92d4ff8          PUSH     {r3-r11,lr}
;;;863    {
000d2e  4602              MOV      r2,r0
;;;864    char data[4];
;;;865    unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;866    
;;;867    if(in==1)
;;;868    	{
;;;869    	bat_ips._av|=1;
000d30  4872              LDR      r0,|L1.3836|
;;;870        ips_bat_av_stat=1;
;;;871    	ips_bat_av_vzvod=1;
;;;872    
;;;873    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;874    	event_ptr++;	
;;;875    	if(event_ptr>63)event_ptr=0;	
;;;876    	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;877    	
;;;878         event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;879    	if(event_cnt!=63)event_cnt=event_ptr;
;;;880    	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;881    	
;;;882    	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;883    	
;;;884    	data[0]='B';
;;;885    	data[1]=0;
;;;886    	data[2]='C';
;;;887    	data[3]=0;
;;;888    	lc640_write_long_ptr(lc640_adr,data);
;;;889    
;;;890    	data[0]=0;
;;;891    	data[1]=0;
;;;892    	data[2]=0;
;;;893    	data[3]=0;
;;;894    	lc640_write_long_ptr(lc640_adr+4,data);
;;;895    
;;;896    	data[0]=LPC_RTC->YEAR;
000d32  f8df81c4          LDR      r8,|L1.3832|
000d36  4c72              LDR      r4,|L1.3840|
000d38  4b72              LDR      r3,|L1.3844|
000d3a  2742              MOVS     r7,#0x42              ;884
000d3c  f890103d          LDRB     r1,[r0,#0x3d]         ;869
000d40  f1a80820          SUB      r8,r8,#0x20
000d44  f44f6560          MOV      r5,#0xe00             ;873
000d48  f04f0900          MOV      r9,#0                 ;875
000d4c  f44f6a80          MOV      r10,#0x400            ;882
000d50  2a01              CMP      r2,#1                 ;867
000d52  d001              BEQ      |L1.3416|
;;;897    	data[1]=LPC_RTC->MONTH;
;;;898    	data[2]=LPC_RTC->DOM;
;;;899    	data[3]=0;
;;;900    	lc640_write_long_ptr(lc640_adr+8,data);
;;;901    
;;;902    	data[0]=LPC_RTC->HOUR;
;;;903    	data[1]=LPC_RTC->MIN;
;;;904    	data[2]=LPC_RTC->SEC;
;;;905    	data[3]=0;
;;;906    	lc640_write_long_ptr(lc640_adr+12,data);
;;;907    	
;;;908    	data[0]='A';
;;;909    	data[1]='A';
;;;910    	data[2]='A';
;;;911    	data[3]='A';
;;;912    	lc640_write_long_ptr(lc640_adr+16,data);
;;;913    	
;;;914    	data[0]='A';
;;;915    	data[1]='A';
;;;916    	data[2]='A';
;;;917    	data[3]='A';
;;;918    	lc640_write_long_ptr(lc640_adr+20,data);
;;;919    	
;;;920    	data[0]='A';
;;;921    	data[1]='A';
;;;922    	data[2]='A';
;;;923    	data[3]='A';
;;;924    	lc640_write_long_ptr(lc640_adr+24,data);
;;;925    	
;;;926    	data[0]='A';
;;;927    	data[1]='A';
;;;928    	data[2]='A';
;;;929    	data[3]='A';
;;;930    	lc640_write_long_ptr(lc640_adr+28,data);
;;;931    					
;;;932    	snmp_trap_send("BAT 1 Alarm, lost",5,1,1);
;;;933    		
;;;934    	}
;;;935    
;;;936    else if(in==0)
000d54  b1e2              CBZ      r2,|L1.3472|
000d56  e1db              B        |L1.4368|
                  |L1.3416|
000d58  f0410101          ORR      r1,r1,#1              ;869
000d5c  f880103d          STRB     r1,[r0,#0x3d]         ;869
000d60  2001              MOVS     r0,#1                 ;870
000d62  7020              STRB     r0,[r4,#0]            ;870
000d64  7018              STRB     r0,[r3,#0]            ;871
000d66  4628              MOV      r0,r5                 ;873
000d68  f7fffffe          BL       lc640_read_int
000d6c  1c40              ADDS     r0,r0,#1              ;874
000d6e  b284              UXTH     r4,r0                 ;874
000d70  2c3f              CMP      r4,#0x3f              ;875
000d72  d900              BLS      |L1.3446|
000d74  2400              MOVS     r4,#0                 ;875
                  |L1.3446|
000d76  b221              SXTH     r1,r4                 ;876
000d78  4628              MOV      r0,r5                 ;876
000d7a  f7fffffe          BL       lc640_write_int
000d7e  f6406602          MOV      r6,#0xe02             ;878
000d82  4630              MOV      r0,r6                 ;878
000d84  f7fffffe          BL       lc640_read_int
000d88  b281              UXTH     r1,r0                 ;878
000d8a  293f              CMP      r1,#0x3f              ;879
000d8c  d001              BEQ      |L1.3474|
000d8e  e0bb              B        |L1.3848|
                  |L1.3472|
000d90  e13a              B        |L1.4104|
                  |L1.3474|
000d92  e0ba              B        |L1.3850|
                  |L1.3476|
000d94  42505320          DCB      "BPS #1 Alarm, overheat",0
000d98  23312041
000d9c  6c61726d
000da0  2c206f76
000da4  65726865
000da8  617400  
000dab  00                DCB      0
                  |L1.3500|
000dac  42505320          DCB      "BPS #1 Alarm, voltage is up",0
000db0  23312041
000db4  6c61726d
000db8  2c20766f
000dbc  6c746167
000dc0  65206973
000dc4  20757000
                  |L1.3528|
000dc8  42505320          DCB      "BPS #1 Alarm, voltage is down",0
000dcc  23312041
000dd0  6c61726d
000dd4  2c20766f
000dd8  6c746167
000ddc  65206973
000de0  20646f77
000de4  6e00    
000de6  00                DCB      0
000de7  00                DCB      0
                  |L1.3560|
000de8  42505320          DCB      "BPS #1 Alarm, connect is lost",0
000dec  23312041
000df0  6c61726d
000df4  2c20636f
000df8  6e6e6563
000dfc  74206973
000e00  206c6f73
000e04  7400    
000e06  00                DCB      0
000e07  00                DCB      0
                  |L1.3592|
000e08  42505320          DCB      "BPS #2 Alarm, overheat",0
000e0c  23322041
000e10  6c61726d
000e14  2c206f76
000e18  65726865
000e1c  617400  
000e1f  00                DCB      0
                  |L1.3616|
000e20  42505320          DCB      "BPS #2 Alarm, voltage is up",0
000e24  23322041
000e28  6c61726d
000e2c  2c20766f
000e30  6c746167
000e34  65206973
000e38  20757000
                  |L1.3644|
000e3c  42505320          DCB      "BPS #2 Alarm, voltage is down",0
000e40  23322041
000e44  6c61726d
000e48  2c20766f
000e4c  6c746167
000e50  65206973
000e54  20646f77
000e58  6e00    
000e5a  00                DCB      0
000e5b  00                DCB      0
                  |L1.3676|
000e5c  42505320          DCB      "BPS #2 Alarm, connect is lost",0
000e60  23322041
000e64  6c61726d
000e68  2c20636f
000e6c  6e6e6563
000e70  74206973
000e74  206c6f73
000e78  7400    
000e7a  00                DCB      0
000e7b  00                DCB      0
                  |L1.3708|
000e7c  42505320          DCB      "BPS #3 Alarm, overheat",0
000e80  23332041
000e84  6c61726d
000e88  2c206f76
000e8c  65726865
000e90  617400  
000e93  00                DCB      0
                  |L1.3732|
000e94  42505320          DCB      "BPS #3 Alarm, voltage is up",0
000e98  23332041
000e9c  6c61726d
000ea0  2c20766f
000ea4  6c746167
000ea8  65206973
000eac  20757000
                  |L1.3760|
000eb0  42505320          DCB      "BPS #3 Alarm, voltage is down",0
000eb4  23332041
000eb8  6c61726d
000ebc  2c20766f
000ec0  6c746167
000ec4  65206973
000ec8  20646f77
000ecc  6e00    
000ece  00                DCB      0
000ecf  00                DCB      0
                  |L1.3792|
000ed0  42505320          DCB      "BPS #3 Alarm, connect is lost",0
000ed4  23332041
000ed8  6c61726d
000edc  2c20636f
000ee0  6e6e6563
000ee4  74206973
000ee8  206c6f73
000eec  7400    
000eee  00                DCB      0
000eef  00                DCB      0
                  |L1.3824|
                          DCD      bat
                  |L1.3828|
                          DCD      bat_u_old_cnt
                  |L1.3832|
                          DCD      0x40024020
                  |L1.3836|
                          DCD      bat_ips
                  |L1.3840|
                          DCD      ips_bat_av_stat
                  |L1.3844|
                          DCD      ips_bat_av_vzvod
                  |L1.3848|
000f08  4621              MOV      r1,r4                 ;879
                  |L1.3850|
000f0a  b209              SXTH     r1,r1                 ;880
000f0c  4630              MOV      r0,r6                 ;880
000f0e  f7fffffe          BL       lc640_write_int
000f12  4628              MOV      r0,r5                 ;882
000f14  f7fffffe          BL       lc640_read_int
000f18  eb0a1040          ADD      r0,r10,r0,LSL #5      ;882
000f1c  b284              UXTH     r4,r0                 ;882
000f1e  f88d7000          STRB     r7,[sp,#0]            ;884
000f22  f88d9001          STRB     r9,[sp,#1]            ;885
000f26  2043              MOVS     r0,#0x43              ;886
000f28  f88d0002          STRB     r0,[sp,#2]            ;886
000f2c  f88d9003          STRB     r9,[sp,#3]            ;887
000f30  4669              MOV      r1,sp                 ;888
000f32  4620              MOV      r0,r4                 ;888
000f34  f7fffffe          BL       lc640_write_long_ptr
000f38  f8cd9000          STR      r9,[sp,#0]            ;893
000f3c  4669              MOV      r1,sp                 ;894
000f3e  1d20              ADDS     r0,r4,#4              ;894
000f40  f7fffffe          BL       lc640_write_long_ptr
000f44  f8b8003c          LDRH     r0,[r8,#0x3c]         ;896
000f48  f88d0000          STRB     r0,[sp,#0]            ;896
000f4c  f8980038          LDRB     r0,[r8,#0x38]         ;897
000f50  f88d0001          STRB     r0,[sp,#1]            ;897
000f54  f898002c          LDRB     r0,[r8,#0x2c]         ;898
000f58  f88d0002          STRB     r0,[sp,#2]            ;898
000f5c  f88d9003          STRB     r9,[sp,#3]            ;899
000f60  4669              MOV      r1,sp                 ;900
000f62  f1040008          ADD      r0,r4,#8              ;900
000f66  f7fffffe          BL       lc640_write_long_ptr
000f6a  f8980028          LDRB     r0,[r8,#0x28]         ;902
000f6e  f88d0000          STRB     r0,[sp,#0]            ;902
000f72  f8980024          LDRB     r0,[r8,#0x24]         ;903
000f76  f88d0001          STRB     r0,[sp,#1]            ;903
000f7a  f8980020          LDRB     r0,[r8,#0x20]         ;904
000f7e  f88d0002          STRB     r0,[sp,#2]            ;904
000f82  f88d9003          STRB     r9,[sp,#3]            ;905
000f86  4669              MOV      r1,sp                 ;906
000f88  f104000c          ADD      r0,r4,#0xc            ;906
000f8c  f7fffffe          BL       lc640_write_long_ptr
000f90  2541              MOVS     r5,#0x41              ;908
000f92  f88d5000          STRB     r5,[sp,#0]            ;908
000f96  f88d5001          STRB     r5,[sp,#1]            ;909
000f9a  f88d5002          STRB     r5,[sp,#2]            ;910
000f9e  f88d5003          STRB     r5,[sp,#3]            ;911
000fa2  4669              MOV      r1,sp                 ;912
000fa4  f1040010          ADD      r0,r4,#0x10           ;912
000fa8  f7fffffe          BL       lc640_write_long_ptr
000fac  f88d5000          STRB     r5,[sp,#0]            ;914
000fb0  f88d5001          STRB     r5,[sp,#1]            ;915
000fb4  f88d5002          STRB     r5,[sp,#2]            ;916
000fb8  f88d5003          STRB     r5,[sp,#3]            ;917
000fbc  4669              MOV      r1,sp                 ;918
000fbe  f1040014          ADD      r0,r4,#0x14           ;918
000fc2  f7fffffe          BL       lc640_write_long_ptr
000fc6  f88d5000          STRB     r5,[sp,#0]            ;920
000fca  f88d5001          STRB     r5,[sp,#1]            ;921
000fce  f88d5002          STRB     r5,[sp,#2]            ;922
000fd2  f88d5003          STRB     r5,[sp,#3]            ;923
000fd6  4669              MOV      r1,sp                 ;924
000fd8  f1040018          ADD      r0,r4,#0x18           ;924
000fdc  f7fffffe          BL       lc640_write_long_ptr
000fe0  f88d5000          STRB     r5,[sp,#0]            ;926
000fe4  f88d5001          STRB     r5,[sp,#1]            ;927
000fe8  f88d5002          STRB     r5,[sp,#2]            ;928
000fec  f88d5003          STRB     r5,[sp,#3]            ;929
000ff0  4669              MOV      r1,sp                 ;930
000ff2  f104001c          ADD      r0,r4,#0x1c           ;930
000ff6  f7fffffe          BL       lc640_write_long_ptr
000ffa  2301              MOVS     r3,#1                 ;932
000ffc  461a              MOV      r2,r3                 ;932
000ffe  2105              MOVS     r1,#5                 ;932
001000  a0ff              ADR      r0,|L1.5120|
001002  f7fffffe          BL       snmp_trap_send
001006  e083              B        |L1.4368|
                  |L1.4104|
;;;937    	{
;;;938    	bat_ips._av&=~1;
001008  f0210101          BIC      r1,r1,#1
00100c  f880103d          STRB     r1,[r0,#0x3d]
;;;939    	ips_bat_av_stat=0;
001010  f8849000          STRB     r9,[r4,#0]
;;;940    	ips_bat_av_vzvod=0;
001014  f8839000          STRB     r9,[r3,#0]
;;;941         
;;;942    	event_ptr=lc640_read_int(PTR_EVENT_LOG);
001018  4628              MOV      r0,r5
00101a  f7fffffe          BL       lc640_read_int
00101e  b286              UXTH     r6,r0
;;;943    	event_ptr_find=event_ptr;
001020  4634              MOV      r4,r6
                  |L1.4130|
;;;944    	
;;;945    avar_bat_ips_hndl_lbl1: 
;;;946    
;;;947    	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001022  eb0a1044          ADD      r0,r10,r4,LSL #5
001026  b285              UXTH     r5,r0
;;;948    
;;;949         lc640_read_long_ptr(lc640_adr,data);
001028  4669              MOV      r1,sp
00102a  4628              MOV      r0,r5
00102c  f7fffffe          BL       lc640_read_long_ptr
;;;950         
;;;951         if(!((data[0]=='B')&&(data[1]==0)&&(data[2]=='C')))
001030  f89d0000          LDRB     r0,[sp,#0]
001034  2842              CMP      r0,#0x42
001036  d106              BNE      |L1.4166|
001038  f89d0001          LDRB     r0,[sp,#1]
00103c  b918              CBNZ     r0,|L1.4166|
00103e  f89d0002          LDRB     r0,[sp,#2]
001042  2843              CMP      r0,#0x43
001044  d007              BEQ      |L1.4182|
                  |L1.4166|
;;;952         	{        
;;;953         	if(event_ptr_find)event_ptr_find--;
001046  b114              CBZ      r4,|L1.4174|
001048  1e64              SUBS     r4,r4,#1
00104a  b2a4              UXTH     r4,r4
00104c  e000              B        |L1.4176|
                  |L1.4174|
;;;954         	else event_ptr_find=63;
00104e  243f              MOVS     r4,#0x3f
                  |L1.4176|
;;;955         	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
001050  42b4              CMP      r4,r6
001052  d1e6              BNE      |L1.4130|
001054  e05c              B        |L1.4368|
                  |L1.4182|
;;;956         	else goto avar_bat_ips_hndl_lbl1;
;;;957         	}
;;;958         else 
;;;959         	{
;;;960         	lc640_read_long_ptr(lc640_adr+16,data);
001056  4669              MOV      r1,sp
001058  f1050010          ADD      r0,r5,#0x10
00105c  f7fffffe          BL       lc640_read_long_ptr
;;;961         	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
001060  f89d0000          LDRB     r0,[sp,#0]
001064  2841              CMP      r0,#0x41
001066  d10b              BNE      |L1.4224|
001068  f89d0001          LDRB     r0,[sp,#1]
00106c  2841              CMP      r0,#0x41
00106e  d107              BNE      |L1.4224|
001070  f89d0002          LDRB     r0,[sp,#2]
001074  2841              CMP      r0,#0x41
001076  d103              BNE      |L1.4224|
001078  f89d0003          LDRB     r0,[sp,#3]
00107c  2841              CMP      r0,#0x41
00107e  d007              BEQ      |L1.4240|
                  |L1.4224|
;;;962         		{        
;;;963         		if(event_ptr_find)event_ptr_find--;
001080  b114              CBZ      r4,|L1.4232|
001082  1e64              SUBS     r4,r4,#1
001084  b2a4              UXTH     r4,r4
001086  e000              B        |L1.4234|
                  |L1.4232|
;;;964             		else event_ptr_find=63;
001088  243f              MOVS     r4,#0x3f
                  |L1.4234|
;;;965             	    	if(event_ptr_find==event_ptr)goto avar_bat_ips_hndl_end;
00108a  42b4              CMP      r4,r6
00108c  d1c9              BNE      |L1.4130|
00108e  e03f              B        |L1.4368|
                  |L1.4240|
;;;966         		else goto avar_bat_ips_hndl_lbl1;
;;;967         		}
;;;968    
;;;969         	}
;;;970         		
;;;971    	data[0]=LPC_RTC->YEAR;
001090  f8b8003c          LDRH     r0,[r8,#0x3c]
001094  f88d0000          STRB     r0,[sp,#0]
;;;972    	data[1]=LPC_RTC->MONTH;
001098  f8980038          LDRB     r0,[r8,#0x38]
00109c  f88d0001          STRB     r0,[sp,#1]
;;;973    	data[2]=LPC_RTC->DOM;
0010a0  f898002c          LDRB     r0,[r8,#0x2c]
0010a4  f88d0002          STRB     r0,[sp,#2]
;;;974    	data[3]=0;
0010a8  f88d9003          STRB     r9,[sp,#3]
;;;975    	lc640_write_long_ptr(lc640_adr+16,data);
0010ac  4669              MOV      r1,sp
0010ae  f1050010          ADD      r0,r5,#0x10
0010b2  f7fffffe          BL       lc640_write_long_ptr
;;;976    
;;;977    	data[0]=LPC_RTC->HOUR;
0010b6  f8980028          LDRB     r0,[r8,#0x28]
0010ba  f88d0000          STRB     r0,[sp,#0]
;;;978    	data[1]=LPC_RTC->MIN;
0010be  f8980024          LDRB     r0,[r8,#0x24]
0010c2  f88d0001          STRB     r0,[sp,#1]
;;;979    	data[2]=LPC_RTC->SEC;
0010c6  f8980020          LDRB     r0,[r8,#0x20]
0010ca  f88d0002          STRB     r0,[sp,#2]
;;;980    	data[3]=0;
0010ce  f88d9003          STRB     r9,[sp,#3]
;;;981    	lc640_write_long_ptr(lc640_adr+20,data);
0010d2  4669              MOV      r1,sp
0010d4  f1050014          ADD      r0,r5,#0x14
0010d8  f7fffffe          BL       lc640_write_long_ptr
;;;982    	
;;;983    	data[0]='B';
0010dc  f88d7000          STRB     r7,[sp,#0]
;;;984    	data[1]='B';
0010e0  f88d7001          STRB     r7,[sp,#1]
;;;985    	data[2]='B';
0010e4  f88d7002          STRB     r7,[sp,#2]
;;;986    	data[3]='B';
0010e8  f88d7003          STRB     r7,[sp,#3]
;;;987    	lc640_write_long_ptr(lc640_adr+24,data);
0010ec  4669              MOV      r1,sp
0010ee  f1050018          ADD      r0,r5,#0x18
0010f2  f7fffffe          BL       lc640_write_long_ptr
;;;988    	
;;;989    	data[0]='B';
0010f6  f88d7000          STRB     r7,[sp,#0]
;;;990    	data[1]='B';
0010fa  f88d7001          STRB     r7,[sp,#1]
;;;991    	data[2]='B';
0010fe  f88d7002          STRB     r7,[sp,#2]
;;;992    	data[3]='B';
001102  f88d7003          STRB     r7,[sp,#3]
;;;993    	lc640_write_long_ptr(lc640_adr+28,data);
001106  4669              MOV      r1,sp
001108  f105001c          ADD      r0,r5,#0x1c
00110c  f7fffffe          BL       lc640_write_long_ptr
                  |L1.4368|
;;;994    	
;;;995    
;;;996    	
;;;997    	}
;;;998    	
;;;999    avar_bat_ips_hndl_end:
;;;1000   __nop();		
001110  bf00              NOP      
                  |L1.4370|
;;;1001   }
001112  e57e              B        |L1.3090|
;;;1002   
                          ENDP

                  avar_bat_hndl PROC
;;;1005   //-----------------------------------------------
;;;1006   void avar_bat_hndl(char b, char in)
001114  e92d4ff8          PUSH     {r3-r11,lr}
;;;1007   {
001118  4606              MOV      r6,r0
;;;1008   char data[4];
;;;1009   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1010   
;;;1011   if(in==1)
;;;1012   	{
;;;1013   	bat[b]._av|=1;
00111a  48be              LDR      r0,|L1.5140|
00111c  eb060246          ADD      r2,r6,r6,LSL #1
;;;1014       
;;;1015   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1016   	event_ptr++;	
;;;1017   	if(event_ptr>63)event_ptr=0;	
;;;1018   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1019   	
;;;1020        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1021   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1022   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1023   	
;;;1024   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1025   	
;;;1026   	data[0]='B';
;;;1027   	data[1]=b;
;;;1028   	data[2]='C';
;;;1029   	data[3]=0;
;;;1030   	lc640_write_long_ptr(lc640_adr,data);
;;;1031   
;;;1032   	data[0]=0;
;;;1033   	data[1]=0;
;;;1034   	data[2]=0;
;;;1035   	data[3]=0;
;;;1036   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1037   
;;;1038   	data[0]=LPC_RTC->YEAR;
001120  f8df82f4          LDR      r8,|L1.5144|
001124  eb021206          ADD      r2,r2,r6,LSL #4       ;1013
001128  f04f0a00          MOV      r10,#0                ;1017
00112c  f04f0942          MOV      r9,#0x42              ;1026
001130  f44f6560          MOV      r5,#0xe00             ;1015
001134  f44f6b80          MOV      r11,#0x400            ;1024
001138  eb000082          ADD      r0,r0,r2,LSL #2       ;1013
00113c  2901              CMP      r1,#1                 ;1011
00113e  d001              BEQ      |L1.4420|
;;;1039   	data[1]=LPC_RTC->MONTH;
;;;1040   	data[2]=LPC_RTC->DOM;
;;;1041   	data[3]=0;
;;;1042   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1043   
;;;1044   	data[0]=LPC_RTC->HOUR;
;;;1045   	data[1]=LPC_RTC->MIN;
;;;1046   	data[2]=LPC_RTC->SEC;
;;;1047   	data[3]=0;
;;;1048   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1049   	
;;;1050   	data[0]='A';
;;;1051   	data[1]='A';
;;;1052   	data[2]='A';
;;;1053   	data[3]='A';
;;;1054   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1055   	
;;;1056   	data[0]='A';
;;;1057   	data[1]='A';
;;;1058   	data[2]='A';
;;;1059   	data[3]='A';
;;;1060   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1061   	
;;;1062   	data[0]='A';
;;;1063   	data[1]='A';
;;;1064   	data[2]='A';
;;;1065   	data[3]='A';
;;;1066   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1067   	
;;;1068   	data[0]='A';
;;;1069   	data[1]='A';
;;;1070   	data[2]='A';
;;;1071   	data[3]='A';
;;;1072   	lc640_write_long_ptr(lc640_adr+28,data);
;;;1073   					
;;;1074   	if(b==0)
;;;1075   		{
;;;1076   		snmp_trap_send("BAT #1 Alarm, lost",5,1,1);
;;;1077   		}
;;;1078   	else if(b==1)
;;;1079   		{
;;;1080   		snmp_trap_send("BAT #2 Alarm, lost",5,2,1);
;;;1081   		} 
;;;1082   			
;;;1083   	}
;;;1084   
;;;1085   else if(in==0)
001140  b3f1              CBZ      r1,|L1.4544|
001142  e127              B        |L1.5012|
                  |L1.4420|
001144  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1013
001148  f0410101          ORR      r1,r1,#1              ;1013
00114c  7001              STRB     r1,[r0,#0]            ;1013
00114e  4628              MOV      r0,r5                 ;1015
001150  f7fffffe          BL       lc640_read_int
001154  1c40              ADDS     r0,r0,#1              ;1016
001156  b284              UXTH     r4,r0                 ;1016
001158  2c3f              CMP      r4,#0x3f              ;1017
00115a  d900              BLS      |L1.4446|
00115c  2400              MOVS     r4,#0                 ;1017
                  |L1.4446|
00115e  b221              SXTH     r1,r4                 ;1018
001160  4628              MOV      r0,r5                 ;1018
001162  f7fffffe          BL       lc640_write_int
001166  f6406702          MOV      r7,#0xe02             ;1020
00116a  4638              MOV      r0,r7                 ;1020
00116c  f7fffffe          BL       lc640_read_int
001170  b280              UXTH     r0,r0                 ;1020
001172  283f              CMP      r0,#0x3f              ;1021
001174  d000              BEQ      |L1.4472|
001176  4620              MOV      r0,r4                 ;1021
                  |L1.4472|
001178  b201              SXTH     r1,r0                 ;1022
00117a  4638              MOV      r0,r7                 ;1022
00117c  f7fffffe          BL       lc640_write_int
001180  4628              MOV      r0,r5                 ;1024
001182  f7fffffe          BL       lc640_read_int
001186  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1024
00118a  b284              UXTH     r4,r0                 ;1024
00118c  f88d9000          STRB     r9,[sp,#0]            ;1026
001190  f88d6001          STRB     r6,[sp,#1]            ;1027
001194  2043              MOVS     r0,#0x43              ;1028
001196  f88d0002          STRB     r0,[sp,#2]            ;1028
00119a  f88da003          STRB     r10,[sp,#3]           ;1029
00119e  4669              MOV      r1,sp                 ;1030
0011a0  4620              MOV      r0,r4                 ;1030
0011a2  f7fffffe          BL       lc640_write_long_ptr
0011a6  f8cda000          STR      r10,[sp,#0]           ;1035
0011aa  4669              MOV      r1,sp                 ;1036
0011ac  1d20              ADDS     r0,r4,#4              ;1036
0011ae  f7fffffe          BL       lc640_write_long_ptr
0011b2  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1038
0011b6  f88d0000          STRB     r0,[sp,#0]            ;1038
0011ba  f8980038          LDRB     r0,[r8,#0x38]         ;1039
0011be  e000              B        |L1.4546|
                  |L1.4544|
0011c0  e066              B        |L1.4752|
                  |L1.4546|
0011c2  f88d0001          STRB     r0,[sp,#1]            ;1039
0011c6  f898002c          LDRB     r0,[r8,#0x2c]         ;1040
0011ca  f88d0002          STRB     r0,[sp,#2]            ;1040
0011ce  f88da003          STRB     r10,[sp,#3]           ;1041
0011d2  4669              MOV      r1,sp                 ;1042
0011d4  f1040008          ADD      r0,r4,#8              ;1042
0011d8  f7fffffe          BL       lc640_write_long_ptr
0011dc  f8980028          LDRB     r0,[r8,#0x28]         ;1044
0011e0  f88d0000          STRB     r0,[sp,#0]            ;1044
0011e4  f8980024          LDRB     r0,[r8,#0x24]         ;1045
0011e8  f88d0001          STRB     r0,[sp,#1]            ;1045
0011ec  f8980020          LDRB     r0,[r8,#0x20]         ;1046
0011f0  f88d0002          STRB     r0,[sp,#2]            ;1046
0011f4  f88da003          STRB     r10,[sp,#3]           ;1047
0011f8  4669              MOV      r1,sp                 ;1048
0011fa  f104000c          ADD      r0,r4,#0xc            ;1048
0011fe  f7fffffe          BL       lc640_write_long_ptr
001202  2541              MOVS     r5,#0x41              ;1050
001204  f88d5000          STRB     r5,[sp,#0]            ;1050
001208  f88d5001          STRB     r5,[sp,#1]            ;1051
00120c  f88d5002          STRB     r5,[sp,#2]            ;1052
001210  f88d5003          STRB     r5,[sp,#3]            ;1053
001214  4669              MOV      r1,sp                 ;1054
001216  f1040010          ADD      r0,r4,#0x10           ;1054
00121a  f7fffffe          BL       lc640_write_long_ptr
00121e  f88d5000          STRB     r5,[sp,#0]            ;1056
001222  f88d5001          STRB     r5,[sp,#1]            ;1057
001226  f88d5002          STRB     r5,[sp,#2]            ;1058
00122a  f88d5003          STRB     r5,[sp,#3]            ;1059
00122e  4669              MOV      r1,sp                 ;1060
001230  f1040014          ADD      r0,r4,#0x14           ;1060
001234  f7fffffe          BL       lc640_write_long_ptr
001238  f88d5000          STRB     r5,[sp,#0]            ;1062
00123c  f88d5001          STRB     r5,[sp,#1]            ;1063
001240  f88d5002          STRB     r5,[sp,#2]            ;1064
001244  f88d5003          STRB     r5,[sp,#3]            ;1065
001248  4669              MOV      r1,sp                 ;1066
00124a  f1040018          ADD      r0,r4,#0x18           ;1066
00124e  f7fffffe          BL       lc640_write_long_ptr
001252  f88d5000          STRB     r5,[sp,#0]            ;1068
001256  f88d5001          STRB     r5,[sp,#1]            ;1069
00125a  f88d5002          STRB     r5,[sp,#2]            ;1070
00125e  f88d5003          STRB     r5,[sp,#3]            ;1071
001262  4669              MOV      r1,sp                 ;1072
001264  f104001c          ADD      r0,r4,#0x1c           ;1072
001268  f7fffffe          BL       lc640_write_long_ptr
00126c  b116              CBZ      r6,|L1.4724|
00126e  2e01              CMP      r6,#1                 ;1078
001270  d007              BEQ      |L1.4738|
001272  e08f              B        |L1.5012|
                  |L1.4724|
001274  2301              MOVS     r3,#1                 ;1076
001276  461a              MOV      r2,r3                 ;1076
001278  2105              MOVS     r1,#5                 ;1076
00127a  a068              ADR      r0,|L1.5148|
00127c  f7fffffe          BL       snmp_trap_send
001280  e088              B        |L1.5012|
                  |L1.4738|
001282  2301              MOVS     r3,#1                 ;1080
001284  2202              MOVS     r2,#2                 ;1080
001286  2105              MOVS     r1,#5                 ;1080
001288  a069              ADR      r0,|L1.5168|
00128a  f7fffffe          BL       snmp_trap_send
00128e  e081              B        |L1.5012|
                  |L1.4752|
;;;1086   	{
;;;1087   	bat[b]._av&=~1;
001290  f8101f3d          LDRB     r1,[r0,#0x3d]!
001294  f0210101          BIC      r1,r1,#1
001298  7001              STRB     r1,[r0,#0]
;;;1088   
;;;1089        event_ptr=lc640_read_int(PTR_EVENT_LOG);
00129a  4628              MOV      r0,r5
00129c  f7fffffe          BL       lc640_read_int
0012a0  b287              UXTH     r7,r0
;;;1090   	event_ptr_find=event_ptr;
0012a2  463c              MOV      r4,r7
                  |L1.4772|
;;;1091   	
;;;1092   avar_bat_hndl_lbl1: 
;;;1093   
;;;1094   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0012a4  eb0b1044          ADD      r0,r11,r4,LSL #5
0012a8  b285              UXTH     r5,r0
;;;1095   
;;;1096        lc640_read_long_ptr(lc640_adr,data);
0012aa  4669              MOV      r1,sp
0012ac  4628              MOV      r0,r5
0012ae  f7fffffe          BL       lc640_read_long_ptr
;;;1097        
;;;1098        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
0012b2  f89d0000          LDRB     r0,[sp,#0]
0012b6  2842              CMP      r0,#0x42
0012b8  d107              BNE      |L1.4810|
0012ba  f89d0001          LDRB     r0,[sp,#1]
0012be  42b0              CMP      r0,r6
0012c0  d103              BNE      |L1.4810|
0012c2  f89d0002          LDRB     r0,[sp,#2]
0012c6  2843              CMP      r0,#0x43
0012c8  d007              BEQ      |L1.4826|
                  |L1.4810|
;;;1099        	{        
;;;1100        	if(event_ptr_find)event_ptr_find--;
0012ca  b114              CBZ      r4,|L1.4818|
0012cc  1e64              SUBS     r4,r4,#1
0012ce  b2a4              UXTH     r4,r4
0012d0  e000              B        |L1.4820|
                  |L1.4818|
;;;1101        	else event_ptr_find=63;
0012d2  243f              MOVS     r4,#0x3f
                  |L1.4820|
;;;1102        	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
0012d4  42bc              CMP      r4,r7
0012d6  d1e5              BNE      |L1.4772|
0012d8  e05c              B        |L1.5012|
                  |L1.4826|
;;;1103        	else goto avar_bat_hndl_lbl1;
;;;1104        	}
;;;1105        else 
;;;1106        	{
;;;1107        	lc640_read_long_ptr(lc640_adr+16,data);
0012da  4669              MOV      r1,sp
0012dc  f1050010          ADD      r0,r5,#0x10
0012e0  f7fffffe          BL       lc640_read_long_ptr
;;;1108        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0012e4  f89d0000          LDRB     r0,[sp,#0]
0012e8  2841              CMP      r0,#0x41
0012ea  d10b              BNE      |L1.4868|
0012ec  f89d0001          LDRB     r0,[sp,#1]
0012f0  2841              CMP      r0,#0x41
0012f2  d107              BNE      |L1.4868|
0012f4  f89d0002          LDRB     r0,[sp,#2]
0012f8  2841              CMP      r0,#0x41
0012fa  d103              BNE      |L1.4868|
0012fc  f89d0003          LDRB     r0,[sp,#3]
001300  2841              CMP      r0,#0x41
001302  d007              BEQ      |L1.4884|
                  |L1.4868|
;;;1109        		{        
;;;1110        		if(event_ptr_find)event_ptr_find--;
001304  b114              CBZ      r4,|L1.4876|
001306  1e64              SUBS     r4,r4,#1
001308  b2a4              UXTH     r4,r4
00130a  e000              B        |L1.4878|
                  |L1.4876|
;;;1111            		else event_ptr_find=63;
00130c  243f              MOVS     r4,#0x3f
                  |L1.4878|
;;;1112            	    	if(event_ptr_find==event_ptr)goto avar_bat_hndl_end;
00130e  42bc              CMP      r4,r7
001310  d1c8              BNE      |L1.4772|
001312  e03f              B        |L1.5012|
                  |L1.4884|
;;;1113        		else goto avar_bat_hndl_lbl1;
;;;1114        		}
;;;1115   
;;;1116        	}
;;;1117        		
;;;1118   	data[0]=LPC_RTC->YEAR;
001314  f8b8003c          LDRH     r0,[r8,#0x3c]
001318  f88d0000          STRB     r0,[sp,#0]
;;;1119   	data[1]=LPC_RTC->MONTH;
00131c  f8980038          LDRB     r0,[r8,#0x38]
001320  f88d0001          STRB     r0,[sp,#1]
;;;1120   	data[2]=LPC_RTC->DOM;
001324  f898002c          LDRB     r0,[r8,#0x2c]
001328  f88d0002          STRB     r0,[sp,#2]
;;;1121   	data[3]=0;
00132c  f88da003          STRB     r10,[sp,#3]
;;;1122   	lc640_write_long_ptr(lc640_adr+16,data);
001330  4669              MOV      r1,sp
001332  f1050010          ADD      r0,r5,#0x10
001336  f7fffffe          BL       lc640_write_long_ptr
;;;1123   
;;;1124   	data[0]=LPC_RTC->HOUR;
00133a  f8980028          LDRB     r0,[r8,#0x28]
00133e  f88d0000          STRB     r0,[sp,#0]
;;;1125   	data[1]=LPC_RTC->MIN;
001342  f8980024          LDRB     r0,[r8,#0x24]
001346  f88d0001          STRB     r0,[sp,#1]
;;;1126   	data[2]=LPC_RTC->SEC;
00134a  f8980020          LDRB     r0,[r8,#0x20]
00134e  f88d0002          STRB     r0,[sp,#2]
;;;1127   	data[3]=0;
001352  f88da003          STRB     r10,[sp,#3]
;;;1128   	lc640_write_long_ptr(lc640_adr+20,data);
001356  4669              MOV      r1,sp
001358  f1050014          ADD      r0,r5,#0x14
00135c  f7fffffe          BL       lc640_write_long_ptr
;;;1129   	
;;;1130   	data[0]='B';
001360  f88d9000          STRB     r9,[sp,#0]
;;;1131   	data[1]='B';
001364  f88d9001          STRB     r9,[sp,#1]
;;;1132   	data[2]='B';
001368  f88d9002          STRB     r9,[sp,#2]
;;;1133   	data[3]='B';
00136c  f88d9003          STRB     r9,[sp,#3]
;;;1134   	lc640_write_long_ptr(lc640_adr+24,data);
001370  4669              MOV      r1,sp
001372  f1050018          ADD      r0,r5,#0x18
001376  f7fffffe          BL       lc640_write_long_ptr
;;;1135   	
;;;1136   	data[0]='B';
00137a  f88d9000          STRB     r9,[sp,#0]
;;;1137   	data[1]='B';
00137e  f88d9001          STRB     r9,[sp,#1]
;;;1138   	data[2]='B';
001382  f88d9002          STRB     r9,[sp,#2]
;;;1139   	data[3]='B';
001386  f88d9003          STRB     r9,[sp,#3]
;;;1140   	lc640_write_long_ptr(lc640_adr+28,data);
00138a  4669              MOV      r1,sp
00138c  f105001c          ADD      r0,r5,#0x1c
001390  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5012|
;;;1141   	
;;;1142   
;;;1143   	
;;;1144   	}
;;;1145   	
;;;1146   avar_bat_hndl_end:
;;;1147   __nop();		
001394  bf00              NOP      
                  |L1.5014|
;;;1148   }
001396  e43c              B        |L1.3090|
;;;1149   
                          ENDP

                  avar_bat_as_hndl PROC
;;;1150   //-----------------------------------------------
;;;1151   void avar_bat_as_hndl(char b, char in)
001398  e92d4ff8          PUSH     {r3-r11,lr}
;;;1152   {
00139c  4606              MOV      r6,r0
;;;1153   char data[4];
;;;1154   unsigned short event_ptr,lc640_adr,event_ptr_find,event_cnt;
;;;1155   
;;;1156   if(in==1)
;;;1157   	{
;;;1158   	bat[b]._av|=2;
;;;1159       
;;;1160   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1161   	event_ptr++;	
;;;1162   	if(event_ptr>63)event_ptr=0;	
;;;1163   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1164   	
;;;1165        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1166   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1167   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1168   	
;;;1169   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1170   	
;;;1171   	data[0]='B';
;;;1172   	data[1]=b;
;;;1173   	data[2]='S';
;;;1174   	data[3]=0;
;;;1175   	lc640_write_long_ptr(lc640_adr,data);
;;;1176   
;;;1177   	data[0]=0;
;;;1178   	data[1]=0;
;;;1179   	data[2]=0;
;;;1180   	data[3]=0;
;;;1181   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1182   
;;;1183   	data[0]=LPC_RTC->YEAR;
00139e  f8df8078          LDR      r8,|L1.5144|
0013a2  f04f0a00          MOV      r10,#0                ;1162
0013a6  f04f0942          MOV      r9,#0x42              ;1171
0013aa  f44f6560          MOV      r5,#0xe00             ;1160
0013ae  f44f6b80          MOV      r11,#0x400            ;1169
0013b2  2901              CMP      r1,#1                 ;1156
0013b4  d001              BEQ      |L1.5050|
;;;1184   	data[1]=LPC_RTC->MONTH;
;;;1185   	data[2]=LPC_RTC->DOM;
;;;1186   	data[3]=0;
;;;1187   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1188   
;;;1189   	data[0]=LPC_RTC->HOUR;
;;;1190   	data[1]=LPC_RTC->MIN;
;;;1191   	data[2]=LPC_RTC->SEC;
;;;1192   	data[3]=0;
;;;1193   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1194   	
;;;1195   	data[0]='A';
;;;1196   	data[1]='A';
;;;1197   	data[2]='A';
;;;1198   	data[3]='A';
;;;1199   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1200   	
;;;1201   	data[0]='A';
;;;1202   	data[1]='A';
;;;1203   	data[2]='A';
;;;1204   	data[3]='A';
;;;1205   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1206   	
;;;1207   	data[0]='A';
;;;1208   	data[1]='A';
;;;1209   	data[2]='A';
;;;1210   	data[3]='A';
;;;1211   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1212   	
;;;1213   	data[0]='A';
;;;1214   	data[1]='A';
;;;1215   	data[2]='A';
;;;1216   	data[3]='A';
;;;1217   	lc640_write_long_ptr(lc640_adr+28,data);				
;;;1218   
;;;1219   	if(b==0)
;;;1220   		{
;;;1221   		snmp_trap_send("BAT #1 Alarm, assimetry",5,1,2);
;;;1222   		}
;;;1223   	else if(b==1)
;;;1224   		{
;;;1225   		snmp_trap_send("BAT #2 Alarm, assimetry",5,2,2);
;;;1226   		} 
;;;1227   	
;;;1228   	}
;;;1229   
;;;1230   else if(in==0)
0013b6  b311              CBZ      r1,|L1.5118|
0013b8  e14b              B        |L1.5714|
                  |L1.5050|
0013ba  eb060046          ADD      r0,r6,r6,LSL #1       ;1158
0013be  eb001106          ADD      r1,r0,r6,LSL #4       ;1158
0013c2  4814              LDR      r0,|L1.5140|
0013c4  eb000081          ADD      r0,r0,r1,LSL #2       ;1158
0013c8  f8101f3d          LDRB     r1,[r0,#0x3d]!        ;1158
0013cc  f0410102          ORR      r1,r1,#2              ;1158
0013d0  7001              STRB     r1,[r0,#0]            ;1158
0013d2  4628              MOV      r0,r5                 ;1160
0013d4  f7fffffe          BL       lc640_read_int
0013d8  1c40              ADDS     r0,r0,#1              ;1161
0013da  b284              UXTH     r4,r0                 ;1161
0013dc  2c3f              CMP      r4,#0x3f              ;1162
0013de  d900              BLS      |L1.5090|
0013e0  2400              MOVS     r4,#0                 ;1162
                  |L1.5090|
0013e2  b221              SXTH     r1,r4                 ;1163
0013e4  4628              MOV      r0,r5                 ;1163
0013e6  f7fffffe          BL       lc640_write_int
0013ea  f6406702          MOV      r7,#0xe02             ;1165
0013ee  4638              MOV      r0,r7                 ;1165
0013f0  f7fffffe          BL       lc640_read_int
0013f4  b280              UXTH     r0,r0                 ;1165
0013f6  283f              CMP      r0,#0x3f              ;1166
0013f8  d000              BEQ      |L1.5116|
0013fa  4620              MOV      r0,r4                 ;1166
                  |L1.5116|
0013fc  e022              B        |L1.5188|
                  |L1.5118|
0013fe  e0ab              B        |L1.5464|
                  |L1.5120|
001400  42415420          DCB      "BAT ",185,"1 Alarm, lost",0
001404  b9312041
001408  6c61726d
00140c  2c206c6f
001410  737400  
001413  00                DCB      0
                  |L1.5140|
                          DCD      bat
                  |L1.5144|
                          DCD      0x40024000
                  |L1.5148|
00141c  42415420          DCB      "BAT #1 Alarm, lost",0
001420  23312041
001424  6c61726d
001428  2c206c6f
00142c  737400  
00142f  00                DCB      0
                  |L1.5168|
001430  42415420          DCB      "BAT #2 Alarm, lost",0
001434  23322041
001438  6c61726d
00143c  2c206c6f
001440  737400  
001443  00                DCB      0
                  |L1.5188|
001444  b201              SXTH     r1,r0                 ;1167
001446  4638              MOV      r0,r7                 ;1167
001448  f7fffffe          BL       lc640_write_int
00144c  4628              MOV      r0,r5                 ;1169
00144e  f7fffffe          BL       lc640_read_int
001452  eb0b1040          ADD      r0,r11,r0,LSL #5      ;1169
001456  b284              UXTH     r4,r0                 ;1169
001458  f88d9000          STRB     r9,[sp,#0]            ;1171
00145c  f88d6001          STRB     r6,[sp,#1]            ;1172
001460  2053              MOVS     r0,#0x53              ;1173
001462  f88d0002          STRB     r0,[sp,#2]            ;1173
001466  f88da003          STRB     r10,[sp,#3]           ;1174
00146a  4669              MOV      r1,sp                 ;1175
00146c  4620              MOV      r0,r4                 ;1175
00146e  f7fffffe          BL       lc640_write_long_ptr
001472  f8cda000          STR      r10,[sp,#0]           ;1180
001476  4669              MOV      r1,sp                 ;1181
001478  1d20              ADDS     r0,r4,#4              ;1181
00147a  f7fffffe          BL       lc640_write_long_ptr
00147e  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1183
001482  f88d0000          STRB     r0,[sp,#0]            ;1183
001486  f8980038          LDRB     r0,[r8,#0x38]         ;1184
00148a  f88d0001          STRB     r0,[sp,#1]            ;1184
00148e  f898002c          LDRB     r0,[r8,#0x2c]         ;1185
001492  f88d0002          STRB     r0,[sp,#2]            ;1185
001496  f88da003          STRB     r10,[sp,#3]           ;1186
00149a  4669              MOV      r1,sp                 ;1187
00149c  f1040008          ADD      r0,r4,#8              ;1187
0014a0  f7fffffe          BL       lc640_write_long_ptr
0014a4  f8980028          LDRB     r0,[r8,#0x28]         ;1189
0014a8  f88d0000          STRB     r0,[sp,#0]            ;1189
0014ac  f8980024          LDRB     r0,[r8,#0x24]         ;1190
0014b0  f88d0001          STRB     r0,[sp,#1]            ;1190
0014b4  f8980020          LDRB     r0,[r8,#0x20]         ;1191
0014b8  f88d0002          STRB     r0,[sp,#2]            ;1191
0014bc  f88da003          STRB     r10,[sp,#3]           ;1192
0014c0  4669              MOV      r1,sp                 ;1193
0014c2  f104000c          ADD      r0,r4,#0xc            ;1193
0014c6  f7fffffe          BL       lc640_write_long_ptr
0014ca  2541              MOVS     r5,#0x41              ;1195
0014cc  f88d5000          STRB     r5,[sp,#0]            ;1195
0014d0  f88d5001          STRB     r5,[sp,#1]            ;1196
0014d4  f88d5002          STRB     r5,[sp,#2]            ;1197
0014d8  f88d5003          STRB     r5,[sp,#3]            ;1198
0014dc  4669              MOV      r1,sp                 ;1199
0014de  f1040010          ADD      r0,r4,#0x10           ;1199
0014e2  f7fffffe          BL       lc640_write_long_ptr
0014e6  f88d5000          STRB     r5,[sp,#0]            ;1201
0014ea  f88d5001          STRB     r5,[sp,#1]            ;1202
0014ee  f88d5002          STRB     r5,[sp,#2]            ;1203
0014f2  f88d5003          STRB     r5,[sp,#3]            ;1204
0014f6  4669              MOV      r1,sp                 ;1205
0014f8  f1040014          ADD      r0,r4,#0x14           ;1205
0014fc  f7fffffe          BL       lc640_write_long_ptr
001500  f88d5000          STRB     r5,[sp,#0]            ;1207
001504  f88d5001          STRB     r5,[sp,#1]            ;1208
001508  f88d5002          STRB     r5,[sp,#2]            ;1209
00150c  f88d5003          STRB     r5,[sp,#3]            ;1210
001510  4669              MOV      r1,sp                 ;1211
001512  f1040018          ADD      r0,r4,#0x18           ;1211
001516  f7fffffe          BL       lc640_write_long_ptr
00151a  f88d5000          STRB     r5,[sp,#0]            ;1213
00151e  f88d5001          STRB     r5,[sp,#1]            ;1214
001522  f88d5002          STRB     r5,[sp,#2]            ;1215
001526  f88d5003          STRB     r5,[sp,#3]            ;1216
00152a  4669              MOV      r1,sp                 ;1217
00152c  f104001c          ADD      r0,r4,#0x1c           ;1217
001530  f7fffffe          BL       lc640_write_long_ptr
001534  b116              CBZ      r6,|L1.5436|
001536  2e01              CMP      r6,#1                 ;1223
001538  d007              BEQ      |L1.5450|
00153a  e08a              B        |L1.5714|
                  |L1.5436|
00153c  2302              MOVS     r3,#2                 ;1221
00153e  2201              MOVS     r2,#1                 ;1221
001540  2105              MOVS     r1,#5                 ;1221
001542  a0fd              ADR      r0,|L1.6456|
001544  f7fffffe          BL       snmp_trap_send
001548  e083              B        |L1.5714|
                  |L1.5450|
00154a  2302              MOVS     r3,#2                 ;1225
00154c  461a              MOV      r2,r3                 ;1225
00154e  2105              MOVS     r1,#5                 ;1225
001550  a0ff              ADR      r0,|L1.6480|
001552  f7fffffe          BL       snmp_trap_send
001556  e07c              B        |L1.5714|
                  |L1.5464|
;;;1231   	{
;;;1232   	//bat[b]._av=0;
;;;1233   
;;;1234        event_ptr=lc640_read_int(PTR_EVENT_LOG);
001558  4628              MOV      r0,r5
00155a  f7fffffe          BL       lc640_read_int
00155e  b287              UXTH     r7,r0
;;;1235   	event_ptr_find=event_ptr;
001560  463c              MOV      r4,r7
                  |L1.5474|
;;;1236   	
;;;1237   avar_bat_as_hndl_lbl1: 
;;;1238   
;;;1239   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
001562  eb0b1044          ADD      r0,r11,r4,LSL #5
001566  b285              UXTH     r5,r0
;;;1240   
;;;1241        lc640_read_long_ptr(lc640_adr,data);
001568  4669              MOV      r1,sp
00156a  4628              MOV      r0,r5
00156c  f7fffffe          BL       lc640_read_long_ptr
;;;1242        
;;;1243        if(!((data[0]=='B')&&(data[1]==b)&&(data[2]=='C')))
001570  f89d0000          LDRB     r0,[sp,#0]
001574  2842              CMP      r0,#0x42
001576  d107              BNE      |L1.5512|
001578  f89d0001          LDRB     r0,[sp,#1]
00157c  42b0              CMP      r0,r6
00157e  d103              BNE      |L1.5512|
001580  f89d0002          LDRB     r0,[sp,#2]
001584  2843              CMP      r0,#0x43
001586  d007              BEQ      |L1.5528|
                  |L1.5512|
;;;1244        	{        
;;;1245        	if(event_ptr_find)event_ptr_find--;
001588  b114              CBZ      r4,|L1.5520|
00158a  1e64              SUBS     r4,r4,#1
00158c  b2a4              UXTH     r4,r4
00158e  e000              B        |L1.5522|
                  |L1.5520|
;;;1246        	else event_ptr_find=63;
001590  243f              MOVS     r4,#0x3f
                  |L1.5522|
;;;1247        	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
001592  42bc              CMP      r4,r7
001594  d1e5              BNE      |L1.5474|
001596  e05c              B        |L1.5714|
                  |L1.5528|
;;;1248        	else goto avar_bat_as_hndl_lbl1;
;;;1249        	}
;;;1250        else 
;;;1251        	{
;;;1252        	lc640_read_long_ptr(lc640_adr+16,data);
001598  4669              MOV      r1,sp
00159a  f1050010          ADD      r0,r5,#0x10
00159e  f7fffffe          BL       lc640_read_long_ptr
;;;1253        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0015a2  f89d0000          LDRB     r0,[sp,#0]
0015a6  2841              CMP      r0,#0x41
0015a8  d10b              BNE      |L1.5570|
0015aa  f89d0001          LDRB     r0,[sp,#1]
0015ae  2841              CMP      r0,#0x41
0015b0  d107              BNE      |L1.5570|
0015b2  f89d0002          LDRB     r0,[sp,#2]
0015b6  2841              CMP      r0,#0x41
0015b8  d103              BNE      |L1.5570|
0015ba  f89d0003          LDRB     r0,[sp,#3]
0015be  2841              CMP      r0,#0x41
0015c0  d007              BEQ      |L1.5586|
                  |L1.5570|
;;;1254        		{        
;;;1255        		if(event_ptr_find)event_ptr_find--;
0015c2  b114              CBZ      r4,|L1.5578|
0015c4  1e64              SUBS     r4,r4,#1
0015c6  b2a4              UXTH     r4,r4
0015c8  e000              B        |L1.5580|
                  |L1.5578|
;;;1256            		else event_ptr_find=63;
0015ca  243f              MOVS     r4,#0x3f
                  |L1.5580|
;;;1257            	    	if(event_ptr_find==event_ptr)goto avar_bat_as_hndl_end;
0015cc  42bc              CMP      r4,r7
0015ce  d1c8              BNE      |L1.5474|
0015d0  e03f              B        |L1.5714|
                  |L1.5586|
;;;1258        		else goto avar_bat_as_hndl_lbl1;
;;;1259        		}
;;;1260   
;;;1261        	}
;;;1262        		
;;;1263   	data[0]=LPC_RTC->YEAR;
0015d2  f8b8003c          LDRH     r0,[r8,#0x3c]
0015d6  f88d0000          STRB     r0,[sp,#0]
;;;1264   	data[1]=LPC_RTC->MONTH;
0015da  f8980038          LDRB     r0,[r8,#0x38]
0015de  f88d0001          STRB     r0,[sp,#1]
;;;1265   	data[2]=LPC_RTC->DOM;
0015e2  f898002c          LDRB     r0,[r8,#0x2c]
0015e6  f88d0002          STRB     r0,[sp,#2]
;;;1266   	data[3]=0;
0015ea  f88da003          STRB     r10,[sp,#3]
;;;1267   	lc640_write_long_ptr(lc640_adr+16,data);
0015ee  4669              MOV      r1,sp
0015f0  f1050010          ADD      r0,r5,#0x10
0015f4  f7fffffe          BL       lc640_write_long_ptr
;;;1268   
;;;1269   	data[0]=LPC_RTC->HOUR;
0015f8  f8980028          LDRB     r0,[r8,#0x28]
0015fc  f88d0000          STRB     r0,[sp,#0]
;;;1270   	data[1]=LPC_RTC->MIN;
001600  f8980024          LDRB     r0,[r8,#0x24]
001604  f88d0001          STRB     r0,[sp,#1]
;;;1271   	data[2]=LPC_RTC->SEC;
001608  f8980020          LDRB     r0,[r8,#0x20]
00160c  f88d0002          STRB     r0,[sp,#2]
;;;1272   	data[3]=0;
001610  f88da003          STRB     r10,[sp,#3]
;;;1273   	lc640_write_long_ptr(lc640_adr+20,data);
001614  4669              MOV      r1,sp
001616  f1050014          ADD      r0,r5,#0x14
00161a  f7fffffe          BL       lc640_write_long_ptr
;;;1274   	
;;;1275   	data[0]='B';
00161e  f88d9000          STRB     r9,[sp,#0]
;;;1276   	data[1]='B';
001622  f88d9001          STRB     r9,[sp,#1]
;;;1277   	data[2]='B';
001626  f88d9002          STRB     r9,[sp,#2]
;;;1278   	data[3]='B';
00162a  f88d9003          STRB     r9,[sp,#3]
;;;1279   	lc640_write_long_ptr(lc640_adr+24,data);
00162e  4669              MOV      r1,sp
001630  f1050018          ADD      r0,r5,#0x18
001634  f7fffffe          BL       lc640_write_long_ptr
;;;1280   	
;;;1281   	data[0]='B';
001638  f88d9000          STRB     r9,[sp,#0]
;;;1282   	data[1]='B';
00163c  f88d9001          STRB     r9,[sp,#1]
;;;1283   	data[2]='B';
001640  f88d9002          STRB     r9,[sp,#2]
;;;1284   	data[3]='B';
001644  f88d9003          STRB     r9,[sp,#3]
;;;1285   	lc640_write_long_ptr(lc640_adr+28,data);
001648  4669              MOV      r1,sp
00164a  f105001c          ADD      r0,r5,#0x1c
00164e  f7fffffe          BL       lc640_write_long_ptr
                  |L1.5714|
;;;1286   	
;;;1287   
;;;1288   	
;;;1289   	}
;;;1290   	
;;;1291   avar_bat_as_hndl_end:
;;;1292   __nop();		
001652  bf00              NOP      
;;;1293   }
001654  e55d              B        |L1.4370|
;;;1294   
                          ENDP

                  ke_mem_hndl PROC
;;;1296   //-----------------------------------------------
;;;1297   void ke_mem_hndl(char b,unsigned short in)
001656  b5f3              PUSH     {r0,r1,r4-r7,lr}
;;;1298   {
001658  b083              SUB      sp,sp,#0xc
00165a  4605              MOV      r5,r0
;;;1299   char data[4];
;;;1300   unsigned int event_ptr=0,lc640_adr/*,event_ptr_find*/,event_cnt;
;;;1301   //unsigned char temp,temp_;
;;;1302   //unsigned int tempUI;
;;;1303   //unsigned long tempUL; 
;;;1304   signed temp_temp;
;;;1305   
;;;1306   temp_temp=bat[b]._u_old[bat_u_old_cnt+1]; 
00165c  eb050045          ADD      r0,r5,r5,LSL #1
001660  49c1              LDR      r1,|L1.6504|
001662  eb001005          ADD      r0,r0,r5,LSL #4
001666  eb010180          ADD      r1,r1,r0,LSL #2
00166a  48c0              LDR      r0,|L1.6508|
00166c  f9b00000          LDRSH    r0,[r0,#0]  ; bat_u_old_cnt
001670  1c40              ADDS     r0,r0,#1
001672  eb010040          ADD      r0,r1,r0,LSL #1
001676  f9b00020          LDRSH    r0,[r0,#0x20]
00167a  9001              STR      r0,[sp,#4]
;;;1307   
;;;1308   event_ptr=lc640_read_int(PTR_EVENT_LOG);
00167c  f44f6660          MOV      r6,#0xe00
001680  4630              MOV      r0,r6
001682  f7fffffe          BL       lc640_read_int
;;;1309   event_ptr++;	
001686  1c44              ADDS     r4,r0,#1
;;;1310   if(event_ptr>63)event_ptr=0;	
001688  2c3f              CMP      r4,#0x3f
00168a  d900              BLS      |L1.5774|
00168c  2400              MOVS     r4,#0
                  |L1.5774|
;;;1311   lc640_write_int(PTR_EVENT_LOG,event_ptr);	
00168e  b221              SXTH     r1,r4
001690  4630              MOV      r0,r6
001692  f7fffffe          BL       lc640_write_int
;;;1312   	
;;;1313   event_cnt=lc640_read_int(CNT_EVENT_LOG);
001696  f6406702          MOV      r7,#0xe02
00169a  4638              MOV      r0,r7
00169c  f7fffffe          BL       lc640_read_int
;;;1314   if(event_cnt!=63)event_cnt=event_ptr;
0016a0  283f              CMP      r0,#0x3f
0016a2  d000              BEQ      |L1.5798|
0016a4  4620              MOV      r0,r4
                  |L1.5798|
;;;1315   lc640_write_int(CNT_EVENT_LOG,event_cnt); 
0016a6  b201              SXTH     r1,r0
0016a8  4638              MOV      r0,r7
0016aa  f7fffffe          BL       lc640_write_int
;;;1316   	
;;;1317   lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
0016ae  4630              MOV      r0,r6
0016b0  f7fffffe          BL       lc640_read_int
0016b4  f44f6180          MOV      r1,#0x400
0016b8  eb011440          ADD      r4,r1,r0,LSL #5
;;;1318   	
;;;1319   data[0]='B';
0016bc  2042              MOVS     r0,#0x42
0016be  f88d0008          STRB     r0,[sp,#8]
;;;1320   data[1]=b; 
0016c2  f88d5009          STRB     r5,[sp,#9]
;;;1321   data[2]='K';
0016c6  204b              MOVS     r0,#0x4b
0016c8  f88d000a          STRB     r0,[sp,#0xa]
;;;1322   data[3]=0;
0016cc  2600              MOVS     r6,#0
0016ce  f88d600b          STRB     r6,[sp,#0xb]
;;;1323   
;;;1324   lc640_write_long_ptr(lc640_adr,data);
0016d2  a902              ADD      r1,sp,#8
0016d4  4620              MOV      r0,r4
0016d6  f7fffffe          BL       lc640_write_long_ptr
;;;1325   
;;;1326   data[0]=*((char*)&in);
0016da  f89d0010          LDRB     r0,[sp,#0x10]
0016de  f88d0008          STRB     r0,[sp,#8]
;;;1327   data[1]=*(((char*)(&in))+1);
0016e2  f89d0011          LDRB     r0,[sp,#0x11]
0016e6  f88d0009          STRB     r0,[sp,#9]
;;;1328   data[2]=*((char*)&temp_temp);
0016ea  f89d0004          LDRB     r0,[sp,#4]
0016ee  f88d000a          STRB     r0,[sp,#0xa]
;;;1329   data[3]=*(((char*)(&temp_temp))+1);
0016f2  f89d0005          LDRB     r0,[sp,#5]
0016f6  f88d000b          STRB     r0,[sp,#0xb]
;;;1330   lc640_write_long_ptr(lc640_adr+4,data);
0016fa  a902              ADD      r1,sp,#8
0016fc  1d20              ADDS     r0,r4,#4
0016fe  f7fffffe          BL       lc640_write_long_ptr
;;;1331   
;;;1332   ke_date[0]=lc640_read_long(EE_SPC_KE_DATE0);
001702  f44f70fc          MOV      r0,#0x1f8
001706  f7fffffe          BL       lc640_read_long
00170a  4d99              LDR      r5,|L1.6512|
00170c  6028              STR      r0,[r5,#0]  ; ke_date
;;;1333   lc640_write_long_ptr(lc640_adr+8,(char*)&ke_date[0]);
00170e  4629              MOV      r1,r5
001710  f1040008          ADD      r0,r4,#8
001714  f7fffffe          BL       lc640_write_long_ptr
;;;1334   ke_date[1]=lc640_read_long(EE_SPC_KE_DATE1);	
001718  f44f70fe          MOV      r0,#0x1fc
00171c  f7fffffe          BL       lc640_read_long
001720  6068              STR      r0,[r5,#4]  ; ke_date
;;;1335   lc640_write_long_ptr(lc640_adr+12,(char*)&ke_date[1]);
001722  1d29              ADDS     r1,r5,#4
001724  f104000c          ADD      r0,r4,#0xc
001728  f7fffffe          BL       lc640_write_long_ptr
;;;1336   
;;;1337   data[0]=LPC_RTC->YEAR;
00172c  4d91              LDR      r5,|L1.6516|
00172e  8ba8              LDRH     r0,[r5,#0x1c]
001730  f88d0008          STRB     r0,[sp,#8]
;;;1338   data[1]=LPC_RTC->MONTH;
001734  7e28              LDRB     r0,[r5,#0x18]
001736  f88d0009          STRB     r0,[sp,#9]
;;;1339   data[2]=LPC_RTC->DOM;
00173a  7b28              LDRB     r0,[r5,#0xc]
00173c  f88d000a          STRB     r0,[sp,#0xa]
;;;1340   data[3]=0;
001740  f88d600b          STRB     r6,[sp,#0xb]
;;;1341   lc640_write_long_ptr(lc640_adr+16,data);
001744  a902              ADD      r1,sp,#8
001746  f1040010          ADD      r0,r4,#0x10
00174a  f7fffffe          BL       lc640_write_long_ptr
;;;1342   
;;;1343   data[0]=LPC_RTC->HOUR;
00174e  7a28              LDRB     r0,[r5,#8]
001750  f88d0008          STRB     r0,[sp,#8]
;;;1344   data[1]=LPC_RTC->MIN;
001754  7928              LDRB     r0,[r5,#4]
001756  f88d0009          STRB     r0,[sp,#9]
;;;1345   data[2]=LPC_RTC->SEC;
00175a  7828              LDRB     r0,[r5,#0]
00175c  f88d000a          STRB     r0,[sp,#0xa]
;;;1346   data[3]=0;
001760  f88d600b          STRB     r6,[sp,#0xb]
;;;1347   lc640_write_long_ptr(lc640_adr+20,data);
001764  a902              ADD      r1,sp,#8
001766  f1040014          ADD      r0,r4,#0x14
00176a  f7fffffe          BL       lc640_write_long_ptr
;;;1348    
;;;1349   }
00176e  b005              ADD      sp,sp,#0x14
001770  bdf0              POP      {r4-r7,pc}
;;;1350   
                          ENDP

                  vz_mem_hndl PROC
;;;1352   //-----------------------------------------------
;;;1353   void vz_mem_hndl(unsigned short in)
001772  e92d4ff8          PUSH     {r3-r11,lr}
;;;1354   {
;;;1355   char data[4];
;;;1356   unsigned int event_ptr=0,lc640_adr,event_ptr_find=0,event_cnt;
001776  2600              MOVS     r6,#0
001778  2400              MOVS     r4,#0
;;;1357   //char avar_simbol;
;;;1358   
;;;1359   if(in==1)
;;;1360   	{
;;;1361   	event_ptr=lc640_read_int(PTR_EVENT_LOG);
;;;1362   	event_ptr++;	
;;;1363   	if(event_ptr>63)event_ptr=0;	
;;;1364   	lc640_write_int(PTR_EVENT_LOG,event_ptr);	
;;;1365   	
;;;1366        event_cnt=lc640_read_int(CNT_EVENT_LOG);
;;;1367   	if(event_cnt!=63)event_cnt=event_ptr;
;;;1368   	lc640_write_int(CNT_EVENT_LOG,event_cnt); 
;;;1369   	
;;;1370   	lc640_adr=EVENT_LOG+(lc640_read_int(PTR_EVENT_LOG)*32);
;;;1371   	
;;;1372   	data[0]='B';
;;;1373   	data[1]=0; 
;;;1374   	data[2]='Z';
;;;1375   	data[3]=0;
;;;1376   	lc640_write_long_ptr(lc640_adr,data);
;;;1377   
;;;1378   	data[0]=0;
;;;1379   	data[1]=0;
;;;1380   	data[2]=0;
;;;1381   	data[3]=0;
;;;1382   	lc640_write_long_ptr(lc640_adr+4,data);
;;;1383   
;;;1384   	data[0]=LPC_RTC->YEAR;
00177a  f8df81f8          LDR      r8,|L1.6516|
00177e  2742              MOVS     r7,#0x42              ;1372
001780  46a1              MOV      r9,r4                 ;1356
001782  f1a80820          SUB      r8,r8,#0x20
001786  f44f6a80          MOV      r10,#0x400            ;1370
00178a  2801              CMP      r0,#1                 ;1359
00178c  d001              BEQ      |L1.6034|
;;;1385   	data[1]=LPC_RTC->MONTH;
;;;1386   	data[2]=LPC_RTC->DOM;
;;;1387   	data[3]=0;
;;;1388   	lc640_write_long_ptr(lc640_adr+8,data);
;;;1389   
;;;1390   	data[0]=LPC_RTC->HOUR;
;;;1391   	data[1]=LPC_RTC->MIN;
;;;1392   	data[2]=LPC_RTC->SEC;
;;;1393   	data[3]=0;
;;;1394   	lc640_write_long_ptr(lc640_adr+12,data);
;;;1395   	
;;;1396   	data[0]='A';
;;;1397   	data[1]='A';
;;;1398   	data[2]='A';
;;;1399   	data[3]='A';
;;;1400   	lc640_write_long_ptr(lc640_adr+16,data);
;;;1401   	
;;;1402   	data[0]='A';
;;;1403   	data[1]='A';
;;;1404   	data[2]='A';
;;;1405   	data[3]='A';
;;;1406   	lc640_write_long_ptr(lc640_adr+20,data);
;;;1407   	
;;;1408   	data[0]='A';
;;;1409   	data[1]='A';
;;;1410   	data[2]='A';
;;;1411   	data[3]='A';
;;;1412   	lc640_write_long_ptr(lc640_adr+24,data);
;;;1413   	
;;;1414   	data[0]='A';
;;;1415   	data[1]='A';
;;;1416   	data[2]='A';
;;;1417   	data[3]='A';
;;;1418   	lc640_write_long_ptr(lc640_adr+28,data);		
;;;1419    	
;;;1420   	}
;;;1421   
;;;1422   else if(in==0)
00178e  b3f0              CBZ      r0,|L1.6158|
001790  e121              B        |L1.6614|
                  |L1.6034|
001792  f44f6560          MOV      r5,#0xe00             ;1361
001796  4628              MOV      r0,r5                 ;1361
001798  f7fffffe          BL       lc640_read_int
00179c  1c44              ADDS     r4,r0,#1              ;1362
00179e  2c3f              CMP      r4,#0x3f              ;1363
0017a0  d900              BLS      |L1.6052|
0017a2  2400              MOVS     r4,#0                 ;1363
                  |L1.6052|
0017a4  b221              SXTH     r1,r4                 ;1364
0017a6  4628              MOV      r0,r5                 ;1364
0017a8  f7fffffe          BL       lc640_write_int
0017ac  f6406602          MOV      r6,#0xe02             ;1366
0017b0  4630              MOV      r0,r6                 ;1366
0017b2  f7fffffe          BL       lc640_read_int
0017b6  283f              CMP      r0,#0x3f              ;1367
0017b8  d000              BEQ      |L1.6076|
0017ba  4620              MOV      r0,r4                 ;1367
                  |L1.6076|
0017bc  b201              SXTH     r1,r0                 ;1368
0017be  4630              MOV      r0,r6                 ;1368
0017c0  f7fffffe          BL       lc640_write_int
0017c4  4628              MOV      r0,r5                 ;1370
0017c6  f7fffffe          BL       lc640_read_int
0017ca  eb0a1440          ADD      r4,r10,r0,LSL #5      ;1370
0017ce  f88d7000          STRB     r7,[sp,#0]            ;1372
0017d2  f88d9001          STRB     r9,[sp,#1]            ;1373
0017d6  205a              MOVS     r0,#0x5a              ;1374
0017d8  f88d0002          STRB     r0,[sp,#2]            ;1374
0017dc  f88d9003          STRB     r9,[sp,#3]            ;1375
0017e0  4669              MOV      r1,sp                 ;1376
0017e2  4620              MOV      r0,r4                 ;1376
0017e4  f7fffffe          BL       lc640_write_long_ptr
0017e8  f8cd9000          STR      r9,[sp,#0]            ;1381
0017ec  4669              MOV      r1,sp                 ;1382
0017ee  1d20              ADDS     r0,r4,#4              ;1382
0017f0  f7fffffe          BL       lc640_write_long_ptr
0017f4  f8b8003c          LDRH     r0,[r8,#0x3c]         ;1384
0017f8  f88d0000          STRB     r0,[sp,#0]            ;1384
0017fc  f8980038          LDRB     r0,[r8,#0x38]         ;1385
001800  f88d0001          STRB     r0,[sp,#1]            ;1385
001804  f898002c          LDRB     r0,[r8,#0x2c]         ;1386
001808  f88d0002          STRB     r0,[sp,#2]            ;1386
00180c  e000              B        |L1.6160|
                  |L1.6158|
00180e  e04f              B        |L1.6320|
                  |L1.6160|
001810  f88d9003          STRB     r9,[sp,#3]            ;1387
001814  4669              MOV      r1,sp                 ;1388
001816  f1040008          ADD      r0,r4,#8              ;1388
00181a  f7fffffe          BL       lc640_write_long_ptr
00181e  f8980028          LDRB     r0,[r8,#0x28]         ;1390
001822  f88d0000          STRB     r0,[sp,#0]            ;1390
001826  f8980024          LDRB     r0,[r8,#0x24]         ;1391
00182a  f88d0001          STRB     r0,[sp,#1]            ;1391
00182e  f8980020          LDRB     r0,[r8,#0x20]         ;1392
001832  f88d0002          STRB     r0,[sp,#2]            ;1392
001836  f88d9003          STRB     r9,[sp,#3]            ;1393
00183a  4669              MOV      r1,sp                 ;1394
00183c  f104000c          ADD      r0,r4,#0xc            ;1394
001840  f7fffffe          BL       lc640_write_long_ptr
001844  2541              MOVS     r5,#0x41              ;1396
001846  f88d5000          STRB     r5,[sp,#0]            ;1396
00184a  f88d5001          STRB     r5,[sp,#1]            ;1397
00184e  f88d5002          STRB     r5,[sp,#2]            ;1398
001852  f88d5003          STRB     r5,[sp,#3]            ;1399
001856  4669              MOV      r1,sp                 ;1400
001858  f1040010          ADD      r0,r4,#0x10           ;1400
00185c  f7fffffe          BL       lc640_write_long_ptr
001860  f88d5000          STRB     r5,[sp,#0]            ;1402
001864  f88d5001          STRB     r5,[sp,#1]            ;1403
001868  f88d5002          STRB     r5,[sp,#2]            ;1404
00186c  f88d5003          STRB     r5,[sp,#3]            ;1405
001870  4669              MOV      r1,sp                 ;1406
001872  f1040014          ADD      r0,r4,#0x14           ;1406
001876  f7fffffe          BL       lc640_write_long_ptr
00187a  f88d5000          STRB     r5,[sp,#0]            ;1408
00187e  f88d5001          STRB     r5,[sp,#1]            ;1409
001882  f88d5002          STRB     r5,[sp,#2]            ;1410
001886  f88d5003          STRB     r5,[sp,#3]            ;1411
00188a  4669              MOV      r1,sp                 ;1412
00188c  f1040018          ADD      r0,r4,#0x18           ;1412
001890  f7fffffe          BL       lc640_write_long_ptr
001894  f88d5000          STRB     r5,[sp,#0]            ;1414
001898  f88d5001          STRB     r5,[sp,#1]            ;1415
00189c  f88d5002          STRB     r5,[sp,#2]            ;1416
0018a0  f88d5003          STRB     r5,[sp,#3]            ;1417
0018a4  4669              MOV      r1,sp                 ;1418
0018a6  f104001c          ADD      r0,r4,#0x1c           ;1418
0018aa  f7fffffe          BL       lc640_write_long_ptr
0018ae  e092              B        |L1.6614|
                  |L1.6320|
;;;1423   	{      
;;;1424        
;;;1425   vz_mem_hndl_lbl1: 
;;;1426   
;;;1427   	lc640_adr=EVENT_LOG+(event_ptr_find*32);
0018b0  eb0a1544          ADD      r5,r10,r4,LSL #5
;;;1428   
;;;1429        lc640_read_long_ptr(lc640_adr,data);
0018b4  4669              MOV      r1,sp
0018b6  4628              MOV      r0,r5
0018b8  f7fffffe          BL       lc640_read_long_ptr
;;;1430        
;;;1431        if(!((data[0]=='B')&&(data[2]=='Z')))
0018bc  f89d0000          LDRB     r0,[sp,#0]
0018c0  2842              CMP      r0,#0x42
0018c2  d103              BNE      |L1.6348|
0018c4  f89d0002          LDRB     r0,[sp,#2]
0018c8  285a              CMP      r0,#0x5a
0018ca  d006              BEQ      |L1.6362|
                  |L1.6348|
;;;1432        	{        
;;;1433        	if(event_ptr_find)event_ptr_find--;
0018cc  b10c              CBZ      r4,|L1.6354|
0018ce  1e64              SUBS     r4,r4,#1
0018d0  e000              B        |L1.6356|
                  |L1.6354|
;;;1434        	else event_ptr_find=63;
0018d2  243f              MOVS     r4,#0x3f
                  |L1.6356|
;;;1435        	if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
0018d4  42b4              CMP      r4,r6
0018d6  d1eb              BNE      |L1.6320|
0018d8  e07d              B        |L1.6614|
                  |L1.6362|
;;;1436        	else goto vz_mem_hndl_lbl1;
;;;1437        	}
;;;1438        else 
;;;1439        	{
;;;1440        	lc640_read_long_ptr(lc640_adr+16,data);
0018da  4669              MOV      r1,sp
0018dc  f1050010          ADD      r0,r5,#0x10
0018e0  f7fffffe          BL       lc640_read_long_ptr
;;;1441        	if(!((data[0]=='A')&&(data[1]=='A')&&(data[2]=='A')&&(data[3]=='A')))
0018e4  f89d0000          LDRB     r0,[sp,#0]
0018e8  2841              CMP      r0,#0x41
0018ea  d10b              BNE      |L1.6404|
0018ec  f89d0001          LDRB     r0,[sp,#1]
0018f0  2841              CMP      r0,#0x41
0018f2  d107              BNE      |L1.6404|
0018f4  f89d0002          LDRB     r0,[sp,#2]
0018f8  2841              CMP      r0,#0x41
0018fa  d103              BNE      |L1.6404|
0018fc  f89d0003          LDRB     r0,[sp,#3]
001900  2841              CMP      r0,#0x41
001902  d006              BEQ      |L1.6418|
                  |L1.6404|
;;;1442        		{        
;;;1443        		if(event_ptr_find)event_ptr_find--;
001904  b10c              CBZ      r4,|L1.6410|
001906  1e64              SUBS     r4,r4,#1
001908  e000              B        |L1.6412|
                  |L1.6410|
;;;1444            		else event_ptr_find=63;
00190a  243f              MOVS     r4,#0x3f
                  |L1.6412|
;;;1445            		if(event_ptr_find==event_ptr)goto vz_mem_hndl_end;
00190c  42b4              CMP      r4,r6
00190e  d1cf              BNE      |L1.6320|
001910  e061              B        |L1.6614|
                  |L1.6418|
;;;1446        		else goto vz_mem_hndl_lbl1;
;;;1447        		}
;;;1448   
;;;1449        	}	
;;;1450   
;;;1451   
;;;1452   	
;;;1453   	data[0]=LPC_RTC->YEAR;
001912  f8b8003c          LDRH     r0,[r8,#0x3c]
001916  f88d0000          STRB     r0,[sp,#0]
;;;1454   	data[1]=LPC_RTC->MONTH;
00191a  f8980038          LDRB     r0,[r8,#0x38]
00191e  f88d0001          STRB     r0,[sp,#1]
;;;1455   	data[2]=LPC_RTC->DOM;
001922  f898002c          LDRB     r0,[r8,#0x2c]
001926  f88d0002          STRB     r0,[sp,#2]
;;;1456   	data[3]=0;
00192a  f88d9003          STRB     r9,[sp,#3]
;;;1457   	lc640_write_long_ptr(lc640_adr+16,data);
00192e  4669              MOV      r1,sp
001930  f1050010          ADD      r0,r5,#0x10
001934  e020              B        |L1.6520|
001936  0000              DCW      0x0000
                  |L1.6456|
001938  42415420          DCB      "BAT #1 Alarm, assimetry",0
00193c  23312041
001940  6c61726d
001944  2c206173
001948  73696d65
00194c  74727900
                  |L1.6480|
001950  42415420          DCB      "BAT #2 Alarm, assimetry",0
001954  23322041
001958  6c61726d
00195c  2c206173
001960  73696d65
001964  74727900
                  |L1.6504|
                          DCD      bat
                  |L1.6508|
                          DCD      bat_u_old_cnt
                  |L1.6512|
                          DCD      ke_date
                  |L1.6516|
                          DCD      0x40024020
                  |L1.6520|
001978  f7fffffe          BL       lc640_write_long_ptr
;;;1458   
;;;1459   	data[0]=LPC_RTC->HOUR;
00197c  f8980028          LDRB     r0,[r8,#0x28]
001980  f88d0000          STRB     r0,[sp,#0]
;;;1460   	data[1]=LPC_RTC->MIN;
001984  f8980024          LDRB     r0,[r8,#0x24]
001988  f88d0001          STRB     r0,[sp,#1]
;;;1461   	data[2]=LPC_RTC->SEC;
00198c  f8980020          LDRB     r0,[r8,#0x20]
001990  f88d0002          STRB     r0,[sp,#2]
;;;1462   	data[3]=0;
001994  f88d9003          STRB     r9,[sp,#3]
;;;1463   	lc640_write_long_ptr(lc640_adr+20,data);
001998  4669              MOV      r1,sp
00199a  f1050014          ADD      r0,r5,#0x14
00199e  f7fffffe          BL       lc640_write_long_ptr
;;;1464   	
;;;1465   	data[0]='B';
0019a2  f88d7000          STRB     r7,[sp,#0]
;;;1466   	data[1]='B';
0019a6  f88d7001          STRB     r7,[sp,#1]
;;;1467   	data[2]='B';
0019aa  f88d7002          STRB     r7,[sp,#2]
;;;1468   	data[3]='B';
0019ae  f88d7003          STRB     r7,[sp,#3]
;;;1469   	lc640_write_long_ptr(lc640_adr+24,data);
0019b2  4669              MOV      r1,sp
0019b4  f1050018          ADD      r0,r5,#0x18
0019b8  f7fffffe          BL       lc640_write_long_ptr
;;;1470   	
;;;1471   	data[0]='B';
0019bc  f88d7000          STRB     r7,[sp,#0]
;;;1472   	data[1]='B';
0019c0  f88d7001          STRB     r7,[sp,#1]
;;;1473   	data[2]='B';
0019c4  f88d7002          STRB     r7,[sp,#2]
;;;1474   	data[3]='B';
0019c8  f88d7003          STRB     r7,[sp,#3]
;;;1475   	lc640_write_long_ptr(lc640_adr+28,data);
0019cc  4669              MOV      r1,sp
0019ce  f105001c          ADD      r0,r5,#0x1c
0019d2  f7fffffe          BL       lc640_write_long_ptr
                  |L1.6614|
;;;1476   	
;;;1477   	}
;;;1478   
;;;1479   vz_mem_hndl_end:
;;;1480   __nop(); 
0019d6  bf00              NOP      
;;;1481   
;;;1482   }
0019d8  e4dd              B        |L1.5014|
;;;1483     
                          ENDP


                          AREA ||.data||, DATA, ALIGN=2

                  avar_stat
                          DCD      0x00000000
                  avar_ind_stat
                          DCD      0x00000000
                  avar_stat_old
                          DCD      0x00000000
                  avar_stat_new
                          DCD      0x00000000
                  avar_stat_offed
                          DCD      0x00000000
                  rki_avar1_stat
                          DCD      0x00000000
                  rki_avar1_ind_stat
                          DCD      0x00000000
                  rki_avar1_stat_old
                          DCD      0x00000000
                  rki_avar1_stat_new
                          DCD      0x00000000
                  rki_avar1_stat_offed
                          DCD      0x00000000
                  rki_avarI1_stat
                          DCD      0x00000000
                  rki_avarI1_ind_stat
                          DCD      0x00000000
                  rki_avarI1_stat_old
                          DCD      0x00000000
                  rki_avarI1_stat_new
                          DCD      0x00000000
                  rki_avarI1_stat_offed
                          DCD      0x00000000
                  rki_avarI2_stat
                          DCD      0x00000000
                  rki_avarI2_ind_stat
                          DCD      0x00000000
                  rki_avarI2_stat_old
                          DCD      0x00000000
                  rki_avarI2_stat_new
                          DCD      0x00000000
                  rki_avarI2_stat_offed
                          DCD      0x00000000
                  av_inv
                          DCD      0x00000000
000054  0000              DCB      0x00,0x00
